     H/TITLE Exc Transfer old CF1  XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by  : 2E  Version:  1181
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model         lopment-
     H* System        : OMS Development Model
     H* User name     : ISPPATE
     H* Date          : 04/11/07  Time  : 13:17:03
     H* Copyright     : OMS Development Model         lopment-
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : Application Profile       Retrieval index       NV
      *
     FCAB1REL2IF  E           K        DISK
      * RSQ : Item Balance Detail       Co/Whs/Item/Prod Date
      *
     FPDL5CPL9IF  E           K        DISK
      * RSQ : Item Lot Location         Co/Whs/Itm/PDte(D)
      *
     FPDL7CPL2IF  E           K        DISK
      * RSQ : Item Lot Loc Trans        Co/Itm/Whs/Typ/Dte/Sq(d)
      *
     FPDL5CPL1IF  E           K        DISK
      * RTV : Item Lot Location         Retrieval index
      *
     FCAB1REL0IF  E           K        DISK
      * RTV : Item Balance Detail       Retrieval index       NV
      *
     FPDL2REL0IF  E           K        DISK
      * RTV : Warehouse Location        Retrieval index
      *
     FPDL7CPL0IF  E           K        DISK                      A
      * UPD : Item Lot Loc Trans        Update index
      *
     FPDL5CPL0UF  E           K        DISK                      A
      * UPD : Item Lot Location         Update index
      *
     FCAB1REL1UF  E           K        DISK
      * UPD : Item Balance Detail       Update index
      *
     FPDL2REL1IF  E           K        DISK                      A
      * UPD : Warehouse Location        Update index
      *
      * Long constants
     E                    @CN#    1   1  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@DRRETH
      * User Profile Control      Retrieval index       NV
      * Renamed input format fields
     I              DRAJVN                          WAAJVN
     I              DRAUNA                          WAAUNA
     I              DRB8NA                          WAB8NA
     I              DRAHVN                          WAAHVN
     I              DRI6ST                          WAI6ST
     I              DRI7ST                          WAI7ST
     I              DRXMST                          WAXMST
     I              DRXNST                          WAXNST
     I              DRI8ST                          WAI8ST
     I              DRNLNB                          WANLNB
     I              DRMPNA                          WAMPNA
     I              DRBCCD                          WABCCD
     I              DRAIC3                          WAAIC3
     I              DRDQCD                          WADQCD
     I              DRDRCD                          WADRCD
     I              DRAJCD                          WAAJCD
     I              DRBUVN                          WABUVN
     I              DRUVST                          WAUVST
     I              DRUWST                          WAUWST
     I              DRUXST                          WAUXST
     I              DRAATM                          WAAATM
     I              DRAYNA                          WAAYNA
     I              DRA0NA                          WAA0NA
     I              DRAXDT                          WAAXDT
      *
     I@DTRETE
      * Application Profile       Retrieval index       NV
      * Renamed input format fields
     I              DTAJVN                          WBAJVN
     I              DTDNCD                          WBDNCD
     I              DTAIC3                          WBAIC3
     I              DTDQCD                          WBDQCD
     I              DTDRCD                          WBDRCD
     I              DTAJCD                          WBAJCD
     I              DTJFST                          WBJFST
     I              DTUVST                          WBUVST
     I              DTUWST                          WBUWST
     I              DTUXST                          WBUXST
     I              DTAATM                          WBAATM
     I              DTAYNA                          WBAYNA
     I              DTA0NA                          WBA0NA
     I              DTAXDT                          WBAXDT
      *
     I@B1RESE
      * Item Balance Detail       Co/Whs/Item/Prod Date
      * Renamed input format fields
     I              B1AIC3                          WCAIC3
     I              B1HGCD                          WCHGCD
     I              B1AJCD                          WCAJCD
     I              B1ELDT                          WCELDT
     I              B1ABWG                          WCABWG
     I              B1AGQT                          WCAGQT
     I              B1AHQT                          WCAHQT
     I              B1AIQT                          WCAIQT
     I              B1CTST                          WCCTST
     I              B1ACWG                          WCACWG
     I              B1ARQT                          WCARQT
     I              B1ASQT                          WCASQT
     I              B1ATQT                          WCATQT
     I              B1HDQT                          WCHDQT
     I              B1HEQT                          WCHEQT
     I              B1F6ST                          WCF6ST
     I              B1BMWG                          WCBMWG
     I              B1DSQT                          WCDSQT
     I              B1DTQT                          WCDTQT
     I              B1DUQT                          WCDUQT
     I              B1DHDT                          WCDHDT
     I              B1AGCS                          WCAGCS
     I              B1AECS                          WCAECS
     I              B1IDVA                          WCIDVA
     I              B1K7DT                          WCK7DT
     I              B1RINB                          WCRINB
     I              B1RHNB                          WCRHNB
     I              B1RGNB                          WCRGNB
     I              B1UVST                          WCUVST
     I              B1UWST                          WCUWST
     I              B1UXST                          WCUXST
     I              B1VSST                          WCVSST
     I              B1AATM                          WCAATM
     I              B1AYNA                          WCAYNA
     I              B1A0NA                          WCA0NA
     I              B1AXDT                          WCAXDT
      *
     I@L5CPHC
      * Item Lot Location         Co/Whs/Itm/PDte(D)
      * Renamed input format fields
     I              L5AIC3                          WDAIC3
     I              L5HGCD                          WDHGCD
     I              L5AJCD                          WDAJCD
     I              L5ELDT                          WDELDT
     I              L5LXNM                          WDLXNM
     I              L5YMCD                          WDYMCD
     I              L5YNCD                          WDYNCD
     I              L5J2QT                          WDJ2QT
     I              L5G5WG                          WDG5WG
     I              L5J3QT                          WDJ3QT
     I              L5G6WG                          WDG6WG
     I              L5J4QT                          WDJ4QT
     I              L5G7WG                          WDG7WG
     I              L5LODT                          WDLODT
     I              L5LPDT                          WDLPDT
     I              L5LQDT                          WDLQDT
     I              L5NBR                           WDNBR
     I              L5YTCD                          WDYTCD
     I              L5AMSX                          WDAMSX
     I              L5ASSX                          WDASSX
     I              L5ATSX                          WDATSX
     I              L5AUSX                          WDAUSX
     I              L5YSCD                          WDYSCD
     I              L5UVST                          WDUVST
     I              L5UWST                          WDUWST
     I              L5UXST                          WDUXST
     I              L5VSST                          WDVSST
     I              L5AATM                          WDAATM
     I              L5AYNA                          WDAYNA
     I              L5A0NA                          WDA0NA
     I              L5AXDT                          WDAXDT
      *
     I@L7CPUK
      * Item Lot Loc Trans        Co/Itm/Whs/Typ/Dte/Sq(d)
      * Renamed input format fields
     I              L7AIC3                          WEAIC3
     I              L7HGCD                          WEHGCD
     I              L7AJCD                          WEAJCD
     I              L7LTRT                          WELTRT
     I              L7LRDT                          WELRDT
     I              L7LLTS                          WELLTS
     I              L7LSDT                          WELSDT
     I              L7J5QT                          WEJ5QT
     I              L7G8WG                          WEG8WG
     I              L7LLTN                          WELLTN
     I              L7YMCD                          WEYMCD
     I              L7LLCL                          WELLCL
     I              L7BNAA                          WEBNAA
     I              L7LLTR                          WELLTR
     I              L7Y2CD                          WEY2CD
     I              L7LLTL                          WELLTL
     I              L7C4NB                          WEC4NB
     I              L7LOST                          WELOST
     I              L7LLTU                          WELLTU
     I              L7LLYT                          WELLYT
     I              L7UVST                          WEUVST
     I              L7UWST                          WEUWST
     I              L7UXST                          WEUXST
     I              L7VSST                          WEVSST
     I              L7AATM                          WEAATM
     I              L7AYNA                          WEAYNA
     I              L7A0NA                          WEA0NA
     I              L7AXDT                          WEAXDT
      *
     I@L7CPS3
      * Item Lot Loc Trans        Update index
      * Renamed input format fields
     I              L7AIC3                          WFAIC3
     I              L7HGCD                          WFHGCD
     I              L7AJCD                          WFAJCD
     I              L7LTRT                          WFLTRT
     I              L7LRDT                          WFLRDT
     I              L7LLTS                          WFLLTS
     I              L7LSDT                          WFLSDT
     I              L7J5QT                          WFJ5QT
     I              L7G8WG                          WFG8WG
     I              L7LLTN                          WFLLTN
     I              L7YMCD                          WFYMCD
     I              L7LLCL                          WFLLCL
     I              L7BNAA                          WFBNAA
     I              L7LLTR                          WFLLTR
     I              L7Y2CD                          WFY2CD
     I              L7LLTL                          WFLLTL
     I              L7C4NB                          WFC4NB
     I              L7LOST                          WFLOST
     I              L7LLTU                          WFLLTU
     I              L7LLYT                          WFLLYT
     I              L7UVST                          WFUVST
     I              L7UWST                          WFUWST
     I              L7UXST                          WFUXST
     I              L7VSST                          WFVSST
     I              L7AATM                          WFAATM
     I              L7AYNA                          WFAYNA
     I              L7A0NA                          WFA0NA
     I              L7AXDT                          WFAXDT
      *
     I@L5CPSV
      * Item Lot Location         Retrieval index
      * Renamed input format fields
     I              L5AIC3                          WGAIC3
     I              L5HGCD                          WGHGCD
     I              L5AJCD                          WGAJCD
     I              L5ELDT                          WGELDT
     I              L5LXNM                          WGLXNM
     I              L5YMCD                          WGYMCD
     I              L5YNCD                          WGYNCD
     I              L5J2QT                          WGJ2QT
     I              L5G5WG                          WGG5WG
     I              L5J3QT                          WGJ3QT
     I              L5G6WG                          WGG6WG
     I              L5J4QT                          WGJ4QT
     I              L5G7WG                          WGG7WG
     I              L5LODT                          WGLODT
     I              L5LPDT                          WGLPDT
     I              L5LQDT                          WGLQDT
     I              L5NBR                           WGNBR
     I              L5YTCD                          WGYTCD
     I              L5AMSX                          WGAMSX
     I              L5ASSX                          WGASSX
     I              L5ATSX                          WGATSX
     I              L5AUSX                          WGAUSX
     I              L5YSCD                          WGYSCD
     I              L5UVST                          WGUVST
     I              L5UWST                          WGUWST
     I              L5UXST                          WGUXST
     I              L5VSST                          WGVSST
     I              L5AATM                          WGAATM
     I              L5AYNA                          WGAYNA
     I              L5A0NA                          WGA0NA
     I              L5AXDT                          WGAXDT
      *
     I@L5CPSL
      * Item Lot Location         Update index
      * Renamed input format fields
     I              L5AIC3                          WHAIC3
     I              L5HGCD                          WHHGCD
     I              L5AJCD                          WHAJCD
     I              L5ELDT                          WHELDT
     I              L5LXNM                          WHLXNM
     I              L5YMCD                          WHYMCD
     I              L5YNCD                          WHYNCD
     I              L5J2QT                          WHJ2QT
     I              L5G5WG                          WHG5WG
     I              L5J3QT                          WHJ3QT
     I              L5G6WG                          WHG6WG
     I              L5J4QT                          WHJ4QT
     I              L5G7WG                          WHG7WG
     I              L5LODT                          WHLODT
     I              L5LPDT                          WHLPDT
     I              L5LQDT                          WHLQDT
     I              L5NBR                           WHNBR
     I              L5YTCD                          WHYTCD
     I              L5AMSX                          WHAMSX
     I              L5ASSX                          WHASSX
     I              L5ATSX                          WHATSX
     I              L5AUSX                          WHAUSX
     I              L5YSCD                          WHYSCD
     I              L5UVST                          WHUVST
     I              L5UWST                          WHUWST
     I              L5UXST                          WHUXST
     I              L5VSST                          WHVSST
     I              L5AATM                          WHAATM
     I              L5AYNA                          WHAYNA
     I              L5A0NA                          WHA0NA
     I              L5AXDT                          WHAXDT
      *
     I@B1REJ0
      * Item Balance Detail       Retrieval index       NV
      * Renamed input format fields
     I              B1AIC3                          WIAIC3
     I              B1HGCD                          WIHGCD
     I              B1AJCD                          WIAJCD
     I              B1ELDT                          WIELDT
     I              B1ABWG                          WIABWG
     I              B1AGQT                          WIAGQT
     I              B1AHQT                          WIAHQT
     I              B1AIQT                          WIAIQT
     I              B1CTST                          WICTST
     I              B1ACWG                          WIACWG
     I              B1ARQT                          WIARQT
     I              B1ASQT                          WIASQT
     I              B1ATQT                          WIATQT
     I              B1HDQT                          WIHDQT
     I              B1HEQT                          WIHEQT
     I              B1F6ST                          WIF6ST
     I              B1BMWG                          WIBMWG
     I              B1DSQT                          WIDSQT
     I              B1DTQT                          WIDTQT
     I              B1DUQT                          WIDUQT
     I              B1DHDT                          WIDHDT
     I              B1AGCS                          WIAGCS
     I              B1AECS                          WIAECS
     I              B1IDVA                          WIIDVA
     I              B1K7DT                          WIK7DT
     I              B1RINB                          WIRINB
     I              B1RHNB                          WIRHNB
     I              B1RGNB                          WIRGNB
     I              B1UVST                          WIUVST
     I              B1UWST                          WIUWST
     I              B1UXST                          WIUXST
     I              B1VSST                          WIVSST
     I              B1AATM                          WIAATM
     I              B1AYNA                          WIAYNA
     I              B1A0NA                          WIA0NA
     I              B1AXDT                          WIAXDT
      *
     I@B1REJ1
      * Item Balance Detail       Update index
      * Renamed input format fields
     I              B1AIC3                          WJAIC3
     I              B1HGCD                          WJHGCD
     I              B1AJCD                          WJAJCD
     I              B1ELDT                          WJELDT
     I              B1ABWG                          WJABWG
     I              B1AGQT                          WJAGQT
     I              B1AHQT                          WJAHQT
     I              B1AIQT                          WJAIQT
     I              B1CTST                          WJCTST
     I              B1ACWG                          WJACWG
     I              B1ARQT                          WJARQT
     I              B1ASQT                          WJASQT
     I              B1ATQT                          WJATQT
     I              B1HDQT                          WJHDQT
     I              B1HEQT                          WJHEQT
     I              B1F6ST                          WJF6ST
     I              B1BMWG                          WJBMWG
     I              B1DSQT                          WJDSQT
     I              B1DTQT                          WJDTQT
     I              B1DUQT                          WJDUQT
     I              B1DHDT                          WJDHDT
     I              B1AGCS                          WJAGCS
     I              B1AECS                          WJAECS
     I              B1IDVA                          WJIDVA
     I              B1K7DT                          WJK7DT
     I              B1RINB                          WJRINB
     I              B1RHNB                          WJRHNB
     I              B1RGNB                          WJRGNB
     I              B1UVST                          WJUVST
     I              B1UWST                          WJUWST
     I              B1UXST                          WJUXST
     I              B1VSST                          WJVSST
     I              B1AATM                          WJAATM
     I              B1AYNA                          WJAYNA
     I              B1A0NA                          WJA0NA
     I              B1AXDT                          WJAXDT
      *
     I@L2RESM
      * Warehouse Location        Retrieval index
      * Renamed input format fields
     I              L2AJCD                          WKAJCD
     I              L2YMCD                          WKYMCD
     I              L2YPCD                          WKYPCD
     I              L2LCBY                          WKLCBY
     I              L2LCCT                          WKLCCT
     I              L2WLUS                          WKWLUS
     I              L2WUSD                          WKWUSD
     I              L2WLUN                          WKWLUN
     I              L2AGSX                          WKAGSX
     I              L2UVST                          WKUVST
     I              L2UWST                          WKUWST
     I              L2UXST                          WKUXST
     I              L2VSST                          WKVSST
     I              L2AATM                          WKAATM
     I              L2AYNA                          WKAYNA
     I              L2A0NA                          WKA0NA
     I              L2AXDT                          WKAXDT
      *
     I@L2RESN
      * Warehouse Location        Update index
      * Renamed input format fields
     I              L2AJCD                          WLAJCD
     I              L2YMCD                          WLYMCD
     I              L2YPCD                          WLYPCD
     I              L2LCBY                          WLLCBY
     I              L2LCCT                          WLLCCT
     I              L2WLUS                          WLWLUS
     I              L2WUSD                          WLWUSD
     I              L2WLUN                          WLWLUN
     I              L2AGSX                          WLAGSX
     I              L2UVST                          WLUVST
     I              L2UWST                          WLUWST
     I              L2UXST                          WLUXST
     I              L2VSST                          WLVSST
     I              L2AATM                          WLAATM
     I              L2AYNA                          WLAYNA
     I              L2A0NA                          WLA0NA
     I              L2AXDT                          WLAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IQPDL71    E DSPDL7CPL0
      * UPD : Item Lot Loc Trans        Update index
      * Renamed input format fields
     I              L7AIC3                          WFAIC3
     I              L7HGCD                          WFHGCD
     I              L7AJCD                          WFAJCD
     I              L7LTRT                          WFLTRT
     I              L7LRDT                          WFLRDT
     I              L7LLTS                          WFLLTS
     I              L7LSDT                          WFLSDT
     I              L7J5QT                          WFJ5QT
     I              L7G8WG                          WFG8WG
     I              L7LLTN                          WFLLTN
     I              L7YMCD                          WFYMCD
     I              L7LLCL                          WFLLCL
     I              L7BNAA                          WFBNAA
     I              L7LLTR                          WFLLTR
     I              L7Y2CD                          WFY2CD
     I              L7LLTL                          WFLLTL
     I              L7C4NB                          WFC4NB
     I              L7LOST                          WFLOST
     I              L7LLTU                          WFLLTU
     I              L7LLYT                          WFLLYT
     I              L7UVST                          WFUVST
     I              L7UWST                          WFUWST
     I              L7UXST                          WFUXST
     I              L7VSST                          WFVSST
     I              L7AATM                          WFAATM
     I              L7AYNA                          WFAYNA
     I              L7A0NA                          WFA0NA
     I              L7AXDT                          WFAXDT
      *
     IQPDL51    E DSPDL5CPL0
      * UPD : Item Lot Location         Update index
      * Renamed input format fields
     I              L5AIC3                          WHAIC3
     I              L5HGCD                          WHHGCD
     I              L5AJCD                          WHAJCD
     I              L5ELDT                          WHELDT
     I              L5LXNM                          WHLXNM
     I              L5YMCD                          WHYMCD
     I              L5YNCD                          WHYNCD
     I              L5J2QT                          WHJ2QT
     I              L5G5WG                          WHG5WG
     I              L5J3QT                          WHJ3QT
     I              L5G6WG                          WHG6WG
     I              L5J4QT                          WHJ4QT
     I              L5G7WG                          WHG7WG
     I              L5LODT                          WHLODT
     I              L5LPDT                          WHLPDT
     I              L5LQDT                          WHLQDT
     I              L5NBR                           WHNBR
     I              L5YTCD                          WHYTCD
     I              L5AMSX                          WHAMSX
     I              L5ASSX                          WHASSX
     I              L5ATSX                          WHATSX
     I              L5AUSX                          WHAUSX
     I              L5YSCD                          WHYSCD
     I              L5UVST                          WHUVST
     I              L5UWST                          WHUWST
     I              L5UXST                          WHUXST
     I              L5VSST                          WHVSST
     I              L5AATM                          WHAATM
     I              L5AYNA                          WHAYNA
     I              L5A0NA                          WHA0NA
     I              L5AXDT                          WHAXDT
      *
     IYARDCS      DS                            111
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQCAB11    E DSCAB1REL1
      * UPD : Item Balance Detail       Update index
      * Renamed input format fields
     I              B1AIC3                          WJAIC3
     I              B1HGCD                          WJHGCD
     I              B1AJCD                          WJAJCD
     I              B1ELDT                          WJELDT
     I              B1ABWG                          WJABWG
     I              B1AGQT                          WJAGQT
     I              B1AHQT                          WJAHQT
     I              B1AIQT                          WJAIQT
     I              B1CTST                          WJCTST
     I              B1ACWG                          WJACWG
     I              B1ARQT                          WJARQT
     I              B1ASQT                          WJASQT
     I              B1ATQT                          WJATQT
     I              B1HDQT                          WJHDQT
     I              B1HEQT                          WJHEQT
     I              B1F6ST                          WJF6ST
     I              B1BMWG                          WJBMWG
     I              B1DSQT                          WJDSQT
     I              B1DTQT                          WJDTQT
     I              B1DUQT                          WJDUQT
     I              B1DHDT                          WJDHDT
     I              B1AGCS                          WJAGCS
     I              B1AECS                          WJAECS
     I              B1IDVA                          WJIDVA
     I              B1K7DT                          WJK7DT
     I              B1RINB                          WJRINB
     I              B1RHNB                          WJRHNB
     I              B1RGNB                          WJRGNB
     I              B1UVST                          WJUVST
     I              B1UWST                          WJUWST
     I              B1UXST                          WJUXST
     I              B1VSST                          WJVSST
     I              B1AATM                          WJAATM
     I              B1AYNA                          WJAYNA
     I              B1A0NA                          WJA0NA
     I              B1AXDT                          WJAXDT
      *
     IQPDL21    E DSPDL2REL1
      * UPD : Warehouse Location        Update index
      * Renamed input format fields
     I              L2AJCD                          WLAJCD
     I              L2YMCD                          WLYMCD
     I              L2YPCD                          WLYPCD
     I              L2LCBY                          WLLCBY
     I              L2LCCT                          WLLCCT
     I              L2WLUS                          WLWLUS
     I              L2WUSD                          WLWUSD
     I              L2WLUN                          WLWLUN
     I              L2AGSX                          WLAGSX
     I              L2UVST                          WLUVST
     I              L2UWST                          WLUWST
     I              L2UXST                          WLUXST
     I              L2VSST                          WLVSST
     I              L2AATM                          WLAATM
     I              L2AYNA                          WLAYNA
     I              L2A0NA                          WLA0NA
     I              L2AXDT                          WLAXDT
      *
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Exc Transfer old CF1  XF
      * *****************************************************************
      * PK0306 8/23/01      Transfer CF1 product over 90 days old to CFH
      * *****************************************************************
      *
     C                     MOVEL*BLANK    WN0001 10        User Code Model
      *
      * RTV default Company    IF
      * Rtv Profile Model     RT - User Profile Control  * 
     C                     EXSR SARVGN
      * CASE: PAR.User Code Model is equal to blank
     C           WN0001    IFEQ *BLANK                     *IF
      * RTV Appl. Default Co   RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##USR     WL0001    P      User Profile Na
     C                     MOVEL'P/S'     WL0002    P      Application Cod
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    YL0001           Company Number
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Default Co   RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0001    WL0001    P      User Profile Na
     C                     MOVEL'P/S'     WL0002    P      Application Cod
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    YL0001           Company Number
     C                     END                             *FI
     C                     MOVEL'CF1'     YL0002           Warehouse Code
      * LCL.Label Date  USR = JOB.*Job date + CON.-90 *DAYS
     C           ##JDT     ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-90       XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0003
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0003
     C                     END
     C                     MOVEL'CFH'     YL0004           To Warehouse Co
      * Rtv Transfer old CF1  RT - Item Balance Detail  * 
     C                     EXSR SCRVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Profile Model     RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAJVN           User Profile Na
      * Setup key
     C                     MOVEL##USR     WAAJVN           User Profile Na
      * Establish starting position
     C           KRSSA     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0001           User Code Model
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWABUVN    WN0001           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Appl. Default Co   RT - Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAJVN           User Profile Na
     C                     KFLD           WBDNCD           Application Cod
      * Setup key
     C                     MOVELWL0001    WBAJVN           User Profile Na
     C                     MOVELWL0002    WBDNCD           Application Cod
      * Establish starting position
     C           KRSSB     CHAIN@DTRETE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0767' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0003           Company Number
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBAIC3    WL0003           Company Number
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Transfer old CF1  RT - Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSC01           Company Number
     C           *LIKE     DEFN WCAJCD    WQSC02           Warehouse Code
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Warehouse Code
      * Setup key
     C                     Z-ADDYL0001    WQSC01           Company Number
     C                     MOVELYL0002    WQSC02           Warehouse Code
      * Establish starting position
     C           KRSSC     SETLL@B1RESE                    *
     C           KRSSC     READE@B1RESE                  90*
      * Data record not found
     C   90                MOVEL'USR0330' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.Label Date LT PAR.Label Date  USR
      *   |- c2    : DB1.Quantity on Hand - U/M1 is not equal zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCK7DT    IFLT YL0003                     *IF
     C           WCARQT    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Upd Balances Transfer  XF - Item Balance  * 
     C                     CALL 'PDQTXFR'              90  Upd Balances Tr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WCAIC3    WQ0001  30       Company Number
     C                     PARM WCHGCD    WQ0002  70       Item Code
     C                     PARM WCAJCD    WQ0003  3        Warehouse Code
     C                     PARM 'T'       WQ0004  1        Inventory Trans
     C                     PARM 'TW'      WQ0005  2        Inventory Trans
     C                     PARM ##JDT     WQ0006  70       Transaction Dat
     C                     PARM WCELDT    WQ0007  70       Production Date
     C                     PARM 'SG'      WQ0008  2        Item Transactio
     C                     PARM @CN,01    WQ0009 30        Description
     C                     PARM 'TRF'     WQ0010  3        Reason Code
     C                     PARM *ZERO     WQ0011  70       Order Number
     C                     PARM '1'       WQ0012  1        Shift Number
     C                     PARM WCK7DT    WQ0013  70       Label Date
     C                     PARM YL0004    WQ0014  3        USR Warehouse C
     C                     PARM WCACWG    WQ0015 112       USR Weight Accu
     C                     PARM WCARQT    WQ0016 112       USR Quantity
     C                     PARM 'N'       WQ0017  1        USR Unship Flag
     C                     PARM 'N'       WQ0018  1        Inter-Plant Tra
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Rtv Transfer LotLoc   RT - Item Lot Location  * 
     C                     EXSR SDRVGN
     C                     END                             *FI
     C           KRSSC     READE@B1RESE                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Transfer LotLoc   RT - Item Lot Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSD01           Company Number
     C           *LIKE     DEFN WDHGCD    WQSD02           Item Code
     C           *LIKE     DEFN WDAJCD    WQSD03           Warehouse Code
     C           *LIKE     DEFN WDELDT    WQSD04           Production Date
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Item Code
     C                     KFLD           WQSD03           Warehouse Code
     C                     KFLD           WQSD04           Production Date
      * Setup key
     C                     Z-ADDWCAIC3    WQSD01           Company Number
     C                     Z-ADDWCHGCD    WQSD02           Item Code
     C                     MOVELWCAJCD    WQSD03           Warehouse Code
     C                     Z-ADDWCELDT    WQSD04           Production Date
      * Establish starting position
     C           KRSSD     SETLL@L5CPHC                    *
     C           KRSSD     READE@L5CPHC                  90*
      * Data record not found
     C   90                MOVEL'USR2634' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Update From Lot/Location
     C           WDJ2QT    MULT -1        YL0005           Quantity Loc Tr
      *
     C                     Z-ADD*ZERO     WN0002  30       LLT Sequence #
     C                     MOVEL*BLANK    WN0003  1        EDI Status 1
     C                     MOVEL*BLANK    WN0004  1        EDI Status 2
     C                     MOVEL*BLANK    WN0005  1        EDI Status 3
     C                     MOVEL*BLANK    WN0006  1        Record Status
     C                     Z-ADD*ZERO     WN0007  60       Job Time
     C                     MOVEL*BLANK    WN0008 10        User Id
     C                     MOVEL*BLANK    WN0009 10        Job Name
     C                     Z-ADD*ZERO     WN0010  70       Job Date
      *
      * Crt Item Lot/Loc Trns IF
      * Rtv Next Seq #        RT - IC Item Lot/Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0004           Company Number
     C                     Z-ADDWCHGCD    WL0005           Item Code
     C                     MOVELWCAJCD    WL0006    P      Warehouse Code
     C                     MOVEL'T'       WL0007    P      LLT Trans Type
     C                     Z-ADD##JDT     WL0008           LLT Trans Date
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0009    WN0002           LLT Sequence #
      * Crt Item Lot/Loc Trns CR - Item Lot/Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0010           Company Number
     C                     Z-ADDWCHGCD    WL0011           Item Code
     C                     MOVELWCAJCD    WL0012    P      Warehouse Code
     C                     MOVEL'T'       WL0013    P      LLT Trans Type
     C                     Z-ADD##JDT     WL0014           LLT Trans Date
     C                     Z-ADDWN0002    WL0015           LLT Sequence #
     C                     Z-ADDWCELDT    WL0016           LLT Production
     C                     Z-ADDYL0005    WL0017           LLT Trans Qty
     C                     Z-ADD*ZERO     WL0018           LLT Trans Wgt
     C                     Z-ADDWDLXNM    WL0019           LLT Lot Number
     C                     MOVELWDYMCD    WL0020    P      Location Code
     C                     Z-ADDWDYNCD    WL0021           LLT Location Le
     C                     MOVELYL0004    WL0022    P      Transfer Wareho
     C                     Z-ADDWDLXNM    WL0023           LLT Transfer Lo
     C                     MOVELWDYMCD    WL0024    P      Transfer Locati
     C                     Z-ADDWDYNCD    WL0025           LLT Transfer Lo
     C                     Z-ADD*ZERO     WL0026           Order Number
     C                     MOVEL'P'       WL0027    P      LLT Status
     C                     MOVELWULLTU    WL0028    P      LTT Unused Sts
     C                     MOVELWULLYT    WL0029    P      LTT Unused Sts
     C                     MOVELWN0003    WL0030    P      EDI Status 1
     C                     MOVELWN0004    WL0031    P      EDI Status 2
     C                     MOVELWN0005    WL0032    P      EDI Status 3
     C                     MOVELWN0006    WL0033    P      Record Status
     C                     Z-ADDWN0007    WL0034           Job Time
     C                     MOVELWN0008    WL0035    P      User Id
     C                     MOVELWN0009    WL0036    P      Job Name
     C                     Z-ADDWN0010    WL0037           Job Date
     C                     EXSR SFCRRC
      * Upd ReLoc Qty On-Hand RT - Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0038           Company Number
     C                     Z-ADDWCHGCD    WL0039           Item Code
     C                     MOVELWCAJCD    WL0040    P      Warehouse Code
     C                     Z-ADDWCELDT    WL0041           Production Date
     C                     Z-ADDWDLXNM    WL0042           Lot Number
     C                     MOVELWDYMCD    WL0043    P      Location Code
     C                     Z-ADDWDYNCD    WL0044           Location Level
     C                     Z-ADDWDG5WG    WL0045           ILL Unit Weight
     C                     Z-ADDWDLODT    WL0046           ILL Avail Ship
     C                     Z-ADDWDLPDT    WL0047           ILL Unused Date
     C                     MOVELWDAMSX    WL0048    P      ILL Status
     C                     MOVELWDYSCD    WL0049    P      Inv Hold Reason
     C                     Z-ADDYL0005    WL0050           Quantity Loc Tr
     C                     EXSR SGRVGN
      * Create To Lot/Location
      * Val Location Exists   RT - Warehouse Location  * 
     C                     EXSR SMRVGN
      * Create Warehouse Location if one does not exist.
      * CASE: LCL.Record Found -PS CD USR is Record Not Found
     C           YL0006    IFEQ 'N'                        *IF
     C                     Z-ADD1         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00004
     C           ZQ        ORGT 00004
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWDYMCD:ZQ YL0007    P  90  Location Aisle
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00004
     C           ZQ        ORGT 00004
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWDYMCD:ZQ YL0008    P  90  Location Bay Al
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     MOVE YL0008    YL0009           Location Bay
      * Crt Whs Location      CR - Warehouse Location  * 
     C                     EXSR SNCRRC
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0054  30       LLT Sequence #
     C                     MOVEL*BLANK    WN0055  1        EDI Status 1
     C                     MOVEL*BLANK    WN0056  1        EDI Status 2
     C                     MOVEL*BLANK    WN0057  1        EDI Status 3
     C                     MOVEL*BLANK    WN0058  1        Record Status
     C                     Z-ADD*ZERO     WN0059  60       Job Time
     C                     MOVEL*BLANK    WN0060 10        User Id
     C                     MOVEL*BLANK    WN0061 10        Job Name
     C                     Z-ADD*ZERO     WN0062  70       Job Date
      *
      * Crt Item Lot/Loc Trns IF
      * Rtv Next Seq #        RT - IC Item Lot/Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0004           Company Number
     C                     Z-ADDWCHGCD    WL0005           Item Code
     C                     MOVELYL0004    WL0006    P      Warehouse Code
     C                     MOVEL'RT'      WL0007    P      LLT Trans Type
     C                     Z-ADD##JDT     WL0008           LLT Trans Date
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0009    WN0054           LLT Sequence #
      * Crt Item Lot/Loc Trns CR - Item Lot/Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0010           Company Number
     C                     Z-ADDWCHGCD    WL0011           Item Code
     C                     MOVELYL0004    WL0012    P      Warehouse Code
     C                     MOVEL'RT'      WL0013    P      LLT Trans Type
     C                     Z-ADD##JDT     WL0014           LLT Trans Date
     C                     Z-ADDWN0054    WL0015           LLT Sequence #
     C                     Z-ADDWCELDT    WL0016           LLT Production
     C                     Z-ADDWDJ2QT    WL0017           LLT Trans Qty
     C                     Z-ADD*ZERO     WL0018           LLT Trans Wgt
     C                     Z-ADDWDLXNM    WL0019           LLT Lot Number
     C                     MOVELWDYMCD    WL0020    P      Location Code
     C                     Z-ADDWDYNCD    WL0021           LLT Location Le
     C                     MOVELWCAJCD    WL0022    P      Transfer Wareho
     C                     Z-ADDWDLXNM    WL0023           LLT Transfer Lo
     C                     MOVELWDYMCD    WL0024    P      Transfer Locati
     C                     Z-ADDWDYNCD    WL0025           LLT Transfer Lo
     C                     Z-ADD*ZERO     WL0026           Order Number
     C                     MOVEL'P'       WL0027    P      LLT Status
     C                     MOVELWULLTU    WL0028    P      LTT Unused Sts
     C                     MOVELWULLYT    WL0029    P      LTT Unused Sts
     C                     MOVELWN0055    WL0030    P      EDI Status 1
     C                     MOVELWN0056    WL0031    P      EDI Status 2
     C                     MOVELWN0057    WL0032    P      EDI Status 3
     C                     MOVELWN0058    WL0033    P      Record Status
     C                     Z-ADDWN0059    WL0034           Job Time
     C                     MOVELWN0060    WL0035    P      User Id
     C                     MOVELWN0061    WL0036    P      Job Name
     C                     Z-ADDWN0062    WL0037           Job Date
     C                     EXSR SFCRRC
      * Upd ReLoc Qty On-Hand RT - Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0038           Company Number
     C                     Z-ADDWCHGCD    WL0039           Item Code
     C                     MOVELYL0004    WL0040    P      Warehouse Code
     C                     Z-ADDWCELDT    WL0041           Production Date
     C                     Z-ADDWDLXNM    WL0042           Lot Number
     C                     MOVELWDYMCD    WL0043    P      Location Code
     C                     Z-ADDWDYNCD    WL0044           Location Level
     C                     Z-ADDWDG5WG    WL0045           ILL Unit Weight
     C                     Z-ADDWDLODT    WL0046           ILL Avail Ship
     C                     Z-ADDWDLPDT    WL0047           ILL Unused Date
     C                     MOVELWDAMSX    WL0048    P      ILL Status
     C                     MOVELWDYSCD    WL0049    P      Inv Hold Reason
     C                     Z-ADDWDJ2QT    WL0050           Quantity Loc Tr
     C                     EXSR SGRVGN
     C           KRSSD     READE@L5CPHC                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Next Seq #        RT - IC Item Lot/Loc Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIC3    WQSE01           Company Number
     C           *LIKE     DEFN WEHGCD    WQSE02           Item Code
     C           *LIKE     DEFN WEAJCD    WQSE03           Warehouse Code
     C           *LIKE     DEFN WELTRT    WQSE04           LLT Trans Type
     C           *LIKE     DEFN WELRDT    WQSE05           LLT Trans Date
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WQSE02           Item Code
     C                     KFLD           WQSE03           Warehouse Code
     C                     KFLD           WQSE04           LLT Trans Type
     C                     KFLD           WQSE05           LLT Trans Date
      * Setup key
     C                     Z-ADDWL0004    WQSE01           Company Number
     C                     Z-ADDWL0005    WQSE02           Item Code
     C                     MOVELWL0006    WQSE03           Warehouse Code
     C                     MOVELWL0007    WQSE04           LLT Trans Type
     C                     Z-ADDWL0008    WQSE05           LLT Trans Date
      * Establish starting position
     C           KRSSE     SETLL@L7CPUK                    *
     C           KRSSE     READE@L7CPUK                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2638' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WL0009           LLT Sequence #
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WELLTS    ADD  1         WL0009           LLT Sequence #
     C                     GOTO SEEXIT                     *QUIT
     C           KRSSE     READE@L7CPUK                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCRRC    BEGSR
      *================================================================
      * Crt Item Lot/Loc Trns CR - Item Lot/Loc Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @L7CPS3
     C                     Z-ADDWL0010    WFAIC3           Company Number
     C                     Z-ADDWL0011    WFHGCD           Item Code
     C                     MOVELWL0012    WFAJCD           Warehouse Code
     C                     MOVELWL0013    WFLTRT           LLT Trans Type
     C                     Z-ADDWL0014    WFLRDT           LLT Trans Date
     C                     Z-ADDWL0015    WFLLTS           LLT Sequence #
     C                     Z-ADDWL0016    WFLSDT           LLT Production
     C                     Z-ADDWL0017    WFJ5QT           LLT Trans Qty
     C                     Z-ADDWL0018    WFG8WG           LLT Trans Wgt
     C                     Z-ADDWL0019    WFLLTN           LLT Lot Number
     C                     MOVELWL0020    WFYMCD           Location Code
     C                     Z-ADDWL0021    WFLLCL           LLT Location Le
     C                     MOVELWL0022    WFBNAA           Transfer Wareho
     C                     Z-ADDWL0023    WFLLTR           LLT Transfer Lo
     C                     MOVELWL0024    WFY2CD           Transfer Locati
     C                     Z-ADDWL0025    WFLLTL           LLT Transfer Lo
     C                     Z-ADDWL0026    WFC4NB           Order Number
     C                     MOVELWL0027    WFLOST           LLT Status
     C                     MOVELWL0028    WFLLTU           LTT Unused Sts
     C                     MOVELWL0029    WFLLYT           LTT Unused Sts
     C                     MOVELWL0030    WFUVST           EDI Status 1
     C                     MOVELWL0031    WFUWST           EDI Status 2
     C                     MOVELWL0032    WFUXST           EDI Status 3
     C                     MOVELWL0033    WFVSST           Record Status
     C                     Z-ADDWL0034    WFAATM           Job Time
     C                     MOVELWL0035    WFAYNA           User Id
     C                     MOVELWL0036    WFA0NA           Job Name
     C                     Z-ADDWL0037    WFAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WFVSST           Record Status
     C                     Z-ADD##JTM     WFAATM           Job Time
     C                     MOVEL##USR     WFAYNA           User Id
     C                     MOVEL##JOB     WFA0NA           Job Name
     C                     Z-ADD##JDT     WFAXDT           Job Date
     C           KLCRSF    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFHGCD           Item Code
     C                     KFLD           WFAJCD           Warehouse Code
     C                     KFLD           WFLTRT           LLT Trans Type
     C                     KFLD           WFLRDT           LLT Trans Date
     C                     KFLD           WFLLTS           LLT Sequence #
      * Check for duplicate primary key
     C           KLCRSF    SETLL@L7CPS3                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2639' W0RTN   7
      * Send message 'Item Lot Loc Trans     EX'
     C                     MOVEL'USR2639' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C                     WRITE@L7CPS3                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Upd ReLoc Qty On-Hand RT - Item Lot Location  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0011  50       ILL Item Qty On
     C                     Z-ADD*ZERO     WN0012  50       ILL Co-Packer L
     C                     Z-ADD*ZERO     WN0013 112       ILl Item Wgt On
     C                     Z-ADD*ZERO     WN0014  50       ILL Unused Qty
     C                     Z-ADD*ZERO     WN0015 112       ILL Unused Wgt
     C                     Z-ADD*ZERO     WN0016  70       ILL Unused Date
     C                     Z-ADD*ZERO     WN0017  72       ILL Unused Nbr
     C                     MOVEL*BLANK    WN0018  6        ILL Customer Co
     C                     MOVEL*BLANK    WN0019  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0020  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0021  2        ILL Unused Sts
     C                     MOVEL*BLANK    WN0022  1        EDI Status 1
     C                     MOVEL*BLANK    WN0023  1        EDI Status 2
     C                     MOVEL*BLANK    WN0024  1        EDI Status 3
     C                     MOVEL*BLANK    WN0025  1        Record Status
     C                     Z-ADD*ZERO     WN0026  60       Job Time
     C                     MOVEL*BLANK    WN0027 10        User Id
     C                     MOVEL*BLANK    WN0028 10        Job Name
     C                     Z-ADD*ZERO     WN0029  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGHGCD           Item Code
     C                     KFLD           WGAJCD           Warehouse Code
     C                     KFLD           WGELDT           Production Date
     C                     KFLD           WGLXNM           Lot Number
     C                     KFLD           WGYMCD           Location Code
     C                     KFLD           WGYNCD           Location Level
      * Setup key
     C                     Z-ADDWL0038    WGAIC3           Company Number
     C                     Z-ADDWL0039    WGHGCD           Item Code
     C                     MOVELWL0040    WGAJCD           Warehouse Code
     C                     Z-ADDWL0041    WGELDT           Production Date
     C                     Z-ADDWL0042    WGLXNM           Lot Number
     C                     MOVELWL0043    WGYMCD           Location Code
     C                     Z-ADDWL0044    WGYNCD           Location Level
      * Establish starting position
     C           KRSSG     CHAIN@L5CPSV              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2634' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Item Loc          CR - Item Lot Location  * 
     C                     EXSR SHCRRC
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WGJ2QT    ADD  WL0050    WN0011           ILL Item Qty On
      * CASE: PAR.ILL Item Qty On-Hand is GT Zero
     C           WN0011    IFGT *ZERO                      *IF
      * Chg Quantity On-Hand  CH - Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWGAIC3    WL0051           Company Number
     C                     Z-ADDWGHGCD    WL0052           Item Code
     C                     MOVELWGAJCD    WL0053    P      Warehouse Code
     C                     Z-ADDWGELDT    WL0054           Production Date
     C                     Z-ADDWGLXNM    WL0055           Lot Number
     C                     MOVELWGYMCD    WL0056    P      Location Code
     C                     Z-ADDWGYNCD    WL0057           Location Level
     C                     Z-ADDWN0011    WL0058           ILL Item Qty On
     C                     EXSR SICHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Del Item Location     DL - IC Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWGAIC3    WL0059           Company Number
     C                     Z-ADDWGHGCD    WL0060           Item Code
     C                     MOVELWGAJCD    WL0061    P      Warehouse Code
     C                     Z-ADDWGELDT    WL0062           Production Date
     C                     Z-ADDWGLXNM    WL0063           Lot Number
     C                     MOVELWGYMCD    WL0064    P      Location Code
     C                     Z-ADDWGYNCD    WL0065           Location Level
     C                     EXSR SJDLRC
      * Del Item Balance Dtl  RT - IC Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWGAIC3    WL0066           Company Number
     C                     Z-ADDWGHGCD    WL0067           Item Code
     C                     MOVELWGAJCD    WL0068    P      Warehouse Code
     C                     Z-ADDWGELDT    WL0069           Production Date
     C                     EXSR SKRVGN
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCRRC    BEGSR
      *================================================================
      * Crt Item Loc          CR - Item Lot Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @L5CPSL
     C                     Z-ADDWL0038    WHAIC3           Company Number
     C                     Z-ADDWL0039    WHHGCD           Item Code
     C                     MOVELWL0040    WHAJCD           Warehouse Code
     C                     Z-ADDWL0041    WHELDT           Production Date
     C                     Z-ADDWL0042    WHLXNM           Lot Number
     C                     MOVELWL0043    WHYMCD           Location Code
     C                     Z-ADDWL0044    WHYNCD           Location Level
     C                     Z-ADDWL0050    WHJ2QT           ILL Item Qty On
     C                     Z-ADDWL0045    WHG5WG           ILL Unit Weight
     C                     Z-ADDWN0012    WHJ3QT           ILL Co-Packer L
     C                     Z-ADDWN0013    WHG6WG           ILl Item Wgt On
     C                     Z-ADDWN0014    WHJ4QT           ILL Unused Qty
     C                     Z-ADDWN0015    WHG7WG           ILL Unused Wgt
     C                     Z-ADDWL0046    WHLODT           ILL Avail Ship
     C                     Z-ADDWL0047    WHLPDT           ILL Unused Date
     C                     Z-ADDWN0016    WHLQDT           ILL Unused Date
     C                     Z-ADDWN0017    WHNBR            ILL Unused Nbr
     C                     MOVELWN0018    WHYTCD           ILL Customer Co
     C                     MOVELWL0048    WHAMSX           ILL Status
     C                     MOVELWN0019    WHASSX           ILL Unused Sts
     C                     MOVELWN0020    WHATSX           ILL Unused Sts
     C                     MOVELWN0021    WHAUSX           ILL Unused Sts
     C                     MOVELWL0049    WHYSCD           Inv Hold Reason
     C                     MOVELWN0022    WHUVST           EDI Status 1
     C                     MOVELWN0023    WHUWST           EDI Status 2
     C                     MOVELWN0024    WHUXST           EDI Status 3
     C                     MOVELWN0025    WHVSST           Record Status
     C                     Z-ADDWN0026    WHAATM           Job Time
     C                     MOVELWN0027    WHAYNA           User Id
     C                     MOVELWN0028    WHA0NA           Job Name
     C                     Z-ADDWN0029    WHAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WHVSST           Record Status
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##JOB     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
     C           KLCRSH    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHHGCD           Item Code
     C                     KFLD           WHAJCD           Warehouse Code
     C                     KFLD           WHELDT           Production Date
     C                     KFLD           WHLXNM           Lot Number
     C                     KFLD           WHYMCD           Location Code
     C                     KFLD           WHYNCD           Location Level
      * Check for duplicate primary key
     C           KLCRSH    SETLL@L5CPSL                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2635' W0RTN   7
      * Send message 'Item Lot Location      EX'
     C                     MOVEL'USR2635' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C                     WRITE@L5CPSL                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICHRC    BEGSR
      *================================================================
      * Chg Quantity On-Hand  CH - Item Lot Location  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0030 112       ILL Unit Weight
     C                     Z-ADD*ZERO     WN0031  50       ILL Co-Packer L
     C                     Z-ADD*ZERO     WN0032 112       ILl Item Wgt On
     C                     Z-ADD*ZERO     WN0033  50       ILL Unused Qty
     C                     Z-ADD*ZERO     WN0034 112       ILL Unused Wgt
     C                     Z-ADD*ZERO     WN0035  70       ILL Avail Ship
     C                     Z-ADD*ZERO     WN0036  70       ILL Unused Date
     C                     Z-ADD*ZERO     WN0037  70       ILL Unused Date
     C                     Z-ADD*ZERO     WN0038  72       ILL Unused Nbr
     C                     MOVEL*BLANK    WN0039  6        ILL Customer Co
     C                     MOVEL*BLANK    WN0040  1        ILL Status
     C                     MOVEL*BLANK    WN0041  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0042  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0043  2        ILL Unused Sts
     C                     MOVEL*BLANK    WN0044  3        Inv Hold Reason
     C                     MOVEL*BLANK    WN0045  1        EDI Status 1
     C                     MOVEL*BLANK    WN0046  1        EDI Status 2
     C                     MOVEL*BLANK    WN0047  1        EDI Status 3
     C                     MOVEL*BLANK    WN0048  1        Record Status
     C                     Z-ADD*ZERO     WN0049  60       Job Time
     C                     MOVEL*BLANK    WN0050 10        User Id
     C                     MOVEL*BLANK    WN0051 10        Job Name
     C                     Z-ADD*ZERO     WN0052  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @L5CPSL
     C                     Z-ADDWL0051    WHAIC3           Company Number
     C                     Z-ADDWL0052    WHHGCD           Item Code
     C                     MOVELWL0053    WHAJCD    P      Warehouse Code
     C                     Z-ADDWL0054    WHELDT           Production Date
     C                     Z-ADDWL0055    WHLXNM           Lot Number
     C                     MOVELWL0056    WHYMCD    P      Location Code
     C                     Z-ADDWL0057    WHYNCD           Location Level
      *
     C           KLCHSI    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHHGCD           Item Code
     C                     KFLD           WHAJCD           Warehouse Code
     C                     KFLD           WHELDT           Production Date
     C                     KFLD           WHLXNM           Lot Number
     C                     KFLD           WHYMCD           Location Code
     C                     KFLD           WHYNCD           Location Level
     C           KLCHSI    CHAIN@L5CPSL              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDL5CPL0'MDACP
     C                     MOVEL'@L5CPSL' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDL51    YARDCS
      * Move non-key fields to @L5CPSL
     C                     Z-ADDWL0058    WHJ2QT           ILL Item Qty On
      *
      * Set PGM.*Record Data Changed flag
     C           QPDL51    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##JOB     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDL51    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@L5CPSL                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDL5CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJDLRC    BEGSR
      *================================================================
      * Del Item Location     DL - IC Item Lot Location  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0053  50       ILL Item Qty On
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @L5CPSL
     C                     Z-ADDWL0059    WHAIC3           Company Number
     C                     Z-ADDWL0060    WHHGCD           Item Code
     C                     MOVELWL0061    WHAJCD           Warehouse Code
     C                     Z-ADDWL0062    WHELDT           Production Date
     C                     Z-ADDWL0063    WHLXNM           Lot Number
     C                     MOVELWL0064    WHYMCD           Location Code
     C                     Z-ADDWL0065    WHYNCD           Location Level
      *
     C           KLDLSJ    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHHGCD           Item Code
     C                     KFLD           WHAJCD           Warehouse Code
     C                     KFLD           WHELDT           Production Date
     C                     KFLD           WHLXNM           Lot Number
     C                     KFLD           WHYMCD           Location Code
     C                     KFLD           WHYNCD           Location Level
     C           KLDLSJ    CHAIN@L5CPSL              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDL5CPL0'MDACP
     C                     MOVEL'@L5CPSL' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@L5CPSL                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Del Item Balance Dtl  RT - IC Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIHGCD           Item Code
     C                     KFLD           WIAJCD           Warehouse Code
     C                     KFLD           WIELDT           Production Date
      * Setup key
     C                     Z-ADDWL0066    WIAIC3           Company Number
     C                     Z-ADDWL0067    WIHGCD           Item Code
     C                     MOVELWL0068    WIAJCD           Warehouse Code
     C                     Z-ADDWL0069    WIELDT           Production Date
      * Establish starting position
     C           KRSSK     CHAIN@B1REJ0              90    *
      * Data record not found
     C   90                MOVEL'USR0330' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Quantity on Hand - U/M1 is Equal to zero
     C           WIARQT    IFEQ *ZERO                      *IF
      * Del Item Balance Dtl  DL - IC Item Balance Detail  * 
     C                     EXSR SLDLRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLDLRC    BEGSR
      *================================================================
      * Del Item Balance Dtl  DL - IC Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B1REJ1
     C                     Z-ADDWIAIC3    WJAIC3           Company Number
     C                     Z-ADDWIHGCD    WJHGCD           Item Code
     C                     MOVELWIAJCD    WJAJCD           Warehouse Code
     C                     Z-ADDWIELDT    WJELDT           Production Date
      *
     C           KLDLSL    KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJHGCD           Item Code
     C                     KFLD           WJAJCD           Warehouse Code
     C                     KFLD           WJELDT           Production Date
     C           KLDLSL    CHAIN@B1REJ1              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB1REL1'MDACP
     C                     MOVEL'@B1REJ1' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B1REJ1                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Val Location Exists   RT - Warehouse Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WKAJCD           Warehouse Code
     C                     KFLD           WKYMCD           Location Code
      * Setup key
     C                     MOVELYL0004    WKAJCD           Warehouse Code
     C                     MOVELWDYMCD    WKYMCD           Location Code
      * Establish starting position
     C           KRSSM     CHAIN@L2RESM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2628' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       YL0006           Record Found -P
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y'       YL0006           Record Found -P
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNCRRC    BEGSR
      *================================================================
      * Crt Whs Location      CR - Warehouse Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @L2RESN
     C                     MOVELYL0004    WLAJCD           Warehouse Code
     C                     MOVELWDYMCD    WLYMCD           Location Code
     C                     MOVELYL0007    WLYPCD           Location Aisle
     C                     Z-ADDYL0009    WLLCBY           Location Bay
     C                     Z-ADD*ZERO     WLLCCT           Loc Unused Chil
     C                     MOVELWUWLUS    WLWLUS           WL Unused Sts 1
     C                     MOVELWUWUSD    WLWUSD           WL Unused Sts 2
     C                     MOVELWUWLUN    WLWLUN           WL PFS Zone
     C                     MOVEL'F'       WLAGSX           WLT Type Code
     C                     MOVELWUUVST    WLUVST           EDI Status 1
     C                     MOVELWUUWST    WLUWST           EDI Status 2
     C                     MOVELWUUXST    WLUXST           EDI Status 3
     C                     MOVELWUVSST    WLVSST           Record Status
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     MOVEL*BLANK    WLAYNA           User Id
     C                     MOVEL*BLANK    WLA0NA           Job Name
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WLVSST           Record Status
     C                     Z-ADD##JTM     WLAATM           Job Time
     C                     MOVEL##USR     WLAYNA           User Id
     C                     MOVEL##JOB     WLA0NA           Job Name
     C                     Z-ADD##JDT     WLAXDT           Job Date
     C           KLCRSN    KLIST
     C                     KFLD           WLAJCD           Warehouse Code
     C                     KFLD           WLYMCD           Location Code
      * Check for duplicate primary key
     C           KLCRSN    SETLL@L2RESN                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2629' W0RTN   7
      * Send message 'Warehouse Location     EX'
     C                     MOVEL'USR2629' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C                     WRITE@L2RESN                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WANLNB           Entity Number
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCELDT           Production Date
     C                     Z-ADD*ZERO     WCABWG           Physical Count
     C                     Z-ADD*ZERO     WCAGQT           Physical Count
     C                     Z-ADD*ZERO     WCAHQT           Physical Count
     C                     Z-ADD*ZERO     WCAIQT           Physical Count
     C                     Z-ADD*ZERO     WCACWG           Quantity on Han
     C                     Z-ADD*ZERO     WCARQT           Quantity on Han
     C                     Z-ADD*ZERO     WCASQT           Quantity on Han
     C                     Z-ADD*ZERO     WCATQT           Quantity on Han
     C                     Z-ADD*ZERO     WCHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WCHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WCBMWG           Physical Start
     C                     Z-ADD*ZERO     WCDSQT           Physical Start
     C                     Z-ADD*ZERO     WCDTQT           Physical Start
     C                     Z-ADD*ZERO     WCDUQT           Physical Start
     C                     Z-ADD*ZERO     WCDHDT           Physical Start
     C                     Z-ADD*ZERO     WCAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WCAECS           Last Cost
     C                     Z-ADD*ZERO     WCIDVA           Value of On Han
     C                     Z-ADD*ZERO     WCK7DT           Label Date
     C                     Z-ADD*ZERO     WCRINB           Item Structure
     C                     Z-ADD*ZERO     WCRHNB           Item Structure
     C                     Z-ADD*ZERO     WCRGNB           Item Structure
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDHGCD           Item Code
     C                     Z-ADD*ZERO     WDELDT           Production Date
     C                     Z-ADD*ZERO     WDLXNM           Lot Number
     C                     Z-ADD*ZERO     WDYNCD           Location Level
     C                     Z-ADD*ZERO     WDJ2QT           ILL Item Qty On
     C                     Z-ADD*ZERO     WDG5WG           ILL Unit Weight
     C                     Z-ADD*ZERO     WDJ3QT           ILL Co-Packer L
     C                     Z-ADD*ZERO     WDG6WG           ILl Item Wgt On
     C                     Z-ADD*ZERO     WDJ4QT           ILL Unused Qty
     C                     Z-ADD*ZERO     WDG7WG           ILL Unused Wgt
     C                     Z-ADD*ZERO     WDLODT           ILL Avail Ship
     C                     Z-ADD*ZERO     WDLPDT           ILL Unused Date
     C                     Z-ADD*ZERO     WDLQDT           ILL Unused Date
     C                     Z-ADD*ZERO     WDNBR            ILL Unused Nbr
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field LTT Unused Sts 1
     C                     MOVEL*BLANK    WULLTU  1
      * Define work field LTT Unused Sts 2
     C                     MOVEL*BLANK    WULLYT  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEHGCD           Item Code
     C                     Z-ADD*ZERO     WELRDT           LLT Trans Date
     C                     Z-ADD*ZERO     WELLTS           LLT Sequence #
     C                     Z-ADD*ZERO     WELSDT           LLT Production
     C                     Z-ADD*ZERO     WEJ5QT           LLT Trans Qty
     C                     Z-ADD*ZERO     WEG8WG           LLT Trans Wgt
     C                     Z-ADD*ZERO     WELLTN           LLT Lot Number
     C                     Z-ADD*ZERO     WELLCL           LLT Location Le
     C                     Z-ADD*ZERO     WELLTR           LLT Transfer Lo
     C                     Z-ADD*ZERO     WELLTL           LLT Transfer Lo
     C                     Z-ADD*ZERO     WEC4NB           Order Number
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKLCBY           Location Bay
     C                     Z-ADD*ZERO     WKLCCT           Loc Unused Chil
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Define work field WL Unused Sts 1
     C                     MOVEL*BLANK    WUWLUS  1
      * Define work field WL Unused Sts 2
     C                     MOVEL*BLANK    WUWUSD  1
      * Define work field WL PFS Zone
     C                     MOVEL*BLANK    WUWLUN  2
      * Define work field EDI Status 1
     C                     MOVEL*BLANK    WUUVST  1
      * Define work field EDI Status 2
     C                     MOVEL*BLANK    WUUWST  1
      * Define work field EDI Status 3
     C                     MOVEL*BLANK    WUUXST  1
      * Define work field Record Status
     C                     MOVEL*BLANK    WUVSST  1
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SBRVGN.
     C                     MOVEL*BLANK    WL0001 10
     C                     MOVEL*BLANK    WL0002  6
     C                     Z-ADD*ZERO     WL0003  30
      * Define local variables for subroutine SERVGN.
     C                     Z-ADD*ZERO     WL0004  30
     C                     Z-ADD*ZERO     WL0005  70
     C                     MOVEL*BLANK    WL0006  3
     C                     MOVEL*BLANK    WL0007  2
     C                     Z-ADD*ZERO     WL0008  70
     C                     Z-ADD*ZERO     WL0009  30
      * Define local variables for subroutine SFCRRC.
     C                     Z-ADD*ZERO     WL0010  30
     C                     Z-ADD*ZERO     WL0011  70
     C                     MOVEL*BLANK    WL0012  3
     C                     MOVEL*BLANK    WL0013  2
     C                     Z-ADD*ZERO     WL0014  70
     C                     Z-ADD*ZERO     WL0015  30
     C                     Z-ADD*ZERO     WL0016  70
     C                     Z-ADD*ZERO     WL0017  50
     C                     Z-ADD*ZERO     WL0018 112
     C                     Z-ADD*ZERO     WL0019  50
     C                     MOVEL*BLANK    WL0020  4
     C                     Z-ADD*ZERO     WL0021  20
     C                     MOVEL*BLANK    WL0022  3
     C                     Z-ADD*ZERO     WL0023  50
     C                     MOVEL*BLANK    WL0024  4
     C                     Z-ADD*ZERO     WL0025  20
     C                     Z-ADD*ZERO     WL0026  70
     C                     MOVEL*BLANK    WL0027  1
     C                     MOVEL*BLANK    WL0028  1
     C                     MOVEL*BLANK    WL0029  1
     C                     MOVEL*BLANK    WL0030  1
     C                     MOVEL*BLANK    WL0031  1
     C                     MOVEL*BLANK    WL0032  1
     C                     MOVEL*BLANK    WL0033  1
     C                     Z-ADD*ZERO     WL0034  60
     C                     MOVEL*BLANK    WL0035 10
     C                     MOVEL*BLANK    WL0036 10
     C                     Z-ADD*ZERO     WL0037  70
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0038  30
     C                     Z-ADD*ZERO     WL0039  70
     C                     MOVEL*BLANK    WL0040  3
     C                     Z-ADD*ZERO     WL0041  70
     C                     Z-ADD*ZERO     WL0042  50
     C                     MOVEL*BLANK    WL0043  4
     C                     Z-ADD*ZERO     WL0044  20
     C                     Z-ADD*ZERO     WL0045 112
     C                     Z-ADD*ZERO     WL0046  70
     C                     Z-ADD*ZERO     WL0047  70
     C                     MOVEL*BLANK    WL0048  1
     C                     MOVEL*BLANK    WL0049  3
     C                     Z-ADD*ZERO     WL0050  70
      * Define local variables for subroutine SICHRC.
     C                     Z-ADD*ZERO     WL0051  30
     C                     Z-ADD*ZERO     WL0052  70
     C                     MOVEL*BLANK    WL0053  3
     C                     Z-ADD*ZERO     WL0054  70
     C                     Z-ADD*ZERO     WL0055  50
     C                     MOVEL*BLANK    WL0056  4
     C                     Z-ADD*ZERO     WL0057  20
     C                     Z-ADD*ZERO     WL0058  50
      * Define local variables for subroutine SJDLRC.
     C                     Z-ADD*ZERO     WL0059  30
     C                     Z-ADD*ZERO     WL0060  70
     C                     MOVEL*BLANK    WL0061  3
     C                     Z-ADD*ZERO     WL0062  70
     C                     Z-ADD*ZERO     WL0063  50
     C                     MOVEL*BLANK    WL0064  4
     C                     Z-ADD*ZERO     WL0065  20
      * Define local variables for subroutine SKRVGN.
     C                     Z-ADD*ZERO     WL0066  30
     C                     Z-ADD*ZERO     WL0067  70
     C                     MOVEL*BLANK    WL0068  3
     C                     Z-ADD*ZERO     WL0069  70
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0001  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0002  3
      * Define local work field Label Date  USR
     C                     Z-ADD*ZERO     YL0003  70
      * Define local work field To Warehouse Code  USR
     C                     MOVEL*BLANK    YL0004  3
      * Define local work field Quantity Loc Trans USR
     C                     Z-ADD*ZERO     YL0005  70
      * Define local work field Record Found -PS CD USR
     C                     MOVEL*BLANK    YL0006  1
      * Define local work field Location Aisle
     C                     MOVEL*BLANK    YL0007  2
      * Define local work field Location Bay Alpha
     C                     MOVEL*BLANK    YL0008  2
      * Define local work field Location Bay
     C                     Z-ADD*ZERO     YL0009  20
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Transfer Warehouse-System
