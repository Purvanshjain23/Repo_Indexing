     H/TITLE Clc MTO Item Costs    XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by  : 2E  Version:  1181
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model         lopment-
     H* System        : OMS Development Model
     H* User name     : ISSMASO
     H* Date          : 03/17/08  Time  : 16:32:35
     H* Copyright     : OMS Development Model         lopment-
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCABZRELSIF  E           K        DISK
      * RSQ : Company Item              Co/RMCde/ItmCde
      *
     FPOAXCPL2IF  E           K        DISK
      * RSQ : Item Standard Cost        Co/Itm/Dte(d)
      *
     FOMHSTPM9IF  E           K        DISK
      * RSQ : Sales History             Co/ShpItm/ShpDte
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FOMF0CPL2IF  E           K        DISK
      * RSQ : Commodity Mrkt Price      Market Date Descending
      *
     FOMHSTPL0UF  E           K        DISK
      * UPD : Sales History             Update index
      *
     I@BZREHM
      * Company Item              Co/RMCde/ItmCde
      * Renamed input format fields
     I              BZAIC3                          WAAIC3
     I              BZHGCD                          WAHGCD
     I              BZAVNA                          WAAVNA
     I              BZAWNA                          WAAWNA
     I              BZL7NA                          WAL7NA
     I              BZL8NA                          WAL8NA
     I              BZL6NA                          WAL6NA
     I              BZMFNA                          WAMFNA
     I              BZADCD                          WAADCD
     I              BZAWPC                          WAAWPC
     I              BZLXST                          WALXST
     I              BZAECD                          WAAECD
     I              BZAXPC                          WAAXPC
     I              BZLYST                          WALYST
     I              BZAFCD                          WAAFCD
     I              BZAICD                          WAAICD
     I              BZAIWG                          WAAIWG
     I              BZHICD                          WAHICD
     I              BZRBCD                          WARBCD
     I              BZFZST                          WAFZST
     I              BZAVST                          WAAVST
     I              BZCZWG                          WACZWG
     I              BZC0WG                          WAC0WG
     I              BZURTN                          WAURTN
     I              BZAJC8                          WAAJC8
     I              BZRINB                          WARINB
     I              BZRHNB                          WARHNB
     I              BZRGNB                          WARGNB
     I              BZLNCD                          WALNCD
     I              BZTFNB                          WATFNB
     I              BZN0CD                          WAN0CD
     I              BZX4ST                          WAX4ST
     I              BZTMVA                          WATMVA
     I              BZTNVA                          WATNVA
     I              BZBLPR                          WABLPR
     I              BZBMPR                          WABMPR
     I              BZLRCD                          WALRCD
     I              BZU9ST                          WAU9ST
     I              BZCMCO                          WACMCO
     I              BZQ1CD                          WAQ1CD
     I              BZQ8CD                          WAQ8CD
     I              BZCHTM                          WACHTM
     I              BZQZCD                          WAQZCD
     I              BZXWST                          WAXWST
     I              BZXXST                          WAXXST
     I              BZVMST                          WAVMST
     I              BZSWGH                          WASWGH
     I              BZPPHE                          WAPPHE
     I              BZR3CD                          WAR3CD
     I              BZSDCD                          WASDCD
     I              BZICN1                          WAICN1
     I              BZSVCD                          WASVCD
     I              BZICN2                          WAICN2
     I              BZSWCD                          WASWCD
     I              BZV2NB                          WAV2NB
     I              BZSXCD                          WASXCD
     I              BZITCN                          WAITCN
     I              BZSYCD                          WASYCD
     I              BZITC5                          WAITC5
     I              BZSZCD                          WASZCD
     I              BZICN6                          WAICN6
     I              BZS0CD                          WAS0CD
     I              BZICN7                          WAICN7
     I              BZS1CD                          WAS1CD
     I              BZICN8                          WAICN8
     I              BZS2CD                          WAS2CD
     I              BZICN9                          WAICN9
     I              BZS3CD                          WAS3CD
     I              BZICN0                          WAICN0
     I              BZS4CD                          WAS4CD
     I              BZSFNB                          WASFNB
     I              BZA3WG                          WAA3WG
     I              BZSJNB                          WASJNB
     I              BZLLCD                          WALLCD
     I              BZLMCD                          WALMCD
     I              BZP3ST                          WAP3ST
     I              BZSKNB                          WASKNB
     I              BZSLNB                          WASLNB
     I              BZSMNB                          WASMNB
     I              BZP4ST                          WAP4ST
     I              BZCFNB                          WACFNB
     I              BZCGNB                          WACGNB
     I              BZILNB                          WAILNB
     I              BZCHNB                          WACHNB
     I              BZCINB                          WACINB
     I              BZCJNB                          WACJNB
     I              BZCMNB                          WACMNB
     I              BZCNNB                          WACNNB
     I              BZCRNB                          WACRNB
     I              BZCSNB                          WACSNB
     I              BZCVNB                          WACVNB
     I              BZCWNB                          WACWNB
     I              BZCXNB                          WACXNB
     I              BZCZNB                          WACZNB
     I              BZC0NB                          WAC0NB
     I              BZN1CD                          WAN1CD
     I              BZB4NB                          WAB4NB
     I              BZB5NB                          WAB5NB
     I              BZX5ST                          WAX5ST
     I              BZX6ST                          WAX6ST
     I              BZX7ST                          WAX7ST
     I              BZPCCT                          WAPCCT
     I              BZBDNB                          WABDNB
     I              BZBJNB                          WABJNB
     I              BZSUST                          WASUST
     I              BZSVST                          WASVST
     I              BZSYST                          WASYST
     I              BZSZST                          WASZST
     I              BZS1ST                          WAS1ST
     I              BZXRCD                          WAXRCD
     I              BZXTCD                          WAXTCD
     I              BZXUCD                          WAXUCD
     I              BZF5WG                          WAF5WG
     I              BZF6WG                          WAF6WG
     I              BZF7WG                          WAF7WG
     I              BZBLNB                          WABLNB
     I              BZBNNB                          WABNNB
     I              BZS2ST                          WAS2ST
     I              BZS4ST                          WAS4ST
     I              BZS5ST                          WAS5ST
     I              BZS6ST                          WAS6ST
     I              BZS8ST                          WAS8ST
     I              BZS9ST                          WAS9ST
     I              BZTCST                          WATCST
     I              BZTDST                          WATDST
     I              BZUVST                          WAUVST
     I              BZUWST                          WAUWST
     I              BZUXST                          WAUXST
     I              BZVSST                          WAVSST
     I              BZAATM                          WAAATM
     I              BZAYNA                          WAAYNA
     I              BZA0NA                          WAA0NA
     I              BZAXDT                          WAAXDT
      *
     I@AXCPHJ
      * Item Standard Cost        Co/Itm/Dte(d)
      * Renamed input format fields
     I              AXAIC3                          WBAIC3
     I              AXHGCD                          WBHGCD
     I              AXAUDT                          WBAUDT
     I              AXFCPC                          WBFCPC
     I              AXGEPC                          WBGEPC
     I              AXEDPR                          WBEDPR
     I              AXEGPR                          WBEGPR
     I              AXEEPR                          WBEEPR
     I              AXEFPR                          WBEFPR
     I              AXFRPR                          WBFRPR
     I              AXFSPR                          WBFSPR
     I              AXFTPR                          WBFTPR
     I              AXFUPR                          WBFUPR
     I              AXFVPR                          WBFVPR
     I              AXFWPR                          WBFWPR
     I              AXUVST                          WBUVST
     I              AXUWST                          WBUWST
     I              AXUXST                          WBUXST
     I              AXVSST                          WBVSST
     I              AXAATM                          WBAATM
     I              AXAYNA                          WBAYNA
     I              AXA0NA                          WBA0NA
     I              AXAXDT                          WBAXDT
      *
     I@HSTPC9
      * Sales History             Co/ShpItm/ShpDte
      * Renamed input format fields
     I              F4AIC3                          WCAIC3
     I              F4C4NB                          WCC4NB
     I              F4DPNB                          WCDPNB
     I              F4UENB                          WCUENB
     I              F4MONA                          WCMONA
     I              F4RJCD                          WCRJCD
     I              F4RKCD                          WCRKCD
     I              F4GPTX                          WCGPTX
     I              F4ABTX                          WCABTX
     I              F4KXCD                          WCKXCD
     I              F4BOCD                          WCBOCD
     I              F4BTC7                          WCBTC7
     I              F4ANC7                          WCANC7
     I              F4AQTX                          WCAQTX
     I              F4BKC7                          WCBKC7
     I              F4BRTX                          WCBRTX
     I              F4HNNA                          WCHNNA
     I              F4DBCD                          WCDBCD
     I              F4CKTX                          WCCKTX
     I              F4BCNA                          WCBCNA
     I              F4A0DT                          WCA0DT
     I              F4ACDT                          WCACDT
     I              F4R4CD                          WCR4CD
     I              F4R5CD                          WCR5CD
     I              F4BFCD                          WCBFCD
     I              F4Q4CD                          WCQ4CD
     I              F4AQCD                          WCAQCD
     I              F4TBNB                          WCTBNB
     I              F4BZNA                          WCBZNA
     I              F4RLCD                          WCRLCD
     I              F4JNCD                          WCJNCD
     I              F4Q2CD                          WCQ2CD
     I              F4U2ST                          WCU2ST
     I              F4ATIN                          WCATIN
     I              F4T3NB                          WCT3NB
     I              F4RSRN                          WCRSRN
     I              F4ORIT                          WCORIT
     I              F4AJCD                          WCAJCD
     I              F4AVQT                          WCAVQT
     I              F4D0WG                          WCD0WG
     I              F4CCQT                          WCCCQT
     I              F4AUWG                          WCAUWG
     I              F4AGCD                          WCAGCD
     I              F4AKPR                          WCAKPR
     I              F4AUPR                          WCAUPR
     I              F4CRCD                          WCCRCD
     I              F4A5DT                          WCA5DT
     I              F4AWDT                          WCAWDT
     I              F4HDDT                          WCHDDT
     I              F4AGCS                          WCAGCS
     I              F4AQCS                          WCAQCS
     I              F4AVWG                          WCAVWG
     I              F4AYVA                          WCAYVA
     I              F4AMST                          WCAMST
     I              F4ANST                          WCANST
     I              F4VAST                          WCVAST
     I              F4L6NB                          WCL6NB
     I              F4UMCD                          WCUMCD
     I              F4HCDT                          WCHCDT
     I              F4ESNB                          WCESNB
     I              F4ETNB                          WCETNB
     I              F4BZNB                          WCBZNB
     I              F4EXQT                          WCEXQT
     I              F4BYWG                          WCBYWG
     I              F4S5NB                          WCS5NB
     I              F4MAVA                          WCMAVA
     I              F4KDVA                          WCKDVA
     I              F4USVA                          WCUSVA
     I              F4UTVA                          WCUTVA
     I              F4A4WG                          WCA4WG
     I              F4CKNB                          WCCKNB
     I              F4BMST                          WCBMST
     I              F4R8NB                          WCR8NB
     I              F4RMCD                          WCRMCD
     I              F4BZPR                          WCBZPR
     I              F4RDCD                          WCRDCD
     I              F4Q7CD                          WCQ7CD
     I              F4EXDT                          WCEXDT
     I              F4LQCD                          WCLQCD
     I              F4HICD                          WCHICD
     I              F4RBCD                          WCRBCD
     I              F4RGNB                          WCRGNB
     I              F4RHNB                          WCRHNB
     I              F4RINB                          WCRINB
     I              F4R1NB                          WCR1NB
     I              F4CONB                          WCCONB
     I              F4CEST                          WCCEST
     I              F4GNDT                          WCGNDT
     I              F4RMNB                          WCRMNB
     I              F4AODT                          WCAODT
     I              F4LLCD                          WCLLCD
     I              F4LMCD                          WCLMCD
     I              F4SKNB                          WCSKNB
     I              F4SLNB                          WCSLNB
     I              F4SMNB                          WCSMNB
     I              F4G7NA                          WCG7NA
     I              F4ONVA                          WCONVA
     I              F4N0CD                          WCN0CD
     I              F4B4NB                          WCB4NB
     I              F4B5NB                          WCB5NB
     I              F4N1CD                          WCN1CD
     I              F4GIDT                          WCGIDT
     I              F4Z1ST                          WCZ1ST
     I              F4ULVA                          WCULVA
     I              F4UNVA                          WCUNVA
     I              F4UOVA                          WCUOVA
     I              F4UPVA                          WCUPVA
     I              F4UQVA                          WCUQVA
     I              F4SDCD                          WCSDCD
     I              F4QZCD                          WCQZCD
     I              F4XWST                          WCXWST
     I              F4T9CD                          WCT9CD
     I              F4UBCD                          WCUBCD
     I              F4CFC7                          WCCFC7
     I              F4X1CD                          WCX1CD
     I              F4GASX                          WCGASX
     I              F4DUPR                          WCDUPR
     I              F4B6VL                          WCB6VL
     I              F4IANX                          WCIANX
     I              F4IBNX                          WCIBNX
     I              F4RPCD                          WCRPCD
     I              F4NYDT                          WCNYDT
     I              F4BZTM                          WCBZTM
     I              F4Z4NB                          WCZ4NB
     I              F4XACD                          WCXACD
     I              F4OANA                          WCOANA
     I              F4OKTX                          WCOKTX
     I              F4K4TX                          WCK4TX
     I              F4NBBO                          WCNBBO
     I              F4OCFR                          WCOCFR
     I              F4C0C7                          WCC0C7
     I              F4A1AA                          WCA1AA
     I              F4VEST                          WCVEST
     I              F4A5PR                          WCA5PR
     I              F4CDPR                          WCCDPR
     I              F4D0PR                          WCD0PR
     I              F4D0VL                          WCD0VL
     I              F4IRSX                          WCIRSX
     I              F4CEVL                          WCCEVL
     I              F4ISSX                          WCISSX
     I              F4ITSX                          WCITSX
     I              F4IUSX                          WCIUSX
     I              F4OHDT                          WCOHDT
     I              F4D9PR                          WCD9PR
     I              F4CFVL                          WCCFVL
     I              F4UVST                          WCUVST
     I              F4UWST                          WCUWST
     I              F4UXST                          WCUXST
     I              F4AATM                          WCAATM
     I              F4AYNA                          WCAYNA
     I              F4A0NA                          WCA0NA
     I              F4AXDT                          WCAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WDAIC3
     I              BZHGCD                          WDHGCD
     I              BZAVNA                          WDAVNA
     I              BZAWNA                          WDAWNA
     I              BZL7NA                          WDL7NA
     I              BZL8NA                          WDL8NA
     I              BZL6NA                          WDL6NA
     I              BZMFNA                          WDMFNA
     I              BZADCD                          WDADCD
     I              BZAWPC                          WDAWPC
     I              BZLXST                          WDLXST
     I              BZAECD                          WDAECD
     I              BZAXPC                          WDAXPC
     I              BZLYST                          WDLYST
     I              BZAFCD                          WDAFCD
     I              BZAICD                          WDAICD
     I              BZAIWG                          WDAIWG
     I              BZHICD                          WDHICD
     I              BZRBCD                          WDRBCD
     I              BZFZST                          WDFZST
     I              BZAVST                          WDAVST
     I              BZCZWG                          WDCZWG
     I              BZC0WG                          WDC0WG
     I              BZURTN                          WDURTN
     I              BZAJC8                          WDAJC8
     I              BZRINB                          WDRINB
     I              BZRHNB                          WDRHNB
     I              BZRGNB                          WDRGNB
     I              BZLNCD                          WDLNCD
     I              BZTFNB                          WDTFNB
     I              BZN0CD                          WDN0CD
     I              BZX4ST                          WDX4ST
     I              BZTMVA                          WDTMVA
     I              BZTNVA                          WDTNVA
     I              BZBLPR                          WDBLPR
     I              BZBMPR                          WDBMPR
     I              BZLRCD                          WDLRCD
     I              BZU9ST                          WDU9ST
     I              BZCMCO                          WDCMCO
     I              BZQ1CD                          WDQ1CD
     I              BZQ8CD                          WDQ8CD
     I              BZCHTM                          WDCHTM
     I              BZQZCD                          WDQZCD
     I              BZXWST                          WDXWST
     I              BZXXST                          WDXXST
     I              BZVMST                          WDVMST
     I              BZSWGH                          WDSWGH
     I              BZPPHE                          WDPPHE
     I              BZR3CD                          WDR3CD
     I              BZSDCD                          WDSDCD
     I              BZICN1                          WDICN1
     I              BZSVCD                          WDSVCD
     I              BZICN2                          WDICN2
     I              BZSWCD                          WDSWCD
     I              BZV2NB                          WDV2NB
     I              BZSXCD                          WDSXCD
     I              BZITCN                          WDITCN
     I              BZSYCD                          WDSYCD
     I              BZITC5                          WDITC5
     I              BZSZCD                          WDSZCD
     I              BZICN6                          WDICN6
     I              BZS0CD                          WDS0CD
     I              BZICN7                          WDICN7
     I              BZS1CD                          WDS1CD
     I              BZICN8                          WDICN8
     I              BZS2CD                          WDS2CD
     I              BZICN9                          WDICN9
     I              BZS3CD                          WDS3CD
     I              BZICN0                          WDICN0
     I              BZS4CD                          WDS4CD
     I              BZSFNB                          WDSFNB
     I              BZA3WG                          WDA3WG
     I              BZSJNB                          WDSJNB
     I              BZLLCD                          WDLLCD
     I              BZLMCD                          WDLMCD
     I              BZP3ST                          WDP3ST
     I              BZSKNB                          WDSKNB
     I              BZSLNB                          WDSLNB
     I              BZSMNB                          WDSMNB
     I              BZP4ST                          WDP4ST
     I              BZCFNB                          WDCFNB
     I              BZCGNB                          WDCGNB
     I              BZILNB                          WDILNB
     I              BZCHNB                          WDCHNB
     I              BZCINB                          WDCINB
     I              BZCJNB                          WDCJNB
     I              BZCMNB                          WDCMNB
     I              BZCNNB                          WDCNNB
     I              BZCRNB                          WDCRNB
     I              BZCSNB                          WDCSNB
     I              BZCVNB                          WDCVNB
     I              BZCWNB                          WDCWNB
     I              BZCXNB                          WDCXNB
     I              BZCZNB                          WDCZNB
     I              BZC0NB                          WDC0NB
     I              BZN1CD                          WDN1CD
     I              BZB4NB                          WDB4NB
     I              BZB5NB                          WDB5NB
     I              BZX5ST                          WDX5ST
     I              BZX6ST                          WDX6ST
     I              BZX7ST                          WDX7ST
     I              BZPCCT                          WDPCCT
     I              BZBDNB                          WDBDNB
     I              BZBJNB                          WDBJNB
     I              BZSUST                          WDSUST
     I              BZSVST                          WDSVST
     I              BZSYST                          WDSYST
     I              BZSZST                          WDSZST
     I              BZS1ST                          WDS1ST
     I              BZXRCD                          WDXRCD
     I              BZXTCD                          WDXTCD
     I              BZXUCD                          WDXUCD
     I              BZF5WG                          WDF5WG
     I              BZF6WG                          WDF6WG
     I              BZF7WG                          WDF7WG
     I              BZBLNB                          WDBLNB
     I              BZBNNB                          WDBNNB
     I              BZS2ST                          WDS2ST
     I              BZS4ST                          WDS4ST
     I              BZS5ST                          WDS5ST
     I              BZS6ST                          WDS6ST
     I              BZS8ST                          WDS8ST
     I              BZS9ST                          WDS9ST
     I              BZTCST                          WDTCST
     I              BZTDST                          WDTDST
     I              BZUVST                          WDUVST
     I              BZUWST                          WDUWST
     I              BZUXST                          WDUXST
     I              BZVSST                          WDVSST
     I              BZAATM                          WDAATM
     I              BZAYNA                          WDAYNA
     I              BZA0NA                          WDA0NA
     I              BZAXDT                          WDAXDT
      *
     I@F0CPEP
      * Commodity Mrkt Price      Market Date Descending
      * Renamed input format fields
     I              F0LQCD                          WELQCD
     I              F0LRCD                          WELRCD
     I              F0EQDT                          WEEQDT
     I              F0A5PR                          WEA5PR
     I              F0B8PR                          WEB8PR
     I              F0UVST                          WEUVST
     I              F0UWST                          WEUWST
     I              F0UXST                          WEUXST
     I              F0VSST                          WEVSST
     I              F0AATM                          WEAATM
     I              F0AYNA                          WEAYNA
     I              F0A0NA                          WEA0NA
     I              F0AXDT                          WEAXDT
      *
     I@FHSTD2
      * Sales History             Update index
      * Renamed input format fields
     I              F4AIC3                          WFAIC3
     I              F4C4NB                          WFC4NB
     I              F4DPNB                          WFDPNB
     I              F4UENB                          WFUENB
     I              F4MONA                          WFMONA
     I              F4RJCD                          WFRJCD
     I              F4RKCD                          WFRKCD
     I              F4GPTX                          WFGPTX
     I              F4ABTX                          WFABTX
     I              F4KXCD                          WFKXCD
     I              F4BOCD                          WFBOCD
     I              F4BTC7                          WFBTC7
     I              F4ANC7                          WFANC7
     I              F4AQTX                          WFAQTX
     I              F4BKC7                          WFBKC7
     I              F4BRTX                          WFBRTX
     I              F4HNNA                          WFHNNA
     I              F4DBCD                          WFDBCD
     I              F4CKTX                          WFCKTX
     I              F4BCNA                          WFBCNA
     I              F4A0DT                          WFA0DT
     I              F4ACDT                          WFACDT
     I              F4R4CD                          WFR4CD
     I              F4R5CD                          WFR5CD
     I              F4BFCD                          WFBFCD
     I              F4Q4CD                          WFQ4CD
     I              F4AQCD                          WFAQCD
     I              F4TBNB                          WFTBNB
     I              F4BZNA                          WFBZNA
     I              F4RLCD                          WFRLCD
     I              F4JNCD                          WFJNCD
     I              F4Q2CD                          WFQ2CD
     I              F4U2ST                          WFU2ST
     I              F4ATIN                          WFATIN
     I              F4T3NB                          WFT3NB
     I              F4RSRN                          WFRSRN
     I              F4ORIT                          WFORIT
     I              F4AJCD                          WFAJCD
     I              F4AVQT                          WFAVQT
     I              F4D0WG                          WFD0WG
     I              F4CCQT                          WFCCQT
     I              F4AUWG                          WFAUWG
     I              F4AGCD                          WFAGCD
     I              F4AKPR                          WFAKPR
     I              F4AUPR                          WFAUPR
     I              F4CRCD                          WFCRCD
     I              F4A5DT                          WFA5DT
     I              F4AWDT                          WFAWDT
     I              F4HDDT                          WFHDDT
     I              F4AGCS                          WFAGCS
     I              F4AQCS                          WFAQCS
     I              F4AVWG                          WFAVWG
     I              F4AYVA                          WFAYVA
     I              F4AMST                          WFAMST
     I              F4ANST                          WFANST
     I              F4VAST                          WFVAST
     I              F4L6NB                          WFL6NB
     I              F4UMCD                          WFUMCD
     I              F4HCDT                          WFHCDT
     I              F4ESNB                          WFESNB
     I              F4ETNB                          WFETNB
     I              F4BZNB                          WFBZNB
     I              F4EXQT                          WFEXQT
     I              F4BYWG                          WFBYWG
     I              F4S5NB                          WFS5NB
     I              F4MAVA                          WFMAVA
     I              F4KDVA                          WFKDVA
     I              F4USVA                          WFUSVA
     I              F4UTVA                          WFUTVA
     I              F4A4WG                          WFA4WG
     I              F4CKNB                          WFCKNB
     I              F4BMST                          WFBMST
     I              F4R8NB                          WFR8NB
     I              F4RMCD                          WFRMCD
     I              F4BZPR                          WFBZPR
     I              F4RDCD                          WFRDCD
     I              F4Q7CD                          WFQ7CD
     I              F4EXDT                          WFEXDT
     I              F4LQCD                          WFLQCD
     I              F4HICD                          WFHICD
     I              F4RBCD                          WFRBCD
     I              F4RGNB                          WFRGNB
     I              F4RHNB                          WFRHNB
     I              F4RINB                          WFRINB
     I              F4R1NB                          WFR1NB
     I              F4CONB                          WFCONB
     I              F4CEST                          WFCEST
     I              F4GNDT                          WFGNDT
     I              F4RMNB                          WFRMNB
     I              F4AODT                          WFAODT
     I              F4LLCD                          WFLLCD
     I              F4LMCD                          WFLMCD
     I              F4SKNB                          WFSKNB
     I              F4SLNB                          WFSLNB
     I              F4SMNB                          WFSMNB
     I              F4G7NA                          WFG7NA
     I              F4ONVA                          WFONVA
     I              F4N0CD                          WFN0CD
     I              F4B4NB                          WFB4NB
     I              F4B5NB                          WFB5NB
     I              F4N1CD                          WFN1CD
     I              F4GIDT                          WFGIDT
     I              F4Z1ST                          WFZ1ST
     I              F4ULVA                          WFULVA
     I              F4UNVA                          WFUNVA
     I              F4UOVA                          WFUOVA
     I              F4UPVA                          WFUPVA
     I              F4UQVA                          WFUQVA
     I              F4SDCD                          WFSDCD
     I              F4QZCD                          WFQZCD
     I              F4XWST                          WFXWST
     I              F4T9CD                          WFT9CD
     I              F4UBCD                          WFUBCD
     I              F4CFC7                          WFCFC7
     I              F4X1CD                          WFX1CD
     I              F4GASX                          WFGASX
     I              F4DUPR                          WFDUPR
     I              F4B6VL                          WFB6VL
     I              F4IANX                          WFIANX
     I              F4IBNX                          WFIBNX
     I              F4RPCD                          WFRPCD
     I              F4NYDT                          WFNYDT
     I              F4BZTM                          WFBZTM
     I              F4Z4NB                          WFZ4NB
     I              F4XACD                          WFXACD
     I              F4OANA                          WFOANA
     I              F4OKTX                          WFOKTX
     I              F4K4TX                          WFK4TX
     I              F4NBBO                          WFNBBO
     I              F4OCFR                          WFOCFR
     I              F4C0C7                          WFC0C7
     I              F4A1AA                          WFA1AA
     I              F4VEST                          WFVEST
     I              F4A5PR                          WFA5PR
     I              F4CDPR                          WFCDPR
     I              F4D0PR                          WFD0PR
     I              F4D0VL                          WFD0VL
     I              F4IRSX                          WFIRSX
     I              F4CEVL                          WFCEVL
     I              F4ISSX                          WFISSX
     I              F4ITSX                          WFITSX
     I              F4IUSX                          WFIUSX
     I              F4OHDT                          WFOHDT
     I              F4D9PR                          WFD9PR
     I              F4CFVL                          WFCFVL
     I              F4UVST                          WFUVST
     I              F4UWST                          WFUWST
     I              F4UXST                          WFUXST
     I              F4AATM                          WFAATM
     I              F4AYNA                          WFAYNA
     I              F4A0NA                          WFA0NA
     I              F4AXDT                          WFAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQOMHS1    E DSOMHSTPL0
      * UPD : Sales History             Update index
      * Renamed input format fields
     I              F4AIC3                          WFAIC3
     I              F4C4NB                          WFC4NB
     I              F4DPNB                          WFDPNB
     I              F4UENB                          WFUENB
     I              F4MONA                          WFMONA
     I              F4RJCD                          WFRJCD
     I              F4RKCD                          WFRKCD
     I              F4GPTX                          WFGPTX
     I              F4ABTX                          WFABTX
     I              F4KXCD                          WFKXCD
     I              F4BOCD                          WFBOCD
     I              F4BTC7                          WFBTC7
     I              F4ANC7                          WFANC7
     I              F4AQTX                          WFAQTX
     I              F4BKC7                          WFBKC7
     I              F4BRTX                          WFBRTX
     I              F4HNNA                          WFHNNA
     I              F4DBCD                          WFDBCD
     I              F4CKTX                          WFCKTX
     I              F4BCNA                          WFBCNA
     I              F4A0DT                          WFA0DT
     I              F4ACDT                          WFACDT
     I              F4R4CD                          WFR4CD
     I              F4R5CD                          WFR5CD
     I              F4BFCD                          WFBFCD
     I              F4Q4CD                          WFQ4CD
     I              F4AQCD                          WFAQCD
     I              F4TBNB                          WFTBNB
     I              F4BZNA                          WFBZNA
     I              F4RLCD                          WFRLCD
     I              F4JNCD                          WFJNCD
     I              F4Q2CD                          WFQ2CD
     I              F4U2ST                          WFU2ST
     I              F4ATIN                          WFATIN
     I              F4T3NB                          WFT3NB
     I              F4RSRN                          WFRSRN
     I              F4ORIT                          WFORIT
     I              F4AJCD                          WFAJCD
     I              F4AVQT                          WFAVQT
     I              F4D0WG                          WFD0WG
     I              F4CCQT                          WFCCQT
     I              F4AUWG                          WFAUWG
     I              F4AGCD                          WFAGCD
     I              F4AKPR                          WFAKPR
     I              F4AUPR                          WFAUPR
     I              F4CRCD                          WFCRCD
     I              F4A5DT                          WFA5DT
     I              F4AWDT                          WFAWDT
     I              F4HDDT                          WFHDDT
     I              F4AGCS                          WFAGCS
     I              F4AQCS                          WFAQCS
     I              F4AVWG                          WFAVWG
     I              F4AYVA                          WFAYVA
     I              F4AMST                          WFAMST
     I              F4ANST                          WFANST
     I              F4VAST                          WFVAST
     I              F4L6NB                          WFL6NB
     I              F4UMCD                          WFUMCD
     I              F4HCDT                          WFHCDT
     I              F4ESNB                          WFESNB
     I              F4ETNB                          WFETNB
     I              F4BZNB                          WFBZNB
     I              F4EXQT                          WFEXQT
     I              F4BYWG                          WFBYWG
     I              F4S5NB                          WFS5NB
     I              F4MAVA                          WFMAVA
     I              F4KDVA                          WFKDVA
     I              F4USVA                          WFUSVA
     I              F4UTVA                          WFUTVA
     I              F4A4WG                          WFA4WG
     I              F4CKNB                          WFCKNB
     I              F4BMST                          WFBMST
     I              F4R8NB                          WFR8NB
     I              F4RMCD                          WFRMCD
     I              F4BZPR                          WFBZPR
     I              F4RDCD                          WFRDCD
     I              F4Q7CD                          WFQ7CD
     I              F4EXDT                          WFEXDT
     I              F4LQCD                          WFLQCD
     I              F4HICD                          WFHICD
     I              F4RBCD                          WFRBCD
     I              F4RGNB                          WFRGNB
     I              F4RHNB                          WFRHNB
     I              F4RINB                          WFRINB
     I              F4R1NB                          WFR1NB
     I              F4CONB                          WFCONB
     I              F4CEST                          WFCEST
     I              F4GNDT                          WFGNDT
     I              F4RMNB                          WFRMNB
     I              F4AODT                          WFAODT
     I              F4LLCD                          WFLLCD
     I              F4LMCD                          WFLMCD
     I              F4SKNB                          WFSKNB
     I              F4SLNB                          WFSLNB
     I              F4SMNB                          WFSMNB
     I              F4G7NA                          WFG7NA
     I              F4ONVA                          WFONVA
     I              F4N0CD                          WFN0CD
     I              F4B4NB                          WFB4NB
     I              F4B5NB                          WFB5NB
     I              F4N1CD                          WFN1CD
     I              F4GIDT                          WFGIDT
     I              F4Z1ST                          WFZ1ST
     I              F4ULVA                          WFULVA
     I              F4UNVA                          WFUNVA
     I              F4UOVA                          WFUOVA
     I              F4UPVA                          WFUPVA
     I              F4UQVA                          WFUQVA
     I              F4SDCD                          WFSDCD
     I              F4QZCD                          WFQZCD
     I              F4XWST                          WFXWST
     I              F4T9CD                          WFT9CD
     I              F4UBCD                          WFUBCD
     I              F4CFC7                          WFCFC7
     I              F4X1CD                          WFX1CD
     I              F4GASX                          WFGASX
     I              F4DUPR                          WFDUPR
     I              F4B6VL                          WFB6VL
     I              F4IANX                          WFIANX
     I              F4IBNX                          WFIBNX
     I              F4RPCD                          WFRPCD
     I              F4NYDT                          WFNYDT
     I              F4BZTM                          WFBZTM
     I              F4Z4NB                          WFZ4NB
     I              F4XACD                          WFXACD
     I              F4OANA                          WFOANA
     I              F4OKTX                          WFOKTX
     I              F4K4TX                          WFK4TX
     I              F4NBBO                          WFNBBO
     I              F4OCFR                          WFOCFR
     I              F4C0C7                          WFC0C7
     I              F4A1AA                          WFA1AA
     I              F4VEST                          WFVEST
     I              F4A5PR                          WFA5PR
     I              F4CDPR                          WFCDPR
     I              F4D0PR                          WFD0PR
     I              F4D0VL                          WFD0VL
     I              F4IRSX                          WFIRSX
     I              F4CEVL                          WFCEVL
     I              F4ISSX                          WFISSX
     I              F4ITSX                          WFITSX
     I              F4IUSX                          WFIUSX
     I              F4OHDT                          WFOHDT
     I              F4D9PR                          WFD9PR
     I              F4CFVL                          WFCFVL
     I              F4UVST                          WFUVST
     I              F4UWST                          WFUWST
     I              F4UXST                          WFUXST
     I              F4AATM                          WFAATM
     I              F4AYNA                          WFAYNA
     I              F4A0NA                          WFA0NA
     I              F4AXDT                          WFAXDT
      *
     IYARDCS      DS                            792
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Company Item
      * I :  Company Number
     I                                    P   1   20P1AIC3
     IP2PARM      DS
      * I :  Date Mon USR
     I                                    P   1   40P2JHDT
     IP3PARM      DS
      * I :  Date Sun USR
     I                                    P   1   40P3JNDT
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P2JHDT    PARM           WP0002  70       Date Mon USR
     C           P3JNDT    PARM           WP0003  70       Date Sun USR
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Clc MTO Item Costs    XF
      * Clc MTO Item Costs    RT - Company Item  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Clc MTO Item Costs    RT - Company Item  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0002 114       Raw Material Co
     C                     Z-ADD*ZERO     WN0003  74       Yield
     C                     Z-ADD*ZERO     WN0004  96       Std Packaging C
     C                     Z-ADD*ZERO     WN0005  96       Std Other Cost/
     C                     Z-ADD*ZERO     WN0006  96       Std Inc. Labor
     C                     Z-ADD*ZERO     WN0007  96       Std Ingredient
     C                     Z-ADD*ZERO     WN0008 152       Sale Amount USR
     C                     Z-ADD*ZERO     WN0009 152       Sale Weight USR
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     YL0001           Seaboard Equiva
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSA01           Company Number
      * Establish starting position
     C           KRSSA     SETLL@BZREHM                    *
     C           KRSSA     READE@BZREHM                  90*
      * Data record not found
     C   90                MOVEL'USR0326' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * 100306 slm at this time we are recompile but this function
      *        is attached to a WW but is not used Alice says to wait
      *        the function below is creating a per lb and the standard
      *        cost is in CWT... So this is on Alice's list to wait.
      * Rtv MTO Standard Cost RT - Item Standard Cost  * 
     C                     EXSR SBRVGN
      * CASE: DB1.Raw Material Item NE LCL.Raw Material Item
     C           WABLNB    IFNE YL0001                     *IF
      * Clc RM Avg Sales      RT - Sales History  * 
     C                     EXSR SCRVGN
     C                     Z-ADDWABLNB    YL0001           Seaboard Equiva
     C                     END                             *FI
      * Raw Material Cost /LB
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Sale Weight USR is GT Zero
      *   |- c2    : PAR.Yield is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0009    IFGT *ZERO                      *IF
     C           WN0003    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Raw Material Cost /LB
      * PAR.Raw Material Cost /LB =
      *    *COMPUTE (((x1 / x2) - x3) / (x4))
      * x1    : PAR.Sale Amount USR
      * /     : LCL.Product Value *Rounded
      * x2    : PAR.Sale Weight USR
      * -     : LCL.Product Value
      * x3    : PAR.Std Other Cost/CWT
      * /     : LCL.Product Value *Rounded
      * x4    : PAR.Yield
     C           WN0008    DIV  WN0009    YL0002    H      Product Value
     C                     SUB  WN0005    YL0002           Product Value
     C                     DIV  WN0003    YL0002    H      Product Value
     C                     Z-ADDYL0002    WN0002           Raw Material Co
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Mkt/Grp/Ovr/HdWgt RT - Company/Item  * 
     C                     EXSR SDRVGN
      * RTV Market Price       RT - Commodity Mrkt Price  * 
     C                     EXSR SERVGN
      * Raw Material Cost /LB
      * CASE: PAR.Yield is GT Zero
     C           WN0003    IFGT *ZERO                      *IF
      * Raw Material Cost /LB
      * PAR.Raw Material Cost /LB =
      *    *COMPUTE ((x1 + x2 - x3) / x4)
      * x1    : LCL.Commodity Market Price
      * +     : PGM.*Synon (15,2) work field
      * x2    : LCL.Market Overage
      * -     : PGM.*Synon (15,2) work field
      * x3    : PAR.Std Other Cost/CWT
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x4    : PAR.Yield
     C           YL0006    ADD  YL0004    W0WA02           *Synon (15,2) w
     C           W0WA02    SUB  WN0005    W0WA01           *Synon (15,2) w
     C           W0WA01    DIV  WN0003    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0002           Raw Material Co
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0002           Raw Material Co
     C                     END                             *FI
     C                     END                             *FI
      * Unit Cost Per Pound
      * PAR.Unit Cost Per Pound =
      *    *COMPUTE (x1 + x2 + x3)
      * x1    : PAR.Std Inc. Labor Cost/Cwt
      * +     : LCL.Product Value
      * x2    : PAR.Std Ingredient Cost/CWT
      * +     : LCL.Product Value
      * x3    : PAR.Std Packaging Cost/CWT
     C           WN0006    ADD  WN0007    YL0002           Product Value
     C                     ADD  WN0004    YL0002           Product Value
     C                     Z-ADDYL0002    WN0001           Unit Cost Per P
      * Upd RM/Unit Cost      RT - Sales History  * 
     C                     EXSR SFRVGN
     C           KRSSA     READE@BZREHM                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv MTO Standard Cost RT - Item Standard Cost  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSB01           Company Number
     C           *LIKE     DEFN WBHGCD    WQSB02           Item Code
      * Define keylist
     C           KPSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Item Code
     C                     KFLD           WBAUDT           Effective Date
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Item Code
      * Setup key
     C                     Z-ADDWAAIC3    WQSB01           Company Number
     C                     Z-ADDWAHGCD    WQSB02           Item Code
     C                     Z-ADDP2JHDT    WBAUDT           Effective Date
      * Establish starting position
     C           KPSSB     SETLL@AXCPHJ                    *
     C           KRSSB     READE@AXCPHJ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2999' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0003           Yield
     C                     Z-ADD*ZERO     WN0004           Std Packaging C
     C                     Z-ADD*ZERO     WN0005           Std Other Cost/
     C                     Z-ADD*ZERO     WN0006           Std Inc. Labor
     C                     Z-ADD*ZERO     WN0007           Std Ingredient
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBFCPC    WN0003           Yield
     C                     Z-ADDWBEDPR    WN0004           Std Packaging C
     C                     Z-ADDWBEGPR    WN0005           Std Other Cost/
     C                     Z-ADDWBEEPR    WN0006           Std Inc. Labor
     C                     Z-ADDWBEFPR    WN0007           Std Ingredient
     C                     GOTO SBEXIT                     *QUIT
     C           KRSSB     READE@AXCPHJ                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Clc RM Avg Sales      RT - Sales History  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0008           Sale Amount USR
     C                     Z-ADD*ZERO     WN0009           Sale Weight USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSC01           Company Number
     C           *LIKE     DEFN WCS5NB    WQSC02           Shipped Item Co
      * Define keylist
     C           KPSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Shipped Item Co
     C                     KFLD           WCGNDT           Actual Shipped
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Shipped Item Co
      * Setup key
     C                     Z-ADDWAAIC3    WQSC01           Company Number
     C                     Z-ADDWABLNB    WQSC02           Shipped Item Co
     C                     Z-ADDP2JHDT    WCGNDT           Actual Shipped
      * Establish starting position
     C           KPSSC     SETLL@HSTPC9                    *
     C           KRSSC     READE@HSTPC9                  90*
      * Data record not found
     C   90                MOVEL'USR1241' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Actual Shipped Date GT PAR.Date Sun USR
     C           WCGNDT    IFGT P3JNDT                     *IF
     C                     GOTO SCEXIT                     *QUIT
     C                     END                             *FI
      * CASE: DB1.Order Type - Sales is Regular Order
     C           WCJNCD    IFEQ 'OR'                       *IF
     C                     ADD  WCUSVA    WN0008           Sale Amount USR
     C                     ADD  WCBYWG    WN0009           Sale Weight USR
     C                     END                             *FI
     C           KRSSC     READE@HSTPC9                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Mkt/Grp/Ovr/HdWgt RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDHGCD           Item Code
      * Setup key
     C                     Z-ADDWAAIC3    WDAIC3           Company Number
     C                     Z-ADDWABLNB    WDHGCD           Item Code
      * Establish starting position
     C           KRSSD     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAVNA           Description Lin
     C                     MOVEL*BLANK    YL0003           Default Commod
     C                     Z-ADD*ZERO     YL0004           Market Overage
     C                     Z-ADD*ZERO     WUBMPR           Standard Overag
     C                     MOVEL*BLANK    YL0005           Commodity Price
     C                     Z-ADD*ZERO     WUSWGH           Std Weight/Head
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDAVNA    WUAVNA           Description Lin
     C                     MOVELWDLNCD    YL0003           Default Commod
     C                     Z-ADDWDBLPR    YL0004           Market Overage
     C                     Z-ADDWDBMPR    WUBMPR           Standard Overag
     C                     MOVELWDLRCD    YL0005           Commodity Price
     C                     Z-ADDWDSWGH    WUSWGH           Std Weight/Head
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WELQCD    WQSE01           Commodity Marke
     C           *LIKE     DEFN WELRCD    WQSE02           Commodity Price
      * Define keylist
     C           KPSSE     KLIST
     C                     KFLD           WQSE01           Commodity Marke
     C                     KFLD           WQSE02           Commodity Price
     C                     KFLD           WEEQDT           Market Price Da
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Commodity Marke
     C                     KFLD           WQSE02           Commodity Price
      * Setup key
     C                     MOVELYL0003    WQSE01           Commodity Marke
     C                     MOVELYL0005    WQSE02           Commodity Price
     C                     Z-ADDP3JNDT    WEEQDT           Market Price Da
      * Establish starting position
     C           KPSSE     SETLL@F0CPEP                    *
     C           KRSSE     READE@F0CPEP                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1222' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0006           Commodity Marke
     C                     Z-ADD*ZERO     YL0007           USR Date Priced
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWEA5PR    YL0006           Commodity Marke
     C                     Z-ADDWEEQDT    YL0007           USR Date Priced
     C                     GOTO SEEXIT                     *QUIT
     C           KRSSE     READE@F0CPEP                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Upd RM/Unit Cost      RT - Sales History  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSF01           Company Number
     C           *LIKE     DEFN WCS5NB    WQSF02           Shipped Item Co
      * Define keylist
     C           KPSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Shipped Item Co
     C                     KFLD           WCGNDT           Actual Shipped
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Shipped Item Co
      * Setup key
     C                     Z-ADDWAAIC3    WQSF01           Company Number
     C                     Z-ADDWAHGCD    WQSF02           Shipped Item Co
     C                     Z-ADDP2JHDT    WCGNDT           Actual Shipped
      * Establish starting position
     C           KPSSF     SETLL@HSTPC9                    *
     C           KRSSF     READE@HSTPC9                  90*
      * Data record not found
     C   90                MOVEL'USR1241' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Actual Shipped Date GT PAR.Date Sun USR
     C           WCGNDT    IFGT P3JNDT                     *IF
     C                     GOTO SFEXIT                     *QUIT
     C                     END                             *FI
      * CASE: DB1.Order Type - Sales is Regular Order
     C           WCJNCD    IFEQ 'OR'                       *IF
      * Chg RM/Unit Cost      CH - Sales History  * 
     C                     EXSR SGCHRC
     C                     END                             *FI
     C           KRSSF     READE@HSTPC9                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCHRC    BEGSR
      *================================================================
      * Chg RM/Unit Cost      CH - Sales History  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0010 20        A/R City
     C                     MOVEL*BLANK    WN0011  2        A/R State
     C                     MOVEL*BLANK    WN0012  6        A/R County Code
     C                     MOVEL*BLANK    WN0013 11        A/R Zip/Postal
     C                     MOVEL*BLANK    WN0014 25        Alpha Search
     C                     MOVEL*BLANK    WN0015  6        Country Code
     C                     MOVEL*BLANK    WN0016  2        Type Code
     C                     Z-ADD*ZERO     WN0017  70       Parent Customer
     C                     Z-ADD*ZERO     WN0018  70       A/R Customer Nu
     C                     MOVEL*BLANK    WN0019 30        A/R Customer Na
     C                     Z-ADD*ZERO     WN0020  70       Ship To Custome
     C                     MOVEL*BLANK    WN0021 30        Ship To Name
     C                     MOVEL*BLANK    WN0022 20        Ship To City
     C                     MOVEL*BLANK    WN0023  2        Ship To State C
     C                     MOVEL*BLANK    WN0024 11        Ship To Zip/Pos
     C                     MOVEL*BLANK    WN0025 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0026  70       Order Date
     C                     Z-ADD*ZERO     WN0027  70       Cancel Date
     C                     MOVEL*BLANK    WN0028  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0029  3        Original Salesp
     C                     MOVEL*BLANK    WN0030  2        Manager Level C
     C                     MOVEL*BLANK    WN0031  3        VP Level Code
     C                     MOVEL*BLANK    WN0032  2        Terms Code
     C                     Z-ADD*ZERO     WN0033  52       Absorbed Freigh
     C                     MOVEL*BLANK    WN0034  3        Carrier Code
     C                     MOVEL*BLANK    WN0035  3        Order Header Re
     C                     MOVEL*BLANK    WN0036  2        Order Type - Sa
     C                     MOVEL*BLANK    WN0037  2        Shipping Method
     C                     MOVEL*BLANK    WN0038  1        Export Status
     C                     Z-ADD*ZERO     WN0039  70       Attach to Invoi
     C                     Z-ADD*ZERO     WN0040  70       Attach to Order
     C                     Z-ADD*ZERO     WN0041  70       Resell Referenc
     C                     Z-ADD*ZERO     WN0042  70       Original Item
     C                     MOVEL*BLANK    WN0043  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0044 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0045 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0046 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0047 112       Weight Schedule
     C                     MOVEL*BLANK    WN0048  2        U/M - Ordered
     C                     Z-ADD*ZERO     WN0049 114       Unit Price
     C                     Z-ADD*ZERO     WN0050 114       Unit Price Orde
     C                     MOVEL*BLANK    WN0051  2        U/M - Base Pric
     C                     Z-ADD*ZERO     WN0052  70       Requested Ship
     C                     Z-ADD*ZERO     WN0053  70       Invoice Date
     C                     Z-ADD*ZERO     WN0054  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0055 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0056 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0057 112       Extended Amount
     C                     MOVEL*BLANK    WN0058  1        Affect Inventor
     C                     MOVEL*BLANK    WN0059  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0060  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0061  70       Contract Number
     C                     MOVEL*BLANK    WN0062  6        Export Country
     C                     Z-ADD*ZERO     WN0063  70       LD Arrival Date
     C                     Z-ADD*ZERO     WN0064  40       Accounting Year
     C                     Z-ADD*ZERO     WN0065  20       Accounting Peri
     C                     Z-ADD*ZERO     WN0066  30       OM Week
     C                     Z-ADD*ZERO     WN0067 112       Quantity Billed
     C                     Z-ADD*ZERO     WN0068 112       Weight Billed
     C                     Z-ADD*ZERO     WN0069  70       Shipped Item Co
     C                     Z-ADD*ZERO     WN0070 112       Billing Detail
     C                     Z-ADD*ZERO     WN0071 112       Billing Detail
     C                     Z-ADD*ZERO     WN0072 112       FOB Gross Amoun
     C                     Z-ADD*ZERO     WN0073 112       Standard Overag
     C                     Z-ADD*ZERO     WN0074 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0075  80       G/L Document Nu
     C                     MOVEL*BLANK    WN0076  1        G/L Update Stat
     C                     Z-ADD*ZERO     WN0077  30       Shipping Compan
     C                     MOVEL*BLANK    WN0078  3        Order Detail Re
     C                     Z-ADD*ZERO     WN0079 114       Price Overage O
     C                     MOVEL*BLANK    WN0080  3        Date Method Cod
     C                     MOVEL*BLANK    WN0081  3        Price Method Co
     C                     Z-ADD*ZERO     WN0082  70       Market Pricing
     C                     MOVEL*BLANK    WN0083  3        Commodity Marke
     C                     MOVEL*BLANK    WN0084  2        Quality Level
     C                     MOVEL*BLANK    WN0085  2        Item Level
     C                     Z-ADD*ZERO     WN0086  30       Item Structure
     C                     Z-ADD*ZERO     WN0087  30       Item Structure
     C                     Z-ADD*ZERO     WN0088  30       Item Structure
     C                     Z-ADD*ZERO     WN0089 112       Rated Freight
     C                     Z-ADD*ZERO     WN0090  70       Invoice Number
     C                     MOVEL*BLANK    WN0091  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0092  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0093  70       Load ID
     C                     Z-ADD*ZERO     WN0094  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0095  3        Packaging Code
     C                     MOVEL*BLANK    WN0096  3        Item Market Cod
     C                     Z-ADD*ZERO     WN0097  20       Agrimetrics gro
     C                     Z-ADD*ZERO     WN0098  10       Agrimetrics pac
     C                     Z-ADD*ZERO     WN0099  20       Agrimetrics gra
     C                     MOVEL*BLANK    WN0100 30        Order Desc. Lin
     C                     Z-ADD*ZERO     WN0101 112       Actual Freight
     C                     MOVEL*BLANK    WN0102  3        Item Type Code
     C                     Z-ADD*ZERO     WN0103  30       PM R/M Type Cod
     C                     Z-ADD*ZERO     WN0104  50       PM Line Number
     C                     MOVEL*BLANK    WN0105  3        SH Unused (was
     C                     Z-ADD*ZERO     WN0106  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0107  1        Modified Flag
     C                     Z-ADD*ZERO     WN0108 112       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0109 112       Ledgrd Trd Fund
     C                     Z-ADD*ZERO     WN0110 112       Commission Amou
     C                     Z-ADD*ZERO     WN0111 112       Financials Amou
     C                     Z-ADD*ZERO     WN0112 112       Financials Amou
     C                     MOVEL*BLANK    WN0113  1        Group for Packa
     C                     MOVEL*BLANK    WN0114  2        Base/Conv/Loss
     C                     MOVEL*BLANK    WN0115  1        Variety/Rendere
     C                     MOVEL*BLANK    WN0116  3        Customer Group
     C                     MOVEL*BLANK    WN0117  3        Customer Group
     C                     Z-ADD*ZERO     WN0118  70       Order Group Cod
     C                     MOVEL*BLANK    WN0119  4        Shipping Zone C
     C                     MOVEL*BLANK    WN0120  1        Invoice Price T
     C                     Z-ADD*ZERO     WN0121 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0122 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0123  30       Req Shipping Te
     C                     Z-ADD*ZERO     WN0124  30       Actual Shipping
     C                     MOVEL*BLANK    WN0125  1        Age Code
     C                     Z-ADD*ZERO     WN0126  70       Req Delivery Da
     C                     Z-ADD*ZERO     WN0127  60       Req Delivery Ti
     C                     Z-ADD*ZERO     WN0128  70       MPC Number
     C                     MOVEL*BLANK    WN0129  3        Shipping Line
     C                     MOVEL*BLANK    WN0130 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0131 25        Port City
     C                     MOVEL*BLANK    WN0132 30        Vessel Name
     C                     MOVEL*BLANK    WN0133 12        Booking Number
     C                     Z-ADD*ZERO     WN0134 112       Ocean Freight
     C                     Z-ADD*ZERO     WN0135  70       Claim Number
     C                     Z-ADD*ZERO     WN0136  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0137  1        Palletize
     C                     Z-ADD*ZERO     WN0138 114       Commodity Marke
     C                     Z-ADD*ZERO     WN0139 114       Market Value
     C                     Z-ADD*ZERO     WN0140 114       Default Cmdty M
     C                     MOVEL*BLANK    WN0141  1        Sales Expense P
     C                     Z-ADD*ZERO     WN0142 112       Sales Expense T
     C                     MOVEL*BLANK    WN0143  1        Data Mart Proce
     C                     MOVEL*BLANK    WN0144  1        LH Load Type
     C                     MOVEL*BLANK    WN0145  2        Order TF Exempt
     C                     Z-ADD*ZERO     WN0146  70       LD Sail Date
     C                     Z-ADD*ZERO     WN0147 114       NonLedgrd TrdFn
     C                     Z-ADD*ZERO     WN0148 112       HST Item Target
     C                     MOVEL*BLANK    WN0149  1        EDI Status 1
     C                     MOVEL*BLANK    WN0150  1        EDI Status 2
     C                     MOVEL*BLANK    WN0151  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0152  60       Job Time
     C                     MOVEL*BLANK    WN0153 10        User Id
     C                     MOVEL*BLANK    WN0154 10        Job Name
     C                     Z-ADD*ZERO     WN0155  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @FHSTD2
     C                     Z-ADDWCAIC3    WFAIC3           Company Number
     C                     Z-ADDWCC4NB    WFC4NB           Order Number
     C                     Z-ADDWCDPNB    WFDPNB           Order Sequence
     C                     Z-ADDWCUENB    WFUENB           Order Secondary
      *
     C           KLCHSG    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFC4NB           Order Number
     C                     KFLD           WFDPNB           Order Sequence
     C                     KFLD           WFUENB           Order Secondary
     C           KLCHSG    CHAIN@FHSTD2              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMHSTPL0'MDACP
     C                     MOVEL'@FHSTD2' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMHS1    YARDCS
      * USER: Processing after Data read
     C                     MOVEL'N'       WFISSX           Data Mart Proce
      * Move non-key fields to @FHSTD2
     C                     Z-ADDWN0001    WFAGCS           Unit Cost Per P
     C                     Z-ADDWN0002    WFD0VL           Raw Material Co
      *
      * Set PGM.*Record Data Changed flag
     C           QOMHS1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@FHSTD2                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMHSTPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WAAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WAAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WAAIWG           Unit Weight
     C                     Z-ADD*ZERO     WACZWG           Minimum Weight
     C                     Z-ADD*ZERO     WAC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WAURTN           Number Cases On
     C                     Z-ADD*ZERO     WAAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WATFNB           Transportation
     C                     Z-ADD*ZERO     WATMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WATNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WABLPR           Market Overage
     C                     Z-ADD*ZERO     WABMPR           Standard Overag
     C                     Z-ADD*ZERO     WACMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WACHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WASWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WAPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WAICN1           Item Category N
     C                     Z-ADD*ZERO     WAICN2           Item Category N
     C                     Z-ADD*ZERO     WAV2NB           Item Category N
     C                     Z-ADD*ZERO     WAITCN           Item Category N
     C                     Z-ADD*ZERO     WAITC5           Item Category N
     C                     Z-ADD*ZERO     WAICN6           Item Category N
     C                     Z-ADD*ZERO     WAICN7           Item Category N
     C                     Z-ADD*ZERO     WAICN8           Item Category N
     C                     Z-ADD*ZERO     WAICN9           Item Category N
     C                     Z-ADD*ZERO     WAICN0           Item Category N
     C                     Z-ADD*ZERO     WASFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WAA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WASJNB           Production Lead
     C                     Z-ADD*ZERO     WASKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WASLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WASMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WACFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WACGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WAILNB           PM % 2nds Facto
     C                     Z-ADD*ZERO     WACHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WACINB           PM Batch Size
     C                     Z-ADD*ZERO     WACJNB           PM Lot Size
     C                     Z-ADD*ZERO     WACMNB           Partial Item Co
     C                     Z-ADD*ZERO     WACNNB           WIP Item Code
     C                     Z-ADD*ZERO     WACRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WACSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WACVNB           FP Std Green We
     C                     Z-ADD*ZERO     WACWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WACXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WACZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WAC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WAB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WAB5NB           PM Line Number
     C                     Z-ADD*ZERO     WABDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WABJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WAF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WAF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WAF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WABLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WABNNB           Production Qty
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBAUDT           Effective Date
     C                     Z-ADD*ZERO     WBFCPC           Yield
     C                     Z-ADD*ZERO     WBGEPC           Pump Yield
     C                     Z-ADD*ZERO     WBEDPR           Std Packaging C
     C                     Z-ADD*ZERO     WBEGPR           Std Other Cost/
     C                     Z-ADD*ZERO     WBEEPR           Std Inc. Labor
     C                     Z-ADD*ZERO     WBEFPR           Std Ingredient
     C                     Z-ADD*ZERO     WBFRPR           Std Meat Cost/C
     C                     Z-ADD*ZERO     WBFSPR           UnUsed Cost Fie
     C                     Z-ADD*ZERO     WBFTPR           UnUsed Cost fie
     C                     Z-ADD*ZERO     WBFUPR           Std Total Labor
     C                     Z-ADD*ZERO     WBFVPR           UnUsed Cost fie
     C                     Z-ADD*ZERO     WBFWPR           UnUsed Cost fie
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCDPNB           Order Sequence
     C                     Z-ADD*ZERO     WCUENB           Order Secondary
     C                     Z-ADD*ZERO     WCBTC7           Parent Customer
     C                     Z-ADD*ZERO     WCANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCA0DT           Order Date
     C                     Z-ADD*ZERO     WCACDT           Cancel Date
     C                     Z-ADD*ZERO     WCTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WCATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WCT3NB           Attach to Order
     C                     Z-ADD*ZERO     WCRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WCORIT           Original Item
     C                     Z-ADD*ZERO     WCAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WCD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WCCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WCAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WCAKPR           Unit Price
     C                     Z-ADD*ZERO     WCAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WCA5DT           Requested Ship
     C                     Z-ADD*ZERO     WCAWDT           Invoice Date
     C                     Z-ADD*ZERO     WCHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WCAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WCAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WCAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WCAYVA           Extended Amount
     C                     Z-ADD*ZERO     WCL6NB           Contract Number
     C                     Z-ADD*ZERO     WCHCDT           LD Arrival Date
     C                     Z-ADD*ZERO     WCESNB           Accounting Year
     C                     Z-ADD*ZERO     WCETNB           Accounting Peri
     C                     Z-ADD*ZERO     WCBZNB           OM Week
     C                     Z-ADD*ZERO     WCEXQT           Quantity Billed
     C                     Z-ADD*ZERO     WCBYWG           Weight Billed
     C                     Z-ADD*ZERO     WCS5NB           Shipped Item Co
     C                     Z-ADD*ZERO     WCMAVA           Billing Detail
     C                     Z-ADD*ZERO     WCKDVA           Billing Detail
     C                     Z-ADD*ZERO     WCUSVA           FOB Gross Amoun
     C                     Z-ADD*ZERO     WCUTVA           Standard Overag
     C                     Z-ADD*ZERO     WCA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WCCKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WCR8NB           Shipping Compan
     C                     Z-ADD*ZERO     WCBZPR           Price Overage O
     C                     Z-ADD*ZERO     WCEXDT           Market Pricing
     C                     Z-ADD*ZERO     WCRGNB           Item Structure
     C                     Z-ADD*ZERO     WCRHNB           Item Structure
     C                     Z-ADD*ZERO     WCRINB           Item Structure
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCCONB           Invoice Number
     C                     Z-ADD*ZERO     WCGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WCRMNB           Load ID
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WCSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WCSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WCONVA           Actual Freight
     C                     Z-ADD*ZERO     WCB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WCB5NB           PM Line Number
     C                     Z-ADD*ZERO     WCGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WCULVA           Absorbed Freigh
     C                     Z-ADD*ZERO     WCUNVA           Ledgrd Trd Fund
     C                     Z-ADD*ZERO     WCUOVA           Commission Amou
     C                     Z-ADD*ZERO     WCUPVA           Financials Amou
     C                     Z-ADD*ZERO     WCUQVA           Financials Amou
     C                     Z-ADD*ZERO     WCCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WCDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WCB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WCIANX           Req Shipping Te
     C                     Z-ADD*ZERO     WCIBNX           Actual Shipping
     C                     Z-ADD*ZERO     WCNYDT           Req Delivery Da
     C                     Z-ADD*ZERO     WCBZTM           Req Delivery Ti
     C                     Z-ADD*ZERO     WCZ4NB           MPC Number
     C                     Z-ADD*ZERO     WCOCFR           Ocean Freight
     C                     Z-ADD*ZERO     WCC0C7           Claim Number
     C                     Z-ADD*ZERO     WCA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WCA5PR           Commodity Marke
     C                     Z-ADD*ZERO     WCCDPR           Market Value
     C                     Z-ADD*ZERO     WCD0PR           Default Cmdty M
     C                     Z-ADD*ZERO     WCD0VL           Raw Material Co
     C                     Z-ADD*ZERO     WCCEVL           Sales Expense T
     C                     Z-ADD*ZERO     WCOHDT           LD Sail Date
     C                     Z-ADD*ZERO     WCD9PR           NonLedgrd TrdFn
     C                     Z-ADD*ZERO     WCCFVL           HST Item Target
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field Description Line One
     C                     MOVEL*BLANK    WUAVNA 30
      * Define work field Standard Overage/Underage
     C                     Z-ADD*ZERO     WUBMPR 114
      * Define work field Std Weight/Head (Var/Ren)
     C                     Z-ADD*ZERO     WUSWGH 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEEQDT           Market Price Da
     C                     Z-ADD*ZERO     WEA5PR           Commodity Marke
     C                     Z-ADD*ZERO     WEB8PR           Projected Marke
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WA02 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      * Define local work field Seaboard Equivalent Item
     C                     Z-ADD*ZERO     YL0001  70
      * Define local work field Product Value
     C                     Z-ADD*ZERO     YL0002 154
      * Define local work field Default Commod Mark basis
     C                     MOVEL*BLANK    YL0003  3
      * Define local work field Market Overage
     C                     Z-ADD*ZERO     YL0004 114
      * Define local work field Commodity Price Group
     C                     MOVEL*BLANK    YL0005  7
      * Define local work field Commodity Market Price
     C                     Z-ADD*ZERO     YL0006 114
      * Define local work field USR Date Priced
     C                     Z-ADD*ZERO     YL0007  70
      *================================================================
     CSR         ZZEXIT    ENDSR
