/*                                                                 */
/*  PROGRAM NUMBER:  PWFFUPC                                       */
/*  PROGRAM NAME:    Email Delivery Schedule Report .xls           */
/*  PROGRAMMER:      Brad Baden                                    */
/*  CREATE DATE:     11/25/2017                                    */
/*                                                                 */
/*  FUNCTION:        This CLP function is used to Email an .xls    */
/*                   copy of the Delivery Schedule Report.         */
/*                                                                 */
/*******************************************************************/
/*  Modification History                                           */
/*   T13559 DN  08/22/18 - Append 'TEST' to Subject Line if in     */
/*     TEST env. Changed Email Subject Line to 40 in length to     */
/*     support Producer Location value.                            */
/*  03/26/2021 RMC SDN 475- FOR TEST, CHG &OVRUSROPT TO &USER      */
/*                                                                 */
/*******************************************************************/

             PGM        PARM(&RECIPIENT &EMLSUBJ &OPTIONS)
/*                                                                 */
/*-----------------------------------------------------------------*/
/*                      PARAMETER                                  */
/*-----------------------------------------------------------------*/
/* Function Specific                                               */
             DCL        VAR(&RECIPIENT) TYPE(*CHAR) LEN(75)
             DCL        VAR(&EMLSUBJ) TYPE(*CHAR) LEN(50)
             DCL        VAR(&OPTIONS) TYPE(*CHAR) LEN(200)

             DCL        VAR(&RTNLIB) TYPE(*CHAR) LEN(10)

/*-----------------------------------------------------------------*/
/* T13559 DN 08/22/18-Append 'TEST' to Subject Line if in TEST env. */
             RTVOBJD    OBJ(PKAXCPP) OBJTYPE(*FILE) RTNLIB(&RTNLIB)
             MONMSG     MSGID(CPF9801)  /* Object Not Found */

             IF         COND(&RTNLIB *NE 'PRKFGUP' *AND &RTNLIB *NE +
                          'PRKFSTP' *AND &RTNLIB *NE 'PRKFTFP') +
                          THEN(DO)
             CHGVAR     VAR(&EMLSUBJ) VALUE(&EMLSUBJ *BCAT '- TEST')
             ENDDO

/*-----------------------------------------------------------------*/
             EXECUTE    VIEW(DLVSCDXLS) PCFMT(*XLSX) +
                          RECIPIENT(&RECIPIENT) EMLMSG(&OPTIONS) +
                          TEXT(&EMLSUBJ)

/*-----------------------------------------------------------------*/
/*                      CLEAR FILE                                 */
             CLRPFM     FILE(PWAJCPP)

/*-----------------------------------------------------------------*/
/*                      PROGRAM END                                */
/*-----------------------------------------------------------------*/
  ENDPGM:
             ENDPGM
