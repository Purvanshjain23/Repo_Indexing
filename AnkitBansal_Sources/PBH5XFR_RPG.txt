     H/TITLE EXC Jpn Ords only-Upld XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.5 (1351)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 04/17/13  Time  : 16:20:58
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPNHGCPL2IF  E           K        DISK
      * RSQ : WF Export Upload Header   Co#, ShipTo, PO#
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
      * Long constants
     E                    @CN#    1  02  6   @CN    25
     I@HGCPLN
      * WF Export Upload Header   Co#, ShipTo, PO#
      * Renamed input format fields
     I              HGBKC7                          WABKC7
     I              HGBCNA                          WABCNA
     I              HGAIC3                          WAAIC3
     I              HGAJCD                          WAAJCD
     I              HGBVTM                          WABVTM
     I              HGXECD                          WAXECD
     I              HGTYNA                          WATYNA
     I              HGTZNA                          WATZNA
     I              HGRINY                          WARINY
     I              HGYMT1                          WAYMT1
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: WF Export Upload Header
      * I :  Company Number
     I                                    P   1   20P1AIC3
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * EXC Jpn Ords only-Upld XF
      * ** Creates Load & Order records for Japanese Chilled Orders
      * RTV/CRT Jpn Ords only  RT - WF Export Upload Header  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV/CRT Jpn Ords only  RT - WF Export Upload Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001 15        ED Shipping Mar
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSA01           Company Number
      * Establish starting position
     C           KRSSA     SETLL@HGCPLN                    *
     C           KRSSA     READE@HGCPLN                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4442' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,001   W0RTN            *Return code
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * ** Creates Order Headers/Details for Japanese Chilled Orders
      * ** Load Header and Detail are NOT created
      * ** This function is called by an SSIS function
      * ** Default Order Number to zeros for this procedure
      * ** Put Price Code into the Item Code PASS USR field
     C                     Z-ADD*ZERO     YL0001           System Value Nu
     C                     Z-ADD*ZERO     YL0002           Order Number 1
      * ** Build the Special Instructions, pass in Customer Name parm
     C                     MOVEL*BLANK    YL0003           Reference Field
     C                     Z-ADD1         ZQ      50
     C           'CAF'     CAT  WAXECD:ZQ YL0003    P      Reference Field
      * ** Build the Shipping Instructions
     C                     Z-ADD*ZERO     ZQ      50
     C           WABCNA    CAT  '/':ZQ    WN0001    P      ED Shipping Mar
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0001    CAT  WAYMT1:ZQ WN0001    P      ED Shipping Mar
      * ** Parse SSD from *char(26) (from SSIS) to 10 alpha for CVT DATE
      * ** Then move 11 alpha date to 7 alpha, convert 7 alpha
      * ** to 7 numeric. Finally move 7 numeric to SSD
     C                     Z-ADD4         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00026
     C           ZQ        ORGT 00026
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWATYNA:ZQ WUZ7TX    P  90  Text USR 4
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00026
     C           ZQ        ORGT 00026
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWATYNA:ZQ WUHKT1    P  90  Text 2
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD9         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00026
     C           ZQ        ORGT 00026
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWATYNA:ZQ WUW2TX    P  90  Text 2 Length U
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WUZ7TX    CAT  WUHKT1:ZQ WUK1TX    P      Text 10A USR
     C                     Z-ADD*ZERO     ZQ      50
     C           WUK1TX    CAT  WUW2TX:ZQ WUK1TX    P      Text 10A USR
      * Cvt Date              UP - /UT Functions  * 
     C                     CALL 'POD5UPR'              90  Cvt Date
     C                     PARM WUK1TX    WQ0001 10        Date From Conve
     C           WUTAT1    PARM *BLANK    WQ0002 11        Date To Convert
     C                     PARM '*YYMD'   WQ0003  8        Date From Forma
     C                     PARM '*CYMD'   WQ0004  8        Date To Format
     C                     PARM '*NONE'   WQ0005  7        Date Separator
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POD5UPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUTAT1    WUY8TX           Text USR 7
     C                     MOVE WUY8TX    WUODNB           Number Value -
      * WRK.Scheduled Ship Date USR = WRK.Number Value - 7
     C                     Z-ADDWUODNB    WUHODT           Scheduled Ship
      * ** Parse SSD from *char(26) (from SSIS) to 10 alpha for CVT DATE
      * ** Then move 11 alpha date to 7 alpha, convert 7 alpha
      * ** to 7 numeric. Finally move 7 numeric to RDD
     C                     Z-ADD4         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00026
     C           ZQ        ORGT 00026
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWATZNA:ZQ WUZ7TX    P  90  Text USR 4
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00026
     C           ZQ        ORGT 00026
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWATZNA:ZQ WUHKT1    P  90  Text 2
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD9         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00026
     C           ZQ        ORGT 00026
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWATZNA:ZQ WUW2TX    P  90  Text 2 Length U
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WUZ7TX    CAT  WUHKT1:ZQ WUK1TX    P      Text 10A USR
     C                     Z-ADD*ZERO     ZQ      50
     C           WUK1TX    CAT  WUW2TX:ZQ WUK1TX    P      Text 10A USR
      * Cvt Date              UP - /UT Functions  * 
     C                     CALL 'POD5UPR'              90  Cvt Date
     C                     PARM WUK1TX    WQ0006 10        Date From Conve
     C           WUTAT1    PARM *BLANK    WQ0007 11        Date To Convert
     C                     PARM '*YYMD'   WQ0008  8        Date From Forma
     C                     PARM '*CYMD'   WQ0009  8        Date To Format
     C                     PARM '*NONE'   WQ0010  7        Date Separator
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POD5UPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUTAT1    WUY8TX           Text USR 7
     C                     MOVE WUY8TX    WUODNB           Number Value -
      * WRK.Req Delivery Date = WRK.Number Value - 7
     C                     Z-ADDWUODNB    WUNYDT           Req Delivery Da
      * CRT Japan Orders only  XF - Customer Price Header  * 
     C                     CALL 'PBH2XFR'              90  CRT Japan Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0011 155       Company Number
     C                     PARM WABKC7    WQ0012 155       Customer Number
     C                     PARM WUHODT    WQ0013 155       Date 1
     C                     PARM WUHODT    WQ0014 155       Date 2
     C                     PARM WUNYDT    WQ0015 155       From Date Pass
     C           YL0002    PARM YL0002    WQ0016 155       Order Number 1
     C           YL0001    PARM YL0001    WQ0017 155       System Value Nu
     C                     PARM WAAJCD    WQ0018  3        Warehouse Code
     C                     PARM WABVTM    WQ0019 155       Item Code PASS
     C                     PARM 'U'       WQ0020  1        Change Flag USR
     C                     PARM YL0003    WQ0021 30        Customer Name
     C                     PARM WABCNA    WQ0022 15        Customer Purcha
     C                     PARM WARINY    WQ0023  40       Days to Age  Pa
     C                     PARM YL0004    WQ0024 155       Date 4 RGF   Pa
     C                     PARM YL0005    WQ0025 155       Date 4 RGT   Pa
     C                     PARM WN0001    WQ0026 15        ED Shipping Mar
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBH2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * ** Default printer to Sales, PRKPRT14
     C                     MOVEL*BLANK    WUBCSX           Hold
     C                     MOVEL'*NO'     WUBCSX           Hold
      * Rtv Alpha Value       XF - Company Values  * 
     C                     CALL 'POMTXFR'              90  Rtv Alpha Value
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0027  30       Company Number
     C                     PARM @CN,002   WQ0028 10        Company Value C
     C           WUDEV     PARM *BLANK    WQ0029 40        System Value Al
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * E2176 SLM 03/14/2013 due to parms only pass as blanks
      * PRT Acknowledgements UP - Order Header TRG  * 
     C                     CALL 'PDJWPCLP'             90  PRT Acknowledge
     C                     PARM WAAIC3    WQ0030 155       Company Number
     C                     PARM YL0002    WQ0031 155       Order Number 1
     C                     PARM YL0002    WQ0032 155       Order Number 2
     C                     PARM *ZERO     WQ0033 155       Date 1
     C                     PARM *ZERO     WQ0034 155       Date 2
     C                     PARM *ZERO     WQ0035 155       Thru Date Pass
     C                     PARM *BLANK    WQ0036  2        Order Type - Sa
     C                     PARM WUOTTX    WQ0037  2        Shipping Method
     C                     PARM '1'       WQ0038  1        Billing Activit
     C                     PARM 'A'       WQ0039  1        Export Sales
     C                     PARM *BLANK    WQ0040  3        USR Warehouse C
     C                     PARM *BLANK    WQ0041  3        USR CDE Parm 1
     C                     PARM *BLANK    WQ0042  3        USR CDE Parm 2
     C                     PARM *BLANK    WQ0043  3        USR CDE Parm 3
     C                     PARM *BLANK    WQ0044  3        USR CDE Parm 4
     C                     PARM *BLANK    WQ0045  3        USR CDE Parm 5
     C                     PARM *BLANK    WQ0046  3        USR CDE Parm 6
     C                     PARM *BLANK    WQ0047  3        USR CDE Parm 7
     C                     PARM *BLANK    WQ0048  3        USR CDE Parm 8
     C                     PARM *BLANK    WQ0049  3        USR CDE Parm 9
     C                     PARM 'S'       WQ0050  1        USR Select/Omit
     C                     PARM WUDEV     WQ0051 10        PRT Printer Dev
     C                     PARM WUBCSX    WQ0052  4        PRT Hold Output
     C                     PARM '*YES'    WQ0053  4        PRT Save Output
     C                     PARM 1         WQ0054 155       System Value Nu
     C                     PARM *BLANK    WQ0055 10        PRT Night Queue
     C                     PARM *ZERO     WQ0056 155       Date 3
     C                     PARM *BLANK    WQ0057  1        Email To Whs
     C                     PARM *BLANK    WQ0058  3        Email to Wareho
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDJWPCLP'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * RTV Order Qty/Wgt TotalRT - Order Header TRG  * 
     C                     EXSR SBRVGN
      * EDT Post Open Orders 2 XF - Order Header TRG  * 
     C                     CALL 'POI4XFR'              90  EDT Post Open O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0059  30       Company Number
     C                     PARM YL0002    WQ0060  70       Order Number
     C                     PARM WABKC7    WQ0061  70       Ship To Custome
     C           YL0006    PARM YL0006    WQ0062 112       Order Value Tot
     C           YL0007    PARM *ZERO     WQ0063 112       Order Weight To
     C                     PARM 'JPN'     WQ0064  6        USR Country Cod
     C                     PARM WAAJCD    WQ0065  3        USR Warehouse C
     C                     PARM 'EOA'     WQ0066  3        Pricing Event C
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POI4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C           KRSSA     READE@HGCPLN                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Order Qty/Wgt TotalRT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
      * Setup key
     C                     Z-ADDWAAIC3    WBAIC3           Company Number
     C                     Z-ADDYL0002    WBC4NB           Order Number
      * Establish starting position
     C           KRSSB     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBJZVA    YL0006           Order Value Tot
     C                     Z-ADDWBA1WG    YL0007           Order Weight To
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WABVTM           Price Code
     C                     Z-ADD*ZERO     WARINY           Item Age Days
      * Define work field Text USR 4
     C                     MOVEL*BLANK    WUZ7TX  4
      * Define work field Text 2
     C                     MOVEL*BLANK    WUHKT1  2
      * Define work field Text 2 Length USR
     C                     MOVEL*BLANK    WUW2TX  2
      * Define work field Text 10A USR
     C                     MOVEL*BLANK    WUK1TX 10
      * Define work field Text usr 11
     C                     MOVEL*BLANK    WUTAT1 11
      * Define work field Text USR 7
     C                     MOVEL*BLANK    WUY8TX  7
      * Define work field Number Value - 7
     C                     Z-ADD*ZERO     WUODNB  70
      * Define work field Scheduled Ship Date USR
     C                     Z-ADD*ZERO     WUHODT  70
      * Define work field Req Delivery Date
     C                     Z-ADD*ZERO     WUNYDT  70
      * Define work field Hold
     C                     MOVEL*BLANK    WUBCSX  5
      * Define work field Printer Device
     C                     MOVEL*BLANK    WUDEV  10
      * Define work field Blank for 4           USR
     C                     MOVEL*BLANK    WUOTTX  4
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WBA0DT           Order Date
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBACDT           Cancel Date
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WBA1WG           Order Weight To
     C                     Z-ADD*ZERO     WBEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WBAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WBATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WBRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WBT3NB           Attach to Order
     C                     Z-ADD*ZERO     WBCONB           Invoice Number
     C                     Z-ADD*ZERO     WBAWDT           Invoice Date
     C                     Z-ADD*ZERO     WBVRVA           A/R order Value
     C                     Z-ADD*ZERO     WBB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WBNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WBNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WBNQDT           OH Unused Date
     C                     Z-ADD*ZERO     WBNRDT           OH Unused Date
     C                     Z-ADD*ZERO     WBNSDT           OH Unused Date
     C                     Z-ADD*ZERO     WBBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WBBQTM           Time of Origina
     C                     Z-ADD*ZERO     WBBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WBBSTM           OH Unused Time
     C                     Z-ADD*ZERO     WBBTTM           OH Unused Time
     C                     Z-ADD*ZERO     WBH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WBH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WBH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WBH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WBH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WBC0C7           Claim Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local work field System Value Numeric
     C                     Z-ADD*ZERO     YL0001 155
      * Define local work field Order Number 1  PASS  USR
     C                     Z-ADD*ZERO     YL0002 155
      * Define local work field Reference Field
     C                     MOVEL*BLANK    YL0003 15
      * Define local work field Date 4 RGF   Pass
     C                     Z-ADD*ZERO     YL0004 155
      * Define local work field Date 4 RGT   Pass
     C                     Z-ADD*ZERO     YL0005 155
      * Define local work field Order Value Total
     C                     Z-ADD*ZERO     YL0006 112
      * Define local work field Order Weight Total
     C                     Z-ADD*ZERO     YL0007 112
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Y2U0005
00002 JPNPRINTER
