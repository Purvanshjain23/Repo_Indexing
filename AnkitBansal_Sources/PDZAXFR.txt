     H/TITLE Prc Add Physical Count XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by  : 2E  Version:  1181
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model         lopment-
     H* System        : OMS Development Model
     H* User name     : ISRBEND
     H* Date          : 05/31/07  Time  : 15:59:59
     H* Copyright     : OMS Development Model         lopment-
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : Application Profile       Retrieval index       NV
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FPDKACPL1IF  E           K        DISK
      * RTV : AS Inventory Restoration  Retrieval index
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FCAB0REL1IF  E           K        DISK
      * RTV : Item Balance              Retrieval index       NV
      *
     FCAB1REL3IF  E           K        DISK
      * RSQ : Item Balance Detail      o/Whse Slct Phys Count
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FCAB0REL0IF  E           K        DISK                      A
      * UPD : Item Balance              Update index
      *
     FCAB1REL1UF  E           K        DISK                      A
      * UPD : Item Balance Detail       Update index
      *
     FPDKACPL0UF  E           K        DISK
      * UPD : AS Inventory Restoration  Update index
      *
     E                    UCT        40  1               CENTER TABLE
      * Long constants
     E                    @CN#    1   6  6   @CN    25
     I@DRRETH
      * User Profile Control      Retrieval index       NV
      * Renamed input format fields
     I              DRAJVN                          WAAJVN
     I              DRAUNA                          WAAUNA
     I              DRB8NA                          WAB8NA
     I              DRAHVN                          WAAHVN
     I              DRI6ST                          WAI6ST
     I              DRI7ST                          WAI7ST
     I              DRXMST                          WAXMST
     I              DRXNST                          WAXNST
     I              DRI8ST                          WAI8ST
     I              DRNLNB                          WANLNB
     I              DRMPNA                          WAMPNA
     I              DRBCCD                          WABCCD
     I              DRAIC3                          WAAIC3
     I              DRDQCD                          WADQCD
     I              DRDRCD                          WADRCD
     I              DRAJCD                          WAAJCD
     I              DRBUVN                          WABUVN
     I              DRUVST                          WAUVST
     I              DRUWST                          WAUWST
     I              DRUXST                          WAUXST
     I              DRAATM                          WAAATM
     I              DRAYNA                          WAAYNA
     I              DRA0NA                          WAA0NA
     I              DRAXDT                          WAAXDT
      *
     I@DTRETE
      * Application Profile       Retrieval index       NV
      * Renamed input format fields
     I              DTAJVN                          WBAJVN
     I              DTDNCD                          WBDNCD
     I              DTAIC3                          WBAIC3
     I              DTDQCD                          WBDQCD
     I              DTDRCD                          WBDRCD
     I              DTAJCD                          WBAJCD
     I              DTJFST                          WBJFST
     I              DTUVST                          WBUVST
     I              DTUWST                          WBUWST
     I              DTUXST                          WBUXST
     I              DTAATM                          WBAATM
     I              DTAYNA                          WBAYNA
     I              DTA0NA                          WBA0NA
     I              DTAXDT                          WBAXDT
      *
     I@ABREG3
      * Company Name and Address  Retrieval index       NV
      * Renamed input format fields
     I              ABAIC3                          WCAIC3
     I              ABADTX                          WCADTX
     I              ABACNA                          WCACNA
     I              ABADNA                          WCADNA
     I              ABAENA                          WCAENA
     I              ABAJNA                          WCAJNA
     I              ABBTTX                          WCBTTX
     I              ABBVTX                          WCBVTX
     I              ABBWTX                          WCBWTX
     I              ABA2NA                          WCA2NA
     I              ABABTX                          WCABTX
     I              ABBGCD                          WCBGCD
     I              ABKXCD                          WCKXCD
     I              ABUVST                          WCUVST
     I              ABUWST                          WCUWST
     I              ABUXST                          WCUXST
     I              ABVSST                          WCVSST
     I              ABAATM                          WCAATM
     I              ABAYNA                          WCAYNA
     I              ABA0NA                          WCA0NA
     I              ABAXDT                          WCAXDT
      *
     I@DNRESF
      * Application               RSQ Application Code
      * Renamed input format fields
     I              DNDNCD                          WDDNCD
     I              DNAUNA                          WDAUNA
     I              DNVKST                          WDVKST
     I              DNRSCD                          WDRSCD
     I              DNUVST                          WDUVST
     I              DNUWST                          WDUWST
     I              DNUXST                          WDUXST
     I              DNAATM                          WDAATM
     I              DNAYNA                          WDAYNA
     I              DNA0NA                          WDA0NA
     I              DNAXDT                          WDAXDT
      *
     I@KACPE9
      * AS Inventory Restoration  Retrieval index
      * Renamed input format fields
     I              KAASPD                          WEASPD
     I              KAUYCD                          WEUYCD
     I              KAASP6                          WEASP6
     I              KAIDTX                          WEIDTX
     I              KAASTC                          WEASTC
     I              KAEMWG                          WEEMWG
     I              KAXXCD                          WEXXCD
     I              KATVCD                          WETVCD
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WFAIC3
     I              BZHGCD                          WFHGCD
     I              BZAVNA                          WFAVNA
     I              BZAWNA                          WFAWNA
     I              BZL7NA                          WFL7NA
     I              BZL8NA                          WFL8NA
     I              BZL6NA                          WFL6NA
     I              BZMFNA                          WFMFNA
     I              BZADCD                          WFADCD
     I              BZAWPC                          WFAWPC
     I              BZLXST                          WFLXST
     I              BZAECD                          WFAECD
     I              BZAXPC                          WFAXPC
     I              BZLYST                          WFLYST
     I              BZAFCD                          WFAFCD
     I              BZAICD                          WFAICD
     I              BZAIWG                          WFAIWG
     I              BZHICD                          WFHICD
     I              BZRBCD                          WFRBCD
     I              BZFZST                          WFFZST
     I              BZAVST                          WFAVST
     I              BZCZWG                          WFCZWG
     I              BZC0WG                          WFC0WG
     I              BZURTN                          WFURTN
     I              BZAJC8                          WFAJC8
     I              BZRINB                          WFRINB
     I              BZRHNB                          WFRHNB
     I              BZRGNB                          WFRGNB
     I              BZLNCD                          WFLNCD
     I              BZTFNB                          WFTFNB
     I              BZN0CD                          WFN0CD
     I              BZX4ST                          WFX4ST
     I              BZTMVA                          WFTMVA
     I              BZTNVA                          WFTNVA
     I              BZBLPR                          WFBLPR
     I              BZBMPR                          WFBMPR
     I              BZLRCD                          WFLRCD
     I              BZU9ST                          WFU9ST
     I              BZCMCO                          WFCMCO
     I              BZQ1CD                          WFQ1CD
     I              BZQ8CD                          WFQ8CD
     I              BZCHTM                          WFCHTM
     I              BZQZCD                          WFQZCD
     I              BZXWST                          WFXWST
     I              BZXXST                          WFXXST
     I              BZVMST                          WFVMST
     I              BZSWGH                          WFSWGH
     I              BZPPHE                          WFPPHE
     I              BZR3CD                          WFR3CD
     I              BZSDCD                          WFSDCD
     I              BZICN1                          WFICN1
     I              BZSVCD                          WFSVCD
     I              BZICN2                          WFICN2
     I              BZSWCD                          WFSWCD
     I              BZV2NB                          WFV2NB
     I              BZSXCD                          WFSXCD
     I              BZITCN                          WFITCN
     I              BZSYCD                          WFSYCD
     I              BZITC5                          WFITC5
     I              BZSZCD                          WFSZCD
     I              BZICN6                          WFICN6
     I              BZS0CD                          WFS0CD
     I              BZICN7                          WFICN7
     I              BZS1CD                          WFS1CD
     I              BZICN8                          WFICN8
     I              BZS2CD                          WFS2CD
     I              BZICN9                          WFICN9
     I              BZS3CD                          WFS3CD
     I              BZICN0                          WFICN0
     I              BZS4CD                          WFS4CD
     I              BZSFNB                          WFSFNB
     I              BZA3WG                          WFA3WG
     I              BZSJNB                          WFSJNB
     I              BZLLCD                          WFLLCD
     I              BZLMCD                          WFLMCD
     I              BZP3ST                          WFP3ST
     I              BZSKNB                          WFSKNB
     I              BZSLNB                          WFSLNB
     I              BZSMNB                          WFSMNB
     I              BZP4ST                          WFP4ST
     I              BZCFNB                          WFCFNB
     I              BZCGNB                          WFCGNB
     I              BZILNB                          WFILNB
     I              BZCHNB                          WFCHNB
     I              BZCINB                          WFCINB
     I              BZCJNB                          WFCJNB
     I              BZCMNB                          WFCMNB
     I              BZCNNB                          WFCNNB
     I              BZCRNB                          WFCRNB
     I              BZCSNB                          WFCSNB
     I              BZCVNB                          WFCVNB
     I              BZCWNB                          WFCWNB
     I              BZCXNB                          WFCXNB
     I              BZCZNB                          WFCZNB
     I              BZC0NB                          WFC0NB
     I              BZN1CD                          WFN1CD
     I              BZB4NB                          WFB4NB
     I              BZB5NB                          WFB5NB
     I              BZX5ST                          WFX5ST
     I              BZX6ST                          WFX6ST
     I              BZX7ST                          WFX7ST
     I              BZPCCT                          WFPCCT
     I              BZBDNB                          WFBDNB
     I              BZBJNB                          WFBJNB
     I              BZSUST                          WFSUST
     I              BZSVST                          WFSVST
     I              BZSYST                          WFSYST
     I              BZSZST                          WFSZST
     I              BZS1ST                          WFS1ST
     I              BZXRCD                          WFXRCD
     I              BZXTCD                          WFXTCD
     I              BZXUCD                          WFXUCD
     I              BZF5WG                          WFF5WG
     I              BZF6WG                          WFF6WG
     I              BZF7WG                          WFF7WG
     I              BZBLNB                          WFBLNB
     I              BZBNNB                          WFBNNB
     I              BZS2ST                          WFS2ST
     I              BZS4ST                          WFS4ST
     I              BZS5ST                          WFS5ST
     I              BZS6ST                          WFS6ST
     I              BZS8ST                          WFS8ST
     I              BZS9ST                          WFS9ST
     I              BZTCST                          WFTCST
     I              BZTDST                          WFTDST
     I              BZUVST                          WFUVST
     I              BZUWST                          WFUWST
     I              BZUXST                          WFUXST
     I              BZVSST                          WFVSST
     I              BZAATM                          WFAATM
     I              BZAYNA                          WFAYNA
     I              BZA0NA                          WFA0NA
     I              BZAXDT                          WFAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WGAJCD
     I              ADF8NA                          WGF8NA
     I              ADACNA                          WGACNA
     I              ADADNA                          WGADNA
     I              ADAENA                          WGAENA
     I              ADAJNA                          WGAJNA
     I              ADBTTX                          WGBTTX
     I              ADAOCD                          WGAOCD
     I              ADBGCD                          WGBGCD
     I              ADVHST                          WGVHST
     I              ADMPNA                          WGMPNA
     I              ADWPST                          WGWPST
     I              ADXUST                          WGXUST
     I              ADT0ST                          WGT0ST
     I              ADT1ST                          WGT1ST
     I              ADDBNB                          WGDBNB
     I              ADT2ST                          WGT2ST
     I              ADT3ST                          WGT3ST
     I              ADT4ST                          WGT4ST
     I              ADT6ST                          WGT6ST
     I              ADBWC3                          WGBWC3
     I              ADBTC3                          WGBTC3
     I              ADBUC3                          WGBUC3
     I              ADBVC3                          WGBVC3
     I              ADFCAA                          WGFCAA
     I              ADRQSX                          WGRQSX
     I              ADRRSX                          WGRRSX
     I              ADRSSX                          WGRSSX
     I              ADRTSX                          WGRTSX
     I              ADT7ST                          WGT7ST
     I              ADT8ST                          WGT8ST
     I              ADRNSX                          WGRNSX
     I              ADROSX                          WGROSX
     I              ADRPSX                          WGRPSX
     I              ADUVST                          WGUVST
     I              ADUWST                          WGUWST
     I              ADUXST                          WGUXST
     I              ADVSST                          WGVSST
     I              ADAATM                          WGAATM
     I              ADAYNA                          WGAYNA
     I              ADA0NA                          WGA0NA
     I              ADAXDT                          WGAXDT
      *
     I@AFREBE
      * Calendar                  Retrieval index       NV
      * Renamed input format fields
     I              AFAIC3                          WHAIC3
     I              AFBCDT                          WHBCDT
     I              AFCQNB                          WHCQNB
     I              AFESNB                          WHESNB
     I              AFETNB                          WHETNB
     I              AFBZNB                          WHBZNB
     I              AFA9ST                          WHA9ST
     I              AFEINB                          WHEINB
     I              AFC5ST                          WHC5ST
     I              AFAQNB                          WHAQNB
     I              AFCMST                          WHCMST
     I              AFV9ST                          WHV9ST
     I              AFWAST                          WHWAST
     I              AFX2ST                          WHX2ST
     I              AFOJDT                          WHOJDT
     I              AFNQNX                          WHNQNX
     I              AFNRNX                          WHNRNX
     I              AFI9SX                          WHI9SX
     I              AFJASX                          WHJASX
     I              AFOKDT                          WHOKDT
     I              AFOLDT                          WHOLDT
     I              AFUVST                          WHUVST
     I              AFUWST                          WHUWST
     I              AFUXST                          WHUXST
     I              AFAATM                          WHAATM
     I              AFAYNA                          WHAYNA
     I              AFA0NA                          WHA0NA
     I              AFAXDT                          WHAXDT
      *
     I@B0REJX
      * Item Balance              Retrieval index       NV
      * Renamed input format fields
     I              B0AIC3                          WIAIC3
     I              B0HGCD                          WIHGCD
     I              B0AJCD                          WIAJCD
     I              B0AGCS                          WIAGCS
     I              B0AECS                          WIAECS
     I              B0BACS                          WIBACS
     I              B0BBCS                          WIBBCS
     I              B0CBPR                          WICBPR
     I              B0GUDT                          WIGUDT
     I              B0XYST                          WIXYST
     I              B0CTPR                          WICTPR
     I              B0G4DT                          WIG4DT
     I              B0BOWG                          WIBOWG
     I              B0DDQT                          WIDDQT
     I              B0DEQT                          WIDEQT
     I              B0DFQT                          WIDFQT
     I              B0HDQT                          WIHDQT
     I              B0HEQT                          WIHEQT
     I              B0AJQT                          WIAJQT
     I              B0AQQT                          WIAQQT
     I              B0AUQT                          WIAUQT
     I              B0EMQT                          WIEMQT
     I              B0DOQT                          WIDOQT
     I              B0ATNA                          WIATNA
     I              B0AKDT                          WIAKDT
     I              B0ANDT                          WIANDT
     I              B0IDVA                          WIIDVA
     I              B0JVST                          WIJVST
     I              B0BZPC                          WIBZPC
     I              B0DGQT                          WIDGQT
     I              B0DIDT                          WIDIDT
     I              B0ALCD                          WIALCD
     I              B0BFDY                          WIBFDY
     I              B0DJDT                          WIDJDT
     I              B0BGDY                          WIBGDY
     I              B0DKDT                          WIDKDT
     I              B0J2ST                          WIJ2ST
     I              B0DJQT                          WIDJQT
     I              B0BNWG                          WIBNWG
     I              B0DLDT                          WIDLDT
     I              B0DPQT                          WIDPQT
     I              B0DQQT                          WIDQQT
     I              B0DMDT                          WIDMDT
     I              B0M0ST                          WIM0ST
     I              B0J9ST                          WIJ9ST
     I              B0KBST                          WIKBST
     I              B0AKC8                          WIAKC8
     I              B0RINB                          WIRINB
     I              B0RHNB                          WIRHNB
     I              B0RGNB                          WIRGNB
     I              B0UVST                          WIUVST
     I              B0UWST                          WIUWST
     I              B0UXST                          WIUXST
     I              B0VSST                          WIVSST
     I              B0AATM                          WIAATM
     I              B0AYNA                          WIAYNA
     I              B0A0NA                          WIA0NA
     I              B0AXDT                          WIAXDT
      *
     I@B0REJT
      * Item Balance              Update index
      * Renamed input format fields
     I              B0AIC3                          WJAIC3
     I              B0HGCD                          WJHGCD
     I              B0AJCD                          WJAJCD
     I              B0AGCS                          WJAGCS
     I              B0AECS                          WJAECS
     I              B0BACS                          WJBACS
     I              B0BBCS                          WJBBCS
     I              B0CBPR                          WJCBPR
     I              B0GUDT                          WJGUDT
     I              B0XYST                          WJXYST
     I              B0CTPR                          WJCTPR
     I              B0G4DT                          WJG4DT
     I              B0BOWG                          WJBOWG
     I              B0DDQT                          WJDDQT
     I              B0DEQT                          WJDEQT
     I              B0DFQT                          WJDFQT
     I              B0HDQT                          WJHDQT
     I              B0HEQT                          WJHEQT
     I              B0AJQT                          WJAJQT
     I              B0AQQT                          WJAQQT
     I              B0AUQT                          WJAUQT
     I              B0EMQT                          WJEMQT
     I              B0DOQT                          WJDOQT
     I              B0ATNA                          WJATNA
     I              B0AKDT                          WJAKDT
     I              B0ANDT                          WJANDT
     I              B0IDVA                          WJIDVA
     I              B0JVST                          WJJVST
     I              B0BZPC                          WJBZPC
     I              B0DGQT                          WJDGQT
     I              B0DIDT                          WJDIDT
     I              B0ALCD                          WJALCD
     I              B0BFDY                          WJBFDY
     I              B0DJDT                          WJDJDT
     I              B0BGDY                          WJBGDY
     I              B0DKDT                          WJDKDT
     I              B0J2ST                          WJJ2ST
     I              B0DJQT                          WJDJQT
     I              B0BNWG                          WJBNWG
     I              B0DLDT                          WJDLDT
     I              B0DPQT                          WJDPQT
     I              B0DQQT                          WJDQQT
     I              B0DMDT                          WJDMDT
     I              B0M0ST                          WJM0ST
     I              B0J9ST                          WJJ9ST
     I              B0KBST                          WJKBST
     I              B0AKC8                          WJAKC8
     I              B0RINB                          WJRINB
     I              B0RHNB                          WJRHNB
     I              B0RGNB                          WJRGNB
     I              B0UVST                          WJUVST
     I              B0UWST                          WJUWST
     I              B0UXST                          WJUXST
     I              B0VSST                          WJVSST
     I              B0AATM                          WJAATM
     I              B0AYNA                          WJAYNA
     I              B0A0NA                          WJA0NA
     I              B0AXDT                          WJAXDT
      *
     I@B1RELK
      * Item Balance Detail      o/Whse Slct Phys Count
      * Renamed input format fields
     I              B1AIC3                          WKAIC3
     I              B1HGCD                          WKHGCD
     I              B1AJCD                          WKAJCD
     I              B1ELDT                          WKELDT
     I              B1ABWG                          WKABWG
     I              B1AGQT                          WKAGQT
     I              B1AHQT                          WKAHQT
     I              B1AIQT                          WKAIQT
     I              B1CTST                          WKCTST
     I              B1ACWG                          WKACWG
     I              B1ARQT                          WKARQT
     I              B1ASQT                          WKASQT
     I              B1ATQT                          WKATQT
     I              B1HDQT                          WKHDQT
     I              B1HEQT                          WKHEQT
     I              B1F6ST                          WKF6ST
     I              B1BMWG                          WKBMWG
     I              B1DSQT                          WKDSQT
     I              B1DTQT                          WKDTQT
     I              B1DUQT                          WKDUQT
     I              B1DHDT                          WKDHDT
     I              B1AGCS                          WKAGCS
     I              B1AECS                          WKAECS
     I              B1IDVA                          WKIDVA
     I              B1K7DT                          WKK7DT
     I              B1RINB                          WKRINB
     I              B1RHNB                          WKRHNB
     I              B1RGNB                          WKRGNB
     I              B1UVST                          WKUVST
     I              B1UWST                          WKUWST
     I              B1UXST                          WKUXST
     I              B1VSST                          WKVSST
     I              B1AATM                          WKAATM
     I              B1AYNA                          WKAYNA
     I              B1A0NA                          WKA0NA
     I              B1AXDT                          WKAXDT
      *
     I@B1REJ1
      * Item Balance Detail       Update index
      * Renamed input format fields
     I              B1AIC3                          WLAIC3
     I              B1HGCD                          WLHGCD
     I              B1AJCD                          WLAJCD
     I              B1ELDT                          WLELDT
     I              B1ABWG                          WLABWG
     I              B1AGQT                          WLAGQT
     I              B1AHQT                          WLAHQT
     I              B1AIQT                          WLAIQT
     I              B1CTST                          WLCTST
     I              B1ACWG                          WLACWG
     I              B1ARQT                          WLARQT
     I              B1ASQT                          WLASQT
     I              B1ATQT                          WLATQT
     I              B1HDQT                          WLHDQT
     I              B1HEQT                          WLHEQT
     I              B1F6ST                          WLF6ST
     I              B1BMWG                          WLBMWG
     I              B1DSQT                          WLDSQT
     I              B1DTQT                          WLDTQT
     I              B1DUQT                          WLDUQT
     I              B1DHDT                          WLDHDT
     I              B1AGCS                          WLAGCS
     I              B1AECS                          WLAECS
     I              B1IDVA                          WLIDVA
     I              B1K7DT                          WLK7DT
     I              B1RINB                          WLRINB
     I              B1RHNB                          WLRHNB
     I              B1RGNB                          WLRGNB
     I              B1UVST                          WLUVST
     I              B1UWST                          WLUWST
     I              B1UXST                          WLUXST
     I              B1VSST                          WLVSST
     I              B1AATM                          WLAATM
     I              B1AYNA                          WLAYNA
     I              B1A0NA                          WLA0NA
     I              B1AXDT                          WLAXDT
      *
     I@KACPE5
      * AS Inventory Restoration  Update index
      * Renamed input format fields
     I              KAASPD                          WMASPD
     I              KAUYCD                          WMUYCD
     I              KAASP6                          WMASP6
     I              KAIDTX                          WMIDTX
     I              KAASTC                          WMASTC
     I              KAEMWG                          WMEMWG
     I              KAXXCD                          WMXXCD
     I              KATVCD                          WMTVCD
      *
     I@KMREHC
      * Company Values            Retrieval index
      * Renamed input format fields
     I              KMAIC3                          WOAIC3
     I              KMV8CD                          WOV8CD
     I              KMAUNA                          WOAUNA
     I              KMI5ST                          WOI5ST
     I              KMBXTX                          WOBXTX
     I              KMM8NB                          WOM8NB
     I              KMUVST                          WOUVST
     I              KMUWST                          WOUWST
     I              KMUXST                          WOUXST
     I              KMVSST                          WOVSST
     I              KMAATM                          WOAATM
     I              KMAYNA                          WOAYNA
     I              KMA0NA                          WOA0NA
     I              KMAXDT                          WOAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQCAB01    E DSCAB0REL0
      * UPD : Item Balance              Update index
      * Renamed input format fields
     I              B0AIC3                          WJAIC3
     I              B0HGCD                          WJHGCD
     I              B0AJCD                          WJAJCD
     I              B0AGCS                          WJAGCS
     I              B0AECS                          WJAECS
     I              B0BACS                          WJBACS
     I              B0BBCS                          WJBBCS
     I              B0CBPR                          WJCBPR
     I              B0GUDT                          WJGUDT
     I              B0XYST                          WJXYST
     I              B0CTPR                          WJCTPR
     I              B0G4DT                          WJG4DT
     I              B0BOWG                          WJBOWG
     I              B0DDQT                          WJDDQT
     I              B0DEQT                          WJDEQT
     I              B0DFQT                          WJDFQT
     I              B0HDQT                          WJHDQT
     I              B0HEQT                          WJHEQT
     I              B0AJQT                          WJAJQT
     I              B0AQQT                          WJAQQT
     I              B0AUQT                          WJAUQT
     I              B0EMQT                          WJEMQT
     I              B0DOQT                          WJDOQT
     I              B0ATNA                          WJATNA
     I              B0AKDT                          WJAKDT
     I              B0ANDT                          WJANDT
     I              B0IDVA                          WJIDVA
     I              B0JVST                          WJJVST
     I              B0BZPC                          WJBZPC
     I              B0DGQT                          WJDGQT
     I              B0DIDT                          WJDIDT
     I              B0ALCD                          WJALCD
     I              B0BFDY                          WJBFDY
     I              B0DJDT                          WJDJDT
     I              B0BGDY                          WJBGDY
     I              B0DKDT                          WJDKDT
     I              B0J2ST                          WJJ2ST
     I              B0DJQT                          WJDJQT
     I              B0BNWG                          WJBNWG
     I              B0DLDT                          WJDLDT
     I              B0DPQT                          WJDPQT
     I              B0DQQT                          WJDQQT
     I              B0DMDT                          WJDMDT
     I              B0M0ST                          WJM0ST
     I              B0J9ST                          WJJ9ST
     I              B0KBST                          WJKBST
     I              B0AKC8                          WJAKC8
     I              B0RINB                          WJRINB
     I              B0RHNB                          WJRHNB
     I              B0RGNB                          WJRGNB
     I              B0UVST                          WJUVST
     I              B0UWST                          WJUWST
     I              B0UXST                          WJUXST
     I              B0VSST                          WJVSST
     I              B0AATM                          WJAATM
     I              B0AYNA                          WJAYNA
     I              B0A0NA                          WJA0NA
     I              B0AXDT                          WJAXDT
      *
     IQCAB11    E DSCAB1REL1
      * UPD : Item Balance Detail       Update index
      * Renamed input format fields
     I              B1AIC3                          WLAIC3
     I              B1HGCD                          WLHGCD
     I              B1AJCD                          WLAJCD
     I              B1ELDT                          WLELDT
     I              B1ABWG                          WLABWG
     I              B1AGQT                          WLAGQT
     I              B1AHQT                          WLAHQT
     I              B1AIQT                          WLAIQT
     I              B1CTST                          WLCTST
     I              B1ACWG                          WLACWG
     I              B1ARQT                          WLARQT
     I              B1ASQT                          WLASQT
     I              B1ATQT                          WLATQT
     I              B1HDQT                          WLHDQT
     I              B1HEQT                          WLHEQT
     I              B1F6ST                          WLF6ST
     I              B1BMWG                          WLBMWG
     I              B1DSQT                          WLDSQT
     I              B1DTQT                          WLDTQT
     I              B1DUQT                          WLDUQT
     I              B1DHDT                          WLDHDT
     I              B1AGCS                          WLAGCS
     I              B1AECS                          WLAECS
     I              B1IDVA                          WLIDVA
     I              B1K7DT                          WLK7DT
     I              B1RINB                          WLRINB
     I              B1RHNB                          WLRHNB
     I              B1RGNB                          WLRGNB
     I              B1UVST                          WLUVST
     I              B1UWST                          WLUWST
     I              B1UXST                          WLUXST
     I              B1VSST                          WLVSST
     I              B1AATM                          WLAATM
     I              B1AYNA                          WLAYNA
     I              B1A0NA                          WLA0NA
     I              B1AXDT                          WLAXDT
      *
     IYARDCS      DS                            163
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPDKA1    E DSPDKACPL0
      * UPD : AS Inventory Restoration  Update index
      * Renamed input format fields
     I              KAASPD                          WMASPD
     I              KAUYCD                          WMUYCD
     I              KAASP6                          WMASP6
     I              KAIDTX                          WMIDTX
     I              KAASTC                          WMASTC
     I              KAEMWG                          WMEMWG
     I              KAXXCD                          WMXXCD
     I              KATVCD                          WMTVCD
      *
     IYBRDCS      DS                             59
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'AS Inventory Restoration'
      * AS Product Code
     I                                        1   5 ZA0001
      * AS Warehouse ID Code
     I                                        6   8 ZA0002
      * AS Label Date 6.0
     I                                        9  14 ZA0003
      * AS Product Description 1
     I                                       15  39 ZA0004
      * AS Container Total
     I                                       40  45 ZA0005
      * AS Total Net Weight
     I                                       46  52 ZA0006
      * AS Production Date
     I                                       53  58 ZA0007
      * AS Carriage Return
     I                                       59  59 ZA0008
      * Message data for 'SND Pager Message'
      * Pager Name USR
     I                                        1  10 ZA0009
      * Pager Msg USR
     I                                       11  90 ZA0010
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prc Add Physical Count XF
      *
     C                     MOVEL*BLANK    WN0001 10        User Profile Na
      *
      * VAL Set Int. Acc EXTNL IF
     C                     MOVEL##USR     WN0001           User Profile Na
      *
     C                     MOVEL*BLANK    WN0002 10        User Code Model
      *
      * VAL User/Appl EXTERNAL IF
      * RTV Program Setup      RT - User Profile Control  * 
     C                     EXSR SARVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0002    IFEQ *BLANK                     *IF
      * Retrieve Appl. Profile - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0001    WL0001    P      User Profile Na
     C                     MOVEL'OMS'     WL0002    P      Application Cod
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    WUAIC3           Company Number
     C                     MOVELWL0004    WUAJCD    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0002    WL0001    P      User Profile Na
     C                     MOVEL'OMS'     WL0002    P      Application Cod
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    WUAIC3           Company Number
     C                     MOVELWL0004    WUAJCD    P      Warehouse Code
     C                     END                             *FI
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     Z-ADDWUAIC3    WUAIC3           Company Number
     C                     MOVELWUWVST    WUWVST           Access Denied (
      * If access denied is no, rtv co. name
      * CASE: WRK.Access Denied (Y/N) is no
     C           WUWVST    IFEQ 'N'                        *IF
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SCRVGN
     C                     END                             *FI
      * RTV Screen Heading     RT
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SDRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * Center Text String 40 - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C                     MOVE 'N'       FLAG    1        FLAG
     C           UX        DOWGT0
     C           FLAG      ANDEQ'N'
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     MOVE 'Y'       FLAG
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
      *** ADDED FOR HPE, THERE HEADER FOOTER IS OFF   MEA 042494
     C                     SUB  1         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
     C                     MOVELWUDE40    WUBXTX           System Value Al
      * Prc Add Physical Count RT - AS Inventory Restoration  * 
     C                     EXSR SFRVGN
      * Exc Upd Last Dt Cllctn XF - AS Last Data Collection  * 
     C                     CALL 'PDTCXFR'              90  Exc Upd Last Dt
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUAIC3    WQ0086  30       Company Number
     C                     PARM 'INVRST'  WQ0087  6        AS Data Collect
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDTCXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Program Setup      RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0001    WAAJVN           User Profile Na
      * Establish starting position
     C           KRSSA     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAI6ST    WUI6ST           Allow Multi-Com
     C                     MOVELWAMPNA    WUMPNA           Default Printer
     C                     MOVELWABCCD    WUBCCD           Salesperson Cod
     C                     MOVELWABUVN    WN0002           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Retrieve Appl. Profile - Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAJVN           User Profile Na
     C                     KFLD           WBDNCD           Application Cod
      * Setup key
     C                     MOVELWL0001    WBAJVN           User Profile Na
     C                     MOVELWL0002    WBDNCD           Application Cod
      * Establish starting position
     C           KRSSB     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBAIC3    WL0003           Company Number
     C                     MOVELWBAJCD    WL0004           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAIC3           Company Number
      * Setup key
     C                     Z-ADDWUAIC3    WCAIC3           Company Number
      * Establish starting position
     C           KRSSC     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUADTX           Name
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCADTX    WUADTX           Name
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDDNCD    WQSD01           Application Cod
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSD01           Application Cod
     C                     MOVEL'OMS'     WQSD01           Application Cod
      * Establish starting position
     C           KRSSD     SETLL@DNRESF                    *
     C           KRSSD     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           WDRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELWDAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SERVGN
     C                     END                             *FI
     C           KRSSD     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDDNCD    WQSE01           Application Cod
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Application Cod
      * Setup key
     C                     MOVELWDRSCD    WQSE01           Application Cod
      * Establish starting position
     C           KRSSE     SETLL@DNRESF                    *
     C           KRSSE     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDAUNA    WUAUNA           Description
     C           KRSSE     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Prc Add Physical Count RT - AS Inventory Restoration  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0003  1        Error Status
     C                     Z-ADD*ZERO     WN0004  70       USR Start Date
     C                     MOVEL*BLANK    WN0005  1        Production Date
     C                     MOVEL*BLANK    WN0006  1        Record Found US
     C                     MOVEL*BLANK    WN0007  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0008 114       Unit Cost Per P
     C                     MOVEL*BLANK    WN0009  1        AS Error Code
     C                     MOVEL*BLANK    WN0010  6        AS Data Collect
     C                     Z-ADD*ZERO     WN0011  70       AS Transaction
     C                     Z-ADD*ZERO     WN0012  60       AS Transaction
     C                     Z-ADD*ZERO     WN0013  70       AS Sequence Num
     C                     MOVEL*BLANK    WN0014110        AS Error Record
     C                     MOVEL*BLANK    WN0015  1        AS Error Code
     C                     MOVEL*BLANK    WN0016 10        AS Notified Lis
     C                     MOVEL*BLANK    WN0017  1        AS Unused Sts 1
     C                     MOVEL*BLANK    WN0018  1        AS Unused Sts 2
     C                     MOVEL*BLANK    WN0019  1        AS Unused Sts 3
     C                     MOVEL*BLANK    WN0020  2        AS Unused Sts 4
     C                     MOVEL*BLANK    WN0021  2        AS Unused Sts 5
     C                     MOVEL*BLANK    WN0022  1        EDI Status 1
     C                     MOVEL*BLANK    WN0023  1        EDI Status 2
     C                     MOVEL*BLANK    WN0024  1        EDI Status 3
     C                     MOVEL*BLANK    WN0025  1        Record Status
     C                     Z-ADD*ZERO     WN0026  60       Job Time
     C                     MOVEL*BLANK    WN0027 10        User Id
     C                     MOVEL*BLANK    WN0028 10        Job Name
     C                     Z-ADD*ZERO     WN0029  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * JRB 05/31/07 DLY029 Removed hard coded Co Num
      * *********************************************************
     C                     Z-ADD##JDT     WN0011           AS Transaction
     C                     Z-ADD##JTM     WN0012           AS Transaction
     C                     MOVEL*BLANK    WN0016           AS Notified Lis
     C                     MOVEL'ASPRDUPL'WN0016           AS Notified Lis
     C                     MOVEL'INVRST'  WN0010           AS Data Collect
     C                     MOVEL'N'       YL0001           Upload Error US
      * *********************************************************
      * Establish starting position
     C           *LOVAL    SETLL@KACPE9                    *
     C                     READ @KACPE9                  90*
      * Data record not found
     C   90                MOVEL'USR2142' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVELWEASPD    WUY7TX           Text USR 5
      * RPG TESTN for 5 pos.  US - /UT User Source  * 
     C                     TESTN          WUY7TX  5  60
     C           *IN60     IFEQ '0'
     C                     MOVE 'DECERR ' WUH3TX
     C                     ELSE
     C                     MOVE '       ' WUH3TX
     C                     END
      * CASE: WRK.Return Code Usr is DECERR
     C           WUH3TX    IFEQ 'DECERR'                   *IF
     C                     Z-ADD*ZERO     WUHGCD           Item Code
     C                     MOVEL'Y'       YL0002           Error Flag
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUHGCD           Item Code
     C                     MOVE WEASPD    WUHGCD           Item Code
     C                     END                             *FI
      * CASE: LCL.Error Flag            USR is Yes
     C           YL0002    IFEQ 'Y'                        *IF
      * Crt Upload Error Log  XF - AS Upload Error Log  * 
     C                     CALL 'POMKXFR'              90  Crt Upload Erro
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUAIC3    WQ0001  30       Company Number
     C                     PARM WN0010    WQ0002  6        AS Data Collect
     C                     PARM WN0011    WQ0003  70       AS Transaction
     C                     PARM WN0012    WQ0004  60       AS Transaction
     C                     PARM @CN,01    WQ0005110        AS Error Record
     C                     PARM @CN,02    WQ0006 10        AS Error Log Co
     C                     PARM WN0016    WQ0007 10        AS Notified Lis
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'E'       WN0009           AS Error Code
     C                     MOVEL'Y'       YL0001           Upload Error US
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WN0003           Error Status
      * ***********************************************************
      * Setup message data for message
     C                     MOVELWEASPD    ZA0001           AS Product Code
     C                     MOVELWEUYCD    ZA0002           AS Warehouse ID
     C                     MOVELWEASP6    ZA0003           AS Label Date 6
     C                     MOVELWEIDTX    ZA0004           AS Product Desc
     C                     MOVELWEASTC    ZA0005           AS Container To
     C                     MOVELWEEMWG    ZA0006           AS Total Net We
     C                     MOVELWEXXCD    ZA0007           AS Production D
     C                     MOVELWETVCD    ZA0008           AS Carriage Ret
      * Retrieve message AS Inventory Restoration
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3075' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           WN0014    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * ***********************************************************
     C                     Z-ADD*ZERO     WUHGCD           Item Code
     C                     MOVE WEASPD    WUTSNB           Calc 5
     C           WUTSNB    MULT 1         WUHGCD           Item Code
      * Val Item/Rtv Whse,PDC  RT - Company Item  * 
     C                     EXSR SGRVGN
      * Validate item
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'Y'       WN0003           Error Status
      * Crt Upload Error Log  XF - AS Upload Error Log  * 
     C                     CALL 'POMKXFR'              90  Crt Upload Erro
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUAIC3    WQ0008  30       Company Number
     C                     PARM WN0010    WQ0009  6        AS Data Collect
     C                     PARM WN0011    WQ0010  70       AS Transaction
     C                     PARM WN0012    WQ0011  60       AS Transaction
     C                     PARM WN0014    WQ0012110        AS Error Record
     C                     PARM 'ITEMCODE'WQ0013 10        AS Error Log Co
     C                     PARM WN0016    WQ0014 10        AS Notified Lis
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Val Accu-Sort Whse     RT - Warehouse  * 
     C                     EXSR SHRVGN
      * Validate warehouse
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'Y'       WN0003           Error Status
      * Crt Upload Error Log  XF - AS Upload Error Log  * 
     C                     CALL 'POMKXFR'              90  Crt Upload Erro
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUAIC3    WQ0015  30       Company Number
     C                     PARM WN0010    WQ0016  6        AS Data Collect
     C                     PARM WN0011    WQ0017  70       AS Transaction
     C                     PARM WN0012    WQ0018  60       AS Transaction
     C                     PARM WN0014    WQ0019110        AS Error Record
     C                     PARM 'WHSCODE' WQ0020 10        AS Error Log Co
     C                     PARM WN0016    WQ0021 10        AS Notified Lis
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Validate Label date if production date control is yes
      * CASE: PAR.Production Date Control is yes
     C           WN0005    IFEQ 'Y'                        *IF
     C                     MOVE WEASP6    WUMHNX           Label Date USR
      * WRK.Label Date = WRK.Label Date USR
     C                     Z-ADDWUMHNX    WUK7DT           Label Date
      * Set Century.
      * CASE: WRK.Label Date is < 410101
     C           WUK7DT    IFLT 410101                     *IF
     C                     ADD  1000000   WUK7DT           Label Date
     C                     END                             *FI
      * VAL Date               RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0005           Company Number
     C                     Z-ADDWUK7DT    WL0006           Post to G/L Dat
     C                     EXSR SIRVGN
      * If date is not valid then error = Yes
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'Y'       WN0003           Error Status
      * Crt Upload Error Log  XF - AS Upload Error Log  * 
     C                     CALL 'POMKXFR'              90  Crt Upload Erro
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUAIC3    WQ0022  30       Company Number
     C                     PARM WN0010    WQ0023  6        AS Data Collect
     C                     PARM WN0011    WQ0024  70       AS Transaction
     C                     PARM WN0012    WQ0025  60       AS Transaction
     C                     PARM WN0014    WQ0026110        AS Error Record
     C                     PARM @CN,03    WQ0027 10        AS Error Log Co
     C                     PARM WN0016    WQ0028 10        AS Notified Lis
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Validate production date if production date control is yes
      * CASE: PAR.Production Date Control is yes
     C           WN0005    IFEQ 'Y'                        *IF
     C                     MOVE WEXXCD    WUMGNX           Prod Date USR
      * WRK.Production Date = WRK.Prod Date USR
     C                     Z-ADDWUMGNX    WUELDT           Production Date
      * Set Century.
      * CASE: WRK.Production Date is < 410101
     C           WUELDT    IFLT 410101                     *IF
     C                     ADD  1000000   WUELDT           Production Date
     C                     END                             *FI
      * VAL Date               RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0005           Company Number
     C                     Z-ADDWUELDT    WL0006           Post to G/L Dat
     C                     EXSR SIRVGN
      * If date is not valid then error = Yes
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'Y'       WN0003           Error Status
      * Crt Upload Error Log  XF - AS Upload Error Log  * 
     C                     CALL 'POMKXFR'              90  Crt Upload Erro
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUAIC3    WQ0029  30       Company Number
     C                     PARM WN0010    WQ0030  6        AS Data Collect
     C                     PARM WN0011    WQ0031  70       AS Transaction
     C                     PARM WN0012    WQ0032  60       AS Transaction
     C                     PARM WN0014    WQ0033110        AS Error Record
     C                     PARM 'PRODDATE'WQ0034 10        AS Error Log Co
     C                     PARM WN0016    WQ0035 10        AS Notified Lis
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Rtv Status/Default     RT - IC Item Balance  * 
     C                     EXSR SJRVGN
      * If item balance not found, get unit cost or error
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       WN0006           Record Found US
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WN0006           Record Found US
     C                     Z-ADD##JDT     WUGIDT           Pricing Date Us
      * CLC Rtv Unit Cost/LB   XF - Item Balance  * 
     C                     CALL 'PDLSXFR'              90  CLC Rtv Unit Co
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUAIC3    WQ0036  30       Company Number
     C                     PARM WUHGCD    WQ0037  70       Item Code
     C                     PARM WEUYCD    WQ0038  3        Warehouse Code
     C           WN0008    PARM WN0008    WQ0039 114       Unit Cost Per P
     C           WUBACS    PARM WUBACS    WQ0040 114       Cost per Primar
     C           WUGIDT    PARM WUGIDT    WQ0041  70       Pricing Date Us
     C           WUU1ST    PARM WUU1ST    WQ0042  1        Price Status
     C                     PARM ##JDT     WQ0043  70       As of Date
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDLSXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PAR.Unit Cost Per Pound EQ WRK.ZERO
     C           WN0008    IFEQ WUW0NB                     *IF
     C                     MOVEL'Y'       WN0003           Error Status
      * Crt Upload Error Log  XF - AS Upload Error Log  * 
     C                     CALL 'POMKXFR'              90  Crt Upload Erro
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUAIC3    WQ0044  30       Company Number
     C                     PARM WN0010    WQ0045  6        AS Data Collect
     C                     PARM WN0011    WQ0046  70       AS Transaction
     C                     PARM WN0012    WQ0047  60       AS Transaction
     C                     PARM WN0014    WQ0048110        AS Error Record
     C                     PARM 'UNITCOST'WQ0049 10        AS Error Log Co
     C                     PARM WN0016    WQ0050 10        AS Notified Lis
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * 10/04/05 PKD Only process WIPs
      * Rtv Item Type Code     RT - Company Item  * 
     C                     EXSR SKRVGN
      * Check Item Type Code
      * CASE: LCL.Item Type Code is Not Work In Process
     C           YL0003    IFEQ *BLANK                     *IF
     C           YL0003    OREQ 'EX'
     C           YL0003    OREQ 'FG'
     C           YL0003    OREQ 'PS'
     C           YL0003    OREQ 'RM'
     C                     MOVEL'Y'       WN0003           Error Status
      * Crt Upload Error Log  XF - AS Upload Error Log  * 
     C                     CALL 'POMKXFR'              90  Crt Upload Erro
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUAIC3    WQ0051  30       Company Number
     C                     PARM WN0010    WQ0052  6        AS Data Collect
     C                     PARM WN0011    WQ0053  70       AS Transaction
     C                     PARM WN0012    WQ0054  60       AS Transaction
     C                     PARM WN0014    WQ0055110        AS Error Record
     C                     PARM 'ASNOTWP' WQ0056 10        AS Error Log Co
     C                     PARM WN0016    WQ0057 10        AS Notified Lis
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * If error is no, process count
      * CASE: PAR.Error Status is no
     C           WN0003    IFEQ 'N'                        *IF
      * If item balance not found then create it
      * CASE: PAR.Record Found USR is Record Not Found
     C           WN0006    IFEQ 'N'                        *IF
      * Rtv Item Typ/Grp/Cls  RT - Company/Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0007           Company Number
     C                     Z-ADDWUHGCD    WL0008           Item Code
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0009    WURINB           Item Structure
     C                     Z-ADDWL0010    WURHNB           Item Structure
     C                     Z-ADDWL0011    WURGNB           Item Structure
      * Crt Item Balance       CR - Item Balance  * 
     C                     EXSR SMCRRC
     C                     END                             *FI
      * Rtv Phys. Start Date   RT - Item Balance Detail  * 
     C                     EXSR SNRVGN
      * Date manipulation
      * CASE: PAR.Production Date Control is no
     C           WN0005    IFEQ 'N'                        *IF
     C                     Z-ADD*ZERO     WUELDT           Production Date
     C                     Z-ADD*ZERO     WUK7DT           Label Date
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUELDT           Production Date
     C                     MOVE WEXXCD    WUELDT           Production Date
      * Set Century.
      * CASE: WRK.Production Date is < 410101
     C           WUELDT    IFLT 410101                     *IF
     C                     ADD  1000000   WUELDT           Production Date
     C                     END                             *FI
     C                     Z-ADD*ZERO     WUK7DT           Label Date
     C                     MOVE WEASP6    WUK7DT           Label Date
      * Set Century.
      * CASE: WRK.Label Date is < 410101
     C           WUK7DT    IFLT 410101                     *IF
     C                     ADD  1000000   WUK7DT           Label Date
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVE WEASTC    WUTTNB           Calc 6
     C           WUTTNB    MULT 1         WUA5QT           Transaction Qua
     C                     MOVE WEEMWG    WUTVNB           Calc 7
     C           WUTVNB    DIV  10        WUAHWG           Transaction Wei
      * *** this will change the label date, if the old one was in error
      * Chg AS Physical Count  CH - Item Balance Detail  * 
     C                     EXSR SOCHRC
     C                     MOVELWEUYCD    WN0007           Warehouse Code
     C                     MOVEL*BLANK    WN0009           AS Error Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'E'       WN0009           AS Error Code
     C                     MOVEL'Y'       YL0001           Upload Error US
     C                     END                             *FI
     C                     END                             *FI
      * CHG Inventory Restorat CH - AS Inventory Restoration  * 
     C                     EXSR SQCHRC
     C                     READ @KACPE9                  90*
     C                     ENDDO
      * USER: Exit processing
      * Automatically Post the Restoration
     C                     EXSR UASUBR                     Automatically P
      * ***********************************************************
      * CASE: LCL.Upload Error USR is yes
     C           YL0001    IFEQ 'Y'                        *IF
      *
     C                     MOVEL*BLANK    WN0071 40        System Value Al
     C                     MOVEL*BLANK    WN0072 10        Pager Name USR
      *
      * Snd Pager Message     IF
      * RTV Alpha Value        RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0012           Company Number
     C                     MOVELWN0016    WL0013    P      Company Value C
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0014    WN0071    P      System Value Al
     C                     MOVELWN0071    WN0072           Pager Name USR
      * Setup message data for message
     C                     MOVELWN0072    ZA0009           Pager Name USR
     C                     MOVEL@CN,06    ZA0010           Pager Msg USR
      *
      * Execute message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2EXMCC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3006' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
     C           W0RTN     IFNE *BLANK
      * Error detected during execution
     C                     SETON                     99    *
     C                     END
      *
     C                     END                             *FI
      * ***********************************************************
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Val Item/Rtv Whse,PDC  RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFHGCD           Item Code
      * Setup key
     C                     Z-ADDWUAIC3    WFAIC3           Company Number
     C                     Z-ADDWUHGCD    WFHGCD           Item Code
      * Establish starting position
     C           KRSSG     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0005           Production Date
     C                     MOVEL*BLANK    WUQ1CD           Default Warehou
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFFZST    WN0005           Production Date
     C                     MOVELWFQ1CD    WUQ1CD           Default Warehou
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Val Accu-Sort Whse     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WGAJCD           Warehouse Code
      * Setup key
     C                     MOVELWEUYCD    WGAJCD           Warehouse Code
      * Establish starting position
     C           KRSSH     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Trans Contol AS400/Plant is Plant
     C           WGXUST    IFEQ 'P'                        *IF
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * VAL Date               RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADDWL0005    WHAIC3           Company Number
     C                     Z-ADDWL0006    WHBCDT           Post to G/L Dat
      * Establish starting position
     C           KRSSI     CHAIN@AFREBE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0018' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Status/Default     RT - IC Item Balance  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIHGCD           Item Code
     C                     KFLD           WIAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWUAIC3    WIAIC3           Company Number
     C                     Z-ADDWUHGCD    WIHGCD           Item Code
     C                     MOVELWEUYCD    WIAJCD           Warehouse Code
      * Establish starting position
     C           KRSSJ     CHAIN@B0REJX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0328' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUAGCS           Unit Cost Per P
     C                     MOVEL*BLANK    WUJ9ST           Cost Update Pen
     C                     MOVEL*BLANK    WUKBST           Post G/L Status
     C                     Z-ADD*ZERO     WUAKC8           Vendor - Item/W
     C                     MOVEL*BLANK    WUVSST           Record Status
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWIAGCS    WUAGCS           Unit Cost Per P
     C                     MOVELWIJ9ST    WUJ9ST           Cost Update Pen
     C                     MOVELWIKBST    WUKBST           Post G/L Status
     C                     Z-ADDWIAKC8    WUAKC8           Vendor - Item/W
     C                     MOVELWIVSST    WUVSST           Record Status
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Item Type Code     RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFHGCD           Item Code
      * Setup key
     C                     Z-ADDWUAIC3    WFAIC3           Company Number
     C                     Z-ADDWUHGCD    WFHGCD           Item Code
      * Establish starting position
     C           KRSSK     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0003           Item Type Code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFN0CD    YL0003           Item Type Code
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Item Typ/Grp/Cls  RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0007    WFAIC3           Company Number
     C                     Z-ADDWL0008    WFHGCD           Item Code
      * Establish starting position
     C           KRSSL     CHAIN@BZREJU              90    *
      * Data record not found
     C   90                MOVEL'USR0326' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWFRINB    WL0009           Item Structure
     C                     Z-ADDWFRHNB    WL0010           Item Structure
     C                     Z-ADDWFRGNB    WL0011           Item Structure
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCRRC    BEGSR
      *================================================================
      * Crt Item Balance       CR - Item Balance  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0030  60       Job Time
     C                     MOVEL*BLANK    WN0031 10        User Id
     C                     MOVEL*BLANK    WN0032 10        Job Name
     C                     Z-ADD*ZERO     WN0033  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B0REJT
     C                     Z-ADDWUAIC3    WJAIC3           Company Number
     C                     Z-ADDWUHGCD    WJHGCD           Item Code
     C                     MOVELWEUYCD    WJAJCD           Warehouse Code
     C                     Z-ADDWN0008    WJAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WJAECS           Last Cost
     C                     Z-ADD*ZERO     WJBACS           Cost per Primar
     C                     Z-ADD*ZERO     WJBBCS           Cost per Pricin
     C                     Z-ADD*ZERO     WJCBPR           Revaluation Cos
     C                     Z-ADD*ZERO     WJGUDT           Revaluation Eff
     C                     MOVEL*BLANK    WJXYST           Revaluation Cos
     C                     Z-ADD*ZERO     WJCTPR           Last Revaluatio
     C                     Z-ADD*ZERO     WJG4DT           Last Revaluatio
     C                     Z-ADD*ZERO     WJBOWG           On Hand Weight
     C                     Z-ADD*ZERO     WJDDQT           On Hand U/M1 Su
     C                     Z-ADD*ZERO     WJDEQT           On Hand U/M2 Su
     C                     Z-ADD*ZERO     WJDFQT           On Hand U/M3 Su
     C                     Z-ADD*ZERO     WJHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WJHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WJAJQT           Quantity Schedu
     C                     Z-ADD*ZERO     WJAQQT           Quantity on Sal
     C                     Z-ADD*ZERO     WJAUQT           Quantity on Pur
     C                     Z-ADD*ZERO     WJEMQT           Quantity on Tra
     C                     Z-ADD*ZERO     WJDOQT           Quantity Avail.
     C                     MOVEL*BLANK    WJATNA           Cycle Count Cod
     C                     Z-ADD*ZERO     WJAKDT           Date of Last Or
     C                     Z-ADD*ZERO     WJANDT           Date of Last Sh
     C                     Z-ADD*ZERO     WJIDVA           Value of On Han
     C                     MOVEL'N'       WJJVST           Inventory Plann
     C                     Z-ADD*ZERO     WJBZPC           Safety Allowanc
     C                     Z-ADD*ZERO     WJDGQT           Safety Allowanc
     C                     Z-ADD*ZERO     WJDIDT           Stock Out Date
     C                     MOVEL*BLANK    WJALCD           Buyer Code
     C                     Z-ADD*ZERO     WJBFDY           Lead Time - Las
     C                     Z-ADD*ZERO     WJDJDT           Lead Time - Dat
     C                     Z-ADD*ZERO     WJBGDY           Lead Time - Nex
     C                     Z-ADD*ZERO     WJDKDT           Lead Time - Dat
     C                     MOVEL'N'       WJJ2ST           Lead Time - Exc
     C                     Z-ADD*ZERO     WJDJQT           Usage Qty per C
     C                     Z-ADD*ZERO     WJBNWG           Usage Weight pe
     C                     Z-ADD*ZERO     WJDLDT           Inventory Manag
     C                     Z-ADD*ZERO     WJDPQT           Minimum Quantit
     C                     Z-ADD*ZERO     WJDQQT           Maximum Quantit
     C                     Z-ADD*ZERO     WJDMDT           Last Physical C
     C                     MOVEL'N'       WJM0ST           Requisition Mod
     C                     MOVEL'N'       WJJ9ST           Cost Update Pen
     C                     MOVEL'N'       WJKBST           Post G/L Status
     C                     Z-ADD*ZERO     WJAKC8           Vendor - Item/W
     C                     Z-ADDWURINB    WJRINB           Item Structure
     C                     Z-ADDWURHNB    WJRHNB           Item Structure
     C                     Z-ADDWURGNB    WJRGNB           Item Structure
     C                     MOVEL*BLANK    WJUVST           EDI Status 1
     C                     MOVEL*BLANK    WJUWST           EDI Status 2
     C                     MOVEL*BLANK    WJUXST           EDI Status 3
     C                     MOVEL'A'       WJVSST           Record Status
      *
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WJAATM' defaulted for 'Job Time'.
      * Field '(DB1) WJAYNA' defaulted for 'User Id'.
      * Field '(DB1) WJA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WJAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL##USR     WJAYNA           User Id
     C                     MOVEL##JOB     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
     C           KLCRSM    KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJHGCD           Item Code
     C                     KFLD           WJAJCD           Warehouse Code
      * Check for duplicate primary key
     C           KLCRSM    SETLL@B0REJT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0329' W0RTN   7
      * Send message 'Item Balance           EX'
     C                     MOVEL'USR0329' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C                     WRITE@B0REJT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Phys. Start Date   RT - Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WN0004           Physical Start
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKAIC3    WQSN01           Company Number
     C           *LIKE     DEFN WKAJCD    WQSN02           Warehouse Code
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Company Number
     C                     KFLD           WQSN02           Warehouse Code
      * Setup key
     C                     Z-ADDWUAIC3    WQSN01           Company Number
     C                     MOVELWEUYCD    WQSN02           Warehouse Code
      * Establish starting position
     C           KRSSN     SETLL@B1RELK                    *
     C           KRSSN     READE@B1RELK                  90*
      * Data record not found
     C   90                MOVEL'USR0330' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Physical Start Date is entered
     C           WKDHDT    IFNE *ZERO                      *IF
      * PAR = DB1 By name
     C                     Z-ADDWKDHDT    WN0004           Physical Start
     C                     GOTO SNEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSN     READE@B1RELK                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCHRC    BEGSR
      *================================================================
      * Chg AS Physical Count  CH - Item Balance Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0034 112       Physical Count
     C                     Z-ADD*ZERO     WN0035 112       Physical Count
     C                     Z-ADD*ZERO     WN0036 112       Physical Count
     C                     Z-ADD*ZERO     WN0037 112       Physical Count
     C                     MOVEL*BLANK    WN0038  1        Physical Count
     C                     Z-ADD*ZERO     WN0039 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0040 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0041 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0042 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0043 112       Quantity In Chi
     C                     Z-ADD*ZERO     WN0044 112       Weight In Chill
     C                     MOVEL*BLANK    WN0045  1        Update Exceptio
     C                     Z-ADD*ZERO     WN0046 112       Physical Start
     C                     Z-ADD*ZERO     WN0047 112       Physical Start
     C                     Z-ADD*ZERO     WN0048 112       Physical Start
     C                     Z-ADD*ZERO     WN0049 112       Physical Start
     C                     Z-ADD*ZERO     WN0050  70       Physical Start
     C                     Z-ADD*ZERO     WN0051 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0052 114       Last Cost
     C                     Z-ADD*ZERO     WN0053 112       Value of On Han
     C                     Z-ADD*ZERO     WN0054  30       Item Structure
     C                     Z-ADD*ZERO     WN0055  30       Item Structure
     C                     Z-ADD*ZERO     WN0056  30       Item Structure
     C                     MOVEL*BLANK    WN0057  1        EDI Status 1
     C                     MOVEL*BLANK    WN0058  1        EDI Status 2
     C                     MOVEL*BLANK    WN0059  1        EDI Status 3
     C                     MOVEL*BLANK    WN0060  1        Record Status
     C                     Z-ADD*ZERO     WN0061  60       Job Time
     C                     MOVEL*BLANK    WN0062 10        User Id
     C                     MOVEL*BLANK    WN0063 10        Job Name
     C                     Z-ADD*ZERO     WN0064  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @B1REJ1
     C                     Z-ADDWUAIC3    WLAIC3           Company Number
     C                     Z-ADDWUHGCD    WLHGCD           Item Code
     C                     MOVELWEUYCD    WLAJCD    P      Warehouse Code
     C                     Z-ADDWUELDT    WLELDT           Production Date
      *
     C           KLCHSO    KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLHGCD           Item Code
     C                     KFLD           WLAJCD           Warehouse Code
     C                     KFLD           WLELDT           Production Date
     C           KLCHSO    CHAIN@B1REJ1              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * USER: Processing if Data record not found
      * Rtv Item Typ/Grp/Cls  RT - Company/Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0007           Company Number
     C                     Z-ADDWUHGCD    WL0008           Item Code
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0009    WN0054           Item Structure
     C                     Z-ADDWL0010    WN0055           Item Structure
     C                     Z-ADDWL0011    WN0056           Item Structure
      * Crt AS Physical Count  CR - Item Balance Detail  * 
     C                     EXSR SPCRRC
     C           W0RTN     IFNE *BLANK                     IF
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB1REL1'MDACP
     C                     MOVEL'@B1REJ1' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     ENDIF
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB11    YARDCS
      * Move non-key fields to @B1REJ1
     C                     Z-ADDWUK7DT    WLK7DT           Label Date
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB11    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     MOVEL'Y'       YARDC            *Record Data Ch
      * CASE: DB1.Physical Start Date is not entered
     C           WLDHDT    IFEQ *ZERO                      *IF
     C                     Z-ADDWN0004    WLDHDT           Physical Start
     C                     END                             *FI
     C                     ADD  WUAHWG    WLABWG           Physical Count
     C                     ADD  WUA5QT    WLAGQT           Physical Count
     C                     MOVEL'P'       WLCTST           Physical Count
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WLAATM           Job Time
     C                     MOVEL##USR     WLAYNA           User Id
     C                     MOVEL##JOB     WLA0NA           Job Name
     C                     Z-ADD##JDT     WLAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QCAB11    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@B1REJ1                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB1REL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPCRRC    BEGSR
      *================================================================
      * Crt AS Physical Count  CR - Item Balance Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0065  60       Job Time
     C                     MOVEL*BLANK    WN0066 10        User Id
     C                     MOVEL*BLANK    WN0067 10        Job Name
     C                     Z-ADD*ZERO     WN0068  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1REJ1
     C                     Z-ADDWUAIC3    WLAIC3           Company Number
     C                     Z-ADDWUHGCD    WLHGCD           Item Code
     C                     MOVELWEUYCD    WLAJCD           Warehouse Code
     C                     Z-ADDWUELDT    WLELDT           Production Date
     C                     Z-ADDWUAHWG    WLABWG           Physical Count
     C                     Z-ADDWUA5QT    WLAGQT           Physical Count
     C                     Z-ADD*ZERO     WLAHQT           Physical Count
     C                     Z-ADD*ZERO     WLAIQT           Physical Count
     C                     MOVEL'P'       WLCTST           Physical Count
     C                     Z-ADD*ZERO     WLACWG           Quantity on Han
     C                     Z-ADD*ZERO     WLARQT           Quantity on Han
     C                     Z-ADD*ZERO     WLASQT           Quantity on Han
     C                     Z-ADD*ZERO     WLATQT           Quantity on Han
     C                     Z-ADD*ZERO     WLHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WLHEQT           Weight In Chill
     C                     MOVEL'N'       WLF6ST           Update Exceptio
     C                     Z-ADD*ZERO     WLBMWG           Physical Start
     C                     Z-ADD*ZERO     WLDSQT           Physical Start
     C                     Z-ADD*ZERO     WLDTQT           Physical Start
     C                     Z-ADD*ZERO     WLDUQT           Physical Start
     C                     Z-ADDWN0004    WLDHDT           Physical Start
     C                     Z-ADD*ZERO     WLAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WLAECS           Last Cost
     C                     Z-ADD*ZERO     WLIDVA           Value of On Han
     C                     Z-ADDWUK7DT    WLK7DT           Label Date
     C                     Z-ADDWN0054    WLRINB           Item Structure
     C                     Z-ADDWN0055    WLRHNB           Item Structure
     C                     Z-ADDWN0056    WLRGNB           Item Structure
     C                     MOVEL*BLANK    WLUVST           EDI Status 1
     C                     MOVEL*BLANK    WLUWST           EDI Status 2
     C                     MOVEL*BLANK    WLUXST           EDI Status 3
     C                     MOVEL'A'       WLVSST           Record Status
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WLAATM           Job Time
     C                     MOVEL##USR     WLAYNA           User Id
     C                     MOVEL##JOB     WLA0NA           Job Name
     C                     Z-ADD##JDT     WLAXDT           Job Date
     C           KLCRSP    KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLHGCD           Item Code
     C                     KFLD           WLAJCD           Warehouse Code
     C                     KFLD           WLELDT           Production Date
      * Check for duplicate primary key
     C           KLCRSP    SETLL@B1REJ1                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0331' W0RTN   7
      * Send message 'Item Balance Detail    EX'
     C                     MOVEL'USR0331' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C                     WRITE@B1REJ1                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQCHRC    BEGSR
      *================================================================
      * CHG Inventory Restorat CH - AS Inventory Restoration  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0069 25        AS Product Desc
     C                     MOVEL*BLANK    WN0070  6        AS Container To
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @KACPE5
     C                     MOVELWEASPD    WMASPD    P      AS Product Code
     C                     MOVELWEUYCD    WMUYCD    P      AS Warehouse ID
     C                     MOVELWEASP6    WMASP6    P      AS Label Date 6
      *
     C           KLCHSQ    KLIST
     C                     KFLD           WMASPD           AS Product Code
     C                     KFLD           WMUYCD           AS Warehouse ID
     C                     KFLD           WMASP6           AS Label Date 6
     C           KLCHSQ    CHAIN@KACPE5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDKACPL0'MDACP
     C                     MOVEL'@KACPE5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SQEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDKA1    YBRDCS
      * Move non-key fields to @KACPE5
     C                     MOVELWEEMWG    WMEMWG    P      AS Total Net We
     C                     MOVELWEXXCD    WMXXCD    P      AS Production D
     C                     MOVELWN0009    WMTVCD    P      AS Carriage Ret
      *
      * Set PGM.*Record Data Changed flag
     C           QPDKA1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@KACPE5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDKACPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV Alpha Value        RT - Company Values  * Post Restoration G
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WOAIC3           Company Number
     C                     KFLD           WOV8CD           Company Value C
      * Setup key
     C                     Z-ADDWL0012    WOAIC3           Company Number
     C                     MOVELWL0013    WOV8CD           Company Value C
      * Establish starting position
     C           KRSSR     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWOBXTX    WL0014           System Value Al
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Automatically Post the Restoration
      *================================================================
      * RTV Alpha Value        RT - Company Values  * Post Restoration GP
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0012           Company Number
     C                     MOVEL@CN,04    WL0013    P      Company Value C
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0014    YL0004    P      System Value Al
     C                     MOVELYL0004    YL0005           Process Post US
      * CASE: LCL.Process Post USR is yes
     C           YL0005    IFEQ 'Y'                        *IF
      * *
      * ***** Print Physical to Book Comparison *****
      * RTV Alpha Value        RT - Company Values  * Printer 1
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0012           Company Number
     C                     MOVEL@CN,05    WL0013    P      Company Value C
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0014    YL0004    P      System Value Al
     C                     MOVELYL0004    YL0006           PRT Printer Dev
     C                     Z-ADDWUAIC3    YL0007           Company Number
     C                     Z-ADD01        YL0008           Copies 15.5
      * Prt Phy-Book Comp     CL - Physical Count Control  * 
     C                     CALL 'ICPYCLP'              90  Prt Phy-Book Co
     C                     PARM YL0007    WQ0058 155       Company Number
     C                     PARM WN0007    WQ0059  3        Warehouse Code
     C                     PARM 'WP'      WQ0060  3        Cycle Count Cod
     C                     PARM 'Y'       WQ0061  1        Prt Non-Zero Qt
     C                     PARM 'I/C'     WQ0062  6        Application Cod
     C                     PARM YL0006    WQ0063 10        PRT Printer Dev
     C                     PARM '*NO'     WQ0064  4        PRT Hold Output
     C                     PARM '*YES'    WQ0065  4        PRT Save Output
     C                     PARM YL0008    WQ0066 155       Copies 15.5
     C                     PARM '*JOBD'   WQ0067 10        PRT Night Queue
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ICPYCLP' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * *
      * Post Flag - indicates to mark the Exceptions prior to posting.
      * Prt AS Restoration Exc UP - /UT User Programs  * 
     C                     CALL 'POKSUPC'              90  Prt AS Restorat
     C                     PARM YL0009    WQ0068  7        Return Code Usr
     C                     PARM YL0006    WQ0069 10        PRT Printer Dev
     C                     PARM '*YES'    WQ0070  4        PRT Hold Output
     C                     PARM '*YES'    WQ0071  4        PRT Save Output
     C                     PARM YL0007    WQ0072 155       Company Number
     C                     PARM 1         WQ0073 155       System Value Nu
     C                     PARM WN0007    WQ0074  3        Warehouse Code
     C                     PARM 'WP'      WQ0075  3        Cycle Count Cod
     C                     PARM 'Y'       WQ0076  1        Exclude Immtrl
     C                     PARM 'Y'       WQ0077  1        Exclude Scale/C
     C                     PARM 'Y'       WQ0078  1        Exclude WIPs
     C                     PARM 'Y'       WQ0079  1        Exclude 9xxxx(n
     C                     PARM 'Y'       WQ0080  1        Exclude Sold Fr
     C                     PARM 'Y'       WQ0081  1        Exclude neg QOH
     C                     PARM 'Y'       WQ0082  1        Mark Exception
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POKSUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * Post Restoration
      * PRC Post Co/Whse/Open  XF - Physical Count Control  * 
     C                     CALL 'PDNXXFR'              90  PRC Post Co/Whs
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUAIC3    WQ0083  30       Company Number
     C                     PARM WN0007    WQ0084  3        Warehouse Code
     C                     PARM 'WP'      WQ0085  3        Cycle Count Cod
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDNXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Warehouse Code
     C                     MOVEL*BLANK    WUAJCD  3
      * Define work field Company Number
     C                     Z-ADD*ZERO     WUAIC3  30
      * Define work field Salesperson Code
     C                     MOVEL*BLANK    WUBCCD  3
      * Define work field Allow Multi-Company
     C                     MOVEL*BLANK    WUI6ST  1
      * Define work field Default Printer
     C                     MOVEL*BLANK    WUMPNA 10
      * Define work field Name
     C                     MOVEL*BLANK    WUADTX 30
      * Define work field System Value Alpha
     C                     MOVEL*BLANK    WUBXTX 40
      * Define work field Access Denied (Y/N)
     C                     MOVEL*BLANK    WUWVST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WANLNB           Entity Number
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Initialize renamed input format fields
      * Define work field Text USR 5
     C                     MOVEL*BLANK    WUY7TX  5
      * Define work field Return Code Usr
     C                     MOVEL*BLANK    WUH3TX  7
      * Define work field Item Code
     C                     Z-ADD*ZERO     WUHGCD  70
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Calc 5
     C                     Z-ADD*ZERO     WUTSNB  50
      * Define work field Default Warehouse
     C                     MOVEL*BLANK    WUQ1CD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFHGCD           Item Code
     C                     Z-ADD*ZERO     WFAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WFAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WFAIWG           Unit Weight
     C                     Z-ADD*ZERO     WFCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WFC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WFURTN           Number Cases On
     C                     Z-ADD*ZERO     WFAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WFRINB           Item Structure
     C                     Z-ADD*ZERO     WFRHNB           Item Structure
     C                     Z-ADD*ZERO     WFRGNB           Item Structure
     C                     Z-ADD*ZERO     WFTFNB           Transportation
     C                     Z-ADD*ZERO     WFTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WFTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WFBLPR           Market Overage
     C                     Z-ADD*ZERO     WFBMPR           Standard Overag
     C                     Z-ADD*ZERO     WFCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WFCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WFSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WFPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WFICN1           Item Category N
     C                     Z-ADD*ZERO     WFICN2           Item Category N
     C                     Z-ADD*ZERO     WFV2NB           Item Category N
     C                     Z-ADD*ZERO     WFITCN           Item Category N
     C                     Z-ADD*ZERO     WFITC5           Item Category N
     C                     Z-ADD*ZERO     WFICN6           Item Category N
     C                     Z-ADD*ZERO     WFICN7           Item Category N
     C                     Z-ADD*ZERO     WFICN8           Item Category N
     C                     Z-ADD*ZERO     WFICN9           Item Category N
     C                     Z-ADD*ZERO     WFICN0           Item Category N
     C                     Z-ADD*ZERO     WFSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WFA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WFSJNB           CI Unused Numbe
     C                     Z-ADD*ZERO     WFSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WFSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WFSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WFCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WFCGNB           PM Line Time Ef
     C                     Z-ADD*ZERO     WFILNB           PM % 2nds Facto
     C                     Z-ADD*ZERO     WFCHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WFCINB           PM Batch Size
     C                     Z-ADD*ZERO     WFCJNB           PM Lot Size
     C                     Z-ADD*ZERO     WFCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WFCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WFCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WFCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WFCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WFCWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WFCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WFCZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WFC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WFB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WFB5NB           PM Line Number
     C                     Z-ADD*ZERO     WFBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WFBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WFF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WFF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WFF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WFBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WFBNNB           Production Qty
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WGBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WGBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WGBUC3           WHS Unused Comp
     C                     Z-ADD*ZERO     WGBVC3           WHS Unused Comp
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Define work field Label Date USR
     C                     Z-ADD*ZERO     WUMHNX  60
      * Define work field Label Date
     C                     Z-ADD*ZERO     WUK7DT  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHBCDT           Post to G/L Dat
     C                     Z-ADD*ZERO     WHCQNB           Julian Date
     C                     Z-ADD*ZERO     WHESNB           Accounting Year
     C                     Z-ADD*ZERO     WHETNB           Accounting Peri
     C                     Z-ADD*ZERO     WHBZNB           OM Week
     C                     Z-ADD*ZERO     WHEINB           Week Number
     C                     Z-ADD*ZERO     WHAQNB           Billing Cycle
     C                     Z-ADD*ZERO     WHOJDT           HPS PIC Date
     C                     Z-ADD*ZERO     WHNQNX           HPS Calendar Ye
     C                     Z-ADD*ZERO     WHNRNX           HPS Calendar We
     C                     Z-ADD*ZERO     WHOKDT           Calendar Unused
     C                     Z-ADD*ZERO     WHOLDT           Calendar Unused
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Define work field Prod Date USR
     C                     Z-ADD*ZERO     WUMGNX  60
      * Define work field Production Date
     C                     Z-ADD*ZERO     WUELDT  70
      * Define work field Unit Cost Per Pound
     C                     Z-ADD*ZERO     WUAGCS 114
      * Define work field Cost Update Pending
     C                     MOVEL*BLANK    WUJ9ST  1
      * Define work field Post G/L Status
     C                     MOVEL*BLANK    WUKBST  1
      * Define work field Vendor - Item/Whse Deflt.
     C                     Z-ADD*ZERO     WUAKC8  80
      * Define work field Record Status
     C                     MOVEL*BLANK    WUVSST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIHGCD           Item Code
     C                     Z-ADD*ZERO     WIAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WIAECS           Last Cost
     C                     Z-ADD*ZERO     WIBACS           Cost per Primar
     C                     Z-ADD*ZERO     WIBBCS           Cost per Pricin
     C                     Z-ADD*ZERO     WICBPR           Revaluation Cos
     C                     Z-ADD*ZERO     WIGUDT           Revaluation Eff
     C                     Z-ADD*ZERO     WICTPR           Last Revaluatio
     C                     Z-ADD*ZERO     WIG4DT           Last Revaluatio
     C                     Z-ADD*ZERO     WIBOWG           On Hand Weight
     C                     Z-ADD*ZERO     WIDDQT           On Hand U/M1 Su
     C                     Z-ADD*ZERO     WIDEQT           On Hand U/M2 Su
     C                     Z-ADD*ZERO     WIDFQT           On Hand U/M3 Su
     C                     Z-ADD*ZERO     WIHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WIHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WIAJQT           Quantity Schedu
     C                     Z-ADD*ZERO     WIAQQT           Quantity on Sal
     C                     Z-ADD*ZERO     WIAUQT           Quantity on Pur
     C                     Z-ADD*ZERO     WIEMQT           Quantity on Tra
     C                     Z-ADD*ZERO     WIDOQT           Quantity Avail.
     C                     Z-ADD*ZERO     WIAKDT           Date of Last Or
     C                     Z-ADD*ZERO     WIANDT           Date of Last Sh
     C                     Z-ADD*ZERO     WIIDVA           Value of On Han
     C                     Z-ADD*ZERO     WIBZPC           Safety Allowanc
     C                     Z-ADD*ZERO     WIDGQT           Safety Allowanc
     C                     Z-ADD*ZERO     WIDIDT           Stock Out Date
     C                     Z-ADD*ZERO     WIBFDY           Lead Time - Las
     C                     Z-ADD*ZERO     WIDJDT           Lead Time - Dat
     C                     Z-ADD*ZERO     WIBGDY           Lead Time - Nex
     C                     Z-ADD*ZERO     WIDKDT           Lead Time - Dat
     C                     Z-ADD*ZERO     WIDJQT           Usage Qty per C
     C                     Z-ADD*ZERO     WIBNWG           Usage Weight pe
     C                     Z-ADD*ZERO     WIDLDT           Inventory Manag
     C                     Z-ADD*ZERO     WIDPQT           Minimum Quantit
     C                     Z-ADD*ZERO     WIDQQT           Maximum Quantit
     C                     Z-ADD*ZERO     WIDMDT           Last Physical C
     C                     Z-ADD*ZERO     WIAKC8           Vendor - Item/W
     C                     Z-ADD*ZERO     WIRINB           Item Structure
     C                     Z-ADD*ZERO     WIRHNB           Item Structure
     C                     Z-ADD*ZERO     WIRGNB           Item Structure
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Define work field Pricing Date Used
     C                     Z-ADD*ZERO     WUGIDT  70
      * Define work field Cost per Primary U/M
     C                     Z-ADD*ZERO     WUBACS 114
      * Define work field Price Status
     C                     MOVEL*BLANK    WUU1ST  1
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field Item Structure Class Code
     C                     Z-ADD*ZERO     WURINB  30
      * Define work field Item Structure Group Code
     C                     Z-ADD*ZERO     WURHNB  30
      * Define work field Item Structure Type Code
     C                     Z-ADD*ZERO     WURGNB  30
      * Clear all neither parameters
      * Crt Item Balance       CR - Item Balance  * 
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKHGCD           Item Code
     C                     Z-ADD*ZERO     WKELDT           Production Date
     C                     Z-ADD*ZERO     WKABWG           Physical Count
     C                     Z-ADD*ZERO     WKAGQT           Physical Count
     C                     Z-ADD*ZERO     WKAHQT           Physical Count
     C                     Z-ADD*ZERO     WKAIQT           Physical Count
     C                     Z-ADD*ZERO     WKACWG           Quantity on Han
     C                     Z-ADD*ZERO     WKARQT           Quantity on Han
     C                     Z-ADD*ZERO     WKASQT           Quantity on Han
     C                     Z-ADD*ZERO     WKATQT           Quantity on Han
     C                     Z-ADD*ZERO     WKHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WKHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WKBMWG           Physical Start
     C                     Z-ADD*ZERO     WKDSQT           Physical Start
     C                     Z-ADD*ZERO     WKDTQT           Physical Start
     C                     Z-ADD*ZERO     WKDUQT           Physical Start
     C                     Z-ADD*ZERO     WKDHDT           Physical Start
     C                     Z-ADD*ZERO     WKAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WKAECS           Last Cost
     C                     Z-ADD*ZERO     WKIDVA           Value of On Han
     C                     Z-ADD*ZERO     WKK7DT           Label Date
     C                     Z-ADD*ZERO     WKRINB           Item Structure
     C                     Z-ADD*ZERO     WKRHNB           Item Structure
     C                     Z-ADD*ZERO     WKRGNB           Item Structure
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Define work field Calc 6
     C                     Z-ADD*ZERO     WUTTNB  60
      * Define work field Transaction Quantity
     C                     Z-ADD*ZERO     WUA5QT 112
      * Define work field Calc 7
     C                     Z-ADD*ZERO     WUTVNB  70
      * Define work field Transaction Weight
     C                     Z-ADD*ZERO     WUAHWG 112
      * Clear all neither parameters
      * Crt AS Physical Count  CR - Item Balance Detail  * 
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOAIC3           Company Number
     C                     Z-ADD*ZERO     WOM8NB           System Value Nu
     C                     Z-ADD*ZERO     WOAATM           Job Time
     C                     Z-ADD*ZERO     WOAXDT           Job Date
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SBRVGN.
     C                     MOVEL*BLANK    WL0001 10
     C                     MOVEL*BLANK    WL0002  6
     C                     Z-ADD*ZERO     WL0003  30
     C                     MOVEL*BLANK    WL0004  3
      * Define local variables for subroutine SIRVGN.
     C                     Z-ADD*ZERO     WL0005  30
     C                     Z-ADD*ZERO     WL0006  70
      * Define local variables for subroutine SLRVGN.
     C                     Z-ADD*ZERO     WL0007  30
     C                     Z-ADD*ZERO     WL0008  70
     C                     Z-ADD*ZERO     WL0009  30
     C                     Z-ADD*ZERO     WL0010  30
     C                     Z-ADD*ZERO     WL0011  30
      * Define local variables for subroutine SRRVGN.
     C                     Z-ADD*ZERO     WL0012  30
     C                     MOVEL*BLANK    WL0013 10
     C                     MOVEL*BLANK    WL0014 40
      * Define local work field Upload Error USR
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Error Flag            USR
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field Item Type Code
     C                     MOVEL*BLANK    YL0003  3
      * Define local work field System Value Alpha
     C                     MOVEL*BLANK    YL0004 40
      * Define local work field Process Post USR
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field PRT Printer Device
     C                     MOVEL*BLANK    YL0006 10
      * Define local work field Company Number Pass   USR
     C                     Z-ADD*ZERO     YL0007 155
      * Define local work field Copies 15.5           USR
     C                     Z-ADD*ZERO     YL0008 155
      * Define local work field Return Code Usr
     C                     MOVEL*BLANK    YL0009  7
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Data Decimal Error
00002 ITMNOTNUM
00003 LABELDATE
00004 PSTRSTGP1
00005 PHYBKRPT3
00006 400-300-002
