             PGM        PARM(&ERROR &EVENT)
             DCL        VAR(&RETURN) TYPE(*CHAR) LEN(7)
             DCL        VAR(&FLIB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&HLIB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&EVENT) TYPE(*CHAR) LEN(2) VALUE('  ')
             DCL        VAR(&PDIM) TYPE(*CHAR) LEN(1) VALUE('N')
             DCL        VAR(&PDJK) TYPE(*CHAR) LEN(1) VALUE('N')
             DCL        VAR(&ERROR) TYPE(*CHAR) LEN(1) VALUE('N')
/*                                                              */
/* RETRIEVE DATA FILE LIBRARY FROM SYSTEM                       */
/*                                                              */
             CALL       PGM(CAQXXFR) PARM(&RETURN &FLIB &HLIB)
             IF COND(&FLIB *EQ '          ') THEN(DO)
             CHGVAR VAR(&ERROR) VALUE('Y')
             GOTO       CMDLBL(END)
             ENDDO
/*                                                                  */
/* PD ORDER DETAIL PRICING                                          */
/*                                                                  */
             IF         COND(&EVENT *EQ '**') THEN(DO)
/*                                                              */
/* MAKE CERTAIN THAT LIBRARY QTEMP IS FIRST ON LIBRARY LIST     */
/*                                                              */
             RMVLIBLE   LIB(QTEMP)
             MONMSG     MSGID(CPF0000)

             ADDLIBLE   LIB(QTEMP) POSITION(*FIRST)
             MONMSG     MSGID(CPF0000)

             CHKOBJ     OBJ(QTEMP/PDIMCPP) OBJTYPE(*FILE)
             MONMSG     MSGID(CPF9801) EXEC(CHGVAR VAR(&PDIM) +
                          VALUE('Y'))
NEXT1:
             CHKOBJ     OBJ(QTEMP/PDJKCPP) OBJTYPE(*FILE)
             MONMSG     MSGID(CPF9801) EXEC(CHGVAR VAR(&PDJK) +
                          VALUE('Y'))
             ENDDO

PDIMCPP:
/*                                                                 */
/* CREATE PHYSICAL AND LOGICAL ORDER DETAIL PRICING FILES TO QTEMP */
/*                                                                 */
             IF         COND(&PDIM *EQ 'Y') THEN(DO)
/*                                                                 */
             CRTDUPOBJ  OBJ(PDIMCPP) FROMLIB(&FLIB) OBJTYPE(*FILE) +
                          TOLIB(QTEMP) DATA(*NO)

             CRTDUPOBJ  OBJ(PDIMCPW0) FROMLIB(&FLIB) OBJTYPE(*FILE) +
                          TOLIB(QTEMP)

             CRTDUPOBJ  OBJ(PDIMCPW1) FROMLIB(&FLIB) OBJTYPE(*FILE) +
                          TOLIB(QTEMP)
             CRTDUPOBJ  OBJ(PDIMCPW2) FROMLIB(&FLIB) OBJTYPE(*FILE) +
                          TOLIB(QTEMP)
 /*                                                                 */
             ENDDO
 /*                                                                 */
 /* CREATE PHYSICAL AND LOGICAL ORDER DTL FORMULA FILES TO QTEMP    */
 /*                                                                 */

 /*                                                                 */
             IF         COND(&PDJK *EQ 'Y') THEN(DO)
 /*                                                                 */
             CRTDUPOBJ  OBJ(PDJKCPP) FROMLIB(&FLIB) OBJTYPE(*FILE) +
                          TOLIB(QTEMP) DATA(*NO)

             CRTDUPOBJ  OBJ(PDJKCPW0) FROMLIB(&FLIB) OBJTYPE(*FILE) +
                          TOLIB(QTEMP)

             CRTDUPOBJ  OBJ(PDJKCPW1) FROMLIB(&FLIB) OBJTYPE(*FILE) +
                          TOLIB(QTEMP)
             ENDDO


 END:        ENDPGM
