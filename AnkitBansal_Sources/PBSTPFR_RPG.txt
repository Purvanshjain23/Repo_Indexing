     H/TITLE Prt PFS Prd Sch Bt Dt PF  Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Print file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 11/19/19  Time  : 14:17:05
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPBB1CPL2IF  E           K        DISK
      * RSQ : PFS Prod Sched Batch Dtl Co/DtTm(D)/Tp/Gp/U/BC/Itm
      *
     FPBB1CPL1IF  E           K        DISK
      * RTV : PFS Prod Sched Batch Dtl  Retrieval index
      *
     FOME8REL0IF  E           K        DISK
      * RTV : Item Structure Type       Retrieval index
      *
     FOME9REL0IF  E           K        DISK
      * RTV : Item Structure Group      Retrieval index
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FPDIOREL1IF  E           K        DISK
      * RTV : Item Bill Of Material     Retrieval index
      *
     FCABZRELMIF  E           K        DISK
      * RTV : Company Item              ItmTyp=PS & PkgTyp=B
      *
     FPOAZCPL4IF  E           K        DISK
      * RSQ : Packaging BOM             Co/Item/Sel Bag Types
      *
     FPOARREL1IF  E           K        DISK
      * RTV : Packaging Item            Retrieval index
      *
     FPBSTPFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: Prt PFS Prd Sch Bt Dt PF  Print file
      *
     E                    #L3         3  1
      * Long constants
     E                    @CN#    1  02  6   @CN    25
     I@B1CPUT
      * PFS Prod Sched Batch Dtl  Retrieval index
      * Renamed input format fields
     I              B1Y1NX                          WAY1NX
     I              B1ASD8                          WAASD8
     I              B1AOTS                          WAAOTS
     I              B1TVAA                          WATVAA
     I              B1BTSQ                          WABTSQ
     I              B1P7DT                          WAP7DT
     I              B1Y2NX                          WAY2NX
     I              B1U2SX                          WAU2SX
     I              B1ZPNX                          WAZPNX
     I              B1ZXNX                          WAZXNX
     I              B1CSSC                          WACSSC
     I              B1ODQY                          WAODQY
     I              B1INAL                          WAINAL
     I              B1C6NB                          WAC6NB
     I              B1C8NB                          WAC8NB
     I              B1FLQ1                          WAFLQ1
     I              B1FLQ2                          WAFLQ2
     I              B1ZGNX                          WAZGNX
     I              B1ZWNX                          WAZWNX
     I              B1ZSNX                          WAZSNX
     I              B1ZJNX                          WAZJNX
     I              B1ZKNX                          WAZKNX
     I              B1DNNB                          WADNNB
     I              B1DONB                          WADONB
     I              B1DRNB                          WADRNB
     I              B1U0SX                          WAU0SX
     I              B1BZSC                          WABZSC
     I              B1B3SC                          WAB3SC
     I              B1B0SC                          WAB0SC
     I              B1VISX                          WAVISX
     I              B1ZLSX                          WAZLSX
     I              B1VGSX                          WAVGSX
     I              B1OJU1                          WAOJU1
     I              B1UWSX                          WAUWSX
     I              B1UXSX                          WAUXSX
     I              B1V3SX                          WAV3SX
     I              B1AHNY                          WAAHNY
     I              B1AINY                          WAAINY
     I              B1AJNY                          WAAJNY
     I              B1AKNY                          WAAKNY
      *
     I@BZREG0
      * Company Item              ItmTyp=PS & PkgTyp=B
      * Renamed input format fields
     I              BZAIC3                          WBAIC3
     I              BZHGCD                          WBHGCD
     I              BZAVNA                          WBAVNA
     I              BZAWNA                          WBAWNA
     I              BZL7NA                          WBL7NA
     I              BZL8NA                          WBL8NA
     I              BZL6NA                          WBL6NA
     I              BZMFNA                          WBMFNA
     I              BZADCD                          WBADCD
     I              BZAWPC                          WBAWPC
     I              BZLXST                          WBLXST
     I              BZAECD                          WBAECD
     I              BZAXPC                          WBAXPC
     I              BZLYST                          WBLYST
     I              BZAFCD                          WBAFCD
     I              BZAICD                          WBAICD
     I              BZAIWG                          WBAIWG
     I              BZHICD                          WBHICD
     I              BZRBCD                          WBRBCD
     I              BZFZST                          WBFZST
     I              BZAVST                          WBAVST
     I              BZCZWG                          WBCZWG
     I              BZC0WG                          WBC0WG
     I              BZURTN                          WBURTN
     I              BZAJC8                          WBAJC8
     I              BZRINB                          WBRINB
     I              BZRHNB                          WBRHNB
     I              BZRGNB                          WBRGNB
     I              BZLNCD                          WBLNCD
     I              BZTFNB                          WBTFNB
     I              BZN0CD                          WBN0CD
     I              BZX4ST                          WBX4ST
     I              BZTMVA                          WBTMVA
     I              BZTNVA                          WBTNVA
     I              BZBLPR                          WBBLPR
     I              BZBMPR                          WBBMPR
     I              BZLRCD                          WBLRCD
     I              BZU9ST                          WBU9ST
     I              BZCMCO                          WBCMCO
     I              BZQ1CD                          WBQ1CD
     I              BZQ8CD                          WBQ8CD
     I              BZCHTM                          WBCHTM
     I              BZQZCD                          WBQZCD
     I              BZXWST                          WBXWST
     I              BZXXST                          WBXXST
     I              BZVMST                          WBVMST
     I              BZSWGH                          WBSWGH
     I              BZPPHE                          WBPPHE
     I              BZR3CD                          WBR3CD
     I              BZSDCD                          WBSDCD
     I              BZICN1                          WBICN1
     I              BZSVCD                          WBSVCD
     I              BZICN2                          WBICN2
     I              BZSWCD                          WBSWCD
     I              BZV2NB                          WBV2NB
     I              BZSXCD                          WBSXCD
     I              BZITCN                          WBITCN
     I              BZSYCD                          WBSYCD
     I              BZITC5                          WBITC5
     I              BZSZCD                          WBSZCD
     I              BZICN6                          WBICN6
     I              BZS0CD                          WBS0CD
     I              BZICN7                          WBICN7
     I              BZS1CD                          WBS1CD
     I              BZICN8                          WBICN8
     I              BZS2CD                          WBS2CD
     I              BZICN9                          WBICN9
     I              BZS3CD                          WBS3CD
     I              BZICN0                          WBICN0
     I              BZS4CD                          WBS4CD
     I              BZSFNB                          WBSFNB
     I              BZA3WG                          WBA3WG
     I              BZSJNB                          WBSJNB
     I              BZLLCD                          WBLLCD
     I              BZLMCD                          WBLMCD
     I              BZP3ST                          WBP3ST
     I              BZSKNB                          WBSKNB
     I              BZSLNB                          WBSLNB
     I              BZSMNB                          WBSMNB
     I              BZP4ST                          WBP4ST
     I              BZCFNB                          WBCFNB
     I              BZCGNB                          WBCGNB
     I              BZILNB                          WBILNB
     I              BZCHNB                          WBCHNB
     I              BZCINB                          WBCINB
     I              BZCJNB                          WBCJNB
     I              BZCMNB                          WBCMNB
     I              BZCNNB                          WBCNNB
     I              BZCRNB                          WBCRNB
     I              BZCSNB                          WBCSNB
     I              BZCVNB                          WBCVNB
     I              BZCWNB                          WBCWNB
     I              BZCXNB                          WBCXNB
     I              BZCZNB                          WBCZNB
     I              BZC0NB                          WBC0NB
     I              BZN1CD                          WBN1CD
     I              BZB4NB                          WBB4NB
     I              BZB5NB                          WBB5NB
     I              BZX5ST                          WBX5ST
     I              BZX6ST                          WBX6ST
     I              BZX7ST                          WBX7ST
     I              BZPCCT                          WBPCCT
     I              BZBDNB                          WBBDNB
     I              BZBJNB                          WBBJNB
     I              BZSUST                          WBSUST
     I              BZSVST                          WBSVST
     I              BZSYST                          WBSYST
     I              BZSZST                          WBSZST
     I              BZS1ST                          WBS1ST
     I              BZXRCD                          WBXRCD
     I              BZXTCD                          WBXTCD
     I              BZXUCD                          WBXUCD
     I              BZF5WG                          WBF5WG
     I              BZF6WG                          WBF6WG
     I              BZF7WG                          WBF7WG
     I              BZBLNB                          WBBLNB
     I              BZBNNB                          WBBNNB
     I              BZS2ST                          WBS2ST
     I              BZS4ST                          WBS4ST
     I              BZS5ST                          WBS5ST
     I              BZS6ST                          WBS6ST
     I              BZS8ST                          WBS8ST
     I              BZS9ST                          WBS9ST
     I              BZTCST                          WBTCST
     I              BZTDST                          WBTDST
     I              BZUVST                          WBUVST
     I              BZUWST                          WBUWST
     I              BZUXST                          WBUXST
     I              BZVSST                          WBVSST
     I              BZAATM                          WBAATM
     I              BZAYNA                          WBAYNA
     I              BZA0NA                          WBA0NA
     I              BZAXDT                          WBAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXDI8T       DS
      * Internal date
     I                                        1   80XDI8DT
     I                                        1   40XDI8CY
     I                                        1   10XDI8CC
     I                                        2   40XDI8YY
     I                                        5   60XDI8MM
     I                                        7   80XDI8DD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS                             33
      * KEY: PFS Prod Sched Batch Dtl Co/DtTm(D)/Tp/Gp/U/BC/Itm
      * I : RST PFS Company Number
     I                                        1   30P1Y1NX
      * I : RST PFS Batch Date
     I                                        4  110P1ASD8
      * I : RST PFS Batch Time
     I                                       12  170P1AOTS
     IP2PARM      DS
      * FLD: PFS Prod Sched Batch Hdr
      * I :  PFS User ID
     I                                        1  10 P2TVAA
      * I :  PFS Baseline Schedule
     I                                       11  11 P2B0SC
      * I :  PFS Process Status
     I                                       12  120P2UXSX
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C                     PARM           P1PARM           KEY: PFS Prod S
     C           P2TVAA    PARM           WP0001 10        PFS User ID
     C           P2B0SC    PARM           WP0002  1        PFS Baseline Sc
     C           P2UXSX    PARM           WP0003  10       PFS Process Sta
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prt PFS Prd Sch Bt Dt PF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$FENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * Prt PFS Prd Sch Bt Dt PF: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN B1Y1NX    WQKA01           PFS Company Num
     C           *LIKE     DEFN B1ASD8    WQKA02           PFS Batch Date
     C           *LIKE     DEFN B1AOTS    WQKA03           PFS Batch Time
      * Define keylist
     C           KRSA      KLIST
     C                     KFLD           WQKA01           PFS Company Num
     C                     KFLD           WQKA02           PFS Batch Date
     C                     KFLD           WQKA03           PFS Batch Time
      * Setup key
     C                     Z-ADDP1Y1NX    WQKA01           PFS Company Num
     C                     Z-ADDP1ASD8    WQKA02           PFS Batch Date
     C                     Z-ADDP1AOTS    WQKA03           PFS Batch Time
      * Establish starting position
     C           KRSA      SETLL@B1CPVB                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        PFS Company Num
     C                     MOVEL'Y'       W0AL01  1        PFS Batch Date
     C                     MOVEL'Y'       W0AL02  1        PFS Batch Time
     C                     MOVEL'Y'       W0AL03  1        PFS Item Struct
     C                     MOVEL'Y'       W0AL04  1        PFS Item Struct
     C                     MOVEL'Y'       W0AL05  1        PFS Primary UOM
     C                     MOVEL'Y'       W0AL06  1        PFS Base/Conver
     C                     MOVEL'Y'       W0AL07  1        PFS Item Code
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP01  1
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP02  1
     C                     END
      *
     C           W0AL03    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDB1Y1NX    $CY1NX           PFS Company Num
     C                     Z-ADDB1ASD8    $CASD8           PFS Batch Date
     C                     Z-ADDB1AOTS    $CAOTS           PFS Batch Time
     C                     MOVELB1U2SX    $CU2SX           PFS Label Type
     C                     Z-ADDB1DNNB    $CDNNB           PFS Item Struct
     C                     MOVEL*BLANK    $CDCTX           Item Structure
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP03  1
     C                     END
      *
     C           W0AL04    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDB1Y1NX    $DY1NX           PFS Company Num
     C                     Z-ADDB1ASD8    $DASD8           PFS Batch Date
     C                     Z-ADDB1AOTS    $DAOTS           PFS Batch Time
     C                     Z-ADDB1DNNB    $DDNNB           PFS Item Struct
     C                     Z-ADDB1DONB    $DDONB           PFS Item Struct
     C                     MOVEL*BLANK    $DDDTX           Item Structure
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP04  1
     C                     END
      *
     C           W0AL05    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP05  1
     C                     END
      *
     C           W0AL06    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP06  1
     C                     END
      *
     C           W0AL07    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP07  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDB1Y1NX    $EY1NX           PFS Company Num
     C                     Z-ADDB1ASD8    $EASD8           PFS Batch Date
     C                     Z-ADDB1AOTS    $EAOTS           PFS Batch Time
     C                     MOVELB1TVAA    $ETVAA           PFS User ID
     C                     Z-ADDB1BTSQ    $EBTSQ           PFS Batch Seq
     C                     Z-ADDB1P7DT    $EP7DT           PFS Production
     C                     Z-ADDB1Y2NX    $EY2NX           PFS Item Code
     C                     MOVEL*BLANK    $EAVNA           Description Lin
     C                     Z-ADDB1C6NB    $EC6NB           PFS Fill Qty Pr
     C                     Z-ADDB1C8NB    $EC8NB           PFS Fill Qty Sh
     C                     Z-ADDB1FLQ1    $EFLQ1           PFS Fill Qty Sh
     C                     Z-ADDB1FLQ2    $EFLQ2           PFS Fill Qty Sh
     C                     Z-ADDB1ODQY    $EODQY           PFS Ordered Qty
     C                     Z-ADDB1ZSNX    $EZSNX           PFS Scheduled S
     C                     Z-ADDB1DNNB    $EDNNB           PFS Item Struct
     C                     Z-ADDB1DONB    $EDONB           PFS Item Struct
     C                     Z-ADDB1DRNB    $EDRNB           PFS Item Struct
     C                     MOVEL*BLANK    $ENYNA           Box Description
     C                     MOVEL*BLANK    $EBRAA           Packaging Item
     C                     MOVEL*BLANK    $EELU1           Done Usr
     C                     MOVEL*BLANK    $EEMU1           Need Usr
     C                     MOVELB1U0SX    $EU0SX           PFS Primary UOM
     C                     MOVELB1B3SC    $EB3SC           PFS Base/Conver
     C                     MOVELB1BZSC    $EBZSC           PFS Fresh/Froze
     C                     MOVELB1U2SX    $EU2SX           PFS Label Type
     C                     Z-ADDB1ZPNX    $EZPNX           PFS Order Numbe
     C                     Z-ADDB1ZXNX    $EZXNX           PFS Order Line
     C                     MOVELB1CSSC    $ECSSC           PFS Order Line
     C                     Z-ADDB1ZGNX    $EZGNX           PFS Load ID
     C                     Z-ADDB1ZWNX    $EZWNX           PFS Loading Seq
     C                     Z-ADDB1INAL    $EINAL           PFS Inventory A
     C                     Z-ADDB1ZJNX    $EZJNX           PFS Load Deadli
     C                     Z-ADDB1ZKNX    $EZKNX           PFS Load Deadli
     C                     MOVEL*BLANK    $EXITX           Pckg Item Descr
     C                     MOVELB1B0SC    $EB0SC           PFS Baseline Sc
     C                     MOVELB1VISX    $EVISX           PFS Palletize
     C                     MOVELB1ZLSX    $EZLSX           PFS Pallet Type
     C                     MOVELB1VGSX    $EVGSX           PFS Slip Sheet
     C                     MOVELB1OJU1    $EOJU1           PFS Customer Na
     C                     MOVELB1UWSX    $EUWSX           PFS Record Stat
     C                     Z-ADDB1UXSX    $EUXSX           PFS Process Sta
     C                     MOVELB1V3SX    $EV3SX           PFS Error Reaso
     C                     Z-ADDB1AHNY    $EAHNY           PFS Create Date
     C                     Z-ADDB1AINY    $EAINY           PFS Create Time
     C                     Z-ADDB1AJNY    $EAJNY           PFS Change Date
     C                     Z-ADDB1AKNY    $EAKNY           PFS Change time
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN B1Y1NX    WZA001           PFS Company Num
     C                     Z-ADDB1Y1NX    WZA001
     C           *LIKE     DEFN B1ASD8    WZA002           PFS Batch Date
     C                     Z-ADDB1ASD8    WZA002
     C           *LIKE     DEFN B1AOTS    WZA003           PFS Batch Time
     C                     Z-ADDB1AOTS    WZA003
     C           *LIKE     DEFN B1DNNB    WZA004           PFS Item Struct
     C                     Z-ADDB1DNNB    WZA004
     C           *LIKE     DEFN B1DONB    WZA005           PFS Item Struct
     C                     Z-ADDB1DONB    WZA005
     C           *LIKE     DEFN B1U0SX    WZA006           PFS Primary UOM
     C                     MOVELB1U0SX    WZA006
     C           *LIKE     DEFN B1B3SC    WZA007           PFS Base/Conver
     C                     MOVELB1B3SC    WZA007
     C           *LIKE     DEFN B1Y2NX    WZA008           PFS Item Code
     C                     Z-ADDB1Y2NX    WZA008
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C           KRSA      READE@B1CPVB                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        PFS Company Num
     C                     MOVEL*BLANK    W0AL01  1        PFS Batch Date
     C                     MOVEL*BLANK    W0AL02  1        PFS Batch Time
     C                     MOVEL*BLANK    W0AL03  1        PFS Item Struct
     C                     MOVEL*BLANK    W0AL04  1        PFS Item Struct
     C                     MOVEL*BLANK    W0AL05  1        PFS Primary UOM
     C                     MOVEL*BLANK    W0AL06  1        PFS Base/Conver
     C                     MOVEL*BLANK    W0AL07  1        PFS Item Code
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        PFS Company Num
     C                     MOVEL'Y'       W0AL01  1        PFS Batch Date
     C                     MOVEL'Y'       W0AL02  1        PFS Batch Time
     C                     MOVEL'Y'       W0AL03  1        PFS Item Struct
     C                     MOVEL'Y'       W0AL04  1        PFS Item Struct
     C                     MOVEL'Y'       W0AL05  1        PFS Primary UOM
     C                     MOVEL'Y'       W0AL06  1        PFS Base/Conver
     C                     MOVEL'Y'       W0AL07  1        PFS Item Code
     C                     ELSE
      * Next record - Detect level breaks
     C           B1Y1NX    IFNE WZA001                     PFS Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C           B1ASD8    IFNE WZA002                     PFS Batch Date
     C           W0AL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL01
     C                     END
     C           B1AOTS    IFNE WZA003                     PFS Batch Time
     C           W0AL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL02
     C                     END
     C           B1DNNB    IFNE WZA004                     PFS Item Struct
     C           W0AL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL03
     C                     END
     C           B1DONB    IFNE WZA005                     PFS Item Struct
     C           W0AL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL04
     C                     END
     C           B1U0SX    IFNE WZA006                     PFS Primary UOM
     C           W0AL04    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL05
     C                     END
     C           B1B3SC    IFNE WZA007                     PFS Base/Conver
     C           W0AL05    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL06
     C                     END
     C           B1Y2NX    IFNE WZA008                     PFS Item Code
     C           W0AL06    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL07
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL07    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP07
     C                     END
      *
     C           W0AL06    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP06
     C                     END
      *
     C           W0AL05    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP05
     C                     END
      *
     C           W0AL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP04
     C                     END
      *
     C           W0AL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP03
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP02
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP01
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of Prt PFS Prd Sch Bt Dt PF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of Prt PFS Prd Sch Bt Dt PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print PFS Company Number of Prt PFS Prd Sch Bt Dt PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP00
     C                     END                             FI
      * Print PFS Batch Date of Prt PFS Prd Sch Bt Dt PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP01
     C                     END                             FI
      * Print PFS Batch Time of Prt PFS Prd Sch Bt Dt PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP02
     C                     END                             FI
      * Print PFS Item Structure Type of Prt PFS Prd Sch Bt Dt PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP03    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of PFS Item Structure Type format
      * RTV  Description       RT - Item Structure Type  * 
     C                     EXSR SBRVGN
     C           W0PFM     IFEQ 'Y'
      * Print format
     C                     WRITE$CKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE 'P'       W0AP03
     C                     END                             FI
      * Print PFS Item Structure Group of Prt PFS Prd Sch Bt Dt PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP04    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of PFS Item Structure Group format
      * Rtv Group Description  RT - Item Structure Group  * 
     C                     EXSR SCRVGN
     C           W0PFM     IFEQ 'Y'
      * Print format
     C                     WRITE$DKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE 'P'       W0AP04
     C                     END                             FI
      * Print PFS Primary UOM of Prt PFS Prd Sch Bt Dt PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP05    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP05    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP05
     C                     END                             FI
      * Print PFS Base/Converted of Prt PFS Prd Sch Bt Dt PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP06    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP06    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP06
     C                     END                             FI
      * Print PFS Item Code of Prt PFS Prd Sch Bt Dt PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP07    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP07    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP07
     C                     END                             FI
      * Print Detail line. of Prt PFS Prd Sch Bt Dt PF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * Company Item Description Line 1
      * Rtv Descriptions      RT - Company Item  * 
     C                     EXSR SDRVGN
      * Box Description
      * RTV BOX ID FOR ITEM    RT - Item Bill Of Material  * 
     C                     EXSR SERVGN
      * Bag Code (Packaging Item Code)
      * RTV Itm Bag Code      RT - Packaging BOM  * 
     C                     EXSR SGRVGN
      * Pckg Item Description
      * RTV Packaging Item    RT - Packaging Item  * 
     C                     EXSR SHRVGN
      * Done & Need
     C                     MOVEL'____'    $EELU1           Done Usr
     C                     MOVEL'____'    $EEMU1           Need Usr
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert PFS Scheduled Ship Date to display format
      * Convert date
     C                     Z-ADD$EZSNX    XDI8DT
     C                     EXSR XDV84T
     C                     Z-ADDXDEXDT    VEZSNX
      * Convert PFS Load Deadline Date to display format
      * Convert date
     C                     Z-ADD$EZJNX    XDI8DT
     C                     EXSR XDV84T
     C                     Z-ADDXDEXDT    VEZJNX
     C                     MOVEL'0'       *IN79
     C           $EU0SX    IFEQ 'BX'                       *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print column headings if required
     C           W0ACDT    IFEQ 'Y'
     C                     WRITE$ECOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ACDT
     C                     END                             FI
      * Print format
     C                     WRITE$EDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
     C                     MOVEL*BLANK    W0SKP   1
      * Cascade skip to new page requests upwards
     C           W0AP03    IFEQ 'Y'
     C                     MOVEL'Y'       W0SKP
     C                     END
      * Request new page if required
     C           W0SKP     IFEQ 'Y'                        IF
     C                     MOVE 'Y'       W0NEWP
     C                     END                             FI
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of Prt PFS Prd Sch Bt Dt PF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * PFS Company Number of Prt PFS Prd Sch Bt Dt PF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * PFS Batch Date of Prt PFS Prd Sch Bt Dt PF
     C           W0AP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * PFS Batch Time of Prt PFS Prd Sch Bt Dt PF
     C           W0AP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * PFS Item Structure Type of Prt PFS Prd Sch Bt Dt PF
     C           W0AP03    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * PFS Item Structure Group of Prt PFS Prd Sch Bt Dt PF
     C           W0AP04    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * PFS Primary UOM of Prt PFS Prd Sch Bt Dt PF
     C           W0AP05    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * PFS Base/Converted of Prt PFS Prd Sch Bt Dt PF
     C           W0AP06    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * PFS Item Code of Prt PFS Prd Sch Bt Dt PF
     C           W0AP07    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt PFS Prd Sch Bt Dt PF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD3         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD4         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
      * USER: Process top of page
     C                     Z-ADDP1Y1NX    $BAIC3           Company Number
     C                     Z-ADDP1ASD8    $BASD8           PFS Batch Date
     C                     Z-ADDP1AOTS    $BAOTS           PFS Batch Time
     C                     MOVELP2TVAA    $BTVAA           PFS User ID
      * Rtv PFS Production Dt RT - PFS Prod Sched Batch Dtl  * 
     C                     EXSR SARVGN
      * Process Status
      * CASE: PAR.PFS Process Status is Ready to Send
     C           P2UXSX    IFEQ 6                          *IF
     C                     MOVEL@CN,001   $BEGU1           PFS Process Sta
     C                     ELSE
      * CASE: PAR.PFS Process Status is Sent
     C           P2UXSX    IFEQ 9                          *IF
     C                     MOVEL*BLANK    $BEGU1           PFS Process Sta
     C                     MOVEL'Sent'    $BEGU1           PFS Process Sta
     C                     ELSE
      * CASE: PAR.PFS Process Status is Batch Selection
     C           P2UXSX    IFEQ 4                          *IF
     C                     MOVEL@CN,002   $BEGU1           PFS Process Sta
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Update Baseline
      * CASE: PAR.PFS Baseline Schedule is Baseline
     C           P2B0SC    IFEQ 'B'                        *IF
     C                     MOVEL'Y'       $BCRSC           Update Baseline
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       $BCRSC           Update Baseline
     C                     END                             *FI
      * Convert fields to external form
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $BAIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$BAIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VBAIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VBAIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert PFS Batch Date to display format
      * Convert date
     C                     Z-ADD$BASD8    XDI8DT
     C                     EXSR XDV84T
     C                     Z-ADDXDEXDT    VBASD8
      * Convert PFS Production Date to display format
      * Convert date
     C                     Z-ADD$BP7DT    XDI8DT
     C                     EXSR XDV84T
     C                     Z-ADDXDEXDT    VBP7DT
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv PFS Production Dt RT - PFS Prod Sched Batch Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * E3787 JJH 09/01/15 - This RTVOBJ is used to get the PFS Productio
      *   Date from the first record in PFS Prod Sched Batch Dtl file.
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAY1NX    WQSA01           PFS Company Num
     C           *LIKE     DEFN WAASD8    WQSA02           PFS Batch Date
     C           *LIKE     DEFN WAAOTS    WQSA03           PFS Batch Time
     C           *LIKE     DEFN WATVAA    WQSA04           PFS User ID
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           PFS Company Num
     C                     KFLD           WQSA02           PFS Batch Date
     C                     KFLD           WQSA03           PFS Batch Time
     C                     KFLD           WQSA04           PFS User ID
      * Setup key
     C                     Z-ADDB1Y1NX    WQSA01           PFS Company Num
     C                     Z-ADD$BASD8    WQSA02           PFS Batch Date
     C                     Z-ADD$BAOTS    WQSA03           PFS Batch Time
     C                     MOVEL$BTVAA    WQSA04           PFS User ID
      * Establish starting position
     C           KRSSA     SETLL@B1CPUT                    *
     C           KRSSA     READE@B1CPUT                  90*
      * Data record not found
     C   90                MOVEL'USR4804' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWAP7DT    $BP7DT           PFS Production
     C                     GOTO SAEXIT                     *QUIT
     C           KRSSA     READE@B1CPUT                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV  Description       RT - Item Structure Type  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           E8RGNB           Item Structure
      * Setup key
     C                     Z-ADD$CDNNB    E8RGNB           Item Structure
      * Establish starting position
     C           KRSSB     CHAIN@E8REBB              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1166' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     $CDNNB           Item Structure
     C                     MOVEL*BLANK    $CDCTX           Item Structure
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     Z-ADDE8RGNB    $CDNNB           Item Structure
     C                     MOVELE8DCTX    $CDCTX           Item Structure
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Group Description  RT - Item Structure Group  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           E9RHNB           Item Structure
      * Setup key
     C                     Z-ADD$DDONB    E9RHNB           Item Structure
      * Establish starting position
     C           KRSSC     CHAIN@E9REA8              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1168' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     $DDNNB           Item Structure
     C                     MOVEL*BLANK    $DDDTX           Item Structure
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDE9RGNB    $DDNNB           Item Structure
     C                     MOVELE9DDTX    $DDDTX           Item Structure
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Descriptions      RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADD$EY1NX    BZAIC3           Company Number
     C                     Z-ADD$EY2NX    BZHGCD           Item Code
      * Establish starting position
     C           KRSSD     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBZAVNA    $EAVNA           Description Lin
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV BOX ID FOR ITEM    RT - Item Bill Of Material  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  1        Package Type Co
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0001           Package Type Co
     C                     MOVEL*BLANK    $ENYNA           Box Description
      * Declare restrictor key work fields
     C           *LIKE     DEFN IOAIC3    WQSE01           Company Number
     C           *LIKE     DEFN IOHGCD    WQSE02           Item Code
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WQSE02           Item Code
      * Setup key
     C                     Z-ADD$EY1NX    WQSE01           Company Number
     C                     Z-ADD$EY2NX    WQSE02           Item Code
      * Establish starting position
     C           KRSSE     SETLL@IORETI                    *
     C           KRSSE     READE@IORETI                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1679' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0001           Package Type Co
     C                     MOVEL*BLANK    $ENYNA           Box Description
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADD0         WUAIWG           Unit Weight
      * RTV Item Type & PckCD  RT - Company/Item  * 
     C                     EXSR SFRVGN
      * CASE: PAR.Package Type Code is Box
     C           WN0001    IFEQ 'B'                        *IF
     C                     MOVELWUAVNA    $ENYNA           Box Description
     C                     Z-ADDWUAIWG    YN0006           Unit Weight
     C           IOC9NB    MULT 1         YN0005           Box iD
     C                     GOTO SEEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSE     READE@IORETI                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Item Type & PckCD  RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBHGCD           Item Code
      * Setup key
     C                     Z-ADDIOAIC3    WBAIC3           Company Number
     C                     Z-ADDIOC9NB    WBHGCD           Item Code
      * Establish starting position
     C           KRSSF     CHAIN@BZREG0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAVNA           Description Lin
     C                     Z-ADD*ZERO     WUAIWG           Unit Weight
     C                     MOVEL*BLANK    WUN0CD           Item Type Code
     C                     MOVEL*BLANK    WN0001           Package Type Co
     C                     Z-ADD*ZERO     WUSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WUA3WG           Misc Tare Weigh
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBAVNA    WUAVNA           Description Lin
     C                     Z-ADDWBAIWG    WUAIWG           Unit Weight
     C                     MOVELWBN0CD    WUN0CD           Item Type Code
     C                     MOVELWBX4ST    WN0001           Package Type Co
     C                     Z-ADDWBSFNB    WUSFNB           Pallet Tare Wei
     C                     Z-ADDWBA3WG    WUA3WG           Misc Tare Weigh
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Itm Bag Code      RT - Packaging BOM  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN AZAIC3    WQSG01           Company Number
     C           *LIKE     DEFN AZHGCD    WQSG02           Item Code
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Item Code
      * Setup key
     C                     Z-ADD$EY1NX    WQSG01           Company Number
     C                     Z-ADD$EY2NX    WQSG02           Item Code
      * Establish starting position
     C           KRSSG     SETLL@AZCPPC                    *
     C           KRSSG     READE@AZCPPC                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $EBRAA           Packaging Item
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAZBRAA    $EBRAA           Packaging Item
     C                     GOTO SGEXIT                     *QUIT
     C           KRSSG     READE@AZCPPC                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Packaging Item    RT - Packaging Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           ARAIC3           Company Number
     C                     KFLD           ARBRAA           Packaging Item
      * Setup key
     C                     Z-ADD$EY1NX    ARAIC3           Company Number
     C                     MOVEL$EBRAA    ARBRAA           Packaging Item
      * Establish starting position
     C           KRSSH     CHAIN@ARREGL              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2982' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $EXITX           Pckg Item Descr
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELARXITX    $EXITX           Pckg Item Descr
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         XDV84T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDI8DD    XDEX01           DD
     C                     Z-ADDXDI8MM    XDEX02           MM
     C           1000      MULT XDI8CC    XDEY02           Y
     C                     ADD  XDI8YY    XDEY02            YYY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDI8MM    XDEX01           MM
     C                     Z-ADDXDI8DD    XDEX02           DD
     C           1000      MULT XDI8CC    XDEY02           Y
     C                     ADD  XDI8YY    XDEY02            YYY
     C                     ELSE
      * YMD format
     C           1000      MULT XDI8CC    XDEY01           Y
     C                     ADD  XDI8YY    XDEY01            YYY
     C                     Z-ADDXDI8MM    XDEX03           MM
     C                     Z-ADDXDI8DD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDV84E    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    B1Y1NX           PFS Company Num
     C                     MOVEL*HIVAL    B1ASD8           PFS Batch Date
     C                     MOVEL*HIVAL    B1AOTS           PFS Batch Time
     C                     MOVEL*LOVAL    B1DNNB           PFS Item Struct
     C                     MOVEL*LOVAL    B1DONB           PFS Item Struct
     C                     MOVEL*LOVAL    B1U0SX           PFS Primary UOM
     C                     MOVEL*HIVAL    B1B3SC           PFS Base/Conver
     C                     MOVEL*LOVAL    B1Y2NX           PFS Item Code
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAY1NX           PFS Company Num
     C                     Z-ADD*ZERO     WAASD8           PFS Batch Date
     C                     Z-ADD*ZERO     WAAOTS           PFS Batch Time
     C                     Z-ADD*ZERO     WABTSQ           PFS Batch Seq
     C                     Z-ADD*ZERO     WAP7DT           PFS Production
     C                     Z-ADD*ZERO     WAY2NX           PFS Item Code
     C                     Z-ADD*ZERO     WAZPNX           PFS Order Numbe
     C                     Z-ADD*ZERO     WAZXNX           PFS Order Line
     C                     Z-ADD*ZERO     WAODQY           PFS Ordered Qty
     C                     Z-ADD*ZERO     WAINAL           PFS Inventory A
     C                     Z-ADD*ZERO     WAC6NB           PFS Fill Qty Pr
     C                     Z-ADD*ZERO     WAC8NB           PFS Fill Qty Sh
     C                     Z-ADD*ZERO     WAFLQ1           PFS Fill Qty Sh
     C                     Z-ADD*ZERO     WAFLQ2           PFS Fill Qty Sh
     C                     Z-ADD*ZERO     WAZGNX           PFS Load ID
     C                     Z-ADD*ZERO     WAZWNX           PFS Loading Seq
     C                     Z-ADD*ZERO     WAZSNX           PFS Scheduled S
     C                     Z-ADD*ZERO     WAZJNX           PFS Load Deadli
     C                     Z-ADD*ZERO     WAZKNX           PFS Load Deadli
     C                     Z-ADD*ZERO     WADNNB           PFS Item Struct
     C                     Z-ADD*ZERO     WADONB           PFS Item Struct
     C                     Z-ADD*ZERO     WADRNB           PFS Item Struct
     C                     Z-ADD*ZERO     WAUXSX           PFS Process Sta
     C                     Z-ADD*ZERO     WAAHNY           PFS Create Date
     C                     Z-ADD*ZERO     WAAINY           PFS Create Time
     C                     Z-ADD*ZERO     WAAJNY           PFS Change Date
     C                     Z-ADD*ZERO     WAAKNY           PFS Change time
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field Unit Weight
     C                     Z-ADD*ZERO     WUAIWG 112
      * Define work field Description Line One
     C                     MOVEL*BLANK    WUAVNA 30
      * Define work field Item Type Code
     C                     MOVEL*BLANK    WUN0CD  3
      * Define work field Pallet Tare Weight
     C                     Z-ADD*ZERO     WUSFNB  52
      * Define work field Misc Tare Weight
     C                     Z-ADD*ZERO     WUA3WG  52
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WBAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WBAIWG           Unit Weight
     C                     Z-ADD*ZERO     WBCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WBC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WBURTN           Number Cases On
     C                     Z-ADD*ZERO     WBAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WBRINB           Item Structure
     C                     Z-ADD*ZERO     WBRHNB           Item Structure
     C                     Z-ADD*ZERO     WBRGNB           Item Structure
     C                     Z-ADD*ZERO     WBTFNB           Transportation
     C                     Z-ADD*ZERO     WBTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WBTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WBBLPR           Market Overage
     C                     Z-ADD*ZERO     WBBMPR           Standard Overag
     C                     Z-ADD*ZERO     WBCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WBCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WBSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WBPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WBICN1           Item Category N
     C                     Z-ADD*ZERO     WBICN2           Item Category N
     C                     Z-ADD*ZERO     WBV2NB           Item Category N
     C                     Z-ADD*ZERO     WBITCN           Item Category N
     C                     Z-ADD*ZERO     WBITC5           Item Category N
     C                     Z-ADD*ZERO     WBICN6           Item Category N
     C                     Z-ADD*ZERO     WBICN7           Item Category N
     C                     Z-ADD*ZERO     WBICN8           Item Category N
     C                     Z-ADD*ZERO     WBICN9           Item Category N
     C                     Z-ADD*ZERO     WBICN0           Item Category N
     C                     Z-ADD*ZERO     WBSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WBA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WBSJNB           Production Lead
     C                     Z-ADD*ZERO     WBSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WBSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WBSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WBCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WBCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WBILNB           Packages per ca
     C                     Z-ADD*ZERO     WBCHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WBCINB           PM Batch Size
     C                     Z-ADD*ZERO     WBCJNB           Package Level s
     C                     Z-ADD*ZERO     WBCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WBCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WBCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WBCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WBCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WBCWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WBCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WBCZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WBC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WBB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WBB5NB           PM Line Number
     C                     Z-ADD*ZERO     WBBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WBBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WBF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WBF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WBF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WBBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WBBNNB           Production Qty
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define null work field Description Line Two
     C                     MOVEL*BLANK    YN0001 30
      * Define null work field U/M - Primary
     C                     MOVEL*BLANK    YN0002  2
      * Define null work field U/M - Second
     C                     MOVEL*BLANK    YN0003  2
      * Define null work field U/M - Third
     C                     MOVEL*BLANK    YN0004  2
      * Define null work field Box iD
     C                     Z-ADD*ZERO     YN0005  70
      * Define null work field Unit Weight
     C                     Z-ADD*ZERO     YN0006 112
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Ready to send
00002 Batch Selection
