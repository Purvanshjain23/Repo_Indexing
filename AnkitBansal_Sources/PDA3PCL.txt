/********************************************************************/
/*  NAME      - PDA3PCL                                             */
/*  SYNOPSIS  - CL PROGRAM FOR PRINTING BILL OF LADING ON           */
/*              AN OVERLAY                                          */
/*                                                                  */
/*  SYSTEM    - ORDER MANAGEMENT SYSTEM                             */
/*  DATE      - 11/06/95                                            */
/********************************************************************/
/*  1/24/2006 LJB - PRINTER OVERRIDES HAVE BEEN CHANGED TO SET THE  */
/*              PRINTER DEVICE TYPE TO *AFPDS, OVERLAY IS SBFBOL,   */
/*              OVERFLOW IS 58, PAGE LENGTH IS 88 AND WIDTH IS 85.  */
/*  5/02/2006 RMC - CHG DRAWER IN OVERRIDE BY COMPANY               */
/*  06/13/2007 LJB - OVERRIDE INFORMATION IS NOW STORED IN COMPANY  */
/*              DOCUMENT DEFAULTS FILE. CALL PMG9XFR TO RETRIEVE    */
/*              SPECS, ONCE FOR THE BOL OVERLAY AND ONCE FOR THE    */
/*              FAX OVERLAY. BOL PGM IS PDC2PFR.                    */
/*              (SET OVERRIDES IN PMHSDFR-WW COMPANY DOC DEFAULTS)  */
/* 12/18/2007 RMC FP1110                                           */
/*            PAGE CPI NEEDS TO BE 3.1 INSTEAD OF 2.0 LONG.(IE. 16.7) */
/* 05/11/10   ISLBUSE ADDED CHECKS FOR HOLD/SAVE BEING BLANK FROM */
/* 1/19/12    FROM INPUT PARMS -- BUT NEVER INSTALLED IT .. SO I AM NOW..RMC */
/* 7/18/19    T14912 - CHG FOR SEABOARD ENERGY BOLS - TEXT CHG - OFFSET OVL */
/*            IF PGM IS PMO7PFR   SCAN:PRTHPB                        */
/* 9/18/19 RMC  T15460 - ADD PARME FOR BACK OVERLAY FOR PMO7PFR$, ADD TO     */
/*                     OVRPRTF   ==>HPB / SEABOARD ENERGY ONLY     */
/* 09/15/22 DN   W104274 - CHANGE PMO7PFR FRONT OVERLAY OFFSET DOWN &     */
/*                         ACROSS FROM .3 & .3 TO .0 & .0.                 */
/********************************************************************/
 PDA3PCL:    PGM        PARM(&RETURN &APPLIC &DESC &LOAD &COMP +
                          &EXPORT &TYPE &DEPT &OVERLAY &BKOVER)

             DCL        VAR(&COMP) TYPE(*DEC) LEN(3 0)
             DCL        VAR(&LOAD) TYPE(*DEC) LEN(7 0)
             DCL        VAR(&APPLIC) TYPE(*CHAR) LEN(6)
             DCL        VAR(&COPY) TYPE(*DEC) LEN(2 0)
             DCL        VAR(&OUTQ) TYPE(*CHAR) LEN(10)
             DCL        VAR(&EXPORT) TYPE(*CHAR) LEN(1)
             DCL        VAR(&DESC) TYPE(*CHAR) LEN(30)
             DCL        VAR(&NQSTAT) TYPE(*CHAR) LEN(1) VALUE(N)
             DCL        VAR(&NIGHTQ) TYPE(*CHAR) LEN(10)
             DCL        VAR(&RETURN) TYPE(*CHAR) LEN(7)
/*----------------------------------------------------------------- */
/* PARMS FOR THE RETRIEVE OVERLAY PARAMETERS PROGRAM                */
/*----------------------------------------------------------------- */
             DCL        VAR(&TYPE) TYPE(*CHAR) LEN(2)
             DCL        VAR(&DEPT) TYPE(*CHAR) LEN(6)
             DCL        VAR(&OVERLAY) TYPE(*CHAR) LEN(8)
             DCL        VAR(&BKOVER) TYPE(*CHAR) LEN(8)  /* BACKOVERLAY NME */
             DCL        VAR(&CDDPGM) TYPE(*CHAR) LEN(10)
             DCL        VAR(&CDDFILE) TYPE(*CHAR) LEN(10)
             DCL        VAR(&ADDLOBJ) TYPE(*CHAR) LEN(10)
             DCL        VAR(&SENDPHONE) TYPE(*CHAR) LEN(10)
             DCL        VAR(&SENDFAX) TYPE(*CHAR) LEN(10)
             DCL        VAR(&OVOUTQ) TYPE(*CHAR) LEN(10)
             DCL        VAR(&OVHOLD) TYPE(*CHAR) LEN(4)
             DCL        VAR(&OVSAVE) TYPE(*CHAR) LEN(4)
             DCL        VAR(&HOLD) TYPE(*CHAR) LEN(4)
             DCL        VAR(&SAVE) TYPE(*CHAR) LEN(4)
             DCL        VAR(&DRAWER) TYPE(*DEC) LEN(3 0)
             DCL        VAR(&PRTDEVTYPE) TYPE(*CHAR) LEN(10)
             DCL        VAR(&LENGTH) TYPE(*DEC) LEN(3 0)
             DCL        VAR(&WIDTH) TYPE(*DEC) LEN(3 0)
             DCL        VAR(&CPI) TYPE(*DEC) LEN(3 1)
             DCL        VAR(&LPI) TYPE(*DEC) LEN(2 0)
             DCL        VAR(&OVERFLOW) TYPE(*DEC) LEN(3 0)
             DCL        VAR(&ROTATE) TYPE(*CHAR) LEN(5)
             DCL        VAR(&COMMENT1) TYPE(*CHAR) LEN(50)
             DCL        VAR(&COMMENT2) TYPE(*CHAR) LEN(50)
             DCL        VAR(&COMMENT3) TYPE(*CHAR) LEN(50)
             DCL        VAR(&COMMENT4) TYPE(*CHAR) LEN(50)
             DCL        VAR(&COMMENT5) TYPE(*CHAR) LEN(50)
             DCL        VAR(&RECSTS) TYPE(*CHAR) LEN(1)

/* ERROR MESSAGE FIELDS                                                       */
             DCL        VAR(&MSG) TYPE(*CHAR) LEN(512) /* MESSAGE */
             DCL        VAR(&MSGID) TYPE(*CHAR) LEN(7) /* MESSAGE ID */
             DCL        VAR(&MSGL) TYPE(*DEC) LEN(5 0) VALUE(512)

/********************************************************************/
/*   PROMPT FOR PRINTER OVERRIDES                                   */
/********************************************************************/
             CHGVAR     VAR(&COPY) VALUE(3)
             CALL       PGM(PDG0PVR) PARM(&RETURN &DESC &OUTQ &HOLD +
                          &SAVE &COPY &NQSTAT &NIGHTQ &APPLIC)

             IF         COND(&RETURN *NE ' ') THEN(GOTO +
                          CMDLBL(USERQUIT))

/*----------------------------------------------------------------- */
/* CALL THE GENERIC RETRIEVE COMPANY DOCUMENT DEFAULTS FIELDS       */
/* PROGRAM. COMPANY, TYPE, DEPARTMENT, AND OVERLAY NAME ARE         */
/* INPUT RESTRICTED, THE REST ARE OUTPUT PARMS.                     */
/*----------------------------------------------------------------- */
             CALL       PGM(PMG9XFR) PARM(' ' &COMP &TYPE &DEPT +
                          &OVERLAY &CDDPGM &CDDFILE &ADDLOBJ +
                          &SENDPHONE &SENDFAX &OVOUTQ &OVHOLD +
                          &OVSAVE &DRAWER &PRTDEVTYPE &LENGTH +
                          &WIDTH &LPI &CPI &OVERFLOW &ROTATE +
                          &COMMENT1 &COMMENT2 &COMMENT3 &COMMENT4 +
                          &COMMENT5 &RECSTS)

             IF         COND(&OUTQ *EQ '     ') THEN(CHGVAR +
                          VAR(&OUTQ) VALUE(&OVOUTQ))
             IF         COND(&SAVE *EQ '     ') THEN(CHGVAR +
                          VAR(&SAVE) VALUE(&OVSAVE))
             IF         COND(&HOLD *EQ '     ') THEN(CHGVAR +
                          VAR(&HOLD) VALUE(&OVHOLD))

 PRTHPB:     IF         COND(&CDDFILE *EQ 'PMO7PFR$') THEN(DO)
 /* W104274-CHANGE FRONTOVL OFFSET DOWN & ACROSS FROM .3 & .3 TO BOTH .0 */
             OVRPRTF    FILE(&CDDFILE) DEVTYPE(&PRTDEVTYPE) +
                          PAGESIZE(&LENGTH &WIDTH) LPI(&LPI) +
                          CPI(&CPI) OVRFLW(&OVERFLOW) +
                          DRAWER(&DRAWER) PAGRTT(&ROTATE) +
                          DUPLEX(*YES) FRONTOVL(&OVERLAY .0 .0) +
                          BACKOVL(&BKOVER 0 0 *CONSTANT) +
                          OUTQ(&OUTQ) COPIES(&COPY) HOLD(&HOLD) +
                          SAVE(&SAVE)
                          GOTO CALL
                          ENDDO
 PRTFOOD:    OVRPRTF    FILE(&CDDFILE) DEVTYPE(&PRTDEVTYPE) +
                          PAGESIZE(&LENGTH &WIDTH) LPI(&LPI) +
                          CPI(&CPI) OVRFLW(&OVERFLOW) +
                          DRAWER(&DRAWER) PAGRTT(&ROTATE) +
                          FRONTOVL(&OVERLAY) OUTQ(&OUTQ) +
                          COPIES(&COPY) HOLD(&HOLD) SAVE(&SAVE)

/* CALL BILL OF LADING PRINT PROGRAM                                */
 CALL:       CALL       PGM(&CDDPGM) PARM(' ' &LOAD &COMP &EXPORT)

             CHGVAR     VAR(&RETURN) VALUE('       ')
             GOTO       CMDLBL(ENDPGM)

/*-------------------------USER QUIT--------------------------------*/
 USERQUIT:   GOTO       CMDLBL(ENDPGM)

/*----------------------RECEIVE MESSAGES----------------------------*/
 MSGTRAP:    CHGVAR     VAR(&RETURN) VALUE('ERROR  ')

             RCVMSG     MSGTYPE(*EXCP) MSGDTA(&MSG) MSGDTALEN(&MSGL) +
                          MSGID(&MSGID)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(ENDPGM))

             SNDPGMMSG  MSGID(&MSGID) MSGF(QCPFMSG) MSGDTA(%SST(&MSG +
                          1 &MSGL)) MSGTYPE(*ESCAPE)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(ENDPGM))

 ENDPGM:     ENDPGM
