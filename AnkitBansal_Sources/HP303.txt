      *****************  RPG PROGRAM HEADING  ************************
      *
      * SYSTEM:      HOG PRODUCTION
      * PROGRAM:     HP303
      * TITLE:       BUILD WORKFILES-DEATHS AND CULL SALES BY WEEK RPT
      *                 (CLOSED GROUPS ONLY)
      * PROGRAMMER:  LEANNE FEDOR
      * CREATED:     02/29/96
      *
      *  FUNCTION:   THIS BATCH PROGRAM IS CALLED FROM HP403CL.
      *              IT BUILDS FOUR WORKFILES:
      *                 HSP303 - GROUP DETAIL
      *                 HSP304 - GROUP TOTAL
      *                 HSP305 - FARM/PHASE TOTAL
      *                 HSP306 - PHASE TOTAL
      *
      *              THE USER'S SUBMISSION CRITERIA ARE PASSED IN THE
      *              LDA FROM HP403.  OPEN QUERIES ARE USED TO MAKE AN
      *              INITIAL SELECTION OF DATA.
      *
      ****************************************************************
      * MODIFICATIONS:
      ****************************************************************
      * DATE      PROGRAMMER
      *
      * 09/07/99  LeAnne Fedor
      *           Added logic for 8 additional weeks.  Report will now have
      *           28 weeks instead of 20.
      *
      * 11/03/99  LeAnne Fedor
      *           Building/room were added to the group total file.  Added
      *           logic to populate the fields.
      *
      * 08/17/00  LeAnne Fedor
      *           Added logic to populate the new workfile field 'adjusted
      *           transfer in head'.  Also, changed dead/cull percent to
      *           used this 'adjusted' value instead of the normal transfer
      *           in head.
      *
      * 07/18/02  LeAnne Fedor
      *           Changed farm/phase total logic to accommodate the fact that a farm
      *           can now contain groups with various phases.
      *
      * 07/02/09  LeAnne Ramsey
      *           Recompile only. Added new field 'Continuous Flow Flag' to Hog Group file.
      *
      * 10/15/13  LeAnne Ramsey (E2831)
      *           Recompile only. Added field 'MTech Reference'.
      /eject
      ****************************************************************
      * FILE SPECIFICATIONS
      ****************************************************************
      *
     FHSP018    IF   E           K DISK
      *    FARM SITE
      *
     FHSP033    IF   E           K DISK
      *    CLOSED HOG GROUP
      *
     FHSP034    IF   E           K DISK
      *    HOG GROUP
      *    (RECORDS SELECTED BY OPEN QUERY)
      *
     FHSL068D   IF   E           K DISK
      *    KILLED/DEAD HOGS
      *
     FHSP074    IF   E           K DISK
      *    TRANSFER MOVEMENT HEADER
      *
     FHSL075C   IF   E           K DISK
      *    TRANSFER MOVEMENT DETAIL
      *
     FHSP084    IF   E           K DISK
      *    SALES MOVEMENT HEADER
      *
     FHSL085B   IF   E           K DISK
      *    SALES MOVEMENT DETAIL
      *
     FHSP303    UF A E           K DISK
      *  WORKFILE FOR GROUP DETAIL
      *
     FHSP304    O    E           K DISK
      *  WORKFILE FOR GROUP TOTAL
      *
     FHSL304B   IF   E           K DISK    RENAME(WGREC:WGRECB)
      *  WORKFILE FOR GROUP TOTAL
      *
     FHSP305    O    E           K DISK
      *  WORKFILE FOR FARM TOTAL
      *
     FHSL305A   IF   E           K DISK    RENAME(WFREC:WFRECA)
      *  WORKFILE FOR FARM TOTAL
      *
     FHSP306    O    E           K DISK
      *  WORKFILE FOR PHASE TOTAL
      *
      /EJECT
      ****************************************************************
      * INPUT SPECS
      ****************************************************************
      *----------------------------------------------------------------
      * LDA - REPORT SELECTIONS
      *----------------------------------------------------------------
      *
     D                UDS
     D  LDFSBO                 1      5
     D  LDFYMD                 6     13  0
     D  LDTYMD                14     21  0
     D  LDPPCD                22     26
     D  LDFSCD                27     31  0
     D  LDPTCD                48     52
     D  LDHGSN                53     59  0
     D  LDFMDY                60     65  0
     D  LDTMDY                66     71  0
     D  LDCELL                77     79  0
     D  LDRPFL                80     80
     D  LDPPFL                81     81
     D  LDTDFL                82     82
     D  LDSDFL                83     83
     D  LDDDFL                84     84
     D  LDCSFL                85     85
      *
      *
      *---------------------------------------------------------------
      *  NAMED CONSTANTS
      *---------------------------------------------------------------
      *
     D YES             C                   CONST('Y')
     D NO              C                   CONST('N')
      *
      /EJECT
      ****************************************************************
      * MAIN LINE
      ****************************************************************
      *
      * READ EACH HOG GROUP SELECTED BY THE OPNQRY
      *
     C     *IN90         DOUEQ     *ON                                          MAIN DO
     C                   READ      HSP034                                 90
     C     *IN90         IFEQ      *OFF                                         IF NOT EOF
     C                   MOVEL     YES           PROCFL
      *
      * IF THE USER ELECTED TO SEE ONLY GROUPS FROM A
      * SPECIFIC CELL, RETRIEVE THE CELL OF THE FARM THAT THIS
      * GROUP IS ON. ONLY PROCESS THE GROUP IF IT IS ON A FARM
      * IN THE REQUESTED CELL.
      *
     C     LDCELL        IFNE      0                                            IF 1 CELL
     C     HGFSCD        CHAIN     HSP018                             91
     C     *IN91         IFEQ      *ON                                          IF BAD
     C     FSCELL        ORNE      LDCELL
     C                   MOVEL     NO            PROCFL
     C                   ENDIF                                                  IF BAD
     C                   ENDIF                                                  IF 1 CELL
      *
     C     PROCFL        IFEQ      YES                                          IF PROCESS
      *
      * THERE ARE SEVERAL STEPS FOR PROCESSING EACH GROUP:
      *  1) FIND THE 'FROM' AND 'TO' DATE RANGES FOR 28
      *     WEEKS FOR THE GROUP STARTING WITH THE OPEN DATE.
      *     WRITE 28 GROUP DETAIL WORKFILE RECORDS--1 FOR EACH WEEK.
      *  2) IF THE USER HAS ELECTED TO INCLUDE THE DAILY DEADS,
      *     FIND THE DAILY DEADS FOR THE GROUP AND SUM THEM
      *     INTO THE APPROPRIATE WEEK RECORD.
      *  3) IF THE USER HAS ELECTED TO INCLUDE THE DOAS FROM
      *     TRANSFERS, RETRIEVE THE DOAS FROM TRANSFERS AND UPDATE
      *     THE APPROPRIATE WEEK RECORD.
      *  4) IF THE USER HAS ELECTED TO INCLUDE THE DOAS FROM
      *     SALES, RETRIEVE THE DOAS FROM SALES AND UPDATE
      *     THE APPROPRIATE WEEK RECORD.
      *  5) IF THE USER HAS ELECTED TO INCLUDE THE CULL SALES,
      *     RETRIEVE THE 'LIVE' HEAD FROM CULL SALES AND UPDATE
      *     THE APPROPRIATE WEEK RECORD.
      *  6) AFTER ALL VALUES ARE ACCUMULATED FOR THE 28 WEEKS,
      *     WRITE ONE TOTAL RECORD FOR THE GROUP.
      *
      *
      * SETUP FROM/TO DATES FOR 28 WEEKS FOR THE GROUP
      *
     C                   EXSR      $28WKS
      *
      * ACCUMULATE THE DAILY DEADS BY WEEK IF THE USER HAS
      * ELECTED TO SEE DAILY DEADS
      *
     C     LDDDFL        IFEQ      'X'
     C                   EXSR      $DEADS
     C                   ENDIF
      *
      * ACCUMULATE THE DOAS FROM TRANSFERS IF THE USER ELECTED
      * TO SEE TRANSFER DOAS
      *
     C     LDTDFL        IFEQ      'X'
     C                   EXSR      $TDOAS
     C                   ENDIF
      *
      * ACCUMULATE THE DOAS FROM SALES IF THE USER ELECTED
      * TO SEE SALES DOAS
      *
     C     LDSDFL        IFEQ      'X'
     C                   EXSR      $SDOAS
     C                   ENDIF
      *
      * ACCUMULATE THE 'LIVE' HEAD FROM CULL SALES IF THE
      * USER ELECTED TO SEE CULL SALES
      *
     C     LDCSFL        IFEQ      'X'
     C                   EXSR      $CULLS
     C                   ENDIF
      *
      * YOU HAVE NOW ACCUMULATED ALL DATA FOR A GROUP IN THE
      * 28 WEEKLY RECORDS IN THE GROUP DETAIL FILE. REREAD THESE
      * RECORDS AND SETUP YOUR TOTAL RECORD FOR THE GROUP.
      *
     C                   EXSR      $GROUP
      *
     C                   ENDIF                                                  IF PROCESS
     C                   ENDIF                                                  IF NOT EOF
     C                   ENDDO                                                  MAIN DO
      *
      *----------------------------------------------------------------
      * EOF PROCESSING
      *----------------------------------------------------------------
      *
      * THERE ARE TWO STEPS TO THE EOF PROCESSING:
      *    1) CREATE FARM TOTAL WORKFILE RECORDS
      *    2) CREATE PHASE TOTAL WORKFILE RECORDS
      *
     C                   EXSR      $FARM
     C                   EXSR      $PHASE
      *
     C                   SETON                                        LR
      /EJECT
      *----------------------------------------------------------------
      * $28WKS - FIND THE FROM/TO DATE RANGES FOR 28 WEEKS OF THE GROUP
      *----------------------------------------------------------------
      *
      * THIS SUBROUTINE WILL START WITH THE 'OPEN' DATE OF THE GROUP
      * AND CREATE 28 RECORDS IN THE GROUP DETAIL WORKFILE FOR EACH
      * WEEK OF THE GROUP'S LIFE.
      *
     C     $28WKS        BEGSR
      *
      * INTIALIZE FIELDS IN THE WORKFILE DETAIL RECORD
      *
     C                   Z-ADD     HGHGSN        WDHGSN
     C                   Z-ADD     0             WDCDHD
      *
      * DEFAULT THE 'OPEN' DATE FOR THE GROUP TO THE FIRST
      * FROM DATE.
     C                   Z-ADD     HGOPDT        WKFYMD
      *
     C                   DO        28                                           DO 28 WEEKS
      *
      * FIND THE ENDING DATE FOR THE WEEK BY ADDING SIX DAYS
      * TO THE FROM DATE.
     C                   Z-ADD     WKFYMD        PFRM8
     C                   Z-ADD     6             PDAYS
     C                   EXSR      $DATE
     C                   Z-ADD     PFRM8         WDFYMD
     C                   Z-ADD     PTO8          WDTYMD
     C                   WRITE     WDREC
      *
      * FIND THE NEXT FROM DATE BY ADDING SEVEN DAYS TO
      * THE CURRENT FROM DATE.
      *
     C                   Z-ADD     7             PDAYS
     C                   EXSR      $DATE
     C                   Z-ADD     PTO8          WKFYMD
     C                   ENDDO                                                  DO 28 WEEKS
      *
     C                   ENDSR
      /EJECT
      *----------------------------------------------------------------
      * $DEADS - SUM THE DAILY DEADS FOR A GROUP BY WEEK
      *----------------------------------------------------------------
      *
      * THIS SUBROUTINE WILL READ ALL THE DAILY DEADS FOR A GROUP AND
      * SUM THEM INTO THE APPROPRIATE WEEK IN THE GROUP DETAIL
      * WORKFILE
      *
     C     $DEADS        BEGSR
      *
     C     HGHGSN        SETLL     HSL068D
      *
     C     *IN91         DOUEQ     *ON                                          DO DEADS
     C     HGHGSN        READE     HSL068D                                91
     C     *IN91         IFEQ      *OFF                                         IF NOT EOF
     C                   Z-ADD     KDKDDT        WKCYMD
     C                   Z-ADD     KDKDHD        WKHD
     C                   EXSR      $ACCUM
     C                   ENDIF                                                  IF NOT EOF
     C                   ENDDO                                                  DO DEADS
      *
     C                   ENDSR
      /EJECT
      *----------------------------------------------------------------
      * $TDOAS - ACCUMULATE THE DOAS FROM TRANSFERS FOR THIS GROUP
      *----------------------------------------------------------------
      *
      * THIS SUBROUTINE WILL READ ALL DOAS FROM TRANSFERS FOR A GROUP
      * AND SUM THEM INTO THE APPROPRIATE WEEK IN THE GROUP DETAIL
      * WORKFILE.
      *
      * THE 'RECEIVE DATE' OF THE MOVEMENT WILL BE RETRIEVED AND USED
      * FOR DETERMINING THE 'DATE' OF THE DOA HEAD.
      *
     C     $TDOAS        BEGSR
      *
     C     HGHGSN        SETLL     HSL075C
      *
     C     *IN91         DOUEQ     *ON                                          DO TRAN DOA
     C     HGHGSN        READE     HSL075C                                91
     C     *IN91         IFEQ      *OFF                                         IF NOT EOF
     C     MDDOHD        ANDNE     0
      *
     C     MDMVSN        CHAIN     HSP074                             92
     C     *IN92         IFEQ      *OFF
     C                   Z-ADD     MHRCDT        WKCYMD
     C                   ELSE
     C                   Z-ADD     0             WKCYMD
     C                   ENDIF
      *
     C                   Z-ADD     MDDOHD        WKHD
     C                   EXSR      $ACCUM
     C                   ENDIF                                                  IF NOT EOF
     C                   ENDDO                                                  DO TRAN DOA
      *
     C                   ENDSR
      /EJECT
      *----------------------------------------------------------------
      * $SDOAS - ACCUMULATE THE DOAS FROM SALES FOR THIS GROUP
      *----------------------------------------------------------------
      *
      * THIS SUBROUTINE WILL READ ALL DOAS FROM SALES FOR A GROUP
      * AND SUM THEM INTO THE APPROPRIATE WEEK IN THE GROUP DETAIL
      * WORKFILE
      *
      * THE 'RECEIVE DATE' OF THE MOVEMENT WILL BE RETRIEVED AND USED
      * FOR DETERMINING THE 'DATE' OF THE DOA HEAD.
      *
     C     $SDOAS        BEGSR
      *
     C     HGHGSN        SETLL     HSL085B
      *
     C     *IN91         DOUEQ     *ON                                          DO SALES DOA
     C     HGHGSN        READE     HSL085B                                91
     C     *IN91         IFEQ      *OFF                                         IF NOT EOF
     C     SGDOHD        ANDNE     0
      *
     C     SGMVSN        CHAIN     HSP084                             92
     C     *IN92         IFEQ      *OFF
     C                   Z-ADD     SHRCDT        WKCYMD
     C                   ELSE
     C                   Z-ADD     0             WKCYMD
     C                   ENDIF
      *
     C                   Z-ADD     SGDOHD        WKHD
     C                   EXSR      $ACCUM
     C                   ENDIF                                                  IF NOT EOF
     C                   ENDDO                                                  DO SALES DOA
      *
     C                   ENDSR
      /EJECT
      *----------------------------------------------------------------
      * $CULLS - ACCUMULATE THE LIVE HEAD FROM CULLS SALES FOR GROUP
      *----------------------------------------------------------------
      *
      * THIS SUBROUTINE WILL READ ALL CULL SALES FOR A GROUP AND
      * ACCUMULATE LIVE HEAD IN THE APPROPRIATE WEEK FOR THE GROUP
      * DETAIL WORKFILE
      *
      * THE 'RECEIVE DATE' OF THE MOVEMENT WILL BE RETRIEVED AND USED
      * FOR DETERMINING WHETHER TO INCLUDE THE SALE.
      *
     C     $CULLS        BEGSR
      *
     C     HGHGSN        SETLL     HSL085B
      *
     C     *IN91         DOUEQ     *ON                                          DO CULL SALE
     C                   Z-ADD     0             WKCYMD
     C     HGHGSN        READE     HSL085B                                91
     C     *IN91         IFEQ      *OFF                                         IF NOT EOF
     C     SGLVHD        ANDNE     0
      *
     C     SGMVSN        CHAIN     HSP084                             92
     C     *IN92         IFEQ      *OFF                                         IF CULL SALE
     C     SHSTCD        ANDEQ     'CULLS'
     C                   Z-ADD     SHRCDT        WKCYMD
     C                   Z-ADD     SGLVHD        WKHD
     C                   EXSR      $ACCUM
     C                   ENDIF                                                  IF CULL SALE
      *
     C                   ENDIF                                                  IF NOT EOF
     C                   ENDDO                                                  DO CULL SALE
      *
     C                   ENDSR
      /EJECT
      *---------------------------------------------------------------
      * $ACCUM - ACCUMULATE DEAD HOGS INTO THE APPROPRIATE WEEK
      *---------------------------------------------------------------
      *
     C     $ACCUM        BEGSR
      *
      * POSITION IN THE FILE USING THE HOG GROUP NUMBER AND DATE.
      *
     C     K1P303        SETLL     HSP303
     C     HGHGSN        READE     HSP303                                 92
     C     *IN92         IFEQ      *OFF                                         IF FOUND WK
     C                   ADD       WKHD          WDCDHD
     C                   UPDATE    WDREC
     C                   ELSE
      *
      * IF YOUR DATE DIDN'T FIT INTO ANY OF THE 28 WEEKS,
      * DUMP THE HEAD INTO WEEK 28
      *
     C     HGHGSN        SETGT     HSP303
     C     HGHGSN        READPE    HSP303                                 92
     C     *IN92         IFEQ      *OFF                                         IF DUMPING
     C                   ADD       WKHD          WDCDHD
     C                   UPDATE    WDREC
     C                   ENDIF                                                  IF DUMPING
     C                   ENDIF                                                  IF FOUND WK
      *
     C                   ENDSR
      /EJECT
      *----------------------------------------------------------------
      * $GROUP - READ THE GROUP DETAIL RECORDS AND WRITE A TOTAL RECORD
      *----------------------------------------------------------------
      *
      * THIS SUBROUTINE READS THE 28 DETAIL RECORDS FOR THE GROUP
      * AND MOVES THE VALUES INTO A SINGLE TOTAL RECORD WHICH WILL BE
      * PRINTED ON THE REPORT.
      *
      * THE 'PERCENT' FOR EACH WEEK IS ALSO CALCULATED.  THE
      * VALUE IS THE PERCENT OF ADJUSTED HEAD TRANSFERRED INTO THE GROUP
      * THAT IS REPRESENTED BY THE WEEK'S DEAD AND CULL SALE HEAD.
      *
     C     $GROUP        BEGSR
      *
     C                   Z-ADD     HGHGSN        WGHGSN
     C                   MOVEL     HGHGCD        WGHGCD
     C                   MOVEL     HGBLCD        WGBLCD
     C                   MOVEL     HGRMCD        WGRMCD
     C                   MOVEL     HGFSCD        WGFSCD
     C                   MOVEL     HGPPCD        WGPPCD
      *
      *  INITIALIZE DEAD/CULL SALE HEAD FIELDS FOR THE 28 WEEKS
      *
     C                   Z-ADD     0             WGCDHD
     C                   Z-ADD     0             WG01HD
     C                   Z-ADD     0             WG02HD
     C                   Z-ADD     0             WG03HD
     C                   Z-ADD     0             WG04HD
     C                   Z-ADD     0             WG05HD
     C                   Z-ADD     0             WG06HD
     C                   Z-ADD     0             WG07HD
     C                   Z-ADD     0             WG08HD
     C                   Z-ADD     0             WG09HD
     C                   Z-ADD     0             WG10HD
     C                   Z-ADD     0             WG11HD
     C                   Z-ADD     0             WG12HD
     C                   Z-ADD     0             WG13HD
     C                   Z-ADD     0             WG14HD
     C                   Z-ADD     0             WG15HD
     C                   Z-ADD     0             WG16HD
     C                   Z-ADD     0             WG17HD
     C                   Z-ADD     0             WG18HD
     C                   Z-ADD     0             WG19HD
     C                   Z-ADD     0             WG20HD
     C                   Z-ADD     0             WG21HD
     C                   Z-ADD     0             WG22HD
     C                   Z-ADD     0             WG23HD
     C                   Z-ADD     0             WG24HD
     C                   Z-ADD     0             WG25HD
     C                   Z-ADD     0             WG26HD
     C                   Z-ADD     0             WG27HD
     C                   Z-ADD     0             WG28HD
      *
      *  INITIALIZE PERCENT FIELDS FOR THE 28 WEEKS
      *
     C                   Z-ADD     0             WG01PR
     C                   Z-ADD     0             WG02PR
     C                   Z-ADD     0             WG03PR
     C                   Z-ADD     0             WG04PR
     C                   Z-ADD     0             WG05PR
     C                   Z-ADD     0             WG06PR
     C                   Z-ADD     0             WG07PR
     C                   Z-ADD     0             WG08PR
     C                   Z-ADD     0             WG09PR
     C                   Z-ADD     0             WG10PR
     C                   Z-ADD     0             WG11PR
     C                   Z-ADD     0             WG12PR
     C                   Z-ADD     0             WG13PR
     C                   Z-ADD     0             WG14PR
     C                   Z-ADD     0             WG15PR
     C                   Z-ADD     0             WG16PR
     C                   Z-ADD     0             WG17PR
     C                   Z-ADD     0             WG18PR
     C                   Z-ADD     0             WG19PR
     C                   Z-ADD     0             WG20PR
     C                   Z-ADD     0             WG21PR
     C                   Z-ADD     0             WG22PR
     C                   Z-ADD     0             WG23PR
     C                   Z-ADD     0             WG24PR
     C                   Z-ADD     0             WG25PR
     C                   Z-ADD     0             WG26PR
     C                   Z-ADD     0             WG27PR
     C                   Z-ADD     0             WG28PR
      *
     C                   Z-ADD     0             COUNT
      *
      * RETRIEVE TOTAL HEAD TRANSFERRED INTO THE GROUP FROM
      * THE CLOSED GROUP RECORD.
      *
     C                   MOVEL     'TRANI'       WKRPCD
     C     K2P033        CHAIN     HSP033                             92
     C     *IN92         IFEQ      *OFF
     C                   Z-ADD     CGCGHD        WGTIHD
     C                   ELSE
     C                   Z-ADD     0             WGTIHD
     C                   ENDIF
      *
      * RETRIEVE ADJUSTED HEAD TRANSFERRED INTO THE GROUP FROM
      * THE CLOSED GROUP RECORD.
      *
     C                   MOVEL     'TRANA'       WKRPCD
     C     K2P033        CHAIN     HSP033                             92
     C     *IN92         IFEQ      *OFF
     C                   Z-ADD     CGCGHD        WGAJTIHD
     C                   ELSE
     C                   Z-ADD     0             WGAJTIHD
     C                   ENDIF
      *
      * PROCESS THE 28 DETAIL RECORDS FOR THE GROUP
      *
     C     HGHGSN        SETLL     HSP303
      *
     C     *IN91         DOUEQ     *ON                                          DO WEEKS
     C     HGHGSN        READE     HSP303                                 91
     C     *IN91         IFEQ      *OFF                                         IF NOT EOF
     C                   ADD       1             COUNT
      *
      * ACCUMULATE DEAD AND CULL SALE HEAD FOR THE GROUP
      *
     C                   ADD       WDCDHD        WGCDHD
      *
      * SETUP DEAD AND CULL SALE HEAD PER WEEK
      *
     C                   SELECT
     C     COUNT         WHENEQ    1
     C                   Z-ADD     WDCDHD        WG01HD
      *
     C     COUNT         WHENEQ    2
     C                   Z-ADD     WDCDHD        WG02HD
      *
     C     COUNT         WHENEQ    3
     C                   Z-ADD     WDCDHD        WG03HD
      *
     C     COUNT         WHENEQ    4
     C                   Z-ADD     WDCDHD        WG04HD
      *
     C     COUNT         WHENEQ    5
     C                   Z-ADD     WDCDHD        WG05HD
      *
     C     COUNT         WHENEQ    6
     C                   Z-ADD     WDCDHD        WG06HD
      *
     C     COUNT         WHENEQ    7
     C                   Z-ADD     WDCDHD        WG07HD
      *
     C     COUNT         WHENEQ    8
     C                   Z-ADD     WDCDHD        WG08HD
      *
     C     COUNT         WHENEQ    9
     C                   Z-ADD     WDCDHD        WG09HD
      *
     C     COUNT         WHENEQ    10
     C                   Z-ADD     WDCDHD        WG10HD
      *
     C     COUNT         WHENEQ    11
     C                   Z-ADD     WDCDHD        WG11HD
      *
     C     COUNT         WHENEQ    12
     C                   Z-ADD     WDCDHD        WG12HD
      *
     C     COUNT         WHENEQ    13
     C                   Z-ADD     WDCDHD        WG13HD
      *
     C     COUNT         WHENEQ    14
     C                   Z-ADD     WDCDHD        WG14HD
      *
     C     COUNT         WHENEQ    15
     C                   Z-ADD     WDCDHD        WG15HD
      *
     C     COUNT         WHENEQ    16
     C                   Z-ADD     WDCDHD        WG16HD
      *
     C     COUNT         WHENEQ    17
     C                   Z-ADD     WDCDHD        WG17HD
      *
     C     COUNT         WHENEQ    18
     C                   Z-ADD     WDCDHD        WG18HD
      *
     C     COUNT         WHENEQ    19
     C                   Z-ADD     WDCDHD        WG19HD
      *
     C     COUNT         WHENEQ    20
     C                   Z-ADD     WDCDHD        WG20HD
      *
     C     COUNT         WHENEQ    21
     C                   Z-ADD     WDCDHD        WG21HD
      *
     C     COUNT         WHENEQ    22
     C                   Z-ADD     WDCDHD        WG22HD
      *
     C     COUNT         WHENEQ    23
     C                   Z-ADD     WDCDHD        WG23HD
      *
     C     COUNT         WHENEQ    24
     C                   Z-ADD     WDCDHD        WG24HD
      *
     C     COUNT         WHENEQ    25
     C                   Z-ADD     WDCDHD        WG25HD
      *
     C     COUNT         WHENEQ    26
     C                   Z-ADD     WDCDHD        WG26HD
      *
     C     COUNT         WHENEQ    27
     C                   Z-ADD     WDCDHD        WG27HD
      *
     C     COUNT         WHENEQ    28
     C                   Z-ADD     WDCDHD        WG28HD
     C                   ENDSL
      *
     C                   ENDIF                                                  IF NOT EOF
     C                   ENDDO                                                  DO WEEKS
      *
      * CALCULATE PERCENT OF ADJUSTED TRANSFERS IN REPRESENTED
      * FOR EACH WEEK.
      *
     C     WG01HD        IFNE      0
     C     WGAJTIHD      ANDNE     0
     C     WG01HD        DIV       WGAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WG01PR
     C                   ENDIF
      *
     C     WG02HD        IFNE      0
     C     WGAJTIHD      ANDNE     0
     C     WG02HD        DIV       WGAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WG02PR
     C                   ENDIF
      *
     C     WG03HD        IFNE      0
     C     WGAJTIHD      ANDNE     0
     C     WG03HD        DIV       WGAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WG03PR
     C                   ENDIF
      *
     C     WG04HD        IFNE      0
     C     WGAJTIHD      ANDNE     0
     C     WG04HD        DIV       WGAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WG04PR
     C                   ENDIF
      *
     C     WG05HD        IFNE      0
     C     WGAJTIHD      ANDNE     0
     C     WG05HD        DIV       WGAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WG05PR
     C                   ENDIF
      *
     C     WG06HD        IFNE      0
     C     WGAJTIHD      ANDNE     0
     C     WG06HD        DIV       WGAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WG06PR
     C                   ENDIF
      *
     C     WG07HD        IFNE      0
     C     WGAJTIHD      ANDNE     0
     C     WG07HD        DIV       WGAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WG07PR
     C                   ENDIF
      *
     C     WG08HD        IFNE      0
     C     WGAJTIHD      ANDNE     0
     C     WG08HD        DIV       WGAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WG08PR
     C                   ENDIF
      *
     C     WG09HD        IFNE      0
     C     WGAJTIHD      ANDNE     0
     C     WG09HD        DIV       WGAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WG09PR
     C                   ENDIF
      *
     C     WG10HD        IFNE      0
     C     WGAJTIHD      ANDNE     0
     C     WG10HD        DIV       WGAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WG10PR
     C                   ENDIF
      *
     C     WG11HD        IFNE      0
     C     WGAJTIHD      ANDNE     0
     C     WG11HD        DIV       WGAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WG11PR
     C                   ENDIF
      *
     C     WG12HD        IFNE      0
     C     WGAJTIHD      ANDNE     0
     C     WG12HD        DIV       WGAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WG12PR
     C                   ENDIF
      *
     C     WG13HD        IFNE      0
     C     WGAJTIHD      ANDNE     0
     C     WG13HD        DIV       WGAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WG13PR
     C                   ENDIF
      *
     C     WG14HD        IFNE      0
     C     WGAJTIHD      ANDNE     0
     C     WG14HD        DIV       WGAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WG14PR
     C                   ENDIF
      *
     C     WG15HD        IFNE      0
     C     WGAJTIHD      ANDNE     0
     C     WG15HD        DIV       WGAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WG15PR
     C                   ENDIF
      *
     C     WG16HD        IFNE      0
     C     WGAJTIHD      ANDNE     0
     C     WG16HD        DIV       WGAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WG16PR
     C                   ENDIF
      *
     C     WG17HD        IFNE      0
     C     WGAJTIHD      ANDNE     0
     C     WG17HD        DIV       WGAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WG17PR
     C                   ENDIF
      *
     C     WG18HD        IFNE      0
     C     WGAJTIHD      ANDNE     0
     C     WG18HD        DIV       WGAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WG18PR
     C                   ENDIF
      *
     C     WG19HD        IFNE      0
     C     WGAJTIHD      ANDNE     0
     C     WG19HD        DIV       WGAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WG19PR
     C                   ENDIF
      *
     C     WG20HD        IFNE      0
     C     WGAJTIHD      ANDNE     0
     C     WG20HD        DIV       WGAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WG20PR
     C                   ENDIF
      *
     C     WG21HD        IFNE      0
     C     WGAJTIHD      ANDNE     0
     C     WG21HD        DIV       WGAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WG21PR
     C                   ENDIF
      *
     C     WG22HD        IFNE      0
     C     WGAJTIHD      ANDNE     0
     C     WG22HD        DIV       WGAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WG22PR
     C                   ENDIF
      *
     C     WG23HD        IFNE      0
     C     WGAJTIHD      ANDNE     0
     C     WG23HD        DIV       WGAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WG23PR
     C                   ENDIF
      *
     C     WG24HD        IFNE      0
     C     WGAJTIHD      ANDNE     0
     C     WG24HD        DIV       WGAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WG24PR
     C                   ENDIF
      *
     C     WG25HD        IFNE      0
     C     WGAJTIHD      ANDNE     0
     C     WG25HD        DIV       WGAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WG25PR
     C                   ENDIF
      *
     C     WG26HD        IFNE      0
     C     WGAJTIHD      ANDNE     0
     C     WG26HD        DIV       WGAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WG26PR
     C                   ENDIF
      *
     C     WG27HD        IFNE      0
     C     WGAJTIHD      ANDNE     0
     C     WG27HD        DIV       WGAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WG27PR
     C                   ENDIF
      *
     C     WG28HD        IFNE      0
     C     WGAJTIHD      ANDNE     0
     C     WG28HD        DIV       WGAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WG28PR
     C                   ENDIF
      *
     C                   WRITE     WGREC
      *
     C                   ENDSR
      /EJECT
      *---------------------------------------------------------------
      * $FARM - READ GROUP TOTAL RECORDS AND CREATE FARM TOTAL RECORD
      *---------------------------------------------------------------
      *
      * THIS SUBROUTINE READS THE GROUP TOTAL RECORDS FROM THE WORKFILE
      * AND CREATES A TOTAL RECORD FOR EACH FARM IN THE 'FARM TOTAL'
      * WORKFILE.
      *
     C     $FARM         BEGSR
      *
     C     *LOVAL        SETLL     HSL304B
     C                   MOVEL     YES           FIRST
      *
     C     *IN91         DOUEQ     *ON                                          DO GROUPS
     C                   READ      HSL304B                                91
     C     *IN91         IFEQ      *OFF                                         IF NOT EOF
      *
     C     FIRST         IFEQ      YES
     C                   MOVEL     NO            FIRST
     C                   EXSR      $CLRFS
     C                   ENDIF
      *
     C     SVPPCD        IFNE      WGPPCD                                       IF BREAK
     C     SVFSCD        ORNE      WGFSCD
     C                   EXSR      $WRTFS
     C                   EXSR      $CLRFS
     C                   ENDIF                                                  IF BREAK
      *
     C                   ADD       WGTIHD        WFTIHD
     C                   ADD       WGAJTIHD      WFAJTIHD
     C                   ADD       WGCDHD        WFCDHD
     C                   ADD       WG01HD        WF01HD
     C                   ADD       WG02HD        WF02HD
     C                   ADD       WG03HD        WF03HD
     C                   ADD       WG04HD        WF04HD
     C                   ADD       WG05HD        WF05HD
     C                   ADD       WG06HD        WF06HD
     C                   ADD       WG07HD        WF07HD
     C                   ADD       WG08HD        WF08HD
     C                   ADD       WG09HD        WF09HD
     C                   ADD       WG10HD        WF10HD
     C                   ADD       WG11HD        WF11HD
     C                   ADD       WG12HD        WF12HD
     C                   ADD       WG13HD        WF13HD
     C                   ADD       WG14HD        WF14HD
     C                   ADD       WG15HD        WF15HD
     C                   ADD       WG16HD        WF16HD
     C                   ADD       WG17HD        WF17HD
     C                   ADD       WG18HD        WF18HD
     C                   ADD       WG19HD        WF19HD
     C                   ADD       WG20HD        WF20HD
     C                   ADD       WG21HD        WF21HD
     C                   ADD       WG22HD        WF22HD
     C                   ADD       WG23HD        WF23HD
     C                   ADD       WG24HD        WF24HD
     C                   ADD       WG25HD        WF25HD
     C                   ADD       WG26HD        WF26HD
     C                   ADD       WG27HD        WF27HD
     C                   ADD       WG28HD        WF28HD
     C                   ENDIF                                                  IF NOT EOF
      *
     C                   ENDDO                                                  DO GROUPS
      *
      *  WRITE OUT THE LAST FARM RECORD
      *
     C     FIRST         IFEQ      NO
     C                   EXSR      $WRTFS
     C                   ENDIF
      *
     C                   ENDSR
      /EJECT
      *---------------------------------------------------------------
      * $CLRFS - CLEAR FIELDS IN FARM SITE TOTAL WORKFILE RECORD
      *---------------------------------------------------------------
      *
     C     $CLRFS        BEGSR
      *
     C                   MOVEL     WGPPCD        SVPPCD
     C                   Z-ADD     WGFSCD        SVFSCD
      *
     C                   Z-ADD     WGFSCD        WFFSCD
     C                   MOVEL     WGPPCD        WFPPCD
      *
     C                   Z-ADD     0             WFTIHD
     C                   Z-ADD     0             WFAJTIHD
     C                   Z-ADD     0             WFCDHD
     C                   Z-ADD     0             WF01HD
     C                   Z-ADD     0             WF02HD
     C                   Z-ADD     0             WF03HD
     C                   Z-ADD     0             WF04HD
     C                   Z-ADD     0             WF05HD
     C                   Z-ADD     0             WF06HD
     C                   Z-ADD     0             WF07HD
     C                   Z-ADD     0             WF08HD
     C                   Z-ADD     0             WF09HD
     C                   Z-ADD     0             WF10HD
     C                   Z-ADD     0             WF11HD
     C                   Z-ADD     0             WF12HD
     C                   Z-ADD     0             WF13HD
     C                   Z-ADD     0             WF14HD
     C                   Z-ADD     0             WF15HD
     C                   Z-ADD     0             WF16HD
     C                   Z-ADD     0             WF17HD
     C                   Z-ADD     0             WF18HD
     C                   Z-ADD     0             WF19HD
     C                   Z-ADD     0             WF20HD
     C                   Z-ADD     0             WF21HD
     C                   Z-ADD     0             WF22HD
     C                   Z-ADD     0             WF23HD
     C                   Z-ADD     0             WF24HD
     C                   Z-ADD     0             WF25HD
     C                   Z-ADD     0             WF26HD
     C                   Z-ADD     0             WF27HD
     C                   Z-ADD     0             WF28HD
      *
     C                   Z-ADD     0             WF01PR
     C                   Z-ADD     0             WF02PR
     C                   Z-ADD     0             WF03PR
     C                   Z-ADD     0             WF04PR
     C                   Z-ADD     0             WF05PR
     C                   Z-ADD     0             WF06PR
     C                   Z-ADD     0             WF07PR
     C                   Z-ADD     0             WF08PR
     C                   Z-ADD     0             WF09PR
     C                   Z-ADD     0             WF10PR
     C                   Z-ADD     0             WF11PR
     C                   Z-ADD     0             WF12PR
     C                   Z-ADD     0             WF13PR
     C                   Z-ADD     0             WF14PR
     C                   Z-ADD     0             WF15PR
     C                   Z-ADD     0             WF16PR
     C                   Z-ADD     0             WF17PR
     C                   Z-ADD     0             WF18PR
     C                   Z-ADD     0             WF19PR
     C                   Z-ADD     0             WF20PR
     C                   Z-ADD     0             WF21PR
     C                   Z-ADD     0             WF22PR
     C                   Z-ADD     0             WF23PR
     C                   Z-ADD     0             WF24PR
     C                   Z-ADD     0             WF25PR
     C                   Z-ADD     0             WF26PR
     C                   Z-ADD     0             WF27PR
     C                   Z-ADD     0             WF28PR
      *
     C                   ENDSR
      /EJECT
      *---------------------------------------------------------------
      * $WRTFS - WRITE A FARM SITE TOTAL WORKFILE RECORD
      *---------------------------------------------------------------
      *
     C     $WRTFS        BEGSR
      *
      * CALCULATE PERCENT PER WEEK
      *
     C     WF01HD        IFNE      0
     C     WFAJTIHD      ANDNE     0
     C     WF01HD        DIV       WFAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WF01PR
     C                   ENDIF
      *
     C     WF02HD        IFNE      0
     C     WFAJTIHD      ANDNE     0
     C     WF02HD        DIV       WFAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WF02PR
     C                   ENDIF
      *
     C     WF03HD        IFNE      0
     C     WFAJTIHD      ANDNE     0
     C     WF03HD        DIV       WFAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WF03PR
     C                   ENDIF
      *
     C     WF04HD        IFNE      0
     C     WFAJTIHD      ANDNE     0
     C     WF04HD        DIV       WFAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WF04PR
     C                   ENDIF
      *
     C     WF05HD        IFNE      0
     C     WFAJTIHD      ANDNE     0
     C     WF05HD        DIV       WFAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WF05PR
     C                   ENDIF
      *
     C     WF06HD        IFNE      0
     C     WFAJTIHD      ANDNE     0
     C     WF06HD        DIV       WFAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WF06PR
     C                   ENDIF
      *
     C     WF07HD        IFNE      0
     C     WFAJTIHD      ANDNE     0
     C     WF07HD        DIV       WFAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WF07PR
     C                   ENDIF
      *
     C     WF08HD        IFNE      0
     C     WFAJTIHD      ANDNE     0
     C     WF08HD        DIV       WFAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WF08PR
     C                   ENDIF
      *
     C     WF09HD        IFNE      0
     C     WFAJTIHD      ANDNE     0
     C     WF09HD        DIV       WFAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WF09PR
     C                   ENDIF
      *
     C     WF10HD        IFNE      0
     C     WFAJTIHD      ANDNE     0
     C     WF10HD        DIV       WFAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WF10PR
     C                   ENDIF
      *
     C     WF11HD        IFNE      0
     C     WFAJTIHD      ANDNE     0
     C     WF11HD        DIV       WFAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WF11PR
     C                   ENDIF
      *
     C     WF12HD        IFNE      0
     C     WFAJTIHD      ANDNE     0
     C     WF12HD        DIV       WFAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WF12PR
     C                   ENDIF
      *
     C     WF13HD        IFNE      0
     C     WFAJTIHD      ANDNE     0
     C     WF13HD        DIV       WFAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WF13PR
     C                   ENDIF
      *
     C     WF14HD        IFNE      0
     C     WFAJTIHD      ANDNE     0
     C     WF14HD        DIV       WFAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WF14PR
     C                   ENDIF
      *
     C     WF15HD        IFNE      0
     C     WFAJTIHD      ANDNE     0
     C     WF15HD        DIV       WFAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WF15PR
     C                   ENDIF
      *
     C     WF16HD        IFNE      0
     C     WFAJTIHD      ANDNE     0
     C     WF16HD        DIV       WFAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WF16PR
     C                   ENDIF
      *
     C     WF17HD        IFNE      0
     C     WFAJTIHD      ANDNE     0
     C     WF17HD        DIV       WFAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WF17PR
     C                   ENDIF
      *
     C     WF18HD        IFNE      0
     C     WFAJTIHD      ANDNE     0
     C     WF18HD        DIV       WFAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WF18PR
     C                   ENDIF
      *
     C     WF19HD        IFNE      0
     C     WFAJTIHD      ANDNE     0
     C     WF19HD        DIV       WFAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WF19PR
     C                   ENDIF
      *
     C     WF20HD        IFNE      0
     C     WFAJTIHD      ANDNE     0
     C     WF20HD        DIV       WFAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WF20PR
     C                   ENDIF
      *
     C     WF21HD        IFNE      0
     C     WFAJTIHD      ANDNE     0
     C     WF21HD        DIV       WFAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WF21PR
     C                   ENDIF
      *
     C     WF22HD        IFNE      0
     C     WFAJTIHD      ANDNE     0
     C     WF22HD        DIV       WFAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WF22PR
     C                   ENDIF
      *
     C     WF23HD        IFNE      0
     C     WFAJTIHD      ANDNE     0
     C     WF23HD        DIV       WFAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WF23PR
     C                   ENDIF
      *
     C     WF24HD        IFNE      0
     C     WFAJTIHD      ANDNE     0
     C     WF24HD        DIV       WFAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WF24PR
     C                   ENDIF
      *
     C     WF25HD        IFNE      0
     C     WFAJTIHD      ANDNE     0
     C     WF25HD        DIV       WFAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WF25PR
     C                   ENDIF
      *
     C     WF26HD        IFNE      0
     C     WFAJTIHD      ANDNE     0
     C     WF26HD        DIV       WFAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WF26PR
     C                   ENDIF
      *
     C     WF27HD        IFNE      0
     C     WFAJTIHD      ANDNE     0
     C     WF27HD        DIV       WFAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WF27PR
     C                   ENDIF
      *
     C     WF28HD        IFNE      0
     C     WFAJTIHD      ANDNE     0
     C     WF28HD        DIV       WFAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WF28PR
     C                   ENDIF
      *
     C                   WRITE     WFREC
      *
     C                   ENDSR
      /EJECT
      *---------------------------------------------------------------
      * $PHASE - READ FARM TOTAL RECORDS AND CREATE PHASE TOTAL RECORD
      *---------------------------------------------------------------
      *
      * THIS SUBROUTINE READS THE FARM TOTAL RECORDS FROM THE WORKFILE
      * AND CREATES A TOTAL RECORD FOR EACH PHASE FOR THE 'PHASE TOTAL'
      * WORKFILE.
      *
     C     $PHASE        BEGSR
      *
     C     *LOVAL        SETLL     HSL305A
     C                   MOVEL     YES           FIRST
      *
     C     *IN91         DOUEQ     *ON                                          DO FARMS
     C                   READ      HSL305A                                91
     C     *IN91         IFEQ      *OFF                                         IF NOT EOF
      *
     C     FIRST         IFEQ      YES
     C                   MOVEL     NO            FIRST
     C                   EXSR      $CLRPP
     C                   ENDIF
      *
     C     SVPPCD        IFNE      WFPPCD                                       IF BREAK
     C                   EXSR      $WRTPP
     C                   EXSR      $CLRPP
     C                   ENDIF                                                  IF BREAK
      *
     C                   ADD       WFTIHD        WPTIHD
     C                   ADD       WFAJTIHD      WPAJTIHD
     C                   ADD       WFCDHD        WPCDHD
     C                   ADD       WF01HD        WP01HD
     C                   ADD       WF02HD        WP02HD
     C                   ADD       WF03HD        WP03HD
     C                   ADD       WF04HD        WP04HD
     C                   ADD       WF05HD        WP05HD
     C                   ADD       WF06HD        WP06HD
     C                   ADD       WF07HD        WP07HD
     C                   ADD       WF08HD        WP08HD
     C                   ADD       WF09HD        WP09HD
     C                   ADD       WF10HD        WP10HD
     C                   ADD       WF11HD        WP11HD
     C                   ADD       WF12HD        WP12HD
     C                   ADD       WF13HD        WP13HD
     C                   ADD       WF14HD        WP14HD
     C                   ADD       WF15HD        WP15HD
     C                   ADD       WF16HD        WP16HD
     C                   ADD       WF17HD        WP17HD
     C                   ADD       WF18HD        WP18HD
     C                   ADD       WF19HD        WP19HD
     C                   ADD       WF20HD        WP20HD
     C                   ADD       WF21HD        WP21HD
     C                   ADD       WF22HD        WP22HD
     C                   ADD       WF23HD        WP23HD
     C                   ADD       WF24HD        WP24HD
     C                   ADD       WF25HD        WP25HD
     C                   ADD       WF26HD        WP26HD
     C                   ADD       WF27HD        WP27HD
     C                   ADD       WF28HD        WP28HD
     C                   ENDIF                                                  IF NOT EOF
      *
     C                   ENDDO                                                  DO GROUPS
      *
      *  WRITE OUT THE LAST PHASE RECORD
      *
     C     FIRST         IFEQ      NO
     C                   EXSR      $WRTPP
     C                   ENDIF
      *
     C                   ENDSR
      /EJECT
      *---------------------------------------------------------------
      * $CLRPP - CLEAR FIELDS IN PRODUCTION PHASE TOTAL WORKFILE REC
      *---------------------------------------------------------------
      *
     C     $CLRPP        BEGSR
      *
     C                   MOVEL     WFPPCD        SVPPCD
     C                   MOVEL     WFPPCD        WPPPCD
      *
     C                   Z-ADD     0             WPTIHD
     C                   Z-ADD     0             WPAJTIHD
     C                   Z-ADD     0             WPCDHD
     C                   Z-ADD     0             WP01HD
     C                   Z-ADD     0             WP02HD
     C                   Z-ADD     0             WP03HD
     C                   Z-ADD     0             WP04HD
     C                   Z-ADD     0             WP05HD
     C                   Z-ADD     0             WP06HD
     C                   Z-ADD     0             WP07HD
     C                   Z-ADD     0             WP08HD
     C                   Z-ADD     0             WP09HD
     C                   Z-ADD     0             WP10HD
     C                   Z-ADD     0             WP11HD
     C                   Z-ADD     0             WP12HD
     C                   Z-ADD     0             WP13HD
     C                   Z-ADD     0             WP14HD
     C                   Z-ADD     0             WP15HD
     C                   Z-ADD     0             WP16HD
     C                   Z-ADD     0             WP17HD
     C                   Z-ADD     0             WP18HD
     C                   Z-ADD     0             WP19HD
     C                   Z-ADD     0             WP20HD
     C                   Z-ADD     0             WP21HD
     C                   Z-ADD     0             WP22HD
     C                   Z-ADD     0             WP23HD
     C                   Z-ADD     0             WP24HD
     C                   Z-ADD     0             WP25HD
     C                   Z-ADD     0             WP26HD
     C                   Z-ADD     0             WP27HD
     C                   Z-ADD     0             WP28HD
      *
     C                   Z-ADD     0             WP01PR
     C                   Z-ADD     0             WP02PR
     C                   Z-ADD     0             WP03PR
     C                   Z-ADD     0             WP04PR
     C                   Z-ADD     0             WP05PR
     C                   Z-ADD     0             WP06PR
     C                   Z-ADD     0             WP07PR
     C                   Z-ADD     0             WP08PR
     C                   Z-ADD     0             WP09PR
     C                   Z-ADD     0             WP10PR
     C                   Z-ADD     0             WP11PR
     C                   Z-ADD     0             WP12PR
     C                   Z-ADD     0             WP13PR
     C                   Z-ADD     0             WP14PR
     C                   Z-ADD     0             WP15PR
     C                   Z-ADD     0             WP16PR
     C                   Z-ADD     0             WP17PR
     C                   Z-ADD     0             WP18PR
     C                   Z-ADD     0             WP19PR
     C                   Z-ADD     0             WP20PR
     C                   Z-ADD     0             WP21PR
     C                   Z-ADD     0             WP22PR
     C                   Z-ADD     0             WP23PR
     C                   Z-ADD     0             WP24PR
     C                   Z-ADD     0             WP25PR
     C                   Z-ADD     0             WP26PR
     C                   Z-ADD     0             WP27PR
     C                   Z-ADD     0             WP28PR
      *
     C                   ENDSR
      /EJECT
      *---------------------------------------------------------------
      * $WRTPP - WRITE A PRODUCTION PHASE TOTAL
      *---------------------------------------------------------------
      *
     C     $WRTPP        BEGSR
      *
      * CALCULATE PERCENT PER WEEK
      *
     C     WP01HD        IFNE      0
     C     WPAJTIHD      ANDNE     0
     C     WP01HD        DIV       WPAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WP01PR
     C                   ENDIF
      *
     C     WP02HD        IFNE      0
     C     WPAJTIHD      ANDNE     0
     C     WP02HD        DIV       WPAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WP02PR
     C                   ENDIF
      *
     C     WP03HD        IFNE      0
     C     WPAJTIHD      ANDNE     0
     C     WP03HD        DIV       WPAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WP03PR
     C                   ENDIF
      *
     C     WP04HD        IFNE      0
     C     WPAJTIHD      ANDNE     0
     C     WP04HD        DIV       WPAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WP04PR
     C                   ENDIF
      *
     C     WP05HD        IFNE      0
     C     WPAJTIHD      ANDNE     0
     C     WP05HD        DIV       WPAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WP05PR
     C                   ENDIF
      *
     C     WP06HD        IFNE      0
     C     WPAJTIHD      ANDNE     0
     C     WP06HD        DIV       WPAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WP06PR
     C                   ENDIF
      *
     C     WP07HD        IFNE      0
     C     WPAJTIHD      ANDNE     0
     C     WP07HD        DIV       WPAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WP07PR
     C                   ENDIF
      *
     C     WP08HD        IFNE      0
     C     WPAJTIHD      ANDNE     0
     C     WP08HD        DIV       WPAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WP08PR
     C                   ENDIF
      *
     C     WP09HD        IFNE      0
     C     WPAJTIHD      ANDNE     0
     C     WP09HD        DIV       WPAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WP09PR
     C                   ENDIF
      *
     C     WP10HD        IFNE      0
     C     WPAJTIHD      ANDNE     0
     C     WP10HD        DIV       WPAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WP10PR
     C                   ENDIF
      *
     C     WP11HD        IFNE      0
     C     WPAJTIHD      ANDNE     0
     C     WP11HD        DIV       WPAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WP11PR
     C                   ENDIF
      *
     C     WP12HD        IFNE      0
     C     WPAJTIHD      ANDNE     0
     C     WP12HD        DIV       WPAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WP12PR
     C                   ENDIF
      *
     C     WP13HD        IFNE      0
     C     WPAJTIHD      ANDNE     0
     C     WP13HD        DIV       WPAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WP13PR
     C                   ENDIF
      *
     C     WP14HD        IFNE      0
     C     WPAJTIHD      ANDNE     0
     C     WP14HD        DIV       WPAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WP14PR
     C                   ENDIF
      *
     C     WP15HD        IFNE      0
     C     WPAJTIHD      ANDNE     0
     C     WP15HD        DIV       WPAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WP15PR
     C                   ENDIF
      *
     C     WP16HD        IFNE      0
     C     WPAJTIHD      ANDNE     0
     C     WP16HD        DIV       WPAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WP16PR
     C                   ENDIF
      *
     C     WP17HD        IFNE      0
     C     WPAJTIHD      ANDNE     0
     C     WP17HD        DIV       WPAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WP17PR
     C                   ENDIF
      *
     C     WP18HD        IFNE      0
     C     WPAJTIHD      ANDNE     0
     C     WP18HD        DIV       WPAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WP18PR
     C                   ENDIF
      *
     C     WP19HD        IFNE      0
     C     WPAJTIHD      ANDNE     0
     C     WP19HD        DIV       WPAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WP19PR
     C                   ENDIF
      *
     C     WP20HD        IFNE      0
     C     WPAJTIHD      ANDNE     0
     C     WP20HD        DIV       WPAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WP20PR
     C                   ENDIF
      *
     C     WP21HD        IFNE      0
     C     WPAJTIHD      ANDNE     0
     C     WP21HD        DIV       WPAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WP21PR
     C                   ENDIF
      *
     C     WP22HD        IFNE      0
     C     WPAJTIHD      ANDNE     0
     C     WP22HD        DIV       WPAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WP22PR
     C                   ENDIF
      *
     C     WP23HD        IFNE      0
     C     WPAJTIHD      ANDNE     0
     C     WP23HD        DIV       WPAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WP23PR
     C                   ENDIF
      *
     C     WP24HD        IFNE      0
     C     WPAJTIHD      ANDNE     0
     C     WP24HD        DIV       WPAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WP24PR
     C                   ENDIF
      *
     C     WP25HD        IFNE      0
     C     WPAJTIHD      ANDNE     0
     C     WP25HD        DIV       WPAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WP25PR
     C                   ENDIF
      *
     C     WP26HD        IFNE      0
     C     WPAJTIHD      ANDNE     0
     C     WP26HD        DIV       WPAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WP26PR
     C                   ENDIF
      *
     C     WP27HD        IFNE      0
     C     WPAJTIHD      ANDNE     0
     C     WP27HD        DIV       WPAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WP27PR
     C                   ENDIF
      *
     C     WP28HD        IFNE      0
     C     WPAJTIHD      ANDNE     0
     C     WP28HD        DIV       WPAJTIHD      WKFLD
     C     WKFLD         MULT(H)   100           WP28PR
     C                   ENDIF
      *
     C                   WRITE     WPREC
      *
     C                   ENDSR
      /EJECT
      *---------------------------------------------------------------
      * $DATE -  MANIPULATE DATES WITH DATE UTILITY
      *---------------------------------------------------------------
      *
     C     $DATE         BEGSR
      *
     C                   MOVEL     'CYMD'        PFRFMT
     C                   MOVEL     'CYMD'        PTOFMT
     C                   MOVEL     'I'           PCODE
     C                   MOVE      *BLANK        PRTRN
      *
     C                   CALL      'UT80060R'
     C                   PARM                    PFRM8             8 0
     C                   PARM                    PTO8              8 0
     C                   PARM                    PFRFMT            4
     C                   PARM                    PTOFMT            4
     C                   PARM                    PDAYS             4 0
     C                   PARM                    PCODE             1
     C                   PARM                    PRTRN             1
      *
     C                   ENDSR
      /EJECT
      *---------------------------------------------------------------
      * *INZSR - INITIALIZATION SUBROUTINE
      *---------------------------------------------------------------
      *
     C     *INZSR        BEGSR
      *
      * KEY LISTS
      *
      * KEY FOR GROUP DETAIL WORK FILE
      *
     C     K1P303        KLIST
     C                   KFLD                    HGHGSN
     C                   KFLD                    WKCYMD
      *
     C     K2P033        KLIST
     C                   KFLD                    HGHGSN
     C                   KFLD                    WKRPCD
      *
     C     *LIKE         DEFINE    CGRPCD        WKRPCD
      *
      * CONTROL PROCESSING FLAGS AND FIELDS
      *
     C                   MOVEL     YES           FIRST             1
     C                   MOVEL     YES           PROCFL            1
     C                   Z-ADD     0             COUNT             3 0
     C     *LIKE         DEFINE    FSFSCD        SVFSCD
     C     *LIKE         DEFINE    FSPPCD        SVPPCD
      *
      * WORKFIELDS
     C     *LIKE         DEFINE    HGCLDT        WKFYMD
     C     *LIKE         DEFINE    HGCLDT        WKCYMD
     C     *LIKE         DEFINE    KDKDHD        WKHD
     C                   Z-ADD     0             WKFLD            15 5
      *
     C                   ENDSR
      /EJECT
