     H/TITLE EDT Lock Load Edit/INF XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 06/17/16  Time  : 15:25:42
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FOPBFCPL8IF  E           K        DISK
      * RSQ : Order Header TRG          Load #/All orders
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCAADREL9IF  E           K        DISK
      * RSQ : Warehouse                 ShipCo/Warehouse
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FOMFLCPL2IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop/Order
      *
     FOMFKREL0IF  E           K        DISK
      * RTV : Truck Size                Retrieval index
      *
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     I@FJCPBN
      * Load Header               Retrieval index
      * Renamed input format fields
     I              FJRMNB                          WARMNB
     I              FJAIC3                          WAAIC3
     I              FJAODT                          WAAODT
     I              FJPJST                          WAPJST
     I              FJPKST                          WAPKST
     I              FJRNNB                          WARNNB
     I              FJDMTX                          WADMTX
     I              FJDNTX                          WADNTX
     I              FJDOTX                          WADOTX
     I              FJWTTX                          WAWTTX
     I              FJWUTX                          WAWUTX
     I              FJRPNB                          WARPNB
     I              FJFLAM                          WAFLAM
     I              FJXQST                          WAXQST
     I              FJRRNB                          WARRNB
     I              FJDXTX                          WADXTX
     I              FJDYTX                          WADYTX
     I              FJSBNB                          WASBNB
     I              FJBZNA                          WABZNA
     I              FJRONB                          WARONB
     I              FJSQNB                          WASQNB
     I              FJR1NB                          WAR1NB
     I              FJVCST                          WAVCST
     I              FJVDST                          WAVDST
     I              FJSDNB                          WASDNB
     I              FJPAOU                          WAPAOU
     I              FJDGWG                          WADGWG
     I              FJSXNB                          WASXNB
     I              FJHADT                          WAHADT
     I              FJAART                          WAAART
     I              FJDHWG                          WADHWG
     I              FJDIWG                          WADIWG
     I              FJAQDT                          WAAQDT
     I              FJS6NB                          WAS6NB
     I              FJT4NB                          WAT4NB
     I              FJPRTM                          WAPRTM
     I              FJNPSV                          WANPSV
     I              FJJ8TX                          WAJ8TX
     I              FJTLMI                          WATLMI
     I              FJJ9TX                          WAJ9TX
     I              FJQ2CD                          WAQ2CD
     I              FJVPCD                          WAVPCD
     I              FJDBCD                          WADBCD
     I              FJGRWE                          WAGRWE
     I              FJXCCD                          WAXCCD
     I              FJU2ST                          WAU2ST
     I              FJF9DT                          WAF9DT
     I              FJONTM                          WAONTM
     I              FJJ4DT                          WAJ4DT
     I              FJTRTM                          WATRTM
     I              FJJ5DT                          WAJ5DT
     I              FJSPTM                          WASPTM
     I              FJJ6DT                          WAJ6DT
     I              FJLFTM                          WALFTM
     I              FJJ7DT                          WAJ7DT
     I              FJBOTM                          WABOTM
     I              FJJ8DT                          WAJ8DT
     I              FJBLTM                          WABLTM
     I              FJKIDT                          WAKIDT
     I              FJASTM                          WAASTM
     I              FJKADT                          WAKADT
     I              FJAJCM                          WAAJCM
     I              FJXACD                          WAXACD
     I              FJOANA                          WAOANA
     I              FJK4TX                          WAK4TX
     I              FJVOAG                          WAVOAG
     I              FJKBDT                          WAKBDT
     I              FJNBBO                          WANBBO
     I              FJW4CD                          WAW4CD
     I              FJEFDT                          WAEFDT
     I              FJCNTN                          WACNTN
     I              FJKCDT                          WAKCDT
     I              FJTMIN                          WATMIN
     I              FJKDDT                          WAKDDT
     I              FJVMNB                          WAVMNB
     I              FJOCFR                          WAOCFR
     I              FJKJDT                          WAKJDT
     I              FJATTM                          WAATTM
     I              FJOTRS                          WAOTRS
     I              FJRNST                          WARNST
     I              FJBRBK                          WABRBK
     I              FJEIDT                          WAEIDT
     I              FJRMST                          WARMST
     I              FJAJCD                          WAAJCD
     I              FJKKDT                          WAKKDT
     I              FJAVTM                          WAAVTM
     I              FJKZDT                          WAKZDT
     I              FJAXTM                          WAAXTM
     I              FJLHOS                          WALHOS
     I              FJLHOR                          WALHOR
     I              FJWNTX                          WAWNTX
     I              FJOITX                          WAOITX
     I              FJOJTX                          WAOJTX
     I              FJLLDT                          WALLDT
     I              FJLSHG                          WALSHG
     I              FJYPST                          WAYPST
     I              FJK0DT                          WAK0DT
     I              FJAYTM                          WAAYTM
     I              FJKNNX                          WAKNNX
     I              FJICWG                          WAICWG
     I              FJIDWG                          WAIDWG
     I              FJH9SX                          WAH9SX
     I              FJWOTX                          WAWOTX
     I              FJK1DT                          WAK1DT
     I              FJAZTM                          WAAZTM
     I              FJK2DT                          WAK2DT
     I              FJA0TM                          WAA0TM
     I              FJROST                          WAROST
     I              FJRPST                          WARPST
     I              FJRQST                          WARQST
     I              FJRRST                          WARRST
     I              FJZBVA                          WAZBVA
     I              FJWPTX                          WAWPTX
     I              FJWQTX                          WAWQTX
     I              FJWRTX                          WAWRTX
     I              FJWSTX                          WAWSTX
     I              FJRVSX                          WARVSX
     I              FJRUSX                          WARUSX
     I              FJRWSX                          WARWSX
     I              FJRXSX                          WARXSX
     I              FJRYSX                          WARYSX
     I              FJRZSX                          WARZSX
     I              FJR0SX                          WAR0SX
     I              FJR1SX                          WAR1SX
     I              FJR2SX                          WAR2SX
     I              FJR3SX                          WAR3SX
     I              FJR4SX                          WAR4SX
     I              FJPYDT                          WAPYDT
     I              FJCKTM                          WACKTM
     I              FJPZDT                          WAPZDT
     I              FJCLTM                          WACLTM
     I              FJP0DT                          WAP0DT
     I              FJCMTM                          WACMTM
     I              FJP1DT                          WAP1DT
     I              FJCNTM                          WACNTM
     I              FJP2DT                          WAP2DT
     I              FJCOTM                          WACOTM
     I              FJP3DT                          WAP3DT
     I              FJCQTM                          WACQTM
     I              FJUVST                          WAUVST
     I              FJUWST                          WAUWST
     I              FJUXST                          WAUXST
     I              FJAATM                          WAAATM
     I              FJAYNA                          WAAYNA
     I              FJA0NA                          WAA0NA
     I              FJAXDT                          WAAXDT
      *
     I@BFCPD9
      * Order Header TRG          Load #/All orders
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
     I@DRRETH
      * User Profile Control      Retrieval index       NV
      * Renamed input format fields
     I              DRAJVN                          WCAJVN
     I              DRAUNA                          WCAUNA
     I              DRB8NA                          WCB8NA
     I              DRAHVN                          WCAHVN
     I              DRI6ST                          WCI6ST
     I              DRI7ST                          WCI7ST
     I              DRXMST                          WCXMST
     I              DRXNST                          WCXNST
     I              DRI8ST                          WCI8ST
     I              DRNLNB                          WCNLNB
     I              DRMPNA                          WCMPNA
     I              DRBCCD                          WCBCCD
     I              DRAIC3                          WCAIC3
     I              DRDQCD                          WCDQCD
     I              DRDRCD                          WCDRCD
     I              DRAJCD                          WCAJCD
     I              DRBUVN                          WCBUVN
     I              DRUVST                          WCUVST
     I              DRUWST                          WCUWST
     I              DRUXST                          WCUXST
     I              DRAATM                          WCAATM
     I              DRAYNA                          WCAYNA
     I              DRA0NA                          WCA0NA
     I              DRAXDT                          WCAXDT
      *
     I@DTRETE
      * User Application Profile  Retrieval index       NV
      * Renamed input format fields
     I              DTAJVN                          WDAJVN
     I              DTDNCD                          WDDNCD
     I              DTAIC3                          WDAIC3
     I              DTDQCD                          WDDQCD
     I              DTDRCD                          WDDRCD
     I              DTAJCD                          WDAJCD
     I              DTJFST                          WDJFST
     I              DTUVST                          WDUVST
     I              DTUWST                          WDUWST
     I              DTUXST                          WDUXST
     I              DTAATM                          WDAATM
     I              DTAYNA                          WDAYNA
     I              DTA0NA                          WDA0NA
     I              DTAXDT                          WDAXDT
      *
     I@ADREWA
      * Warehouse                 ShipCo/Warehouse
      * Renamed input format fields
     I              ADAJCD                          WEAJCD
     I              ADF8NA                          WEF8NA
     I              ADACNA                          WEACNA
     I              ADADNA                          WEADNA
     I              ADAENA                          WEAENA
     I              ADAJNA                          WEAJNA
     I              ADBTTX                          WEBTTX
     I              ADAOCD                          WEAOCD
     I              ADBGCD                          WEBGCD
     I              ADVHST                          WEVHST
     I              ADMPNA                          WEMPNA
     I              ADWPST                          WEWPST
     I              ADXUST                          WEXUST
     I              ADT0ST                          WET0ST
     I              ADT1ST                          WET1ST
     I              ADDBNB                          WEDBNB
     I              ADT2ST                          WET2ST
     I              ADT3ST                          WET3ST
     I              ADT4ST                          WET4ST
     I              ADT6ST                          WET6ST
     I              ADBWC3                          WEBWC3
     I              ADBTC3                          WEBTC3
     I              ADBUC3                          WEBUC3
     I              ADBVC3                          WEBVC3
     I              ADFCAA                          WEFCAA
     I              ADRQSX                          WERQSX
     I              ADRRSX                          WERRSX
     I              ADRSSX                          WERSSX
     I              ADRTSX                          WERTSX
     I              ADT7ST                          WET7ST
     I              ADT8ST                          WET8ST
     I              ADRNSX                          WERNSX
     I              ADROSX                          WEROSX
     I              ADRPSX                          WERPSX
     I              ADUVST                          WEUVST
     I              ADUWST                          WEUWST
     I              ADUXST                          WEUXST
     I              ADVSST                          WEVSST
     I              ADAATM                          WEAATM
     I              ADAYNA                          WEAYNA
     I              ADA0NA                          WEA0NA
     I              ADAXDT                          WEAXDT
      *
     I@ABREG3
      * Company Name and Address  Retrieval index       NV
      * Renamed input format fields
     I              ABAIC3                          WFAIC3
     I              ABADTX                          WFADTX
     I              ABACNA                          WFACNA
     I              ABADNA                          WFADNA
     I              ABAENA                          WFAENA
     I              ABAJNA                          WFAJNA
     I              ABBTTX                          WFBTTX
     I              ABBVTX                          WFBVTX
     I              ABBWTX                          WFBWTX
     I              ABA2NA                          WFA2NA
     I              ABABTX                          WFABTX
     I              ABBGCD                          WFBGCD
     I              ABKXCD                          WFKXCD
     I              ABUVST                          WFUVST
     I              ABUWST                          WFUWST
     I              ABUXST                          WFUXST
     I              ABVSST                          WFVSST
     I              ABAATM                          WFAATM
     I              ABAYNA                          WFAYNA
     I              ABA0NA                          WFA0NA
     I              ABAXDT                          WFAXDT
      *
     I@FLCPEB
      * Load Detail               Load/Stop/Order
      * Renamed input format fields
     I              FLRMNB                          WGRMNB
     I              FLRUNB                          WGRUNB
     I              FLRVNB                          WGRVNB
     I              FLDQTX                          WGDQTX
     I              FLRWNB                          WGRWNB
     I              FLRXNB                          WGRXNB
     I              FLSQNB                          WGSQNB
     I              FLT0NB                          WGT0NB
     I              FLT1NB                          WGT1NB
     I              FLR1NB                          WGR1NB
     I              FLAIC3                          WGAIC3
     I              FLC4NB                          WGC4NB
     I              FLVCST                          WGVCST
     I              FLKEDT                          WGKEDT
     I              FLSXNB                          WGSXNB
     I              FLKFDT                          WGKFDT
     I              FLACTM                          WGACTM
     I              FLK5TX                          WGK5TX
     I              FLW5CD                          WGW5CD
     I              FLEJDT                          WGEJDT
     I              FLAGTM                          WGAGTM
     I              FLKJDT                          WGKJDT
     I              FLATTM                          WGATTM
     I              FLHDDT                          WGHDDT
     I              FLAUTM                          WGAUTM
     I              FLKKDT                          WGKKDT
     I              FLAVTM                          WGAVTM
     I              FLZ4NB                          WGZ4NB
     I              FLY7ST                          WGY7ST
     I              FLY2ST                          WGY2ST
     I              FLWHTX                          WGWHTX
     I              FLWITX                          WGWITX
     I              FLWJTX                          WGWJTX
     I              FLWKTX                          WGWKTX
     I              FLWLTX                          WGWLTX
     I              FLN7DT                          WGN7DT
     I              FLN8DT                          WGN8DT
     I              FLN9DT                          WGN9DT
     I              FLB3TM                          WGB3TM
     I              FLB4TM                          WGB4TM
     I              FLB5TM                          WGB5TM
     I              FLIASX                          WGIASX
     I              FLIBSX                          WGIBSX
     I              FLICSX                          WGICSX
     I              FLWVTX                          WGWVTX
     I              FLWWTX                          WGWWTX
     I              FLWXTX                          WGWXTX
     I              FLUVST                          WGUVST
     I              FLUWST                          WGUWST
     I              FLUXST                          WGUXST
     I              FLAATM                          WGAATM
     I              FLAYNA                          WGAYNA
     I              FLA0NA                          WGA0NA
     I              FLAXDT                          WGAXDT
      *
     I@FKREBT
      * Truck Size                Retrieval index
      * Renamed input format fields
     I              FKRONB                          WHRONB
     I              FKDPTX                          WHDPTX
     I              FKRSNB                          WHRSNB
     I              FKRTNB                          WHRTNB
     I              FKTANB                          WHTANB
     I              FKUVST                          WHUVST
     I              FKUWST                          WHUWST
     I              FKUXST                          WHUXST
     I              FKVSST                          WHVSST
     I              FKAATM                          WHAATM
     I              FKAYNA                          WHAYNA
     I              FKA0NA                          WHA0NA
     I              FKAXDT                          WHAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Load Header
      * I :  Load ID
     I                                    P   1   40P1RMNB
      * I :  Company Number
     I                                    P   5   60P1AIC3
      * N :  Load Status
     I                                        7   7 P1PKST
      * N :  Total Load Order Weight
     I                                    P   8  110P1RPNB
      * N :  Carrier Code
     I                                       12  14 P1BZNA
      * N :  Truck Size
     I                                       15  21 P1RONB
      * N :  Shipping Method
     I                                       22  23 P1Q2CD
      * N :  Load Acceptance Flag
     I                                       24  24 P1RMST
     IP2PARM      DS
      * I :  *SFLSEL
     I                                        1   1 P2SEL
     IP3PARM      DS
      * I :  STATUS
     I                                        1   1 P3ATUS
     IP4PARM      DS
      * O :  Error Status
     I                                        1   1 P4ECST
     IP5PARM      DS
      * FLD: Order Header TRG
      * N :  Block Order Flag
     I                                        1   1 P5BCST
     IP6PARM      DS
      * I :  Lock option override sts
     I                                        1   1 P6FJST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'No Orders Assinged - INF'
      * Load ID
     I                                    P   1   40ZA0001
      * *SFLSEL
     I                                        5   5 ZA0002
      * Message data for 'Blck Ord on Ld-no UPD-INF'
      * *SFLSEL
     I                                        1   1 ZA0003
      * Load ID
     I                                    P   2   50ZA0004
      * Message data for 'Load Cant be Locked - INF'
      * *SFLSEL
     I                                        1   1 ZA0005
      * Load ID
     I                                    P   2   50ZA0006
      * Message data for 'Carrier must be ent.- INF'
      * Carrier Code
     I                                        1   3 ZA0007
      * Load ID
     I                                    P   4   70ZA0008
      * Message data for 'Truck size needed - INF'
      * Truck Size
     I                                        1   7 ZA0009
      * Load ID
     I                                    P   8  110ZA0010
      * Message data for 'Shipping Mthd req - INF'
      * Shipping Method
     I                                        1   2 ZA0011
      * Message data for 'Load has ords w/o stp-INF'
      * Load ID
     I                                    P   1   40ZA0012
      * Message data for 'Load is not accepted- INF'
      * Load ID
     I                                    P   1   40ZA0013
      * Message data for 'Load has Ords on Hold-INF'
      * Load ID
     I                                    P   1   40ZA0014
      * *SFLSEL
     I                                        5   5 ZA0015
      * Message data for 'Load has Cncld Ords - INF'
      * Load ID
     I                                    P   1   40ZA0016
      * *SFLSEL
     I                                        5   5 ZA0017
      * Message data for 'Load has Ords in Use-INF'
      * *SFLSEL
     I                                        1   1 ZA0018
      * Load ID
     I                                    P   2   50ZA0019
      * Message data for 'Order detail needs review'
      * *SFLSEL
     I                                        1   1 ZA0020
      * Load ID
     I                                    P   2   50ZA0021
      * Message data for 'Load Weight LT Minimum'
      * Load ID
     I                                    P   1   40ZA0022
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1RMNB    PARM           WP0001  70       Load ID
     C           P1AIC3    PARM           WP0002  30       Company Number
     C           P2SEL     PARM           WP0003  1        *SFLSEL
     C           P3ATUS    PARM           WP0004  1        STATUS
     C           P4ECST    PARM P4ECST    WP0005  1        Error Status
     C           P6FJST    PARM           WP0006  1        Lock option ove
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * EDT Lock Load Edit/INF XF
      * ** Chk for ord detail errors still pending  9.20.2011 P001251 LJB
      * ** Chg lock option override sts to *job date chk   8.23.09 E00495
      * ** Add lock option override sts for sched ship date chk  7.24.09
      * ** Add Override Total Load Miles - WRK context     E00207 8/13/08
      * RTV Load for Load Plan RT - Load Header  * 
     C                     EXSR SARVGN
      * RTV Any Ord/Blk  on Ld RT - Order Header TRG  * 
     C                     EXSR SBRVGN
      *
     C                     Z-ADD*ZERO     WN0001  70       Maximum pounds
     C                     Z-ADD*ZERO     WN0002  70       Minimum pounds
     C                     MOVEL*BLANK    WN0003  1        USR Orders on L
     C                     MOVEL*BLANK    WN0004  1        Order in Use
     C                     MOVEL*BLANK    WN0005  1        Header Status
     C                     MOVEL*BLANK    WN0006  1        Access Denied (
      *
      * EDT Lock Load Edits-INFIF
      * assume will have error
     C                     MOVEL'Y'       P4ECST           Error Status
      *
     C                     MOVEL*BLANK    WN0007 10        User Profile Na
      *
      * VAL Set Int.Acc No Hdg IF
     C                     MOVEL##USR     WN0007           User Profile Na
      *
     C                     MOVEL*BLANK    WN0008 10        User Code Model
      *
      * VAL User/Appl No Exit  IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR SCRVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0008    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0007    WL0001    P      User Profile Na
     C                     MOVEL'LOCKLD'  WL0002    P      Application Cod
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    WUAIC3           Company Number
     C                     MOVELWL0004    YL0002    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0008    WL0001    P      User Profile Na
     C                     MOVEL'LOCKLD'  WL0002    P      Application Cod
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    WUAIC3           Company Number
     C                     MOVELWL0004    YL0002    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0002    WUG0TX           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: LCL.Company Number is greater than zero
     C           YL0001    IFGT 0                          *IF
     C                     Z-ADDYL0001    WUAIC3           Company Number
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0002    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  RT - Warehouse  * 
     C                     EXSR SERVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWUAIC3    WUNFNN           Company Number
     C                     MOVELWUWVST    WN0006           Access Denied (
      * If access denied is no, rtv co. name
      * CASE: WRK.Access Denied (Y/N) is no
     C           WUWVST    IFEQ 'N'                        *IF
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SFRVGN
     C                     END                             *FI
      * CASE: PAR.Access Denied (Y/N) is yes
     C           WN0006    IFEQ 'Y'                        *IF
      * Send message 'Usr Cant Lock/Unlk Ld-INF'
     C                     MOVEL'USR2543' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * VAL no Stop Entered    RT - Load Detail  * 
     C                     EXSR SGRVGN
      * Validate lock request
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
     C                     Z-ADDP1RMNB    ZA0001           Load ID
     C                     MOVELP2SEL     ZA0002           *SFLSEL
      * Send message 'No Orders Assinged - INF'
     C                     MOVEL'USR2544' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.Block Order Flag is Block Order
     C           P5BCST    IFEQ 'B'                        *IF
      * Setup message data for message
     C                     MOVELP2SEL     ZA0003           *SFLSEL
     C                     Z-ADDP1RMNB    ZA0004           Load ID
      * Send message 'Blck Ord on Ld-no UPD-INF'
     C                     MOVEL'USR2545' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.Load Status is Locked thru Invoiced
     C           P1PKST    IFEQ 'I'                        *IF
     C           P1PKST    OREQ 'L'
     C           P1PKST    OREQ 'S'
      * Setup message data for message
     C                     MOVELP2SEL     ZA0005           *SFLSEL
     C                     Z-ADDP1RMNB    ZA0006           Load ID
      * Send message 'Load Cant be Locked - INF'
     C                     MOVEL'USR2546' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Carrier Code EQ WRK.BLANK
      *   |- c2    : PAR.STATUS is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1BZNA    IFEQ WUGSTX                     *IF
     C           P3ATUS    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVELP1BZNA    ZA0007           Carrier Code
     C                     Z-ADDP1RMNB    ZA0008           Load ID
      * Send message 'Carrier must be ent.- INF'
     C                     MOVEL'USR2547' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.Truck Size EQ WRK.BLANK
     C           P1RONB    IFEQ WUGSTX                     *IF
      * Setup message data for message
     C                     MOVELP1RONB    ZA0009           Truck Size
     C                     Z-ADDP1RMNB    ZA0010           Load ID
      * Send message 'Truck size needed - INF'
     C                     MOVEL'USR2548' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.Shipping Method EQ WRK.BLANK
     C           P1Q2CD    IFEQ WUGSTX                     *IF
      * Setup message data for message
     C                     MOVELP1Q2CD    ZA0011           Shipping Method
      * Send message 'Shipping Mthd req - INF'
     C                     MOVEL'USR2549' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.USR Orders on Load is yes
     C           WN0003    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     Z-ADDP1RMNB    ZA0012           Load ID
      * Send message 'Load has ords w/o stp-INF'
     C                     MOVEL'USR2550' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.Load Acceptance Flag is Load not Accepted
     C           P1RMST    IFEQ 'U'                        *IF
      * Setup message data for message
     C                     Z-ADDP1RMNB    ZA0013           Load ID
      * Send message 'Load is not accepted- INF'
     C                     MOVEL'USR2551' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Hold, Use-by load  RT - PD Order Header  * 
     C                     EXSR SHRVGN
      * Error if held/cancelled/in use order(s) on load
      * CASE: PAR.Header Status is Hold
     C           WN0005    IFEQ 'H'                        *IF
      * Setup message data for message
     C                     Z-ADDP1RMNB    ZA0014           Load ID
     C                     MOVELP2SEL     ZA0015           *SFLSEL
      * Send message 'Load has Ords on Hold-INF'
     C                     MOVEL'USR2552' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.Header Status is Cancelled
     C           WN0005    IFEQ 'X'                        *IF
      * Setup message data for message
     C                     Z-ADDP1RMNB    ZA0016           Load ID
     C                     MOVELP2SEL     ZA0017           *SFLSEL
      * Send message 'Load has Cncld Ords - INF'
     C                     MOVEL'USR2553' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.Order in Use is yes
     C           WN0004    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVELP2SEL     ZA0018           *SFLSEL
     C                     Z-ADDP1RMNB    ZA0019           Load ID
      * Send message 'Load has Ords in Use-INF'
     C                     MOVEL'USR2554' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Ord Requires Revw RT - Order Header TRG  * 
     C                     EXSR SIRVGN
      * ** Check for errors in Export Order Automation Upload   P001251
      * CASE: LCL.Order Requires Review is Yes
     C           YL0004    IFEQ 'Y'                        *IF
      * ** Cannot lock load if errors in Order Detail         P001251
      * Setup message data for message
     C                     MOVELP2SEL     ZA0020           *SFLSEL
     C                     Z-ADDP1RMNB    ZA0021           Load ID
      * Send message 'Order detail needs review'
     C                     MOVEL'USR4464' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Min & Max Pounds  RT - OM Truck Size  * 
     C                     EXSR SJRVGN
      * Do not want to lock the load if the Load Weight is not
      * within range.  -Purva 5/5/99 C0007042
      * Check minimum and maximum pounds
      * CASE: PAR.Total Weight LT PAR.Minimum pounds
     C           P1RPNB    IFLT WN0002                     *IF
      * Setup message data for message
     C                     Z-ADDP1RMNB    ZA0022           Load ID
      * Send message 'Load Weight LT Minimum'
     C                     MOVEL'USR1262' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       P4ECST           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Total Weight GT PAR.Maximum pounds
     C           P1RPNB    IFGT WN0001                     *IF
      * Send message 'Load weight exceeds Truck'
     C                     MOVEL'USR2231' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       P4ECST           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * Check Sched ship date if not called from a LOCK option  FP1054 7/
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Lock option override sts is No
      *   |- c2    : PAR.Scheduled Ship Date GT JOB.*Job date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6FJST    IFEQ 'N'                        *IF
     C           WUAODT    IFGT ##JDT                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       P4ECST           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Locking load pending'
     C                     MOVEL'USR1273' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       P4ECST           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ***** Change Log and Comments
     C                     EXSR UASUBR                     ***** Change Lo
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Load for Load Plan RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WARMNB           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WARMNB           Load ID
      * Establish starting position
     C           KRSSA     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUAODT           Scheduled Ship
     C                     MOVEL*BLANK    P1PKST           Load Status
     C                     Z-ADD*ZERO     WURNNB           Reefer Temperat
     C                     Z-ADD*ZERO     P1RPNB           Total Load Orde
     C                     Z-ADD*ZERO     WUFLAM           Flat Amount
     C                     MOVEL*BLANK    WUXQST           Allocate Pounds
     C                     MOVEL*BLANK    P1BZNA           Carrier Code
     C                     MOVEL*BLANK    P1RONB           Truck Size
     C                     Z-ADD*ZERO     WUR1NB           Rated Freight
     C                     MOVEL*BLANK    WUVDST           Load Type
     C                     Z-ADD*ZERO     WUT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WUTLMI           Total Load Mile
     C                     MOVEL*BLANK    P1Q2CD           Shipping Method
     C                     MOVEL*BLANK    WUVPCD           Ship From Wareh
     C                     MOVEL*BLANK    WUDBCD           Ship To State C
     C                     MOVEL*BLANK    WUXCCD           Carrier Broker
     C                     MOVEL*BLANK    P1RMST           Load Acceptance
     C                     Z-ADD*ZERO     WUK2DT           Override Total
     C                     MOVEL*BLANK    WUWRTX           Shipping Temp C
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWAAODT    WUAODT           Scheduled Ship
     C                     MOVELWAPKST    P1PKST           Load Status
     C                     Z-ADDWARNNB    WURNNB           Reefer Temperat
     C                     Z-ADDWARPNB    P1RPNB           Total Load Orde
     C                     Z-ADDWAFLAM    WUFLAM           Flat Amount
     C                     MOVELWAXQST    WUXQST           Allocate Pounds
     C                     MOVELWABZNA    P1BZNA           Carrier Code
     C                     MOVELWARONB    P1RONB           Truck Size
     C                     Z-ADDWAR1NB    WUR1NB           Rated Freight
     C                     MOVELWAVDST    WUVDST           Load Type
     C                     Z-ADDWAT4NB    WUT4NB           Schedule Sequen
     C                     Z-ADDWATLMI    WUTLMI           Total Load Mile
     C                     MOVELWAQ2CD    P1Q2CD           Shipping Method
     C                     MOVELWAVPCD    WUVPCD           Ship From Wareh
     C                     MOVELWADBCD    WUDBCD           Ship To State C
     C                     MOVELWAXCCD    WUXCCD           Carrier Broker
     C                     MOVELWARMST    P1RMST           Load Acceptance
     C                     Z-ADDWAK2DT    WUK2DT           Override Total
     C                     MOVELWAWRTX    WUWRTX           Shipping Temp C
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Any Ord/Blk  on Ld RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
     C                     MOVEL*BLANK    WUJDST           USR Check Y/N S
      * OMS203:  need to know if there are any Block orders on load
     C                     MOVEL'F'       P5BCST           Block Order Fla
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBRMNB    WQSB02           Load ID
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB02           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WQSB02           Load ID
      * Establish starting position
     C           KRSSB     SETLL@BFCPD9                    *
     C           KRSSB     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUJDST           USR Check Y/N S
      * CASE: DB1.Block Order Flag is Block Order
     C           WBBCST    IFEQ 'B'                        *IF
     C                     MOVELWBBCST    P5BCST           Block Order Fla
     C                     GOTO SBEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSB     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0007    WCAJVN           User Profile Na
      * Establish starting position
     C           KRSSC     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCI6ST    WUG0TX           Allow Multi-Com
     C                     MOVELWCMPNA    WUG0TX           Default Printer
     C                     MOVELWCBCCD    WUG0TX           Salesperson Cod
     C                     Z-ADDWCAIC3    YL0001           Company Number
     C                     MOVELWCBUVN    WN0008           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAJVN           User Profile Na
     C                     KFLD           WDDNCD           Application Cod
      * Setup key
     C                     MOVELWL0001    WDAJVN           User Profile Na
     C                     MOVELWL0002    WDDNCD           Application Cod
      * Establish starting position
     C           KRSSD     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWDAIC3    WL0003           Company Number
     C                     MOVELWDAJCD    WL0004           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Prod Whse for Co  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEBWC3    WQSE01           Shipping Compan
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Shipping Compan
      * Setup key
     C                     Z-ADDYL0003    WQSE01           Shipping Compan
      * Establish starting position
     C           KRSSE     SETLL@ADREWA                    *
     C           KRSSE     READE@ADREWA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUG0TX           Warehouse Code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C           WEVSST    IFEQ 'A'                        *IF
      * CASE: DB1.Production Warehouse Code is Warehouse Code not Blank
     C           WEAOCD    IFNE *BLANK                     *IF
     C                     MOVELWEAOCD    WUG0TX           Warehouse Code
     C                     GOTO SEEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSE     READE@ADREWA                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WFAIC3           Company Number
      * Setup key
     C                     Z-ADDWUAIC3    WFAIC3           Company Number
      * Establish starting position
     C           KRSSF     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUG0TX           Name
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFADTX    WUG0TX           Name
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * VAL no Stop Entered    RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WN0003           Status - Y or N
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGRMNB    WQSG02           Load ID
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG02           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WQSG02           Load ID
      * Establish starting position
     C           KRSSG     SETLL@FLCPEB                    *
     C           KRSSG     READE@FLCPEB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Stop/Drop is EQ Zero
     C           WGRVNB    IFEQ 0                          *IF
     C                     MOVEL'Y'       WN0003           Status - Y or N
     C                     GOTO SGEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSG     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Hold, Use-by load  RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0004           Order in Use
     C                     MOVEL*BLANK    WN0005           Header Status
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBRMNB    WQSH02           Load ID
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH02           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WQSH02           Load ID
      * Establish starting position
     C           KRSSH     SETLL@BFCPD9                    *
     C           KRSSH     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * If find 1 order on load which is held/cancelled, set par flag and
      * CASE: DB1.Header Status is Hold
     C           WBGWST    IFEQ 'H'                        *IF
     C                     MOVELWBGWST    WN0005           Header Status
     C                     GOTO SHEXIT                     *QUIT
     C                     ELSE
      * CASE: DB1.Header Status is Cancelled
     C           WBGWST    IFEQ 'X'                        *IF
     C                     MOVELWBGWST    WN0005           Header Status
     C                     GOTO SHEXIT                     *QUIT
     C                     ELSE
      * CASE: DB1.Order in Use is yes
     C           WBGJST    IFEQ 'Y'                        *IF
     C                     MOVELWBGJST    WN0004           Order in Use
     C                     GOTO SHEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSH     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Ord Requires Revw RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBRMNB    WQSI02           Load ID
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI02           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WQSI02           Load ID
      * Establish starting position
     C           KRSSI     SETLL@BFCPD9                    *
     C           KRSSI     READE@BFCPD9                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0004           Order Requires
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBFUSX    YL0004           Order Requires
     C           KRSSI     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Min & Max Pounds  RT - OM Truck Size  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WHRONB           Truck Size
      * Setup key
     C                     MOVELP1RONB    WHRONB           Truck Size
      * Establish starting position
     C           KRSSJ     CHAIN@FKREBT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1190' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0001           Maximum pounds
     C                     Z-ADD*ZERO     WN0002           Minimum pounds
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWHRSNB    WN0001           Maximum pounds
     C                     Z-ADDWHTANB    WN0002           Minimum pounds
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * *****
      * ** 09/20/2011 LJB P001251  Export Order Automation Upload
      * ** Cannot lock load if there are errors still pending in the
      * ** Order Detail record
      * *****
      * ** Auto lock if shipping today & no errors            E00495
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1PKST           Load Status
     C                     Z-ADD*ZERO     P1RPNB           Total Load Orde
     C                     MOVEL*BLANK    P1BZNA           Carrier Code
     C                     MOVEL*BLANK    P1RONB           Truck Size
     C                     MOVEL*BLANK    P1Q2CD           Shipping Method
     C                     MOVEL*BLANK    P1RMST           Load Acceptance
     C                     MOVEL*BLANK    P5BCST           Block Order Fla
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Scheduled Ship Date
     C                     Z-ADD*ZERO     WUAODT  70
      * Define work field Reefer Temperature
     C                     Z-ADD*ZERO     WURNNB  52
      * Define work field Flat Amount
     C                     Z-ADD*ZERO     WUFLAM 112
      * Define work field Allocate Pounds/Miles
     C                     MOVEL*BLANK    WUXQST  1
      * Define work field Rated Freight
     C                     Z-ADD*ZERO     WUR1NB 112
      * Define work field Load Type
     C                     MOVEL*BLANK    WUVDST  1
      * Define work field Schedule Sequence Number
     C                     Z-ADD*ZERO     WUT4NB  50
      * Define work field Total Load Miles
     C                     Z-ADD*ZERO     WUTLMI  70
      * Define work field Ship From Warehouse
     C                     MOVEL*BLANK    WUVPCD  3
      * Define work field Ship To State Code
     C                     MOVEL*BLANK    WUDBCD  2
      * Define work field Carrier Broker
     C                     MOVEL*BLANK    WUXCCD  3
      * Define work field Override Total Load Miles
     C                     Z-ADD*ZERO     WUK2DT  70
      * Define work field Shipping Temp C/F txt
     C                     MOVEL*BLANK    WUWRTX 25
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WARPNB           Total Load Orde
     C                     Z-ADD*ZERO     WAFLAM           Flat Amount
     C                     Z-ADD*ZERO     WARRNB           Total Stops
     C                     Z-ADD*ZERO     WASBNB           BOL Time
     C                     Z-ADD*ZERO     WASQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WASDNB           Number Pallets
     C                     Z-ADD*ZERO     WAPAOU           Number Pallets
     C                     Z-ADD*ZERO     WADGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WASXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WAHADT           Actual Arrival
     C                     Z-ADD*ZERO     WAAART           Actual Arrival
     C                     Z-ADD*ZERO     WADHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WADIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WAAQDT           Actual Departur
     C                     Z-ADD*ZERO     WAS6NB           Departure Time
     C                     Z-ADD*ZERO     WAT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WAPRTM           Product Tempera
     C                     Z-ADD*ZERO     WANPSV           Number Pallets
     C                     Z-ADD*ZERO     WATLMI           Total Load Mile
     C                     Z-ADD*ZERO     WAGRWE           Gross Weight
     C                     Z-ADD*ZERO     WAF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WAJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WATRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WAJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WASPTM           Spotted Time
     C                     Z-ADD*ZERO     WAJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WALFTM           Load Finished T
     C                     Z-ADD*ZERO     WAJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WABOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WAJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WABLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WAKIDT           Truck Departure
     C                     Z-ADD*ZERO     WAASTM           Truck Departure
     C                     Z-ADD*ZERO     WAKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WAAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WAVOAG           Voyage
     C                     Z-ADD*ZERO     WAKBDT           Sail Date
     C                     Z-ADD*ZERO     WAEFDT           Arrival Date
     C                     Z-ADD*ZERO     WAKCDT           Date In
     C                     Z-ADD*ZERO     WATMIN           Time In
     C                     Z-ADD*ZERO     WAKDDT           Date Out
     C                     Z-ADD*ZERO     WAVMNB           Time Out
     C                     Z-ADD*ZERO     WAOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WAKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WAATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WABRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAKKDT           On Yard Date
     C                     Z-ADD*ZERO     WAAVTM           On Yard Time
     C                     Z-ADD*ZERO     WAKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WAAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WALLDT           Express Mail Da
     C                     Z-ADD*ZERO     WAK0DT           Product Complet
     C                     Z-ADD*ZERO     WAAYTM           Product Complet
     C                     Z-ADD*ZERO     WAKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WAICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WAIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WAK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WAAZTM           Load Door 1
     C                     Z-ADD*ZERO     WAK2DT           Override Total
     C                     Z-ADD*ZERO     WAA0TM           Load Door 2
     C                     Z-ADD*ZERO     WAZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WAPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WACKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WAPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WACLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WAP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WACMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WAP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WACNTM           LH Unused Time
     C                     Z-ADD*ZERO     WAP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WACOTM           LH Unused Time
     C                     Z-ADD*ZERO     WAP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WACQTM           LH Unused Time
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field USR Check Y/N Status
     C                     MOVEL*BLANK    WUJDST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WBA0DT           Order Date
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBACDT           Cancel Date
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WBA1WG           Order Weight To
     C                     Z-ADD*ZERO     WBEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WBAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WBATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WBRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WBT3NB           Attach to Order
     C                     Z-ADD*ZERO     WBCONB           Invoice Number
     C                     Z-ADD*ZERO     WBAWDT           Invoice Date
     C                     Z-ADD*ZERO     WBVRVA           A/R order Value
     C                     Z-ADD*ZERO     WBB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WBNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WBNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WBNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WBNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WBNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WBBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WBBQTM           Time of Origina
     C                     Z-ADD*ZERO     WBBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WBBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WBBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WBH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WBH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WBH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WBH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WBH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WBC0C7           Claim Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Define work field Company Number
     C                     Z-ADD*ZERO     WUAIC3  30
      * Define work field Access Denied (Y/N)
     C                     MOVEL*BLANK    WUWVST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCNLNB           Entity Number
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WEBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WEBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WEBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WEBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGRMNB           Load ID
     C                     Z-ADD*ZERO     WGRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WGRVNB           Stop/Drop
     C                     Z-ADD*ZERO     WGRWNB           Miles to next s
     C                     Z-ADD*ZERO     WGRXNB           Freight Charge
     C                     Z-ADD*ZERO     WGSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WGT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     WGT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WGR1NB           Rated Freight
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGC4NB           Order Number
     C                     Z-ADD*ZERO     WGKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WGSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WGKFDT           Appointment Con
     C                     Z-ADD*ZERO     WGACTM           Appointment Con
     C                     Z-ADD*ZERO     WGEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WGAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WGKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WGATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WGHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WGAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WGKKDT           On Yard Date
     C                     Z-ADD*ZERO     WGAVTM           On Yard Time
     C                     Z-ADD*ZERO     WGZ4NB           MPC Number
     C                     Z-ADD*ZERO     WGN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WGN8DT           LD Sls Appt Con
     C                     Z-ADD*ZERO     WGN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WGB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WGB4TM           LD Sls Appt Con
     C                     Z-ADD*ZERO     WGB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHRSNB           Maximum pounds
     C                     Z-ADD*ZERO     WHRTNB           Maximum Units
     C                     Z-ADD*ZERO     WHTANB           Minimum pounds
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SDRVGN.
     C                     MOVEL*BLANK    WL0001 10
     C                     MOVEL*BLANK    WL0002  6
     C                     Z-ADD*ZERO     WL0003  30
     C                     MOVEL*BLANK    WL0004  3
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0001  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0002  3
      * Define local work field Shipping Company
     C                     Z-ADD*ZERO     YL0003  30
      * Define local work field Order Requires Review
     C                     MOVEL*BLANK    YL0004  2
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Y2U0005
