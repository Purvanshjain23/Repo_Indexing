/***************************************************************** */
/*                                                                 */
/*  PROGRAM NUMBER:  AUDSNDEML                                     */
/*  PROGRAM NAME:    Send the Audit Information via email          */
/*                   From and to Date and Email address            */
/*                   This is going to Brad Knadler at              */
/*                   Triumph Foods                                 */
/*  PROGRAMMER:      Susan Mason                                   */
/*  CREATE DATE:     09/28/12                                      */
/*                                                                 */
/*  FUNCTION:        this cl was developed to send the Audit       */
/*                   information to 1 person only at Triumph       */
/*                   every day and will be executed on the         */
/*                   job scheduler                                 */
/*                                                                 */
/*******************************************************************/
/*  Modification History                                           */
/*                                                                 */
/*******************************************************************/
             PGM        PARM(&CMPCDE &FROMA &TOA &EMAIL)

             DCL        VAR(&CMPCDE) TYPE(*CHAR) LEN(3)
             DCL        VAR(&FROMA) TYPE(*CHAR) LEN(8)
             DCL        VAR(&TOA) TYPE(*CHAR) LEN(8)
             DCL        VAR(&EMAIL) TYPE(*CHAR) LEN(50)
/* NUMERIC VALUES                                                  */
             DCL        VAR(&CMPNUM) TYPE(*DEC) LEN(3 0) VALUE(000)
             DCL        VAR(&FROM) TYPE(*DEC) LEN(8 0) VALUE(00000000)
             DCL        VAR(&TO) TYPE(*DEC) LEN(8 0) VALUE(00000000)

             DCL        VAR(&TEXT) TYPE(*CHAR) LEN(50) +
                          VALUE('Audit Information for Job Date(1)  +
                          and Job Date')
             CHGVAR(&CMPNUM)
             CHGVAR(&FROM)
             CHGVAR(&TO)

             IF COND(&FROM *EQ 00000000) THEN(DO)
/* ******************************   */
/* Calculate from and to date       */
/* based on job date calculate the  */
/* TO date:                         */
/* job date                         */
/* From date                        */
/* job date get 1 previous kill dte */
/* ******************************   */

             CALL       PGM(PLRWXFR) PARM(' ' &CMPNME &FROMA &TOA)

             ENDDO

/*****************************************************************/
             EXECUTE    VIEW(MASFLIB/AUDITLOG) PCFMT(*XLS) +
                          REPLACE(*YES) RECIPIENT(&EMAIL) +
                          EMLMSG(&TEXT) SETVAR((&FROM) (&TO))
ENDPGM
