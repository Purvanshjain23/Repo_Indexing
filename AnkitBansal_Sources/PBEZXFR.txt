     H/TITLE PFS Cat2 Load Info    XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 07/12/19  Time  : 10:36:25
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FOMFLCPL4IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop(Desc)/Order
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer                  Retrieval index       NV
      *
     FPOBIREL1IF  E           K        DISK
      * RTV : Customer Item Reference   Retrieval index
      *
     FCAEOREL1IF  E           K        DISK
      * RTV : Company Customer          Retrieval index
      *
     FCAAFREL6IF  E           K        DISK
      * RSQ : Calendar                  RSQ Co/Date Descending
      *
     FPDIOREL1IF  E           K        DISK
      * RTV : Item Bill Of Material     Retrieval index
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FPPBCCPL1IF  E           K        DISK
      * RTV : PFS Order Detail          Retrieval index
      *
     FPMAMREL1IF  E           K        DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FPDJYREL2IF  E           K        DISK
      * RTV : Company Defaults Internal Active Records
      *
     FPPBDCPL1IF  E           K        DISK
      * RTV : PFS Order BOL Comment     Retrieval index
      *
     FOPCOCPL1IF  E           K        DISK
      * RTV : Order Comment             Retrieval index       NV
      *
     FPPB1REL1IF  E           K        DISK
      * RTV : Country Comment           Retrieval index
      *
     FPOAVCPL1IF  E           K        DISK
      * RTV : Customer Comment          Retrieval index
      *
     FPDNEREL1IF  E           K        DISK
      * RTV : Customer EXT              Retrieval index
      *
     FOMFLCPL5IF  E           K        DISK
      * RSQ : Load Detail               Co/Load/Order
      *
     FPDLCREL0IF  E           K        DISK
      * RTV : Shipping Line/Port        Retrieval index
      *
     FPPBBCPL1IF  E           K        DISK
      * RTV : PFS Order Header          Retrieval index
      *
     FPPBCCPL0UF  E           K        DISK                      A
      * UPD : PFS Order Detail          Update index
      *
     FPPBDCPL0UF  E           K        DISK                      A
      * UPD : PFS Order BOL Comment     Update index
      *
     FPPBBCPL0UF  E           K        DISK                      A
      * UPD : PFS Order Header          Update index
      *
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@FJCPBN
      * Load Header               Retrieval index
      * Renamed input format fields
     I              FJRMNB                          WARMNB
     I              FJAIC3                          WAAIC3
     I              FJAODT                          WAAODT
     I              FJPJST                          WAPJST
     I              FJPKST                          WAPKST
     I              FJRNNB                          WARNNB
     I              FJDMTX                          WADMTX
     I              FJDNTX                          WADNTX
     I              FJDOTX                          WADOTX
     I              FJWTTX                          WAWTTX
     I              FJWUTX                          WAWUTX
     I              FJRPNB                          WARPNB
     I              FJFLAM                          WAFLAM
     I              FJXQST                          WAXQST
     I              FJRRNB                          WARRNB
     I              FJDXTX                          WADXTX
     I              FJDYTX                          WADYTX
     I              FJSBNB                          WASBNB
     I              FJBZNA                          WABZNA
     I              FJRONB                          WARONB
     I              FJSQNB                          WASQNB
     I              FJR1NB                          WAR1NB
     I              FJVCST                          WAVCST
     I              FJVDST                          WAVDST
     I              FJSDNB                          WASDNB
     I              FJPAOU                          WAPAOU
     I              FJDGWG                          WADGWG
     I              FJSXNB                          WASXNB
     I              FJHADT                          WAHADT
     I              FJAART                          WAAART
     I              FJDHWG                          WADHWG
     I              FJDIWG                          WADIWG
     I              FJAQDT                          WAAQDT
     I              FJS6NB                          WAS6NB
     I              FJT4NB                          WAT4NB
     I              FJPRTM                          WAPRTM
     I              FJNPSV                          WANPSV
     I              FJJ8TX                          WAJ8TX
     I              FJTLMI                          WATLMI
     I              FJJ9TX                          WAJ9TX
     I              FJQ2CD                          WAQ2CD
     I              FJVPCD                          WAVPCD
     I              FJDBCD                          WADBCD
     I              FJGRWE                          WAGRWE
     I              FJXCCD                          WAXCCD
     I              FJU2ST                          WAU2ST
     I              FJF9DT                          WAF9DT
     I              FJONTM                          WAONTM
     I              FJJ4DT                          WAJ4DT
     I              FJTRTM                          WATRTM
     I              FJJ5DT                          WAJ5DT
     I              FJSPTM                          WASPTM
     I              FJJ6DT                          WAJ6DT
     I              FJLFTM                          WALFTM
     I              FJJ7DT                          WAJ7DT
     I              FJBOTM                          WABOTM
     I              FJJ8DT                          WAJ8DT
     I              FJBLTM                          WABLTM
     I              FJKIDT                          WAKIDT
     I              FJASTM                          WAASTM
     I              FJKADT                          WAKADT
     I              FJAJCM                          WAAJCM
     I              FJXACD                          WAXACD
     I              FJOANA                          WAOANA
     I              FJK4TX                          WAK4TX
     I              FJVOAG                          WAVOAG
     I              FJKBDT                          WAKBDT
     I              FJNBBO                          WANBBO
     I              FJW4CD                          WAW4CD
     I              FJEFDT                          WAEFDT
     I              FJCNTN                          WACNTN
     I              FJKCDT                          WAKCDT
     I              FJTMIN                          WATMIN
     I              FJKDDT                          WAKDDT
     I              FJVMNB                          WAVMNB
     I              FJOCFR                          WAOCFR
     I              FJKJDT                          WAKJDT
     I              FJATTM                          WAATTM
     I              FJOTRS                          WAOTRS
     I              FJRNST                          WARNST
     I              FJBRBK                          WABRBK
     I              FJEIDT                          WAEIDT
     I              FJRMST                          WARMST
     I              FJAJCD                          WAAJCD
     I              FJKKDT                          WAKKDT
     I              FJAVTM                          WAAVTM
     I              FJKZDT                          WAKZDT
     I              FJAXTM                          WAAXTM
     I              FJLHOS                          WALHOS
     I              FJLHOR                          WALHOR
     I              FJWNTX                          WAWNTX
     I              FJOITX                          WAOITX
     I              FJOJTX                          WAOJTX
     I              FJLLDT                          WALLDT
     I              FJLSHG                          WALSHG
     I              FJYPST                          WAYPST
     I              FJK0DT                          WAK0DT
     I              FJAYTM                          WAAYTM
     I              FJKNNX                          WAKNNX
     I              FJICWG                          WAICWG
     I              FJIDWG                          WAIDWG
     I              FJH9SX                          WAH9SX
     I              FJWOTX                          WAWOTX
     I              FJK1DT                          WAK1DT
     I              FJAZTM                          WAAZTM
     I              FJK2DT                          WAK2DT
     I              FJA0TM                          WAA0TM
     I              FJROST                          WAROST
     I              FJRPST                          WARPST
     I              FJRQST                          WARQST
     I              FJRRST                          WARRST
     I              FJZBVA                          WAZBVA
     I              FJWPTX                          WAWPTX
     I              FJWQTX                          WAWQTX
     I              FJWRTX                          WAWRTX
     I              FJWSTX                          WAWSTX
     I              FJRVSX                          WARVSX
     I              FJRUSX                          WARUSX
     I              FJRWSX                          WARWSX
     I              FJRXSX                          WARXSX
     I              FJRYSX                          WARYSX
     I              FJRZSX                          WARZSX
     I              FJR0SX                          WAR0SX
     I              FJR1SX                          WAR1SX
     I              FJR2SX                          WAR2SX
     I              FJR3SX                          WAR3SX
     I              FJR4SX                          WAR4SX
     I              FJPYDT                          WAPYDT
     I              FJCKTM                          WACKTM
     I              FJPZDT                          WAPZDT
     I              FJCLTM                          WACLTM
     I              FJP0DT                          WAP0DT
     I              FJCMTM                          WACMTM
     I              FJP1DT                          WAP1DT
     I              FJCNTM                          WACNTM
     I              FJP2DT                          WAP2DT
     I              FJCOTM                          WACOTM
     I              FJP3DT                          WAP3DT
     I              FJCQTM                          WACQTM
     I              FJUVST                          WAUVST
     I              FJUWST                          WAUWST
     I              FJUXST                          WAUXST
     I              FJAATM                          WAAATM
     I              FJAYNA                          WAAYNA
     I              FJA0NA                          WAA0NA
     I              FJAXDT                          WAAXDT
      *
     I@FLCPE8
      * Load Detail               Load/Stop(Desc)/Order
      * Renamed input format fields
     I              FLRMNB                          WBRMNB
     I              FLRUNB                          WBRUNB
     I              FLRVNB                          WBRVNB
     I              FLDQTX                          WBDQTX
     I              FLRWNB                          WBRWNB
     I              FLRXNB                          WBRXNB
     I              FLSQNB                          WBSQNB
     I              FLT0NB                          WBT0NB
     I              FLT1NB                          WBT1NB
     I              FLR1NB                          WBR1NB
     I              FLAIC3                          WBAIC3
     I              FLC4NB                          WBC4NB
     I              FLVCST                          WBVCST
     I              FLKEDT                          WBKEDT
     I              FLSXNB                          WBSXNB
     I              FLKFDT                          WBKFDT
     I              FLACTM                          WBACTM
     I              FLK5TX                          WBK5TX
     I              FLW5CD                          WBW5CD
     I              FLEJDT                          WBEJDT
     I              FLAGTM                          WBAGTM
     I              FLKJDT                          WBKJDT
     I              FLATTM                          WBATTM
     I              FLHDDT                          WBHDDT
     I              FLAUTM                          WBAUTM
     I              FLKKDT                          WBKKDT
     I              FLAVTM                          WBAVTM
     I              FLZ4NB                          WBZ4NB
     I              FLY7ST                          WBY7ST
     I              FLY2ST                          WBY2ST
     I              FLWHTX                          WBWHTX
     I              FLWITX                          WBWITX
     I              FLWJTX                          WBWJTX
     I              FLWKTX                          WBWKTX
     I              FLWLTX                          WBWLTX
     I              FLN7DT                          WBN7DT
     I              FLN8DT                          WBN8DT
     I              FLN9DT                          WBN9DT
     I              FLB3TM                          WBB3TM
     I              FLB4TM                          WBB4TM
     I              FLB5TM                          WBB5TM
     I              FLIASX                          WBIASX
     I              FLIBSX                          WBIBSX
     I              FLICSX                          WBICSX
     I              FLWVTX                          WBWVTX
     I              FLWWTX                          WBWWTX
     I              FLWXTX                          WBWXTX
     I              FLUVST                          WBUVST
     I              FLUWST                          WBUWST
     I              FLUXST                          WBUXST
     I              FLAATM                          WBAATM
     I              FLAYNA                          WBAYNA
     I              FLA0NA                          WBA0NA
     I              FLAXDT                          WBAXDT
      *
     I@KMREHC
      * Company Values            Retrieval index
      * Renamed input format fields
     I              KMAIC3                          WCAIC3
     I              KMV8CD                          WCV8CD
     I              KMAUNA                          WCAUNA
     I              KMI5ST                          WCI5ST
     I              KMBXTX                          WCBXTX
     I              KMM8NB                          WCM8NB
     I              KMUVST                          WCUVST
     I              KMUWST                          WCUWST
     I              KMUXST                          WCUXST
     I              KMVSST                          WCVSST
     I              KMAATM                          WCAATM
     I              KMAYNA                          WCAYNA
     I              KMA0NA                          WCA0NA
     I              KMAXDT                          WCAXDT
      *
     I@BGWKAE
      * Order Detail              co/
      * Renamed input format fields
     I              OMAIC3                          WDAIC3
     I              OMC4NB                          WDC4NB
     I              OMDPNB                          WDDPNB
     I              OMUENB                          WDUENB
     I              OMHGCD                          WDHGCD
     I              OMAJCD                          WDAJCD
     I              OMBKC7                          WDBKC7
     I              OMCFC7                          WDCFC7
     I              OMGMST                          WDGMST
     I              OMGNST                          WDGNST
     I              OMMAVA                          WDMAVA
     I              OMKDVA                          WDKDVA
     I              OML8VA                          WDL8VA
     I              OML9VA                          WDL9VA
     I              OMGTST                          WDGTST
     I              OMGVST                          WDGVST
     I              OMGUST                          WDGUST
     I              OMQFST                          WDQFST
     I              OMAYVA                          WDAYVA
     I              OMEXDT                          WDEXDT
     I              OMLQCD                          WDLQCD
     I              OMRDCD                          WDRDCD
     I              OMQ7CD                          WDQ7CD
     I              OMBZPR                          WDBZPR
     I              OML6NB                          WDL6NB
     I              OMU1ST                          WDU1ST
     I              OMGIDT                          WDGIDT
     I              OMCRCD                          WDCRCD
     I              OMAGCD                          WDAGCD
     I              OMRZST                          WDRZST
     I              OMR0ST                          WDR0ST
     I              OMR1ST                          WDR1ST
     I              OMG7NA                          WDG7NA
     I              OMG8NA                          WDG8NA
     I              OMRPCD                          WDRPCD
     I              OMVEST                          WDVEST
     I              OMVGST                          WDVGST
     I              OMAVST                          WDAVST
     I              OMU0ST                          WDU0ST
     I              OMRFCD                          WDRFCD
     I              OMFZST                          WDFZST
     I              OMR1NB                          WDR1NB
     I              OMAVQT                          WDAVQT
     I              OMD0WG                          WDD0WG
     I              OMCCQT                          WDCCQT
     I              OMAUWG                          WDAUWG
     I              OMCBQT                          WDCBQT
     I              OMATWG                          WDATWG
     I              OMAQCS                          WDAQCS
     I              OMAGCS                          WDAGCS
     I              OMAKPR                          WDAKPR
     I              OMALPR                          WDALPR
     I              OMAUPR                          WDAUPR
     I              OMAVWG                          WDAVWG
     I              OMA4WG                          WDA4WG
     I              OMA5DT                          WDA5DT
     I              OMAODT                          WDAODT
     I              OMGNDT                          WDGNDT
     I              OMAMST                          WDAMST
     I              OMANST                          WDANST
     I              OMVAST                          WDVAST
     I              OMRGNB                          WDRGNB
     I              OMRHNB                          WDRHNB
     I              OMRINB                          WDRINB
     I              OMRBCD                          WDRBCD
     I              OMHICD                          WDHICD
     I              OMRNCD                          WDRNCD
     I              OMROCD                          WDROCD
     I              OMCXDT                          WDCXDT
     I              OMAJVN                          WDAJVN
     I              OMKXCD                          WDKXCD
     I              OMJPCD                          WDJPCD
     I              OMCQCD                          WDCQCD
     I              OMR4CD                          WDR4CD
     I              OMZ1ST                          WDZ1ST
     I              OMZ3ST                          WDZ3ST
     I              OMZ4ST                          WDZ4ST
     I              OMDUPR                          WDDUPR
     I              OMB6VL                          WDB6VL
     I              OMA1AA                          WDA1AA
     I              OMFZSX                          WDFZSX
     I              OMF0SX                          WDF0SX
     I              OMF1SX                          WDF1SX
     I              OMF2SX                          WDF2SX
     I              OMF3SX                          WDF3SX
     I              OMF4SX                          WDF4SX
     I              OMF5SX                          WDF5SX
     I              OMF6SX                          WDF6SX
     I              OMF7SX                          WDF7SX
     I              OMNTDT                          WDNTDT
     I              OMNUDT                          WDNUDT
     I              OMNVDT                          WDNVDT
     I              OMNWDT                          WDNWDT
     I              OMNXDT                          WDNXDT
     I              OMBUTM                          WDBUTM
     I              OMBVTM                          WDBVTM
     I              OMBWTM                          WDBWTM
     I              OMBXTM                          WDBXTM
     I              OMBYTM                          WDBYTM
     I              OMH5NX                          WDH5NX
     I              OMH6NX                          WDH6NX
     I              OMH7NX                          WDH7NX
     I              OMH8NX                          WDH8NX
     I              OMH9NX                          WDH9NX
     I              OMDVPR                          WDDVPR
     I              OMDWPR                          WDDWPR
     I              OMDXPR                          WDDXPR
     I              OMDYPR                          WDDYPR
     I              OMDZPR                          WDDZPR
     I              OMGSPR                          WDGSPR
     I              OMGTPR                          WDGTPR
     I              OMGUPR                          WDGUPR
     I              OMHOST                          WDHOST
     I              OMHPST                          WDHPST
     I              OMIOST                          WDIOST
     I              OMPEWG                          WDPEWG
     I              OMRINY                          WDRINY
     I              OMTIDT                          WDTIDT
     I              OMTJDT                          WDTJDT
     I              OMH2ST                          WDH2ST
     I              OMH0ST                          WDH0ST
     I              OMH1ST                          WDH1ST
     I              OMTKDT                          WDTKDT
     I              OMTLDT                          WDTLDT
     I              OMTMDT                          WDTMDT
     I              OMUVST                          WDUVST
     I              OMUWST                          WDUWST
     I              OMUXST                          WDUXST
     I              OMAATM                          WDAATM
     I              OMAYNA                          WDAYNA
     I              OMA0NA                          WDA0NA
     I              OMAXDT                          WDAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WEAJCD
     I              ADF8NA                          WEF8NA
     I              ADACNA                          WEACNA
     I              ADADNA                          WEADNA
     I              ADAENA                          WEAENA
     I              ADAJNA                          WEAJNA
     I              ADBTTX                          WEBTTX
     I              ADAOCD                          WEAOCD
     I              ADBGCD                          WEBGCD
     I              ADVHST                          WEVHST
     I              ADMPNA                          WEMPNA
     I              ADWPST                          WEWPST
     I              ADXUST                          WEXUST
     I              ADT0ST                          WET0ST
     I              ADT1ST                          WET1ST
     I              ADDBNB                          WEDBNB
     I              ADT2ST                          WET2ST
     I              ADT3ST                          WET3ST
     I              ADT4ST                          WET4ST
     I              ADT6ST                          WET6ST
     I              ADBWC3                          WEBWC3
     I              ADBTC3                          WEBTC3
     I              ADBUC3                          WEBUC3
     I              ADBVC3                          WEBVC3
     I              ADFCAA                          WEFCAA
     I              ADRQSX                          WERQSX
     I              ADRRSX                          WERRSX
     I              ADRSSX                          WERSSX
     I              ADRTSX                          WERTSX
     I              ADT7ST                          WET7ST
     I              ADT8ST                          WET8ST
     I              ADRNSX                          WERNSX
     I              ADROSX                          WEROSX
     I              ADRPSX                          WERPSX
     I              ADUVST                          WEUVST
     I              ADUWST                          WEUWST
     I              ADUXST                          WEUXST
     I              ADVSST                          WEVSST
     I              ADAATM                          WEAATM
     I              ADAYNA                          WEAYNA
     I              ADA0NA                          WEA0NA
     I              ADAXDT                          WEAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WFAIC3
     I              BEC4NB                          WFC4NB
     I              BEJNCD                          WFJNCD
     I              BEANC7                          WFANC7
     I              BEBKC7                          WFBKC7
     I              BEBRTX                          WFBRTX
     I              BEHMNA                          WFHMNA
     I              BEHONA                          WFHONA
     I              BEHPNA                          WFHPNA
     I              BEHNNA                          WFHNNA
     I              BEDBCD                          WFDBCD
     I              BECKTX                          WFCKTX
     I              BEB0C7                          WFB0C7
     I              BEAETX                          WFAETX
     I              BEB1NA                          WFB1NA
     I              BEB3NA                          WFB3NA
     I              BEB4NA                          WFB4NA
     I              BEB2NA                          WFB2NA
     I              BEBHCD                          WFBHCD
     I              BEC8TX                          WFC8TX
     I              BEBCNA                          WFBCNA
     I              BEA0DT                          WFA0DT
     I              BEA5DT                          WFA5DT
     I              BEGNDT                          WFGNDT
     I              BEACDT                          WFACDT
     I              BEAQCD                          WFAQCD
     I              BEB6NA                          WFB6NA
     I              BEBYNA                          WFBYNA
     I              BEBZNA                          WFBZNA
     I              BEGTST                          WFGTST
     I              BEGVST                          WFGVST
     I              BEGUST                          WFGUST
     I              BEQFST                          WFQFST
     I              BECQCD                          WFCQCD
     I              BEGJST                          WFGJST
     I              BEGWST                          WFGWST
     I              BEGXST                          WFGXST
     I              BEGYST                          WFGYST
     I              BEAODT                          WFAODT
     I              BEAIVN                          WFAIVN
     I              BECXDT                          WFCXDT
     I              BEJZVA                          WFJZVA
     I              BEA1WG                          WFA1WG
     I              BEXIST                          WFXIST
     I              BEXJST                          WFXJST
     I              BEXKST                          WFXKST
     I              BEEIDT                          WFEIDT
     I              BEAFTM                          WFAFTM
     I              BEE8CD                          WFE8CD
     I              BEE9CD                          WFE9CD
     I              BERMNB                          WFRMNB
     I              BETBNB                          WFTBNB
     I              BER1NB                          WFR1NB
     I              BEPJST                          WFPJST
     I              BEU0ST                          WFU0ST
     I              BEU1ST                          WFU1ST
     I              BEQ2CD                          WFQ2CD
     I              BEU2ST                          WFU2ST
     I              BEVEST                          WFVEST
     I              BEVFST                          WFVFST
     I              BEVGST                          WFVGST
     I              BERPCD                          WFRPCD
     I              BERNNB                          WFRNNB
     I              BEVDST                          WFVDST
     I              BEATIN                          WFATIN
     I              BEU4ST                          WFU4ST
     I              BEU5ST                          WFU5ST
     I              BERSRN                          WFRSRN
     I              BEMHNA                          WFMHNA
     I              BEMINA                          WFMINA
     I              BEWBST                          WFWBST
     I              BER4CD                          WFR4CD
     I              BEBFCD                          WFBFCD
     I              BEQ4CD                          WFQ4CD
     I              BET3NB                          WFT3NB
     I              BESICD                          WFSICD
     I              BECONB                          WFCONB
     I              BECEST                          WFCEST
     I              BEAWDT                          WFAWDT
     I              BEJPCD                          WFJPCD
     I              BEXUST                          WFXUST
     I              BEZ1ST                          WFZ1ST
     I              BEVRVA                          WFVRVA
     I              BEOBST                          WFOBST
     I              BEBCST                          WFBCST
     I              BEBDST                          WFBDST
     I              BEB7VL                          WFB7VL
     I              BEGASX                          WFGASX
     I              BEGBSX                          WFGBSX
     I              BEGCSX                          WFGCSX
     I              BEGDSX                          WFGDSX
     I              BEFNSX                          WFFNSX
     I              BEFOSX                          WFFOSX
     I              BEFPSX                          WFFPSX
     I              BEFQSX                          WFFQSX
     I              BEFRSX                          WFFRSX
     I              BEFSSX                          WFFSSX
     I              BEFTSX                          WFFTSX
     I              BEFUSX                          WFFUSX
     I              BEFVSX                          WFFVSX
     I              BEFWSX                          WFFWSX
     I              BEFXSX                          WFFXSX
     I              BEFYSX                          WFFYSX
     I              BENODT                          WFNODT
     I              BENPDT                          WFNPDT
     I              BENQDT                          WFNQDT
     I              BENRDT                          WFNRDT
     I              BENSDT                          WFNSDT
     I              BEBPTM                          WFBPTM
     I              BEBQTM                          WFBQTM
     I              BEBRTM                          WFBRTM
     I              BEBSTM                          WFBSTM
     I              BEBTTM                          WFBTTM
     I              BEH0NX                          WFH0NX
     I              BEH1NX                          WFH1NX
     I              BEH2NX                          WFH2NX
     I              BEH3NX                          WFH3NX
     I              BEH4NX                          WFH4NX
     I              BEC0C7                          WFC0C7
     I              BEUVST                          WFUVST
     I              BEUWST                          WFUWST
     I              BEUXST                          WFUXST
     I              BEAATM                          WFAATM
     I              BEAYNA                          WFAYNA
     I              BEA0NA                          WFA0NA
     I              BEAXDT                          WFAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WGAIC3
     I              OMC4NB                          WGC4NB
     I              OMDPNB                          WGDPNB
     I              OMUENB                          WGUENB
     I              OMHGCD                          WGHGCD
     I              OMAJCD                          WGAJCD
     I              OMBKC7                          WGBKC7
     I              OMCFC7                          WGCFC7
     I              OMGMST                          WGGMST
     I              OMGNST                          WGGNST
     I              OMMAVA                          WGMAVA
     I              OMKDVA                          WGKDVA
     I              OML8VA                          WGL8VA
     I              OML9VA                          WGL9VA
     I              OMGTST                          WGGTST
     I              OMGVST                          WGGVST
     I              OMGUST                          WGGUST
     I              OMQFST                          WGQFST
     I              OMAYVA                          WGAYVA
     I              OMEXDT                          WGEXDT
     I              OMLQCD                          WGLQCD
     I              OMRDCD                          WGRDCD
     I              OMQ7CD                          WGQ7CD
     I              OMBZPR                          WGBZPR
     I              OML6NB                          WGL6NB
     I              OMU1ST                          WGU1ST
     I              OMGIDT                          WGGIDT
     I              OMCRCD                          WGCRCD
     I              OMAGCD                          WGAGCD
     I              OMRZST                          WGRZST
     I              OMR0ST                          WGR0ST
     I              OMR1ST                          WGR1ST
     I              OMG7NA                          WGG7NA
     I              OMG8NA                          WGG8NA
     I              OMRPCD                          WGRPCD
     I              OMVEST                          WGVEST
     I              OMVGST                          WGVGST
     I              OMAVST                          WGAVST
     I              OMU0ST                          WGU0ST
     I              OMRFCD                          WGRFCD
     I              OMFZST                          WGFZST
     I              OMR1NB                          WGR1NB
     I              OMAVQT                          WGAVQT
     I              OMD0WG                          WGD0WG
     I              OMCCQT                          WGCCQT
     I              OMAUWG                          WGAUWG
     I              OMCBQT                          WGCBQT
     I              OMATWG                          WGATWG
     I              OMAQCS                          WGAQCS
     I              OMAGCS                          WGAGCS
     I              OMAKPR                          WGAKPR
     I              OMALPR                          WGALPR
     I              OMAUPR                          WGAUPR
     I              OMAVWG                          WGAVWG
     I              OMA4WG                          WGA4WG
     I              OMA5DT                          WGA5DT
     I              OMAODT                          WGAODT
     I              OMGNDT                          WGGNDT
     I              OMAMST                          WGAMST
     I              OMANST                          WGANST
     I              OMVAST                          WGVAST
     I              OMRGNB                          WGRGNB
     I              OMRHNB                          WGRHNB
     I              OMRINB                          WGRINB
     I              OMRBCD                          WGRBCD
     I              OMHICD                          WGHICD
     I              OMRNCD                          WGRNCD
     I              OMROCD                          WGROCD
     I              OMCXDT                          WGCXDT
     I              OMAJVN                          WGAJVN
     I              OMKXCD                          WGKXCD
     I              OMJPCD                          WGJPCD
     I              OMCQCD                          WGCQCD
     I              OMR4CD                          WGR4CD
     I              OMZ1ST                          WGZ1ST
     I              OMZ3ST                          WGZ3ST
     I              OMZ4ST                          WGZ4ST
     I              OMDUPR                          WGDUPR
     I              OMB6VL                          WGB6VL
     I              OMA1AA                          WGA1AA
     I              OMFZSX                          WGFZSX
     I              OMF0SX                          WGF0SX
     I              OMF1SX                          WGF1SX
     I              OMF2SX                          WGF2SX
     I              OMF3SX                          WGF3SX
     I              OMF4SX                          WGF4SX
     I              OMF5SX                          WGF5SX
     I              OMF6SX                          WGF6SX
     I              OMF7SX                          WGF7SX
     I              OMNTDT                          WGNTDT
     I              OMNUDT                          WGNUDT
     I              OMNVDT                          WGNVDT
     I              OMNWDT                          WGNWDT
     I              OMNXDT                          WGNXDT
     I              OMBUTM                          WGBUTM
     I              OMBVTM                          WGBVTM
     I              OMBWTM                          WGBWTM
     I              OMBXTM                          WGBXTM
     I              OMBYTM                          WGBYTM
     I              OMH5NX                          WGH5NX
     I              OMH6NX                          WGH6NX
     I              OMH7NX                          WGH7NX
     I              OMH8NX                          WGH8NX
     I              OMH9NX                          WGH9NX
     I              OMDVPR                          WGDVPR
     I              OMDWPR                          WGDWPR
     I              OMDXPR                          WGDXPR
     I              OMDYPR                          WGDYPR
     I              OMDZPR                          WGDZPR
     I              OMGSPR                          WGGSPR
     I              OMGTPR                          WGGTPR
     I              OMGUPR                          WGGUPR
     I              OMHOST                          WGHOST
     I              OMHPST                          WGHPST
     I              OMIOST                          WGIOST
     I              OMPEWG                          WGPEWG
     I              OMRINY                          WGRINY
     I              OMTIDT                          WGTIDT
     I              OMTJDT                          WGTJDT
     I              OMH2ST                          WGH2ST
     I              OMH0ST                          WGH0ST
     I              OMH1ST                          WGH1ST
     I              OMTKDT                          WGTKDT
     I              OMTLDT                          WGTLDT
     I              OMTMDT                          WGTMDT
     I              OMUVST                          WGUVST
     I              OMUWST                          WGUWST
     I              OMUXST                          WGUXST
     I              OMAATM                          WGAATM
     I              OMAYNA                          WGAYNA
     I              OMA0NA                          WGA0NA
     I              OMAXDT                          WGAXDT
      *
     I@BBREE9
      * Customer                  Retrieval index       NV
      * Renamed input format fields
     I              BBBKC7                          WHBKC7
     I              BBAYTX                          WHAYTX
     I              BBACNA                          WHACNA
     I              BBADNA                          WHADNA
     I              BBAENA                          WHAENA
     I              BBAJNA                          WHAJNA
     I              BBBGCD                          WHBGCD
     I              BBG5CD                          WHG5CD
     I              BBBTTX                          WHBTTX
     I              BBBVTX                          WHBVTX
     I              BBBWTX                          WHBWTX
     I              BBABTX                          WHABTX
     I              BBA2NA                          WHA2NA
     I              BBCBST                          WHCBST
     I              BBB0NA                          WHB0NA
     I              BBP3NB                          WHP3NB
     I              BBAXNA                          WHAXNA
     I              BBI6DT                          WHI6DT
     I              BBAYDT                          WHAYDT
     I              BBANC7                          WHANC7
     I              BBBTC7                          WHBTC7
     I              BBK6ST                          WHK6ST
     I              BBUZST                          WHUZST
     I              BBKXCD                          WHKXCD
     I              BBLTCD                          WHLTCD
     I              BBQNST                          WHQNST
     I              BBS2NB                          WHS2NB
     I              BBVHVA                          WHVHVA
     I              BBI7DT                          WHI7DT
     I              BBRJST                          WHRJST
     I              BBRKST                          WHRKST
     I              BBQWST                          WHQWST
     I              BBQXST                          WHQXST
     I              BBQYST                          WHQYST
     I              BBUNCS                          WHUNCS
     I              BBUVST                          WHUVST
     I              BBUWST                          WHUWST
     I              BBUXST                          WHUXST
     I              BBVSST                          WHVSST
     I              BBAATM                          WHAATM
     I              BBAYNA                          WHAYNA
     I              BBA0NA                          WHA0NA
     I              BBAXDT                          WHAXDT
      *
     I@BIREKY
      * Customer Item Reference   Retrieval index
      * Renamed input format fields
     I              BIBKC7                          WIBKC7
     I              BIHGCD                          WIHGCD
     I              BICOAA                          WICOAA
     I              BICPAA                          WICPAA
     I              BIPSNA                          WIPSNA
     I              BIPTNA                          WIPTNA
     I              BIPUNA                          WIPUNA
     I              BILBSX                          WILBSX
     I              BILCSX                          WILCSX
     I              BILDSX                          WILDSX
     I              BILESX                          WILESX
     I              BILFSX                          WILFSX
     I              BIVSST                          WIVSST
     I              BIMJDT                          WIMJDT
     I              BIBETM                          WIBETM
     I              BICCVN                          WICCVN
     I              BICDVN                          WICDVN
     I              BIMKDT                          WIMKDT
     I              BIBFTM                          WIBFTM
     I              BICEVN                          WICEVN
     I              BICFVN                          WICFVN
      *
     I@EOREXM
      * Company Customer          Retrieval index
      * Renamed input format fields
     I              EOAIC3                          WJAIC3
     I              EOBKC7                          WJBKC7
     I              EOAQCD                          WJAQCD
     I              EOR4CD                          WJR4CD
     I              EOBYNA                          WJBYNA
     I              EOB6NA                          WJB6NA
     I              EOBZNA                          WJBZNA
     I              EOLLST                          WJLLST
     I              EOPPST                          WJPPST
     I              EOR5NB                          WJR5NB
     I              EOR6NB                          WJR6NB
     I              EOQGST                          WJQGST
     I              EOBOCD                          WJBOCD
     I              EOTBNB                          WJTBNB
     I              EOMTCU                          WJMTCU
     I              EOW2NB                          WJW2NB
     I              EORPCD                          WJRPCD
     I              EOAJCD                          WJAJCD
     I              EOX9ST                          WJX9ST
     I              EOT9CD                          WJT9CD
     I              EOUBCD                          WJUBCD
     I              EOISTX                          WJISTX
     I              EOLQCD                          WJLQCD
     I              EONJNA                          WJNJNA
     I              EOI0TX                          WJI0TX
     I              EONKNA                          WJNKNA
     I              EOI1TX                          WJI1TX
     I              EOVLST                          WJVLST
     I              EORLST                          WJRLST
     I              EOMMTX                          WJMMTX
     I              EOOHNA                          WJOHNA
     I              EOQ6ST                          WJQ6ST
     I              EOQ8ST                          WJQ8ST
     I              EORBST                          WJRBST
     I              EOREST                          WJREST
     I              EOUVST                          WJUVST
     I              EOUWST                          WJUWST
     I              EOUXST                          WJUXST
     I              EOVSST                          WJVSST
     I              EOAATM                          WJAATM
     I              EOAYNA                          WJAYNA
     I              EOA0NA                          WJA0NA
     I              EOAXDT                          WJAXDT
      *
     I@AFREPU
      * Calendar                  RSQ Co/Date Descending
      * Renamed input format fields
     I              AFAIC3                          WKAIC3
     I              AFBCDT                          WKBCDT
     I              AFCQNB                          WKCQNB
     I              AFESNB                          WKESNB
     I              AFETNB                          WKETNB
     I              AFBZNB                          WKBZNB
     I              AFA9ST                          WKA9ST
     I              AFEINB                          WKEINB
     I              AFC5ST                          WKC5ST
     I              AFAQNB                          WKAQNB
     I              AFCMST                          WKCMST
     I              AFV9ST                          WKV9ST
     I              AFWAST                          WKWAST
     I              AFX2ST                          WKX2ST
     I              AFOJDT                          WKOJDT
     I              AFNQNX                          WKNQNX
     I              AFNRNX                          WKNRNX
     I              AFI9SX                          WKI9SX
     I              AFJASX                          WKJASX
     I              AFOKDT                          WKOKDT
     I              AFOLDT                          WKOLDT
     I              AFUVST                          WKUVST
     I              AFUWST                          WKUWST
     I              AFUXST                          WKUXST
     I              AFAATM                          WKAATM
     I              AFAYNA                          WKAYNA
     I              AFA0NA                          WKA0NA
     I              AFAXDT                          WKAXDT
      *
     I@IORETI
      * Item Bill Of Material     Retrieval index
      * Renamed input format fields
     I              IOAIC3                          WLAIC3
     I              IOHGCD                          WLHGCD
     I              IOC9NB                          WLC9NB
     I              IOV2ST                          WLV2ST
     I              IOBOPR                          WLBOPR
     I              IOBPPR                          WLBPPR
     I              IOHGQT                          WLHGQT
     I              IOHHCD                          WLHHCD
     I              IOYAST                          WLYAST
     I              IOCNSM                          WLCNSM
     I              IOBMY1                          WLBMY1
     I              IOBMY2                          WLBMY2
     I              IOIXQT                          WLIXQT
     I              IOIYQT                          WLIYQT
     I              IORSST                          WLRSST
     I              IORTST                          WLRTST
     I              IOUVST                          WLUVST
     I              IOUWST                          WLUWST
     I              IOUXST                          WLUXST
     I              IOVSST                          WLVSST
     I              IOAATM                          WLAATM
     I              IOAYNA                          WLAYNA
     I              IOA0NA                          WLA0NA
     I              IOAXDT                          WLAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WMAIC3
     I              BZHGCD                          WMHGCD
     I              BZAVNA                          WMAVNA
     I              BZAWNA                          WMAWNA
     I              BZL7NA                          WML7NA
     I              BZL8NA                          WML8NA
     I              BZL6NA                          WML6NA
     I              BZMFNA                          WMMFNA
     I              BZADCD                          WMADCD
     I              BZAWPC                          WMAWPC
     I              BZLXST                          WMLXST
     I              BZAECD                          WMAECD
     I              BZAXPC                          WMAXPC
     I              BZLYST                          WMLYST
     I              BZAFCD                          WMAFCD
     I              BZAICD                          WMAICD
     I              BZAIWG                          WMAIWG
     I              BZHICD                          WMHICD
     I              BZRBCD                          WMRBCD
     I              BZFZST                          WMFZST
     I              BZAVST                          WMAVST
     I              BZCZWG                          WMCZWG
     I              BZC0WG                          WMC0WG
     I              BZURTN                          WMURTN
     I              BZAJC8                          WMAJC8
     I              BZRINB                          WMRINB
     I              BZRHNB                          WMRHNB
     I              BZRGNB                          WMRGNB
     I              BZLNCD                          WMLNCD
     I              BZTFNB                          WMTFNB
     I              BZN0CD                          WMN0CD
     I              BZX4ST                          WMX4ST
     I              BZTMVA                          WMTMVA
     I              BZTNVA                          WMTNVA
     I              BZBLPR                          WMBLPR
     I              BZBMPR                          WMBMPR
     I              BZLRCD                          WMLRCD
     I              BZU9ST                          WMU9ST
     I              BZCMCO                          WMCMCO
     I              BZQ1CD                          WMQ1CD
     I              BZQ8CD                          WMQ8CD
     I              BZCHTM                          WMCHTM
     I              BZQZCD                          WMQZCD
     I              BZXWST                          WMXWST
     I              BZXXST                          WMXXST
     I              BZVMST                          WMVMST
     I              BZSWGH                          WMSWGH
     I              BZPPHE                          WMPPHE
     I              BZR3CD                          WMR3CD
     I              BZSDCD                          WMSDCD
     I              BZICN1                          WMICN1
     I              BZSVCD                          WMSVCD
     I              BZICN2                          WMICN2
     I              BZSWCD                          WMSWCD
     I              BZV2NB                          WMV2NB
     I              BZSXCD                          WMSXCD
     I              BZITCN                          WMITCN
     I              BZSYCD                          WMSYCD
     I              BZITC5                          WMITC5
     I              BZSZCD                          WMSZCD
     I              BZICN6                          WMICN6
     I              BZS0CD                          WMS0CD
     I              BZICN7                          WMICN7
     I              BZS1CD                          WMS1CD
     I              BZICN8                          WMICN8
     I              BZS2CD                          WMS2CD
     I              BZICN9                          WMICN9
     I              BZS3CD                          WMS3CD
     I              BZICN0                          WMICN0
     I              BZS4CD                          WMS4CD
     I              BZSFNB                          WMSFNB
     I              BZA3WG                          WMA3WG
     I              BZSJNB                          WMSJNB
     I              BZLLCD                          WMLLCD
     I              BZLMCD                          WMLMCD
     I              BZP3ST                          WMP3ST
     I              BZSKNB                          WMSKNB
     I              BZSLNB                          WMSLNB
     I              BZSMNB                          WMSMNB
     I              BZP4ST                          WMP4ST
     I              BZCFNB                          WMCFNB
     I              BZCGNB                          WMCGNB
     I              BZILNB                          WMILNB
     I              BZCHNB                          WMCHNB
     I              BZCINB                          WMCINB
     I              BZCJNB                          WMCJNB
     I              BZCMNB                          WMCMNB
     I              BZCNNB                          WMCNNB
     I              BZCRNB                          WMCRNB
     I              BZCSNB                          WMCSNB
     I              BZCVNB                          WMCVNB
     I              BZCWNB                          WMCWNB
     I              BZCXNB                          WMCXNB
     I              BZCZNB                          WMCZNB
     I              BZC0NB                          WMC0NB
     I              BZN1CD                          WMN1CD
     I              BZB4NB                          WMB4NB
     I              BZB5NB                          WMB5NB
     I              BZX5ST                          WMX5ST
     I              BZX6ST                          WMX6ST
     I              BZX7ST                          WMX7ST
     I              BZPCCT                          WMPCCT
     I              BZBDNB                          WMBDNB
     I              BZBJNB                          WMBJNB
     I              BZSUST                          WMSUST
     I              BZSVST                          WMSVST
     I              BZSYST                          WMSYST
     I              BZSZST                          WMSZST
     I              BZS1ST                          WMS1ST
     I              BZXRCD                          WMXRCD
     I              BZXTCD                          WMXTCD
     I              BZXUCD                          WMXUCD
     I              BZF5WG                          WMF5WG
     I              BZF6WG                          WMF6WG
     I              BZF7WG                          WMF7WG
     I              BZBLNB                          WMBLNB
     I              BZBNNB                          WMBNNB
     I              BZS2ST                          WMS2ST
     I              BZS4ST                          WMS4ST
     I              BZS5ST                          WMS5ST
     I              BZS6ST                          WMS6ST
     I              BZS8ST                          WMS8ST
     I              BZS9ST                          WMS9ST
     I              BZTCST                          WMTCST
     I              BZTDST                          WMTDST
     I              BZUVST                          WMUVST
     I              BZUWST                          WMUWST
     I              BZUXST                          WMUXST
     I              BZVSST                          WMVSST
     I              BZAATM                          WMAATM
     I              BZAYNA                          WMAYNA
     I              BZA0NA                          WMA0NA
     I              BZAXDT                          WMAXDT
      *
     I@BCCPZP
      * PFS Order Detail          Retrieval index
      * Renamed input format fields
     I              BCY1NX                          WOY1NX
     I              BCZPNX                          WOZPNX
     I              BCZXNX                          WOZXNX
     I              BCZYNX                          WOZYNX
     I              BCY2NX                          WOY2NX
     I              BCGIT1                          WOGIT1
     I              BCGGT1                          WOGGT1
     I              BCGHT1                          WOGHT1
     I              BCVFSX                          WOVFSX
     I              BCVGSX                          WOVGSX
     I              BCVHSX                          WOVHSX
     I              BCVISX                          WOVISX
     I              BCF8AA                          WOF8AA
     I              BCV4SX                          WOV4SX
     I              BCF9AA                          WOF9AA
     I              BCZFNX                          WOZFNX
     I              BCZZNX                          WOZZNX
     I              BCZ0NX                          WOZ0NX
     I              BCBINY                          WOBINY
     I              BCBJNY                          WOBJNY
     I              BCBKNY                          WOBKNY
     I              BCATNY                          WOATNY
     I              BCALD8                          WOALD8
     I              BCAMD8                          WOAMD8
     I              BCF5NY                          WOF5NY
     I              BCZISX                          WOZISX
     I              BCZJSX                          WOZJSX
     I              BCZKSX                          WOZKSX
     I              BCZLSX                          WOZLSX
     I              BCZMSX                          WOZMSX
     I              BCUWSX                          WOUWSX
     I              BCUXSX                          WOUXSX
     I              BCV3SX                          WOV3SX
     I              BCAHNY                          WOAHNY
     I              BCAINY                          WOAINY
     I              BCAJNY                          WOAJNY
     I              BCAKNY                          WOAKNY
      *
     I@BCCPZO
      * PFS Order Detail          Update index
      * Renamed input format fields
     I              BCY1NX                          WRY1NX
     I              BCZPNX                          WRZPNX
     I              BCZXNX                          WRZXNX
     I              BCZYNX                          WRZYNX
     I              BCY2NX                          WRY2NX
     I              BCGIT1                          WRGIT1
     I              BCGGT1                          WRGGT1
     I              BCGHT1                          WRGHT1
     I              BCVFSX                          WRVFSX
     I              BCVGSX                          WRVGSX
     I              BCVHSX                          WRVHSX
     I              BCVISX                          WRVISX
     I              BCF8AA                          WRF8AA
     I              BCV4SX                          WRV4SX
     I              BCF9AA                          WRF9AA
     I              BCZFNX                          WRZFNX
     I              BCZZNX                          WRZZNX
     I              BCZ0NX                          WRZ0NX
     I              BCBINY                          WRBINY
     I              BCBJNY                          WRBJNY
     I              BCBKNY                          WRBKNY
     I              BCATNY                          WRATNY
     I              BCALD8                          WRALD8
     I              BCAMD8                          WRAMD8
     I              BCF5NY                          WRF5NY
     I              BCZISX                          WRZISX
     I              BCZJSX                          WRZJSX
     I              BCZKSX                          WRZKSX
     I              BCZLSX                          WRZLSX
     I              BCZMSX                          WRZMSX
     I              BCUWSX                          WRUWSX
     I              BCUXSX                          WRUXSX
     I              BCV3SX                          WRV3SX
     I              BCAHNY                          WRAHNY
     I              BCAINY                          WRAINY
     I              BCAJNY                          WRAJNY
     I              BCAKNY                          WRAKNY
      *
     I@AMREJF
      * Order Header Extension    Retrieval index
      * Renamed input format fields
     I              AMAIC3                          WSAIC3
     I              AMC4NB                          WSC4NB
     I              AMRMNB                          WSRMNB
     I              AMRUNB                          WSRUNB
     I              AMXACD                          WSXACD
     I              AMOANA                          WSOANA
     I              AMHBAA                          WSHBAA
     I              AMJ0T1                          WSJ0T1
     I              AMGENY                          WSGENY
     I              AMJ1T1                          WSJ1T1
     I              AMHCAA                          WSHCAA
     I              AMQWDT                          WSQWDT
     I              AMQXDT                          WSQXDT
     I              AMQYDT                          WSQYDT
     I              AMHDAA                          WSHDAA
     I              AMCCTX                          WSCCTX
     I              AMJ2T1                          WSJ2T1
     I              AMRLNA                          WSRLNA
     I              AMRMNA                          WSRMNA
     I              AMGINY                          WSGINY
     I              AMGFNY                          WSGFNY
     I              AMGGNY                          WSGGNY
     I              AMGHNY                          WSGHNY
     I              AMHEVL                          WSHEVL
     I              AMHFVL                          WSHFVL
     I              AMHGVL                          WSHGVL
     I              AMQZDT                          WSQZDT
     I              AMQ0DT                          WSQ0DT
     I              AMQ1DT                          WSQ1DT
     I              AMQ2DT                          WSQ2DT
     I              AMC2TX                          WSC2TX
     I              AMC3TX                          WSC3TX
     I              AMC6TX                          WSC6TX
     I              AMCHTX                          WSCHTX
     I              AMCITX                          WSCITX
     I              AMCLTX                          WSCLTX
     I              AMB4TX                          WSB4TX
     I              AMCUTX                          WSCUTX
     I              AMCVTX                          WSCVTX
     I              AMB9TX                          WSB9TX
     I              AMJWSC                          WSJWSC
     I              AMITNY                          WSITNY
     I              AMLMT1                          WSLMT1
     I              AMLWAA                          WSLWAA
     I              AMFVST                          WSFVST
     I              AMF0ST                          WSF0ST
     I              AMF2ST                          WSF2ST
     I              AMF3ST                          WSF3ST
     I              AMJUSC                          WSJUSC
     I              AMJVSC                          WSJVSC
     I              AMV3T1                          WSV3T1
     I              AMV4T1                          WSV4T1
     I              AMV5T1                          WSV5T1
     I              AMV6T1                          WSV6T1
     I              AMV7T1                          WSV7T1
     I              AMV8T1                          WSV8T1
     I              AMV9T1                          WSV9T1
     I              AMWAT1                          WSWAT1
     I              AMWBT1                          WSWBT1
     I              AMWCT1                          WSWCT1
     I              AMWDT1                          WSWDT1
     I              AMQJNY                          WSQJNY
     I              AMQKNY                          WSQKNY
     I              AMQLNY                          WSQLNY
     I              AMP8NY                          WSP8NY
     I              AMP9NY                          WSP9NY
     I              AMQANY                          WSQANY
     I              AMQCNY                          WSQCNY
     I              AMQDNY                          WSQDNY
     I              AMQENY                          WSQENY
     I              AMQFNY                          WSQFNY
     I              AMQGNY                          WSQGNY
     I              AMQHNY                          WSQHNY
     I              AMQINY                          WSQINY
     I              AMQMNY                          WSQMNY
     I              AMMYU1                          WSMYU1
     I              AMJXSC                          WSJXSC
     I              AMJYSC                          WSJYSC
     I              AMJZSC                          WSJZSC
     I              AMJ0SC                          WSJ0SC
     I              AMMZU1                          WSMZU1
     I              AMM0U1                          WSM0U1
     I              AMM1U1                          WSM1U1
     I              AMM2U1                          WSM2U1
     I              AMM3U1                          WSM3U1
     I              AMW5DT                          WSW5DT
     I              AMW6DT                          WSW6DT
     I              AMUVST                          WSUVST
     I              AMUWST                          WSUWST
     I              AMUXST                          WSUXST
     I              AMVSST                          WSVSST
     I              AMAATM                          WSAATM
     I              AMAYNA                          WSAYNA
     I              AMA0NA                          WSA0NA
     I              AMAXDT                          WSAXDT
      *
     I@JYRECE
      * Company Defaults Internal Active Records
      * Renamed input format fields
     I              JYAIC3                          WTAIC3
     I              JYZ9ST                          WTZ9ST
     I              JYCSST                          WTCSST
     I              JYZ8ST                          WTZ8ST
     I              JYCXST                          WTCXST
     I              JYSWST                          WTSWST
     I              JYXXTM                          WTXXTM
     I              JYUECD                          WTUECD
     I              JYHSST                          WTHSST
     I              JYAMEO                          WTAMEO
     I              JYSSDF                          WTSSDF
     I              JYPDFT                          WTPDFT
     I              JYYISX                          WTYISX
     I              JYYJSX                          WTYJSX
     I              JYYKSX                          WTYKSX
     I              JYYLSX                          WTYLSX
     I              JYYMSX                          WTYMSX
     I              JYYNSX                          WTYNSX
     I              JYUVST                          WTUVST
     I              JYUWST                          WTUWST
     I              JYUXST                          WTUXST
     I              JYVSST                          WTVSST
     I              JYAATM                          WTAATM
     I              JYAYNA                          WTAYNA
     I              JYA0NA                          WTA0NA
     I              JYAXDT                          WTAXDT
      *
     I@BDCPAB
      * PFS Order BOL Comment     Retrieval index
      * Renamed input format fields
     I              BDY1NX                          WVY1NX
     I              BDZPNX                          WVZPNX
     I              BDIZST                          WVIZST
     I              BDZ1NX                          WVZ1NX
     I              BDGJT1                          WVGJT1
     I              BDUWSX                          WVUWSX
     I              BDUXSX                          WVUXSX
     I              BDV3SX                          WVV3SX
     I              BDAHNY                          WVAHNY
     I              BDAINY                          WVAINY
     I              BDAJNY                          WVAJNY
     I              BDAKNY                          WVAKNY
      *
     I@BDCPAA
      * PFS Order BOL Comment     Update index
      * Renamed input format fields
     I              BDY1NX                          WWY1NX
     I              BDZPNX                          WWZPNX
     I              BDIZST                          WWIZST
     I              BDZ1NX                          WWZ1NX
     I              BDGJT1                          WWGJT1
     I              BDUWSX                          WWUWSX
     I              BDUXSX                          WWUXSX
     I              BDV3SX                          WWV3SX
     I              BDAHNY                          WWAHNY
     I              BDAINY                          WWAINY
     I              BDAJNY                          WWAJNY
     I              BDAKNY                          WWAKNY
      *
     I@COCPNU
      * Order Comment             Retrieval index       NV
      * Renamed input format fields
     I              COAIC3                          WXAIC3
     I              COC4NB                          WXC4NB
     I              COI1SX                          WXI1SX
     I              CODXNB                          WXDXNB
     I              COG4NA                          WXG4NA
     I              COUVST                          WXUVST
     I              COUWST                          WXUWST
     I              COUXST                          WXUXST
     I              COAATM                          WXAATM
     I              COAYNA                          WXAYNA
     I              COA0NA                          WXA0NA
     I              COAXDT                          WXAXDT
      *
     I@B1REED
      * Country Comment           Retrieval index
      * Renamed input format fields
     I              B1KXCD                          WYKXCD
     I              B1I1SX                          WYI1SX
     I              B1M5NX                          WYM5NX
     I              B1Q6NA                          WYQ6NA
     I              B1UVST                          WYUVST
     I              B1UWST                          WYUWST
     I              B1UXST                          WYUXST
     I              B1VSST                          WYVSST
     I              B1AATM                          WYAATM
     I              B1AYNA                          WYAYNA
     I              B1A0NA                          WYA0NA
     I              B1AXDT                          WYAXDT
      *
     I@AVCPG4
      * Customer Comment          Retrieval index
      * Renamed input format fields
     I              AVBKC7                          TABKC7
     I              AVI1SX                          TAI1SX
     I              AVM5NX                          TAM5NX
     I              AVXRTX                          TAXRTX
     I              AVUVST                          TAUVST
     I              AVUWST                          TAUWST
     I              AVUXST                          TAUXST
     I              AVVSST                          TAVSST
     I              AVAATM                          TAAATM
     I              AVAYNA                          TAAYNA
     I              AVA0NA                          TAA0NA
     I              AVAXDT                          TAAXDT
      *
     I@NEREAT
      * Customer EXT              Retrieval index
      * Renamed input format fields
     I              NEBKC7                          TBBKC7
     I              NEUFTX                          TBUFTX
     I              NEUGTX                          TBUGTX
     I              NEPFNA                          TBPFNA
     I              NEJ5NX                          TBJ5NX
     I              NEU5TX                          TBU5TX
     I              NEU6TX                          TBU6TX
     I              NEW0TX                          TBW0TX
     I              NEHSSX                          TBHSSX
     I              NEHUSX                          TBHUSX
     I              NEHVSX                          TBHVSX
     I              NEAAC8                          TBAAC8
     I              NEP0SX                          TBP0SX
     I              NEP1SX                          TBP1SX
     I              NEP2SX                          TBP2SX
     I              NEP3SX                          TBP3SX
     I              NEP4SX                          TBP4SX
     I              NEP5SX                          TBP5SX
     I              NEP6SX                          TBP6SX
     I              NEUVST                          TBUVST
     I              NEUWST                          TBUWST
     I              NEUXST                          TBUXST
     I              NEVSST                          TBVSST
     I              NEAATM                          TBAATM
     I              NEAYNA                          TBAYNA
     I              NEA0NA                          TBA0NA
     I              NEAXDT                          TBAXDT
      *
     I@FLCPKF
      * Load Detail               Co/Load/Order
      * Renamed input format fields
     I              FLRMNB                          TCRMNB
     I              FLRUNB                          TCRUNB
     I              FLRVNB                          TCRVNB
     I              FLDQTX                          TCDQTX
     I              FLRWNB                          TCRWNB
     I              FLRXNB                          TCRXNB
     I              FLSQNB                          TCSQNB
     I              FLT0NB                          TCT0NB
     I              FLT1NB                          TCT1NB
     I              FLR1NB                          TCR1NB
     I              FLAIC3                          TCAIC3
     I              FLC4NB                          TCC4NB
     I              FLVCST                          TCVCST
     I              FLKEDT                          TCKEDT
     I              FLSXNB                          TCSXNB
     I              FLKFDT                          TCKFDT
     I              FLACTM                          TCACTM
     I              FLK5TX                          TCK5TX
     I              FLW5CD                          TCW5CD
     I              FLEJDT                          TCEJDT
     I              FLAGTM                          TCAGTM
     I              FLKJDT                          TCKJDT
     I              FLATTM                          TCATTM
     I              FLHDDT                          TCHDDT
     I              FLAUTM                          TCAUTM
     I              FLKKDT                          TCKKDT
     I              FLAVTM                          TCAVTM
     I              FLZ4NB                          TCZ4NB
     I              FLY7ST                          TCY7ST
     I              FLY2ST                          TCY2ST
     I              FLWHTX                          TCWHTX
     I              FLWITX                          TCWITX
     I              FLWJTX                          TCWJTX
     I              FLWKTX                          TCWKTX
     I              FLWLTX                          TCWLTX
     I              FLN7DT                          TCN7DT
     I              FLN8DT                          TCN8DT
     I              FLN9DT                          TCN9DT
     I              FLB3TM                          TCB3TM
     I              FLB4TM                          TCB4TM
     I              FLB5TM                          TCB5TM
     I              FLIASX                          TCIASX
     I              FLIBSX                          TCIBSX
     I              FLICSX                          TCICSX
     I              FLWVTX                          TCWVTX
     I              FLWWTX                          TCWWTX
     I              FLWXTX                          TCWXTX
     I              FLUVST                          TCUVST
     I              FLUWST                          TCUWST
     I              FLUXST                          TCUXST
     I              FLAATM                          TCAATM
     I              FLAYNA                          TCAYNA
     I              FLA0NA                          TCA0NA
     I              FLAXDT                          TCAXDT
      *
     I@LCREL2
      * Shipping Line/Port        Retrieval index
      * Renamed input format fields
     I              LCXACD                          TDXACD
     I              LCOANA                          TDOANA
     I              LCOKTX                          TDOKTX
     I              LCLBTX                          TDLBTX
     I              LCLATX                          TDLATX
     I              LCXBCD                          TDXBCD
     I              LCLCTX                          TDLCTX
     I              LCSPPN                          TDSPPN
     I              LCLDTX                          TDLDTX
     I              LCPYAA                          TDPYAA
     I              LCUVST                          TDUVST
     I              LCUWST                          TDUWST
     I              LCUXST                          TDUXST
     I              LCVSST                          TDVSST
     I              LCAATM                          TDAATM
     I              LCAYNA                          TDAYNA
     I              LCA0NA                          TDA0NA
     I              LCAXDT                          TDAXDT
      *
     I@BBCPZS
      * PFS Order Header          Retrieval index
      * Renamed input format fields
     I              BBY1NX                          TEY1NX
     I              BBZPNX                          TEZPNX
     I              BBZGNX                          TEZGNX
     I              BBZWNX                          TEZWNX
     I              BBZVNX                          TEZVNX
     I              BBVCSX                          TEVCSX
     I              BBZQNX                          TEZQNX
     I              BBF0T1                          TEF0T1
     I              BBF1T1                          TEF1T1
     I              BBF2T1                          TEF2T1
     I              BBGUT1                          TEGUT1
     I              BBF3T1                          TEF3T1
     I              BBF4T1                          TEF4T1
     I              BBF5T1                          TEF5T1
     I              BBF6T1                          TEF6T1
     I              BBF7T1                          TEF7T1
     I              BBZENX                          TEZENX
     I              BBF8T1                          TEF8T1
     I              BBF9T1                          TEF9T1
     I              BBGAT1                          TEGAT1
     I              BBGVT1                          TEGVT1
     I              BBGBT1                          TEGBT1
     I              BBGCT1                          TEGCT1
     I              BBGDT1                          TEGDT1
     I              BBFZT1                          TEFZT1
     I              BBZRNX                          TEZRNX
     I              BBZSNX                          TEZSNX
     I              BBZTNX                          TEZTNX
     I              BBZUNX                          TEZUNX
     I              BBVBSX                          TEVBSX
     I              BBU3SX                          TEU3SX
     I              BBGET1                          TEGET1
     I              BBGFT1                          TEGFT1
     I              BBA1NY                          TEA1NY
     I              BBBKNY                          TEBKNY
     I              BBATNY                          TEATNY
     I              BBVESX                          TEVESX
     I              BBF8AA                          TEF8AA
     I              BBF9AA                          TEF9AA
     I              BBC5NY                          TEC5NY
     I              BBF5NY                          TEF5NY
     I              BBF5AA                          TEF5AA
     I              BBFRT1                          TEFRT1
     I              BBFST1                          TEFST1
     I              BBFTT1                          TEFTT1
     I              BBFUT1                          TEFUT1
     I              BBFVT1                          TEFVT1
     I              BBFWT1                          TEFWT1
     I              BBFXT1                          TEFXT1
     I              BBZLNX                          TEZLNX
     I              BBF7AA                          TEF7AA
     I              BBF6AA                          TEF6AA
     I              BBS6NA                          TES6NA
     I              BBZDSX                          TEZDSX
     I              BBZESX                          TEZESX
     I              BBZFSX                          TEZFSX
     I              BBZGSX                          TEZGSX
     I              BBZHSX                          TEZHSX
     I              BBMXU1                          TEMXU1
     I              BBUWSX                          TEUWSX
     I              BBUXSX                          TEUXSX
     I              BBV3SX                          TEV3SX
     I              BBAHNY                          TEAHNY
     I              BBAINY                          TEAINY
     I              BBAJNY                          TEAJNY
     I              BBAKNY                          TEAKNY
      *
     I@BBCPZR
      * PFS Order Header          Update index
      * Renamed input format fields
     I              BBY1NX                          TFY1NX
     I              BBZPNX                          TFZPNX
     I              BBZGNX                          TFZGNX
     I              BBZWNX                          TFZWNX
     I              BBZVNX                          TFZVNX
     I              BBVCSX                          TFVCSX
     I              BBZQNX                          TFZQNX
     I              BBF0T1                          TFF0T1
     I              BBF1T1                          TFF1T1
     I              BBF2T1                          TFF2T1
     I              BBGUT1                          TFGUT1
     I              BBF3T1                          TFF3T1
     I              BBF4T1                          TFF4T1
     I              BBF5T1                          TFF5T1
     I              BBF6T1                          TFF6T1
     I              BBF7T1                          TFF7T1
     I              BBZENX                          TFZENX
     I              BBF8T1                          TFF8T1
     I              BBF9T1                          TFF9T1
     I              BBGAT1                          TFGAT1
     I              BBGVT1                          TFGVT1
     I              BBGBT1                          TFGBT1
     I              BBGCT1                          TFGCT1
     I              BBGDT1                          TFGDT1
     I              BBFZT1                          TFFZT1
     I              BBZRNX                          TFZRNX
     I              BBZSNX                          TFZSNX
     I              BBZTNX                          TFZTNX
     I              BBZUNX                          TFZUNX
     I              BBVBSX                          TFVBSX
     I              BBU3SX                          TFU3SX
     I              BBGET1                          TFGET1
     I              BBGFT1                          TFGFT1
     I              BBA1NY                          TFA1NY
     I              BBBKNY                          TFBKNY
     I              BBATNY                          TFATNY
     I              BBVESX                          TFVESX
     I              BBF8AA                          TFF8AA
     I              BBF9AA                          TFF9AA
     I              BBC5NY                          TFC5NY
     I              BBF5NY                          TFF5NY
     I              BBF5AA                          TFF5AA
     I              BBFRT1                          TFFRT1
     I              BBFST1                          TFFST1
     I              BBFTT1                          TFFTT1
     I              BBFUT1                          TFFUT1
     I              BBFVT1                          TFFVT1
     I              BBFWT1                          TFFWT1
     I              BBFXT1                          TFFXT1
     I              BBZLNX                          TFZLNX
     I              BBF7AA                          TFF7AA
     I              BBF6AA                          TFF6AA
     I              BBS6NA                          TFS6NA
     I              BBZDSX                          TFZDSX
     I              BBZESX                          TFZESX
     I              BBZFSX                          TFZFSX
     I              BBZGSX                          TFZGSX
     I              BBZHSX                          TFZHSX
     I              BBMXU1                          TFMXU1
     I              BBUWSX                          TFUWSX
     I              BBUXSX                          TFUXSX
     I              BBV3SX                          TFV3SX
     I              BBAHNY                          TFAHNY
     I              BBAINY                          TFAINY
     I              BBAJNY                          TFAJNY
     I              BBAKNY                          TFAKNY
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
     IQPPBC1    E DSPPBCCPL0
      * UPD : PFS Order Detail          Update index
      * Renamed input format fields
     I              BCY1NX                          WRY1NX
     I              BCZPNX                          WRZPNX
     I              BCZXNX                          WRZXNX
     I              BCZYNX                          WRZYNX
     I              BCY2NX                          WRY2NX
     I              BCGIT1                          WRGIT1
     I              BCGGT1                          WRGGT1
     I              BCGHT1                          WRGHT1
     I              BCVFSX                          WRVFSX
     I              BCVGSX                          WRVGSX
     I              BCVHSX                          WRVHSX
     I              BCVISX                          WRVISX
     I              BCF8AA                          WRF8AA
     I              BCV4SX                          WRV4SX
     I              BCF9AA                          WRF9AA
     I              BCZFNX                          WRZFNX
     I              BCZZNX                          WRZZNX
     I              BCZ0NX                          WRZ0NX
     I              BCBINY                          WRBINY
     I              BCBJNY                          WRBJNY
     I              BCBKNY                          WRBKNY
     I              BCATNY                          WRATNY
     I              BCALD8                          WRALD8
     I              BCAMD8                          WRAMD8
     I              BCF5NY                          WRF5NY
     I              BCZISX                          WRZISX
     I              BCZJSX                          WRZJSX
     I              BCZKSX                          WRZKSX
     I              BCZLSX                          WRZLSX
     I              BCZMSX                          WRZMSX
     I              BCUWSX                          WRUWSX
     I              BCUXSX                          WRUXSX
     I              BCV3SX                          WRV3SX
     I              BCAHNY                          WRAHNY
     I              BCAINY                          WRAINY
     I              BCAJNY                          WRAJNY
     I              BCAKNY                          WRAKNY
      *
     IYARDCS      DS                            222
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPPBD1    E DSPPBDCPL0
      * UPD : PFS Order BOL Comment     Update index
      * Renamed input format fields
     I              BDY1NX                          WWY1NX
     I              BDZPNX                          WWZPNX
     I              BDIZST                          WWIZST
     I              BDZ1NX                          WWZ1NX
     I              BDGJT1                          WWGJT1
     I              BDUWSX                          WWUWSX
     I              BDUXSX                          WWUXSX
     I              BDV3SX                          WWV3SX
     I              BDAHNY                          WWAHNY
     I              BDAINY                          WWAINY
     I              BDAJNY                          WWAJNY
     I              BDAKNY                          WWAKNY
      *
     IYBRDCS      DS                            111
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IQPPBB1    E DSPPBBCPL0
      * UPD : PFS Order Header          Update index
      * Renamed input format fields
     I              BBY1NX                          TFY1NX
     I              BBZPNX                          TFZPNX
     I              BBZGNX                          TFZGNX
     I              BBZWNX                          TFZWNX
     I              BBZVNX                          TFZVNX
     I              BBVCSX                          TFVCSX
     I              BBZQNX                          TFZQNX
     I              BBF0T1                          TFF0T1
     I              BBF1T1                          TFF1T1
     I              BBF2T1                          TFF2T1
     I              BBGUT1                          TFGUT1
     I              BBF3T1                          TFF3T1
     I              BBF4T1                          TFF4T1
     I              BBF5T1                          TFF5T1
     I              BBF6T1                          TFF6T1
     I              BBF7T1                          TFF7T1
     I              BBZENX                          TFZENX
     I              BBF8T1                          TFF8T1
     I              BBF9T1                          TFF9T1
     I              BBGAT1                          TFGAT1
     I              BBGVT1                          TFGVT1
     I              BBGBT1                          TFGBT1
     I              BBGCT1                          TFGCT1
     I              BBGDT1                          TFGDT1
     I              BBFZT1                          TFFZT1
     I              BBZRNX                          TFZRNX
     I              BBZSNX                          TFZSNX
     I              BBZTNX                          TFZTNX
     I              BBZUNX                          TFZUNX
     I              BBVBSX                          TFVBSX
     I              BBU3SX                          TFU3SX
     I              BBGET1                          TFGET1
     I              BBGFT1                          TFGFT1
     I              BBA1NY                          TFA1NY
     I              BBBKNY                          TFBKNY
     I              BBATNY                          TFATNY
     I              BBVESX                          TFVESX
     I              BBF8AA                          TFF8AA
     I              BBF9AA                          TFF9AA
     I              BBC5NY                          TFC5NY
     I              BBF5NY                          TFF5NY
     I              BBF5AA                          TFF5AA
     I              BBFRT1                          TFFRT1
     I              BBFST1                          TFFST1
     I              BBFTT1                          TFFTT1
     I              BBFUT1                          TFFUT1
     I              BBFVT1                          TFFVT1
     I              BBFWT1                          TFFWT1
     I              BBFXT1                          TFFXT1
     I              BBZLNX                          TFZLNX
     I              BBF7AA                          TFF7AA
     I              BBF6AA                          TFF6AA
     I              BBS6NA                          TFS6NA
     I              BBZDSX                          TFZDSX
     I              BBZESX                          TFZESX
     I              BBZFSX                          TFZFSX
     I              BBZGSX                          TFZGSX
     I              BBZHSX                          TFZHSX
     I              BBMXU1                          TFMXU1
     I              BBUWSX                          TFUWSX
     I              BBUXSX                          TFUXSX
     I              BBV3SX                          TFV3SX
     I              BBAHNY                          TFAHNY
     I              BBAINY                          TFAINY
     I              BBAJNY                          TFAJNY
     I              BBAKNY                          TFAKNY
      *
     IYCRDCS      DS                            861
      * Outward parameters
     IPARC        DS                             82
      * RCD : Load Order Change Log     Retrieval index
      * N :  Sequence Number
     I                                    P   9  100PADXNB
      * I :  Load ID
     I                                    P  11  140PARMNB
      * I :  Stop/Drop
     I                                    P  15  170PARVNB
      * I :  Load Change Type
     I                                       18  23 PARVST
      * I :  Department Control Code
     I                                       24  26 PAUJST
      * I :  Change Log Prior Value
     I                                       27  38 PAMNTX
      * I :  Change Log New Value
     I                                       39  50 PAMOTX
      * I :  User Id
     I                                       51  60 PAAYNA
      * I :  Job Name
     I                                       61  70 PAA0NA
      * I :  Carrier Code
     I                                       71  73 PABZNA
      * N :  Carrier Broker Carrier Co
     I                                       74  76 PAXMCD
      * I :  Company Number
     I                                    P  77  780PAAIC3
      * I :  Order Number
     I                                    P  79  820PAC4NB
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Load Detail
      * I :  Load ID
     I                                    P   1   40P1RMNB
     IP2PARM      DS
      * FLD: PFS Order Header
     IP3PARM      DS
      * FLD: Load Header
      * I :  Load Status
     I                                        1   1 P3PKST
     IP4PARM      DS
      * N :  Number Pallets Loaded
     I                                    P   1   30P4PAOU
     IP5PARM      DS
      * N :  Weight 1 USR
     I                                    P   1   62P5IVWG
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Requested Delv Date Error'
      * Requested Delivery Dt
     I                                    P   1   40ZA0001
      * Message data for 'Scheduled Ship Date Req'd'
      * Scheduled Ship Date
     I                                    P   1   40ZA0002
      * Message data for 'PrdDte Shipped BEF Made'
      * Production AgeDte Fr
     I                                    P   1   40ZA0003
      * Message data for 'Enter Age Days or Dates'
      * Item Age Days
     I                                    P   1   30ZA0004
      * Production Ovr AgeDte Fr
     I                                    P   4   70ZA0005
      * Production Ovr AgeDte To
     I                                    P   8  110ZA0006
      * Message data for 'Age OvrDate Ranage Invlid'
      * Item Age Days
     I                                    P   1   30ZA0007
      * Production Ovr AgeDte Fr
     I                                    P   4   70ZA0008
      * Production Ovr AgeDte To
     I                                    P   8  110ZA0009
      * Message data for 'Age OvrDate Ranage Invlid'
      * Item Age Days
     I                                    P   1   30ZA0010
      * Production Ovr AgeDte Fr
     I                                    P   4   70ZA0011
      * Production Ovr AgeDte To
     I                                    P   8  110ZA0012
      * Message data for 'Age OvrDate Ranage Invlid'
      * Item Age Days
     I                                    P   1   30ZA0013
      * Production Ovr AgeDte Fr
     I                                    P   4   70ZA0014
      * Production Ovr AgeDte To
     I                                    P   8  110ZA0015
      * Message data for 'Invalid Item Age Days'
      * Item Age Days
     I                                    P   1   30ZA0016
      * Message data for 'Invalid Prod OvrDates'
      * Production AgeDte Fr
     I                                    P   1   40ZA0017
      * Production AgeDte To
     I                                    P   5   80ZA0018
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1RMNB    PARM           WP0001  70       Load ID
     C           P3PKST    PARM           WP0002  1        Load Status
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * PFS Cat2 Load Info    XF
      * P00196 8/22/12 RMC Cat2 implementation at Dailys. Call for lock/u
      *    Lock - crt pfs order header/detail with Load id
      *    UnLock - crt pfs order header/detail with -0- Load id
      * ****************************
      * RTV Carrier Code       RT - Load Header  * 
     C                     EXSR SARVGN
      * PFS Cat2 Load Info    RT - Load Detail  * 
     C                     EXSR SBRVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Carrier Code       RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WARMNB           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WARMNB           Load ID
      * Establish starting position
     C           KRSSA     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWABZNA    YL0001           Carrier Code
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * PFS Cat2 Load Info    RT - Load Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  20       PFS Loading Seq
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1         WN0001           PFS Loading Seq
     C                     MOVEL'Y'       YL0003           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBRMNB    WQSB02           Load ID
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB02           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WQSB02           Load ID
      * Establish starting position
     C           KRSSB     SETLL@FLCPE8                    *
     C           KRSSB     READE@FLCPE8                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * First Time
      * CASE: LCL.First Time Flag is Yes
     C           YL0003    IFEQ 'Y'                        *IF
     C                     MOVELWBRVNB    YL0004           Stop/Drop Seque
     C                     MOVEL'N'       YL0003           First Time Flag
     C                     END                             *FI
      * CLC:  PFS Loading Sequence Number
      * CASE: LCL.Stop/Drop NE DB1.Stop/Drop
     C           YL0005    IFNE WBRVNB                     *IF
     C                     ADD  1         WN0001           PFS Loading Seq
     C                     Z-ADDWBRVNB    YL0005           Stop/Drop
     C                     END                             *FI
      * ****************************
      * Get Next PFS Sequence No         -- copied from reg carlisle lh d
     C                     EXSR UASUBR                     Get Next PFS Se
      * ****************************
     C                     Z-ADDP1RMNB    YL0007           Load ID
     C                     Z-ADDWBRVNB    YL0005           Stop/Drop
      * CASE: PAR.Load Status is Unlock
     C           P3PKST    IFEQ 'U'                        *IF
     C                     Z-ADD0         YL0007           Load ID
     C                     Z-ADD0         YL0005           Stop/Drop
     C                     Z-ADD0         YL0008           PFS Loading Seq
     C                     END                             *FI
      * **** UPDATE ORDER HEADER
      * RTV 1st WHS/PFS Act   RT - Order Detail  * 
     C                     EXSR SDRVGN
      * ** Create PFS Order Header
      * CASE: LCL.WHS Live w/Carlisle is Yes
     C           YL0010    IFEQ 'Y'                        *IF
      * PFS Order Header      RT - Order Header TRG  * 
     C                     EXSR SFRVGN
     C                     END                             *FI
      * *** CREATE LOAD ORDER CHANGE LOG ***
      * CASE: PAR.Load Status is Unlock
     C           P3PKST    IFEQ 'U'                        *IF
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPARC
     C                     Z-ADDWBRMNB    PARMNB           Load ID
     C                     Z-ADDWBRVNB    PARVNB           Stop/Drop
     C                     MOVEL'SNDUNL'  PARVST    P      Load Change Typ
     C                     MOVEL'INT'     PAUJST    P      Department Cont
     C                     MOVEL*BLANK    PAMNTX    P      Change Log Prio
     C                     MOVEL*BLANK    PAMOTX    P      Change Log New
     C                     MOVEL##USR     PAAYNA    P      User Id
     C                     MOVEL##JOB     PAA0NA    P      Job Name
     C                     MOVELYL0001    PABZNA    P      Carrier Code
     C                     Z-ADDWBAIC3    PAAIC3           Company Number
     C                     Z-ADDWBC4NB    PAC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPARC
     C                     Z-ADDWBRMNB    PARMNB           Load ID
     C                     Z-ADDWBRVNB    PARVNB           Stop/Drop
     C                     MOVEL'SNDPFS'  PARVST    P      Load Change Typ
     C                     MOVEL'INT'     PAUJST    P      Department Cont
     C                     MOVEL*BLANK    PAMNTX    P      Change Log Prio
     C                     MOVEL*BLANK    PAMOTX    P      Change Log New
     C                     MOVEL##USR     PAAYNA    P      User Id
     C                     MOVEL##JOB     PAA0NA    P      Job Name
     C                     MOVELYL0001    PABZNA    P      Carrier Code
     C                     Z-ADDWBAIC3    PAAIC3           Company Number
     C                     Z-ADDWBC4NB    PAC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C           KRSSB     READE@FLCPE8                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Numeric Value      RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCV8CD           Company Value C
      * Setup key
     C                     Z-ADDWBAIC3    WCAIC3           Company Number
     C                     MOVEL@CN,001   WCV8CD           Company Value C
      * Establish starting position
     C           KRSSC     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCM8NB    YL0006           System Value Nu
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV 1st WHS/PFS Act   RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSD01           Company Number
     C           *LIKE     DEFN WDC4NB    WQSD02           Order Number
      * Define keylist
     C           KPSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Order Number
     C                     KFLD           WDDPNB           Order Sequence
     C                     KFLD           WDUENB           Order Secondary
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Order Number
      * Setup key
     C                     Z-ADDWBAIC3    WQSD01           Company Number
     C                     Z-ADDWBC4NB    WQSD02           Order Number
     C                     Z-ADD0         WDDPNB           Order Sequence
     C                     Z-ADD0         WDUENB           Order Secondary
      * Establish starting position
     C           KPSSD     SETLL@BGWKAE                    *
     C           KRSSD     READE@BGWKAE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0009           Warehouse Code
     C                     MOVEL*BLANK    YL0010           WHS Live w/Carl
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * 10/20/06 PKD Changed to use the WHS PFS LD/ORD Interface
      * Rtv Live w/CT PFS Int RT - Warehouse  * 
     C                     EXSR SERVGN
     C                     MOVEL'N'       YL0010           WHS Live w/Carl
      * CASE: LCL.WHS Live w/Carlisle is Yes
     C           YL0011    IFEQ 'Y'                        *IF
      * CASE: LCL.WHS PFS Interface is Download/Both
     C           YL0012    IFEQ 'D'                        *IF
     C           YL0012    OREQ 'B'
     C                     MOVEL'Y'       YL0010           WHS Live w/Carl
     C                     END                             *FI
     C                     END                             *FI
      * PAR = DB1 By name
     C                     MOVELWDAJCD    YL0009           Warehouse Code
     C                     GOTO SDEXIT                     *QUIT
     C           KRSSD     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Live w/CT PFS Int RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WEAJCD           Warehouse Code
      * Setup key
     C                     MOVELWDAJCD    WEAJCD           Warehouse Code
      * Establish starting position
     C           KRSSE     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0011           WHS Live w/Carl
     C                     MOVEL*BLANK    YL0012           WHS PFS Interfa
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWERRSX    YL0011           WHS Live w/Carl
     C                     MOVELWERSSX    YL0012           WHS PFS Interfa
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * PFS Order Header      RT - Order Header TRG  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0002  30       PFS Company Num
     C                     Z-ADD*ZERO     WN0003  70       PFS Order Numbe
     C                     Z-ADD*ZERO     WN0004  70       PFS Load ID
     C                     Z-ADD*ZERO     WN0005  20       PFS Load Stop N
     C                     MOVEL*BLANK    WN0006  2        PFS Order Type
     C                     Z-ADD*ZERO     WN0007  70       PFS Ship To Cus
     C                     MOVEL*BLANK    WN0008 30        PFS Ship To Cus
     C                     MOVEL*BLANK    WN0009 30        PFS Ship To Cus
     C                     MOVEL*BLANK    WN0010 30        PFS Ship To Cus
     C                     MOVEL*BLANK    WN0011 30        PFS Ship To Cus
     C                     MOVEL*BLANK    WN0012 20        PFS Ship To Cus
     C                     MOVEL*BLANK    WN0013  2        PFS Ship To Cus
     C                     MOVEL*BLANK    WN0014 11        PFS Ship To Cus
     C                     MOVEL*BLANK    WN0015 50        PFS Ship To Ema
     C                     MOVEL*BLANK    WN0016 25        PFS Ship To Pho
     C                     Z-ADD*ZERO     WN0017  70       PFS Bill To Cus
     C                     MOVEL*BLANK    WN0018 30        PFS Bill To Cus
     C                     MOVEL*BLANK    WN0019 30        PFS Bill To Cus
     C                     MOVEL*BLANK    WN0020 30        PFS Bill To Cus
     C                     MOVEL*BLANK    WN0021 30        PFS Bill To Cus
     C                     MOVEL*BLANK    WN0022 20        PFS Bill To Cus
     C                     MOVEL*BLANK    WN0023  2        PFS Bill To Cus
     C                     MOVEL*BLANK    WN0024 11        PFS Bill To Cus
     C                     MOVEL*BLANK    WN0025 15        PFS Customer PO
     C                     Z-ADD*ZERO     WN0026  80       PFS Order Date
     C                     Z-ADD*ZERO     WN0027  80       PFS Scheduled S
     C                     Z-ADD*ZERO     WN0028  80       PFS Requested D
     C                     Z-ADD*ZERO     WN0029  60       PFS Requested D
     C                     MOVEL*BLANK    WN0030  1        PFS Export Stat
     C                     MOVEL*BLANK    WN0031  6        PFS Country Cod
     C                     MOVEL*BLANK    WN0032 40        PFS Special Ins
     C                     MOVEL*BLANK    WN0033 40        PFS Special Ins
     C                     Z-ADD*ZERO     WN0034  70       PFS Maximum Gro
     C                     Z-ADD*ZERO     WN0035  50       PFS Estimated P
     C                     Z-ADD*ZERO     WN0036  52       PFS Average Pal
     C                     MOVEL*BLANK    WN0037  1        PFS Order Statu
     C                     MOVEL*BLANK    WN0038  3        PFS Ship From W
     C                     MOVEL*BLANK    WN0039  3        PFS Ship To War
     C                     Z-ADD*ZERO     WN0040  50       PFS Order Detai
     C                     MOVEL*BLANK    WN0041  3        PFS Shipping Li
     C                     MOVEL*BLANK    WN0042 30        PFS Shipping Li
     C                     MOVEL*BLANK    WN0043 30        PFS Shipping Li
     C                     MOVEL*BLANK    WN0044 30        PFS Shipping Li
     C                     MOVEL*BLANK    WN0045 20        PFS Shipping Li
     C                     MOVEL*BLANK    WN0046  2        PFS Shipping Li
     C                     MOVEL*BLANK    WN0047 11        PFS Shipping LI
     C                     MOVEL*BLANK    WN0048 30        PFS Vessel Name
     C                     MOVEL*BLANK    WN0049 15        PFS Voyage
     C                     MOVEL*BLANK    WN0050 20        PFS Discharge P
     C                     MOVEL*BLANK    WN0051 15        PFS Booking Num
     C                     MOVEL*BLANK    WN0052 15        PFS Delivery P.
     C                     MOVEL*BLANK    WN0053  1        PFS Order Unuse
     C                     MOVEL*BLANK    WN0054  1        PFS Order Unuse
     C                     MOVEL*BLANK    WN0055  1        PFS Order Unuse
     C                     MOVEL*BLANK    WN0056  2        PFS Order Unuse
     C                     MOVEL*BLANK    WN0057  2        PFS Order Unuse
     C                     MOVEL*BLANK    WN0058 15        PFS Order Unuse
     C                     MOVEL*BLANK    WN0059  1        PFS Record Stat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFC4NB           Order Number
      * Setup key
     C                     Z-ADDWBAIC3    WFAIC3           Company Number
     C                     Z-ADDWBC4NB    WFC4NB           Order Number
      * Establish starting position
     C           KRSSF     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * FP1309 Inventory Age  IF
      * FP1309 Inventory Age Code Description
      * ** CREATE ORDER DETAIL
      * PFS Order Detail      RT - Order Detail  * 
     C                     EXSR SGRVGN
      * ** E0657 RMC 4/05/2010   UPDATE ORDER BOL Comment from Country co
      * **   Was outputting shipping instructions prior to 4/05/10 - but
      * **   Werent picked up by carisle in ppu1upc - file was commented
      * RTV OHE Intend for Exp RT - Order Header Extension  * 
     C                     EXSR SRRVGN
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
     C                     EXSR SSRVGN
      * For Daily CAT = put all comments in Order Comments
      * CASE: LCL.Company Organization is Daily's
     C           YL0023    IFEQ 'D'                        *IF
      * Rtv Del Ord Comment   RT - PFS Order BOL Comment  * delete all fo
     C                     EXSR STRVGN
      * CASE: PAR.Load Status is Lock
     C           P3PKST    IFEQ 'L'                        *IF
      * RTV PFS Ord Comment   RT - Order Comment  * 
     C                     EXSR SVRVGN
      * RTV Country Code only  RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWFAIC3    WL0014           Company Number
     C                     Z-ADDWFC4NB    WL0015           Order Number
     C                     EXSR TARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0016    YL0025    P      Country Code
      * CASE: LCL.OHE Intended for ExportCC is Entered
     C           YL0021    IFNE *BLANK                     *IF
      * Rtv PFS BL Cmnt f/CAT RT - Country Comment  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0021    WL0017    P      Country Code
     C                     MOVEL'BI'      WL0018    P      Comment Type
     C                     Z-ADDWFAIC3    WL0019           Company Number
     C                     Z-ADDWFC4NB    WL0020           Order Number
     C                     MOVELP3PKST    WL0021    P      Load Status
     C                     EXSR TBRVGN
     C                     ELSE
      * CASE: LCL.Country Code is Entered
     C           YL0025    IFNE *BLANK                     *IF
      * Rtv PFS BL Cmnt f/CAT RT - Country Comment  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0025    WL0017    P      Country Code
     C                     MOVEL'BL'      WL0018    P      Comment Type
     C                     Z-ADDWFAIC3    WL0019           Company Number
     C                     Z-ADDWFC4NB    WL0020           Order Number
     C                     MOVELP3PKST    WL0021    P      Load Status
     C                     EXSR TBRVGN
     C                     END                             *FI
     C                     END                             *FI
      * PFS Cust Comment Tp BL RT - Customer Comment  * 
     C                     EXSR TCRVGN
     C                     END                             *FI
     C                     END                             *FI
      * Not Dailys output these comments -  orig code before p000196
      * CASE: LCL.Company Organization is Not Daily's
     C           YL0023    IFEQ 'H'                        *IF
     C           YL0023    OREQ 'S'
      * RTV Country Code only  RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWFAIC3    WL0014           Company Number
     C                     Z-ADDWFC4NB    WL0015           Order Number
     C                     EXSR TARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0016    YL0025    P      Country Code
      * CASE: LCL.OHE Intended for ExportCC is Entered
     C           YL0021    IFNE *BLANK                     *IF
      * Rtv Crt PFS BOL CommntRT - Country Comment  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0021    WL0022    P      Country Code
     C                     MOVEL'BI'      WL0023    P      Comment Type
     C                     Z-ADDWFAIC3    WL0024           Company Number
     C                     Z-ADDWFC4NB    WL0025           Order Number
     C                     MOVELP3PKST    WL0026    P      Load Status
     C                     EXSR TDRVGN
     C                     ELSE
      * CASE: LCL.Country Code is Entered
     C           YL0025    IFNE *BLANK                     *IF
      * Rtv Crt PFS BOL CommntRT - Country Comment  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0025    WL0022    P      Country Code
     C                     MOVEL'BL'      WL0023    P      Comment Type
     C                     Z-ADDWFAIC3    WL0024           Company Number
     C                     Z-ADDWFC4NB    WL0025           Order Number
     C                     MOVELP3PKST    WL0026    P      Load Status
     C                     EXSR TDRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ** PFS Order Header now includes the export shipping instructions
      * ** CREATE ORDER HEADER
     C                     EXSR UCSUBR                     ** CREATE ORDER
      * ** Accumulate Number of Pallets Loaded & Total Pallet Weight **
     C                     ADD  YL0013    P4PAOU           Number Pallets
     C                     ADD  YL0014    P5IVWG           Weight 1 USR
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * PFS Order Detail      RT - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0060  30       PFS Company Num
     C                     Z-ADD*ZERO     WN0061  70       PFS Order Numbe
     C                     Z-ADD*ZERO     WN0062  30       PFS Order Line
     C                     Z-ADD*ZERO     WN0063  30       PFS Substitutio
     C                     Z-ADD*ZERO     WN0064  70       PFS Item Code
     C                     MOVEL*BLANK    WN0065 14        PFS Customer It
     C                     MOVEL*BLANK    WN0066 30        PFS Item Descri
     C                     MOVEL*BLANK    WN0067 30        PFS Item Descri
     C                     MOVEL*BLANK    WN0068  1        PFS Age Code
     C                     MOVEL*BLANK    WN0069  1        PFS Slip Sheet
     C                     MOVEL*BLANK    WN0070  1        PFS Shrink Wrap
     C                     MOVEL*BLANK    WN0071  1        PFS Palletize
     C                     MOVEL*BLANK    WN0072  3        PFS Ship From W
     C                     MOVEL*BLANK    WN0073  2        PFS Ship From W
     C                     MOVEL*BLANK    WN0074  3        PFS Ship To War
     C                     Z-ADD*ZERO     WN0075  70       PFS Scheduled Q
     C                     Z-ADD*ZERO     WN0076  82       PFS Scheduled W
     C                     Z-ADD*ZERO     WN0077  82       PFS Maximum Net
     C                     Z-ADD*ZERO     WN0078  82       PFS Minimum Uni
     C                     Z-ADD*ZERO     WN0079  82       PFS Maximum Uni
     C                     Z-ADD*ZERO     WN0080  50       PFS Estimated P
     C                     Z-ADD*ZERO     WN0081  52       PFS Average Pal
     C                     Z-ADD*ZERO     WN0082  80       PFS Oldest Date
     C                     Z-ADD*ZERO     WN0083  80       PFS Newest Date
     C                     MOVEL*BLANK    WN0084  1        PFS Ord Dtl Unu
     C                     MOVEL*BLANK    WN0085  1        PFS Ord Dtl Unu
     C                     MOVEL*BLANK    WN0086  1        PFS Ord Dtl Unu
     C                     MOVEL*BLANK    WN0087  2        PFS Pallet Type
     C                     MOVEL*BLANK    WN0088  2        PFS Ord Dtl Unu
     C                     MOVEL*BLANK    WN0089  1        PFS Record Stat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * RMC 12/19/17 output par.pfs pallet type
      * RMC R5207 02/16/16 DLY - output sched ship date-1prod date for ne
      * RMC 03/13/07 output par.sequence no.
      * FP1309 Inventory Age  IF
      * FP1309 Inventory Age Code Description
     C                     Z-ADD0         YL0013           Number Pallets
     C                     Z-ADD0         YL0014           Weight 1 USR
     C                     Z-ADD0         WN0040           PFS Order Detai
      * Rtv Plant Co/Org      XF - Company Defaults Internal  * 
     C                     CALL 'PMOVXFR'              90  Rtv Plant Co/Or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WFAIC3    WQ0004  30       Company Number
     C           WUYISX    PARM *BLANK    WQ0005  1        Plant Company S
     C           WUYJSX    PARM *BLANK    WQ0006  1        Company Organiz
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMOVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGAIC3    WQSG01           Company Number
     C           *LIKE     DEFN WGC4NB    WQSG02           Order Number
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Order Number
      * Setup key
     C                     Z-ADDWFAIC3    WQSG01           Company Number
     C                     Z-ADDWFC4NB    WQSG02           Order Number
      * Establish starting position
     C           KRSSG     SETLL@BGWKL1                    *
     C           KRSSG     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * fp1309 calculate the date for the newest and oldest
     C                     Z-ADDWGAIC3    WN0060           PFS Company Num
     C                     Z-ADDWGC4NB    WN0061           PFS Order Numbe
     C                     Z-ADDWGDPNB    WN0062           PFS Order Line
     C                     Z-ADDWGBXTM    WN0063           PFS Substitutio
      * RTV Item Ref Sts      RT - Customer  * 
     C                     EXSR SHRVGN
     C                     Z-ADDWGHGCD    WN0064           PFS Item Code
      * CASE: LCL.Item Reference Status is Both
     C           YL0015    IFEQ 'B'                        *IF
      * Rtv Cust Item Ref     RT - Customer Item Reference  * 
     C                     EXSR SIRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WN0065           PFS Customer It
     C                     END                             *FI
     C                     MOVELWGG7NA    WN0066           PFS Item Descri
     C                     MOVELWGG8NA    WN0067           PFS Item Descri
     C                     MOVELWGVGST    WN0069           PFS Slip Sheet
     C                     MOVELWFVFST    WN0070           PFS Shrink Wrap
     C                     MOVELWGVEST    WN0071           PFS Palletize
     C                     MOVELWGF5SX    WN0087           PFS Pallet Type
     C                     MOVELWGAJCD    WN0072           PFS Ship From W
      * CASE: PAR.PFS Ship From Warehouse is CFH
     C           WN0072    IFEQ 'CFH'                      *IF
     C                     MOVEL'CF1'     WN0072           PFS Ship From W
     C                     END                             *FI
      * RTV Warehouse Type     RT - Warehouse  * 
     C                     EXSR SJRVGN
      * PFS Ship To Warehouse
      * CASE: PAR.Order Type - Sales is Transfer Order
     C           WFJNCD    IFEQ 'TR'                       *IF
      * Rtv Default Warehouse  RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWGAIC3    WL0001           Company Number
     C                     Z-ADDWGBKC7    WL0002           Ship To Custome
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    WN0074    P      Warehouse Code
     C                     END                             *FI
      * FP1309 Calculate Oldest Allowed & Newest Allowed Dates
     C                     EXSR UBSUBR                     FP1309 Calculat
      * RMC 10/14/13 E2824 Output Ordered a lieu sched - because sched ch
      *   unless User Release is Yes, then they want to short ship the sc
      * CASE: DB1.Released by User Sts Y/N is yes
     C           WGF3SX    IFEQ 'Y'                        *IF
     C                     Z-ADDWGCCQT    WN0075           PFS Scheduled Q
     C                     Z-ADDWGAUWG    WN0076           PFS Scheduled W
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWGAVQT    WN0075           PFS Scheduled Q
     C                     Z-ADDWGD0WG    WN0076           PFS Scheduled W
     C                     END                             *FI
     C                     Z-ADDWGBWTM    WN0077           PFS Maximum Net
      * PFS Estimated Pallets, PFS Average Pallet Tare
      * CASE: PAR.Palletize is yes
     C           WFVEST    IFEQ 'Y'                        *IF
      * Rtv Pallet Tare/Cases RT - Item Bill Of Material  * 
     C                     EXSR SMRVGN
      * CASE: LCL.Number Cases On A Pallet is GT Zero
     C           YL0019    IFGT 0                          *IF
      * PFS Estimated Pallets
      * PAR.PFS Estimated Pallets =
      *    *COMPUTE ((x1 / x2))
      * x1    : DB1.Quantity Ordered
      * /     : PGM.*Synon (15,0) work field *
      * x2    : LCL.Number Cases On A Pallet
     C           WGAVQT    DIV  YL0019    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0080           PFS Estimated P
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD0         WN0080           PFS Estimated P
     C                     END                             *FI
      * CASE: PAR.PFS Estimated Pallets is GT Zero
     C           WN0080    IFGT 0                          *IF
     C                     Z-ADDYL0020    WN0081           PFS Average Pal
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD0         WN0080           PFS Estimated P
     C                     Z-ADD0         WN0081           PFS Average Pal
     C                     END                             *FI
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Detail Line Status is Cancelled
      *   |- c2    : PAR.Load Status is Unlock
      *   '-
     C           WGGMST    IFEQ 'X'                        *IF
     C           P3PKST    OREQ 'U'                        *OR
     C                     MOVEL'D'       WN0089           PFS Record Stat
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'C'       WN0089           PFS Record Stat
     C                     END                             *FI
      * Upd Order Detail      RT - PFS Order Detail  * 
     C                     EXSR SORVGN
      * ** Accumulate Number of Pallets & Total Pallet Weight **
     C                     ADD  WN0080    YL0013           Number Pallets
      * PAR.Weight 1 USR
      * PAR.Weight 1 USR =
      *    *COMPUTE ((x3 + (x1 * x2)))
      * x3    : PAR.Weight 1 USR
      * +     : PGM.*Synon (15,2) work field
      * x1    : PAR.PFS Average Pallet Tare
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PFS Estimated Pallets
     C           WN0081    MULT WN0080    W0WA01           *Synon (15,2) w
     C           YL0014    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0014           Weight 1 USR
     C                     ADD  1         WN0040           PFS Order Detai
     C           KRSSG     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Item Ref Sts      RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WHBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWGBKC7    WHBKC7           Ship To Custome
      * Establish starting position
     C           KRSSH     CHAIN@BBREE9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0015           Item Reference
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHQYST    YL0015           Item Reference
     C                     GOTO SHEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Cust Item Ref     RT - Customer Item Reference  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WIBKC7           Ship To Custome
     C                     KFLD           WIHGCD           Item Code
      * Setup key
     C                     Z-ADDWGBKC7    WIBKC7           Ship To Custome
     C                     Z-ADDWGHGCD    WIHGCD           Item Code
      * Establish starting position
     C           KRSSI     CHAIN@BIREKY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3081' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0065           CIR Resource No
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWICOAA    WN0065           CIR Resource No
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Warehouse Type     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WEAJCD           Warehouse Code
      * Setup key
     C                     MOVELWN0072    WEAJCD           Warehouse Code
      * Establish starting position
     C           KRSSJ     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0073           Warehouse Type
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEWPST    WN0073           Warehouse Type
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Default Warehouse  RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0001    WJAIC3           Company Number
     C                     Z-ADDWL0002    WJBKC7           Ship To Custome
      * Establish starting position
     C           KRSSK     CHAIN@EOREXM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0003           Warehouse Code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWJAJCD    WL0003           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Prev Prd Dte      RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKAIC3    WQSL01           Company Number
      * Define keylist
     C           KPSSL     KLIST
     C                     KFLD           WQSL01           Company Number
     C                     KFLD           WKBCDT           Post to G/L Dat
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Company Number
      * Setup key
     C                     Z-ADDWGAIC3    WQSL01           Company Number
     C                     Z-ADDWGAODT    WKBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSL     SETLL@AFREPU                    *
     C           KRSSL     READE@AFREPU                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Plant Date of Last Order EQ PAR.Plant Date of Last Orde
     C           WKBCDT    IFEQ WGAODT                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.Production Day Status is yes
     C           WKWAST    IFEQ 'Y'                        *IF
     C                     Z-ADDWKBCDT    YL0017           Production Date
     C                     GOTO SLEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSL     READE@AFREPU                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Pallet Tare/Cases RT - Item Bill Of Material  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLAIC3    WQSM01           Company Number
     C           *LIKE     DEFN WLHGCD    WQSM02           Item Code
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           Item Code
      * Setup key
     C                     Z-ADDWGAIC3    WQSM01           Company Number
     C                     Z-ADDWGHGCD    WQSM02           Item Code
      * Establish starting position
     C           KRSSM     SETLL@IORETI                    *
     C           KRSSM     READE@IORETI                  90*
      * Data record not found
     C   90                MOVEL'USR1679' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.BOM Type is Supplies
     C           WLV2ST    IFEQ 'S'                        *IF
      * Rtv Pallet Tare/Cases RT - Company/Item  * 
     C                     EXSR SNRVGN
     C                     GOTO SMEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSM     READE@IORETI                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Pallet Tare/Cases RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WMAIC3           Company Number
     C                     KFLD           WMHGCD           Item Code
      * Setup key
     C                     Z-ADDWLAIC3    WMAIC3           Company Number
     C                     Z-ADDWLC9NB    WMHGCD           Item Code
      * Establish starting position
     C           KRSSN     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWMURTN    YL0019           Number Cases On
     C                     Z-ADDWMSFNB    YL0020           Pallet Tare Wei
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Upd Order Detail      RT - PFS Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0090  10       PFS Process Sta
     C                     MOVEL*BLANK    WN0091  6        PFS Error Reaso
     C                     Z-ADD*ZERO     WN0092  80       PFS Create Date
     C                     Z-ADD*ZERO     WN0093  60       PFS Create Time
     C                     Z-ADD*ZERO     WN0094  80       PFS Change Date
     C                     Z-ADD*ZERO     WN0095  60       PFS Change time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WOY1NX           PFS Company Num
     C                     KFLD           WOZPNX           PFS Order Numbe
     C                     KFLD           WOZXNX           PFS Order Line
     C                     KFLD           WOZYNX           PFS Substitutio
      * Setup key
     C                     Z-ADDWN0060    WOY1NX           PFS Company Num
     C                     Z-ADDWN0061    WOZPNX           PFS Order Numbe
     C                     Z-ADDWN0062    WOZXNX           PFS Order Line
     C                     Z-ADDWN0063    WOZYNX           PFS Substitutio
      * Establish starting position
     C           KRSSO     CHAIN@BCCPZP              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3488' W0RTN   7
      * USER: Processing if Data record not found
      * Crt PFS Order Detail  CR - PFS Order Detail  * 
     C                     EXSR SPCRRC
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg PFS Order Detail  CH - PFS Order Detail  * 
     C                     EXSR SQCHRC
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPCRRC    BEGSR
      *================================================================
      * Crt PFS Order Detail  CR - PFS Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BCCPZO
     C                     Z-ADDWN0060    WRY1NX           PFS Company Num
     C                     Z-ADDWN0061    WRZPNX           PFS Order Numbe
     C                     Z-ADDWN0062    WRZXNX           PFS Order Line
     C                     Z-ADDWN0063    WRZYNX           PFS Substitutio
     C                     Z-ADDWN0064    WRY2NX           PFS Item Code
     C                     MOVELWN0065    WRGIT1           PFS Customer It
     C                     MOVELWN0066    WRGGT1           PFS Item Descri
     C                     MOVELWN0067    WRGHT1           PFS Item Descri
     C                     MOVELWN0068    WRVFSX           PFS Age Code
     C                     MOVELWN0069    WRVGSX           PFS Slip Sheet
     C                     MOVELWN0070    WRVHSX           PFS Shrink Wrap
     C                     MOVELWN0071    WRVISX           PFS Palletize
     C                     MOVELWN0072    WRF8AA           PFS Ship From W
     C                     MOVELWN0073    WRV4SX           PFS Ship From W
     C                     MOVELWN0074    WRF9AA           PFS Ship To War
     C                     Z-ADDWN0075    WRZFNX           PFS Scheduled Q
     C                     Z-ADDWN0076    WRZZNX           PFS Scheduled W
     C                     Z-ADDWN0077    WRZ0NX           PFS Maximum Net
     C                     Z-ADDWN0078    WRBINY           PFS Minimum Uni
     C                     Z-ADDWN0079    WRBJNY           PFS Maximum Uni
     C                     Z-ADDWN0080    WRBKNY           PFS Estimated P
     C                     Z-ADDWN0081    WRATNY           PFS Average Pal
     C                     Z-ADDWN0082    WRALD8           PFS Oldest Date
     C                     Z-ADDWN0083    WRAMD8           PFS Newest Date
     C                     Z-ADDYL0006    WRF5NY           PFS Sequence No
     C                     MOVELWN0084    WRZISX           PFS Ord Dtl Unu
     C                     MOVELWN0085    WRZJSX           PFS Ord Dtl Unu
     C                     MOVELWN0086    WRZKSX           PFS Ord Dtl Unu
     C                     MOVELWN0087    WRZLSX           PFS Pallet Type
     C                     MOVELWN0088    WRZMSX           PFS Ord Dtl Unu
     C                     MOVELWN0089    WRUWSX           PFS Record Stat
     C                     Z-ADDWN0090    WRUXSX           PFS Process Sta
     C                     MOVELWN0091    WRV3SX           PFS Error Reaso
     C                     Z-ADDWN0092    WRAHNY           PFS Create Date
     C                     Z-ADDWN0093    WRAINY           PFS Create Time
     C                     Z-ADDWN0094    WRAJNY           PFS Change Date
     C                     Z-ADDWN0095    WRAKNY           PFS Change time
      *
      * USER: Processing before Data update
      * Set Create Stamp      IF
     C                     Z-ADD0         WRUXSX           PFS Process Sta
     C                     Z-ADD##JDT     WRAHNY           PFS Create Date
     C                     Z-ADD##JTM     WRAINY           PFS Create Time
     C           KLCRSP    KLIST
     C                     KFLD           WRY1NX           PFS Company Num
     C                     KFLD           WRZPNX           PFS Order Numbe
     C                     KFLD           WRZXNX           PFS Order Line
     C                     KFLD           WRZYNX           PFS Substitutio
      * Check for duplicate primary key
     C           KLCRSP    SETLL@BCCPZO                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3489' W0RTN   7
      * Send message 'PFS Order Detail       EX'
     C                     MOVEL'USR3489' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C                     WRITE@BCCPZO                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQCHRC    BEGSR
      *================================================================
      * Chg PFS Order Detail  CH - PFS Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0096  10       PFS Process Sta
     C                     MOVEL*BLANK    WN0097  6        PFS Error Reaso
     C                     Z-ADD*ZERO     WN0098  80       PFS Create Date
     C                     Z-ADD*ZERO     WN0099  60       PFS Create Time
     C                     Z-ADD*ZERO     WN0100  80       PFS Change Date
     C                     Z-ADD*ZERO     WN0101  60       PFS Change time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BCCPZO
     C                     Z-ADDWN0060    WRY1NX           PFS Company Num
     C                     Z-ADDWN0061    WRZPNX           PFS Order Numbe
     C                     Z-ADDWN0062    WRZXNX           PFS Order Line
     C                     Z-ADDWN0063    WRZYNX           PFS Substitutio
      *
     C           KLCHSQ    KLIST
     C                     KFLD           WRY1NX           PFS Company Num
     C                     KFLD           WRZPNX           PFS Order Numbe
     C                     KFLD           WRZXNX           PFS Order Line
     C                     KFLD           WRZYNX           PFS Substitutio
     C           KLCHSQ    CHAIN@BCCPZO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PPBCCPL0'MDACP
     C                     MOVEL'@BCCPZO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SQEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPPBC1    YARDCS
      * Move non-key fields to @BCCPZO
     C                     Z-ADDWN0064    WRY2NX           PFS Item Code
     C                     MOVELWN0065    WRGIT1    P      PFS Customer It
     C                     MOVELWN0066    WRGGT1    P      PFS Item Descri
     C                     MOVELWN0067    WRGHT1    P      PFS Item Descri
     C                     MOVELWN0068    WRVFSX    P      PFS Age Code
     C                     MOVELWN0069    WRVGSX    P      PFS Slip Sheet
     C                     MOVELWN0070    WRVHSX    P      PFS Shrink Wrap
     C                     MOVELWN0071    WRVISX    P      PFS Palletize
     C                     MOVELWN0072    WRF8AA    P      PFS Ship From W
     C                     MOVELWN0073    WRV4SX    P      PFS Ship From W
     C                     MOVELWN0074    WRF9AA    P      PFS Ship To War
     C                     Z-ADDWN0075    WRZFNX           PFS Scheduled Q
     C                     Z-ADDWN0076    WRZZNX           PFS Scheduled W
     C                     Z-ADDWN0077    WRZ0NX           PFS Maximum Net
     C                     Z-ADDWN0078    WRBINY           PFS Minimum Uni
     C                     Z-ADDWN0079    WRBJNY           PFS Maximum Uni
     C                     Z-ADDWN0080    WRBKNY           PFS Estimated P
     C                     Z-ADDWN0081    WRATNY           PFS Average Pal
     C                     Z-ADDWN0082    WRALD8           PFS Oldest Date
     C                     Z-ADDWN0083    WRAMD8           PFS Newest Date
     C                     Z-ADDYL0006    WRF5NY           PFS Sequence No
     C                     MOVELWN0084    WRZISX    P      PFS Ord Dtl Unu
     C                     MOVELWN0085    WRZJSX    P      PFS Ord Dtl Unu
     C                     MOVELWN0086    WRZKSX    P      PFS Ord Dtl Unu
     C                     MOVELWN0087    WRZLSX    P      PFS Pallet Type
     C                     MOVELWN0088    WRZMSX    P      PFS Ord Dtl Unu
     C                     MOVELWN0089    WRUWSX    P      PFS Record Stat
      *
      * Set PGM.*Record Data Changed flag
     C           QPPBC1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Change Stamp      IF
     C                     Z-ADD##JDT     WRAJNY           PFS Change Date
     C                     Z-ADD##JTM     WRAKNY           PFS Change time
      * Set PGM.*Record Data Changed flag
     C           QPPBC1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BCCPZO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPPBCCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV OHE Intend for Exp RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WSAIC3           Company Number
     C                     KFLD           WSC4NB           Order Number
      * Setup key
     C                     Z-ADDWFAIC3    WSAIC3           Company Number
     C                     Z-ADDWFC4NB    WSC4NB           Order Number
      * Establish starting position
     C           KRSSR     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWSLWAA    YL0021           OHE Intended fo
     C                     GOTO SREXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WTAIC3           Company Number
      * Setup key
     C                     Z-ADDWFAIC3    WTAIC3           Company Number
      * Establish starting position
     C           KRSSS     CHAIN@JYRECE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2025' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0022           Plant Company S
     C                     MOVEL*BLANK    YL0023           Company Organiz
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWTYISX    YL0022           Plant Company S
     C                     MOVELWTYJSX    YL0023           Company Organiz
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Rtv Del Ord Comment   RT - PFS Order BOL Comment  * delete all f
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WVY1NX    WQST01           PFS Company Num
     C           *LIKE     DEFN WVZPNX    WQST02           PFS Order Numbe
     C           *LIKE     DEFN WVIZST    WQST03           PFS BOL Comment
      * Define keylist
     C           KPSST     KLIST
     C                     KFLD           WQST01           PFS Company Num
     C                     KFLD           WQST02           PFS Order Numbe
     C                     KFLD           WQST03           PFS BOL Comment
     C                     KFLD           WVZ1NX           PFS Sequence Nu
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST01           PFS Company Num
     C                     KFLD           WQST02           PFS Order Numbe
     C                     KFLD           WQST03           PFS BOL Comment
      * Setup key
     C                     Z-ADDWFAIC3    WQST01           PFS Company Num
     C                     Z-ADDWFC4NB    WQST02           PFS Order Numbe
     C                     MOVEL'BL'      WQST03           PFS BOL Comment
     C                     Z-ADD0         WVZ1NX           PFS Sequence Nu
      * Establish starting position
     C           KPSST     SETLL@BDCPAB                    *
     C           KRSST     READE@BDCPAB                  90*
      * Data record not found
     C   90                MOVEL'USR3490' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del PFS BOL Comment   DL - PFS Order BOL Comment  * 
     C                     EXSR SUDLRC
     C           KRSST     READE@BDCPAB                  90*
     C                     ENDDO
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUDLRC    BEGSR
      *================================================================
      * Del PFS BOL Comment   DL - PFS Order BOL Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @BDCPAA
     C                     Z-ADDWVY1NX    WWY1NX           PFS Company Num
     C                     Z-ADDWVZPNX    WWZPNX           PFS Order Numbe
     C                     MOVELWVIZST    WWIZST           PFS BOL Comment
     C                     Z-ADDWVZ1NX    WWZ1NX           PFS Sequence Nu
      *
     C           KLDLSU    KLIST
     C                     KFLD           WWY1NX           PFS Company Num
     C                     KFLD           WWZPNX           PFS Order Numbe
     C                     KFLD           WWIZST           PFS BOL Comment
     C                     KFLD           WWZ1NX           PFS Sequence Nu
     C           KLDLSU    CHAIN@BDCPAA              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PPBDCPL0'MDACP
     C                     MOVEL'@BDCPAA' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@BDCPAA                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * RTV PFS Ord Comment   RT - Order Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WXAIC3    WQSV01           Company Number
     C           *LIKE     DEFN WXC4NB    WQSV02           Order Number
     C           *LIKE     DEFN WXI1SX    WQSV03           Comment Type
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV01           Company Number
     C                     KFLD           WQSV02           Order Number
     C                     KFLD           WQSV03           Comment Type
      * Setup key
     C                     Z-ADDWFAIC3    WQSV01           Company Number
     C                     Z-ADDWFC4NB    WQSV02           Order Number
     C                     MOVEL'BL'      WQSV03           Comment Type
      * Establish starting position
     C           KRSSV     SETLL@COCPNU                    *
     C           KRSSV     READE@COCPNU                  90*
      * Data record not found
     C   90                MOVEL'USR0486' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Last Seq for Order - PFS Order BOL Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWXAIC3    WL0004           PFS Company Num
     C                     Z-ADDWXC4NB    WL0005           PFS Order Numbe
     C                     MOVELWXI1SX    WL0006    P      PFS BOL Comment
     C                     Z-ADDYL0024    WL0007           PFS Sequence Nu
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0007    YL0024           PFS Sequence Nu
     C                     ADD  1         YL0024           PFS Sequence Nu
      * Upd PFS BOL Comment   RT - PFS Order BOL Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWXAIC3    WL0008           PFS Company Num
     C                     Z-ADDWXC4NB    WL0009           PFS Order Numbe
     C                     MOVELWXI1SX    WL0010    P      PFS BOL Comment
     C                     Z-ADDYL0024    WL0011           PFS Sequence Nu
     C                     MOVELWXG4NA    WL0012    P      PFS BOL Comment
     C                     MOVEL'A'       WL0013    P      PFS Record Stat
     C                     EXSR SXRVGN
     C           KRSSV     READE@COCPNU                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Rtv Last Seq for Order - PFS Order BOL Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WVY1NX    WQSW01           PFS Company Num
     C           *LIKE     DEFN WVZPNX    WQSW02           PFS Order Numbe
     C           *LIKE     DEFN WVIZST    WQSW03           PFS BOL Comment
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WQSW01           PFS Company Num
     C                     KFLD           WQSW02           PFS Order Numbe
     C                     KFLD           WQSW03           PFS BOL Comment
      * Setup key
     C                     Z-ADDWL0004    WQSW01           PFS Company Num
     C                     Z-ADDWL0005    WQSW02           PFS Order Numbe
     C                     MOVELWL0006    WQSW03           PFS BOL Comment
      * Establish starting position
     C           KRSSW     SETLL@BDCPAB                    *
     C           KRSSW     READE@BDCPAB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3490' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0007           PFS Sequence Nu
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWVZ1NX    WL0007           PFS Sequence Nu
     C           KRSSW     READE@BDCPAB                  90*
     C                     ENDDO
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * Upd PFS BOL Comment   RT - PFS Order BOL Comment  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0102  10       PFS Process Sta
     C                     MOVEL*BLANK    WN0103  6        PFS Error Reaso
     C                     Z-ADD*ZERO     WN0104  80       PFS Create Date
     C                     Z-ADD*ZERO     WN0105  60       PFS Create Time
     C                     Z-ADD*ZERO     WN0106  80       PFS Change Date
     C                     Z-ADD*ZERO     WN0107  60       PFS Change time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WVY1NX           PFS Company Num
     C                     KFLD           WVZPNX           PFS Order Numbe
     C                     KFLD           WVIZST           PFS BOL Comment
     C                     KFLD           WVZ1NX           PFS Sequence Nu
      * Setup key
     C                     Z-ADDWL0008    WVY1NX           PFS Company Num
     C                     Z-ADDWL0009    WVZPNX           PFS Order Numbe
     C                     MOVELWL0010    WVIZST           PFS BOL Comment
     C                     Z-ADDWL0011    WVZ1NX           PFS Sequence Nu
      * Establish starting position
     C           KRSSX     CHAIN@BDCPAB              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3490' W0RTN   7
      * USER: Processing if Data record not found
      * Crt PFS BOL Comment   CR - PFS Order BOL Comment  * 
     C                     EXSR SYCRRC
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg PFS BOL Comment   CH - PFS Order BOL Comment  * 
     C                     EXSR SZCHRC
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYCRRC    BEGSR
      *================================================================
      * Crt PFS BOL Comment   CR - PFS Order BOL Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BDCPAA
     C                     Z-ADDWL0008    WWY1NX           PFS Company Num
     C                     Z-ADDWL0009    WWZPNX           PFS Order Numbe
     C                     MOVELWL0010    WWIZST           PFS BOL Comment
     C                     Z-ADDWL0011    WWZ1NX           PFS Sequence Nu
     C                     MOVELWL0012    WWGJT1           PFS BOL Comment
     C                     MOVELWL0013    WWUWSX           PFS Record Stat
     C                     Z-ADDWN0102    WWUXSX           PFS Process Sta
     C                     MOVELWN0103    WWV3SX           PFS Error Reaso
     C                     Z-ADDWN0104    WWAHNY           PFS Create Date
     C                     Z-ADDWN0105    WWAINY           PFS Create Time
     C                     Z-ADDWN0106    WWAJNY           PFS Change Date
     C                     Z-ADDWN0107    WWAKNY           PFS Change time
      *
      * USER: Processing before Data update
      * Set Create Stamp      IF
     C                     Z-ADD0         WWUXSX           PFS Process Sta
     C                     Z-ADD##JDT     WWAHNY           PFS Create Date
     C                     Z-ADD##JTM     WWAINY           PFS Create Time
     C           KLCRSY    KLIST
     C                     KFLD           WWY1NX           PFS Company Num
     C                     KFLD           WWZPNX           PFS Order Numbe
     C                     KFLD           WWIZST           PFS BOL Comment
     C                     KFLD           WWZ1NX           PFS Sequence Nu
      * Check for duplicate primary key
     C           KLCRSY    SETLL@BDCPAA                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3491' W0RTN   7
      * Send message 'PFS Order BOL Comment  EX'
     C                     MOVEL'USR3491' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C                     WRITE@BDCPAA                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZCHRC    BEGSR
      *================================================================
      * Chg PFS BOL Comment   CH - PFS Order BOL Comment  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0108  10       PFS Process Sta
     C                     MOVEL*BLANK    WN0109  6        PFS Error Reaso
     C                     Z-ADD*ZERO     WN0110  80       PFS Create Date
     C                     Z-ADD*ZERO     WN0111  60       PFS Create Time
     C                     Z-ADD*ZERO     WN0112  80       PFS Change Date
     C                     Z-ADD*ZERO     WN0113  60       PFS Change time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @BDCPAA
     C                     Z-ADDWL0008    WWY1NX           PFS Company Num
     C                     Z-ADDWL0009    WWZPNX           PFS Order Numbe
     C                     MOVELWL0010    WWIZST    P      PFS BOL Comment
     C                     Z-ADDWL0011    WWZ1NX           PFS Sequence Nu
      *
     C           KLCHSZ    KLIST
     C                     KFLD           WWY1NX           PFS Company Num
     C                     KFLD           WWZPNX           PFS Order Numbe
     C                     KFLD           WWIZST           PFS BOL Comment
     C                     KFLD           WWZ1NX           PFS Sequence Nu
     C           KLCHSZ    CHAIN@BDCPAA              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PPBDCPL0'MDACP
     C                     MOVEL'@BDCPAA' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SZEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPPBD1    YBRDCS
      * Move non-key fields to @BDCPAA
     C                     MOVELWL0012    WWGJT1    P      PFS BOL Comment
     C                     MOVELWL0013    WWUWSX    P      PFS Record Stat
      *
      * Set PGM.*Record Data Changed flag
     C           QPPBD1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Change Stamp      IF
     C                     Z-ADD##JDT     WWAJNY           PFS Change Date
     C                     Z-ADD##JTM     WWAKNY           PFS Change time
      * Set PGM.*Record Data Changed flag
     C           QPPBD1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@BDCPAA                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPPBDCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * RTV Country Code only  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQTA01           Company Number
     C           *LIKE     DEFN WDC4NB    WQTA02           Order Number
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WQTA01           Company Number
     C                     KFLD           WQTA02           Order Number
      * Setup key
     C                     Z-ADDWL0014    WQTA01           Company Number
     C                     Z-ADDWL0015    WQTA02           Order Number
      * Establish starting position
     C           KRSTA     SETLL@BGWKAE                    *
     C           KRSTA     READE@BGWKAE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0016           Country Code
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           WDGMST    IFEQ 'L'                        *IF
     C           WDGMST    OREQ 'A'
     C           WDGMST    OREQ 'C'
     C           WDGMST    OREQ 'R'
     C           WDGMST    OREQ 'E'
     C           WDGMST    OREQ 'H'
     C           WDGMST    OREQ 'I'
      * PAR = DB1 By name
     C                     MOVELWDKXCD    WL0016           Country Code
     C                     GOTO TAEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTA     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * Rtv PFS BL Cmnt f/CAT RT - Country Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WYKXCD    WQTB01           Country Code
     C           *LIKE     DEFN WYI1SX    WQTB02           Comment Type
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WQTB01           Country Code
     C                     KFLD           WQTB02           Comment Type
      * Setup key
     C                     MOVELWL0017    WQTB01           Country Code
     C                     MOVELWL0018    WQTB02           Comment Type
      * Establish starting position
     C           KRSTB     SETLL@B1REED                    *
     C           KRSTB     READE@B1REED                  90*
      * Data record not found
     C   90                MOVEL'USR3594' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Comment is Not Entered
     C           WYQ6NA    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Last Seq for Order - PFS Order BOL Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0019    WL0004           PFS Company Num
     C                     Z-ADDWL0020    WL0005           PFS Order Numbe
     C                     MOVEL'BL'      WL0006    P      PFS BOL Comment
     C                     Z-ADDYL0026    WL0007           PFS Sequence Nu
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0007    YL0026           PFS Sequence Nu
     C                     ADD  1         YL0026           PFS Sequence Nu
      * Upd PFS BOL Comment   RT - PFS Order BOL Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0019    WL0008           PFS Company Num
     C                     Z-ADDWL0020    WL0009           PFS Order Numbe
     C                     MOVEL'BL'      WL0010    P      PFS BOL Comment
     C                     Z-ADDYL0026    WL0011           PFS Sequence Nu
     C                     MOVELWYQ6NA    WL0012    P      PFS BOL Comment
     C                     MOVEL'A'       WL0013    P      PFS Record Stat
     C                     EXSR SXRVGN
     C                     END                             *FI
     C           KRSTB     READE@B1REED                  90*
     C                     ENDDO
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * PFS Cust Comment Tp BL RT - Customer Comment  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0114  70       PFS Ship To Cus
     C                     MOVEL*BLANK    WN0115  2        PFS Comment Typ
     C                     Z-ADD*ZERO     WN0116  30       PFS Sequence Nu
     C                     MOVEL*BLANK    WN0117 60        PFS Comment
     C                     MOVEL*BLANK    WN0118  1        PFS Record Stat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TABKC7    WQTC01           Ship To Custome
     C           *LIKE     DEFN TAI1SX    WQTC02           Comment Type
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WQTC01           Ship To Custome
     C                     KFLD           WQTC02           Comment Type
      * Setup key
     C                     Z-ADDWFBKC7    WQTC01           Ship To Custome
     C                     MOVEL'BL'      WQTC02           Comment Type
      * Establish starting position
     C           KRSTC     SETLL@AVCPG4                    *
     C           KRSTC     READE@AVCPG4                  90*
      * Data record not found
     C   90                MOVEL'USR2993' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Last Seq for Order - PFS Order BOL Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWFAIC3    WL0004           PFS Company Num
     C                     Z-ADDWFC4NB    WL0005           PFS Order Numbe
     C                     MOVEL'BL'      WL0006    P      PFS BOL Comment
     C                     Z-ADDWN0116    WL0007           PFS Sequence Nu
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0007    WN0116           PFS Sequence Nu
     C                     ADD  1         WN0116           PFS Sequence Nu
      * Upd PFS BOL Comment   RT - PFS Order BOL Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWFAIC3    WL0008           PFS Company Num
     C                     Z-ADDWFC4NB    WL0009           PFS Order Numbe
     C                     MOVEL'BL'      WL0010    P      PFS BOL Comment
     C                     Z-ADDWN0116    WL0011           PFS Sequence Nu
     C                     MOVELTAXRTX    WL0012    P      PFS BOL Comment
     C                     MOVEL'A'       WL0013    P      PFS Record Stat
     C                     EXSR SXRVGN
     C           KRSTC     READE@AVCPG4                  90*
     C                     ENDDO
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * Rtv Crt PFS BOL CommntRT - Country Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WYKXCD    WQTD01           Country Code
     C           *LIKE     DEFN WYI1SX    WQTD02           Comment Type
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WQTD01           Country Code
     C                     KFLD           WQTD02           Comment Type
      * Setup key
     C                     MOVELWL0022    WQTD01           Country Code
     C                     MOVELWL0023    WQTD02           Comment Type
      * Establish starting position
     C           KRSTD     SETLL@B1REED                    *
     C           KRSTD     READE@B1REED                  90*
      * Data record not found
     C   90                MOVEL'USR3594' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Comment is Not Entered
     C           WYQ6NA    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Load Status is Unlock
     C           WL0026    IFEQ 'U'                        *IF
     C                     MOVEL'D'       YL0027           PFS Record Stat
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'C'       YL0027           PFS Record Stat
     C                     END                             *FI
      * Upd PFS BOL Comment   RT - PFS Order BOL Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0024    WL0008           PFS Company Num
     C                     Z-ADDWL0025    WL0009           PFS Order Numbe
     C                     MOVELWYI1SX    WL0010    P      PFS BOL Comment
     C                     Z-ADDWYM5NX    WL0011           PFS Sequence Nu
     C                     MOVELWYQ6NA    WL0012    P      PFS BOL Comment
     C                     MOVELYL0027    WL0013    P      PFS Record Stat
     C                     EXSR SXRVGN
     C                     END                             *FI
     C           KRSTD     READE@B1REED                  90*
     C                     ENDDO
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * Rtv All Values        RT - Customer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           TBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWFBKC7    TBBKC7           Ship To Custome
      * Establish starting position
     C           KRSTE     CHAIN@NEREAT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2880' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0015           Email Address
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELTBUGTX    WN0015           Email Address
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * RTV Customer Telephone RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           WHBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWFBKC7    WHBKC7           Ship To Custome
      * Establish starting position
     C           KRSTF     CHAIN@BBREE9              90    *
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHBVTX    WN0016           Telephone Numbe
     C                     ENDIF
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * RTV Carr Appt Dt/Tm   RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TCRMNB    WQTG02           Load ID
     C           *LIKE     DEFN TCC4NB    WQTG03           Order Number
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           WQTG02           Load ID
     C                     KFLD           WQTG03           Order Number
      * Setup key
     C                     Z-ADDWFRMNB    WQTG02           Load ID
     C                     Z-ADDWFC4NB    WQTG03           Order Number
      * Establish starting position
     C           KRSTG     SETLL@FLCPKF                    *
     C           KRSTG     READE@FLCPKF                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDTCN7DT    YL0031           Appointment Con
     C                     Z-ADDTCB3TM    YL0032           Appointment Con
     C                     GOTO TGEXIT                     *QUIT
     C           KRSTG     READE@FLCPKF                  90*
     C                     ENDDO
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * RTV OHE Delivery PO #  RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           WSAIC3           Company Number
     C                     KFLD           WSC4NB           Order Number
      * Setup key
     C                     Z-ADDWFAIC3    WSAIC3           Company Number
     C                     Z-ADDWFC4NB    WSC4NB           Order Number
      * Establish starting position
     C           KRSTH     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0052           Delivery P.O. N
     C                     GOTO THEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWSLMT1    WN0052           Delivery P.O. N
     C                     GOTO THEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * RTV From/To WHS   PFS RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGAIC3    WQTI01           Company Number
     C           *LIKE     DEFN WGC4NB    WQTI02           Order Number
      * Define keylist
     C           KPSTI     KLIST
     C                     KFLD           WQTI01           Company Number
     C                     KFLD           WQTI02           Order Number
     C                     KFLD           WGDPNB           Order Sequence
     C                     KFLD           WGUENB           Order Secondary
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           WQTI01           Company Number
     C                     KFLD           WQTI02           Order Number
      * Setup key
     C                     Z-ADDWFAIC3    WQTI01           Company Number
     C                     Z-ADDWFC4NB    WQTI02           Order Number
     C                     Z-ADD0         WGDPNB           Order Sequence
     C                     Z-ADD0         WGUENB           Order Secondary
      * Establish starting position
     C           KPSTI     SETLL@BGWKL1                    *
     C           KRSTI     READE@BGWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0038           Warehouse Code
     C                     GOTO TIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * C2748:  Changed RTV Warehouse Code RT to exclude Cancelled lines.
      * CASE: DB1.Detail Line Status is Cancelled
     C           WGGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * PAR = DB1 By name
     C                     MOVELWGAJCD    WN0038           Warehouse Code
     C                     GOTO TIEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTI     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * RTV PFS Export Inst    RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           WSAIC3           Company Number
     C                     KFLD           WSC4NB           Order Number
      * Setup key
     C                     Z-ADDWFAIC3    WSAIC3           Company Number
     C                     Z-ADDWFC4NB    WSC4NB           Order Number
      * Establish starting position
     C           KRSTJ     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0041           Shipping Line
     C                     MOVEL*BLANK    YL0002           Port Delv Termi
     C                     MOVEL*BLANK    WN0045           OHE City
     C                     MOVEL*BLANK    WN0048           OHE Vessel/Airl
     C                     MOVEL*BLANK    WN0049           OHE Voyage/Flig
     C                     MOVEL*BLANK    WN0051           OHE Booking Num
     C                     MOVEL*BLANK    WN0050           OHE Discharge P
     C                     Z-ADD*ZERO     YL0033           OHE Sail/Flight
     C                     Z-ADD*ZERO     YL0034           OHE Port Cut Da
     C                     Z-ADD*ZERO     YL0035           OHE Arrival Dat
     C                     MOVEL*BLANK    YL0036           OHE Late Delive
     C                     MOVEL*BLANK    YL0037           OHE Ship Status
     C                     MOVEL*BLANK    YL0038           OHE Container N
     C                     MOVEL*BLANK    YL0039           OHE Comment 1
     C                     MOVEL*BLANK    YL0040           OHE Comment 2
     C                     GOTO TJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWSXACD    WN0041           Shipping Line
     C                     MOVELWSOANA    YL0002           Port Delv Termi
     C                     MOVELWSHBAA    WN0045           OHE City
     C                     MOVELWSJ0T1    WN0048           OHE Vessel/Airl
     C                     MOVELWSGENY    WN0049           OHE Voyage/Flig
     C                     MOVELWSJ1T1    WN0051           OHE Booking Num
     C                     MOVELWSHCAA    WN0050           OHE Discharge P
     C                     Z-ADDWSQWDT    YL0033           OHE Sail/Flight
     C                     Z-ADDWSQXDT    YL0034           OHE Port Cut Da
     C                     Z-ADDWSQYDT    YL0035           OHE Arrival Dat
     C                     MOVELWSHDAA    YL0036           OHE Late Delive
     C                     MOVELWSCCTX    YL0037           OHE Ship Status
     C                     MOVELWSJ2T1    YL0038           OHE Container N
     C                     MOVELWSRLNA    YL0039           OHE Comment 1
     C                     MOVELWSRMNA    YL0040           OHE Comment 2
     C                     GOTO TJEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKRVGN    BEGSR
      *================================================================
      * RTV Shipping Line/PortsRT - Shipping Line/Port  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTK     KLIST
     C                     KFLD           TDXACD           Shipping Line
     C                     KFLD           TDOANA           Port Delv Termi
      * Setup key
     C                     MOVELWN0041    TDXACD           Shipping Line
     C                     MOVELYL0002    TDOANA           Port Delv Termi
      * Establish starting position
     C           KRSTK     CHAIN@LCREL2              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2419' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0045           Port City
     C                     MOVEL*BLANK    WN0043           Port Address Li
     C                     MOVEL*BLANK    WN0044           Port Address Li
     C                     MOVEL*BLANK    WN0046           Sail Port State
     C                     MOVEL*BLANK    WN0047           Port Zip/Postal
     C                     Z-ADD*ZERO     YL0041           Port Phone Numb
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELTDOKTX    WN0045           Port City
     C                     MOVELTDLBTX    WN0043           Port Address Li
     C                     MOVELTDLATX    WN0044           Port Address Li
     C                     MOVELTDXBCD    WN0046           Sail Port State
     C                     MOVELTDLCTX    WN0047           Port Zip/Postal
     C                     Z-ADDTDSPPN    YL0041           Port Phone Numb
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLRVGN    BEGSR
      *================================================================
      * Upd Order Header      RT - PFS Order Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0135  10       PFS Process Sta
     C                     MOVEL*BLANK    WN0136  6        PFS Error Reaso
     C                     Z-ADD*ZERO     WN0137  80       PFS Create Date
     C                     Z-ADD*ZERO     WN0138  60       PFS Create Time
     C                     Z-ADD*ZERO     WN0139  80       PFS Change Date
     C                     Z-ADD*ZERO     WN0140  60       PFS Change time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * LJB 1/14/09 FP1303 Add PFS Delivery P.O. Number (new field)
      * RMC 03/13/07 output par.sequence no
      * Define keylist
     C           KRSTL     KLIST
     C                     KFLD           TEY1NX           PFS Company Num
     C                     KFLD           TEZPNX           PFS Order Numbe
      * Setup key
     C                     Z-ADDWN0002    TEY1NX           PFS Company Num
     C                     Z-ADDWN0003    TEZPNX           PFS Order Numbe
      * Establish starting position
     C           KRSTL     CHAIN@BBCPZS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3486' W0RTN   7
      * USER: Processing if Data record not found
      * Crt PFS Order Header  CR - PFS Order Header  * 
     C                     EXSR TMCRRC
     C                     GOTO TLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg PFS Order Header  CH - PFS Order Header  * 
     C                     EXSR TNCHRC
     C                     ENDIF
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMCRRC    BEGSR
      *================================================================
      * Crt PFS Order Header  CR - PFS Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BBCPZR
     C                     Z-ADDWN0002    TFY1NX           PFS Company Num
     C                     Z-ADDWN0003    TFZPNX           PFS Order Numbe
     C                     Z-ADDWN0004    TFZGNX           PFS Load ID
     C                     Z-ADDYL0008    TFZWNX           PFS Loading Seq
     C                     Z-ADDWN0005    TFZVNX           PFS Load Stop N
     C                     MOVELWN0006    TFVCSX           PFS Order Type
     C                     Z-ADDWN0007    TFZQNX           PFS Ship To Cus
     C                     MOVELWN0008    TFF0T1           PFS Ship To Cus
     C                     MOVELWN0009    TFF1T1           PFS Ship To Cus
     C                     MOVELWN0010    TFF2T1           PFS Ship To Cus
     C                     MOVELWN0011    TFGUT1           PFS Ship To Cus
     C                     MOVELWN0012    TFF3T1           PFS Ship To Cus
     C                     MOVELWN0013    TFF4T1           PFS Ship To Cus
     C                     MOVELWN0014    TFF5T1           PFS Ship To Cus
     C                     MOVELWN0015    TFF6T1           PFS Ship To Ema
     C                     MOVELWN0016    TFF7T1           PFS Ship To Pho
     C                     Z-ADDWN0017    TFZENX           PFS Bill To Cus
     C                     MOVELWN0018    TFF8T1           PFS Bill To Cus
     C                     MOVELWN0019    TFF9T1           PFS Bill To Cus
     C                     MOVELWN0020    TFGAT1           PFS Bill To Cus
     C                     MOVELWN0021    TFGVT1           PFS Bill To Cus
     C                     MOVELWN0022    TFGBT1           PFS Bill To Cus
     C                     MOVELWN0023    TFGCT1           PFS Bill To Cus
     C                     MOVELWN0024    TFGDT1           PFS Bill To Cus
     C                     MOVELWN0025    TFFZT1           PFS Customer PO
     C                     Z-ADDWN0026    TFZRNX           PFS Order Date
     C                     Z-ADDWN0027    TFZSNX           PFS Scheduled S
     C                     Z-ADDWN0028    TFZTNX           PFS Requested D
     C                     Z-ADDWN0029    TFZUNX           PFS Requested D
     C                     MOVELWN0030    TFVBSX           PFS Export Stat
     C                     MOVELWN0031    TFU3SX           PFS Country Cod
     C                     MOVELWN0032    TFGET1           PFS Special Ins
     C                     MOVELWN0033    TFGFT1           PFS Special Ins
     C                     Z-ADDWN0034    TFA1NY           PFS Maximum Gro
     C                     Z-ADDWN0035    TFBKNY           PFS Estimated P
     C                     Z-ADDWN0036    TFATNY           PFS Average Pal
     C                     MOVELWN0037    TFVESX           PFS Order Statu
     C                     MOVELWN0038    TFF8AA           PFS Ship From W
     C                     MOVELWN0039    TFF9AA           PFS Ship To War
     C                     Z-ADDWN0040    TFC5NY           PFS Order Detai
     C                     Z-ADDYL0006    TFF5NY           PFS Sequence No
     C                     MOVELWN0041    TFF5AA           PFS Shipping Li
     C                     MOVELWN0042    TFFRT1           PFS Shipping Li
     C                     MOVELWN0043    TFFST1           PFS Shipping Li
     C                     MOVELWN0044    TFFTT1           PFS Shipping Li
     C                     MOVELWN0045    TFFUT1           PFS Shipping Li
     C                     MOVELWN0046    TFFVT1           PFS Shipping Li
     C                     MOVELWN0047    TFFWT1           PFS Shipping LI
     C                     MOVELWN0048    TFFXT1           PFS Vessel Name
     C                     MOVELWN0049    TFZLNX           PFS Voyage
     C                     MOVELWN0050    TFF7AA           PFS Discharge P
     C                     MOVELWN0051    TFF6AA           PFS Booking Num
     C                     MOVELWN0052    TFS6NA           PFS Delivery P.
     C                     MOVELWN0053    TFZDSX           PFS Order Unuse
     C                     MOVELWN0054    TFZESX           PFS Order Unuse
     C                     MOVELWN0055    TFZFSX           PFS Order Unuse
     C                     MOVELWN0056    TFZGSX           PFS Order Unuse
     C                     MOVELWN0057    TFZHSX           PFS Order Unuse
     C                     MOVELWN0058    TFMXU1           PFS Order Unuse
     C                     MOVELWN0059    TFUWSX           PFS Record Stat
     C                     Z-ADDWN0135    TFUXSX           PFS Process Sta
     C                     MOVELWN0136    TFV3SX           PFS Error Reaso
     C                     Z-ADDWN0137    TFAHNY           PFS Create Date
     C                     Z-ADDWN0138    TFAINY           PFS Create Time
     C                     Z-ADDWN0139    TFAJNY           PFS Change Date
     C                     Z-ADDWN0140    TFAKNY           PFS Change time
      *
      * USER: Processing before Data update
      * Set Create Stamp      IF
     C                     Z-ADD0         TFUXSX           PFS Process Sta
     C                     Z-ADD##JDT     TFAHNY           PFS Create Date
     C                     Z-ADD##JTM     TFAINY           PFS Create Time
     C           KLCRTM    KLIST
     C                     KFLD           TFY1NX           PFS Company Num
     C                     KFLD           TFZPNX           PFS Order Numbe
      * Check for duplicate primary key
     C           KLCRTM    SETLL@BBCPZR                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3487' W0RTN   7
      * Send message 'PFS Order Header       EX'
     C                     MOVEL'USR3487' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TMEXIT
     C                     ENDIF
      *
     C                     WRITE@BBCPZR                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNCHRC    BEGSR
      *================================================================
      * Chg PFS Order Header  CH - PFS Order Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0141  10       PFS Process Sta
     C                     MOVEL*BLANK    WN0142  6        PFS Error Reaso
     C                     Z-ADD*ZERO     WN0143  80       PFS Create Date
     C                     Z-ADD*ZERO     WN0144  60       PFS Create Time
     C                     Z-ADD*ZERO     WN0145  80       PFS Change Date
     C                     Z-ADD*ZERO     WN0146  60       PFS Change time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @BBCPZR
     C                     Z-ADDWN0002    TFY1NX           PFS Company Num
     C                     Z-ADDWN0003    TFZPNX           PFS Order Numbe
      *
     C           KLCHTN    KLIST
     C                     KFLD           TFY1NX           PFS Company Num
     C                     KFLD           TFZPNX           PFS Order Numbe
     C           KLCHTN    CHAIN@BBCPZR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PPBBCPL0'MDACP
     C                     MOVEL'@BBCPZR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TNEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPPBB1    YCRDCS
      * Move non-key fields to @BBCPZR
     C                     Z-ADDWN0004    TFZGNX           PFS Load ID
     C                     Z-ADDYL0008    TFZWNX           PFS Loading Seq
     C                     Z-ADDWN0005    TFZVNX           PFS Load Stop N
     C                     MOVELWN0006    TFVCSX    P      PFS Order Type
     C                     Z-ADDWN0007    TFZQNX           PFS Ship To Cus
     C                     MOVELWN0008    TFF0T1    P      PFS Ship To Cus
     C                     MOVELWN0009    TFF1T1    P      PFS Ship To Cus
     C                     MOVELWN0010    TFF2T1    P      PFS Ship To Cus
     C                     MOVELWN0011    TFGUT1    P      PFS Ship To Cus
     C                     MOVELWN0012    TFF3T1    P      PFS Ship To Cus
     C                     MOVELWN0013    TFF4T1    P      PFS Ship To Cus
     C                     MOVELWN0014    TFF5T1    P      PFS Ship To Cus
     C                     MOVELWN0015    TFF6T1    P      PFS Ship To Ema
     C                     MOVELWN0016    TFF7T1    P      PFS Ship To Pho
     C                     Z-ADDWN0017    TFZENX           PFS Bill To Cus
     C                     MOVELWN0018    TFF8T1    P      PFS Bill To Cus
     C                     MOVELWN0019    TFF9T1    P      PFS Bill To Cus
     C                     MOVELWN0020    TFGAT1    P      PFS Bill To Cus
     C                     MOVELWN0021    TFGVT1    P      PFS Bill To Cus
     C                     MOVELWN0022    TFGBT1    P      PFS Bill To Cus
     C                     MOVELWN0023    TFGCT1    P      PFS Bill To Cus
     C                     MOVELWN0024    TFGDT1    P      PFS Bill To Cus
     C                     MOVELWN0025    TFFZT1    P      PFS Customer PO
     C                     Z-ADDWN0026    TFZRNX           PFS Order Date
     C                     Z-ADDWN0027    TFZSNX           PFS Scheduled S
     C                     Z-ADDWN0028    TFZTNX           PFS Requested D
     C                     Z-ADDWN0029    TFZUNX           PFS Requested D
     C                     MOVELWN0030    TFVBSX    P      PFS Export Stat
     C                     MOVELWN0031    TFU3SX    P      PFS Country Cod
     C                     MOVELWN0032    TFGET1    P      PFS Special Ins
     C                     MOVELWN0033    TFGFT1    P      PFS Special Ins
     C                     Z-ADDWN0034    TFA1NY           PFS Maximum Gro
     C                     Z-ADDWN0035    TFBKNY           PFS Estimated P
     C                     Z-ADDWN0036    TFATNY           PFS Average Pal
     C                     MOVELWN0037    TFVESX    P      PFS Order Statu
     C                     MOVELWN0038    TFF8AA    P      PFS Ship From W
     C                     MOVELWN0039    TFF9AA    P      PFS Ship To War
     C                     Z-ADDWN0040    TFC5NY           PFS Order Detai
     C                     Z-ADDYL0006    TFF5NY           PFS Sequence No
     C                     MOVELWN0041    TFF5AA    P      PFS Shipping Li
     C                     MOVELWN0042    TFFRT1    P      PFS Shipping Li
     C                     MOVELWN0043    TFFST1    P      PFS Shipping Li
     C                     MOVELWN0044    TFFTT1    P      PFS Shipping Li
     C                     MOVELWN0045    TFFUT1    P      PFS Shipping Li
     C                     MOVELWN0046    TFFVT1    P      PFS Shipping Li
     C                     MOVELWN0047    TFFWT1    P      PFS Shipping LI
     C                     MOVELWN0048    TFFXT1    P      PFS Vessel Name
     C                     MOVELWN0049    TFZLNX    P      PFS Voyage
     C                     MOVELWN0050    TFF7AA    P      PFS Discharge P
     C                     MOVELWN0051    TFF6AA    P      PFS Booking Num
     C                     MOVELWN0052    TFS6NA    P      PFS Delivery P.
     C                     MOVELWN0053    TFZDSX    P      PFS Order Unuse
     C                     MOVELWN0054    TFZESX    P      PFS Order Unuse
     C                     MOVELWN0055    TFZFSX    P      PFS Order Unuse
     C                     MOVELWN0056    TFZGSX    P      PFS Order Unuse
     C                     MOVELWN0057    TFZHSX    P      PFS Order Unuse
     C                     MOVELWN0058    TFMXU1    P      PFS Order Unuse
     C                     MOVELWN0059    TFUWSX    P      PFS Record Stat
      *
      * Set PGM.*Record Data Changed flag
     C           QPPBB1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Change Stamp      IF
     C                     Z-ADD##JDT     TFAJNY           PFS Change Date
     C                     Z-ADD##JTM     TFAKNY           PFS Change time
      * Set PGM.*Record Data Changed flag
     C           QPPBB1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@BBCPZR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPPBBCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Get Next PFS Sequence No         -- copied from reg carlisle lh
      *================================================================
      * Create all records for this order/load with same sequence.
      * RTV Numeric Value      RT - Company Values  * 
     C                     EXSR SCRVGN
     C                     ADD  1         YL0006           PFS Sequence No
      * Skip 0
      * CASE: LCL.PFS Sequence No. is eq 0
     C           YL0006    IFEQ 0                          *IF
     C                     ADD  1         YL0006           PFS Sequence No
     C                     END                             *FI
      * Rtv Chg Comp Val Num   XF - Company Values  * 
     C                     CALL 'PPW2XFR'              90  Rtv Chg Comp Va
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBAIC3    WQ0001  30       Company Number
     C                     PARM @CN,001   WQ0002 10        Company Value C
     C                     PARM YL0006    WQ0003 155       System Value Nu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPW2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * FP1309 Calculate Oldest Allowed & Newest Allowed Dates
      *================================================================
      * FP1309 Calculate Oldest Allowed & Newest Allowed Dates
     C                     MOVELWUJ1TX    WN0068           PFS Age Code
     C                     Z-ADD0         WN0082           PFS Oldest Date
     C                     Z-ADD0         WN0083           PFS Newest Date
      * **** Calculate both dates ****
      * The oldest allowed date is either the Override From date or
      * Requested Delivery Date - Item Age Days.
      * Val Age Information   IF
     C                     MOVEL*BLANK    WUB8SX           Error Flag
     C                     MOVEL*BLANK    YL0016           Error Status
     C                     MOVEL*BLANK    WUKWTX           Error Reason De
     C                     MOVEL*BLANK    WUKXTX           Error Reason De
     C                     MOVEL*BLANK    WUKYTX           Error Reason De
     C                     MOVEL*BLANK    WUKZTX           Error Reason De
     C                     MOVEL*BLANK    WUTITX           Error Reason De
      * CASE: PAR.Company Organization is Seaboard
     C           WUYJSX    IFEQ 'S'                        *IF
      * CASE: PAR.Requested Delivery Date is not entered
     C           WFEIDT    IFEQ 0                          *IF
      * Setup message data for message
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  WFEIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0001
      * Send message 'Requested Delv Date Error'
     C                     MOVEL'USR4329' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: PAR.Scheduled Ship Date is not entered
     C           WGAODT    IFEQ 0                          *IF
      * Setup message data for message
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  WGAODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0002
      * Send message 'Scheduled Ship Date Req'd'
     C                     MOVEL'USR2230' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Val Age information   XF - Order Detail  * 
     C                     CALL 'PNQNXFR'              90  Val Age informa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WGHGCD    WQ0007  70       Item Code
     C                     PARM WGAJCD    WQ0008  3        Warehouse Code
     C           WUB8SX    PARM WUB8SX    WQ0009  1        Error Flag
     C           WUKWTX    PARM WUKWTX    WQ0010 30        Error Reason De
     C           WUKXTX    PARM WUKXTX    WQ0011 30        Error Reason De
     C           WUKYTX    PARM WUKYTX    WQ0012 30        Error Reason De
     C           WUKZTX    PARM WUKZTX    WQ0013 30        Error Reason De
     C           WUTITX    PARM WUTITX    WQ0014 30        Error Reason De
     C                     PARM WGAIC3    WQ0015  30       Company Number
     C                     PARM WGAODT    WQ0016  70       Scheduled Ship
     C                     PARM WFEIDT    WQ0017  70       Requested Deliv
     C                     PARM WGRINY    WQ0018  40       Item Age Days
     C                     PARM WGTIDT    WQ0019  70       Production Ovr
     C                     PARM WGTJDT    WQ0020  70       Production Ovr
     C           WN0082    PARM WN0082    WQ0021  70       Production AgeD
     C           WN0083    PARM WN0083    WQ0022  70       Production AgeD
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Verify if message should be sent if validation is required
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Error Flag            USR is Yes
      *   |- c2    : PAR.Production Dates Sts Usr is Validation routine
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUB8SX    IFEQ 'Y'                        *IF
     C           'C'       IFEQ 'V'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * message 1 Product is shipped before product is made
      * CASE: WRK.Error Reason Descript 1 NE WRK.Blank for 30          US
     C           WUKWTX    IFNE WUW4TX                     *IF
      * Setup message data for message
      * Convert Production AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  WN0082    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0003
      * Send message 'PrdDte Shipped BEF Made'
     C                     MOVEL'USR4307' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * message 2 Either Days or override date but not both
      * CASE: WRK.Error Reason Descript 2 NE WRK.Blank for 30          US
     C           WUKXTX    IFNE WUW4TX                     *IF
      * Setup message data for message
     C                     Z-ADDWGRINY    ZA0004           Item Age Days
      * Convert Production Ovr AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  WGTIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0005
      * Convert Production Ovr AgeDte To to display format
      * Convert date
     C           1000000   ADD  WGTJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0006
      * Send message 'Enter Age Days or Dates'
     C                     MOVEL'USR4304' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * message 3 With Chill Days Either Days or Override Dates required
      * CASE: WRK.Error Reason Descript 3 NE WRK.Blank for 30          US
     C           WUKYTX    IFNE WUW4TX                     *IF
      * Setup message data for message
     C                     Z-ADDWGRINY    ZA0007           Item Age Days
      * Convert Production Ovr AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  WGTIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0008
      * Convert Production Ovr AgeDte To to display format
      * Convert date
     C           1000000   ADD  WGTJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0009
      * Send message 'Age OvrDate Ranage Invlid'
     C                     MOVEL'USR4305' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * message 4 From date is > then SHIP DATE
      * CASE: WRK.Error Reason Descript 4 NE WRK.Blank for 30          US
     C           WUKZTX    IFNE WUW4TX                     *IF
      * Setup message data for message
     C                     Z-ADDWGRINY    ZA0010           Item Age Days
      * Convert Production Ovr AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  WGTIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0011
      * Convert Production Ovr AgeDte To to display format
      * Convert date
     C           1000000   ADD  WGTJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0012
      * Send message 'Age OvrDate Ranage Invlid'
     C                     MOVEL'USR4305' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * message 5 To date is > then SHIP DATE
      * CASE: WRK.Error Reason Descript 5 NE WRK.Blank for 30          US
     C           WUTITX    IFNE WUW4TX                     *IF
      * Setup message data for message
     C                     Z-ADDWGRINY    ZA0013           Item Age Days
      * Convert Production Ovr AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  WGTIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0014
      * Convert Production Ovr AgeDte To to display format
      * Convert date
     C           1000000   ADD  WGTJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0015
      * Send message 'Age OvrDate Ranage Invlid'
     C                     MOVEL'USR4305' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * CASE: PAR.Production Ovr AgeDte Fr is not entered
     C           WGTIDT    IFEQ 0                          *IF
      * Setup message data for message
     C                     Z-ADDWGRINY    ZA0016           Item Age Days
      * Send message 'Invalid Item Age Days'
     C                     MOVEL'USR4309' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Production AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  WN0082    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0017
      * Convert Production AgeDte To to display format
      * Convert date
     C           1000000   ADD  WN0083    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0018
      * Send message 'Invalid Prod OvrDates'
     C                     MOVEL'USR4310' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     MOVEL'Y'       YL0016           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Newest date is from the Schedule Ship Date unless User OvrR
      * CASE: DB1.Production Ovr AgeDte To is GT Zero
     C           WGTJDT    IFGT 0                          *IF
      * The newest allowed date: If entered - Override To date will be us
     C                     ELSE
      * CASE: *OTHERWISE
      * The newest allowed date: If there is no override then
      * the newest allowed date = Schedule Ship Date
      * Carlisle application adds the chill time in their process
      * Requested from John Z during technical review.  FP1309
     C                     Z-ADDWGAODT    WN0083           PFS Newest Date
     C                     END                             *FI
      * R5207 2/16/16  Dailys  Only  - newest prod date
      * CASE: WRK.Company Organization is Daily's
     C           WUYJSX    IFEQ 'D'                        *IF
      * Rtv Prev Prd Dte      RT - Calendar  * 
     C                     EXSR SLRVGN
     C                     MOVEL*BLANK    WUR4TX           Date (Alpha) US
     C                     MOVELYL0017    WUR4TX           Date (Alpha) US
     C                     Z-ADD6         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWUR4TX:ZQ WUT7TX    P  90  Date (Char-6) U
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           '20'      CAT  WUT7TX:ZQ YL0018    P      Date (Char-8) U
     C                     MOVE YL0018    WN0083           PFS Newest Date
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * ** CREATE ORDER HEADER
      *================================================================
     C                     Z-ADDWFAIC3    WN0002           PFS Company Num
     C                     Z-ADDWFC4NB    WN0003           PFS Order Numbe
     C                     Z-ADDYL0007    WN0004           PFS Load ID
     C                     Z-ADDYL0005    WN0005           PFS Load Stop N
     C                     MOVELWFJNCD    WN0006           PFS Order Type
     C                     Z-ADDWFBKC7    WN0007           PFS Ship To Cus
     C                     MOVELWFBRTX    WN0008           PFS Ship To Cus
     C                     MOVELWFHMNA    WN0009           PFS Ship To Cus
     C                     MOVELWFHONA    WN0010           PFS Ship To Cus
     C                     MOVELWFHPNA    WN0011           PFS Ship To Cus
     C                     MOVELWFHNNA    WN0012           PFS Ship To Cus
     C                     MOVELWFDBCD    WN0013           PFS Ship To Cus
     C                     MOVELWFCKTX    WN0014           PFS Ship To Cus
      * Rtv All Values        RT - Customer EXT  * 
     C                     EXSR TERVGN
      * RTV Customer Telephone RT - Customer  * 
     C                     EXSR TFRVGN
     C                     Z-ADDWFB0C7    WN0017           PFS Bill To Cus
     C                     MOVELWFAETX    WN0018           PFS Bill To Cus
     C                     MOVELWFB1NA    WN0019           PFS Bill To Cus
     C                     MOVELWFB3NA    WN0020           PFS Bill To Cus
     C                     MOVELWFB4NA    WN0021           PFS Bill To Cus
     C                     MOVELWFB2NA    WN0022           PFS Bill To Cus
     C                     MOVELWFBHCD    WN0023           PFS Bill To Cus
     C                     MOVELWFC8TX    WN0024           PFS Bill To Cus
     C                     MOVELWFBCNA    WN0025           PFS Customer PO
      *
     C                     MOVEL*BLANK    WN0119  8        Date (Char-8) U
     C                     MOVEL*BLANK    WN0120  4        Year Alpha (YYY
     C                     MOVEL*BLANK    WN0121  2        Month (Char) US
     C                     MOVEL*BLANK    WN0122  2        Day   (Char) US
      *
      * CNV cyymmdd to yyyymmdd
      * LCL.Year Code = PAR.Date In  (7,0) USR *YEAR
     C           WFA0DT    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    YL0028
      * LCL.Month NBR USR = PAR.Date In  (7,0) USR *MONTH
     C           WFA0DT    ADD  1000000   XDINDT
     C                     Z-ADDXDINMM    YL0029
      * LCL.Day of Month USR = PAR.Date In  (7,0) USR *DAY OF MONTH
     C           WFA0DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD0         XDINDD
     C                     EXSR XCVTA
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
     C                     MOVE XDURR     YL0030
     C                     MOVEL*BLANK    WN0120           Year Alpha (YYY
     C                     MOVELYL0028    WN0120           Year Alpha (YYY
     C                     MOVELYL0029    WN0121           Month (Char) US
     C                     MOVELYL0030    WN0122           Day   (Char) US
     C                     Z-ADD0         ZQ      50
     C           WN0120    CAT  WN0121:ZQ WN0119    P      Date (Char-8) U
     C                     Z-ADD0         ZQ      50
     C           WN0119    CAT  WN0122:ZQ WN0119    P      Date (Char-8) U
     C                     MOVE WN0119    WN0026           Date Out (8,0)
      *
     C                     MOVEL*BLANK    WN0123  8        Date (Char-8) U
     C                     MOVEL*BLANK    WN0124  4        Year Alpha (YYY
     C                     MOVEL*BLANK    WN0125  2        Month (Char) US
     C                     MOVEL*BLANK    WN0126  2        Day   (Char) US
      *
      * CNV cyymmdd to yyyymmdd
      * LCL.Year Code = PAR.Date In  (7,0) USR *YEAR
     C           WFAODT    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    YL0028
      * LCL.Month NBR USR = PAR.Date In  (7,0) USR *MONTH
     C           WFAODT    ADD  1000000   XDINDT
     C                     Z-ADDXDINMM    YL0029
      * LCL.Day of Month USR = PAR.Date In  (7,0) USR *DAY OF MONTH
     C           WFAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD0         XDINDD
     C                     EXSR XCVTA
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
     C                     MOVE XDURR     YL0030
     C                     MOVEL*BLANK    WN0124           Year Alpha (YYY
     C                     MOVELYL0028    WN0124           Year Alpha (YYY
     C                     MOVELYL0029    WN0125           Month (Char) US
     C                     MOVELYL0030    WN0126           Day   (Char) US
     C                     Z-ADD0         ZQ      50
     C           WN0124    CAT  WN0125:ZQ WN0123    P      Date (Char-8) U
     C                     Z-ADD0         ZQ      50
     C           WN0123    CAT  WN0126:ZQ WN0123    P      Date (Char-8) U
     C                     MOVE WN0123    WN0027           Date Out (8,0)
     C                     Z-ADD0         YL0031           LD Carrier Appt
     C                     Z-ADD0         YL0032           LD Carrier Appt
      * E4119 RMC 9/2/16 TMS Use appt date/time if there, else use req de
      * CASE: DB1.OH Load Plan Ready is Yes
     C           WFFVSX    IFEQ 'Y'                        *IF
      * RTV Carr Appt Dt/Tm   RT - Load Detail  * 
     C                     EXSR TGRVGN
     C                     END                             *FI
      * CASE: LCL.LD Carrier Appt Date is Entered
     C           YL0031    IFGT 0                          *IF
      *
     C                     MOVEL*BLANK    WN0127  8        Date (Char-8) U
     C                     MOVEL*BLANK    WN0128  4        Year Alpha (YYY
     C                     MOVEL*BLANK    WN0129  2        Month (Char) US
     C                     MOVEL*BLANK    WN0130  2        Day   (Char) US
      *
      * CNV cyymmdd to yyyymmdd
      * LCL.Year Code = PAR.Date In  (7,0) USR *YEAR
     C           YL0031    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    YL0028
      * LCL.Month NBR USR = PAR.Date In  (7,0) USR *MONTH
     C           YL0031    ADD  1000000   XDINDT
     C                     Z-ADDXDINMM    YL0029
      * LCL.Day of Month USR = PAR.Date In  (7,0) USR *DAY OF MONTH
     C           YL0031    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD0         XDINDD
     C                     EXSR XCVTA
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
     C                     MOVE XDURR     YL0030
     C                     MOVEL*BLANK    WN0128           Year Alpha (YYY
     C                     MOVELYL0028    WN0128           Year Alpha (YYY
     C                     MOVELYL0029    WN0129           Month (Char) US
     C                     MOVELYL0030    WN0130           Day   (Char) US
     C                     Z-ADD0         ZQ      50
     C           WN0128    CAT  WN0129:ZQ WN0127    P      Date (Char-8) U
     C                     Z-ADD0         ZQ      50
     C           WN0127    CAT  WN0130:ZQ WN0127    P      Date (Char-8) U
     C                     MOVE WN0127    WN0028           Date Out (8,0)
     C                     Z-ADDYL0032    WN0029           PFS Requested D
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     MOVEL*BLANK    WN0131  8        Date (Char-8) U
     C                     MOVEL*BLANK    WN0132  4        Year Alpha (YYY
     C                     MOVEL*BLANK    WN0133  2        Month (Char) US
     C                     MOVEL*BLANK    WN0134  2        Day   (Char) US
      *
      * CNV cyymmdd to yyyymmdd
      * LCL.Year Code = PAR.Date In  (7,0) USR *YEAR
     C           WFEIDT    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    YL0028
      * LCL.Month NBR USR = PAR.Date In  (7,0) USR *MONTH
     C           WFEIDT    ADD  1000000   XDINDT
     C                     Z-ADDXDINMM    YL0029
      * LCL.Day of Month USR = PAR.Date In  (7,0) USR *DAY OF MONTH
     C           WFEIDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD0         XDINDD
     C                     EXSR XCVTA
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
     C                     MOVE XDURR     YL0030
     C                     MOVEL*BLANK    WN0132           Year Alpha (YYY
     C                     MOVELYL0028    WN0132           Year Alpha (YYY
     C                     MOVELYL0029    WN0133           Month (Char) US
     C                     MOVELYL0030    WN0134           Day   (Char) US
     C                     Z-ADD0         ZQ      50
     C           WN0132    CAT  WN0133:ZQ WN0131    P      Date (Char-8) U
     C                     Z-ADD0         ZQ      50
     C           WN0131    CAT  WN0134:ZQ WN0131    P      Date (Char-8) U
     C                     MOVE WN0131    WN0028           Date Out (8,0)
     C           100       MULT WFAFTM    WN0029           PFS Requested D
     C                     END                             *FI
     C                     MOVELWFU2ST    WN0030           PFS Export Stat
      * RTV Country Code only  RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWFAIC3    WL0014           Company Number
     C                     Z-ADDWFC4NB    WL0015           Order Number
     C                     EXSR TARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0016    WN0031    P      Country Code
      * ** 01/14/2009 LJB FP1303 Retrieve new delivery p.o.number
      * RTV OHE Delivery PO #  RT - Order Header Extension  * 
     C                     EXSR THRVGN
      * CASE: PAR.PFS Country Code is Not Entered
     C           WN0031    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    WN0031           PFS Country Cod
     C                     MOVEL'USA'     WN0031           PFS Country Cod
     C                     END                             *FI
     C                     MOVELWFB6NA    WN0032           PFS Special Ins
     C                     MOVELWFBYNA    WN0033           PFS Special Ins
     C                     Z-ADDWFBPTM    WN0034           PFS Maximum Gro
     C                     Z-ADDYL0013    WN0035           PFS Estimated P
      * avg pallet tare
      * CASE: LCL.Number Pallets Loaded is Not zero
     C           YL0013    IFNE 0                          *IF
     C           YL0014    DIV  YL0013    WN0036    H      PFS Average Pal
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD0         WN0036           PFS Average Pal
     C                     END                             *FI
      * RTV From/To WHS   PFS RT - Order Detail  * 
     C                     EXSR TIRVGN
      * Warehouse CFH to CF1
      * CASE: PAR.PFS Ship From Warehouse is CFH
     C           WN0038    IFEQ 'CFH'                      *IF
     C                     MOVEL'CF1'     WN0038           PFS Ship From W
     C                     END                             *FI
      * PFS Ship To Warehouse for Transfers
      * CASE: DB1.Order Type - Sales is Transfer Order
     C           WFJNCD    IFEQ 'TR'                       *IF
      * Rtv Default Warehouse  RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWFAIC3    WL0001           Company Number
     C                     Z-ADDWFBKC7    WL0002           Ship To Custome
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    WN0039    P      Warehouse Code
     C                     END                             *FI
      * invoiced status
      * CASE: DB1.Invoice Number is GT Zero
     C           WFCONB    IFGT 0                          *IF
     C                     MOVEL'C'       WN0037           PFS Order Statu
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWFGWST    WN0037           PFS Order Statu
     C                     END                             *FI
      * --------
      * load status
      * CASE: PAR.Load Status is Unlock
     C           P3PKST    IFEQ 'U'                        *IF
     C                     MOVEL'D'       WN0059           PFS Record Stat
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'C'       WN0059           PFS Record Stat
     C                     END                             *FI
      * PFS015 RMC 8/14/06
      * CASE: PAR.Receipt Order Sts USR is yes
     C           'N'       IFEQ 'Y'                        *IF
     C                     MOVEL'RO'      WN0006           PFS Order Type
     C                     END                             *FI
      * **************************************************************
      * ** FP1101-4 LJB 04/06/2007
      * ** Get Customer Order Export Instructions from OHE
      * CASE: DB1.Export Status is yes
     C           WFU2ST    IFEQ 'Y'                        *IF
      * ** FP1101
     C                     MOVELWFU2ST    WN0030           PFS Export Stat
      * RTV PFS Export Inst    RT - Order Header Extension  * 
     C                     EXSR TJRVGN
      * ** Shipping line and port terminal info
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.PFS Shipping Line is Entered
      *   |- c2    : PAR.Port Delv Terminal is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0041    IFNE *BLANK                     *IF
     C           YL0002    IFNE *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Shipping Line/PortsRT - Shipping Line/Port  * 
     C                     EXSR TKRVGN
     C                     MOVEL*BLANK    WN0042           PFS Shipping Li
     C                     MOVELYL0002    WN0042           PFS Shipping Li
     C                     MOVEL*BLANK    WN0016           PFS Ship To Pho
     C                     MOVELYL0041    WN0016           PFS Ship To Pho
     C                     END                             *FI
     C                     END                             *FI
      * ** Update includes new Order Header Extension file export data
      * 07/12/19 DN R15161-Sent in PAR.PFS Load Unused Text 1.
      * Upd Order Header      RT - PFS Order Header  * 
     C                     EXSR TLRVGN
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDUDY     BEGSR
      *================================================================
      * Calculate duration, *DAYS
      *================================================================
     C           XDAY1     IFLT 1
     C           XDAY2     ORLT 1
     C                     Z-ADD0         XDURR
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     GOTO XDUDYE
     C                     END
     C           XDAY1     IFGE XDAY2
      * From date2 to date1
     C                     Z-ADDXDAY2     XABEG   60
     C                     Z-ADDXDAY1     XAEND   60
     C                     ELSE
      * From date1 to date2
     C                     Z-ADDXDAY1     XABEG   60
     C                     Z-ADDXDAY2     XAEND   60
     C                     END
     C           XDWSL     IFEQ 0
      * None days of week selected
     C                     Z-ADD0         XDURR
     C                     GOTO XDUDYC
     C                     END
     C           XAEND     SUB  XABEG     XDURR   80
     C           XDWSL     IFEQ 7
      * All days of week selected
     C                     GOTO XDUDYC
     C                     END
      * Some days of week selected
     C                     DIV  7         XDURR
     C                     MVR            XDLSW   10
     C                     MULT XDWSL     XDURR
     C           XDLSW     IFNE 0
      * Determine day of week of the beginning date
     C           XABEG     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
      * Loop: Increment the date by the last week
     C           XDLSW     DOWGT0
      * Increment the day of week
     C                     ADD  1         YY
     C                     SUB  1         XDLSW
      * Put day of week into the range 1-7
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     END
      * Selected day of the last week has been processed
     C           YDOW,YY   IFEQ XDSEL
      * Increment duration
     C                     ADD  1         XDURR
     C                     END
      * End of loop
     C                     END
     C                     END
     C           XDUDYC    TAG
     C           XDURR     IFEQ 0
      * Return Code: Unable to calculate duration
     C                     MOVEL'Y2U0060' W0RTN   7
     C                     ELSE
     C                     MOVEL*BLANK    W0RTN   7
     C                     END
      *================================================================
     CSR         XDUDYE    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P4PAOU           Number Pallets
     C                     Z-ADD*ZERO     P5IVWG           Weight 1 USR
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WARPNB           Total Load Orde
     C                     Z-ADD*ZERO     WAFLAM           Flat Amount
     C                     Z-ADD*ZERO     WARRNB           Total Stops
     C                     Z-ADD*ZERO     WASBNB           BOL Time
     C                     Z-ADD*ZERO     WASQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WASDNB           Number Pallets
     C                     Z-ADD*ZERO     WAPAOU           Number Pallets
     C                     Z-ADD*ZERO     WADGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WASXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WAHADT           Actual Arrival
     C                     Z-ADD*ZERO     WAAART           Actual Arrival
     C                     Z-ADD*ZERO     WADHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WADIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WAAQDT           Actual Departur
     C                     Z-ADD*ZERO     WAS6NB           Departure Time
     C                     Z-ADD*ZERO     WAT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WAPRTM           Product Tempera
     C                     Z-ADD*ZERO     WANPSV           Number Spacers
     C                     Z-ADD*ZERO     WATLMI           Total Load Mile
     C                     Z-ADD*ZERO     WAGRWE           Gross Weight
     C                     Z-ADD*ZERO     WAF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WAJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WATRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WAJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WASPTM           Spotted Time
     C                     Z-ADD*ZERO     WAJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WALFTM           Load Finished T
     C                     Z-ADD*ZERO     WAJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WABOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WAJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WABLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WAKIDT           Truck Departure
     C                     Z-ADD*ZERO     WAASTM           Truck Departure
     C                     Z-ADD*ZERO     WAKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WAAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WAVOAG           Voyage
     C                     Z-ADD*ZERO     WAKBDT           Sail Date
     C                     Z-ADD*ZERO     WAEFDT           Arrival Date
     C                     Z-ADD*ZERO     WAKCDT           Date In
     C                     Z-ADD*ZERO     WATMIN           Time In
     C                     Z-ADD*ZERO     WAKDDT           Date Out
     C                     Z-ADD*ZERO     WAVMNB           Time Out
     C                     Z-ADD*ZERO     WAOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WAKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WAATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WABRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAKKDT           On Yard Date
     C                     Z-ADD*ZERO     WAAVTM           On Yard Time
     C                     Z-ADD*ZERO     WAKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WAAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WALLDT           Express Mail Da
     C                     Z-ADD*ZERO     WAK0DT           Product Complet
     C                     Z-ADD*ZERO     WAAYTM           Product Complet
     C                     Z-ADD*ZERO     WAKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WAICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WAIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WAK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WAAZTM           Load Door 1
     C                     Z-ADD*ZERO     WAK2DT           Override Total
     C                     Z-ADD*ZERO     WAA0TM           Load Door 2
     C                     Z-ADD*ZERO     WAZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WAPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WACKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WAPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WACLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WAP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WACMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WAP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WACNTM           LH Unused Time
     C                     Z-ADD*ZERO     WAP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WACOTM           LH Unused Time
     C                     Z-ADD*ZERO     WAP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WACQTM           LH Unused Time
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WBRVNB           Stop/Drop
     C                     Z-ADD*ZERO     WBRWNB           Miles to next s
     C                     Z-ADD*ZERO     WBRXNB           Freight Charge
     C                     Z-ADD*ZERO     WBSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WBT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     WBT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WBSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WBKFDT           Appointment Con
     C                     Z-ADD*ZERO     WBACTM           Appointment Con
     C                     Z-ADD*ZERO     WBEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WBAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WBKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WBATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WBHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WBAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WBKKDT           On Yard Date
     C                     Z-ADD*ZERO     WBAVTM           On Yard Time
     C                     Z-ADD*ZERO     WBZ4NB           MPC Number
     C                     Z-ADD*ZERO     WBN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WBN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WBN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WBB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WBB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WBB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCM8NB           System Value Nu
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDDPNB           Order Sequence
     C                     Z-ADD*ZERO     WDUENB           Order Secondary
     C                     Z-ADD*ZERO     WDHGCD           Item Code
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WDMAVA           Billing Detail
     C                     Z-ADD*ZERO     WDKDVA           Billing Detail
     C                     Z-ADD*ZERO     WDL8VA           Billing Detail
     C                     Z-ADD*ZERO     WDL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WDAYVA           Extended Amount
     C                     Z-ADD*ZERO     WDEXDT           Market Pricing
     C                     Z-ADD*ZERO     WDBZPR           Price Overage O
     C                     Z-ADD*ZERO     WDL6NB           Contract Number
     C                     Z-ADD*ZERO     WDGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WDD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WDCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WDAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WDCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WDATWG           Weight Shipped
     C                     Z-ADD*ZERO     WDAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WDAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WDAKPR           Unit Price
     C                     Z-ADD*ZERO     WDALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WDAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WDAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WDA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WDA5DT           Requested Ship
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WDRGNB           Item Structure
     C                     Z-ADD*ZERO     WDRHNB           Item Structure
     C                     Z-ADD*ZERO     WDRINB           Item Structure
     C                     Z-ADD*ZERO     WDCXDT           Date of Origina
     C                     Z-ADD*ZERO     WDDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WDB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WDA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WDNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WDNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WDNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WDNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WDNXDT           OD Unused Date
     C                     Z-ADD*ZERO     WDBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WDBVTM           Price Code
     C                     Z-ADD*ZERO     WDBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WDBXTM           Substitution Li
     C                     Z-ADD*ZERO     WDBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WDH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WDH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WDH7NX           OD Item Target
     C                     Z-ADD*ZERO     WDH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WDH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WDDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WDDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WDDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WDDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WDDZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WDGSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     WDGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WDGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WDPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WDRINY           Item Age Days
     C                     Z-ADD*ZERO     WDTIDT           Production Ovr
     C                     Z-ADD*ZERO     WDTJDT           Production Ovr
     C                     Z-ADD*ZERO     WDTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WDTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WDTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WEBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WEBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WEBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WEBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Define work field Header Status
     C                     MOVEL*BLANK    WUGWST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFC4NB           Order Number
     C                     Z-ADD*ZERO     WFANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WFBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WFB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WFA0DT           Order Date
     C                     Z-ADD*ZERO     WFA5DT           Requested Ship
     C                     Z-ADD*ZERO     WFGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WFACDT           Cancel Date
     C                     Z-ADD*ZERO     WFAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WFCXDT           Date of Origina
     C                     Z-ADD*ZERO     WFJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WFA1WG           Order Weight To
     C                     Z-ADD*ZERO     WFEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WFAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WFRMNB           Load ID
     C                     Z-ADD*ZERO     WFTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WFR1NB           Rated Freight
     C                     Z-ADD*ZERO     WFRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WFATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WFRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WFT3NB           Attach to Order
     C                     Z-ADD*ZERO     WFCONB           Invoice Number
     C                     Z-ADD*ZERO     WFAWDT           Invoice Date
     C                     Z-ADD*ZERO     WFVRVA           A/R order Value
     C                     Z-ADD*ZERO     WFB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WFNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WFNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WFNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WFNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WFNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WFBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WFBQTM           Time of Origina
     C                     Z-ADD*ZERO     WFBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WFBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WFBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WFH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WFH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WFH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WFH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WFH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WFC0C7           Claim Number
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Define work field Plant Company Sts
     C                     MOVEL*BLANK    WUYISX  1
      * Define work field Company Organization
     C                     MOVEL*BLANK    WUYJSX  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WHP3NB           D & B Number
     C                     Z-ADD*ZERO     WHI6DT           Date of D & B R
     C                     Z-ADD*ZERO     WHAYDT           Credit Line Exp
     C                     Z-ADD*ZERO     WHANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WHBTC7           Parent Customer
     C                     Z-ADD*ZERO     WHS2NB           Parent Credit L
     C                     Z-ADD*ZERO     WHVHVA           A/R Credit Limi
     C                     Z-ADD*ZERO     WHI7DT           Order Entry Hol
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WIHGCD           Item Code
     C                     Z-ADD*ZERO     WIMJDT           Create Date
     C                     Z-ADD*ZERO     WIBETM           Create Time
     C                     Z-ADD*ZERO     WIMKDT           Change Date
     C                     Z-ADD*ZERO     WIBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WJR5NB           Deliver after t
     C                     Z-ADD*ZERO     WJR6NB           Deliver before
     C                     Z-ADD*ZERO     WJTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WJMTCU           Mileage To Cust
     C                     Z-ADD*ZERO     WJW2NB           Co/Cust Overage
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Define work field BLANK 1               USR
     C                     MOVEL*BLANK    WUJ1TX 25
      * Define work field Error Flag            USR
     C                     MOVEL*BLANK    WUB8SX  1
      * Define work field Error Reason Descript 1
     C                     MOVEL*BLANK    WUKWTX 30
      * Define work field Error Reason Descript 2
     C                     MOVEL*BLANK    WUKXTX 30
      * Define work field Error Reason Descript 3
     C                     MOVEL*BLANK    WUKYTX 30
      * Define work field Error Reason Descript 4
     C                     MOVEL*BLANK    WUKZTX 30
      * Define work field Error Reason Descript 5
     C                     MOVEL*BLANK    WUTITX 30
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Blank for 30          USR
     C                     MOVEL*BLANK    WUW4TX 30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKBCDT           Post to G/L Dat
     C                     Z-ADD*ZERO     WKCQNB           Julian Date
     C                     Z-ADD*ZERO     WKESNB           Accounting Year
     C                     Z-ADD*ZERO     WKETNB           Accounting Peri
     C                     Z-ADD*ZERO     WKBZNB           OM Week
     C                     Z-ADD*ZERO     WKEINB           Week Number
     C                     Z-ADD*ZERO     WKAQNB           Billing Cycle
     C                     Z-ADD*ZERO     WKOJDT           HPS PIC Date
     C                     Z-ADD*ZERO     WKNQNX           HPS Calendar Ye
     C                     Z-ADD*ZERO     WKNRNX           HPS Calendar We
     C                     Z-ADD*ZERO     WKOKDT           Calendar Unused
     C                     Z-ADD*ZERO     WKOLDT           Calendar Unused
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Define work field Date (Alpha) USR
     C                     MOVEL*BLANK    WUR4TX  7
      * Define work field Date (Char-6) USR
     C                     MOVEL*BLANK    WUT7TX  6
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLAIC3           Company Number
     C                     Z-ADD*ZERO     WLHGCD           Item Code
     C                     Z-ADD*ZERO     WLC9NB           Component Item
     C                     Z-ADD*ZERO     WLBOPR           Sales Yield
     C                     Z-ADD*ZERO     WLBPPR           Production Yiel
     C                     Z-ADD*ZERO     WLHGQT           Packaging Quant
     C                     Z-ADD*ZERO     WLCNSM           Consume Priorit
     C                     Z-ADD*ZERO     WLBMY1           Consume Priorit
     C                     Z-ADD*ZERO     WLBMY2           BOM Pumped Perc
     C                     Z-ADD*ZERO     WLIXQT           BOM Meat Cost C
     C                     Z-ADD*ZERO     WLIYQT           BOM Off Line Yi
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMAIC3           Company Number
     C                     Z-ADD*ZERO     WMHGCD           Item Code
     C                     Z-ADD*ZERO     WMAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WMAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WMAIWG           Unit Weight
     C                     Z-ADD*ZERO     WMCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WMC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WMURTN           Number Cases On
     C                     Z-ADD*ZERO     WMAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WMRINB           Item Structure
     C                     Z-ADD*ZERO     WMRHNB           Item Structure
     C                     Z-ADD*ZERO     WMRGNB           Item Structure
     C                     Z-ADD*ZERO     WMTFNB           Transportation
     C                     Z-ADD*ZERO     WMTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WMTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WMBLPR           Market Overage
     C                     Z-ADD*ZERO     WMBMPR           Standard Overag
     C                     Z-ADD*ZERO     WMCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WMCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WMSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WMPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WMICN1           Item Category N
     C                     Z-ADD*ZERO     WMICN2           Item Category N
     C                     Z-ADD*ZERO     WMV2NB           Item Category N
     C                     Z-ADD*ZERO     WMITCN           Item Category N
     C                     Z-ADD*ZERO     WMITC5           Item Category N
     C                     Z-ADD*ZERO     WMICN6           Item Category N
     C                     Z-ADD*ZERO     WMICN7           Item Category N
     C                     Z-ADD*ZERO     WMICN8           Item Category N
     C                     Z-ADD*ZERO     WMICN9           Item Category N
     C                     Z-ADD*ZERO     WMICN0           Item Category N
     C                     Z-ADD*ZERO     WMSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WMA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WMSJNB           Production Lead
     C                     Z-ADD*ZERO     WMSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WMSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WMSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WMCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WMCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WMILNB           Packages per ca
     C                     Z-ADD*ZERO     WMCHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WMCINB           PM Batch Size
     C                     Z-ADD*ZERO     WMCJNB           Package Level s
     C                     Z-ADD*ZERO     WMCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WMCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WMCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WMCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WMCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WMCWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WMCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WMCZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WMC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WMB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WMB5NB           PM Line Number
     C                     Z-ADD*ZERO     WMBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WMBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WMF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WMF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WMF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WMBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WMBNNB           Production Qty
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOY1NX           PFS Company Num
     C                     Z-ADD*ZERO     WOZPNX           PFS Order Numbe
     C                     Z-ADD*ZERO     WOZXNX           PFS Order Line
     C                     Z-ADD*ZERO     WOZYNX           PFS Substitutio
     C                     Z-ADD*ZERO     WOY2NX           PFS Item Code
     C                     Z-ADD*ZERO     WOZFNX           PFS Scheduled Q
     C                     Z-ADD*ZERO     WOZZNX           PFS Scheduled W
     C                     Z-ADD*ZERO     WOZ0NX           PFS Maximum Net
     C                     Z-ADD*ZERO     WOBINY           PFS Minimum Uni
     C                     Z-ADD*ZERO     WOBJNY           PFS Maximum Uni
     C                     Z-ADD*ZERO     WOBKNY           PFS Estimated P
     C                     Z-ADD*ZERO     WOATNY           PFS Average Pal
     C                     Z-ADD*ZERO     WOALD8           PFS Oldest Date
     C                     Z-ADD*ZERO     WOAMD8           PFS Newest Date
     C                     Z-ADD*ZERO     WOF5NY           PFS Sequence No
     C                     Z-ADD*ZERO     WOUXSX           PFS Process Sta
     C                     Z-ADD*ZERO     WOAHNY           PFS Create Date
     C                     Z-ADD*ZERO     WOAINY           PFS Create Time
     C                     Z-ADD*ZERO     WOAJNY           PFS Change Date
     C                     Z-ADD*ZERO     WOAKNY           PFS Change time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WSAIC3           Company Number
     C                     Z-ADD*ZERO     WSC4NB           Order Number
     C                     Z-ADD*ZERO     WSRMNB           Load ID
     C                     Z-ADD*ZERO     WSRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WSQWDT           OHE Sail/Flight
     C                     Z-ADD*ZERO     WSQXDT           OHE Port Cut Da
     C                     Z-ADD*ZERO     WSQYDT           OHE Arrival Dat
     C                     Z-ADD*ZERO     WSGINY           OHE Unused Numb
     C                     Z-ADD*ZERO     WSGFNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WSGGNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WSGHNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WSHEVL           OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WSHFVL           OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WSHGVL           Transload Termi
     C                     Z-ADD*ZERO     WSQZDT           OHE Est Arrv at
     C                     Z-ADD*ZERO     WSQ0DT           OHE Backhaul ET
     C                     Z-ADD*ZERO     WSQ1DT           OHE Port/Pier P
     C                     Z-ADD*ZERO     WSQ2DT           OHE Actual Ship
     C                     Z-ADD*ZERO     WSITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WSQJNY           OHE Backhaul Re
     C                     Z-ADD*ZERO     WSQKNY           LD Stop/Drop
     C                     Z-ADD*ZERO     WSQLNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WSP8NY           OHE Pier Pass F
     C                     Z-ADD*ZERO     WSP9NY           OHE Port Check
     C                     Z-ADD*ZERO     WSQANY           OHE Port Cut Ti
     C                     Z-ADD*ZERO     WSQCNY           OHE Backhaul Tr
     C                     Z-ADD*ZERO     WSQDNY           OHE Load Sched
     C                     Z-ADD*ZERO     WSQENY           Original Appoin
     C                     Z-ADD*ZERO     WSQFNY           Original Appoin
     C                     Z-ADD*ZERO     WSQGNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WSQHNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WSQINY           OHE Unused Nume
     C                     Z-ADD*ZERO     WSQMNY           OHE Orig ABS Fr
     C                     Z-ADD*ZERO     WSW5DT           OHE Unused Date
     C                     Z-ADD*ZERO     WSW6DT           OHE Unused Date
     C                     Z-ADD*ZERO     WSAATM           Job Time
     C                     Z-ADD*ZERO     WSAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WTAIC3           Company Number
     C                     Z-ADD*ZERO     WTXXTM           Departure Time
     C                     Z-ADD*ZERO     WTAATM           Job Time
     C                     Z-ADD*ZERO     WTAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WVY1NX           PFS Company Num
     C                     Z-ADD*ZERO     WVZPNX           PFS Order Numbe
     C                     Z-ADD*ZERO     WVZ1NX           PFS Sequence Nu
     C                     Z-ADD*ZERO     WVUXSX           PFS Process Sta
     C                     Z-ADD*ZERO     WVAHNY           PFS Create Date
     C                     Z-ADD*ZERO     WVAINY           PFS Create Time
     C                     Z-ADD*ZERO     WVAJNY           PFS Change Date
     C                     Z-ADD*ZERO     WVAKNY           PFS Change time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WXAIC3           Company Number
     C                     Z-ADD*ZERO     WXC4NB           Order Number
     C                     Z-ADD*ZERO     WXDXNB           Sequence Number
     C                     Z-ADD*ZERO     WXAATM           Job Time
     C                     Z-ADD*ZERO     WXAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WYM5NX           Comment Sequenc
     C                     Z-ADD*ZERO     WYAATM           Job Time
     C                     Z-ADD*ZERO     WYAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TABKC7           Ship To Custome
     C                     Z-ADD*ZERO     TAM5NX           Comment Sequenc
     C                     Z-ADD*ZERO     TAAATM           Job Time
     C                     Z-ADD*ZERO     TAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     TBAAC8           Customer G/L Ve
     C                     Z-ADD*ZERO     TBAATM           Job Time
     C                     Z-ADD*ZERO     TBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TDSPPN           Port Phone Numb
     C                     Z-ADD*ZERO     TDAATM           Job Time
     C                     Z-ADD*ZERO     TDAXDT           Job Date
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    W0WJ00 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SKRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003  3
      * Define local variables for subroutine SWRVGN.
     C                     Z-ADD*ZERO     WL0004  30
     C                     Z-ADD*ZERO     WL0005  70
     C                     MOVEL*BLANK    WL0006  2
     C                     Z-ADD*ZERO     WL0007  30
      * Define local variables for subroutine SXRVGN.
     C                     Z-ADD*ZERO     WL0008  30
     C                     Z-ADD*ZERO     WL0009  70
     C                     MOVEL*BLANK    WL0010  2
     C                     Z-ADD*ZERO     WL0011  30
     C                     MOVEL*BLANK    WL0012 60
     C                     MOVEL*BLANK    WL0013  1
      * Define local variables for subroutine TARVGN.
     C                     Z-ADD*ZERO     WL0014  30
     C                     Z-ADD*ZERO     WL0015  70
     C                     MOVEL*BLANK    WL0016  6
      * Define local variables for subroutine TBRVGN.
     C                     MOVEL*BLANK    WL0017  6
     C                     MOVEL*BLANK    WL0018  2
     C                     Z-ADD*ZERO     WL0019  30
     C                     Z-ADD*ZERO     WL0020  70
     C                     MOVEL*BLANK    WL0021  1
      * Define local variables for subroutine TDRVGN.
     C                     MOVEL*BLANK    WL0022  6
     C                     MOVEL*BLANK    WL0023  2
     C                     Z-ADD*ZERO     WL0024  30
     C                     Z-ADD*ZERO     WL0025  70
     C                     MOVEL*BLANK    WL0026  1
      * Define local work field Carrier Code
     C                     MOVEL*BLANK    YL0001  3
      * Define local work field Port Delv Terminal
     C                     MOVEL*BLANK    YL0002 20
      * Define local work field First Time Flag
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field Stop/Drop Sequence Alpha
     C                     MOVEL*BLANK    YL0004  5
      * Define local work field Stop/Drop
     C                     Z-ADD*ZERO     YL0005  50
      * Define local work field PFS Sequence No.
     C                     Z-ADD*ZERO     YL0006  90
      * Define local work field Load ID
     C                     Z-ADD*ZERO     YL0007  70
      * Define local work field PFS Loading Sequence
     C                     Z-ADD*ZERO     YL0008  20
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0009  3
      * Define local work field WHS Live w/Carlisle
     C                     MOVEL*BLANK    YL0010  1
      * Define local work field WHS Live w/Carlisle
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field WHS PFS Interface
     C                     MOVEL*BLANK    YL0012  1
      * Define local work field Number Pallets Loaded
     C                     Z-ADD*ZERO     YL0013  50
      * Define local work field Weight 1 USR
     C                     Z-ADD*ZERO     YL0014 112
      * Define local work field Item Reference Status
     C                     MOVEL*BLANK    YL0015  1
      * Define null work field CIR Item No
     C                     MOVEL*BLANK    YN0001 10
      * Define null work field CIR Description Line 1
     C                     MOVEL*BLANK    YN0002 30
      * Define null work field CIR Description Line 2
     C                     MOVEL*BLANK    YN0003 30
      * Define null work field CIR Description Line 3
     C                     MOVEL*BLANK    YN0004 30
      * Define local work field Error Status
     C                     MOVEL*BLANK    YL0016  1
      * Define local work field Production Date Prev USR
     C                     Z-ADD*ZERO     YL0017  70
      * Define local work field Date (Char-8) USR
     C                     MOVEL*BLANK    YL0018  8
      * Define local work field Number Cases On A Pallet
     C                     Z-ADD*ZERO     YL0019  50
      * Define local work field Pallet Tare Weight
     C                     Z-ADD*ZERO     YL0020  52
      * Define local work field OHE Intended for ExportCC
     C                     MOVEL*BLANK    YL0021  6
      * Define local work field Plant Company Sts
     C                     MOVEL*BLANK    YL0022  1
      * Define local work field Company Organization
     C                     MOVEL*BLANK    YL0023  1
      * Define local work field PFS Sequence Number
     C                     Z-ADD*ZERO     YL0024  30
      * Define local work field Country Code
     C                     MOVEL*BLANK    YL0025  6
      * Define local work field PFS Sequence Number
     C                     Z-ADD*ZERO     YL0026  30
      * Define local work field PFS Record Status
     C                     MOVEL*BLANK    YL0027  1
      * Define null work field Internet Password
     C                     MOVEL*BLANK    YN0005 10
      * Define null work field Email User ID
     C                     MOVEL*BLANK    YN0006  8
      * Define null work field EDI Trading Partner No.
     C                     MOVEL*BLANK    YN0007  6
      * Define null work field EDI Cust Duns Number
     C                     MOVEL*BLANK    YN0008 20
      * Define null work field EDI Warehouse/Store No.
     C                     MOVEL*BLANK    YN0009 20
      * Define null work field State Tax ID
     C                     MOVEL*BLANK    YN0010 20
      * Define null work field Cust Shipping Temp C/F
     C                     MOVEL*BLANK    YN0011  1
      * Define null work field One Invoice Per PO
     C                     MOVEL*BLANK    YN0012  1
      * Define null work field EDI Advanced Ship Notice
     C                     MOVEL*BLANK    YN0013  1
      * Define local work field Year Code
     C                     Z-ADD*ZERO     YL0028  40
      * Define local work field Month NBR USR
     C                     Z-ADD*ZERO     YL0029  20
      * Define local work field Day of Month USR
     C                     Z-ADD*ZERO     YL0030  20
      * Define local work field LD Carrier Appt Date
     C                     Z-ADD*ZERO     YL0031  70
      * Define local work field LD Carrier Appt Time
     C                     Z-ADD*ZERO     YL0032  60
      * Define local work field OHE Sail/Flight Date
     C                     Z-ADD*ZERO     YL0033  70
      * Define local work field OHE Port Cut Date
     C                     Z-ADD*ZERO     YL0034  70
      * Define local work field OHE Arrival Date
     C                     Z-ADD*ZERO     YL0035  70
      * Define local work field OHE Late Delivery Code
     C                     MOVEL*BLANK    YL0036  3
      * Define local work field OHE Ship Status
     C                     MOVEL*BLANK    YL0037  1
      * Define local work field OHE Container Number
     C                     MOVEL*BLANK    YL0038 12
      * Define local work field OHE Comment 1
     C                     MOVEL*BLANK    YL0039 35
      * Define local work field OHE Comment 2
     C                     MOVEL*BLANK    YL0040 75
      * Define local work field Port Phone Number
     C                     Z-ADD*ZERO     YL0041 110
      * Define null work field Port Fax Number
     C                     MOVEL*BLANK    YN0014 25
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 PFSSEQNO
