     H/TITLE Bld Prior Day Report  XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISRCENT
     H* Date          : 08/17/21  Time  : 17:06:55
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKC4REL1IF  E           K        DISK
      * RTV : Payment Processing Parms  Retrieval index
      *
     FPKE4CPL1IF  E           K        DISK
      * RTV : MPR Estimated Purchases   Retrieval index
      *
     FPKA1CP11IF  E           K        DISK
      * RSQ : Tattoo Header             Co/KlDte/Prd/PayTp/Tatoo
      *
     FPKAWCPL1IF  E           K        DISK
      * RTV : Buy Order Header          Retrieval index
      *
     FPKARREL3IF  E           K        DISK
      * RSQ : Carcass Merit Program     Active CMP only
      *
     FPKE3CPL1IF  E           K        DISK
      * RTV : MPR Producer Purch Type   Retrieval index
      *
     FPKA1CPL0IF  E           K        DISK
      * RTV : Tattoo Header             Retrieval index
      *
     FPKDNCPL1IF  E           K        DISK
      * RTV : Tattoo Header EXT         Retrieval index
      *
     FPKCDCPL8IF  E           K        DISK
      * RTV : Tattoo Ded/Add            Rtv Index - Seab's
      *
     FPKE6CPL1IF  E           K        DISK
      * RTV : MPR Prior Day Slaughtered Retrieval index
      *
     FPKAWCPLHIF  E           K        DISK
      * RSQ : Buy Order Header          Co/KIllDt
      *
     FPKAXCPL0IF  E           K        DISK
      * RTV : Buy Order Load            Retrieval index
      *
     FPKAFREL0IF  E           K        DISK
      * RTV : Producer Location         Retrieval index
      *
     FPKA1CPLIIF  E           K        DISK
      * RSQ : Tattoo Header             Co/Bol/Ttt
      *
     FPLATREL1IF  E           K        DISK
      * RTV : Producer Site             Retrieval index
      *
     FPKA1CPLFIF  E           K        DISK
      * RSQ : Tattoo Header             Co/BOL/Kill/Ttt
      *
     FPKAQCPL0IF  E           K        DISK
      * RTV : Producer Sub-Contract     Retrieval index
      *
     FPKE7CPL1IF  E           K        DISK
      * RTV : MPR Prior Day Purchased   Retrieval index
      *
     FPKAXCPL2IF  E           K        DISK
      * RSQ : Buy Order Load           Co/KillDte/DlvDte/DlvTme
      *
     FPKFHCPL1IF  E           K        DISK
      * RTV : MPR Prior Day Sched Dtl   Retrieval index
      *
     FPKAXCPL7IF  E           K        DISK
      * RSQ : Buy Order Load            Co/DelvDte
      *
     FPKE5CPL1IF  E           K        DISK
      * RTV : MPR Prior Day Scheduled   Retrieval index
      *
     FPKE4CPL0UF  E           K        DISK                      A
      * UPD : MPR Estimated Purchases   Update index
      *
     FPKE6CPL0UF  E           K        DISK                      A
      * UPD : MPR Prior Day Slaughtered Update index
      *
     FPKE7CPL0UF  E           K        DISK                      A
      * UPD : MPR Prior Day Purchased   Update index
      *
     FPKAXCPL1UF  E           K        DISK
      * UPD : Buy Order Load            Update index
      *
     FPKAWCPL0UF  E           K        DISK
      * UPD : Buy Order Header          Update index
      *
     FPKFHCPL0UF  E           K        DISK                      A
      * UPD : MPR Prior Day Sched Dtl   Update index
      *
     FPKE5CPL0UF  E           K        DISK                      A
      * UPD : MPR Prior Day Scheduled   Update index
      *
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@C4REO7
      * Payment Processing Parms  Retrieval index
      * Renamed input format fields
     I              C4HONB                          WAHONB
     I              C4CKDT                          WACKDT
     I              C4M1NB                          WAM1NB
     I              C4KHST                          WAKHST
     I              C4KJST                          WAKJST
     I              C4PINB                          WAPINB
     I              C4KKST                          WAKKST
     I              C4AAVN                          WAAAVN
     I              C4AADT                          WAAADT
     I              C4AMTM                          WAAMTM
     I              C4AJST                          WAAJST
     I              C4AHVN                          WAAHVN
     I              C4AGVN                          WAAGVN
     I              C4ABVN                          WAABVN
     I              C4ABDT                          WAABDT
     I              C4ABTM                          WAABTM
      *
     I@E4CPF7
      * MPR Estimated Purchases   Retrieval index
      * Renamed input format fields
     I              E4HONB                          WBHONB
     I              E4ETDT                          WBETDT
     I              E4C0A1                          WBC0A1
     I              E4C1A1                          WBC1A1
     I              E4AAVN                          WBAAVN
     I              E4AADT                          WBAADT
     I              E4AMTM                          WBAMTM
     I              E4AJST                          WBAJST
     I              E4AHVN                          WBAHVN
     I              E4AGVN                          WBAGVN
     I              E4ABVN                          WBABVN
     I              E4ABDT                          WBABDT
     I              E4ABTM                          WBABTM
      *
     I@E4CPF6
      * MPR Estimated Purchases   Update index
      * Renamed input format fields
     I              E4HONB                          WCHONB
     I              E4ETDT                          WCETDT
     I              E4C0A1                          WCC0A1
     I              E4C1A1                          WCC1A1
     I              E4AAVN                          WCAAVN
     I              E4AADT                          WCAADT
     I              E4AMTM                          WCAMTM
     I              E4AJST                          WCAJST
     I              E4AHVN                          WCAHVN
     I              E4AGVN                          WCAGVN
     I              E4ABVN                          WCABVN
     I              E4ABDT                          WCABDT
     I              E4ABTM                          WCABTM
      *
     I@A1CPCV
      * Tattoo Header             Co/KlDte/Prd/PayTp/Tatoo
      * Renamed input format fields
     I              A1HMNB                          WDHMNB
     I              A1BNNB                          WDBNNB
     I              A1BONB                          WDBONB
     I              A1CVNB                          WDCVNB
     I              A1B0DT                          WDB0DT
     I              A1AWDT                          WDAWDT
     I              A1BICD                          WDBICD
     I              A1CPST                          WDCPST
     I              A1ACPR                          WDACPR
     I              A1B9PR                          WDB9PR
     I              A1CAPR                          WDCAPR
     I              A1C4ST                          WDC4ST
     I              A1AIPR                          WDAIPR
     I              A1A6DT                          WDA6DT
     I              A1C2ST                          WDC2ST
     I              A1CXNB                          WDCXNB
     I              A1CWNB                          WDCWNB
     I              A1FCNB                          WDFCNB
     I              A1H9NB                          WDH9NB
     I              A1FDNB                          WDFDNB
     I              A1FENB                          WDFENB
     I              A1HENB                          WDHENB
     I              A1HFNB                          WDHFNB
     I              A1CYNB                          WDCYNB
     I              A1LRNB                          WDLRNB
     I              A1E0NB                          WDE0NB
     I              A1A5PC                          WDA5PC
     I              A1FBNB                          WDFBNB
     I              A1A4PC                          WDA4PC
     I              A1F7NB                          WDF7NB
     I              A1HDNB                          WDHDNB
     I              A1F5NB                          WDF5NB
     I              A1F4NB                          WDF4NB
     I              A1F3NB                          WDF3NB
     I              A1F2NB                          WDF2NB
     I              A1AVPC                          WDAVPC
     I              A1AWPC                          WDAWPC
     I              A1CWPC                          WDCWPC
     I              A1A8PC                          WDA8PC
     I              A1A7PC                          WDA7PC
     I              A1B8PR                          WDB8PR
     I              A1AMPR                          WDAMPR
     I              A1ANPR                          WDANPR
     I              A1AYVA                          WDAYVA
     I              A1AWVA                          WDAWVA
     I              A1AOPR                          WDAOPR
     I              A1AXVA                          WDAXVA
     I              A1APPR                          WDAPPR
     I              A1ASPR                          WDASPR
     I              A1A4VA                          WDA4VA
     I              A1ATPR                          WDATPR
     I              A1A5VA                          WDA5VA
     I              A1CBPR                          WDCBPR
     I              A1CCPR                          WDCCPR
     I              A1LPNB                          WDLPNB
     I              A1CDPR                          WDCDPR
     I              A1A7VA                          WDA7VA
     I              A1A2PR                          WDA2PR
     I              A1JWST                          WDJWST
     I              A1CWST                          WDCWST
     I              A1D7ST                          WDD7ST
     I              A1D8ST                          WDD8ST
     I              A1DWST                          WDDWST
     I              A1D6ST                          WDD6ST
     I              A1GHNB                          WDGHNB
     I              A1BYDT                          WDBYDT
     I              A1E0ST                          WDE0ST
     I              A1E1ST                          WDE1ST
     I              A1E2ST                          WDE2ST
     I              A1BSDT                          WDBSDT
     I              A1BTDT                          WDBTDT
     I              A1BUDT                          WDBUDT
     I              A1HGNB                          WDHGNB
     I              A1HHNB                          WDHHNB
     I              A1HINB                          WDHINB
     I              A1A3PR                          WDA3PR
     I              A1A4PR                          WDA4PR
     I              A1A6PR                          WDA6PR
     I              A1J9NB                          WDJ9NB
     I              A1D6PR                          WDD6PR
     I              A1D7PR                          WDD7PR
     I              A1D8PR                          WDD8PR
     I              A1D9PR                          WDD9PR
     I              A1EAPR                          WDEAPR
     I              A1EBPR                          WDEBPR
     I              A1ECPR                          WDECPR
     I              A1EDPR                          WDEDPR
     I              A1EEPR                          WDEEPR
     I              A1EFPR                          WDEFPR
     I              A1EGPR                          WDEGPR
     I              A1EHPR                          WDEHPR
     I              A1KAST                          WDKAST
     I              A1J7ST                          WDJ7ST
     I              A1J9ST                          WDJ9ST
     I              A1OXNB                          WDOXNB
     I              A1LKST                          WDLKST
     I              A1LLST                          WDLLST
     I              A1J8ST                          WDJ8ST
     I              A1LIST                          WDLIST
     I              A1LJST                          WDLJST
     I              A1NZTX                          WDNZTX
     I              A1HJCD                          WDHJCD
     I              A1R4ST                          WDR4ST
     I              A1R5ST                          WDR5ST
     I              A1R6ST                          WDR6ST
     I              A1R7ST                          WDR7ST
     I              A1THWT                          WDTHWT
     I              A1T2WT                          WDT2WT
     I              A1THHD                          WDTHHD
     I              A1T2HD                          WDT2HD
     I              A1OBPR                          WDOBPR
     I              A1KOER                          WDKOER
     I              A1OPIR                          WDOPIR
     I              A1OPEM                          WDOPEM
     I              A1IORP                          WDIORP
     I              A1OWEO                          WDOWEO
     I              A1OQET                          WDOQET
     I              A1URST                          WDURST
     I              A1USST                          WDUSST
     I              A1HHPC                          WDHHPC
     I              A1S9PR                          WDS9PR
     I              A1TAPR                          WDTAPR
     I              A1TBPR                          WDTBPR
     I              A1JFUR                          WDJFUR
     I              A1KRIF                          WDKRIF
     I              A1KORF                          WDKORF
     I              A1KAPR                          WDKAPR
     I              A1KROT                          WDKROT
     I              A1OTJG                          WDOTJG
     I              A1IRJG                          WDIRJG
     I              A1IMJF                          WDIMJF
     I              A1IRGF                          WDIRGF
     I              A1KRJF                          WDKRJF
     I              A1OJRF                          WDOJRF
     I              A1KFOR                          WDKFOR
     I              A1ORJK                          WDORJK
     I              A1OMVJ                          WDOMVJ
     I              A1MVNF                          WDMVNF
     I              A1MCNF                          WDMCNF
     I              A1NCNF                          WDNCNF
     I              A1NCHF                          WDNCHF
     I              A1IGIR                          WDIGIR
     I              A1KFJR                          WDKFJR
     I              A1EADT                          WDEADT
     I              A1EBDT                          WDEBDT
     I              A1ECDT                          WDECDT
     I              A1EDDT                          WDEDDT
     I              A1EEDT                          WDEEDT
     I              A1U4ST                          WDU4ST
     I              A1U5ST                          WDU5ST
     I              A1U6ST                          WDU6ST
     I              A1U7ST                          WDU7ST
     I              A1U8ST                          WDU8ST
     I              A1U9ST                          WDU9ST
     I              A1VAST                          WDVAST
     I              A1VBST                          WDVBST
     I              A1BDCD                          WDBDCD
     I              A1CSCD                          WDCSCD
     I              A1ABCD                          WDABCD
     I              A1AECD                          WDAECD
     I              A1ACCD                          WDACCD
     I              A1AGCD                          WDAGCD
     I              A1BECD                          WDBECD
     I              A1AAVN                          WDAAVN
     I              A1AADT                          WDAADT
     I              A1AMTM                          WDAMTM
     I              A1AJST                          WDAJST
     I              A1AHVN                          WDAHVN
     I              A1AGVN                          WDAGVN
     I              A1ABVN                          WDABVN
     I              A1ABDT                          WDABDT
     I              A1ABTM                          WDABTM
      *
     I@AWCPBI
      * Buy Order Header          Retrieval index
      * Renamed input format fields
     I              AWHMNB                          WEHMNB
     I              AWBNNB                          WEBNNB
     I              AWARDT                          WEARDT
     I              AWASDT                          WEASDT
     I              AWA4ST                          WEA4ST
     I              AWA5ST                          WEA5ST
     I              AWAAPR                          WEAAPR
     I              AWA6ST                          WEA6ST
     I              AWA7ST                          WEA7ST
     I              AWB3ST                          WEB3ST
     I              AWALPR                          WEALPR
     I              AWETCD                          WEETCD
     I              AWEUCD                          WEEUCD
     I              AWJ5TX                          WEJ5TX
     I              AWD5DT                          WED5DT
     I              AWD6DT                          WED6DT
     I              AWD7DT                          WED7DT
     I              AWD8DT                          WED8DT
     I              AWD9DT                          WED9DT
     I              AWJOEJ                          WEJOEJ
     I              AWKOFF                          WEKOFF
     I              AWKWPE                          WEKWPE
     I              AWIMBF                          WEIMBF
     I              AWOPTR                          WEOPTR
     I              AWOEJD                          WEOEJD
     I              AWIRMF                          WEIRMF
     I              AWJIRM                          WEJIRM
     I              AWJRKF                          WEJRKF
     I              AWKFIR                          WEKFIR
     I              AWUZST                          WEUZST
     I              AWU0ST                          WEU0ST
     I              AWU1ST                          WEU1ST
     I              AWU2ST                          WEU2ST
     I              AWU3ST                          WEU3ST
     I              AWHXNB                          WEHXNB
     I              AWGANB                          WEGANB
     I              AWGBNB                          WEGBNB
     I              AWABCD                          WEABCD
     I              AWAECD                          WEAECD
     I              AWAKCD                          WEAKCD
     I              AWALCD                          WEALCD
     I              AWAGCD                          WEAGCD
     I              AWAICD                          WEAICD
     I              AWAMCD                          WEAMCD
     I              AWACCD                          WEACCD
     I              AWAAVN                          WEAAVN
     I              AWAADT                          WEAADT
     I              AWAMTM                          WEAMTM
     I              AWAJST                          WEAJST
     I              AWAHVN                          WEAHVN
     I              AWAGVN                          WEAGVN
     I              AWABVN                          WEABVN
     I              AWABDT                          WEABDT
     I              AWABTM                          WEABTM
      *
     I@ARREML
      * Carcass Merit Program     Active CMP only
      * Renamed input format fields
     I              ARAMCD                          WFAMCD
     I              ARA3TX                          WFA3TX
     I              ARDLST                          WFDLST
     I              ARDMST                          WFDMST
     I              ARDOST                          WFDOST
     I              ARDQST                          WFDQST
     I              ARAZPC                          WFAZPC
     I              ARA0PC                          WFA0PC
     I              ARDTST                          WFDTST
     I              ARF5ST                          WFF5ST
     I              ARI1PR                          WFI1PR
     I              ARVEPR                          WFVEPR
     I              ARVFPR                          WFVFPR
     I              ARVHPR                          WFVHPR
     I              ARVIPR                          WFVIPR
     I              ARVJPR                          WFVJPR
     I              ARZ2ST                          WFZ2ST
     I              ARZ3ST                          WFZ3ST
     I              ARZ4ST                          WFZ4ST
     I              ARAAVN                          WFAAVN
     I              ARAADT                          WFAADT
     I              ARAMTM                          WFAMTM
     I              ARAJST                          WFAJST
     I              ARAHVN                          WFAHVN
     I              ARAGVN                          WFAGVN
     I              ARABVN                          WFABVN
     I              ARABDT                          WFABDT
     I              ARABTM                          WFABTM
      *
     I@E3CPF4
      * MPR Producer Purch Type   Retrieval index
      * Renamed input format fields
     I              E3ABCD                          WGABCD
     I              E3C0A1                          WGC0A1
     I              E3AAVN                          WGAAVN
     I              E3AADT                          WGAADT
     I              E3AMTM                          WGAMTM
     I              E3AJST                          WGAJST
     I              E3AHVN                          WGAHVN
     I              E3AGVN                          WGAGVN
     I              E3ABVN                          WGABVN
     I              E3ABDT                          WGABDT
     I              E3ABTM                          WGABTM
      *
     I@A1CPC4
      * Tattoo Header             Retrieval index
      * Renamed input format fields
     I              A1HMNB                          WHHMNB
     I              A1BNNB                          WHBNNB
     I              A1BONB                          WHBONB
     I              A1CVNB                          WHCVNB
     I              A1B0DT                          WHB0DT
     I              A1AWDT                          WHAWDT
     I              A1BICD                          WHBICD
     I              A1CPST                          WHCPST
     I              A1ACPR                          WHACPR
     I              A1B9PR                          WHB9PR
     I              A1CAPR                          WHCAPR
     I              A1C4ST                          WHC4ST
     I              A1AIPR                          WHAIPR
     I              A1A6DT                          WHA6DT
     I              A1C2ST                          WHC2ST
     I              A1CXNB                          WHCXNB
     I              A1CWNB                          WHCWNB
     I              A1FCNB                          WHFCNB
     I              A1H9NB                          WHH9NB
     I              A1FDNB                          WHFDNB
     I              A1FENB                          WHFENB
     I              A1HENB                          WHHENB
     I              A1HFNB                          WHHFNB
     I              A1CYNB                          WHCYNB
     I              A1LRNB                          WHLRNB
     I              A1E0NB                          WHE0NB
     I              A1A5PC                          WHA5PC
     I              A1FBNB                          WHFBNB
     I              A1A4PC                          WHA4PC
     I              A1F7NB                          WHF7NB
     I              A1HDNB                          WHHDNB
     I              A1F5NB                          WHF5NB
     I              A1F4NB                          WHF4NB
     I              A1F3NB                          WHF3NB
     I              A1F2NB                          WHF2NB
     I              A1AVPC                          WHAVPC
     I              A1AWPC                          WHAWPC
     I              A1CWPC                          WHCWPC
     I              A1A8PC                          WHA8PC
     I              A1A7PC                          WHA7PC
     I              A1B8PR                          WHB8PR
     I              A1AMPR                          WHAMPR
     I              A1ANPR                          WHANPR
     I              A1AYVA                          WHAYVA
     I              A1AWVA                          WHAWVA
     I              A1AOPR                          WHAOPR
     I              A1AXVA                          WHAXVA
     I              A1APPR                          WHAPPR
     I              A1ASPR                          WHASPR
     I              A1A4VA                          WHA4VA
     I              A1ATPR                          WHATPR
     I              A1A5VA                          WHA5VA
     I              A1CBPR                          WHCBPR
     I              A1CCPR                          WHCCPR
     I              A1LPNB                          WHLPNB
     I              A1CDPR                          WHCDPR
     I              A1A7VA                          WHA7VA
     I              A1A2PR                          WHA2PR
     I              A1JWST                          WHJWST
     I              A1CWST                          WHCWST
     I              A1D7ST                          WHD7ST
     I              A1D8ST                          WHD8ST
     I              A1DWST                          WHDWST
     I              A1D6ST                          WHD6ST
     I              A1GHNB                          WHGHNB
     I              A1BYDT                          WHBYDT
     I              A1E0ST                          WHE0ST
     I              A1E1ST                          WHE1ST
     I              A1E2ST                          WHE2ST
     I              A1BSDT                          WHBSDT
     I              A1BTDT                          WHBTDT
     I              A1BUDT                          WHBUDT
     I              A1HGNB                          WHHGNB
     I              A1HHNB                          WHHHNB
     I              A1HINB                          WHHINB
     I              A1A3PR                          WHA3PR
     I              A1A4PR                          WHA4PR
     I              A1A6PR                          WHA6PR
     I              A1J9NB                          WHJ9NB
     I              A1D6PR                          WHD6PR
     I              A1D7PR                          WHD7PR
     I              A1D8PR                          WHD8PR
     I              A1D9PR                          WHD9PR
     I              A1EAPR                          WHEAPR
     I              A1EBPR                          WHEBPR
     I              A1ECPR                          WHECPR
     I              A1EDPR                          WHEDPR
     I              A1EEPR                          WHEEPR
     I              A1EFPR                          WHEFPR
     I              A1EGPR                          WHEGPR
     I              A1EHPR                          WHEHPR
     I              A1KAST                          WHKAST
     I              A1J7ST                          WHJ7ST
     I              A1J9ST                          WHJ9ST
     I              A1OXNB                          WHOXNB
     I              A1LKST                          WHLKST
     I              A1LLST                          WHLLST
     I              A1J8ST                          WHJ8ST
     I              A1LIST                          WHLIST
     I              A1LJST                          WHLJST
     I              A1NZTX                          WHNZTX
     I              A1HJCD                          WHHJCD
     I              A1R4ST                          WHR4ST
     I              A1R5ST                          WHR5ST
     I              A1R6ST                          WHR6ST
     I              A1R7ST                          WHR7ST
     I              A1THWT                          WHTHWT
     I              A1T2WT                          WHT2WT
     I              A1THHD                          WHTHHD
     I              A1T2HD                          WHT2HD
     I              A1OBPR                          WHOBPR
     I              A1KOER                          WHKOER
     I              A1OPIR                          WHOPIR
     I              A1OPEM                          WHOPEM
     I              A1IORP                          WHIORP
     I              A1OWEO                          WHOWEO
     I              A1OQET                          WHOQET
     I              A1URST                          WHURST
     I              A1USST                          WHUSST
     I              A1HHPC                          WHHHPC
     I              A1S9PR                          WHS9PR
     I              A1TAPR                          WHTAPR
     I              A1TBPR                          WHTBPR
     I              A1JFUR                          WHJFUR
     I              A1KRIF                          WHKRIF
     I              A1KORF                          WHKORF
     I              A1KAPR                          WHKAPR
     I              A1KROT                          WHKROT
     I              A1OTJG                          WHOTJG
     I              A1IRJG                          WHIRJG
     I              A1IMJF                          WHIMJF
     I              A1IRGF                          WHIRGF
     I              A1KRJF                          WHKRJF
     I              A1OJRF                          WHOJRF
     I              A1KFOR                          WHKFOR
     I              A1ORJK                          WHORJK
     I              A1OMVJ                          WHOMVJ
     I              A1MVNF                          WHMVNF
     I              A1MCNF                          WHMCNF
     I              A1NCNF                          WHNCNF
     I              A1NCHF                          WHNCHF
     I              A1IGIR                          WHIGIR
     I              A1KFJR                          WHKFJR
     I              A1EADT                          WHEADT
     I              A1EBDT                          WHEBDT
     I              A1ECDT                          WHECDT
     I              A1EDDT                          WHEDDT
     I              A1EEDT                          WHEEDT
     I              A1U4ST                          WHU4ST
     I              A1U5ST                          WHU5ST
     I              A1U6ST                          WHU6ST
     I              A1U7ST                          WHU7ST
     I              A1U8ST                          WHU8ST
     I              A1U9ST                          WHU9ST
     I              A1VAST                          WHVAST
     I              A1VBST                          WHVBST
     I              A1BDCD                          WHBDCD
     I              A1CSCD                          WHCSCD
     I              A1ABCD                          WHABCD
     I              A1AECD                          WHAECD
     I              A1ACCD                          WHACCD
     I              A1AGCD                          WHAGCD
     I              A1BECD                          WHBECD
     I              A1AAVN                          WHAAVN
     I              A1AADT                          WHAADT
     I              A1AMTM                          WHAMTM
     I              A1AJST                          WHAJST
     I              A1AHVN                          WHAHVN
     I              A1AGVN                          WHAGVN
     I              A1ABVN                          WHABVN
     I              A1ABDT                          WHABDT
     I              A1ABTM                          WHABTM
      *
     I@DNCPUY
      * Tattoo Header EXT         Retrieval index
      * Renamed input format fields
     I              DNHMNB                          WIHMNB
     I              DNBNNB                          WIBNNB
     I              DNBONB                          WIBONB
     I              DNCVNB                          WICVNB
     I              DNB0DT                          WIB0DT
     I              DNI5PR                          WII5PR
     I              DNJBPR                          WIJBPR
     I              DNI6PR                          WII6PR
     I              DNI7PR                          WII7PR
     I              DNI8PR                          WII8PR
     I              DNI9PR                          WII9PR
     I              DNJAPR                          WIJAPR
     I              DNJCPR                          WIJCPR
     I              DNJDPR                          WIJDPR
     I              DNJEPR                          WIJEPR
     I              DNJFPR                          WIJFPR
     I              DNJGPR                          WIJGPR
     I              DNJHPR                          WIJHPR
     I              DNJIPR                          WIJIPR
     I              DNJJPR                          WIJJPR
     I              DNJKPR                          WIJKPR
     I              DNJLPR                          WIJLPR
     I              DNJMPR                          WIJMPR
     I              DNJNPR                          WIJNPR
     I              DNJOPR                          WIJOPR
     I              DNLTBF                          WILTBF
     I              DNHZPC                          WIHZPC
     I              DNLTHW                          WILTHW
     I              DNH0PC                          WIH0PC
     I              DNGTBF                          WIGTBF
     I              DNH1PC                          WIH1PC
     I              DNGTHW                          WIGTHW
     I              DNH2PC                          WIH2PC
     I              DNHLBF                          WIHLBF
     I              DNHLLE                          WIHLLE
     I              DNHLHW                          WIHLHW
     I              DNHLLP                          WIHLLP
     I              DNHGBF                          WIHGBF
     I              DNHGLE                          WIHGLE
     I              DNHGHW                          WIHGHW
     I              DNHFLP                          WIHFLP
     I              DNSNA1                          WISNA1
     I              DNSOA1                          WISOA1
     I              DNSPA1                          WISPA1
     I              DNDGSS                          WIDGSS
     I              DNDHSS                          WIDHSS
     I              DNDISS                          WIDISS
     I              DNABCD                          WIABCD
     I              DNNYCD                          WINYCD
     I              DNOVCD                          WIOVCD
     I              DNAAVN                          WIAAVN
     I              DNAADT                          WIAADT
     I              DNAMTM                          WIAMTM
     I              DNAJST                          WIAJST
     I              DNAHVN                          WIAHVN
     I              DNAGVN                          WIAGVN
     I              DNABVN                          WIABVN
     I              DNABDT                          WIABDT
     I              DNABTM                          WIABTM
      *
     I@CDCPWY
      * Tattoo Ded/Add            Rtv Index - Seab's
      * Renamed input format fields
     I              CDHMNB                          WJHMNB
     I              CDBNNB                          WJBNNB
     I              CDBONB                          WJBONB
     I              CDCVNB                          WJCVNB
     I              CDB0DT                          WJB0DT
     I              CDBQCD                          WJBQCD
     I              CDAZVA                          WJAZVA
     I              CDA0VA                          WJA0VA
     I              CDJBST                          WJJBST
     I              CDEIST                          WJEIST
     I              CDJDST                          WJJDST
     I              CDDPCD                          WJDPCD
     I              CDE3CD                          WJE3CD
     I              CDAQNB                          WJAQNB
     I              CDOCST                          WJOCST
     I              CDPEST                          WJPEST
     I              CDPFST                          WJPFST
     I              CDPGST                          WJPGST
     I              CDPIST                          WJPIST
     I              CDPJST                          WJPJST
     I              CDPKST                          WJPKST
     I              CDPLST                          WJPLST
     I              CDAAVN                          WJAAVN
     I              CDAADT                          WJAADT
     I              CDAMTM                          WJAMTM
     I              CDAJST                          WJAJST
     I              CDAHVN                          WJAHVN
     I              CDAGVN                          WJAGVN
     I              CDABVN                          WJABVN
     I              CDABDT                          WJABDT
     I              CDABTM                          WJABTM
      *
     I@E6CPGA
      * MPR Prior Day Slaughtered Retrieval index
      * Renamed input format fields
     I              E6H8CD                          WKH8CD
     I              E6ETDT                          WKETDT
     I              E6C2A1                          WKC2A1
     I              E6IBCD                          WKIBCD
     I              E6DOA1                          WKDOA1
     I              E6DPA1                          WKDPA1
     I              E6DQA1                          WKDQA1
     I              E6UUPR                          WKUUPR
     I              E6UVPR                          WKUVPR
     I              E6UWPR                          WKUWPR
     I              E6UXPR                          WKUXPR
     I              E6DRA1                          WKDRA1
     I              E6DSA1                          WKDSA1
     I              E6UYPR                          WKUYPR
     I              E6DTA1                          WKDTA1
     I              E6DUA1                          WKDUA1
     I              E6DVA1                          WKDVA1
     I              E6AAVN                          WKAAVN
     I              E6AADT                          WKAADT
     I              E6AMTM                          WKAMTM
     I              E6AJST                          WKAJST
     I              E6AHVN                          WKAHVN
     I              E6AGVN                          WKAGVN
     I              E6ABVN                          WKABVN
     I              E6ABDT                          WKABDT
     I              E6ABTM                          WKABTM
      *
     I@E6CPF9
      * MPR Prior Day Slaughtered Update index
      * Renamed input format fields
     I              E6H8CD                          WLH8CD
     I              E6ETDT                          WLETDT
     I              E6C2A1                          WLC2A1
     I              E6IBCD                          WLIBCD
     I              E6DOA1                          WLDOA1
     I              E6DPA1                          WLDPA1
     I              E6DQA1                          WLDQA1
     I              E6UUPR                          WLUUPR
     I              E6UVPR                          WLUVPR
     I              E6UWPR                          WLUWPR
     I              E6UXPR                          WLUXPR
     I              E6DRA1                          WLDRA1
     I              E6DSA1                          WLDSA1
     I              E6UYPR                          WLUYPR
     I              E6DTA1                          WLDTA1
     I              E6DUA1                          WLDUA1
     I              E6DVA1                          WLDVA1
     I              E6AAVN                          WLAAVN
     I              E6AADT                          WLAADT
     I              E6AMTM                          WLAMTM
     I              E6AJST                          WLAJST
     I              E6AHVN                          WLAHVN
     I              E6AGVN                          WLAGVN
     I              E6ABVN                          WLABVN
     I              E6ABDT                          WLABDT
     I              E6ABTM                          WLABTM
      *
     I@AWCPGR
      * Buy Order Header          Co/KIllDt
      * Renamed input format fields
     I              AWHMNB                          WMHMNB
     I              AWBNNB                          WMBNNB
     I              AWARDT                          WMARDT
     I              AWASDT                          WMASDT
     I              AWA4ST                          WMA4ST
     I              AWA5ST                          WMA5ST
     I              AWAAPR                          WMAAPR
     I              AWA6ST                          WMA6ST
     I              AWA7ST                          WMA7ST
     I              AWB3ST                          WMB3ST
     I              AWALPR                          WMALPR
     I              AWETCD                          WMETCD
     I              AWEUCD                          WMEUCD
     I              AWJ5TX                          WMJ5TX
     I              AWD5DT                          WMD5DT
     I              AWD6DT                          WMD6DT
     I              AWD7DT                          WMD7DT
     I              AWD8DT                          WMD8DT
     I              AWD9DT                          WMD9DT
     I              AWJOEJ                          WMJOEJ
     I              AWKOFF                          WMKOFF
     I              AWKWPE                          WMKWPE
     I              AWIMBF                          WMIMBF
     I              AWOPTR                          WMOPTR
     I              AWOEJD                          WMOEJD
     I              AWIRMF                          WMIRMF
     I              AWJIRM                          WMJIRM
     I              AWJRKF                          WMJRKF
     I              AWKFIR                          WMKFIR
     I              AWUZST                          WMUZST
     I              AWU0ST                          WMU0ST
     I              AWU1ST                          WMU1ST
     I              AWU2ST                          WMU2ST
     I              AWU3ST                          WMU3ST
     I              AWHXNB                          WMHXNB
     I              AWGANB                          WMGANB
     I              AWGBNB                          WMGBNB
     I              AWABCD                          WMABCD
     I              AWAECD                          WMAECD
     I              AWAKCD                          WMAKCD
     I              AWALCD                          WMALCD
     I              AWAGCD                          WMAGCD
     I              AWAICD                          WMAICD
     I              AWAMCD                          WMAMCD
     I              AWACCD                          WMACCD
     I              AWAAVN                          WMAAVN
     I              AWAADT                          WMAADT
     I              AWAMTM                          WMAMTM
     I              AWAJST                          WMAJST
     I              AWAHVN                          WMAHVN
     I              AWAGVN                          WMAGVN
     I              AWABVN                          WMABVN
     I              AWABDT                          WMABDT
     I              AWABTM                          WMABTM
      *
     I@AXCPBX
      * Buy Order Load            Retrieval index
      * Renamed input format fields
     I              AXHMNB                          WOHMNB
     I              AXBNNB                          WOBNNB
     I              AXBONB                          WOBONB
     I              AXCQDT                          WOCQDT
     I              AXABTH                          WOABTH
     I              AXACTH                          WOACTH
     I              AXBPNB                          WOBPNB
     I              AXCSNB                          WOCSNB
     I              AXAUDT                          WOAUDT
     I              AXCMST                          WOCMST
     I              AXAGPR                          WOAGPR
     I              AXATVA                          WOATVA
     I              AXI1ST                          WOI1ST
     I              AXDHNB                          WODHNB
     I              AXDINB                          WODINB
     I              AXCNST                          WOCNST
     I              AXGINB                          WOGINB
     I              AXBZDT                          WOBZDT
     I              AXLSNB                          WOLSNB
     I              AXF3TX                          WOF3TX
     I              AXO8ST                          WOO8ST
     I              AXO9ST                          WOO9ST
     I              AXPAST                          WOPAST
     I              AXLDSH                          WOLDSH
     I              AXPBST                          WOPBST
     I              AXPCST                          WOPCST
     I              AXPDST                          WOPDST
     I              AXUWST                          WOUWST
     I              AXUXST                          WOUXST
     I              AXUYST                          WOUYST
     I              AXJKRU                          WOJKRU
     I              AXKEOR                          WOKEOR
     I              AXIOEW                          WOIOEW
     I              AXKJIO                          WOKJIO
     I              AXIOJR                          WOIOJR
     I              AXEIRR                          WOEIRR
     I              AXITMF                          WOITMF
     I              AXODJE                          WOODJE
     I              AXRJIF                          WORJIF
     I              AXOEJF                          WOOEJF
     I              AXD0DT                          WOD0DT
     I              AXD1DT                          WOD1DT
     I              AXD2DT                          WOD2DT
     I              AXD3DT                          WOD3DT
     I              AXD4DT                          WOD4DT
     I              AXBNCD                          WOBNCD
     I              AXABCD                          WOABCD
     I              AXAECD                          WOAECD
     I              AXAAVN                          WOAAVN
     I              AXAADT                          WOAADT
     I              AXAMTM                          WOAMTM
     I              AXAJST                          WOAJST
     I              AXAHVN                          WOAHVN
     I              AXAGVN                          WOAGVN
     I              AXABVN                          WOABVN
     I              AXABDT                          WOABDT
     I              AXABTM                          WOABTM
      *
     I@AFREAR
      * Producer Location         Retrieval index
      * Renamed input format fields
     I              AFABCD                          WRABCD
     I              AFAECD                          WRAECD
     I              AFA8TX                          WRA8TX
     I              AFGLNB                          WRGLNB
     I              AFATST                          WRATST
     I              AFASNB                          WRASNB
     I              AFAUST                          WRAUST
     I              AFQNST                          WRQNST
     I              AFQOST                          WRQOST
     I              AFQPST                          WRQPST
     I              AFQQST                          WRQQST
     I              AFQRST                          WRQRST
     I              AFN0TX                          WRN0TX
     I              AFQSST                          WRQSST
     I              AFQTST                          WRQTST
     I              AFQUST                          WRQUST
     I              AFQVST                          WRQVST
     I              AFR8ST                          WRR8ST
     I              AFR9ST                          WRR9ST
     I              AFSAST                          WRSAST
     I              AFSBST                          WRSBST
     I              AFSDST                          WRSDST
     I              AFSEST                          WRSEST
     I              AFSFST                          WRSFST
     I              AFHWNB                          WRHWNB
     I              AFFUCD                          WRFUCD
     I              AFAAVN                          WRAAVN
     I              AFAADT                          WRAADT
     I              AFAMTM                          WRAMTM
     I              AFAJST                          WRAJST
     I              AFAHVN                          WRAHVN
     I              AFAGVN                          WRAGVN
     I              AFABVN                          WRABVN
     I              AFABDT                          WRABDT
     I              AFABTM                          WRABTM
      *
     I@A1CPOI
      * Tattoo Header             Co/Bol/Ttt
      * Renamed input format fields
     I              A1HMNB                          WSHMNB
     I              A1BNNB                          WSBNNB
     I              A1BONB                          WSBONB
     I              A1CVNB                          WSCVNB
     I              A1B0DT                          WSB0DT
     I              A1AWDT                          WSAWDT
     I              A1BICD                          WSBICD
     I              A1CPST                          WSCPST
     I              A1ACPR                          WSACPR
     I              A1B9PR                          WSB9PR
     I              A1CAPR                          WSCAPR
     I              A1C4ST                          WSC4ST
     I              A1AIPR                          WSAIPR
     I              A1A6DT                          WSA6DT
     I              A1C2ST                          WSC2ST
     I              A1CXNB                          WSCXNB
     I              A1CWNB                          WSCWNB
     I              A1FCNB                          WSFCNB
     I              A1H9NB                          WSH9NB
     I              A1FDNB                          WSFDNB
     I              A1FENB                          WSFENB
     I              A1HENB                          WSHENB
     I              A1HFNB                          WSHFNB
     I              A1CYNB                          WSCYNB
     I              A1LRNB                          WSLRNB
     I              A1E0NB                          WSE0NB
     I              A1A5PC                          WSA5PC
     I              A1FBNB                          WSFBNB
     I              A1A4PC                          WSA4PC
     I              A1F7NB                          WSF7NB
     I              A1HDNB                          WSHDNB
     I              A1F5NB                          WSF5NB
     I              A1F4NB                          WSF4NB
     I              A1F3NB                          WSF3NB
     I              A1F2NB                          WSF2NB
     I              A1AVPC                          WSAVPC
     I              A1AWPC                          WSAWPC
     I              A1CWPC                          WSCWPC
     I              A1A8PC                          WSA8PC
     I              A1A7PC                          WSA7PC
     I              A1B8PR                          WSB8PR
     I              A1AMPR                          WSAMPR
     I              A1ANPR                          WSANPR
     I              A1AYVA                          WSAYVA
     I              A1AWVA                          WSAWVA
     I              A1AOPR                          WSAOPR
     I              A1AXVA                          WSAXVA
     I              A1APPR                          WSAPPR
     I              A1ASPR                          WSASPR
     I              A1A4VA                          WSA4VA
     I              A1ATPR                          WSATPR
     I              A1A5VA                          WSA5VA
     I              A1CBPR                          WSCBPR
     I              A1CCPR                          WSCCPR
     I              A1LPNB                          WSLPNB
     I              A1CDPR                          WSCDPR
     I              A1A7VA                          WSA7VA
     I              A1A2PR                          WSA2PR
     I              A1JWST                          WSJWST
     I              A1CWST                          WSCWST
     I              A1D7ST                          WSD7ST
     I              A1D8ST                          WSD8ST
     I              A1DWST                          WSDWST
     I              A1D6ST                          WSD6ST
     I              A1GHNB                          WSGHNB
     I              A1BYDT                          WSBYDT
     I              A1E0ST                          WSE0ST
     I              A1E1ST                          WSE1ST
     I              A1E2ST                          WSE2ST
     I              A1BSDT                          WSBSDT
     I              A1BTDT                          WSBTDT
     I              A1BUDT                          WSBUDT
     I              A1HGNB                          WSHGNB
     I              A1HHNB                          WSHHNB
     I              A1HINB                          WSHINB
     I              A1A3PR                          WSA3PR
     I              A1A4PR                          WSA4PR
     I              A1A6PR                          WSA6PR
     I              A1J9NB                          WSJ9NB
     I              A1D6PR                          WSD6PR
     I              A1D7PR                          WSD7PR
     I              A1D8PR                          WSD8PR
     I              A1D9PR                          WSD9PR
     I              A1EAPR                          WSEAPR
     I              A1EBPR                          WSEBPR
     I              A1ECPR                          WSECPR
     I              A1EDPR                          WSEDPR
     I              A1EEPR                          WSEEPR
     I              A1EFPR                          WSEFPR
     I              A1EGPR                          WSEGPR
     I              A1EHPR                          WSEHPR
     I              A1KAST                          WSKAST
     I              A1J7ST                          WSJ7ST
     I              A1J9ST                          WSJ9ST
     I              A1OXNB                          WSOXNB
     I              A1LKST                          WSLKST
     I              A1LLST                          WSLLST
     I              A1J8ST                          WSJ8ST
     I              A1LIST                          WSLIST
     I              A1LJST                          WSLJST
     I              A1NZTX                          WSNZTX
     I              A1HJCD                          WSHJCD
     I              A1R4ST                          WSR4ST
     I              A1R5ST                          WSR5ST
     I              A1R6ST                          WSR6ST
     I              A1R7ST                          WSR7ST
     I              A1THWT                          WSTHWT
     I              A1T2WT                          WST2WT
     I              A1THHD                          WSTHHD
     I              A1T2HD                          WST2HD
     I              A1OBPR                          WSOBPR
     I              A1KOER                          WSKOER
     I              A1OPIR                          WSOPIR
     I              A1OPEM                          WSOPEM
     I              A1IORP                          WSIORP
     I              A1OWEO                          WSOWEO
     I              A1OQET                          WSOQET
     I              A1URST                          WSURST
     I              A1USST                          WSUSST
     I              A1HHPC                          WSHHPC
     I              A1S9PR                          WSS9PR
     I              A1TAPR                          WSTAPR
     I              A1TBPR                          WSTBPR
     I              A1JFUR                          WSJFUR
     I              A1KRIF                          WSKRIF
     I              A1KORF                          WSKORF
     I              A1KAPR                          WSKAPR
     I              A1KROT                          WSKROT
     I              A1OTJG                          WSOTJG
     I              A1IRJG                          WSIRJG
     I              A1IMJF                          WSIMJF
     I              A1IRGF                          WSIRGF
     I              A1KRJF                          WSKRJF
     I              A1OJRF                          WSOJRF
     I              A1KFOR                          WSKFOR
     I              A1ORJK                          WSORJK
     I              A1OMVJ                          WSOMVJ
     I              A1MVNF                          WSMVNF
     I              A1MCNF                          WSMCNF
     I              A1NCNF                          WSNCNF
     I              A1NCHF                          WSNCHF
     I              A1IGIR                          WSIGIR
     I              A1KFJR                          WSKFJR
     I              A1EADT                          WSEADT
     I              A1EBDT                          WSEBDT
     I              A1ECDT                          WSECDT
     I              A1EDDT                          WSEDDT
     I              A1EEDT                          WSEEDT
     I              A1U4ST                          WSU4ST
     I              A1U5ST                          WSU5ST
     I              A1U6ST                          WSU6ST
     I              A1U7ST                          WSU7ST
     I              A1U8ST                          WSU8ST
     I              A1U9ST                          WSU9ST
     I              A1VAST                          WSVAST
     I              A1VBST                          WSVBST
     I              A1BDCD                          WSBDCD
     I              A1CSCD                          WSCSCD
     I              A1ABCD                          WSABCD
     I              A1AECD                          WSAECD
     I              A1ACCD                          WSACCD
     I              A1AGCD                          WSAGCD
     I              A1BECD                          WSBECD
     I              A1AAVN                          WSAAVN
     I              A1AADT                          WSAADT
     I              A1AMTM                          WSAMTM
     I              A1AJST                          WSAJST
     I              A1AHVN                          WSAHVN
     I              A1AGVN                          WSAGVN
     I              A1ABVN                          WSABVN
     I              A1ABDT                          WSABDT
     I              A1ABTM                          WSABTM
      *
     I@ATRELM
      * Producer Site             Retrieval index
      * Renamed input format fields
     I              ATABCD                          WTABCD
     I              ATNYCD                          WTNYCD
     I              ATTETX                          WTTETX
     I              ATTZTX                          WTTZTX
     I              ATT0TX                          WTT0TX
     I              ATT1TX                          WTT1TX
     I              ATT2TX                          WTT2TX
     I              ATT3TX                          WTT3TX
     I              ATTWTX                          WTTWTX
     I              ATTXTX                          WTTXTX
     I              ATMDA1                          WTMDA1
     I              ATMEA1                          WTMEA1
     I              ATTYTX                          WTTYTX
     I              ATAXSS                          WTAXSS
     I              ATAYSS                          WTAYSS
     I              ATAZSS                          WTAZSS
     I              ATMFA1                          WTMFA1
     I              ATT4TX                          WTT4TX
     I              ATT5TX                          WTT5TX
     I              ATBGT1                          WTBGT1
     I              ATAAVN                          WTAAVN
     I              ATAADT                          WTAADT
     I              ATAMTM                          WTAMTM
     I              ATAJST                          WTAJST
     I              ATAHVN                          WTAHVN
     I              ATAGVN                          WTAGVN
     I              ATABVN                          WTABVN
     I              ATABDT                          WTABDT
     I              ATABTM                          WTABTM
      *
     I@A1CPOC
      * Tattoo Header             Co/BOL/Kill/Ttt
      * Renamed input format fields
     I              A1HMNB                          WVHMNB
     I              A1BNNB                          WVBNNB
     I              A1BONB                          WVBONB
     I              A1CVNB                          WVCVNB
     I              A1B0DT                          WVB0DT
     I              A1AWDT                          WVAWDT
     I              A1BICD                          WVBICD
     I              A1CPST                          WVCPST
     I              A1ACPR                          WVACPR
     I              A1B9PR                          WVB9PR
     I              A1CAPR                          WVCAPR
     I              A1C4ST                          WVC4ST
     I              A1AIPR                          WVAIPR
     I              A1A6DT                          WVA6DT
     I              A1C2ST                          WVC2ST
     I              A1CXNB                          WVCXNB
     I              A1CWNB                          WVCWNB
     I              A1FCNB                          WVFCNB
     I              A1H9NB                          WVH9NB
     I              A1FDNB                          WVFDNB
     I              A1FENB                          WVFENB
     I              A1HENB                          WVHENB
     I              A1HFNB                          WVHFNB
     I              A1CYNB                          WVCYNB
     I              A1LRNB                          WVLRNB
     I              A1E0NB                          WVE0NB
     I              A1A5PC                          WVA5PC
     I              A1FBNB                          WVFBNB
     I              A1A4PC                          WVA4PC
     I              A1F7NB                          WVF7NB
     I              A1HDNB                          WVHDNB
     I              A1F5NB                          WVF5NB
     I              A1F4NB                          WVF4NB
     I              A1F3NB                          WVF3NB
     I              A1F2NB                          WVF2NB
     I              A1AVPC                          WVAVPC
     I              A1AWPC                          WVAWPC
     I              A1CWPC                          WVCWPC
     I              A1A8PC                          WVA8PC
     I              A1A7PC                          WVA7PC
     I              A1B8PR                          WVB8PR
     I              A1AMPR                          WVAMPR
     I              A1ANPR                          WVANPR
     I              A1AYVA                          WVAYVA
     I              A1AWVA                          WVAWVA
     I              A1AOPR                          WVAOPR
     I              A1AXVA                          WVAXVA
     I              A1APPR                          WVAPPR
     I              A1ASPR                          WVASPR
     I              A1A4VA                          WVA4VA
     I              A1ATPR                          WVATPR
     I              A1A5VA                          WVA5VA
     I              A1CBPR                          WVCBPR
     I              A1CCPR                          WVCCPR
     I              A1LPNB                          WVLPNB
     I              A1CDPR                          WVCDPR
     I              A1A7VA                          WVA7VA
     I              A1A2PR                          WVA2PR
     I              A1JWST                          WVJWST
     I              A1CWST                          WVCWST
     I              A1D7ST                          WVD7ST
     I              A1D8ST                          WVD8ST
     I              A1DWST                          WVDWST
     I              A1D6ST                          WVD6ST
     I              A1GHNB                          WVGHNB
     I              A1BYDT                          WVBYDT
     I              A1E0ST                          WVE0ST
     I              A1E1ST                          WVE1ST
     I              A1E2ST                          WVE2ST
     I              A1BSDT                          WVBSDT
     I              A1BTDT                          WVBTDT
     I              A1BUDT                          WVBUDT
     I              A1HGNB                          WVHGNB
     I              A1HHNB                          WVHHNB
     I              A1HINB                          WVHINB
     I              A1A3PR                          WVA3PR
     I              A1A4PR                          WVA4PR
     I              A1A6PR                          WVA6PR
     I              A1J9NB                          WVJ9NB
     I              A1D6PR                          WVD6PR
     I              A1D7PR                          WVD7PR
     I              A1D8PR                          WVD8PR
     I              A1D9PR                          WVD9PR
     I              A1EAPR                          WVEAPR
     I              A1EBPR                          WVEBPR
     I              A1ECPR                          WVECPR
     I              A1EDPR                          WVEDPR
     I              A1EEPR                          WVEEPR
     I              A1EFPR                          WVEFPR
     I              A1EGPR                          WVEGPR
     I              A1EHPR                          WVEHPR
     I              A1KAST                          WVKAST
     I              A1J7ST                          WVJ7ST
     I              A1J9ST                          WVJ9ST
     I              A1OXNB                          WVOXNB
     I              A1LKST                          WVLKST
     I              A1LLST                          WVLLST
     I              A1J8ST                          WVJ8ST
     I              A1LIST                          WVLIST
     I              A1LJST                          WVLJST
     I              A1NZTX                          WVNZTX
     I              A1HJCD                          WVHJCD
     I              A1R4ST                          WVR4ST
     I              A1R5ST                          WVR5ST
     I              A1R6ST                          WVR6ST
     I              A1R7ST                          WVR7ST
     I              A1THWT                          WVTHWT
     I              A1T2WT                          WVT2WT
     I              A1THHD                          WVTHHD
     I              A1T2HD                          WVT2HD
     I              A1OBPR                          WVOBPR
     I              A1KOER                          WVKOER
     I              A1OPIR                          WVOPIR
     I              A1OPEM                          WVOPEM
     I              A1IORP                          WVIORP
     I              A1OWEO                          WVOWEO
     I              A1OQET                          WVOQET
     I              A1URST                          WVURST
     I              A1USST                          WVUSST
     I              A1HHPC                          WVHHPC
     I              A1S9PR                          WVS9PR
     I              A1TAPR                          WVTAPR
     I              A1TBPR                          WVTBPR
     I              A1JFUR                          WVJFUR
     I              A1KRIF                          WVKRIF
     I              A1KORF                          WVKORF
     I              A1KAPR                          WVKAPR
     I              A1KROT                          WVKROT
     I              A1OTJG                          WVOTJG
     I              A1IRJG                          WVIRJG
     I              A1IMJF                          WVIMJF
     I              A1IRGF                          WVIRGF
     I              A1KRJF                          WVKRJF
     I              A1OJRF                          WVOJRF
     I              A1KFOR                          WVKFOR
     I              A1ORJK                          WVORJK
     I              A1OMVJ                          WVOMVJ
     I              A1MVNF                          WVMVNF
     I              A1MCNF                          WVMCNF
     I              A1NCNF                          WVNCNF
     I              A1NCHF                          WVNCHF
     I              A1IGIR                          WVIGIR
     I              A1KFJR                          WVKFJR
     I              A1EADT                          WVEADT
     I              A1EBDT                          WVEBDT
     I              A1ECDT                          WVECDT
     I              A1EDDT                          WVEDDT
     I              A1EEDT                          WVEEDT
     I              A1U4ST                          WVU4ST
     I              A1U5ST                          WVU5ST
     I              A1U6ST                          WVU6ST
     I              A1U7ST                          WVU7ST
     I              A1U8ST                          WVU8ST
     I              A1U9ST                          WVU9ST
     I              A1VAST                          WVVAST
     I              A1VBST                          WVVBST
     I              A1BDCD                          WVBDCD
     I              A1CSCD                          WVCSCD
     I              A1ABCD                          WVABCD
     I              A1AECD                          WVAECD
     I              A1ACCD                          WVACCD
     I              A1AGCD                          WVAGCD
     I              A1BECD                          WVBECD
     I              A1AAVN                          WVAAVN
     I              A1AADT                          WVAADT
     I              A1AMTM                          WVAMTM
     I              A1AJST                          WVAJST
     I              A1AHVN                          WVAHVN
     I              A1AGVN                          WVAGVN
     I              A1ABVN                          WVABVN
     I              A1ABDT                          WVABDT
     I              A1ABTM                          WVABTM
      *
     I@AQCPA0
      * Producer Sub-Contract     Retrieval index
      * Renamed input format fields
     I              AQAKCD                          WWAKCD
     I              AQALCD                          WWALCD
     I              AQAHDT                          WWAHDT
     I              AQA2ST                          WWA2ST
     I              AQAZPR                          WWAZPR
     I              AQA0PR                          WWA0PR
     I              AQA9PC                          WWA9PC
     I              AQA7PR                          WWA7PR
     I              AQA8PR                          WWA8PR
     I              AQF3ST                          WWF3ST
     I              AQA9PR                          WWA9PR
     I              AQERCD                          WWERCD
     I              AQESCD                          WWESCD
     I              AQF6PR                          WWF6PR
     I              AQJ3TX                          WWJ3TX
     I              AQABCD                          WWABCD
     I              AQAECD                          WWAECD
     I              AQAGCD                          WWAGCD
     I              AQAICD                          WWAICD
     I              AQAMCD                          WWAMCD
     I              AQAAVN                          WWAAVN
     I              AQAADT                          WWAADT
     I              AQAMTM                          WWAMTM
     I              AQAJST                          WWAJST
     I              AQAHVN                          WWAHVN
     I              AQAGVN                          WWAGVN
     I              AQABVN                          WWABVN
     I              AQABDT                          WWABDT
     I              AQABTM                          WWABTM
      *
     I@E7CPGM
      * MPR Prior Day Purchased   Retrieval index
      * Renamed input format fields
     I              E7H8CD                          WXH8CD
     I              E7ETDT                          WXETDT
     I              E7C2A1                          WXC2A1
     I              E7IBCD                          WXIBCD
     I              E7DWA1                          WXDWA1
     I              E7DXA1                          WXDXA1
     I              E7DYA1                          WXDYA1
     I              E7DZA1                          WXDZA1
     I              E7D0A1                          WXD0A1
     I              E7UZPR                          WXUZPR
     I              E7IDCD                          WXIDCD
     I              E7AAVN                          WXAAVN
     I              E7AADT                          WXAADT
     I              E7AMTM                          WXAMTM
     I              E7AJST                          WXAJST
     I              E7AHVN                          WXAHVN
     I              E7AGVN                          WXAGVN
     I              E7ABVN                          WXABVN
     I              E7ABDT                          WXABDT
     I              E7ABTM                          WXABTM
      *
     I@E7CPGL
      * MPR Prior Day Purchased   Update index
      * Renamed input format fields
     I              E7H8CD                          WYH8CD
     I              E7ETDT                          WYETDT
     I              E7C2A1                          WYC2A1
     I              E7IBCD                          WYIBCD
     I              E7DWA1                          WYDWA1
     I              E7DXA1                          WYDXA1
     I              E7DYA1                          WYDYA1
     I              E7DZA1                          WYDZA1
     I              E7D0A1                          WYD0A1
     I              E7UZPR                          WYUZPR
     I              E7IDCD                          WYIDCD
     I              E7AAVN                          WYAAVN
     I              E7AADT                          WYAADT
     I              E7AMTM                          WYAMTM
     I              E7AJST                          WYAJST
     I              E7AHVN                          WYAHVN
     I              E7AGVN                          WYAGVN
     I              E7ABVN                          WYABVN
     I              E7ABDT                          WYABDT
     I              E7ABTM                          WYABTM
      *
     I@AXCPBY
      * Buy Order Load            Update index
      * Renamed input format fields
     I              AXHMNB                          TAHMNB
     I              AXBNNB                          TABNNB
     I              AXBONB                          TABONB
     I              AXCQDT                          TACQDT
     I              AXABTH                          TAABTH
     I              AXACTH                          TAACTH
     I              AXBPNB                          TABPNB
     I              AXCSNB                          TACSNB
     I              AXAUDT                          TAAUDT
     I              AXCMST                          TACMST
     I              AXAGPR                          TAAGPR
     I              AXATVA                          TAATVA
     I              AXI1ST                          TAI1ST
     I              AXDHNB                          TADHNB
     I              AXDINB                          TADINB
     I              AXCNST                          TACNST
     I              AXGINB                          TAGINB
     I              AXBZDT                          TABZDT
     I              AXLSNB                          TALSNB
     I              AXF3TX                          TAF3TX
     I              AXO8ST                          TAO8ST
     I              AXO9ST                          TAO9ST
     I              AXPAST                          TAPAST
     I              AXLDSH                          TALDSH
     I              AXPBST                          TAPBST
     I              AXPCST                          TAPCST
     I              AXPDST                          TAPDST
     I              AXUWST                          TAUWST
     I              AXUXST                          TAUXST
     I              AXUYST                          TAUYST
     I              AXJKRU                          TAJKRU
     I              AXKEOR                          TAKEOR
     I              AXIOEW                          TAIOEW
     I              AXKJIO                          TAKJIO
     I              AXIOJR                          TAIOJR
     I              AXEIRR                          TAEIRR
     I              AXITMF                          TAITMF
     I              AXODJE                          TAODJE
     I              AXRJIF                          TARJIF
     I              AXOEJF                          TAOEJF
     I              AXD0DT                          TAD0DT
     I              AXD1DT                          TAD1DT
     I              AXD2DT                          TAD2DT
     I              AXD3DT                          TAD3DT
     I              AXD4DT                          TAD4DT
     I              AXBNCD                          TABNCD
     I              AXABCD                          TAABCD
     I              AXAECD                          TAAECD
     I              AXAAVN                          TAAAVN
     I              AXAADT                          TAAADT
     I              AXAMTM                          TAAMTM
     I              AXAJST                          TAAJST
     I              AXAHVN                          TAAHVN
     I              AXAGVN                          TAAGVN
     I              AXABVN                          TAABVN
     I              AXABDT                          TAABDT
     I              AXABTM                          TAABTM
      *
     I@AWCPAZ
      * Buy Order Header          Update index
      * Renamed input format fields
     I              AWHMNB                          TBHMNB
     I              AWBNNB                          TBBNNB
     I              AWARDT                          TBARDT
     I              AWASDT                          TBASDT
     I              AWA4ST                          TBA4ST
     I              AWA5ST                          TBA5ST
     I              AWAAPR                          TBAAPR
     I              AWA6ST                          TBA6ST
     I              AWA7ST                          TBA7ST
     I              AWB3ST                          TBB3ST
     I              AWALPR                          TBALPR
     I              AWETCD                          TBETCD
     I              AWEUCD                          TBEUCD
     I              AWJ5TX                          TBJ5TX
     I              AWD5DT                          TBD5DT
     I              AWD6DT                          TBD6DT
     I              AWD7DT                          TBD7DT
     I              AWD8DT                          TBD8DT
     I              AWD9DT                          TBD9DT
     I              AWJOEJ                          TBJOEJ
     I              AWKOFF                          TBKOFF
     I              AWKWPE                          TBKWPE
     I              AWIMBF                          TBIMBF
     I              AWOPTR                          TBOPTR
     I              AWOEJD                          TBOEJD
     I              AWIRMF                          TBIRMF
     I              AWJIRM                          TBJIRM
     I              AWJRKF                          TBJRKF
     I              AWKFIR                          TBKFIR
     I              AWUZST                          TBUZST
     I              AWU0ST                          TBU0ST
     I              AWU1ST                          TBU1ST
     I              AWU2ST                          TBU2ST
     I              AWU3ST                          TBU3ST
     I              AWHXNB                          TBHXNB
     I              AWGANB                          TBGANB
     I              AWGBNB                          TBGBNB
     I              AWABCD                          TBABCD
     I              AWAECD                          TBAECD
     I              AWAKCD                          TBAKCD
     I              AWALCD                          TBALCD
     I              AWAGCD                          TBAGCD
     I              AWAICD                          TBAICD
     I              AWAMCD                          TBAMCD
     I              AWACCD                          TBACCD
     I              AWAAVN                          TBAAVN
     I              AWAADT                          TBAADT
     I              AWAMTM                          TBAMTM
     I              AWAJST                          TBAJST
     I              AWAHVN                          TBAHVN
     I              AWAGVN                          TBAGVN
     I              AWABVN                          TBABVN
     I              AWABDT                          TBABDT
     I              AWABTM                          TBABTM
      *
     I@AXCPB8
      * Buy Order Load           Co/KillDte/DlvDte/DlvTme
      * Renamed input format fields
     I              AXHMNB                          TCHMNB
     I              AXBNNB                          TCBNNB
     I              AXBONB                          TCBONB
     I              AXCQDT                          TCCQDT
     I              AXABTH                          TCABTH
     I              AXACTH                          TCACTH
     I              AXBPNB                          TCBPNB
     I              AXCSNB                          TCCSNB
     I              AXAUDT                          TCAUDT
     I              AXCMST                          TCCMST
     I              AXAGPR                          TCAGPR
     I              AXATVA                          TCATVA
     I              AXI1ST                          TCI1ST
     I              AXDHNB                          TCDHNB
     I              AXDINB                          TCDINB
     I              AXCNST                          TCCNST
     I              AXGINB                          TCGINB
     I              AXBZDT                          TCBZDT
     I              AXLSNB                          TCLSNB
     I              AXF3TX                          TCF3TX
     I              AXO8ST                          TCO8ST
     I              AXO9ST                          TCO9ST
     I              AXPAST                          TCPAST
     I              AXLDSH                          TCLDSH
     I              AXPBST                          TCPBST
     I              AXPCST                          TCPCST
     I              AXPDST                          TCPDST
     I              AXUWST                          TCUWST
     I              AXUXST                          TCUXST
     I              AXUYST                          TCUYST
     I              AXJKRU                          TCJKRU
     I              AXKEOR                          TCKEOR
     I              AXIOEW                          TCIOEW
     I              AXKJIO                          TCKJIO
     I              AXIOJR                          TCIOJR
     I              AXEIRR                          TCEIRR
     I              AXITMF                          TCITMF
     I              AXODJE                          TCODJE
     I              AXRJIF                          TCRJIF
     I              AXOEJF                          TCOEJF
     I              AXD0DT                          TCD0DT
     I              AXD1DT                          TCD1DT
     I              AXD2DT                          TCD2DT
     I              AXD3DT                          TCD3DT
     I              AXD4DT                          TCD4DT
     I              AXBNCD                          TCBNCD
     I              AXABCD                          TCABCD
     I              AXAECD                          TCAECD
     I              AXAAVN                          TCAAVN
     I              AXAADT                          TCAADT
     I              AXAMTM                          TCAMTM
     I              AXAJST                          TCAJST
     I              AXAHVN                          TCAHVN
     I              AXAGVN                          TCAGVN
     I              AXABVN                          TCABVN
     I              AXABDT                          TCABDT
     I              AXABTM                          TCABTM
      *
     I@FHCPHN
      * MPR Prior Day Sched Dtl   Retrieval index
      * Renamed input format fields
     I              FHH8CD                          TDH8CD
     I              FHETDT                          TDETDT
     I              FHC2A1                          TDC2A1
     I              FHCQDT                          TDCQDT
     I              FHBNNB                          TDBNNB
     I              FHBONB                          TDBONB
     I              FHABCD                          TDABCD
     I              FHAECD                          TDAECD
     I              FHBPNB                          TDBPNB
     I              FHAAVN                          TDAAVN
     I              FHAADT                          TDAADT
     I              FHAMTM                          TDAMTM
     I              FHAJST                          TDAJST
     I              FHAHVN                          TDAHVN
     I              FHAGVN                          TDAGVN
     I              FHABVN                          TDABVN
     I              FHABDT                          TDABDT
     I              FHABTM                          TDABTM
      *
     I@FHCPHM
      * MPR Prior Day Sched Dtl   Update index
      * Renamed input format fields
     I              FHH8CD                          TEH8CD
     I              FHETDT                          TEETDT
     I              FHC2A1                          TEC2A1
     I              FHCQDT                          TECQDT
     I              FHBNNB                          TEBNNB
     I              FHBONB                          TEBONB
     I              FHABCD                          TEABCD
     I              FHAECD                          TEAECD
     I              FHBPNB                          TEBPNB
     I              FHAAVN                          TEAAVN
     I              FHAADT                          TEAADT
     I              FHAMTM                          TEAMTM
     I              FHAJST                          TEAJST
     I              FHAHVN                          TEAHVN
     I              FHAGVN                          TEAGVN
     I              FHABVN                          TEABVN
     I              FHABDT                          TEABDT
     I              FHABTM                          TEABTM
      *
     I@AXCPNQ
      * Buy Order Load            Co/DelvDte
      * Renamed input format fields
     I              AXHMNB                          TFHMNB
     I              AXBNNB                          TFBNNB
     I              AXBONB                          TFBONB
     I              AXCQDT                          TFCQDT
     I              AXABTH                          TFABTH
     I              AXACTH                          TFACTH
     I              AXBPNB                          TFBPNB
     I              AXCSNB                          TFCSNB
     I              AXAUDT                          TFAUDT
     I              AXCMST                          TFCMST
     I              AXAGPR                          TFAGPR
     I              AXATVA                          TFATVA
     I              AXI1ST                          TFI1ST
     I              AXDHNB                          TFDHNB
     I              AXDINB                          TFDINB
     I              AXCNST                          TFCNST
     I              AXGINB                          TFGINB
     I              AXBZDT                          TFBZDT
     I              AXLSNB                          TFLSNB
     I              AXF3TX                          TFF3TX
     I              AXO8ST                          TFO8ST
     I              AXO9ST                          TFO9ST
     I              AXPAST                          TFPAST
     I              AXLDSH                          TFLDSH
     I              AXPBST                          TFPBST
     I              AXPCST                          TFPCST
     I              AXPDST                          TFPDST
     I              AXUWST                          TFUWST
     I              AXUXST                          TFUXST
     I              AXUYST                          TFUYST
     I              AXJKRU                          TFJKRU
     I              AXKEOR                          TFKEOR
     I              AXIOEW                          TFIOEW
     I              AXKJIO                          TFKJIO
     I              AXIOJR                          TFIOJR
     I              AXEIRR                          TFEIRR
     I              AXITMF                          TFITMF
     I              AXODJE                          TFODJE
     I              AXRJIF                          TFRJIF
     I              AXOEJF                          TFOEJF
     I              AXD0DT                          TFD0DT
     I              AXD1DT                          TFD1DT
     I              AXD2DT                          TFD2DT
     I              AXD3DT                          TFD3DT
     I              AXD4DT                          TFD4DT
     I              AXBNCD                          TFBNCD
     I              AXABCD                          TFABCD
     I              AXAECD                          TFAECD
     I              AXAAVN                          TFAAVN
     I              AXAADT                          TFAADT
     I              AXAMTM                          TFAMTM
     I              AXAJST                          TFAJST
     I              AXAHVN                          TFAHVN
     I              AXAGVN                          TFAGVN
     I              AXABVN                          TFABVN
     I              AXABDT                          TFABDT
     I              AXABTM                          TFABTM
      *
     I@E5CPGP
      * MPR Prior Day Scheduled   Retrieval index
      * Renamed input format fields
     I              E5H8CD                          TGH8CD
     I              E5ETDT                          TGETDT
     I              E5C2A1                          TGC2A1
     I              E5C4A1                          TGC4A1
     I              E5C5A1                          TGC5A1
     I              E5C6A1                          TGC6A1
     I              E5C7A1                          TGC7A1
     I              E5C8A1                          TGC8A1
     I              E5C9A1                          TGC9A1
     I              E5DAA1                          TGDAA1
     I              E5DBA1                          TGDBA1
     I              E5DCA1                          TGDCA1
     I              E5DDA1                          TGDDA1
     I              E5DEA1                          TGDEA1
     I              E5DFA1                          TGDFA1
     I              E5DGA1                          TGDGA1
     I              E5DHA1                          TGDHA1
     I              E5AAVN                          TGAAVN
     I              E5AADT                          TGAADT
     I              E5AMTM                          TGAMTM
     I              E5AJST                          TGAJST
     I              E5AHVN                          TGAHVN
     I              E5AGVN                          TGAGVN
     I              E5ABVN                          TGABVN
     I              E5ABDT                          TGABDT
     I              E5ABTM                          TGABTM
      *
     I@E5CPGO
      * MPR Prior Day Scheduled   Update index
      * Renamed input format fields
     I              E5H8CD                          THH8CD
     I              E5ETDT                          THETDT
     I              E5C2A1                          THC2A1
     I              E5C4A1                          THC4A1
     I              E5C5A1                          THC5A1
     I              E5C6A1                          THC6A1
     I              E5C7A1                          THC7A1
     I              E5C8A1                          THC8A1
     I              E5C9A1                          THC9A1
     I              E5DAA1                          THDAA1
     I              E5DBA1                          THDBA1
     I              E5DCA1                          THDCA1
     I              E5DDA1                          THDDA1
     I              E5DEA1                          THDEA1
     I              E5DFA1                          THDFA1
     I              E5DGA1                          THDGA1
     I              E5DHA1                          THDHA1
     I              E5AAVN                          THAAVN
     I              E5AADT                          THAADT
     I              E5AMTM                          THAMTM
     I              E5AJST                          THAJST
     I              E5AHVN                          THAHVN
     I              E5AGVN                          THAGVN
     I              E5ABVN                          THABVN
     I              E5ABDT                          THABDT
     I              E5ABTM                          THABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPKE41    E DSPKE4CPL0
      * UPD : MPR Estimated Purchases   Update index
      * Renamed input format fields
     I              E4HONB                          WCHONB
     I              E4ETDT                          WCETDT
     I              E4C0A1                          WCC0A1
     I              E4C1A1                          WCC1A1
     I              E4AAVN                          WCAAVN
     I              E4AADT                          WCAADT
     I              E4AMTM                          WCAMTM
     I              E4AJST                          WCAJST
     I              E4AHVN                          WCAHVN
     I              E4AGVN                          WCAGVN
     I              E4ABVN                          WCABVN
     I              E4ABDT                          WCABDT
     I              E4ABTM                          WCABTM
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IQPKE61    E DSPKE6CPL0
      * UPD : MPR Prior Day Slaughtered Update index
      * Renamed input format fields
     I              E6H8CD                          WLH8CD
     I              E6ETDT                          WLETDT
     I              E6C2A1                          WLC2A1
     I              E6IBCD                          WLIBCD
     I              E6DOA1                          WLDOA1
     I              E6DPA1                          WLDPA1
     I              E6DQA1                          WLDQA1
     I              E6UUPR                          WLUUPR
     I              E6UVPR                          WLUVPR
     I              E6UWPR                          WLUWPR
     I              E6UXPR                          WLUXPR
     I              E6DRA1                          WLDRA1
     I              E6DSA1                          WLDSA1
     I              E6UYPR                          WLUYPR
     I              E6DTA1                          WLDTA1
     I              E6DUA1                          WLDUA1
     I              E6DVA1                          WLDVA1
     I              E6AAVN                          WLAAVN
     I              E6AADT                          WLAADT
     I              E6AMTM                          WLAMTM
     I              E6AJST                          WLAJST
     I              E6AHVN                          WLAHVN
     I              E6AGVN                          WLAGVN
     I              E6ABVN                          WLABVN
     I              E6ABDT                          WLABDT
     I              E6ABTM                          WLABTM
      *
     IYARDCS      DS                            129
     IQPKE71    E DSPKE7CPL0
      * UPD : MPR Prior Day Purchased   Update index
      * Renamed input format fields
     I              E7H8CD                          WYH8CD
     I              E7ETDT                          WYETDT
     I              E7C2A1                          WYC2A1
     I              E7IBCD                          WYIBCD
     I              E7DWA1                          WYDWA1
     I              E7DXA1                          WYDXA1
     I              E7DYA1                          WYDYA1
     I              E7DZA1                          WYDZA1
     I              E7D0A1                          WYD0A1
     I              E7UZPR                          WYUZPR
     I              E7IDCD                          WYIDCD
     I              E7AAVN                          WYAAVN
     I              E7AADT                          WYAADT
     I              E7AMTM                          WYAMTM
     I              E7AJST                          WYAJST
     I              E7AHVN                          WYAHVN
     I              E7AGVN                          WYAGVN
     I              E7ABVN                          WYABVN
     I              E7ABDT                          WYABDT
     I              E7ABTM                          WYABTM
      *
     IYBRDCS      DS                            108
     IQPKAX1    E DSPKAXCPL1
      * UPD : Buy Order Load            Update index
      * Renamed input format fields
     I              AXHMNB                          TAHMNB
     I              AXBNNB                          TABNNB
     I              AXBONB                          TABONB
     I              AXCQDT                          TACQDT
     I              AXABTH                          TAABTH
     I              AXACTH                          TAACTH
     I              AXBPNB                          TABPNB
     I              AXCSNB                          TACSNB
     I              AXAUDT                          TAAUDT
     I              AXCMST                          TACMST
     I              AXAGPR                          TAAGPR
     I              AXATVA                          TAATVA
     I              AXI1ST                          TAI1ST
     I              AXDHNB                          TADHNB
     I              AXDINB                          TADINB
     I              AXCNST                          TACNST
     I              AXGINB                          TAGINB
     I              AXBZDT                          TABZDT
     I              AXLSNB                          TALSNB
     I              AXF3TX                          TAF3TX
     I              AXO8ST                          TAO8ST
     I              AXO9ST                          TAO9ST
     I              AXPAST                          TAPAST
     I              AXLDSH                          TALDSH
     I              AXPBST                          TAPBST
     I              AXPCST                          TAPCST
     I              AXPDST                          TAPDST
     I              AXUWST                          TAUWST
     I              AXUXST                          TAUXST
     I              AXUYST                          TAUYST
     I              AXJKRU                          TAJKRU
     I              AXKEOR                          TAKEOR
     I              AXIOEW                          TAIOEW
     I              AXKJIO                          TAKJIO
     I              AXIOJR                          TAIOJR
     I              AXEIRR                          TAEIRR
     I              AXITMF                          TAITMF
     I              AXODJE                          TAODJE
     I              AXRJIF                          TARJIF
     I              AXOEJF                          TAOEJF
     I              AXD0DT                          TAD0DT
     I              AXD1DT                          TAD1DT
     I              AXD2DT                          TAD2DT
     I              AXD3DT                          TAD3DT
     I              AXD4DT                          TAD4DT
     I              AXBNCD                          TABNCD
     I              AXABCD                          TAABCD
     I              AXAECD                          TAAECD
     I              AXAAVN                          TAAAVN
     I              AXAADT                          TAAADT
     I              AXAMTM                          TAAMTM
     I              AXAJST                          TAAJST
     I              AXAHVN                          TAAHVN
     I              AXAGVN                          TAAGVN
     I              AXABVN                          TAABVN
     I              AXABDT                          TAABDT
     I              AXABTM                          TAABTM
      *
     IYCRDCS      DS                            237
     IQPKAW1    E DSPKAWCPL0
      * UPD : Buy Order Header          Update index
      * Renamed input format fields
     I              AWHMNB                          TBHMNB
     I              AWBNNB                          TBBNNB
     I              AWARDT                          TBARDT
     I              AWASDT                          TBASDT
     I              AWA4ST                          TBA4ST
     I              AWA5ST                          TBA5ST
     I              AWAAPR                          TBAAPR
     I              AWA6ST                          TBA6ST
     I              AWA7ST                          TBA7ST
     I              AWB3ST                          TBB3ST
     I              AWALPR                          TBALPR
     I              AWETCD                          TBETCD
     I              AWEUCD                          TBEUCD
     I              AWJ5TX                          TBJ5TX
     I              AWD5DT                          TBD5DT
     I              AWD6DT                          TBD6DT
     I              AWD7DT                          TBD7DT
     I              AWD8DT                          TBD8DT
     I              AWD9DT                          TBD9DT
     I              AWJOEJ                          TBJOEJ
     I              AWKOFF                          TBKOFF
     I              AWKWPE                          TBKWPE
     I              AWIMBF                          TBIMBF
     I              AWOPTR                          TBOPTR
     I              AWOEJD                          TBOEJD
     I              AWIRMF                          TBIRMF
     I              AWJIRM                          TBJIRM
     I              AWJRKF                          TBJRKF
     I              AWKFIR                          TBKFIR
     I              AWUZST                          TBUZST
     I              AWU0ST                          TBU0ST
     I              AWU1ST                          TBU1ST
     I              AWU2ST                          TBU2ST
     I              AWU3ST                          TBU3ST
     I              AWHXNB                          TBHXNB
     I              AWGANB                          TBGANB
     I              AWGBNB                          TBGBNB
     I              AWABCD                          TBABCD
     I              AWAECD                          TBAECD
     I              AWAKCD                          TBAKCD
     I              AWALCD                          TBALCD
     I              AWAGCD                          TBAGCD
     I              AWAICD                          TBAICD
     I              AWAMCD                          TBAMCD
     I              AWACCD                          TBACCD
     I              AWAAVN                          TBAAVN
     I              AWAADT                          TBAADT
     I              AWAMTM                          TBAMTM
     I              AWAJST                          TBAJST
     I              AWAHVN                          TBAHVN
     I              AWAGVN                          TBAGVN
     I              AWABVN                          TBABVN
     I              AWABDT                          TBABDT
     I              AWABTM                          TBABTM
      *
     IYDRDCS      DS                            219
     IQPKFH1    E DSPKFHCPL0
      * UPD : MPR Prior Day Sched Dtl   Update index
      * Renamed input format fields
     I              FHH8CD                          TEH8CD
     I              FHETDT                          TEETDT
     I              FHC2A1                          TEC2A1
     I              FHCQDT                          TECQDT
     I              FHBNNB                          TEBNNB
     I              FHBONB                          TEBONB
     I              FHABCD                          TEABCD
     I              FHAECD                          TEAECD
     I              FHBPNB                          TEBPNB
     I              FHAAVN                          TEAAVN
     I              FHAADT                          TEAADT
     I              FHAMTM                          TEAMTM
     I              FHAJST                          TEAJST
     I              FHAHVN                          TEAHVN
     I              FHAGVN                          TEAGVN
     I              FHABVN                          TEABVN
     I              FHABDT                          TEABDT
     I              FHABTM                          TEABTM
      *
     IYERDCS      DS                             93
     IYFRDCS      DS                            219
     IYGRDCS      DS                             69
     IYHRDCS      DS                             69
     IYIRDCS      DS                             69
     IYJRDCS      DS                             69
     IYKRDCS      DS                             69
     IYLRDCS      DS                             69
     IYMRDCS      DS                             69
     IYNRDCS      DS                             69
     IYORDCS      DS                             69
     IYPRDCS      DS                             69
     IYQRDCS      DS                             93
     IQPKE51    E DSPKE5CPL0
      * UPD : MPR Prior Day Scheduled   Update index
      * Renamed input format fields
     I              E5H8CD                          THH8CD
     I              E5ETDT                          THETDT
     I              E5C2A1                          THC2A1
     I              E5C4A1                          THC4A1
     I              E5C5A1                          THC5A1
     I              E5C6A1                          THC6A1
     I              E5C7A1                          THC7A1
     I              E5C8A1                          THC8A1
     I              E5C9A1                          THC9A1
     I              E5DAA1                          THDAA1
     I              E5DBA1                          THDBA1
     I              E5DCA1                          THDCA1
     I              E5DDA1                          THDDA1
     I              E5DEA1                          THDEA1
     I              E5DFA1                          THDFA1
     I              E5DGA1                          THDGA1
     I              E5DHA1                          THDHA1
     I              E5AAVN                          THAAVN
     I              E5AADT                          THAADT
     I              E5AMTM                          THAMTM
     I              E5AJST                          THAJST
     I              E5AHVN                          THAHVN
     I              E5AGVN                          THAGVN
     I              E5ABVN                          THABVN
     I              E5ABDT                          THABDT
     I              E5ABTM                          THABTM
      *
     IYRRDCS      DS                            123
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  Company Number USR
     I                                    P   1   20P1GGNB
     IP2PARM      DS
      * N :  Last Kill Date Rptd USR
     I                                    P   1   40P2EUDT
     IP3PARM      DS
      * N :  Pmt Current Payment Date
     I                                    P   1   40P3CKDT
     IP4PARM      DS
      * N :  Kill Date Usr
     I                                    P   1   40P4CGDT
     IP5PARM      DS
      * B :  MPR Identification Num
     I                                        1   5 P5H8CD
     IP6PARM      DS
      * FLD: MPR Prior Day Scheduled
      * B :  MPR Reporting Date
     I                                    P   1   40P6ETDT
      * B :  MPR Reporting Time
     I                                    P   5   50P6C2A1
      * N :  MPR Sch Head Day 1
     I                                    P   6   90P6C4A1
      * N :  MPR Sch Head Day 2
     I                                    P  10  130P6C5A1
      * N :  MPR Sch Head Day 3
     I                                    P  14  170P6C6A1
      * N :  MPR Sch Head Day 4
     I                                    P  18  210P6C7A1
      * N :  MPR Sch Head Day 5
     I                                    P  22  250P6C8A1
      * N :  MPR Sch Head Day 6
     I                                    P  26  290P6C9A1
      * N :  MPR Sch Head Day 7
     I                                    P  30  330P6DAA1
      * N :  MPR Sch Head Day 8
     I                                    P  34  370P6DBA1
      * N :  MPR Sch Head Day 9
     I                                    P  38  410P6DCA1
      * N :  MPR Sch Head Day 10
     I                                    P  42  450P6DDA1
      * N :  MPR Sch Head Day 11
     I                                    P  46  490P6DEA1
      * N :  MPR Sch Head Day 12
     I                                    P  50  530P6DFA1
      * N :  MPR Sch Head Day 13
     I                                    P  54  570P6DGA1
      * N :  MPR Sch Head Day 14
     I                                    P  58  610P6DHA1
     IP7PARM      DS
      * O :  MPR Day Sts USR
     I                                        1   1 P7V8ST
     IP8PARM      DS
      * B :  MPR LS118C file created
     I                                        1   1 P8WAST
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1GGNB    PARM           WP0001  30       Company Number
     C           P5H8CD    PARM P5H8CD    WP0002  5        MPR Identificat
     C           P6ETDT    PARM P6ETDT    WP0003  70       MPR Reporting D
     C           P6C2A1    PARM P6C2A1    WP0004  10       MPR Reporting T
     C           P7V8ST    PARM P7V8ST    WP0005  1        MPR Day Sts USR
     C           P8WAST    PARM P8WAST    WP0006  1        MPR LS118C file
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Bld Prior Day Report  XF
      * Modifications and Comments
     C                     EXSR UASUBR                     Modifications a
      * Rtv System Date       UP - STR User Source Functions  * 
     C                     CALL 'PKPSUPR'              90  Rtv System Date
     C           P6ETDT    PARM *ZERO     WQ0001  70       *DATE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKPSUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     Z-ADD3         P6C2A1           MPR Reporting T
      * * Retrieve the default Company Number for the User *
      *  RMC 1/4/6 not now.. use input parm Company
      * * Validate if Kill Day Sts is Yes for the Current Date *
      * 03/26/09 PKD/RMC Do not need to check the Kill Day Sts.  Handled
      *                  by the scheduled job on the PC.
      *    - If Invalid Y/N USR = Y, then Kill Day Sts = N.
      *    - If Invalid Y/N USR = N, then Kill Day Sts = Y.
      * 03/26/09 PKD/RMC Invalid = No all the time.
     C                     MOVEL'N'       YL0001           Invalid Y/N USR
      * Continue processing if Invalid Y/N is No.
      * CASE: LCL.Invalid Y/N USR is No
     C           YL0001    IFEQ 'N'                        *IF
      * * Set Reporting Day Status to Yes                              *
     C                     MOVEL'Y'       P7V8ST           MPR Day Sts USR
      * * Retrieve the Last Kill Date Reported from the Company Values *
      * * Retrieve the Last Kill Date Reported from the MPR Control -
      *    will auto-set if a rerun (ie. job date = LAST job date)
      * Exc MPR Ctl-Chk Rerun XF - MPR Control  * 
     C                     CALL 'PWJKXFR'              90  Exc MPR Ctl-Chk
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1GGNB    WQ0002  30       Company
     C           WUH8DT    PARM WUH8DT    WQ0003  70       MPR Last Kill D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWJKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADDWUH8DT    P2EUDT           Last Kill Date
      * * Retrieve the Current Payment Date *
      * RTV Payment Prc        RT - Payment Processing Parms  * 
     C                     EXSR SARVGN
      * * Retrieve Plant Establishment Number from the Company Values *
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1GGNB    WQ0004  30       BOH Company Num
     C                     PARM 'PLTESTNO'WQ0005 10        Company Value C
     C           YL0003    PARM *BLANK    WQ0006 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0003    P5H8CD           MPR Identificat
      * R7841 RMC 11.17 Delete estimated head records -- if a rerun they'
      * Rtv Del Estmtd Purch  RT - MPR Estimated Purchases  * 
     C                     EXSR SBRVGN
      * * Build Prior Day files for paid Kill Dates *
      * Process each day, starting with the day after the Last Kill Date
      * Reported, until the Reporting Date is reached.
      * PAR.Kill Date Usr = PAR.Last Kill Date Rptd USR + CON.1 *DAYS
     C           P2EUDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P4CGDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P4CGDT
     C                     END
      * Process Kill Date while Kill Date < Reporting Date
      * DO WHILE: PAR.Kill Date Usr LT PAR.MPR Reporting Date
     C           P4CGDT    DOWLTP6ETDT                     *DOW
      * * Validate if Kill Day Sts for the Date in the Calendar is Yes *
      * VAL Kill Day    2 OMS XF - STR Order Management Sys  * 
     C                     CALL 'PDWBXFR'              90  VAL Kill Day
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1GGNB    WQ0007  30       PPWS Company Nu
     C                     PARM P4CGDT    WQ0008  70       Kill Date Usr
     C           YL0001    PARM *BLANK    WQ0009  1        Invalid Y/N USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDWBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *    - If Invalid Y/N USR = Y, then Kill Day Sts = N.
      *    - If Invalid Y/N USR = N, then Kill Day Sts = Y.
      * If Kill Day Sts = Y, then build the Prior Day Report files
      * CASE: LCL.Invalid Y/N USR is No
     C           YL0001    IFEQ 'N'                        *IF
      * ***** Build File B: MPR Prior Day Slaughtered *****
      * DOC:  Slaughter Swine  LS118B
     C                     EXSR UBSUBR                     DOC:  Slaughter
      * MPR Bld Prior Day Slg RT - Tattoo Header  * 
     C                     EXSR SDRVGN
      * RMC T15265 7/29/19 Update Last Kill date reported in MPR control
      *   after all the kill days have been processed - outside of Loop
      * LCL.System Value Numeric  USR = PAR.Kill Date Usr
     C                     Z-ADDP4CGDT    YL0059           System Value Nu
      * PAR.Last Kill Date Rptd USR = LCL.System Value Numeric  USR
     C                     Z-ADDYL0059    P2EUDT           Last Kill Date
     C                     END                             *FI
      * ***** Build File C: MPR Prior Day Purchased   *****
      * DOC:  Purchased Swine    LS118C
     C                     EXSR UDSUBR                     DOC:  Purchased
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1GGNB    WQ0014  30       BOH Company Num
     C                     PARM 'MPRORGST'WQ0015 10        Company Value C
     C           YL0060    PARM *BLANK    WQ0016 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Rtv MPR Prior Day PrchRT - Buy Order Header  * 
     C                     EXSR SORVGN
      * If Rerun -- records would have been created on 1st pass, so chg f
      * CASE: WRK.Record Added Usr is No
     C           WUIHST    IFEQ 'N'                        *IF
      * Rtv Record f/RptDay   RT - MPR Prior Day Purchased  * 
     C                     EXSR TFRVGN
     C                     END                             *FI
      * LS118C Created Y/N
      * CASE:
      *  - c1ANDc2
      *   |- c1    : WRK.Record Added Usr is No
      *   |- c2    : PAR.MPR LS118C file created is Not Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUIHST    IFEQ 'N'                        *IF
     C           P8WAST    IFEQ *BLANK                     *IF
     C           P8WAST    OREQ 'N'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       P8WAST           MPR LS118C file
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       P8WAST           MPR LS118C file
     C                     END                             *FI
      * 11/17/16 R7307 RMC "The morning 119A form needs to include the
      * the Estimate number of hogs for each purchase type that you belie
      * you will be PRICING between 1:30pm and 1:30pm. Est s/be >=Actual"
      * Based on the above from usda, use the kill dates being reported,
      * reporting date, so this is moved into the Repeat While killdate l
      * 05/20/19 S15008 RMC Add NEG only if ls118a report date = boh rpt
      * 06/03/19 S15008 RMC Upd BOH MPR EST STS when reported on estimate
      * MPR Bld Estimtd f/Sch RT - Buy Order Load  * 
     C                     EXSR TGRVGN
      * * Increment the Date by 1 *
      * PAR.Kill Date Usr = PAR.Kill Date Usr + CON.1 *DAYS
     C           P4CGDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P4CGDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P4CGDT
     C                     END
     C                     END                             *ITR
      * RMC T15265 7/29/19 Update Last Kill date reported in MPR control
      * Exc MPR Ctl-Upd aft   XF - MPR Control  * 
     C                     CALL 'PWJLXFR'              90  Exc MPR Ctl-Upd
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1GGNB    WQ0080  30       Company
     C                     PARM P2EUDT    WQ0081  70       MPR Last Kill D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWJLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * ***** Build File A: MPR Prior Day Scheduled   *****
      * DOC:  Scheduled Swine   LS118A
     C                     EXSR UESUBR                     DOC:  Scheduled
      * - Commented out 07/01/03 -
     C                     Z-ADDP6ETDT    P4CGDT           Kill Date Usr
      * --------------------------
     C                     Z-ADD1         YL0080           Count USR
      * DO WHILE: LCL.Count USR is LE 14
     C           YL0080    DOWLE14                         *DOW
      * MPR Bld Prior Day Sch RT - Buy Order Load  * 
     C                     EXSR NSRVGN
      * Move Planned Kill to appropriate Day
      * CASE: LCL.Count USR is One
     C           YL0080    IFEQ 1                          *IF
     C                     Z-ADDYL0081    P6C4A1           MPR Sch Head Da
     C                     ELSE
      * CASE: LCL.Count USR is Two
     C           YL0080    IFEQ 2                          *IF
     C                     Z-ADDYL0081    P6C5A1           MPR Sch Head Da
     C                     ELSE
      * CASE: LCL.Count USR is Three
     C           YL0080    IFEQ 3                          *IF
     C                     Z-ADDYL0081    P6C6A1           MPR Sch Head Da
     C                     ELSE
      * CASE: LCL.Count USR is Four
     C           YL0080    IFEQ 4                          *IF
     C                     Z-ADDYL0081    P6C7A1           MPR Sch Head Da
     C                     ELSE
      * CASE: LCL.Count USR is Five
     C           YL0080    IFEQ 5                          *IF
     C                     Z-ADDYL0081    P6C8A1           MPR Sch Head Da
     C                     ELSE
      * CASE: LCL.Count USR is Six
     C           YL0080    IFEQ 6                          *IF
     C                     Z-ADDYL0081    P6C9A1           MPR Sch Head Da
     C                     ELSE
      * CASE: LCL.Count USR is Seven
     C           YL0080    IFEQ 7                          *IF
     C                     Z-ADDYL0081    P6DAA1           MPR Sch Head Da
     C                     ELSE
      * CASE: LCL.Count USR is Eight
     C           YL0080    IFEQ 8                          *IF
     C                     Z-ADDYL0081    P6DBA1           MPR Sch Head Da
     C                     ELSE
      * CASE: LCL.Count USR is Nine
     C           YL0080    IFEQ 9                          *IF
     C                     Z-ADDYL0081    P6DCA1           MPR Sch Head Da
     C                     ELSE
      * CASE: LCL.Count USR is Ten
     C           YL0080    IFEQ 10                         *IF
     C                     Z-ADDYL0081    P6DDA1           MPR Sch Head Da
     C                     ELSE
      * CASE: LCL.Count USR is Eleven
     C           YL0080    IFEQ 11                         *IF
     C                     Z-ADDYL0081    P6DEA1           MPR Sch Head Da
     C                     ELSE
      * CASE: LCL.Count USR is Twelve
     C           YL0080    IFEQ 12                         *IF
     C                     Z-ADDYL0081    P6DFA1           MPR Sch Head Da
     C                     ELSE
      * CASE: LCL.Count USR is Thirteen
     C           YL0080    IFEQ 13                         *IF
     C                     Z-ADDYL0081    P6DGA1           MPR Sch Head Da
     C                     ELSE
      * CASE: LCL.Count USR is Fourteen
     C           YL0080    IFEQ 14                         *IF
     C                     Z-ADDYL0081    P6DHA1           MPR Sch Head Da
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * PAR.Kill Date Usr = PAR.Kill Date Usr + CON.1 *DAYS
     C           P4CGDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P4CGDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P4CGDT
     C                     END
     C                     ADD  1         YL0080           Count USR
     C                     END                             *ITR
      * Upd Prior Day Sched   RT - MPR Prior Day Scheduled  * 
     C                     EXSR NWRVGN
      * ***** Build File LS119A: MPR Daily Purchase Summary Estimated fie
      * This happens every morning. Jancie can maintain it throughout the
      * 12/09/02 Create detail here too, with reporting time=1
      * 12/19/08 E00315 RMC dont report est purch for purch type 1,5 for
      * 09/23/16 R7307 RMC New purch types
      * 11/17/16 R7307 RMC "The morning 119A form needs to include the
      * the Estimate number of hogs for each purchase type that you belie
      * you will be PRICING between 1:30pm and 1:30pm. Est s/be >=Actual"
      * Based on the above from usda, use the kill dates being reported,
      * reporting date, so this is moved into the Repeat While killdate l
     C                     ELSE
      * CASE: *OTHERWISE
      * * Set Reporting Day Status to No                               *
     C                     MOVEL'N'       P7V8ST           MPR Day Sts USR
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         NARVGN    BEGSR
      *================================================================
      * Rtv Upd Estmtd Purch  RT - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNA     KLIST
     C                     KFLD           WBHONB           CC Company Numb
     C                     KFLD           WBETDT           MPR Reporting D
     C                     KFLD           WBC0A1           MPR Purchase Ty
      * Setup key
     C                     Z-ADDTCHMNB    WBHONB           CC Company Numb
     C                     Z-ADDP6ETDT    WBETDT           MPR Reporting D
     C                     Z-ADD5         WBC0A1           MPR Purchase Ty
      * Establish starting position
     C           KRSNA     CHAIN@E4CPF7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0969' W0RTN   7
      * USER: Processing if Data record not found
      * Crt MPR Estmtd Purch  CR - MPR Estimated Purchases  * 
     C                     EXSR NBCRRC
     C                     GOTO NAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WBC1A1    ADD  WN0171    YL0079           MPR Estimated H
      * Chg MPR Estmtd Purch  CH - MPR Estimated Purchases  * 
     C                     EXSR NCCHRC
     C                     ENDIF
      *================================================================
     CSR         NAEXIT    ENDSR
      /EJECT
     CSR         NBCRRC    BEGSR
      *================================================================
      * Crt MPR Estmtd Purch  CR - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @E4CPF6
     C                     Z-ADDTCHMNB    WCHONB           CC Company Numb
     C                     Z-ADDP6ETDT    WCETDT           MPR Reporting D
     C                     Z-ADD5         WCC0A1           MPR Purchase Ty
     C                     Z-ADDWN0171    WCC1A1           MPR Estimated H
     C                     MOVEL*BLANK    WCAAVN           RS User Changed
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     MOVELWUAJST    WCAJST           RS Record Statu
     C                     MOVEL*BLANK    WCAHVN           RS Job
     C                     MOVEL*BLANK    WCAGVN           RS Program
     C                     MOVEL*BLANK    WCABVN           RS User Added
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WCAJST           RS Record Statu
     C                     MOVEL##USR     WCABVN           RS User Added
     C                     Z-ADD##JDT     WCABDT           RS Date Added
     C                     Z-ADD##JTM     WCABTM           RS Time Added
     C                     MOVEL##PGM     WCAGVN           RS Program
     C                     MOVEL##JOB     WCAHVN           RS Job
     C           KLCRNB    KLIST
     C                     KFLD           WCHONB           CC Company Numb
     C                     KFLD           WCETDT           MPR Reporting D
     C                     KFLD           WCC0A1           MPR Purchase Ty
      * Check for duplicate primary key
     C           KLCRNB    SETLL@E4CPF6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0970' W0RTN   7
      * Send message 'MPR Estimated Purchase EX'
     C                     MOVEL'PRK0970' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO NBEXIT
     C                     ENDIF
      *
     C                     WRITE@E4CPF6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NBEXIT    ENDSR
      /EJECT
     CSR         NCCHRC    BEGSR
      *================================================================
      * Chg MPR Estmtd Purch  CH - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YKRDC   1
      *
      * Move key fields to @E4CPF6
     C                     Z-ADDWBHONB    WCHONB           CC Company Numb
     C                     Z-ADDWBETDT    WCETDT           MPR Reporting D
     C                     Z-ADDWBC0A1    WCC0A1           MPR Purchase Ty
      *
     C           KLCHNC    KLIST
     C                     KFLD           WCHONB           CC Company Numb
     C                     KFLD           WCETDT           MPR Reporting D
     C                     KFLD           WCC0A1           MPR Purchase Ty
     C           KLCHNC    CHAIN@E4CPF6              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKE4CPL0'MDACP
     C                     MOVEL'@E4CPF6' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL012.
     C                     MOVEL'LBL012'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKE41    YKRDCS
      * Move non-key fields to @E4CPF6
     C                     Z-ADDYL0079    WCC1A1           MPR Estimated H
     C                     MOVEL*BLANK    WCAAVN    P      RS User Changed
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     MOVELWUAJST    WCAJST    P      RS Record Statu
     C                     MOVEL*BLANK    WCAHVN    P      RS Job
     C                     MOVEL*BLANK    WCAGVN    P      RS Program
     C                     MOVEL*BLANK    WCABVN    P      RS User Added
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKE41    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKE41    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YKRDC     IFEQ 'Y'
     C                     UPDAT@E4CPF6                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKE4CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NCEXIT    ENDSR
      /EJECT
     CSR         NDRVGN    BEGSR
      *================================================================
      * Rtv Upd Estmtd Purch  RT - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSND     KLIST
     C                     KFLD           WBHONB           CC Company Numb
     C                     KFLD           WBETDT           MPR Reporting D
     C                     KFLD           WBC0A1           MPR Purchase Ty
      * Setup key
     C                     Z-ADDTCHMNB    WBHONB           CC Company Numb
     C                     Z-ADDP6ETDT    WBETDT           MPR Reporting D
     C                     Z-ADD6         WBC0A1           MPR Purchase Ty
      * Establish starting position
     C           KRSND     CHAIN@E4CPF7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0969' W0RTN   7
      * USER: Processing if Data record not found
      * Crt MPR Estmtd Purch  CR - MPR Estimated Purchases  * 
     C                     EXSR NECRRC
     C                     GOTO NDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WBC1A1    ADD  WN0172    YL0079           MPR Estimated H
      * Chg MPR Estmtd Purch  CH - MPR Estimated Purchases  * 
     C                     EXSR NFCHRC
     C                     ENDIF
      *================================================================
     CSR         NDEXIT    ENDSR
      /EJECT
     CSR         NECRRC    BEGSR
      *================================================================
      * Crt MPR Estmtd Purch  CR - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @E4CPF6
     C                     Z-ADDTCHMNB    WCHONB           CC Company Numb
     C                     Z-ADDP6ETDT    WCETDT           MPR Reporting D
     C                     Z-ADD6         WCC0A1           MPR Purchase Ty
     C                     Z-ADDWN0172    WCC1A1           MPR Estimated H
     C                     MOVEL*BLANK    WCAAVN           RS User Changed
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     MOVELWUAJST    WCAJST           RS Record Statu
     C                     MOVEL*BLANK    WCAHVN           RS Job
     C                     MOVEL*BLANK    WCAGVN           RS Program
     C                     MOVEL*BLANK    WCABVN           RS User Added
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WCAJST           RS Record Statu
     C                     MOVEL##USR     WCABVN           RS User Added
     C                     Z-ADD##JDT     WCABDT           RS Date Added
     C                     Z-ADD##JTM     WCABTM           RS Time Added
     C                     MOVEL##PGM     WCAGVN           RS Program
     C                     MOVEL##JOB     WCAHVN           RS Job
     C           KLCRNE    KLIST
     C                     KFLD           WCHONB           CC Company Numb
     C                     KFLD           WCETDT           MPR Reporting D
     C                     KFLD           WCC0A1           MPR Purchase Ty
      * Check for duplicate primary key
     C           KLCRNE    SETLL@E4CPF6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0970' W0RTN   7
      * Send message 'MPR Estimated Purchase EX'
     C                     MOVEL'PRK0970' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO NEEXIT
     C                     ENDIF
      *
     C                     WRITE@E4CPF6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NEEXIT    ENDSR
      /EJECT
     CSR         NFCHRC    BEGSR
      *================================================================
      * Chg MPR Estmtd Purch  CH - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YLRDC   1
      *
      * Move key fields to @E4CPF6
     C                     Z-ADDWBHONB    WCHONB           CC Company Numb
     C                     Z-ADDWBETDT    WCETDT           MPR Reporting D
     C                     Z-ADDWBC0A1    WCC0A1           MPR Purchase Ty
      *
     C           KLCHNF    KLIST
     C                     KFLD           WCHONB           CC Company Numb
     C                     KFLD           WCETDT           MPR Reporting D
     C                     KFLD           WCC0A1           MPR Purchase Ty
     C           KLCHNF    CHAIN@E4CPF6              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKE4CPL0'MDACP
     C                     MOVEL'@E4CPF6' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL013.
     C                     MOVEL'LBL013'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKE41    YLRDCS
      * Move non-key fields to @E4CPF6
     C                     Z-ADDYL0079    WCC1A1           MPR Estimated H
     C                     MOVEL*BLANK    WCAAVN    P      RS User Changed
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     MOVELWUAJST    WCAJST    P      RS Record Statu
     C                     MOVEL*BLANK    WCAHVN    P      RS Job
     C                     MOVEL*BLANK    WCAGVN    P      RS Program
     C                     MOVEL*BLANK    WCABVN    P      RS User Added
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKE41    IFNE YLRDCS
     C           YLRDC     ANDNE'N'
     C                     MOVE 'Y'       YLRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKE41    IFNE YLRDCS
     C           YLRDC     ANDNE'N'
     C                     MOVE 'Y'       YLRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YLRDC     IFEQ 'Y'
     C                     UPDAT@E4CPF6                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKE4CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NFEXIT    ENDSR
      /EJECT
     CSR         NGRVGN    BEGSR
      *================================================================
      * Rtv Upd Estmtd Purch  RT - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNG     KLIST
     C                     KFLD           WBHONB           CC Company Numb
     C                     KFLD           WBETDT           MPR Reporting D
     C                     KFLD           WBC0A1           MPR Purchase Ty
      * Setup key
     C                     Z-ADDTCHMNB    WBHONB           CC Company Numb
     C                     Z-ADDP6ETDT    WBETDT           MPR Reporting D
     C                     Z-ADD7         WBC0A1           MPR Purchase Ty
      * Establish starting position
     C           KRSNG     CHAIN@E4CPF7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0969' W0RTN   7
      * USER: Processing if Data record not found
      * Crt MPR Estmtd Purch  CR - MPR Estimated Purchases  * 
     C                     EXSR NHCRRC
     C                     GOTO NGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WBC1A1    ADD  WN0173    YL0079           MPR Estimated H
      * Chg MPR Estmtd Purch  CH - MPR Estimated Purchases  * 
     C                     EXSR NICHRC
     C                     ENDIF
      *================================================================
     CSR         NGEXIT    ENDSR
      /EJECT
     CSR         NHCRRC    BEGSR
      *================================================================
      * Crt MPR Estmtd Purch  CR - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @E4CPF6
     C                     Z-ADDTCHMNB    WCHONB           CC Company Numb
     C                     Z-ADDP6ETDT    WCETDT           MPR Reporting D
     C                     Z-ADD7         WCC0A1           MPR Purchase Ty
     C                     Z-ADDWN0173    WCC1A1           MPR Estimated H
     C                     MOVEL*BLANK    WCAAVN           RS User Changed
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     MOVELWUAJST    WCAJST           RS Record Statu
     C                     MOVEL*BLANK    WCAHVN           RS Job
     C                     MOVEL*BLANK    WCAGVN           RS Program
     C                     MOVEL*BLANK    WCABVN           RS User Added
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WCAJST           RS Record Statu
     C                     MOVEL##USR     WCABVN           RS User Added
     C                     Z-ADD##JDT     WCABDT           RS Date Added
     C                     Z-ADD##JTM     WCABTM           RS Time Added
     C                     MOVEL##PGM     WCAGVN           RS Program
     C                     MOVEL##JOB     WCAHVN           RS Job
     C           KLCRNH    KLIST
     C                     KFLD           WCHONB           CC Company Numb
     C                     KFLD           WCETDT           MPR Reporting D
     C                     KFLD           WCC0A1           MPR Purchase Ty
      * Check for duplicate primary key
     C           KLCRNH    SETLL@E4CPF6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0970' W0RTN   7
      * Send message 'MPR Estimated Purchase EX'
     C                     MOVEL'PRK0970' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO NHEXIT
     C                     ENDIF
      *
     C                     WRITE@E4CPF6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NHEXIT    ENDSR
      /EJECT
     CSR         NICHRC    BEGSR
      *================================================================
      * Chg MPR Estmtd Purch  CH - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YMRDC   1
      *
      * Move key fields to @E4CPF6
     C                     Z-ADDWBHONB    WCHONB           CC Company Numb
     C                     Z-ADDWBETDT    WCETDT           MPR Reporting D
     C                     Z-ADDWBC0A1    WCC0A1           MPR Purchase Ty
      *
     C           KLCHNI    KLIST
     C                     KFLD           WCHONB           CC Company Numb
     C                     KFLD           WCETDT           MPR Reporting D
     C                     KFLD           WCC0A1           MPR Purchase Ty
     C           KLCHNI    CHAIN@E4CPF6              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKE4CPL0'MDACP
     C                     MOVEL'@E4CPF6' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL014.
     C                     MOVEL'LBL014'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKE41    YMRDCS
      * Move non-key fields to @E4CPF6
     C                     Z-ADDYL0079    WCC1A1           MPR Estimated H
     C                     MOVEL*BLANK    WCAAVN    P      RS User Changed
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     MOVELWUAJST    WCAJST    P      RS Record Statu
     C                     MOVEL*BLANK    WCAHVN    P      RS Job
     C                     MOVEL*BLANK    WCAGVN    P      RS Program
     C                     MOVEL*BLANK    WCABVN    P      RS User Added
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKE41    IFNE YMRDCS
     C           YMRDC     ANDNE'N'
     C                     MOVE 'Y'       YMRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKE41    IFNE YMRDCS
     C           YMRDC     ANDNE'N'
     C                     MOVE 'Y'       YMRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YMRDC     IFEQ 'Y'
     C                     UPDAT@E4CPF6                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKE4CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NIEXIT    ENDSR
      /EJECT
     CSR         NJRVGN    BEGSR
      *================================================================
      * Rtv Upd Estmtd Purch  RT - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNJ     KLIST
     C                     KFLD           WBHONB           CC Company Numb
     C                     KFLD           WBETDT           MPR Reporting D
     C                     KFLD           WBC0A1           MPR Purchase Ty
      * Setup key
     C                     Z-ADDTCHMNB    WBHONB           CC Company Numb
     C                     Z-ADDP6ETDT    WBETDT           MPR Reporting D
     C                     Z-ADD8         WBC0A1           MPR Purchase Ty
      * Establish starting position
     C           KRSNJ     CHAIN@E4CPF7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0969' W0RTN   7
      * USER: Processing if Data record not found
      * Crt MPR Estmtd Purch  CR - MPR Estimated Purchases  * 
     C                     EXSR NKCRRC
     C                     GOTO NJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WBC1A1    ADD  WN0174    YL0079           MPR Estimated H
      * Chg MPR Estmtd Purch  CH - MPR Estimated Purchases  * 
     C                     EXSR NLCHRC
     C                     ENDIF
      *================================================================
     CSR         NJEXIT    ENDSR
      /EJECT
     CSR         NKCRRC    BEGSR
      *================================================================
      * Crt MPR Estmtd Purch  CR - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @E4CPF6
     C                     Z-ADDTCHMNB    WCHONB           CC Company Numb
     C                     Z-ADDP6ETDT    WCETDT           MPR Reporting D
     C                     Z-ADD8         WCC0A1           MPR Purchase Ty
     C                     Z-ADDWN0174    WCC1A1           MPR Estimated H
     C                     MOVEL*BLANK    WCAAVN           RS User Changed
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     MOVELWUAJST    WCAJST           RS Record Statu
     C                     MOVEL*BLANK    WCAHVN           RS Job
     C                     MOVEL*BLANK    WCAGVN           RS Program
     C                     MOVEL*BLANK    WCABVN           RS User Added
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WCAJST           RS Record Statu
     C                     MOVEL##USR     WCABVN           RS User Added
     C                     Z-ADD##JDT     WCABDT           RS Date Added
     C                     Z-ADD##JTM     WCABTM           RS Time Added
     C                     MOVEL##PGM     WCAGVN           RS Program
     C                     MOVEL##JOB     WCAHVN           RS Job
     C           KLCRNK    KLIST
     C                     KFLD           WCHONB           CC Company Numb
     C                     KFLD           WCETDT           MPR Reporting D
     C                     KFLD           WCC0A1           MPR Purchase Ty
      * Check for duplicate primary key
     C           KLCRNK    SETLL@E4CPF6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0970' W0RTN   7
      * Send message 'MPR Estimated Purchase EX'
     C                     MOVEL'PRK0970' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO NKEXIT
     C                     ENDIF
      *
     C                     WRITE@E4CPF6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NKEXIT    ENDSR
      /EJECT
     CSR         NLCHRC    BEGSR
      *================================================================
      * Chg MPR Estmtd Purch  CH - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YNRDC   1
      *
      * Move key fields to @E4CPF6
     C                     Z-ADDWBHONB    WCHONB           CC Company Numb
     C                     Z-ADDWBETDT    WCETDT           MPR Reporting D
     C                     Z-ADDWBC0A1    WCC0A1           MPR Purchase Ty
      *
     C           KLCHNL    KLIST
     C                     KFLD           WCHONB           CC Company Numb
     C                     KFLD           WCETDT           MPR Reporting D
     C                     KFLD           WCC0A1           MPR Purchase Ty
     C           KLCHNL    CHAIN@E4CPF6              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKE4CPL0'MDACP
     C                     MOVEL'@E4CPF6' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL015.
     C                     MOVEL'LBL015'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKE41    YNRDCS
      * Move non-key fields to @E4CPF6
     C                     Z-ADDYL0079    WCC1A1           MPR Estimated H
     C                     MOVEL*BLANK    WCAAVN    P      RS User Changed
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     MOVELWUAJST    WCAJST    P      RS Record Statu
     C                     MOVEL*BLANK    WCAHVN    P      RS Job
     C                     MOVEL*BLANK    WCAGVN    P      RS Program
     C                     MOVEL*BLANK    WCABVN    P      RS User Added
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKE41    IFNE YNRDCS
     C           YNRDC     ANDNE'N'
     C                     MOVE 'Y'       YNRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKE41    IFNE YNRDCS
     C           YNRDC     ANDNE'N'
     C                     MOVE 'Y'       YNRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YNRDC     IFEQ 'Y'
     C                     UPDAT@E4CPF6                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKE4CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NLEXIT    ENDSR
      /EJECT
     CSR         NMRVGN    BEGSR
      *================================================================
      * Rtv Upd Estmtd Purch  RT - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNM     KLIST
     C                     KFLD           WBHONB           CC Company Numb
     C                     KFLD           WBETDT           MPR Reporting D
     C                     KFLD           WBC0A1           MPR Purchase Ty
      * Setup key
     C                     Z-ADDTCHMNB    WBHONB           CC Company Numb
     C                     Z-ADDP6ETDT    WBETDT           MPR Reporting D
     C                     Z-ADD10        WBC0A1           MPR Purchase Ty
      * Establish starting position
     C           KRSNM     CHAIN@E4CPF7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0969' W0RTN   7
      * USER: Processing if Data record not found
      * Crt MPR Estmtd Purch  CR - MPR Estimated Purchases  * 
     C                     EXSR NNCRRC
     C                     GOTO NMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WBC1A1    ADD  WN0175    YL0079           MPR Estimated H
      * Chg MPR Estmtd Purch  CH - MPR Estimated Purchases  * 
     C                     EXSR NOCHRC
     C                     ENDIF
      *================================================================
     CSR         NMEXIT    ENDSR
      /EJECT
     CSR         NNCRRC    BEGSR
      *================================================================
      * Crt MPR Estmtd Purch  CR - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @E4CPF6
     C                     Z-ADDTCHMNB    WCHONB           CC Company Numb
     C                     Z-ADDP6ETDT    WCETDT           MPR Reporting D
     C                     Z-ADD10        WCC0A1           MPR Purchase Ty
     C                     Z-ADDWN0175    WCC1A1           MPR Estimated H
     C                     MOVEL*BLANK    WCAAVN           RS User Changed
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     MOVELWUAJST    WCAJST           RS Record Statu
     C                     MOVEL*BLANK    WCAHVN           RS Job
     C                     MOVEL*BLANK    WCAGVN           RS Program
     C                     MOVEL*BLANK    WCABVN           RS User Added
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WCAJST           RS Record Statu
     C                     MOVEL##USR     WCABVN           RS User Added
     C                     Z-ADD##JDT     WCABDT           RS Date Added
     C                     Z-ADD##JTM     WCABTM           RS Time Added
     C                     MOVEL##PGM     WCAGVN           RS Program
     C                     MOVEL##JOB     WCAHVN           RS Job
     C           KLCRNN    KLIST
     C                     KFLD           WCHONB           CC Company Numb
     C                     KFLD           WCETDT           MPR Reporting D
     C                     KFLD           WCC0A1           MPR Purchase Ty
      * Check for duplicate primary key
     C           KLCRNN    SETLL@E4CPF6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0970' W0RTN   7
      * Send message 'MPR Estimated Purchase EX'
     C                     MOVEL'PRK0970' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO NNEXIT
     C                     ENDIF
      *
     C                     WRITE@E4CPF6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NNEXIT    ENDSR
      /EJECT
     CSR         NOCHRC    BEGSR
      *================================================================
      * Chg MPR Estmtd Purch  CH - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YORDC   1
      *
      * Move key fields to @E4CPF6
     C                     Z-ADDWBHONB    WCHONB           CC Company Numb
     C                     Z-ADDWBETDT    WCETDT           MPR Reporting D
     C                     Z-ADDWBC0A1    WCC0A1           MPR Purchase Ty
      *
     C           KLCHNO    KLIST
     C                     KFLD           WCHONB           CC Company Numb
     C                     KFLD           WCETDT           MPR Reporting D
     C                     KFLD           WCC0A1           MPR Purchase Ty
     C           KLCHNO    CHAIN@E4CPF6              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKE4CPL0'MDACP
     C                     MOVEL'@E4CPF6' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL016.
     C                     MOVEL'LBL016'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NOEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NOEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKE41    YORDCS
      * Move non-key fields to @E4CPF6
     C                     Z-ADDYL0079    WCC1A1           MPR Estimated H
     C                     MOVEL*BLANK    WCAAVN    P      RS User Changed
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     MOVELWUAJST    WCAJST    P      RS Record Statu
     C                     MOVEL*BLANK    WCAHVN    P      RS Job
     C                     MOVEL*BLANK    WCAGVN    P      RS Program
     C                     MOVEL*BLANK    WCABVN    P      RS User Added
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKE41    IFNE YORDCS
     C           YORDC     ANDNE'N'
     C                     MOVE 'Y'       YORDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKE41    IFNE YORDCS
     C           YORDC     ANDNE'N'
     C                     MOVE 'Y'       YORDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YORDC     IFEQ 'Y'
     C                     UPDAT@E4CPF6                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKE4CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NOEXIT    ENDSR
      /EJECT
     CSR         NPRVGN    BEGSR
      *================================================================
      * Rtv Upd Estmtd Purch  RT - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNP     KLIST
     C                     KFLD           WBHONB           CC Company Numb
     C                     KFLD           WBETDT           MPR Reporting D
     C                     KFLD           WBC0A1           MPR Purchase Ty
      * Setup key
     C                     Z-ADDTCHMNB    WBHONB           CC Company Numb
     C                     Z-ADDP6ETDT    WBETDT           MPR Reporting D
     C                     Z-ADD11        WBC0A1           MPR Purchase Ty
      * Establish starting position
     C           KRSNP     CHAIN@E4CPF7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0969' W0RTN   7
      * USER: Processing if Data record not found
      * Crt MPR Estmtd Purch  CR - MPR Estimated Purchases  * 
     C                     EXSR NQCRRC
     C                     GOTO NPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WBC1A1    ADD  WN0176    YL0079           MPR Estimated H
      * Chg MPR Estmtd Purch  CH - MPR Estimated Purchases  * 
     C                     EXSR NRCHRC
     C                     ENDIF
      *================================================================
     CSR         NPEXIT    ENDSR
      /EJECT
     CSR         NQCRRC    BEGSR
      *================================================================
      * Crt MPR Estmtd Purch  CR - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @E4CPF6
     C                     Z-ADDTCHMNB    WCHONB           CC Company Numb
     C                     Z-ADDP6ETDT    WCETDT           MPR Reporting D
     C                     Z-ADD11        WCC0A1           MPR Purchase Ty
     C                     Z-ADDWN0176    WCC1A1           MPR Estimated H
     C                     MOVEL*BLANK    WCAAVN           RS User Changed
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     MOVELWUAJST    WCAJST           RS Record Statu
     C                     MOVEL*BLANK    WCAHVN           RS Job
     C                     MOVEL*BLANK    WCAGVN           RS Program
     C                     MOVEL*BLANK    WCABVN           RS User Added
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WCAJST           RS Record Statu
     C                     MOVEL##USR     WCABVN           RS User Added
     C                     Z-ADD##JDT     WCABDT           RS Date Added
     C                     Z-ADD##JTM     WCABTM           RS Time Added
     C                     MOVEL##PGM     WCAGVN           RS Program
     C                     MOVEL##JOB     WCAHVN           RS Job
     C           KLCRNQ    KLIST
     C                     KFLD           WCHONB           CC Company Numb
     C                     KFLD           WCETDT           MPR Reporting D
     C                     KFLD           WCC0A1           MPR Purchase Ty
      * Check for duplicate primary key
     C           KLCRNQ    SETLL@E4CPF6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0970' W0RTN   7
      * Send message 'MPR Estimated Purchase EX'
     C                     MOVEL'PRK0970' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO NQEXIT
     C                     ENDIF
      *
     C                     WRITE@E4CPF6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NQEXIT    ENDSR
      /EJECT
     CSR         NRCHRC    BEGSR
      *================================================================
      * Chg MPR Estmtd Purch  CH - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YPRDC   1
      *
      * Move key fields to @E4CPF6
     C                     Z-ADDWBHONB    WCHONB           CC Company Numb
     C                     Z-ADDWBETDT    WCETDT           MPR Reporting D
     C                     Z-ADDWBC0A1    WCC0A1           MPR Purchase Ty
      *
     C           KLCHNR    KLIST
     C                     KFLD           WCHONB           CC Company Numb
     C                     KFLD           WCETDT           MPR Reporting D
     C                     KFLD           WCC0A1           MPR Purchase Ty
     C           KLCHNR    CHAIN@E4CPF6              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKE4CPL0'MDACP
     C                     MOVEL'@E4CPF6' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL017.
     C                     MOVEL'LBL017'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NREXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKE41    YPRDCS
      * Move non-key fields to @E4CPF6
     C                     Z-ADDYL0079    WCC1A1           MPR Estimated H
     C                     MOVEL*BLANK    WCAAVN    P      RS User Changed
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     MOVELWUAJST    WCAJST    P      RS Record Statu
     C                     MOVEL*BLANK    WCAHVN    P      RS Job
     C                     MOVEL*BLANK    WCAGVN    P      RS Program
     C                     MOVEL*BLANK    WCABVN    P      RS User Added
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKE41    IFNE YPRDCS
     C           YPRDC     ANDNE'N'
     C                     MOVE 'Y'       YPRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKE41    IFNE YPRDCS
     C           YPRDC     ANDNE'N'
     C                     MOVE 'Y'       YPRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YPRDC     IFEQ 'Y'
     C                     UPDAT@E4CPF6                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKE4CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NREXIT    ENDSR
      /EJECT
     CSR         NSRVGN    BEGSR
      *================================================================
      * MPR Bld Prior Day Sch RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     YL0081           Planned Kill US
      * Declare restrictor key work fields
     C           *LIKE     DEFN TFHMNB    WQNS01           BOH Company Num
     C           *LIKE     DEFN TFAUDT    WQNS02           BOL Pln Delv Da
      * Define keylist
     C           KRSNS     KLIST
     C                     KFLD           WQNS01           BOH Company Num
     C                     KFLD           WQNS02           BOL Pln Delv Da
      * Setup key
     C                     Z-ADDP1GGNB    WQNS01           BOH Company Num
     C                     Z-ADDP4CGDT    WQNS02           BOL Pln Delv Da
      * Establish starting position
     C           KRSNS     SETLL@AXCPNQ                    *
     C           KRSNS     READE@AXCPNQ                  90*
      * Data record not found
     C   90                MOVEL'PRK0051' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  TFBPNB    YL0081           Planned Kill US
      * Rtv Crt/Chg Prior Dtl RT - MPR Prior Day Sched Dtl  * 
     C                     EXSR NTRVGN
     C           KRSNS     READE@AXCPNQ                  90*
     C                     ENDDO
      *================================================================
     CSR         NSEXIT    ENDSR
      /EJECT
     CSR         NTRVGN    BEGSR
      *================================================================
      * Rtv Crt/Chg Prior Dtl RT - MPR Prior Day Sched Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNT     KLIST
     C                     KFLD           TDH8CD           MPR Identificat
     C                     KFLD           TDETDT           MPR Reporting D
     C                     KFLD           TDC2A1           MPR Reporting T
     C                     KFLD           TDCQDT           BOL Kill Date
     C                     KFLD           TDBNNB           BOH Buy Order N
     C                     KFLD           TDBONB           BOL Load Number
     C                     KFLD           TDABCD           PD Producer Cod
     C                     KFLD           TDAECD           PL Location Cod
      * Setup key
     C                     MOVELP5H8CD    TDH8CD           MPR Identificat
     C                     Z-ADDP6ETDT    TDETDT           MPR Reporting D
     C                     Z-ADDP6C2A1    TDC2A1           MPR Reporting T
     C                     Z-ADDTFAUDT    TDCQDT           BOL Kill Date
     C                     Z-ADDTFBNNB    TDBNNB           BOH Buy Order N
     C                     Z-ADDTFBONB    TDBONB           BOL Load Number
     C                     MOVELTFABCD    TDABCD           PD Producer Cod
     C                     MOVELTFAECD    TDAECD           PL Location Cod
      * Establish starting position
     C           KRSNT     CHAIN@FHCPHN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1008' W0RTN   7
      * USER: Processing if Data record not found
      * Crt MPR Prior Day Sch CR - MPR Prior Day Sched Dtl  * 
     C                     EXSR NUCRRC
     C                     GOTO NTEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Change MPR Prior Day Sche - MPR Prior Day Sched Dtl  * 
     C                     EXSR NVCHRC
     C                     ENDIF
      *================================================================
     CSR         NTEXIT    ENDSR
      /EJECT
     CSR         NUCRRC    BEGSR
      *================================================================
      * Crt MPR Prior Day Sch CR - MPR Prior Day Sched Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FHCPHM
     C                     MOVELP5H8CD    TEH8CD           MPR Identificat
     C                     Z-ADDP6ETDT    TEETDT           MPR Reporting D
     C                     Z-ADDP6C2A1    TEC2A1           MPR Reporting T
     C                     Z-ADDTFAUDT    TECQDT           BOL Kill Date
     C                     Z-ADDTFBNNB    TEBNNB           BOH Buy Order N
     C                     Z-ADDTFBONB    TEBONB           BOL Load Number
     C                     MOVELTFABCD    TEABCD           PD Producer Cod
     C                     MOVELTFAECD    TEAECD           PL Location Cod
     C                     Z-ADDTFBPNB    TEBPNB           BOL Pln Head De
     C                     MOVEL*BLANK    TEAAVN           RS User Changed
     C                     Z-ADD*ZERO     TEAADT           RS Date Changed
     C                     Z-ADD*ZERO     TEAMTM           RS Time Changed
     C                     MOVEL'A'       TEAJST           RS Record Statu
     C                     MOVEL*BLANK    TEAHVN           RS Job
     C                     MOVEL*BLANK    TEAGVN           RS Program
     C                     MOVEL*BLANK    TEABVN           RS User Added
     C                     Z-ADD*ZERO     TEABDT           RS Date Added
     C                     Z-ADD*ZERO     TEABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       TEAJST           RS Record Statu
     C                     MOVEL##USR     TEABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           TEABDT    PARM *ZERO     WQ0082  70       *DATE
     C           TEABTM    PARM *ZERO     WQ0083  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     TEAGVN           RS Program
     C                     MOVEL##JOB     TEAHVN           RS Job
     C           KLCRNU    KLIST
     C                     KFLD           TEH8CD           MPR Identificat
     C                     KFLD           TEETDT           MPR Reporting D
     C                     KFLD           TEC2A1           MPR Reporting T
     C                     KFLD           TECQDT           BOL Kill Date
     C                     KFLD           TEBNNB           BOH Buy Order N
     C                     KFLD           TEBONB           BOL Load Number
     C                     KFLD           TEABCD           PD Producer Cod
     C                     KFLD           TEAECD           PL Location Cod
      * Check for duplicate primary key
     C           KLCRNU    SETLL@FHCPHM                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1009' W0RTN   7
      * Send message 'MPR Prior Day Sched Dt EX'
     C                     MOVEL'PRK1009' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO NUEXIT
     C                     ENDIF
      *
     C                     WRITE@FHCPHM                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NUEXIT    ENDSR
      /EJECT
     CSR         NVCHRC    BEGSR
      *================================================================
      * Change MPR Prior Day Sche - MPR Prior Day Sched Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YQRDC   1
      *
      * Move key fields to @FHCPHM
     C                     MOVELTDH8CD    TEH8CD    P      MPR Identificat
     C                     Z-ADDTDETDT    TEETDT           MPR Reporting D
     C                     Z-ADDTDC2A1    TEC2A1           MPR Reporting T
     C                     Z-ADDTDCQDT    TECQDT           BOL Kill Date
     C                     Z-ADDTDBNNB    TEBNNB           BOH Buy Order N
     C                     Z-ADDTDBONB    TEBONB           BOL Load Number
     C                     MOVELTDABCD    TEABCD    P      PD Producer Cod
     C                     MOVELTDAECD    TEAECD    P      PL Location Cod
      *
     C           KLCHNV    KLIST
     C                     KFLD           TEH8CD           MPR Identificat
     C                     KFLD           TEETDT           MPR Reporting D
     C                     KFLD           TEC2A1           MPR Reporting T
     C                     KFLD           TECQDT           BOL Kill Date
     C                     KFLD           TEBNNB           BOH Buy Order N
     C                     KFLD           TEBONB           BOL Load Number
     C                     KFLD           TEABCD           PD Producer Cod
     C                     KFLD           TEAECD           PL Location Cod
     C           KLCHNV    CHAIN@FHCPHM              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFHCPL0'MDACP
     C                     MOVEL'@FHCPHM' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL018.
     C                     MOVEL'LBL018'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NVEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NVEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFH1    YQRDCS
      * Move non-key fields to @FHCPHM
     C                     Z-ADDTFBPNB    TEBPNB           BOL Pln Head De
     C                     MOVEL*BLANK    TEAAVN    P      RS User Changed
     C                     Z-ADD*ZERO     TEAADT           RS Date Changed
     C                     Z-ADD*ZERO     TEAMTM           RS Time Changed
     C                     MOVEL'A'       TEAJST    P      RS Record Statu
     C                     MOVEL*BLANK    TEAHVN    P      RS Job
     C                     MOVEL*BLANK    TEAGVN    P      RS Program
     C                     MOVEL*BLANK    TEABVN    P      RS User Added
     C                     Z-ADD*ZERO     TEABDT           RS Date Added
     C                     Z-ADD*ZERO     TEABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFH1    IFNE YQRDCS
     C           YQRDC     ANDNE'N'
     C                     MOVE 'Y'       YQRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp-SysDtIF
     C                     MOVEL##USR     TEAAVN           RS User Changed
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           TEAADT    PARM *ZERO     WQ0084  70       *DATE
     C           TEAMTM    PARM *ZERO     WQ0085  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##JOB     TEAHVN           RS Job
     C                     MOVEL##PGM     TEAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKFH1    IFNE YQRDCS
     C           YQRDC     ANDNE'N'
     C                     MOVE 'Y'       YQRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YQRDC     IFEQ 'Y'
     C                     UPDAT@FHCPHM                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFHCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NVEXIT    ENDSR
      /EJECT
     CSR         NWRVGN    BEGSR
      *================================================================
      * Upd Prior Day Sched   RT - MPR Prior Day Scheduled  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNW     KLIST
     C                     KFLD           TGH8CD           MPR Identificat
     C                     KFLD           TGETDT           MPR Reporting D
     C                     KFLD           TGC2A1           MPR Reporting T
      * Setup key
     C                     MOVELP5H8CD    TGH8CD           MPR Identificat
     C                     Z-ADDP6ETDT    TGETDT           MPR Reporting D
     C                     Z-ADDP6C2A1    TGC2A1           MPR Reporting T
      * Establish starting position
     C           KRSNW     CHAIN@E5CPGP              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0971' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Prior Day Sched   CR - MPR Prior Day Scheduled  * 
     C                     EXSR NXCRRC
     C                     GOTO NWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Prior Day Sched   CH - MPR Prior Day Scheduled  * 
     C                     EXSR NYCHRC
     C                     ENDIF
      *================================================================
     CSR         NWEXIT    ENDSR
      /EJECT
     CSR         NXCRRC    BEGSR
      *================================================================
      * Crt Prior Day Sched   CR - MPR Prior Day Scheduled  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @E5CPGO
     C                     MOVELP5H8CD    THH8CD           MPR Identificat
     C                     Z-ADDP6ETDT    THETDT           MPR Reporting D
     C                     Z-ADDP6C2A1    THC2A1           MPR Reporting T
     C                     Z-ADDP6C4A1    THC4A1           MPR Sch Head Da
     C                     Z-ADDP6C5A1    THC5A1           MPR Sch Head Da
     C                     Z-ADDP6C6A1    THC6A1           MPR Sch Head Da
     C                     Z-ADDP6C7A1    THC7A1           MPR Sch Head Da
     C                     Z-ADDP6C8A1    THC8A1           MPR Sch Head Da
     C                     Z-ADDP6C9A1    THC9A1           MPR Sch Head Da
     C                     Z-ADDP6DAA1    THDAA1           MPR Sch Head Da
     C                     Z-ADDP6DBA1    THDBA1           MPR Sch Head Da
     C                     Z-ADDP6DCA1    THDCA1           MPR Sch Head Da
     C                     Z-ADDP6DDA1    THDDA1           MPR Sch Head Da
     C                     Z-ADDP6DEA1    THDEA1           MPR Sch Head Da
     C                     Z-ADDP6DFA1    THDFA1           MPR Sch Head Da
     C                     Z-ADDP6DGA1    THDGA1           MPR Sch Head Da
     C                     Z-ADDP6DHA1    THDHA1           MPR Sch Head Da
     C                     MOVEL*BLANK    THAAVN           RS User Changed
     C                     Z-ADD*ZERO     THAADT           RS Date Changed
     C                     Z-ADD*ZERO     THAMTM           RS Time Changed
     C                     MOVEL'A'       THAJST           RS Record Statu
     C                     MOVEL*BLANK    THAHVN           RS Job
     C                     MOVEL*BLANK    THAGVN           RS Program
     C                     MOVEL*BLANK    THABVN           RS User Added
     C                     Z-ADD*ZERO     THABDT           RS Date Added
     C                     Z-ADD*ZERO     THABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       THAJST           RS Record Statu
     C                     MOVEL##USR     THABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           THABDT    PARM *ZERO     WQ0086  70       *DATE
     C           THABTM    PARM *ZERO     WQ0087  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     THAGVN           RS Program
     C                     MOVEL##JOB     THAHVN           RS Job
     C           KLCRNX    KLIST
     C                     KFLD           THH8CD           MPR Identificat
     C                     KFLD           THETDT           MPR Reporting D
     C                     KFLD           THC2A1           MPR Reporting T
      * Check for duplicate primary key
     C           KLCRNX    SETLL@E5CPGO                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0972' W0RTN   7
      * Send message 'MPR Prior Day Schedule EX'
     C                     MOVEL'PRK0972' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO NXEXIT
     C                     ENDIF
      *
     C                     WRITE@E5CPGO                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NXEXIT    ENDSR
      /EJECT
     CSR         NYCHRC    BEGSR
      *================================================================
      * Chg Prior Day Sched   CH - MPR Prior Day Scheduled  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0228 10        RS User Changed
     C                     Z-ADD*ZERO     WN0229  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0230  60       RS Time Changed
     C                     MOVEL*BLANK    WN0231  1        RS Record Statu
     C                     MOVEL*BLANK    WN0232 10        RS Job
     C                     MOVEL*BLANK    WN0233 10        RS Program
     C                     MOVEL*BLANK    WN0234 10        RS User Added
     C                     Z-ADD*ZERO     WN0235  70       RS Date Added
     C                     Z-ADD*ZERO     WN0236  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YRRDC   1
      *
      * Move key fields to @E5CPGO
     C                     MOVELTGH8CD    THH8CD    P      MPR Identificat
     C                     Z-ADDTGETDT    THETDT           MPR Reporting D
     C                     Z-ADDTGC2A1    THC2A1           MPR Reporting T
      *
     C           KLCHNY    KLIST
     C                     KFLD           THH8CD           MPR Identificat
     C                     KFLD           THETDT           MPR Reporting D
     C                     KFLD           THC2A1           MPR Reporting T
     C           KLCHNY    CHAIN@E5CPGO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKE5CPL0'MDACP
     C                     MOVEL'@E5CPGO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL019.
     C                     MOVEL'LBL019'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NYEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NYEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKE51    YRRDCS
      * Move non-key fields to @E5CPGO
     C                     Z-ADDP6C4A1    THC4A1           MPR Sch Head Da
     C                     Z-ADDP6C5A1    THC5A1           MPR Sch Head Da
     C                     Z-ADDP6C6A1    THC6A1           MPR Sch Head Da
     C                     Z-ADDP6C7A1    THC7A1           MPR Sch Head Da
     C                     Z-ADDP6C8A1    THC8A1           MPR Sch Head Da
     C                     Z-ADDP6C9A1    THC9A1           MPR Sch Head Da
     C                     Z-ADDP6DAA1    THDAA1           MPR Sch Head Da
     C                     Z-ADDP6DBA1    THDBA1           MPR Sch Head Da
     C                     Z-ADDP6DCA1    THDCA1           MPR Sch Head Da
     C                     Z-ADDP6DDA1    THDDA1           MPR Sch Head Da
     C                     Z-ADDP6DEA1    THDEA1           MPR Sch Head Da
     C                     Z-ADDP6DFA1    THDFA1           MPR Sch Head Da
     C                     Z-ADDP6DGA1    THDGA1           MPR Sch Head Da
     C                     Z-ADDP6DHA1    THDHA1           MPR Sch Head Da
      *
      * Set PGM.*Record Data Changed flag
     C           QPKE51    IFNE YRRDCS
     C           YRRDC     ANDNE'N'
     C                     MOVE 'Y'       YRRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp-SysDtIF
     C                     MOVEL##USR     THAAVN           RS User Changed
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           THAADT    PARM *ZERO     WQ0088  70       *DATE
     C           THAMTM    PARM *ZERO     WQ0089  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##JOB     THAHVN           RS Job
     C                     MOVEL##PGM     THAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKE51    IFNE YRRDCS
     C           YRRDC     ANDNE'N'
     C                     MOVE 'Y'       YRRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YRRDC     IFEQ 'Y'
     C                     UPDAT@E5CPGO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKE5CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NYEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Payment Prc        RT - Payment Processing Parms  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAHONB           CC Company Numb
      * Setup key
     C                     Z-ADDP1GGNB    WAHONB           CC Company Numb
      * Establish starting position
     C           KRSSA     CHAIN@C4REO7              90    *
      * Data record not found
     C   90                MOVEL'PRK0434' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWACKDT    P3CKDT           Pmt Current Pay
     C                     Z-ADDWAM1NB    YL0002           Pmt Current Pay
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Del Estmtd Purch  RT - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHONB    WQSB01           CC Company Numb
     C           *LIKE     DEFN WBETDT    WQSB02           MPR Reporting D
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           CC Company Numb
     C                     KFLD           WQSB02           MPR Reporting D
      * Setup key
     C                     Z-ADDP1GGNB    WQSB01           CC Company Numb
     C                     Z-ADDP6ETDT    WQSB02           MPR Reporting D
      * Establish starting position
     C           KRSSB     SETLL@E4CPF7                    *
     C           KRSSB     READE@E4CPF7                  90*
      * Data record not found
     C   90                MOVEL'PRK0969' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del MPR Estmtd Purch  DL - MPR Estimated Purchases  * 
     C                     EXSR SCDLRC
     C           KRSSB     READE@E4CPF7                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCDLRC    BEGSR
      *================================================================
      * Del MPR Estmtd Purch  DL - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @E4CPF6
     C                     Z-ADDWBHONB    WCHONB           CC Company Numb
     C                     Z-ADDWBETDT    WCETDT           MPR Reporting D
     C                     Z-ADDWBC0A1    WCC0A1           MPR Purchase Ty
      *
     C           KLDLSC    KLIST
     C                     KFLD           WCHONB           CC Company Numb
     C                     KFLD           WCETDT           MPR Reporting D
     C                     KFLD           WCC0A1           MPR Purchase Ty
     C           KLDLSC    CHAIN@E4CPF6              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKE4CPL0'MDACP
     C                     MOVEL'@E4CPF6' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@E4CPF6                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * MPR Bld Prior Day Slg RT - Tattoo Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001 25        MPR Lot Identif
     C                     Z-ADD*ZERO     WN0002  10       MPR Slg Class C
     C                     Z-ADD*ZERO     WN0003  20       MPR Slg Purchas
     C                     Z-ADD*ZERO     WN0004  60       MPR Slg Head
     C                     Z-ADD*ZERO     WN0005  52       MPR Slg Base Pr
     C                     Z-ADD*ZERO     WN0006  52       MPR Slg Avg Net
     C                     Z-ADD*ZERO     WN0007  52       MPR Slg Low Net
     C                     Z-ADD*ZERO     WN0008  52       MPR Slg High Ne
     C                     Z-ADD*ZERO     WN0009  51       MPR Slg Avg Liv
     C                     Z-ADD*ZERO     WN0010  51       MPR Slg Avg Car
     C                     Z-ADD*ZERO     WN0011  52       MPR Slg Avg Sor
     C                     Z-ADD*ZERO     WN0012  42       MPR Slg Avg Bac
     C                     Z-ADD*ZERO     WN0013  42       MPR Slg Avg Loi
     C                     Z-ADD*ZERO     WN0014  41       MPR Slg Avg Lea
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    YL0004           PD Producer Cod
      * R11747 9.25.17 RMC Dont report Avg Live Weight for STF
      * 9/24/02 RMC Output 2 dec avg backfat and loin eye
      * 5/28/03 RMC Output for Sort Loss Calc
      * 2/25/04 RMC Only report price data for Non-Packer Producers (was
      * 2/26/04 RMC Lot = TattooLoad because SBD research hogs may have t
      * same Tattoo on multiple loads.  This makes the pke6cpp rcd unique
      * 11/04/16 RMC R7805 use BOH Purch type
      * 01/04/17 RMC R8309 rpt avg live wt on all
      * 9/17/2020 RMC sort loss cant be > 00 .. so make it .00 if >0
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDHMNB    WQSD01           BOH Company Num
     C           *LIKE     DEFN WDB0DT    WQSD02           TH Kill Date
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           BOH Company Num
     C                     KFLD           WQSD02           TH Kill Date
      * Setup key
     C                     Z-ADDP1GGNB    WQSD01           BOH Company Num
     C                     Z-ADDP4CGDT    WQSD02           TH Kill Date
      * Establish starting position
     C           KRSSD     SETLL@A1CPCV                    *
     C           KRSSD     READE@A1CPCV                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * OMT: Resales
      * CASE: DB1.TH Hog Class Type is Resale
     C           WDLLST    IFEQ 'R'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * OMT: Held Over Head > 0
      * CASE: DB1.TH Held Over is greater than 0
     C           WDH9NB    IFGT 0                          *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * OMT: Held Over Record = Y & Held Over Completed = 0
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.TH Held Over Record is Yes
      *   |- c2    : DB1.TH Held/Ovr Completed Dte is EQ Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WDE1ST    IFEQ 'Y'                        *IF
     C           WDBSDT    IFEQ 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * OMT: Balanced
      * CASE: DB1.TH Kill Balancing Sts is Not Balanced Carcass
     C           WDDWST    IFEQ 'E'                        *IF
     C           WDDWST    OREQ *BLANK
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Process Selected Tattoo
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Changed 02/26/04 because Research hogs for SBD have the same tatt
      * on multiple loads.  This makes the pke6cpp rcd unique
     C                     MOVEL*BLANK    WUDDCD           Tattoo Nbr Alph
     C                     MOVELWDCVNB    WUDDCD           Tattoo Nbr Alph
     C                     MOVEL*BLANK    WUP9TX           Buy Order Load
     C                     MOVELWDBONB    WUP9TX           Buy Order Load
     C                     Z-ADD*ZERO     ZQ      50
     C           WUDDCD    CAT  WUP9TX:ZQ WN0001    P      MPR Lot Identif
     C                     Z-ADD1         WN0002           MPR Slg Class C
      * Rtv CMP grading type  RT - Buy Order Header  * 
     C                     EXSR SERVGN
      * R7805 11/04/16 RMC R7805 Use new BOH Purch Type
      * Rtv BOH Prod PurchTyp RT - Buy Order Header  * 
     C                     EXSR SGRVGN
      * BOH or PRDCR PURCH TYPE
      * CASE: LCL.BOH MPR Purchase Type is *ALL values
     C           YL0007    IFEQ '01'                       *IF
     C           YL0007    OREQ '02'
     C           YL0007    OREQ '03'
     C           YL0007    OREQ '04'
     C           YL0007    OREQ '05'
     C           YL0007    OREQ '06'
     C           YL0007    OREQ '07'
     C           YL0007    OREQ '08'
     C           YL0007    OREQ '09'
     C           YL0007    OREQ '10'
     C           YL0007    OREQ '11'
     C                     MOVE YL0007    WN0003           MPR Slg Purchas
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV MPR Prdcr Purch TpRT - MPR Producer Purch Type  * 
     C                     EXSR SHRVGN
     C                     END                             *FI
     C                     Z-ADDWDFENB    WN0004           MPR Slg Head
     C                     Z-ADDWDD7PR    WN0005           MPR Slg Base Pr
     C                     Z-ADD*ZERO     WN0007           MPR Slg Low Net
     C                     Z-ADD*ZERO     WN0008           MPR Slg High Ne
     C                     Z-ADDWDF7NB    WN0009           MPR Slg Avg Liv
     C                     Z-ADDWDHDNB    WN0010           MPR Slg Avg Car
      * *** New sort loss calc            5/27/03
      * Sort loss per grading type
      * CASE: LCL.CMP Grading Type is Sort Discount Factor
     C           YL0006    IFEQ 'S'                        *IF
     C                     Z-ADDWDEFPR    WN0011           MPR Slg Avg Sor
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.TH Hot Wgt is Not Zero
     C           WDE0NB    IFGT 0                          *IF
      * Comp:MPR Sort Loss
      * PAR.MPR Slg Avg Sort Loss =
      *    *COMPUTE (x1/(x2/x3))
      * x1    : DB1.TH MPR Sort Loss
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WDE0NB    DIV  100       W0WB01    H      *Synon (15,5) w
     C           WDNCHF    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0011           MPR Slg Avg Sor
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0011           MPR Slg Avg Sor
     C                     END                             *FI
     C                     END                             *FI
      * 9/17/2020 cant be reported as  >0 so make it .00
      * CASE: PAR.MPR Slg Avg Sort Loss is Entered GT 0
     C           WN0011    IFGT 0                          *IF
     C                     Z-ADD*ZERO     WN0011           MPR Slg Avg Sor
     C                     END                             *FI
      * ***
      * CASE: DB1.TH Avg Backfat - 2 Dec is Entered
     C           WDMCNF    IFGT 0                          *IF
     C                     Z-ADDWDMCNF    WN0012           MPR Slg Avg Bac
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWDF2NB    WN0012           MPR Slg Avg Bac
     C                     END                             *FI
      * CASE: DB1.TH Avg Loin Eye - 2 dec is Entered
     C           WDMVNF    IFGT 0                          *IF
     C                     Z-ADDWDMVNF    WN0013           MPR Slg Avg Loi
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWDF3NB    WN0013           MPR Slg Avg Loi
     C                     END                             *FI
     C                     Z-ADDWDF4NB    WN0014           MPR Slg Avg Lea
     C                     Z-ADDWDCBPR    YL0008           TH Payment Gros
     C                     Z-ADDWDE0NB    YL0009           TH Hot Wgt
      * If Held Over Record = Y, sum info for all days
      * CASE: DB1.TH Held Over Record is Yes
     C           WDE1ST    IFEQ 'Y'                        *IF
      *
     C                     Z-ADD*ZERO     WN0015 152       Lean % * Wgt US
     C                     Z-ADD*ZERO     WN0016 152       Backfat * Wgt U
     C                     Z-ADD*ZERO     WN0017 152       Loin-Eye * Wgt
     C                     Z-ADD*ZERO     WN0018 152       Backfat * Wgt U
     C                     Z-ADD*ZERO     WN0019 152       Loin-Eye * Wgt
      *
      * Prt Crc Sum (Hld Ovr) IF
      * Modification History Created Str slm 061208
     C                     EXSR UCSUBR                     Modification Hi
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0010           TH Kill Date
     C                     Z-ADD*ZERO     YL0011           TH Dead On Arri
     C                     Z-ADD*ZERO     YL0012           TH Head Receive
     C                     Z-ADD*ZERO     YL0013           TH Yard Deads
     C                     Z-ADD*ZERO     YL0014           TH Head Condemn
     C                     Z-ADD*ZERO     WN0004           TH Head Killed
     C                     Z-ADD*ZERO     YL0015           TH Head Adds
     C                     Z-ADD*ZERO     YL0016           TH Live Wgt
     C                     Z-ADD*ZERO     YL0017           TH Adj Live Wgt
     C                     Z-ADD*ZERO     YL0009           TH Hot Wgt
     C                     Z-ADD*ZERO     WN0009           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0010           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0014           TH Avg Lean Per
     C                     Z-ADD*ZERO     YL0018           TH Avg Loin Eye
     C                     Z-ADD*ZERO     YL0019           TH Avg Backfat
     C                     Z-ADD*ZERO     YL0020           TH Actual Yield
     C                     Z-ADD*ZERO     YL0021           TH Adj Actual Y
     C                     Z-ADD*ZERO     YL0023           TH CM Base Mkt
     C                     Z-ADD*ZERO     YL0024           TH CM Sort Disc
     C                     Z-ADD*ZERO     YL0025           TH CM Yield Gai
     C                     Z-ADD*ZERO     YL0026           TH CM Base Carc
     C                     Z-ADD*ZERO     YL0027           TH CM LN AddOn/
     C                     Z-ADD*ZERO     YL0028           TH CM Carcass G
     C                     Z-ADD*ZERO     YL0029           TH Deduction Am
     C                     Z-ADD*ZERO     YL0030           TH Carcass Net
     C                     Z-ADD*ZERO     YL0031           TH Additions Am
     C                     Z-ADD*ZERO     YL0008           TH Payment Gros
     C                     Z-ADD*ZERO     YL0032           Th Payment Net
     C                     Z-ADD*ZERO     YL0033           TH Fixed Cost A
     C                     Z-ADD*ZERO     YL0034           TH Shipped Weig
     C                     Z-ADD*ZERO     YL0035           TH FFLI
     C                     Z-ADD*ZERO     YL0036           TH Head Exclude
     C                     Z-ADD*ZERO     YL0037           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0005           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     YL0038           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     YL0039           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     YL0040           TH CM Yld G/L L
     C                     Z-ADD*ZERO     YL0041           TH CM Yld G/L C
     C                     Z-ADD*ZERO     YL0042           TH CM Crc Val L
     C                     Z-ADD*ZERO     YL0043           TH CM Crc Val C
     C                     Z-ADD*ZERO     YL0044           TH CM Lean Prem
     C                     Z-ADD*ZERO     YL0045           TH CM Lean Prem
     C                     Z-ADD*ZERO     YL0046           TH CM Gross Liv
     C                     Z-ADD*ZERO     YL0047           TH CM Gross Car
     C                     Z-ADD*ZERO     YL0048           TH Head Adjuste
     C                     Z-ADD*ZERO     YL0049           TH PHA Head Add
     C                     Z-ADD*ZERO     YL0050           TH Excluded Gro
     C                     Z-ADD*ZERO     YL0051           TH Excluded Car
     C                     Z-ADD*ZERO     YL0052           TH Excluded Pre
     C                     Z-ADD*ZERO     YL0053           TH Meat Value F
     C                     Z-ADD*ZERO     YL0054           TH Avg Loin Eye
     C                     Z-ADD*ZERO     YL0055           TH Avg Backfat
     C                     Z-ADD*ZERO     YL0056           TH Head LFT
     C                     Z-ADD*ZERO     YL0057           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0015           Lean % * Wgt US
     C                     Z-ADD*ZERO     WN0016           Backfat * Wgt U
     C                     Z-ADD*ZERO     WN0017           Loin-Eye * Wgt
     C                     Z-ADD*ZERO     WN0018           Backfat * Wgt U
     C                     Z-ADD*ZERO     WN0019           Loin-Eye * Wgt
      * Prt Crc Sum (Hld Ovr) RT - Tattoo Header  * 
     C                     EXSR SIRVGN
      * Calculate Live /CWT and Carc /CWT
      * CASE: WRK.#Sequence Block is NULL
     C           WUJ0ST    IFEQ *BLANK                     *IF
      * Calculate Carc/CWT if Par.Th Hot Wt is n= 0
      * CASE: PAR.TH Hot Wgt NE WRK.Zero USR
     C           YL0009    IFNE WUE9NB                     *IF
      * TH CM Bse Mkt Carc /CWT
      * PAR.TH CM Bse Mkt Carc /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Base Mkt Price Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0009    DIV  100       W0WB01    H      *Synon (15,5) w
     C           YL0023    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0005           TH CM Bse Mkt C
      * TH CM Srt Dsc Carc /CWT
      * PAR.TH CM Srt Dsc Carc /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Sort Discount Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0009    DIV  100       W0WB01    H      *Synon (15,5) w
     C           YL0024    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0039           TH CM Srt Dsc C
      * TH CM Crc Val Carc /CWT
      * WRK.TH CM Crc Val Carc /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Base Carcass Value
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0009    DIV  100       W0WB01    H      *Synon (15,5) w
     C           YL0026    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUEDPR           TH CM Crc Val C
     C                     Z-ADDWUEDPR    YL0043           TH CM Crc Val C
      * TH CM Lean Prem Carc /CWT
      * PAR.TH CM Lean Prem Carc /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM LN AddOn/Deduct Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0009    DIV  100       W0WB01    H      *Synon (15,5) w
     C           YL0027    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0045           TH CM Lean Prem
      * TH CM Gross Carc /CWT
      * PAR.TH CM Gross Carc /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Carcass Gross Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0009    DIV  100       W0WB01    H      *Synon (15,5) w
     C           YL0028    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0047           TH CM Gross Car
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0005           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     YL0039           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     YL0041           TH CM Yld G/L C
     C                     Z-ADD*ZERO     YL0043           TH CM Crc Val C
     C                     Z-ADD*ZERO     YL0045           TH CM Lean Prem
     C                     Z-ADD*ZERO     YL0047           TH CM Gross Car
     C                     END                             *FI
      * Calculate Live/CWT if Par.Th live wt is n= 0
      * CASE: PAR.TH Live Wgt NE WRK.Zero USR
     C           YL0016    IFNE WUE9NB                     *IF
      * TH CM Bse Mkt Live /CWT
      * PAR.TH CM Bse Mkt Live /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Base Mkt Price Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0016    DIV  100       W0WB01    H      *Synon (15,5) w
     C           YL0023    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0037           TH CM Bse Mkt L
      * TH CM Srt Dsc Live /CWT
      * PAR.TH CM Srt Dsc Live /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Sort Discount Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0016    DIV  100       W0WB01    H      *Synon (15,5) w
     C           YL0024    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0038           TH CM Srt Dsc L
      * TH CM Yld G/L live /CWT
      * PAR.TH CM Yld G/L Live /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Yield Gain/Loss Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0016    DIV  100       W0WB01    H      *Synon (15,5) w
     C           YL0025    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0040           TH CM Yld G/L L
      * TH CM Crc Val Live /CWT
      * PAR.TH CM Crc Val Live /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Base Carcass Value
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0016    DIV  100       W0WB01    H      *Synon (15,5) w
     C           YL0026    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0042           TH CM Crc Val L
      * TH CM Lean Prem Live /CWT
      * PAR.TH CM Lean Prem Live /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM LN AddOn/Deduct Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0016    DIV  100       W0WB01    H      *Synon (15,5) w
     C           YL0027    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0044           TH CM Lean Prem
      * TH CM Gross Live /CWT
      * PAR.TH CM Gross Live /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Carcass Gross Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0016    DIV  100       W0WB01    H      *Synon (15,5) w
     C           YL0028    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0046           TH CM Gross Liv
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0037           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     YL0038           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     YL0040           TH CM Yld G/L L
     C                     Z-ADD*ZERO     YL0042           TH CM Crc Val L
     C                     Z-ADD*ZERO     YL0044           TH CM Lean Prem
     C                     Z-ADD*ZERO     YL0046           TH CM Gross Liv
     C                     END                             *FI
     C                     END                             *FI
      * Calc Avg Live Wt
      * CASE: PAR.TH Head Received is *Zeros
     C           YL0012    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WUF7NB           TH Avg Live Wgt
     C                     ELSE
      * CASE: *OTHERWISE
     C           YL0016    DIV  YL0012    WUF7NB           TH Avg Live Wgt
     C                     END                             *FI
      * Calc Adj Live Weight
      * CASE: PAR.TH Head Received EQ PAR.TH Head Killed
     C           YL0012    IFEQ WN0004                     *IF
     C                     Z-ADDYL0016    WULRNB           TH Adj Live Wgt
     C                     ELSE
      * CASE: *OTHERWISE
     C           WN0004    MULT WUF7NB    WULRNB           TH Adj Live Wgt
     C                     END                             *FI
     C                     Z-ADDWUF7NB    WN0009           TH Avg Live Wgt
     C                     Z-ADDWULRNB    YL0017           TH Adj Live Wgt
      * Calc Actual Yield %
      * CASE: PAR.TH Live Wgt NE WRK.Zero USR
     C           YL0016    IFNE WUE9NB                     *IF
      * TH Actual Yield %
      * PAR.TH Actual Yield % =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           YL0009    DIV  YL0016    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0020           TH Actual Yield
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0020           TH Actual Yield
     C                     END                             *FI
      * Calc Adj Actual Yield %
      * CASE: PAR.TH Adj Live Wgt NE WRK.Zero USR
     C           YL0017    IFNE WUE9NB                     *IF
      * TH Adj Actual Yield %
      * PAR.TH Adj Actual Yield % =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : PAR.TH Adj Live Wgt
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           YL0009    DIV  YL0017    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0021           TH Adj Actual Y
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0021           TH Adj Actual Y
     C                     END                             *FI
      * Calc Avg Hot Wt
      * CASE: PAR.TH Head Killed NE WRK.Zero USR
     C           WN0004    IFNE WUE9NB                     *IF
     C           YL0009    DIV  WN0004    WN0010    H      TH Avg Hot Wgt
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0010           TH Avg Hot Wgt
     C                     END                             *FI
      * Calc Avg Lean %, Loin eye, & Backfat
      * CASE: PAR.TH Hot Wgt NE WRK.Zero USR
     C           YL0009    IFNE WUE9NB                     *IF
     C           WN0015    DIV  YL0009    WN0014    H      TH Avg Lean Per
     C           WN0017    DIV  YL0009    YL0018    H      TH Avg Loin Eye
     C           WN0016    DIV  YL0009    YL0019    H      TH Avg Backfat
     C           WN0019    DIV  YL0009    YL0054    H      TH Avg Loin Eye
     C           WN0018    DIV  YL0009    YL0055    H      TH Avg Backfat
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0014           TH Avg Lean Per
     C                     Z-ADD*ZERO     YL0018           TH Avg Loin Eye
     C                     Z-ADD*ZERO     YL0019           TH Avg Backfat
     C                     Z-ADD*ZERO     YL0054           TH Avg Loin Eye
     C                     Z-ADD*ZERO     YL0055           TH Avg Backfat
     C                     END                             *FI
      * TH FFLI
      * PAR.TH FFLI =
      *    *COMPUTE (x1 + (x2 * x3) - (x4 * x5))
      * x1    : CON.51.537
      * +     : PGM.*Synon (17,7) work field
      * x2    : CON..035
      * *     : PGM.*Synon (17,7) work field *
      * x3    : PAR.TH Hot Wgt
      * -     : PGM.*Synon (17,7) work field
      * x4    : CON.12.26
      * *     : PGM.*Synon (17,7) work field *
      * x5    : PAR.TH Avg Backfat
     C           .035      MULT YL0009    W0WD02           *Synon (17,7) w
     C           51.537    ADD  W0WD02    W0WD01           *Synon (17,7) w
     C           12.26     MULT YL0019    W0WD03           *Synon (17,7) w
     C           W0WD01    SUB  W0WD03    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0035           TH FFLI
     C                     Z-ADDYL0039    WN0011           MPR Slg Avg Sor
      * 5/29/03  Sort loss per grading type
      * CASE: LCL.CMP Grading Type is Sort Discount Factor
     C           YL0006    IFEQ 'S'                        *IF
     C                     Z-ADDYL0045    WN0011           MPR Slg Avg Sor
     C                     END                             *FI
      * 9/17/2020 cant be reported as  >0 so make it .00
      * CASE: PAR.MPR Slg Avg Sort Loss is Entered GT 0
     C           WN0011    IFGT 0                          *IF
     C                     Z-ADD*ZERO     WN0011           MPR Slg Avg Sor
     C                     END                             *FI
      * CASE: LCL.TH Avg Backfat - 2 Dec is Entered
     C           YL0055    IFGT 0                          *IF
     C                     Z-ADDYL0055    WN0012           MPR Slg Avg Bac
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0019    WN0012           MPR Slg Avg Bac
     C                     END                             *FI
      * CASE: LCL.TH Avg Loin Eye - 2 dec is Entered
     C           YL0054    IFGT 0                          *IF
     C                     Z-ADDYL0054    WN0013           MPR Slg Avg Loi
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0018    WN0013           MPR Slg Avg Loi
     C                     END                             *FI
     C                     END                             *FI
      * * Include all Seaboard Expenses in the Avg Net Price *
      * Rtv MPR Seaboard Exp  RT - Tattoo Ded/Add  * 
     C                     EXSR SKRVGN
     C                     ADD  YL0058    YL0008           TH Payment Gros
      * MPR Slg Avg Net Price
      * CASE: LCL.TH Hot Wgt is Greater then Zero
     C           YL0009    IFGT 0                          *IF
      * RMC 4/09/01  dont round, per Jancie
      * RMC 11/26/01 Round, per Jancie on x1/...
      * RMC 11/27/01 took out x4 which was a (hot wt * 1) before the /100
      * MPR Slg Avg Net Price
      * PAR.MPR Slg Avg Net Price =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : LCL.TH Payment Gross
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : LCL.TH Hot Wgt
      * /     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           YL0009    DIV  100       W0WD01           *Synon (17,7) w
     C           YL0008    DIV  W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0006           MPR Slg Avg Net
     C                     END                             *FI
      * Dont report Avg Live Weight for STF   RMC    09/25/17
      * CASE: DB1.BOH Company Number is Sioux City
     C           WDHMNB    IFEQ 440                        *IF
     C                     Z-ADD*ZERO     WN0009           MPR Slg Avg Liv
     C                     END                             *FI
      * Only report price data for Non-Packer Producers
      * CASE: PAR.MPR Slg Purchase Type is Packer Owned
     C           WN0003    IFEQ 9                          *IF
     C                     Z-ADD*ZERO     WN0005           MPR Slg Base Pr
     C                     Z-ADD*ZERO     WN0006           MPR Slg Avg Net
     C                     Z-ADD*ZERO     WN0007           MPR Slg Low Net
     C                     Z-ADD*ZERO     WN0008           MPR Slg High Ne
     C                     Z-ADD*ZERO     WN0011           MPR Slg Avg Sor
     C                     END                             *FI
      * Upd Prior Day Slg     RT - MPR Prior Day Slaughtered  * 
     C                     EXSR SLRVGN
     C                     END                             *FI
     C           KRSSD     READE@A1CPCV                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv CMP grading type  RT - Buy Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
      * Setup key
     C                     Z-ADDWDHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWDBNNB    WEBNNB           BOH Buy Order N
      * Establish starting position
     C           KRSSE     CHAIN@AWCPBI              90    *
      * Data record not found
     C   90                MOVEL'PRK0049' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Rtv CMP Grading type  RT - Carcass Merit Program  * 
     C                     EXSR SFRVGN
     C                     Z-ADDWEKOFF    YL0005           BOH Hedge Refer
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv CMP Grading type  RT - Carcass Merit Program  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAMCD    WQSF01           CMP Program Cod
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           CMP Program Cod
      * Setup key
     C                     MOVELWEAMCD    WQSF01           CMP Program Cod
      * Establish starting position
     C           KRSSF     SETLL@ARREML                    *
     C           KRSSF     READE@ARREML                  90*
      * Data record not found
     C   90                MOVEL'PRK0039' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFDLST    YL0006           CMP Grading Typ
     C           KRSSF     READE@ARREML                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv BOH Prod PurchTyp RT - Buy Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
      * Setup key
     C                     Z-ADDWDHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWDBNNB    WEBNNB           BOH Buy Order N
      * Establish starting position
     C           KRSSG     CHAIN@AWCPBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0049' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0007           BOH MPR Purchas
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEU1ST    YL0007           BOH MPR Purchas
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV MPR Prdcr Purch TpRT - MPR Producer Purch Type  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGABCD    WQSH01           PD Producer Cod
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           PD Producer Cod
      * Setup key
     C                     MOVELWDABCD    WQSH01           PD Producer Cod
      * Establish starting position
     C           KRSSH     SETLL@E3CPF4                    *
     C           KRSSH     READE@E3CPF4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0967' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0003           MPR Purchase Ty
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWGC0A1    WN0003           MPR Purchase Ty
     C                     GOTO SHEXIT                     *QUIT
     C           KRSSH     READE@E3CPF4                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Prt Crc Sum (Hld Ovr) RT - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0020  72       TH CA Base Mkt
     C                     Z-ADD*ZERO     WN0021  72       TH CA Sort Disc
     C                     Z-ADD*ZERO     WN0022  72       TH CA Yield Gai
     C                     Z-ADD*ZERO     WN0023  72       TH CA Base Carc
     C                     Z-ADD*ZERO     WN0024  72       TH CA Lean Prem
     C                     Z-ADD*ZERO     WN0025  72       TH CA Carcass G
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WUHBST           First Time Flag
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0010           TH Kill Date
     C                     Z-ADD*ZERO     YL0011           TH Dead On Arri
     C                     Z-ADD*ZERO     YL0012           TH Head Receive
     C                     Z-ADD*ZERO     YL0013           TH Yard Deads
     C                     Z-ADD*ZERO     YL0014           TH Head Condemn
     C                     Z-ADD*ZERO     WN0004           TH Head Killed
     C                     Z-ADD*ZERO     YL0015           TH Head Adds
     C                     Z-ADD*ZERO     YL0016           TH Live Wgt
     C                     Z-ADD*ZERO     YL0017           TH Adj Live Wgt
     C                     Z-ADD*ZERO     YL0009           TH Hot Wgt
     C                     Z-ADD*ZERO     YL0023           TH CM Base Mkt
     C                     Z-ADD*ZERO     YL0024           TH CM Sort Disc
     C                     Z-ADD*ZERO     YL0025           TH CM Yield Gai
     C                     Z-ADD*ZERO     YL0026           TH CM Base Carc
     C                     Z-ADD*ZERO     YL0027           TH CM LN AddOn/
     C                     Z-ADD*ZERO     YL0028           TH CM Carcass G
     C                     Z-ADD*ZERO     YL0029           TH Deduction Am
     C                     Z-ADD*ZERO     YL0030           TH Carcass Net
     C                     Z-ADD*ZERO     YL0031           TH Additions Am
     C                     Z-ADD*ZERO     YL0008           TH Payment Gros
     C                     Z-ADD*ZERO     YL0032           Th Payment Net
     C                     Z-ADD*ZERO     YL0033           TH Fixed Cost A
     C                     Z-ADD*ZERO     YL0036           TH Head Exclude
     C                     Z-ADD*ZERO     YL0048           TH Head Adjuste
     C                     Z-ADD*ZERO     YL0049           TH PHA Head Add
     C                     Z-ADD*ZERO     YL0050           TH Excluded Gro
     C                     Z-ADD*ZERO     YL0051           TH Excluded Car
     C                     Z-ADD*ZERO     YL0052           TH Excluded Pre
     C                     Z-ADD*ZERO     YL0053           TH Meat Value F
     C                     Z-ADD*ZERO     YL0056           TH Head LFT
     C                     Z-ADD*ZERO     YL0057           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0015           Lean % * Wgt US
     C                     Z-ADD*ZERO     WN0016           Backfat * Wgt U
     C                     Z-ADD*ZERO     WN0017           Loin-Eye * Wgt
     C                     Z-ADD*ZERO     WN0020           TH CA Base Mkt
     C                     Z-ADD*ZERO     WN0021           TH CA Sort Disc
     C                     Z-ADD*ZERO     WN0022           TH CA Yield Gai
     C                     Z-ADD*ZERO     WN0023           TH CA Base Carc
     C                     Z-ADD*ZERO     WN0024           TH CA Lean Prem
     C                     Z-ADD*ZERO     WN0025           TH CA Carcass G
     C                     Z-ADD*ZERO     WN0018           Backfat * Wgt U
     C                     Z-ADD*ZERO     WN0019           Loin-Eye * Wgt
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHHMNB    WQSI01           BOH Company Num
     C           *LIKE     DEFN WHBNNB    WQSI02           BOH Buy Order N
     C           *LIKE     DEFN WHBONB    WQSI03           BOL Load Number
     C           *LIKE     DEFN WHCVNB    WQSI04           TH Tattoo Numbe
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           BOH Company Num
     C                     KFLD           WQSI02           BOH Buy Order N
     C                     KFLD           WQSI03           BOL Load Number
     C                     KFLD           WQSI04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWDHMNB    WQSI01           BOH Company Num
     C                     Z-ADDWDBNNB    WQSI02           BOH Buy Order N
     C                     Z-ADDWDBONB    WQSI03           BOL Load Number
     C                     Z-ADDWDCVNB    WQSI04           TH Tattoo Numbe
      * Establish starting position
     C           KRSSI     SETLL@A1CPC4                    *
     C           KRSSI     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * 061208 slm E00144 LFT and eut/koa
      * 050108 slm get TH Fixed Cost Amount
      *                TH Meat Value Factor Amt
      * First Kill Date
      * CASE: WRK.First Time Flag Usr is Yes
     C           WUHBST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WUHBST           First Time Flag
     C                     END                             *FI
     C                     Z-ADDWHB0DT    YL0010           TH Kill Date
     C                     ADD  WHCXNB    YL0011           TH Dead On Arri
     C                     ADD  WHECDT    YL0056           TH Head LFT
     C                     ADD  WHEDDT    YL0057           TH Head EUT/KOA
     C                     ADD  WHCWNB    YL0012           TH Head Receive
     C                     ADD  WHFCNB    YL0013           TH Yard Deads
     C                     ADD  WHFDNB    YL0014           TH Head Condemn
     C                     ADD  WHFENB    WN0004           TH Head Killed
     C                     ADD  WHHENB    YL0015           TH Head Adds
     C                     ADD  WHCYNB    YL0016           TH Live Wgt
     C                     ADD  WHLRNB    YL0017           TH Adj Live Wgt
     C                     ADD  WHE0NB    YL0009           TH Hot Wgt
     C                     ADD  WHANPR    YL0023           TH CM Base Mkt
      * 5/29/03 new for sort loss print
      * CASE: PAR.Status 3 is Yes
     C           'Y'       IFEQ 'Y'                        *IF
     C                     ADD  WHNCHF    YL0024           TH CM Sort Disc
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  WHAYVA    YL0024           TH CM Sort Disc
     C                     END                             *FI
     C                     ADD  WHAWVA    YL0025           TH CM Yield Gai
      * CASE: PAR.CMP Grading Type is Meat Value
     C           WUDLST    IFEQ 'M'                        *IF
     C                     ADD  WHA2PR    YL0026           TH CM Base Carc
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  WHAOPR    YL0026           TH CM Base Carc
     C                     END                             *FI
     C                     ADD  WHAXVA    YL0027           TH CM LN AddOn/
     C                     ADD  WHAPPR    YL0028           TH CM Carcass G
     C                     ADD  WHATPR    YL0030           TH Carcass Net
     C                     ADD  WHCBPR    YL0008           TH Payment Gros
     C                     ADD  WHCCPR    YL0032           Th Payment Net
      * Lean % * Wgt USR
      * PAR.Lean % * Wgt USR =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.Lean % * Wgt USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : DB1.TH Avg Lean Percent
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : DB1.TH Hot Wgt
     C           WHF4NB    MULT WHE0NB    W0WD01           *Synon (17,7) w
     C           WN0015    ADD  W0WD01    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0015           Lean % * Wgt US
      * Backfat * Wgt USR
      * PAR.Backfat * Wgt USR =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.Backfat * Wgt USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : DB1.TH Avg Backfat
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : DB1.TH Hot Wgt
     C           WHF2NB    MULT WHE0NB    W0WD01           *Synon (17,7) w
     C           WN0016    ADD  W0WD01    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0016           Backfat * Wgt U
      * Loin-Eye * Wgt USR
      * PAR.Loin-Eye * Wgt USR =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.Loin-Eye * Wgt USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : DB1.TH Avg Loin Eye Depth
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : DB1.TH Hot Wgt
     C           WHF3NB    MULT WHE0NB    W0WD01           *Synon (17,7) w
     C           WN0017    ADD  W0WD01    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0017           Loin-Eye * Wgt
      * Backfat2 * Wgt USR
      * PAR.Backfat * Wgt USR 2 =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.Backfat * Wgt USR 2
      * +     : PGM.*Synon (17,7) work field
      * x2    : DB1.TH Avg Backfat - 2 Dec
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : DB1.TH Hot Wgt
     C           WHMCNF    MULT WHE0NB    W0WD01           *Synon (17,7) w
     C           WN0018    ADD  W0WD01    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0018           Backfat * Wgt U
      * Loin-Eye2 * Wgt USR
      * PAR.Loin-Eye * Wgt USR 2 =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.Loin-Eye * Wgt USR 2
      * +     : PGM.*Synon (17,7) work field
      * x2    : DB1.TH Avg Loin Eye - 2 dec
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : DB1.TH Hot Wgt
     C           WHMVNF    MULT WHE0NB    W0WD01           *Synon (17,7) w
     C           WN0019    ADD  W0WD01    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0019           Loin-Eye * Wgt
     C                     ADD  WHASPR    YL0029           TH Deduction Am
     C                     ADD  WHA5VA    YL0031           TH Additions Am
      * Analysis to Payments
      * CASE: PAR.Print Carcass Analysis Us is Yes
     C           'N'       IFEQ 'Y'                        *IF
      * Prt Crc Sum (Hld Ovr) RT - Tattoo Header EXT  * 
     C                     EXSR SJRVGN
     C                     ADD  WUI6PR    WN0020           TH CA Base Mkt
     C                     ADD  WUI7PR    WN0021           TH CA Sort Disc
     C                     ADD  WUI8PR    WN0022           TH CA Yield Gai
     C                     ADD  WUI9PR    WN0023           TH CA Base Carc
     C                     ADD  WUJAPR    WN0024           TH CA Lean Prem
     C                     ADD  WUJCPR    WN0025           TH CA Carcass G
     C                     END                             *FI
      * PK0166 - New fields
     C                     ADD  WHJ9NB    YL0036           TH Head Exclude
     C                     ADD  WHTBPR    YL0050           TH Excluded Gro
     C                     ADD  WHKROT    YL0051           TH Excluded Car
     C                     ADD  WHOTJG    YL0052           TH Excluded Pre
     C                     ADD  WHIORP    YL0048           TH Head Adjuste
     C                     ADD  WHOWEO    YL0049           TH PHA Head Add
      * 050108 slm get TH Fixed Cost Amount
     C                     ADD  WHA2PR    YL0033           TH Fixed Cost A
     C                     ADD  WHKFOR    YL0053           TH Meat Value F
     C           KRSSI     READE@A1CPC4                  90*
     C                     ENDDO
      * USER: Exit processing
      * Analysis to Payments
      * CASE: PAR.Print Carcass Analysis Us is Yes
     C           'N'       IFEQ 'Y'                        *IF
     C                     Z-ADDWN0020    YL0023           TH CM Base Mkt
     C                     Z-ADDWN0021    YL0024           TH CM Sort Disc
     C                     Z-ADDWN0022    YL0025           TH CM Yield Gai
     C                     Z-ADDWN0023    YL0026           TH CM Base Carc
     C                     Z-ADDWN0024    YL0027           TH CM LN AddOn/
     C                     Z-ADDWN0025    YL0028           TH CM Carcass G
     C                     END                             *FI
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Prt Crc Sum (Hld Ovr) RT - Tattoo Header EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WIHMNB           BOH Company Num
     C                     KFLD           WIBNNB           BOH Buy Order N
     C                     KFLD           WIBONB           BOL Load Number
     C                     KFLD           WICVNB           TH Tattoo Numbe
     C                     KFLD           WIB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDWHHMNB    WIHMNB           BOH Company Num
     C                     Z-ADDWHBNNB    WIBNNB           BOH Buy Order N
     C                     Z-ADDWHBONB    WIBONB           BOL Load Number
     C                     Z-ADDWHCVNB    WICVNB           TH Tattoo Numbe
     C                     Z-ADDWHB0DT    WIB0DT           TH Kill Date
      * Establish starting position
     C           KRSSJ     CHAIN@DNCPUY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0637' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUI6PR           TH CA Base Mkt
     C                     Z-ADD*ZERO     WUI7PR           TH CA Sort Disc
     C                     Z-ADD*ZERO     WUI8PR           TH CA Yield Gai
     C                     Z-ADD*ZERO     WUI9PR           TH CA Base Carc
     C                     Z-ADD*ZERO     WUJAPR           TH CA Lean Prem
     C                     Z-ADD*ZERO     WUJCPR           TH CA Carcass G
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWII6PR    WUI6PR           TH CA Base Mkt
     C                     Z-ADDWII7PR    WUI7PR           TH CA Sort Disc
     C                     Z-ADDWII8PR    WUI8PR           TH CA Yield Gai
     C                     Z-ADDWII9PR    WUI9PR           TH CA Base Carc
     C                     Z-ADDWIJAPR    WUJAPR           TH CA Lean Prem
     C                     Z-ADDWIJCPR    WUJCPR           TH CA Carcass G
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv MPR Seaboard Exp  RT - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0058           Addt Cst Ttl Us
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJHMNB    WQSK01           BOH Company Num
     C           *LIKE     DEFN WJBNNB    WQSK02           BOH Buy Order N
     C           *LIKE     DEFN WJBONB    WQSK03           BOL Load Number
     C           *LIKE     DEFN WJCVNB    WQSK04           TH Tattoo Numbe
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           BOH Company Num
     C                     KFLD           WQSK02           BOH Buy Order N
     C                     KFLD           WQSK03           BOL Load Number
     C                     KFLD           WQSK04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWDHMNB    WQSK01           BOH Company Num
     C                     Z-ADDWDBNNB    WQSK02           BOH Buy Order N
     C                     Z-ADDWDBONB    WQSK03           BOL Load Number
     C                     Z-ADDWDCVNB    WQSK04           TH Tattoo Numbe
      * Establish starting position
     C           KRSSK     SETLL@CDCPWY                    *
     C           KRSSK     READE@CDCPWY                  90*
      * Data record not found
     C   90                MOVEL'PRK0174' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WJA0VA    YL0058           Addt Cst Ttl Us
     C           KRSSK     READE@CDCPWY                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Upd Prior Day Slg     RT - MPR Prior Day Slaughtered  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WKH8CD           MPR Identificat
     C                     KFLD           WKETDT           MPR Reporting D
     C                     KFLD           WKC2A1           MPR Reporting T
     C                     KFLD           WKIBCD           MPR Lot Identif
      * Setup key
     C                     MOVELP5H8CD    WKH8CD           MPR Identificat
     C                     Z-ADDP6ETDT    WKETDT           MPR Reporting D
     C                     Z-ADDP6C2A1    WKC2A1           MPR Reporting T
     C                     MOVELWN0001    WKIBCD           MPR Lot Identif
      * Establish starting position
     C           KRSSL     CHAIN@E6CPGA              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0973' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Prior Day Slg     CR - MPR Prior Day Slaughtered  * 
     C                     EXSR SMCRRC
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Prior Day Slg     CH - MPR Prior Day Slaughtered  * 
     C                     EXSR SNCHRC
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCRRC    BEGSR
      *================================================================
      * Crt Prior Day Slg     CR - MPR Prior Day Slaughtered  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @E6CPF9
     C                     MOVELP5H8CD    WLH8CD           MPR Identificat
     C                     Z-ADDP6ETDT    WLETDT           MPR Reporting D
     C                     Z-ADDP6C2A1    WLC2A1           MPR Reporting T
     C                     MOVELWN0001    WLIBCD           MPR Lot Identif
     C                     Z-ADDWN0002    WLDOA1           MPR Slg Class C
     C                     Z-ADDWN0003    WLDPA1           MPR Slg Purchas
     C                     Z-ADDWN0004    WLDQA1           MPR Slg Head
     C                     Z-ADDWN0005    WLUUPR           MPR Slg Base Pr
     C                     Z-ADDWN0006    WLUVPR           MPR Slg Avg Net
     C                     Z-ADDWN0007    WLUWPR           MPR Slg Low Net
     C                     Z-ADDWN0008    WLUXPR           MPR Slg High Ne
     C                     Z-ADDWN0009    WLDRA1           MPR Slg Avg Liv
     C                     Z-ADDWN0010    WLDSA1           MPR Slg Avg Car
     C                     Z-ADDWN0011    WLUYPR           MPR Slg Avg Sor
     C                     Z-ADDWN0012    WLDTA1           MPR Slg Avg Bac
     C                     Z-ADDWN0013    WLDUA1           MPR Slg Avg Loi
     C                     Z-ADDWN0014    WLDVA1           MPR Slg Avg Lea
     C                     MOVEL*BLANK    WLAAVN           RS User Changed
     C                     Z-ADD*ZERO     WLAADT           RS Date Changed
     C                     Z-ADD*ZERO     WLAMTM           RS Time Changed
     C                     MOVEL'A'       WLAJST           RS Record Statu
     C                     MOVEL*BLANK    WLAHVN           RS Job
     C                     MOVEL*BLANK    WLAGVN           RS Program
     C                     MOVEL*BLANK    WLABVN           RS User Added
     C                     Z-ADD*ZERO     WLABDT           RS Date Added
     C                     Z-ADD*ZERO     WLABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       WLAJST           RS Record Statu
     C                     MOVEL##USR     WLABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WLABDT    PARM *ZERO     WQ0010  70       *DATE
     C           WLABTM    PARM *ZERO     WQ0011  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     WLAGVN           RS Program
     C                     MOVEL##JOB     WLAHVN           RS Job
     C           KLCRSM    KLIST
     C                     KFLD           WLH8CD           MPR Identificat
     C                     KFLD           WLETDT           MPR Reporting D
     C                     KFLD           WLC2A1           MPR Reporting T
     C                     KFLD           WLIBCD           MPR Lot Identif
      * Check for duplicate primary key
     C           KLCRSM    SETLL@E6CPF9                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0974' W0RTN   7
      * Send message 'MPR Prior Day Slaughte EX'
     C                     MOVEL'PRK0974' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C                     WRITE@E6CPF9                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNCHRC    BEGSR
      *================================================================
      * Chg Prior Day Slg     CH - MPR Prior Day Slaughtered  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0026 10        RS User Changed
     C                     Z-ADD*ZERO     WN0027  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0028  60       RS Time Changed
     C                     MOVEL*BLANK    WN0029  1        RS Record Statu
     C                     MOVEL*BLANK    WN0030 10        RS Job
     C                     MOVEL*BLANK    WN0031 10        RS Program
     C                     MOVEL*BLANK    WN0032 10        RS User Added
     C                     Z-ADD*ZERO     WN0033  70       RS Date Added
     C                     Z-ADD*ZERO     WN0034  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @E6CPF9
     C                     MOVELWKH8CD    WLH8CD    P      MPR Identificat
     C                     Z-ADDWKETDT    WLETDT           MPR Reporting D
     C                     Z-ADDWKC2A1    WLC2A1           MPR Reporting T
     C                     MOVELWKIBCD    WLIBCD    P      MPR Lot Identif
      *
     C           KLCHSN    KLIST
     C                     KFLD           WLH8CD           MPR Identificat
     C                     KFLD           WLETDT           MPR Reporting D
     C                     KFLD           WLC2A1           MPR Reporting T
     C                     KFLD           WLIBCD           MPR Lot Identif
     C           KLCHSN    CHAIN@E6CPF9              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKE6CPL0'MDACP
     C                     MOVEL'@E6CPF9' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKE61    YARDCS
      * Move non-key fields to @E6CPF9
     C                     Z-ADDWN0002    WLDOA1           MPR Slg Class C
     C                     Z-ADDWN0003    WLDPA1           MPR Slg Purchas
     C                     Z-ADDWN0004    WLDQA1           MPR Slg Head
     C                     Z-ADDWN0005    WLUUPR           MPR Slg Base Pr
     C                     Z-ADDWN0006    WLUVPR           MPR Slg Avg Net
     C                     Z-ADDWN0007    WLUWPR           MPR Slg Low Net
     C                     Z-ADDWN0008    WLUXPR           MPR Slg High Ne
     C                     Z-ADDWN0009    WLDRA1           MPR Slg Avg Liv
     C                     Z-ADDWN0010    WLDSA1           MPR Slg Avg Car
     C                     Z-ADDWN0011    WLUYPR           MPR Slg Avg Sor
     C                     Z-ADDWN0012    WLDTA1           MPR Slg Avg Bac
     C                     Z-ADDWN0013    WLDUA1           MPR Slg Avg Loi
     C                     Z-ADDWN0014    WLDVA1           MPR Slg Avg Lea
      *
      * Set PGM.*Record Data Changed flag
     C           QPKE61    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp-SysDtIF
     C                     MOVEL##USR     WLAAVN           RS User Changed
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WLAADT    PARM *ZERO     WQ0012  70       *DATE
     C           WLAMTM    PARM *ZERO     WQ0013  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##JOB     WLAHVN           RS Job
     C                     MOVEL##PGM     WLAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKE61    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@E6CPF9                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKE6CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv MPR Prior Day PrchRT - Buy Order Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0035 25        MPR Lot Identif
     C                     Z-ADD*ZERO     WN0036  10       MPR Pur Ownersh
     C                     Z-ADD*ZERO     WN0037  10       MPR Pur Class C
     C                     Z-ADD*ZERO     WN0038  20       MPR Pur Purchas
     C                     Z-ADD*ZERO     WN0039  60       MPR Pur Head
     C                     Z-ADD*ZERO     WN0040  51       MPR Pur Avg Liv
     C                     Z-ADD*ZERO     WN0041  52       MPR Pur Base Pr
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PK0254  Create MPR Prior Day Purchases
      *   Initialize constant fields
     C                     Z-ADD1         WN0037           MPR Pur Class C
     C                     Z-ADD*ZERO     WN0040           MPR Pur Avg Liv
     C                     Z-ADD*ZERO     WN0041           MPR Pur Base Pr
     C                     MOVEL'N'       WUIHST           Record Added Us
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMHMNB    WQSO01           BOH Company Num
      * Define keylist
     C           KPSSO     KLIST
     C                     KFLD           WQSO01           BOH Company Num
     C                     KFLD           WMASDT           BOH Kill Date
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           BOH Company Num
      * Setup key
     C                     Z-ADDP1GGNB    WQSO01           BOH Company Num
     C                     Z-ADDP4CGDT    WMASDT           BOH Kill Date
      * Establish starting position
     C           KPSSO     SETLL@AWCPGR                    *
     C           KRSSO     READE@AWCPGR                  90*
      * Data record not found
     C   90                MOVEL'PRK0049' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * R7805 11/04/16 RMC R7805 Use new BOH Purch Type
      * CASE: DB1.BOH MPR Purchase Type is *ALL values
     C           WMU1ST    IFEQ '01'                       *IF
     C           WMU1ST    OREQ '02'
     C           WMU1ST    OREQ '03'
     C           WMU1ST    OREQ '04'
     C           WMU1ST    OREQ '05'
     C           WMU1ST    OREQ '06'
     C           WMU1ST    OREQ '07'
     C           WMU1ST    OREQ '08'
     C           WMU1ST    OREQ '09'
     C           WMU1ST    OREQ '10'
     C           WMU1ST    OREQ '11'
     C                     MOVE WMU1ST    WN0038           MPR Pur Purchas
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV MPR Prdcr Purch TpRT - MPR Producer Purch Type  * 
     C                     EXSR SPRVGN
     C                     END                             *FI
      * Purchase Ownership Code
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.BOH Buy Order Type is Internal
      *   |- c2    : PAR.MPR Pur Purchase Type is Packer Owned
      *   '-
     C           WMA5ST    IFEQ 'I'                        *IF
     C           WN0038    OREQ 9                          *OR
     C                     Z-ADD1         WN0036           MPR Pur Ownersh
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.MPR Pur Purchase Type is Packer Sold
      *   |- c2    : PAR.MPR Pur Purchase Type is PckSld Neg Formula
      *   '-
     C           WN0038    IFGE 5                          *IF
     C           WN0038    ANDLE8
     C           WN0038    OREQ 11                         *OR
      * R7307 RMC 9/29/16  added type 11
     C                     Z-ADD2         WN0036           MPR Pur Ownersh
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD3         WN0036           MPR Pur Ownersh
     C                     END                             *FI
     C                     END                             *FI
      * RMC comment this code per MIKE LYNCH usda 04/24/07
      * E3577 11/5/14 RMC Original code before HEDGE
      * CASE: DB1.BOH Buy Order Type is Not Hedge
     C           WMA5ST    IFEQ 'C'                        *IF
     C           WMA5ST    OREQ 'I'
     C           WMA5ST    OREQ 'O'
      * Rtv Crt MPR PriorDyPrcRT - Buy Order Load  * 
     C                     EXSR SQRVGN
     C                     END                             *FI
     C           KRSSO     READE@AWCPGR                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV MPR Prdcr Purch TpRT - MPR Producer Purch Type  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGABCD    WQSP01           PD Producer Cod
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           PD Producer Cod
      * Setup key
     C                     MOVELWMABCD    WQSP01           PD Producer Cod
      * Establish starting position
     C           KRSSP     SETLL@E3CPF4                    *
     C           KRSSP     READE@E3CPF4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0967' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0038           MPR Purchase Ty
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWGC0A1    WN0038           MPR Purchase Ty
     C                     GOTO SPEXIT                     *QUIT
     C           KRSSP     READE@E3CPF4                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Rtv Crt MPR PriorDyPrcRT - Buy Order Load  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0042 25        MPR Lot Identif
     C                     Z-ADD*ZERO     WN0043  60       MPR Pur Head
     C                     Z-ADD*ZERO     WN0044  51       MPR Pur Avg Liv
     C                     MOVEL*BLANK    WN0045  2        MPR Origin
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * S14406 RMC 1/22/19 If the BOL was prev reported - LOT exists in p
      *   with the same reporting date/time - then let it go thru the CAS
      *   so it will update the MPR Pur Base Price in case it has changed
      *   happens if they didnt get entered into AS400, or usda error
      * S12679 RMC 3/2/18 dont report packer owned (9) until they can be
      *   either....still do not report its price. makes them reported wi
      *   the same timing as type 3 et al.
      * R6410
      * RMC Added chk for MMP and not kill date yet. dont output until ki
      *  this price cant be calc until all markets have a price
     C                     MOVEL'PP1'     WUJ5TX           BOH Market Date
      * Declare restrictor key work fields
     C           *LIKE     DEFN WOHMNB    WQSQ01           BOH Company Num
     C           *LIKE     DEFN WOBNNB    WQSQ02           BOH Buy Order N
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           BOH Company Num
     C                     KFLD           WQSQ02           BOH Buy Order N
      * Setup key
     C                     Z-ADDWMHMNB    WQSQ01           BOH Company Num
     C                     Z-ADDWMBNNB    WQSQ02           BOH Buy Order N
      * Establish starting position
     C           KRSSQ     SETLL@AXCPBX                    *
     C           KRSSQ     READE@AXCPBX                  90*
      * Data record not found
     C   90                MOVEL'PRK0051' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.RS Record Status is Active
     C           WOAJST    IFEQ 'A'                        *IF
      * RMC added check for ACTIVE record sts 04/23/07
      * RMC upd price if it was sent before on same REPORTING DATE/TIME 1
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.BOL MPR Prior Day Prch is Not Yes
      *   |- c2    : DB1.BOL MPR Prior Day Prch is Yes
      *   '-
     C           WOPCST    IFEQ *BLANK                     *IF
     C           WOPCST    OREQ 'N'
     C           WOPCST    OREQ 'Y'                        *OR
      * RMC 1.22.19 Added YES above so it goes thru here regardless
     C                     MOVEL*BLANK    WUP8TX           Buy Order Numbe
     C                     MOVELWOBNNB    WUP8TX           Buy Order Numbe
     C                     MOVEL*BLANK    WUP9TX           Buy Order Load
     C                     MOVELWOBONB    WUP9TX           Buy Order Load
     C                     Z-ADD0         ZQ      50
     C           WUP8TX    CAT  WUP9TX:ZQ WN0042    P      MPR Lot Identif
      * Rtv Tattoo Market Hd  RT - Tattoo Header  * 
     C                     EXSR SRRVGN
      * Rtv PL State          RT - Producer Location  * 
     C                     EXSR SSRVGN
      * Get state from site on first mkt tattoo  TFS S13526  9.7.18 added
      * CASE: PAR.MPR Origin from Site USR is Yes
     C           YL0060    IFEQ 'Y'                        *IF
      * Rtv Site ID f/mkt tt   RT - Tattoo Header EXT  * 
     C                     EXSR STRVGN
      * CASE: WRK.PS State is Entered
     C           WUT2TX    IFNE *BLANK                     *IF
     C                     MOVELWUT2TX    WN0045           MPR Origin
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv State f/mpr       RT - Tattoo Header  * 
     C                     EXSR SWRVGN
      * CASE: WRK.TH State is Entered
     C           WUNZTX    IFNE *BLANK                     *IF
     C                     MOVELWUNZTX    WN0045           MPR Origin
     C                     END                             *FI
     C                     END                             *FI
      * 9/20/02 new MPR Compliance issue; 02/26/04 sum(th hd rcvd MARKET)
      * CASE: LCL.Head Total USR is Greater then Zero
     C           YL0061    IFGT 0                          *IF
     C                     Z-ADDYL0061    WN0043           MPR Pur Head
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWOBPNB    WN0043           MPR Pur Head
     C                     END                             *FI
      * RMC 3.2.18  If packer owned, dont rpt until price can be calc'd
      * CASE:
      *  - c2AND(c3ORc5ANDc4)
      *   |- c2    : PAR.PO Option Code is Multi Market Price
      *   |- c3    : DB1.BOL Kill Date GT JOB.*Job date
      *   |- c5    : DB1.BOL Kill Date EQ JOB.*Job date
      *   |- c4    : PAR.BOH Market Date Method NE WRK.BOH Market Date Me
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WMAICD    IFEQ 'MMP'                      *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WOCQDT    IFGT ##JDT                      *IF
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFNE '1'                        *IF
     C           WOCQDT    IFEQ ##JDT                      *IF
     C           WMJ5TX    IFNE WUJ5TX                     *IF
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * S12837 3.27.18 Unless it is mkt date method = PP1 then it can be
      *    was checking if kill date >= job date and not checking for PP1
      * RMC 3.2.18 dont chk packer owned here. want to try to calc it bel
      * RMC 4/24/06 If packer owned, output -0- price - per MikeLynch USD
      * RMC Added chk for MMP and not kill date yet. dont output until ki
      *  this price cant be calc until all markets have a price
     C                     Z-ADD*ZERO     WN0041           MPR Pur Base Pr
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Base Price        RT - Tattoo Header  * 
     C                     EXSR SXRVGN
      * 11/01/17 RMC also check for date being hit with market date metho
      *   in above RTV
      * CASE: PAR.MPR Pur Ownership Code is Packer Owned
     C           WN0036    IFEQ 1                          *IF
     C                     Z-ADD*ZERO     WN0041           MPR Pur Base Pr
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0063    WN0041           MPR Pur Base Pr
     C                     END                             *FI
     C                     END                             *FI
      * If Live, output Avg Live Wt
      * CASE: PAR.BOH Payment Type is Live
     C           WMA4ST    IFEQ 'L'                        *IF
     C                     Z-ADDYL0062    WN0044           MPR Pur Avg Liv
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0044           MPR Pur Avg Liv
     C                     END                             *FI
      * Change comp to > 0; RMC added comp Ownership=1, price is zero 4/2
      * CASE:
      *  - c1OR(c2ANDc3)
      *   |- c1    : PAR.MPR Pur Base Price is Entered GT 0
      *   |- c2    : PAR.MPR Pur Ownership Code is Packer Owned
      *   |- c3    : LCL.TH CM Base Mkt Price is Not Zeros
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0041    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WN0036    IFEQ 1                          *IF
     C           YL0063    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RMC 3.2.18 R12679 report packer owned when a price was able to be
      * ONLY CREATE IF IT WAS NOT PREVIOUSLY REPORTED. If it was on a dif
      *   then we dont want to do it again.
      * Rtv Upd PriorDayPrch  RT - MPR Prior Day Purchased  * 
     C                     EXSR TARVGN
      * CASE: DB1.BOL MPR Prior Day Prch is Not Yes
     C           WOPCST    IFEQ *BLANK                     *IF
     C           WOPCST    OREQ 'N'
      * Chg MPR PriorDayPurch CH - Buy Order Load  * 
     C                     EXSR TDCHRC
      * Chg BOH MPR ReportDtT CH - Buy Order Header  * 
     C                     EXSR TECHRC
      * R7841 RMC 11.10.16 set to report Curr Day on LS119A,B, afternoon
      * CASE: PAR.Record Added Usr is No
     C           WUIHST    IFEQ 'N'                        *IF
     C                     MOVEL'Y'       WUIHST           Record Added Us
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSQ     READE@AXCPBX                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv Tattoo Market Hd  RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     YL0061           Head Total USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHHMNB    WQSR01           BOH Company Num
     C           *LIKE     DEFN WHBNNB    WQSR02           BOH Buy Order N
     C           *LIKE     DEFN WHBONB    WQSR03           BOL Load Number
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           BOH Company Num
     C                     KFLD           WQSR02           BOH Buy Order N
     C                     KFLD           WQSR03           BOL Load Number
      * Setup key
     C                     Z-ADDWOHMNB    WQSR01           BOH Company Num
     C                     Z-ADDWOBNNB    WQSR02           BOH Buy Order N
     C                     Z-ADDWOBONB    WQSR03           BOL Load Number
      * Establish starting position
     C           KRSSR     SETLL@A1CPC4                    *
     C           KRSSR     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.TH Hog Class Type is Market
     C           WHLLST    IFEQ 'M'                        *IF
     C                     ADD  WHCWNB    YL0061           Head Total USR
     C                     END                             *FI
     C           KRSSR     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv PL State          RT - Producer Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WRABCD           PD Producer Cod
     C                     KFLD           WRAECD           PL Location Cod
      * Setup key
     C                     MOVELWOABCD    WRABCD           PD Producer Cod
     C                     MOVELWOAECD    WRAECD           PL Location Cod
      * Establish starting position
     C           KRSSS     CHAIN@AFREAR              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0015' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0045           PL State Code
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWRN0TX    WN0045           PL State Code
     C                     GOTO SSEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Rtv Site ID f/mkt tt   RT - Tattoo Header EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    WUT2TX           PS State
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIHMNB    WQST01           BOH Company Num
     C           *LIKE     DEFN WIBNNB    WQST02           BOH Buy Order N
     C           *LIKE     DEFN WIBONB    WQST03           BOL Load Number
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST01           BOH Company Num
     C                     KFLD           WQST02           BOH Buy Order N
     C                     KFLD           WQST03           BOL Load Number
      * Setup key
     C                     Z-ADDWOHMNB    WQST01           BOH Company Num
     C                     Z-ADDWOBNNB    WQST02           BOH Buy Order N
     C                     Z-ADDWOBONB    WQST03           BOL Load Number
      * Establish starting position
     C           KRSST     SETLL@DNCPUY                    *
     C           KRSST     READE@DNCPUY                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0637' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUT2TX           PS State
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * get the state for the site on the 1st mkt tattoo
      * CASE: DB1.PS Site ID is Not Blank
     C           WINYCD    IFNE *BLANK                     *IF
      * Rtv Class Type        RT - Tattoo Header  * 
     C                     EXSR SURVGN
      * CASE: WRK.TH Hog Class Type is Market
     C           WULLST    IFEQ 'M'                        *IF
      * Rtv Site State WRTN   RT - Producer Site  * 
     C                     EXSR SVRVGN
      * CASE: WRK.PS State is Entered
     C           WUT2TX    IFNE *BLANK                     *IF
     C                     MOVELWUT2TX    WUT2TX           PS State
     C                     GOTO STEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSST     READE@DNCPUY                  90*
     C                     ENDDO
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Rtv Class Type        RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WSHMNB    WQSU01           BOH Company Num
     C           *LIKE     DEFN WSBNNB    WQSU02           BOH Buy Order N
     C           *LIKE     DEFN WSBONB    WQSU03           BOL Load Number
     C           *LIKE     DEFN WSCVNB    WQSU04           TH Tattoo Numbe
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WQSU01           BOH Company Num
     C                     KFLD           WQSU02           BOH Buy Order N
     C                     KFLD           WQSU03           BOL Load Number
     C                     KFLD           WQSU04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWIHMNB    WQSU01           BOH Company Num
     C                     Z-ADDWIBNNB    WQSU02           BOH Buy Order N
     C                     Z-ADDWIBONB    WQSU03           BOL Load Number
     C                     Z-ADDWICVNB    WQSU04           TH Tattoo Numbe
      * Establish starting position
     C           KRSSU     SETLL@A1CPOI                    *
     C           KRSSU     READE@A1CPOI                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WULLST           TH Hog Class Ty
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWSLLST    WULLST           TH Hog Class Ty
     C           KRSSU     READE@A1CPOI                  90*
     C                     ENDDO
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Rtv Site State WRTN   RT - Producer Site  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WTABCD           PD Producer Cod
     C                     KFLD           WTNYCD           PS Site ID
      * Setup key
     C                     MOVELWIABCD    WTABCD           PD Producer Cod
     C                     MOVELWINYCD    WTNYCD           PS Site ID
      * Establish starting position
     C           KRSSV     CHAIN@ATRELM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1137' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUT2TX           PS State
     C                     MOVEL*BLANK    WURTN            *Return code
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWTT2TX    WUT2TX           PS State
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Rtv State f/mpr       RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHHMNB    WQSW01           BOH Company Num
     C           *LIKE     DEFN WHBNNB    WQSW02           BOH Buy Order N
     C           *LIKE     DEFN WHBONB    WQSW03           BOL Load Number
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WQSW01           BOH Company Num
     C                     KFLD           WQSW02           BOH Buy Order N
     C                     KFLD           WQSW03           BOL Load Number
      * Setup key
     C                     Z-ADDWOHMNB    WQSW01           BOH Company Num
     C                     Z-ADDWOBNNB    WQSW02           BOH Buy Order N
     C                     Z-ADDWOBONB    WQSW03           BOL Load Number
      * Establish starting position
     C           KRSSW     SETLL@A1CPC4                    *
     C           KRSSW     READE@A1CPC4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUNZTX           TH State
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.TH Hog Class Type is Market
     C           WHLLST    IFEQ 'M'                        *IF
      * PAR = DB1 By name
     C                     MOVELWHNZTX    WUNZTX           TH State
     C                     GOTO SWEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSW     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * Rtv Base Price        RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WVHMNB    WQSX01           BOH Company Num
     C           *LIKE     DEFN WVBNNB    WQSX02           BOH Buy Order N
     C           *LIKE     DEFN WVBONB    WQSX03           BOL Load Number
     C           *LIKE     DEFN WVB0DT    WQSX04           TH Kill Date
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WQSX01           BOH Company Num
     C                     KFLD           WQSX02           BOH Buy Order N
     C                     KFLD           WQSX03           BOL Load Number
     C                     KFLD           WQSX04           TH Kill Date
      * Setup key
     C                     Z-ADDWOHMNB    WQSX01           BOH Company Num
     C                     Z-ADDWOBNNB    WQSX02           BOH Buy Order N
     C                     Z-ADDWOBONB    WQSX03           BOL Load Number
     C                     Z-ADDWOCQDT    WQSX04           TH Kill Date
      * Establish starting position
     C           KRSSX     SETLL@A1CPOC                    *
     C           KRSSX     READE@A1CPOC                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0062           TH Avg Live Wgt
     C                     Z-ADD*ZERO     YL0063           TH CM Base Mkt
      * S12837 RMC - get sub-ctr info for price calc. 3/26/18 cpy here fr
     C                     Z-ADD*ZERO     YL0064           PSC Market Perc
     C                     Z-ADD*ZERO     YL0065           PSC Mkt Percent
     C                     Z-ADD*ZERO     YL0066           PSC Break Even
      * Rtv PrSb-Cont Carc/Sm RT - Producer Sub-Contract  * 
     C                     EXSR SYRVGN
      * Clc Base Mkt Price    XF - Pricing Option  * 
     C                     CALL 'PKJ7XFR'              90  Clc Base Mkt Pr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WOBNNB    WQ0017  70       BOH Buy Order N
     C                     PARM WOBONB    WQ0018  50       BOL Load Number
     C                     PARM YL0067    WQ0019  50       TH Tattoo Numbe
     C                     PARM WOCQDT    WQ0020  70       TH Purchase Dat
     C                     PARM YL0068    WQ0021  71       TH Live Wgt
     C           YL0063    PARM *ZERO     WQ0022  52       TH CM Base Mkt
     C                     PARM WOCQDT    WQ0023  70       TH Kill Date
     C                     PARM WOHMNB    WQ0024  30       BOH Company Num
     C                     PARM YL0069    WQ0025  52       PSC Floor Price
     C                     PARM YL0070    WQ0026  52       PSC Ceiling Pri
     C                     PARM YL0064    WQ0027  30       PSC Market Perc
     C                     PARM YL0065    WQ0028  52       PSC Mkt Percent
     C           YL0071    PARM YL0071    WQ0029  52       Market Price US
     C           YL0072    PARM *BLANK    WQ0030  2        Pricing UOM USR
     C           YL0073    PARM *ZERO     WQ0031  70       Pricing Date US
     C                     PARM WMAICD    WQ0032  3        PO Option Code
     C                     PARM WMAKCD    WQ0033  5        PC Contract Cod
     C                     PARM WMALCD    WQ0034  5        PSC Sub-Contrac
     C                     PARM WMAAPR    WQ0035  52       BOH Market Add/
     C                     PARM WMAMCD    WQ0036  3        CMP Program Cod
     C                     PARM WMB3ST    WQ0037  2        BOH Quote Price
     C                     PARM WMALPR    WQ0038  52       BOH Quoted Base
     C                     PARM WMETCD    WQ0039  3        BOH Commodity M
     C                     PARM WMEUCD    WQ0040  7        BOH Commodity P
     C                     PARM WMJ5TX    WQ0041  3        BOH Market Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKJ7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PAR.TH CM Base Mkt Price EQ PAR.BOH Market Add/Deduct
     C           YL0063    IFEQ WMAAPR                     *IF
     C                     Z-ADD*ZERO     YL0063           TH CM Base Mkt
     C                     END                             *FI
      * 11/01/17 RMC also check for date being hit with market date metho
      * CASE: PAR.TH Kill Date GT JOB.*Job date
     C           WOCQDT    IFGT ##JDT                      *IF
      * 11/9/17  dont chk market date method. its true for PP1 and  CUR
      * CASE: PAR.BOH Quoted Base Mkt Price is Zeros
     C           WMALPR    IFEQ 0                          *IF
      * 04/12/18 report a quoted base market priced load- dont zero it ou
     C                     Z-ADD*ZERO     YL0063           TH CM Base Mkt
     C                     END                             *FI
     C                     END                             *FI
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * S00313 RMC - get sub-ctr info for price calc. it was 000000
     C                     Z-ADD*ZERO     YL0064           PSC Market Perc
     C                     Z-ADD*ZERO     YL0065           PSC Mkt Percent
     C                     Z-ADD*ZERO     YL0066           PSC Break Even
      * Rtv PrSb-Cont Carc/Sm RT - Producer Sub-Contract  * 
     C                     EXSR SZRVGN
      * Clc Base Mkt Price    XF - Pricing Option  * 
     C                     CALL 'PKJ7XFR'              90  Clc Base Mkt Pr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WVBNNB    WQ0042  70       BOH Buy Order N
     C                     PARM WVBONB    WQ0043  50       BOL Load Number
     C                     PARM WVCVNB    WQ0044  50       TH Tattoo Numbe
     C                     PARM WVAWDT    WQ0045  70       TH Purchase Dat
     C                     PARM WVCYNB    WQ0046  71       TH Live Wgt
     C           YL0063    PARM *ZERO     WQ0047  52       TH CM Base Mkt
     C                     PARM WVB0DT    WQ0048  70       TH Kill Date
     C                     PARM WVHMNB    WQ0049  30       BOH Company Num
     C                     PARM YL0069    WQ0050  52       PSC Floor Price
     C                     PARM YL0070    WQ0051  52       PSC Ceiling Pri
     C                     PARM YL0064    WQ0052  30       PSC Market Perc
     C                     PARM YL0065    WQ0053  52       PSC Mkt Percent
     C           YL0071    PARM YL0071    WQ0054  52       Market Price US
     C           YL0072    PARM *BLANK    WQ0055  2        Pricing UOM USR
     C           YL0073    PARM *ZERO     WQ0056  70       Pricing Date US
     C                     PARM WMAICD    WQ0057  3        PO Option Code
     C                     PARM WMAKCD    WQ0058  5        PC Contract Cod
     C                     PARM WMALCD    WQ0059  5        PSC Sub-Contrac
     C                     PARM WMAAPR    WQ0060  52       BOH Market Add/
     C                     PARM WMAMCD    WQ0061  3        CMP Program Cod
     C                     PARM WMB3ST    WQ0062  2        BOH Quote Price
     C                     PARM WMALPR    WQ0063  52       BOH Quoted Base
     C                     PARM WMETCD    WQ0064  3        BOH Commodity M
     C                     PARM WMEUCD    WQ0065  7        BOH Commodity P
     C                     PARM WMJ5TX    WQ0066  3        BOH Market Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKJ7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * IF PRICE = + - DED, THEN ZERO IT OUT
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.TH CM Base Mkt Price EQ PAR.BOH Market Add/Deduc
      *   |- c2    : PAR.TH CM Base Mkt Price is LT 1.00
      *   '-
     C           YL0063    IFEQ WMAAPR                     *IF
     C           YL0063    ORLT 1                          *OR
      * RMC 4/25/06 added comp lt 1
     C                     Z-ADD*ZERO     YL0063           TH CM Base Mkt
     C                     END                             *FI
      * 11/01/17 RMC also check for date being hit with market date metho
      * CASE: DB1.TH Purchase Date GT JOB.*Job date
     C           WVAWDT    IFGT ##JDT                      *IF
      * CASE: PAR.BOH Quoted Base Mkt Price is Zeros
     C           WMALPR    IFEQ 0                          *IF
      * 04/12/18 report a quoted base market priced load- dont zero it ou
      * 11/9/17  dont chk market date method. its true for PP1 and  CUR
     C                     Z-ADD*ZERO     YL0063           TH CM Base Mkt
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWVF7NB    YL0062           TH Avg Live Wgt
     C                     GOTO SXEXIT                     *QUIT
     C           KRSSX     READE@A1CPOC                  90*
     C                     ENDDO
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * Rtv PrSb-Cont Carc/Sm RT - Producer Sub-Contract  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WWAKCD           PC Contract Cod
     C                     KFLD           WWALCD           PSC Sub-Contrac
      * Setup key
     C                     MOVELWMAKCD    WWAKCD           PC Contract Cod
     C                     MOVELWMALCD    WWALCD           PSC Sub-Contrac
      * Establish starting position
     C           KRSSY     CHAIN@AQCPA0              90    *
      * Data record not found
     C   90                MOVEL'PRK0037' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWWA9PC    YL0064           PSC Market Perc
     C                     Z-ADDWWA7PR    YL0066           PSC Break Even
     C                     Z-ADDWWA9PR    YL0065           PSC Mkt Percent
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * Rtv PrSb-Cont Carc/Sm RT - Producer Sub-Contract  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WWAKCD           PC Contract Cod
     C                     KFLD           WWALCD           PSC Sub-Contrac
      * Setup key
     C                     MOVELWMAKCD    WWAKCD           PC Contract Cod
     C                     MOVELWMALCD    WWALCD           PSC Sub-Contrac
      * Establish starting position
     C           KRSSZ     CHAIN@AQCPA0              90    *
      * Data record not found
     C   90                MOVEL'PRK0037' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWWA9PC    YL0064           PSC Market Perc
     C                     Z-ADDWWA7PR    YL0066           PSC Break Even
     C                     Z-ADDWWA9PR    YL0065           PSC Mkt Percent
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * Rtv Upd PriorDayPrch  RT - MPR Prior Day Purchased  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0046 10        RS User Changed
     C                     Z-ADD*ZERO     WN0047  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0048  60       RS Time Changed
     C                     MOVEL*BLANK    WN0049  1        RS Record Statu
     C                     MOVEL*BLANK    WN0050 10        RS Job
     C                     MOVEL*BLANK    WN0051 10        RS Program
     C                     MOVEL*BLANK    WN0052 10        RS User Added
     C                     Z-ADD*ZERO     WN0053  70       RS Date Added
     C                     Z-ADD*ZERO     WN0054  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WXH8CD           MPR Identificat
     C                     KFLD           WXETDT           MPR Reporting D
     C                     KFLD           WXC2A1           MPR Reporting T
     C                     KFLD           WXIBCD           MPR Lot Identif
      * Setup key
     C                     MOVELP5H8CD    WXH8CD           MPR Identificat
     C                     Z-ADDP6ETDT    WXETDT           MPR Reporting D
     C                     Z-ADDP6C2A1    WXC2A1           MPR Reporting T
     C                     MOVELWN0042    WXIBCD           MPR Lot Identif
      * Establish starting position
     C           KRSTA     CHAIN@E7CPGM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0975' W0RTN   7
      * USER: Processing if Data record not found
      * CASE: PAR.BOL MPR Prior Day Prch is Not Yes
     C           WOPCST    IFEQ *BLANK                     *IF
     C           WOPCST    OREQ 'N'
      * Crt Prior Day Purch   CR - MPR Prior Day Purchased  * 
     C                     EXSR TBCRRC
     C                     END                             *FI
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Prior Day Purch   CH - MPR Prior Day Purchased  * 
     C                     EXSR TCCHRC
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBCRRC    BEGSR
      *================================================================
      * Crt Prior Day Purch   CR - MPR Prior Day Purchased  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @E7CPGL
     C                     MOVELP5H8CD    WYH8CD           MPR Identificat
     C                     Z-ADDP6ETDT    WYETDT           MPR Reporting D
     C                     Z-ADDP6C2A1    WYC2A1           MPR Reporting T
     C                     MOVELWN0042    WYIBCD           MPR Lot Identif
     C                     Z-ADDWN0036    WYDWA1           MPR Pur Ownersh
     C                     Z-ADDWN0037    WYDXA1           MPR Pur Class C
     C                     Z-ADDWN0038    WYDYA1           MPR Pur Purchas
     C                     Z-ADDWN0043    WYDZA1           MPR Pur Head
     C                     Z-ADDWN0044    WYD0A1           MPR Pur Avg Liv
     C                     Z-ADDWN0041    WYUZPR           MPR Pur Base Pr
     C                     MOVELWN0045    WYIDCD           MPR Origin
     C                     MOVELWN0046    WYAAVN           RS User Changed
     C                     Z-ADDWN0047    WYAADT           RS Date Changed
     C                     Z-ADDWN0048    WYAMTM           RS Time Changed
     C                     MOVELWN0049    WYAJST           RS Record Statu
     C                     MOVELWN0050    WYAHVN           RS Job
     C                     MOVELWN0051    WYAGVN           RS Program
     C                     MOVELWN0052    WYABVN           RS User Added
     C                     Z-ADDWN0053    WYABDT           RS Date Added
     C                     Z-ADDWN0054    WYABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       WYAJST           RS Record Statu
     C                     MOVEL##USR     WYABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WYABDT    PARM *ZERO     WQ0067  70       *DATE
     C           WYABTM    PARM *ZERO     WQ0068  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     WYAGVN           RS Program
     C                     MOVEL##JOB     WYAHVN           RS Job
     C           KLCRTB    KLIST
     C                     KFLD           WYH8CD           MPR Identificat
     C                     KFLD           WYETDT           MPR Reporting D
     C                     KFLD           WYC2A1           MPR Reporting T
     C                     KFLD           WYIBCD           MPR Lot Identif
      * Check for duplicate primary key
     C           KLCRTB    SETLL@E7CPGL                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0976' W0RTN   7
      * Send message 'MPR Prior Day Purchase EX'
     C                     MOVEL'PRK0976' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C                     WRITE@E7CPGL                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCCHRC    BEGSR
      *================================================================
      * Chg Prior Day Purch   CH - MPR Prior Day Purchased  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0055 10        RS User Changed
     C                     Z-ADD*ZERO     WN0056  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0057  60       RS Time Changed
     C                     MOVEL*BLANK    WN0058  1        RS Record Statu
     C                     MOVEL*BLANK    WN0059 10        RS Job
     C                     MOVEL*BLANK    WN0060 10        RS Program
     C                     MOVEL*BLANK    WN0061 10        RS User Added
     C                     Z-ADD*ZERO     WN0062  70       RS Date Added
     C                     Z-ADD*ZERO     WN0063  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @E7CPGL
     C                     MOVELWXH8CD    WYH8CD    P      MPR Identificat
     C                     Z-ADDWXETDT    WYETDT           MPR Reporting D
     C                     Z-ADDWXC2A1    WYC2A1           MPR Reporting T
     C                     MOVELWXIBCD    WYIBCD    P      MPR Lot Identif
      *
     C           KLCHTC    KLIST
     C                     KFLD           WYH8CD           MPR Identificat
     C                     KFLD           WYETDT           MPR Reporting D
     C                     KFLD           WYC2A1           MPR Reporting T
     C                     KFLD           WYIBCD           MPR Lot Identif
     C           KLCHTC    CHAIN@E7CPGL              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKE7CPL0'MDACP
     C                     MOVEL'@E7CPGL' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKE71    YBRDCS
      * Move non-key fields to @E7CPGL
     C                     Z-ADDWN0036    WYDWA1           MPR Pur Ownersh
     C                     Z-ADDWN0037    WYDXA1           MPR Pur Class C
     C                     Z-ADDWN0038    WYDYA1           MPR Pur Purchas
     C                     Z-ADDWN0043    WYDZA1           MPR Pur Head
     C                     Z-ADDWN0044    WYD0A1           MPR Pur Avg Liv
     C                     Z-ADDWN0041    WYUZPR           MPR Pur Base Pr
     C                     MOVELWN0045    WYIDCD    P      MPR Origin
      *
      * Set PGM.*Record Data Changed flag
     C           QPKE71    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp-SysDtIF
     C                     MOVEL##USR     WYAAVN           RS User Changed
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WYAADT    PARM *ZERO     WQ0069  70       *DATE
     C           WYAMTM    PARM *ZERO     WQ0070  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##JOB     WYAHVN           RS Job
     C                     MOVEL##PGM     WYAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKE71    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@E7CPGL                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKE7CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDCHRC    BEGSR
      *================================================================
      * Chg MPR PriorDayPurch CH - Buy Order Load  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0064  70       BOL Kill Date
     C                     Z-ADD*ZERO     WN0065  40       BOL Pln Delv St
     C                     Z-ADD*ZERO     WN0066  40       BOL Pln Delv En
     C                     Z-ADD*ZERO     WN0067  50       BOL Pln Head De
     C                     Z-ADD*ZERO     WN0068  71       BOL Shipped Wgt
     C                     Z-ADD*ZERO     WN0069  70       BOL Pln Delv Da
     C                     MOVEL*BLANK    WN0070  2        BOL Freight UOM
     C                     Z-ADD*ZERO     WN0071  72       BOL Freight Uni
     C                     Z-ADD*ZERO     WN0072  72       BOL Freight Amt
     C                     MOVEL*BLANK    WN0073  1        BOL Freight All
     C                     Z-ADD*ZERO     WN0074  70       BOL Head Receiv
     C                     Z-ADD*ZERO     WN0075  71       BOL Live Wgt Re
     C                     MOVEL*BLANK    WN0076  2        BOL Trucker Pay
     C                     Z-ADD*ZERO     WN0077  80       BOL Trucker Che
     C                     Z-ADD*ZERO     WN0078  70       BOL Trucker Che
     C                     Z-ADD*ZERO     WN0079  80       BOL AP Voucher
     C                     MOVEL*BLANK    WN0080 11        BOL Trailer
     C                     MOVEL*BLANK    WN0081  1        BOL Freight Exp
     C                     MOVEL*BLANK    WN0082  1        BOL Scheduled K
     C                     MOVEL*BLANK    WN0083  1        BOL Truck Scale
     C                     Z-ADD*ZERO     WN0084  50       BOL Shipped Hea
     C                     MOVEL*BLANK    WN0085  1        Reported to USD
     C                     MOVEL*BLANK    WN0086  1        BOL Violated Au
     C                     MOVEL*BLANK    WN0087  2        BOL Status 5
     C                     MOVEL*BLANK    WN0088  2        BOL Status 6
     C                     MOVEL*BLANK    WN0089  3        BOL Status 7
     C                     Z-ADD*ZERO     WN0090  70       BOL HPS Movemen
     C                     Z-ADD*ZERO     WN0091  70       BOL Head LFT
     C                     Z-ADD*ZERO     WN0092  70       BOL Head EUT/KO
     C                     Z-ADD*ZERO     WN0093  70       BOL Auth Gate E
     C                     Z-ADD*ZERO     WN0094  70       BOL Head Receiv
     C                     Z-ADD*ZERO     WN0095 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0096 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0097 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0098 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0099 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0100  70       BOL Auth Gate E
     C                     Z-ADD*ZERO     WN0101  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0102  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0103  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0104  70       BOL Unused Date
     C                     MOVEL*BLANK    WN0105  3        TRK Trucker Cod
     C                     MOVEL*BLANK    WN0106  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0107  6        PL Location Cod
     C                     MOVEL*BLANK    WN0108 10        RS User Changed
     C                     Z-ADD*ZERO     WN0109  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0110  60       RS Time Changed
     C                     MOVEL*BLANK    WN0111  1        RS Record Statu
     C                     MOVEL*BLANK    WN0112 10        RS Job
     C                     MOVEL*BLANK    WN0113 10        RS Program
     C                     MOVEL*BLANK    WN0114 10        RS User Added
     C                     Z-ADD*ZERO     WN0115  70       RS Date Added
     C                     Z-ADD*ZERO     WN0116  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @AXCPBY
     C                     Z-ADDWOHMNB    TAHMNB           BOH Company Num
     C                     Z-ADDWOBNNB    TABNNB           BOH Buy Order N
     C                     Z-ADDWOBONB    TABONB           BOL Load Number
      *
     C           KLCHTD    KLIST
     C                     KFLD           TAHMNB           BOH Company Num
     C                     KFLD           TABNNB           BOH Buy Order N
     C                     KFLD           TABONB           BOL Load Number
     C           KLCHTD    CHAIN@AXCPBY              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKAXCPL1'MDACP
     C                     MOVEL'@AXCPBY' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TDEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKAX1    YCRDCS
      * Move non-key fields to @AXCPBY
     C                     MOVEL'Y'       TAPCST    P      BOL MPR Prior D
      *
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp-SysDtIF
     C                     MOVEL##USR     TAAAVN           RS User Changed
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           TAAADT    PARM *ZERO     WQ0071  70       *DATE
     C           TAAMTM    PARM *ZERO     WQ0072  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##JOB     TAAHVN           RS Job
     C                     MOVEL##PGM     TAAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@AXCPBY                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKAXCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TECHRC    BEGSR
      *================================================================
      * Chg BOH MPR ReportDtT CH - Buy Order Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0117  70       BOH Buy Order D
     C                     Z-ADD*ZERO     WN0118  70       BOH Kill Date
     C                     MOVEL*BLANK    WN0119  1        BOH Payment Typ
     C                     MOVEL*BLANK    WN0120  1        BOH Buy Order T
     C                     Z-ADD*ZERO     WN0121  52       BOH Market Add/
     C                     MOVEL*BLANK    WN0122  1        BOH Status
     C                     MOVEL*BLANK    WN0123  1        BOH Delv Plan P
     C                     MOVEL*BLANK    WN0124  2        BOH Quote Price
     C                     Z-ADD*ZERO     WN0125  52       BOH Quoted Base
     C                     MOVEL*BLANK    WN0126  3        BOH Commodity M
     C                     MOVEL*BLANK    WN0127  7        BOH Commodity P
     C                     MOVEL*BLANK    WN0128  3        BOH Market Date
     C                     Z-ADD*ZERO     WN0129  70       BOH Hedge Date
     C                     Z-ADD*ZERO     WN0130  70       BOH Unused Date
     C                     Z-ADD*ZERO     WN0131  70       BOH Unused Date
     C                     Z-ADD*ZERO     WN0132  70       BOH Unused Date
     C                     Z-ADD*ZERO     WN0133  70       BOH Hedge Head
     C                     Z-ADD*ZERO     WN0134  70       BOH Hedge Refer
     C                     Z-ADD*ZERO     WN0135  70       BOH Hedge Time
     C                     Z-ADD*ZERO     WN0136  90       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0137  90       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0138  91       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0139  91       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0140 112       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0141 112       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0142 112       BOH Unused Nbr
     C                     MOVEL*BLANK    WN0143  1        BOH MPR EST RPT
     C                     MOVEL*BLANK    WN0144  2        BOH MPR Purchas
     C                     MOVEL*BLANK    WN0145  3        BOH Status 4
     C                     MOVEL*BLANK    WN0146  3        BOH Status 5
     C                     Z-ADD*ZERO     WN0147  30       PPWS Company Nu
     C                     Z-ADD*ZERO     WN0148  40       CW Year
     C                     Z-ADD*ZERO     WN0149  20       CW Week Number
     C                     MOVEL*BLANK    WN0150  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0151  6        PL Location Cod
     C                     MOVEL*BLANK    WN0152  5        PC Contract Cod
     C                     MOVEL*BLANK    WN0153  5        PSC Sub-Contrac
     C                     MOVEL*BLANK    WN0154  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0155  3        PO Option Code
     C                     MOVEL*BLANK    WN0156  3        CMP Program Cod
     C                     MOVEL*BLANK    WN0157  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0158 10        RS User Changed
     C                     Z-ADD*ZERO     WN0159  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0160  60       RS Time Changed
     C                     MOVEL*BLANK    WN0161  1        RS Record Statu
     C                     MOVEL*BLANK    WN0162 10        RS Job
     C                     MOVEL*BLANK    WN0163 10        RS Program
     C                     MOVEL*BLANK    WN0164 10        RS User Added
     C                     Z-ADD*ZERO     WN0165  70       RS Date Added
     C                     Z-ADD*ZERO     WN0166  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @AWCPAZ
     C                     Z-ADDWOHMNB    TBHMNB           BOH Company Num
     C                     Z-ADDWOBNNB    TBBNNB           BOH Buy Order N
      *
     C           KLCHTE    KLIST
     C                     KFLD           TBHMNB           BOH Company Num
     C                     KFLD           TBBNNB           BOH Buy Order N
     C           KLCHTE    CHAIN@AWCPAZ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKAWCPL0'MDACP
     C                     MOVEL'@AWCPAZ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKAW1    YDRDCS
      * Move non-key fields to @AWCPAZ
     C                     Z-ADDP6ETDT    TBD5DT           BOH MPR Reporti
     C                     MOVEL'1'       TBUZST    P      BOH MPR Reporti
      *
      * Set PGM.*Record Data Changed flag
     C           QPKAW1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     TBAAVN           RS User Changed
     C                     Z-ADD##JDT     TBAADT           RS Date Changed
     C                     Z-ADD##JTM     TBAMTM           RS Time Changed
     C                     MOVEL##JOB     TBAHVN           RS Job
     C                     MOVEL##PGM     TBAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKAW1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@AWCPAZ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKAWCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * Rtv Record f/RptDay   RT - MPR Prior Day Purchased  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WXH8CD    WQTF01           MPR Identificat
     C           *LIKE     DEFN WXETDT    WQTF02           MPR Reporting D
     C           *LIKE     DEFN WXC2A1    WQTF03           MPR Reporting T
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           WQTF01           MPR Identificat
     C                     KFLD           WQTF02           MPR Reporting D
     C                     KFLD           WQTF03           MPR Reporting T
      * Setup key
     C                     MOVELP5H8CD    WQTF01           MPR Identificat
     C                     Z-ADDP6ETDT    WQTF02           MPR Reporting D
     C                     Z-ADDP6C2A1    WQTF03           MPR Reporting T
      * Establish starting position
     C           KRSTF     SETLL@E7CPGM                    *
     C           KRSTF     READE@E7CPGM                  90*
      * Data record not found
     C   90                MOVEL'PRK0975' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUIHST           Record Added Us
     C                     GOTO TFEXIT                     *QUIT
     C           KRSTF     READE@E7CPGM                  90*
     C                     ENDDO
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * MPR Bld Estimtd f/Sch RT - Buy Order Load  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0167  60       MPR Est Purch T
     C                     Z-ADD*ZERO     WN0168  60       MPR Est Purch T
     C                     Z-ADD*ZERO     WN0169  60       MPR Est Purch T
     C                     Z-ADD*ZERO     WN0170  60       MPR Est Purch T
     C                     Z-ADD*ZERO     WN0171  60       MPR Est Purch T
     C                     Z-ADD*ZERO     WN0172  60       MPR Est Purch T
     C                     Z-ADD*ZERO     WN0173  60       MPR Est Purch T
     C                     Z-ADD*ZERO     WN0174  60       MPR Est Purch T
     C                     Z-ADD*ZERO     WN0175  60       MPR Est Purch T
     C                     Z-ADD*ZERO     WN0176  60       MPR Est Purch T
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TCHMNB    WQTG01           BOH Company Num
     C           *LIKE     DEFN TCCQDT    WQTG02           BOL Kill Date
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           WQTG01           BOH Company Num
     C                     KFLD           WQTG02           BOL Kill Date
      * Setup key
     C                     Z-ADDP1GGNB    WQTG01           BOH Company Num
     C                     Z-ADDP4CGDT    WQTG02           BOL Kill Date
      * Establish starting position
     C           KRSTG     SETLL@AXCPB8                    *
     C           KRSTG     READE@AXCPB8                  90*
      * Data record not found
     C   90                MOVEL'PRK0051' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * R7841 chg from BOL Pln Head Delv TO TH Head Received
      * CASE: DB1.RS Record Status is Active
     C           TCAJST    IFEQ 'A'                        *IF
      * Rtv Tattoo Market Hd  RT - Tattoo Header  * 
     C                     EXSR THRVGN
      * R7805 11/04/16 RMC R7805 Use new BOH Purch Type
      * Rtv BOH Reporting Dt  RT - Buy Order Header  * 
     C                     EXSR TIRVGN
      * CASE: LCL.BOH MPR Purchase Type is *ALL values
     C           YL0077    IFEQ '01'                       *IF
     C           YL0077    OREQ '02'
     C           YL0077    OREQ '03'
     C           YL0077    OREQ '04'
     C           YL0077    OREQ '05'
     C           YL0077    OREQ '06'
     C           YL0077    OREQ '07'
     C           YL0077    OREQ '08'
     C           YL0077    OREQ '09'
     C           YL0077    OREQ '10'
     C           YL0077    OREQ '11'
     C                     MOVE YL0077    WUEIA1           MPR Purchase Ty
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV MPR Prdcr Purch TpRT - MPR Producer Purch Type  * 
     C                     EXSR TJRVGN
     C                     END                             *FI
      * CASE: WRK.MPR Purchase Type is Negotiated
     C           WUEIA1    IFEQ 1                          *IF
      * Report negotiated on same day 118a is reported 5.20.19 - and not
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.BOH MPR Reporting Date EQ PAR.MPR Reporting Date
      *   |- c2    : LCL.BOH Status 2 is Not Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0075    IFEQ P6ETDT                     *IF
     C           YL0076    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  YL0074    WN0167           MPR Est Purch T
     C                     END                             *FI
     C                     ELSE
      * CASE: WRK.MPR Purchase Type is Oth Mkt Formula
     C           WUEIA1    IFEQ 2                          *IF
     C                     ADD  YL0074    WN0168           MPR Est Purch T
     C                     ELSE
      * CASE: WRK.MPR Purchase Type is Pork Mkt Formula
     C           WUEIA1    IFEQ 3                          *IF
     C                     ADD  YL0074    WN0169           MPR Est Purch T
     C                     ELSE
      * CASE: WRK.MPR Purchase Type is Oth Purchase Arng
     C           WUEIA1    IFEQ 4                          *IF
     C                     ADD  YL0074    WN0170           MPR Est Purch T
     C                     ELSE
      * CASE: WRK.MPR Purchase Type is PckSld Negotiated
     C           WUEIA1    IFEQ 5                          *IF
      * Report negotiated on same day 118a is reported 5.20.19
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.BOH MPR Reporting Date EQ PAR.MPR Reporting Date
      *   |- c2    : LCL.BOH Status 2 is Not Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0075    IFEQ P6ETDT                     *IF
     C           YL0076    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  YL0074    WN0171           MPR Est Purch T
     C                     END                             *FI
     C                     ELSE
      * CASE: WRK.MPR Purchase Type is PckSld Oth Mkt Formula
     C           WUEIA1    IFEQ 6                          *IF
     C                     ADD  YL0074    WN0172           MPR Est Purch T
     C                     ELSE
      * CASE: WRK.MPR Purchase Type is PckSld Pork Mkt Formula
     C           WUEIA1    IFEQ 7                          *IF
     C                     ADD  YL0074    WN0173           MPR Est Purch T
     C                     ELSE
      * CASE: WRK.MPR Purchase Type is PckSld Oth Purchase Arng
     C           WUEIA1    IFEQ 8                          *IF
     C                     ADD  YL0074    WN0174           MPR Est Purch T
     C                     ELSE
      * CASE: WRK.MPR Purchase Type is Other Neg Formula
     C           WUEIA1    IFEQ 10                         *IF
     C                     ADD  YL0074    WN0175           MPR Est Purch T
     C                     ELSE
      * CASE: WRK.MPR Purchase Type is PckSld Neg Formula
     C           WUEIA1    IFEQ 11                         *IF
     C                     ADD  YL0074    WN0176           MPR Est Purch T
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Rtv Crt/Chg Prior Dtl RT - MPR Prior Day Sched Dtl  * 
     C                     EXSR TKRVGN
      * ADDED 6.3.19 RMC
      * CASE: LCL.BOH Status 2 is Not Yes
     C           YL0076    IFEQ *BLANK                     *IF
      * Chg BOH MPR Est Sts   CH - Buy Order Header  * 
     C                     EXSR TNCHRC
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTG     READE@AXCPB8                  90*
     C                     ENDDO
      * USER: Exit processing
      * E00315 12/19/08 Dont report Estimated Purch for 960 purch types 1
      *   by checking Company Value MPRRPTEST
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM TCHMNB    WQ0077  30       BOH Company Num
     C                     PARM @CN,001   WQ0078 10        Company Value C
     C           YL0078    PARM *BLANK    WQ0079 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PAR.MPR Est Purch Type 1 Hd is ne Zero
     C           WN0167    IFNE 0                          *IF
      * CASE: LCL.Status 1 is Yes
     C           YL0078    IFEQ 'Y'                        *IF
      * Rtv Upd Estmtd Purch  RT - MPR Estimated Purchases  * 
     C                     EXSR TORVGN
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.MPR Est Purch Type 2 Hd is ne Zero
     C           WN0168    IFNE 0                          *IF
      * Rtv Upd Estmtd Purch  RT - MPR Estimated Purchases  * 
     C                     EXSR TRRVGN
     C                     END                             *FI
      * CASE: PAR.MPR Est Purch Type 3 Hd is ne Zero
     C           WN0169    IFNE 0                          *IF
      * Rtv Upd Estmtd Purch  RT - MPR Estimated Purchases  * 
     C                     EXSR TURVGN
     C                     END                             *FI
      * CASE: PAR.MPR Est Purch Type 4 Hd is ne Zero
     C           WN0170    IFNE 0                          *IF
      * Rtv Upd Estmtd Purch  RT - MPR Estimated Purchases  * 
     C                     EXSR TXRVGN
     C                     END                             *FI
      * CASE: PAR.MPR Est Purch Type 5 Hd is ne Zero
     C           WN0171    IFNE 0                          *IF
      * CASE: LCL.Status 1 is Yes
     C           YL0078    IFEQ 'Y'                        *IF
      * Rtv Upd Estmtd Purch  RT - MPR Estimated Purchases  * 
     C                     EXSR NARVGN
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.MPR Est Purch Type 6 Hd is ne Zero
     C           WN0172    IFNE 0                          *IF
      * Rtv Upd Estmtd Purch  RT - MPR Estimated Purchases  * 
     C                     EXSR NDRVGN
     C                     END                             *FI
      * CASE: PAR.MPR Est Purch Type 7 Hd is ne Zero
     C           WN0173    IFNE 0                          *IF
      * Rtv Upd Estmtd Purch  RT - MPR Estimated Purchases  * 
     C                     EXSR NGRVGN
     C                     END                             *FI
      * CASE: PAR.MPR Est Purch Type 8 Hd is ne Zero
     C           WN0174    IFNE 0                          *IF
      * Rtv Upd Estmtd Purch  RT - MPR Estimated Purchases  * 
     C                     EXSR NJRVGN
     C                     END                             *FI
      * CASE: PAR.MPR Est Purch Type 10 Hd is ne Zero
     C           WN0175    IFNE 0                          *IF
      * Rtv Upd Estmtd Purch  RT - MPR Estimated Purchases  * 
     C                     EXSR NMRVGN
     C                     END                             *FI
      * CASE: PAR.MPR Est Purch Type 11 Hd is ne Zero
     C           WN0176    IFNE 0                          *IF
      * Rtv Upd Estmtd Purch  RT - MPR Estimated Purchases  * 
     C                     EXSR NPRVGN
     C                     END                             *FI
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * Rtv Tattoo Market Hd  RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     YL0074           Head Total USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHHMNB    WQTH01           BOH Company Num
     C           *LIKE     DEFN WHBNNB    WQTH02           BOH Buy Order N
     C           *LIKE     DEFN WHBONB    WQTH03           BOL Load Number
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           WQTH01           BOH Company Num
     C                     KFLD           WQTH02           BOH Buy Order N
     C                     KFLD           WQTH03           BOL Load Number
      * Setup key
     C                     Z-ADDTCHMNB    WQTH01           BOH Company Num
     C                     Z-ADDTCBNNB    WQTH02           BOH Buy Order N
     C                     Z-ADDTCBONB    WQTH03           BOL Load Number
      * Establish starting position
     C           KRSTH     SETLL@A1CPC4                    *
     C           KRSTH     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.TH Hog Class Type is Market
     C           WHLLST    IFEQ 'M'                        *IF
     C                     ADD  WHCWNB    YL0074           Head Total USR
     C                     END                             *FI
     C           KRSTH     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * Rtv BOH Reporting Dt  RT - Buy Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
      * Setup key
     C                     Z-ADDTCHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDTCBNNB    WEBNNB           BOH Buy Order N
      * Establish starting position
     C           KRSTI     CHAIN@AWCPBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0049' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0075           BOH MPR Reporti
     C                     MOVEL*BLANK    YL0076           BOH MPR EST RPT
     C                     MOVEL*BLANK    YL0077           BOH MPR Purchas
     C                     GOTO TIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWED5DT    YL0075           BOH MPR Reporti
     C                     MOVELWEU0ST    YL0076           BOH MPR EST RPT
     C                     MOVELWEU1ST    YL0077           BOH MPR Purchas
     C                     ENDIF
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * RTV MPR Prdcr Purch TpRT - MPR Producer Purch Type  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGABCD    WQTJ01           PD Producer Cod
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           WQTJ01           PD Producer Cod
      * Setup key
     C                     MOVELTCABCD    WQTJ01           PD Producer Cod
      * Establish starting position
     C           KRSTJ     SETLL@E3CPF4                    *
     C           KRSTJ     READE@E3CPF4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0967' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUEIA1           MPR Purchase Ty
     C                     GOTO TJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWGC0A1    WUEIA1           MPR Purchase Ty
     C                     GOTO TJEXIT                     *QUIT
     C           KRSTJ     READE@E3CPF4                  90*
     C                     ENDDO
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKRVGN    BEGSR
      *================================================================
      * Rtv Crt/Chg Prior Dtl RT - MPR Prior Day Sched Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTK     KLIST
     C                     KFLD           TDH8CD           MPR Identificat
     C                     KFLD           TDETDT           MPR Reporting D
     C                     KFLD           TDC2A1           MPR Reporting T
     C                     KFLD           TDCQDT           BOL Kill Date
     C                     KFLD           TDBNNB           BOH Buy Order N
     C                     KFLD           TDBONB           BOL Load Number
     C                     KFLD           TDABCD           PD Producer Cod
     C                     KFLD           TDAECD           PL Location Cod
      * Setup key
     C                     MOVELP5H8CD    TDH8CD           MPR Identificat
     C                     Z-ADDP6ETDT    TDETDT           MPR Reporting D
     C                     Z-ADD1         TDC2A1           MPR Reporting T
     C                     Z-ADDTCCQDT    TDCQDT           BOL Kill Date
     C                     Z-ADDTCBNNB    TDBNNB           BOH Buy Order N
     C                     Z-ADDTCBONB    TDBONB           BOL Load Number
     C                     MOVELTCABCD    TDABCD           PD Producer Cod
     C                     MOVELTCAECD    TDAECD           PL Location Cod
      * Establish starting position
     C           KRSTK     CHAIN@FHCPHN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1008' W0RTN   7
      * USER: Processing if Data record not found
      * Crt MPR Prior Day Sch CR - MPR Prior Day Sched Dtl  * 
     C                     EXSR TLCRRC
     C                     GOTO TKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Change MPR Prior Day Sche - MPR Prior Day Sched Dtl  * 
     C                     EXSR TMCHRC
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLCRRC    BEGSR
      *================================================================
      * Crt MPR Prior Day Sch CR - MPR Prior Day Sched Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FHCPHM
     C                     MOVELP5H8CD    TEH8CD           MPR Identificat
     C                     Z-ADDP6ETDT    TEETDT           MPR Reporting D
     C                     Z-ADD1         TEC2A1           MPR Reporting T
     C                     Z-ADDTCCQDT    TECQDT           BOL Kill Date
     C                     Z-ADDTCBNNB    TEBNNB           BOH Buy Order N
     C                     Z-ADDTCBONB    TEBONB           BOL Load Number
     C                     MOVELTCABCD    TEABCD           PD Producer Cod
     C                     MOVELTCAECD    TEAECD           PL Location Cod
     C                     Z-ADDYL0074    TEBPNB           BOL Pln Head De
     C                     MOVEL*BLANK    TEAAVN           RS User Changed
     C                     Z-ADD*ZERO     TEAADT           RS Date Changed
     C                     Z-ADD*ZERO     TEAMTM           RS Time Changed
     C                     MOVEL'A'       TEAJST           RS Record Statu
     C                     MOVEL*BLANK    TEAHVN           RS Job
     C                     MOVEL*BLANK    TEAGVN           RS Program
     C                     MOVEL*BLANK    TEABVN           RS User Added
     C                     Z-ADD*ZERO     TEABDT           RS Date Added
     C                     Z-ADD*ZERO     TEABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       TEAJST           RS Record Statu
     C                     MOVEL##USR     TEABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           TEABDT    PARM *ZERO     WQ0073  70       *DATE
     C           TEABTM    PARM *ZERO     WQ0074  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     TEAGVN           RS Program
     C                     MOVEL##JOB     TEAHVN           RS Job
     C           KLCRTL    KLIST
     C                     KFLD           TEH8CD           MPR Identificat
     C                     KFLD           TEETDT           MPR Reporting D
     C                     KFLD           TEC2A1           MPR Reporting T
     C                     KFLD           TECQDT           BOL Kill Date
     C                     KFLD           TEBNNB           BOH Buy Order N
     C                     KFLD           TEBONB           BOL Load Number
     C                     KFLD           TEABCD           PD Producer Cod
     C                     KFLD           TEAECD           PL Location Cod
      * Check for duplicate primary key
     C           KLCRTL    SETLL@FHCPHM                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1009' W0RTN   7
      * Send message 'MPR Prior Day Sched Dt EX'
     C                     MOVEL'PRK1009' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TLEXIT
     C                     ENDIF
      *
     C                     WRITE@FHCPHM                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMCHRC    BEGSR
      *================================================================
      * Change MPR Prior Day Sche - MPR Prior Day Sched Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @FHCPHM
     C                     MOVELTDH8CD    TEH8CD    P      MPR Identificat
     C                     Z-ADDTDETDT    TEETDT           MPR Reporting D
     C                     Z-ADDTDC2A1    TEC2A1           MPR Reporting T
     C                     Z-ADDTDCQDT    TECQDT           BOL Kill Date
     C                     Z-ADDTDBNNB    TEBNNB           BOH Buy Order N
     C                     Z-ADDTDBONB    TEBONB           BOL Load Number
     C                     MOVELTDABCD    TEABCD    P      PD Producer Cod
     C                     MOVELTDAECD    TEAECD    P      PL Location Cod
      *
     C           KLCHTM    KLIST
     C                     KFLD           TEH8CD           MPR Identificat
     C                     KFLD           TEETDT           MPR Reporting D
     C                     KFLD           TEC2A1           MPR Reporting T
     C                     KFLD           TECQDT           BOL Kill Date
     C                     KFLD           TEBNNB           BOH Buy Order N
     C                     KFLD           TEBONB           BOL Load Number
     C                     KFLD           TEABCD           PD Producer Cod
     C                     KFLD           TEAECD           PL Location Cod
     C           KLCHTM    CHAIN@FHCPHM              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFHCPL0'MDACP
     C                     MOVEL'@FHCPHM' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TMEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TMEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFH1    YERDCS
      * Move non-key fields to @FHCPHM
     C                     Z-ADDYL0074    TEBPNB           BOL Pln Head De
     C                     MOVEL*BLANK    TEAAVN    P      RS User Changed
     C                     Z-ADD*ZERO     TEAADT           RS Date Changed
     C                     Z-ADD*ZERO     TEAMTM           RS Time Changed
     C                     MOVEL'A'       TEAJST    P      RS Record Statu
     C                     MOVEL*BLANK    TEAHVN    P      RS Job
     C                     MOVEL*BLANK    TEAGVN    P      RS Program
     C                     MOVEL*BLANK    TEABVN    P      RS User Added
     C                     Z-ADD*ZERO     TEABDT           RS Date Added
     C                     Z-ADD*ZERO     TEABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFH1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp-SysDtIF
     C                     MOVEL##USR     TEAAVN           RS User Changed
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           TEAADT    PARM *ZERO     WQ0075  70       *DATE
     C           TEAMTM    PARM *ZERO     WQ0076  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##JOB     TEAHVN           RS Job
     C                     MOVEL##PGM     TEAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKFH1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@FHCPHM                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFHCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNCHRC    BEGSR
      *================================================================
      * Chg BOH MPR Est Sts   CH - Buy Order Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0177  70       BOH Buy Order D
     C                     Z-ADD*ZERO     WN0178  70       BOH Kill Date
     C                     MOVEL*BLANK    WN0179  1        BOH Payment Typ
     C                     MOVEL*BLANK    WN0180  1        BOH Buy Order T
     C                     Z-ADD*ZERO     WN0181  52       BOH Market Add/
     C                     MOVEL*BLANK    WN0182  1        BOH Status
     C                     MOVEL*BLANK    WN0183  1        BOH Delv Plan P
     C                     MOVEL*BLANK    WN0184  2        BOH Quote Price
     C                     Z-ADD*ZERO     WN0185  52       BOH Quoted Base
     C                     MOVEL*BLANK    WN0186  3        BOH Commodity M
     C                     MOVEL*BLANK    WN0187  7        BOH Commodity P
     C                     MOVEL*BLANK    WN0188  3        BOH Market Date
     C                     Z-ADD*ZERO     WN0189  70       BOH MPR Reporti
     C                     Z-ADD*ZERO     WN0190  70       BOH Hedge Date
     C                     Z-ADD*ZERO     WN0191  70       BOH Unused Date
     C                     Z-ADD*ZERO     WN0192  70       BOH Unused Date
     C                     Z-ADD*ZERO     WN0193  70       BOH Unused Date
     C                     Z-ADD*ZERO     WN0194  70       BOH Hedge Head
     C                     Z-ADD*ZERO     WN0195  70       BOH Hedge Refer
     C                     Z-ADD*ZERO     WN0196  70       BOH Hedge Time
     C                     Z-ADD*ZERO     WN0197  90       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0198  90       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0199  91       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0200  91       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0201 112       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0202 112       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0203 112       BOH Unused Nbr
     C                     MOVEL*BLANK    WN0204  1        BOH MPR Reporti
     C                     MOVEL*BLANK    WN0205  2        BOH MPR Purchas
     C                     MOVEL*BLANK    WN0206  3        BOH Status 4
     C                     MOVEL*BLANK    WN0207  3        BOH Status 5
     C                     Z-ADD*ZERO     WN0208  30       PPWS Company Nu
     C                     Z-ADD*ZERO     WN0209  40       CW Year
     C                     Z-ADD*ZERO     WN0210  20       CW Week Number
     C                     MOVEL*BLANK    WN0211  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0212  6        PL Location Cod
     C                     MOVEL*BLANK    WN0213  5        PC Contract Cod
     C                     MOVEL*BLANK    WN0214  5        PSC Sub-Contrac
     C                     MOVEL*BLANK    WN0215  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0216  3        PO Option Code
     C                     MOVEL*BLANK    WN0217  3        CMP Program Cod
     C                     MOVEL*BLANK    WN0218  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0219 10        RS User Changed
     C                     Z-ADD*ZERO     WN0220  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0221  60       RS Time Changed
     C                     MOVEL*BLANK    WN0222  1        RS Record Statu
     C                     MOVEL*BLANK    WN0223 10        RS Job
     C                     MOVEL*BLANK    WN0224 10        RS Program
     C                     MOVEL*BLANK    WN0225 10        RS User Added
     C                     Z-ADD*ZERO     WN0226  70       RS Date Added
     C                     Z-ADD*ZERO     WN0227  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @AWCPAZ
     C                     Z-ADDTCHMNB    TBHMNB           BOH Company Num
     C                     Z-ADDTCBNNB    TBBNNB           BOH Buy Order N
      *
     C           KLCHTN    KLIST
     C                     KFLD           TBHMNB           BOH Company Num
     C                     KFLD           TBBNNB           BOH Buy Order N
     C           KLCHTN    CHAIN@AWCPAZ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKAWCPL0'MDACP
     C                     MOVEL'@AWCPAZ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TNEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKAW1    YFRDCS
      * Move non-key fields to @AWCPAZ
     C                     MOVEL'Y'       TBU0ST    P      BOH MPR EST RPT
      *
      * Set PGM.*Record Data Changed flag
     C           QPKAW1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     TBAAVN           RS User Changed
     C                     Z-ADD##JDT     TBAADT           RS Date Changed
     C                     Z-ADD##JTM     TBAMTM           RS Time Changed
     C                     MOVEL##JOB     TBAHVN           RS Job
     C                     MOVEL##PGM     TBAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKAW1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@AWCPAZ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKAWCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TORVGN    BEGSR
      *================================================================
      * Rtv Upd Estmtd Purch  RT - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTO     KLIST
     C                     KFLD           WBHONB           CC Company Numb
     C                     KFLD           WBETDT           MPR Reporting D
     C                     KFLD           WBC0A1           MPR Purchase Ty
      * Setup key
     C                     Z-ADDTCHMNB    WBHONB           CC Company Numb
     C                     Z-ADDP6ETDT    WBETDT           MPR Reporting D
     C                     Z-ADD1         WBC0A1           MPR Purchase Ty
      * Establish starting position
     C           KRSTO     CHAIN@E4CPF7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0969' W0RTN   7
      * USER: Processing if Data record not found
      * Crt MPR Estmtd Purch  CR - MPR Estimated Purchases  * 
     C                     EXSR TPCRRC
     C                     GOTO TOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WBC1A1    ADD  WN0167    YL0079           MPR Estimated H
      * Chg MPR Estmtd Purch  CH - MPR Estimated Purchases  * 
     C                     EXSR TQCHRC
     C                     ENDIF
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPCRRC    BEGSR
      *================================================================
      * Crt MPR Estmtd Purch  CR - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @E4CPF6
     C                     Z-ADDTCHMNB    WCHONB           CC Company Numb
     C                     Z-ADDP6ETDT    WCETDT           MPR Reporting D
     C                     Z-ADD1         WCC0A1           MPR Purchase Ty
     C                     Z-ADDWN0167    WCC1A1           MPR Estimated H
     C                     MOVEL*BLANK    WCAAVN           RS User Changed
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     MOVELWUAJST    WCAJST           RS Record Statu
     C                     MOVEL*BLANK    WCAHVN           RS Job
     C                     MOVEL*BLANK    WCAGVN           RS Program
     C                     MOVEL*BLANK    WCABVN           RS User Added
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WCAJST           RS Record Statu
     C                     MOVEL##USR     WCABVN           RS User Added
     C                     Z-ADD##JDT     WCABDT           RS Date Added
     C                     Z-ADD##JTM     WCABTM           RS Time Added
     C                     MOVEL##PGM     WCAGVN           RS Program
     C                     MOVEL##JOB     WCAHVN           RS Job
     C           KLCRTP    KLIST
     C                     KFLD           WCHONB           CC Company Numb
     C                     KFLD           WCETDT           MPR Reporting D
     C                     KFLD           WCC0A1           MPR Purchase Ty
      * Check for duplicate primary key
     C           KLCRTP    SETLL@E4CPF6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0970' W0RTN   7
      * Send message 'MPR Estimated Purchase EX'
     C                     MOVEL'PRK0970' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TPEXIT
     C                     ENDIF
      *
     C                     WRITE@E4CPF6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQCHRC    BEGSR
      *================================================================
      * Chg MPR Estmtd Purch  CH - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YGRDC   1
      *
      * Move key fields to @E4CPF6
     C                     Z-ADDWBHONB    WCHONB           CC Company Numb
     C                     Z-ADDWBETDT    WCETDT           MPR Reporting D
     C                     Z-ADDWBC0A1    WCC0A1           MPR Purchase Ty
      *
     C           KLCHTQ    KLIST
     C                     KFLD           WCHONB           CC Company Numb
     C                     KFLD           WCETDT           MPR Reporting D
     C                     KFLD           WCC0A1           MPR Purchase Ty
     C           KLCHTQ    CHAIN@E4CPF6              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKE4CPL0'MDACP
     C                     MOVEL'@E4CPF6' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL008.
     C                     MOVEL'LBL008'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TQEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKE41    YGRDCS
      * Move non-key fields to @E4CPF6
     C                     Z-ADDYL0079    WCC1A1           MPR Estimated H
     C                     MOVEL*BLANK    WCAAVN    P      RS User Changed
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     MOVELWUAJST    WCAJST    P      RS Record Statu
     C                     MOVEL*BLANK    WCAHVN    P      RS Job
     C                     MOVEL*BLANK    WCAGVN    P      RS Program
     C                     MOVEL*BLANK    WCABVN    P      RS User Added
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKE41    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKE41    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YGRDC     IFEQ 'Y'
     C                     UPDAT@E4CPF6                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKE4CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRRVGN    BEGSR
      *================================================================
      * Rtv Upd Estmtd Purch  RT - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTR     KLIST
     C                     KFLD           WBHONB           CC Company Numb
     C                     KFLD           WBETDT           MPR Reporting D
     C                     KFLD           WBC0A1           MPR Purchase Ty
      * Setup key
     C                     Z-ADDTCHMNB    WBHONB           CC Company Numb
     C                     Z-ADDP6ETDT    WBETDT           MPR Reporting D
     C                     Z-ADD2         WBC0A1           MPR Purchase Ty
      * Establish starting position
     C           KRSTR     CHAIN@E4CPF7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0969' W0RTN   7
      * USER: Processing if Data record not found
      * Crt MPR Estmtd Purch  CR - MPR Estimated Purchases  * 
     C                     EXSR TSCRRC
     C                     GOTO TREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WBC1A1    ADD  WN0168    YL0079           MPR Estimated H
      * Chg MPR Estmtd Purch  CH - MPR Estimated Purchases  * 
     C                     EXSR TTCHRC
     C                     ENDIF
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         TSCRRC    BEGSR
      *================================================================
      * Crt MPR Estmtd Purch  CR - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @E4CPF6
     C                     Z-ADDTCHMNB    WCHONB           CC Company Numb
     C                     Z-ADDP6ETDT    WCETDT           MPR Reporting D
     C                     Z-ADD2         WCC0A1           MPR Purchase Ty
     C                     Z-ADDWN0168    WCC1A1           MPR Estimated H
     C                     MOVEL*BLANK    WCAAVN           RS User Changed
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     MOVELWUAJST    WCAJST           RS Record Statu
     C                     MOVEL*BLANK    WCAHVN           RS Job
     C                     MOVEL*BLANK    WCAGVN           RS Program
     C                     MOVEL*BLANK    WCABVN           RS User Added
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WCAJST           RS Record Statu
     C                     MOVEL##USR     WCABVN           RS User Added
     C                     Z-ADD##JDT     WCABDT           RS Date Added
     C                     Z-ADD##JTM     WCABTM           RS Time Added
     C                     MOVEL##PGM     WCAGVN           RS Program
     C                     MOVEL##JOB     WCAHVN           RS Job
     C           KLCRTS    KLIST
     C                     KFLD           WCHONB           CC Company Numb
     C                     KFLD           WCETDT           MPR Reporting D
     C                     KFLD           WCC0A1           MPR Purchase Ty
      * Check for duplicate primary key
     C           KLCRTS    SETLL@E4CPF6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0970' W0RTN   7
      * Send message 'MPR Estimated Purchase EX'
     C                     MOVEL'PRK0970' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TSEXIT
     C                     ENDIF
      *
     C                     WRITE@E4CPF6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TSEXIT    ENDSR
      /EJECT
     CSR         TTCHRC    BEGSR
      *================================================================
      * Chg MPR Estmtd Purch  CH - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YHRDC   1
      *
      * Move key fields to @E4CPF6
     C                     Z-ADDWBHONB    WCHONB           CC Company Numb
     C                     Z-ADDWBETDT    WCETDT           MPR Reporting D
     C                     Z-ADDWBC0A1    WCC0A1           MPR Purchase Ty
      *
     C           KLCHTT    KLIST
     C                     KFLD           WCHONB           CC Company Numb
     C                     KFLD           WCETDT           MPR Reporting D
     C                     KFLD           WCC0A1           MPR Purchase Ty
     C           KLCHTT    CHAIN@E4CPF6              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKE4CPL0'MDACP
     C                     MOVEL'@E4CPF6' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL009.
     C                     MOVEL'LBL009'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TTEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TTEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKE41    YHRDCS
      * Move non-key fields to @E4CPF6
     C                     Z-ADDYL0079    WCC1A1           MPR Estimated H
     C                     MOVEL*BLANK    WCAAVN    P      RS User Changed
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     MOVELWUAJST    WCAJST    P      RS Record Statu
     C                     MOVEL*BLANK    WCAHVN    P      RS Job
     C                     MOVEL*BLANK    WCAGVN    P      RS Program
     C                     MOVEL*BLANK    WCABVN    P      RS User Added
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKE41    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKE41    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YHRDC     IFEQ 'Y'
     C                     UPDAT@E4CPF6                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKE4CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TTEXIT    ENDSR
      /EJECT
     CSR         TURVGN    BEGSR
      *================================================================
      * Rtv Upd Estmtd Purch  RT - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTU     KLIST
     C                     KFLD           WBHONB           CC Company Numb
     C                     KFLD           WBETDT           MPR Reporting D
     C                     KFLD           WBC0A1           MPR Purchase Ty
      * Setup key
     C                     Z-ADDTCHMNB    WBHONB           CC Company Numb
     C                     Z-ADDP6ETDT    WBETDT           MPR Reporting D
     C                     Z-ADD3         WBC0A1           MPR Purchase Ty
      * Establish starting position
     C           KRSTU     CHAIN@E4CPF7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0969' W0RTN   7
      * USER: Processing if Data record not found
      * Crt MPR Estmtd Purch  CR - MPR Estimated Purchases  * 
     C                     EXSR TVCRRC
     C                     GOTO TUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WBC1A1    ADD  WN0169    YL0079           MPR Estimated H
      * Chg MPR Estmtd Purch  CH - MPR Estimated Purchases  * 
     C                     EXSR TWCHRC
     C                     ENDIF
      *================================================================
     CSR         TUEXIT    ENDSR
      /EJECT
     CSR         TVCRRC    BEGSR
      *================================================================
      * Crt MPR Estmtd Purch  CR - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @E4CPF6
     C                     Z-ADDTCHMNB    WCHONB           CC Company Numb
     C                     Z-ADDP6ETDT    WCETDT           MPR Reporting D
     C                     Z-ADD3         WCC0A1           MPR Purchase Ty
     C                     Z-ADDWN0169    WCC1A1           MPR Estimated H
     C                     MOVEL*BLANK    WCAAVN           RS User Changed
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     MOVELWUAJST    WCAJST           RS Record Statu
     C                     MOVEL*BLANK    WCAHVN           RS Job
     C                     MOVEL*BLANK    WCAGVN           RS Program
     C                     MOVEL*BLANK    WCABVN           RS User Added
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WCAJST           RS Record Statu
     C                     MOVEL##USR     WCABVN           RS User Added
     C                     Z-ADD##JDT     WCABDT           RS Date Added
     C                     Z-ADD##JTM     WCABTM           RS Time Added
     C                     MOVEL##PGM     WCAGVN           RS Program
     C                     MOVEL##JOB     WCAHVN           RS Job
     C           KLCRTV    KLIST
     C                     KFLD           WCHONB           CC Company Numb
     C                     KFLD           WCETDT           MPR Reporting D
     C                     KFLD           WCC0A1           MPR Purchase Ty
      * Check for duplicate primary key
     C           KLCRTV    SETLL@E4CPF6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0970' W0RTN   7
      * Send message 'MPR Estimated Purchase EX'
     C                     MOVEL'PRK0970' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TVEXIT
     C                     ENDIF
      *
     C                     WRITE@E4CPF6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TVEXIT    ENDSR
      /EJECT
     CSR         TWCHRC    BEGSR
      *================================================================
      * Chg MPR Estmtd Purch  CH - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YIRDC   1
      *
      * Move key fields to @E4CPF6
     C                     Z-ADDWBHONB    WCHONB           CC Company Numb
     C                     Z-ADDWBETDT    WCETDT           MPR Reporting D
     C                     Z-ADDWBC0A1    WCC0A1           MPR Purchase Ty
      *
     C           KLCHTW    KLIST
     C                     KFLD           WCHONB           CC Company Numb
     C                     KFLD           WCETDT           MPR Reporting D
     C                     KFLD           WCC0A1           MPR Purchase Ty
     C           KLCHTW    CHAIN@E4CPF6              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKE4CPL0'MDACP
     C                     MOVEL'@E4CPF6' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL010.
     C                     MOVEL'LBL010'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TWEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TWEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKE41    YIRDCS
      * Move non-key fields to @E4CPF6
     C                     Z-ADDYL0079    WCC1A1           MPR Estimated H
     C                     MOVEL*BLANK    WCAAVN    P      RS User Changed
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     MOVELWUAJST    WCAJST    P      RS Record Statu
     C                     MOVEL*BLANK    WCAHVN    P      RS Job
     C                     MOVEL*BLANK    WCAGVN    P      RS Program
     C                     MOVEL*BLANK    WCABVN    P      RS User Added
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKE41    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKE41    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YIRDC     IFEQ 'Y'
     C                     UPDAT@E4CPF6                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKE4CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TWEXIT    ENDSR
      /EJECT
     CSR         TXRVGN    BEGSR
      *================================================================
      * Rtv Upd Estmtd Purch  RT - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTX     KLIST
     C                     KFLD           WBHONB           CC Company Numb
     C                     KFLD           WBETDT           MPR Reporting D
     C                     KFLD           WBC0A1           MPR Purchase Ty
      * Setup key
     C                     Z-ADDTCHMNB    WBHONB           CC Company Numb
     C                     Z-ADDP6ETDT    WBETDT           MPR Reporting D
     C                     Z-ADD4         WBC0A1           MPR Purchase Ty
      * Establish starting position
     C           KRSTX     CHAIN@E4CPF7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0969' W0RTN   7
      * USER: Processing if Data record not found
      * Crt MPR Estmtd Purch  CR - MPR Estimated Purchases  * 
     C                     EXSR TYCRRC
     C                     GOTO TXEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WBC1A1    ADD  WN0170    YL0079           MPR Estimated H
      * Chg MPR Estmtd Purch  CH - MPR Estimated Purchases  * 
     C                     EXSR TZCHRC
     C                     ENDIF
      *================================================================
     CSR         TXEXIT    ENDSR
      /EJECT
     CSR         TYCRRC    BEGSR
      *================================================================
      * Crt MPR Estmtd Purch  CR - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @E4CPF6
     C                     Z-ADDTCHMNB    WCHONB           CC Company Numb
     C                     Z-ADDP6ETDT    WCETDT           MPR Reporting D
     C                     Z-ADD4         WCC0A1           MPR Purchase Ty
     C                     Z-ADDWN0170    WCC1A1           MPR Estimated H
     C                     MOVEL*BLANK    WCAAVN           RS User Changed
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     MOVELWUAJST    WCAJST           RS Record Statu
     C                     MOVEL*BLANK    WCAHVN           RS Job
     C                     MOVEL*BLANK    WCAGVN           RS Program
     C                     MOVEL*BLANK    WCABVN           RS User Added
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WCAJST           RS Record Statu
     C                     MOVEL##USR     WCABVN           RS User Added
     C                     Z-ADD##JDT     WCABDT           RS Date Added
     C                     Z-ADD##JTM     WCABTM           RS Time Added
     C                     MOVEL##PGM     WCAGVN           RS Program
     C                     MOVEL##JOB     WCAHVN           RS Job
     C           KLCRTY    KLIST
     C                     KFLD           WCHONB           CC Company Numb
     C                     KFLD           WCETDT           MPR Reporting D
     C                     KFLD           WCC0A1           MPR Purchase Ty
      * Check for duplicate primary key
     C           KLCRTY    SETLL@E4CPF6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0970' W0RTN   7
      * Send message 'MPR Estimated Purchase EX'
     C                     MOVEL'PRK0970' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TYEXIT
     C                     ENDIF
      *
     C                     WRITE@E4CPF6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TYEXIT    ENDSR
      /EJECT
     CSR         TZCHRC    BEGSR
      *================================================================
      * Chg MPR Estmtd Purch  CH - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YJRDC   1
      *
      * Move key fields to @E4CPF6
     C                     Z-ADDWBHONB    WCHONB           CC Company Numb
     C                     Z-ADDWBETDT    WCETDT           MPR Reporting D
     C                     Z-ADDWBC0A1    WCC0A1           MPR Purchase Ty
      *
     C           KLCHTZ    KLIST
     C                     KFLD           WCHONB           CC Company Numb
     C                     KFLD           WCETDT           MPR Reporting D
     C                     KFLD           WCC0A1           MPR Purchase Ty
     C           KLCHTZ    CHAIN@E4CPF6              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKE4CPL0'MDACP
     C                     MOVEL'@E4CPF6' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL011.
     C                     MOVEL'LBL011'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TZEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TZEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKE41    YJRDCS
      * Move non-key fields to @E4CPF6
     C                     Z-ADDYL0079    WCC1A1           MPR Estimated H
     C                     MOVEL*BLANK    WCAAVN    P      RS User Changed
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     MOVELWUAJST    WCAJST    P      RS Record Statu
     C                     MOVEL*BLANK    WCAHVN    P      RS Job
     C                     MOVEL*BLANK    WCAGVN    P      RS Program
     C                     MOVEL*BLANK    WCABVN    P      RS User Added
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKE41    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKE41    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YJRDC     IFEQ 'Y'
     C                     UPDAT@E4CPF6                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKE4CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TZEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * 11/02/2020 ISE H16853 - CHANGE BUY ORDER NUMBER FIELD LENGTH FROM
      * WHD 69081 09/17/2020 RMC if sort loss > 0, make it .00 ..cant hav
      *   on LS118B (came about from new prestige contract)
      * T15265 RMC 07/29/19 Get last reported date from MPR control -- wi
      *   adjust if job is reran - per plant. file is updated after all k
      *   dates are processed after the Loop
      * S15008 RMC 05/20/19 Estimated - Report as EST for type 1,5 if rpt
      *   matches BOH rpt date.  if not type 1,5 do as normal
      * S13526 RMC 10/16/18 LS118C-if prod doesnt have site, use state fr
      * S13526 RMC 9.07.18 LS118C-if prod has a site, use state from site
      *         for origin -- on a company value    MPRORGST
      * R12679 RMC 3.02.18 LS118C-dont report packer owned (9) until they
      *   priced..which is the day after kill most likely. they were gett
      *   reported the morning after entry into the system  (per Guy, Dav
      * R11747 RMC 9.25.17 Dont report Avg Live Weight for STF - Per Guy/
      * S11374 RMC 07/31/17 - do the below if it hasnt been reported yet
      * R7841 RMC 11/10/16 - When BOH writes to ls118C, then update it wi
      *   reporting date and time '1' so it will report on the LS119A,B
      *   Move upd Estimated head PKE4CPP into the Repeat While Kill date
      *    to report each BO for the kill dates to be processed.
      *   Needs to be include/rpt for BO that will be priced between 1:30
      * R7307 RMC 09/23/16 - New purchase types- affect ls118C Ownerhip d
      * E3814 JJH 10/07/15 - Recompile because PS Premises ID added to
      *   Producer Site. - No logic changes.
      * E3577 11/6/14 RMC  For BO created from Hedged BO, force type to 2
      *   in Slaughter; for Hedged BOH (with no BOL) force Purch type to
      *   in prior day purch LS118C
      * 4/16/01  Process kill dates until the Reporting date is reached,
      *          not the Curr Paym Date.
      * 4/19/01  Create Estimated Purchases for LS119A Dly Purch Summary
      * 8/16/02  Create new file with Prior day Sched Dtl  - PKFHCPP
      * 12/09/02  Bld Prior Day Sched with BOL access path keyed on Delv
      *           instead of Kill date.        (LS118A)
      *   On Build Estimated Fields for LS119A, create Detail rcd with rp
      * 02/26/04 RMC Prior Day Purch: MPR Head = SUM(TH Hd Rcvd for QM ho
      *              instead of the BOL Head Received.     (LS118C)
      * 01/04/06  Bld Prior Day Purch 118C - check base price >0, not jus
      * 01/04/06  Use co from input parm.
      * 04/24/06 RMC Prior Day Purch: If Prod Purch Type=Packer Owned 9
      *          or Internal, output ls118c (pke7cpp) with -0- base price
      * 04/24/07 RMC Prior Day Purch: Dont chg Purch Type to 1=Negotiated
      * 06/16/08 RMC Prior Day Purch: Output State in MPR Origin field
      * 12/19/08 RMC E00315 for 960  Estimated Purch: dont report purch t
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * DOC:  Slaughter Swine  LS118B
      *================================================================
      * Process the Tattoo Header for each Kill Date between the
      * Last Kill Date Reported and the Current Payment Date.
      * 1)  Both Internal and External Producers are processed.
      * 2)  Do not process Resale Tattoo's.
      * 3)  Only process Hold Over Tattoo's when they are completed.
      *     When processing the Tattoo with Held Over Status = Y,
      *     combine both Kill Date for creating one record.
      * 4)  On Monday, create the data for both Friday and Saturday, if
      *     killed on Saturday.
      * 3/29/01 Prior Day Slg -- If Live Wgt is 0, then output NULL
      *         If Purch Type is 9, output NULL slg base price, slg avg n
      *          slg low net price, slg high net price, slg avg sort loss
      *   (these correlate to item nbrs 15,16,17,18,21)
      * Lot Identification:   Tattoo Number. As of 02/26/04 = TattooLoad
      * Class Code        :   The Class Code will = 1 (Barrows/Gilts)
      * Purchase Type Code:   The Purchase Type Code is identified for
      *                       the producer in the Producer file.
      * Head Count        :   TH Head Killed
      * Base Price        :   TH CM Bse Mkt Carc /CWT.  If the Source
      *                       is Internal, this value will be 0.
      * Average Net Price :   TH Payment Gross plus Additional Expense
      *                       incured by Seaboard.  Divide the total by
      *                       Hot Weight divided by 100.
      * Lowest Net Price  :   This value will be 0.
      * Highest Net Price :   This value will be 0.
      * Avg Live Weight   :   TH Avg Live Wgt.  If the Payment Type
      *                       is Carcass Merit, this value will be 0.
      * Avg Carcass Weight:   TH Avg Hot Wgt.  If the Payment Type
      *                       is Live, this value will be 0.
      * Average Sort Loss :   This value will be 0.
      * Avg Backfat-Inches:   TH Avg Backfat
      * Avg LoinEye-Inches:   TH Avg Loin Eye Depth
      * Avg Lean Percent  :   TH Avg Lean Percent
      * 5/27/03  Avg Sort Loss calc depends on the CMP Grading Type
      * 9/17/2020 sort loss cant be > 00 .. so make it .00 if >0
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Modification History Created Str slm 061208
      *================================================================
      * 9/24/02 RMC Calc 2 dec backfat and loin eye
      * 050108 slm e00216 need additional fields on ho for meat
      * 061208 SLM E00144 LFT Head and Uat/Koa Head
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * DOC:  Purchased Swine    LS118C
      *================================================================
      * Process the Buy Order Header with Buy Order Date equal to the
      * Kill Date being reported/processed.
      * 1)  Only process Buy Orders for External Producers.
      * 2)  For each Buy Order selected, the Buy Order Load is processed
      *     for creating a record in the MPR Prior Day Purchased file.
      * 3)  If the Base Price for the Load = Zero, then do not create a
      *     record in the MPR Prior Day Purchased file.
      * Lot Identification:   Concatenate Buy Order Num & Load Num
      * Ownership Code    :   The Ownership Code is based on the Purchase
      *                       Type Code identified for the Producer.
      *                       If Purchase Type Code = 1, 2, 3, 4
      *                            Ownership Code = 3
      *                       If Purchase Type Code = 5, 6, 7, 8
      *                            Ownership Code = 2
      *                       If Purchase Type Code = 9
      *                            Ownership Code = 1
      * Class Code        :   The Class Code will = 1 (Barrows/Gilts)
      * Purchase Type Code:   The Purchase Type Code is identified for
      *                       the producer in the Producer file.
      * Head Count        :   The Head Count is the Planned Delivery Head
      *                       for the Buy Order Load.
      * Avg Live Weight   :   The Average Live Weight will be Zero for
      *                       all loads processed.  We have not received
      *                       these loads yet.  Also, the Average Live
      *                       Weight only needs reporting, if the Payment
      *                       Type is Live.  If the Payment Type is
      *                       Carcass Merit, then the Average Live Weight
      *                       will be zero.
      * Base Price ($/CWT):   The Base Price will be Zero for all loads
      *                       processed.  We do not know the Base Price
      *                       until the Market Prices have been entered
      *                       into the system.
      * *------------------------------------------------------------*
      * 01/18/01 PKD
      * - Currently, for all of our purchases for the future, we do not
      *   know the Base Price.
      * - One record in the MPR Prior Day Purchased file will be created
      *   with zeros and blanks for sending to the USDA.
      * 03/29/01 RMC
      * - Do not send a blank record.
      * 04/17/01 RMC
      *   Report Purchases when we have the price, which is actually afte
      *   slaughtered.  Read the BO Hdr by Kill Date, and get the Base pr
      *   which includes the (Cutout * 88.7%) +- overage/underage.
      *  For example, hog slaughtered 4/17/01, are reported on 4/18
      *   as Prior Day Purchased.
      * 08/22/01 PKD T568
      *   Changed the Rtv for procesing the Buy Order Header to Position
      *   on the Kill Date instead of restrict.  This will process all
      *   Buy Order that have been created for future Kill Dates.  If
      *   a Buy Order Quote was entered, then the purchase would be
      *   reported the day after the Buy Order is created.  For Buy Order
      *   with Market Date Method of Day Prior Delivery, the purchase
      *   will be reported the day the hogs are killed instead of after
      *   hogs have been killed.
      * - Once the purchase has been reported, the BOL MPR Prior Day Purc
      *   field is changed to Y, so it does not get reported again.
      * *------------------------------------------------------------*
      * 10/09/01 RMC  If Rerun, the LS118 records have already been creat
      *  and the BOL have been flagged as prior-day-purch-reported = Y, s
      *   if no records were created on this run, check for records alrea
      *   existing in the file for this date, and change the Record Added
      *   to = Y so the records will be sent to the USDA in the CL.
      * *------------------------------------------------------------*
      * 9/20/02  Prior Day Purch from the BOL -- use BOL Head Received
      *   if > 0, else use the Plan Head Delv(which is what it did alread
      * *------------------------------------------------------------*
      * 02/26/04 RMC Prior Day Purch: MPR Head = SUM(TH Hd Rcvd for QM ho
      *              instead of the BOL Head Received.
      * *------------------------------------------------------------*
      * 01/04/06 RMC Prior Day Purch: check base price>0, not just n=0
      *              instead of the BOL Head Received.
      * *------------------------------------------------------------*
      * 04/24/06 RMC Prior Day Purch: If Prod Purch Type=Packer Owned 9
      *          or Internal, output ls118c (pke7cpp) with -0- base price
      *          If packer owned make ownership=1 when creating pke7cpp,
      *          Check price > 0 or Ownership=1 when creating pke7cpp
      *          because Ownership=1 its packer owned and price is -0-
      * *------------------------------------------------------------*
      * 11/24/06 RMC Prior Day Purch: If Prod Purch Type=Packer Sold =5,6
      *          Dont make ownership=1 when theres a quoted base price.
      *   Reported to us by Brad K and Mike Lynch - USDA
      * *------------------------------------------------------------*
      * 04/24/07 RMC Prior Day Purch: Dont chg purch type to 1 EVER.
      *   Reported to us by Jerry L and Mike Lynch - USDA
      * *------------------------------------------------------------*
      * 11/05/14 RMC E3577 Prior Day Purch: Hedge BO wont have a BOL, so
      *   from the BOH, using the BOH Hedge Head as the head, force purch
      *    type to 2
      * *------------------------------------------------------------*
      * 11/01/17 RMC S11998 Prior Day Purch: cant calc price for PPI unti
      *   date >= job date. its a day prior method
      * *------------------------------------------------------------*
      * R12679 RMC 3.02.18 LS118C-dont report packer owned (9) until they
      *   priced..which is the day after kill most likely. they were gett
      *   reported the morning after entry into the system  (per Guy, Dav
      *   So every purch type is now only reported when it can be priced.
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * DOC:  Scheduled Swine   LS118A
      *================================================================
      * Process the Buy Order Load by Kill Date for each Calendar
      * day after the Last Kill Date Reported for 14 days.  After
      * processing the 14th day, create a record.
      * 1)  Both Internal and External Producers are included.
      * 2)  If the Reporting Date is Monday and the Last Kill Date
      *     Reported is Friday, then Day 1 will start with Saturday.
      * 3)  If the Reporting Date is Monday and the Last Kill Date
      *     Reported is Saturday, then Day 1 will start with Sunday.
      * Head Count (1-14 days):  SUM(BOL Pln Head Delv) for the day
      *                          being processed.
      * 3/18/02  If Sat/Fri last reported kill, start with Monday.
      *  So exclude Sat/Sunday when setting up 1st kill date here.
      * 12/09/02  Bld Prior Day Sched with BOL access path keyed on Delv
      *           instead of Kill date.        (LS118A)
      * 01/28/03 PKD Only add 1 to Last Kill Date Reported if it's Sat
      *              or Sunday.  The Last Kill Date Reported has already
      *              been updated in the Slaughter processing.
      * 03/18/03 PKD If Sat/Fri last reported kill, start with Monday.
      *              So exclude Sat/Sunday when setting up 1st kill date
      * 07/01/03 PKD Day 1 should be Reporting Date according to Jancie &
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P2EUDT           Last Kill Date
     C                     Z-ADD*ZERO     P3CKDT           Pmt Current Pay
     C                     Z-ADD*ZERO     P4CGDT           Kill Date Usr
     C                     Z-ADD*ZERO     P6C4A1           MPR Sch Head Da
     C                     Z-ADD*ZERO     P6C5A1           MPR Sch Head Da
     C                     Z-ADD*ZERO     P6C6A1           MPR Sch Head Da
     C                     Z-ADD*ZERO     P6C7A1           MPR Sch Head Da
     C                     Z-ADD*ZERO     P6C8A1           MPR Sch Head Da
     C                     Z-ADD*ZERO     P6C9A1           MPR Sch Head Da
     C                     Z-ADD*ZERO     P6DAA1           MPR Sch Head Da
     C                     Z-ADD*ZERO     P6DBA1           MPR Sch Head Da
     C                     Z-ADD*ZERO     P6DCA1           MPR Sch Head Da
     C                     Z-ADD*ZERO     P6DDA1           MPR Sch Head Da
     C                     Z-ADD*ZERO     P6DEA1           MPR Sch Head Da
     C                     Z-ADD*ZERO     P6DFA1           MPR Sch Head Da
     C                     Z-ADD*ZERO     P6DGA1           MPR Sch Head Da
     C                     Z-ADD*ZERO     P6DHA1           MPR Sch Head Da
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field MPR Last Kill Dt Reported
     C                     Z-ADD*ZERO     WUH8DT  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHONB           CC Company Numb
     C                     Z-ADD*ZERO     WACKDT           Pmt Current Pay
     C                     Z-ADD*ZERO     WAM1NB           Pmt Current Pay
     C                     Z-ADD*ZERO     WAPINB           PP Unused Nbr 1
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBHONB           CC Company Numb
     C                     Z-ADD*ZERO     WBETDT           MPR Reporting D
     C                     Z-ADD*ZERO     WBC0A1           MPR Purchase Ty
     C                     Z-ADD*ZERO     WBC1A1           MPR Estimated H
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WDBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WDBONB           BOL Load Number
     C                     Z-ADD*ZERO     WDCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WDB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WDAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WDACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WDB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WDCAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WDAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WDA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WDCXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WDCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WDFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WDH9NB           TH Held Over
     C                     Z-ADD*ZERO     WDFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WDFENB           TH Head Killed
     C                     Z-ADD*ZERO     WDHENB           TH Head Adds
     C                     Z-ADD*ZERO     WDHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WDCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WDLRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WDE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WDA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WDFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WDA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WDF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WDHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WDF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WDF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WDF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WDF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WDAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WDAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WDCWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WDA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WDA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WDB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WDAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WDANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WDAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WDAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WDAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WDAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WDAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WDASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WDA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WDATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WDA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WDCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WDCCPR           Th Payment Net
     C                     Z-ADD*ZERO     WDLPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WDCDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WDA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WDA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WDGHNB           TH Commission A
     C                     Z-ADD*ZERO     WDBYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WDBSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WDBTDT           TH Commission P
     C                     Z-ADD*ZERO     WDBUDT           TH Actual Check
     C                     Z-ADD*ZERO     WDHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WDHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WDHINB           TH FFLI
     C                     Z-ADD*ZERO     WDA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WDA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WDA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WDJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WDD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WDD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WDD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WDD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WDEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WDEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WDECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WDEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WDEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WDEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WDEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WDEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WDOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WDTHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WDT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WDTHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WDT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WDOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WDKOER           TH Head Identif
     C                     Z-ADD*ZERO     WDOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WDOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WDIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WDOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WDHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WDS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WDTAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WDTBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WDJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WDKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WDKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WDKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WDKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WDOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WDIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WDIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WDIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WDKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WDOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WDKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WDORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WDOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WDMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WDMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WDNCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WDNCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WDIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WDKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WDEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WDEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WDECDT           TH Head LFT
     C                     Z-ADD*ZERO     WDEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WDEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
      * Define work field Tattoo Nbr Alpha Usr
     C                     MOVEL*BLANK    WUDDCD  5
      * Define work field Buy Order Load Alpha
     C                     MOVEL*BLANK    WUP9TX  5
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WEBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WEARDT           BOH Buy Order D
     C                     Z-ADD*ZERO     WEASDT           BOH Kill Date
     C                     Z-ADD*ZERO     WEAAPR           BOH Market Add/
     C                     Z-ADD*ZERO     WEALPR           BOH Quoted Base
     C                     Z-ADD*ZERO     WED5DT           BOH MPR Reporti
     C                     Z-ADD*ZERO     WED6DT           BOH Hedge Date
     C                     Z-ADD*ZERO     WED7DT           BOH Unused Date
     C                     Z-ADD*ZERO     WED8DT           BOH Unused Date
     C                     Z-ADD*ZERO     WED9DT           BOH Unused Date
     C                     Z-ADD*ZERO     WEJOEJ           BOH Hedge Head
     C                     Z-ADD*ZERO     WEKOFF           BOH Hedge Refer
     C                     Z-ADD*ZERO     WEKWPE           BOH Hedge Time
     C                     Z-ADD*ZERO     WEIMBF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WEOPTR           BOH Unused Nbr
     C                     Z-ADD*ZERO     WEOEJD           BOH Unused Nbr
     C                     Z-ADD*ZERO     WEIRMF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WEJIRM           BOH Unused Nbr
     C                     Z-ADD*ZERO     WEJRKF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WEKFIR           BOH Unused Nbr
     C                     Z-ADD*ZERO     WEHXNB           PPWS Company Nu
     C                     Z-ADD*ZERO     WEGANB           CW Year
     C                     Z-ADD*ZERO     WEGBNB           CW Week Number
     C                     Z-ADD*ZERO     WEAADT           RS Date Changed
     C                     Z-ADD*ZERO     WEAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WEABDT           RS Date Added
     C                     Z-ADD*ZERO     WEABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAZPC           CMP Std Lean Pe
     C                     Z-ADD*ZERO     WFA0PC           CMP Lean Factor
     C                     Z-ADD*ZERO     WFI1PR           CMP Market Add/
     C                     Z-ADD*ZERO     WFVEPR           CMP % of Carcas
     C                     Z-ADD*ZERO     WFVFPR           CMP Fixed Cost
     C                     Z-ADD*ZERO     WFVHPR           CMP Grade Type
     C                     Z-ADD*ZERO     WFVIPR           CMP Unused Pric
     C                     Z-ADD*ZERO     WFVJPR           CMP Unused Pric
     C                     Z-ADD*ZERO     WFAADT           RS Date Changed
     C                     Z-ADD*ZERO     WFAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WFABDT           RS Date Added
     C                     Z-ADD*ZERO     WFABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGC0A1           MPR Purchase Ty
     C                     Z-ADD*ZERO     WGAADT           RS Date Changed
     C                     Z-ADD*ZERO     WGAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WGABDT           RS Date Added
     C                     Z-ADD*ZERO     WGABTM           RS Time Added
      * Define work field CMP Grading Type
     C                     MOVEL*BLANK    WUDLST  1
      * Define work field First Time Flag Usr
     C                     MOVEL*BLANK    WUHBST  1
      * Define work field TH CA Base Mkt Price Amt
     C                     Z-ADD*ZERO     WUI6PR  72
      * Define work field TH CA Sort Discount Amt
     C                     Z-ADD*ZERO     WUI7PR  72
      * Define work field TH CA Yield Gain/Loss Amt
     C                     Z-ADD*ZERO     WUI8PR  72
      * Define work field TH CA Base Carcass Value
     C                     Z-ADD*ZERO     WUI9PR  72
      * Define work field TH CA Lean Premium Amt
     C                     Z-ADD*ZERO     WUJAPR  72
      * Define work field TH CA Carcass Gross Amt
     C                     Z-ADD*ZERO     WUJCPR  72
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WIBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WIBONB           BOL Load Number
     C                     Z-ADD*ZERO     WICVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WIB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WII5PR           TH CA Market Pr
     C                     Z-ADD*ZERO     WIJBPR           TH CA Base Mark
     C                     Z-ADD*ZERO     WII6PR           TH CA Base Mkt
     C                     Z-ADD*ZERO     WII7PR           TH CA Sort Disc
     C                     Z-ADD*ZERO     WII8PR           TH CA Yield Gai
     C                     Z-ADD*ZERO     WII9PR           TH CA Base Carc
     C                     Z-ADD*ZERO     WIJAPR           TH CA Lean Prem
     C                     Z-ADD*ZERO     WIJCPR           TH CA Carcass G
     C                     Z-ADD*ZERO     WIJDPR           TH CA Bse Mkt L
     C                     Z-ADD*ZERO     WIJEPR           TH CA Bse Mkt C
     C                     Z-ADD*ZERO     WIJFPR           TH CA Srt Dsc L
     C                     Z-ADD*ZERO     WIJGPR           TH CA Srt Dsc C
     C                     Z-ADD*ZERO     WIJHPR           TH CA Yld G/L L
     C                     Z-ADD*ZERO     WIJIPR           TH CA Yld G/L C
     C                     Z-ADD*ZERO     WIJJPR           TH CA Crc Val L
     C                     Z-ADD*ZERO     WIJKPR           TH CA Crc Val C
     C                     Z-ADD*ZERO     WIJLPR           TH CA Lean Prm
     C                     Z-ADD*ZERO     WIJMPR           TH CA Lean Prm
     C                     Z-ADD*ZERO     WIJNPR           TH CA Gross Liv
     C                     Z-ADD*ZERO     WIJOPR           TH CA Gross Car
     C                     Z-ADD*ZERO     WILTBF           TH Min LT Backf
     C                     Z-ADD*ZERO     WIHZPC           TH Min LT LoinE
     C                     Z-ADD*ZERO     WILTHW           TH Min LT Hot W
     C                     Z-ADD*ZERO     WIH0PC           TH Min LT Lean
     C                     Z-ADD*ZERO     WIGTBF           TH Max GT Backf
     C                     Z-ADD*ZERO     WIH1PC           TH Max GT LoinE
     C                     Z-ADD*ZERO     WIGTHW           TH Max GT Hot W
     C                     Z-ADD*ZERO     WIH2PC           TH Max GT Lean
     C                     Z-ADD*ZERO     WIHLBF           TH Head LT Back
     C                     Z-ADD*ZERO     WIHLLE           TH Head LT Loin
     C                     Z-ADD*ZERO     WIHLHW           TH Head LT Hot
     C                     Z-ADD*ZERO     WIHLLP           TH Head LT Lean
     C                     Z-ADD*ZERO     WIHGBF           TH Head GT Back
     C                     Z-ADD*ZERO     WIHGLE           TH Head GT Loin
     C                     Z-ADD*ZERO     WIHGHW           TH Head GT Hot
     C                     Z-ADD*ZERO     WIHFLP           TH Head GT Lean
     C                     Z-ADD*ZERO     WISNA1           TE Unused Numbe
     C                     Z-ADD*ZERO     WISOA1           TE UnUsed Numbe
     C                     Z-ADD*ZERO     WISPA1           TE Unused Numbe
     C                     Z-ADD*ZERO     WIAADT           RS Date Changed
     C                     Z-ADD*ZERO     WIAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WIABDT           RS Date Added
     C                     Z-ADD*ZERO     WIABTM           RS Time Added
      * Define work field #Sequence Block
     C                     MOVEL*BLANK    WUJ0ST  1
      * Define work field Zero USR
     C                     Z-ADD*ZERO     WUE9NB  10
      * Define work field TH CM Crc Val Carc /CWT
     C                     Z-ADD*ZERO     WUEDPR  52
      * Define work field TH Avg Live Wgt
     C                     Z-ADD*ZERO     WUF7NB  51
      * Define work field TH Adj Live Wgt
     C                     Z-ADD*ZERO     WULRNB  71
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WJBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WJBONB           BOL Load Number
     C                     Z-ADD*ZERO     WJCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WJB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WJAZVA           THD Unit Amt
     C                     Z-ADD*ZERO     WJA0VA           THD Ded/Add Amo
     C                     Z-ADD*ZERO     WJAQNB           THD Re-imbursem
     C                     Z-ADD*ZERO     WJAADT           RS Date Changed
     C                     Z-ADD*ZERO     WJAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WJABDT           RS Date Added
     C                     Z-ADD*ZERO     WJABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKETDT           MPR Reporting D
     C                     Z-ADD*ZERO     WKC2A1           MPR Reporting T
     C                     Z-ADD*ZERO     WKDOA1           MPR Slg Class C
     C                     Z-ADD*ZERO     WKDPA1           MPR Slg Purchas
     C                     Z-ADD*ZERO     WKDQA1           MPR Slg Head
     C                     Z-ADD*ZERO     WKUUPR           MPR Slg Base Pr
     C                     Z-ADD*ZERO     WKUVPR           MPR Slg Avg Net
     C                     Z-ADD*ZERO     WKUWPR           MPR Slg Low Net
     C                     Z-ADD*ZERO     WKUXPR           MPR Slg High Ne
     C                     Z-ADD*ZERO     WKDRA1           MPR Slg Avg Liv
     C                     Z-ADD*ZERO     WKDSA1           MPR Slg Avg Car
     C                     Z-ADD*ZERO     WKUYPR           MPR Slg Avg Sor
     C                     Z-ADD*ZERO     WKDTA1           MPR Slg Avg Bac
     C                     Z-ADD*ZERO     WKDUA1           MPR Slg Avg Loi
     C                     Z-ADD*ZERO     WKDVA1           MPR Slg Avg Lea
     C                     Z-ADD*ZERO     WKAADT           RS Date Changed
     C                     Z-ADD*ZERO     WKAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WKABDT           RS Date Added
     C                     Z-ADD*ZERO     WKABTM           RS Time Added
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Record Added Usr
     C                     MOVEL*BLANK    WUIHST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WOBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WOBONB           BOL Load Number
     C                     Z-ADD*ZERO     WOCQDT           BOL Kill Date
     C                     Z-ADD*ZERO     WOABTH           BOL Pln Delv St
     C                     Z-ADD*ZERO     WOACTH           BOL Pln Delv En
     C                     Z-ADD*ZERO     WOBPNB           BOL Pln Head De
     C                     Z-ADD*ZERO     WOCSNB           BOL Shipped Wgt
     C                     Z-ADD*ZERO     WOAUDT           BOL Pln Delv Da
     C                     Z-ADD*ZERO     WOAGPR           BOL Freight Uni
     C                     Z-ADD*ZERO     WOATVA           BOL Freight Amt
     C                     Z-ADD*ZERO     WODHNB           BOL Head Receiv
     C                     Z-ADD*ZERO     WODINB           BOL Live Wgt Re
     C                     Z-ADD*ZERO     WOGINB           BOL Trucker Che
     C                     Z-ADD*ZERO     WOBZDT           BOL Trucker Che
     C                     Z-ADD*ZERO     WOLSNB           BOL AP Voucher
     C                     Z-ADD*ZERO     WOLDSH           BOL Shipped Hea
     C                     Z-ADD*ZERO     WOJKRU           BOL HPS Movemen
     C                     Z-ADD*ZERO     WOKEOR           BOL Head LFT
     C                     Z-ADD*ZERO     WOIOEW           BOL Head EUT/KO
     C                     Z-ADD*ZERO     WOKJIO           BOL Auth Gate E
     C                     Z-ADD*ZERO     WOIOJR           BOL Head Receiv
     C                     Z-ADD*ZERO     WOEIRR           BOL Unused Wgt
     C                     Z-ADD*ZERO     WOITMF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WOODJE           BOL Unused Wgt
     C                     Z-ADD*ZERO     WORJIF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WOOEJF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WOD0DT           BOL Auth Gate E
     C                     Z-ADD*ZERO     WOD1DT           BOL Unused Date
     C                     Z-ADD*ZERO     WOD2DT           BOL Unused Date
     C                     Z-ADD*ZERO     WOD3DT           BOL Unused Date
     C                     Z-ADD*ZERO     WOD4DT           BOL Unused Date
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      * Define work field BOH Market Date Method
     C                     MOVEL*BLANK    WUJ5TX  3
      * Define work field Buy Order Number Alpha
     C                     MOVEL*BLANK    WUP8TX  7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WRGLNB           Pl VND Address
     C                     Z-ADD*ZERO     WRASNB           PL Miles/Unused
     C                     Z-ADD*ZERO     WRHWNB           PL Primary Comp
     C                     Z-ADD*ZERO     WRAADT           RS Date Changed
     C                     Z-ADD*ZERO     WRAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WRABDT           RS Date Added
     C                     Z-ADD*ZERO     WRABTM           RS Time Added
      * Define work field PS State
     C                     MOVEL*BLANK    WUT2TX  3
      * Define work field TH Hog Class Type
     C                     MOVEL*BLANK    WULLST  1
      * Define work field *Return code
     C                     MOVEL*BLANK    WURTN   7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WTMDA1           PS User Mileage
     C                     Z-ADD*ZERO     WTMEA1           PS User Mileage
     C                     Z-ADD*ZERO     WTMFA1           PS Trace Sequen
     C                     Z-ADD*ZERO     WTAADT           RS Date Changed
     C                     Z-ADD*ZERO     WTAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WTABDT           RS Date Added
     C                     Z-ADD*ZERO     WTABTM           RS Time Added
      * Define work field TH State
     C                     MOVEL*BLANK    WUNZTX  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WWAHDT           PSC Date
     C                     Z-ADD*ZERO     WWAZPR           PSC Floor Price
     C                     Z-ADD*ZERO     WWA0PR           PSC Ceiling Pri
     C                     Z-ADD*ZERO     WWA9PC           PSC Market Perc
     C                     Z-ADD*ZERO     WWA7PR           PSC Break Even
     C                     Z-ADD*ZERO     WWA8PR           PSC FLoor Price
     C                     Z-ADD*ZERO     WWA9PR           PSC Mkt Percent
     C                     Z-ADD*ZERO     WWF6PR           PSC Mkt + or -
     C                     Z-ADD*ZERO     WWAADT           RS Date Changed
     C                     Z-ADD*ZERO     WWAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WWABDT           RS Date Added
     C                     Z-ADD*ZERO     WWABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WXETDT           MPR Reporting D
     C                     Z-ADD*ZERO     WXC2A1           MPR Reporting T
     C                     Z-ADD*ZERO     WXDWA1           MPR Pur Ownersh
     C                     Z-ADD*ZERO     WXDXA1           MPR Pur Class C
     C                     Z-ADD*ZERO     WXDYA1           MPR Pur Purchas
     C                     Z-ADD*ZERO     WXDZA1           MPR Pur Head
     C                     Z-ADD*ZERO     WXD0A1           MPR Pur Avg Liv
     C                     Z-ADD*ZERO     WXUZPR           MPR Pur Base Pr
     C                     Z-ADD*ZERO     WXAADT           RS Date Changed
     C                     Z-ADD*ZERO     WXAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WXABDT           RS Date Added
     C                     Z-ADD*ZERO     WXABTM           RS Time Added
      * Define work field MPR Purchase Type
     C                     Z-ADD*ZERO     WUEIA1  20
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TDETDT           MPR Reporting D
     C                     Z-ADD*ZERO     TDC2A1           MPR Reporting T
     C                     Z-ADD*ZERO     TDCQDT           BOL Kill Date
     C                     Z-ADD*ZERO     TDBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     TDBONB           BOL Load Number
     C                     Z-ADD*ZERO     TDBPNB           BOL Pln Head De
     C                     Z-ADD*ZERO     TDAADT           RS Date Changed
     C                     Z-ADD*ZERO     TDAMTM           RS Time Changed
     C                     Z-ADD*ZERO     TDABDT           RS Date Added
     C                     Z-ADD*ZERO     TDABTM           RS Time Added
      * Define work field RS Record Status
     C                     MOVEL*BLANK    WUAJST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TGETDT           MPR Reporting D
     C                     Z-ADD*ZERO     TGC2A1           MPR Reporting T
     C                     Z-ADD*ZERO     TGC4A1           MPR Sch Head Da
     C                     Z-ADD*ZERO     TGC5A1           MPR Sch Head Da
     C                     Z-ADD*ZERO     TGC6A1           MPR Sch Head Da
     C                     Z-ADD*ZERO     TGC7A1           MPR Sch Head Da
     C                     Z-ADD*ZERO     TGC8A1           MPR Sch Head Da
     C                     Z-ADD*ZERO     TGC9A1           MPR Sch Head Da
     C                     Z-ADD*ZERO     TGDAA1           MPR Sch Head Da
     C                     Z-ADD*ZERO     TGDBA1           MPR Sch Head Da
     C                     Z-ADD*ZERO     TGDCA1           MPR Sch Head Da
     C                     Z-ADD*ZERO     TGDDA1           MPR Sch Head Da
     C                     Z-ADD*ZERO     TGDEA1           MPR Sch Head Da
     C                     Z-ADD*ZERO     TGDFA1           MPR Sch Head Da
     C                     Z-ADD*ZERO     TGDGA1           MPR Sch Head Da
     C                     Z-ADD*ZERO     TGDHA1           MPR Sch Head Da
     C                     Z-ADD*ZERO     TGAADT           RS Date Changed
     C                     Z-ADD*ZERO     TGAMTM           RS Time Changed
     C                     Z-ADD*ZERO     TGABDT           RS Date Added
     C                     Z-ADD*ZERO     TGABTM           RS Time Added
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WB01 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD03 177       *Synon (17,7) w
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local work field Invalid Y/N USR
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Pmt Current Payment Step
     C                     Z-ADD*ZERO     YL0002  50
      * Define local work field System Value Alpha    USR
     C                     MOVEL*BLANK    YL0003 40
      * Define local work field PD Producer Code
     C                     MOVEL*BLANK    YL0004  6
      * Define local work field BOH Hedge Reference BO
     C                     Z-ADD*ZERO     YL0005  70
      * Define local work field CMP Grading Type
     C                     MOVEL*BLANK    YL0006  1
      * Define local work field BOH MPR Purchase Type
     C                     MOVEL*BLANK    YL0007  2
      * Define local work field TH Payment Gross
     C                     Z-ADD*ZERO     YL0008  72
      * Define local work field TH Hot Wgt
     C                     Z-ADD*ZERO     YL0009  71
      * Define local work field TH Kill Date
     C                     Z-ADD*ZERO     YL0010  70
      * Define local work field TH Dead On Arrival
     C                     Z-ADD*ZERO     YL0011  50
      * Define local work field TH Head Received
     C                     Z-ADD*ZERO     YL0012  50
      * Define local work field TH Yard Deads
     C                     Z-ADD*ZERO     YL0013  50
      * Define local work field TH Head Condemned
     C                     Z-ADD*ZERO     YL0014  50
      * Define local work field TH Head Adds
     C                     Z-ADD*ZERO     YL0015  50
      * Define local work field TH Live Wgt
     C                     Z-ADD*ZERO     YL0016  71
      * Define local work field TH Adj Live Wgt
     C                     Z-ADD*ZERO     YL0017  71
      * Define local work field TH Avg Loin Eye Depth
     C                     Z-ADD*ZERO     YL0018  31
      * Define local work field TH Avg Backfat
     C                     Z-ADD*ZERO     YL0019  31
      * Define local work field TH Actual Yield %
     C                     Z-ADD*ZERO     YL0020  52
      * Define local work field TH Adj Actual Yield %
     C                     Z-ADD*ZERO     YL0021  52
      * Define local work field TH CM Base Mkt Price
     C                     Z-ADD*ZERO     YL0022  52
      * Define local work field TH CM Base Mkt Price Amt
     C                     Z-ADD*ZERO     YL0023  72
      * Define local work field TH CM Sort Discount Amt
     C                     Z-ADD*ZERO     YL0024  72
      * Define local work field TH CM Yield Gain/Loss Amt
     C                     Z-ADD*ZERO     YL0025  72
      * Define local work field TH CM Base Carcass Value
     C                     Z-ADD*ZERO     YL0026  72
      * Define local work field TH CM LN AddOn/Deduct Amt
     C                     Z-ADD*ZERO     YL0027  72
      * Define local work field TH CM Carcass Gross Amt
     C                     Z-ADD*ZERO     YL0028  72
      * Define local work field TH Deduction Amt
     C                     Z-ADD*ZERO     YL0029  72
      * Define local work field TH Carcass Net Amt
     C                     Z-ADD*ZERO     YL0030  72
      * Define local work field TH Additions Amt
     C                     Z-ADD*ZERO     YL0031  72
      * Define local work field Th Payment Net Amt
     C                     Z-ADD*ZERO     YL0032  72
      * Define local work field TH Fixed Cost Amount
     C                     Z-ADD*ZERO     YL0033  72
      * Define local work field TH Shipped Weight
     C                     Z-ADD*ZERO     YL0034  71
      * Define local work field TH FFLI
     C                     Z-ADD*ZERO     YL0035  31
      * Define local work field TH Head Excluded
     C                     Z-ADD*ZERO     YL0036  50
      * Define local work field TH CM Bse Mkt Live /CWT
     C                     Z-ADD*ZERO     YL0037  52
      * Define local work field TH CM Srt Dsc Live /CWT
     C                     Z-ADD*ZERO     YL0038  52
      * Define local work field TH CM Srt Dsc Carc /CWT
     C                     Z-ADD*ZERO     YL0039  52
      * Define local work field TH CM Yld G/L Live /CWT
     C                     Z-ADD*ZERO     YL0040  52
      * Define local work field TH CM Yld G/L Carc /CWT
     C                     Z-ADD*ZERO     YL0041  52
      * Define local work field TH CM Crc Val Live /CWT
     C                     Z-ADD*ZERO     YL0042  52
      * Define local work field TH CM Crc Val Carc /CWT
     C                     Z-ADD*ZERO     YL0043  52
      * Define local work field TH CM Lean Prem Live /CWT
     C                     Z-ADD*ZERO     YL0044  52
      * Define local work field TH CM Lean Prem Carc /CWT
     C                     Z-ADD*ZERO     YL0045  52
      * Define local work field TH CM Gross Live /CWT
     C                     Z-ADD*ZERO     YL0046  52
      * Define local work field TH CM Gross Carc /CWT
     C                     Z-ADD*ZERO     YL0047  52
      * Define local work field TH Head Adjusted-LN%
     C                     Z-ADD*ZERO     YL0048  50
      * Define local work field TH PHA Head Adds
     C                     Z-ADD*ZERO     YL0049  50
      * Define local work field TH Excluded Gross Value
     C                     Z-ADD*ZERO     YL0050  72
      * Define local work field TH Excluded Carc Val
     C                     Z-ADD*ZERO     YL0051  72
      * Define local work field TH Excluded Premium
     C                     Z-ADD*ZERO     YL0052  72
      * Define local work field TH Meat Value Factor Amt
     C                     Z-ADD*ZERO     YL0053 112
      * Define local work field TH Avg Loin Eye - 2 dec
     C                     Z-ADD*ZERO     YL0054  52
      * Define local work field TH Avg Backfat - 2 Dec
     C                     Z-ADD*ZERO     YL0055  52
      * Define local work field TH Head LFT
     C                     Z-ADD*ZERO     YL0056  70
      * Define local work field TH Head EUT/KOA
     C                     Z-ADD*ZERO     YL0057  70
      * Define local work field Addt Cst Ttl Usr
     C                     Z-ADD*ZERO     YL0058  72
      * Define local work field System Value Numeric  USR
     C                     Z-ADD*ZERO     YL0059 155
      * Define local work field MPR Origin from Site USR
     C                     MOVEL*BLANK    YL0060  1
      * Define local work field Head Total USR
     C                     Z-ADD*ZERO     YL0061  70
      * Define local work field TH Avg Live Wgt
     C                     Z-ADD*ZERO     YL0062  51
      * Define local work field TH CM Base Mkt Price
     C                     Z-ADD*ZERO     YL0063  52
      * Define local work field PSC Market Percent   NU
     C                     Z-ADD*ZERO     YL0064  30
      * Define local work field PSC Mkt Percent
     C                     Z-ADD*ZERO     YL0065  52
      * Define local work field PSC Break Even Percent
     C                     Z-ADD*ZERO     YL0066  52
      * Define local work field TH Tattoo Number
     C                     Z-ADD*ZERO     YL0067  50
      * Define local work field TH Live Wgt
     C                     Z-ADD*ZERO     YL0068  71
      * Define local work field PSC Floor Price
     C                     Z-ADD*ZERO     YL0069  52
      * Define local work field PSC Ceiling Price
     C                     Z-ADD*ZERO     YL0070  52
      * Define local work field Market Price USR
     C                     Z-ADD*ZERO     YL0071  52
      * Define local work field Pricing UOM USR
     C                     MOVEL*BLANK    YL0072  2
      * Define local work field Pricing Date USR
     C                     Z-ADD*ZERO     YL0073  70
      * Define local work field Head Total USR
     C                     Z-ADD*ZERO     YL0074  70
      * Define local work field BOH MPR Reporting Date
     C                     Z-ADD*ZERO     YL0075  70
      * Define local work field BOH MPR EST RPT STS
     C                     MOVEL*BLANK    YL0076  1
      * Define local work field BOH MPR Purchase Type
     C                     MOVEL*BLANK    YL0077  2
      * Define local work field Status 1
     C                     MOVEL*BLANK    YL0078  1
      * Define local work field MPR Estimated Head
     C                     Z-ADD*ZERO     YL0079  70
      * Define local work field Count USR
     C                     Z-ADD*ZERO     YL0080  30
      * Define local work field Planned Kill USR
     C                     Z-ADD*ZERO     YL0081  70
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 MPRRPTEST
