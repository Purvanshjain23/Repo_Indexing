     H/TITLE UPS Re-Alc Inv/Prd OR XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by  : 2E  Version:  1181
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model         lopment-
     H* System        : OMS Development Model
     H* User name     : ISPPATE
     H* Date          : 04/10/07  Time  : 17:07:05
     H* Copyright     : OMS Development Model         lopment-
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FPDKNCPL1IF  E           K        DISK
      * RTV : Order Detail Schedule     Retrieval index
      *
     FPOB5CPL1IF  E           K        DISK
      * RTV : Order Detail Sched-Inv    Retrieval index
      *
     FPOB6CPL1IF  E           K        DISK
      * RTV : Order Detail Sched-Shortg Retrieval index
      *
     FPDKNCPL9IF  E           K        DISK
      * RSQ : Order Detail Schedule     Co/Ord/Seq/Ssq/PDt-d Rlc
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FPOCWCPL1IF  E           K        DISK
      * RTV : PS Prod Item Inventory    Retrieval index
      *
     FPOB5CPL3IF  E           K        DISK
      * RSQ : Order Detail Sched-Inv    Co/Itm/Whs/PDte/Ord
      *
     FPDI8CPL1IF  E           K        DISK
      * RTV : PS Prod Item Schedule     Retrieval index
      *
     FPDJCCPL1IF  E           K        DISK
      * RTV : PS Prod Schedule          Retrieval index
      *
     FPDI8CPL4IF  E           K        DISK
      * RSQ : PS Prod Item Schedule     Co/Itm/Whs/PrdDte/Typ
      *
     FCAAFREL6IF  E           K        DISK
      * RSQ : Calendar                  RSQ Co/Date Descending
      *
     FCAAFREL3IF  E           K        DISK
      * RSQ : Calendar                  Co/Date               NV
      *
     FPDKNCPL0UF  E           K        DISK                      A
      * UPD : Order Detail Schedule     Update index
      *
     FPOB5CPL0UF  E           K        DISK                      A
      * UPD : Order Detail Sched-Inv    Update index
      *
     FPOB6CPL0UF  E           K        DISK
      * UPD : Order Detail Sched-Shortg Update index
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     FPDI8CPL0UF  E           K        DISK                      A
      * UPD : PS Prod Item Schedule     Update index
      *
      * Long constants
     E                    @CN#    1   2  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WAAIC3
     I              OMC4NB                          WAC4NB
     I              OMDPNB                          WADPNB
     I              OMUENB                          WAUENB
     I              OMHGCD                          WAHGCD
     I              OMAJCD                          WAAJCD
     I              OMBKC7                          WABKC7
     I              OMCFC7                          WACFC7
     I              OMGMST                          WAGMST
     I              OMGNST                          WAGNST
     I              OMMAVA                          WAMAVA
     I              OMKDVA                          WAKDVA
     I              OML8VA                          WAL8VA
     I              OML9VA                          WAL9VA
     I              OMGTST                          WAGTST
     I              OMGVST                          WAGVST
     I              OMGUST                          WAGUST
     I              OMQFST                          WAQFST
     I              OMAYVA                          WAAYVA
     I              OMEXDT                          WAEXDT
     I              OMLQCD                          WALQCD
     I              OMRDCD                          WARDCD
     I              OMQ7CD                          WAQ7CD
     I              OMBZPR                          WABZPR
     I              OML6NB                          WAL6NB
     I              OMU1ST                          WAU1ST
     I              OMGIDT                          WAGIDT
     I              OMCRCD                          WACRCD
     I              OMAGCD                          WAAGCD
     I              OMRZST                          WARZST
     I              OMR0ST                          WAR0ST
     I              OMR1ST                          WAR1ST
     I              OMG7NA                          WAG7NA
     I              OMG8NA                          WAG8NA
     I              OMRPCD                          WARPCD
     I              OMVEST                          WAVEST
     I              OMVGST                          WAVGST
     I              OMAVST                          WAAVST
     I              OMU0ST                          WAU0ST
     I              OMRFCD                          WARFCD
     I              OMFZST                          WAFZST
     I              OMR1NB                          WAR1NB
     I              OMAVQT                          WAAVQT
     I              OMD0WG                          WAD0WG
     I              OMCCQT                          WACCQT
     I              OMAUWG                          WAAUWG
     I              OMCBQT                          WACBQT
     I              OMATWG                          WAATWG
     I              OMAQCS                          WAAQCS
     I              OMAGCS                          WAAGCS
     I              OMAKPR                          WAAKPR
     I              OMALPR                          WAALPR
     I              OMAUPR                          WAAUPR
     I              OMAVWG                          WAAVWG
     I              OMA4WG                          WAA4WG
     I              OMA5DT                          WAA5DT
     I              OMAODT                          WAAODT
     I              OMGNDT                          WAGNDT
     I              OMAMST                          WAAMST
     I              OMANST                          WAANST
     I              OMVAST                          WAVAST
     I              OMRGNB                          WARGNB
     I              OMRHNB                          WARHNB
     I              OMRINB                          WARINB
     I              OMRBCD                          WARBCD
     I              OMHICD                          WAHICD
     I              OMRNCD                          WARNCD
     I              OMROCD                          WAROCD
     I              OMCXDT                          WACXDT
     I              OMAJVN                          WAAJVN
     I              OMKXCD                          WAKXCD
     I              OMJPCD                          WAJPCD
     I              OMCQCD                          WACQCD
     I              OMR4CD                          WAR4CD
     I              OMZ1ST                          WAZ1ST
     I              OMZ3ST                          WAZ3ST
     I              OMZ4ST                          WAZ4ST
     I              OMDUPR                          WADUPR
     I              OMB6VL                          WAB6VL
     I              OMA1AA                          WAA1AA
     I              OMFZSX                          WAFZSX
     I              OMF0SX                          WAF0SX
     I              OMF1SX                          WAF1SX
     I              OMF2SX                          WAF2SX
     I              OMF3SX                          WAF3SX
     I              OMF4SX                          WAF4SX
     I              OMF5SX                          WAF5SX
     I              OMF6SX                          WAF6SX
     I              OMF7SX                          WAF7SX
     I              OMNTDT                          WANTDT
     I              OMNUDT                          WANUDT
     I              OMNVDT                          WANVDT
     I              OMNWDT                          WANWDT
     I              OMNXDT                          WANXDT
     I              OMBUTM                          WABUTM
     I              OMBVTM                          WABVTM
     I              OMBWTM                          WABWTM
     I              OMBXTM                          WABXTM
     I              OMBYTM                          WABYTM
     I              OMH5NX                          WAH5NX
     I              OMH6NX                          WAH6NX
     I              OMH7NX                          WAH7NX
     I              OMH8NX                          WAH8NX
     I              OMH9NX                          WAH9NX
     I              OMDVPR                          WADVPR
     I              OMDWPR                          WADWPR
     I              OMDXPR                          WADXPR
     I              OMDYPR                          WADYPR
     I              OMDZPR                          WADZPR
     I              OMUVST                          WAUVST
     I              OMUWST                          WAUWST
     I              OMUXST                          WAUXST
     I              OMAATM                          WAAATM
     I              OMAYNA                          WAAYNA
     I              OMA0NA                          WAA0NA
     I              OMAXDT                          WAAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WBAIC3
     I              BZHGCD                          WBHGCD
     I              BZAVNA                          WBAVNA
     I              BZAWNA                          WBAWNA
     I              BZL7NA                          WBL7NA
     I              BZL8NA                          WBL8NA
     I              BZL6NA                          WBL6NA
     I              BZMFNA                          WBMFNA
     I              BZADCD                          WBADCD
     I              BZAWPC                          WBAWPC
     I              BZLXST                          WBLXST
     I              BZAECD                          WBAECD
     I              BZAXPC                          WBAXPC
     I              BZLYST                          WBLYST
     I              BZAFCD                          WBAFCD
     I              BZAICD                          WBAICD
     I              BZAIWG                          WBAIWG
     I              BZHICD                          WBHICD
     I              BZRBCD                          WBRBCD
     I              BZFZST                          WBFZST
     I              BZAVST                          WBAVST
     I              BZCZWG                          WBCZWG
     I              BZC0WG                          WBC0WG
     I              BZURTN                          WBURTN
     I              BZAJC8                          WBAJC8
     I              BZRINB                          WBRINB
     I              BZRHNB                          WBRHNB
     I              BZRGNB                          WBRGNB
     I              BZLNCD                          WBLNCD
     I              BZTFNB                          WBTFNB
     I              BZN0CD                          WBN0CD
     I              BZX4ST                          WBX4ST
     I              BZTMVA                          WBTMVA
     I              BZTNVA                          WBTNVA
     I              BZBLPR                          WBBLPR
     I              BZBMPR                          WBBMPR
     I              BZLRCD                          WBLRCD
     I              BZU9ST                          WBU9ST
     I              BZCMCO                          WBCMCO
     I              BZQ1CD                          WBQ1CD
     I              BZQ8CD                          WBQ8CD
     I              BZCHTM                          WBCHTM
     I              BZQZCD                          WBQZCD
     I              BZXWST                          WBXWST
     I              BZXXST                          WBXXST
     I              BZVMST                          WBVMST
     I              BZSWGH                          WBSWGH
     I              BZPPHE                          WBPPHE
     I              BZR3CD                          WBR3CD
     I              BZSDCD                          WBSDCD
     I              BZICN1                          WBICN1
     I              BZSVCD                          WBSVCD
     I              BZICN2                          WBICN2
     I              BZSWCD                          WBSWCD
     I              BZV2NB                          WBV2NB
     I              BZSXCD                          WBSXCD
     I              BZITCN                          WBITCN
     I              BZSYCD                          WBSYCD
     I              BZITC5                          WBITC5
     I              BZSZCD                          WBSZCD
     I              BZICN6                          WBICN6
     I              BZS0CD                          WBS0CD
     I              BZICN7                          WBICN7
     I              BZS1CD                          WBS1CD
     I              BZICN8                          WBICN8
     I              BZS2CD                          WBS2CD
     I              BZICN9                          WBICN9
     I              BZS3CD                          WBS3CD
     I              BZICN0                          WBICN0
     I              BZS4CD                          WBS4CD
     I              BZSFNB                          WBSFNB
     I              BZA3WG                          WBA3WG
     I              BZSJNB                          WBSJNB
     I              BZLLCD                          WBLLCD
     I              BZLMCD                          WBLMCD
     I              BZP3ST                          WBP3ST
     I              BZSKNB                          WBSKNB
     I              BZSLNB                          WBSLNB
     I              BZSMNB                          WBSMNB
     I              BZP4ST                          WBP4ST
     I              BZCFNB                          WBCFNB
     I              BZCGNB                          WBCGNB
     I              BZILNB                          WBILNB
     I              BZCHNB                          WBCHNB
     I              BZCINB                          WBCINB
     I              BZCJNB                          WBCJNB
     I              BZCMNB                          WBCMNB
     I              BZCNNB                          WBCNNB
     I              BZCRNB                          WBCRNB
     I              BZCSNB                          WBCSNB
     I              BZCVNB                          WBCVNB
     I              BZCWNB                          WBCWNB
     I              BZCXNB                          WBCXNB
     I              BZCZNB                          WBCZNB
     I              BZC0NB                          WBC0NB
     I              BZN1CD                          WBN1CD
     I              BZB4NB                          WBB4NB
     I              BZB5NB                          WBB5NB
     I              BZX5ST                          WBX5ST
     I              BZX6ST                          WBX6ST
     I              BZX7ST                          WBX7ST
     I              BZPCCT                          WBPCCT
     I              BZBDNB                          WBBDNB
     I              BZBJNB                          WBBJNB
     I              BZSUST                          WBSUST
     I              BZSVST                          WBSVST
     I              BZSYST                          WBSYST
     I              BZSZST                          WBSZST
     I              BZS1ST                          WBS1ST
     I              BZXRCD                          WBXRCD
     I              BZXTCD                          WBXTCD
     I              BZXUCD                          WBXUCD
     I              BZF5WG                          WBF5WG
     I              BZF6WG                          WBF6WG
     I              BZF7WG                          WBF7WG
     I              BZBLNB                          WBBLNB
     I              BZBNNB                          WBBNNB
     I              BZS2ST                          WBS2ST
     I              BZS4ST                          WBS4ST
     I              BZS5ST                          WBS5ST
     I              BZS6ST                          WBS6ST
     I              BZS8ST                          WBS8ST
     I              BZS9ST                          WBS9ST
     I              BZTCST                          WBTCST
     I              BZTDST                          WBTDST
     I              BZUVST                          WBUVST
     I              BZUWST                          WBUWST
     I              BZUXST                          WBUXST
     I              BZVSST                          WBVSST
     I              BZAATM                          WBAATM
     I              BZAYNA                          WBAYNA
     I              BZA0NA                          WBA0NA
     I              BZAXDT                          WBAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WCAJCD
     I              ADF8NA                          WCF8NA
     I              ADACNA                          WCACNA
     I              ADADNA                          WCADNA
     I              ADAENA                          WCAENA
     I              ADAJNA                          WCAJNA
     I              ADBTTX                          WCBTTX
     I              ADAOCD                          WCAOCD
     I              ADBGCD                          WCBGCD
     I              ADVHST                          WCVHST
     I              ADMPNA                          WCMPNA
     I              ADWPST                          WCWPST
     I              ADXUST                          WCXUST
     I              ADT0ST                          WCT0ST
     I              ADT1ST                          WCT1ST
     I              ADDBNB                          WCDBNB
     I              ADT2ST                          WCT2ST
     I              ADT3ST                          WCT3ST
     I              ADT4ST                          WCT4ST
     I              ADT6ST                          WCT6ST
     I              ADBWC3                          WCBWC3
     I              ADBTC3                          WCBTC3
     I              ADBUC3                          WCBUC3
     I              ADBVC3                          WCBVC3
     I              ADFCAA                          WCFCAA
     I              ADRQSX                          WCRQSX
     I              ADRRSX                          WCRRSX
     I              ADRSSX                          WCRSSX
     I              ADRTSX                          WCRTSX
     I              ADT7ST                          WCT7ST
     I              ADT8ST                          WCT8ST
     I              ADRNSX                          WCRNSX
     I              ADROSX                          WCROSX
     I              ADRPSX                          WCRPSX
     I              ADUVST                          WCUVST
     I              ADUWST                          WCUWST
     I              ADUXST                          WCUXST
     I              ADVSST                          WCVSST
     I              ADAATM                          WCAATM
     I              ADAYNA                          WCAYNA
     I              ADA0NA                          WCA0NA
     I              ADAXDT                          WCAXDT
      *
     I@KNCPHO
      * Order Detail Schedule     Retrieval index
      * Renamed input format fields
     I              KNAIC3                          WDAIC3
     I              KNC4NB                          WDC4NB
     I              KNDPNB                          WDDPNB
     I              KNUENB                          WDUENB
     I              KNJGDT                          WDJGDT
     I              KNAODT                          WDAODT
     I              KNAJCD                          WDAJCD
     I              KNAYAA                          WDAYAA
     I              KNHGCD                          WDHGCD
     I              KNIGQT                          WDIGQT
     I              KNFLWG                          WDFLWG
     I              KNIUQT                          WDIUQT
     I              KNF3WG                          WDF3WG
     I              KNIVQT                          WDIVQT
     I              KNF4WG                          WDF4WG
     I              KNP7ST                          WDP7ST
     I              KNP8ST                          WDP8ST
     I              KNQAST                          WDQAST
     I              KNUVST                          WDUVST
     I              KNUWST                          WDUWST
     I              KNUXST                          WDUXST
     I              KNVSST                          WDVSST
     I              KNAATM                          WDAATM
     I              KNAYNA                          WDAYNA
     I              KNA0NA                          WDA0NA
     I              KNAXDT                          WDAXDT
      *
     I@KNCPHN
      * Order Detail Schedule     Update index
      * Renamed input format fields
     I              KNAIC3                          WEAIC3
     I              KNC4NB                          WEC4NB
     I              KNDPNB                          WEDPNB
     I              KNUENB                          WEUENB
     I              KNJGDT                          WEJGDT
     I              KNAODT                          WEAODT
     I              KNAJCD                          WEAJCD
     I              KNAYAA                          WEAYAA
     I              KNHGCD                          WEHGCD
     I              KNIGQT                          WEIGQT
     I              KNFLWG                          WEFLWG
     I              KNIUQT                          WEIUQT
     I              KNF3WG                          WEF3WG
     I              KNIVQT                          WEIVQT
     I              KNF4WG                          WEF4WG
     I              KNP7ST                          WEP7ST
     I              KNP8ST                          WEP8ST
     I              KNQAST                          WEQAST
     I              KNUVST                          WEUVST
     I              KNUWST                          WEUWST
     I              KNUXST                          WEUXST
     I              KNVSST                          WEVSST
     I              KNAATM                          WEAATM
     I              KNAYNA                          WEAYNA
     I              KNA0NA                          WEA0NA
     I              KNAXDT                          WEAXDT
      *
     I@B5CPM2
      * Order Detail Sched-Inv    Retrieval index
      * Renamed input format fields
     I              B5AIC3                          WFAIC3
     I              B5C4NB                          WFC4NB
     I              B5DPNB                          WFDPNB
     I              B5UENB                          WFUENB
     I              B5JGDT                          WFJGDT
     I              B5AODT                          WFAODT
     I              B5AJCD                          WFAJCD
     I              B5HGCD                          WFHGCD
     I              B5IUQT                          WFIUQT
     I              B5F3WG                          WFF3WG
     I              B5UVST                          WFUVST
     I              B5UWST                          WFUWST
     I              B5UXST                          WFUXST
     I              B5VSST                          WFVSST
     I              B5AATM                          WFAATM
     I              B5AYNA                          WFAYNA
     I              B5A0NA                          WFA0NA
     I              B5AXDT                          WFAXDT
      *
     I@B5CPM1
      * Order Detail Sched-Inv    Update index
      * Renamed input format fields
     I              B5AIC3                          WGAIC3
     I              B5C4NB                          WGC4NB
     I              B5DPNB                          WGDPNB
     I              B5UENB                          WGUENB
     I              B5JGDT                          WGJGDT
     I              B5AODT                          WGAODT
     I              B5AJCD                          WGAJCD
     I              B5HGCD                          WGHGCD
     I              B5IUQT                          WGIUQT
     I              B5F3WG                          WGF3WG
     I              B5UVST                          WGUVST
     I              B5UWST                          WGUWST
     I              B5UXST                          WGUXST
     I              B5VSST                          WGVSST
     I              B5AATM                          WGAATM
     I              B5AYNA                          WGAYNA
     I              B5A0NA                          WGA0NA
     I              B5AXDT                          WGAXDT
      *
     I@B6CPNB
      * Order Detail Sched-Shortg Retrieval index
      * Renamed input format fields
     I              B6AIC3                          WHAIC3
     I              B6C4NB                          WHC4NB
     I              B6DPNB                          WHDPNB
     I              B6UENB                          WHUENB
     I              B6JGDT                          WHJGDT
     I              B6AODT                          WHAODT
     I              B6AJCD                          WHAJCD
     I              B6NUDT                          WHNUDT
     I              B6HGCD                          WHHGCD
     I              B6IGQT                          WHIGQT
     I              B6FLWG                          WHFLWG
     I              B6NSQT                          WHNSQT
     I              B6JQWG                          WHJQWG
     I              B6NVDT                          WHNVDT
     I              B6BUTM                          WHBUTM
     I              B6UVST                          WHUVST
     I              B6UWST                          WHUWST
     I              B6UXST                          WHUXST
     I              B6VSST                          WHVSST
     I              B6AATM                          WHAATM
     I              B6AYNA                          WHAYNA
     I              B6A0NA                          WHA0NA
     I              B6AXDT                          WHAXDT
      *
     I@B6CPNA
      * Order Detail Sched-Shortg Update index
      * Renamed input format fields
     I              B6AIC3                          WIAIC3
     I              B6C4NB                          WIC4NB
     I              B6DPNB                          WIDPNB
     I              B6UENB                          WIUENB
     I              B6JGDT                          WIJGDT
     I              B6AODT                          WIAODT
     I              B6AJCD                          WIAJCD
     I              B6NUDT                          WINUDT
     I              B6HGCD                          WIHGCD
     I              B6IGQT                          WIIGQT
     I              B6FLWG                          WIFLWG
     I              B6NSQT                          WINSQT
     I              B6JQWG                          WIJQWG
     I              B6NVDT                          WINVDT
     I              B6BUTM                          WIBUTM
     I              B6UVST                          WIUVST
     I              B6UWST                          WIUWST
     I              B6UXST                          WIUXST
     I              B6VSST                          WIVSST
     I              B6AATM                          WIAATM
     I              B6AYNA                          WIAYNA
     I              B6A0NA                          WIA0NA
     I              B6AXDT                          WIAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WJAIC3
     I              OMC4NB                          WJC4NB
     I              OMDPNB                          WJDPNB
     I              OMUENB                          WJUENB
     I              OMHGCD                          WJHGCD
     I              OMAJCD                          WJAJCD
     I              OMBKC7                          WJBKC7
     I              OMCFC7                          WJCFC7
     I              OMGMST                          WJGMST
     I              OMGNST                          WJGNST
     I              OMMAVA                          WJMAVA
     I              OMKDVA                          WJKDVA
     I              OML8VA                          WJL8VA
     I              OML9VA                          WJL9VA
     I              OMGTST                          WJGTST
     I              OMGVST                          WJGVST
     I              OMGUST                          WJGUST
     I              OMQFST                          WJQFST
     I              OMAYVA                          WJAYVA
     I              OMEXDT                          WJEXDT
     I              OMLQCD                          WJLQCD
     I              OMRDCD                          WJRDCD
     I              OMQ7CD                          WJQ7CD
     I              OMBZPR                          WJBZPR
     I              OML6NB                          WJL6NB
     I              OMU1ST                          WJU1ST
     I              OMGIDT                          WJGIDT
     I              OMCRCD                          WJCRCD
     I              OMAGCD                          WJAGCD
     I              OMRZST                          WJRZST
     I              OMR0ST                          WJR0ST
     I              OMR1ST                          WJR1ST
     I              OMG7NA                          WJG7NA
     I              OMG8NA                          WJG8NA
     I              OMRPCD                          WJRPCD
     I              OMVEST                          WJVEST
     I              OMVGST                          WJVGST
     I              OMAVST                          WJAVST
     I              OMU0ST                          WJU0ST
     I              OMRFCD                          WJRFCD
     I              OMFZST                          WJFZST
     I              OMR1NB                          WJR1NB
     I              OMAVQT                          WJAVQT
     I              OMD0WG                          WJD0WG
     I              OMCCQT                          WJCCQT
     I              OMAUWG                          WJAUWG
     I              OMCBQT                          WJCBQT
     I              OMATWG                          WJATWG
     I              OMAQCS                          WJAQCS
     I              OMAGCS                          WJAGCS
     I              OMAKPR                          WJAKPR
     I              OMALPR                          WJALPR
     I              OMAUPR                          WJAUPR
     I              OMAVWG                          WJAVWG
     I              OMA4WG                          WJA4WG
     I              OMA5DT                          WJA5DT
     I              OMAODT                          WJAODT
     I              OMGNDT                          WJGNDT
     I              OMAMST                          WJAMST
     I              OMANST                          WJANST
     I              OMVAST                          WJVAST
     I              OMRGNB                          WJRGNB
     I              OMRHNB                          WJRHNB
     I              OMRINB                          WJRINB
     I              OMRBCD                          WJRBCD
     I              OMHICD                          WJHICD
     I              OMRNCD                          WJRNCD
     I              OMROCD                          WJROCD
     I              OMCXDT                          WJCXDT
     I              OMAJVN                          WJAJVN
     I              OMKXCD                          WJKXCD
     I              OMJPCD                          WJJPCD
     I              OMCQCD                          WJCQCD
     I              OMR4CD                          WJR4CD
     I              OMZ1ST                          WJZ1ST
     I              OMZ3ST                          WJZ3ST
     I              OMZ4ST                          WJZ4ST
     I              OMDUPR                          WJDUPR
     I              OMB6VL                          WJB6VL
     I              OMA1AA                          WJA1AA
     I              OMFZSX                          WJFZSX
     I              OMF0SX                          WJF0SX
     I              OMF1SX                          WJF1SX
     I              OMF2SX                          WJF2SX
     I              OMF3SX                          WJF3SX
     I              OMF4SX                          WJF4SX
     I              OMF5SX                          WJF5SX
     I              OMF6SX                          WJF6SX
     I              OMF7SX                          WJF7SX
     I              OMNTDT                          WJNTDT
     I              OMNUDT                          WJNUDT
     I              OMNVDT                          WJNVDT
     I              OMNWDT                          WJNWDT
     I              OMNXDT                          WJNXDT
     I              OMBUTM                          WJBUTM
     I              OMBVTM                          WJBVTM
     I              OMBWTM                          WJBWTM
     I              OMBXTM                          WJBXTM
     I              OMBYTM                          WJBYTM
     I              OMH5NX                          WJH5NX
     I              OMH6NX                          WJH6NX
     I              OMH7NX                          WJH7NX
     I              OMH8NX                          WJH8NX
     I              OMH9NX                          WJH9NX
     I              OMDVPR                          WJDVPR
     I              OMDWPR                          WJDWPR
     I              OMDXPR                          WJDXPR
     I              OMDYPR                          WJDYPR
     I              OMDZPR                          WJDZPR
     I              OMUVST                          WJUVST
     I              OMUWST                          WJUWST
     I              OMUXST                          WJUXST
     I              OMAATM                          WJAATM
     I              OMAYNA                          WJAYNA
     I              OMA0NA                          WJA0NA
     I              OMAXDT                          WJAXDT
      *
     I@KNCPNF
      * Order Detail Schedule     Co/Ord/Seq/Ssq/PDt-d Rlc
      * Renamed input format fields
     I              KNAIC3                          WKAIC3
     I              KNC4NB                          WKC4NB
     I              KNDPNB                          WKDPNB
     I              KNUENB                          WKUENB
     I              KNJGDT                          WKJGDT
     I              KNAODT                          WKAODT
     I              KNAJCD                          WKAJCD
     I              KNAYAA                          WKAYAA
     I              KNHGCD                          WKHGCD
     I              KNIGQT                          WKIGQT
     I              KNFLWG                          WKFLWG
     I              KNIUQT                          WKIUQT
     I              KNF3WG                          WKF3WG
     I              KNIVQT                          WKIVQT
     I              KNF4WG                          WKF4WG
     I              KNP7ST                          WKP7ST
     I              KNP8ST                          WKP8ST
     I              KNQAST                          WKQAST
     I              KNUVST                          WKUVST
     I              KNUWST                          WKUWST
     I              KNUXST                          WKUXST
     I              KNVSST                          WKVSST
     I              KNAATM                          WKAATM
     I              KNAYNA                          WKAYNA
     I              KNA0NA                          WKA0NA
     I              KNAXDT                          WKAXDT
      *
     I@AFREBE
      * Calendar                  Retrieval index       NV
      * Renamed input format fields
     I              AFAIC3                          WLAIC3
     I              AFBCDT                          WLBCDT
     I              AFCQNB                          WLCQNB
     I              AFESNB                          WLESNB
     I              AFETNB                          WLETNB
     I              AFBZNB                          WLBZNB
     I              AFA9ST                          WLA9ST
     I              AFEINB                          WLEINB
     I              AFC5ST                          WLC5ST
     I              AFAQNB                          WLAQNB
     I              AFCMST                          WLCMST
     I              AFV9ST                          WLV9ST
     I              AFWAST                          WLWAST
     I              AFX2ST                          WLX2ST
     I              AFOJDT                          WLOJDT
     I              AFNQNX                          WLNQNX
     I              AFNRNX                          WLNRNX
     I              AFI9SX                          WLI9SX
     I              AFJASX                          WLJASX
     I              AFOKDT                          WLOKDT
     I              AFOLDT                          WLOLDT
     I              AFUVST                          WLUVST
     I              AFUWST                          WLUWST
     I              AFUXST                          WLUXST
     I              AFAATM                          WLAATM
     I              AFAYNA                          WLAYNA
     I              AFA0NA                          WLA0NA
     I              AFAXDT                          WLAXDT
      *
     I@CWCPQW
      * PS Prod Item Inventory    Retrieval index
      * Renamed input format fields
     I              CWAIC3                          WMAIC3
     I              CWHGCD                          WMHGCD
     I              CWAJCD                          WMAJCD
     I              CWELDT                          WMELDT
     I              CWACWG                          WMACWG
     I              CWARQT                          WMARQT
     I              CWK7DT                          WMK7DT
     I              CWUVST                          WMUVST
     I              CWUWST                          WMUWST
     I              CWUXST                          WMUXST
     I              CWVSST                          WMVSST
     I              CWAATM                          WMAATM
     I              CWAYNA                          WMAYNA
     I              CWA0NA                          WMA0NA
     I              CWAXDT                          WMAXDT
      *
     I@B5CPM4
      * Order Detail Sched-Inv    Co/Itm/Whs/PDte/Ord
      * Renamed input format fields
     I              B5AIC3                          WOAIC3
     I              B5C4NB                          WOC4NB
     I              B5DPNB                          WODPNB
     I              B5UENB                          WOUENB
     I              B5JGDT                          WOJGDT
     I              B5AODT                          WOAODT
     I              B5AJCD                          WOAJCD
     I              B5HGCD                          WOHGCD
     I              B5IUQT                          WOIUQT
     I              B5F3WG                          WOF3WG
     I              B5UVST                          WOUVST
     I              B5UWST                          WOUWST
     I              B5UXST                          WOUXST
     I              B5VSST                          WOVSST
     I              B5AATM                          WOAATM
     I              B5AYNA                          WOAYNA
     I              B5A0NA                          WOA0NA
     I              B5AXDT                          WOAXDT
      *
     I@I8CPUS
      * PS Prod Item Schedule     Retrieval index
      * Renamed input format fields
     I              I8AIC3                          WRAIC3
     I              I8V5ST                          WRV5ST
     I              I8ELDT                          WRELDT
     I              I8HGCD                          WRHGCD
     I              I8AJCD                          WRAJCD
     I              I8GPDT                          WRGPDT
     I              I8WTSP                          WRWTSP
     I              I8QTSP                          WRQTSP
     I              I8DJPC                          WRDJPC
     I              I8F8WG                          WRF8WG
     I              I8WTIN                          WRWTIN
     I              I8D5NB                          WRD5NB
     I              I8DXWG                          WRDXWG
     I              I8B2NB                          WRB2NB
     I              I8WTCN                          WRWTCN
     I              I8PSCV                          WRPSCV
     I              I8SAWT                          WRSAWT
     I              I8B9NB                          WRB9NB
     I              I8D1WG                          WRD1WG
     I              I8CBNB                          WRCBNB
     I              I8EZWG                          WREZWG
     I              I8CCNB                          WRCCNB
     I              I8E0WG                          WRE0WG
     I              I8D6NB                          WRD6NB
     I              I8OAWT                          WROAWT
     I              I8CDNB                          WRCDNB
     I              I8UNW2                          WRUNW2
     I              I8CENB                          WRCENB
     I              I8F9WG                          WRF9WG
     I              I8BPNB                          WRBPNB
     I              I8GAWG                          WRGAWG
     I              I8BQNB                          WRBQNB
     I              I8GBWG                          WRGBWG
     I              I8BRNB                          WRBRNB
     I              I8GCWG                          WRGCWG
     I              I8BSNB                          WRBSNB
     I              I8GDWG                          WRGDWG
     I              I8BWNB                          WRBWNB
     I              I8GEWG                          WRGEWG
     I              I8PS6U                          WRPS6U
     I              I8WCST                          WRWCST
     I              I8WPST                          WRWPST
     I              I8B5ST                          WRB5ST
     I              I8TFST                          WRTFST
     I              I8TEST                          WRTEST
     I              I8THST                          WRTHST
     I              I8UDST                          WRUDST
     I              I8UFST                          WRUFST
     I              I8UGST                          WRUGST
     I              I8UHST                          WRUHST
     I              I8B6ST                          WRB6ST
     I              I8B7ST                          WRB7ST
     I              I8DVWG                          WRDVWG
     I              I8D7NB                          WRD7NB
     I              I8FCAD                          WRFCAD
     I              I8D9NB                          WRD9NB
     I              I8DWWG                          WRDWWG
     I              I8EANB                          WREANB
     I              I8SHWT                          WRSHWT
     I              I8EBNB                          WREBNB
     I              I8AVWT                          WRAVWT
     I              I8ECNB                          WRECNB
     I              I8WTON                          WRWTON
     I              I8EDNB                          WREDNB
     I              I8FNWT                          WRFNWT
     I              I8EENB                          WREENB
     I              I8QTAS                          WRQTAS
     I              I8EFNB                          WREFNB
     I              I8WAIO                          WRWAIO
     I              I8EGNB                          WREGNB
     I              I8R3CD                          WRR3CD
     I              I8RGNB                          WRRGNB
     I              I8RHNB                          WRRHNB
     I              I8RINB                          WRRINB
     I              I8XRCD                          WRXRCD
     I              I8UVST                          WRUVST
     I              I8UWST                          WRUWST
     I              I8UXST                          WRUXST
     I              I8VSST                          WRVSST
     I              I8AATM                          WRAATM
     I              I8AYNA                          WRAYNA
     I              I8A0NA                          WRA0NA
     I              I8AXDT                          WRAXDT
      *
     I@I8CPUR
      * PS Prod Item Schedule     Update index
      * Renamed input format fields
     I              I8AIC3                          WSAIC3
     I              I8V5ST                          WSV5ST
     I              I8ELDT                          WSELDT
     I              I8HGCD                          WSHGCD
     I              I8AJCD                          WSAJCD
     I              I8GPDT                          WSGPDT
     I              I8WTSP                          WSWTSP
     I              I8QTSP                          WSQTSP
     I              I8DJPC                          WSDJPC
     I              I8F8WG                          WSF8WG
     I              I8WTIN                          WSWTIN
     I              I8D5NB                          WSD5NB
     I              I8DXWG                          WSDXWG
     I              I8B2NB                          WSB2NB
     I              I8WTCN                          WSWTCN
     I              I8PSCV                          WSPSCV
     I              I8SAWT                          WSSAWT
     I              I8B9NB                          WSB9NB
     I              I8D1WG                          WSD1WG
     I              I8CBNB                          WSCBNB
     I              I8EZWG                          WSEZWG
     I              I8CCNB                          WSCCNB
     I              I8E0WG                          WSE0WG
     I              I8D6NB                          WSD6NB
     I              I8OAWT                          WSOAWT
     I              I8CDNB                          WSCDNB
     I              I8UNW2                          WSUNW2
     I              I8CENB                          WSCENB
     I              I8F9WG                          WSF9WG
     I              I8BPNB                          WSBPNB
     I              I8GAWG                          WSGAWG
     I              I8BQNB                          WSBQNB
     I              I8GBWG                          WSGBWG
     I              I8BRNB                          WSBRNB
     I              I8GCWG                          WSGCWG
     I              I8BSNB                          WSBSNB
     I              I8GDWG                          WSGDWG
     I              I8BWNB                          WSBWNB
     I              I8GEWG                          WSGEWG
     I              I8PS6U                          WSPS6U
     I              I8WCST                          WSWCST
     I              I8WPST                          WSWPST
     I              I8B5ST                          WSB5ST
     I              I8TFST                          WSTFST
     I              I8TEST                          WSTEST
     I              I8THST                          WSTHST
     I              I8UDST                          WSUDST
     I              I8UFST                          WSUFST
     I              I8UGST                          WSUGST
     I              I8UHST                          WSUHST
     I              I8B6ST                          WSB6ST
     I              I8B7ST                          WSB7ST
     I              I8DVWG                          WSDVWG
     I              I8D7NB                          WSD7NB
     I              I8FCAD                          WSFCAD
     I              I8D9NB                          WSD9NB
     I              I8DWWG                          WSDWWG
     I              I8EANB                          WSEANB
     I              I8SHWT                          WSSHWT
     I              I8EBNB                          WSEBNB
     I              I8AVWT                          WSAVWT
     I              I8ECNB                          WSECNB
     I              I8WTON                          WSWTON
     I              I8EDNB                          WSEDNB
     I              I8FNWT                          WSFNWT
     I              I8EENB                          WSEENB
     I              I8QTAS                          WSQTAS
     I              I8EFNB                          WSEFNB
     I              I8WAIO                          WSWAIO
     I              I8EGNB                          WSEGNB
     I              I8R3CD                          WSR3CD
     I              I8RGNB                          WSRGNB
     I              I8RHNB                          WSRHNB
     I              I8RINB                          WSRINB
     I              I8XRCD                          WSXRCD
     I              I8UVST                          WSUVST
     I              I8UWST                          WSUWST
     I              I8UXST                          WSUXST
     I              I8VSST                          WSVSST
     I              I8AATM                          WSAATM
     I              I8AYNA                          WSAYNA
     I              I8A0NA                          WSA0NA
     I              I8AXDT                          WSAXDT
      *
     I@JCCPVC
      * PS Prod Schedule          Retrieval index
      * Renamed input format fields
     I              JCAIC3                          WTAIC3
     I              JCV5ST                          WTV5ST
     I              JCELDT                          WTELDT
     I              JCHVHD                          WTHVHD
     I              JCZ6NB                          WTZ6NB
     I              JCZ7NB                          WTZ7NB
     I              JCDGPC                          WTDGPC
     I              JCAVCW                          WTAVCW
     I              JCDIPC                          WTDIPC
     I              JCZ0NB                          WTZ0NB
     I              JCAVLE                          WTAVLE
     I              JCECWG                          WTECWG
     I              JCUVST                          WTUVST
     I              JCUWST                          WTUWST
     I              JCUXST                          WTUXST
     I              JCVSST                          WTVSST
     I              JCAATM                          WTAATM
     I              JCAYNA                          WTAYNA
     I              JCA0NA                          WTA0NA
     I              JCAXDT                          WTAXDT
      *
     I@I8CPXP
      * PS Prod Item Schedule     Co/Itm/Whs/PrdDte/Typ
      * Renamed input format fields
     I              I8AIC3                          WVAIC3
     I              I8V5ST                          WVV5ST
     I              I8ELDT                          WVELDT
     I              I8HGCD                          WVHGCD
     I              I8AJCD                          WVAJCD
     I              I8GPDT                          WVGPDT
     I              I8WTSP                          WVWTSP
     I              I8QTSP                          WVQTSP
     I              I8DJPC                          WVDJPC
     I              I8F8WG                          WVF8WG
     I              I8WTIN                          WVWTIN
     I              I8D5NB                          WVD5NB
     I              I8DXWG                          WVDXWG
     I              I8B2NB                          WVB2NB
     I              I8WTCN                          WVWTCN
     I              I8PSCV                          WVPSCV
     I              I8SAWT                          WVSAWT
     I              I8B9NB                          WVB9NB
     I              I8D1WG                          WVD1WG
     I              I8CBNB                          WVCBNB
     I              I8EZWG                          WVEZWG
     I              I8CCNB                          WVCCNB
     I              I8E0WG                          WVE0WG
     I              I8D6NB                          WVD6NB
     I              I8OAWT                          WVOAWT
     I              I8CDNB                          WVCDNB
     I              I8UNW2                          WVUNW2
     I              I8CENB                          WVCENB
     I              I8F9WG                          WVF9WG
     I              I8BPNB                          WVBPNB
     I              I8GAWG                          WVGAWG
     I              I8BQNB                          WVBQNB
     I              I8GBWG                          WVGBWG
     I              I8BRNB                          WVBRNB
     I              I8GCWG                          WVGCWG
     I              I8BSNB                          WVBSNB
     I              I8GDWG                          WVGDWG
     I              I8BWNB                          WVBWNB
     I              I8GEWG                          WVGEWG
     I              I8PS6U                          WVPS6U
     I              I8WCST                          WVWCST
     I              I8WPST                          WVWPST
     I              I8B5ST                          WVB5ST
     I              I8TFST                          WVTFST
     I              I8TEST                          WVTEST
     I              I8THST                          WVTHST
     I              I8UDST                          WVUDST
     I              I8UFST                          WVUFST
     I              I8UGST                          WVUGST
     I              I8UHST                          WVUHST
     I              I8B6ST                          WVB6ST
     I              I8B7ST                          WVB7ST
     I              I8DVWG                          WVDVWG
     I              I8D7NB                          WVD7NB
     I              I8FCAD                          WVFCAD
     I              I8D9NB                          WVD9NB
     I              I8DWWG                          WVDWWG
     I              I8EANB                          WVEANB
     I              I8SHWT                          WVSHWT
     I              I8EBNB                          WVEBNB
     I              I8AVWT                          WVAVWT
     I              I8ECNB                          WVECNB
     I              I8WTON                          WVWTON
     I              I8EDNB                          WVEDNB
     I              I8FNWT                          WVFNWT
     I              I8EENB                          WVEENB
     I              I8QTAS                          WVQTAS
     I              I8EFNB                          WVEFNB
     I              I8WAIO                          WVWAIO
     I              I8EGNB                          WVEGNB
     I              I8R3CD                          WVR3CD
     I              I8RGNB                          WVRGNB
     I              I8RHNB                          WVRHNB
     I              I8RINB                          WVRINB
     I              I8XRCD                          WVXRCD
     I              I8UVST                          WVUVST
     I              I8UWST                          WVUWST
     I              I8UXST                          WVUXST
     I              I8VSST                          WVVSST
     I              I8AATM                          WVAATM
     I              I8AYNA                          WVAYNA
     I              I8A0NA                          WVA0NA
     I              I8AXDT                          WVAXDT
      *
     I@AFREPU
      * Calendar                  RSQ Co/Date Descending
      * Renamed input format fields
     I              AFAIC3                          WWAIC3
     I              AFBCDT                          WWBCDT
     I              AFCQNB                          WWCQNB
     I              AFESNB                          WWESNB
     I              AFETNB                          WWETNB
     I              AFBZNB                          WWBZNB
     I              AFA9ST                          WWA9ST
     I              AFEINB                          WWEINB
     I              AFC5ST                          WWC5ST
     I              AFAQNB                          WWAQNB
     I              AFCMST                          WWCMST
     I              AFV9ST                          WWV9ST
     I              AFWAST                          WWWAST
     I              AFX2ST                          WWX2ST
     I              AFOJDT                          WWOJDT
     I              AFNQNX                          WWNQNX
     I              AFNRNX                          WWNRNX
     I              AFI9SX                          WWI9SX
     I              AFJASX                          WWJASX
     I              AFOKDT                          WWOKDT
     I              AFOLDT                          WWOLDT
     I              AFUVST                          WWUVST
     I              AFUWST                          WWUWST
     I              AFUXST                          WWUXST
     I              AFAATM                          WWAATM
     I              AFAYNA                          WWAYNA
     I              AFA0NA                          WWA0NA
     I              AFAXDT                          WWAXDT
      *
     I@AFREYY
      * Calendar                  Co/Date               NV
      * Renamed input format fields
     I              AFAIC3                          WXAIC3
     I              AFBCDT                          WXBCDT
     I              AFCQNB                          WXCQNB
     I              AFESNB                          WXESNB
     I              AFETNB                          WXETNB
     I              AFBZNB                          WXBZNB
     I              AFA9ST                          WXA9ST
     I              AFEINB                          WXEINB
     I              AFC5ST                          WXC5ST
     I              AFAQNB                          WXAQNB
     I              AFCMST                          WXCMST
     I              AFV9ST                          WXV9ST
     I              AFWAST                          WXWAST
     I              AFX2ST                          WXX2ST
     I              AFOJDT                          WXOJDT
     I              AFNQNX                          WXNQNX
     I              AFNRNX                          WXNRNX
     I              AFI9SX                          WXI9SX
     I              AFJASX                          WXJASX
     I              AFOKDT                          WXOKDT
     I              AFOLDT                          WXOLDT
     I              AFUVST                          WXUVST
     I              AFUWST                          WXUWST
     I              AFUXST                          WXUXST
     I              AFAATM                          WXAATM
     I              AFAYNA                          WXAYNA
     I              AFA0NA                          WXA0NA
     I              AFAXDT                          WXAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IQPDKN1    E DSPDKNCPL0
      * UPD : Order Detail Schedule     Update index
      * Renamed input format fields
     I              KNAIC3                          WEAIC3
     I              KNC4NB                          WEC4NB
     I              KNDPNB                          WEDPNB
     I              KNUENB                          WEUENB
     I              KNJGDT                          WEJGDT
     I              KNAODT                          WEAODT
     I              KNAJCD                          WEAJCD
     I              KNAYAA                          WEAYAA
     I              KNHGCD                          WEHGCD
     I              KNIGQT                          WEIGQT
     I              KNFLWG                          WEFLWG
     I              KNIUQT                          WEIUQT
     I              KNF3WG                          WEF3WG
     I              KNIVQT                          WEIVQT
     I              KNF4WG                          WEF4WG
     I              KNP7ST                          WEP7ST
     I              KNP8ST                          WEP8ST
     I              KNQAST                          WEQAST
     I              KNUVST                          WEUVST
     I              KNUWST                          WEUWST
     I              KNUXST                          WEUXST
     I              KNVSST                          WEVSST
     I              KNAATM                          WEAATM
     I              KNAYNA                          WEAYNA
     I              KNA0NA                          WEA0NA
     I              KNAXDT                          WEAXDT
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPOB51    E DSPOB5CPL0
      * UPD : Order Detail Sched-Inv    Update index
      * Renamed input format fields
     I              B5AIC3                          WGAIC3
     I              B5C4NB                          WGC4NB
     I              B5DPNB                          WGDPNB
     I              B5UENB                          WGUENB
     I              B5JGDT                          WGJGDT
     I              B5AODT                          WGAODT
     I              B5AJCD                          WGAJCD
     I              B5HGCD                          WGHGCD
     I              B5IUQT                          WGIUQT
     I              B5F3WG                          WGF3WG
     I              B5UVST                          WGUVST
     I              B5UWST                          WGUWST
     I              B5UXST                          WGUXST
     I              B5VSST                          WGVSST
     I              B5AATM                          WGAATM
     I              B5AYNA                          WGAYNA
     I              B5A0NA                          WGA0NA
     I              B5AXDT                          WGAXDT
      *
     IQPOB61    E DSPOB6CPL0
      * UPD : Order Detail Sched-Shortg Update index
      * Renamed input format fields
     I              B6AIC3                          WIAIC3
     I              B6C4NB                          WIC4NB
     I              B6DPNB                          WIDPNB
     I              B6UENB                          WIUENB
     I              B6JGDT                          WIJGDT
     I              B6AODT                          WIAODT
     I              B6AJCD                          WIAJCD
     I              B6NUDT                          WINUDT
     I              B6HGCD                          WIHGCD
     I              B6IGQT                          WIIGQT
     I              B6FLWG                          WIFLWG
     I              B6NSQT                          WINSQT
     I              B6JQWG                          WIJQWG
     I              B6NVDT                          WINVDT
     I              B6BUTM                          WIBUTM
     I              B6UVST                          WIUVST
     I              B6UWST                          WIUWST
     I              B6UXST                          WIUXST
     I              B6VSST                          WIVSST
     I              B6AATM                          WIAATM
     I              B6AYNA                          WIAYNA
     I              B6A0NA                          WIA0NA
     I              B6AXDT                          WIAXDT
      *
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WJAIC3
     I              OMC4NB                          WJC4NB
     I              OMDPNB                          WJDPNB
     I              OMUENB                          WJUENB
     I              OMHGCD                          WJHGCD
     I              OMAJCD                          WJAJCD
     I              OMBKC7                          WJBKC7
     I              OMCFC7                          WJCFC7
     I              OMGMST                          WJGMST
     I              OMGNST                          WJGNST
     I              OMMAVA                          WJMAVA
     I              OMKDVA                          WJKDVA
     I              OML8VA                          WJL8VA
     I              OML9VA                          WJL9VA
     I              OMGTST                          WJGTST
     I              OMGVST                          WJGVST
     I              OMGUST                          WJGUST
     I              OMQFST                          WJQFST
     I              OMAYVA                          WJAYVA
     I              OMEXDT                          WJEXDT
     I              OMLQCD                          WJLQCD
     I              OMRDCD                          WJRDCD
     I              OMQ7CD                          WJQ7CD
     I              OMBZPR                          WJBZPR
     I              OML6NB                          WJL6NB
     I              OMU1ST                          WJU1ST
     I              OMGIDT                          WJGIDT
     I              OMCRCD                          WJCRCD
     I              OMAGCD                          WJAGCD
     I              OMRZST                          WJRZST
     I              OMR0ST                          WJR0ST
     I              OMR1ST                          WJR1ST
     I              OMG7NA                          WJG7NA
     I              OMG8NA                          WJG8NA
     I              OMRPCD                          WJRPCD
     I              OMVEST                          WJVEST
     I              OMVGST                          WJVGST
     I              OMAVST                          WJAVST
     I              OMU0ST                          WJU0ST
     I              OMRFCD                          WJRFCD
     I              OMFZST                          WJFZST
     I              OMR1NB                          WJR1NB
     I              OMAVQT                          WJAVQT
     I              OMD0WG                          WJD0WG
     I              OMCCQT                          WJCCQT
     I              OMAUWG                          WJAUWG
     I              OMCBQT                          WJCBQT
     I              OMATWG                          WJATWG
     I              OMAQCS                          WJAQCS
     I              OMAGCS                          WJAGCS
     I              OMAKPR                          WJAKPR
     I              OMALPR                          WJALPR
     I              OMAUPR                          WJAUPR
     I              OMAVWG                          WJAVWG
     I              OMA4WG                          WJA4WG
     I              OMA5DT                          WJA5DT
     I              OMAODT                          WJAODT
     I              OMGNDT                          WJGNDT
     I              OMAMST                          WJAMST
     I              OMANST                          WJANST
     I              OMVAST                          WJVAST
     I              OMRGNB                          WJRGNB
     I              OMRHNB                          WJRHNB
     I              OMRINB                          WJRINB
     I              OMRBCD                          WJRBCD
     I              OMHICD                          WJHICD
     I              OMRNCD                          WJRNCD
     I              OMROCD                          WJROCD
     I              OMCXDT                          WJCXDT
     I              OMAJVN                          WJAJVN
     I              OMKXCD                          WJKXCD
     I              OMJPCD                          WJJPCD
     I              OMCQCD                          WJCQCD
     I              OMR4CD                          WJR4CD
     I              OMZ1ST                          WJZ1ST
     I              OMZ3ST                          WJZ3ST
     I              OMZ4ST                          WJZ4ST
     I              OMDUPR                          WJDUPR
     I              OMB6VL                          WJB6VL
     I              OMA1AA                          WJA1AA
     I              OMFZSX                          WJFZSX
     I              OMF0SX                          WJF0SX
     I              OMF1SX                          WJF1SX
     I              OMF2SX                          WJF2SX
     I              OMF3SX                          WJF3SX
     I              OMF4SX                          WJF4SX
     I              OMF5SX                          WJF5SX
     I              OMF6SX                          WJF6SX
     I              OMF7SX                          WJF7SX
     I              OMNTDT                          WJNTDT
     I              OMNUDT                          WJNUDT
     I              OMNVDT                          WJNVDT
     I              OMNWDT                          WJNWDT
     I              OMNXDT                          WJNXDT
     I              OMBUTM                          WJBUTM
     I              OMBVTM                          WJBVTM
     I              OMBWTM                          WJBWTM
     I              OMBXTM                          WJBXTM
     I              OMBYTM                          WJBYTM
     I              OMH5NX                          WJH5NX
     I              OMH6NX                          WJH6NX
     I              OMH7NX                          WJH7NX
     I              OMH8NX                          WJH8NX
     I              OMH9NX                          WJH9NX
     I              OMDVPR                          WJDVPR
     I              OMDWPR                          WJDWPR
     I              OMDXPR                          WJDXPR
     I              OMDYPR                          WJDYPR
     I              OMDZPR                          WJDZPR
     I              OMUVST                          WJUVST
     I              OMUWST                          WJUWST
     I              OMUXST                          WJUXST
     I              OMAATM                          WJAATM
     I              OMAYNA                          WJAYNA
     I              OMA0NA                          WJA0NA
     I              OMAXDT                          WJAXDT
      *
     IYARDCS      DS                            469
     IYBRDCS      DS                             69
     IYCRDCS      DS                            100
     IQPDI81    E DSPDI8CPL0
      * UPD : PS Prod Item Schedule     Update index
      * Renamed input format fields
     I              I8AIC3                          WSAIC3
     I              I8V5ST                          WSV5ST
     I              I8ELDT                          WSELDT
     I              I8HGCD                          WSHGCD
     I              I8AJCD                          WSAJCD
     I              I8GPDT                          WSGPDT
     I              I8WTSP                          WSWTSP
     I              I8QTSP                          WSQTSP
     I              I8DJPC                          WSDJPC
     I              I8F8WG                          WSF8WG
     I              I8WTIN                          WSWTIN
     I              I8D5NB                          WSD5NB
     I              I8DXWG                          WSDXWG
     I              I8B2NB                          WSB2NB
     I              I8WTCN                          WSWTCN
     I              I8PSCV                          WSPSCV
     I              I8SAWT                          WSSAWT
     I              I8B9NB                          WSB9NB
     I              I8D1WG                          WSD1WG
     I              I8CBNB                          WSCBNB
     I              I8EZWG                          WSEZWG
     I              I8CCNB                          WSCCNB
     I              I8E0WG                          WSE0WG
     I              I8D6NB                          WSD6NB
     I              I8OAWT                          WSOAWT
     I              I8CDNB                          WSCDNB
     I              I8UNW2                          WSUNW2
     I              I8CENB                          WSCENB
     I              I8F9WG                          WSF9WG
     I              I8BPNB                          WSBPNB
     I              I8GAWG                          WSGAWG
     I              I8BQNB                          WSBQNB
     I              I8GBWG                          WSGBWG
     I              I8BRNB                          WSBRNB
     I              I8GCWG                          WSGCWG
     I              I8BSNB                          WSBSNB
     I              I8GDWG                          WSGDWG
     I              I8BWNB                          WSBWNB
     I              I8GEWG                          WSGEWG
     I              I8PS6U                          WSPS6U
     I              I8WCST                          WSWCST
     I              I8WPST                          WSWPST
     I              I8B5ST                          WSB5ST
     I              I8TFST                          WSTFST
     I              I8TEST                          WSTEST
     I              I8THST                          WSTHST
     I              I8UDST                          WSUDST
     I              I8UFST                          WSUFST
     I              I8UGST                          WSUGST
     I              I8UHST                          WSUHST
     I              I8B6ST                          WSB6ST
     I              I8B7ST                          WSB7ST
     I              I8DVWG                          WSDVWG
     I              I8D7NB                          WSD7NB
     I              I8FCAD                          WSFCAD
     I              I8D9NB                          WSD9NB
     I              I8DWWG                          WSDWWG
     I              I8EANB                          WSEANB
     I              I8SHWT                          WSSHWT
     I              I8EBNB                          WSEBNB
     I              I8AVWT                          WSAVWT
     I              I8ECNB                          WSECNB
     I              I8WTON                          WSWTON
     I              I8EDNB                          WSEDNB
     I              I8FNWT                          WSFNWT
     I              I8EENB                          WSEENB
     I              I8QTAS                          WSQTAS
     I              I8EFNB                          WSEFNB
     I              I8WAIO                          WSWAIO
     I              I8EGNB                          WSEGNB
     I              I8R3CD                          WSR3CD
     I              I8RGNB                          WSRGNB
     I              I8RHNB                          WSRHNB
     I              I8RINB                          WSRINB
     I              I8XRCD                          WSXRCD
     I              I8UVST                          WSUVST
     I              I8UWST                          WSUWST
     I              I8UXST                          WSUXST
     I              I8VSST                          WSVSST
     I              I8AATM                          WSAATM
     I              I8AYNA                          WSAYNA
     I              I8A0NA                          WSA0NA
     I              I8AXDT                          WSAXDT
      *
     IYDRDCS      DS                            326
     IYERDCS      DS                            100
     IYFRDCS      DS                            326
     IYGRDCS      DS                            469
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Detail Schedule
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Order Number
     I                                    P   3   60P1C4NB
      * I :  Order Sequence Number
     I                                    P   7   80P1DPNB
      * I :  Order Secondary Line Seq
     I                                    P   9  100P1UENB
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
     C           P1DPNB    PARM           WP0003  30       Order Sequence
     C           P1UENB    PARM           WP0004  30       Order Secondary
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * UPS Re-Alc Inv/Prd OR XF
      * UPS Re-Alc Inv/Prd OR RT - Order Detail  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * UPS Re-Alc Inv/Prd OR RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * LCL.Ship Date USR = JOB.*Job date + CON.5 *DAYS
     C           ##JDT     ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD5         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111110' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0001
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0001
     C                     END
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
     C                     KFLD           WADPNB           Order Sequence
     C                     KFLD           WAUENB           Order Secondary
      * Setup key
     C                     Z-ADDP1AIC3    WAAIC3           Company Number
     C                     Z-ADDP1C4NB    WAC4NB           Order Number
     C                     Z-ADDP1DPNB    WADPNB           Order Sequence
     C                     Z-ADDP1UENB    WAUENB           Order Secondary
      * Establish starting position
     C           KRSSA     CHAIN@BGWKL1              90    *
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Conf/Comp/Canc
     C           WAGMST    IFEQ 'X'                        *IF
     C           WAGMST    OREQ 'C'
     C           WAGMST    OREQ 'R'
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     Z-ADD*ZERO     WN0001 155       System Value Nu
      *
      * UPS Rtv Company/Item  IF
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0001           Company Number
     C                     Z-ADDWAHGCD    WL0002           Item Code
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    WUAVNA    P      Description Lin
     C                     MOVELWL0004    YL0002    P      U/M - Primary
     C                     Z-ADDWL0005    YL0003           Unit Weight
     C                     Z-ADDWL0006    WURINB           Item Structure
     C                     Z-ADDWL0007    WURHNB           Item Structure
     C                     Z-ADDWL0008    WURGNB           Item Structure
     C                     MOVELWL0009    WUN0CD    P      Item Type Code
     C                     MOVELWL0010    WUQ1CD    P      Default Warehou
     C                     Z-ADDWL0011    YL0004           Fresh Chilling
     C                     MOVELWL0012    YL0005    P      Base/Conv/Loss
     C                     MOVELWL0013    WUXWST    P      Variety/Rendere
     C                     MOVELWL0014    WUVMST    P      Credit Item Sta
     C                     Z-ADDWL0015    WUSWGH           Std Weight/Head
     C                     Z-ADDWL0016    YL0006           Pieces Per Head
     C                     MOVELWL0017    WUR3CD    P      Department Code
     C                     MOVELWL0018    WUSDCD    P      Group for Packa
     C                     MOVELWL0019    WUX5ST    P      Seconds Item
     C                     MOVELWL0020    YL0007    P      Piece Count Ite
     C                     Z-ADDWL0021    YL0008           Pieces Per Bag
     C                     Z-ADDWL0022    YL0009           Bags Per Unit
     C                     MOVELWL0023    WUSUST    P      Export/Domestic
     C                     MOVELWL0024    WUSVST    P      Print On Schedu
     C                     MOVELWL0025    WUSYST    P      Fresh Inv Alloc
     C                     MOVELWL0026    WUSZST    P      Fresh Sched As
     C                     MOVELWL0027    WUS1ST    P      Frozen Sched As
     C                     MOVELWL0028    WUXRCD    P      Primal Group Co
      * BPS Rtv Whs Info      RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWAAJCD    WL0029    P      Warehouse Code
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0030    YL0010    P      Warehouse Type
     C                     MOVELWL0031    WUXUST    P      Trans Contol AS
     C                     MOVELWL0032    WUT0ST    P      Warehouse Locat
     C                     MOVELWL0033    YL0011    P      Warehouse Std C
     C                     Z-ADDWL0034    YL0012           Warehouse Chill
      * Reallocate Item
      * CASE: 5 days in the future or Not Fresh Warehouse
      *  - c1 OR c2
      *   |- c1    : DB1.Scheduled Ship Date GT LCL.Ship Date USR
      *   |- c2    : DB1.Warehouse Code is Not Guymon Fresh
      *   '-
     C           WAAODT    IFGT YL0001                     *IF
     C           WAAJCD    ORNE 'GP1'                      *OR
      * Dlt Ord Dtl Sched     RT - Order Detail Schedule  * 
     C                     EXSR SDRVGN
      * Del Ord Dtl Sch-Inv   RT - Order Detail Sched-Inv  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0040           Company Number
     C                     Z-ADDWAC4NB    WL0041           Order Number
     C                     Z-ADDWADPNB    WL0042           Order Sequence
     C                     Z-ADDWAUENB    WL0043           Order Secondary
     C                     EXSR SFRVGN
      * Del OrdDtl Sch-Shortg RT - Order Detail Sched-Shortg  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0049           Company Number
     C                     Z-ADDWAC4NB    WL0050           Order Number
     C                     Z-ADDWADPNB    WL0051           Order Sequence
     C                     Z-ADDWAUENB    WL0052           Order Secondary
     C                     EXSR SHRVGN
     C                     Z-ADD*ZERO     YL0013           Quantity Schedu
     C                     Z-ADD*ZERO     YL0014           Weight Schedule
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0001  30       Company Number
     C                     PARM WAC4NB    WQ0002  70       Order Number
     C                     PARM WADPNB    WQ0003  30       Order Sequence
     C                     PARM WAUENB    WQ0004  30       Order Secondary
     C                     PARM WAHGCD    WQ0005  70       Item Code
     C                     PARM WAAJCD    WQ0006  3        Warehouse Code
     C                     PARM WARPCD    WQ0007  1        Age Code
     C                     PARM WAAODT    WQ0008  70       Ship Date USR
     C                     PARM WAAVQT    WQ0009 112       Quantity Ordere
     C                     PARM WAD0WG    WQ0010 112       Weight Ordered
     C           YL0013    PARM YL0013    WQ0011 112       Quantity Schedu
     C           YL0014    PARM YL0014    WQ0012 112       Weight Schedule
     C                     PARM 'OA'      WQ0013  2        ATS Adj Type US
     C                     PARM 'REALC'   WQ0014 10        PSAA Program Na
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Short
      * CASE: LCL.Quantity Scheduled NE DB1.Quantity Ordered
     C           YL0013    IFNE WAAVQT                     *IF
      * CASE: DB1.Scheduled Ship Date LE JOB.*Job date
     C           WAAODT    IFLE ##JDT                      *IF
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0015  30       Company Number
     C                     PARM WAC4NB    WQ0016  70       Order Number
     C                     PARM WADPNB    WQ0017  30       Order Sequence
     C                     PARM WAUENB    WQ0018  30       Order Secondary
     C                     PARM WAHGCD    WQ0019  70       Item Code
     C                     PARM WAAJCD    WQ0020  3        Warehouse Code
     C                     PARM WARPCD    WQ0021  1        Age Code
     C                     PARM WAAODT    WQ0022  70       Ship Date USR
     C                     PARM WAAVQT    WQ0023 112       Quantity Ordere
     C                     PARM WAD0WG    WQ0024 112       Weight Ordered
     C           YL0013    PARM YL0013    WQ0025 112       Quantity Schedu
     C           YL0014    PARM YL0014    WQ0026 112       Weight Schedule
     C                     PARM 'SC'      WQ0027  2        ATS Adj Type US
     C                     PARM @CN,01    WQ0028 10        PSAA Program Na
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0029  30       Company Number
     C                     PARM WAC4NB    WQ0030  70       Order Number
     C                     PARM WADPNB    WQ0031  30       Order Sequence
     C                     PARM WAUENB    WQ0032  30       Order Secondary
     C                     PARM WAHGCD    WQ0033  70       Item Code
     C                     PARM WAAJCD    WQ0034  3        Warehouse Code
     C                     PARM WARPCD    WQ0035  1        Age Code
     C                     PARM WAAODT    WQ0036  70       Ship Date USR
     C                     PARM WACCQT    WQ0037 112       Quantity Ordere
     C                     PARM WAAUWG    WQ0038 112       Weight Ordered
     C           YL0013    PARM YL0013    WQ0039 112       Quantity Schedu
     C           YL0014    PARM YL0014    WQ0040 112       Weight Schedule
     C                     PARM 'AO'      WQ0041  2        ATS Adj Type US
     C                     PARM @CN,02    WQ0042 10        PSAA Program Na
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Chg Qty/Wgt Scheduled CH - Order Detail  * 
     C                     EXSR SJCHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * ******
      * NEED TO VISIT this routine because of schedule as orderd the
      * scheduled quantity when short.    04/02/03
      * Currently we are using the allocate by ship date routine.
      * ******
      * UPS Re-Alc Inv/Prod   RT - Order Detail Schedule  * 
     C                     EXSR SKRVGN
      * CASE: DB1.Quantity Ordered GT LCL.Quantity Scheduled
     C           WAAVQT    IFGT YL0013                     *IF
      * CASE: DB1.Scheduled Ship Date LE JOB.*Job date
     C           WAAODT    IFLE ##JDT                      *IF
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0072  30       Company Number
     C                     PARM WAC4NB    WQ0073  70       Order Number
     C                     PARM WADPNB    WQ0074  30       Order Sequence
     C                     PARM WAUENB    WQ0075  30       Order Secondary
     C                     PARM WAHGCD    WQ0076  70       Item Code
     C                     PARM WAAJCD    WQ0077  3        Warehouse Code
     C                     PARM WARPCD    WQ0078  1        Age Code
     C                     PARM WAAODT    WQ0079  70       Ship Date USR
     C                     PARM WAAVQT    WQ0080 112       Quantity Ordere
     C                     PARM WAD0WG    WQ0081 112       Weight Ordered
     C           YL0013    PARM YL0013    WQ0082 112       Quantity Schedu
     C           YL0014    PARM YL0014    WQ0083 112       Weight Schedule
     C                     PARM 'SC'      WQ0084  2        ATS Adj Type US
     C                     PARM @CN,01    WQ0085 10        PSAA Program Na
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0086  30       Company Number
     C                     PARM WAC4NB    WQ0087  70       Order Number
     C                     PARM WADPNB    WQ0088  30       Order Sequence
     C                     PARM WAUENB    WQ0089  30       Order Secondary
     C                     PARM WAHGCD    WQ0090  70       Item Code
     C                     PARM WAAJCD    WQ0091  3        Warehouse Code
     C                     PARM WARPCD    WQ0092  1        Age Code
     C                     PARM WAAODT    WQ0093  70       Ship Date USR
     C                     PARM WAAVQT    WQ0094 112       Quantity Ordere
     C                     PARM WAAVQT    WQ0095 112       Weight Ordered
     C           YL0013    PARM YL0013    WQ0096 112       Quantity Schedu
     C           YL0014    PARM YL0014    WQ0097 112       Weight Schedule
     C                     PARM 'AO'      WQ0098  2        ATS Adj Type US
     C                     PARM @CN,02    WQ0099 10        PSAA Program Na
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Chg Qty/WgtSch & Shrt CH - Order Detail  * 
     C                     EXSR THCHRC
     C                     END                             *FI
     C                     END                             *FI
      * EDT Post Open Orders   XF - Order Header TRG  * 
     C                     CALL 'PDHRXFR'              90  EDT Post Open O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0100  30       Company Number
     C                     PARM WAC4NB    WQ0101  70       Order Number
     C                     PARM WABKC7    WQ0102  70       Ship To Custome
     C           WUJZVA    PARM WUJZVA    WQ0103 112       Order Value Tot
     C           WUA1WG    PARM *ZERO     WQ0104 112       Order Weight To
     C                     PARM 'PS'      WQ0105  3        Pricing Event C
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0001    WBAIC3           Company Number
     C                     Z-ADDWL0002    WBHGCD           Item Code
      * Establish starting position
     C           KRSSB     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0003           Description Lin
     C                     MOVEL*BLANK    WL0004           U/M - Primary
     C                     Z-ADD*ZERO     WL0005           Unit Weight
     C                     Z-ADD*ZERO     WL0006           Item Structure
     C                     Z-ADD*ZERO     WL0007           Item Structure
     C                     Z-ADD*ZERO     WL0008           Item Structure
     C                     MOVEL*BLANK    WL0009           Item Type Code
     C                     MOVEL*BLANK    WL0010           Default Warehou
     C                     Z-ADD*ZERO     WL0011           Fresh Chilling
     C                     MOVEL*BLANK    WL0012           Base/Conv/Loss
     C                     MOVEL*BLANK    WL0013           Variety/Rendere
     C                     MOVEL*BLANK    WL0014           Credit Item Sta
     C                     Z-ADD*ZERO     WL0015           Std Weight/Head
     C                     Z-ADD*ZERO     WL0016           Pieces Per Head
     C                     MOVEL*BLANK    WL0017           Department Code
     C                     MOVEL*BLANK    WL0018           Group for Packa
     C                     MOVEL*BLANK    WL0019           Seconds Item
     C                     MOVEL*BLANK    WL0020           Piece Count Ite
     C                     Z-ADD*ZERO     WL0021           Pieces Per Bag
     C                     Z-ADD*ZERO     WL0022           Bags Per Unit
     C                     MOVEL*BLANK    WL0023           Export/Domestic
     C                     MOVEL*BLANK    WL0024           Print On Schedu
     C                     MOVEL*BLANK    WL0025           Fresh Inv Alloc
     C                     MOVEL*BLANK    WL0026           Fresh Sched As
     C                     MOVEL*BLANK    WL0027           Frozen Sched As
     C                     MOVEL*BLANK    WL0028           Primal Group Co
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBAVNA    WL0003           Description Lin
     C                     MOVELWBADCD    WL0004           U/M - Primary
     C                     Z-ADDWBAIWG    WL0005           Unit Weight
     C                     Z-ADDWBRINB    WL0006           Item Structure
     C                     Z-ADDWBRHNB    WL0007           Item Structure
     C                     Z-ADDWBRGNB    WL0008           Item Structure
     C                     MOVELWBN0CD    WL0009           Item Type Code
     C                     MOVELWBQ1CD    WL0010           Default Warehou
     C                     Z-ADDWBCHTM    WL0011           Fresh Chilling
     C                     MOVELWBQZCD    WL0012           Base/Conv/Loss
     C                     MOVELWBXWST    WL0013           Variety/Rendere
     C                     MOVELWBVMST    WL0014           Credit Item Sta
     C                     Z-ADDWBSWGH    WL0015           Std Weight/Head
     C                     Z-ADDWBPPHE    WL0016           Pieces Per Head
     C                     MOVELWBR3CD    WL0017           Department Code
     C                     MOVELWBSDCD    WL0018           Group for Packa
     C                     MOVELWBX5ST    WL0019           Seconds Item
     C                     MOVELWBPCCT    WL0020           Piece Count Ite
     C                     Z-ADDWBBDNB    WL0021           Pieces Per Bag
     C                     Z-ADDWBBJNB    WL0022           Bags Per Unit
     C                     MOVELWBSUST    WL0023           Export/Domestic
     C                     MOVELWBSVST    WL0024           Print On Schedu
     C                     MOVELWBSYST    WL0025           Fresh Inv Alloc
     C                     MOVELWBSZST    WL0026           Fresh Sched As
     C                     MOVELWBS1ST    WL0027           Frozen Sched As
     C                     MOVELWBXRCD    WL0028           Primal Group Co
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * BPS Rtv Whs Info      RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0029    WCAJCD           Warehouse Code
      * Establish starting position
     C           KRSSC     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0030           Warehouse Type
     C                     MOVEL*BLANK    WL0031           Trans Contol AS
     C                     MOVEL*BLANK    WL0032           Warehouse Locat
     C                     MOVEL*BLANK    WL0033           Warehouse Std C
     C                     Z-ADD*ZERO     WL0034           Warehouse Chill
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCWPST    WL0030           Warehouse Type
     C                     MOVELWCXUST    WL0031           Trans Contol AS
     C                     MOVELWCT0ST    WL0032           Warehouse Locat
     C                     MOVELWCT1ST    WL0033           Warehouse Std C
     C                     Z-ADDWCDBNB    WL0034           Warehouse Chill
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Dlt Ord Dtl Sched     RT - Order Detail Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSD01           Company Number
     C           *LIKE     DEFN WDC4NB    WQSD02           Order Number
     C           *LIKE     DEFN WDDPNB    WQSD03           Order Sequence
     C           *LIKE     DEFN WDUENB    WQSD04           Order Secondary
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Order Number
     C                     KFLD           WQSD03           Order Sequence
     C                     KFLD           WQSD04           Order Secondary
      * Setup key
     C                     Z-ADDP1AIC3    WQSD01           Company Number
     C                     Z-ADDWAC4NB    WQSD02           Order Number
     C                     Z-ADDWADPNB    WQSD03           Order Sequence
     C                     Z-ADDWAUENB    WQSD04           Order Secondary
      * Establish starting position
     C           KRSSD     SETLL@KNCPHO                    *
     C           KRSSD     READE@KNCPHO                  90*
      * Data record not found
     C   90                MOVEL'USR2238' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DLT Ord Detail Sched   DL - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0035           Company Number
     C                     Z-ADDWDC4NB    WL0036           Order Number
     C                     Z-ADDWDDPNB    WL0037           Order Sequence
     C                     Z-ADDWDUENB    WL0038           Order Secondary
     C                     Z-ADDWDJGDT    WL0039           OD Production D
     C                     EXSR SEDLRC
     C           KRSSD     READE@KNCPHO                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SEDLRC    BEGSR
      *================================================================
      * DLT Ord Detail Sched   DL - Order Detail Schedule  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @KNCPHN
     C                     Z-ADDWL0035    WEAIC3           Company Number
     C                     Z-ADDWL0036    WEC4NB           Order Number
     C                     Z-ADDWL0037    WEDPNB           Order Sequence
     C                     Z-ADDWL0038    WEUENB           Order Secondary
     C                     Z-ADDWL0039    WEJGDT           OD Production D
      *
     C           KLDLSE    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
     C                     KFLD           WEJGDT           OD Production D
     C           KLDLSE    CHAIN@KNCPHN              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDKNCPL0'MDACP
     C                     MOVEL'@KNCPHN' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@KNCPHN                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Del Ord Dtl Sch-Inv   RT - Order Detail Sched-Inv  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSF01           Company Number
     C           *LIKE     DEFN WFC4NB    WQSF02           Order Number
     C           *LIKE     DEFN WFDPNB    WQSF03           Order Sequence
     C           *LIKE     DEFN WFUENB    WQSF04           Order Secondary
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Order Number
     C                     KFLD           WQSF03           Order Sequence
     C                     KFLD           WQSF04           Order Secondary
      * Setup key
     C                     Z-ADDWL0040    WQSF01           Company Number
     C                     Z-ADDWL0041    WQSF02           Order Number
     C                     Z-ADDWL0042    WQSF03           Order Sequence
     C                     Z-ADDWL0043    WQSF04           Order Secondary
      * Establish starting position
     C           KRSSF     SETLL@B5CPM2                    *
     C           KRSSF     READE@B5CPM2                  90*
      * Data record not found
     C   90                MOVEL'USR3150' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Delete Order Detail Sched - Order Detail Sched-Inv  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWFAIC3    WL0044           Company Number
     C                     Z-ADDWFC4NB    WL0045           Order Number
     C                     Z-ADDWFDPNB    WL0046           Order Sequence
     C                     Z-ADDWFUENB    WL0047           Order Secondary
     C                     Z-ADDWFJGDT    WL0048           OD Production D
     C                     EXSR SGDLRC
     C           KRSSF     READE@B5CPM2                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGDLRC    BEGSR
      *================================================================
      * Delete Order Detail Sched - Order Detail Sched-Inv  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B5CPM1
     C                     Z-ADDWL0044    WGAIC3           Company Number
     C                     Z-ADDWL0045    WGC4NB           Order Number
     C                     Z-ADDWL0046    WGDPNB           Order Sequence
     C                     Z-ADDWL0047    WGUENB           Order Secondary
     C                     Z-ADDWL0048    WGJGDT           OD Production D
      *
     C           KLDLSG    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGC4NB           Order Number
     C                     KFLD           WGDPNB           Order Sequence
     C                     KFLD           WGUENB           Order Secondary
     C                     KFLD           WGJGDT           OD Production D
     C           KLDLSG    CHAIN@B5CPM1              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POB5CPL0'MDACP
     C                     MOVEL'@B5CPM1' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B5CPM1                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Del OrdDtl Sch-Shortg RT - Order Detail Sched-Shortg  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHAIC3    WQSH01           Company Number
     C           *LIKE     DEFN WHC4NB    WQSH02           Order Number
     C           *LIKE     DEFN WHDPNB    WQSH03           Order Sequence
     C           *LIKE     DEFN WHUENB    WQSH04           Order Secondary
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WQSH02           Order Number
     C                     KFLD           WQSH03           Order Sequence
     C                     KFLD           WQSH04           Order Secondary
      * Setup key
     C                     Z-ADDWL0049    WQSH01           Company Number
     C                     Z-ADDWL0050    WQSH02           Order Number
     C                     Z-ADDWL0051    WQSH03           Order Sequence
     C                     Z-ADDWL0052    WQSH04           Order Secondary
      * Establish starting position
     C           KRSSH     SETLL@B6CPNB                    *
     C           KRSSH     READE@B6CPNB                  90*
      * Data record not found
     C   90                MOVEL'USR3152' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del OrdDtl Sch-Shortg DL - Order Detail Sched-Shortg  * 
     C                     EXSR SIDLRC
     C           KRSSH     READE@B6CPNB                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIDLRC    BEGSR
      *================================================================
      * Del OrdDtl Sch-Shortg DL - Order Detail Sched-Shortg  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B6CPNA
     C                     Z-ADDWHAIC3    WIAIC3           Company Number
     C                     Z-ADDWHC4NB    WIC4NB           Order Number
     C                     Z-ADDWHDPNB    WIDPNB           Order Sequence
     C                     Z-ADDWHUENB    WIUENB           Order Secondary
     C                     Z-ADDWHJGDT    WIJGDT           OD Production D
      *
     C           KLDLSI    KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIC4NB           Order Number
     C                     KFLD           WIDPNB           Order Sequence
     C                     KFLD           WIUENB           Order Secondary
     C                     KFLD           WIJGDT           OD Production D
     C           KLDLSI    CHAIN@B6CPNA              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POB6CPL0'MDACP
     C                     MOVEL'@B6CPNA' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B6CPNA                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCHRC    BEGSR
      *================================================================
      * Chg Qty/Wgt Scheduled CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0002  70       Item Code
     C                     MOVEL*BLANK    WN0003  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0004  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0005  70       Order Group Cod
     C                     MOVEL*BLANK    WN0006  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0007  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0008 112       Billing Detail
     C                     Z-ADD*ZERO     WN0009 112       Billing Detail
     C                     Z-ADD*ZERO     WN0010 112       Billing Detail
     C                     Z-ADD*ZERO     WN0011 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0012  1        Comment Print A
     C                     MOVEL*BLANK    WN0013  1        Comment Print I
     C                     MOVEL*BLANK    WN0014  1        Comment Print P
     C                     MOVEL*BLANK    WN0015  1        Comment Print S
     C                     Z-ADD*ZERO     WN0016 112       Extended Amount
     C                     Z-ADD*ZERO     WN0017  70       Market Pricing
     C                     MOVEL*BLANK    WN0018  3        Commodity Marke
     C                     MOVEL*BLANK    WN0019  3        Date Method Cod
     C                     MOVEL*BLANK    WN0020  3        Price Method Co
     C                     Z-ADD*ZERO     WN0021 114       Price Overage O
     C                     Z-ADD*ZERO     WN0022  70       Contract Number
     C                     MOVEL*BLANK    WN0023  1        Price Status
     C                     Z-ADD*ZERO     WN0024  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0025  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0026  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0027  1        Work Confirm St
     C                     MOVEL*BLANK    WN0028  1        Work Over/Short
     C                     MOVEL*BLANK    WN0029  1        Work Extra Stat
     C                     MOVEL*BLANK    WN0030 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0031 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0032  1        Age Code
     C                     MOVEL*BLANK    WN0033  1        Palletize
     C                     MOVEL*BLANK    WN0034  1        Slip Sheet
     C                     MOVEL*BLANK    WN0035  1        Catch Weight St
     C                     MOVEL*BLANK    WN0036  1        Price Audit
     C                     MOVEL*BLANK    WN0037  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0038  1        Production Date
     C                     Z-ADD*ZERO     WN0039 112       Rated Freight
     C                     Z-ADD*ZERO     WN0040 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0041 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0042 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0043 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0044 114       Unit Cost Order
     C                     Z-ADD*ZERO     WN0045 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0046 114       Unit Price
     C                     Z-ADD*ZERO     WN0047 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0048 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0049 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0050 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0051  70       Requested Ship
     C                     Z-ADD*ZERO     WN0052  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0053  70       Actual Shipped
     C                     MOVEL*BLANK    WN0054  1        Affect Inventor
     C                     MOVEL*BLANK    WN0055  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0056  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0057  30       Item Structure
     C                     Z-ADD*ZERO     WN0058  30       Item Structure
     C                     Z-ADD*ZERO     WN0059  30       Item Structure
     C                     MOVEL*BLANK    WN0060  2        Item Level
     C                     MOVEL*BLANK    WN0061  2        Quality Level
     C                     MOVEL*BLANK    WN0062  2        Pricing Product
     C                     MOVEL*BLANK    WN0063  2        Season Product
     C                     Z-ADD*ZERO     WN0064  70       Date of Origina
     C                     MOVEL*BLANK    WN0065 10        User Profile Na
     C                     MOVEL*BLANK    WN0066  6        Country Code
     C                     MOVEL*BLANK    WN0067  2        Event Code
     C                     MOVEL*BLANK    WN0068  3        Reason Code
     C                     MOVEL*BLANK    WN0069  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0070  1        Modified Flag
     C                     MOVEL*BLANK    WN0071  1        Substituted Fla
     C                     MOVEL*BLANK    WN0072  1        Order Detail St
     C                     Z-ADD*ZERO     WN0073 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0074 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0075  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0076  1        OD Schedule Sho
     C                     MOVEL*BLANK    WN0077  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0078  1        Affect Commissi
     C                     MOVEL*BLANK    WN0079  1        Affect Pricing
     C                     MOVEL*BLANK    WN0080  1        OD Unused Sts 5
     C                     MOVEL*BLANK    WN0081  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0082  2        OD Unused Sts 7
     C                     MOVEL*BLANK    WN0083  3        OD Unused Sts 8
     C                     MOVEL*BLANK    WN0084  3        OD Unused Sts 9
     C                     Z-ADD*ZERO     WN0085  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0086  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0087  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0088  70       OD Unused Date
     C                     Z-ADD*ZERO     WN0089  70       OD Unused Date
     C                     Z-ADD*ZERO     WN0090  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0091  60       Price Code
     C                     Z-ADD*ZERO     WN0092  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0093  60       Substitution Li
     C                     Z-ADD*ZERO     WN0094  60       OD Unused Time
     C                     Z-ADD*ZERO     WN0095 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0096 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0097 112       OD Item Target
     C                     Z-ADD*ZERO     WN0098 112       OD Minimum Unit
     C                     Z-ADD*ZERO     WN0099 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0100 114       OD Unused Prc 1
     C                     Z-ADD*ZERO     WN0101 114       OD Unused Prc 2
     C                     Z-ADD*ZERO     WN0102 114       OD Unused Prc 3
     C                     Z-ADD*ZERO     WN0103 114       OD Unused Prc 4
     C                     Z-ADD*ZERO     WN0104 114       OD Unused Prc 5
     C                     MOVEL*BLANK    WN0105  1        EDI Status 1
     C                     MOVEL*BLANK    WN0106  1        EDI Status 2
     C                     MOVEL*BLANK    WN0107  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0108  60       Job Time
     C                     MOVEL*BLANK    WN0109 10        User Id
     C                     MOVEL*BLANK    WN0110 10        Job Name
     C                     Z-ADD*ZERO     WN0111  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWAAIC3    WJAIC3           Company Number
     C                     Z-ADDWAC4NB    WJC4NB           Order Number
     C                     Z-ADDWADPNB    WJDPNB           Order Sequence
     C                     Z-ADDWAUENB    WJUENB           Order Secondary
      *
     C           KLCHSJ    KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJC4NB           Order Number
     C                     KFLD           WJDPNB           Order Sequence
     C                     KFLD           WJUENB           Order Secondary
     C           KLCHSJ    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YARDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADDYL0013    WJCCQT           Quantity Schedu
     C                     Z-ADDYL0014    WJAUWG           Weight Schedule
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL##USR     WJAYNA           User Id
     C                     MOVEL##JOB     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * UPS Re-Alc Inv/Prod   RT - Order Detail Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Del OrdDtl Sch-Shortg RT - Order Detail Sched-Shortg  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0049           Company Number
     C                     Z-ADDWAC4NB    WL0050           Order Number
     C                     Z-ADDWADPNB    WL0051           Order Sequence
     C                     Z-ADDWAUENB    WL0052           Order Secondary
     C                     EXSR SHRVGN
      * Del Ord Dtl Sch-Inv   RT - Order Detail Sched-Inv  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0040           Company Number
     C                     Z-ADDWAC4NB    WL0041           Order Number
     C                     Z-ADDWADPNB    WL0042           Order Sequence
     C                     Z-ADDWAUENB    WL0043           Order Secondary
     C                     EXSR SFRVGN
     C                     MOVEL*BLANK    YL0015           OD Schedule Sho
     C                     Z-ADD*ZERO     YL0013           Quantity Schedu
     C                     Z-ADD*ZERO     YL0014           Weight Schedule
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKAIC3    WQSK01           Company Number
     C           *LIKE     DEFN WKC4NB    WQSK02           Order Number
     C           *LIKE     DEFN WKDPNB    WQSK03           Order Sequence
     C           *LIKE     DEFN WKUENB    WQSK04           Order Secondary
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           Company Number
     C                     KFLD           WQSK02           Order Number
     C                     KFLD           WQSK03           Order Sequence
     C                     KFLD           WQSK04           Order Secondary
      * Setup key
     C                     Z-ADDWAAIC3    WQSK01           Company Number
     C                     Z-ADDWAC4NB    WQSK02           Order Number
     C                     Z-ADDWADPNB    WQSK03           Order Sequence
     C                     Z-ADDWAUENB    WQSK04           Order Secondary
      * Establish starting position
     C           KRSSK     SETLL@KNCPNF                    *
     C           KRSSK     READE@KNCPNF                  90*
      * Data record not found
     C   90                MOVEL'USR2238' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Prd Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWKAIC3    WL0053           Company Number
     C                     Z-ADDWKJGDT    WL0054           Post to G/L Dat
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0055    YL0016    P      Production Day
      * Allocate Inventory/Production
      * CASE: LCL.Production Day Status is yes
     C           YL0016    IFEQ 'Y'                        *IF
      * Production Date < Job Date, Allocate Inventory
      * CASE: DB1.OD Production Date LT JOB.*Job date
     C           WKJGDT    IFLT ##JDT                      *IF
      * Age Limit
      * CASE: PAR.Warehouse Std Chill Time is yes
     C           YL0011    IFEQ 'Y'                        *IF
      * CLC PA Age Limits      IF
     C                     Z-ADD*ZERO     WUDNBU           Day NBR USR
      * 04/10/07 Effective 04/23/07 representation of Age Code changes
      *          will be such that Age Code A will be 0 day for boxes
      *          and combos.  The labels on the cartons will not print
      *          a date that is offset by Sunday or Holiday.  Instead of
      *          Code Date, it will be the Pack Date.
      * Production Date RGT and Production Date RGF
      * CASE: PAR.Chilling Time is Not Entered
     C           YL0012    IFEQ *ZERO                      *IF
     C                     Z-ADDWKAODT    YL0018           Production Date
      * Production Date RGF
      * CASE: PAR.Age Code is A: 0 Day
     C           WARPCD    IFEQ 'A'                        *IF
     C                     Z-ADDYL0018    YL0017           Production Date
     C                     ELSE
      * CASE: PAR.Age Code is B: 1 Day
     C           WARPCD    IFEQ 'B'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-1 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-1        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is C: 2 Day
     C           WARPCD    IFEQ 'C'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-2 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-2        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is D: 3 Day
     C           WARPCD    IFEQ 'D'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-3 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-3        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is E: 4 Day
     C           WARPCD    IFEQ 'E'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-4 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-4        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is F: 5 Day
     C           WARPCD    IFEQ 'F'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-5 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-5        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is G: 6 Day
     C           WARPCD    IFEQ 'G'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-6 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-6        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Age Code is H: 7 Days to 119 Days
      *   |- c2    : PAR.Age Code is I: 120 Days +
      *   '-
     C           WARPCD    IFEQ 'H'                        *IF
     C           WARPCD    OREQ 'I'                        *OR
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-365 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-365      XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C           YL0012    MULT -1        YL0019           Fresh Chilling
      * PAR.Production Date RGT = PAR.Ship Date USR + LCL.Fresh Chilling
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDYL0019    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111110' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0018
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0018
     C                     END
      * Production Date RGF
      * CASE: Age Code is A or B
      *  - c1 OR c2
      *   |- c1    : PAR.Age Code is A: 0 Day
      *   |- c2    : PAR.Age Code is B: 1 Day
      *   '-
     C           WARPCD    IFEQ 'A'                        *IF
     C           WARPCD    OREQ 'B'                        *OR
      * 04/10/07 For chilled product, we should not have any orders
      *          with Age Code of A; however if we do, we will not allow
      *          ship off cut.
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-1 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-1        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is C: 2 Day
     C           WARPCD    IFEQ 'C'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-2 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-2        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is D: 3 Day
     C           WARPCD    IFEQ 'D'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-3 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-3        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is E: 4 Day
     C           WARPCD    IFEQ 'E'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-4 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-4        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is F: 5 Day
     C           WARPCD    IFEQ 'F'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-5 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-5        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is G: 6 Day
     C           WARPCD    IFEQ 'G'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-6 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-6        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Age Code is H: 7 Days to 119 Days
      *   |- c2    : PAR.Age Code is I: 120 Days +
      *   '-
     C           WARPCD    IFEQ 'H'                        *IF
     C           WARPCD    OREQ 'I'                        *OR
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-365 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-365      XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CLC PA Age Limits      IF
     C                     Z-ADD*ZERO     WUDNBU           Day NBR USR
      * 04/10/07 Effective 04/23/07 representation of Age Code changes
      *          will be such that Age Code A will be 0 day for boxes
      *          and combos.  The labels on the cartons will not print
      *          a date that is offset by Sunday or Holiday.  Instead of
      *          Code Date, it will be the Pack Date.
      * Production Date RGT and Production Date RGF
      * CASE: PAR.Chilling Time is Not Entered
     C           YL0004    IFEQ *ZERO                      *IF
     C                     Z-ADDWKAODT    YL0018           Production Date
      * Production Date RGF
      * CASE: PAR.Age Code is A: 0 Day
     C           WARPCD    IFEQ 'A'                        *IF
     C                     Z-ADDYL0018    YL0017           Production Date
     C                     ELSE
      * CASE: PAR.Age Code is B: 1 Day
     C           WARPCD    IFEQ 'B'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-1 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-1        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is C: 2 Day
     C           WARPCD    IFEQ 'C'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-2 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-2        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is D: 3 Day
     C           WARPCD    IFEQ 'D'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-3 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-3        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is E: 4 Day
     C           WARPCD    IFEQ 'E'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-4 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-4        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is F: 5 Day
     C           WARPCD    IFEQ 'F'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-5 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-5        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is G: 6 Day
     C           WARPCD    IFEQ 'G'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-6 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-6        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Age Code is H: 7 Days to 119 Days
      *   |- c2    : PAR.Age Code is I: 120 Days +
      *   '-
     C           WARPCD    IFEQ 'H'                        *IF
     C           WARPCD    OREQ 'I'                        *OR
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-365 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-365      XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C           YL0004    MULT -1        YL0019           Fresh Chilling
      * PAR.Production Date RGT = PAR.Ship Date USR + LCL.Fresh Chilling
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDYL0019    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111110' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0018
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0018
     C                     END
      * Production Date RGF
      * CASE: Age Code is A or B
      *  - c1 OR c2
      *   |- c1    : PAR.Age Code is A: 0 Day
      *   |- c2    : PAR.Age Code is B: 1 Day
      *   '-
     C           WARPCD    IFEQ 'A'                        *IF
     C           WARPCD    OREQ 'B'                        *OR
      * 04/10/07 For chilled product, we should not have any orders
      *          with Age Code of A; however if we do, we will not allow
      *          ship off cut.
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-1 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-1        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is C: 2 Day
     C           WARPCD    IFEQ 'C'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-2 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-2        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is D: 3 Day
     C           WARPCD    IFEQ 'D'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-3 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-3        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is E: 4 Day
     C           WARPCD    IFEQ 'E'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-4 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-4        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is F: 5 Day
     C           WARPCD    IFEQ 'F'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-5 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-5        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is G: 6 Day
     C           WARPCD    IFEQ 'G'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-6 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-6        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Age Code is H: 7 Days to 119 Days
      *   |- c2    : PAR.Age Code is I: 120 Days +
      *   '-
     C           WARPCD    IFEQ 'H'                        *IF
     C           WARPCD    OREQ 'I'                        *OR
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-365 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-365      XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Quantity Ordered
      * LCL.Quantity Ordered =
      *    *COMPUTE (x1 + x2)
      * x1    : DB1.OD Quantity Scheduled
      * +     : PGM.*Synon (15,0) work field
      * x2    : DB1.OD Quantity Inv Sched
     C           WKIGQT    ADD  WKIUQT    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0020           Quantity Ordere
      * Weight Ordered
      * LCL.Weight Ordered =
      *    *COMPUTE (x1 + x2)
      * x1    : DB1.OD Weight Scheduled
      * +     : PGM.*Synon (15,2) work field
      * x2    : DB1.OD Weight Inv Sched
     C           WKFLWG    ADD  WKF3WG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0021           Weight Ordered
      * Delete old record with Prod Date < Job Date
      * DLT Ord Detail Sched   DL - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWKAIC3    WL0035           Company Number
     C                     Z-ADDWKC4NB    WL0036           Order Number
     C                     Z-ADDWKDPNB    WL0037           Order Sequence
     C                     Z-ADDWKUENB    WL0038           Order Secondary
     C                     Z-ADDWKJGDT    WL0039           OD Production D
     C                     EXSR SEDLRC
      * Quantity Ordered > 0
      * CASE: LCL.Quantity Ordered is Greater than zero
     C           YL0020    IFGT *ZERO                      *IF
     C                     Z-ADD##JDT     YL0022           Production Date
     C                     Z-ADD*ZERO     YL0023           Quantity Schedu
     C                     Z-ADD*ZERO     YL0024           Weight Schedule
     C                     Z-ADDYL0020    YL0025           ATS Quantity Ne
     C                     Z-ADDYL0021    YL0026           ATS Weight Need
      * ** This will create the new order detail schedule record **
      *    for the current date.
      *
     C                     Z-ADD*ZERO     WN0112 110       ATS Quantity Av
     C                     Z-ADD*ZERO     WN0113 112       ATS Weight Avai
     C                     Z-ADD*ZERO     WN0114 112       Quantity Alloca
     C                     Z-ADD*ZERO     WN0115  92       Weight Allocate
      *
      * UPD Allocate Inv      IF
      * Allocate Inventory
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Production Date RGF LT JOB.*Job date
      *   |- c2    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0017    IFLT ##JDT                      *IF
     C           YL0025    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * UPD Allocate Inv      RT - PS Prod Item Inventory  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWKAIC3    WL0056           Company Number
     C                     Z-ADDWKHGCD    WL0057           Item Code
     C                     MOVELWKAJCD    WL0058    P      Warehouse Code
     C                     Z-ADDYL0017    WL0059           Production Date
     C                     Z-ADDYL0003    WL0060           Unit Weight
     C                     MOVELYL0007    WL0061    P      Piece Count Ite
     C                     Z-ADDYL0008    WL0062           Pieces Per Bag
     C                     Z-ADDYL0009    WL0063           Bags Per Unit
     C                     Z-ADDWKC4NB    WL0064           Order Number
     C                     Z-ADDWKDPNB    WL0065           Order Sequence
     C                     Z-ADDWKUENB    WL0066           Order Secondary
     C                     Z-ADDYL0020    WL0067           Quantity Ordere
     C                     Z-ADDYL0021    WL0068           Weight Ordered
     C                     Z-ADDYL0023    WL0069           Quantity Schedu
     C                     Z-ADDYL0024    WL0070           Weight Schedule
     C                     Z-ADDYL0025    WL0071           ATS Quantity Ne
     C                     Z-ADDYL0026    WL0072           ATS Weight Need
     C                     Z-ADDWKAODT    WL0073           Ship Date USR
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0069    YL0023           Quantity Schedu
     C                     Z-ADDWL0070    YL0024           Weight Schedule
     C                     Z-ADDWL0071    YL0025           ATS Quantity Ne
     C                     Z-ADDWL0072    YL0026           ATS Weight Need
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  YL0023    YL0013           Quantity Schedu
     C                     ADD  YL0024    YL0014           Weight Schedule
     C                     END                             *FI
      * Production Date > or = Job Date, Allocate Inv, Prod, or Std
      * CASE: DB1.OD Production Date GE JOB.*Job date
     C           WKJGDT    IFGE ##JDT                      *IF
     C                     Z-ADDWKJGDT    YL0022           Production Date
     C                     Z-ADDWKIUQT    YL0031           OD Quantity Inv
     C                     Z-ADDWKF3WG    YL0032           OD Weight Inv S
     C                     Z-ADDWKIGQT    YL0033           OD Quantity Sch
     C                     Z-ADDWKFLWG    YL0034           OD Weight Sched
      * Delete old record with Prod Date < Job Date
      * DLT Ord Detail Sched   DL - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWKAIC3    WL0035           Company Number
     C                     Z-ADDWKC4NB    WL0036           Order Number
     C                     Z-ADDWKDPNB    WL0037           Order Sequence
     C                     Z-ADDWKUENB    WL0038           Order Secondary
     C                     Z-ADDWKJGDT    WL0039           OD Production D
     C                     EXSR SEDLRC
      * Allocate Inventory
      * CASE: LCL.OD Quantity Inv Sched is GT Zero
     C           YL0031    IFGT *ZERO                      *IF
      * Age Limit
      * CASE: PAR.Warehouse Std Chill Time is yes
     C           YL0011    IFEQ 'Y'                        *IF
      * CLC PA Age Limits      IF
     C                     Z-ADD*ZERO     WUDNBU           Day NBR USR
      * 04/10/07 Effective 04/23/07 representation of Age Code changes
      *          will be such that Age Code A will be 0 day for boxes
      *          and combos.  The labels on the cartons will not print
      *          a date that is offset by Sunday or Holiday.  Instead of
      *          Code Date, it will be the Pack Date.
      * Production Date RGT and Production Date RGF
      * CASE: PAR.Chilling Time is Not Entered
     C           YL0012    IFEQ *ZERO                      *IF
     C                     Z-ADDWKAODT    YL0018           Production Date
      * Production Date RGF
      * CASE: PAR.Age Code is A: 0 Day
     C           WARPCD    IFEQ 'A'                        *IF
     C                     Z-ADDYL0018    YL0017           Production Date
     C                     ELSE
      * CASE: PAR.Age Code is B: 1 Day
     C           WARPCD    IFEQ 'B'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-1 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-1        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is C: 2 Day
     C           WARPCD    IFEQ 'C'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-2 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-2        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is D: 3 Day
     C           WARPCD    IFEQ 'D'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-3 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-3        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is E: 4 Day
     C           WARPCD    IFEQ 'E'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-4 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-4        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is F: 5 Day
     C           WARPCD    IFEQ 'F'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-5 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-5        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is G: 6 Day
     C           WARPCD    IFEQ 'G'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-6 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-6        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Age Code is H: 7 Days to 119 Days
      *   |- c2    : PAR.Age Code is I: 120 Days +
      *   '-
     C           WARPCD    IFEQ 'H'                        *IF
     C           WARPCD    OREQ 'I'                        *OR
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-365 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-365      XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C           YL0012    MULT -1        YL0019           Fresh Chilling
      * PAR.Production Date RGT = PAR.Ship Date USR + LCL.Fresh Chilling
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDYL0019    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111110' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0018
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0018
     C                     END
      * Production Date RGF
      * CASE: Age Code is A or B
      *  - c1 OR c2
      *   |- c1    : PAR.Age Code is A: 0 Day
      *   |- c2    : PAR.Age Code is B: 1 Day
      *   '-
     C           WARPCD    IFEQ 'A'                        *IF
     C           WARPCD    OREQ 'B'                        *OR
      * 04/10/07 For chilled product, we should not have any orders
      *          with Age Code of A; however if we do, we will not allow
      *          ship off cut.
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-1 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-1        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is C: 2 Day
     C           WARPCD    IFEQ 'C'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-2 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-2        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is D: 3 Day
     C           WARPCD    IFEQ 'D'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-3 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-3        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is E: 4 Day
     C           WARPCD    IFEQ 'E'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-4 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-4        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is F: 5 Day
     C           WARPCD    IFEQ 'F'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-5 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-5        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is G: 6 Day
     C           WARPCD    IFEQ 'G'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-6 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-6        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Age Code is H: 7 Days to 119 Days
      *   |- c2    : PAR.Age Code is I: 120 Days +
      *   '-
     C           WARPCD    IFEQ 'H'                        *IF
     C           WARPCD    OREQ 'I'                        *OR
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-365 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-365      XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CLC PA Age Limits      IF
     C                     Z-ADD*ZERO     WUDNBU           Day NBR USR
      * 04/10/07 Effective 04/23/07 representation of Age Code changes
      *          will be such that Age Code A will be 0 day for boxes
      *          and combos.  The labels on the cartons will not print
      *          a date that is offset by Sunday or Holiday.  Instead of
      *          Code Date, it will be the Pack Date.
      * Production Date RGT and Production Date RGF
      * CASE: PAR.Chilling Time is Not Entered
     C           YL0004    IFEQ *ZERO                      *IF
     C                     Z-ADDWKAODT    YL0018           Production Date
      * Production Date RGF
      * CASE: PAR.Age Code is A: 0 Day
     C           WARPCD    IFEQ 'A'                        *IF
     C                     Z-ADDYL0018    YL0017           Production Date
     C                     ELSE
      * CASE: PAR.Age Code is B: 1 Day
     C           WARPCD    IFEQ 'B'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-1 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-1        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is C: 2 Day
     C           WARPCD    IFEQ 'C'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-2 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-2        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is D: 3 Day
     C           WARPCD    IFEQ 'D'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-3 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-3        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is E: 4 Day
     C           WARPCD    IFEQ 'E'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-4 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-4        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is F: 5 Day
     C           WARPCD    IFEQ 'F'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-5 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-5        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is G: 6 Day
     C           WARPCD    IFEQ 'G'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-6 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-6        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Age Code is H: 7 Days to 119 Days
      *   |- c2    : PAR.Age Code is I: 120 Days +
      *   '-
     C           WARPCD    IFEQ 'H'                        *IF
     C           WARPCD    OREQ 'I'                        *OR
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-365 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-365      XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C           YL0004    MULT -1        YL0019           Fresh Chilling
      * PAR.Production Date RGT = PAR.Ship Date USR + LCL.Fresh Chilling
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDYL0019    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111110' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0018
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0018
     C                     END
      * Production Date RGF
      * CASE: Age Code is A or B
      *  - c1 OR c2
      *   |- c1    : PAR.Age Code is A: 0 Day
      *   |- c2    : PAR.Age Code is B: 1 Day
      *   '-
     C           WARPCD    IFEQ 'A'                        *IF
     C           WARPCD    OREQ 'B'                        *OR
      * 04/10/07 For chilled product, we should not have any orders
      *          with Age Code of A; however if we do, we will not allow
      *          ship off cut.
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-1 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-1        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is C: 2 Day
     C           WARPCD    IFEQ 'C'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-2 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-2        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is D: 3 Day
     C           WARPCD    IFEQ 'D'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-3 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-3        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is E: 4 Day
     C           WARPCD    IFEQ 'E'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-4 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-4        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is F: 5 Day
     C           WARPCD    IFEQ 'F'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-5 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-5        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is G: 6 Day
     C           WARPCD    IFEQ 'G'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-6 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-6        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Age Code is H: 7 Days to 119 Days
      *   |- c2    : PAR.Age Code is I: 120 Days +
      *   '-
     C           WARPCD    IFEQ 'H'                        *IF
     C           WARPCD    OREQ 'I'                        *OR
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-365 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-365      XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0017
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0017
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDYL0031    YL0020           Quantity Ordere
     C                     Z-ADDYL0032    YL0021           Weight Ordered
     C                     Z-ADD*ZERO     YL0023           Quantity Schedu
     C                     Z-ADD*ZERO     YL0024           Weight Schedule
     C                     Z-ADDYL0020    YL0025           ATS Quantity Ne
     C                     Z-ADDYL0021    YL0026           ATS Weight Need
      * ** This will create the new order detail schedule record **
      *    for the current date.
      *
     C                     Z-ADD*ZERO     WN0251 110       ATS Quantity Av
     C                     Z-ADD*ZERO     WN0252 112       ATS Weight Avai
     C                     Z-ADD*ZERO     WN0253 112       Quantity Alloca
     C                     Z-ADD*ZERO     WN0254  92       Weight Allocate
      *
      * UPD Allocate Inv      IF
      * Allocate Inventory
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Production Date RGF LT JOB.*Job date
      *   |- c2    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0017    IFLT ##JDT                      *IF
     C           YL0025    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * UPD Allocate Inv      RT - PS Prod Item Inventory  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWKAIC3    WL0056           Company Number
     C                     Z-ADDWKHGCD    WL0057           Item Code
     C                     MOVELWKAJCD    WL0058    P      Warehouse Code
     C                     Z-ADDYL0017    WL0059           Production Date
     C                     Z-ADDYL0003    WL0060           Unit Weight
     C                     MOVELYL0007    WL0061    P      Piece Count Ite
     C                     Z-ADDYL0008    WL0062           Pieces Per Bag
     C                     Z-ADDYL0009    WL0063           Bags Per Unit
     C                     Z-ADDWKC4NB    WL0064           Order Number
     C                     Z-ADDWKDPNB    WL0065           Order Sequence
     C                     Z-ADDWKUENB    WL0066           Order Secondary
     C                     Z-ADDYL0020    WL0067           Quantity Ordere
     C                     Z-ADDYL0021    WL0068           Weight Ordered
     C                     Z-ADDYL0023    WL0069           Quantity Schedu
     C                     Z-ADDYL0024    WL0070           Weight Schedule
     C                     Z-ADDYL0025    WL0071           ATS Quantity Ne
     C                     Z-ADDYL0026    WL0072           ATS Weight Need
     C                     Z-ADDWKAODT    WL0073           Ship Date USR
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0069    YL0023           Quantity Schedu
     C                     Z-ADDWL0070    YL0024           Weight Schedule
     C                     Z-ADDWL0071    YL0025           ATS Quantity Ne
     C                     Z-ADDWL0072    YL0026           ATS Weight Need
     C                     END                             *FI
     C                     ADD  YL0023    YL0013           Quantity Schedu
     C                     ADD  YL0024    YL0014           Weight Schedule
     C                     END                             *FI
      * Allocate Production Or Standard
      * CASE: LCL.OD Quantity Scheduled is Greater than zero
     C           YL0033    IFGT *ZERO                      *IF
     C                     Z-ADDYL0033    YL0020           Quantity Ordere
     C                     Z-ADDYL0034    YL0021           Weight Ordered
     C                     Z-ADDYL0033    YL0025           ATS Quantity Ne
     C                     Z-ADDYL0034    YL0026           ATS Weight Need
     C                     Z-ADD*ZERO     YL0023           Quantity Schedu
     C                     Z-ADD*ZERO     YL0024           Weight Schedule
      * If Base, allocated Production. If Converted, allocate Standard
      * CASE: PAR.Base/Conv/Loss Item is Base
     C           YL0005    IFEQ 'B'                        *IF
      *
     C                     MOVEL*BLANK    WN0255  1        Production Type
     C                     Z-ADD*ZERO     WN0256 110       ATS Quantity Av
     C                     Z-ADD*ZERO     WN0257 112       ATS Weight Avai
     C                     Z-ADD*ZERO     WN0258  70       ATS Pieces Avai
     C                     Z-ADD*ZERO     WN0259 112       Quantity Alloca
     C                     Z-ADD*ZERO     WN0260  92       Weight Allocate
     C                     Z-ADD*ZERO     WN0261  70       Pieces Allocate
     C                     Z-ADD*ZERO     WN0262  52       Chilling Time U
     C                     Z-ADD*ZERO     WN0263  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0264  52       Production Yiel
     C                     Z-ADD*ZERO     WN0265  70       SM Pieces Need
     C                     Z-ADD*ZERO     WN0266 112       SM Weight Need
      *
      * UPD Allocate Prd      IF
     C                     MOVEL'F'       YL0035           Allocation Meth
      * Chilling Time
      * CASE: PAR.Warehouse Std Chill Time is yes
     C           YL0011    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0012    WN0262           Chilling Time U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0004    WN0262           Chilling Time U
     C                     END                             *FI
     C                     Z-ADDWKJGDT    YL0036           Production Date
      * DOC:  Allocation
     C                     EXSR UASUBR                     DOC:  Allocatio
      * CASE: LCL.Allocation Method USR is Forward
     C           YL0035    IFEQ 'F'                        *IF
      * Starting Production Date
      * CASE: PAR.Production Date RGF LT JOB.*Job date
     C           WKJGDT    IFLT ##JDT                      *IF
     C                     Z-ADD##JDT     YL0022           Production Date
      * CASE: PAR.Production Date RGT LT JOB.*Job date
     C           WKJGDT    IFLT ##JDT                      *IF
     C                     Z-ADDWKJGDT    YL0036           Production Date
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWKJGDT    YL0022           Production Date
     C                     END                             *FI
      * ITR:  Allocate Availability based on AGE CODE.
      * DO WHILE: Prd Dte <= Prd Dte RGT & Need > 0
      *  - c1 AND c3
      *   |- c1    : PAR.Production Date LE LCL.Production Date To
      *   |- c3    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     DO   *HIVAL                     *DOW
     C                     MOVEL'0'       Y0CX01  1
     C           YL0022    IFLE YL0036                     *IF
     C           YL0025    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
     C                     LEAVE
     C                     END                             *FI
      * Rtv Prd Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWKAIC3    WL0053           Company Number
     C                     Z-ADDYL0022    WL0054           Post to G/L Dat
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0055    YL0037    P      Production Day
      * Allocate Production
      * CASE: LCL.Production Day Status is yes
     C           YL0037    IFEQ 'Y'                        *IF
      * Determine Production Type
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           YL0022    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       WN0255           Production Type
      * Val Sched Existance   RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWKAIC3    WL0137           Company Number
     C                     MOVELWN0255    WL0138    P      Production Type
     C                     Z-ADDYL0022    WL0139           Production Date
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0140    WUWXST    P      Record Found US
      * Set to Plan if record not found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'P'       WN0255           Production Type
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Production Date GT JOB.*Job date
     C           YL0022    IFGT ##JDT                      *IF
     C                     MOVEL'P'       WN0255           Production Type
     C                     END                             *FI
     C                     END                             *FI
      * Rtv Avail Production  RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWKAIC3    WL0141           Company Number
     C                     MOVELWN0255    WL0142    P      Production Type
     C                     Z-ADDYL0022    WL0143           Production Date
     C                     Z-ADDWKHGCD    WL0144           Item Code
     C                     MOVELWKAJCD    WL0145    P      Warehouse Code
     C                     Z-ADDWN0257    WL0147           ATS Weight Avai
     C                     Z-ADDWN0258    WL0148           ATS Pieces Avai
     C                     Z-ADDWN0262    WL0149           Chilling Time U
     C                     EXSR SXRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0146    WN0263           PS Avg Piece Wg
     C                     Z-ADDWL0147    WN0257           ATS Weight Avai
     C                     Z-ADDWL0148    WN0258           ATS Pieces Avai
      * Quantity Available
      * CASE: Piece Count = Y
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0007    IFEQ 'Y'                        *IF
     C           YL0008    IFGT *ZERO                      *IF
     C           YL0009    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / (x2 * x3))
      * x1    : PAR.ATS Pieces Available USR
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Bags Per Unit
     C           YL0008    MULT YL0009    W0WJ01           *Synon (15,0) w
     C           WN0258    DIV  W0WJ01    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0256           ATS Quantity Av
     C                     ELSE
      * CASE: Piece Count = N
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0007    IFEQ *BLANK                     *IF
     C           YL0007    OREQ 'N'
     C           YL0003    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.ATS Weight Available USR
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0257    DIV  YL0003    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0256           ATS Quantity Av
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0256           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * Schedule As Ordered
      * CASE: PAR.ATS Adj Type USR 2 is Sched/Alloc As Ordered
     C           'AO'      IFEQ 'AO'                       *IF
      * CASE: PAR.ATS Quantity Avail USR LT PAR.ATS Quantity Need USR
     C           WN0256    IFLT YL0025                     *IF
     C                     Z-ADDYL0025    WN0256           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * If production avail allocate
      * CASE: PAR.ATS Quantity Avail USR is GT Zero
     C           WN0256    IFGT *ZERO                      *IF
      * Allocate Available Quantity
      * CASE: PAR.ATS Quantity Need USR GT PAR.ATS Quantity Avail USR
     C           YL0025    IFGT WN0256                     *IF
     C                     ADD  WN0256    YL0023           Quantity Schedu
     C           WN0256    MULT YL0003    WN0257           ATS Weight Avai
     C                     ADD  WN0257    YL0024           Weight Schedule
     C                     Z-ADDWN0257    WN0260           Weight Allocate
     C                     Z-ADDWN0256    WN0259           Quantity Alloca
     C                     ELSE
      * CASE: PAR.ATS Quantity Need USR LE PAR.ATS Quantity Avail USR
     C           YL0025    IFLE WN0256                     *IF
     C                     ADD  YL0025    YL0023           Quantity Schedu
     C           YL0025    MULT YL0003    YL0026    H      ATS Weight Need
     C                     ADD  YL0026    YL0024           Weight Schedule
     C                     Z-ADDYL0026    WN0260           Weight Allocate
     C                     Z-ADDYL0025    WN0259           Quantity Alloca
     C                     END                             *FI
     C                     END                             *FI
      * If quantity allocated is GT zero
      * CASE: PAR.Quantity Allocated USR is GT Zero
     C           WN0259    IFGT *ZERO                      *IF
      * Upd Ord Detail Sched  RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWKAIC3    WL0150           Company Number
     C                     Z-ADDWKC4NB    WL0151           Order Number
     C                     Z-ADDWKDPNB    WL0152           Order Sequence
     C                     Z-ADDWKUENB    WL0153           Order Secondary
     C                     Z-ADDYL0022    WL0154           OD Production D
     C                     Z-ADDWKAODT    WL0155           Scheduled Ship
     C                     MOVELWKAJCD    WL0156    P      Warehouse Code
     C                     MOVELWKAJCD    WL0157    P      Order From Ware
     C                     Z-ADDWKHGCD    WL0158           Item Code
     C                     Z-ADDWN0260    WL0159           Weight Allocate
     C                     Z-ADDWN0259    WL0160           Quantity Alloca
     C                     MOVELYL0005    WL0161    P      Base/Conv/Loss
     C                     EXSR SZRVGN
      * CASE: PAR.Piece Count Item is yes
     C           YL0007    IFEQ 'Y'                        *IF
      * Pieces Allocated
      * PAR.Pieces Allocated USR =
      *    *COMPUTE (x1 * x2 * x3)
      * x1    : PAR.Quantity Allocated USR
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Bags Per Unit
     C           WN0259    MULT YL0008    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT YL0009    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0261           Pieces Allocate
      * Weight Allocated
      * PAR.Weight Allocated USR =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.Pieces Allocated USR
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PS Avg Piece Wgt
     C           WN0261    MULT WN0263    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0260           Weight Allocate
     C                     END                             *FI
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWKAIC3    WL0162           Company Number
     C                     MOVELWN0255    WL0163    P      Production Type
     C                     Z-ADDYL0022    WL0164           Production Date
     C                     Z-ADDWKHGCD    WL0165           Item Code
     C                     MOVELWKAJCD    WL0166    P      Warehouse Code
     C                     Z-ADDWN0260    WL0167           Weight Allocate
     C                     Z-ADDWN0261    WL0168           Pieces Allocate
     C                     EXSR TBRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0259           Quantity Alloca
     C                     Z-ADD*ZERO     WN0260           Weight Allocate
     C                     Z-ADD*ZERO     YL0023           Quantity Schedu
     C                     Z-ADD*ZERO     YL0024           Weight Schedule
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  *ZERO     YL0023           Quantity Schedu
     C                     ADD  *ZERO     YL0024           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * CLC Inc/Dec Date       IF
      * CASE: PAR.*Duration (factor) is LT Zero
     C           1         IFLT *ZERO                      *IF
     C           1         MULT -1        WUDUF            *Duration (fact
      * Clc Date (descending) RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWKAIC3    WL0173           Company Number
     C                     Z-ADDYL0022    WL0174           Post to G/L Dat
     C                     Z-ADDYL0022    WL0176           *Date2 (beginni
     C                     Z-ADDWUDUF     WL0177           *Duration (fact
     C                     EXSR TFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0175    YL0022           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is GT Zero
     C           1         IFGT *ZERO                      *IF
      * Clc Date (ascending)  RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWKAIC3    WL0178           Company Number
     C                     Z-ADDYL0022    WL0179           Post to G/L Dat
     C                     Z-ADDYL0022    WL0181           *Date2 (beginni
     C                     Z-ADD1         WL0182           *Duration (fact
     C                     EXSR TGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0180    YL0022           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is EQ Zero
     C           1         IFEQ *ZERO                      *IF
     C                     Z-ADDYL0022    YL0022           *Date1 (ending)
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           YL0020    SUB  YL0023    YL0025           ATS Quantity Ne
     C           YL0021    SUB  YL0024    YL0026           ATS Weight Need
     C                     END                             *ITR
     C                     END                             *FI
     C           YL0020    SUB  YL0023    YL0025           ATS Quantity Ne
     C           YL0021    SUB  YL0024    YL0026           ATS Weight Need
     C                     ELSE
      * CASE: PAR.Base/Conv/Loss Item is Converted/Fabricated
     C           YL0005    IFEQ 'C'                        *IF
     C           YL0005    OREQ 'F'
      * UPD Allocate Std      XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDHMXFR'              90  UPD Allocate St
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WKAJCD    WQ0043  3        Warehouse Code
     C                     PARM WKAIC3    WQ0044  30       Company Number
     C                     PARM WKHGCD    WQ0045  70       Item Code
     C           YL0022    PARM YL0022    WQ0046  70       Production Date
     C                     PARM YL0002    WQ0047  2        U/M - Primary
     C                     PARM YL0003    WQ0048 112       Unit Weight
     C                     PARM YL0004    WQ0049  52       Fresh Chilling
     C                     PARM YL0007    WQ0050  1        Piece Count Ite
     C                     PARM YL0008    WQ0051  70       Pieces Per Bag
     C                     PARM YL0009    WQ0052  70       Bags Per Unit
     C                     PARM YL0010    WQ0053  2        Warehouse Type
     C                     PARM YL0011    WQ0054  1        Warehouse Std C
     C                     PARM YL0012    WQ0055  52       Warehouse Chill
     C                     PARM WKC4NB    WQ0056  70       Order Number
     C                     PARM WKDPNB    WQ0057  30       Order Sequence
     C                     PARM WKUENB    WQ0058  30       Order Secondary
     C                     PARM WKJGDT    WQ0059  70       Production Date
     C                     PARM WKJGDT    WQ0060  70       Production Date
     C                     PARM YL0020    WQ0061 112       Quantity Ordere
     C                     PARM YL0021    WQ0062 112       Weight Ordered
     C           YL0023    PARM YL0023    WQ0063 112       Quantity Schedu
     C           YL0024    PARM YL0024    WQ0064 112       Weight Schedule
     C           YL0025    PARM YL0025    WQ0065 112       ATS Quantity Ne
     C           YL0026    PARM YL0026    WQ0066 112       ATS Weight Need
     C                     PARM WARPCD    WQ0067  1        Age Code
     C                     PARM WKAODT    WQ0068  70       Ship Date USR
     C                     PARM 'AO'      WQ0069  2        ATS Adj Type US
     C                     PARM 'SCHASORD'WQ0070 10        PSAA Program Na
     C                     PARM WKAYAA    WQ0071  3        Order From Ware
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  YL0023    YL0013           Quantity Schedu
     C                     ADD  YL0024    YL0014           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * * The date the production was scheduled for is no longer a
      *   production day.
      * DLT Ord Detail Sched   DL - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWKAIC3    WL0035           Company Number
     C                     Z-ADDWKC4NB    WL0036           Order Number
     C                     Z-ADDWKDPNB    WL0037           Order Sequence
     C                     Z-ADDWKUENB    WL0038           Order Secondary
     C                     Z-ADDWKJGDT    WL0039           OD Production D
     C                     EXSR SEDLRC
      * Del Ord Dtl Sch-Inv   RT - Order Detail Sched-Inv  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWKAIC3    WL0040           Company Number
     C                     Z-ADDWKC4NB    WL0041           Order Number
     C                     Z-ADDWKDPNB    WL0042           Order Sequence
     C                     Z-ADDWKUENB    WL0043           Order Secondary
     C                     EXSR SFRVGN
      * Del OrdDtl Sch-Shortg RT - Order Detail Sched-Shortg  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWKAIC3    WL0049           Company Number
     C                     Z-ADDWKC4NB    WL0050           Order Number
     C                     Z-ADDWKDPNB    WL0051           Order Sequence
     C                     Z-ADDWKUENB    WL0052           Order Secondary
     C                     EXSR SHRVGN
     C                     END                             *FI
     C           KRSSK     READE@KNCPNF                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Prd Day Sts       RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADDWL0053    WLAIC3           Company Number
     C                     Z-ADDWL0054    WLBCDT           Post to G/L Dat
      * Establish starting position
     C           KRSSL     CHAIN@AFREBE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0018' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0055           Production Day
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWLWAST    WL0055           Production Day
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * UPD Allocate Inv      RT - PS Prod Item Inventory  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0116 110       ATS Quantity Av
     C                     Z-ADD*ZERO     WN0117 112       ATS Weight Avai
     C                     Z-ADD*ZERO     WN0118  70       ATS Pieces Avai
     C                     Z-ADD*ZERO     WN0119 112       Quantity Alloca
     C                     Z-ADD*ZERO     WN0120  92       Weight Allocate
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WN0119           Quantity Alloca
     C                     Z-ADD*ZERO     WN0120           Weight Allocate
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMAIC3    WQSM01           Company Number
     C           *LIKE     DEFN WMHGCD    WQSM02           Item Code
     C           *LIKE     DEFN WMAJCD    WQSM03           Warehouse Code
      * Define keylist
     C           KPSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           Item Code
     C                     KFLD           WQSM03           Warehouse Code
     C                     KFLD           WMELDT           Production Date
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           Item Code
     C                     KFLD           WQSM03           Warehouse Code
      * Setup key
     C                     Z-ADDWL0056    WQSM01           Company Number
     C                     Z-ADDWL0057    WQSM02           Item Code
     C                     MOVELWL0058    WQSM03           Warehouse Code
     C                     Z-ADDWL0059    WMELDT           Production Date
      * Establish starting position
     C           KPSSM     SETLL@CWCPQW                    *
     C           KRSSM     READE@CWCPQW                  90*
      * Data record not found
     C   90                MOVEL'USR3238' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Production Date EQ JOB.*Job date
      *   |- c2    : PAR.ATS Quantity Need USR is Less than or equal zero
      *   '-
     C           WMELDT    IFEQ ##JDT                      *IF
     C           WL0071    ORLE *ZERO                      *OR
     C                     GOTO SMEXIT                     *QUIT
     C                     END                             *FI
      * Rtv Ord Dtl Sch-Inv   RT - Order Detail Sched-Inv  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWMAIC3    WL0074           Company Number
     C                     Z-ADDWMHGCD    WL0075           Item Code
     C                     MOVELWMAJCD    WL0076    P      Warehouse Code
     C                     Z-ADDWMELDT    WL0077           OD Production D
     C                     Z-ADDYL0027    WL0078           OD Quantity Inv
     C                     Z-ADDYL0028    WL0079           OD Weight Inv S
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0078    YL0027           OD Quantity Inv
     C                     Z-ADDWL0079    YL0028           OD Weight Inv S
     C           WMARQT    SUB  YL0027    WN0116           ATS Quantity Av
     C           WMACWG    SUB  YL0028    WN0117           ATS Weight Avai
      * Allocate Available Inventory
      * CASE: PAR.ATS Quantity Avail USR is GT Zero
     C           WN0116    IFGT *ZERO                      *IF
      * Allocate
      * CASE: PAR.ATS Quantity Need USR GT PAR.ATS Quantity Avail USR
     C           WL0071    IFGT WN0116                     *IF
     C                     ADD  WN0116    WL0069           Quantity Schedu
     C           WN0116    MULT WL0060    WN0117           ATS Weight Avai
     C                     ADD  WN0117    WL0070           Weight Schedule
     C                     Z-ADDWN0116    WN0119           Quantity Alloca
     C                     Z-ADDWN0117    WN0120           Weight Allocate
     C                     ELSE
      * CASE: PAR.ATS Quantity Need USR LE PAR.ATS Quantity Avail USR
     C           WL0071    IFLE WN0116                     *IF
     C                     ADD  WL0071    WL0069           Quantity Schedu
     C                     ADD  WL0072    WL0070           Weight Schedule
     C                     Z-ADDWL0071    WN0119           Quantity Alloca
     C           WN0119    MULT WL0060    WN0120    H      Weight Allocate
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  *ZERO     WL0069           Quantity Schedu
     C                     ADD  *ZERO     WL0070           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * Upd Ord Dtl Sch-Inv   RT - Order Detail Sched-Inv  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWMAIC3    WL0080           Company Number
     C                     Z-ADDWL0064    WL0081           Order Number
     C                     Z-ADDWL0065    WL0082           Order Sequence
     C                     Z-ADDWL0066    WL0083           Order Secondary
     C                     Z-ADDWMELDT    WL0084           OD Production D
     C                     Z-ADDWL0073    WL0085           Scheduled Ship
     C                     MOVELWMAJCD    WL0086    P      Warehouse Code
     C                     Z-ADDWMHGCD    WL0087           Item Code
     C                     Z-ADDWN0119    WL0088           OD Quantity Inv
     C                     Z-ADDWN0120    WL0089           OD Weight Inv S
     C                     EXSR SORVGN
      * Upd Qty/Wgt Inv Alc   RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0056    WL0090           Company Number
     C                     Z-ADDWL0064    WL0091           Order Number
     C                     Z-ADDWL0065    WL0092           Order Sequence
     C                     Z-ADDWL0066    WL0093           Order Secondary
     C                     Z-ADD##JDT     WL0094           OD Production D
     C                     Z-ADDWL0073    WL0095           Scheduled Ship
     C                     MOVELWL0058    WL0096    P      Warehouse Code
     C                     MOVELWL0058    WL0097    P      Order From Ware
     C                     Z-ADDWL0057    WL0098           Item Code
     C                     Z-ADDWN0119    WL0099           Quantity Alloca
     C                     Z-ADDWN0120    WL0100           Weight Allocate
     C                     EXSR SRRVGN
      * Upd Inv Allocated     RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0056    WL0127           Company Number
     C                     MOVEL'S'       WL0128    P      Production Type
     C                     Z-ADD##JDT     WL0129           Production Date
     C                     Z-ADDWL0057    WL0130           Item Code
     C                     MOVELWL0058    WL0131    P      Warehouse Code
     C                     MOVELWL0061    WL0132    P      Piece Count Ite
     C                     Z-ADDWL0062    WL0133           Pieces Per Bag
     C                     Z-ADDWL0063    WL0134           Bags Per Unit
     C                     Z-ADDWN0120    WL0135           Weight Allocate
     C                     Z-ADDWN0119    WL0136           Quantity Alloca
     C                     EXSR SURVGN
     C                     END                             *FI
     C           WL0067    SUB  WL0069    WL0071           ATS Quantity Ne
     C           WL0068    SUB  WL0070    WL0072           ATS Weight Need
     C           KRSSM     READE@CWCPQW                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Ord Dtl Sch-Inv   RT - Order Detail Sched-Inv  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0078           OD Quantity Inv
     C                     Z-ADD*ZERO     WL0079           OD Weight Inv S
      * Declare restrictor key work fields
     C           *LIKE     DEFN WOAIC3    WQSN01           Company Number
     C           *LIKE     DEFN WOHGCD    WQSN02           Item Code
     C           *LIKE     DEFN WOAJCD    WQSN03           Warehouse Code
     C           *LIKE     DEFN WOJGDT    WQSN04           OD Production D
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Company Number
     C                     KFLD           WQSN02           Item Code
     C                     KFLD           WQSN03           Warehouse Code
     C                     KFLD           WQSN04           OD Production D
      * Setup key
     C                     Z-ADDWL0074    WQSN01           Company Number
     C                     Z-ADDWL0075    WQSN02           Item Code
     C                     MOVELWL0076    WQSN03           Warehouse Code
     C                     Z-ADDWL0077    WQSN04           OD Production D
      * Establish starting position
     C           KRSSN     SETLL@B5CPM4                    *
     C           KRSSN     READE@B5CPM4                  90*
      * Data record not found
     C   90                MOVEL'USR3150' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WOIUQT    WL0078           OD Quantity Inv
     C                     ADD  WOF3WG    WL0079           OD Weight Inv S
     C           KRSSN     READE@B5CPM4                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Upd Ord Dtl Sch-Inv   RT - Order Detail Sched-Inv  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0121  1        EDI Status 1
     C                     MOVEL*BLANK    WN0122  1        EDI Status 2
     C                     MOVEL*BLANK    WN0123  1        EDI Status 3
     C                     MOVEL*BLANK    WN0124  1        Record Status
     C                     Z-ADD*ZERO     WN0125  60       Job Time
     C                     MOVEL*BLANK    WN0126 10        User Id
     C                     MOVEL*BLANK    WN0127 10        Job Name
     C                     Z-ADD*ZERO     WN0128  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFC4NB           Order Number
     C                     KFLD           WFDPNB           Order Sequence
     C                     KFLD           WFUENB           Order Secondary
     C                     KFLD           WFJGDT           OD Production D
      * Setup key
     C                     Z-ADDWL0080    WFAIC3           Company Number
     C                     Z-ADDWL0081    WFC4NB           Order Number
     C                     Z-ADDWL0082    WFDPNB           Order Sequence
     C                     Z-ADDWL0083    WFUENB           Order Secondary
     C                     Z-ADDWL0084    WFJGDT           OD Production D
      * Establish starting position
     C           KRSSO     CHAIN@B5CPM2              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3150' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Ord Dtl Sch-Inv   CR - Order Detail Sched-Inv  * 
     C                     EXSR SPCRRC
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WFIUQT    ADD  WL0088    YL0029           OD Quantity Inv
     C           WFF3WG    ADD  WL0089    YL0030           OD Weight Inv S
      * CASE: LCL.OD Quantity Inv Sched is LE Zero
     C           YL0029    IFLE *ZERO                      *IF
      * Delete Order Detail Sched - Order Detail Sched-Inv  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWFAIC3    WL0044           Company Number
     C                     Z-ADDWFC4NB    WL0045           Order Number
     C                     Z-ADDWFDPNB    WL0046           Order Sequence
     C                     Z-ADDWFUENB    WL0047           Order Secondary
     C                     Z-ADDWFJGDT    WL0048           OD Production D
     C                     EXSR SGDLRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg Ord Dtl Sch-Inv   CH - Order Detail Sched-Inv  * 
     C                     EXSR SQCHRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPCRRC    BEGSR
      *================================================================
      * Crt Ord Dtl Sch-Inv   CR - Order Detail Sched-Inv  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B5CPM1
     C                     Z-ADDWL0080    WGAIC3           Company Number
     C                     Z-ADDWL0081    WGC4NB           Order Number
     C                     Z-ADDWL0082    WGDPNB           Order Sequence
     C                     Z-ADDWL0083    WGUENB           Order Secondary
     C                     Z-ADDWL0084    WGJGDT           OD Production D
     C                     Z-ADDWL0085    WGAODT           Scheduled Ship
     C                     MOVELWL0086    WGAJCD           Warehouse Code
     C                     Z-ADDWL0087    WGHGCD           Item Code
     C                     Z-ADDWL0088    WGIUQT           OD Quantity Inv
     C                     Z-ADDWL0089    WGF3WG           OD Weight Inv S
     C                     MOVELWN0121    WGUVST           EDI Status 1
     C                     MOVELWN0122    WGUWST           EDI Status 2
     C                     MOVELWN0123    WGUXST           EDI Status 3
     C                     MOVELWN0124    WGVSST           Record Status
     C                     Z-ADDWN0125    WGAATM           Job Time
     C                     MOVELWN0126    WGAYNA           User Id
     C                     MOVELWN0127    WGA0NA           Job Name
     C                     Z-ADDWN0128    WGAXDT           Job Date
      *
      * USER: Processing before Data update
      * UPS CRTOBJ Stamp      IF
     C                     MOVEL'A'       WGVSST           Record Status
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##PGM     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
     C           KLCRSP    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGC4NB           Order Number
     C                     KFLD           WGDPNB           Order Sequence
     C                     KFLD           WGUENB           Order Secondary
     C                     KFLD           WGJGDT           OD Production D
      * Check for duplicate primary key
     C           KLCRSP    SETLL@B5CPM1                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3151' W0RTN   7
      * Send message 'Order Detail Sched-Inv EX'
     C                     MOVEL'USR3151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C                     WRITE@B5CPM1                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQCHRC    BEGSR
      *================================================================
      * Chg Ord Dtl Sch-Inv   CH - Order Detail Sched-Inv  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0129  1        EDI Status 1
     C                     MOVEL*BLANK    WN0130  1        EDI Status 2
     C                     MOVEL*BLANK    WN0131  1        EDI Status 3
     C                     MOVEL*BLANK    WN0132  1        Record Status
     C                     Z-ADD*ZERO     WN0133  60       Job Time
     C                     MOVEL*BLANK    WN0134 10        User Id
     C                     MOVEL*BLANK    WN0135 10        Job Name
     C                     Z-ADD*ZERO     WN0136  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @B5CPM1
     C                     Z-ADDWFAIC3    WGAIC3           Company Number
     C                     Z-ADDWFC4NB    WGC4NB           Order Number
     C                     Z-ADDWFDPNB    WGDPNB           Order Sequence
     C                     Z-ADDWFUENB    WGUENB           Order Secondary
     C                     Z-ADDWFJGDT    WGJGDT           OD Production D
      *
     C           KLCHSQ    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGC4NB           Order Number
     C                     KFLD           WGDPNB           Order Sequence
     C                     KFLD           WGUENB           Order Secondary
     C                     KFLD           WGJGDT           OD Production D
     C           KLCHSQ    CHAIN@B5CPM1              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POB5CPL0'MDACP
     C                     MOVEL'@B5CPM1' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SQEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPOB51    YBRDCS
      * Move non-key fields to @B5CPM1
     C                     Z-ADDWFAODT    WGAODT           Scheduled Ship
     C                     MOVELWL0086    WGAJCD    P      Warehouse Code
     C                     Z-ADDWL0087    WGHGCD           Item Code
     C                     Z-ADDYL0029    WGIUQT           OD Quantity Inv
     C                     Z-ADDYL0030    WGF3WG           OD Weight Inv S
      *
      * Set PGM.*Record Data Changed flag
     C           QPOB51    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@B5CPM1                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPOB5CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Upd Qty/Wgt Inv Alc   RT - Order Detail Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0137 112       OD Quantity Sch
     C                     Z-ADD*ZERO     WN0138 112       OD Weight Sched
     C                     Z-ADD*ZERO     WN0139 112       OD Quantity Inv
     C                     Z-ADD*ZERO     WN0140 112       OD Weight Inv S
     C                     Z-ADD*ZERO     WN0141 112       OD Quantity Unu
     C                     Z-ADD*ZERO     WN0142 112       OD Weight Unuse
     C                     MOVEL*BLANK    WN0143  1        OD Added to Sch
     C                     MOVEL*BLANK    WN0144  1        OD Reallocate S
     C                     MOVEL*BLANK    WN0145  2        OD Status Unuse
     C                     MOVEL*BLANK    WN0146  1        EDI Status 1
     C                     MOVEL*BLANK    WN0147  1        EDI Status 2
     C                     MOVEL*BLANK    WN0148  1        EDI Status 3
     C                     MOVEL*BLANK    WN0149  1        Record Status
     C                     Z-ADD*ZERO     WN0150  60       Job Time
     C                     MOVEL*BLANK    WN0151 10        User Id
     C                     MOVEL*BLANK    WN0152 10        Job Name
     C                     Z-ADD*ZERO     WN0153  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
     C                     KFLD           WDDPNB           Order Sequence
     C                     KFLD           WDUENB           Order Secondary
     C                     KFLD           WDJGDT           OD Production D
      * Setup key
     C                     Z-ADDWL0090    WDAIC3           Company Number
     C                     Z-ADDWL0091    WDC4NB           Order Number
     C                     Z-ADDWL0092    WDDPNB           Order Sequence
     C                     Z-ADDWL0093    WDUENB           Order Secondary
     C                     Z-ADDWL0094    WDJGDT           OD Production D
      * Establish starting position
     C           KRSSR     CHAIN@KNCPHO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2238' W0RTN   7
      * USER: Processing if Data record not found
      * CRT Ord Detail Sched   CR - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0090    WL0101           Company Number
     C                     Z-ADDWL0091    WL0102           Order Number
     C                     Z-ADDWL0092    WL0103           Order Sequence
     C                     Z-ADDWL0093    WL0104           Order Secondary
     C                     Z-ADDWL0094    WL0105           OD Production D
     C                     Z-ADDWL0095    WL0106           Scheduled Ship
     C                     MOVELWL0096    WL0107    P      Warehouse Code
     C                     MOVELWL0096    WL0108    P      Order From Ware
     C                     Z-ADDWL0098    WL0109           Item Code
     C                     Z-ADDWN0137    WL0110           OD Quantity Sch
     C                     Z-ADDWN0138    WL0111           OD Weight Sched
     C                     Z-ADDWL0099    WL0112           OD Quantity Inv
     C                     Z-ADDWL0100    WL0113           OD Weight Inv S
     C                     Z-ADDWN0141    WL0114           OD Quantity Unu
     C                     Z-ADDWN0142    WL0115           OD Weight Unuse
     C                     MOVELWN0143    WL0116    P      OD Added to Sch
     C                     MOVELWN0144    WL0117    P      OD Reallocate S
     C                     MOVELWN0145    WL0118    P      OD Status Unuse
     C                     MOVELWN0146    WL0119    P      EDI Status 1
     C                     MOVELWN0147    WL0120    P      EDI Status 2
     C                     MOVELWN0148    WL0121    P      EDI Status 3
     C                     MOVELWN0149    WL0122    P      Record Status
     C                     Z-ADDWN0150    WL0123           Job Time
     C                     MOVELWN0151    WL0124    P      User Id
     C                     MOVELWN0152    WL0125    P      Job Name
     C                     Z-ADDWN0153    WL0126           Job Date
     C                     EXSR SSCRRC
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WDIUQT    ADD  WL0099    WN0139           OD Quantity Inv
     C           WDF3WG    ADD  WL0100    WN0140           OD Weight Inv S
      * CASE: PAR.OD Quantity Inv Sched is LE Zero
     C           WN0139    IFLE *ZERO                      *IF
      * DLT Ord Detail Sched   DL - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0035           Company Number
     C                     Z-ADDWDC4NB    WL0036           Order Number
     C                     Z-ADDWDDPNB    WL0037           Order Sequence
     C                     Z-ADDWDUENB    WL0038           Order Secondary
     C                     Z-ADDWDJGDT    WL0039           OD Production D
     C                     EXSR SEDLRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg Qty/Wgt Inv Alc - Order Detail Schedule  * 
     C                     EXSR STCHRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCRRC    BEGSR
      *================================================================
      * CRT Ord Detail Sched   CR - Order Detail Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @KNCPHN
     C                     Z-ADDWL0101    WEAIC3           Company Number
     C                     Z-ADDWL0102    WEC4NB           Order Number
     C                     Z-ADDWL0103    WEDPNB           Order Sequence
     C                     Z-ADDWL0104    WEUENB           Order Secondary
     C                     Z-ADDWL0105    WEJGDT           OD Production D
     C                     Z-ADDWL0106    WEAODT           Scheduled Ship
     C                     MOVELWL0107    WEAJCD           Warehouse Code
     C                     MOVELWL0108    WEAYAA           Order From Ware
     C                     Z-ADDWL0109    WEHGCD           Item Code
     C                     Z-ADDWL0110    WEIGQT           OD Quantity Sch
     C                     Z-ADDWL0111    WEFLWG           OD Weight Sched
     C                     Z-ADDWL0112    WEIUQT           OD Quantity Inv
     C                     Z-ADDWL0113    WEF3WG           OD Weight Inv S
     C                     Z-ADDWL0114    WEIVQT           OD Quantity Unu
     C                     Z-ADDWL0115    WEF4WG           OD Weight Unuse
     C                     MOVELWL0116    WEP7ST           OD Added to Sch
     C                     MOVELWL0117    WEP8ST           OD Reallocate S
     C                     MOVELWL0118    WEQAST           OD Status Unuse
     C                     MOVELWL0119    WEUVST           EDI Status 1
     C                     MOVELWL0120    WEUWST           EDI Status 2
     C                     MOVELWL0121    WEUXST           EDI Status 3
     C                     MOVELWL0122    WEVSST           Record Status
     C                     Z-ADDWL0123    WEAATM           Job Time
     C                     MOVELWL0124    WEAYNA           User Id
     C                     MOVELWL0125    WEA0NA           Job Name
     C                     Z-ADDWL0126    WEAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WEVSST           Record Status
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##JOB     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
     C           KLCRSS    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
     C                     KFLD           WEJGDT           OD Production D
      * Check for duplicate primary key
     C           KLCRSS    SETLL@KNCPHN                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2239' W0RTN   7
      * Send message 'Order Detail Schedule  EX'
     C                     MOVEL'USR2239' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C                     WRITE@KNCPHN                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STCHRC    BEGSR
      *================================================================
      * Chg Qty/Wgt Inv Alc - Order Detail Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0154  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0155  3        Warehouse Code
     C                     MOVEL*BLANK    WN0156  3        Order From Ware
     C                     Z-ADD*ZERO     WN0157  70       Item Code
     C                     Z-ADD*ZERO     WN0158 112       OD Quantity Sch
     C                     Z-ADD*ZERO     WN0159 112       OD Weight Sched
     C                     Z-ADD*ZERO     WN0160 112       OD Quantity Unu
     C                     Z-ADD*ZERO     WN0161 112       OD Weight Unuse
     C                     MOVEL*BLANK    WN0162  1        OD Added to Sch
     C                     MOVEL*BLANK    WN0163  1        OD Reallocate S
     C                     MOVEL*BLANK    WN0164  2        OD Status Unuse
     C                     MOVEL*BLANK    WN0165  1        EDI Status 1
     C                     MOVEL*BLANK    WN0166  1        EDI Status 2
     C                     MOVEL*BLANK    WN0167  1        EDI Status 3
     C                     MOVEL*BLANK    WN0168  1        Record Status
     C                     Z-ADD*ZERO     WN0169  60       Job Time
     C                     MOVEL*BLANK    WN0170 10        User Id
     C                     MOVEL*BLANK    WN0171 10        Job Name
     C                     Z-ADD*ZERO     WN0172  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @KNCPHN
     C                     Z-ADDWL0090    WEAIC3           Company Number
     C                     Z-ADDWL0091    WEC4NB           Order Number
     C                     Z-ADDWL0092    WEDPNB           Order Sequence
     C                     Z-ADDWL0093    WEUENB           Order Secondary
     C                     Z-ADDWL0094    WEJGDT           OD Production D
      *
     C           KLCHST    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
     C                     KFLD           WEJGDT           OD Production D
     C           KLCHST    CHAIN@KNCPHN              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDKNCPL0'MDACP
     C                     MOVEL'@KNCPHN' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO STEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDKN1    YCRDCS
      * Move non-key fields to @KNCPHN
     C                     Z-ADDWN0139    WEIUQT           OD Quantity Inv
     C                     Z-ADDWN0140    WEF3WG           OD Weight Inv S
      *
      * Set PGM.*Record Data Changed flag
     C           QPDKN1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * UPS CHGOBJ Stamp      IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##PGM     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDKN1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@KNCPHN                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDKNCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Upd Inv Allocated     RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0173  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0174  70       PS Pieces Inv A
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WRAIC3           Company Number
     C                     KFLD           WRV5ST           Production Type
     C                     KFLD           WRELDT           Production Date
     C                     KFLD           WRHGCD           Item Code
     C                     KFLD           WRAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWL0127    WRAIC3           Company Number
     C                     MOVELWL0128    WRV5ST           Production Type
     C                     Z-ADDWL0129    WRELDT           Production Date
     C                     Z-ADDWL0130    WRHGCD           Item Code
     C                     MOVELWL0131    WRAJCD           Warehouse Code
      * Establish starting position
     C           KRSSU     CHAIN@I8CPUS              90    *
      * Data record not found
     C   90                MOVEL'USR1763' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WRUNW2    ADD  WL0135    WN0173           PS Weight Inv A
      * PS Pieces Inv Allocated
      * CASE: PAR.Piece Count Item is yes
     C           WL0132    IFEQ 'Y'                        *IF
      * Pieces Inv Allocated
      * PAR.PS Pieces Inv Allocated =
      *    *COMPUTE (x1 + (x2 * (x3 * x4)))
      * x1    : DB1.PS Pieces Inv Allocated
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.Quantity Allocated USR
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Bags Per Unit
     C           WL0133    MULT WL0134    W0WJ02           *Synon (15,0) w
     C           WL0136    MULT W0WJ02    W0WJ01    H      *Synon (15,0) w
     C           WRCENB    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0174           PS Pieces Inv A
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0174           PS Pieces Inv A
     C                     END                             *FI
      * Chg Inv Allocated     CH - PS Prod Item Schedule  * 
     C                     EXSR SVCHRC
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVCHRC    BEGSR
      *================================================================
      * Chg Inv Allocated     CH - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0175  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0176  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0177  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0178  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0179  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0180  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0181  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0182  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0183  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0184  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0185  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0186  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0187  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0188  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0189  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0190  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0191  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0192  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0193  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0194  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0195  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0196 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0197  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0198 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0199  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0200 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0201  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0202 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0203  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0204 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0205  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0206 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0207  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0208  3        PS Item Id
     C                     MOVEL*BLANK    WN0209  2        Warehouse Type
     C                     MOVEL*BLANK    WN0210  1        PS Lock Status
     C                     MOVEL*BLANK    WN0211  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0212  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0213  1        PS Piece Count
     C                     MOVEL*BLANK    WN0214  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0215  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0216  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0217  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0218  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0219  3        PS Shift/Priori
     C                     Z-ADD*ZERO     WN0220  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0221  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0222  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0223  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0224  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0225  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0226  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0227  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0228  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0229  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0230  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0231  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0232  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0233  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0234  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0235  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0236  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0237  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0238  6        Department Code
     C                     Z-ADD*ZERO     WN0239  30       Item Structure
     C                     Z-ADD*ZERO     WN0240  30       Item Structure
     C                     Z-ADD*ZERO     WN0241  30       Item Structure
     C                     MOVEL*BLANK    WN0242  6        Primal Group Co
     C                     MOVEL*BLANK    WN0243  1        EDI Status 1
     C                     MOVEL*BLANK    WN0244  1        EDI Status 2
     C                     MOVEL*BLANK    WN0245  1        EDI Status 3
     C                     MOVEL*BLANK    WN0246  1        Record Status
     C                     Z-ADD*ZERO     WN0247  60       Job Time
     C                     MOVEL*BLANK    WN0248 10        User Id
     C                     MOVEL*BLANK    WN0249 10        Job Name
     C                     Z-ADD*ZERO     WN0250  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @I8CPUR
     C                     Z-ADDWRAIC3    WSAIC3           Company Number
     C                     MOVELWRV5ST    WSV5ST    P      Production Type
     C                     Z-ADDWRELDT    WSELDT           Production Date
     C                     Z-ADDWRHGCD    WSHGCD           Item Code
     C                     MOVELWRAJCD    WSAJCD    P      Warehouse Code
      *
     C           KLCHSV    KLIST
     C                     KFLD           WSAIC3           Company Number
     C                     KFLD           WSV5ST           Production Type
     C                     KFLD           WSELDT           Production Date
     C                     KFLD           WSHGCD           Item Code
     C                     KFLD           WSAJCD           Warehouse Code
     C           KLCHSV    CHAIN@I8CPUR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI8CPL0'MDACP
     C                     MOVEL'@I8CPUR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SVEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDI81    YDRDCS
      * Move non-key fields to @I8CPUR
     C                     Z-ADDWN0173    WSUNW2           PS Weight Inv A
     C                     Z-ADDWN0174    WSCENB           PS Pieces Inv A
      *
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * UPS CHGOBJ Stamp      IF
     C                     Z-ADD##JTM     WSAATM           Job Time
     C                     MOVEL##USR     WSAYNA           User Id
     C                     MOVEL##PGM     WSA0NA           Job Name
     C                     Z-ADD##JDT     WSAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@I8CPUR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDI8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Val Sched Existance   RT - PS Prod Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WTAIC3           Company Number
     C                     KFLD           WTV5ST           Production Type
     C                     KFLD           WTELDT           Production Date
      * Setup key
     C                     Z-ADDWL0137    WTAIC3           Company Number
     C                     MOVELWL0138    WTV5ST           Production Type
     C                     Z-ADDWL0139    WTELDT           Production Date
      * Establish starting position
     C           KRSSW     CHAIN@JCCPVC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1795' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WL0140           Record Found US
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y'       WL0140           Record Found US
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * Rtv Avail Production  RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0267  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0268  70       PS Pieces Ship
     C                     MOVEL*BLANK    WN0269  1        Piece Count Ite
     C                     Z-ADD*ZERO     WN0270  70       Pieces Per Bag
     C                     Z-ADD*ZERO     WN0271  70       Bags Per Unit
     C                     Z-ADD*ZERO     WN0272  92       Weight Producti
     C                     Z-ADD*ZERO     WN0273  70       Pieces Producti
     C                     Z-ADD*ZERO     WN0274 112       OD Quantity Sch
     C                     Z-ADD*ZERO     WN0275 112       OD Weight Sched
     C                     Z-ADD*ZERO     WN0276  70       Pieces Allocate
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0146           PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0267           PS Weight Ship
     C                     Z-ADD*ZERO     WN0268           PS Pieces Ship
     C                     Z-ADD*ZERO     WL0147           ATS Weight Avai
     C                     Z-ADD*ZERO     WL0148           ATS Pieces Avai
     C                     MOVEL*BLANK    WN0269           Piece Count Ite
     C                     Z-ADD*ZERO     WN0270           Pieces Per Bag
     C                     Z-ADD*ZERO     WN0271           Bags Per Unit
     C                     Z-ADD*ZERO     WN0272           Weight Producti
     C                     Z-ADD*ZERO     WN0273           Pieces Producti
     C                     Z-ADD*ZERO     WN0274           OD Quantity Sch
     C                     Z-ADD*ZERO     WN0275           OD Weight Sched
     C                     Z-ADD*ZERO     WN0276           Pieces Allocate
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WRAIC3           Company Number
     C                     KFLD           WRV5ST           Production Type
     C                     KFLD           WRELDT           Production Date
     C                     KFLD           WRHGCD           Item Code
     C                     KFLD           WRAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWL0141    WRAIC3           Company Number
     C                     MOVELWL0142    WRV5ST           Production Type
     C                     Z-ADDWL0143    WRELDT           Production Date
     C                     Z-ADDWL0144    WRHGCD           Item Code
     C                     MOVELWL0145    WRAJCD           Warehouse Code
      * Establish starting position
     C           KRSSX     CHAIN@I8CPUS              90    *
      * Data record not found
     C   90                MOVEL'USR1763' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Production = Standard + Prod Adj - Converted
      * Prod Avail = Production + Ship Cut Adj + Ship Adj - Prod Alloc
      * CASE: DB1.PS Lock Status is NOT LOCKED
     C           WRB5ST    IFEQ 'N'                        *IF
      * Ship Cut Adjust
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Chilling Time USR is GT Zero
      *   |- c2    : DB1.Production Date EQ JOB.*Job date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0149    IFGT *ZERO                      *IF
     C           WRELDT    IFEQ ##JDT                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Ship Cut Adjust   RT - PS Prod Item Schedule  * 
     C                     EXSR SYRVGN
     C                     END                             *FI
      * Weight Production
      * PAR.Weight Production USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : DB1.PS Weight Standard
      * +     : PGM.*Synon (15,2) work field
      * x2    : DB1.PS Weight Prod Adj
      * -     : PGM.*Synon (15,2) work field
      * x3    : DB1.PS Weight Converted
     C           WRDXWG    ADD  WRD1WG    W0WA01           *Synon (15,2) w
     C           W0WA01    SUB  WRWTCN    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0272           Weight Producti
      * Pieces Production
      * PAR.Pieces Production USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : DB1.PS Pieces Standard
      * +     : PGM.*Synon (15,0) work field
      * x2    : DB1.PS Pieces Prod Adj
      * -     : PGM.*Synon (15,0) work field
      * x3    : DB1.PS Pieces Converted
     C           WRB2NB    ADD  WRCBNB    W0WJ01           *Synon (15,0) w
     C           W0WJ01    SUB  WRPSCV    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0273           Pieces Producti
      * Weight Available
      * PAR.ATS Weight Available USR =
      *    *COMPUTE (x1 + x2 + x3 - x4)
      * x1    : PAR.Weight Production USR
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.PS Weight Ship Cut Adj
      * +     : PGM.*Synon (15,2) work field
      * x3    : DB1.PS Weight Shipping Adj
      * -     : PGM.*Synon (15,2) work field
      * x4    : DB1.PS Weight Prod Allocated
     C           WN0272    ADD  WN0267    W0WA02           *Synon (15,2) w
     C           W0WA02    ADD  WRSAWT    W0WA01           *Synon (15,2) w
     C           W0WA01    SUB  WROAWT    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0147           ATS Weight Avai
      * Pieces Available
      * PAR.ATS Pieces Available USR =
      *    *COMPUTE (x1 + x2 + x3 - x4)
      * x1    : PAR.Pieces Production USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Pieces Ship Cut Adj
      * +     : PGM.*Synon (15,0) work field
      * x3    : DB1.PS Pieces Shipping Adj
      * -     : PGM.*Synon (15,0) work field
      * x4    : DB1.PS Pieces Prod Allocated
     C           WN0273    ADD  WN0268    W0WJ02           *Synon (15,0) w
     C           W0WJ02    ADD  WRB9NB    W0WJ01           *Synon (15,0) w
     C           W0WJ01    SUB  WRCDNB    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0148           ATS Pieces Avai
      * Weight Avail
      * CASE: PAR.ATS Weight Available USR is Less than zero
     C           WL0147    IFLT *ZERO                      *IF
     C                     Z-ADD*ZERO     WL0147           ATS Weight Avai
     C                     Z-ADD*ZERO     WL0148           ATS Pieces Avai
     C                     END                             *FI
     C                     Z-ADDWRF8WG    WL0146           PS Avg Piece Wg
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * Rtv Ship Cut Adjust   RT - PS Prod Item Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WVAIC3    WQSY01           Company Number
     C           *LIKE     DEFN WVHGCD    WQSY02           Item Code
     C           *LIKE     DEFN WVAJCD    WQSY03           Warehouse Code
     C           *LIKE     DEFN WVELDT    WQSY04           Production Date
     C           *LIKE     DEFN WVV5ST    WQSY05           Production Type
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WQSY01           Company Number
     C                     KFLD           WQSY02           Item Code
     C                     KFLD           WQSY03           Warehouse Code
     C                     KFLD           WQSY04           Production Date
     C                     KFLD           WQSY05           Production Type
      * Setup key
     C                     Z-ADDWRAIC3    WQSY01           Company Number
     C                     Z-ADDWRHGCD    WQSY02           Item Code
     C                     MOVELWRAJCD    WQSY03           Warehouse Code
     C                     Z-ADDWRGPDT    WQSY04           Production Date
     C                     MOVEL'P'       WQSY05           Production Type
      * Establish starting position
     C           KRSSY     SETLL@I8CPXP                    *
     C           KRSSY     READE@I8CPXP                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0267           PS Weight Ship
     C                     Z-ADD*ZERO     WN0268           PS Pieces Ship
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWVE0WG    WN0267           PS Weight Ship
     C                     Z-ADDWVD6NB    WN0268           PS Pieces Ship
     C           KRSSY     READE@I8CPXP                  90*
     C                     ENDDO
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * Upd Ord Detail Sched  RT - Order Detail Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0277 112       OD Quantity Sch
     C                     Z-ADD*ZERO     WN0278 112       OD Weight Sched
     C                     Z-ADD*ZERO     WN0279 112       OD Quantity Inv
     C                     Z-ADD*ZERO     WN0280 112       OD Weight Inv S
     C                     Z-ADD*ZERO     WN0281 112       OD Quantity Unu
     C                     Z-ADD*ZERO     WN0282 112       OD Weight Unuse
     C                     MOVEL*BLANK    WN0283  1        OD Added to Sch
     C                     MOVEL*BLANK    WN0284  1        OD Reallocate S
     C                     MOVEL*BLANK    WN0285  2        OD Status Unuse
     C                     MOVEL*BLANK    WN0286  1        EDI Status 1
     C                     MOVEL*BLANK    WN0287  1        EDI Status 2
     C                     MOVEL*BLANK    WN0288  1        EDI Status 3
     C                     MOVEL*BLANK    WN0289  1        Record Status
     C                     Z-ADD*ZERO     WN0290  60       Job Time
     C                     MOVEL*BLANK    WN0291 10        User Id
     C                     MOVEL*BLANK    WN0292 10        Job Name
     C                     Z-ADD*ZERO     WN0293  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
     C                     KFLD           WDDPNB           Order Sequence
     C                     KFLD           WDUENB           Order Secondary
     C                     KFLD           WDJGDT           OD Production D
      * Setup key
     C                     Z-ADDWL0150    WDAIC3           Company Number
     C                     Z-ADDWL0151    WDC4NB           Order Number
     C                     Z-ADDWL0152    WDDPNB           Order Sequence
     C                     Z-ADDWL0153    WDUENB           Order Secondary
     C                     Z-ADDWL0154    WDJGDT           OD Production D
      * Establish starting position
     C           KRSSZ     CHAIN@KNCPHO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2238' W0RTN   7
      * USER: Processing if Data record not found
      * CRT Ord Detail Sched   CR - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0150    WL0101           Company Number
     C                     Z-ADDWL0151    WL0102           Order Number
     C                     Z-ADDWL0152    WL0103           Order Sequence
     C                     Z-ADDWL0153    WL0104           Order Secondary
     C                     Z-ADDWL0154    WL0105           OD Production D
     C                     Z-ADDWL0155    WL0106           Scheduled Ship
     C                     MOVELWL0156    WL0107    P      Warehouse Code
     C                     MOVELWL0157    WL0108    P      Order From Ware
     C                     Z-ADDWL0158    WL0109           Item Code
     C                     Z-ADDWL0160    WL0110           OD Quantity Sch
     C                     Z-ADDWL0159    WL0111           OD Weight Sched
     C                     Z-ADDWN0279    WL0112           OD Quantity Inv
     C                     Z-ADDWN0280    WL0113           OD Weight Inv S
     C                     Z-ADDWN0281    WL0114           OD Quantity Unu
     C                     Z-ADDWN0282    WL0115           OD Weight Unuse
     C                     MOVELWN0283    WL0116    P      OD Added to Sch
     C                     MOVELWN0284    WL0117    P      OD Reallocate S
     C                     MOVELWN0285    WL0118    P      OD Status Unuse
     C                     MOVELWN0286    WL0119    P      EDI Status 1
     C                     MOVELWN0287    WL0120    P      EDI Status 2
     C                     MOVELWN0288    WL0121    P      EDI Status 3
     C                     MOVELWN0289    WL0122    P      Record Status
     C                     Z-ADDWN0290    WL0123           Job Time
     C                     MOVELWN0291    WL0124    P      User Id
     C                     MOVELWN0292    WL0125    P      Job Name
     C                     Z-ADDWN0293    WL0126           Job Date
     C                     EXSR SSCRRC
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WDIGQT    ADD  WL0160    WN0277           OD Quantity Sch
     C           WDFLWG    ADD  WL0159    WN0278           OD Weight Sched
     C                     MOVELWDP7ST    YL0038           OD Added to Sch
      * CASE: PAR.Base/Conv/Loss Item is Converted/Fabricated
     C           WL0161    IFEQ 'C'                        *IF
     C           WL0161    OREQ 'F'
      * CASE: PAR.OD Production Date EQ JOB.*Job date
     C           WL0154    IFEQ ##JDT                      *IF
     C                     MOVEL'Y'       YL0038           OD Added to Sch
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.OD Quantity Scheduled is Greater than zero
     C           WN0277    IFGT *ZERO                      *IF
      * CHG Qty/Wgt Scheduled  CH - Order Detail Schedule  * 
     C                     EXSR TACHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * DLT Ord Detail Sched   DL - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0035           Company Number
     C                     Z-ADDWDC4NB    WL0036           Order Number
     C                     Z-ADDWDDPNB    WL0037           Order Sequence
     C                     Z-ADDWDUENB    WL0038           Order Secondary
     C                     Z-ADDWDJGDT    WL0039           OD Production D
     C                     EXSR SEDLRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TACHRC    BEGSR
      *================================================================
      * CHG Qty/Wgt Scheduled  CH - Order Detail Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0294  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0295  3        Warehouse Code
     C                     MOVEL*BLANK    WN0296  3        Order From Ware
     C                     Z-ADD*ZERO     WN0297  70       Item Code
     C                     Z-ADD*ZERO     WN0298 112       OD Quantity Unu
     C                     Z-ADD*ZERO     WN0299 112       OD Weight Unuse
     C                     MOVEL*BLANK    WN0300  1        OD Reallocate S
     C                     MOVEL*BLANK    WN0301  2        OD Status Unuse
     C                     MOVEL*BLANK    WN0302  1        EDI Status 1
     C                     MOVEL*BLANK    WN0303  1        EDI Status 2
     C                     MOVEL*BLANK    WN0304  1        EDI Status 3
     C                     MOVEL*BLANK    WN0305  1        Record Status
     C                     Z-ADD*ZERO     WN0306  60       Job Time
     C                     MOVEL*BLANK    WN0307 10        User Id
     C                     MOVEL*BLANK    WN0308 10        Job Name
     C                     Z-ADD*ZERO     WN0309  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @KNCPHN
     C                     Z-ADDWDAIC3    WEAIC3           Company Number
     C                     Z-ADDWDC4NB    WEC4NB           Order Number
     C                     Z-ADDWDDPNB    WEDPNB           Order Sequence
     C                     Z-ADDWDUENB    WEUENB           Order Secondary
     C                     Z-ADDWDJGDT    WEJGDT           OD Production D
      *
     C           KLCHTA    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
     C                     KFLD           WEJGDT           OD Production D
     C           KLCHTA    CHAIN@KNCPHN              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDKNCPL0'MDACP
     C                     MOVEL'@KNCPHN' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL008.
     C                     MOVEL'LBL008'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TAEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDKN1    YERDCS
      * Move non-key fields to @KNCPHN
     C                     Z-ADDWN0277    WEIGQT           OD Quantity Sch
     C                     Z-ADDWN0278    WEFLWG           OD Weight Sched
     C                     Z-ADDWDIUQT    WEIUQT           OD Quantity Inv
     C                     Z-ADDWDF3WG    WEF3WG           OD Weight Inv S
     C                     MOVELYL0038    WEP7ST    P      OD Added to Sch
      *
      * Set PGM.*Record Data Changed flag
     C           QPDKN1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##JOB     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDKN1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@KNCPHN                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDKNCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0310  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0311  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0312  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0313  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0314  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0315  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0316  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0317  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0318  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0319  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0320  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0321  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0322  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0323  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0324  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0325  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0326  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0327  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0328  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0329  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0330  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0331  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0332  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0333 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0334  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0335 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0336  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0337 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0338  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0339 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0340  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0341 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0342  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0343 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0344  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0345  3        PS Item Id
     C                     MOVEL*BLANK    WN0346  2        Warehouse Type
     C                     MOVEL*BLANK    WN0347  1        PS Lock Status
     C                     MOVEL*BLANK    WN0348  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0349  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0350  1        PS Piece Count
     C                     MOVEL*BLANK    WN0351  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0352  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0353  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0354  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0355  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0356  3        PS Shift/Priori
     C                     Z-ADD*ZERO     WN0357  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0358  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0359  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0360  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0361  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0362  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0363  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0364  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0365  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0366  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0367  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0368  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0369  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0370  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0371  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0372  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0373  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0374  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0375  6        Department Code
     C                     Z-ADD*ZERO     WN0376  30       Item Structure
     C                     Z-ADD*ZERO     WN0377  30       Item Structure
     C                     Z-ADD*ZERO     WN0378  30       Item Structure
     C                     MOVEL*BLANK    WN0379  6        Primal Group Co
     C                     MOVEL*BLANK    WN0380  1        EDI Status 1
     C                     MOVEL*BLANK    WN0381  1        EDI Status 2
     C                     MOVEL*BLANK    WN0382  1        EDI Status 3
     C                     MOVEL*BLANK    WN0383  1        Record Status
     C                     Z-ADD*ZERO     WN0384  60       Job Time
     C                     MOVEL*BLANK    WN0385 10        User Id
     C                     MOVEL*BLANK    WN0386 10        Job Name
     C                     Z-ADD*ZERO     WN0387  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WRAIC3           Company Number
     C                     KFLD           WRV5ST           Production Type
     C                     KFLD           WRELDT           Production Date
     C                     KFLD           WRHGCD           Item Code
     C                     KFLD           WRAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWL0162    WRAIC3           Company Number
     C                     MOVELWL0163    WRV5ST           Production Type
     C                     Z-ADDWL0164    WRELDT           Production Date
     C                     Z-ADDWL0165    WRHGCD           Item Code
     C                     MOVELWL0166    WRAJCD           Warehouse Code
      * Establish starting position
     C           KRSTB     CHAIN@I8CPUS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1763' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADDWL0167    WN0329           PS Weight Prod
     C                     Z-ADDWL0168    WN0330           PS Pieces Prod
      * CASE: PAR.PS Pieces Prod Allocated is GT Zero
     C           WN0330    IFGT *ZERO                      *IF
      * Average Piece Weight
      * PAR.PS Avg Piece Wgt =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Prod Allocated
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PS Pieces Prod Allocated
     C           WN0329    DIV  WN0330    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0314           PS Avg Piece Wg
     C                     END                             *FI
      * UPS Crt Prod Detail   CR - PS Prod Item Schedule  * 
     C                     EXSR TCCRRC
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WROAWT    ADD  WL0167    WN0329           PS Weight Prod
     C           WRCDNB    ADD  WL0168    WN0330           PS Pieces Prod
      * Chg Prod Allocated    CH - PS Prod Item Schedule  * 
     C                     EXSR TECHRC
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCCRRC    BEGSR
      *================================================================
      * UPS Crt Prod Detail   CR - PS Prod Item Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @I8CPUR
     C                     Z-ADDWL0162    WSAIC3           Company Number
     C                     MOVELWL0163    WSV5ST           Production Type
     C                     Z-ADDWL0164    WSELDT           Production Date
     C                     Z-ADDWL0165    WSHGCD           Item Code
     C                     MOVELWL0166    WSAJCD           Warehouse Code
     C                     Z-ADDWN0310    WSGPDT           PS Available Sh
     C                     Z-ADDWN0311    WSWTSP           PS Weight Plann
     C                     Z-ADDWN0312    WSQTSP           PS Pieces Plann
     C                     Z-ADDWN0313    WSDJPC           PS % of Carcass
     C                     Z-ADDWN0314    WSF8WG           PS Avg Piece Wg
     C                     Z-ADDWN0315    WSWTIN           PS Weight Inv O
     C                     Z-ADDWN0316    WSD5NB           PS Pieces Inv O
     C                     Z-ADDWN0317    WSDXWG           PS Weight Stand
     C                     Z-ADDWN0318    WSB2NB           PS Pieces Stand
     C                     Z-ADDWN0319    WSWTCN           PS Weight Conve
     C                     Z-ADDWN0320    WSPSCV           PS Pieces Conve
     C                     Z-ADDWN0321    WSSAWT           PS Weight Shipp
     C                     Z-ADDWN0322    WSB9NB           PS Pieces Shipp
     C                     Z-ADDWN0323    WSD1WG           PS Weight Prod
     C                     Z-ADDWN0324    WSCBNB           PS Pieces Prod
     C                     Z-ADDWN0325    WSEZWG           PS Weight Inv A
     C                     Z-ADDWN0326    WSCCNB           PS Pieces Inv A
     C                     Z-ADDWN0327    WSE0WG           PS Weight Ship
     C                     Z-ADDWN0328    WSD6NB           PS Pieces Ship
     C                     Z-ADDWN0329    WSOAWT           PS Weight Prod
     C                     Z-ADDWN0330    WSCDNB           PS Pieces Prod
     C                     Z-ADDWN0331    WSUNW2           PS Weight Inv A
     C                     Z-ADDWN0332    WSCENB           PS Pieces Inv A
     C                     Z-ADDWN0333    WSF9WG           PS Unit Weight
     C                     Z-ADDWN0334    WSBPNB           PS Pieces Unuse
     C                     Z-ADDWN0335    WSGAWG           PS Weight Unuse
     C                     Z-ADDWN0336    WSBQNB           PS Pieces Unuse
     C                     Z-ADDWN0337    WSGBWG           PS Weight Unuse
     C                     Z-ADDWN0338    WSBRNB           PS Pieces Unuse
     C                     Z-ADDWN0339    WSGCWG           PS Weight Unuse
     C                     Z-ADDWN0340    WSBSNB           PS Pieces Unuse
     C                     Z-ADDWN0341    WSGDWG           PS Weight Unuse
     C                     Z-ADDWN0342    WSBWNB           PS Pieces Unuse
     C                     Z-ADDWN0343    WSGEWG           PS Weight Unuse
     C                     Z-ADDWN0344    WSPS6U           PS Pieces Unuse
     C                     MOVELWN0345    WSWCST           PS Item Id
     C                     MOVELWN0346    WSWPST           Warehouse Type
     C                     MOVELWN0347    WSB5ST           PS Lock Status
     C                     MOVELWN0348    WSTFST           PS Export/Domes
     C                     MOVELWN0349    WSTEST           PS Print On Sch
     C                     MOVELWN0350    WSTHST           PS Piece Count
     C                     MOVELWN0351    WSUDST           PS Unused Sts 1
     C                     MOVELWN0352    WSUFST           PS Unused Sts 2
     C                     MOVELWN0353    WSUGST           PS Unused Sts 3
     C                     MOVELWN0354    WSUHST           PS Unused Sts 4
     C                     MOVELWN0355    WSB6ST           PS Item Sched N
     C                     MOVELWN0356    WSB7ST           PS Shift/Priori
     C                     Z-ADDWN0357    WSDVWG           PS Weight Order
     C                     Z-ADDWN0358    WSD7NB           PS Pieces Order
     C                     Z-ADDWN0359    WSFCAD           PS Weight FC Ad
     C                     Z-ADDWN0360    WSD9NB           PS Pieces FC Ad
     C                     Z-ADDWN0361    WSDWWG           PS Weight FX Ad
     C                     Z-ADDWN0362    WSEANB           PS Pieces FX Ad
     C                     Z-ADDWN0363    WSSHWT           PS Weight Sched
     C                     Z-ADDWN0364    WSEBNB           PS Pieces Sched
     C                     Z-ADDWN0365    WSAVWT           PS Weight Avail
     C                     Z-ADDWN0366    WSECNB           PS Pieces Avail
     C                     Z-ADDWN0367    WSWTON           PS Weight Produ
     C                     Z-ADDWN0368    WSEDNB           PS Pieces Produ
     C                     Z-ADDWN0369    WSFNWT           PS Weight Fab N
     C                     Z-ADDWN0370    WSEENB           PS Pieces Fab N
     C                     Z-ADDWN0371    WSQTAS           PS Weight Sched
     C                     Z-ADDWN0372    WSEFNB           PS Pieces Sched
     C                     Z-ADDWN0373    WSWAIO           PS Weight Sched
     C                     Z-ADDWN0374    WSEGNB           PS Pieces Sched
     C                     MOVELWN0375    WSR3CD           Department Code
     C                     Z-ADDWN0376    WSRGNB           Item Structure
     C                     Z-ADDWN0377    WSRHNB           Item Structure
     C                     Z-ADDWN0378    WSRINB           Item Structure
     C                     MOVELWN0379    WSXRCD           Primal Group Co
     C                     MOVELWN0380    WSUVST           EDI Status 1
     C                     MOVELWN0381    WSUWST           EDI Status 2
     C                     MOVELWN0382    WSUXST           EDI Status 3
     C                     MOVELWN0383    WSVSST           Record Status
     C                     Z-ADDWN0384    WSAATM           Job Time
     C                     MOVELWN0385    WSAYNA           User Id
     C                     MOVELWN0386    WSA0NA           Job Name
     C                     Z-ADDWN0387    WSAXDT           Job Date
      *
      * USER: Processing before Data update
      * BPS Setup Item Info   IF
      *
     C                     Z-ADD*ZERO     WN0388 155       System Value Nu
      *
      * UPS Rtv Company/Item  IF
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWSAIC3    WL0001           Company Number
     C                     Z-ADDWSHGCD    WL0002           Item Code
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    WUAVNA    P      Description Lin
     C                     MOVELWL0004    WUADCD    P      U/M - Primary
     C                     Z-ADDWL0005    WUAIWG           Unit Weight
     C                     Z-ADDWL0006    WSRINB           Item Structure
     C                     Z-ADDWL0007    WSRHNB           Item Structure
     C                     Z-ADDWL0008    WSRGNB           Item Structure
     C                     MOVELWL0009    WUN0CD    P      Item Type Code
     C                     MOVELWL0010    WUQ1CD    P      Default Warehou
     C                     Z-ADDWL0011    WUCHTM           Fresh Chilling
     C                     MOVELWL0012    WUQZCD    P      Base/Conv/Loss
     C                     MOVELWL0013    WUXWST    P      Variety/Rendere
     C                     MOVELWL0014    WUVMST    P      Credit Item Sta
     C                     Z-ADDWL0015    WUSWGH           Std Weight/Head
     C                     Z-ADDWL0016    WUPPHE           Pieces Per Head
     C                     MOVELWL0017    WSR3CD    P      Department Code
     C                     MOVELWL0018    WUSDCD    P      Group for Packa
     C                     MOVELWL0019    WUX5ST    P      Seconds Item
     C                     MOVELWL0020    WSTHST    P      Piece Count Ite
     C                     Z-ADDWL0021    WUBDNB           Pieces Per Bag
     C                     Z-ADDWL0022    WUBJNB           Bags Per Unit
     C                     MOVELWL0023    WSTFST    P      Export/Domestic
     C                     MOVELWL0024    WSTEST    P      Print On Schedu
     C                     MOVELWL0025    WUSYST    P      Fresh Inv Alloc
     C                     MOVELWL0026    WUSZST    P      Fresh Sched As
     C                     MOVELWL0027    WUS1ST    P      Frozen Sched As
     C                     MOVELWL0028    WSXRCD    P      Primal Group Co
      * BPS Rtv Whs Info      RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWSAJCD    WL0029    P      Warehouse Code
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0030    WSWPST    P      Warehouse Type
     C                     MOVELWL0031    WUXUST    P      Trans Contol AS
     C                     MOVELWL0032    WUT0ST    P      Warehouse Locat
     C                     MOVELWL0033    WUT1ST    P      Warehouse Std C
     C                     Z-ADDWL0034    WUDBNB           Warehouse Chill
      * BPS Set Up Item Id    IF
      * CASE: PAR.Item Type Code is Raw Materials
     C           WUN0CD    IFEQ 'RM'                       *IF
     C                     MOVEL'RMB'     WSWCST           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Seconds Item is Yes
     C           WUX5ST    IFEQ 'Y'                        *IF
     C                     MOVEL'FSC'     WSWCST           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Variety/Rendered/Cut is Variety
     C           WUXWST    IFEQ 'V'                        *IF
     C                     MOVEL'FVR'     WSWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Rendered
     C           WUXWST    IFEQ 'R'                        *IF
     C                     MOVEL'FRD'     WSWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Cut
     C           WUXWST    IFEQ 'C'                        *IF
      * Base/Converted/Fabricated
      * CASE: PAR.Credit Item Status is yes
     C           WUVMST    IFEQ 'Y'                        *IF
      * Setup Base/Converted/Fabricated Credit
      * CASE: PAR.Converted/Base Item is Base
     C           WUQZCD    IFEQ 'B'                        *IF
     C                     MOVEL'FBC'     WSWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WUQZCD    IFEQ 'C'                        *IF
     C                     MOVEL'FCC'     WSWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WUQZCD    IFEQ 'F'                        *IF
     C                     MOVEL'FFC'     WSWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WUQZCD    IFEQ 'L'                        *IF
     C                     MOVEL'FLC'     WSWCST           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup Base/Converted/Fabricated
      * CASE: PAR.Converted/Base Item is Base
     C           WUQZCD    IFEQ 'B'                        *IF
     C                     MOVEL'FGB'     WSWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WUQZCD    IFEQ 'C'                        *IF
     C                     MOVEL'FCV'     WSWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WUQZCD    IFEQ 'F'                        *IF
     C                     MOVEL'FFB'     WSWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WUQZCD    IFEQ 'L'                        *IF
     C                     MOVEL'FLS'     WSWCST           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Available Ship Date
      * CASE: WRK.Warehouse Std Chill Time is yes
     C           WUT1ST    IFEQ 'Y'                        *IF
      * UPS Clc Avail Shp Dte RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWSAIC3    WL0169           Company Number
     C                     Z-ADDWL0164    WL0170           Post to G/L Dat
     C                     Z-ADDWUDBNB    WL0171           Fresh Chilling
     C                     EXSR TDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0172    WSGPDT           PS Available Sh
     C                     ELSE
      * CASE: *OTHERWISE
      * UPS Clc Avail Shp Dte RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWSAIC3    WL0169           Company Number
     C                     Z-ADDWL0164    WL0170           Post to G/L Dat
     C                     Z-ADDWUCHTM    WL0171           Fresh Chilling
     C                     EXSR TDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0172    WSGPDT           PS Available Sh
     C                     END                             *FI
      * Average Piece Weight
      * CASE: PAR.PS Pieces Planned Prod is GT Zero
     C           WN0312    IFGT *ZERO                      *IF
     C           WN0311    DIV  WN0312    WSF8WG    H      PS Avg Piece Wg
     C                     END                             *FI
      * UPS CRTOBJ Stamp      IF
     C                     MOVEL'A'       WSVSST           Record Status
     C                     Z-ADD##JTM     WSAATM           Job Time
     C                     MOVEL##USR     WSAYNA           User Id
     C                     MOVEL##PGM     WSA0NA           Job Name
     C                     Z-ADD##JDT     WSAXDT           Job Date
     C                     MOVEL'N'       WSB5ST           PS Lock Status
     C           KLCRTC    KLIST
     C                     KFLD           WSAIC3           Company Number
     C                     KFLD           WSV5ST           Production Type
     C                     KFLD           WSELDT           Production Date
     C                     KFLD           WSHGCD           Item Code
     C                     KFLD           WSAJCD           Warehouse Code
      * Check for duplicate primary key
     C           KLCRTC    SETLL@I8CPUR                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1764' W0RTN   7
      * Send message 'PS Prod Item Schedule  EX'
     C                     MOVEL'USR1764' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C                     WRITE@I8CPUR                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * UPS Clc Avail Shp Dte RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLAIC3    WQTD01           Company Number
      * Define keylist
     C           KPSTD     KLIST
     C                     KFLD           WQTD01           Company Number
     C                     KFLD           WLBCDT           Post to G/L Dat
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WQTD01           Company Number
      * Setup key
     C                     Z-ADDWL0169    WQTD01           Company Number
     C                     Z-ADDWL0170    WLBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSTD     SETLL@AFREBE                    *
     C           KRSTD     READE@AFREBE                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DOC:  Change Log
     C                     EXSR UBSUBR                     DOC:  Change Lo
      * CASE: WRK.Count USR EQ PAR.Chilling Time
     C           WUCNTU    IFEQ WL0171                     *IF
     C                     Z-ADDWLBCDT    WL0172           PS Available Sh
     C                     GOTO TDEXIT                     *QUIT
     C                     END                             *FI
      * 04/10/07 PKD No offset, so do not check for Saturday.
     C                     ADD  1         WUCNTU           Count USR
     C           KRSTD     READE@AFREBE                  90*
     C                     ENDDO
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TECHRC    BEGSR
      *================================================================
      * Chg Prod Allocated    CH - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0389  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0390  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0391  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0392  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0393  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0394  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0395  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0396  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0397  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0398  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0399  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0400  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0401  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0402  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0403  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0404  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0405  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0406  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0407  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0408  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0409 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0410  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0411 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0412  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0413 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0414  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0415 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0416  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0417 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0418  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0419 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0420  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0421  3        PS Item Id
     C                     MOVEL*BLANK    WN0422  2        Warehouse Type
     C                     MOVEL*BLANK    WN0423  1        PS Lock Status
     C                     MOVEL*BLANK    WN0424  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0425  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0426  1        PS Piece Count
     C                     MOVEL*BLANK    WN0427  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0428  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0429  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0430  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0431  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0432  3        PS Shift/Priori
     C                     Z-ADD*ZERO     WN0433  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0434  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0435  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0436  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0437  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0438  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0439  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0440  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0441  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0442  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0443  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0444  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0445  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0446  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0447  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0448  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0449  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0450  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0451  6        Department Code
     C                     Z-ADD*ZERO     WN0452  30       Item Structure
     C                     Z-ADD*ZERO     WN0453  30       Item Structure
     C                     Z-ADD*ZERO     WN0454  30       Item Structure
     C                     MOVEL*BLANK    WN0455  6        Primal Group Co
     C                     MOVEL*BLANK    WN0456  1        EDI Status 1
     C                     MOVEL*BLANK    WN0457  1        EDI Status 2
     C                     MOVEL*BLANK    WN0458  1        EDI Status 3
     C                     MOVEL*BLANK    WN0459  1        Record Status
     C                     Z-ADD*ZERO     WN0460  60       Job Time
     C                     MOVEL*BLANK    WN0461 10        User Id
     C                     MOVEL*BLANK    WN0462 10        Job Name
     C                     Z-ADD*ZERO     WN0463  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @I8CPUR
     C                     Z-ADDWRAIC3    WSAIC3           Company Number
     C                     MOVELWRV5ST    WSV5ST    P      Production Type
     C                     Z-ADDWRELDT    WSELDT           Production Date
     C                     Z-ADDWRHGCD    WSHGCD           Item Code
     C                     MOVELWRAJCD    WSAJCD    P      Warehouse Code
      *
     C           KLCHTE    KLIST
     C                     KFLD           WSAIC3           Company Number
     C                     KFLD           WSV5ST           Production Type
     C                     KFLD           WSELDT           Production Date
     C                     KFLD           WSHGCD           Item Code
     C                     KFLD           WSAJCD           Warehouse Code
     C           KLCHTE    CHAIN@I8CPUR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI8CPL0'MDACP
     C                     MOVEL'@I8CPUR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL009.
     C                     MOVEL'LBL009'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDI81    YFRDCS
      * Move non-key fields to @I8CPUR
     C                     Z-ADDWRF8WG    WSF8WG           PS Avg Piece Wg
     C                     Z-ADDWN0329    WSOAWT           PS Weight Prod
     C                     Z-ADDWN0330    WSCDNB           PS Pieces Prod
      *
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
      * UPS CHGOBJ Stamp      IF
     C                     Z-ADD##JTM     WSAATM           Job Time
     C                     MOVEL##USR     WSAYNA           User Id
     C                     MOVEL##PGM     WSA0NA           Job Name
     C                     Z-ADD##JDT     WSAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@I8CPUR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDI8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * Clc Date (descending) RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WWAIC3    WQTF01           Company Number
      * Define keylist
     C           KPSTF     KLIST
     C                     KFLD           WQTF01           Company Number
     C                     KFLD           WWBCDT           Post to G/L Dat
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           WQTF01           Company Number
      * Setup key
     C                     Z-ADDWL0173    WQTF01           Company Number
     C                     Z-ADDWL0174    WWBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSTF     SETLL@AFREPU                    *
     C           KRSTF     READE@AFREPU                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Post to G/L Date EQ DB1.Post to G/L Date
     C           WL0174    IFEQ WWBCDT                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
      * CASE: WRK.Count USR EQ PAR.*Duration (factor)
     C           WUCNTU    IFEQ WL0177                     *IF
     C                     Z-ADDWWBCDT    WL0175           *Date1 (ending)
     C                     GOTO TFEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTF     READE@AFREPU                  90*
     C                     ENDDO
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * Clc Date (ascending)  RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WXAIC3    WQTG01           Company Number
      * Define keylist
     C           KPSTG     KLIST
     C                     KFLD           WQTG01           Company Number
     C                     KFLD           WXBCDT           Post to G/L Dat
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           WQTG01           Company Number
      * Setup key
     C                     Z-ADDWL0178    WQTG01           Company Number
     C                     Z-ADDWL0179    WXBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSTG     SETLL@AFREYY                    *
     C           KRSTG     READE@AFREYY                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Post to G/L Date EQ DB1.Post to G/L Date
     C           WL0179    IFEQ WXBCDT                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
      * CASE: WRK.Count USR EQ PAR.*Duration (factor)
     C           WUCNTU    IFEQ WL0182                     *IF
     C                     Z-ADDWXBCDT    WL0180           *Date1 (ending)
     C                     GOTO TGEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTG     READE@AFREYY                  90*
     C                     ENDDO
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THCHRC    BEGSR
      *================================================================
      * Chg Qty/WgtSch & Shrt CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0464  70       Item Code
     C                     MOVEL*BLANK    WN0465  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0466  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0467  70       Order Group Cod
     C                     MOVEL*BLANK    WN0468  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0469  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0470 112       Billing Detail
     C                     Z-ADD*ZERO     WN0471 112       Billing Detail
     C                     Z-ADD*ZERO     WN0472 112       Billing Detail
     C                     Z-ADD*ZERO     WN0473 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0474  1        Comment Print A
     C                     MOVEL*BLANK    WN0475  1        Comment Print I
     C                     MOVEL*BLANK    WN0476  1        Comment Print P
     C                     MOVEL*BLANK    WN0477  1        Comment Print S
     C                     Z-ADD*ZERO     WN0478 112       Extended Amount
     C                     Z-ADD*ZERO     WN0479  70       Market Pricing
     C                     MOVEL*BLANK    WN0480  3        Commodity Marke
     C                     MOVEL*BLANK    WN0481  3        Date Method Cod
     C                     MOVEL*BLANK    WN0482  3        Price Method Co
     C                     Z-ADD*ZERO     WN0483 114       Price Overage O
     C                     Z-ADD*ZERO     WN0484  70       Contract Number
     C                     MOVEL*BLANK    WN0485  1        Price Status
     C                     Z-ADD*ZERO     WN0486  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0487  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0488  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0489  1        Work Confirm St
     C                     MOVEL*BLANK    WN0490  1        Work Over/Short
     C                     MOVEL*BLANK    WN0491  1        Work Extra Stat
     C                     MOVEL*BLANK    WN0492 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0493 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0494  1        Age Code
     C                     MOVEL*BLANK    WN0495  1        Palletize
     C                     MOVEL*BLANK    WN0496  1        Slip Sheet
     C                     MOVEL*BLANK    WN0497  1        Catch Weight St
     C                     MOVEL*BLANK    WN0498  1        Price Audit
     C                     MOVEL*BLANK    WN0499  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0500  1        Production Date
     C                     Z-ADD*ZERO     WN0501 112       Rated Freight
     C                     Z-ADD*ZERO     WN0502 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0503 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0504 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0505 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0506 114       Unit Cost Order
     C                     Z-ADD*ZERO     WN0507 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0508 114       Unit Price
     C                     Z-ADD*ZERO     WN0509 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0510 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0511 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0512 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0513  70       Requested Ship
     C                     Z-ADD*ZERO     WN0514  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0515  70       Actual Shipped
     C                     MOVEL*BLANK    WN0516  1        Affect Inventor
     C                     MOVEL*BLANK    WN0517  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0518  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0519  30       Item Structure
     C                     Z-ADD*ZERO     WN0520  30       Item Structure
     C                     Z-ADD*ZERO     WN0521  30       Item Structure
     C                     MOVEL*BLANK    WN0522  2        Item Level
     C                     MOVEL*BLANK    WN0523  2        Quality Level
     C                     MOVEL*BLANK    WN0524  2        Pricing Product
     C                     MOVEL*BLANK    WN0525  2        Season Product
     C                     Z-ADD*ZERO     WN0526  70       Date of Origina
     C                     MOVEL*BLANK    WN0527 10        User Profile Na
     C                     MOVEL*BLANK    WN0528  6        Country Code
     C                     MOVEL*BLANK    WN0529  2        Event Code
     C                     MOVEL*BLANK    WN0530  3        Reason Code
     C                     MOVEL*BLANK    WN0531  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0532  1        Modified Flag
     C                     MOVEL*BLANK    WN0533  1        Substituted Fla
     C                     MOVEL*BLANK    WN0534  1        Order Detail St
     C                     Z-ADD*ZERO     WN0535 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0536 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0537  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0538  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0539  1        Affect Commissi
     C                     MOVEL*BLANK    WN0540  1        Affect Pricing
     C                     MOVEL*BLANK    WN0541  1        OD Unused Sts 5
     C                     MOVEL*BLANK    WN0542  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0543  2        OD Unused Sts 7
     C                     MOVEL*BLANK    WN0544  3        OD Unused Sts 8
     C                     MOVEL*BLANK    WN0545  3        OD Unused Sts 9
     C                     Z-ADD*ZERO     WN0546  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0547  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0548  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0549  70       OD Unused Date
     C                     Z-ADD*ZERO     WN0550  70       OD Unused Date
     C                     Z-ADD*ZERO     WN0551  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0552  60       Price Code
     C                     Z-ADD*ZERO     WN0553  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0554  60       Substitution Li
     C                     Z-ADD*ZERO     WN0555  60       OD Unused Time
     C                     Z-ADD*ZERO     WN0556 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0557 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0558 112       OD Item Target
     C                     Z-ADD*ZERO     WN0559 112       OD Minimum Unit
     C                     Z-ADD*ZERO     WN0560 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0561 114       OD Unused Prc 1
     C                     Z-ADD*ZERO     WN0562 114       OD Unused Prc 2
     C                     Z-ADD*ZERO     WN0563 114       OD Unused Prc 3
     C                     Z-ADD*ZERO     WN0564 114       OD Unused Prc 4
     C                     Z-ADD*ZERO     WN0565 114       OD Unused Prc 5
     C                     MOVEL*BLANK    WN0566  1        EDI Status 1
     C                     MOVEL*BLANK    WN0567  1        EDI Status 2
     C                     MOVEL*BLANK    WN0568  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0569  60       Job Time
     C                     MOVEL*BLANK    WN0570 10        User Id
     C                     MOVEL*BLANK    WN0571 10        Job Name
     C                     Z-ADD*ZERO     WN0572  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YGRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWAAIC3    WJAIC3           Company Number
     C                     Z-ADDWAC4NB    WJC4NB           Order Number
     C                     Z-ADDWADPNB    WJDPNB           Order Sequence
     C                     Z-ADDWAUENB    WJUENB           Order Secondary
      *
     C           KLCHTH    KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJC4NB           Order Number
     C                     KFLD           WJDPNB           Order Sequence
     C                     KFLD           WJUENB           Order Secondary
     C           KLCHTH    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL010.
     C                     MOVEL'LBL010'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO THEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO THEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YGRDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADDYL0013    WJCCQT           Quantity Schedu
     C                     Z-ADDYL0014    WJAUWG           Weight Schedule
     C                     MOVEL*BLANK    WJFZSX    P      OD Schedule Sho
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL##USR     WJAYNA           User Id
     C                     MOVEL##JOB     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YGRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * DOC:  Allocation
      *================================================================
      * Backward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      * Forward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * DOC:  Change Log
      *================================================================
      * 04/10/07 Effective 04/23/07 representation of Age Code changes
      *          will be such that Age Code A will be 0 day for boxes
      *          and combos.  The labels on the cartons will not print
      *          a date that is offset by Sunday or Holiday.  Instead of
      *          Code Date, it will be the Pack Date.
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WACFC7           Order Group Cod
     C                     Z-ADD*ZERO     WAMAVA           Billing Detail
     C                     Z-ADD*ZERO     WAKDVA           Billing Detail
     C                     Z-ADD*ZERO     WAL8VA           Billing Detail
     C                     Z-ADD*ZERO     WAL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WAAYVA           Extended Amount
     C                     Z-ADD*ZERO     WAEXDT           Market Pricing
     C                     Z-ADD*ZERO     WABZPR           Price Overage O
     C                     Z-ADD*ZERO     WAL6NB           Contract Number
     C                     Z-ADD*ZERO     WAGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WAAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WAD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WACCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WAAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WACBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WAATWG           Weight Shipped
     C                     Z-ADD*ZERO     WAAQCS           Unit Cost Order
     C                     Z-ADD*ZERO     WAAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WAAKPR           Unit Price
     C                     Z-ADD*ZERO     WAALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WAAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WAAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WAA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WADUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WAB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WAA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WANTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WANUDT           Consumed Item C
     C                     Z-ADD*ZERO     WANVDT           Deadline Depart
     C                     Z-ADD*ZERO     WANWDT           OD Unused Date
     C                     Z-ADD*ZERO     WANXDT           OD Unused Date
     C                     Z-ADD*ZERO     WABUTM           Deadline Depart
     C                     Z-ADD*ZERO     WABVTM           Price Code
     C                     Z-ADD*ZERO     WABWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WABXTM           Substitution Li
     C                     Z-ADD*ZERO     WABYTM           OD Unused Time
     C                     Z-ADD*ZERO     WAH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WAH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WAH7NX           OD Item Target
     C                     Z-ADD*ZERO     WAH8NX           OD Minimum Unit
     C                     Z-ADD*ZERO     WAH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WADVPR           OD Unused Prc 1
     C                     Z-ADD*ZERO     WADWPR           OD Unused Prc 2
     C                     Z-ADD*ZERO     WADXPR           OD Unused Prc 3
     C                     Z-ADD*ZERO     WADYPR           OD Unused Prc 4
     C                     Z-ADD*ZERO     WADZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Description Line One
     C                     MOVEL*BLANK    WUAVNA 30
      * Define work field Item Structure Class Code
     C                     Z-ADD*ZERO     WURINB  30
      * Define work field Item Structure Group Code
     C                     Z-ADD*ZERO     WURHNB  30
      * Define work field Item Structure Type Code
     C                     Z-ADD*ZERO     WURGNB  30
      * Define work field Item Type Code
     C                     MOVEL*BLANK    WUN0CD  3
      * Define work field Default Warehouse
     C                     MOVEL*BLANK    WUQ1CD  3
      * Define work field Variety/Rendered/Cut
     C                     MOVEL*BLANK    WUXWST  1
      * Define work field Credit Item Status
     C                     MOVEL*BLANK    WUVMST  1
      * Define work field Std Weight/Head (Var/Ren)
     C                     Z-ADD*ZERO     WUSWGH 112
      * Define work field Department Code
     C                     MOVEL*BLANK    WUR3CD  6
      * Define work field Group for Packaging
     C                     MOVEL*BLANK    WUSDCD  1
      * Define work field Seconds Item
     C                     MOVEL*BLANK    WUX5ST  1
      * Define work field Export/Domestic
     C                     MOVEL*BLANK    WUSUST  1
      * Define work field Print On Schedule
     C                     MOVEL*BLANK    WUSVST  1
      * Define work field Fresh Inv Allocation Seq
     C                     MOVEL*BLANK    WUSYST  1
      * Define work field Fresh Sched As Ordered
     C                     MOVEL*BLANK    WUSZST  1
      * Define work field Frozen Sched As Ordered
     C                     MOVEL*BLANK    WUS1ST  1
      * Define work field Primal Group Code
     C                     MOVEL*BLANK    WUXRCD  6
      * Define work field Trans Contol AS400/Plant
     C                     MOVEL*BLANK    WUXUST  1
      * Define work field Warehouse Location
     C                     MOVEL*BLANK    WUT0ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WBAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WBAIWG           Unit Weight
     C                     Z-ADD*ZERO     WBCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WBC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WBURTN           Number Cases On
     C                     Z-ADD*ZERO     WBAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WBRINB           Item Structure
     C                     Z-ADD*ZERO     WBRHNB           Item Structure
     C                     Z-ADD*ZERO     WBRGNB           Item Structure
     C                     Z-ADD*ZERO     WBTFNB           Transportation
     C                     Z-ADD*ZERO     WBTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WBTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WBBLPR           Market Overage
     C                     Z-ADD*ZERO     WBBMPR           Standard Overag
     C                     Z-ADD*ZERO     WBCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WBCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WBSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WBPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WBICN1           Item Category N
     C                     Z-ADD*ZERO     WBICN2           Item Category N
     C                     Z-ADD*ZERO     WBV2NB           Item Category N
     C                     Z-ADD*ZERO     WBITCN           Item Category N
     C                     Z-ADD*ZERO     WBITC5           Item Category N
     C                     Z-ADD*ZERO     WBICN6           Item Category N
     C                     Z-ADD*ZERO     WBICN7           Item Category N
     C                     Z-ADD*ZERO     WBICN8           Item Category N
     C                     Z-ADD*ZERO     WBICN9           Item Category N
     C                     Z-ADD*ZERO     WBICN0           Item Category N
     C                     Z-ADD*ZERO     WBSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WBA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WBSJNB           CI Unused Numbe
     C                     Z-ADD*ZERO     WBSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WBSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WBSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WBCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WBCGNB           PM Line Time Ef
     C                     Z-ADD*ZERO     WBILNB           PM % 2nds Facto
     C                     Z-ADD*ZERO     WBCHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WBCINB           PM Batch Size
     C                     Z-ADD*ZERO     WBCJNB           PM Lot Size
     C                     Z-ADD*ZERO     WBCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WBCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WBCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WBCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WBCVNB           PM Formula Yiel
     C                     Z-ADD*ZERO     WBCWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WBCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WBCZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WBC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WBB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WBB5NB           PM Line Number
     C                     Z-ADD*ZERO     WBBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WBBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WBF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WBF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WBF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WBBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WBBNNB           Production Qty
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WCBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WCBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WCBUC3           WHS Unused Comp
     C                     Z-ADD*ZERO     WCBVC3           WHS Unused Comp
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDDPNB           Order Sequence
     C                     Z-ADD*ZERO     WDUENB           Order Secondary
     C                     Z-ADD*ZERO     WDJGDT           OD Production D
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDHGCD           Item Code
     C                     Z-ADD*ZERO     WDIGQT           OD Quantity Sch
     C                     Z-ADD*ZERO     WDFLWG           OD Weight Sched
     C                     Z-ADD*ZERO     WDIUQT           OD Quantity Inv
     C                     Z-ADD*ZERO     WDF3WG           OD Weight Inv S
     C                     Z-ADD*ZERO     WDIVQT           OD Quantity Unu
     C                     Z-ADD*ZERO     WDF4WG           OD Weight Unuse
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFC4NB           Order Number
     C                     Z-ADD*ZERO     WFDPNB           Order Sequence
     C                     Z-ADD*ZERO     WFUENB           Order Secondary
     C                     Z-ADD*ZERO     WFJGDT           OD Production D
     C                     Z-ADD*ZERO     WFAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WFHGCD           Item Code
     C                     Z-ADD*ZERO     WFIUQT           OD Quantity Inv
     C                     Z-ADD*ZERO     WFF3WG           OD Weight Inv S
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHC4NB           Order Number
     C                     Z-ADD*ZERO     WHDPNB           Order Sequence
     C                     Z-ADD*ZERO     WHUENB           Order Secondary
     C                     Z-ADD*ZERO     WHJGDT           OD Production D
     C                     Z-ADD*ZERO     WHAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WHNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WHHGCD           Item Code
     C                     Z-ADD*ZERO     WHIGQT           OD Quantity Sch
     C                     Z-ADD*ZERO     WHFLWG           OD Weight Sched
     C                     Z-ADD*ZERO     WHNSQT           ODS Quantity Sh
     C                     Z-ADD*ZERO     WHJQWG           ODS Weight Shor
     C                     Z-ADD*ZERO     WHNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WHBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLAIC3           Company Number
     C                     Z-ADD*ZERO     WLBCDT           Post to G/L Dat
     C                     Z-ADD*ZERO     WLCQNB           Julian Date
     C                     Z-ADD*ZERO     WLESNB           Accounting Year
     C                     Z-ADD*ZERO     WLETNB           Accounting Peri
     C                     Z-ADD*ZERO     WLBZNB           OM Week
     C                     Z-ADD*ZERO     WLEINB           Week Number
     C                     Z-ADD*ZERO     WLAQNB           Billing Cycle
     C                     Z-ADD*ZERO     WLOJDT           HPS PIC Date
     C                     Z-ADD*ZERO     WLNQNX           HPS Calendar Ye
     C                     Z-ADD*ZERO     WLNRNX           HPS Calendar We
     C                     Z-ADD*ZERO     WLOKDT           Calendar Unused
     C                     Z-ADD*ZERO     WLOLDT           Calendar Unused
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Define work field Day NBR USR
     C                     Z-ADD*ZERO     WUDNBU  20
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMAIC3           Company Number
     C                     Z-ADD*ZERO     WMHGCD           Item Code
     C                     Z-ADD*ZERO     WMELDT           Production Date
     C                     Z-ADD*ZERO     WMACWG           Quantity on Han
     C                     Z-ADD*ZERO     WMARQT           Quantity on Han
     C                     Z-ADD*ZERO     WMK7DT           Label Date
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WRAIC3           Company Number
     C                     Z-ADD*ZERO     WRELDT           Production Date
     C                     Z-ADD*ZERO     WRHGCD           Item Code
     C                     Z-ADD*ZERO     WRGPDT           PS Available Sh
     C                     Z-ADD*ZERO     WRWTSP           PS Weight Plann
     C                     Z-ADD*ZERO     WRQTSP           PS Pieces Plann
     C                     Z-ADD*ZERO     WRDJPC           PS % of Carcass
     C                     Z-ADD*ZERO     WRF8WG           PS Avg Piece Wg
     C                     Z-ADD*ZERO     WRWTIN           PS Weight Inv O
     C                     Z-ADD*ZERO     WRD5NB           PS Pieces Inv O
     C                     Z-ADD*ZERO     WRDXWG           PS Weight Stand
     C                     Z-ADD*ZERO     WRB2NB           PS Pieces Stand
     C                     Z-ADD*ZERO     WRWTCN           PS Weight Conve
     C                     Z-ADD*ZERO     WRPSCV           PS Pieces Conve
     C                     Z-ADD*ZERO     WRSAWT           PS Weight Shipp
     C                     Z-ADD*ZERO     WRB9NB           PS Pieces Shipp
     C                     Z-ADD*ZERO     WRD1WG           PS Weight Prod
     C                     Z-ADD*ZERO     WRCBNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WREZWG           PS Weight Inv A
     C                     Z-ADD*ZERO     WRCCNB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WRE0WG           PS Weight Ship
     C                     Z-ADD*ZERO     WRD6NB           PS Pieces Ship
     C                     Z-ADD*ZERO     WROAWT           PS Weight Prod
     C                     Z-ADD*ZERO     WRCDNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WRUNW2           PS Weight Inv A
     C                     Z-ADD*ZERO     WRCENB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WRF9WG           PS Unit Weight
     C                     Z-ADD*ZERO     WRBPNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WRGAWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WRBQNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WRGBWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WRBRNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WRGCWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WRBSNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WRGDWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WRBWNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WRGEWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WRPS6U           PS Pieces Unuse
     C                     Z-ADD*ZERO     WRDVWG           PS Weight Order
     C                     Z-ADD*ZERO     WRD7NB           PS Pieces Order
     C                     Z-ADD*ZERO     WRFCAD           PS Weight FC Ad
     C                     Z-ADD*ZERO     WRD9NB           PS Pieces FC Ad
     C                     Z-ADD*ZERO     WRDWWG           PS Weight FX Ad
     C                     Z-ADD*ZERO     WREANB           PS Pieces FX Ad
     C                     Z-ADD*ZERO     WRSHWT           PS Weight Sched
     C                     Z-ADD*ZERO     WREBNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WRAVWT           PS Weight Avail
     C                     Z-ADD*ZERO     WRECNB           PS Pieces Avail
     C                     Z-ADD*ZERO     WRWTON           PS Weight Produ
     C                     Z-ADD*ZERO     WREDNB           PS Pieces Produ
     C                     Z-ADD*ZERO     WRFNWT           PS Weight Fab N
     C                     Z-ADD*ZERO     WREENB           PS Pieces Fab N
     C                     Z-ADD*ZERO     WRQTAS           PS Weight Sched
     C                     Z-ADD*ZERO     WREFNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WRWAIO           PS Weight Sched
     C                     Z-ADD*ZERO     WREGNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WRRGNB           Item Structure
     C                     Z-ADD*ZERO     WRRHNB           Item Structure
     C                     Z-ADD*ZERO     WRRINB           Item Structure
     C                     Z-ADD*ZERO     WRAATM           Job Time
     C                     Z-ADD*ZERO     WRAXDT           Job Date
      * Define work field Record Found USR
     C                     MOVEL*BLANK    WUWXST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WTAIC3           Company Number
     C                     Z-ADD*ZERO     WTELDT           Production Date
     C                     Z-ADD*ZERO     WTHVHD           Hog Volume
     C                     Z-ADD*ZERO     WTZ6NB           Average Live We
     C                     Z-ADD*ZERO     WTZ7NB           Average Hot Wei
     C                     Z-ADD*ZERO     WTDGPC           Cooler Shrink P
     C                     Z-ADD*ZERO     WTAVCW           Average Cold We
     C                     Z-ADD*ZERO     WTDIPC           Average Lean Pe
     C                     Z-ADD*ZERO     WTZ0NB           Average Backfat
     C                     Z-ADD*ZERO     WTAVLE           Average Loin-Ey
     C                     Z-ADD*ZERO     WTECWG           Hot Weight Tota
     C                     Z-ADD*ZERO     WTAATM           Job Time
     C                     Z-ADD*ZERO     WTAXDT           Job Date
      * Define work field U/M - Primary
     C                     MOVEL*BLANK    WUADCD  2
      * Define work field Unit Weight
     C                     Z-ADD*ZERO     WUAIWG 112
      * Define work field Fresh Chilling Time
     C                     Z-ADD*ZERO     WUCHTM  52
      * Define work field Base/Conv/Loss Item
     C                     MOVEL*BLANK    WUQZCD  2
      * Define work field Pieces Per Head
     C                     Z-ADD*ZERO     WUPPHE  70
      * Define work field Pieces Per Bag
     C                     Z-ADD*ZERO     WUBDNB  70
      * Define work field Bags Per Unit
     C                     Z-ADD*ZERO     WUBJNB  70
      * Define work field Warehouse Std Chill Time
     C                     MOVEL*BLANK    WUT1ST  1
      * Define work field Warehouse Chill Time
     C                     Z-ADD*ZERO     WUDBNB  52
      * Define work field Count USR
     C                     Z-ADD*ZERO     WUCNTU  50
      * Define work field *Duration (factor)
     C                     Z-ADD*ZERO     WUDUF   80
      * Define work field Order Value Total
     C                     Z-ADD*ZERO     WUJZVA 112
      * Define work field Order Weight Total
     C                     Z-ADD*ZERO     WUA1WG 112
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WJ00 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WJ02 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WJ01 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA02 152       *Synon (15,2) w
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SBRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003 30
     C                     MOVEL*BLANK    WL0004  2
     C                     Z-ADD*ZERO     WL0005 112
     C                     Z-ADD*ZERO     WL0006  30
     C                     Z-ADD*ZERO     WL0007  30
     C                     Z-ADD*ZERO     WL0008  30
     C                     MOVEL*BLANK    WL0009  3
     C                     MOVEL*BLANK    WL0010  3
     C                     Z-ADD*ZERO     WL0011  52
     C                     MOVEL*BLANK    WL0012  2
     C                     MOVEL*BLANK    WL0013  1
     C                     MOVEL*BLANK    WL0014  1
     C                     Z-ADD*ZERO     WL0015 112
     C                     Z-ADD*ZERO     WL0016  70
     C                     MOVEL*BLANK    WL0017  6
     C                     MOVEL*BLANK    WL0018  1
     C                     MOVEL*BLANK    WL0019  1
     C                     MOVEL*BLANK    WL0020  1
     C                     Z-ADD*ZERO     WL0021  70
     C                     Z-ADD*ZERO     WL0022  70
     C                     MOVEL*BLANK    WL0023  1
     C                     MOVEL*BLANK    WL0024  1
     C                     MOVEL*BLANK    WL0025  1
     C                     MOVEL*BLANK    WL0026  1
     C                     MOVEL*BLANK    WL0027  1
     C                     MOVEL*BLANK    WL0028  6
      * Define local variables for subroutine SCRVGN.
     C                     MOVEL*BLANK    WL0029  3
     C                     MOVEL*BLANK    WL0030  2
     C                     MOVEL*BLANK    WL0031  1
     C                     MOVEL*BLANK    WL0032  1
     C                     MOVEL*BLANK    WL0033  1
     C                     Z-ADD*ZERO     WL0034  52
      * Define local variables for subroutine SEDLRC.
     C                     Z-ADD*ZERO     WL0035  30
     C                     Z-ADD*ZERO     WL0036  70
     C                     Z-ADD*ZERO     WL0037  30
     C                     Z-ADD*ZERO     WL0038  30
     C                     Z-ADD*ZERO     WL0039  70
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0040  30
     C                     Z-ADD*ZERO     WL0041  70
     C                     Z-ADD*ZERO     WL0042  30
     C                     Z-ADD*ZERO     WL0043  30
      * Define local variables for subroutine SGDLRC.
     C                     Z-ADD*ZERO     WL0044  30
     C                     Z-ADD*ZERO     WL0045  70
     C                     Z-ADD*ZERO     WL0046  30
     C                     Z-ADD*ZERO     WL0047  30
     C                     Z-ADD*ZERO     WL0048  70
      * Define local variables for subroutine SHRVGN.
     C                     Z-ADD*ZERO     WL0049  30
     C                     Z-ADD*ZERO     WL0050  70
     C                     Z-ADD*ZERO     WL0051  30
     C                     Z-ADD*ZERO     WL0052  30
      * Define local variables for subroutine SLRVGN.
     C                     Z-ADD*ZERO     WL0053  30
     C                     Z-ADD*ZERO     WL0054  70
     C                     MOVEL*BLANK    WL0055  1
      * Define local variables for subroutine SMRVGN.
     C                     Z-ADD*ZERO     WL0056  30
     C                     Z-ADD*ZERO     WL0057  70
     C                     MOVEL*BLANK    WL0058  3
     C                     Z-ADD*ZERO     WL0059  70
     C                     Z-ADD*ZERO     WL0060 112
     C                     MOVEL*BLANK    WL0061  1
     C                     Z-ADD*ZERO     WL0062  70
     C                     Z-ADD*ZERO     WL0063  70
     C                     Z-ADD*ZERO     WL0064  70
     C                     Z-ADD*ZERO     WL0065  30
     C                     Z-ADD*ZERO     WL0066  30
     C                     Z-ADD*ZERO     WL0067 112
     C                     Z-ADD*ZERO     WL0068 112
     C                     Z-ADD*ZERO     WL0069 112
     C                     Z-ADD*ZERO     WL0070 112
     C                     Z-ADD*ZERO     WL0071 112
     C                     Z-ADD*ZERO     WL0072 112
     C                     Z-ADD*ZERO     WL0073  70
      * Define local variables for subroutine SNRVGN.
     C                     Z-ADD*ZERO     WL0074  30
     C                     Z-ADD*ZERO     WL0075  70
     C                     MOVEL*BLANK    WL0076  3
     C                     Z-ADD*ZERO     WL0077  70
     C                     Z-ADD*ZERO     WL0078 112
     C                     Z-ADD*ZERO     WL0079 112
      * Define local variables for subroutine SORVGN.
     C                     Z-ADD*ZERO     WL0080  30
     C                     Z-ADD*ZERO     WL0081  70
     C                     Z-ADD*ZERO     WL0082  30
     C                     Z-ADD*ZERO     WL0083  30
     C                     Z-ADD*ZERO     WL0084  70
     C                     Z-ADD*ZERO     WL0085  70
     C                     MOVEL*BLANK    WL0086  3
     C                     Z-ADD*ZERO     WL0087  70
     C                     Z-ADD*ZERO     WL0088 112
     C                     Z-ADD*ZERO     WL0089 112
      * Define local variables for subroutine SRRVGN.
     C                     Z-ADD*ZERO     WL0090  30
     C                     Z-ADD*ZERO     WL0091  70
     C                     Z-ADD*ZERO     WL0092  30
     C                     Z-ADD*ZERO     WL0093  30
     C                     Z-ADD*ZERO     WL0094  70
     C                     Z-ADD*ZERO     WL0095  70
     C                     MOVEL*BLANK    WL0096  3
     C                     MOVEL*BLANK    WL0097  3
     C                     Z-ADD*ZERO     WL0098  70
     C                     Z-ADD*ZERO     WL0099 112
     C                     Z-ADD*ZERO     WL0100  92
      * Define local variables for subroutine SSCRRC.
     C                     Z-ADD*ZERO     WL0101  30
     C                     Z-ADD*ZERO     WL0102  70
     C                     Z-ADD*ZERO     WL0103  30
     C                     Z-ADD*ZERO     WL0104  30
     C                     Z-ADD*ZERO     WL0105  70
     C                     Z-ADD*ZERO     WL0106  70
     C                     MOVEL*BLANK    WL0107  3
     C                     MOVEL*BLANK    WL0108  3
     C                     Z-ADD*ZERO     WL0109  70
     C                     Z-ADD*ZERO     WL0110 112
     C                     Z-ADD*ZERO     WL0111 112
     C                     Z-ADD*ZERO     WL0112 112
     C                     Z-ADD*ZERO     WL0113 112
     C                     Z-ADD*ZERO     WL0114 112
     C                     Z-ADD*ZERO     WL0115 112
     C                     MOVEL*BLANK    WL0116  1
     C                     MOVEL*BLANK    WL0117  1
     C                     MOVEL*BLANK    WL0118  2
     C                     MOVEL*BLANK    WL0119  1
     C                     MOVEL*BLANK    WL0120  1
     C                     MOVEL*BLANK    WL0121  1
     C                     MOVEL*BLANK    WL0122  1
     C                     Z-ADD*ZERO     WL0123  60
     C                     MOVEL*BLANK    WL0124 10
     C                     MOVEL*BLANK    WL0125 10
     C                     Z-ADD*ZERO     WL0126  70
      * Define local variables for subroutine SURVGN.
     C                     Z-ADD*ZERO     WL0127  30
     C                     MOVEL*BLANK    WL0128  1
     C                     Z-ADD*ZERO     WL0129  70
     C                     Z-ADD*ZERO     WL0130  70
     C                     MOVEL*BLANK    WL0131  3
     C                     MOVEL*BLANK    WL0132  1
     C                     Z-ADD*ZERO     WL0133  70
     C                     Z-ADD*ZERO     WL0134  70
     C                     Z-ADD*ZERO     WL0135  92
     C                     Z-ADD*ZERO     WL0136 112
      * Define local variables for subroutine SWRVGN.
     C                     Z-ADD*ZERO     WL0137  30
     C                     MOVEL*BLANK    WL0138  1
     C                     Z-ADD*ZERO     WL0139  70
     C                     MOVEL*BLANK    WL0140  1
      * Define local variables for subroutine SXRVGN.
     C                     Z-ADD*ZERO     WL0141  30
     C                     MOVEL*BLANK    WL0142  1
     C                     Z-ADD*ZERO     WL0143  70
     C                     Z-ADD*ZERO     WL0144  70
     C                     MOVEL*BLANK    WL0145  3
     C                     Z-ADD*ZERO     WL0146  92
     C                     Z-ADD*ZERO     WL0147 112
     C                     Z-ADD*ZERO     WL0148  70
     C                     Z-ADD*ZERO     WL0149  52
      * Define local variables for subroutine SZRVGN.
     C                     Z-ADD*ZERO     WL0150  30
     C                     Z-ADD*ZERO     WL0151  70
     C                     Z-ADD*ZERO     WL0152  30
     C                     Z-ADD*ZERO     WL0153  30
     C                     Z-ADD*ZERO     WL0154  70
     C                     Z-ADD*ZERO     WL0155  70
     C                     MOVEL*BLANK    WL0156  3
     C                     MOVEL*BLANK    WL0157  3
     C                     Z-ADD*ZERO     WL0158  70
     C                     Z-ADD*ZERO     WL0159  92
     C                     Z-ADD*ZERO     WL0160 112
     C                     MOVEL*BLANK    WL0161  2
      * Define local variables for subroutine TBRVGN.
     C                     Z-ADD*ZERO     WL0162  30
     C                     MOVEL*BLANK    WL0163  1
     C                     Z-ADD*ZERO     WL0164  70
     C                     Z-ADD*ZERO     WL0165  70
     C                     MOVEL*BLANK    WL0166  3
     C                     Z-ADD*ZERO     WL0167  92
     C                     Z-ADD*ZERO     WL0168  70
      * Define local variables for subroutine TDRVGN.
     C                     Z-ADD*ZERO     WL0169  30
     C                     Z-ADD*ZERO     WL0170  70
     C                     Z-ADD*ZERO     WL0171  52
     C                     Z-ADD*ZERO     WL0172  70
      * Define local variables for subroutine TFRVGN.
     C                     Z-ADD*ZERO     WL0173  30
     C                     Z-ADD*ZERO     WL0174  70
     C                     Z-ADD*ZERO     WL0175  70
     C                     Z-ADD*ZERO     WL0176  70
     C                     Z-ADD*ZERO     WL0177  80
      * Define local variables for subroutine TGRVGN.
     C                     Z-ADD*ZERO     WL0178  30
     C                     Z-ADD*ZERO     WL0179  70
     C                     Z-ADD*ZERO     WL0180  70
     C                     Z-ADD*ZERO     WL0181  70
     C                     Z-ADD*ZERO     WL0182  80
      * Define local work field Ship Date USR
     C                     Z-ADD*ZERO     YL0001  70
      * Define local work field U/M - Primary
     C                     MOVEL*BLANK    YL0002  2
      * Define local work field Unit Weight
     C                     Z-ADD*ZERO     YL0003 112
      * Define local work field Fresh Chilling Time
     C                     Z-ADD*ZERO     YL0004  52
      * Define local work field Base/Conv/Loss Item
     C                     MOVEL*BLANK    YL0005  2
      * Define local work field Pieces Per Head
     C                     Z-ADD*ZERO     YL0006  70
      * Define local work field Piece Count Item
     C                     MOVEL*BLANK    YL0007  1
      * Define local work field Pieces Per Bag
     C                     Z-ADD*ZERO     YL0008  70
      * Define local work field Bags Per Unit
     C                     Z-ADD*ZERO     YL0009  70
      * Define local work field Warehouse Type
     C                     MOVEL*BLANK    YL0010  2
      * Define local work field Warehouse Std Chill Time
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field Warehouse Chill Time
     C                     Z-ADD*ZERO     YL0012  52
      * Define local work field Quantity Scheduled
     C                     Z-ADD*ZERO     YL0013 112
      * Define local work field Weight Scheduled
     C                     Z-ADD*ZERO     YL0014 112
      * Define local work field OD Schedule Shortage
     C                     MOVEL*BLANK    YL0015  1
      * Define local work field Production Day Status
     C                     MOVEL*BLANK    YL0016  1
      * Define local work field Production Date RGF
     C                     Z-ADD*ZERO     YL0017  70
      * Define local work field Production Date RGT
     C                     Z-ADD*ZERO     YL0018  70
      * Define local work field Fresh Chilling Time
     C                     Z-ADD*ZERO     YL0019  52
      * Define local work field Quantity Ordered
     C                     Z-ADD*ZERO     YL0020 112
      * Define local work field Weight Ordered
     C                     Z-ADD*ZERO     YL0021 112
      * Define local work field Production Date
     C                     Z-ADD*ZERO     YL0022  70
      * Define local work field Quantity Scheduled
     C                     Z-ADD*ZERO     YL0023 112
      * Define local work field Weight Scheduled
     C                     Z-ADD*ZERO     YL0024 112
      * Define local work field ATS Quantity Need USR
     C                     Z-ADD*ZERO     YL0025 112
      * Define local work field ATS Weight Need USR
     C                     Z-ADD*ZERO     YL0026 112
      * Define local work field OD Quantity Inv Sched
     C                     Z-ADD*ZERO     YL0027 112
      * Define local work field OD Weight Inv Sched
     C                     Z-ADD*ZERO     YL0028 112
      * Define local work field OD Quantity Inv Sched
     C                     Z-ADD*ZERO     YL0029 112
      * Define local work field OD Weight Inv Sched
     C                     Z-ADD*ZERO     YL0030 112
      * Define local work field OD Quantity Inv Sched
     C                     Z-ADD*ZERO     YL0031 112
      * Define local work field OD Weight Inv Sched
     C                     Z-ADD*ZERO     YL0032 112
      * Define local work field OD Quantity Scheduled
     C                     Z-ADD*ZERO     YL0033 112
      * Define local work field OD Weight Scheduled
     C                     Z-ADD*ZERO     YL0034 112
      * Define local work field Allocation Method USR
     C                     MOVEL*BLANK    YL0035  1
      * Define local work field Production Date To
     C                     Z-ADD*ZERO     YL0036  70
      * Define local work field Production Day Status
     C                     MOVEL*BLANK    YL0037  1
      * Define local work field OD Added to Sched Today
     C                     MOVEL*BLANK    YL0038  1
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 SHIPOFFCUT
00002 SCHEDASORD
