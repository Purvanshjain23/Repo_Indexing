     H/TITLE Exc Prc from F0010    XF  Execute external functio
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) BNDDIR(YBNDDIR) DBGVIEW(*SOURCE)
     Z* CVTOPT(*DATETIME) ACTGRP(*CALLER) OPTIMIZE(*BASIC)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
     H* Object type   : *PGM
      *
     H* Company       : E1IDEVMDL
     H* System        : E1IDEVMDL
     H* User name     : ISRCENT
     H* Date          : 04/27/20  Time  : 09:40:06
     H* Copyright     : E1IDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FEZ0010L2  IF   E           K DISK
      * RSQ : Company Constants  F0010Z Sel Unprocessed
      *
     FE10010L1  IF   E           K DISK
      * RTV : Company Constants  F0010  Retrieval index
      *
     FE10010L0  UF A E           K DISK
      * UPD : Company Constants  F0010  Update index
      *
     FEZ0010L0  UF   E           K DISK
      * UPD : Company Constants  F0010Z Update index
      *
      * Long constants
     D @CN#            S              6    DIM(01)CTDATA PERRCD(1)
     D @CN             S             25    DIM(01) ALT(@CN#)
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
     D QE1001        E DS                  EXTNAME(E10010L0)
      * UPD : Company Constants  F0010  Update index
      * Renamed input format fields
     D  WCCO         E                     EXTFLD(CCCO)
     D  WCNAME       E                     EXTFLD(CCNAME)
     D  WCALTC       E                     EXTFLD(CCALTC)
     D  WCDFYJ       E                     EXTFLD(CCDFYJ)
     D  WCPNC        E                     EXTFLD(CCPNC)
     D  WCDOT1       E                     EXTFLD(CCDOT1)
     D  WCCRYR       E                     EXTFLD(CCCRYR)
     D  WCCRYC       E                     EXTFLD(CCCRYC)
     D  WCDOT2       E                     EXTFLD(CCDOT2)
     D  WCMCUA       E                     EXTFLD(CCMCUA)
     D  WCMCUD       E                     EXTFLD(CCMCUD)
     D  WCMCUC       E                     EXTFLD(CCMCUC)
     D  WCMCUB       E                     EXTFLD(CCMCUB)
     D  WCDPRC       E                     EXTFLD(CCDPRC)
     D  WCBKTX       E                     EXTFLD(CCBKTX)
     D  WCTXBM       E                     EXTFLD(CCTXBM)
     D  WCTXBO       E                     EXTFLD(CCTXBO)
     D  WCNWXJ       E                     EXTFLD(CCNWXJ)
     D  WCGLIE       E                     EXTFLD(CCGLIE)
     D  WCABIN       E                     EXTFLD(CCABIN)
     D  WCCALD       E                     EXTFLD(CCCALD)
     D  WCDTPN       E                     EXTFLD(CCDTPN)
     D  WCPNF        E                     EXTFLD(CCPNF)
     D  WCDFF        E                     EXTFLD(CCDFF)
     D  WCCRCD       E                     EXTFLD(CCCRCD)
     D  WCSMI        E                     EXTFLD(CCSMI)
     D  WCSMU        E                     EXTFLD(CCSMU)
     D  WCSMS        E                     EXTFLD(CCSMS)
     D  WCDNLT       E                     EXTFLD(CCDNLT)
     D  WCSTMT       E                     EXTFLD(CCSTMT)
     D  WCATCS       E                     EXTFLD(CCATCS)
     D  WCALGM       E                     EXTFLD(CCALGM)
     D  WCAGEM       E                     EXTFLD(CCAGEM)
     D  WCCRDY       E                     EXTFLD(CCCRDY)
     D  WCAGR1       E                     EXTFLD(CCAGR1)
     D  WCAGR2       E                     EXTFLD(CCAGR2)
     D  WCAGR3       E                     EXTFLD(CCAGR3)
     D  WCAGR4       E                     EXTFLD(CCAGR4)
     D  WCAGR5       E                     EXTFLD(CCAGR5)
     D  WCAGR6       E                     EXTFLD(CCAGR6)
     D  WCAGR7       E                     EXTFLD(CCAGR7)
     D  WCFRY        E                     EXTFLD(CCFRY)
     D  WCFRP        E                     EXTFLD(CCFRP)
     D  WCNNP        E                     EXTFLD(CCNNP)
     D  WCFP         E                     EXTFLD(CCFP)
     D  WCAGE        E                     EXTFLD(CCAGE)
     D  WCDAG        E                     EXTFLD(CCDAG)
     D  WCARPN       E                     EXTFLD(CCARPN)
     D  WCAPPN       E                     EXTFLD(CCAPPN)
     D  WCARFJ       E                     EXTFLD(CCARFJ)
     D  WCAPFJ       E                     EXTFLD(CCAPFJ)
     D  WCAN8        E                     EXTFLD(CCAN8)
     D  WCSGBK       E                     EXTFLD(CCSGBK)
     D  WCPTCO       E                     EXTFLD(CCPTCO)
     D  WCX1         E                     EXTFLD(CCX1)
     D  WCX2         E                     EXTFLD(CCX2)
     D  WCUSER       E                     EXTFLD(CCUSER)
     D  WCPID        E                     EXTFLD(CCPID)
     D  WCUPMJ       E                     EXTFLD(CCUPMJ)
     D  WCJOBN       E                     EXTFLD(CCJOBN)
     D  WCUPMT       E                     EXTFLD(CCUPMT)
     D  WCFKNB       E                     EXTFLD(CCFKNB)
     D  WCH0TX       E                     EXTFLD(CCH0TX)
     D  WCH1TX       E                     EXTFLD(CCH1TX)
     D  WCAN8C       E                     EXTFLD(CCAN8C)
      *
     D YARDCS          DS           298
      * Message data for message Y2U0009.
     D MD0009          DS
     D  MDPGM                  1     10
     D  MDACP                 11     20
     D  MDFMT                 21     30
     D  MDACT                 31     34
     D  MDLBL                 35     40
     D QEZ001        E DS                  EXTNAME(EZ0010L0)
      * UPD : Company Constants  F0010Z Update index
      * Renamed input format fields
     D  WDCO         E                     EXTFLD(BDCO)
     D  WDACTS       E                     EXTFLD(BDACTS)
     D  WDNAME       E                     EXTFLD(BDNAME)
     D  WDALTC       E                     EXTFLD(BDALTC)
     D  WDDFYJ       E                     EXTFLD(BDDFYJ)
     D  WDPNC        E                     EXTFLD(BDPNC)
     D  WDDOT1       E                     EXTFLD(BDDOT1)
     D  WDCRYR       E                     EXTFLD(BDCRYR)
     D  WDCRYC       E                     EXTFLD(BDCRYC)
     D  WDDOT2       E                     EXTFLD(BDDOT2)
     D  WDMCUA       E                     EXTFLD(BDMCUA)
     D  WDMCUD       E                     EXTFLD(BDMCUD)
     D  WDMCUC       E                     EXTFLD(BDMCUC)
     D  WDMCUB       E                     EXTFLD(BDMCUB)
     D  WDDPRC       E                     EXTFLD(BDDPRC)
     D  WDBKTX       E                     EXTFLD(BDBKTX)
     D  WDTXBM       E                     EXTFLD(BDTXBM)
     D  WDTXBO       E                     EXTFLD(BDTXBO)
     D  WDNWXJ       E                     EXTFLD(BDNWXJ)
     D  WDGLIE       E                     EXTFLD(BDGLIE)
     D  WDABIN       E                     EXTFLD(BDABIN)
     D  WDCALD       E                     EXTFLD(BDCALD)
     D  WDDTPN       E                     EXTFLD(BDDTPN)
     D  WDPNF        E                     EXTFLD(BDPNF)
     D  WDDFF        E                     EXTFLD(BDDFF)
     D  WDCRCD       E                     EXTFLD(BDCRCD)
     D  WDSMI        E                     EXTFLD(BDSMI)
     D  WDSMU        E                     EXTFLD(BDSMU)
     D  WDSMS        E                     EXTFLD(BDSMS)
     D  WDDNLT       E                     EXTFLD(BDDNLT)
     D  WDSTMT       E                     EXTFLD(BDSTMT)
     D  WDATCS       E                     EXTFLD(BDATCS)
     D  WDALGM       E                     EXTFLD(BDALGM)
     D  WDAGEM       E                     EXTFLD(BDAGEM)
     D  WDCRDY       E                     EXTFLD(BDCRDY)
     D  WDAGR1       E                     EXTFLD(BDAGR1)
     D  WDAGR2       E                     EXTFLD(BDAGR2)
     D  WDAGR3       E                     EXTFLD(BDAGR3)
     D  WDAGR4       E                     EXTFLD(BDAGR4)
     D  WDAGR5       E                     EXTFLD(BDAGR5)
     D  WDAGR6       E                     EXTFLD(BDAGR6)
     D  WDAGR7       E                     EXTFLD(BDAGR7)
     D  WDFRY        E                     EXTFLD(BDFRY)
     D  WDFRP        E                     EXTFLD(BDFRP)
     D  WDNNP        E                     EXTFLD(BDNNP)
     D  WDFP         E                     EXTFLD(BDFP)
     D  WDAGE        E                     EXTFLD(BDAGE)
     D  WDDAG        E                     EXTFLD(BDDAG)
     D  WDARPN       E                     EXTFLD(BDARPN)
     D  WDAPPN       E                     EXTFLD(BDAPPN)
     D  WDARFJ       E                     EXTFLD(BDARFJ)
     D  WDAPFJ       E                     EXTFLD(BDAPFJ)
     D  WDAN8        E                     EXTFLD(BDAN8)
     D  WDSGBK       E                     EXTFLD(BDSGBK)
     D  WDPTCO       E                     EXTFLD(BDPTCO)
     D  WDX1         E                     EXTFLD(BDX1)
     D  WDX2         E                     EXTFLD(BDX2)
     D  WDUSER       E                     EXTFLD(BDUSER)
     D  WDPID        E                     EXTFLD(BDPID)
     D  WDUPMJ       E                     EXTFLD(BDUPMJ)
     D  WDJOBN       E                     EXTFLD(BDJOBN)
     D  WDUPMT       E                     EXTFLD(BDUPMT)
     D  WDFKNB       E                     EXTFLD(BDFKNB)
     D  WDH0TX       E                     EXTFLD(BDH0TX)
     D  WDH1TX       E                     EXTFLD(BDH1TX)
     D  WDKGNB       E                     EXTFLD(BDKGNB)
     D  WDIEST       E                     EXTFLD(BDIEST)
     D  WDADDT       E                     EXTFLD(BDADDT)
     D  WDADTM       E                     EXTFLD(BDADTM)
      *
     D YBRDCS          DS           333
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  XDTSDL         S             26
     D  ZADFMF         S             10
     D  YARDC          S              1
     D  YBRDC          S              1
     D  ZAPGMQ         S             10
     D  ZAPGRL         S              5
     D  ZAMSID         S              7
     D  ZAMSGF         S             10
     D  ZAMSTP         S              7
     D  YILE           S              1
     D  W0PMT          S              1
     D                 DS
     D  ZAMSDA                 1    132
     I@0010FC
      * Company Constants  F0010Z Sel Unprocessed
      * Renamed input format fields
     I              BDCO                        WACO
     I              BDACTS                      WAACTS
     I              BDNAME                      WANAME
     I              BDALTC                      WAALTC
     I              BDDFYJ                      WADFYJ
     I              BDPNC                       WAPNC
     I              BDDOT1                      WADOT1
     I              BDCRYR                      WACRYR
     I              BDCRYC                      WACRYC
     I              BDDOT2                      WADOT2
     I              BDMCUA                      WAMCUA
     I              BDMCUD                      WAMCUD
     I              BDMCUC                      WAMCUC
     I              BDMCUB                      WAMCUB
     I              BDDPRC                      WADPRC
     I              BDBKTX                      WABKTX
     I              BDTXBM                      WATXBM
     I              BDTXBO                      WATXBO
     I              BDNWXJ                      WANWXJ
     I              BDGLIE                      WAGLIE
     I              BDABIN                      WAABIN
     I              BDCALD                      WACALD
     I              BDDTPN                      WADTPN
     I              BDPNF                       WAPNF
     I              BDDFF                       WADFF
     I              BDCRCD                      WACRCD
     I              BDSMI                       WASMI
     I              BDSMU                       WASMU
     I              BDSMS                       WASMS
     I              BDDNLT                      WADNLT
     I              BDSTMT                      WASTMT
     I              BDATCS                      WAATCS
     I              BDALGM                      WAALGM
     I              BDAGEM                      WAAGEM
     I              BDCRDY                      WACRDY
     I              BDAGR1                      WAAGR1
     I              BDAGR2                      WAAGR2
     I              BDAGR3                      WAAGR3
     I              BDAGR4                      WAAGR4
     I              BDAGR5                      WAAGR5
     I              BDAGR6                      WAAGR6
     I              BDAGR7                      WAAGR7
     I              BDFRY                       WAFRY
     I              BDFRP                       WAFRP
     I              BDNNP                       WANNP
     I              BDFP                        WAFP
     I              BDAGE                       WAAGE
     I              BDDAG                       WADAG
     I              BDARPN                      WAARPN
     I              BDAPPN                      WAAPPN
     I              BDARFJ                      WAARFJ
     I              BDAPFJ                      WAAPFJ
     I              BDAN8                       WAAN8
     I              BDSGBK                      WASGBK
     I              BDPTCO                      WAPTCO
     I              BDX1                        WAX1
     I              BDX2                        WAX2
     I              BDUSER                      WAUSER
     I              BDPID                       WAPID
     I              BDUPMJ                      WAUPMJ
     I              BDJOBN                      WAJOBN
     I              BDUPMT                      WAUPMT
     I              BDFKNB                      WAFKNB
     I              BDH0TX                      WAH0TX
     I              BDH1TX                      WAH1TX
     I              BDKGNB                      WAKGNB
     I              BDIEST                      WAIEST
     I              BDADDT                      WAADDT
     I              BDADTM                      WAADTM
      *
     II0010L1
      * Company Constants  F0010  Retrieval index
      * Renamed input format fields
     I              CCCO                        WBCO
     I              CCNAME                      WBNAME
     I              CCALTC                      WBALTC
     I              CCDFYJ                      WBDFYJ
     I              CCPNC                       WBPNC
     I              CCDOT1                      WBDOT1
     I              CCCRYR                      WBCRYR
     I              CCCRYC                      WBCRYC
     I              CCDOT2                      WBDOT2
     I              CCMCUA                      WBMCUA
     I              CCMCUD                      WBMCUD
     I              CCMCUC                      WBMCUC
     I              CCMCUB                      WBMCUB
     I              CCDPRC                      WBDPRC
     I              CCBKTX                      WBBKTX
     I              CCTXBM                      WBTXBM
     I              CCTXBO                      WBTXBO
     I              CCNWXJ                      WBNWXJ
     I              CCGLIE                      WBGLIE
     I              CCABIN                      WBABIN
     I              CCCALD                      WBCALD
     I              CCDTPN                      WBDTPN
     I              CCPNF                       WBPNF
     I              CCDFF                       WBDFF
     I              CCCRCD                      WBCRCD
     I              CCSMI                       WBSMI
     I              CCSMU                       WBSMU
     I              CCSMS                       WBSMS
     I              CCDNLT                      WBDNLT
     I              CCSTMT                      WBSTMT
     I              CCATCS                      WBATCS
     I              CCALGM                      WBALGM
     I              CCAGEM                      WBAGEM
     I              CCCRDY                      WBCRDY
     I              CCAGR1                      WBAGR1
     I              CCAGR2                      WBAGR2
     I              CCAGR3                      WBAGR3
     I              CCAGR4                      WBAGR4
     I              CCAGR5                      WBAGR5
     I              CCAGR6                      WBAGR6
     I              CCAGR7                      WBAGR7
     I              CCFRY                       WBFRY
     I              CCFRP                       WBFRP
     I              CCNNP                       WBNNP
     I              CCFP                        WBFP
     I              CCAGE                       WBAGE
     I              CCDAG                       WBDAG
     I              CCARPN                      WBARPN
     I              CCAPPN                      WBAPPN
     I              CCARFJ                      WBARFJ
     I              CCAPFJ                      WBAPFJ
     I              CCAN8                       WBAN8
     I              CCSGBK                      WBSGBK
     I              CCPTCO                      WBPTCO
     I              CCX1                        WBX1
     I              CCX2                        WBX2
     I              CCUSER                      WBUSER
     I              CCPID                       WBPID
     I              CCUPMJ                      WBUPMJ
     I              CCJOBN                      WBJOBN
     I              CCUPMT                      WBUPMT
     I              CCFKNB                      WBFKNB
     I              CCH0TX                      WBH0TX
     I              CCH1TX                      WBH1TX
     I              CCAN8C                      WBAN8C
      *
     II0010L0
      * Company Constants  F0010  Update index
      * Renamed input format fields
     I              CCCO                        WCCO
     I              CCNAME                      WCNAME
     I              CCALTC                      WCALTC
     I              CCDFYJ                      WCDFYJ
     I              CCPNC                       WCPNC
     I              CCDOT1                      WCDOT1
     I              CCCRYR                      WCCRYR
     I              CCCRYC                      WCCRYC
     I              CCDOT2                      WCDOT2
     I              CCMCUA                      WCMCUA
     I              CCMCUD                      WCMCUD
     I              CCMCUC                      WCMCUC
     I              CCMCUB                      WCMCUB
     I              CCDPRC                      WCDPRC
     I              CCBKTX                      WCBKTX
     I              CCTXBM                      WCTXBM
     I              CCTXBO                      WCTXBO
     I              CCNWXJ                      WCNWXJ
     I              CCGLIE                      WCGLIE
     I              CCABIN                      WCABIN
     I              CCCALD                      WCCALD
     I              CCDTPN                      WCDTPN
     I              CCPNF                       WCPNF
     I              CCDFF                       WCDFF
     I              CCCRCD                      WCCRCD
     I              CCSMI                       WCSMI
     I              CCSMU                       WCSMU
     I              CCSMS                       WCSMS
     I              CCDNLT                      WCDNLT
     I              CCSTMT                      WCSTMT
     I              CCATCS                      WCATCS
     I              CCALGM                      WCALGM
     I              CCAGEM                      WCAGEM
     I              CCCRDY                      WCCRDY
     I              CCAGR1                      WCAGR1
     I              CCAGR2                      WCAGR2
     I              CCAGR3                      WCAGR3
     I              CCAGR4                      WCAGR4
     I              CCAGR5                      WCAGR5
     I              CCAGR6                      WCAGR6
     I              CCAGR7                      WCAGR7
     I              CCFRY                       WCFRY
     I              CCFRP                       WCFRP
     I              CCNNP                       WCNNP
     I              CCFP                        WCFP
     I              CCAGE                       WCAGE
     I              CCDAG                       WCDAG
     I              CCARPN                      WCARPN
     I              CCAPPN                      WCAPPN
     I              CCARFJ                      WCARFJ
     I              CCAPFJ                      WCAPFJ
     I              CCAN8                       WCAN8
     I              CCSGBK                      WCSGBK
     I              CCPTCO                      WCPTCO
     I              CCX1                        WCX1
     I              CCX2                        WCX2
     I              CCUSER                      WCUSER
     I              CCPID                       WCPID
     I              CCUPMJ                      WCUPMJ
     I              CCJOBN                      WCJOBN
     I              CCUPMT                      WCUPMT
     I              CCFKNB                      WCFKNB
     I              CCH0TX                      WCH0TX
     I              CCH1TX                      WCH1TX
     I              CCAN8C                      WCAN8C
      *
     I@BDCPE2
      * Company Constants  F0010Z Update index
      * Renamed input format fields
     I              BDCO                        WDCO
     I              BDACTS                      WDACTS
     I              BDNAME                      WDNAME
     I              BDALTC                      WDALTC
     I              BDDFYJ                      WDDFYJ
     I              BDPNC                       WDPNC
     I              BDDOT1                      WDDOT1
     I              BDCRYR                      WDCRYR
     I              BDCRYC                      WDCRYC
     I              BDDOT2                      WDDOT2
     I              BDMCUA                      WDMCUA
     I              BDMCUD                      WDMCUD
     I              BDMCUC                      WDMCUC
     I              BDMCUB                      WDMCUB
     I              BDDPRC                      WDDPRC
     I              BDBKTX                      WDBKTX
     I              BDTXBM                      WDTXBM
     I              BDTXBO                      WDTXBO
     I              BDNWXJ                      WDNWXJ
     I              BDGLIE                      WDGLIE
     I              BDABIN                      WDABIN
     I              BDCALD                      WDCALD
     I              BDDTPN                      WDDTPN
     I              BDPNF                       WDPNF
     I              BDDFF                       WDDFF
     I              BDCRCD                      WDCRCD
     I              BDSMI                       WDSMI
     I              BDSMU                       WDSMU
     I              BDSMS                       WDSMS
     I              BDDNLT                      WDDNLT
     I              BDSTMT                      WDSTMT
     I              BDATCS                      WDATCS
     I              BDALGM                      WDALGM
     I              BDAGEM                      WDAGEM
     I              BDCRDY                      WDCRDY
     I              BDAGR1                      WDAGR1
     I              BDAGR2                      WDAGR2
     I              BDAGR3                      WDAGR3
     I              BDAGR4                      WDAGR4
     I              BDAGR5                      WDAGR5
     I              BDAGR6                      WDAGR6
     I              BDAGR7                      WDAGR7
     I              BDFRY                       WDFRY
     I              BDFRP                       WDFRP
     I              BDNNP                       WDNNP
     I              BDFP                        WDFP
     I              BDAGE                       WDAGE
     I              BDDAG                       WDDAG
     I              BDARPN                      WDARPN
     I              BDAPPN                      WDAPPN
     I              BDARFJ                      WDARFJ
     I              BDAPFJ                      WDAPFJ
     I              BDAN8                       WDAN8
     I              BDSGBK                      WDSGBK
     I              BDPTCO                      WDPTCO
     I              BDX1                        WDX1
     I              BDX2                        WDX2
     I              BDUSER                      WDUSER
     I              BDPID                       WDPID
     I              BDUPMJ                      WDUPMJ
     I              BDJOBN                      WDJOBN
     I              BDUPMT                      WDUPMT
     I              BDFKNB                      WDFKNB
     I              BDH0TX                      WDH0TX
     I              BDH1TX                      WDH1TX
     I              BDKGNB                      WDKGNB
     I              BDIEST                      WDIEST
     I              BDADDT                      WDADDT
     I              BDADTM                      WDADTM
      *
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * Exc Prc from F0010    XF
      * SDN 465 JDE to E1 RMC 4/27/2020
      *   Read staged table from E1 for the address book and update E1IDE
      *    table E10010- process ADDS and CHANGES
      * Rtv Prc from F0010    RT - Company Constants  F0010Z  * 
     C                   EXSR      SARVGN
      *----------------------------------------------------------------
      * Exit program
     C     AAEXIT        TAG
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
      /EJECT
     CSR   SARVGN        BEGSR
      *================================================================
      * Rtv Prc from F0010    RT - Company Constants  F0010Z  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KPSSA         KLIST
     C                   KFLD                    WACO                           Company
     C                   KFLD                    WAACTS                         Date Time Stamp
      * Initialize key list
     C                   MOVEL     *LOVAL        WACO                           Company
     C                   MOVEL     XDTSDL        WAACTS                         Date Time Stamp
      * Setup key
      * Establish starting position
     C     KPSSA         SETLL     @0010FC                                      *
     C                   READ      @0010FC                                90    *
      * Data record not found
     C   90              MOVEL     'E1I0155'     W0RTN
      * USER: Process Data record
      * Rtv CrtChg from Stage RT - Company Constants  F0010  * 
     C                   DOW       NOT *IN90
     C                   EXSR      SBRVGN
      * Chg F0010Z to Prcd    CH - Company Constants  F0010Z  * 
     C                   EXSR      SECHRC
     C                   READ      @0010FC                                90    *
     C                   ENDDO
      *================================================================
     CSR   SAEXIT        ENDSR
      /EJECT
     CSR   SBRVGN        BEGSR
      *================================================================
      * Rtv CrtChg from Stage RT - Company Constants  F0010  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSB         KLIST
     C                   KFLD                    WBCO                           Company
      * Setup key
     C                   MOVEL     WACO          WBCO                           Company
      * Establish starting position
     C     KRSSB         CHAIN     I0010L1                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'E1I0088'     W0RTN
      * USER: Processing if Data record not found
      * Crt E10010 from Stage CR - Company Constants  F0010  * 
     C                   EXSR      SCCRRC
     C                   GOTO      SBEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * Chg E10010 from Stage CH - Company Constants  F0010  * 
     C                   IF        NOT *IN90
     C                   EXSR      SDCHRC
     C                   ENDIF
      *================================================================
     CSR   SBEXIT        ENDSR
      /EJECT
     CSR   SCCRRC        BEGSR
      *================================================================
      * Crt E10010 from Stage CR - Company Constants  F0010  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Move all fields to I0010L0
     C                   MOVEL     WACO          WCCO                           Company
     C                   MOVEL     WANAME        WCNAME                         Name
     C                   MOVEL     WAALTC        WCALTC                         Alternate Compa
     C                   Z-ADD     WADFYJ        WCDFYJ                         Date - Fiscal Y
     C                   Z-ADD     WAPNC         WCPNC                          Period Number -
     C                   MOVEL     WADOT1        WCDOT1                         Allow Mult Curr
     C                   MOVEL     WACRYR        WCCRYR                         Currency Conver
     C                   MOVEL     WACRYC        WCCRYC                         Search Type Sec
     C                   MOVEL     WADOT2        WCDOT2                         Computation ID
     C                   MOVEL     WAMCUA        WCMCUA                         Default CC-Asse
     C                   MOVEL     WAMCUD        WCMCUD                         Default CC-Depr
     C                   MOVEL     WAMCUC        WCMCUC                         Default CC-Accu
     C                   MOVEL     WAMCUB        WCMCUB                         Default CC-Reve
     C                   MOVEL     WADPRC        WCDPRC                         Voucher Redstri
     C                   MOVEL     WABKTX        WCBKTX                         Detailed Curren
     C                   Z-ADD     WATXBM        WCTXBM                         Tax Year-Begin
     C                   Z-ADD     WATXBO        WCTXBO                         Tax Year-Begin
     C                   Z-ADD     WANWXJ        WCNWXJ                         Date - New Tax
     C                   MOVEL     WAGLIE        WCGLIE                         Display 10 Clas
     C                   MOVEL     WAABIN        WCABIN                         Post Acct Balan
     C                   MOVEL     WACALD        WCCALD                         Number of Perio
     C                   MOVEL     WADTPN        WCDTPN                         Fiscal Date Pat
     C                   Z-ADD     WAPNF         WCPNF                          Period Nbr-Fina
     C                   Z-ADD     WADFF         WCDFF                          Financial Repor
     C                   MOVEL     WACRCD        WCCRCD                         Currency Code -
     C                   MOVEL     WASMI         WCSMI                          Symbol for Item
     C                   MOVEL     WASMU         WCSMU                          Symbol for Unit
     C                   MOVEL     WASMS         WCSMS                          Symbol for Seri
     C                   MOVEL     WADNLT        WCDNLT                         Delinquency Not
     C                   MOVEL     WASTMT        WCSTMT                         Print Statement
     C                   MOVEL     WAATCS        WCATCS                         Auto Receipt
     C                   MOVEL     WAALGM        WCALGM                         Auto Receipt Al
     C                   MOVEL     WAAGEM        WCAGEM                         Aging Method
     C                   Z-ADD     WACRDY        WCCRDY                         Aging Days - A/
     C                   Z-ADD     WAAGR1        WCAGR1                         Aging Days - A/
     C                   Z-ADD     WAAGR2        WCAGR2                         Aging Days - A/
     C                   Z-ADD     WAAGR3        WCAGR3                         Aging Days - A/
     C                   Z-ADD     WAAGR4        WCAGR4                         Aging Days - A/
     C                   Z-ADD     WAAGR5        WCAGR5                         Aging Days - A/
     C                   Z-ADD     WAAGR6        WCAGR6                         Aging Days - A/
     C                   Z-ADD     WAAGR7        WCAGR7                         Aging Days - A/
     C                   Z-ADD     WAFRY         WCFRY                          52 Period Fin R
     C                   Z-ADD     WAFRP         WCFRP                          52 Period Finan
     C                   Z-ADD     WANNP         WCNNP                          52 Period Nbr o
     C                   Z-ADD     WAFP          WCFP                           Percentage Fact
     C                   MOVEL     WAAGE         WCAGE                          Aging - Date Ba
     C                   Z-ADD     WADAG         WCDAG                          Date - Age As O
     C                   Z-ADD     WAARPN        WCARPN                         Period Number -
     C                   Z-ADD     WAAPPN        WCAPPN                         Period Number -
     C                   Z-ADD     WAARFJ        WCARFJ                         Date - A/R Fisc
     C                   Z-ADD     WAAPFJ        WCAPFJ                         Date - A/P Fisc
     C                   Z-ADD     WAAN8         WCAN8                          Address Number
     C                   MOVEL     WASGBK        WCSGBK                         Signature Block
     C                   MOVEL     WAPTCO        WCPTCO                         Print Company N
     C                   MOVEL     WAX1          WCX1                           Future Use - Fl
     C                   MOVEL     WAX2          WCX2                           Future Use - Fl
     C                   MOVEL     WAUSER        WCUSER                         User ID
     C                   MOVEL     WAPID         WCPID                          Program ID
     C                   Z-ADD     WAUPMJ        WCUPMJ                         Date - Updated
     C                   MOVEL     WAJOBN        WCJOBN                         Work Station ID
     C                   Z-ADD     WAUPMT        WCUPMT                         Time - Last Upd
     C                   Z-ADD     WAFKNB        WCFKNB                         Target System I
     C                   MOVEL     WAH0TX        WCH0TX                         Target Company
     C                   MOVEL     WAH1TX        WCH1TX                         Source Alias Sy
     C                   Z-ADD     WAKGNB        WCAN8C                         Target Address#
      *
     C     KLCRSC        KLIST
     C                   KFLD                    WCCO                           Company
      * Check for duplicate primary key
     C     KLCRSC        SETLL     I0010L0                                90    *
     C                   IF        *IN90
     C                   MOVEL     'E1I0089'     W0RTN
      * Send message 'Company Constants  F00 EX'
     C                   MOVEL     'E1I0089'     ZAMSID
     C                   EXSR      ZASNMS
     C                   GOTO      SCEXIT
     C                   ENDIF
      *
     C                   WRITE     I0010L0                              91      *
      *
      * Write error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
     C                   ENDIF
      *================================================================
     CSR   SCEXIT        ENDSR
      /EJECT
     CSR   SDCHRC        BEGSR
      *================================================================
      * Chg E10010 from Stage CH - Company Constants  F0010  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YARDC = ' '
      *
      * Move key fields to I0010L0
     C                   MOVEL(P)  WBCO          WCCO                           Company
      *
     C     KLCHSD        KLIST
     C                   KFLD                    WCCO                           Company
     C     KLCHSD        CHAIN     I0010L0                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'E10010L0'    MDACP
     C                   MOVEL     'I0010L0'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL001.
     C                   MOVEL     'LBL001'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      SDEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      SDEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QE1001        YARDCS
      * Move non-key fields to I0010L0
     C                   MOVEL(P)  WBNAME        WCNAME                         Name
     C                   MOVEL(P)  WAALTC        WCALTC                         Alternate Compa
     C                   Z-ADD     WADFYJ        WCDFYJ                         Date - Fiscal Y
     C                   Z-ADD     WAPNC         WCPNC                          Period Number -
     C                   MOVEL(P)  WADOT1        WCDOT1                         Allow Mult Curr
     C                   MOVEL(P)  WACRYR        WCCRYR                         Currency Conver
     C                   MOVEL(P)  WACRYC        WCCRYC                         Search Type Sec
     C                   MOVEL(P)  WADOT2        WCDOT2                         Computation ID
     C                   MOVEL(P)  WAMCUA        WCMCUA                         Default CC-Asse
     C                   MOVEL(P)  WAMCUD        WCMCUD                         Default CC-Depr
     C                   MOVEL(P)  WAMCUC        WCMCUC                         Default CC-Accu
     C                   MOVEL(P)  WAMCUB        WCMCUB                         Default CC-Reve
     C                   MOVEL(P)  WADPRC        WCDPRC                         Voucher Redstri
     C                   MOVEL(P)  WABKTX        WCBKTX                         Detailed Curren
     C                   Z-ADD     WATXBM        WCTXBM                         Tax Year-Begin
     C                   Z-ADD     WATXBO        WCTXBO                         Tax Year-Begin
     C                   Z-ADD     WANWXJ        WCNWXJ                         Date - New Tax
     C                   MOVEL(P)  WAGLIE        WCGLIE                         Display 10 Clas
     C                   MOVEL(P)  WAABIN        WCABIN                         Post Acct Balan
     C                   MOVEL(P)  WACALD        WCCALD                         Number of Perio
     C                   MOVEL(P)  WADTPN        WCDTPN                         Fiscal Date Pat
     C                   Z-ADD     WAPNF         WCPNF                          Period Nbr-Fina
     C                   Z-ADD     WADFF         WCDFF                          Financial Repor
     C                   MOVEL(P)  WACRCD        WCCRCD                         Currency Code -
     C                   MOVEL(P)  WASMI         WCSMI                          Symbol for Item
     C                   MOVEL(P)  WASMU         WCSMU                          Symbol for Unit
     C                   MOVEL(P)  WASMS         WCSMS                          Symbol for Seri
     C                   MOVEL(P)  WADNLT        WCDNLT                         Delinquency Not
     C                   MOVEL(P)  WASTMT        WCSTMT                         Print Statement
     C                   MOVEL(P)  WAATCS        WCATCS                         Auto Receipt
     C                   MOVEL(P)  WAALGM        WCALGM                         Auto Receipt Al
     C                   MOVEL(P)  WAAGEM        WCAGEM                         Aging Method
     C                   Z-ADD     WACRDY        WCCRDY                         Aging Days - A/
     C                   Z-ADD     WAAGR1        WCAGR1                         Aging Days - A/
     C                   Z-ADD     WAAGR2        WCAGR2                         Aging Days - A/
     C                   Z-ADD     WAAGR3        WCAGR3                         Aging Days - A/
     C                   Z-ADD     WAAGR4        WCAGR4                         Aging Days - A/
     C                   Z-ADD     WAAGR5        WCAGR5                         Aging Days - A/
     C                   Z-ADD     WAAGR6        WCAGR6                         Aging Days - A/
     C                   Z-ADD     WAAGR7        WCAGR7                         Aging Days - A/
     C                   Z-ADD     WAFRY         WCFRY                          52 Period Fin R
     C                   Z-ADD     WAFRP         WCFRP                          52 Period Finan
     C                   Z-ADD     WANNP         WCNNP                          52 Period Nbr o
     C                   Z-ADD     WAFP          WCFP                           Percentage Fact
     C                   MOVEL(P)  WAAGE         WCAGE                          Aging - Date Ba
     C                   Z-ADD     WADAG         WCDAG                          Date - Age As O
     C                   Z-ADD     WAARPN        WCARPN                         Period Number -
     C                   Z-ADD     WAAPPN        WCAPPN                         Period Number -
     C                   Z-ADD     WAARFJ        WCARFJ                         Date - A/R Fisc
     C                   Z-ADD     WAAPFJ        WCAPFJ                         Date - A/P Fisc
     C                   Z-ADD     WAAN8         WCAN8                          Address Number
     C                   MOVEL(P)  WASGBK        WCSGBK                         Signature Block
     C                   MOVEL(P)  WAPTCO        WCPTCO                         Print Company N
     C                   MOVEL(P)  WAX1          WCX1                           Future Use - Fl
     C                   MOVEL(P)  WAX2          WCX2                           Future Use - Fl
     C                   MOVEL(P)  WAUSER        WCUSER                         User ID
     C                   MOVEL(P)  WAPID         WCPID                          Program ID
     C                   Z-ADD     WAUPMJ        WCUPMJ                         Date - Updated
     C                   MOVEL(P)  WAJOBN        WCJOBN                         Work Station ID
     C                   Z-ADD     WAUPMT        WCUPMT                         Time - Last Upd
     C                   Z-ADD     WAFKNB        WCFKNB                         Target System I
     C                   MOVEL(P)  WAH0TX        WCH0TX                         Target Company
     C                   MOVEL(P)  WAH1TX        WCH1TX                         Source Alias Sy
     C                   Z-ADD     WAKGNB        WCAN8C                         Target Address#
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QE1001 <> YARDCS AND
     C                             YARDC <> 'N'
     C                   MOVE      'Y'           YARDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YARDC = 'Y'
     C                   UPDATE    I0010L0                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    E10010L0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   SDEXIT        ENDSR
      /EJECT
     CSR   SECHRC        BEGSR
      *================================================================
      * Chg F0010Z to Prcd    CH - Company Constants  F0010Z  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YBRDC = ' '
      *
      * Move key fields to @BDCPE2
     C                   MOVEL(P)  WACO          WDCO                           Company
     C                   MOVEL(P)  WAACTS        WDACTS                         Date Time Stamp
      *
     C     KLCHSE        KLIST
     C                   KFLD                    WDCO                           Company
     C                   KFLD                    WDACTS                         Date Time Stamp
     C     KLCHSE        CHAIN     @BDCPE2                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'EZ0010L0'    MDACP
     C                   MOVEL     '@BDCPE2'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL002.
     C                   MOVEL     'LBL002'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      SEEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      SEEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QEZ001        YBRDCS
      * Move non-key fields to @BDCPE2
     C                   MOVEL(P)  WANAME        WDNAME                         Name
     C                   MOVEL(P)  WAALTC        WDALTC                         Alternate Compa
     C                   Z-ADD     WADFYJ        WDDFYJ                         Date - Fiscal Y
     C                   Z-ADD     WAPNC         WDPNC                          Period Number -
     C                   MOVEL(P)  WADOT1        WDDOT1                         Allow Mult Curr
     C                   MOVEL(P)  WACRYR        WDCRYR                         Currency Conver
     C                   MOVEL(P)  WACRYC        WDCRYC                         Search Type Sec
     C                   MOVEL(P)  WADOT2        WDDOT2                         Computation ID
     C                   MOVEL(P)  WAMCUA        WDMCUA                         Default CC-Asse
     C                   MOVEL(P)  WAMCUD        WDMCUD                         Default CC-Depr
     C                   MOVEL(P)  WAMCUC        WDMCUC                         Default CC-Accu
     C                   MOVEL(P)  WAMCUB        WDMCUB                         Default CC-Reve
     C                   MOVEL(P)  WADPRC        WDDPRC                         Voucher Redstri
     C                   MOVEL(P)  WABKTX        WDBKTX                         Detailed Curren
     C                   Z-ADD     WATXBM        WDTXBM                         Tax Year-Begin
     C                   Z-ADD     WATXBO        WDTXBO                         Tax Year-Begin
     C                   Z-ADD     WANWXJ        WDNWXJ                         Date - New Tax
     C                   MOVEL(P)  WAGLIE        WDGLIE                         Display 10 Clas
     C                   MOVEL(P)  WAABIN        WDABIN                         Post Acct Balan
     C                   MOVEL(P)  WACALD        WDCALD                         Number of Perio
     C                   MOVEL(P)  WADTPN        WDDTPN                         Fiscal Date Pat
     C                   Z-ADD     WAPNF         WDPNF                          Period Nbr-Fina
     C                   Z-ADD     WADFF         WDDFF                          Financial Repor
     C                   MOVEL(P)  WACRCD        WDCRCD                         Currency Code -
     C                   MOVEL(P)  WASMI         WDSMI                          Symbol for Item
     C                   MOVEL(P)  WASMU         WDSMU                          Symbol for Unit
     C                   MOVEL(P)  WASMS         WDSMS                          Symbol for Seri
     C                   MOVEL(P)  WADNLT        WDDNLT                         Delinquency Not
     C                   MOVEL(P)  WASTMT        WDSTMT                         Print Statement
     C                   MOVEL(P)  WAATCS        WDATCS                         Auto Receipt
     C                   MOVEL(P)  WAALGM        WDALGM                         Auto Receipt Al
     C                   MOVEL(P)  WAAGEM        WDAGEM                         Aging Method
     C                   Z-ADD     WACRDY        WDCRDY                         Aging Days - A/
     C                   Z-ADD     WAAGR1        WDAGR1                         Aging Days - A/
     C                   Z-ADD     WAAGR2        WDAGR2                         Aging Days - A/
     C                   Z-ADD     WAAGR3        WDAGR3                         Aging Days - A/
     C                   Z-ADD     WAAGR4        WDAGR4                         Aging Days - A/
     C                   Z-ADD     WAAGR5        WDAGR5                         Aging Days - A/
     C                   Z-ADD     WAAGR6        WDAGR6                         Aging Days - A/
     C                   Z-ADD     WAAGR7        WDAGR7                         Aging Days - A/
     C                   Z-ADD     WAFRY         WDFRY                          52 Period Fin R
     C                   Z-ADD     WAFRP         WDFRP                          52 Period Finan
     C                   Z-ADD     WANNP         WDNNP                          52 Period Nbr o
     C                   Z-ADD     WAFP          WDFP                           Percentage Fact
     C                   MOVEL(P)  WAAGE         WDAGE                          Aging - Date Ba
     C                   Z-ADD     WADAG         WDDAG                          Date - Age As O
     C                   Z-ADD     WAARPN        WDARPN                         Period Number -
     C                   Z-ADD     WAAPPN        WDAPPN                         Period Number -
     C                   Z-ADD     WAARFJ        WDARFJ                         Date - A/R Fisc
     C                   Z-ADD     WAAPFJ        WDAPFJ                         Date - A/P Fisc
     C                   Z-ADD     WAAN8         WDAN8                          Address Number
     C                   MOVEL(P)  WASGBK        WDSGBK                         Signature Block
     C                   MOVEL(P)  WAPTCO        WDPTCO                         Print Company N
     C                   MOVEL(P)  WAX1          WDX1                           Future Use - Fl
     C                   MOVEL(P)  WAX2          WDX2                           Future Use - Fl
     C                   MOVEL(P)  WAUSER        WDUSER                         User ID
     C                   MOVEL(P)  WAPID         WDPID                          Program ID
     C                   Z-ADD     WAUPMJ        WDUPMJ                         Date - Updated
     C                   MOVEL(P)  WAJOBN        WDJOBN                         Work Station ID
     C                   Z-ADD     WAUPMT        WDUPMT                         Time - Last Upd
     C                   Z-ADD     WAFKNB        WDFKNB                         Target System I
     C                   MOVEL(P)  WAH0TX        WDH0TX                         Target Company
     C                   MOVEL(P)  WAH1TX        WDH1TX                         Source Alias Sy
     C                   Z-ADD     WAKGNB        WDKGNB                         Address Number
     C                   MOVEL(P)  '1'           WDIEST                         OMS ERP Process
     C                   Z-ADD     ##JDT         WDADDT                         OMS ERP Process
     C                   Z-ADD     ##JTM         WDADTM                         OMS ERP Process
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QEZ001 <> YBRDCS AND
     C                             YBRDC <> 'N'
     C                   MOVE      'Y'           YBRDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YBRDC = 'Y'
     C                   UPDATE    @BDCPE2                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    EZ0010L0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   SEEXIT        ENDSR
      /EJECT
     CSR   ZASNMS        BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C                   IF        ZAPGMQ = ' '
     C                   MOVEL     ##PGM         ZAPGMQ
     C                   END
      * If no message file specified, use default
     C                   IF        ZAMSGF = ' '
     C                   MOVEL     ZADFMF        ZAMSGF
     C                   END
     C                   CALL      'Y2SNMGC'
     C                   PARM                    ZAPGMQ                         Program queue
     C                   PARM                    ZAPGRL                         Rel queue
     C                   PARM                    ZAMSID                         Message ID
     C                   PARM                    ZAMSGF                         Message file
     C                   PARM                    ZAMSDA                         Message data
     C                   PARM                    ZAMSTP                         Message type
     C                   PARM      'Y'           YILE
      * Clear all fields for default mechanism next time
     C                   EVAL      ZAPGMQ = ' '
     C                   EVAL      ZAPGRL = ' '
     C                   EVAL      ZAMSID = ' '
     C                   EVAL      ZAMSGF = ' '
     C                   EVAL      ZAMSDA = ' '
     C                   EVAL      ZAMSTP = ' '
      *================================================================
     CSR   ZAEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
      * Initialize renamed input format fields
     C                   MOVE(P)   '0'           XDTSDL
     C                   MOVEL     @CN(001)      XDTSDL
     C                   MOVEL     XDTSDL        WAACTS                         Date Time Stamp
     C                   Z-ADD     *ZERO         WADFYJ                         Date - Fiscal Y
     C                   Z-ADD     *ZERO         WAPNC                          Period Number -
     C                   Z-ADD     *ZERO         WATXBM                         Tax Year-Begin
     C                   Z-ADD     *ZERO         WATXBO                         Tax Year-Begin
     C                   Z-ADD     *ZERO         WANWXJ                         Date - New Tax
     C                   Z-ADD     *ZERO         WAPNF                          Period Nbr-Fina
     C                   Z-ADD     *ZERO         WADFF                          Financial Repor
     C                   Z-ADD     *ZERO         WACRDY                         Aging Days - A/
     C                   Z-ADD     *ZERO         WAAGR1                         Aging Days - A/
     C                   Z-ADD     *ZERO         WAAGR2                         Aging Days - A/
     C                   Z-ADD     *ZERO         WAAGR3                         Aging Days - A/
     C                   Z-ADD     *ZERO         WAAGR4                         Aging Days - A/
     C                   Z-ADD     *ZERO         WAAGR5                         Aging Days - A/
     C                   Z-ADD     *ZERO         WAAGR6                         Aging Days - A/
     C                   Z-ADD     *ZERO         WAAGR7                         Aging Days - A/
     C                   Z-ADD     *ZERO         WAFRY                          52 Period Fin R
     C                   Z-ADD     *ZERO         WAFRP                          52 Period Finan
     C                   Z-ADD     *ZERO         WANNP                          52 Period Nbr o
     C                   Z-ADD     *ZERO         WAFP                           Percentage Fact
     C                   Z-ADD     *ZERO         WADAG                          Date - Age As O
     C                   Z-ADD     *ZERO         WAARPN                         Period Number -
     C                   Z-ADD     *ZERO         WAAPPN                         Period Number -
     C                   Z-ADD     *ZERO         WAARFJ                         Date - A/R Fisc
     C                   Z-ADD     *ZERO         WAAPFJ                         Date - A/P Fisc
     C                   Z-ADD     *ZERO         WAAN8                          Address Number
     C                   Z-ADD     *ZERO         WAUPMJ                         Date - Updated
     C                   Z-ADD     *ZERO         WAUPMT                         Time - Last Upd
     C                   Z-ADD     *ZERO         WAFKNB                         Target System I
     C                   Z-ADD     *ZERO         WAKGNB                         Address Number
     C                   Z-ADD     *ZERO         WAADDT                         OMS ERP Process
     C                   Z-ADD     *ZERO         WAADTM                         OMS ERP Process
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WBDFYJ                         Date - Fiscal Y
     C                   Z-ADD     *ZERO         WBPNC                          Period Number -
     C                   Z-ADD     *ZERO         WBTXBM                         Tax Year-Begin
     C                   Z-ADD     *ZERO         WBTXBO                         Tax Year-Begin
     C                   Z-ADD     *ZERO         WBNWXJ                         Date - New Tax
     C                   Z-ADD     *ZERO         WBPNF                          Period Nbr-Fina
     C                   Z-ADD     *ZERO         WBDFF                          Financial Repor
     C                   Z-ADD     *ZERO         WBCRDY                         Aging Days - A/
     C                   Z-ADD     *ZERO         WBAGR1                         Aging Days - A/
     C                   Z-ADD     *ZERO         WBAGR2                         Aging Days - A/
     C                   Z-ADD     *ZERO         WBAGR3                         Aging Days - A/
     C                   Z-ADD     *ZERO         WBAGR4                         Aging Days - A/
     C                   Z-ADD     *ZERO         WBAGR5                         Aging Days - A/
     C                   Z-ADD     *ZERO         WBAGR6                         Aging Days - A/
     C                   Z-ADD     *ZERO         WBAGR7                         Aging Days - A/
     C                   Z-ADD     *ZERO         WBFRY                          52 Period Fin R
     C                   Z-ADD     *ZERO         WBFRP                          52 Period Finan
     C                   Z-ADD     *ZERO         WBNNP                          52 Period Nbr o
     C                   Z-ADD     *ZERO         WBFP                           Percentage Fact
     C                   Z-ADD     *ZERO         WBDAG                          Date - Age As O
     C                   Z-ADD     *ZERO         WBARPN                         Period Number -
     C                   Z-ADD     *ZERO         WBAPPN                         Period Number -
     C                   Z-ADD     *ZERO         WBARFJ                         Date - A/R Fisc
     C                   Z-ADD     *ZERO         WBAPFJ                         Date - A/P Fisc
     C                   Z-ADD     *ZERO         WBAN8                          Address Number
     C                   Z-ADD     *ZERO         WBUPMJ                         Date - Updated
     C                   Z-ADD     *ZERO         WBUPMT                         Time - Last Upd
     C                   Z-ADD     *ZERO         WBFKNB                         Target System I
     C                   Z-ADD     *ZERO         WBAN8C                         Target Address#
      * Obtain default message file
     C     *DTAARA       DEFINE    E1MGFLA       ZADFMF
     C                   IN        ZADFMF
      * Dummy move for compiler
     C                   MOVE      '0'           @CN#(1)
     C                   MOVEL     'N'           W0PMT
      *================================================================
     CSR   ZZEXIT        ENDSR
** @CN
00001 0001-01-01-00.00.00.00000
