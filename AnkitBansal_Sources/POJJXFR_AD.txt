// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for POJJXFR
// ?Date: 14.08.2025 Time: 03:37:36
// ?------------------------------------------------------------------------------------------------

//?Execute user function

EXECUTE FUNCTION(CNV HPS PIC Date      RT) TYPE(RTVOBJ) FILE(CAAFREP)           AC1618092;
PARAMETER(360);
PARAMETER(0990101);
{
 //?USER: Initialize routine

 // WRK.Previous Date  USR = PAR.Post to G/L Date + CON.-1 *DAYS
 WRK.Previous_Date_USR = DATEINCR(PAR.Post_to_G_L_Date '-1' 'DY' 1111111 'NONE' 'N' 1);

 EXECUTE FUNCTION(RTV Calendar HPS       RT) TYPE(RTVOBJ) FILE(CAAFREP)          AC1617628;
 PARAMETER(PAR.Company_Number);
 PARAMETER(WRK.Previous_Date_USR);
 PARAMETER(WRK.HPS_Calendar_Year);
 PARAMETER(WRK.HPS_Calendar_Week);
 {
  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

  QUIT;

 }

 CASE;

 // IF WRK.HPS Calendar Year is equal to zero
 IF WRK.HPS_Calendar_Year = *ZERO;

 // WRK.USR Year = PAR.Post to G/L Date *YEAR
 WRK.USR_Year = DATEDTLS(PAR.Post_to_G_L_Date 'YR' 1111111 'NONE' 'N' 1);

 // WRK.HPS Calendar Year = WRK.USR Year - CON.1
 WRK.HPS_Calendar_Year = WRK.USR_Year - 1;

 // WRK.HPS Calendar Week = CON.52
 WRK.HPS_Calendar_Week = 52;

 ENDIF;

 //?USER: Process Data record

 CASE;

 // IF DB1.Post to G/L Date is In the year 2000
 IF DB1.Post_to_G_L_Date >= 1000101;

 QUIT;

 ENDIF;

 //?Calculate HPS PIC Date:
 //?1. Find the number of days between the incoming date and 5/31/2000.
 // WRK.Days = CON.1000531 - DB1.Post to G/L Date *DAYS
 WRK.Days = DURATION(1000531 DB1.Post_to_G_L_Date 'DY' 1111111 'NONE' 'N' 1);

 //?2.  Subtract the difference from the known 100-year value of 5/31/2000.
 //?   The result is the 100-year value for the Calendar Date.
 // WRK.Days = CON.36677 - WRK.Days
 WRK.Days = 36677 - WRK.Days;

 //?3. Subtract a hard-coded value from the 100-year value.
 //?(Per Leanne, we dont understand this calc. Its just what the user gave us)
 // WRK.HPS PIC Date = WRK.Days - CON.26203
 WRK.HPS_PIC_Date = WRK.Days - 26203;

 //?**************
 //?Set up day of week
 DO;

 //?the days of week returned go from Monday=1 thru Sunday=7
 // WRK.USR Day of Week Number = DB1.Post to G/L Date *DAY OF WEEK
 WRK.USR_Day_of_Week_Number = DATEDTLS(DB1.Post_to_G_L_Date 'DW' 1111111 'NONE' 'N' 1);

 CASE;

 // IF WRK.USR Day of Week Number is Saturday
 IF WRK.USR_Day_of_Week_Number = 7;

 // WRK.USR Day of Week Number = CON.1
 WRK.USR_Day_of_Week_Number = 1;

 // IF *OTHERWISE
 IF *OTHERWISE;

 // WRK.USR Day of Week Number = WRK.USR Day of Week Number + CON.1
 WRK.USR_Day_of_Week_Number = WRK.USR_Day_of_Week_Number + 1;

 ENDIF;

 // WRK.CD7 Ext Numeric Key = CVTVAR(WRK.USR Day of Week Number)
 WRK.CD7_Ext_Numeric_Key = CVTVAR(WRK.USR_Day_of_Week_Number);

 // WRK.Day of Week = SUBSTRING(WRK.CD7 Ext Numeric Key,CON.7,CON.1)
 WRK.Day_of_Week = SUBSTRING(WRK.CD7_Ext_Numeric_Key:7:1);

 ENDDO;

 //?Set-up HPS Calendar Week, Year
 CASE;

 // IF WRK.Day of Week is Saturday
 IF WRK.Day_of_Week = '7';

 //?Set-up HPS Calendar Week, Year
 // IF WRK.Day of Week is Sunday
 IF WRK.Day_of_Week = '1';

 //?** RMC 1/11/2001  Calc HPS Calendar Week and year
 // WRK.HPS Calendar Week = WRK.HPS Calendar Week + CON.1
 WRK.HPS_Calendar_Week = WRK.HPS_Calendar_Week + 1;

 CASE;

 // IF WRK.HPS Calendar Week is GT 52
 IF WRK.HPS_Calendar_Week > 52;

 // WRK.HPS Calendar Week = CON.1
 WRK.HPS_Calendar_Week = 1;

 // WRK.HPS Calendar Year = WRK.HPS Calendar Year + CON.1
 WRK.HPS_Calendar_Year = WRK.HPS_Calendar_Year + 1;

 ENDIF;

 //?Set-up HPS Calendar Week, Year
 // IF *OTHERWISE
 IF *OTHERWISE;

 ENDIF;

 EXECUTE FUNCTION(CHG Calendar           CH) TYPE(CHGOBJ) FILE(CAAFREP)          AC1102025;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Post_to_G_L_Date);
 PARAMETER(DB1.Julian_Date);
 PARAMETER(DB1.Accounting_Year_Code);
 PARAMETER(DB1.Accounting_Period_Code);
 PARAMETER(DB1.OM_Week);
 PARAMETER(DB1.Day_of_Week);
 PARAMETER(DB1.Week_Number);
 PARAMETER(DB1.Public_Holiday_Status);
 PARAMETER(DB1.Billing_Cycle);
 PARAMETER(DB1.Payroll_Quarter);
 PARAMETER(DB1.Kill_Day_Status);
 PARAMETER(DB1.Production_Day_Status);
 PARAMETER(DB1.Prodcution_Sch_Pln_Sts);
 PARAMETER(WRK.HPS_PIC_Date);
 PARAMETER(WRK.HPS_Calendar_Year);
 PARAMETER(WRK.HPS_Calendar_Week);
 PARAMETER(DB1.Number_of_Prod_Shifts);
 PARAMETER(DB1.Calendar_Unused_Sts_2);
 PARAMETER(DB1.Calendar_Unused_Date);
 PARAMETER(DB1.Calendar_Unused_Date_2);
 PARAMETER(DB1.EDI_Status_1);
 PARAMETER(DB1.EDI_Status_2);
 PARAMETER(DB1.EDI_Status_3);
 PARAMETER(DB1.Job_Time);
 PARAMETER(DB1.User_Id);
 PARAMETER(DB1.Job_Name);
 PARAMETER(DB1.Job_Date);
}


EXECUTE FUNCTION(CNV HPS PIC Date      RT) TYPE(RTVOBJ) FILE(CAAFREP)           AC1618092;
PARAMETER(350);
PARAMETER(0990101);
{
 //?USER: Initialize routine

 // WRK.Previous Date  USR = PAR.Post to G/L Date + CON.-1 *DAYS
 WRK.Previous_Date_USR = DATEINCR(PAR.Post_to_G_L_Date '-1' 'DY' 1111111 'NONE' 'N' 1);

 EXECUTE FUNCTION(RTV Calendar HPS       RT) TYPE(RTVOBJ) FILE(CAAFREP)          AC1617628;
 PARAMETER(PAR.Company_Number);
 PARAMETER(WRK.Previous_Date_USR);
 PARAMETER(WRK.HPS_Calendar_Year);
 PARAMETER(WRK.HPS_Calendar_Week);
 {
  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

  QUIT;

 }

 CASE;

 // IF WRK.HPS Calendar Year is equal to zero
 IF WRK.HPS_Calendar_Year = *ZERO;

 // WRK.USR Year = PAR.Post to G/L Date *YEAR
 WRK.USR_Year = DATEDTLS(PAR.Post_to_G_L_Date 'YR' 1111111 'NONE' 'N' 1);

 // WRK.HPS Calendar Year = WRK.USR Year - CON.1
 WRK.HPS_Calendar_Year = WRK.USR_Year - 1;

 // WRK.HPS Calendar Week = CON.52
 WRK.HPS_Calendar_Week = 52;

 ENDIF;

 //?USER: Process Data record

 CASE;

 // IF DB1.Post to G/L Date is In the year 2000
 IF DB1.Post_to_G_L_Date >= 1000101;

 QUIT;

 ENDIF;

 //?Calculate HPS PIC Date:
 //?1. Find the number of days between the incoming date and 5/31/2000.
 // WRK.Days = CON.1000531 - DB1.Post to G/L Date *DAYS
 WRK.Days = DURATION(1000531 DB1.Post_to_G_L_Date 'DY' 1111111 'NONE' 'N' 1);

 //?2.  Subtract the difference from the known 100-year value of 5/31/2000.
 //?   The result is the 100-year value for the Calendar Date.
 // WRK.Days = CON.36677 - WRK.Days
 WRK.Days = 36677 - WRK.Days;

 //?3. Subtract a hard-coded value from the 100-year value.
 //?(Per Leanne, we dont understand this calc. Its just what the user gave us)
 // WRK.HPS PIC Date = WRK.Days - CON.26203
 WRK.HPS_PIC_Date = WRK.Days - 26203;

 //?**************
 //?Set up day of week
 DO;

 //?the days of week returned go from Monday=1 thru Sunday=7
 // WRK.USR Day of Week Number = DB1.Post to G/L Date *DAY OF WEEK
 WRK.USR_Day_of_Week_Number = DATEDTLS(DB1.Post_to_G_L_Date 'DW' 1111111 'NONE' 'N' 1);

 CASE;

 // IF WRK.USR Day of Week Number is Saturday
 IF WRK.USR_Day_of_Week_Number = 7;

 // WRK.USR Day of Week Number = CON.1
 WRK.USR_Day_of_Week_Number = 1;

 // IF *OTHERWISE
 IF *OTHERWISE;

 // WRK.USR Day of Week Number = WRK.USR Day of Week Number + CON.1
 WRK.USR_Day_of_Week_Number = WRK.USR_Day_of_Week_Number + 1;

 ENDIF;

 // WRK.CD7 Ext Numeric Key = CVTVAR(WRK.USR Day of Week Number)
 WRK.CD7_Ext_Numeric_Key = CVTVAR(WRK.USR_Day_of_Week_Number);

 // WRK.Day of Week = SUBSTRING(WRK.CD7 Ext Numeric Key,CON.7,CON.1)
 WRK.Day_of_Week = SUBSTRING(WRK.CD7_Ext_Numeric_Key:7:1);

 ENDDO;

 //?Set-up HPS Calendar Week, Year
 CASE;

 // IF WRK.Day of Week is Saturday
 IF WRK.Day_of_Week = '7';

 //?Set-up HPS Calendar Week, Year
 // IF WRK.Day of Week is Sunday
 IF WRK.Day_of_Week = '1';

 //?** RMC 1/11/2001  Calc HPS Calendar Week and year
 // WRK.HPS Calendar Week = WRK.HPS Calendar Week + CON.1
 WRK.HPS_Calendar_Week = WRK.HPS_Calendar_Week + 1;

 CASE;

 // IF WRK.HPS Calendar Week is GT 52
 IF WRK.HPS_Calendar_Week > 52;

 // WRK.HPS Calendar Week = CON.1
 WRK.HPS_Calendar_Week = 1;

 // WRK.HPS Calendar Year = WRK.HPS Calendar Year + CON.1
 WRK.HPS_Calendar_Year = WRK.HPS_Calendar_Year + 1;

 ENDIF;

 //?Set-up HPS Calendar Week, Year
 // IF *OTHERWISE
 IF *OTHERWISE;

 ENDIF;

 EXECUTE FUNCTION(CHG Calendar           CH) TYPE(CHGOBJ) FILE(CAAFREP)          AC1102025;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Post_to_G_L_Date);
 PARAMETER(DB1.Julian_Date);
 PARAMETER(DB1.Accounting_Year_Code);
 PARAMETER(DB1.Accounting_Period_Code);
 PARAMETER(DB1.OM_Week);
 PARAMETER(DB1.Day_of_Week);
 PARAMETER(DB1.Week_Number);
 PARAMETER(DB1.Public_Holiday_Status);
 PARAMETER(DB1.Billing_Cycle);
 PARAMETER(DB1.Payroll_Quarter);
 PARAMETER(DB1.Kill_Day_Status);
 PARAMETER(DB1.Production_Day_Status);
 PARAMETER(DB1.Prodcution_Sch_Pln_Sts);
 PARAMETER(WRK.HPS_PIC_Date);
 PARAMETER(WRK.HPS_Calendar_Year);
 PARAMETER(WRK.HPS_Calendar_Week);
 PARAMETER(DB1.Number_of_Prod_Shifts);
 PARAMETER(DB1.Calendar_Unused_Sts_2);
 PARAMETER(DB1.Calendar_Unused_Date);
 PARAMETER(DB1.Calendar_Unused_Date_2);
 PARAMETER(DB1.EDI_Status_1);
 PARAMETER(DB1.EDI_Status_2);
 PARAMETER(DB1.EDI_Status_3);
 PARAMETER(DB1.Job_Time);
 PARAMETER(DB1.User_Id);
 PARAMETER(DB1.Job_Name);
 PARAMETER(DB1.Job_Date);
}


EXECUTE FUNCTION(CNV HPS PIC Date      RT) TYPE(RTVOBJ) FILE(CAAFREP)           AC1618092;
PARAMETER(999);
PARAMETER(0990101);
{
 //?USER: Initialize routine

 // WRK.Previous Date  USR = PAR.Post to G/L Date + CON.-1 *DAYS
 WRK.Previous_Date_USR = DATEINCR(PAR.Post_to_G_L_Date '-1' 'DY' 1111111 'NONE' 'N' 1);

 EXECUTE FUNCTION(RTV Calendar HPS       RT) TYPE(RTVOBJ) FILE(CAAFREP)          AC1617628;
 PARAMETER(PAR.Company_Number);
 PARAMETER(WRK.Previous_Date_USR);
 PARAMETER(WRK.HPS_Calendar_Year);
 PARAMETER(WRK.HPS_Calendar_Week);
 {
  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

  QUIT;

 }

 CASE;

 // IF WRK.HPS Calendar Year is equal to zero
 IF WRK.HPS_Calendar_Year = *ZERO;

 // WRK.USR Year = PAR.Post to G/L Date *YEAR
 WRK.USR_Year = DATEDTLS(PAR.Post_to_G_L_Date 'YR' 1111111 'NONE' 'N' 1);

 // WRK.HPS Calendar Year = WRK.USR Year - CON.1
 WRK.HPS_Calendar_Year = WRK.USR_Year - 1;

 // WRK.HPS Calendar Week = CON.52
 WRK.HPS_Calendar_Week = 52;

 ENDIF;

 //?USER: Process Data record

 CASE;

 // IF DB1.Post to G/L Date is In the year 2000
 IF DB1.Post_to_G_L_Date >= 1000101;

 QUIT;

 ENDIF;

 //?Calculate HPS PIC Date:
 //?1. Find the number of days between the incoming date and 5/31/2000.
 // WRK.Days = CON.1000531 - DB1.Post to G/L Date *DAYS
 WRK.Days = DURATION(1000531 DB1.Post_to_G_L_Date 'DY' 1111111 'NONE' 'N' 1);

 //?2.  Subtract the difference from the known 100-year value of 5/31/2000.
 //?   The result is the 100-year value for the Calendar Date.
 // WRK.Days = CON.36677 - WRK.Days
 WRK.Days = 36677 - WRK.Days;

 //?3. Subtract a hard-coded value from the 100-year value.
 //?(Per Leanne, we dont understand this calc. Its just what the user gave us)
 // WRK.HPS PIC Date = WRK.Days - CON.26203
 WRK.HPS_PIC_Date = WRK.Days - 26203;

 //?**************
 //?Set up day of week
 DO;

 //?the days of week returned go from Monday=1 thru Sunday=7
 // WRK.USR Day of Week Number = DB1.Post to G/L Date *DAY OF WEEK
 WRK.USR_Day_of_Week_Number = DATEDTLS(DB1.Post_to_G_L_Date 'DW' 1111111 'NONE' 'N' 1);

 CASE;

 // IF WRK.USR Day of Week Number is Saturday
 IF WRK.USR_Day_of_Week_Number = 7;

 // WRK.USR Day of Week Number = CON.1
 WRK.USR_Day_of_Week_Number = 1;

 // IF *OTHERWISE
 IF *OTHERWISE;

 // WRK.USR Day of Week Number = WRK.USR Day of Week Number + CON.1
 WRK.USR_Day_of_Week_Number = WRK.USR_Day_of_Week_Number + 1;

 ENDIF;

 // WRK.CD7 Ext Numeric Key = CVTVAR(WRK.USR Day of Week Number)
 WRK.CD7_Ext_Numeric_Key = CVTVAR(WRK.USR_Day_of_Week_Number);

 // WRK.Day of Week = SUBSTRING(WRK.CD7 Ext Numeric Key,CON.7,CON.1)
 WRK.Day_of_Week = SUBSTRING(WRK.CD7_Ext_Numeric_Key:7:1);

 ENDDO;

 //?Set-up HPS Calendar Week, Year
 CASE;

 // IF WRK.Day of Week is Saturday
 IF WRK.Day_of_Week = '7';

 //?Set-up HPS Calendar Week, Year
 // IF WRK.Day of Week is Sunday
 IF WRK.Day_of_Week = '1';

 //?** RMC 1/11/2001  Calc HPS Calendar Week and year
 // WRK.HPS Calendar Week = WRK.HPS Calendar Week + CON.1
 WRK.HPS_Calendar_Week = WRK.HPS_Calendar_Week + 1;

 CASE;

 // IF WRK.HPS Calendar Week is GT 52
 IF WRK.HPS_Calendar_Week > 52;

 // WRK.HPS Calendar Week = CON.1
 WRK.HPS_Calendar_Week = 1;

 // WRK.HPS Calendar Year = WRK.HPS Calendar Year + CON.1
 WRK.HPS_Calendar_Year = WRK.HPS_Calendar_Year + 1;

 ENDIF;

 //?Set-up HPS Calendar Week, Year
 // IF *OTHERWISE
 IF *OTHERWISE;

 ENDIF;

 EXECUTE FUNCTION(CHG Calendar           CH) TYPE(CHGOBJ) FILE(CAAFREP)          AC1102025;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Post_to_G_L_Date);
 PARAMETER(DB1.Julian_Date);
 PARAMETER(DB1.Accounting_Year_Code);
 PARAMETER(DB1.Accounting_Period_Code);
 PARAMETER(DB1.OM_Week);
 PARAMETER(DB1.Day_of_Week);
 PARAMETER(DB1.Week_Number);
 PARAMETER(DB1.Public_Holiday_Status);
 PARAMETER(DB1.Billing_Cycle);
 PARAMETER(DB1.Payroll_Quarter);
 PARAMETER(DB1.Kill_Day_Status);
 PARAMETER(DB1.Production_Day_Status);
 PARAMETER(DB1.Prodcution_Sch_Pln_Sts);
 PARAMETER(WRK.HPS_PIC_Date);
 PARAMETER(WRK.HPS_Calendar_Year);
 PARAMETER(WRK.HPS_Calendar_Week);
 PARAMETER(DB1.Number_of_Prod_Shifts);
 PARAMETER(DB1.Calendar_Unused_Sts_2);
 PARAMETER(DB1.Calendar_Unused_Date);
 PARAMETER(DB1.Calendar_Unused_Date_2);
 PARAMETER(DB1.EDI_Status_1);
 PARAMETER(DB1.EDI_Status_2);
 PARAMETER(DB1.EDI_Status_3);
 PARAMETER(DB1.Job_Time);
 PARAMETER(DB1.User_Id);
 PARAMETER(DB1.Job_Name);
 PARAMETER(DB1.Job_Date);
}


