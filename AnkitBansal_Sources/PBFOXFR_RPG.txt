     H/TITLE Exc Build MPR Dwnld   XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISJMIST
     H* Date          : 04/29/25  Time  : 02:20:15
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FPDLHCPL1IF  E           K        DISK
      * RTV : Load Order Change Log     Retrieval index
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FCAEOREL3IF  E           K        DISK
      * RSQ : Company Customer          Customer/Company
      *
     FPMFDREL2IF  E           K        DISK
      * RSQ : Company Item Ext          RTV, select Active
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FPBARCPL2IF  E           K        DISK
      * RSQ : MPR FOB Omaha Rate Table  Country/St/Zip
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FPBAOCPL1IF  E           K        DISK
      * RTV : MPR Wholesale Pork Daily  Retrieval index
      *
     FOPBGWKN5IF  E           K        DISK
      * RSQ : Order Detail              Co/Ord/Seq(d),NtCancel
      *
     FPDNEREL1IF  E           K        DISK
      * RTV : Customer EXT              Retrieval index
      *
     FOPBGWKL6IF  E           K        DISK
      * RSQ : Order Detail              Co/Order/Item
      *
     FPBAOCPL0UF  E           K        DISK                      A
      * UPD : MPR Wholesale Pork Daily  Update index
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
      * Long constants
     E                    @CN#    1  02  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@KMREHC
      * Company Values            Retrieval index
      * Renamed input format fields
     I              KMAIC3                          WAAIC3
     I              KMV8CD                          WAV8CD
     I              KMAUNA                          WAAUNA
     I              KMI5ST                          WAI5ST
     I              KMBXTX                          WABXTX
     I              KMM8NB                          WAM8NB
     I              KMUVST                          WAUVST
     I              KMUWST                          WAUWST
     I              KMUXST                          WAUXST
     I              KMVSST                          WAVSST
     I              KMAATM                          WAAATM
     I              KMAYNA                          WAAYNA
     I              KMA0NA                          WAA0NA
     I              KMAXDT                          WAAXDT
      *
     I@LHCPN7
      * Load Order Change Log     Retrieval index
      * Renamed input format fields
     I              LHK4DT                          WBK4DT
     I              LHA1TM                          WBA1TM
     I              LHDXNB                          WBDXNB
     I              LHRMNB                          WBRMNB
     I              LHRVNB                          WBRVNB
     I              LHRVST                          WBRVST
     I              LHUJST                          WBUJST
     I              LHMNTX                          WBMNTX
     I              LHMOTX                          WBMOTX
     I              LHAYNA                          WBAYNA
     I              LHA0NA                          WBA0NA
     I              LHBZNA                          WBBZNA
     I              LHXMCD                          WBXMCD
     I              LHAIC3                          WBAIC3
     I              LHC4NB                          WBC4NB
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WCAIC3
     I              OMC4NB                          WCC4NB
     I              OMDPNB                          WCDPNB
     I              OMUENB                          WCUENB
     I              OMHGCD                          WCHGCD
     I              OMAJCD                          WCAJCD
     I              OMBKC7                          WCBKC7
     I              OMCFC7                          WCCFC7
     I              OMGMST                          WCGMST
     I              OMGNST                          WCGNST
     I              OMMAVA                          WCMAVA
     I              OMKDVA                          WCKDVA
     I              OML8VA                          WCL8VA
     I              OML9VA                          WCL9VA
     I              OMGTST                          WCGTST
     I              OMGVST                          WCGVST
     I              OMGUST                          WCGUST
     I              OMQFST                          WCQFST
     I              OMAYVA                          WCAYVA
     I              OMEXDT                          WCEXDT
     I              OMLQCD                          WCLQCD
     I              OMRDCD                          WCRDCD
     I              OMQ7CD                          WCQ7CD
     I              OMBZPR                          WCBZPR
     I              OML6NB                          WCL6NB
     I              OMU1ST                          WCU1ST
     I              OMGIDT                          WCGIDT
     I              OMCRCD                          WCCRCD
     I              OMAGCD                          WCAGCD
     I              OMRZST                          WCRZST
     I              OMR0ST                          WCR0ST
     I              OMR1ST                          WCR1ST
     I              OMG7NA                          WCG7NA
     I              OMG8NA                          WCG8NA
     I              OMRPCD                          WCRPCD
     I              OMVEST                          WCVEST
     I              OMVGST                          WCVGST
     I              OMAVST                          WCAVST
     I              OMU0ST                          WCU0ST
     I              OMRFCD                          WCRFCD
     I              OMFZST                          WCFZST
     I              OMR1NB                          WCR1NB
     I              OMAVQT                          WCAVQT
     I              OMD0WG                          WCD0WG
     I              OMCCQT                          WCCCQT
     I              OMAUWG                          WCAUWG
     I              OMCBQT                          WCCBQT
     I              OMATWG                          WCATWG
     I              OMAQCS                          WCAQCS
     I              OMAGCS                          WCAGCS
     I              OMAKPR                          WCAKPR
     I              OMALPR                          WCALPR
     I              OMAUPR                          WCAUPR
     I              OMAVWG                          WCAVWG
     I              OMA4WG                          WCA4WG
     I              OMA5DT                          WCA5DT
     I              OMAODT                          WCAODT
     I              OMGNDT                          WCGNDT
     I              OMAMST                          WCAMST
     I              OMANST                          WCANST
     I              OMVAST                          WCVAST
     I              OMRGNB                          WCRGNB
     I              OMRHNB                          WCRHNB
     I              OMRINB                          WCRINB
     I              OMRBCD                          WCRBCD
     I              OMHICD                          WCHICD
     I              OMRNCD                          WCRNCD
     I              OMROCD                          WCROCD
     I              OMCXDT                          WCCXDT
     I              OMAJVN                          WCAJVN
     I              OMKXCD                          WCKXCD
     I              OMJPCD                          WCJPCD
     I              OMCQCD                          WCCQCD
     I              OMR4CD                          WCR4CD
     I              OMZ1ST                          WCZ1ST
     I              OMZ3ST                          WCZ3ST
     I              OMZ4ST                          WCZ4ST
     I              OMDUPR                          WCDUPR
     I              OMB6VL                          WCB6VL
     I              OMA1AA                          WCA1AA
     I              OMFZSX                          WCFZSX
     I              OMF0SX                          WCF0SX
     I              OMF1SX                          WCF1SX
     I              OMF2SX                          WCF2SX
     I              OMF3SX                          WCF3SX
     I              OMF4SX                          WCF4SX
     I              OMF5SX                          WCF5SX
     I              OMF6SX                          WCF6SX
     I              OMF7SX                          WCF7SX
     I              OMNTDT                          WCNTDT
     I              OMNUDT                          WCNUDT
     I              OMNVDT                          WCNVDT
     I              OMNWDT                          WCNWDT
     I              OMNXDT                          WCNXDT
     I              OMBUTM                          WCBUTM
     I              OMBVTM                          WCBVTM
     I              OMBWTM                          WCBWTM
     I              OMBXTM                          WCBXTM
     I              OMBYTM                          WCBYTM
     I              OMH5NX                          WCH5NX
     I              OMH6NX                          WCH6NX
     I              OMH7NX                          WCH7NX
     I              OMH8NX                          WCH8NX
     I              OMH9NX                          WCH9NX
     I              OMDVPR                          WCDVPR
     I              OMDWPR                          WCDWPR
     I              OMDXPR                          WCDXPR
     I              OMDYPR                          WCDYPR
     I              OMDZPR                          WCDZPR
     I              OMGSPR                          WCGSPR
     I              OMGTPR                          WCGTPR
     I              OMGUPR                          WCGUPR
     I              OMHOST                          WCHOST
     I              OMHPST                          WCHPST
     I              OMIOST                          WCIOST
     I              OMPEWG                          WCPEWG
     I              OMRINY                          WCRINY
     I              OMTIDT                          WCTIDT
     I              OMTJDT                          WCTJDT
     I              OMH2ST                          WCH2ST
     I              OMH0ST                          WCH0ST
     I              OMH1ST                          WCH1ST
     I              OMTKDT                          WCTKDT
     I              OMTLDT                          WCTLDT
     I              OMTMDT                          WCTMDT
     I              OMUVST                          WCUVST
     I              OMUWST                          WCUWST
     I              OMUXST                          WCUXST
     I              OMAATM                          WCAATM
     I              OMAYNA                          WCAYNA
     I              OMA0NA                          WCA0NA
     I              OMAXDT                          WCAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WDAIC3
     I              BEC4NB                          WDC4NB
     I              BEJNCD                          WDJNCD
     I              BEANC7                          WDANC7
     I              BEBKC7                          WDBKC7
     I              BEBRTX                          WDBRTX
     I              BEHMNA                          WDHMNA
     I              BEHONA                          WDHONA
     I              BEHPNA                          WDHPNA
     I              BEHNNA                          WDHNNA
     I              BEDBCD                          WDDBCD
     I              BECKTX                          WDCKTX
     I              BEB0C7                          WDB0C7
     I              BEAETX                          WDAETX
     I              BEB1NA                          WDB1NA
     I              BEB3NA                          WDB3NA
     I              BEB4NA                          WDB4NA
     I              BEB2NA                          WDB2NA
     I              BEBHCD                          WDBHCD
     I              BEC8TX                          WDC8TX
     I              BEBCNA                          WDBCNA
     I              BEA0DT                          WDA0DT
     I              BEA5DT                          WDA5DT
     I              BEGNDT                          WDGNDT
     I              BEACDT                          WDACDT
     I              BEAQCD                          WDAQCD
     I              BEB6NA                          WDB6NA
     I              BEBYNA                          WDBYNA
     I              BEBZNA                          WDBZNA
     I              BEGTST                          WDGTST
     I              BEGVST                          WDGVST
     I              BEGUST                          WDGUST
     I              BEQFST                          WDQFST
     I              BECQCD                          WDCQCD
     I              BEGJST                          WDGJST
     I              BEGWST                          WDGWST
     I              BEGXST                          WDGXST
     I              BEGYST                          WDGYST
     I              BEAODT                          WDAODT
     I              BEAIVN                          WDAIVN
     I              BECXDT                          WDCXDT
     I              BEJZVA                          WDJZVA
     I              BEA1WG                          WDA1WG
     I              BEXIST                          WDXIST
     I              BEXJST                          WDXJST
     I              BEXKST                          WDXKST
     I              BEEIDT                          WDEIDT
     I              BEAFTM                          WDAFTM
     I              BEE8CD                          WDE8CD
     I              BEE9CD                          WDE9CD
     I              BERMNB                          WDRMNB
     I              BETBNB                          WDTBNB
     I              BER1NB                          WDR1NB
     I              BEPJST                          WDPJST
     I              BEU0ST                          WDU0ST
     I              BEU1ST                          WDU1ST
     I              BEQ2CD                          WDQ2CD
     I              BEU2ST                          WDU2ST
     I              BEVEST                          WDVEST
     I              BEVFST                          WDVFST
     I              BEVGST                          WDVGST
     I              BERPCD                          WDRPCD
     I              BERNNB                          WDRNNB
     I              BEVDST                          WDVDST
     I              BEATIN                          WDATIN
     I              BEU4ST                          WDU4ST
     I              BEU5ST                          WDU5ST
     I              BERSRN                          WDRSRN
     I              BEMHNA                          WDMHNA
     I              BEMINA                          WDMINA
     I              BEWBST                          WDWBST
     I              BER4CD                          WDR4CD
     I              BEBFCD                          WDBFCD
     I              BEQ4CD                          WDQ4CD
     I              BET3NB                          WDT3NB
     I              BESICD                          WDSICD
     I              BECONB                          WDCONB
     I              BECEST                          WDCEST
     I              BEAWDT                          WDAWDT
     I              BEJPCD                          WDJPCD
     I              BEXUST                          WDXUST
     I              BEZ1ST                          WDZ1ST
     I              BEVRVA                          WDVRVA
     I              BEOBST                          WDOBST
     I              BEBCST                          WDBCST
     I              BEBDST                          WDBDST
     I              BEB7VL                          WDB7VL
     I              BEGASX                          WDGASX
     I              BEGBSX                          WDGBSX
     I              BEGCSX                          WDGCSX
     I              BEGDSX                          WDGDSX
     I              BEFNSX                          WDFNSX
     I              BEFOSX                          WDFOSX
     I              BEFPSX                          WDFPSX
     I              BEFQSX                          WDFQSX
     I              BEFRSX                          WDFRSX
     I              BEFSSX                          WDFSSX
     I              BEFTSX                          WDFTSX
     I              BEFUSX                          WDFUSX
     I              BEFVSX                          WDFVSX
     I              BEFWSX                          WDFWSX
     I              BEFXSX                          WDFXSX
     I              BEFYSX                          WDFYSX
     I              BENODT                          WDNODT
     I              BENPDT                          WDNPDT
     I              BENQDT                          WDNQDT
     I              BENRDT                          WDNRDT
     I              BENSDT                          WDNSDT
     I              BEBPTM                          WDBPTM
     I              BEBQTM                          WDBQTM
     I              BEBRTM                          WDBRTM
     I              BEBSTM                          WDBSTM
     I              BEBTTM                          WDBTTM
     I              BEH0NX                          WDH0NX
     I              BEH1NX                          WDH1NX
     I              BEH2NX                          WDH2NX
     I              BEH3NX                          WDH3NX
     I              BEH4NX                          WDH4NX
     I              BEC0C7                          WDC0C7
     I              BEUVST                          WDUVST
     I              BEUWST                          WDUWST
     I              BEUXST                          WDUXST
     I              BEAATM                          WDAATM
     I              BEAYNA                          WDAYNA
     I              BEA0NA                          WDA0NA
     I              BEAXDT                          WDAXDT
      *
     I@EOREU0
      * Company Customer          Customer/Company
      * Renamed input format fields
     I              EOAIC3                          WEAIC3
     I              EOBKC7                          WEBKC7
     I              EOAQCD                          WEAQCD
     I              EOR4CD                          WER4CD
     I              EOBYNA                          WEBYNA
     I              EOB6NA                          WEB6NA
     I              EOBZNA                          WEBZNA
     I              EOLLST                          WELLST
     I              EOPPST                          WEPPST
     I              EOR5NB                          WER5NB
     I              EOR6NB                          WER6NB
     I              EOQGST                          WEQGST
     I              EOBOCD                          WEBOCD
     I              EOTBNB                          WETBNB
     I              EOMTCU                          WEMTCU
     I              EOW2NB                          WEW2NB
     I              EORPCD                          WERPCD
     I              EOAJCD                          WEAJCD
     I              EOX9ST                          WEX9ST
     I              EOT9CD                          WET9CD
     I              EOUBCD                          WEUBCD
     I              EOISTX                          WEISTX
     I              EOLQCD                          WELQCD
     I              EONJNA                          WENJNA
     I              EOI0TX                          WEI0TX
     I              EONKNA                          WENKNA
     I              EOI1TX                          WEI1TX
     I              EOVLST                          WEVLST
     I              EORLST                          WERLST
     I              EOMMTX                          WEMMTX
     I              EOOHNA                          WEOHNA
     I              EOQ6ST                          WEQ6ST
     I              EOQ8ST                          WEQ8ST
     I              EORBST                          WERBST
     I              EOREST                          WEREST
     I              EOUVST                          WEUVST
     I              EOUWST                          WEUWST
     I              EOUXST                          WEUXST
     I              EOVSST                          WEVSST
     I              EOAATM                          WEAATM
     I              EOAYNA                          WEAYNA
     I              EOA0NA                          WEA0NA
     I              EOAXDT                          WEAXDT
      *
     I@FDREAW
      * Company Item Ext          RTV, select Active
      * Renamed input format fields
     I              FDAIC3                          WFAIC3
     I              FDHGCD                          WFHGCD
     I              FDD0ST                          WFD0ST
     I              FDD2ST                          WFD2ST
     I              FDD6ST                          WFD6ST
     I              FDWESP                          WFWESP
     I              FDEDST                          WFEDST
     I              FDEFST                          WFEFST
     I              FDEHST                          WFEHST
     I              FDEMST                          WFEMST
     I              FDENST                          WFENST
     I              FDEOST                          WFEOST
     I              FDEPST                          WFEPST
     I              FDEQST                          WFEQST
     I              FDOQNY                          WFOQNY
     I              FDORNY                          WFORNY
     I              FDS2DT                          WFS2DT
     I              FDUFT1                          WFUFT1
     I              FDKUAA                          WFKUAA
     I              FDVSST                          WFVSST
     I              FDMJDT                          WFMJDT
     I              FDBETM                          WFBETM
     I              FDCCVN                          WFCCVN
     I              FDCDVN                          WFCDVN
     I              FDMKDT                          WFMKDT
     I              FDBFTM                          WFBFTM
     I              FDCEVN                          WFCEVN
     I              FDCFVN                          WFCFVN
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WGAIC3
     I              BZHGCD                          WGHGCD
     I              BZAVNA                          WGAVNA
     I              BZAWNA                          WGAWNA
     I              BZL7NA                          WGL7NA
     I              BZL8NA                          WGL8NA
     I              BZL6NA                          WGL6NA
     I              BZMFNA                          WGMFNA
     I              BZADCD                          WGADCD
     I              BZAWPC                          WGAWPC
     I              BZLXST                          WGLXST
     I              BZAECD                          WGAECD
     I              BZAXPC                          WGAXPC
     I              BZLYST                          WGLYST
     I              BZAFCD                          WGAFCD
     I              BZAICD                          WGAICD
     I              BZAIWG                          WGAIWG
     I              BZHICD                          WGHICD
     I              BZRBCD                          WGRBCD
     I              BZFZST                          WGFZST
     I              BZAVST                          WGAVST
     I              BZCZWG                          WGCZWG
     I              BZC0WG                          WGC0WG
     I              BZURTN                          WGURTN
     I              BZAJC8                          WGAJC8
     I              BZRINB                          WGRINB
     I              BZRHNB                          WGRHNB
     I              BZRGNB                          WGRGNB
     I              BZLNCD                          WGLNCD
     I              BZTFNB                          WGTFNB
     I              BZN0CD                          WGN0CD
     I              BZX4ST                          WGX4ST
     I              BZTMVA                          WGTMVA
     I              BZTNVA                          WGTNVA
     I              BZBLPR                          WGBLPR
     I              BZBMPR                          WGBMPR
     I              BZLRCD                          WGLRCD
     I              BZU9ST                          WGU9ST
     I              BZCMCO                          WGCMCO
     I              BZQ1CD                          WGQ1CD
     I              BZQ8CD                          WGQ8CD
     I              BZCHTM                          WGCHTM
     I              BZQZCD                          WGQZCD
     I              BZXWST                          WGXWST
     I              BZXXST                          WGXXST
     I              BZVMST                          WGVMST
     I              BZSWGH                          WGSWGH
     I              BZPPHE                          WGPPHE
     I              BZR3CD                          WGR3CD
     I              BZSDCD                          WGSDCD
     I              BZICN1                          WGICN1
     I              BZSVCD                          WGSVCD
     I              BZICN2                          WGICN2
     I              BZSWCD                          WGSWCD
     I              BZV2NB                          WGV2NB
     I              BZSXCD                          WGSXCD
     I              BZITCN                          WGITCN
     I              BZSYCD                          WGSYCD
     I              BZITC5                          WGITC5
     I              BZSZCD                          WGSZCD
     I              BZICN6                          WGICN6
     I              BZS0CD                          WGS0CD
     I              BZICN7                          WGICN7
     I              BZS1CD                          WGS1CD
     I              BZICN8                          WGICN8
     I              BZS2CD                          WGS2CD
     I              BZICN9                          WGICN9
     I              BZS3CD                          WGS3CD
     I              BZICN0                          WGICN0
     I              BZS4CD                          WGS4CD
     I              BZSFNB                          WGSFNB
     I              BZA3WG                          WGA3WG
     I              BZSJNB                          WGSJNB
     I              BZLLCD                          WGLLCD
     I              BZLMCD                          WGLMCD
     I              BZP3ST                          WGP3ST
     I              BZSKNB                          WGSKNB
     I              BZSLNB                          WGSLNB
     I              BZSMNB                          WGSMNB
     I              BZP4ST                          WGP4ST
     I              BZCFNB                          WGCFNB
     I              BZCGNB                          WGCGNB
     I              BZILNB                          WGILNB
     I              BZCHNB                          WGCHNB
     I              BZCINB                          WGCINB
     I              BZCJNB                          WGCJNB
     I              BZCMNB                          WGCMNB
     I              BZCNNB                          WGCNNB
     I              BZCRNB                          WGCRNB
     I              BZCSNB                          WGCSNB
     I              BZCVNB                          WGCVNB
     I              BZCWNB                          WGCWNB
     I              BZCXNB                          WGCXNB
     I              BZCZNB                          WGCZNB
     I              BZC0NB                          WGC0NB
     I              BZN1CD                          WGN1CD
     I              BZB4NB                          WGB4NB
     I              BZB5NB                          WGB5NB
     I              BZX5ST                          WGX5ST
     I              BZX6ST                          WGX6ST
     I              BZX7ST                          WGX7ST
     I              BZPCCT                          WGPCCT
     I              BZBDNB                          WGBDNB
     I              BZBJNB                          WGBJNB
     I              BZSUST                          WGSUST
     I              BZSVST                          WGSVST
     I              BZSYST                          WGSYST
     I              BZSZST                          WGSZST
     I              BZS1ST                          WGS1ST
     I              BZXRCD                          WGXRCD
     I              BZXTCD                          WGXTCD
     I              BZXUCD                          WGXUCD
     I              BZF5WG                          WGF5WG
     I              BZF6WG                          WGF6WG
     I              BZF7WG                          WGF7WG
     I              BZBLNB                          WGBLNB
     I              BZBNNB                          WGBNNB
     I              BZS2ST                          WGS2ST
     I              BZS4ST                          WGS4ST
     I              BZS5ST                          WGS5ST
     I              BZS6ST                          WGS6ST
     I              BZS8ST                          WGS8ST
     I              BZS9ST                          WGS9ST
     I              BZTCST                          WGTCST
     I              BZTDST                          WGTDST
     I              BZUVST                          WGUVST
     I              BZUWST                          WGUWST
     I              BZUXST                          WGUXST
     I              BZVSST                          WGVSST
     I              BZAATM                          WGAATM
     I              BZAYNA                          WGAYNA
     I              BZA0NA                          WGA0NA
     I              BZAXDT                          WGAXDT
      *
     I@ARCPOV
      * MPR FOB Omaha Rate Table  Country/St/Zip
      * Renamed input format fields
     I              ARPZAA                          WHPZAA
     I              ARW5NY                          WHW5NY
     I              ARP0AA                          WHP0AA
     I              ARW6NY                          WHW6NY
     I              ARHSPR                          WHHSPR
     I              ARW7NY                          WHW7NY
     I              ARU2DT                          WHU2DT
     I              ARZWT1                          WHZWT1
     I              ARZXT1                          WHZXT1
     I              ARVSST                          WHVSST
     I              ARMJDT                          WHMJDT
     I              ARBETM                          WHBETM
     I              ARCCVN                          WHCCVN
     I              ARCDVN                          WHCDVN
     I              ARMKDT                          WHMKDT
     I              ARBFTM                          WHBFTM
     I              ARCEVN                          WHCEVN
     I              ARCFVN                          WHCFVN
      *
     I@ADREAO
      * Warehouse Codes           Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WIAJCD
     I              ADF8NA                          WIF8NA
     I              ADACNA                          WIACNA
     I              ADADNA                          WIADNA
     I              ADAENA                          WIAENA
     I              ADAJNA                          WIAJNA
     I              ADBTTX                          WIBTTX
     I              ADAOCD                          WIAOCD
     I              ADBGCD                          WIBGCD
     I              ADVHST                          WIVHST
     I              ADMPNA                          WIMPNA
     I              ADWPST                          WIWPST
     I              ADXUST                          WIXUST
     I              ADT0ST                          WIT0ST
     I              ADT1ST                          WIT1ST
     I              ADDBNB                          WIDBNB
     I              ADT2ST                          WIT2ST
     I              ADT3ST                          WIT3ST
     I              ADT4ST                          WIT4ST
     I              ADT6ST                          WIT6ST
     I              ADBWC3                          WIBWC3
     I              ADBTC3                          WIBTC3
     I              ADBUC3                          WIBUC3
     I              ADBVC3                          WIBVC3
     I              ADFCAA                          WIFCAA
     I              ADRQSX                          WIRQSX
     I              ADRRSX                          WIRRSX
     I              ADRSSX                          WIRSSX
     I              ADRTSX                          WIRTSX
     I              ADT7ST                          WIT7ST
     I              ADT8ST                          WIT8ST
     I              ADRNSX                          WIRNSX
     I              ADROSX                          WIROSX
     I              ADRPSX                          WIRPSX
     I              ADUVST                          WIUVST
     I              ADUWST                          WIUWST
     I              ADUXST                          WIUXST
     I              ADVSST                          WIVSST
     I              ADAATM                          WIAATM
     I              ADAYNA                          WIAYNA
     I              ADA0NA                          WIA0NA
     I              ADAXDT                          WIAXDT
     I              ADQDSC                          WIQDSC
      *
     I@AOCPOG
      * MPR Wholesale Pork Daily  Retrieval index
      * Renamed input format fields
     I              AOPWAA                          WJPWAA
     I              AOUTDT                          WJUTDT
     I              AOV0NY                          WJV0NY
     I              AOZBT1                          WJZBT1
     I              AOFRC7                          WJFRC7
     I              AOPEST                          WJPEST
     I              AOPIST                          WJPIST
     I              AOPLST                          WJPLST
     I              AOPQST                          WJPQST
     I              AOPTST                          WJPTST
     I              AOPUST                          WJPUST
     I              AOPVST                          WJPVST
     I              AOZCT1                          WJZCT1
     I              AOPNWG                          WJPNWG
     I              AOHMPR                          WJHMPR
     I              AOHNPR                          WJHNPR
     I              AOPXST                          WJPXST
     I              AOPXS2                          WJPXS2
     I              AOUZDT                          WJUZDT
     I              AOU1DT                          WJU1DT
     I              AOU0DT                          WJU0DT
     I              AOHOPR                          WJHOPR
     I              AOW4NY                          WJW4NY
     I              AOWZNY                          WJWZNY
     I              AOW0NY                          WJW0NY
     I              AOW1NY                          WJW1NY
     I              AOHSPR                          WJHSPR
     I              AOW3NY                          WJW3NY
     I              AOP6ST                          WJP6ST
     I              AOP0AA                          WJP0AA
     I              AOW6NY                          WJW6NY
     I              AOW7NY                          WJW7NY
     I              AOUYDT                          WJUYDT
     I              AOVSST                          WJVSST
     I              AOMJDT                          WJMJDT
     I              AOBETM                          WJBETM
     I              AOCCVN                          WJCCVN
     I              AOCDVN                          WJCDVN
     I              AOMKDT                          WJMKDT
     I              AOBFTM                          WJBFTM
     I              AOCEVN                          WJCEVN
     I              AOCFVN                          WJCFVN
      *
     I@AOCPOF
      * MPR Wholesale Pork Daily  Update index
      * Renamed input format fields
     I              AOPWAA                          WKPWAA
     I              AOUTDT                          WKUTDT
     I              AOV0NY                          WKV0NY
     I              AOZBT1                          WKZBT1
     I              AOFRC7                          WKFRC7
     I              AOPEST                          WKPEST
     I              AOPIST                          WKPIST
     I              AOPLST                          WKPLST
     I              AOPQST                          WKPQST
     I              AOPTST                          WKPTST
     I              AOPUST                          WKPUST
     I              AOPVST                          WKPVST
     I              AOZCT1                          WKZCT1
     I              AOPNWG                          WKPNWG
     I              AOHMPR                          WKHMPR
     I              AOHNPR                          WKHNPR
     I              AOPXST                          WKPXST
     I              AOPXS2                          WKPXS2
     I              AOUZDT                          WKUZDT
     I              AOU1DT                          WKU1DT
     I              AOU0DT                          WKU0DT
     I              AOHOPR                          WKHOPR
     I              AOW4NY                          WKW4NY
     I              AOWZNY                          WKWZNY
     I              AOW0NY                          WKW0NY
     I              AOW1NY                          WKW1NY
     I              AOHSPR                          WKHSPR
     I              AOW3NY                          WKW3NY
     I              AOP6ST                          WKP6ST
     I              AOP0AA                          WKP0AA
     I              AOW6NY                          WKW6NY
     I              AOW7NY                          WKW7NY
     I              AOUYDT                          WKUYDT
     I              AOVSST                          WKVSST
     I              AOMJDT                          WKMJDT
     I              AOBETM                          WKBETM
     I              AOCCVN                          WKCCVN
     I              AOCDVN                          WKCDVN
     I              AOMKDT                          WKMKDT
     I              AOBFTM                          WKBFTM
     I              AOCEVN                          WKCEVN
     I              AOCFVN                          WKCFVN
      *
     I@BGWKON
      * Order Detail              Co/Ord/Seq(d),NtCancel
      * Renamed input format fields
     I              OMAIC3                          WLAIC3
     I              OMC4NB                          WLC4NB
     I              OMDPNB                          WLDPNB
     I              OMUENB                          WLUENB
     I              OMHGCD                          WLHGCD
     I              OMAJCD                          WLAJCD
     I              OMBKC7                          WLBKC7
     I              OMCFC7                          WLCFC7
     I              OMGMST                          WLGMST
     I              OMGNST                          WLGNST
     I              OMMAVA                          WLMAVA
     I              OMKDVA                          WLKDVA
     I              OML8VA                          WLL8VA
     I              OML9VA                          WLL9VA
     I              OMGTST                          WLGTST
     I              OMGVST                          WLGVST
     I              OMGUST                          WLGUST
     I              OMQFST                          WLQFST
     I              OMAYVA                          WLAYVA
     I              OMEXDT                          WLEXDT
     I              OMLQCD                          WLLQCD
     I              OMRDCD                          WLRDCD
     I              OMQ7CD                          WLQ7CD
     I              OMBZPR                          WLBZPR
     I              OML6NB                          WLL6NB
     I              OMU1ST                          WLU1ST
     I              OMGIDT                          WLGIDT
     I              OMCRCD                          WLCRCD
     I              OMAGCD                          WLAGCD
     I              OMRZST                          WLRZST
     I              OMR0ST                          WLR0ST
     I              OMR1ST                          WLR1ST
     I              OMG7NA                          WLG7NA
     I              OMG8NA                          WLG8NA
     I              OMRPCD                          WLRPCD
     I              OMVEST                          WLVEST
     I              OMVGST                          WLVGST
     I              OMAVST                          WLAVST
     I              OMU0ST                          WLU0ST
     I              OMRFCD                          WLRFCD
     I              OMFZST                          WLFZST
     I              OMR1NB                          WLR1NB
     I              OMAVQT                          WLAVQT
     I              OMD0WG                          WLD0WG
     I              OMCCQT                          WLCCQT
     I              OMAUWG                          WLAUWG
     I              OMCBQT                          WLCBQT
     I              OMATWG                          WLATWG
     I              OMAQCS                          WLAQCS
     I              OMAGCS                          WLAGCS
     I              OMAKPR                          WLAKPR
     I              OMALPR                          WLALPR
     I              OMAUPR                          WLAUPR
     I              OMAVWG                          WLAVWG
     I              OMA4WG                          WLA4WG
     I              OMA5DT                          WLA5DT
     I              OMAODT                          WLAODT
     I              OMGNDT                          WLGNDT
     I              OMAMST                          WLAMST
     I              OMANST                          WLANST
     I              OMVAST                          WLVAST
     I              OMRGNB                          WLRGNB
     I              OMRHNB                          WLRHNB
     I              OMRINB                          WLRINB
     I              OMRBCD                          WLRBCD
     I              OMHICD                          WLHICD
     I              OMRNCD                          WLRNCD
     I              OMROCD                          WLROCD
     I              OMCXDT                          WLCXDT
     I              OMAJVN                          WLAJVN
     I              OMKXCD                          WLKXCD
     I              OMJPCD                          WLJPCD
     I              OMCQCD                          WLCQCD
     I              OMR4CD                          WLR4CD
     I              OMZ1ST                          WLZ1ST
     I              OMZ3ST                          WLZ3ST
     I              OMZ4ST                          WLZ4ST
     I              OMDUPR                          WLDUPR
     I              OMB6VL                          WLB6VL
     I              OMA1AA                          WLA1AA
     I              OMFZSX                          WLFZSX
     I              OMF0SX                          WLF0SX
     I              OMF1SX                          WLF1SX
     I              OMF2SX                          WLF2SX
     I              OMF3SX                          WLF3SX
     I              OMF4SX                          WLF4SX
     I              OMF5SX                          WLF5SX
     I              OMF6SX                          WLF6SX
     I              OMF7SX                          WLF7SX
     I              OMNTDT                          WLNTDT
     I              OMNUDT                          WLNUDT
     I              OMNVDT                          WLNVDT
     I              OMNWDT                          WLNWDT
     I              OMNXDT                          WLNXDT
     I              OMBUTM                          WLBUTM
     I              OMBVTM                          WLBVTM
     I              OMBWTM                          WLBWTM
     I              OMBXTM                          WLBXTM
     I              OMBYTM                          WLBYTM
     I              OMH5NX                          WLH5NX
     I              OMH6NX                          WLH6NX
     I              OMH7NX                          WLH7NX
     I              OMH8NX                          WLH8NX
     I              OMH9NX                          WLH9NX
     I              OMDVPR                          WLDVPR
     I              OMDWPR                          WLDWPR
     I              OMDXPR                          WLDXPR
     I              OMDYPR                          WLDYPR
     I              OMDZPR                          WLDZPR
     I              OMGSPR                          WLGSPR
     I              OMGTPR                          WLGTPR
     I              OMGUPR                          WLGUPR
     I              OMHOST                          WLHOST
     I              OMHPST                          WLHPST
     I              OMIOST                          WLIOST
     I              OMPEWG                          WLPEWG
     I              OMRINY                          WLRINY
     I              OMTIDT                          WLTIDT
     I              OMTJDT                          WLTJDT
     I              OMH2ST                          WLH2ST
     I              OMH0ST                          WLH0ST
     I              OMH1ST                          WLH1ST
     I              OMTKDT                          WLTKDT
     I              OMTLDT                          WLTLDT
     I              OMTMDT                          WLTMDT
     I              OMUVST                          WLUVST
     I              OMUWST                          WLUWST
     I              OMUXST                          WLUXST
     I              OMAATM                          WLAATM
     I              OMAYNA                          WLAYNA
     I              OMA0NA                          WLA0NA
     I              OMAXDT                          WLAXDT
      *
     I@NEREAT
      * Customer EXT              Retrieval index
      * Renamed input format fields
     I              NEBKC7                          WMBKC7
     I              NEUFTX                          WMUFTX
     I              NEUGTX                          WMUGTX
     I              NEPFNA                          WMPFNA
     I              NEJ5NX                          WMJ5NX
     I              NEU5TX                          WMU5TX
     I              NEU6TX                          WMU6TX
     I              NEW0TX                          WMW0TX
     I              NEHSSX                          WMHSSX
     I              NEHUSX                          WMHUSX
     I              NEHVSX                          WMHVSX
     I              NEAAC8                          WMAAC8
     I              NEP0SX                          WMP0SX
     I              NEP1SX                          WMP1SX
     I              NEP2SX                          WMP2SX
     I              NEP3SX                          WMP3SX
     I              NEP4SX                          WMP4SX
     I              NEP5SX                          WMP5SX
     I              NEP6SX                          WMP6SX
     I              NEUVST                          WMUVST
     I              NEUWST                          WMUWST
     I              NEUXST                          WMUXST
     I              NEVSST                          WMVSST
     I              NEAATM                          WMAATM
     I              NEAYNA                          WMAYNA
     I              NEA0NA                          WMA0NA
     I              NEAXDT                          WMAXDT
      *
     I@BGWKZL
      * Order Detail              Co/Order/Item
      * Renamed input format fields
     I              OMAIC3                          WOAIC3
     I              OMC4NB                          WOC4NB
     I              OMDPNB                          WODPNB
     I              OMUENB                          WOUENB
     I              OMHGCD                          WOHGCD
     I              OMAJCD                          WOAJCD
     I              OMBKC7                          WOBKC7
     I              OMCFC7                          WOCFC7
     I              OMGMST                          WOGMST
     I              OMGNST                          WOGNST
     I              OMMAVA                          WOMAVA
     I              OMKDVA                          WOKDVA
     I              OML8VA                          WOL8VA
     I              OML9VA                          WOL9VA
     I              OMGTST                          WOGTST
     I              OMGVST                          WOGVST
     I              OMGUST                          WOGUST
     I              OMQFST                          WOQFST
     I              OMAYVA                          WOAYVA
     I              OMEXDT                          WOEXDT
     I              OMLQCD                          WOLQCD
     I              OMRDCD                          WORDCD
     I              OMQ7CD                          WOQ7CD
     I              OMBZPR                          WOBZPR
     I              OML6NB                          WOL6NB
     I              OMU1ST                          WOU1ST
     I              OMGIDT                          WOGIDT
     I              OMCRCD                          WOCRCD
     I              OMAGCD                          WOAGCD
     I              OMRZST                          WORZST
     I              OMR0ST                          WOR0ST
     I              OMR1ST                          WOR1ST
     I              OMG7NA                          WOG7NA
     I              OMG8NA                          WOG8NA
     I              OMRPCD                          WORPCD
     I              OMVEST                          WOVEST
     I              OMVGST                          WOVGST
     I              OMAVST                          WOAVST
     I              OMU0ST                          WOU0ST
     I              OMRFCD                          WORFCD
     I              OMFZST                          WOFZST
     I              OMR1NB                          WOR1NB
     I              OMAVQT                          WOAVQT
     I              OMD0WG                          WOD0WG
     I              OMCCQT                          WOCCQT
     I              OMAUWG                          WOAUWG
     I              OMCBQT                          WOCBQT
     I              OMATWG                          WOATWG
     I              OMAQCS                          WOAQCS
     I              OMAGCS                          WOAGCS
     I              OMAKPR                          WOAKPR
     I              OMALPR                          WOALPR
     I              OMAUPR                          WOAUPR
     I              OMAVWG                          WOAVWG
     I              OMA4WG                          WOA4WG
     I              OMA5DT                          WOA5DT
     I              OMAODT                          WOAODT
     I              OMGNDT                          WOGNDT
     I              OMAMST                          WOAMST
     I              OMANST                          WOANST
     I              OMVAST                          WOVAST
     I              OMRGNB                          WORGNB
     I              OMRHNB                          WORHNB
     I              OMRINB                          WORINB
     I              OMRBCD                          WORBCD
     I              OMHICD                          WOHICD
     I              OMRNCD                          WORNCD
     I              OMROCD                          WOROCD
     I              OMCXDT                          WOCXDT
     I              OMAJVN                          WOAJVN
     I              OMKXCD                          WOKXCD
     I              OMJPCD                          WOJPCD
     I              OMCQCD                          WOCQCD
     I              OMR4CD                          WOR4CD
     I              OMZ1ST                          WOZ1ST
     I              OMZ3ST                          WOZ3ST
     I              OMZ4ST                          WOZ4ST
     I              OMDUPR                          WODUPR
     I              OMB6VL                          WOB6VL
     I              OMA1AA                          WOA1AA
     I              OMFZSX                          WOFZSX
     I              OMF0SX                          WOF0SX
     I              OMF1SX                          WOF1SX
     I              OMF2SX                          WOF2SX
     I              OMF3SX                          WOF3SX
     I              OMF4SX                          WOF4SX
     I              OMF5SX                          WOF5SX
     I              OMF6SX                          WOF6SX
     I              OMF7SX                          WOF7SX
     I              OMNTDT                          WONTDT
     I              OMNUDT                          WONUDT
     I              OMNVDT                          WONVDT
     I              OMNWDT                          WONWDT
     I              OMNXDT                          WONXDT
     I              OMBUTM                          WOBUTM
     I              OMBVTM                          WOBVTM
     I              OMBWTM                          WOBWTM
     I              OMBXTM                          WOBXTM
     I              OMBYTM                          WOBYTM
     I              OMH5NX                          WOH5NX
     I              OMH6NX                          WOH6NX
     I              OMH7NX                          WOH7NX
     I              OMH8NX                          WOH8NX
     I              OMH9NX                          WOH9NX
     I              OMDVPR                          WODVPR
     I              OMDWPR                          WODWPR
     I              OMDXPR                          WODXPR
     I              OMDYPR                          WODYPR
     I              OMDZPR                          WODZPR
     I              OMGSPR                          WOGSPR
     I              OMGTPR                          WOGTPR
     I              OMGUPR                          WOGUPR
     I              OMHOST                          WOHOST
     I              OMHPST                          WOHPST
     I              OMIOST                          WOIOST
     I              OMPEWG                          WOPEWG
     I              OMRINY                          WORINY
     I              OMTIDT                          WOTIDT
     I              OMTJDT                          WOTJDT
     I              OMH2ST                          WOH2ST
     I              OMH0ST                          WOH0ST
     I              OMH1ST                          WOH1ST
     I              OMTKDT                          WOTKDT
     I              OMTLDT                          WOTLDT
     I              OMTMDT                          WOTMDT
     I              OMUVST                          WOUVST
     I              OMUWST                          WOUWST
     I              OMUXST                          WOUXST
     I              OMAATM                          WOAATM
     I              OMAYNA                          WOAYNA
     I              OMA0NA                          WOA0NA
     I              OMAXDT                          WOAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WRAIC3
     I              OMC4NB                          WRC4NB
     I              OMDPNB                          WRDPNB
     I              OMUENB                          WRUENB
     I              OMHGCD                          WRHGCD
     I              OMAJCD                          WRAJCD
     I              OMBKC7                          WRBKC7
     I              OMCFC7                          WRCFC7
     I              OMGMST                          WRGMST
     I              OMGNST                          WRGNST
     I              OMMAVA                          WRMAVA
     I              OMKDVA                          WRKDVA
     I              OML8VA                          WRL8VA
     I              OML9VA                          WRL9VA
     I              OMGTST                          WRGTST
     I              OMGVST                          WRGVST
     I              OMGUST                          WRGUST
     I              OMQFST                          WRQFST
     I              OMAYVA                          WRAYVA
     I              OMEXDT                          WREXDT
     I              OMLQCD                          WRLQCD
     I              OMRDCD                          WRRDCD
     I              OMQ7CD                          WRQ7CD
     I              OMBZPR                          WRBZPR
     I              OML6NB                          WRL6NB
     I              OMU1ST                          WRU1ST
     I              OMGIDT                          WRGIDT
     I              OMCRCD                          WRCRCD
     I              OMAGCD                          WRAGCD
     I              OMRZST                          WRRZST
     I              OMR0ST                          WRR0ST
     I              OMR1ST                          WRR1ST
     I              OMG7NA                          WRG7NA
     I              OMG8NA                          WRG8NA
     I              OMRPCD                          WRRPCD
     I              OMVEST                          WRVEST
     I              OMVGST                          WRVGST
     I              OMAVST                          WRAVST
     I              OMU0ST                          WRU0ST
     I              OMRFCD                          WRRFCD
     I              OMFZST                          WRFZST
     I              OMR1NB                          WRR1NB
     I              OMAVQT                          WRAVQT
     I              OMD0WG                          WRD0WG
     I              OMCCQT                          WRCCQT
     I              OMAUWG                          WRAUWG
     I              OMCBQT                          WRCBQT
     I              OMATWG                          WRATWG
     I              OMAQCS                          WRAQCS
     I              OMAGCS                          WRAGCS
     I              OMAKPR                          WRAKPR
     I              OMALPR                          WRALPR
     I              OMAUPR                          WRAUPR
     I              OMAVWG                          WRAVWG
     I              OMA4WG                          WRA4WG
     I              OMA5DT                          WRA5DT
     I              OMAODT                          WRAODT
     I              OMGNDT                          WRGNDT
     I              OMAMST                          WRAMST
     I              OMANST                          WRANST
     I              OMVAST                          WRVAST
     I              OMRGNB                          WRRGNB
     I              OMRHNB                          WRRHNB
     I              OMRINB                          WRRINB
     I              OMRBCD                          WRRBCD
     I              OMHICD                          WRHICD
     I              OMRNCD                          WRRNCD
     I              OMROCD                          WRROCD
     I              OMCXDT                          WRCXDT
     I              OMAJVN                          WRAJVN
     I              OMKXCD                          WRKXCD
     I              OMJPCD                          WRJPCD
     I              OMCQCD                          WRCQCD
     I              OMR4CD                          WRR4CD
     I              OMZ1ST                          WRZ1ST
     I              OMZ3ST                          WRZ3ST
     I              OMZ4ST                          WRZ4ST
     I              OMDUPR                          WRDUPR
     I              OMB6VL                          WRB6VL
     I              OMA1AA                          WRA1AA
     I              OMFZSX                          WRFZSX
     I              OMF0SX                          WRF0SX
     I              OMF1SX                          WRF1SX
     I              OMF2SX                          WRF2SX
     I              OMF3SX                          WRF3SX
     I              OMF4SX                          WRF4SX
     I              OMF5SX                          WRF5SX
     I              OMF6SX                          WRF6SX
     I              OMF7SX                          WRF7SX
     I              OMNTDT                          WRNTDT
     I              OMNUDT                          WRNUDT
     I              OMNVDT                          WRNVDT
     I              OMNWDT                          WRNWDT
     I              OMNXDT                          WRNXDT
     I              OMBUTM                          WRBUTM
     I              OMBVTM                          WRBVTM
     I              OMBWTM                          WRBWTM
     I              OMBXTM                          WRBXTM
     I              OMBYTM                          WRBYTM
     I              OMH5NX                          WRH5NX
     I              OMH6NX                          WRH6NX
     I              OMH7NX                          WRH7NX
     I              OMH8NX                          WRH8NX
     I              OMH9NX                          WRH9NX
     I              OMDVPR                          WRDVPR
     I              OMDWPR                          WRDWPR
     I              OMDXPR                          WRDXPR
     I              OMDYPR                          WRDYPR
     I              OMDZPR                          WRDZPR
     I              OMGSPR                          WRGSPR
     I              OMGTPR                          WRGTPR
     I              OMGUPR                          WRGUPR
     I              OMHOST                          WRHOST
     I              OMHPST                          WRHPST
     I              OMIOST                          WRIOST
     I              OMPEWG                          WRPEWG
     I              OMRINY                          WRRINY
     I              OMTIDT                          WRTIDT
     I              OMTJDT                          WRTJDT
     I              OMH2ST                          WRH2ST
     I              OMH0ST                          WRH0ST
     I              OMH1ST                          WRH1ST
     I              OMTKDT                          WRTKDT
     I              OMTLDT                          WRTLDT
     I              OMTMDT                          WRTMDT
     I              OMUVST                          WRUVST
     I              OMUWST                          WRUWST
     I              OMUXST                          WRUXST
     I              OMAATM                          WRAATM
     I              OMAYNA                          WRAYNA
     I              OMA0NA                          WRA0NA
     I              OMAXDT                          WRAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IQPBAO1    E DSPBAOCPL0
      * UPD : MPR Wholesale Pork Daily  Update index
      * Renamed input format fields
     I              AOPWAA                          WKPWAA
     I              AOUTDT                          WKUTDT
     I              AOV0NY                          WKV0NY
     I              AOZBT1                          WKZBT1
     I              AOFRC7                          WKFRC7
     I              AOPEST                          WKPEST
     I              AOPIST                          WKPIST
     I              AOPLST                          WKPLST
     I              AOPQST                          WKPQST
     I              AOPTST                          WKPTST
     I              AOPUST                          WKPUST
     I              AOPVST                          WKPVST
     I              AOZCT1                          WKZCT1
     I              AOPNWG                          WKPNWG
     I              AOHMPR                          WKHMPR
     I              AOHNPR                          WKHNPR
     I              AOPXST                          WKPXST
     I              AOPXS2                          WKPXS2
     I              AOUZDT                          WKUZDT
     I              AOU1DT                          WKU1DT
     I              AOU0DT                          WKU0DT
     I              AOHOPR                          WKHOPR
     I              AOW4NY                          WKW4NY
     I              AOWZNY                          WKWZNY
     I              AOW0NY                          WKW0NY
     I              AOW1NY                          WKW1NY
     I              AOHSPR                          WKHSPR
     I              AOW3NY                          WKW3NY
     I              AOP6ST                          WKP6ST
     I              AOP0AA                          WKP0AA
     I              AOW6NY                          WKW6NY
     I              AOW7NY                          WKW7NY
     I              AOUYDT                          WKUYDT
     I              AOVSST                          WKVSST
     I              AOMJDT                          WKMJDT
     I              AOBETM                          WKBETM
     I              AOCCVN                          WKCCVN
     I              AOCDVN                          WKCDVN
     I              AOMKDT                          WKMKDT
     I              AOBFTM                          WKBFTM
     I              AOCEVN                          WKCEVN
     I              AOCFVN                          WKCFVN
      *
     IYARDCS      DS                            229
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WRAIC3
     I              OMC4NB                          WRC4NB
     I              OMDPNB                          WRDPNB
     I              OMUENB                          WRUENB
     I              OMHGCD                          WRHGCD
     I              OMAJCD                          WRAJCD
     I              OMBKC7                          WRBKC7
     I              OMCFC7                          WRCFC7
     I              OMGMST                          WRGMST
     I              OMGNST                          WRGNST
     I              OMMAVA                          WRMAVA
     I              OMKDVA                          WRKDVA
     I              OML8VA                          WRL8VA
     I              OML9VA                          WRL9VA
     I              OMGTST                          WRGTST
     I              OMGVST                          WRGVST
     I              OMGUST                          WRGUST
     I              OMQFST                          WRQFST
     I              OMAYVA                          WRAYVA
     I              OMEXDT                          WREXDT
     I              OMLQCD                          WRLQCD
     I              OMRDCD                          WRRDCD
     I              OMQ7CD                          WRQ7CD
     I              OMBZPR                          WRBZPR
     I              OML6NB                          WRL6NB
     I              OMU1ST                          WRU1ST
     I              OMGIDT                          WRGIDT
     I              OMCRCD                          WRCRCD
     I              OMAGCD                          WRAGCD
     I              OMRZST                          WRRZST
     I              OMR0ST                          WRR0ST
     I              OMR1ST                          WRR1ST
     I              OMG7NA                          WRG7NA
     I              OMG8NA                          WRG8NA
     I              OMRPCD                          WRRPCD
     I              OMVEST                          WRVEST
     I              OMVGST                          WRVGST
     I              OMAVST                          WRAVST
     I              OMU0ST                          WRU0ST
     I              OMRFCD                          WRRFCD
     I              OMFZST                          WRFZST
     I              OMR1NB                          WRR1NB
     I              OMAVQT                          WRAVQT
     I              OMD0WG                          WRD0WG
     I              OMCCQT                          WRCCQT
     I              OMAUWG                          WRAUWG
     I              OMCBQT                          WRCBQT
     I              OMATWG                          WRATWG
     I              OMAQCS                          WRAQCS
     I              OMAGCS                          WRAGCS
     I              OMAKPR                          WRAKPR
     I              OMALPR                          WRALPR
     I              OMAUPR                          WRAUPR
     I              OMAVWG                          WRAVWG
     I              OMA4WG                          WRA4WG
     I              OMA5DT                          WRA5DT
     I              OMAODT                          WRAODT
     I              OMGNDT                          WRGNDT
     I              OMAMST                          WRAMST
     I              OMANST                          WRANST
     I              OMVAST                          WRVAST
     I              OMRGNB                          WRRGNB
     I              OMRHNB                          WRRHNB
     I              OMRINB                          WRRINB
     I              OMRBCD                          WRRBCD
     I              OMHICD                          WRHICD
     I              OMRNCD                          WRRNCD
     I              OMROCD                          WRROCD
     I              OMCXDT                          WRCXDT
     I              OMAJVN                          WRAJVN
     I              OMKXCD                          WRKXCD
     I              OMJPCD                          WRJPCD
     I              OMCQCD                          WRCQCD
     I              OMR4CD                          WRR4CD
     I              OMZ1ST                          WRZ1ST
     I              OMZ3ST                          WRZ3ST
     I              OMZ4ST                          WRZ4ST
     I              OMDUPR                          WRDUPR
     I              OMB6VL                          WRB6VL
     I              OMA1AA                          WRA1AA
     I              OMFZSX                          WRFZSX
     I              OMF0SX                          WRF0SX
     I              OMF1SX                          WRF1SX
     I              OMF2SX                          WRF2SX
     I              OMF3SX                          WRF3SX
     I              OMF4SX                          WRF4SX
     I              OMF5SX                          WRF5SX
     I              OMF6SX                          WRF6SX
     I              OMF7SX                          WRF7SX
     I              OMNTDT                          WRNTDT
     I              OMNUDT                          WRNUDT
     I              OMNVDT                          WRNVDT
     I              OMNWDT                          WRNWDT
     I              OMNXDT                          WRNXDT
     I              OMBUTM                          WRBUTM
     I              OMBVTM                          WRBVTM
     I              OMBWTM                          WRBWTM
     I              OMBXTM                          WRBXTM
     I              OMBYTM                          WRBYTM
     I              OMH5NX                          WRH5NX
     I              OMH6NX                          WRH6NX
     I              OMH7NX                          WRH7NX
     I              OMH8NX                          WRH8NX
     I              OMH9NX                          WRH9NX
     I              OMDVPR                          WRDVPR
     I              OMDWPR                          WRDWPR
     I              OMDXPR                          WRDXPR
     I              OMDYPR                          WRDYPR
     I              OMDZPR                          WRDZPR
     I              OMGSPR                          WRGSPR
     I              OMGTPR                          WRGTPR
     I              OMGUPR                          WRGUPR
     I              OMHOST                          WRHOST
     I              OMHPST                          WRHPST
     I              OMIOST                          WRIOST
     I              OMPEWG                          WRPEWG
     I              OMRINY                          WRRINY
     I              OMTIDT                          WRTIDT
     I              OMTJDT                          WRTJDT
     I              OMH2ST                          WRH2ST
     I              OMH0ST                          WRH0ST
     I              OMH1ST                          WRH1ST
     I              OMTKDT                          WRTKDT
     I              OMTLDT                          WRTLDT
     I              OMTMDT                          WRTMDT
     I              OMUVST                          WRUVST
     I              OMUWST                          WRUWST
     I              OMUXST                          WRUXST
     I              OMAATM                          WRAATM
     I              OMAYNA                          WRAYNA
     I              OMA0NA                          WRA0NA
     I              OMAXDT                          WRAXDT
      *
     IYBRDCS      DS                            525
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Detail
      * I :  Company Number
     I                                    P   1   20P1AIC3
     IP2PARM      DS
      * FLD: MPR Wholesale Pork Daily
      * B :  MPR Identification Num
     I                                        1   5 P2PWAA
      * B :  MPR Reporting Date
     I                                    P   6   90P2UTDT
      * I :  MPR Reporting Time
     I                                    P  10  100P2V0NY
      * N :  MPR Lot Identification
     I                                       11  35 P2ZBT1
      * N :  MPR Class code
     I                                       36  36 P2PTST
      * N :  MPR Null
     I                                       37  46 P2PUST
      * N :  MPR Null 1
     I                                       47  56 P2PVST
      * I :  MPR Data Mart Process Sts
     I                                       57  57 P2PXST
     IP3PARM      DS
      * FLD: Load Order Change Log
      * N :  Created Date
     I                                    P   1   40P3K4DT
      * N :  Created Time
     I                                    P   5   80P3A1TM
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P2PWAA    PARM P2PWAA    WP0002  5        MPR Identificat
     C           P2UTDT    PARM P2UTDT    WP0003  70       MPR Reporting D
     C           P2V0NY    PARM           WP0004  10       MPR Reporting T
     C           P2PXST    PARM           WP0005  1        MPR Data Mart P
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Exc Build MPR Dwnld   XF
      * E2247 New file for the MPR for Wholesale Pork - to be live 1/7/20
      *  LS-89 File is built/sent 2 times a day:  1 = by 10am    2 = by 2
      * Order Details will be written to this file if:
      *   1. The order is a regular "OR"der & "F"irm. TR/CM/DM are not se
      *     ** ALso send Block orders, same rules   4/10/13 E2540
      *   2. The order NOT an inter-co, nor Affiliated nor Sample sale,no
      *   3. The item has the flag for 'MPR to USDA' set to Yes
      *   4. The order detail is price Audited = M or A   OR see *7 below
      *   5. If the ordr is CT it must be > 1000 lbs
      *   6. The order detail was previously sent, but the ord qty/wgt ch
      *  *7. The order detail is MPR Prc Ready for MPR - E2540 4/8/13 RMC
      *   and MPR ready is NOT "X" for exclude
      * RMC 6/28/13 C2664 For days out calc, if order is FRM priced, use:
      *           Req Delv - Sched Ship, instead of Req Delv - Order Dt
      *  So FRM orders are within the FRM window of less than 14/10 days
      * RMC 7/31/13 E2649 Input Data Mart Process sts -
      *   Input "N" for run into Qtemp, input "R" for hard run at 9:30/1:
      *   After cognos grabs the data from the hard run, this will be "C"
      * RMC 12/4/13 E2910 For days out calc, use OD Entry Date alieu orde
      *   12/10/13 put the od date used in the mpr date sent for cognos p
      * RMC 5/22/14 C3124 in fob price calc, exclude TDL, SF1, WF1, LAL w
      *   now Accruals REVADJ
      * RMC 2/06/15 E3903 Treat HDG price type as FRM instead of as NEG -
      *    per USDA William Worlie
      * RMC 3/18/15 E4017 for FR, BX: if item age days >= 11 use Refrig c
      *    for FR,CB, if item age days >= 7 use Refrig code= 2
      *    per Aaron H
      * RMC 4/03/15 E4054 Treat new DST pr type as NEG (distressed sales)
      * RMC 1/07/16 E4675 Added unit price calc for TN
      * RMC 2/11/16 E5180 new price type NHT No Higher Than - treat like
      * RMC 12/6/16 R8044 Excl Abs Frt from calc if SFC Accrual exists
      *     Output Sts SF in MPR Price Calc Exception field
      * RMC 12/5/17 S12163 Treat new TNK pr type as NEG (tanked (old) sal
      * RMC 05/02/18 R13009 Dont exclude Abs Frt if SFC Accrual exists.AN
      *   add SFS AND FRC accrual rates to the calculation, and still ded
      *   ABS Frt... price needs to include those two REVADJ
      *    Put freight addon in its own field in the mpr file
      * RMC 1/29/20 WHD 59607 Treat new FLR pr type as NEG (floor)
      * RTV Alpha Value        RT - Company Values  * 
     C                     EXSR SARVGN
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           YL0001    PARM *ZERO     WQ0001 155       Current System
     C           YL0002    PARM *ZERO     WQ0002 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * PAR.MPR Reporting Date = LCL.Current System Date
     C                     Z-ADDYL0001    P2UTDT           MPR Reporting D
     C                     MOVEL'1'       P2PTST           MPR Class code
     C                     MOVEL*BLANK    P2PUST           MPR Null
     C                     MOVEL*BLANK    P2PVST           MPR Null 1
      * Get ordwgt changes since last mpr submission from load order log
      * CASE: PAR.MPR Reporting Time is 1=10am
     C           P2V0NY    IFEQ 1                          *IF
      * PAR.Created Date = JOB.*Job date + CON.-1 *DAYS
     C           ##JDT     ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-1        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111100' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P3K4DT
     C                     ELSE
     C           XDINDT    SUB  1000000   P3K4DT
     C                     END
     C                     Z-ADD134500    P3A1TM           Created Time
     C                     ELSE
      * CASE: PAR.MPR Reporting Time is 2=2pm
     C           P2V0NY    IFEQ 2                          *IF
     C                     Z-ADD##JDT     P3K4DT           Created Date
     C                     Z-ADD094500    P3A1TM           Created Time
      * CASE: PAR.MPR Data Mart Process Sts is New - not MPR Reported
     C           P2PXST    IFEQ 'N'                        *IF
      * CASE: JOB.*Job time is GE 13:45
     C           ##JTM     IFGE 134500                     *IF
     C                     Z-ADD134500    P3A1TM           Created Time
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD094500    P3A1TM           Created Time
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * RTV Bld MPR Dwnld      RT - Load Order Change Log  * 
     C                     EXSR SBRVGN
      * Get orders per OD
      * RTV Bld MPR Dwnld     RT - Order Detail  * 
     C                     EXSR SMRVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Alpha Value        RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAV8CD           Company Value C
      * Setup key
     C                     Z-ADDP1AIC3    WAAIC3           Company Number
     C                     MOVE *BLANK    WAV8CD           Company Value C
     C                     MOVEL'PLTESTNO'WAV8CD           Company Value C
      * Establish starting position
     C           KRSSA     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWABXTX    P2PWAA           System Value Al
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Bld MPR Dwnld      RT - Load Order Change Log  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001 25        MPR Lot Identif
     C                     Z-ADD*ZERO     WN0002  70       MPR Item Code
     C                     MOVEL*BLANK    WN0003  1        MPR Destination
     C                     MOVEL*BLANK    WN0004  1        MPR Sales Type
     C                     MOVEL*BLANK    WN0005  1        MPR Delivery Pe
     C                     MOVEL*BLANK    WN0006  1        MPR Refrigerati
     C                     MOVEL*BLANK    WN0007 30        MPR Item Descri
     C                     Z-ADD*ZERO     WN0008  70       MPR Product Wei
     C                     Z-ADD*ZERO     WN0009  62       MPR FOB Plant P
     C                     Z-ADD*ZERO     WN0010  62       MPR FOB Omaha P
     C                     MOVEL*BLANK    WN0011  2        MPR Price Calc
     C                     Z-ADD*ZERO     WN0012  70       MPR Actual Ship
     C                     Z-ADD*ZERO     WN0013  70       MPR Requested S
     C                     Z-ADD*ZERO     WN0014  70       MPR Scheduled S
     C                     Z-ADD*ZERO     WN0015 114       MPR Unit Price
     C                     Z-ADD*ZERO     WN0016  94       MPR Absorbed Fr
     C                     Z-ADD*ZERO     WN0017  94       MPR Customer Ac
     C                     Z-ADD*ZERO     WN0018  94       MPR Unused Rate
     C                     Z-ADD*ZERO     WN0019  94       MPR Order Accru
     C                     Z-ADD*ZERO     WN0020  94       MPR FOB Rate pe
     C                     Z-ADD*ZERO     WN0021  94       MPR Freight Add
     C                     MOVEL*BLANK    WN0022  2        MPR Shipping Me
     C                     MOVEL*BLANK    WN0023  2        MPR State Code
     C                     Z-ADD*ZERO     WN0024  50       MPR Zip Code
     C                     Z-ADD*ZERO     WN0025  70       MPR FOB Miles t
     C                     Z-ADD*ZERO     WN0026  70       MPR OD Entry_Fi
     C                     MOVEL*BLANK    WN0027  1        Record Selected
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD##JDT     WN0026           MPR OD Entry_Fi
      * Define keylist
     C           KPSSB     KLIST
     C                     KFLD           WBK4DT           Created Date
     C                     KFLD           WBA1TM           Created Time
      * Setup key
     C                     Z-ADDP3K4DT    WBK4DT           Created Date
     C                     Z-ADDP3A1TM    WBA1TM           Created Time
      * Establish starting position
     C           KPSSB     SETLL@LHCPN7                    *
     C                     READ @LHCPN7                  90*
      * Data record not found
     C   90                MOVEL'USR2471' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Company Number EQ PAR.Company Number
     C           WBAIC3    IFEQ P1AIC3                     *IF
      * CASE: DB1.Load Change Type is Order Weight
     C           WBRVST    IFEQ @CN,001                    *IF
     C                     MOVEL'N'       WN0027           Record Selected
     C                     Z-ADD7         YRSW00
     C                     Z-ADD5         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00012
     C           ZQ        ORGT 00012
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWBMNTX:ZQ YL0003    P  90  USR Text 7
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * WI642   JM-04/29/25-Fix for Scenario 1.
      * CASE: LCL.USR Text 7            USR is Seven Zeros
     C           YL0003    IFEQ @CN,002                    *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Change log prior has seq in pos 1-3, weight in 5-11:  001 0000nnn
     C                     Z-ADD3         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00012
     C           ZQ        ORGT 00012
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWBMNTX:ZQ YL0004    P  90  Text 3 Length U
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     MOVE YL0004    YL0005           Order Sequence
      * RTV MPR Build Fields  RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0001           Company Number
     C                     Z-ADDWBC4NB    WL0002           Order Number
     C                     Z-ADDYL0005    WL0003           Order Sequence
     C                     Z-ADD1         WL0004           Order Secondary
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    YL0006           Item Code
     C                     MOVELWL0006    YL0007    P      Warehouse Code
     C                     MOVELWL0007    YL0008    P      Price Method Co
     C                     MOVELWL0008    YL0009    P      Price Status
     C                     MOVELWL0009    YL0010    P      U_M_Base Price
     C                     MOVELWL0010    YL0011    P      U_M_Ordered
     C                     MOVELWL0011    YL0012    P      Order Desc_Line
     C                     Z-ADDWL0012    YL0013           Unit Price
     C                     Z-ADDWL0013    YL0014           Unit Weight Ord
     C                     Z-ADDWL0014    YL0015           Date of Origina
     C                     MOVELWL0015    YL0016    P      Country Code
     C                     MOVELWL0016    YL0017    P      OD Price Type
     C                     MOVELWL0017    YL0018    P      OD MPR Sent to
     C                     Z-ADDWL0018    YL0019           Item Age Days
      * RTV MPR Bld Dwnld     RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0019           Company Number
     C                     Z-ADDWBC4NB    WL0020           Order Number
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0021    YL0020    P      Order Type_Sale
     C                     Z-ADDWL0022    YL0021           AR Customer Num
     C                     Z-ADDWL0023    YL0022           Ship To Custome
     C                     MOVELWL0024    YL0023    P      Ship To State C
     C                     MOVELWL0025    YL0024    P      Ship To Zip_Pos
     C                     Z-ADDWL0026    YL0025           Order Date
     C                     Z-ADDWL0027    WN0013           Requested Ship
     C                     Z-ADDWL0028    WN0012           Actual Shipped
     C                     MOVELWL0029    YL0026    P      Header Status
     C                     Z-ADDWL0030    WN0014           Scheduled Ship
     C                     Z-ADDWL0031    YN0001           Date of Origina
     C                     Z-ADDWL0032    YL0027           Order Weight To
     C                     Z-ADDWL0033    YL0028           Requested Deliv
     C                     MOVELWL0034    YL0009    P      Price Status
     C                     MOVELWL0035    YL0029    P      Shipping Method
     C                     MOVELWL0036    YL0030    P      Export Status
     C                     MOVELWL0037    YL0031    P      Block Order Fla
     C                     MOVELWL0038    YL0032    P      Type Code
      * Rtv CIE MPR to USDA   RT - Company Item Ext  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0033    WL0039           Company Number
     C                     Z-ADDYL0006    WL0040           Item Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0041    YL0034    P      CIE MPR Report
      * RTV Unit Weight        RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0033    WL0042           Company Number
     C                     Z-ADDYL0006    WL0043           Item Code
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0044    YL0035           Unit Weight
     C                     MOVELWL0045    YL0036    P      Quality Level
      * Re-Send if order previously sent and weight change > 10%
      * CASE: LCL.OD MPR Sent to USDA Sts is yes
     C           YL0018    IFEQ 'Y'                        *IF
     C                     Z-ADD7         YRSW00
     C                     Z-ADD5         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00012
     C           ZQ        ORGT 00012
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWBMNTX:ZQ YL0037    P  90  Text USR 7
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     MOVE YL0037    YL0038           Weight Beg Inv
     C                     Z-ADD7         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00012
     C           ZQ        ORGT 00012
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWBMOTX:ZQ YL0037    P  90  Text USR 7
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     MOVE YL0037    YL0039           Weight End Inv
     C           YL0039    SUB  YL0038    YL0040           Weight Gain Usr
     C           YL0038    MULT .10       YL0041           Weight Open  7.
      * CASE: LCL.Weight Gain Usr GT LCL.Weight Open  7.0      USR
     C           YL0040    IFGT YL0041                     *IF
     C                     Z-ADDYL0040    WN0008           MPR Product Wei
     C                     MOVEL'Y'       WN0027           Record Selected
     C                     END                             *FI
      * If order item weight changed by >10% original wgt, then send Diff
      * CASE: PAR.Record Selected       USR is yes
     C           WN0027    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    WN0001           MPR Lot Identif
     C                     MOVELWBC4NB    WN0001           MPR Lot Identif
      * Destination
      * CASE: LCL.Export Status is yes
     C           YL0030    IFEQ 'Y'                        *IF
      * CASE:
      *  - c1ORc2
      *   |- c1    : LCL.Country Code is Canada
      *   |- c2    : LCL.Country Code is Mexico
      *   '-
     C           YL0016    IFEQ 'CAN'                      *IF
     C           YL0016    OREQ 'MEX'                      *OR
     C                     MOVEL'3'       WN0003           MPR Destination
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Val Canada state  RT - MPR FOB Omaha Rate Table  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL'CAN'     WL0046    P      MPR Country
     C                     MOVELYL0023    WL0047    P      MPR State Code
     C                     MOVELYL0042    WL0048    P      Record Found US
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0048    YL0042    P      Record Found US
      * if thru Canada to someplace else, report as NAFTA, else Export/ov
      * CASE: LCL.Record Found USR is Record Found
     C           YL0042    IFEQ 'Y'                        *IF
     C                     MOVEL'3'       WN0003           MPR Destination
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'2'       WN0003           MPR Destination
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVELYL0016    YL0043           MPR Country
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'1'       WN0003           MPR Destination
     C                     MOVEL*BLANK    YL0043           MPR Country
     C                     MOVEL'USA'     YL0043           MPR Country
     C                     END                             *FI
     C                     MOVEL'1'       WN0004           MPR Sales Type
      * new 6/28/13   -- add HDG here 2/6/15 , new NHT 2.11.16
      * CASE:
      *  - c1ORc2ORc3
      *   |- c1    : LCL.OD Price Type is Formula
      *   |- c2    : LCL.OD Price Type is Hedged
      *   |- c3    : LCL.OD Price Type is No Higher Than
      *   '-
     C           YL0017    IFEQ 'FRM'                      *IF
     C           YL0017    OREQ 'HDG'                      *OR
     C           YL0017    OREQ 'NHT'                      *OR
      * LCL.Days = LCL.Requested Delivery Date - PAR.MPR Scheduled Ship D
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C           WN0014    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           YL0028    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     YL0044
     C                     ELSE
     C           XDURR     MULT -1        YL0044
     C                     END
     C                     Z-ADDYL0015    WN0026           MPR OD Entry_Fi
     C                     ELSE
      * CASE: *OTHERWISE
      * Use OD Entry Date instead                 12/4/13
      * CASE: LCL.Date of Original Entry is Entered
     C           YL0015    IFNE 0                          *IF
      * CASE: LCL.Date of Original Entry GT LCL.Order Date
     C           YL0015    IFGT YL0025                     *IF
      * LCL.Days = LCL.Requested Delivery Date - LCL.Date of Original Ent
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C           YL0015    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           YL0028    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     YL0044
     C                     ELSE
     C           XDURR     MULT -1        YL0044
     C                     END
     C                     Z-ADDYL0015    WN0026           MPR OD Entry_Fi
     C                     ELSE
      * CASE: *OTHERWISE
      * LCL.Days = LCL.Requested Delivery Date - LCL.Order Date *DAYS
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C           YL0025    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           YL0028    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     YL0044
     C                     ELSE
     C           XDURR     MULT -1        YL0044
     C                     END
     C                     Z-ADDYL0025    WN0026           MPR OD Entry_Fi
     C                     END                             *FI
      * CASE: LCL.Days is LT 0
     C           YL0044    IFLT 0                          *IF
     C                     Z-ADD*ZERO     YL0044           Days
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * LCL.Days = LCL.Requested Delivery Date - LCL.Order Date *DAYS
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C           YL0025    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           YL0028    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     YL0044
     C                     ELSE
     C           XDURR     MULT -1        YL0044
     C                     END
     C                     Z-ADDYL0025    WN0026           MPR OD Entry_Fi
     C                     END                             *FI
     C                     END                             *FI
      * Sales Price type
      * CASE:
      *  - c1ORc2ORc3ORc4
      *   |- c1    : LCL.OD Price Type is Negotiated
      *   |- c2    : LCL.OD Price Type is Distressed
      *   |- c3    : LCL.OD Price Type is Tanked
      *   |- c4    : LCL.OD Price Type is Floor
      *   '-
     C           YL0017    IFEQ 'NEG'                      *IF
     C           YL0017    OREQ 'DST'                      *OR
     C           YL0017    OREQ 'TNK'                      *OR
     C           YL0017    OREQ 'FLR'                      *OR
      * bx: neg or fwd
      * CASE: LCL.U/M - Ordered is EQ Boxes
     C           YL0011    IFEQ 'BX'                       *IF
      * CASE: LCL.Days is LE 14
     C           YL0044    IFLE 14                         *IF
     C                     MOVEL'1'       WN0004           MPR Sales Type
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'2'       WN0004           MPR Sales Type
     C                     END                             *FI
     C                     END                             *FI
      * cb: neg or fwd
      * CASE: LCL.U/M - Ordered is Combos
     C           YL0011    IFEQ 'CB'                       *IF
      * CASE: LCL.Days is LE 10
     C           YL0044    IFLE 10                         *IF
     C                     MOVEL'1'       WN0004           MPR Sales Type
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'2'       WN0004           MPR Sales Type
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE:
      *  - c1ORc2ORc3
      *   |- c1    : LCL.OD Price Type is Formula
      *   |- c2    : LCL.OD Price Type is Hedged
      *   |- c3    : LCL.OD Price Type is No Higher Than
      *   '-
     C           YL0017    IFEQ 'FRM'                      *IF
     C           YL0017    OREQ 'HDG'                      *OR
     C           YL0017    OREQ 'NHT'                      *OR
      * Move HDG here from NEG Case stmt   2/6/15
      * Added new NHT here   2/11/16
      * bx: frm or fwd
      * CASE: LCL.U/M - Ordered is EQ Boxes
     C           YL0011    IFEQ 'BX'                       *IF
      * CASE: LCL.Days is LE 14
     C           YL0044    IFLE 14                         *IF
     C                     MOVEL'3'       WN0004           MPR Sales Type
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'2'       WN0004           MPR Sales Type
     C                     END                             *FI
     C                     END                             *FI
      * cb: frm or fwd
      * CASE: LCL.U/M - Ordered is Combos
     C           YL0011    IFEQ 'CB'                       *IF
      * CASE: LCL.Days is LE 10
     C           YL0044    IFLE 10                         *IF
     C                     MOVEL'3'       WN0004           MPR Sales Type
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'2'       WN0004           MPR Sales Type
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.OD Price Type is Contract
     C           YL0017    IFEQ 'CON'                      *IF
      * bx: neg or fwd
      * CASE: LCL.U/M - Ordered is EQ Boxes
     C           YL0011    IFEQ 'BX'                       *IF
      * CASE: LCL.Days is LE 14
     C           YL0044    IFLE 14                         *IF
     C                     MOVEL'1'       WN0004           MPR Sales Type
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'2'       WN0004           MPR Sales Type
     C                     END                             *FI
     C                     END                             *FI
      * cb: neg or fwd
      * CASE: LCL.U/M - Ordered is Combos
     C           YL0011    IFEQ 'CB'                       *IF
      * CASE: LCL.Days is LE 10
     C           YL0044    IFLE 10                         *IF
     C                     MOVEL'1'       WN0004           MPR Sales Type
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'2'       WN0004           MPR Sales Type
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Delivery Period -> boxes
      * CASE: LCL.U/M - Ordered is EQ Boxes
     C           YL0011    IFEQ 'BX'                       *IF
      * Days
      * CASE: LCL.Days is Between 15 - 60
     C           YL0044    IFGE 15                         *IF
     C           YL0044    ANDLE60
     C                     MOVEL'2'       WN0005           MPR Delivery Pe
     C                     ELSE
      * CASE: LCL.Days is GT 60
     C           YL0044    IFGT 60                         *IF
     C                     MOVEL'3'       WN0005           MPR Delivery Pe
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'1'       WN0005           MPR Delivery Pe
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Delivery Period -> Combos
      * CASE: LCL.U/M - Ordered is Combos
     C           YL0011    IFEQ 'CB'                       *IF
      * Days
      * CASE: LCL.Days is Between 11 - 60
     C           YL0044    IFGE 11                         *IF
     C           YL0044    ANDLE60
     C                     MOVEL'5'       WN0005           MPR Delivery Pe
     C                     ELSE
      * CASE: LCL.Days is GT 60
     C           YL0044    IFGT 60                         *IF
     C                     MOVEL'6'       WN0005           MPR Delivery Pe
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'4'       WN0005           MPR Delivery Pe
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * RTV Warehouse Type     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0007    WL0049    P      Warehouse Code
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0050    YL0045    P      Warehouse Type
      * Refrigeration = frozen vs. fresh  bx/cb
      * CASE: LCL.Warehouse Type is Frozen
     C           YL0045    IFEQ 'FZ'                       *IF
     C                     MOVEL'5'       WN0006           MPR Refrigerati
     C                     ELSE
      * CASE: *OTHERWISE
      * FRESH
      * CASE: LCL.U/M - Ordered is EQ Boxes
     C           YL0011    IFEQ 'BX'                       *IF
      * CASE: LCL.Item Age Days is GE 11 Days
     C           YL0019    IFGT 11                         *IF
     C                     MOVEL'4'       WN0006           MPR Refrigerati
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'3'       WN0006           MPR Refrigerati
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.U/M - Ordered is Combos
     C           YL0011    IFEQ 'CB'                       *IF
      * CASE: LCL.Item Age Days is 7 days to 121 days & Over
     C           YL0019    IFGE 7                          *IF
     C           YL0019    ANDLE9999
     C                     MOVEL'2'       WN0006           MPR Refrigerati
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'1'       WN0006           MPR Refrigerati
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDYL0006    WN0002           MPR Item Code
     C                     MOVELYL0012    WN0007           MPR Item Descri
      * Calc Fob Plant price
      * Get KNOWN Frt, accruals, commission and take them out of Unit Pri
      * Unit price CWT  for CS and other
      * CASE: LCL.U/M - Base Price is Cases
     C           YL0010    IFEQ 'CS'                       *IF
      * CASE: LCL.Unit Weight Ordered U/M is Greater than zero
     C           YL0014    IFGT 0                          *IF
      * Comp:Unit prc CWT for CS
      * PAR.MPR Unit Price =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : LCL.Unit Price
      * /     : PGM.*Synon (17,7) work field *
      * x2    : LCL.Unit Weight Ordered U_M
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           YL0013    DIV  YL0014    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT 100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0015           MPR Unit Price
     C                     ELSE
      * CASE: *OTHERWISE
      * Comp:Unit prc CWT for CS
      * PAR.MPR Unit Price =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : LCL.Unit Price
      * /     : PGM.*Synon (17,7) work field *
      * x2    : LCL.Unit Weight
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           YL0013    DIV  YL0035    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT 100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0015           MPR Unit Price
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.U/M - Base Price is Tons
     C           YL0010    IFEQ 'TN'                       *IF
     C           YL0013    DIV  2000      WUHVPR           Unit Price USR
     C           WUHVPR    MULT 100       WN0015           MPR Unit Price
     C                     ELSE
      * CASE: *OTHERWISE
     C           YL0013    MULT 100       WN0015           MPR Unit Price
     C                     END                             *FI
     C                     END                             *FI
      * Exc Get Fob Prc Adjs  XF - MPR Wholesale Pork Daily  * 
     C                     CALL 'PBFYXFR'              90  Exc Get Fob Prc
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBAIC3    WQ0003  30       Company Number
     C                     PARM WBC4NB    WQ0004  70       Order Number
     C                     PARM YL0005    WQ0005  30       Order Sequence
     C                     PARM YL0046    WQ0006  30       Order Secondary
     C                     PARM YL0006    WQ0007  70       Item Code
     C                     PARM YL0022    WQ0008  70       Ship To Custome
     C                     PARM YL0008    WQ0009  3        Price Method Co
     C                     PARM YL0009    WQ0010  1        Price Status
     C                     PARM YL0047    WQ0011 112       Quantity Shippe
     C                     PARM WN0008    WQ0012 112       Weight Shipped
     C                     PARM WN0013    WQ0013  70       Requested Ship
     C                     PARM WN0012    WQ0014  70       Actual Shipped
     C           WN0017    PARM WN0017    WQ0015  94       MPR Customer Ac
     C           WN0016    PARM WN0016    WQ0016  94       MPR Absorbed Fr
     C           WN0019    PARM WN0019    WQ0017  94       MPR Order Accru
     C                     PARM YL0029    WQ0018  2        Shipping Method
     C           WN0011    PARM WN0011    WQ0019  2        MPR Price Calc
     C           WN0021    PARM WN0021    WQ0020  94       MPR Freight Add
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBFYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Compute: FOB Plant Price
      * PAR.MPR FOB Plant Price/CWT =
      *    *COMPUTE ((x1-x2-x3-x5+x6))
      * x1    : PAR.MPR Unit Price
      * -     : PGM.*Synon (17,7) work field
      * x2    : PAR.MPR Absorbed Frt Rate
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.MPR Customer Accrual Rt
      * -     : PGM.*Synon (17,7) work field
      * x5    : PAR.MPR Order Accrual Rate
      * +     : PGM.*Synon (17,7) work field
      * x6    : PAR.MPR Freight Add On
     C           WN0015    SUB  WN0016    W0WD03           *Synon (17,7) w
     C           W0WD03    SUB  WN0017    W0WD02           *Synon (17,7) w
     C           W0WD02    SUB  WN0019    W0WD01           *Synon (17,7) w
     C           W0WD01    ADD  WN0021    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0009           MPR FOB Plant P
      * Calc FOB Omaha Price
     C                     MOVELYL0023    WN0023           MPR State Code
     C                     MOVELYL0029    WN0022           MPR Shipping Me
      * Exc Calc FOB Omaha Pr XF - MPR Wholesale Pork Daily  * 
     C                     CALL 'PBGTXFR'              90  Exc Calc FOB Om
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBAIC3    WQ0021  30       Company Number
     C                     PARM WBC4NB    WQ0022  70       Order Number
     C                     PARM YL0024    WQ0023 11        Ship To Zip_Pos
     C                     PARM WN0022    WQ0024  2        Shipping Method
     C           YL0043    PARM YL0043    WQ0025  6        MPR Country
     C                     PARM YL0007    WQ0026  3        Warehouse Code
     C           WN0010    PARM WN0010    WQ0027  62       MPR FOB Omaha P
     C                     PARM WN0009    WQ0028  62       MPR FOB Plant P
     C                     PARM WN0015    WQ0029 114       MPR Unit Price
     C           WN0020    PARM WN0020    WQ0030  94       MPR FOB Rate pe
     C           WN0022    PARM WN0022    WQ0031  2        MPR Shipping Me
     C           WN0023    PARM WN0023    WQ0032  2        MPR State Code
     C           WN0024    PARM WN0024    WQ0033  50       MPR Zip Code
     C           WN0025    PARM WN0025    WQ0034  70       MPR FOB Miles t
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBGTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Deduct accruals
      * CASE: PAR.MPR FOB Omaha Price is eq 0
     C           WN0010    IFEQ 0                          *IF
     C                     MOVEL'E'       YL0018           OD MPR Sent to
     C                     ELSE
      * CASE: *OTHERWISE
      * Deduct accruals here too
      * Compute: FOB Omaha Price
      * PAR.MPR FOB Omaha Price =
      *    *COMPUTE ((x1-x3-x5))
      * x1    : PAR.MPR FOB Omaha Price
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.MPR Customer Accrual Rt
      * -     : PGM.*Synon (17,7) work field
      * x5    : PAR.MPR Order Accrual Rate
     C           WN0010    SUB  WN0017    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WN0019    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0010           MPR FOB Omaha P
     C                     MOVEL'Y'       YL0018           OD MPR Sent to
     C                     END                             *FI
      * CASE: LCL.OD MPR Sent to USDA Sts is yes
     C           YL0018    IFEQ 'Y'                        *IF
      * Rtv Crt/Chg MPR Prk   RT - MPR Wholesale Pork Daily  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP2PWAA    WL0051    P      MPR Identificat
     C                     Z-ADDP2UTDT    WL0052           MPR Reporting D
     C                     Z-ADDP2V0NY    WL0053           MPR Reporting T
     C                     MOVELWN0001    WL0054    P      MPR Lot Identif
     C                     Z-ADDWN0002    WL0055           MPR Item Code
     C                     MOVELWN0003    WL0056    P      MPR Destination
     C                     MOVELWN0004    WL0057    P      MPR Sales Type
     C                     MOVELWN0005    WL0058    P      MPR Delivery Pe
     C                     MOVELWN0006    WL0059    P      MPR Refrigerati
     C                     MOVELP2PTST    WL0060    P      MPR Class code
     C                     MOVELP2PUST    WL0061    P      MPR Null
     C                     MOVELP2PVST    WL0062    P      MPR Null 1
     C                     MOVELWN0007    WL0063    P      MPR Item Descri
     C                     Z-ADDWN0008    WL0064           MPR Product Wei
     C                     Z-ADDWN0009    WL0065           MPR FOB Plant P
     C                     Z-ADDWN0010    WL0066           MPR FOB Omaha P
     C                     MOVELP2PXST    WL0067    P      MPR Data Mart P
     C                     MOVELWN0011    WL0068    P      MPR Price Calc
     C                     Z-ADDWN0012    WL0069           MPR Actual Ship
     C                     Z-ADDWN0013    WL0070           MPR Requested S
     C                     Z-ADDWN0014    WL0071           MPR Scheduled S
     C                     Z-ADDWN0015    WL0072           MPR Unit Price
     C                     Z-ADDWN0016    WL0073           MPR Absorbed Fr
     C                     Z-ADDWN0017    WL0074           MPR Customer Ac
     C                     Z-ADDWN0019    WL0075           MPR Order Accru
     C                     Z-ADDWN0020    WL0076           MPR FOB Rate pe
     C                     Z-ADDWN0021    WL0077           MPR Freight Add
     C                     MOVELWN0022    WL0078    P      MPR Shipping Me
     C                     MOVELWN0023    WL0079    P      MPR State Code
     C                     Z-ADDWN0024    WL0080           MPR Zip Code
     C                     Z-ADDWN0025    WL0081           MPR FOB Miles t
     C                     Z-ADDWN0026    WL0082           MPR OD Entry_Fi
     C                     EXSR SJRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     READ @LHCPN7                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV MPR Build Fields  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
     C                     KFLD           WCDPNB           Order Sequence
     C                     KFLD           WCUENB           Order Secondary
      * Setup key
     C                     Z-ADDWL0001    WCAIC3           Company Number
     C                     Z-ADDWL0002    WCC4NB           Order Number
     C                     Z-ADDWL0003    WCDPNB           Order Sequence
     C                     Z-ADDWL0004    WCUENB           Order Secondary
      * Establish starting position
     C           KRSSC     CHAIN@BGWKL1              90    *
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCHGCD    WL0005           Item Code
     C                     MOVELWCAJCD    WL0006           Warehouse Code
     C                     MOVELWCQ7CD    WL0007           Price Method Co
     C                     MOVELWCU1ST    WL0008           Price Status
     C                     MOVELWCCRCD    WL0009           U_M_Base Price
     C                     MOVELWCAGCD    WL0010           U_M_Ordered
     C                     MOVELWCG7NA    WL0011           Order Desc_Line
     C                     Z-ADDWCAKPR    WL0012           Unit Price
     C                     Z-ADDWCAVWG    WL0013           Unit Weight Ord
     C                     Z-ADDWCCXDT    WL0014           Date of Origina
     C                     MOVELWCKXCD    WL0015           Country Code
     C                     MOVELWCF7SX    WL0016           OD Price Type
     C                     MOVELWCHOST    WL0017           OD MPR Sent to
     C                     Z-ADDWCRINY    WL0018           Item Age Days
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV MPR Bld Dwnld     RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0019    WDAIC3           Company Number
     C                     Z-ADDWL0020    WDC4NB           Order Number
      * Establish starting position
     C           KRSSD     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0021           Order Type_Sale
     C                     Z-ADD*ZERO     WL0022           AR Customer Num
     C                     Z-ADD*ZERO     WL0023           Ship To Custome
     C                     MOVEL*BLANK    WL0024           Ship To State C
     C                     MOVEL*BLANK    WL0025           Ship To Zip_Pos
     C                     Z-ADD*ZERO     WL0026           Order Date
     C                     Z-ADD*ZERO     WL0027           Requested Ship
     C                     Z-ADD*ZERO     WL0028           Actual Shipped
     C                     MOVEL*BLANK    WL0029           Header Status
     C                     Z-ADD*ZERO     WL0030           Scheduled Ship
     C                     Z-ADD*ZERO     WL0031           Date of Origina
     C                     Z-ADD*ZERO     WL0032           Order Weight To
     C                     Z-ADD*ZERO     WL0033           Requested Deliv
     C                     MOVEL*BLANK    WL0034           Price Status
     C                     MOVEL*BLANK    WL0035           Shipping Method
     C                     MOVEL*BLANK    WL0036           Export Status
     C                     MOVEL*BLANK    WL0037           Block Order Fla
     C                     MOVEL*BLANK    WL0038           Type Code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDJNCD    WL0021           Order Type_Sale
     C                     Z-ADDWDANC7    WL0022           AR Customer Num
     C                     Z-ADDWDBKC7    WL0023           Ship To Custome
     C                     MOVELWDDBCD    WL0024           Ship To State C
     C                     MOVELWDCKTX    WL0025           Ship To Zip_Pos
     C                     Z-ADDWDA0DT    WL0026           Order Date
     C                     Z-ADDWDA5DT    WL0027           Requested Ship
     C                     Z-ADDWDGNDT    WL0028           Actual Shipped
     C                     MOVELWDGWST    WL0029           Header Status
     C                     Z-ADDWDAODT    WL0030           Scheduled Ship
     C                     Z-ADDWDCXDT    WL0031           Date of Origina
     C                     Z-ADDWDA1WG    WL0032           Order Weight To
     C                     Z-ADDWDEIDT    WL0033           Requested Deliv
     C                     MOVELWDU1ST    WL0034           Price Status
     C                     MOVELWDQ2CD    WL0035           Shipping Method
     C                     MOVELWDU2ST    WL0036           Export Status
     C                     MOVELWDBCST    WL0037           Block Order Fla
      * Rtv Customer Type     RT - Company Customer  * 
     C                     EXSR SERVGN
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Customer Type     RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEBKC7    WQSE01           Ship To Custome
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Ship To Custome
      * Setup key
     C                     Z-ADDWDBKC7    WQSE01           Ship To Custome
      * Establish starting position
     C           KRSSE     SETLL@EOREU0                    *
     C           KRSSE     READE@EOREU0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0038           Type Code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEBOCD    WL0038           Type Code
     C                     GOTO SEEXIT                     *QUIT
     C           KRSSE     READE@EOREU0                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv CIE MPR to USDA   RT - Company Item Ext  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSF01           Company Number
     C           *LIKE     DEFN WFHGCD    WQSF02           Item Code
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Item Code
      * Setup key
     C                     Z-ADDWL0039    WQSF01           Company Number
     C                     Z-ADDWL0040    WQSF02           Item Code
      * Establish starting position
     C           KRSSF     SETLL@FDREAW                    *
     C           KRSSF     READE@FDREAW                  90*
      * Data record not found
     C   90                MOVEL'USR4125' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFEQST    WL0041           CIE MPR Report
     C           KRSSF     READE@FDREAW                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Unit Weight        RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0042    WGAIC3           Company Number
     C                     Z-ADDWL0043    WGHGCD           Item Code
      * Establish starting position
     C           KRSSG     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0044           Unit Weight
     C                     MOVEL*BLANK    WL0045           Quality Level
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWGAIWG    WL0044           Unit Weight
     C                     MOVELWGHICD    WL0045           Quality Level
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Val Canada state  RT - MPR FOB Omaha Rate Table  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHPZAA    WQSH01           MPR Country
     C           *LIKE     DEFN WHP0AA    WQSH02           MPR State Code
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           MPR Country
     C                     KFLD           WQSH02           MPR State Code
      * Setup key
     C                     MOVELWL0046    WQSH01           MPR Country
     C                     MOVELWL0047    WQSH02           MPR State Code
      * Establish starting position
     C           KRSSH     SETLL@ARCPOV                    *
     C           KRSSH     READE@ARCPOV                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4551' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WL0048           Record Found US
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WL0048           Record Found US
     C           KRSSH     READE@ARCPOV                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Warehouse Type     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WIAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0049    WIAJCD           Warehouse Code
      * Establish starting position
     C           KRSSI     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0050           Warehouse Type
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWIWPST    WL0050           Warehouse Type
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Crt/Chg MPR Prk   RT - MPR Wholesale Pork Daily  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WJPWAA           MPR Identificat
     C                     KFLD           WJUTDT           MPR Reporting D
     C                     KFLD           WJV0NY           MPR Reporting T
     C                     KFLD           WJZBT1           MPR Lot Identif
     C                     KFLD           WJFRC7           MPR Item Code
      * Setup key
     C                     MOVELWL0051    WJPWAA           MPR Identificat
     C                     Z-ADDWL0052    WJUTDT           MPR Reporting D
     C                     Z-ADDWL0053    WJV0NY           MPR Reporting T
     C                     MOVELWL0054    WJZBT1           MPR Lot Identif
     C                     Z-ADDWL0055    WJFRC7           MPR Item Code
      * Establish starting position
     C           KRSSJ     CHAIN@AOCPOG              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4536' W0RTN   7
      * USER: Processing if Data record not found
      * Crt MPR Wholesale Prk CR - MPR Wholesale Pork Daily  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWL0051    WL0083    P      MPR Identificat
     C                     Z-ADDWL0052    WL0084           MPR Reporting D
     C                     Z-ADDWL0053    WL0085           MPR Reporting T
     C                     MOVELWL0054    WL0086    P      MPR Lot Identif
     C                     Z-ADDWL0055    WL0087           MPR Item Code
     C                     MOVELWL0056    WL0088    P      MPR Destination
     C                     MOVELWL0057    WL0089    P      MPR Sales Type
     C                     MOVELWL0058    WL0090    P      MPR Delivery Pe
     C                     MOVELWL0059    WL0091    P      MPR Refrigerati
     C                     MOVELWL0060    WL0092    P      MPR Class code
     C                     MOVELWL0061    WL0093    P      MPR Null
     C                     MOVELWL0062    WL0094    P      MPR Null 1
     C                     MOVELWL0063    WL0095    P      MPR Item Descri
     C                     Z-ADDWL0064    WL0096           MPR Product Wei
     C                     Z-ADDWL0065    WL0097           MPR FOB Plant P
     C                     Z-ADDWL0066    WL0098           MPR FOB Omaha P
     C                     MOVELWL0067    WL0099    P      MPR Data Mart P
     C                     MOVELWL0068    WL0100    P      MPR Price Calc
     C                     Z-ADDWL0069    WL0101           MPR Actual Ship
     C                     Z-ADDWL0070    WL0102           MPR Requested S
     C                     Z-ADDWL0071    WL0103           MPR Scheduled S
     C                     Z-ADDWL0072    WL0104           MPR Unit Price
     C                     Z-ADDWL0073    WL0105           MPR Absorbed Fr
     C                     Z-ADDWL0074    WL0106           MPR Customer Ac
     C                     Z-ADD*ZERO     WL0107           MPR Unused Rate
     C                     Z-ADDWL0075    WL0108           MPR Order Accru
     C                     Z-ADDWL0076    WL0109           MPR FOB Rate pe
     C                     Z-ADDWL0077    WL0110           MPR Freight Add
     C                     MOVELWL0078    WL0111    P      MPR Shipping Me
     C                     MOVELWL0079    WL0112    P      MPR State Code
     C                     Z-ADDWL0080    WL0113           MPR Zip Code
     C                     Z-ADDWL0081    WL0114           MPR FOB Miles t
     C                     Z-ADDWL0082    WL0115           MPR OD Entry_Fi
     C                     MOVEL'A'       WL0116    P      Record Status
     C                     Z-ADD*ZERO     WL0117           Create Date
     C                     Z-ADD*ZERO     WL0118           Create Time
     C                     MOVEL*BLANK    WL0119           Create User
     C                     MOVEL*BLANK    WL0120           Create Program
     C                     Z-ADD*ZERO     WL0121           Change Date
     C                     Z-ADD*ZERO     WL0122           Change Time
     C                     MOVEL*BLANK    WL0123           Change User
     C                     MOVEL*BLANK    WL0124           Change Program
     C                     EXSR SKCRRC
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WJPNWG    ADD  WL0064    YL0048           MPR Product Wei
      * Chg MPR Wholesale Prk CH - MPR Wholesale Pork Daily  * 
     C                     EXSR SLCHRC
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCRRC    BEGSR
      *================================================================
      * Crt MPR Wholesale Prk CR - MPR Wholesale Pork Daily  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AOCPOF
     C                     MOVELWL0083    WKPWAA           MPR Identificat
     C                     Z-ADDWL0084    WKUTDT           MPR Reporting D
     C                     Z-ADDWL0085    WKV0NY           MPR Reporting T
     C                     MOVELWL0086    WKZBT1           MPR Lot Identif
     C                     Z-ADDWL0087    WKFRC7           MPR Item Code
     C                     MOVELWL0088    WKPEST           MPR Destination
     C                     MOVELWL0089    WKPIST           MPR Sales Type
     C                     MOVELWL0090    WKPLST           MPR Delivery Pe
     C                     MOVELWL0091    WKPQST           MPR Refrigerati
     C                     MOVELWL0092    WKPTST           MPR Class code
     C                     MOVELWL0093    WKPUST           MPR Null
     C                     MOVELWL0094    WKPVST           MPR Null 1
     C                     MOVELWL0095    WKZCT1           MPR Item Descri
     C                     Z-ADDWL0096    WKPNWG           MPR Product Wei
     C                     Z-ADDWL0097    WKHMPR           MPR FOB Plant P
     C                     Z-ADDWL0098    WKHNPR           MPR FOB Omaha P
     C                     MOVELWL0099    WKPXST           MPR Data Mart P
     C                     MOVELWL0100    WKPXS2           MPR Price Calc
     C                     Z-ADDWL0101    WKUZDT           MPR Actual Ship
     C                     Z-ADDWL0102    WKU1DT           MPR Requested S
     C                     Z-ADDWL0103    WKU0DT           MPR Scheduled S
     C                     Z-ADDWL0104    WKHOPR           MPR Unit Price
     C                     Z-ADDWL0105    WKW4NY           MPR Absorbed Fr
     C                     Z-ADDWL0106    WKWZNY           MPR Customer Ac
     C                     Z-ADDWL0107    WKW0NY           MPR Unused Rate
     C                     Z-ADDWL0108    WKW1NY           MPR Order Accru
     C                     Z-ADDWL0109    WKHSPR           MPR FOB Rate pe
     C                     Z-ADDWL0110    WKW3NY           MPR Freight Add
     C                     MOVELWL0111    WKP6ST           MPR Shipping Me
     C                     MOVELWL0112    WKP0AA           MPR State Code
     C                     Z-ADDWL0113    WKW6NY           MPR Zip Code
     C                     Z-ADDWL0114    WKW7NY           MPR FOB Miles t
     C                     Z-ADDWL0115    WKUYDT           MPR OD Entry_Fi
     C                     MOVELWL0116    WKVSST           Record Status
     C                     Z-ADDWL0117    WKMJDT           Create Date
     C                     Z-ADDWL0118    WKBETM           Create Time
     C                     MOVELWL0119    WKCCVN           Create User
     C                     MOVELWL0120    WKCDVN           Create Program
     C                     Z-ADDWL0121    WKMKDT           Change Date
     C                     Z-ADDWL0122    WKBFTM           Change Time
     C                     MOVELWL0123    WKCEVN           Change User
     C                     MOVELWL0124    WKCFVN           Change Program
      *
      * USER: Processing before Data update
      * Set Crt Date/Time      IF
      * *** Set RECORD STATUS field. ***
     C                     MOVEL'A'       WKVSST           Record Status
      * *** Set CREATE fields. ***
     C                     Z-ADD##JDT     WKMJDT           Create Date
     C                     Z-ADD##JTM     WKBETM           Create Time
     C                     MOVEL##USR     WKCCVN           Create User
     C                     MOVEL##PGM     WKCDVN           Create Program
      * *** Set CHANGE fields. ***
     C                     Z-ADD*ZERO     WKMKDT           Change Date
     C                     Z-ADD*ZERO     WKBFTM           Change Time
     C                     MOVEL*BLANK    WKCEVN           Change User
     C                     MOVEL*BLANK    WKCFVN           Change Program
     C           KLCRSK    KLIST
     C                     KFLD           WKPWAA           MPR Identificat
     C                     KFLD           WKUTDT           MPR Reporting D
     C                     KFLD           WKV0NY           MPR Reporting T
     C                     KFLD           WKZBT1           MPR Lot Identif
     C                     KFLD           WKFRC7           MPR Item Code
      * Check for duplicate primary key
     C           KLCRSK    SETLL@AOCPOF                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR4537' W0RTN   7
      * Send message 'MPR Wholesale Pork Dai EX'
     C                     MOVEL'USR4537' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C                     WRITE@AOCPOF                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCHRC    BEGSR
      *================================================================
      * Chg MPR Wholesale Prk CH - MPR Wholesale Pork Daily  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @AOCPOF
     C                     MOVELWJPWAA    WKPWAA    P      MPR Identificat
     C                     Z-ADDWJUTDT    WKUTDT           MPR Reporting D
     C                     Z-ADDWJV0NY    WKV0NY           MPR Reporting T
     C                     MOVELWJZBT1    WKZBT1    P      MPR Lot Identif
     C                     Z-ADDWJFRC7    WKFRC7           MPR Item Code
      *
     C           KLCHSL    KLIST
     C                     KFLD           WKPWAA           MPR Identificat
     C                     KFLD           WKUTDT           MPR Reporting D
     C                     KFLD           WKV0NY           MPR Reporting T
     C                     KFLD           WKZBT1           MPR Lot Identif
     C                     KFLD           WKFRC7           MPR Item Code
     C           KLCHSL    CHAIN@AOCPOF              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PBAOCPL0'MDACP
     C                     MOVEL'@AOCPOF' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPBAO1    YARDCS
      * Move non-key fields to @AOCPOF
     C                     MOVELWL0056    WKPEST    P      MPR Destination
     C                     MOVELWL0057    WKPIST    P      MPR Sales Type
     C                     MOVELWL0058    WKPLST    P      MPR Delivery Pe
     C                     MOVELWL0059    WKPQST    P      MPR Refrigerati
     C                     MOVELWL0060    WKPTST    P      MPR Class code
     C                     MOVELWL0061    WKPUST    P      MPR Null
     C                     MOVELWL0062    WKPVST    P      MPR Null 1
     C                     MOVELWL0063    WKZCT1    P      MPR Item Descri
     C                     Z-ADDYL0048    WKPNWG           MPR Product Wei
     C                     Z-ADDWL0065    WKHMPR           MPR FOB Plant P
     C                     Z-ADDWL0066    WKHNPR           MPR FOB Omaha P
     C                     MOVELWL0067    WKPXST    P      MPR Data Mart P
     C                     MOVELWL0068    WKPXS2    P      MPR Price Calc
     C                     Z-ADDWJUZDT    WKUZDT           MPR Actual Ship
     C                     Z-ADDWJU1DT    WKU1DT           MPR Requested S
     C                     Z-ADDWJU0DT    WKU0DT           MPR Scheduled S
     C                     Z-ADDWJHOPR    WKHOPR           MPR Unit Price
     C                     Z-ADDWJW4NY    WKW4NY           MPR Absorbed Fr
     C                     Z-ADDWJWZNY    WKWZNY           MPR Customer Ac
     C                     Z-ADDWJW0NY    WKW0NY           MPR Unused Rate
     C                     Z-ADDWJW1NY    WKW1NY           MPR Order Accru
     C                     Z-ADDWJHSPR    WKHSPR           MPR FOB Rate pe
     C                     Z-ADDWL0077    WKW3NY           MPR Freight Add
     C                     MOVELWJP6ST    WKP6ST    P      MPR Shipping Me
     C                     MOVELWJP0AA    WKP0AA    P      MPR State Code
     C                     Z-ADDWJW6NY    WKW6NY           MPR Zip Code
     C                     Z-ADDWJW7NY    WKW7NY           MPR FOB Miles t
     C                     Z-ADDWJUYDT    WKUYDT           MPR OD Entry_Fi
     C                     MOVELWJVSST    WKVSST    P      Record Status
     C                     Z-ADDWJMJDT    WKMJDT           Create Date
     C                     Z-ADDWJBETM    WKBETM           Create Time
     C                     MOVELWJCCVN    WKCCVN    P      Create User
     C                     MOVELWJCDVN    WKCDVN    P      Create Program
     C                     Z-ADD*ZERO     WKMKDT           Change Date
     C                     Z-ADD*ZERO     WKBFTM           Change Time
     C                     MOVEL*BLANK    WKCEVN    P      Change User
     C                     MOVEL*BLANK    WKCFVN    P      Change Program
      *
      * Set PGM.*Record Data Changed flag
     C           QPBAO1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Chg Date/Time      IF
     C                     Z-ADD##JDT     WKMKDT           Change Date
     C                     Z-ADD##JTM     WKBFTM           Change Time
     C                     MOVEL##USR     WKCEVN           Change User
     C                     MOVEL##PGM     WKCFVN           Change Program
      * Set PGM.*Record Data Changed flag
     C           QPBAO1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@AOCPOF                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPBAOCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Bld MPR Dwnld     RT - Order Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0028  1        Record Selected
     C                     MOVEL*BLANK    WN0029 25        MPR Lot Identif
     C                     Z-ADD*ZERO     WN0030  70       MPR Item Code
     C                     MOVEL*BLANK    WN0031  1        MPR Destination
     C                     MOVEL*BLANK    WN0032  1        MPR Sales Type
     C                     MOVEL*BLANK    WN0033  1        MPR Delivery Pe
     C                     MOVEL*BLANK    WN0034  1        MPR Refrigerati
     C                     MOVEL*BLANK    WN0035 30        MPR Item Descri
     C                     Z-ADD*ZERO     WN0036  70       MPR Product Wei
     C                     Z-ADD*ZERO     WN0037  62       MPR FOB Plant P
     C                     Z-ADD*ZERO     WN0038  62       MPR FOB Omaha P
     C                     MOVEL*BLANK    WN0039  2        MPR Price Calc
     C                     Z-ADD*ZERO     WN0040  70       MPR Actual Ship
     C                     Z-ADD*ZERO     WN0041  70       MPR Requested S
     C                     Z-ADD*ZERO     WN0042  70       MPR Scheduled S
     C                     Z-ADD*ZERO     WN0043 114       MPR Unit Price
     C                     Z-ADD*ZERO     WN0044  94       MPR Absorbed Fr
     C                     Z-ADD*ZERO     WN0045  94       MPR Customer Ac
     C                     Z-ADD*ZERO     WN0046  94       MPR Unused Rate
     C                     Z-ADD*ZERO     WN0047  94       MPR Order Accru
     C                     Z-ADD*ZERO     WN0048  94       MPR FOB Rate pe
     C                     Z-ADD*ZERO     WN0049  94       MPR Freight Add
     C                     MOVEL*BLANK    WN0050  2        MPR Shipping Me
     C                     MOVEL*BLANK    WN0051  2        MPR State Code
     C                     Z-ADD*ZERO     WN0052  50       MPR Zip Code
     C                     Z-ADD*ZERO     WN0053  70       MPR FOB Miles t
     C                     Z-ADD*ZERO     WN0054  70       MPR OD Entry_Fi
     C                     MOVEL*BLANK    WN0055  1        OD MPR Sent to
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD##JDT     WN0054           MPR OD Entry_Fi
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLAIC3    WQSM01           Company Number
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSM01           Company Number
      * Establish starting position
     C           KRSSM     SETLL@BGWKON                    *
     C           KRSSM     READE@BGWKON                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WN0028           Record Selected
      * RTV MPR Bld Dwnld     RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0019           Company Number
     C                     Z-ADDWLC4NB    WL0020           Order Number
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0021    YL0049    P      Order Type_Sale
     C                     Z-ADDWL0022    YL0050           AR Customer Num
     C                     Z-ADDWL0023    YL0051           Ship To Custome
     C                     MOVELWL0024    YL0052    P      Ship To State C
     C                     MOVELWL0025    YL0053    P      Ship To Zip_Pos
     C                     Z-ADDWL0026    YL0054           Order Date
     C                     Z-ADDWL0027    WN0041           Requested Ship
     C                     Z-ADDWL0028    WN0040           Actual Shipped
     C                     MOVELWL0029    YL0055    P      Header Status
     C                     Z-ADDWL0030    WN0042           Scheduled Ship
     C                     Z-ADDWL0031    YL0056           Date of Origina
     C                     Z-ADDWL0032    YL0057           Order Weight To
     C                     Z-ADDWL0033    YL0058           Requested Deliv
     C                     MOVELWL0034    YL0059    P      Price Status
     C                     MOVELWL0035    YL0060    P      Shipping Method
     C                     MOVELWL0036    YL0061    P      Export Status
     C                     MOVELWL0037    YL0062    P      Block Order Fla
     C                     MOVELWL0038    YL0063    P      Type Code
      * Rtv CIE MPR to USDA   RT - Company Item Ext  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0039           Company Number
     C                     Z-ADDWLHGCD    WL0040           Item Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0041    YL0064    P      CIE MPR Report
      * RTV Unit Weight        RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0042           Company Number
     C                     Z-ADDWLHGCD    WL0043           Item Code
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0044    YL0065           Unit Weight
     C                     MOVELWL0045    YL0066    P      Quality Level
      * Rtv EE Meat Sales flag RT - Customer EXT  * 
     C                     EXSR SNRVGN
     C                     MOVEL*BLANK    WN0055           OD MPR Sent to
      * Sel order type
      * CASE: LCL.Order Type - Sales is Regular Order
     C           YL0049    IFEQ 'OR'                       *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WN0028           Record Selected
     C                     MOVEL'X'       WN0055           OD MPR Sent to
     C                     END                             *FI
      * Sel customer type , + excl Empl meat sale
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5
      *   |- c1    : LCL.Type Code is Inter Company
      *   |- c2    : LCL.Type Code is Inter-Comp Sales Agreemnt
      *   |- c3    : LCL.Type Code is Inter-Plant Transfer
      *   |- c4    : LCL.Type Code is Is Promotional/Samples
      *   |- c5    : LCL.Employee/Co-Packer Sale is Employee
      *   '-
     C           YL0063    IFEQ 'IC'                       *IF
     C           YL0063    OREQ 'IS'                       *OR
     C           YL0063    OREQ 'IP'                       *OR
     C           YL0063    OREQ 'PS'                       *OR
     C           YL0067    OREQ 'E'                        *OR
     C                     MOVEL'N'       WN0028           Record Selected
     C                     MOVEL'X'       WN0055           OD MPR Sent to
     C                     END                             *FI
      * Sel item has a price & is price audited | price ready to send(E25
      * CASE:
      *  - c1AND((c2ANDc3ANDc5)ORc4)
      *   |- c1    : DB1.Unit Price is Greater than zero
      *   |- c2    : DB1.Price Status is Priced
      *   |- c3    : DB1.Price Audit is Manually/Auto Price Audit
      *   |- c5    : DB1.OD MPR Prc Ready to Send is Not X
      *   |- c4    : DB1.OD MPR Prc Ready to Send is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WLAKPR    IFGT 0                          *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WLU1ST    IFEQ 'P'                        *IF
     C           WLU0ST    IFEQ 'A'                        *IF
     C           WLU0ST    OREQ 'M'
     C           WLHPST    IFEQ *BLANK                     *IF
     C           WLHPST    OREQ 'N'
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX02    IFNE '1'                        *IF
     C           WLHPST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WN0028           Record Selected
     C                     END                             *FI
      * Sel item is wholesale pork
      * CASE: LCL.CIE MPR Report to USDA is Yes
     C           YL0064    IFEQ 'Y'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WN0028           Record Selected
     C                     MOVEL'X'       WN0055           OD MPR Sent to
     C                     END                             *FI
      * Sel item has a weight ordered
      * CASE: DB1.Weight Ordered is Equal to zero
     C           WLD0WG    IFEQ 0                          *IF
     C                     MOVEL'N'       WN0028           Record Selected
     C                     END                             *FI
      * Exc shipping method= CT and total weight < 1000 lbs
      * CASE:
      *  - c3 AND c1
      *   |- c3    : LCL.Shipping Method is Collect
      *   |- c1    : LCL.Order Weight Total is LT 1000
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0060    IFEQ 'CR'                       *IF
     C           YL0060    OREQ 'CT'
     C           YL0057    IFLT 1000                       *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       WN0028           Record Selected
     C                     END                             *FI
      * If not selected and already invoiced, set to "X"clude
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Record Selected       USR is no
      *   |- c2    : DB1.Detail Line Status is Complete
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0028    IFEQ 'N'                        *IF
     C           WLGMST    IFEQ 'C'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'X'       WN0055           OD MPR Sent to
     C                     END                             *FI
      * Process: Record Selected to be sent to MPR USDA
      * CASE: PAR.Record Selected       USR is yes
     C           WN0028    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    WN0029           MPR Lot Identif
     C                     MOVELWLC4NB    WN0029           MPR Lot Identif
      * Destination
      * CASE: LCL.Export Status is yes
     C           YL0061    IFEQ 'Y'                        *IF
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.Country Code is Canada
      *   |- c2    : DB1.Country Code is Mexico
      *   '-
     C           WLKXCD    IFEQ 'CAN'                      *IF
     C           WLKXCD    OREQ 'MEX'                      *OR
     C                     MOVEL'3'       WN0031           MPR Destination
     C                     ELSE
      * CASE: *OTHERWISE
      * If Dest is foreign, but address is CANada, treat as Canada-> NAFT
      * RTV Val Canada state  RT - MPR FOB Omaha Rate Table  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL'CAN'     WL0046    P      MPR Country
     C                     MOVELYL0052    WL0047    P      MPR State Code
     C                     MOVELYL0068    WL0048    P      Record Found US
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0048    YL0068    P      Record Found US
      * Thru Canada to someplace else
      * CASE: LCL.Record Found USR is Record Found
     C           YL0068    IFEQ 'Y'                        *IF
     C                     MOVEL'3'       WN0031           MPR Destination
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'2'       WN0031           MPR Destination
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVELWLKXCD    YL0069           MPR Country
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'1'       WN0031           MPR Destination
     C                     MOVEL*BLANK    YL0069           MPR Country
     C                     MOVEL'USA'     YL0069           MPR Country
     C                     END                             *FI
     C                     MOVEL'1'       WN0032           MPR Sales Type
      * new 6/28/13  -- changed 12/5/13 E2910 -- 2/6/15 add HDG here,2/12
      * CASE:
      *  - c1ORc2ORc3
      *   |- c1    : DB1.OD Price Type is Formula
      *   |- c2    : DB1.OD Price Type is Hedged
      *   |- c3    : DB1.OD Price Type is No Higher Than
      *   '-
     C           WLF7SX    IFEQ 'FRM'                      *IF
     C           WLF7SX    OREQ 'HDG'                      *OR
     C           WLF7SX    OREQ 'NHT'                      *OR
      * LCL.Days = LCL.Requested Delivery Date - DB1.Scheduled Ship Date
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C           WLAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           YL0058    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     YL0070
     C                     ELSE
     C           XDURR     MULT -1        YL0070
     C                     END
     C                     Z-ADDWLCXDT    WN0054           MPR OD Entry_Fi
     C                     ELSE
      * CASE: *OTHERWISE
      * Use OD Entry date instead - so when items are added it will be mo
      * CASE: DB1.Date of Original Entry is Entered
     C           WLCXDT    IFNE 0                          *IF
      * CASE: DB1.Date of Original Entry GT LCL.Order Date
     C           WLCXDT    IFGT YL0054                     *IF
      * LCL.Days = LCL.Requested Delivery Date - DB1.Date of Original Ent
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C           WLCXDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           YL0058    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     YL0070
     C                     ELSE
     C           XDURR     MULT -1        YL0070
     C                     END
     C                     Z-ADDWLCXDT    WN0054           MPR OD Entry_Fi
     C                     ELSE
      * CASE: *OTHERWISE
      * LCL.Days = LCL.Requested Delivery Date - LCL.Order Date *DAYS
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C           YL0054    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           YL0058    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     YL0070
     C                     ELSE
     C           XDURR     MULT -1        YL0070
     C                     END
     C                     Z-ADDYL0054    WN0054           MPR OD Entry_Fi
     C                     END                             *FI
      * CASE: LCL.Days is LT 0
     C           YL0070    IFLT 0                          *IF
     C                     Z-ADD*ZERO     YL0070           Days
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * LCL.Days = LCL.Requested Delivery Date - LCL.Order Date *DAYS
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C           YL0054    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           YL0058    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     YL0070
     C                     ELSE
     C           XDURR     MULT -1        YL0070
     C                     END
     C                     Z-ADDYL0054    WN0054           MPR OD Entry_Fi
     C                     END                             *FI
     C                     END                             *FI
      * Sales Price type
      * CASE:
      *  - c1ORc2ORc3ORc4
      *   |- c1    : DB1.OD Price Type is Negotiated
      *   |- c2    : DB1.OD Price Type is Distressed
      *   |- c3    : DB1.OD Price Type is Tanked
      *   |- c4    : DB1.OD Price Type is Floor
      *   '-
     C           WLF7SX    IFEQ 'NEG'                      *IF
     C           WLF7SX    OREQ 'DST'                      *OR
     C           WLF7SX    OREQ 'TNK'                      *OR
     C           WLF7SX    OREQ 'FLR'                      *OR
      * bx: neg or fwd
      * CASE: DB1.U/M - Ordered is EQ Boxes
     C           WLAGCD    IFEQ 'BX'                       *IF
      * CASE: LCL.Days is LE 14
     C           YL0070    IFLE 14                         *IF
     C                     MOVEL'1'       WN0032           MPR Sales Type
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'2'       WN0032           MPR Sales Type
     C                     END                             *FI
     C                     END                             *FI
      * cb: neg or fwd
      * CASE: DB1.U/M - Ordered is Combos
     C           WLAGCD    IFEQ 'CB'                       *IF
      * CASE: LCL.Days is LE 10
     C           YL0070    IFLE 10                         *IF
     C                     MOVEL'1'       WN0032           MPR Sales Type
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'2'       WN0032           MPR Sales Type
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE:
      *  - c1ORc2ORc3
      *   |- c1    : DB1.OD Price Type is Formula
      *   |- c2    : DB1.OD Price Type is Hedged
      *   |- c3    : DB1.OD Price Type is No Higher Than
      *   '-
     C           WLF7SX    IFEQ 'FRM'                      *IF
     C           WLF7SX    OREQ 'HDG'                      *OR
     C           WLF7SX    OREQ 'NHT'                      *OR
      * move HDG here from NEG case 2/6/15
      * added new NHT here 02/11/16
      * bx: frm or fwd
      * CASE: DB1.U/M - Ordered is EQ Boxes
     C           WLAGCD    IFEQ 'BX'                       *IF
      * CASE: LCL.Days is LE 14
     C           YL0070    IFLE 14                         *IF
     C                     MOVEL'3'       WN0032           MPR Sales Type
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'2'       WN0032           MPR Sales Type
     C                     END                             *FI
     C                     END                             *FI
      * cb: frm or fwd
      * CASE: DB1.U/M - Ordered is Combos
     C           WLAGCD    IFEQ 'CB'                       *IF
      * CASE: LCL.Days is LE 10
     C           YL0070    IFLE 10                         *IF
     C                     MOVEL'3'       WN0032           MPR Sales Type
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'2'       WN0032           MPR Sales Type
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.OD Price Type is Contract
     C           WLF7SX    IFEQ 'CON'                      *IF
      * bx: neg or fwd
      * CASE: DB1.U/M - Ordered is EQ Boxes
     C           WLAGCD    IFEQ 'BX'                       *IF
      * CASE: LCL.Days is LE 14
     C           YL0070    IFLE 14                         *IF
     C                     MOVEL'1'       WN0032           MPR Sales Type
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'2'       WN0032           MPR Sales Type
     C                     END                             *FI
     C                     END                             *FI
      * cb: neg or fwd
      * CASE: DB1.U/M - Ordered is Combos
     C           WLAGCD    IFEQ 'CB'                       *IF
      * CASE: LCL.Days is LE 10
     C           YL0070    IFLE 10                         *IF
     C                     MOVEL'1'       WN0032           MPR Sales Type
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'2'       WN0032           MPR Sales Type
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Delivery Period -> boxes
      * CASE: DB1.U/M - Ordered is EQ Boxes
     C           WLAGCD    IFEQ 'BX'                       *IF
      * Days
      * CASE: LCL.Days is Between 15 - 60
     C           YL0070    IFGE 15                         *IF
     C           YL0070    ANDLE60
     C                     MOVEL'2'       WN0033           MPR Delivery Pe
     C                     ELSE
      * CASE: LCL.Days is GT 60
     C           YL0070    IFGT 60                         *IF
     C                     MOVEL'3'       WN0033           MPR Delivery Pe
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'1'       WN0033           MPR Delivery Pe
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Delivery Period -> Combos
      * CASE: DB1.U/M - Ordered is Combos
     C           WLAGCD    IFEQ 'CB'                       *IF
      * Days
      * CASE: LCL.Days is Between 11 - 60
     C           YL0070    IFGE 11                         *IF
     C           YL0070    ANDLE60
     C                     MOVEL'5'       WN0033           MPR Delivery Pe
     C                     ELSE
      * CASE: LCL.Days is GT 60
     C           YL0070    IFGT 60                         *IF
     C                     MOVEL'6'       WN0033           MPR Delivery Pe
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'4'       WN0033           MPR Delivery Pe
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * RTV Warehouse Type     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWLAJCD    WL0049    P      Warehouse Code
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0050    YL0071    P      Warehouse Type
      * Refrigeration = frozen vs. fresh  bx/cb
      * CASE: LCL.Warehouse Type is Frozen
     C           YL0071    IFEQ 'FZ'                       *IF
     C                     MOVEL'5'       WN0034           MPR Refrigerati
     C                     ELSE
      * CASE: *OTHERWISE
      * FRESH
      * CASE: DB1.U/M - Ordered is EQ Boxes
     C           WLAGCD    IFEQ 'BX'                       *IF
      * CASE: DB1.Item Age Days is GE 11 Days
     C           WLRINY    IFGT 11                         *IF
     C                     MOVEL'4'       WN0034           MPR Refrigerati
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'3'       WN0034           MPR Refrigerati
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.U/M - Ordered is Combos
     C           WLAGCD    IFEQ 'CB'                       *IF
      * CASE: DB1.Item Age Days is 7 days to 121 days & Over
     C           WLRINY    IFGE 7                          *IF
     C           WLRINY    ANDLE9999
     C                     MOVEL'2'       WN0034           MPR Refrigerati
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'1'       WN0034           MPR Refrigerati
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWLHGCD    WN0030           MPR Item Code
     C                     MOVELWLG7NA    WN0035           MPR Item Descri
      * Product Weight =  ordered
      * CASE: DB1.Weight Ordered is Greater than zero
     C           WLD0WG    IFGT 0                          *IF
     C                     Z-ADDWLD0WG    WN0036           MPR Product Wei
     C                     Z-ADDWLAVQT    YL0072           Quantity Ordere
     C                     END                             *FI
      * Get KNOWN Frt, accruals, commission and take them out of Unit Pri
      * Unit price CWT  for CS and other
      * CASE: DB1.U/M - Base Price is Cases
     C           WLCRCD    IFEQ 'CS'                       *IF
      * CASE: DB1.Unit Weight Ordered U/M is Greater than zero
     C           WLAVWG    IFGT 0                          *IF
      * Comp:Unit prc CWT for CS
      * PAR.MPR Unit Price =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : DB1.Unit Price
      * /     : PGM.*Synon (17,7) work field *
      * x2    : DB1.Unit Weight Ordered U_M
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           WLAKPR    DIV  WLAVWG    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT 100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0043           MPR Unit Price
     C                     ELSE
      * CASE: *OTHERWISE
      * Comp:Unit prc CWT for CS
      * PAR.MPR Unit Price =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : DB1.Unit Price
      * /     : PGM.*Synon (17,7) work field *
      * x2    : LCL.Unit Weight
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           WLAKPR    DIV  YL0065    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT 100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0043           MPR Unit Price
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.U/M - Base Price is Tons
     C           WLCRCD    IFEQ 'TN'                       *IF
     C           WLAKPR    DIV  2000      WUHVPR           Unit Price USR
     C           WUHVPR    MULT 100       WN0043           MPR Unit Price
     C                     ELSE
      * CASE: *OTHERWISE
     C           WLAKPR    MULT 100       WN0043           MPR Unit Price
     C                     END                             *FI
     C                     END                             *FI
      * Exc Get Fob Prc Adjs  XF - MPR Wholesale Pork Daily  * 
     C                     CALL 'PBFYXFR'              90  Exc Get Fob Prc
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WLAIC3    WQ0035  30       Company Number
     C                     PARM WLC4NB    WQ0036  70       Order Number
     C                     PARM WLDPNB    WQ0037  30       Order Sequence
     C                     PARM WLUENB    WQ0038  30       Order Secondary
     C                     PARM WLHGCD    WQ0039  70       Item Code
     C                     PARM WLBKC7    WQ0040  70       Ship To Custome
     C                     PARM WLQ7CD    WQ0041  3        Price Method Co
     C                     PARM WLU1ST    WQ0042  1        Price Status
     C                     PARM YL0072    WQ0043 112       Quantity Shippe
     C                     PARM WN0036    WQ0044 112       Weight Shipped
     C                     PARM WN0041    WQ0045  70       Requested Ship
     C                     PARM WN0040    WQ0046  70       Actual Shipped
     C           WN0045    PARM WN0045    WQ0047  94       MPR Customer Ac
     C           WN0044    PARM WN0044    WQ0048  94       MPR Absorbed Fr
     C           WN0047    PARM WN0047    WQ0049  94       MPR Order Accru
     C                     PARM YL0060    WQ0050  2        Shipping Method
     C           WN0039    PARM WN0039    WQ0051  2        MPR Price Calc
     C           WN0049    PARM WN0049    WQ0052  94       MPR Freight Add
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBFYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Compute: FOB Plant Price
      * PAR.MPR FOB Plant Price/CWT =
      *    *COMPUTE ((x1-x2-x3-x5+x6))
      * x1    : PAR.MPR Unit Price
      * -     : PGM.*Synon (17,7) work field
      * x2    : PAR.MPR Absorbed Frt Rate
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.MPR Customer Accrual Rt
      * -     : PGM.*Synon (17,7) work field
      * x5    : PAR.MPR Order Accrual Rate
      * +     : PGM.*Synon (17,7) work field
      * x6    : PAR.MPR Freight Add On
     C           WN0043    SUB  WN0044    W0WD03           *Synon (17,7) w
     C           W0WD03    SUB  WN0045    W0WD02           *Synon (17,7) w
     C           W0WD02    SUB  WN0047    W0WD01           *Synon (17,7) w
     C           W0WD01    ADD  WN0049    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0037           MPR FOB Plant P
      * Only report if price is > 0, else its not ready yet.
      * CASE: PAR.MPR FOB Plant Price/CWT is GT 0
     C           WN0037    IFGT 0                          *IF
     C                     MOVELYL0052    WN0051           MPR State Code
     C                     MOVELYL0060    WN0050           MPR Shipping Me
      * Exc Calc FOB Omaha Pr XF - MPR Wholesale Pork Daily  * 
     C                     CALL 'PBGTXFR'              90  Exc Calc FOB Om
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WLAIC3    WQ0053  30       Company Number
     C                     PARM WLC4NB    WQ0054  70       Order Number
     C                     PARM YL0053    WQ0055 11        Ship To Zip_Pos
     C                     PARM WN0050    WQ0056  2        Shipping Method
     C           YL0069    PARM YL0069    WQ0057  6        MPR Country
     C                     PARM WLAJCD    WQ0058  3        Warehouse Code
     C           WN0038    PARM WN0038    WQ0059  62       MPR FOB Omaha P
     C                     PARM WN0037    WQ0060  62       MPR FOB Plant P
     C                     PARM WN0043    WQ0061 114       MPR Unit Price
     C           WN0048    PARM WN0048    WQ0062  94       MPR FOB Rate pe
     C           WN0050    PARM WN0050    WQ0063  2        MPR Shipping Me
     C           WN0051    PARM WN0051    WQ0064  2        MPR State Code
     C           WN0052    PARM WN0052    WQ0065  50       MPR Zip Code
     C           WN0053    PARM WN0053    WQ0066  70       MPR FOB Miles t
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBGTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Compute: FOB Omaha Price
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.MPR FOB Omaha Price is eq 0
      *   |- c2    : PAR.MPR Unit Price is GE 1000
      *   '-
     C           WN0038    IFEQ 0                          *IF
     C           WN0043    ORGE 1000                       *OR
      * dont write rcd -- flag Detail as ERROR
      * 11/15/2013 PKD Added condition for PAR.MPR Unit Price. If it is
      *                greater than or equal to $1000/CWT, mark Order
      *                as an error.
     C                     MOVEL'E'       WN0055           OD MPR Sent to
     C                     ELSE
      * CASE: *OTHERWISE
      * Deduct accruals here too
      * Compute: FOB Omaha Price
      * PAR.MPR FOB Omaha Price =
      *    *COMPUTE ((x1-x3-x5))
      * x1    : PAR.MPR FOB Omaha Price
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.MPR Customer Accrual Rt
      * -     : PGM.*Synon (17,7) work field
      * x5    : PAR.MPR Order Accrual Rate
     C           WN0038    SUB  WN0045    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WN0047    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0038           MPR FOB Omaha P
     C                     MOVEL'Y'       WN0055           OD MPR Sent to
     C                     END                             *FI
      * Items added at shipping time ...
      * CASE: DB1.Order Sequence Number is LT 50
     C           WLDPNB    IFLT 50                         *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * if item on the ord and has been sent, resend with diff if >10% or
      * VAL Co/Ord/Item f/mpr RT - Order Detail  * 
     C                     EXSR SORVGN
      * If item was already sent, then send difference if >10% change
      * CASE: LCL.Weight Ordered is Greater than zero
     C           YL0075    IFGT 0                          *IF
     C           WN0036    SUB  YL0075    YL0077           Weight Adjust
     C           YL0075    MULT .10       YL0078           Percent 7.4 USR
      * CASE: LCL.Weight Adjust GT LCL.Percent 7.4 USR
     C           YL0077    IFGT YL0078                     *IF
     C                     Z-ADDYL0077    WN0036           MPR Product Wei
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.OD MPR Sent to USDA Sts is yes
     C           WN0055    IFEQ 'Y'                        *IF
      * Create or Update Rcd (if item is on the order twice)
      * Rtv Crt/Chg MPR Prk   RT - MPR Wholesale Pork Daily  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP2PWAA    WL0051    P      MPR Identificat
     C                     Z-ADDP2UTDT    WL0052           MPR Reporting D
     C                     Z-ADDP2V0NY    WL0053           MPR Reporting T
     C                     MOVELWN0029    WL0054    P      MPR Lot Identif
     C                     Z-ADDWN0030    WL0055           MPR Item Code
     C                     MOVELWN0031    WL0056    P      MPR Destination
     C                     MOVELWN0032    WL0057    P      MPR Sales Type
     C                     MOVELWN0033    WL0058    P      MPR Delivery Pe
     C                     MOVELWN0034    WL0059    P      MPR Refrigerati
     C                     MOVELP2PTST    WL0060    P      MPR Class code
     C                     MOVELP2PUST    WL0061    P      MPR Null
     C                     MOVELP2PVST    WL0062    P      MPR Null 1
     C                     MOVELWN0035    WL0063    P      MPR Item Descri
     C                     Z-ADDWN0036    WL0064           MPR Product Wei
     C                     Z-ADDWN0037    WL0065           MPR FOB Plant P
     C                     Z-ADDWN0038    WL0066           MPR FOB Omaha P
     C                     MOVELP2PXST    WL0067    P      MPR Data Mart P
     C                     MOVELWN0039    WL0068    P      MPR Price Calc
     C                     Z-ADDWN0040    WL0069           MPR Actual Ship
     C                     Z-ADDWN0041    WL0070           MPR Requested S
     C                     Z-ADDWN0042    WL0071           MPR Scheduled S
     C                     Z-ADDWN0043    WL0072           MPR Unit Price
     C                     Z-ADDWN0044    WL0073           MPR Absorbed Fr
     C                     Z-ADDWN0045    WL0074           MPR Customer Ac
     C                     Z-ADDWN0047    WL0075           MPR Order Accru
     C                     Z-ADDWN0048    WL0076           MPR FOB Rate pe
     C                     Z-ADDWN0049    WL0077           MPR Freight Add
     C                     MOVELWN0050    WL0078    P      MPR Shipping Me
     C                     MOVELWN0051    WL0079    P      MPR State Code
     C                     Z-ADDWN0052    WL0080           MPR Zip Code
     C                     Z-ADDWN0053    WL0081           MPR FOB Miles t
     C                     Z-ADDWN0054    WL0082           MPR OD Entry_Fi
     C                     EXSR SJRVGN
     C                     END                             *FI
      * OD: Update MPR sent to USDA Sts to Yes or Error IF Hard run at 9:
      * CASE: PAR.MPR Data Mart Process Sts is Ready for cognos-MPR Rptd
     C           P2PXST    IFEQ 'R'                        *IF
      * Chg MPR USDA Sts      CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0125           Company Number
     C                     Z-ADDWLC4NB    WL0126           Order Number
     C                     Z-ADDWLDPNB    WL0127           Order Sequence
     C                     Z-ADDWLUENB    WL0128           Order Secondary
     C                     MOVELWN0055    WL0129    P      OD MPR Sent to
     C                     EXSR SPCHRC
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.Detail Line Status is Complete
     C           WLGMST    IFEQ 'C'                        *IF
     C                     MOVEL'X'       WN0055           OD MPR Sent to
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * OD: Update with Exclude send to MPR USDA- only if hard run at 9:3
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.OD MPR Sent to USDA Sts is Exclude
      *   |- c2    : PAR.MPR Data Mart Process Sts is Ready for cognos-MP
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0055    IFEQ 'X'                        *IF
     C           P2PXST    IFEQ 'R'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Chg MPR USDA Sts      CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0125           Company Number
     C                     Z-ADDWLC4NB    WL0126           Order Number
     C                     Z-ADDWLDPNB    WL0127           Order Sequence
     C                     Z-ADDWLUENB    WL0128           Order Secondary
     C                     MOVELWN0055    WL0129    P      OD MPR Sent to
     C                     EXSR SPCHRC
     C                     END                             *FI
     C           KRSSM     READE@BGWKON                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv EE Meat Sales flag RT - Customer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WMBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWLBKC7    WMBKC7           Ship To Custome
      * Establish starting position
     C           KRSSN     CHAIN@NEREAT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2880' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0067           Employee_Co_Pac
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWMP2SX    YL0067           Employee_Co_Pac
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * VAL Co/Ord/Item f/mpr RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Template version identifier - Edit to reflect current version.
      * Template version identifier - Edit to reflect current version.
      * Declare restrictor key work fields
     C           *LIKE     DEFN WOAIC3    WQSO01           Company Number
     C           *LIKE     DEFN WOC4NB    WQSO02           Order Number
     C           *LIKE     DEFN WOHGCD    WQSO03           Item Code
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Company Number
     C                     KFLD           WQSO02           Order Number
     C                     KFLD           WQSO03           Item Code
      * Setup key
     C                     Z-ADDWLAIC3    WQSO01           Company Number
     C                     Z-ADDWLC4NB    WQSO02           Order Number
     C                     Z-ADDWLHGCD    WQSO03           Item Code
      * Establish starting position
     C           KRSSO     SETLL@BGWKZL                    *
     C           KRSSO     READE@BGWKZL                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0073           Order Sequence
     C                     Z-ADD*ZERO     YL0074           Order Secondary
     C                     Z-ADD*ZERO     YL0075           Weight Ordered
     C                     Z-ADD*ZERO     YL0076           Weight Shipped
     C                     MOVEL*BLANK    WN0055           OD MPR Sent to
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           WOGMST    IFEQ 'L'                        *IF
     C           WOGMST    OREQ 'A'
     C           WOGMST    OREQ 'C'
     C           WOGMST    OREQ 'R'
     C           WOGMST    OREQ 'E'
     C           WOGMST    OREQ 'H'
     C           WOGMST    OREQ 'I'
      * CASE: DB1.Order Sequence Number NE PAR.Order Sequence Number USR
     C           WODPNB    IFNE WLDPNB                     *IF
      * CASE: DB1.OD MPR Sent to USDA Sts is yes
     C           WOHOST    IFEQ 'Y'                        *IF
     C                     ADD  WOD0WG    YL0075           Weight Ordered
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSO     READE@BGWKZL                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPCHRC    BEGSR
      *================================================================
      * Chg MPR USDA Sts      CH - Order Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0056  70       Item Code
     C                     MOVEL*BLANK    WN0057  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0058  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0059  70       Order Group Cod
     C                     MOVEL*BLANK    WN0060  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0061  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0062 112       Billing Detail
     C                     Z-ADD*ZERO     WN0063 112       Billing Detail
     C                     Z-ADD*ZERO     WN0064 112       Billing Detail
     C                     Z-ADD*ZERO     WN0065 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0066  1        Comment Print A
     C                     MOVEL*BLANK    WN0067  1        Comment Print I
     C                     MOVEL*BLANK    WN0068  1        Comment Print P
     C                     MOVEL*BLANK    WN0069  1        Comment Print S
     C                     Z-ADD*ZERO     WN0070 112       Extended Amount
     C                     Z-ADD*ZERO     WN0071  70       Market Pricing
     C                     MOVEL*BLANK    WN0072  3        Commodity Marke
     C                     MOVEL*BLANK    WN0073  3        Date Method Cod
     C                     MOVEL*BLANK    WN0074  3        Price Method Co
     C                     Z-ADD*ZERO     WN0075 114       Price Overage O
     C                     Z-ADD*ZERO     WN0076  70       Contract Number
     C                     MOVEL*BLANK    WN0077  1        Price Status
     C                     Z-ADD*ZERO     WN0078  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0079  2        U_M_Base Price
     C                     MOVEL*BLANK    WN0080  2        U_M_Ordered
     C                     MOVEL*BLANK    WN0081  1        Work Confirm St
     C                     MOVEL*BLANK    WN0082  1        Work Over_Short
     C                     MOVEL*BLANK    WN0083  1        OD Production P
     C                     MOVEL*BLANK    WN0084 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0085 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0086  1        Age Code
     C                     MOVEL*BLANK    WN0087  1        Palletize
     C                     MOVEL*BLANK    WN0088  1        Slip Sheet
     C                     MOVEL*BLANK    WN0089  1        Catch Weight St
     C                     MOVEL*BLANK    WN0090  1        Price Audit
     C                     MOVEL*BLANK    WN0091  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0092  1        Production Date
     C                     Z-ADD*ZERO     WN0093 112       Rated Freight
     C                     Z-ADD*ZERO     WN0094 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0095 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0096 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0097 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0098 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0099 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0100 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0101 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0102 114       Unit Price
     C                     Z-ADD*ZERO     WN0103 114       Unit Price_Cred
     C                     Z-ADD*ZERO     WN0104 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0105 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0106 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0107  70       Requested Ship
     C                     Z-ADD*ZERO     WN0108  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0109  70       Actual Shipped
     C                     MOVEL*BLANK    WN0110  1        Affect Inventor
     C                     MOVEL*BLANK    WN0111  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0112  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0113  30       Item Structure
     C                     Z-ADD*ZERO     WN0114  30       Item Structure
     C                     Z-ADD*ZERO     WN0115  30       Item Structure
     C                     MOVEL*BLANK    WN0116  2        Item Level
     C                     MOVEL*BLANK    WN0117  2        Quality Level
     C                     MOVEL*BLANK    WN0118  2        Pricing Product
     C                     MOVEL*BLANK    WN0119  2        Season Product
     C                     Z-ADD*ZERO     WN0120  70       Date of Origina
     C                     MOVEL*BLANK    WN0121 10        User Profile Na
     C                     MOVEL*BLANK    WN0122  6        Country Code
     C                     MOVEL*BLANK    WN0123  2        Event Code
     C                     MOVEL*BLANK    WN0124  3        Reason Code
     C                     MOVEL*BLANK    WN0125  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0126  1        Modified Flag
     C                     MOVEL*BLANK    WN0127  1        Substituted Fla
     C                     MOVEL*BLANK    WN0128  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0129 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0130 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0131  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0132  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0133  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0134  1        Affect Commissi
     C                     MOVEL*BLANK    WN0135  1        Affect Pricing
     C                     MOVEL*BLANK    WN0136  1        Released by Use
     C                     MOVEL*BLANK    WN0137  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0138  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0139  3        Production Ware
     C                     MOVEL*BLANK    WN0140  3        OD Price Type
     C                     Z-ADD*ZERO     WN0141  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0142  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0143  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0144  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0145  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0146  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0147  60       Price Code
     C                     Z-ADD*ZERO     WN0148  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0149  60       Substitution Li
     C                     Z-ADD*ZERO     WN0150  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0151 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0152 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0153 112       OD Item Target
     C                     Z-ADD*ZERO     WN0154 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0155 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0156 114       Order Gate_Fina
     C                     Z-ADD*ZERO     WN0157 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0158 114       OD Gate_Final P
     C                     Z-ADD*ZERO     WN0159 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0160 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0161 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0162 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0163 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0164  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0165  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0166 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0167  40       Item Age Days
     C                     Z-ADD*ZERO     WN0168  70       Production Ovr
     C                     Z-ADD*ZERO     WN0169  70       Production Ovr
     C                     MOVEL*BLANK    WN0170  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0171  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0172  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0173  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0174  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0175  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0176  1        EDI Status 1
     C                     MOVEL*BLANK    WN0177  1        EDI Status 2
     C                     MOVEL*BLANK    WN0178  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0179  60       Job Time
     C                     MOVEL*BLANK    WN0180 10        User Id
     C                     MOVEL*BLANK    WN0181 10        Job Name
     C                     Z-ADD*ZERO     WN0182  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWL0125    WRAIC3           Company Number
     C                     Z-ADDWL0126    WRC4NB           Order Number
     C                     Z-ADDWL0127    WRDPNB           Order Sequence
     C                     Z-ADDWL0128    WRUENB           Order Secondary
      *
     C           KLCHSP    KLIST
     C                     KFLD           WRAIC3           Company Number
     C                     KFLD           WRC4NB           Order Number
     C                     KFLD           WRDPNB           Order Sequence
     C                     KFLD           WRUENB           Order Secondary
     C           KLCHSP    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YBRDCS
      * Move non-key fields to @BGWKL0
     C                     MOVELWL0129    WRHOST    P      OD MPR Sent to
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WRAATM           Job Time
     C                     MOVEL##USR     WRAYNA           User Id
     C                     MOVEL##JOB     WRA0NA           Job Name
     C                     Z-ADD##JDT     WRAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDUDY     BEGSR
      *================================================================
      * Calculate duration, *DAYS
      *================================================================
     C           XDAY1     IFLT 1
     C           XDAY2     ORLT 1
     C                     Z-ADD0         XDURR
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     GOTO XDUDYE
     C                     END
     C           XDAY1     IFGE XDAY2
      * From date2 to date1
     C                     Z-ADDXDAY2     XABEG   60
     C                     Z-ADDXDAY1     XAEND   60
     C                     ELSE
      * From date1 to date2
     C                     Z-ADDXDAY1     XABEG   60
     C                     Z-ADDXDAY2     XAEND   60
     C                     END
     C           XDWSL     IFEQ 0
      * None days of week selected
     C                     Z-ADD0         XDURR
     C                     GOTO XDUDYC
     C                     END
     C           XAEND     SUB  XABEG     XDURR   80
     C           XDWSL     IFEQ 7
      * All days of week selected
     C                     GOTO XDUDYC
     C                     END
      * Some days of week selected
     C                     DIV  7         XDURR
     C                     MVR            XDLSW   10
     C                     MULT XDWSL     XDURR
     C           XDLSW     IFNE 0
      * Determine day of week of the beginning date
     C           XABEG     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
      * Loop: Increment the date by the last week
     C           XDLSW     DOWGT0
      * Increment the day of week
     C                     ADD  1         YY
     C                     SUB  1         XDLSW
      * Put day of week into the range 1-7
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     END
      * Selected day of the last week has been processed
     C           YDOW,YY   IFEQ XDSEL
      * Increment duration
     C                     ADD  1         XDURR
     C                     END
      * End of loop
     C                     END
     C                     END
     C           XDUDYC    TAG
     C           XDURR     IFEQ 0
      * Return Code: Unable to calculate duration
     C                     MOVEL'Y2U0060' W0RTN   7
     C                     ELSE
     C                     MOVEL*BLANK    W0RTN   7
     C                     END
      *================================================================
     CSR         XDUDYE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      * Clear all neither parameters
     C                     MOVEL*BLANK    P2ZBT1           MPR Lot Identif
     C                     MOVEL*BLANK    P2PTST           MPR Class code
     C                     MOVEL*BLANK    P2PUST           MPR Null
     C                     MOVEL*BLANK    P2PVST           MPR Null 1
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P3K4DT           Created Date
     C                     Z-ADD*ZERO     P3A1TM           Created Time
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAM8NB           System Value Nu
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBK4DT           Created Date
     C                     Z-ADD*ZERO     WBA1TM           Created Time
     C                     Z-ADD*ZERO     WBDXNB           Sequence Number
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBRVNB           Stop_Drop
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCDPNB           Order Sequence
     C                     Z-ADD*ZERO     WCUENB           Order Secondary
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WCMAVA           Billing Detail
     C                     Z-ADD*ZERO     WCKDVA           Billing Detail
     C                     Z-ADD*ZERO     WCL8VA           Billing Detail
     C                     Z-ADD*ZERO     WCL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WCAYVA           Extended Amount
     C                     Z-ADD*ZERO     WCEXDT           Market Pricing
     C                     Z-ADD*ZERO     WCBZPR           Price Overage O
     C                     Z-ADD*ZERO     WCL6NB           Contract Number
     C                     Z-ADD*ZERO     WCGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WCD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WCCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WCAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WCCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WCATWG           Weight Shipped
     C                     Z-ADD*ZERO     WCAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WCAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WCAKPR           Unit Price
     C                     Z-ADD*ZERO     WCALPR           Unit Price_Cred
     C                     Z-ADD*ZERO     WCAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WCAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WCA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WCA5DT           Requested Ship
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WCRGNB           Item Structure
     C                     Z-ADD*ZERO     WCRHNB           Item Structure
     C                     Z-ADD*ZERO     WCRINB           Item Structure
     C                     Z-ADD*ZERO     WCCXDT           Date of Origina
     C                     Z-ADD*ZERO     WCDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WCB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WCA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WCNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WCNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WCNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WCNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WCNXDT           OD Firm Date
     C                     Z-ADD*ZERO     WCBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WCBVTM           Price Code
     C                     Z-ADD*ZERO     WCBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WCBXTM           Substitution Li
     C                     Z-ADD*ZERO     WCBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WCH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WCH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WCH7NX           OD Item Target
     C                     Z-ADD*ZERO     WCH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WCH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WCDVPR           Order Gate_Fina
     C                     Z-ADD*ZERO     WCDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WCDXPR           OD Gate_Final P
     C                     Z-ADD*ZERO     WCDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WCDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WCGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WCGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WCGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WCPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WCRINY           Item Age Days
     C                     Z-ADD*ZERO     WCTIDT           Production Ovr
     C                     Z-ADD*ZERO     WCTJDT           Production Ovr
     C                     Z-ADD*ZERO     WCTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WCTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WCTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDANC7           AR Customer Num
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WDA0DT           Order Date
     C                     Z-ADD*ZERO     WDA5DT           Requested Ship
     C                     Z-ADD*ZERO     WDGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WDACDT           Cancel Date
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDCXDT           Date of Origina
     C                     Z-ADD*ZERO     WDJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WDA1WG           Order Weight To
     C                     Z-ADD*ZERO     WDEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WDAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WDATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WDRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WDT3NB           Attach to Order
     C                     Z-ADD*ZERO     WDCONB           Invoice Number
     C                     Z-ADD*ZERO     WDAWDT           Invoice Date
     C                     Z-ADD*ZERO     WDVRVA           A_R order Value
     C                     Z-ADD*ZERO     WDB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WDNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WDNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WDNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WDNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WDNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WDBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WDBQTM           Time of Origina
     C                     Z-ADD*ZERO     WDBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WDBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WDBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WDH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WDH1NX           Act Non_Ref Frt
     C                     Z-ADD*ZERO     WDH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WDH3NX           OH Total Non_Re
     C                     Z-ADD*ZERO     WDH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WDC0C7           Claim Number
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WER5NB           Deliver after t
     C                     Z-ADD*ZERO     WER6NB           Deliver before
     C                     Z-ADD*ZERO     WETBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WEMTCU           Mileage To Cust
     C                     Z-ADD*ZERO     WEW2NB           Co_Cust Overage
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFHGCD           Item Code
     C                     Z-ADD*ZERO     WFOQNY           CIE Unused Numb
     C                     Z-ADD*ZERO     WFORNY           CIE Unused Numb
     C                     Z-ADD*ZERO     WFS2DT           CIE Unused Date
     C                     Z-ADD*ZERO     WFMJDT           Create Date
     C                     Z-ADD*ZERO     WFBETM           Create Time
     C                     Z-ADD*ZERO     WFMKDT           Change Date
     C                     Z-ADD*ZERO     WFBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGHGCD           Item Code
     C                     Z-ADD*ZERO     WGAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WGAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WGAIWG           Unit Weight
     C                     Z-ADD*ZERO     WGCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WGC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WGURTN           Number Cases On
     C                     Z-ADD*ZERO     WGAJC8           Vendor Item Def
     C                     Z-ADD*ZERO     WGRINB           Item Structure
     C                     Z-ADD*ZERO     WGRHNB           Item Structure
     C                     Z-ADD*ZERO     WGRGNB           Item Structure
     C                     Z-ADD*ZERO     WGTFNB           Transportation
     C                     Z-ADD*ZERO     WGTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WGTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WGBLPR           Market Overage
     C                     Z-ADD*ZERO     WGBMPR           Standard Overag
     C                     Z-ADD*ZERO     WGCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WGCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WGSWGH           Std Weight_Head
     C                     Z-ADD*ZERO     WGPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WGICN1           Item Category N
     C                     Z-ADD*ZERO     WGICN2           Item Category N
     C                     Z-ADD*ZERO     WGV2NB           Item Category N
     C                     Z-ADD*ZERO     WGITCN           Item Category N
     C                     Z-ADD*ZERO     WGITC5           Item Category N
     C                     Z-ADD*ZERO     WGICN6           Item Category N
     C                     Z-ADD*ZERO     WGICN7           Item Category N
     C                     Z-ADD*ZERO     WGICN8           Item Category N
     C                     Z-ADD*ZERO     WGICN9           Item Category N
     C                     Z-ADD*ZERO     WGICN0           Item Category N
     C                     Z-ADD*ZERO     WGSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WGA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WGSJNB           Production Lead
     C                     Z-ADD*ZERO     WGSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WGSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WGSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WGCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WGCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WGILNB           Packages per ca
     C                     Z-ADD*ZERO     WGCHNB           Use_Freeze_Sell
     C                     Z-ADD*ZERO     WGCINB           PM Batch Size
     C                     Z-ADD*ZERO     WGCJNB           Package Level s
     C                     Z-ADD*ZERO     WGCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WGCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WGCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WGCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WGCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WGCWNB           PM Std LBS Man
     C                     Z-ADD*ZERO     WGCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WGCZNB           PM Formula LBS
     C                     Z-ADD*ZERO     WGC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WGB4NB           PM Raw Material
     C                     Z-ADD*ZERO     WGB5NB           PM Line Number
     C                     Z-ADD*ZERO     WGBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WGBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WGF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WGF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WGF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WGBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WGBNNB           Production Qty
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHW5NY           MPR Region
     C                     Z-ADD*ZERO     WHW6NY           MPR Zip Code
     C                     Z-ADD*ZERO     WHHSPR           MPR FOB Rate pe
     C                     Z-ADD*ZERO     WHW7NY           MPR FOB Miles t
     C                     Z-ADD*ZERO     WHU2DT           MPR FOB Unused
     C                     Z-ADD*ZERO     WHMJDT           Create Date
     C                     Z-ADD*ZERO     WHBETM           Create Time
     C                     Z-ADD*ZERO     WHMKDT           Change Date
     C                     Z-ADD*ZERO     WHBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WIBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WIBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WIBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WIBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Define work field Unit Price USR 11.6
     C                     Z-ADD*ZERO     WUHVPR 116
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJUTDT           MPR Reporting D
     C                     Z-ADD*ZERO     WJV0NY           MPR Reporting T
     C                     Z-ADD*ZERO     WJFRC7           MPR Item Code
     C                     Z-ADD*ZERO     WJPNWG           MPR Product Wei
     C                     Z-ADD*ZERO     WJHMPR           MPR FOB Plant P
     C                     Z-ADD*ZERO     WJHNPR           MPR FOB Omaha P
     C                     Z-ADD*ZERO     WJUZDT           MPR Actual Ship
     C                     Z-ADD*ZERO     WJU1DT           MPR Requested S
     C                     Z-ADD*ZERO     WJU0DT           MPR Scheduled S
     C                     Z-ADD*ZERO     WJHOPR           MPR Unit Price
     C                     Z-ADD*ZERO     WJW4NY           MPR Absorbed Fr
     C                     Z-ADD*ZERO     WJWZNY           MPR Customer Ac
     C                     Z-ADD*ZERO     WJW0NY           MPR Unused Rate
     C                     Z-ADD*ZERO     WJW1NY           MPR Order Accru
     C                     Z-ADD*ZERO     WJHSPR           MPR FOB Rate pe
     C                     Z-ADD*ZERO     WJW3NY           MPR Freight Add
     C                     Z-ADD*ZERO     WJW6NY           MPR Zip Code
     C                     Z-ADD*ZERO     WJW7NY           MPR FOB Miles t
     C                     Z-ADD*ZERO     WJUYDT           MPR OD Entry_Fi
     C                     Z-ADD*ZERO     WJMJDT           Create Date
     C                     Z-ADD*ZERO     WJBETM           Create Time
     C                     Z-ADD*ZERO     WJMKDT           Change Date
     C                     Z-ADD*ZERO     WJBFTM           Change Time
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WMAAC8           Customer G_L Ve
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD03 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL@CN,1     @CN,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     Z-ADD*ZERO     WL0003  30
     C                     Z-ADD*ZERO     WL0004  30
     C                     Z-ADD*ZERO     WL0005  70
     C                     MOVEL*BLANK    WL0006  3
     C                     MOVEL*BLANK    WL0007  3
     C                     MOVEL*BLANK    WL0008  1
     C                     MOVEL*BLANK    WL0009  2
     C                     MOVEL*BLANK    WL0010  2
     C                     MOVEL*BLANK    WL0011 30
     C                     Z-ADD*ZERO     WL0012 114
     C                     Z-ADD*ZERO     WL0013 112
     C                     Z-ADD*ZERO     WL0014  70
     C                     MOVEL*BLANK    WL0015  6
     C                     MOVEL*BLANK    WL0016  3
     C                     MOVEL*BLANK    WL0017  1
     C                     Z-ADD*ZERO     WL0018  40
      * Define local variables for subroutine SDRVGN.
     C                     Z-ADD*ZERO     WL0019  30
     C                     Z-ADD*ZERO     WL0020  70
     C                     MOVEL*BLANK    WL0021  2
     C                     Z-ADD*ZERO     WL0022  70
     C                     Z-ADD*ZERO     WL0023  70
     C                     MOVEL*BLANK    WL0024  2
     C                     MOVEL*BLANK    WL0025 11
     C                     Z-ADD*ZERO     WL0026  70
     C                     Z-ADD*ZERO     WL0027  70
     C                     Z-ADD*ZERO     WL0028  70
     C                     MOVEL*BLANK    WL0029  1
     C                     Z-ADD*ZERO     WL0030  70
     C                     Z-ADD*ZERO     WL0031  70
     C                     Z-ADD*ZERO     WL0032 112
     C                     Z-ADD*ZERO     WL0033  70
     C                     MOVEL*BLANK    WL0034  1
     C                     MOVEL*BLANK    WL0035  2
     C                     MOVEL*BLANK    WL0036  1
     C                     MOVEL*BLANK    WL0037  1
     C                     MOVEL*BLANK    WL0038  2
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0039  30
     C                     Z-ADD*ZERO     WL0040  70
     C                     MOVEL*BLANK    WL0041  2
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0042  30
     C                     Z-ADD*ZERO     WL0043  70
     C                     Z-ADD*ZERO     WL0044 112
     C                     MOVEL*BLANK    WL0045  2
      * Define local variables for subroutine SHRVGN.
     C                     MOVEL*BLANK    WL0046  6
     C                     MOVEL*BLANK    WL0047  2
     C                     MOVEL*BLANK    WL0048  1
      * Define local variables for subroutine SIRVGN.
     C                     MOVEL*BLANK    WL0049  3
     C                     MOVEL*BLANK    WL0050  2
      * Define local variables for subroutine SJRVGN.
     C                     MOVEL*BLANK    WL0051  5
     C                     Z-ADD*ZERO     WL0052  70
     C                     Z-ADD*ZERO     WL0053  10
     C                     MOVEL*BLANK    WL0054 25
     C                     Z-ADD*ZERO     WL0055  70
     C                     MOVEL*BLANK    WL0056  1
     C                     MOVEL*BLANK    WL0057  1
     C                     MOVEL*BLANK    WL0058  1
     C                     MOVEL*BLANK    WL0059  1
     C                     MOVEL*BLANK    WL0060  1
     C                     MOVEL*BLANK    WL0061 10
     C                     MOVEL*BLANK    WL0062 10
     C                     MOVEL*BLANK    WL0063 30
     C                     Z-ADD*ZERO     WL0064  70
     C                     Z-ADD*ZERO     WL0065  62
     C                     Z-ADD*ZERO     WL0066  62
     C                     MOVEL*BLANK    WL0067  1
     C                     MOVEL*BLANK    WL0068  2
     C                     Z-ADD*ZERO     WL0069  70
     C                     Z-ADD*ZERO     WL0070  70
     C                     Z-ADD*ZERO     WL0071  70
     C                     Z-ADD*ZERO     WL0072 114
     C                     Z-ADD*ZERO     WL0073  94
     C                     Z-ADD*ZERO     WL0074  94
     C                     Z-ADD*ZERO     WL0075  94
     C                     Z-ADD*ZERO     WL0076  94
     C                     Z-ADD*ZERO     WL0077  94
     C                     MOVEL*BLANK    WL0078  2
     C                     MOVEL*BLANK    WL0079  2
     C                     Z-ADD*ZERO     WL0080  50
     C                     Z-ADD*ZERO     WL0081  70
     C                     Z-ADD*ZERO     WL0082  70
      * Define local variables for subroutine SKCRRC.
     C                     MOVEL*BLANK    WL0083  5
     C                     Z-ADD*ZERO     WL0084  70
     C                     Z-ADD*ZERO     WL0085  10
     C                     MOVEL*BLANK    WL0086 25
     C                     Z-ADD*ZERO     WL0087  70
     C                     MOVEL*BLANK    WL0088  1
     C                     MOVEL*BLANK    WL0089  1
     C                     MOVEL*BLANK    WL0090  1
     C                     MOVEL*BLANK    WL0091  1
     C                     MOVEL*BLANK    WL0092  1
     C                     MOVEL*BLANK    WL0093 10
     C                     MOVEL*BLANK    WL0094 10
     C                     MOVEL*BLANK    WL0095 30
     C                     Z-ADD*ZERO     WL0096  70
     C                     Z-ADD*ZERO     WL0097  62
     C                     Z-ADD*ZERO     WL0098  62
     C                     MOVEL*BLANK    WL0099  1
     C                     MOVEL*BLANK    WL0100  2
     C                     Z-ADD*ZERO     WL0101  70
     C                     Z-ADD*ZERO     WL0102  70
     C                     Z-ADD*ZERO     WL0103  70
     C                     Z-ADD*ZERO     WL0104 114
     C                     Z-ADD*ZERO     WL0105  94
     C                     Z-ADD*ZERO     WL0106  94
     C                     Z-ADD*ZERO     WL0107  94
     C                     Z-ADD*ZERO     WL0108  94
     C                     Z-ADD*ZERO     WL0109  94
     C                     Z-ADD*ZERO     WL0110  94
     C                     MOVEL*BLANK    WL0111  2
     C                     MOVEL*BLANK    WL0112  2
     C                     Z-ADD*ZERO     WL0113  50
     C                     Z-ADD*ZERO     WL0114  70
     C                     Z-ADD*ZERO     WL0115  70
     C                     MOVEL*BLANK    WL0116  1
     C                     Z-ADD*ZERO     WL0117  70
     C                     Z-ADD*ZERO     WL0118  60
     C                     MOVEL*BLANK    WL0119 10
     C                     MOVEL*BLANK    WL0120 10
     C                     Z-ADD*ZERO     WL0121  70
     C                     Z-ADD*ZERO     WL0122  60
     C                     MOVEL*BLANK    WL0123 10
     C                     MOVEL*BLANK    WL0124 10
      * Define local variables for subroutine SPCHRC.
     C                     Z-ADD*ZERO     WL0125  30
     C                     Z-ADD*ZERO     WL0126  70
     C                     Z-ADD*ZERO     WL0127  30
     C                     Z-ADD*ZERO     WL0128  30
     C                     MOVEL*BLANK    WL0129  1
      * Define local work field Current System Date
     C                     Z-ADD*ZERO     YL0001 155
      * Define local work field Current System Time
     C                     Z-ADD*ZERO     YL0002 155
      * Define local work field USR Text 7            USR
     C                     MOVEL*BLANK    YL0003  7
      * Define local work field Text 3 Length USR
     C                     MOVEL*BLANK    YL0004  3
      * Define local work field Order Sequence Number
     C                     Z-ADD*ZERO     YL0005  30
      * Define local work field Item Code
     C                     Z-ADD*ZERO     YL0006  70
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0007  3
      * Define local work field Price Method Code
     C                     MOVEL*BLANK    YL0008  3
      * Define local work field Price Status
     C                     MOVEL*BLANK    YL0009  1
      * Define local work field U_M_Base Price
     C                     MOVEL*BLANK    YL0010  2
      * Define local work field U_M_Ordered
     C                     MOVEL*BLANK    YL0011  2
      * Define local work field Order Desc_Line One
     C                     MOVEL*BLANK    YL0012 30
      * Define local work field Unit Price
     C                     Z-ADD*ZERO     YL0013 114
      * Define local work field Unit Weight Ordered U_M
     C                     Z-ADD*ZERO     YL0014 112
      * Define local work field Date of Original Entry
     C                     Z-ADD*ZERO     YL0015  70
      * Define local work field Country Code
     C                     MOVEL*BLANK    YL0016  6
      * Define local work field OD Price Type
     C                     MOVEL*BLANK    YL0017  3
      * Define local work field OD MPR Sent to USDA Sts
     C                     MOVEL*BLANK    YL0018  1
      * Define local work field Item Age Days
     C                     Z-ADD*ZERO     YL0019  40
      * Define local work field Order Type_Sales
     C                     MOVEL*BLANK    YL0020  2
      * Define local work field AR Customer Number
     C                     Z-ADD*ZERO     YL0021  70
      * Define local work field Ship To Customer
     C                     Z-ADD*ZERO     YL0022  70
      * Define local work field Ship To State Code
     C                     MOVEL*BLANK    YL0023  2
      * Define local work field Ship To Zip_Postal Code
     C                     MOVEL*BLANK    YL0024 11
      * Define local work field Order Date
     C                     Z-ADD*ZERO     YL0025  70
      * Define local work field Header Status
     C                     MOVEL*BLANK    YL0026  1
      * Define null work field Date of Original Entry
     C                     Z-ADD*ZERO     YN0001  70
      * Define local work field Order Weight Total
     C                     Z-ADD*ZERO     YL0027 112
      * Define local work field Requested Delivery Date
     C                     Z-ADD*ZERO     YL0028  70
      * Define local work field Shipping Method
     C                     MOVEL*BLANK    YL0029  2
      * Define local work field Export Status
     C                     MOVEL*BLANK    YL0030  1
      * Define local work field Block Order Flag
     C                     MOVEL*BLANK    YL0031  1
      * Define local work field Type Code
     C                     MOVEL*BLANK    YL0032  2
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0033  30
      * Define local work field CIE MPR Report to USDA
     C                     MOVEL*BLANK    YL0034  2
      * Define local work field Unit Weight
     C                     Z-ADD*ZERO     YL0035 112
      * Define local work field Quality Level
     C                     MOVEL*BLANK    YL0036  2
      * Define local work field Text USR 7
     C                     MOVEL*BLANK    YL0037  7
      * Define local work field Weight Beg Inv usr
     C                     Z-ADD*ZERO     YL0038  70
      * Define local work field Weight End Inv usr
     C                     Z-ADD*ZERO     YL0039  70
      * Define local work field Weight Gain Usr
     C                     Z-ADD*ZERO     YL0040  70
      * Define local work field Weight Open  7.0      USR
     C                     Z-ADD*ZERO     YL0041  70
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0042  1
      * Define local work field MPR Country
     C                     MOVEL*BLANK    YL0043  6
      * Define local work field Days
     C                     Z-ADD*ZERO     YL0044  50
      * Define local work field Warehouse Type
     C                     MOVEL*BLANK    YL0045  2
      * Define local work field Order Secondary Line Seq
     C                     Z-ADD*ZERO     YL0046  30
      * Define local work field Quantity Ordered
     C                     Z-ADD*ZERO     YL0047 112
      * Define local work field MPR Product Weight
     C                     Z-ADD*ZERO     YL0048  70
      * Define local work field Order Type_Sales
     C                     MOVEL*BLANK    YL0049  2
      * Define local work field AR Customer Number
     C                     Z-ADD*ZERO     YL0050  70
      * Define local work field Ship To Customer
     C                     Z-ADD*ZERO     YL0051  70
      * Define local work field Ship To State Code
     C                     MOVEL*BLANK    YL0052  2
      * Define local work field Ship To Zip_Postal Code
     C                     MOVEL*BLANK    YL0053 11
      * Define local work field Order Date
     C                     Z-ADD*ZERO     YL0054  70
      * Define local work field Header Status
     C                     MOVEL*BLANK    YL0055  1
      * Define local work field Date of Original Entry
     C                     Z-ADD*ZERO     YL0056  70
      * Define local work field Order Weight Total
     C                     Z-ADD*ZERO     YL0057 112
      * Define local work field Requested Delivery Date
     C                     Z-ADD*ZERO     YL0058  70
      * Define local work field Price Status
     C                     MOVEL*BLANK    YL0059  1
      * Define local work field Shipping Method
     C                     MOVEL*BLANK    YL0060  2
      * Define local work field Export Status
     C                     MOVEL*BLANK    YL0061  1
      * Define local work field Block Order Flag
     C                     MOVEL*BLANK    YL0062  1
      * Define local work field Type Code
     C                     MOVEL*BLANK    YL0063  2
      * Define local work field CIE MPR Report to USDA
     C                     MOVEL*BLANK    YL0064  2
      * Define local work field Unit Weight
     C                     Z-ADD*ZERO     YL0065 112
      * Define local work field Quality Level
     C                     MOVEL*BLANK    YL0066  2
      * Define local work field Employee_Co_Packer Sale
     C                     MOVEL*BLANK    YL0067  1
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0068  1
      * Define local work field MPR Country
     C                     MOVEL*BLANK    YL0069  6
      * Define local work field Days
     C                     Z-ADD*ZERO     YL0070  50
      * Define local work field Warehouse Type
     C                     MOVEL*BLANK    YL0071  2
      * Define local work field Quantity Ordered
     C                     Z-ADD*ZERO     YL0072 112
      * Define local work field Order Sequence Number
     C                     Z-ADD*ZERO     YL0073  30
      * Define local work field Order Secondary Line Seq
     C                     Z-ADD*ZERO     YL0074  30
      * Define local work field Weight Ordered
     C                     Z-ADD*ZERO     YL0075 112
      * Define local work field Weight Shipped Total
     C                     Z-ADD*ZERO     YL0076 112
      * Define local work field Weight Adjust
     C                     Z-ADD*ZERO     YL0077  70
      * Define local work field Percent 7.4 USR
     C                     Z-ADD*ZERO     YL0078  74
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 ORDWGT
00002 0000000
