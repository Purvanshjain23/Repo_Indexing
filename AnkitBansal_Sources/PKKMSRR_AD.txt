// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PKKMSRR
// ?Date: 14.08.2025 Time: 02:49:47
// ?------------------------------------------------------------------------------------------------

//?USER: Initialize program

//?Modification history
DO;

//? 7/01/2019 JBB E15190 - Display all active or all inactive records
ENDDO;

// PGM.*Scan limit = CND.No Max
PGM.*Scan_limit = 999999;

EXECUTE FUNCTION(Rtv Producer Name     RT) TYPE(RTVOBJ) FILE(PKACREP)           AB1101542;
PARAMETER(CTL.PD_Producer_Code);
PARAMETER(CTL.PD_Name);
{
 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


//?Default screen to Active records only
// PAR.RS Record Status = CND.Active
PAR.RS_Record_Status = 'A';

//?USER: Load subfile record from DBF record

//?Load Record Status text
CASE;

// IF PAR.RS Record Status is Active
IF PAR.RS_Record_Status = 'A';

// CTL.Text 8 USR = CON.Active
CTL.Text_8_USR = 'Active';

//?Load Record Status text
// IF *OTHERWISE
IF *OTHERWISE;

// CTL.Text 8 USR = CON.Inactive
CTL.Text_8_USR = 'Inactive';

ENDIF;

//?Initially do not select the record
// PGM.*Record selected = CND.*NO
PGM.*Record_selected = 'N';

EXECUTE FUNCTION(Rtv Producer Status   RT) TYPE(RTVOBJ) FILE(PKACREP)           AB1352227;
PARAMETER(RCD.PD_Producer_Code);
PARAMETER(RCD.RS_Record_Status_Prd_Site);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


//?Record selection
CASE;

// IF PAR.RS Record Status is Active
IF PAR.RS_Record_Status = 'A';

// AND RCD.RS Record Status is Active
AND RCD.RS_Record_Status = 'A';

// AND RCD.RS Record Status Prd Site is Active
AND RCD.RS_Record_Status_Prd_Site = 'A';

// PGM.*Record selected = CND.*YES
PGM.*Record_selected = 'Y';

//?Record selection
// IF PAR.RS Record Status is InActive
IF PAR.RS_Record_Status = 'I';

// AND RCD.RS Record Status is InActive
AND ( RCD.RS_Record_Status = 'I';

// OR RCD.RS Record Status Prd Site is InActive
OR RCD.RS_Record_Status_Prd_Site = 'I' );

// PGM.*Record selected = CND.*YES
PGM.*Record_selected = 'Y';

ENDIF;

//?USER: Process command keys

//?F10 = Toggle Active/Inactive
CASE;

// IF CTL.*CMD key is CF10
IF CTL.*CMD_key = '10';

//?Change status
CASE;

// IF PAR.RS Record Status is Active
IF PAR.RS_Record_Status = 'A';

// PAR.RS Record Status = CND.InActive
PAR.RS_Record_Status = 'I';

//?Change status
// IF PAR.RS Record Status is InActive
IF PAR.RS_Record_Status = 'I';

// PAR.RS Record Status = CND.Active
PAR.RS_Record_Status = 'A';

ENDIF;

// PGM.*Reload subfile = CND.*YES
PGM.*Reload_subfile = 'Y';

ENDIF;

