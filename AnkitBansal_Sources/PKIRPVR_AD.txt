// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PKIRPVR
// ?Date: 14.08.2025 Time: 02:51:50
// ?------------------------------------------------------------------------------------------------

//?USER: Initialize program

//?RMC 03/20/07 chg time edtcdes from T to 4
//?H16853 ISE 01/23/21 - Increased the length from 5 to 7 and corrected the
//?                      alignment of Buy Order Number field.
EXECUTE FUNCTION(HPE086 Live Scale Interf) TYPE(EXCINTFUN)                      AB1194880;
{
 //?Execute internal function

 //?03/31/97  SLM  LIVE SCALE INTERFACE Using the AS/400
 //?               replace all of the pc get weight routines
}


// Execute function Mov ApplN to Company  US.
EXECUTE FUNCTION(Mov ApplN to Company  US) TYPE(EXCUSRSRC) ('PKMFUFR');
PARAMETER(PAR.Oms_System_Value_Alpha);
{
 C***   MOVE USER SOURCE                      ***
 C                     MOVEL#IEVTX    ##CMP
}


//?USER: Load screen

// DTL.HC Class Type Desc Usr = Condition name of PAR.TH Hog Class Type
DTL.HC_Class_Type_Desc_Usr = RTVCND(PAR.TH_Hog_Class_Type);

// DTL.Defect Desc 15        USR = Condition name of PAR.DF Defect Code
DTL.Defect_Desc_15_USR = RTVCND(PAR.DF_Defect_Code);

//?USER: Process command keys

//?If not F3 or F22 then set fields to zero
CASE;

// IF DTL.*CMD key is CF03
IF DTL.*CMD_key = '03';

// OR DTL.*CMD key is CF22
OR DTL.*CMD_key = '22';

//?If not F3 or F22 then set fields to zero
// IF *OTHERWISE
IF *OTHERWISE;

// DTL.TST Wgt = CON.*ZERO
DTL.TST_Wgt = *ZERO;

// DTL.TST Wgt Date = CON.*ZERO
DTL.TST_Wgt_Date = *ZERO;

// DTL.TST Wgt Time = CON.*ZERO
DTL.TST_Wgt_Time = *ZERO;

// DTL.TST Last Zero Date = CON.*ZERO
DTL.TST_Last_Zero_Date = *ZERO;

// DTL.TST Last Zero Time = CON.*ZERO
DTL.TST_Last_Zero_Time = *ZERO;

ENDIF;

//?USER: User defined action

CASE;

// IF DTL.*CMD key is CF03
IF DTL.*CMD_key = '03';

// OR DTL.*CMD key is CF22
OR DTL.*CMD_key = '22';

// PAR.TST Wgt = DTL.TST Wgt
PAR.TST_Wgt = DTL.TST_Wgt;

// PAR.TST Wgt Date = DTL.TST Wgt Date
PAR.TST_Wgt_Date = DTL.TST_Wgt_Date;

// PAR.TST Wgt Time = DTL.TST Wgt Time
PAR.TST_Wgt_Time = DTL.TST_Wgt_Time;

// PAR.TST Wgt Hour = DTL.TST Wgt Time / CON.10000 *
PAR.TST_Wgt_Hour = DTL.TST_Wgt_Time / 10000;

// PAR.TST Last Zero Date = DTL.TST Last Zero Date
PAR.TST_Last_Zero_Date = DTL.TST_Last_Zero_Date;

// PAR.TST Last Zero Time = DTL.TST Last Zero Time
PAR.TST_Last_Zero_Time = DTL.TST_Last_Zero_Time;

CASE;

// IF DTL.*CMD key is CF03
IF DTL.*CMD_key = '03';

// PAR.*Return code = CND.*Normal
PAR.*Return_code = *BLANK;

// IF DTL.*CMD key is CF22
IF DTL.*CMD_key = '22';

// PAR.*Return code = CND.Accept Record
PAR.*Return_code = 'ACCPTRC';

ENDIF;

RETURN;

// IF *OTHERWISE
IF *OTHERWISE;

// DTL.TST Wgt = CON.*ZERO
DTL.TST_Wgt = *ZERO;

// DTL.TST Wgt Date = CON.*ZERO
DTL.TST_Wgt_Date = *ZERO;

// DTL.TST Wgt Time = CON.*ZERO
DTL.TST_Wgt_Time = *ZERO;

// DTL.TST Last Zero Date = CON.*ZERO
DTL.TST_Last_Zero_Date = *ZERO;

// DTL.TST Last Zero Time = CON.*ZERO
DTL.TST_Last_Zero_Time = *ZERO;

ENDIF;

