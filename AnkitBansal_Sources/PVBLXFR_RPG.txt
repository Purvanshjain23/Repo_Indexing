     H/TITLE Rtv Plan Prod Sts All XF  Execute external functio
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* OPTION(*NODEBUGIO) CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Execute external function
     H* Object type   : *PGM
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISJMIST
     H* Date          : 03/20/24  Time  : 08:28:43
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPMFDREL1  IF   E           K DISK
      * RTV : Company Item Ext          Retrieval index
      *
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  WP0001         S              3  0
     D  WP0002         S              7  0
     D  WP0003         S              1
     D  WP0004         S              1
     D  WP0005         S              1
     D  WP0006         S              1
     D  WP0007         S              1
     D  WP0008         S              1
     D  WP0009         S              1
     D  WP0010         S              1
     D  WP0011         S              1
     D  WP0012         S              1
     D  WP0013         S              2
     D  WP0014         S              2
     D  WP0015         S             11  2
     D  WP0016         S             11  0
     D  WP0017         S              7  0
     D  WP0018         S             25
     D  WP0019         S              6
     D  WP0020         S              1
     D  WP0021         S              1
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  W0PMT          S              1
      /EJECT
      * Parameter declarations
     D P1PARM          DS
      * FLD: Company Item Ext
      * I :  Company Number
     D  P1AIC3                 1      2P 0
      * I :  Item Code
     D  P1HGCD                 3      6P 0
      * O :  Produce on Sunday Sts
     D  P1D0ST                 7      7
      * O :  Produce on Monday Sts
     D  P1D2ST                 8      8
      * O :  Produce on Tuesday Sts
     D  P1D6ST                 9      9
      * O :  Produce on Wednesday Sts
     D  P1WESP                10     10
      * O :  Produce on Thursday Sts
     D  P1EDST                11     11
      * O :  Produce on Friday Sts
     D  P1EFST                12     12
      * O :  Produce on Saturday Sts
     D  P1EHST                13     13
      * O :  Plan Production Sts
     D  P1EMST                14     14
      * O :  Allocation Method
     D  P1ENST                15     15
      * O :  Adjust Credit Pieces
     D  P1EOST                16     16
      * O :  CIE Use Age Days over Max
     D  P1EPST                17     18
      * O :  CIE MPR Report to USDA
     D  P1EQST                19     20
      * O :  CIE Unused Number
     D  P1OQNY                21     26P 2
      * O :  CIE Unused Number 2
     D  P1ORNY                27     32P 0
      * O :  CIE Unused Date
     D  P1S2DT                33     36P 0
      * O :  CIE TPM Equipment Code
     D  P1UFT1                37     61
      * O :  CIE Capacity Code
     D  P1KUAA                62     67
      * O :  Record Status
     D  P1VSST                68     68
     D P2PARM          DS
      * O :  USR Return Code
     D  P2N7CD                 1      1
     I@FDREAP
      * Company Item Ext          Retrieval index
      * Renamed input format fields
     I              FDAIC3                      WAAIC3
     I              FDHGCD                      WAHGCD
     I              FDD0ST                      WAD0ST
     I              FDD2ST                      WAD2ST
     I              FDD6ST                      WAD6ST
     I              FDWESP                      WAWESP
     I              FDEDST                      WAEDST
     I              FDEFST                      WAEFST
     I              FDEHST                      WAEHST
     I              FDEMST                      WAEMST
     I              FDENST                      WAENST
     I              FDEOST                      WAEOST
     I              FDEPST                      WAEPST
     I              FDEQST                      WAEQST
     I              FDOQNY                      WAOQNY
     I              FDORNY                      WAORNY
     I              FDS2DT                      WAS2DT
     I              FDUFT1                      WAUFT1
     I              FDKUAA                      WAKUAA
     I              FDVSST                      WAVSST
     I              FDMJDT                      WAMJDT
     I              FDBETM                      WABETM
     I              FDCCVN                      WACCVN
     I              FDCDVN                      WACDVN
     I              FDMKDT                      WAMKDT
     I              FDBFTM                      WABFTM
     I              FDCEVN                      WACEVN
     I              FDCFVN                      WACFVN
      *
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
     C     P1AIC3        PARM                    WP0001                         Company Number
     C     P1HGCD        PARM                    WP0002                         Item Code
     C                   PARM      P1D0ST        WP0003                         Produce on Sund
     C                   PARM      P1D2ST        WP0004                         Produce on Mond
     C                   PARM      P1D6ST        WP0005                         Produce on Tues
     C                   PARM      P1WESP        WP0006                         Produce on Wedn
     C                   PARM      P1EDST        WP0007                         Produce on Thur
     C                   PARM      P1EFST        WP0008                         Produce on Frid
     C                   PARM      P1EHST        WP0009                         Produce on Satu
     C                   PARM      P1EMST        WP0010                         Plan Production
     C                   PARM      P1ENST        WP0011                         Allocation Meth
     C                   PARM      P1EOST        WP0012                         Adjust Credit P
     C                   PARM      P1EPST        WP0013                         CIE Use Age Day
     C                   PARM      P1EQST        WP0014                         CIE MPR Report
     C                   PARM      P1OQNY        WP0015                         CIE Unused Numb
     C                   PARM      P1ORNY        WP0016                         CIE Unused Numb
     C                   PARM      P1S2DT        WP0017                         CIE Unused Date
     C                   PARM      P1UFT1        WP0018                         CIE TPM Equipme
     C                   PARM      P1KUAA        WP0019                         CIE Capacity Co
     C                   PARM      P1VSST        WP0020                         Record Status
     C                   PARM      P2N7CD        WP0021                         USR Return Code
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * Rtv Plan Prod Sts All XF
      * Change Log and comments
     C                   EXSR      UASUBR                                       Change Log and
      * Rtv Plan Prod Sts All RT - Company Item Ext  * 
     C                   EXSR      SARVGN
      *----------------------------------------------------------------
      * Exit program
     C     AAEXIT        TAG
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
      /EJECT
     CSR   SARVGN        BEGSR
      *================================================================
      * Rtv Plan Prod Sts All RT - Company Item Ext  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSA         KLIST
     C                   KFLD                    WAAIC3                         Company Number
     C                   KFLD                    WAHGCD                         Item Code
      * Setup key
     C                   Z-ADD     P1AIC3        WAAIC3                         Company Number
     C                   Z-ADD     P1HGCD        WAHGCD                         Item Code
      * Establish starting position
     C     KRSSA         CHAIN     @FDREAP                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR4125'     W0RTN
      * USER: Processing if Data record not found
     C                   MOVEL     'N'           P2N7CD                         USR Return Code
      * PAR = CON By name
     C                   EVAL      P1D0ST = ' '                                 Produce on Sund
     C                   EVAL      P1D2ST = ' '                                 Produce on Mond
     C                   EVAL      P1D6ST = ' '                                 Produce on Tues
     C                   EVAL      P1WESP = ' '                                 Produce on Wedn
     C                   EVAL      P1EDST = ' '                                 Produce on Thur
     C                   EVAL      P1EFST = ' '                                 Produce on Frid
     C                   EVAL      P1EHST = ' '                                 Produce on Satu
     C                   EVAL      P1EMST = ' '                                 Plan Production
     C                   EVAL      P1ENST = ' '                                 Allocation Meth
     C                   EVAL      P1EOST = ' '                                 Adjust Credit P
     C                   EVAL      P1EPST = ' '                                 CIE Use Age Day
     C                   EVAL      P1EQST = ' '                                 CIE MPR Report
     C                   Z-ADD     *ZERO         P1OQNY                         CIE Unused Numb
     C                   Z-ADD     *ZERO         P1ORNY                         CIE Unused Numb
     C                   Z-ADD     *ZERO         P1S2DT                         CIE Unused Date
     C                   EVAL      P1UFT1 = ' '                                 CIE TPM Equipme
     C                   EVAL      P1KUAA = ' '                                 CIE Capacity Co
     C                   EVAL      P1VSST = ' '                                 Record Status
     C                   EVAL      P2N7CD = ' '                                 USR Return Code
     C                   GOTO      SAEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     WAD0ST        P1D0ST                         Produce on Sund
     C                   MOVEL     WAD2ST        P1D2ST                         Produce on Mond
     C                   MOVEL     WAD6ST        P1D6ST                         Produce on Tues
     C                   MOVEL     WAWESP        P1WESP                         Produce on Wedn
     C                   MOVEL     WAEDST        P1EDST                         Produce on Thur
     C                   MOVEL     WAEFST        P1EFST                         Produce on Frid
     C                   MOVEL     WAEHST        P1EHST                         Produce on Satu
     C                   MOVEL     WAEMST        P1EMST                         Plan Production
     C                   MOVEL     WAENST        P1ENST                         Allocation Meth
     C                   MOVEL     WAEOST        P1EOST                         Adjust Credit P
     C                   MOVEL     WAEPST        P1EPST                         CIE Use Age Day
     C                   MOVEL     WAEQST        P1EQST                         CIE MPR Report
     C                   Z-ADD     WAOQNY        P1OQNY                         CIE Unused Numb
     C                   Z-ADD     WAORNY        P1ORNY                         CIE Unused Numb
     C                   Z-ADD     WAS2DT        P1S2DT                         CIE Unused Date
     C                   MOVEL     WAUFT1        P1UFT1                         CIE TPM Equipme
     C                   MOVEL     WAKUAA        P1KUAA                         CIE Capacity Co
     C                   MOVEL     WAVSST        P1VSST                         Record Status
     C                   MOVEL     'E'           P2N7CD                         USR Return Code
     C                   ENDIF
      *================================================================
     CSR   SAEXIT        ENDSR
      /EJECT
     CSR   UASUBR        BEGSR
      *================================================================
      * Change Log and comments
      *================================================================
      * *****
      * JM00035 JM-10/18/23 Edit Order Detail Line for regular Order
      * When User Code Model = 'PORKSCHE5'
      * Use below validation to display yes = 'Y' on UI for Prod Plan.
      * 1) Validate company item extension
      * *****
      *================================================================
     CSR   UAEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      *
      *
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WAAIC3                         Company Number
     C                   Z-ADD     *ZERO         WAHGCD                         Item Code
     C                   Z-ADD     *ZERO         WAOQNY                         CIE Unused Numb
     C                   Z-ADD     *ZERO         WAORNY                         CIE Unused Numb
     C                   Z-ADD     *ZERO         WAS2DT                         CIE Unused Date
     C                   Z-ADD     *ZERO         WAMJDT                         Create Date
     C                   Z-ADD     *ZERO         WABETM                         Create Time
     C                   Z-ADD     *ZERO         WAMKDT                         Change Date
     C                   Z-ADD     *ZERO         WABFTM                         Change Time
     C                   MOVEL     'N'           W0PMT
      *================================================================
     CSR   ZZEXIT        ENDSR
