// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for OMG3SRR
// ?Date: 14.08.2025 Time: 03:27:05
// ?------------------------------------------------------------------------------------------------

//?USER: Initialize program

// PGM.*Scan limit = CND.9999999
PGM.*Scan_limit = 9999999;

//?USER: Load subfile record from DBF record

// PGM.*Record selected = CND.*YES
PGM.*Record_selected = 'Y';

//?Select only for company in CTL
CASE;

// IF CTL.Accounting Company Number is not equal to zero
IF CTL.Company_Number <> *ZERO;

CASE;

// IF DB1.Accounting Company Number NE CTL.Accounting Company Number
IF DB1.Company_Number <> CTL.Company_Number;

// PGM.*Record selected = CND.*NO
PGM.*Record_selected = 'N';

ENDIF;

ENDIF;

//?Select only billing type
CASE;

// IF PGM.*Record selected is *YES
IF PGM.*Record_selected = 'Y';

//?If bill type = ' ', this is for either credit or debit memos
CASE;

// IF PAR.Billing Activity Type EQ WRK.BLANK
IF PAR.Billing_Activity_Type = WRK.BLANK;

//?Exclude Invoice and Transfer types
CASE;

// IF DB1.Billing Activity Type is Invoice or Transfer
IF DB1.Billing_Activity_Type = '1'/'4';

// PGM.*Record selected = CND.*NO
PGM.*Record_selected = 'N';

ENDIF;

//?If bill type = ' ', this is for either credit or debit memos
// IF PAR.Billing Activity Type is Invoice
IF PAR.Billing_Activity_Type = '1';

//?(If invoice is passed in, use both invoice and warehouse transfer types)
//?Exclude Credit and Debit memo types
CASE;

// IF DB1.Billing Activity Type is Credit or Debit Memo
IF DB1.Billing_Activity_Type = '2'/'3';

// PGM.*Record selected = CND.*NO
PGM.*Record_selected = 'N';

ENDIF;

//?If bill type = ' ', this is for either credit or debit memos
// IF *OTHERWISE
IF *OTHERWISE;

//?(credit or debit memo passed in, process only what's passed)
//?Exclude non-matching billing activity types
CASE;

// IF DB1.Billing Activity Type NE PAR.Billing Activity Type
IF DB1.Billing_Activity_Type <> PAR.Billing_Activity_Type;

// PGM.*Record selected = CND.*NO
PGM.*Record_selected = 'N';

ENDIF;

ENDIF;

ENDIF;

EXECUTE FUNCTION(RTV 1st Warehouse/UOM  RT) TYPE(RTVOBJ) FILE(OPBGWKP)          AC1568424;
PARAMETER(DB1.Company_Number);
PARAMETER(DB1.Order_Number);
PARAMETER(*ZERO);
PARAMETER(*ZERO);
PARAMETER(RCD.Warehouse_Code);
PARAMETER(NLL.U_M_Ordered);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

 QUIT;

}


//?SEL: Warehouse Code
CASE;

// IF CTL.Warehouse Code is Not Blanks
IF CTL.Warehouse_Code <> *BLANK;

CASE;

// IF CTL.Warehouse Code NE RCD.Warehouse Code
IF CTL.Warehouse_Code <> RCD.Warehouse_Code;

// PGM.*Record selected = CND.*NO
PGM.*Record_selected = 'N';

ENDIF;

ENDIF;

//?USER: Process subfile control

CASE;

// IF LCL.Warehouse Code NE CTL.Warehouse Code
IF LCL.Warehouse_Code <> CTL.Warehouse_Code;

// PGM.*Reload subfile = CND.*YES
PGM.*Reload_subfile = 'Y';

// LCL.Warehouse Code = CTL.Warehouse Code
LCL.Warehouse_Code = CTL.Warehouse_Code;

QUIT;

ENDIF;

