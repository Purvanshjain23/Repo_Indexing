     H/TITLE Edt Tattoo Hdr/DefemmmmER Edit record(1 screen)
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     W* Warning: This program does not set on the LR indicator
      *
     H* SYNOPSIS :
     H* - Maintain DBF file records, one at a time
     H* - Existing records may be updated or deleted
     H* - New records may be added
     H* - Key changes are not allowed
      *
     H* Generated by CA 2E release 8.5 (1351)
     H* Function type : Edit record(1 screen)
      *
     H* Company       : HPEDEVMDL                     n
     H* System        : HPEDEVMDL
     H* User name     : ISSMASO
     H* Date          : 08/10/11  Time  : 11:42:01
     H* Copyright     : HPEDEVMDL                     n
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPLM3E1R#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: Edt Tattoo Hdr/DefemmmmER Edit record(1 screen)
      *
     FPKA1CPL0IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RTV : Tattoo Header             Retrieval index
      *
     FPKAFREL0IF  E           K        DISK
      * RTV : Producer Location         Retrieval index
      *
     FPKDNCPL1IF  E           K        DISK
      * RTV : Tattoo Header EXT         Retrieval index
      *
     FPLATREL1IF  E           K        DISK
      * RTV : Producer Site             Retrieval index
      *
     FPKDZREL1IF  E           K        DISK
      * RTV : Tattoo Defect             Retrieval index
      *
     FPKEJCPL2IF  E           K        DISK
      * RSQ : Buy Order Load Weight     Co/BOL
      *
     FPKA8REL5IF  E           K        DISK
      * RSQ : Hog Classification        Hog Class Type 'R'esale
      *
     FPKA8REL4IF  E           K        DISK
      * RSQ : Hog Classification        Hog Class Type Qualified
      *
     FPKAXCPL0IF  E           K        DISK
      * RTV : Buy Order Load            Retrieval index
      *
     FPLAECPL2IF  E           K        DISK
      * RSQ : Delivery Sched Detail     BOH Co/BO/BOL/Kill Dt
      *
     FPLAFCPL2IF  E           K        DISK
      * RSQ : Delivery Tracking         BOH CO/BO/BOL/KillDt
      *
     FPKA7REL1IF  E           K        DISK
      * RTV : Hog Defect                Retrieval index
      *
     FPKA8REL1IF  E           K        DISK
      * RTV : Hog Classification        Retrieval index
      *
     FPKACREL1IF  E           K        DISK
      * RTV : Producer                  Retrieval index
      *
     FPKAAREL0IF  E           K        DISK
      * RTV : Source                    Retrieval index
      *
     FPKA2CPL1IF  E           K        DISK
      * RTV : Tattoo Detail             Retrieval index
      *
     FPLASREL1IF  E           K        DISK
      * RTV : Producer Site Mileage     Retrieval index
      *
     FPLA8REL1IF  E           K        DISK
      * RTV : Producer Subsidiary       Retrieval index
      *
     FPKA7REL2IF  E           K        DISK
      * RSQ : Hog Defect                Active Hog Defects
      *
     FPKA3REL5IF  E           K        DISK
      * RSQ : Pen                       Co/Pen/Open
      *
     FPKAWCPL1IF  E           K        DISK
      * RTV : Buy Order Header          Retrieval index
      *
     FPKCCREL0IF  E           K        DISK
      * RTV : Tattoo Header Process     Retrieval index
      *
     FPKADREL0IF  E           K        DISK
      * RTV : Hog Buyer                 Retrieval index
      *
     FPKAIREL0IF  E           K        DISK
      * RTV : Genetic                   Retrieval index
      *
     FPKFJCPL4IF  E           K        DISK
      * RSQ : Tattoo Pending            Co/Tattoo/BOL
      *
     FPKA1CPLAIF  E           K        DISK
      * RSQ : Tattoo Header             Co/Kill/Tattoo Active
      *
     FPKA2CPL8IF  E           K        DISK
      * RSQ : Tattoo Detail             Co/Pen
      *
     FPKA3REL1IF  E           K        DISK
      * RTV : Pen                       Retrieval index
      *
     FPKA2CPLCIF  E           K        DISK
      * RSQ : Tattoo Detail             Co/Bo/Ld/TTT/KillDt/Pen
      *
     FPKFJCPL0UF  E           K        DISK
      * UPD : Tattoo Pending            Update index
      *
     FPKA3REL0UF  E           K        DISK
      * UPD : Pen                       Update index
      *
     FPKAXCPL1UF  E           K        DISK
      * UPD : Buy Order Load            Update index
      *
     FPKAWCPL0UF  E           K        DISK
      * UPD : Buy Order Header          Update index
      *
     FPLAECPL1UF  E           K        DISK
      * UPD : Delivery Sched Detail     Update index
      *
     FPKA1CPL1UF  E           K        DISK                      A
      * UPD : Tattoo Header             Update index
      *
     FPKDZREL0UF  E           K        DISK                      A
      * UPD : Tattoo Defect             Update index
      *
     FPLAFCPL0UF  E           K        DISK
      * UPD : Delivery Tracking         Update index
      *
     FPKDNCPL0UF  E           K        DISK                      A
      * UPD : Tattoo Header EXT         Update index
      *
     FPKA2CPL0UF  E           K        DISK
      * UPD : Tattoo Detail             Update index
      *
      * KEY Screen: Field position and name array
     E                    W0BEG   5 005  5 0A
     E                    W0END   5 005  5 0A
     E                    W0NAM   5 005 10
      * DETAIL Screen: Field position and name array
     E                    W1BEG   7 064  5 0A
     E                    W1END   7 064  5 0A
     E                    W1NAM   7 064 10
      * Long constants
     E                    @CN#    1  05  6   @CN    25
     I@A8RESC
      * Hog Classification        Hog Class Type Qualified
      * Renamed input format fields
     I              A8BECD                          WABECD
     I              A8BDTX                          WABDTX
     I              A8BXST                          WABXST
     I              A8BYST                          WABYST
     I              A8BITX                          WABITX
     I              A8B0ST                          WAB0ST
     I              A8FBST                          WAFBST
     I              A8AAVN                          WAAAVN
     I              A8AADT                          WAAADT
     I              A8AMTM                          WAAMTM
     I              A8AJST                          WAAJST
     I              A8AHVN                          WAAHVN
     I              A8AGVN                          WAAGVN
     I              A8ABVN                          WAABVN
     I              A8ABDT                          WAABDT
     I              A8ABTM                          WAABTM
      *
     I@AFCPI4
      * Delivery Tracking         BOH CO/BO/BOL/KillDt
      * Renamed input format fields
     I              AFHONB                          WBHONB
     I              AFE0DT                          WBE0DT
     I              AFE9DT                          WBE9DT
     I              AFAJTH                          WBAJTH
     I              AFH4A1                          WBH4A1
     I              AFFXDT                          WBFXDT
     I              AFJIA1                          WBJIA1
     I              AFIBA1                          WBIBA1
     I              AFW5ST                          WBW5ST
     I              AFICA1                          WBICA1
     I              AFK0CD                          WBK0CD
     I              AFK1CD                          WBK1CD
     I              AFLFCD                          WBLFCD
     I              AFLGCD                          WBLGCD
     I              AFIDA1                          WBIDA1
     I              AFIPA1                          WBIPA1
     I              AFLICD                          WBLICD
     I              AFJ8CD                          WBJ8CD
     I              AFJ9CD                          WBJ9CD
     I              AFMGCD                          WBMGCD
     I              AFXHST                          WBXHST
     I              AFXIST                          WBXIST
     I              AFIEA1                          WBIEA1
     I              AFKBCD                          WBKBCD
     I              AFKZCD                          WBKZCD
     I              AFLHCD                          WBLHCD
     I              AFFADT                          WBFADT
     I              AFAKTH                          WBAKTH
     I              AFBYTH                          WBBYTH
     I              AFW6ST                          WBW6ST
     I              AFXXST                          WBXXST
     I              AFFBDT                          WBFBDT
     I              AFALTH                          WBALTH
     I              AFBVTH                          WBBVTH
     I              AFAMTH                          WBAMTH
     I              AFFCDT                          WBFCDT
     I              AFANTH                          WBANTH
     I              AFBHTH                          WBBHTH
     I              AFFDDT                          WBFDDT
     I              AFAOTH                          WBAOTH
     I              AFBWTH                          WBBWTH
     I              AFAPTH                          WBAPTH
     I              AFFEDT                          WBFEDT
     I              AFAQTH                          WBAQTH
     I              AFARTH                          WBARTH
     I              AFFFDT                          WBFFDT
     I              AFASTH                          WBASTH
     I              AFATTH                          WBATTH
     I              AFFGDT                          WBFGDT
     I              AFAUTH                          WBAUTH
     I              AFFHDT                          WBFHDT
     I              AFAVTH                          WBAVTH
     I              AFAWTH                          WBAWTH
     I              AFBKTH                          WBBKTH
     I              AFBLTH                          WBBLTH
     I              AFXJST                          WBXJST
     I              AFK3CD                          WBK3CD
     I              AFFIDT                          WBFIDT
     I              AFAXTH                          WBAXTH
     I              AFAYTH                          WBAYTH
     I              AFFJDT                          WBFJDT
     I              AFAZTH                          WBAZTH
     I              AFA0TH                          WBA0TH
     I              AFFKDT                          WBFKDT
     I              AFA1TH                          WBA1TH
     I              AFA2TH                          WBA2TH
     I              AFFLDT                          WBFLDT
     I              AFA3TH                          WBA3TH
     I              AFA4TH                          WBA4TH
     I              AFBTTH                          WBBTTH
     I              AFFMDT                          WBFMDT
     I              AFA5TH                          WBA5TH
     I              AFA6TH                          WBA6TH
     I              AFBXTH                          WBBXTH
     I              AFXKST                          WBXKST
     I              AFYDST                          WBYDST
     I              AFFYDT                          WBFYDT
     I              AFB0TH                          WBB0TH
     I              AFBZTH                          WBBZTH
     I              AFH2A1                          WBH2A1
     I              AFJ2A1                          WBJ2A1
     I              AFJ3A1                          WBJ3A1
     I              AFKMA1                          WBKMA1
     I              AFJ4A1                          WBJ4A1
     I              AFJ5A1                          WBJ5A1
     I              AFJ6A1                          WBJ6A1
     I              AFJ7A1                          WBJ7A1
     I              AFJ8A1                          WBJ8A1
     I              AFJ9A1                          WBJ9A1
     I              AFKAA1                          WBKAA1
     I              AFKBA1                          WBKBA1
     I              AFKCA1                          WBKCA1
     I              AFKDA1                          WBKDA1
     I              AFKEA1                          WBKEA1
     I              AFKFA1                          WBKFA1
     I              AFKNA1                          WBKNA1
     I              AFKGA1                          WBKGA1
     I              AFKHA1                          WBKHA1
     I              AFKOA1                          WBKOA1
     I              AFKIA1                          WBKIA1
     I              AFKJA1                          WBKJA1
     I              AFKKA1                          WBKKA1
     I              AFKLA1                          WBKLA1
     I              AFYNST                          WBYNST
     I              AFYOST                          WBYOST
     I              AFABCD                          WBABCD
     I              AFAECD                          WBAECD
     I              AFAACD                          WBAACD
     I              AFHMNB                          WBHMNB
     I              AFBNNB                          WBBNNB
     I              AFBONB                          WBBONB
     I              AFAAVN                          WBAAVN
     I              AFAADT                          WBAADT
     I              AFAMTM                          WBAMTM
     I              AFAJST                          WBAJST
     I              AFAHVN                          WBAHVN
     I              AFAGVN                          WBAGVN
     I              AFABVN                          WBABVN
     I              AFABDT                          WBABDT
     I              AFABTM                          WBABTM
      *
     I@A8REDA
      * Hog Classification        Retrieval index
      * Renamed input format fields
     I              A8BECD                          WCBECD
     I              A8BDTX                          WCBDTX
     I              A8BXST                          WCBXST
     I              A8BYST                          WCBYST
     I              A8BITX                          WCBITX
     I              A8B0ST                          WCB0ST
     I              A8FBST                          WCFBST
     I              A8AAVN                          WCAAVN
     I              A8AADT                          WCAADT
     I              A8AMTM                          WCAMTM
     I              A8AJST                          WCAJST
     I              A8AHVN                          WCAHVN
     I              A8AGVN                          WCAGVN
     I              A8ABVN                          WCABVN
     I              A8ABDT                          WCABDT
     I              A8ABTM                          WCABTM
      *
     I@A8REPM
      * Producer Subsidiary       Retrieval index
      * Renamed input format fields
     I              A8ABCD                          WDABCD
     I              A8OVCD                          WDOVCD
     I              A8V2TX                          WDV2TX
     I              A8DCSS                          WDDCSS
     I              A8DDSS                          WDDDSS
     I              A8DESS                          WDDESS
     I              A8SKA1                          WDSKA1
     I              A8SLA1                          WDSLA1
     I              A8SMA1                          WDSMA1
     I              A8AAVN                          WDAAVN
     I              A8AADT                          WDAADT
     I              A8AMTM                          WDAMTM
     I              A8AJST                          WDAJST
     I              A8AHVN                          WDAHVN
     I              A8AGVN                          WDAGVN
     I              A8ABVN                          WDABVN
     I              A8ABDT                          WDABDT
     I              A8ABTM                          WDABTM
      *
     I@A7REMM
      * Hog Defect                Active Hog Defects
      * Renamed input format fields
     I              A7BDCD                          WEBDCD
     I              A7BCTX                          WEBCTX
     I              A7RXST                          WERXST
     I              A7R2ST                          WER2ST
     I              A7RYST                          WERYST
     I              A7RZST                          WERZST
     I              A7R0ST                          WER0ST
     I              A7R1ST                          WER1ST
     I              A7HYCD                          WEHYCD
     I              A7HZCD                          WEHZCD
     I              A7VYST                          WEVYST
     I              A7AEA1                          WEAEA1
     I              A7UOPR                          WEUOPR
     I              A7UPPR                          WEUPPR
     I              A7UQPR                          WEUQPR
     I              A7AAVN                          WEAAVN
     I              A7AADT                          WEAADT
     I              A7AMTM                          WEAMTM
     I              A7AJST                          WEAJST
     I              A7AHVN                          WEAHVN
     I              A7AGVN                          WEAGVN
     I              A7ABVN                          WEABVN
     I              A7ABDT                          WEABDT
     I              A7ABTM                          WEABTM
      *
     I@FJCPHV
      * Tattoo Pending            Update index
      * Renamed input format fields
     I              FJHONB                          WFHONB
     I              FJEZDT                          WFEZDT
     I              FJHSA1                          WFHSA1
     I              FJHMNB                          WFHMNB
     I              FJBNNB                          WFBNNB
     I              FJBONB                          WFBONB
     I              FJHRA1                          WFHRA1
     I              FJBKTM                          WFBKTM
     I              FJWPST                          WFWPST
     I              FJWQST                          WFWQST
     I              FJMIA1                          WFMIA1
     I              FJAAVN                          WFAAVN
     I              FJAADT                          WFAADT
     I              FJAMTM                          WFAMTM
     I              FJAJST                          WFAJST
     I              FJAHVN                          WFAHVN
     I              FJAGVN                          WFAGVN
     I              FJABVN                          WFABVN
     I              FJABDT                          WFABDT
     I              FJABTM                          WFABTM
      *
     I@A1CPL0
      * Tattoo Header             Co/Kill/Tattoo Active
      * Renamed input format fields
     I              A1HMNB                          WGHMNB
     I              A1BNNB                          WGBNNB
     I              A1BONB                          WGBONB
     I              A1CVNB                          WGCVNB
     I              A1B0DT                          WGB0DT
     I              A1AWDT                          WGAWDT
     I              A1BICD                          WGBICD
     I              A1CPST                          WGCPST
     I              A1ACPR                          WGACPR
     I              A1B9PR                          WGB9PR
     I              A1CAPR                          WGCAPR
     I              A1C4ST                          WGC4ST
     I              A1AIPR                          WGAIPR
     I              A1A6DT                          WGA6DT
     I              A1C2ST                          WGC2ST
     I              A1CXNB                          WGCXNB
     I              A1CWNB                          WGCWNB
     I              A1FCNB                          WGFCNB
     I              A1H9NB                          WGH9NB
     I              A1FDNB                          WGFDNB
     I              A1FENB                          WGFENB
     I              A1HENB                          WGHENB
     I              A1HFNB                          WGHFNB
     I              A1CYNB                          WGCYNB
     I              A1LRNB                          WGLRNB
     I              A1E0NB                          WGE0NB
     I              A1A5PC                          WGA5PC
     I              A1FBNB                          WGFBNB
     I              A1A4PC                          WGA4PC
     I              A1F7NB                          WGF7NB
     I              A1HDNB                          WGHDNB
     I              A1F5NB                          WGF5NB
     I              A1F4NB                          WGF4NB
     I              A1F3NB                          WGF3NB
     I              A1F2NB                          WGF2NB
     I              A1AVPC                          WGAVPC
     I              A1AWPC                          WGAWPC
     I              A1CWPC                          WGCWPC
     I              A1A8PC                          WGA8PC
     I              A1A7PC                          WGA7PC
     I              A1B8PR                          WGB8PR
     I              A1AMPR                          WGAMPR
     I              A1ANPR                          WGANPR
     I              A1AYVA                          WGAYVA
     I              A1AWVA                          WGAWVA
     I              A1AOPR                          WGAOPR
     I              A1AXVA                          WGAXVA
     I              A1APPR                          WGAPPR
     I              A1ASPR                          WGASPR
     I              A1A4VA                          WGA4VA
     I              A1ATPR                          WGATPR
     I              A1A5VA                          WGA5VA
     I              A1CBPR                          WGCBPR
     I              A1CCPR                          WGCCPR
     I              A1LPNB                          WGLPNB
     I              A1CDPR                          WGCDPR
     I              A1A7VA                          WGA7VA
     I              A1A2PR                          WGA2PR
     I              A1JWST                          WGJWST
     I              A1CWST                          WGCWST
     I              A1D7ST                          WGD7ST
     I              A1D8ST                          WGD8ST
     I              A1DWST                          WGDWST
     I              A1D6ST                          WGD6ST
     I              A1GHNB                          WGGHNB
     I              A1BYDT                          WGBYDT
     I              A1E0ST                          WGE0ST
     I              A1E1ST                          WGE1ST
     I              A1E2ST                          WGE2ST
     I              A1BSDT                          WGBSDT
     I              A1BTDT                          WGBTDT
     I              A1BUDT                          WGBUDT
     I              A1HGNB                          WGHGNB
     I              A1HHNB                          WGHHNB
     I              A1HINB                          WGHINB
     I              A1A3PR                          WGA3PR
     I              A1A4PR                          WGA4PR
     I              A1A6PR                          WGA6PR
     I              A1J9NB                          WGJ9NB
     I              A1D6PR                          WGD6PR
     I              A1D7PR                          WGD7PR
     I              A1D8PR                          WGD8PR
     I              A1D9PR                          WGD9PR
     I              A1EAPR                          WGEAPR
     I              A1EBPR                          WGEBPR
     I              A1ECPR                          WGECPR
     I              A1EDPR                          WGEDPR
     I              A1EEPR                          WGEEPR
     I              A1EFPR                          WGEFPR
     I              A1EGPR                          WGEGPR
     I              A1EHPR                          WGEHPR
     I              A1KAST                          WGKAST
     I              A1J7ST                          WGJ7ST
     I              A1J9ST                          WGJ9ST
     I              A1OXNB                          WGOXNB
     I              A1LKST                          WGLKST
     I              A1LLST                          WGLLST
     I              A1J8ST                          WGJ8ST
     I              A1LIST                          WGLIST
     I              A1LJST                          WGLJST
     I              A1NZTX                          WGNZTX
     I              A1HJCD                          WGHJCD
     I              A1R4ST                          WGR4ST
     I              A1R5ST                          WGR5ST
     I              A1R6ST                          WGR6ST
     I              A1R7ST                          WGR7ST
     I              A1THWT                          WGTHWT
     I              A1T2WT                          WGT2WT
     I              A1THHD                          WGTHHD
     I              A1T2HD                          WGT2HD
     I              A1OBPR                          WGOBPR
     I              A1KOER                          WGKOER
     I              A1OPIR                          WGOPIR
     I              A1OPEM                          WGOPEM
     I              A1IORP                          WGIORP
     I              A1OWEO                          WGOWEO
     I              A1OQET                          WGOQET
     I              A1URST                          WGURST
     I              A1USST                          WGUSST
     I              A1HHPC                          WGHHPC
     I              A1S9PR                          WGS9PR
     I              A1TAPR                          WGTAPR
     I              A1TBPR                          WGTBPR
     I              A1JFUR                          WGJFUR
     I              A1KRIF                          WGKRIF
     I              A1KORF                          WGKORF
     I              A1KAPR                          WGKAPR
     I              A1KROT                          WGKROT
     I              A1OTJG                          WGOTJG
     I              A1IRJG                          WGIRJG
     I              A1IMJF                          WGIMJF
     I              A1IRGF                          WGIRGF
     I              A1KRJF                          WGKRJF
     I              A1OJRF                          WGOJRF
     I              A1KFOR                          WGKFOR
     I              A1ORJK                          WGORJK
     I              A1OMVJ                          WGOMVJ
     I              A1MVNF                          WGMVNF
     I              A1MCNF                          WGMCNF
     I              A1NCNF                          WGNCNF
     I              A1NCHF                          WGNCHF
     I              A1IGIR                          WGIGIR
     I              A1KFJR                          WGKFJR
     I              A1EADT                          WGEADT
     I              A1EBDT                          WGEBDT
     I              A1ECDT                          WGECDT
     I              A1EDDT                          WGEDDT
     I              A1EEDT                          WGEEDT
     I              A1U4ST                          WGU4ST
     I              A1U5ST                          WGU5ST
     I              A1U6ST                          WGU6ST
     I              A1U7ST                          WGU7ST
     I              A1U8ST                          WGU8ST
     I              A1U9ST                          WGU9ST
     I              A1VAST                          WGVAST
     I              A1VBST                          WGVBST
     I              A1BDCD                          WGBDCD
     I              A1CSCD                          WGCSCD
     I              A1ABCD                          WGABCD
     I              A1AECD                          WGAECD
     I              A1ACCD                          WGACCD
     I              A1AGCD                          WGAGCD
     I              A1BECD                          WGBECD
     I              A1AAVN                          WGAAVN
     I              A1AADT                          WGAADT
     I              A1AMTM                          WGAMTM
     I              A1AJST                          WGAJST
     I              A1AHVN                          WGAHVN
     I              A1AGVN                          WGAGVN
     I              A1ABVN                          WGABVN
     I              A1ABDT                          WGABDT
     I              A1ABTM                          WGABTM
      *
     I@A2CPKE
      * Tattoo Detail             Co/Pen
      * Renamed input format fields
     I              A2HMNB                          WHHMNB
     I              A2BNNB                          WHBNNB
     I              A2BONB                          WHBONB
     I              A2CVNB                          WHCVNB
     I              A2B0DT                          WHB0DT
     I              A2C2NB                          WHC2NB
     I              A2CZNB                          WHCZNB
     I              A2C0NB                          WHC0NB
     I              A2D8NB                          WHD8NB
     I              A2H7NB                          WHH7NB
     I              A2GGST                          WHGGST
     I              A2AJTM                          WHAJTM
     I              A2JEA1                          WHJEA1
     I              A2B7CD                          WHB7CD
     I              A2D7NB                          WHD7NB
     I              A2D9ST                          WHD9ST
     I              A2E3ST                          WHE3ST
     I              A2E4ST                          WHE4ST
     I              A2E5ST                          WHE5ST
     I              A2BVDT                          WHBVDT
     I              A2BWDT                          WHBWDT
     I              A2BXDT                          WHBXDT
     I              A2HVNB                          WHHVNB
     I              A2CMCD                          WHCMCD
     I              A2B9CD                          WHB9CD
     I              A2H8NB                          WHH8NB
     I              A2CYCD                          WHCYCD
     I              A2AAVN                          WHAAVN
     I              A2AADT                          WHAADT
     I              A2AMTM                          WHAMTM
     I              A2AJST                          WHAJST
     I              A2AHVN                          WHAHVN
     I              A2AGVN                          WHAGVN
     I              A2ABVN                          WHABVN
     I              A2ABDT                          WHABDT
     I              A2ABTM                          WHABTM
      *
     I@A3REDD
      * Pen                       Retrieval index
      * Renamed input format fields
     I              A3HVNB                          WIHVNB
     I              A3CMCD                          WICMCD
     I              A3BBTX                          WIBBTX
     I              A3CTNB                          WICTNB
     I              A3D6NB                          WID6NB
     I              A3B6CD                          WIB6CD
     I              A3DGST                          WIDGST
     I              A3EBNB                          WIEBNB
     I              A3FWST                          WIFWST
     I              A3HBNB                          WIHBNB
     I              A3AGCD                          WIAGCD
     I              A3AAVN                          WIAAVN
     I              A3AADT                          WIAADT
     I              A3AMTM                          WIAMTM
     I              A3AJST                          WIAJST
     I              A3AHVN                          WIAHVN
     I              A3AGVN                          WIAGVN
     I              A3ABVN                          WIABVN
     I              A3ABDT                          WIABDT
     I              A3ABTM                          WIABTM
      *
     I@A3REDC
      * Pen                       Update index
      * Renamed input format fields
     I              A3HVNB                          WJHVNB
     I              A3CMCD                          WJCMCD
     I              A3BBTX                          WJBBTX
     I              A3CTNB                          WJCTNB
     I              A3D6NB                          WJD6NB
     I              A3B6CD                          WJB6CD
     I              A3DGST                          WJDGST
     I              A3EBNB                          WJEBNB
     I              A3FWST                          WJFWST
     I              A3HBNB                          WJHBNB
     I              A3AGCD                          WJAGCD
     I              A3AAVN                          WJAAVN
     I              A3AADT                          WJAADT
     I              A3AMTM                          WJAMTM
     I              A3AJST                          WJAJST
     I              A3AHVN                          WJAHVN
     I              A3AGVN                          WJAGVN
     I              A3ABVN                          WJABVN
     I              A3ABDT                          WJABDT
     I              A3ABTM                          WJABTM
      *
     I@AXCPBY
      * Buy Order Load            Update index
      * Renamed input format fields
     I              AXHMNB                          WKHMNB
     I              AXBNNB                          WKBNNB
     I              AXBONB                          WKBONB
     I              AXCQDT                          WKCQDT
     I              AXABTH                          WKABTH
     I              AXACTH                          WKACTH
     I              AXBPNB                          WKBPNB
     I              AXCSNB                          WKCSNB
     I              AXAUDT                          WKAUDT
     I              AXCMST                          WKCMST
     I              AXAGPR                          WKAGPR
     I              AXATVA                          WKATVA
     I              AXI1ST                          WKI1ST
     I              AXDHNB                          WKDHNB
     I              AXDINB                          WKDINB
     I              AXCNST                          WKCNST
     I              AXGINB                          WKGINB
     I              AXBZDT                          WKBZDT
     I              AXLSNB                          WKLSNB
     I              AXF3TX                          WKF3TX
     I              AXO8ST                          WKO8ST
     I              AXO9ST                          WKO9ST
     I              AXPAST                          WKPAST
     I              AXLDSH                          WKLDSH
     I              AXPBST                          WKPBST
     I              AXPCST                          WKPCST
     I              AXPDST                          WKPDST
     I              AXUWST                          WKUWST
     I              AXUXST                          WKUXST
     I              AXUYST                          WKUYST
     I              AXJKRU                          WKJKRU
     I              AXKEOR                          WKKEOR
     I              AXIOEW                          WKIOEW
     I              AXKJIO                          WKKJIO
     I              AXIOJR                          WKIOJR
     I              AXEIRR                          WKEIRR
     I              AXITMF                          WKITMF
     I              AXODJE                          WKODJE
     I              AXRJIF                          WKRJIF
     I              AXOEJF                          WKOEJF
     I              AXD0DT                          WKD0DT
     I              AXD1DT                          WKD1DT
     I              AXD2DT                          WKD2DT
     I              AXD3DT                          WKD3DT
     I              AXD4DT                          WKD4DT
     I              AXBNCD                          WKBNCD
     I              AXABCD                          WKABCD
     I              AXAECD                          WKAECD
     I              AXAAVN                          WKAAVN
     I              AXAADT                          WKAADT
     I              AXAMTM                          WKAMTM
     I              AXAJST                          WKAJST
     I              AXAHVN                          WKAHVN
     I              AXAGVN                          WKAGVN
     I              AXABVN                          WKABVN
     I              AXABDT                          WKABDT
     I              AXABTM                          WKABTM
      *
     I@AWCPAZ
      * Buy Order Header          Update index
      * Renamed input format fields
     I              AWHMNB                          WLHMNB
     I              AWBNNB                          WLBNNB
     I              AWARDT                          WLARDT
     I              AWASDT                          WLASDT
     I              AWA4ST                          WLA4ST
     I              AWA5ST                          WLA5ST
     I              AWAAPR                          WLAAPR
     I              AWA6ST                          WLA6ST
     I              AWA7ST                          WLA7ST
     I              AWB3ST                          WLB3ST
     I              AWALPR                          WLALPR
     I              AWETCD                          WLETCD
     I              AWEUCD                          WLEUCD
     I              AWJ5TX                          WLJ5TX
     I              AWD5DT                          WLD5DT
     I              AWD6DT                          WLD6DT
     I              AWD7DT                          WLD7DT
     I              AWD8DT                          WLD8DT
     I              AWD9DT                          WLD9DT
     I              AWJOEJ                          WLJOEJ
     I              AWKOFF                          WLKOFF
     I              AWKWPE                          WLKWPE
     I              AWIMBF                          WLIMBF
     I              AWOPTR                          WLOPTR
     I              AWOEJD                          WLOEJD
     I              AWIRMF                          WLIRMF
     I              AWJIRM                          WLJIRM
     I              AWJRKF                          WLJRKF
     I              AWKFIR                          WLKFIR
     I              AWUZST                          WLUZST
     I              AWU0ST                          WLU0ST
     I              AWU1ST                          WLU1ST
     I              AWU2ST                          WLU2ST
     I              AWU3ST                          WLU3ST
     I              AWHXNB                          WLHXNB
     I              AWGANB                          WLGANB
     I              AWGBNB                          WLGBNB
     I              AWABCD                          WLABCD
     I              AWAECD                          WLAECD
     I              AWAKCD                          WLAKCD
     I              AWALCD                          WLALCD
     I              AWAGCD                          WLAGCD
     I              AWAICD                          WLAICD
     I              AWAMCD                          WLAMCD
     I              AWACCD                          WLACCD
     I              AWAAVN                          WLAAVN
     I              AWAADT                          WLAADT
     I              AWAMTM                          WLAMTM
     I              AWAJST                          WLAJST
     I              AWAHVN                          WLAHVN
     I              AWAGVN                          WLAGVN
     I              AWABVN                          WLABVN
     I              AWABDT                          WLABDT
     I              AWABTM                          WLABTM
      *
     I@AECPIH
      * Delivery Sched Detail     Update index
      * Renamed input format fields
     I              AEHONB                          WMHONB
     I              AEE0DT                          WME0DT
     I              AEE6DT                          WME6DT
     I              AEAGTH                          WMAGTH
     I              AEHZA1                          WMHZA1
     I              AEH0A1                          WMH0A1
     I              AEH1A1                          WMH1A1
     I              AEJ4CD                          WMJ4CD
     I              AEJ5CD                          WMJ5CD
     I              AELBCD                          WMLBCD
     I              AELCCD                          WMLCCD
     I              AEIOA1                          WMIOA1
     I              AEH2A1                          WMH2A1
     I              AEIJA1                          WMIJA1
     I              AEK9CD                          WMK9CD
     I              AEK8CD                          WMK8CD
     I              AEJ6CD                          WMJ6CD
     I              AEJ7CD                          WMJ7CD
     I              AEMGCD                          WMMGCD
     I              AEW1ST                          WMW1ST
     I              AEW2ST                          WMW2ST
     I              AEH3A1                          WMH3A1
     I              AEMECD                          WMMECD
     I              AEMFCD                          WMMFCD
     I              AEW4ST                          WMW4ST
     I              AEXWST                          WMXWST
     I              AEFRDT                          WMFRDT
     I              AEBOTH                          WMBOTH
     I              AEE7DT                          WME7DT
     I              AEAHTH                          WMAHTH
     I              AEE8DT                          WME8DT
     I              AEAITH                          WMAITH
     I              AEXBST                          WMXBST
     I              AEXGST                          WMXGST
     I              AEXPST                          WMXPST
     I              AEXNST                          WMXNST
     I              AEXTST                          WMXTST
     I              AEXLST                          WMXLST
     I              AEW0ST                          WMW0ST
     I              AEYEST                          WMYEST
     I              AEFZDT                          WMFZDT
     I              AEB1TH                          WMB1TH
     I              AEAACD                          WMAACD
     I              AEABCD                          WMABCD
     I              AEAECD                          WMAECD
     I              AEHMNB                          WMHMNB
     I              AEBNNB                          WMBNNB
     I              AEBONB                          WMBONB
     I              AEAAVN                          WMAAVN
     I              AEAADT                          WMAADT
     I              AEAMTM                          WMAMTM
     I              AEAJST                          WMAJST
     I              AEAHVN                          WMAHVN
     I              AEAGVN                          WMAGVN
     I              AEABVN                          WMABVN
     I              AEABDT                          WMABDT
     I              AEABTM                          WMABTM
      *
     I@DZREX2
      * Tattoo Defect             Update index
      * Renamed input format fields
     I              DZHMNB                          WOHMNB
     I              DZBNNB                          WOBNNB
     I              DZBONB                          WOBONB
     I              DZCVNB                          WOCVNB
     I              DZB0DT                          WOB0DT
     I              DZBDCD                          WOBDCD
     I              DZLJNB                          WOLJNB
     I              DZBECD                          WOBECD
     I              DZB7SS                          WOB7SS
     I              DZB8SS                          WOB8SS
     I              DZB9SS                          WOB9SS
     I              DZCASS                          WOCASS
     I              DZNXA1                          WONXA1
     I              DZNYA1                          WONYA1
     I              DZNZA1                          WONZA1
     I              DZAAVN                          WOAAVN
     I              DZAADT                          WOAADT
     I              DZAMTM                          WOAMTM
     I              DZAJST                          WOAJST
     I              DZAHVN                          WOAHVN
     I              DZAGVN                          WOAGVN
     I              DZABVN                          WOABVN
     I              DZABDT                          WOABDT
     I              DZABTM                          WOABTM
      *
     I@AFCPIC
      * Delivery Tracking         Update index
      * Renamed input format fields
     I              AFHONB                          WRHONB
     I              AFE0DT                          WRE0DT
     I              AFE9DT                          WRE9DT
     I              AFAJTH                          WRAJTH
     I              AFH4A1                          WRH4A1
     I              AFFXDT                          WRFXDT
     I              AFJIA1                          WRJIA1
     I              AFIBA1                          WRIBA1
     I              AFW5ST                          WRW5ST
     I              AFICA1                          WRICA1
     I              AFK0CD                          WRK0CD
     I              AFK1CD                          WRK1CD
     I              AFLFCD                          WRLFCD
     I              AFLGCD                          WRLGCD
     I              AFIDA1                          WRIDA1
     I              AFIPA1                          WRIPA1
     I              AFLICD                          WRLICD
     I              AFJ8CD                          WRJ8CD
     I              AFJ9CD                          WRJ9CD
     I              AFMGCD                          WRMGCD
     I              AFXHST                          WRXHST
     I              AFXIST                          WRXIST
     I              AFIEA1                          WRIEA1
     I              AFKBCD                          WRKBCD
     I              AFKZCD                          WRKZCD
     I              AFLHCD                          WRLHCD
     I              AFFADT                          WRFADT
     I              AFAKTH                          WRAKTH
     I              AFBYTH                          WRBYTH
     I              AFW6ST                          WRW6ST
     I              AFXXST                          WRXXST
     I              AFFBDT                          WRFBDT
     I              AFALTH                          WRALTH
     I              AFBVTH                          WRBVTH
     I              AFAMTH                          WRAMTH
     I              AFFCDT                          WRFCDT
     I              AFANTH                          WRANTH
     I              AFBHTH                          WRBHTH
     I              AFFDDT                          WRFDDT
     I              AFAOTH                          WRAOTH
     I              AFBWTH                          WRBWTH
     I              AFAPTH                          WRAPTH
     I              AFFEDT                          WRFEDT
     I              AFAQTH                          WRAQTH
     I              AFARTH                          WRARTH
     I              AFFFDT                          WRFFDT
     I              AFASTH                          WRASTH
     I              AFATTH                          WRATTH
     I              AFFGDT                          WRFGDT
     I              AFAUTH                          WRAUTH
     I              AFFHDT                          WRFHDT
     I              AFAVTH                          WRAVTH
     I              AFAWTH                          WRAWTH
     I              AFBKTH                          WRBKTH
     I              AFBLTH                          WRBLTH
     I              AFXJST                          WRXJST
     I              AFK3CD                          WRK3CD
     I              AFFIDT                          WRFIDT
     I              AFAXTH                          WRAXTH
     I              AFAYTH                          WRAYTH
     I              AFFJDT                          WRFJDT
     I              AFAZTH                          WRAZTH
     I              AFA0TH                          WRA0TH
     I              AFFKDT                          WRFKDT
     I              AFA1TH                          WRA1TH
     I              AFA2TH                          WRA2TH
     I              AFFLDT                          WRFLDT
     I              AFA3TH                          WRA3TH
     I              AFA4TH                          WRA4TH
     I              AFBTTH                          WRBTTH
     I              AFFMDT                          WRFMDT
     I              AFA5TH                          WRA5TH
     I              AFA6TH                          WRA6TH
     I              AFBXTH                          WRBXTH
     I              AFXKST                          WRXKST
     I              AFYDST                          WRYDST
     I              AFFYDT                          WRFYDT
     I              AFB0TH                          WRB0TH
     I              AFBZTH                          WRBZTH
     I              AFH2A1                          WRH2A1
     I              AFJ2A1                          WRJ2A1
     I              AFJ3A1                          WRJ3A1
     I              AFKMA1                          WRKMA1
     I              AFJ4A1                          WRJ4A1
     I              AFJ5A1                          WRJ5A1
     I              AFJ6A1                          WRJ6A1
     I              AFJ7A1                          WRJ7A1
     I              AFJ8A1                          WRJ8A1
     I              AFJ9A1                          WRJ9A1
     I              AFKAA1                          WRKAA1
     I              AFKBA1                          WRKBA1
     I              AFKCA1                          WRKCA1
     I              AFKDA1                          WRKDA1
     I              AFKEA1                          WRKEA1
     I              AFKFA1                          WRKFA1
     I              AFKNA1                          WRKNA1
     I              AFKGA1                          WRKGA1
     I              AFKHA1                          WRKHA1
     I              AFKOA1                          WRKOA1
     I              AFKIA1                          WRKIA1
     I              AFKJA1                          WRKJA1
     I              AFKKA1                          WRKKA1
     I              AFKLA1                          WRKLA1
     I              AFYNST                          WRYNST
     I              AFYOST                          WRYOST
     I              AFABCD                          WRABCD
     I              AFAECD                          WRAECD
     I              AFAACD                          WRAACD
     I              AFHMNB                          WRHMNB
     I              AFBNNB                          WRBNNB
     I              AFBONB                          WRBONB
     I              AFAAVN                          WRAAVN
     I              AFAADT                          WRAADT
     I              AFAMTM                          WRAMTM
     I              AFAJST                          WRAJST
     I              AFAHVN                          WRAHVN
     I              AFAGVN                          WRAGVN
     I              AFABVN                          WRABVN
     I              AFABDT                          WRABDT
     I              AFABTM                          WRABTM
      *
     I@DNCPUX
      * Tattoo Header EXT         Update index
      * Renamed input format fields
     I              DNHMNB                          WSHMNB
     I              DNBNNB                          WSBNNB
     I              DNBONB                          WSBONB
     I              DNCVNB                          WSCVNB
     I              DNB0DT                          WSB0DT
     I              DNI5PR                          WSI5PR
     I              DNJBPR                          WSJBPR
     I              DNI6PR                          WSI6PR
     I              DNI7PR                          WSI7PR
     I              DNI8PR                          WSI8PR
     I              DNI9PR                          WSI9PR
     I              DNJAPR                          WSJAPR
     I              DNJCPR                          WSJCPR
     I              DNJDPR                          WSJDPR
     I              DNJEPR                          WSJEPR
     I              DNJFPR                          WSJFPR
     I              DNJGPR                          WSJGPR
     I              DNJHPR                          WSJHPR
     I              DNJIPR                          WSJIPR
     I              DNJJPR                          WSJJPR
     I              DNJKPR                          WSJKPR
     I              DNJLPR                          WSJLPR
     I              DNJMPR                          WSJMPR
     I              DNJNPR                          WSJNPR
     I              DNJOPR                          WSJOPR
     I              DNLTBF                          WSLTBF
     I              DNHZPC                          WSHZPC
     I              DNLTHW                          WSLTHW
     I              DNH0PC                          WSH0PC
     I              DNGTBF                          WSGTBF
     I              DNH1PC                          WSH1PC
     I              DNGTHW                          WSGTHW
     I              DNH2PC                          WSH2PC
     I              DNHLBF                          WSHLBF
     I              DNHLLE                          WSHLLE
     I              DNHLHW                          WSHLHW
     I              DNHLLP                          WSHLLP
     I              DNHGBF                          WSHGBF
     I              DNHGLE                          WSHGLE
     I              DNHGHW                          WSHGHW
     I              DNHFLP                          WSHFLP
     I              DNSNA1                          WSSNA1
     I              DNSOA1                          WSSOA1
     I              DNSPA1                          WSSPA1
     I              DNDGSS                          WSDGSS
     I              DNDHSS                          WSDHSS
     I              DNDISS                          WSDISS
     I              DNABCD                          WSABCD
     I              DNNYCD                          WSNYCD
     I              DNOVCD                          WSOVCD
     I              DNAAVN                          WSAAVN
     I              DNAADT                          WSAADT
     I              DNAMTM                          WSAMTM
     I              DNAJST                          WSAJST
     I              DNAHVN                          WSAHVN
     I              DNAGVN                          WSAGVN
     I              DNABVN                          WSABVN
     I              DNABDT                          WSABDT
     I              DNABTM                          WSABTM
      *
     I@A2CPDF
      * Tattoo Detail             Update index
      * Renamed input format fields
     I              A2HMNB                          WTHMNB
     I              A2BNNB                          WTBNNB
     I              A2BONB                          WTBONB
     I              A2CVNB                          WTCVNB
     I              A2B0DT                          WTB0DT
     I              A2C2NB                          WTC2NB
     I              A2CZNB                          WTCZNB
     I              A2C0NB                          WTC0NB
     I              A2D8NB                          WTD8NB
     I              A2H7NB                          WTH7NB
     I              A2GGST                          WTGGST
     I              A2AJTM                          WTAJTM
     I              A2JEA1                          WTJEA1
     I              A2B7CD                          WTB7CD
     I              A2D7NB                          WTD7NB
     I              A2D9ST                          WTD9ST
     I              A2E3ST                          WTE3ST
     I              A2E4ST                          WTE4ST
     I              A2E5ST                          WTE5ST
     I              A2BVDT                          WTBVDT
     I              A2BWDT                          WTBWDT
     I              A2BXDT                          WTBXDT
     I              A2HVNB                          WTHVNB
     I              A2CMCD                          WTCMCD
     I              A2B9CD                          WTB9CD
     I              A2H8NB                          WTH8NB
     I              A2CYCD                          WTCYCD
     I              A2AAVN                          WTAAVN
     I              A2AADT                          WTAADT
     I              A2AMTM                          WTAMTM
     I              A2AJST                          WTAJST
     I              A2AHVN                          WTAHVN
     I              A2AGVN                          WTAGVN
     I              A2ABVN                          WTABVN
     I              A2ABDT                          WTABDT
     I              A2ABTM                          WTABTM
      *
     I@A2CPNP
      * Tattoo Detail             Co/Bo/Ld/TTT/KillDt/Pen
      * Renamed input format fields
     I              A2HMNB                          WVHMNB
     I              A2BNNB                          WVBNNB
     I              A2BONB                          WVBONB
     I              A2CVNB                          WVCVNB
     I              A2B0DT                          WVB0DT
     I              A2C2NB                          WVC2NB
     I              A2CZNB                          WVCZNB
     I              A2C0NB                          WVC0NB
     I              A2D8NB                          WVD8NB
     I              A2H7NB                          WVH7NB
     I              A2GGST                          WVGGST
     I              A2AJTM                          WVAJTM
     I              A2JEA1                          WVJEA1
     I              A2B7CD                          WVB7CD
     I              A2D7NB                          WVD7NB
     I              A2D9ST                          WVD9ST
     I              A2E3ST                          WVE3ST
     I              A2E4ST                          WVE4ST
     I              A2E5ST                          WVE5ST
     I              A2BVDT                          WVBVDT
     I              A2BWDT                          WVBWDT
     I              A2BXDT                          WVBXDT
     I              A2HVNB                          WVHVNB
     I              A2CMCD                          WVCMCD
     I              A2B9CD                          WVB9CD
     I              A2H8NB                          WVH8NB
     I              A2CYCD                          WVCYCD
     I              A2AAVN                          WVAAVN
     I              A2AADT                          WVAADT
     I              A2AMTM                          WVAMTM
     I              A2AJST                          WVAJST
     I              A2AHVN                          WVAHVN
     I              A2AGVN                          WVAGVN
     I              A2ABVN                          WVABVN
     I              A2ABDT                          WVABDT
     I              A2ABTM                          WVABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     I@1DBRC    E DSPKA1CPL1
      * UPD : Tattoo Header             Update index
      * Current/previous master file format fields for change control
      *
     I#1DBRC      DS                            582
      * Stored master file format fields
     I                                        1   1 #1DB1
      *
     IQPKFJ1    E DSPKFJCPL0
      * UPD : Tattoo Pending            Update index
      * Renamed input format fields
     I              FJHONB                          WFHONB
     I              FJEZDT                          WFEZDT
     I              FJHSA1                          WFHSA1
     I              FJHMNB                          WFHMNB
     I              FJBNNB                          WFBNNB
     I              FJBONB                          WFBONB
     I              FJHRA1                          WFHRA1
     I              FJBKTM                          WFBKTM
     I              FJWPST                          WFWPST
     I              FJWQST                          WFWQST
     I              FJMIA1                          WFMIA1
     I              FJAAVN                          WFAAVN
     I              FJAADT                          WFAADT
     I              FJAMTM                          WFAMTM
     I              FJAJST                          WFAJST
     I              FJAHVN                          WFAHVN
     I              FJAGVN                          WFAGVN
     I              FJABVN                          WFABVN
     I              FJABDT                          WFABDT
     I              FJABTM                          WFABTM
      *
     IYARDCS      DS                             86
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPKA31    E DSPKA3REL0
      * UPD : Pen                       Update index
      * Renamed input format fields
     I              A3HVNB                          WJHVNB
     I              A3CMCD                          WJCMCD
     I              A3BBTX                          WJBBTX
     I              A3CTNB                          WJCTNB
     I              A3D6NB                          WJD6NB
     I              A3B6CD                          WJB6CD
     I              A3DGST                          WJDGST
     I              A3EBNB                          WJEBNB
     I              A3FWST                          WJFWST
     I              A3HBNB                          WJHBNB
     I              A3AGCD                          WJAGCD
     I              A3AAVN                          WJAAVN
     I              A3AADT                          WJAADT
     I              A3AMTM                          WJAMTM
     I              A3AJST                          WJAJST
     I              A3AHVN                          WJAHVN
     I              A3AGVN                          WJAGVN
     I              A3ABVN                          WJABVN
     I              A3ABDT                          WJABDT
     I              A3ABTM                          WJABTM
      *
     IYBRDCS      DS                            107
     IYCRDCS      DS                            107
     IYDRDCS      DS                            107
     IYERDCS      DS                            107
     IQPKAX1    E DSPKAXCPL1
      * UPD : Buy Order Load            Update index
      * Renamed input format fields
     I              AXHMNB                          WKHMNB
     I              AXBNNB                          WKBNNB
     I              AXBONB                          WKBONB
     I              AXCQDT                          WKCQDT
     I              AXABTH                          WKABTH
     I              AXACTH                          WKACTH
     I              AXBPNB                          WKBPNB
     I              AXCSNB                          WKCSNB
     I              AXAUDT                          WKAUDT
     I              AXCMST                          WKCMST
     I              AXAGPR                          WKAGPR
     I              AXATVA                          WKATVA
     I              AXI1ST                          WKI1ST
     I              AXDHNB                          WKDHNB
     I              AXDINB                          WKDINB
     I              AXCNST                          WKCNST
     I              AXGINB                          WKGINB
     I              AXBZDT                          WKBZDT
     I              AXLSNB                          WKLSNB
     I              AXF3TX                          WKF3TX
     I              AXO8ST                          WKO8ST
     I              AXO9ST                          WKO9ST
     I              AXPAST                          WKPAST
     I              AXLDSH                          WKLDSH
     I              AXPBST                          WKPBST
     I              AXPCST                          WKPCST
     I              AXPDST                          WKPDST
     I              AXUWST                          WKUWST
     I              AXUXST                          WKUXST
     I              AXUYST                          WKUYST
     I              AXJKRU                          WKJKRU
     I              AXKEOR                          WKKEOR
     I              AXIOEW                          WKIOEW
     I              AXKJIO                          WKKJIO
     I              AXIOJR                          WKIOJR
     I              AXEIRR                          WKEIRR
     I              AXITMF                          WKITMF
     I              AXODJE                          WKODJE
     I              AXRJIF                          WKRJIF
     I              AXOEJF                          WKOEJF
     I              AXD0DT                          WKD0DT
     I              AXD1DT                          WKD1DT
     I              AXD2DT                          WKD2DT
     I              AXD3DT                          WKD3DT
     I              AXD4DT                          WKD4DT
     I              AXBNCD                          WKBNCD
     I              AXABCD                          WKABCD
     I              AXAECD                          WKAECD
     I              AXAAVN                          WKAAVN
     I              AXAADT                          WKAADT
     I              AXAMTM                          WKAMTM
     I              AXAJST                          WKAJST
     I              AXAHVN                          WKAHVN
     I              AXAGVN                          WKAGVN
     I              AXABVN                          WKABVN
     I              AXABDT                          WKABDT
     I              AXABTM                          WKABTM
      *
     IYFRDCS      DS                            236
     IQPKAW1    E DSPKAWCPL0
      * UPD : Buy Order Header          Update index
      * Renamed input format fields
     I              AWHMNB                          WLHMNB
     I              AWBNNB                          WLBNNB
     I              AWARDT                          WLARDT
     I              AWASDT                          WLASDT
     I              AWA4ST                          WLA4ST
     I              AWA5ST                          WLA5ST
     I              AWAAPR                          WLAAPR
     I              AWA6ST                          WLA6ST
     I              AWA7ST                          WLA7ST
     I              AWB3ST                          WLB3ST
     I              AWALPR                          WLALPR
     I              AWETCD                          WLETCD
     I              AWEUCD                          WLEUCD
     I              AWJ5TX                          WLJ5TX
     I              AWD5DT                          WLD5DT
     I              AWD6DT                          WLD6DT
     I              AWD7DT                          WLD7DT
     I              AWD8DT                          WLD8DT
     I              AWD9DT                          WLD9DT
     I              AWJOEJ                          WLJOEJ
     I              AWKOFF                          WLKOFF
     I              AWKWPE                          WLKWPE
     I              AWIMBF                          WLIMBF
     I              AWOPTR                          WLOPTR
     I              AWOEJD                          WLOEJD
     I              AWIRMF                          WLIRMF
     I              AWJIRM                          WLJIRM
     I              AWJRKF                          WLJRKF
     I              AWKFIR                          WLKFIR
     I              AWUZST                          WLUZST
     I              AWU0ST                          WLU0ST
     I              AWU1ST                          WLU1ST
     I              AWU2ST                          WLU2ST
     I              AWU3ST                          WLU3ST
     I              AWHXNB                          WLHXNB
     I              AWGANB                          WLGANB
     I              AWGBNB                          WLGBNB
     I              AWABCD                          WLABCD
     I              AWAECD                          WLAECD
     I              AWAKCD                          WLAKCD
     I              AWALCD                          WLALCD
     I              AWAGCD                          WLAGCD
     I              AWAICD                          WLAICD
     I              AWAMCD                          WLAMCD
     I              AWACCD                          WLACCD
     I              AWAAVN                          WLAAVN
     I              AWAADT                          WLAADT
     I              AWAMTM                          WLAMTM
     I              AWAJST                          WLAJST
     I              AWAHVN                          WLAHVN
     I              AWAGVN                          WLAGVN
     I              AWABVN                          WLABVN
     I              AWABDT                          WLABDT
     I              AWABTM                          WLABTM
      *
     IYGRDCS      DS                            218
     IQPLAE1    E DSPLAECPL1
      * UPD : Delivery Sched Detail     Update index
      * Renamed input format fields
     I              AEHONB                          WMHONB
     I              AEE0DT                          WME0DT
     I              AEE6DT                          WME6DT
     I              AEAGTH                          WMAGTH
     I              AEHZA1                          WMHZA1
     I              AEH0A1                          WMH0A1
     I              AEH1A1                          WMH1A1
     I              AEJ4CD                          WMJ4CD
     I              AEJ5CD                          WMJ5CD
     I              AELBCD                          WMLBCD
     I              AELCCD                          WMLCCD
     I              AEIOA1                          WMIOA1
     I              AEH2A1                          WMH2A1
     I              AEIJA1                          WMIJA1
     I              AEK9CD                          WMK9CD
     I              AEK8CD                          WMK8CD
     I              AEJ6CD                          WMJ6CD
     I              AEJ7CD                          WMJ7CD
     I              AEMGCD                          WMMGCD
     I              AEW1ST                          WMW1ST
     I              AEW2ST                          WMW2ST
     I              AEH3A1                          WMH3A1
     I              AEMECD                          WMMECD
     I              AEMFCD                          WMMFCD
     I              AEW4ST                          WMW4ST
     I              AEXWST                          WMXWST
     I              AEFRDT                          WMFRDT
     I              AEBOTH                          WMBOTH
     I              AEE7DT                          WME7DT
     I              AEAHTH                          WMAHTH
     I              AEE8DT                          WME8DT
     I              AEAITH                          WMAITH
     I              AEXBST                          WMXBST
     I              AEXGST                          WMXGST
     I              AEXPST                          WMXPST
     I              AEXNST                          WMXNST
     I              AEXTST                          WMXTST
     I              AEXLST                          WMXLST
     I              AEW0ST                          WMW0ST
     I              AEYEST                          WMYEST
     I              AEFZDT                          WMFZDT
     I              AEB1TH                          WMB1TH
     I              AEAACD                          WMAACD
     I              AEABCD                          WMABCD
     I              AEAECD                          WMAECD
     I              AEHMNB                          WMHMNB
     I              AEBNNB                          WMBNNB
     I              AEBONB                          WMBONB
     I              AEAAVN                          WMAAVN
     I              AEAADT                          WMAADT
     I              AEAMTM                          WMAMTM
     I              AEAJST                          WMAJST
     I              AEAHVN                          WMAHVN
     I              AEAGVN                          WMAGVN
     I              AEABVN                          WMABVN
     I              AEABDT                          WMABDT
     I              AEABTM                          WMABTM
      *
     IYHRDCS      DS                            232
     IYIRDCS      DS                            236
     IQPKDZ1    E DSPKDZREL0
      * UPD : Tattoo Defect             Update index
      * Renamed input format fields
     I              DZHMNB                          WOHMNB
     I              DZBNNB                          WOBNNB
     I              DZBONB                          WOBONB
     I              DZCVNB                          WOCVNB
     I              DZB0DT                          WOB0DT
     I              DZBDCD                          WOBDCD
     I              DZLJNB                          WOLJNB
     I              DZBECD                          WOBECD
     I              DZB7SS                          WOB7SS
     I              DZB8SS                          WOB8SS
     I              DZB9SS                          WOB9SS
     I              DZCASS                          WOCASS
     I              DZNXA1                          WONXA1
     I              DZNYA1                          WONYA1
     I              DZNZA1                          WONZA1
     I              DZAAVN                          WOAAVN
     I              DZAADT                          WOAADT
     I              DZAMTM                          WOAMTM
     I              DZAJST                          WOAJST
     I              DZAHVN                          WOAHVN
     I              DZAGVN                          WOAGVN
     I              DZABVN                          WOABVN
     I              DZABDT                          WOABDT
     I              DZABTM                          WOABTM
      *
     IQPLAF1    E DSPLAFCPL0
      * UPD : Delivery Tracking         Update index
      * Renamed input format fields
     I              AFHONB                          WRHONB
     I              AFE0DT                          WRE0DT
     I              AFE9DT                          WRE9DT
     I              AFAJTH                          WRAJTH
     I              AFH4A1                          WRH4A1
     I              AFFXDT                          WRFXDT
     I              AFJIA1                          WRJIA1
     I              AFIBA1                          WRIBA1
     I              AFW5ST                          WRW5ST
     I              AFICA1                          WRICA1
     I              AFK0CD                          WRK0CD
     I              AFK1CD                          WRK1CD
     I              AFLFCD                          WRLFCD
     I              AFLGCD                          WRLGCD
     I              AFIDA1                          WRIDA1
     I              AFIPA1                          WRIPA1
     I              AFLICD                          WRLICD
     I              AFJ8CD                          WRJ8CD
     I              AFJ9CD                          WRJ9CD
     I              AFMGCD                          WRMGCD
     I              AFXHST                          WRXHST
     I              AFXIST                          WRXIST
     I              AFIEA1                          WRIEA1
     I              AFKBCD                          WRKBCD
     I              AFKZCD                          WRKZCD
     I              AFLHCD                          WRLHCD
     I              AFFADT                          WRFADT
     I              AFAKTH                          WRAKTH
     I              AFBYTH                          WRBYTH
     I              AFW6ST                          WRW6ST
     I              AFXXST                          WRXXST
     I              AFFBDT                          WRFBDT
     I              AFALTH                          WRALTH
     I              AFBVTH                          WRBVTH
     I              AFAMTH                          WRAMTH
     I              AFFCDT                          WRFCDT
     I              AFANTH                          WRANTH
     I              AFBHTH                          WRBHTH
     I              AFFDDT                          WRFDDT
     I              AFAOTH                          WRAOTH
     I              AFBWTH                          WRBWTH
     I              AFAPTH                          WRAPTH
     I              AFFEDT                          WRFEDT
     I              AFAQTH                          WRAQTH
     I              AFARTH                          WRARTH
     I              AFFFDT                          WRFFDT
     I              AFASTH                          WRASTH
     I              AFATTH                          WRATTH
     I              AFFGDT                          WRFGDT
     I              AFAUTH                          WRAUTH
     I              AFFHDT                          WRFHDT
     I              AFAVTH                          WRAVTH
     I              AFAWTH                          WRAWTH
     I              AFBKTH                          WRBKTH
     I              AFBLTH                          WRBLTH
     I              AFXJST                          WRXJST
     I              AFK3CD                          WRK3CD
     I              AFFIDT                          WRFIDT
     I              AFAXTH                          WRAXTH
     I              AFAYTH                          WRAYTH
     I              AFFJDT                          WRFJDT
     I              AFAZTH                          WRAZTH
     I              AFA0TH                          WRA0TH
     I              AFFKDT                          WRFKDT
     I              AFA1TH                          WRA1TH
     I              AFA2TH                          WRA2TH
     I              AFFLDT                          WRFLDT
     I              AFA3TH                          WRA3TH
     I              AFA4TH                          WRA4TH
     I              AFBTTH                          WRBTTH
     I              AFFMDT                          WRFMDT
     I              AFA5TH                          WRA5TH
     I              AFA6TH                          WRA6TH
     I              AFBXTH                          WRBXTH
     I              AFXKST                          WRXKST
     I              AFYDST                          WRYDST
     I              AFFYDT                          WRFYDT
     I              AFB0TH                          WRB0TH
     I              AFBZTH                          WRBZTH
     I              AFH2A1                          WRH2A1
     I              AFJ2A1                          WRJ2A1
     I              AFJ3A1                          WRJ3A1
     I              AFKMA1                          WRKMA1
     I              AFJ4A1                          WRJ4A1
     I              AFJ5A1                          WRJ5A1
     I              AFJ6A1                          WRJ6A1
     I              AFJ7A1                          WRJ7A1
     I              AFJ8A1                          WRJ8A1
     I              AFJ9A1                          WRJ9A1
     I              AFKAA1                          WRKAA1
     I              AFKBA1                          WRKBA1
     I              AFKCA1                          WRKCA1
     I              AFKDA1                          WRKDA1
     I              AFKEA1                          WRKEA1
     I              AFKFA1                          WRKFA1
     I              AFKNA1                          WRKNA1
     I              AFKGA1                          WRKGA1
     I              AFKHA1                          WRKHA1
     I              AFKOA1                          WRKOA1
     I              AFKIA1                          WRKIA1
     I              AFKJA1                          WRKJA1
     I              AFKKA1                          WRKKA1
     I              AFKLA1                          WRKLA1
     I              AFYNST                          WRYNST
     I              AFYOST                          WRYOST
     I              AFABCD                          WRABCD
     I              AFAECD                          WRAECD
     I              AFAACD                          WRAACD
     I              AFHMNB                          WRHMNB
     I              AFBNNB                          WRBNNB
     I              AFBONB                          WRBONB
     I              AFAAVN                          WRAAVN
     I              AFAADT                          WRAADT
     I              AFAMTM                          WRAMTM
     I              AFAJST                          WRAJST
     I              AFAHVN                          WRAHVN
     I              AFAGVN                          WRAGVN
     I              AFABVN                          WRABVN
     I              AFABDT                          WRABDT
     I              AFABTM                          WRABTM
      *
     IYJRDCS      DS                            454
     IQPKDN1    E DSPKDNCPL0
      * UPD : Tattoo Header EXT         Update index
      * Renamed input format fields
     I              DNHMNB                          WSHMNB
     I              DNBNNB                          WSBNNB
     I              DNBONB                          WSBONB
     I              DNCVNB                          WSCVNB
     I              DNB0DT                          WSB0DT
     I              DNI5PR                          WSI5PR
     I              DNJBPR                          WSJBPR
     I              DNI6PR                          WSI6PR
     I              DNI7PR                          WSI7PR
     I              DNI8PR                          WSI8PR
     I              DNI9PR                          WSI9PR
     I              DNJAPR                          WSJAPR
     I              DNJCPR                          WSJCPR
     I              DNJDPR                          WSJDPR
     I              DNJEPR                          WSJEPR
     I              DNJFPR                          WSJFPR
     I              DNJGPR                          WSJGPR
     I              DNJHPR                          WSJHPR
     I              DNJIPR                          WSJIPR
     I              DNJJPR                          WSJJPR
     I              DNJKPR                          WSJKPR
     I              DNJLPR                          WSJLPR
     I              DNJMPR                          WSJMPR
     I              DNJNPR                          WSJNPR
     I              DNJOPR                          WSJOPR
     I              DNLTBF                          WSLTBF
     I              DNHZPC                          WSHZPC
     I              DNLTHW                          WSLTHW
     I              DNH0PC                          WSH0PC
     I              DNGTBF                          WSGTBF
     I              DNH1PC                          WSH1PC
     I              DNGTHW                          WSGTHW
     I              DNH2PC                          WSH2PC
     I              DNHLBF                          WSHLBF
     I              DNHLLE                          WSHLLE
     I              DNHLHW                          WSHLHW
     I              DNHLLP                          WSHLLP
     I              DNHGBF                          WSHGBF
     I              DNHGLE                          WSHGLE
     I              DNHGHW                          WSHGHW
     I              DNHFLP                          WSHFLP
     I              DNSNA1                          WSSNA1
     I              DNSOA1                          WSSOA1
     I              DNSPA1                          WSSPA1
     I              DNDGSS                          WSDGSS
     I              DNDHSS                          WSDHSS
     I              DNDISS                          WSDISS
     I              DNABCD                          WSABCD
     I              DNNYCD                          WSNYCD
     I              DNOVCD                          WSOVCD
     I              DNAAVN                          WSAAVN
     I              DNAADT                          WSAADT
     I              DNAMTM                          WSAMTM
     I              DNAJST                          WSAJST
     I              DNAHVN                          WSAHVN
     I              DNAGVN                          WSAGVN
     I              DNABVN                          WSABVN
     I              DNABDT                          WSABDT
     I              DNABTM                          WSABTM
      *
     IQPKA21    E DSPKA2CPL0
      * UPD : Tattoo Detail             Update index
      * Renamed input format fields
     I              A2HMNB                          WTHMNB
     I              A2BNNB                          WTBNNB
     I              A2BONB                          WTBONB
     I              A2CVNB                          WTCVNB
     I              A2B0DT                          WTB0DT
     I              A2C2NB                          WTC2NB
     I              A2CZNB                          WTCZNB
     I              A2C0NB                          WTC0NB
     I              A2D8NB                          WTD8NB
     I              A2H7NB                          WTH7NB
     I              A2GGST                          WTGGST
     I              A2AJTM                          WTAJTM
     I              A2JEA1                          WTJEA1
     I              A2B7CD                          WTB7CD
     I              A2D7NB                          WTD7NB
     I              A2D9ST                          WTD9ST
     I              A2E3ST                          WTE3ST
     I              A2E4ST                          WTE4ST
     I              A2E5ST                          WTE5ST
     I              A2BVDT                          WTBVDT
     I              A2BWDT                          WTBWDT
     I              A2BXDT                          WTBXDT
     I              A2HVNB                          WTHVNB
     I              A2CMCD                          WTCMCD
     I              A2B9CD                          WTB9CD
     I              A2H8NB                          WTH8NB
     I              A2CYCD                          WTCYCD
     I              A2AAVN                          WTAAVN
     I              A2AADT                          WTAADT
     I              A2AMTM                          WTAMTM
     I              A2AJST                          WTAJST
     I              A2AHVN                          WTAHVN
     I              A2AGVN                          WTAGVN
     I              A2ABVN                          WTABVN
     I              A2ABDT                          WTABDT
     I              A2ABTM                          WTABTM
      *
     IYKRDCS      DS                            132
     IYLRDCS      DS                            236
     IYMRDCS      DS                            107
     IYNRDCS      DS                            107
     IYORDCS      DS                            107
     IYPRDCS      DS                            107
     IYQRDCS      DS                            107
     IYRRDCS      DS                            107
     IYSRDCS      DS                            107
     IYTRDCS      DS                            107
     IYURDCS      DS                            454
     IYVRDCS      DS                            582
     IYWRDCS      DS                            236
     IYXRDCS      DS                            582
     IYYRDCS      DS                            236
     IYZRDCS      DS                            107
     IY0RDCS      DS                            217
     IY1RDCS      DS                            217
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
     IY2RDCS      DS                             86
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Tattoo Header
      * I : RST BOH Company Number
     I                                    P   1   20P1HMNB
      * I : RST BOH Buy Order Number
     I                                    P   3   50P1BNNB
      * I : RST BOL Load Number
     I                                    P   6   80P1BONB
      * B : RST TH Tattoo Number
     I                                    P   9  110P1CVNB
      * I : RST TH Kill Date
     I                                    P  12  150P1B0DT
      * I :  TH Group Reference
     I                                       16  25 P1BICD
      * N :  TH Dead On Arrival
     I                                    P  26  280P1CXNB
      * I : MAP TH Sex
     I                                       29  29 P1E2ST
      * I : MAP TH HPS Movement Ref #
     I                                    P  30  330P1OXNB
      * I : MAP TH Hog Class Type
     I                                       34  34 P1LLST
      * I : MAP PD Producer Code
     I                                       35  40 P1ABCD
      * I : MAP PL Location Code
     I                                       41  46 P1AECD
      * I : MAP GN Genetic Code
     I                                       47  51 P1AGCD
     IP2PARM      DS
      * FLD: *Arrays
      * I :  Oms System Value Alpha
     I                                        1  40 P2EVTX
      * I :  Name USR
     I                                       41  80 P2BSTX
      * I :  BOL Pln Delv Date
     I                                    P  81  840P2AUDT
      * B : MAP Record Added Usr
     I                                       85  85 P2IHST
      * I :  PD Name
     I                                       86 125 P2AGTX
      * I :  PL Name
     I                                      126 165 P2A8TX
      * I :  User modified: 0-not modi
     I                                      166 166 P2UMOD
      * N :  State
     I                                      167 169 P2DRTX
      * I :  Company Value Code    USR
     I                                      170 179 P2FACD
      * I :  SBD Top Load Sts
     I                                      180 180 P2WEST
     IP3PARM      DS
      * FLD: Source
      * N :  SR Source Code
     I                                        1   3 P3AACD
      * N :  SR Description
     I                                        4  28 P3AFTX
      * N :  SR Type
     I                                       29  29 P3IXST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'State Code Invalid'
      * State
     I                                        1   3 ZA0001
      * Message data for 'State Code Invalid'
      * State
     I                                        1   3 ZA0002
      * Message data for 'Producer Site ID Required'
      * PS Site ID
     I                                        1  10 ZA0003
      * Message data for 'Producer Site/Mileage NF'
      * PS Site ID
     I                                        1  10 ZA0004
      * Message data for 'State Code Invalid'
      * State
     I                                        1   3 ZA0005
      * Message data for 'Producer Subsidiary Req'
      * Producer Subsidiary Code
     I                                        1   6 ZA0006
      * Message data for 'Producer Subsidiary NotFn'
      * Producer Subsidiary Code
     I                                        1   6 ZA0007
      * Message data for 'Tattoo Def Not Fnd Error'
      * Defect Code Usr
     I                                        1   6 ZA0008
      * Message data for 'Tattoo Def Not Fnd Error'
      * Defect Code Usr
     I                                        1   6 ZA0009
      * Message data for 'Tattoo Def Not Fnd Error'
      * Defect Code Usr
     I                                        1   6 ZA0010
      * Message data for 'Tattoo Def Not Fnd Error'
      * Defect Code Usr
     I                                        1   6 ZA0011
      * Message data for 'Tattoo Def Not Fnd Error'
      * Defect Code Usr
     I                                        1   6 ZA0012
      * Message data for 'Tattoo Def Not Fnd Error'
      * Defect Code Usr
     I                                        1   6 ZA0013
      * Message data for 'Tattoo Def Not Fnd Error'
      * Defect Code Usr
     I                                        1   6 ZA0014
      * Message data for 'Tattoo Def Not Fnd Error'
      * Defect Code Usr
     I                                        1   6 ZA0015
      * Message data for 'Tattoo Def Not Fnd Error'
      * Defect Code Usr
     I                                        1   6 ZA0016
      * Message data for 'Tattoo Def Not Fnd Error'
      * Defect Code Usr
     I                                        1   6 ZA0017
      * Message data for 'Class code inval for type'
      * TH Hog Class Type
     I                                        1   1 ZA0018
      * HC Class Code
     I                                        2   4 ZA0019
      * Message data for 'Enter Head On BOL'
      * BOL Shipped Head
     I                                    P   1   30ZA0020
      * Message data for 'State Code Invalid'
      * State
     I                                        1   3 ZA0021
      * Message data for 'Pen is req for rsl/int'
      * Pen Number
     I                                        1   3 ZA0022
      * Message data for 'Pen type not the same as'
      * Pen Number
     I                                        1   3 ZA0023
      * HC Class Type
     I                                        4   4 ZA0024
      * Pen Type
     I                                        5   5 ZA0025
      * Message data for 'Shipped Weight is Requird'
      * TH Shipped Weight
     I                                    P   1   41ZA0026
      * Message data for 'Defect NAllow on Hog Type'
      * HC Class Type
     I                                        1   1 ZA0027
      * DF Defect Code
     I                                        2   7 ZA0028
      * DF Classification Defs
     I                                        8   8 ZA0029
      * Message data for 'Defect NAllow on Hog Type'
      * HC Class Type
     I                                        1   1 ZA0030
      * DF Defect Code
     I                                        2   7 ZA0031
      * DF Classification Defs
     I                                        8   8 ZA0032
      * Message data for 'Defect NAllow on Hog Type'
      * HC Class Type
     I                                        1   1 ZA0033
      * DF Defect Code
     I                                        2   7 ZA0034
      * DF Classification Defs
     I                                        8   8 ZA0035
      * Message data for 'Defect NAllow on Hog Type'
      * HC Class Type
     I                                        1   1 ZA0036
      * DF Defect Code
     I                                        2   7 ZA0037
      * DF Classification Defs
     I                                        8   8 ZA0038
      * Message data for 'Defect NAllow on Hog Type'
      * HC Class Type
     I                                        1   1 ZA0039
      * DF Defect Code
     I                                        2   7 ZA0040
      * DF Classification Defs
     I                                        8   8 ZA0041
      * Message data for 'Defect NAllow on Hog Type'
      * HC Class Type
     I                                        1   1 ZA0042
      * DF Defect Code
     I                                        2   7 ZA0043
      * DF Classification Defs
     I                                        8   8 ZA0044
      * Message data for 'Defect NAllow on Hog Type'
      * HC Class Type
     I                                        1   1 ZA0045
      * DF Defect Code
     I                                        2   7 ZA0046
      * DF Classification Defs
     I                                        8   8 ZA0047
      * Message data for 'Defect NAllow on Hog Type'
      * HC Class Type
     I                                        1   1 ZA0048
      * DF Defect Code
     I                                        2   7 ZA0049
      * DF Classification Defs
     I                                        8   8 ZA0050
      * Message data for 'Defect NAllow on Hog Type'
      * HC Class Type
     I                                        1   1 ZA0051
      * DF Defect Code
     I                                        2   7 ZA0052
      * DF Classification Defs
     I                                        8   8 ZA0053
      * Message data for 'Defect NAllow on Hog Type'
      * HC Class Type
     I                                        1   1 ZA0054
      * DF Defect Code
     I                                        2   7 ZA0055
      * DF Classification Defs
     I                                        8   8 ZA0056
      * Message data for 'State Code Invalid'
      * State
     I                                        1   3 ZA0057
      * Message data for 'Tattoo &1 has been added.'
      * TH Tattoo Number
     I                                    P   1   30ZA0058
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HMNB    PARM           WP0001  30       BOH Company Num
     C           P1BNNB    PARM           WP0002  50       BOH Buy Order N
     C           P1BONB    PARM           WP0003  50       BOL Load Number
     C           P1CVNB    PARM P1CVNB    WP0004  50       TH Tattoo Numbe
     C           P1B0DT    PARM           WP0005  70       TH Kill Date
     C           P1BICD    PARM           WP0006 10        TH Group Refere
     C           P1E2ST    PARM           WP0007  1        TH Sex
     C           P1OXNB    PARM           WP0008  70       TH HPS Movement
     C           P1LLST    PARM           WP0009  1        TH Hog Class Ty
     C           P1ABCD    PARM           WP0010  6        PD Producer Cod
     C           P1AECD    PARM           WP0011  6        PL Location Cod
     C           P1AGCD    PARM           WP0012  5        GN Genetic Code
     C           P2EVTX    PARM           WP0013 40        Oms System Valu
     C           P2BSTX    PARM           WP0014 40        Name USR
     C           P2AUDT    PARM           WP0015  70       BOL Pln Delv Da
     C           P2IHST    PARM P2IHST    WP0016  1        Record Added Us
     C           P2AGTX    PARM           WP0017 40        PD Name
     C           P2A8TX    PARM           WP0018 40        PL Name
     C           P2UMOD    PARM           WP0019  1        User modified:
     C           P2FACD    PARM           WP0020 10        Company Value C
     C           P2WEST    PARM           WP0021  1        SBD Top Load St
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Check passed parameters
     C                     EXSR FACKPM
      * Perform once if all passed, else repeat
     C           W0RPT     DOUEQ'N'
      * Display and process key screen
     C                     EXSR BADSKY
     C                     END
      * Terminate program
     C                     EXSR ZXEXPG
      *****************************************************************
      /EJECT
     CSR         BADSKY    BEGSR
      *================================================================
      * Display and process key screen
      *================================================================
      * Bypass first display of key screen is possible
     C                     MOVEL'Y'       W0BYP   1
      * Initialize key screen
     C                     EXSR MDIZ#K
      * Signal start of transaction
     C                     MOVEL'Y'       W0TRN   1
     C           W0TRN     DOWEQ'Y'
     C           W0TRN     OREQ 'K'
      * Ensure transaction continues (if reset)
     C                     MOVEL'Y'       W0TRN   1
      * Conduct screen conversation
     C           W0TRN     DOWEQ'Y'
      * Convert internal to external form
     C  N09                EXSR MNCV#K
      * Is bypass key screen still viable?
     C           W0BYP     IFEQ 'Y'
     C           #1HMNB    IFEQ *ZERO                      BOH Company Num
     C           #1BNNB    OREQ *ZERO                      BOH Buy Order N
     C           #1BONB    OREQ *ZERO                      BOL Load Number
     C           #1B0DT    OREQ *ZERO                      TH Kill Date
     C           #1CVNB    OREQ *ZERO                      TH Tattoo Numbe
      * One or more key fields is blank
     C           *IN30     OREQ '1'
      * HOME: Reset screen fields
     C                     MOVEL'N'       W0BYP
     C                     END
     C                     END
      * Bypass key screen
     C           W0BYP     IFEQ 'N'
      * Display key screen
     C                     EXSR BBEXFM
     C                     END
      * Cancel key screen bypass
     C                     MOVEL'N'       W0BYP
      * Process response to key screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * Switch between *ADD/*CHANGE modes
     C   09                CAS            BCCHMD
      * HOME: Reset screen fields
     C   30                CAS            BDHMKY
      * Process key screen input
     C                     CAS            BEPRKY
     C                     END
     C           W0TRN     DOWEQ'R'
     C                     MOVEL'Y'       W0TRN
     C                     EXSR BEPRKY
     C                     END
      *
     C                     END
     C                     END
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBEXFM    BEGSR
      *================================================================
      * Display key screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSAK
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * PUTOVR unless conditioned fields change
     C                     SETON                         86*
     C           *IN89     IFNE BBIN89
     C                     SETOF                         86*
     C                     END
     C                     MOVE *IN89     BBIN89  1
     C                     MOVEL'K'       W0GRP   1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDKEY
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1
      * Reset global error indicator
     C                     SETOF                         99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         BCCHMD    BEGSR
      *================================================================
      * Switch between *ADD/*CHANGE modes
      *================================================================
     C           W0PMD     IFEQ 'ADD'
     C                     MOVEL'CHG'     W0PMD   3
     C                     ELSE
     C                     MOVEL'ADD'     W0PMD
     C                     END
      *================================================================
     CSR         BCEXIT    ENDSR
      /EJECT
     CSR         BDHMKY    BEGSR
      *================================================================
      * Process HOME key
      *================================================================
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         BDEXIT    ENDSR
      /EJECT
     CSR         BEPRKY    BEGSR
      *================================================================
      * Process key screen input
      *================================================================
      * Initialise detail screen
     C                     EXSR MAIZ#1
      * Validate key fields
     C                     EXSR BFVLKY
     C           *IN99     CABEQ'1'       BEEXIT
     C           YPMTFD    CABNE*BLANKS   BEEXIT
      * Check for existing record
     C           KRTV      KLIST
     C                     KFLD           A1HMNB           BOH Company Num
     C                     KFLD           A1BNNB           BOH Buy Order N
     C                     KFLD           A1BONB           BOL Load Number
     C                     KFLD           A1CVNB           TH Tattoo Numbe
     C                     KFLD           A1B0DT           TH Kill Date
      * Setup key
     C                     Z-ADD#1HMNB    A1HMNB
     C                     Z-ADD#1BNNB    A1BNNB
     C                     Z-ADD#1BONB    A1BONB
     C                     Z-ADD#1CVNB    A1CVNB
     C                     Z-ADD#1B0DT    A1B0DT
     C           KRTV      CHAIN@A1CPC4              9091  *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     SETON                     9931  *
     C                     GOTO BEEXIT
     C                     END                             FI 91
      *
      * If record does not exist, flip to add mode
     C           *IN90     IFEQ '1'
     C                     MOVEL'ADD'     W0PMD
      * USER: Initialize detail screen (new record)
     C                     MOVEL'N'       YL0001           TattooPend Set
      * 9/22/2008 slm
      * do to adding fields to screen set cursor on new rules
      * Set Cursor
      * CASE: PAR.TH Hog Class Type is Market
     C           P1LLST    IFEQ 'M'                        *IF
      * set cursor  --- rules on when to position to Producer subsidary
      * CASE: DTL.BOL Load Shipped Head is Not Zero
     C           #DLDSH    IFNE *ZERO                      *IF
      * *Set Cursor: DTL.Producer Subsidary Code  (*Override=*YES)
     C                     Z-ADD007       W0ROW1
     C                     Z-ADD031       W0COL1
     C                     MOVEL'1'       W0OVR1           *YES
     C                     ELSE
      * CASE: *OTHERWISE
      * *Set Cursor: DTL.Producer Subsidary Code  (*Override=*YES)
     C                     Z-ADD007       W0ROW1
     C                     Z-ADD031       W0COL1
     C                     MOVEL'1'       W0OVR1           *YES
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * set cursor  --- rules on when to position to Class Code
      * CASE: DTL.BOL Load Shipped Head is Not Zero
     C           #DLDSH    IFNE *ZERO                      *IF
      * *Set Cursor: DTL.HC Class Code  (*Override=*YES)
     C                     Z-ADD008       W0ROW1
     C                     Z-ADD031       W0COL1
     C                     MOVEL'1'       W0OVR1           *YES
     C                     ELSE
      * CASE: *OTHERWISE
      * *Set Cursor: DTL.HC Class Code  (*Override=*NO)
     C                     Z-ADD008       W0ROW1
     C                     Z-ADD031       W0COL1
     C                     MOVEL'0'       W0OVR1           *NO
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    #DOVCD           Producer Subsid
     C                     Z-ADDP1OXNB    #1OXNB           TH HPS Movement
     C                     MOVELP1BICD    #1BICD           TH Group Refere
     C                     MOVELP1E2ST    #1E2ST           TH Sex
     C                     MOVELP1AGCD    #1AGCD           GN Genetic Code
     C                     MOVELP2BSTX    #DBSTX           Name USR
     C                     Z-ADD#1B0DT    #1AWDT           TH Purchase Dat
     C                     MOVELP2AGTX    #DAGTX           PD Name
     C                     MOVELP1LLST    #1LLST           TH Hog Class Ty
      * DTL.Description 30 USR = Condition name of DTL.TH Hog Class Type
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1110255   Y2LSNO  70       List number
     C                     PARM #1LLST    W0INVL 25        TH Hog Class Ty
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DKKTX    PARM           W0CNNM 25        Description 30
      *
     C                     MOVELP3AACD    #1LKST           TH Source Code
      * 1/16/06 slm Initial fields on site from prior records
      *       change to only get the producer location one time.
     C                     MOVEL*BLANK    #DNYCD           PS Site ID
     C                     MOVEL'N'       #DQTST           PL Site ID Requ
      * get site id required and th state
      * Rtv PL Vnd Nbr, state RT - Producer Location  * 
     C                     EXSR SARVGN
      * CASE: DTL.TH Hog Class Type is Resale
     C           #1LLST    IFEQ 'R'                        *IF
     C                     MOVEL'N'       #DQTST           PL Site ID Requ
     C                     MOVEL*BLANK    #DNYCD           PS Site ID
     C                     END                             *FI
      * CASE: DTL.PL Site ID Required is Yes
     C           #DQTST    IFEQ 'Y'                        *IF
      * get site id
      * Rtv Site ID            RT - Tattoo Header EXT  * 
     C                     EXSR SBRVGN
      * get th state
      * Rtv Site State ActOnlyRT - Producer Site  * 
     C                     EXSR SCRVGN
     C                     END                             *FI
      * ** Don't exchange the screen field and the hidden state field
      * ** Just use the screen state field.      03/07/2006 LJB
      * 042606 slm -- chnges due to project on the site id and state code
      * Placed TH STATE CODE on the screen, def either prd loc, or site i
     C                     MOVELWUCRTX    YL0003           Return Code USR
      * Rtv State Description UP - STR VND Common Routines  * 
     C                     CALL 'STATERET'             90  Rtv State Descr
     C           YL0003    PARM YL0003    WQ0001  7        Return Code USR
     C                     PARM #1NZTX    WQ0002  3        State
     C           #DLXTX    PARM *BLANK    WQ0003 30        State Desc 30 U
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'STATERET'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     9941  *
     C                     END
      * Invalid state code send message
      * CASE: LCL.Return Code USR is *Normal
     C           YL0003    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1NZTX    ZA0001           TH State
      * Send message 'State Code Invalid'
     C                     MOVEL'PRK0308' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9941  *
      *
     C                     END                             *FI
     C                     MOVEL'N'       WUL9ST           Display Output
     C                     MOVEL'N'       WUMAST           Display Output
      * get defects/hd
     C                     EXSR UASUBR                     get defects/hd
      * Added by PKP 01/18/99 - retrieve movement number
      * CASE: DTL.TH Source Type is Internal
     C           #1KAST    IFEQ 'I'                        *IF
      * Rtv Movement Number   RT - Buy Order Load Weight  * 
     C                     EXSR SERVGN
     C                     MOVEL*BLANK    #1AGCD           GN Genetic Code
     C                     MOVEL'PIC'     #1AGCD           GN Genetic Code
     C                     END                             *FI
     C                     MOVEL'N'       #1J7ST           TH Scale Ticket
     C                     MOVEL*BLANK    #1C2ST           TH Resale Sprea
     C                     MOVEL*BLANK    WUKPST           @Status Interna
      * Retrieve hog classification
      * CASE: DTL.TH Hog Class Type is Resale
     C           #1LLST    IFEQ 'R'                        *IF
      * Rtv Hog Class Resale  RT - Hog Classification  * 
     C                     EXSR SFRVGN
      * CASE: DTL.TH Source Type is Internal
     C           #1KAST    IFEQ 'I'                        *IF
     C                     MOVEL'Y'       WUKPST           @Status Interna
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Hog Class Qualify RT - Hog Classification  * 
     C                     EXSR SGRVGN
     C                     END                             *FI
      * DTL.HC Class Type Desc Usr = Condition name of DTL.TH Hog Class T
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1110255   Y2LSNO  70       List number
     C                     PARM #1LLST    W0INVL 25        TH Hog Class Ty
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DE6TX    PARM           W0CNNM 25        HC Class Type D
      *
      * ******************************
      * Load description of pars passed in when a subj,rsl is created for
      * an existing tattoo.
      * Retrieve Group Reference Code (alpha) from HPS
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.TH Source Type is Internal
      *   |- c2    : PAR.TH Group Reference NE WRK.Blank USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1KAST    IFEQ 'I'                        *IF
     C           P1BICD    IFNE WUCRTX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv HPS Grp from Mvmt UP - STR HPS Interface  * 
     C                     CALL 'HP258'                90  Rtv HPS Grp fro
     C           WULMST    PARM WULMST    WQ0004  7        Return Code USR
     C                     PARM #1OXNB    WQ0005  70       TH HPS Movement
     C           #DEPCD    PARM *BLANK    WQ0006  7        HPS Group Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP258'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
     C                     END
     C                     END                             *FI
      * Get Sex name
      * CASE: DTL.TH Sex NE WRK.Blank USR
     C           #1E2ST    IFNE WUCRTX                     *IF
      * DTL.Sex Desc Usr = Condition name of PAR.TH Sex
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1135183   Y2LSNO  70       List number
     C                     PARM P1E2ST    W0INVL 25        TH Sex
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DFRTX    PARM           W0CNNM 25        Sex Desc Usr
      *
     C                     END                             *FI
      * Check producer for Insured, to diplay on screen
      * Rtv/Chk Prdcr for Ins XF - Deduction/Addition  * 
     C                     CALL 'PKGDXFR'              90  Rtv/Chk Prdcr f
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1ABCD    WQ0007  6        PD Producer Cod
     C           WUABST    PARM *BLANK    WQ0008  1        @Status (Yes/No
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKGDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Insured
      * CASE: WRK.@Status (Yes/No) is Yes
     C           WUABST    IFEQ 'Y'                        *IF
     C                     MOVEL@CN,001   #DK5TX           Text 9 USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #DK5TX           Text 9 USR
     C                     END                             *FI
      * Rtv Sch Shift/Shp Hd  RT - Buy Order Load  * 
     C                     EXSR SHRVGN
      * BOL Shipped Head
      * CASE: DTL.HC Class Code is Resale
     C           #1BECD    IFEQ 'RSL'                      *IF
     C                     Z-ADDYL0005    #DLDSH           BOL Shipped Hea
     C                     END                             *FI
     C                     MOVEL'N'       #1LJST           TH Shift Held O
      * *----------------------------------------------------------*
      * * 01/23/03 PKD Retrieve the Movement Reference from Delivery
      *                Schedule to default.  If not in the Schedule
      *                Then retrieve it from the Tracking.
      * Rtv Mvmnt,Farm f/BOL  RT - Delivery Sched Detail  * 
     C                     EXSR SIRVGN
      * If TH HPS Movement Ref # is zeros, retrieve value
      * CASE: DTL.TH HPS Movement Ref # EQ WRK.Zero USR
     C           #1OXNB    IFEQ WUE9NB                     *IF
      * Rtv Movement Number   RT - Delivery Tracking  * 
     C                     EXSR SJRVGN
     C                     END                             *FI
      * If TH HPS Movement Ref # is still zeros - load default value
      * CASE: DTL.TH HPS Movement Ref # EQ WRK.Zero USR
     C           #1OXNB    IFEQ WUE9NB                     *IF
     C                     Z-ADDP1OXNB    #1OXNB           TH HPS Movement
     C                     END                             *FI
      * *----------------------------------------------------------*
     C                     Z-ADD*ZERO     WUOXNB           TH HPS Movement
      * *----------------------------------------------------------*
     C                     ELSE
      * If record does exist, flip to change mode
     C                     MOVEL'CHG'     W0PMD
      * Load screen fields from DBF
     C                     EXSR MBFL#1
      * CALC: Detail screen function fields
      * DTL.TH Live Purch UOM  Usr = Condition name of DTL.TH Live Purcha
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100063   Y2LSNO  70       List number
     C                     PARM #1CPST    W0INVL 25        TH Live Purchas
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DEPTX    PARM           W0CNNM 25        TH Live Purch U
      *
      * DTL.Sex Desc Usr = Condition name of DTL.TH Sex
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1135183   Y2LSNO  70       List number
     C                     PARM #1E2ST    W0INVL 25        TH Sex
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DFRTX    PARM           W0CNNM 25        Sex Desc Usr
      *
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
     C                     EXSR SKRVGN
     C                     MOVEL'Y'       WUNEST           Ship Wgt Allow
      * Test of allow ship weight to be input/output
      * CASE: DTL.TH Payment Sts is Paid Anything
     C           #1CWST    IFEQ 'PL'                       *IF
     C           #1CWST    OREQ 'PC'
     C           #1CWST    OREQ 'NC'
     C           #1CWST    OREQ 'NL'
     C                     MOVEL'N'       WUNEST           Ship Wgt Allow
     C                     ELSE
      * CASE: DTL.TH Held Over is greater than 0
     C           #1H9NB    IFGT *ZERO                      *IF
     C                     MOVEL'N'       WUNEST           Ship Wgt Allow
     C                     ELSE
      * CASE: DTL.TH Held Over Record is Yes
     C           #1E1ST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WUNEST           Ship Wgt Allow
     C                     MOVEL'Y'       WUNFST           Held Over Recor
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Test of held over quanity
      * CASE: DTL.TH Held Over is greater than 0
     C           #1H9NB    IFGT *ZERO                      *IF
     C                     MOVEL'Y'       WUNFST           Held Over Recor
     C                     END                             *FI
      * USER: Initialize detail screen (existing record)
      * 9/22/2008 slm
      * do to adding fields to screen set cursor on new rules
      * Set Cursor
      * CASE: PAR.TH Hog Class Type is Market
     C           P1LLST    IFEQ 'M'                        *IF
      * set cursor  --- rules on when to position to Producer subsidary
      * CASE: DTL.BOL Load Shipped Head is Not Zero
     C           #DLDSH    IFNE *ZERO                      *IF
      * *Set Cursor: DTL.Producer Subsidary Code  (*Override=*YES)
     C                     Z-ADD007       W0ROW1
     C                     Z-ADD031       W0COL1
     C                     MOVEL'1'       W0OVR1           *YES
     C                     ELSE
      * CASE: *OTHERWISE
      * *Set Cursor: DTL.Producer Subsidary Code  (*Override=*YES)
     C                     Z-ADD007       W0ROW1
     C                     Z-ADD031       W0COL1
     C                     MOVEL'1'       W0OVR1           *YES
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * set cursor  --- rules on when to position to Class Code
      * CASE: DTL.BOL Load Shipped Head is Not Zero
     C           #DLDSH    IFNE *ZERO                      *IF
      * *Set Cursor: DTL.HC Class Code  (*Override=*YES)
     C                     Z-ADD008       W0ROW1
     C                     Z-ADD031       W0COL1
     C                     MOVEL'1'       W0OVR1           *YES
     C                     ELSE
      * CASE: *OTHERWISE
      * *Set Cursor: DTL.HC Class Code  (*Override=*NO)
     C                     Z-ADD008       W0ROW1
     C                     Z-ADD031       W0COL1
     C                     MOVEL'0'       W0OVR1           *NO
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       YL0007           Record Change U
      * DTL.Description 30 USR = Condition name of DTL.TH Hog Class Type
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1110255   Y2LSNO  70       List number
     C                     PARM #1LLST    W0INVL 25        TH Hog Class Ty
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DKKTX    PARM           W0CNNM 25        Description 30
      *
     C                     MOVELP2AGTX    #DAGTX           PD Name
     C                     MOVELP2A8TX    #DA8TX           PL Name
      * DTL.TH Live Purch UOM  Usr = Condition name of DB1.TH Live Purcha
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100063   Y2LSNO  70       List number
     C                     PARM A1CPST    W0INVL 25        TH Live Purchas
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DEPTX    PARM           W0CNNM 25        TH Live Purch U
      *
      * DTL.Sex Desc Usr = Condition name of DB1.TH Sex
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1135183   Y2LSNO  70       List number
     C                     PARM A1E2ST    W0INVL 25        TH Sex
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DFRTX    PARM           W0CNNM 25        Sex Desc Usr
      *
      * Rtv Hog Class Desc    RT - Hog Classification  * 
     C                     EXSR SLRVGN
     C                     MOVELP2BSTX    #DBSTX           Name USR
      * ** 01/16/06 slm - Get Site ID Required flag on Non Resale Hogs
     C                     MOVEL'N'       #DQTST           PL Site ID Requ
     C                     MOVEL*BLANK    #DNYCD           PS Site ID
     C                     MOVELP3AACD    #1LKST           TH Source Code
      * Rtv Prdcr Vendor#,Src RT - Producer  * 
     C                     EXSR SMRVGN
      * ** Retrieve Site ID & Producer Subsidiary from Tattoo Header EXT
      * Rtv Site ID/Prod Subs RT - Tattoo Header EXT  * 
     C                     EXSR SNRVGN
      * Rtv vendor info & site information from the producer
      * CASE: DTL.TH State EQ WRK.Blank USR
     C           #1NZTX    IFEQ WUCRTX                     *IF
      * Rtv PL Vnd Nbr, state RT - Producer Location  * 
     C                     EXSR SORVGN
      * CASE: DTL.PL Site ID Required is Yes
     C           #DQTST    IFEQ 'Y'                        *IF
      * get th state
      * Rtv Site State ActOnlyRT - Producer Site  * 
     C                     EXSR SPRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv PL Vnd Nbr, state RT - Producer Location  * 
     C                     EXSR SQRVGN
     C                     END                             *FI
      * Resale hogs set site id to blanks and producer susbidary
      * CASE: DB1.TH Hog Class Type is Resale
     C           A1LLST    IFEQ 'R'                        *IF
     C                     MOVEL'N'       #DQTST           PL Site ID Requ
     C                     MOVEL*BLANK    #DNYCD           PS Site ID
     C                     MOVEL*BLANK    #DOVCD           Producer Subsid
     C                     END                             *FI
      * 042606 slm -- chnges due to project on the site id and state code
      * Placed TH STATE CODE on the screen, def either prd loc, or site i
     C                     MOVELWUCRTX    YL0003           Return Code USR
      * Rtv State Description UP - STR VND Common Routines  * 
     C                     CALL 'STATERET'             90  Rtv State Descr
     C           YL0003    PARM YL0003    WQ0009  7        Return Code USR
     C                     PARM #1NZTX    WQ0010  3        State
     C           #DLXTX    PARM *BLANK    WQ0011 30        State Desc 30 U
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'STATERET'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     9941  *
     C                     END
      * Invalid state code send message
      * CASE: LCL.Return Code USR is *Normal
     C           YL0003    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1NZTX    ZA0002           TH State
      * Send message 'State Code Invalid'
     C                     MOVEL'PRK0308' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9941  *
      *
     C                     END                             *FI
      * Rtv Source Type       RT - Source  * 
     C                     EXSR SRRVGN
      * Rtv Shipped Head      RT - Buy Order Load  * 
     C                     EXSR SSRVGN
     C                     Z-ADDYL0005    #DLDSH           BOL Shipped Hea
      * DTL.SR Type Desc = Condition name of DTL.TH Source Type
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1121482   Y2LSNO  70       List number
     C                     PARM #1KAST    W0INVL 25        TH Source Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DISTX    PARM           W0CNNM 25        SR Type Desc
      *
      * DTL.HC Class Type Desc Usr = Condition name of DTL.TH Hog Class T
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1110255   Y2LSNO  70       List number
     C                     PARM #1LLST    W0INVL 25        TH Hog Class Ty
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DE6TX    PARM           W0CNNM 25        HC Class Type D
      *
     C                     MOVELA1C2ST    #1C2ST           TH Resale Sprea
     C                     MOVEL*BLANK    WUKPST           @Status Interna
     C                     MOVEL'N'       WUL9ST           Display Output
     C                     MOVEL'N'       WUMAST           Display Output
      * MKT: Hide defect/head fields  and pen/hd recvd
      * CASE: DTL.TH Hog Class Type is Market
     C           #1LLST    IFEQ 'M'                        *IF
     C                     MOVEL'Y'       WUL9ST           Display Output
     C                     MOVEL'Y'       WUMAST           Display Output
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DTL.TH Hog Class Type is Subject
      *   |- c2    : DTL.TH Source Type is External
      *   '-
     C           #1LLST    IFEQ 'S'                        *IF
     C           #1KAST    OREQ 'E'                        *OR
     C                     MOVEL'Y'       WUMAST           Display Output
     C                     END                             *FI
     C                     END                             *FI
      * Set flag to display unweighed resale pen & received hd, get pen
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.TH Source Type is Internal
      *   |- c2    : DTL.TH Hog Class Type is Resale
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1KAST    IFEQ 'I'                        *IF
     C           #1LLST    IFEQ 'R'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUKPST           @Status Interna
      * Protect the defect/head/pen fields if tattoo has been weighed.
      * CASE: DTL.TH Resale Spread Sts is Spread
     C           #1C2ST    IFEQ 'P'                        *IF
     C                     MOVEL'Y'       WUL9ST           Display Output
     C                     MOVEL'Y'       WUMAST           Display Output
     C                     END                             *FI
     C                     END                             *FI
      * Get Defect/Hd
     C                     EXSR UBSUBR                     Get Defect/Hd
      * Retrieve Group Reference Code (alpha) from HPS
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.TH Source Type is Internal
      *   |- c2    : DTL.TH Tattoo Reference NE WRK.Blank USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1KAST    IFEQ 'I'                        *IF
     C           #1BICD    IFNE WUCRTX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Comment 12/12/02 pk0495
     C                     END                             *FI
      * Save input fields to check for changes later
     C                     MOVEL#1CPST    WUCPST           TH Live Purchas
     C                     Z-ADD#1ACPR    WUACPR           TH Live Purchas
     C                     MOVEL#1AGCD    WUAGCD           GN Genetic Code
     C                     Z-ADD#1HGNB    WUHGNB           TH Shipped Weig
      * Check producer for Insured, to diplay on screen
      * Rtv/Chk Prdcr for Ins XF - Deduction/Addition  * 
     C                     CALL 'PKGDXFR'              90  Rtv/Chk Prdcr f
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1ABCD    WQ0012  6        PD Producer Cod
     C           WUABST    PARM *BLANK    WQ0013  1        @Status (Yes/No
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKGDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Insured
      * CASE: WRK.@Status (Yes/No) is Yes
     C           WUABST    IFEQ 'Y'                        *IF
     C                     MOVEL@CN,001   #DK5TX           Text 9 USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #DK5TX           Text 9 USR
     C                     END                             *FI
     C                     Z-ADDA1OXNB    WUOXNB           TH HPS Movement
     C                     END
      *..................................................
     C   99                GOTO BEEXIT
      *
     C           YPMTFD    IFEQ *BLANK
      * No error: Display and process details
     C                     EXSR CADSDA
     C                     END
      *
      *================================================================
     CSR         BEEXIT    ENDSR
      /EJECT
     CSR         BFVLKY    BEGSR
      *================================================================
      * Validate key fields
      *================================================================
     C           W0PMD     IFNE 'ADD'
     C           YPMTFD    ORNE *BLANK
     C                     END
      * Check relations
      * Check restriction within
     C                     EXSR VACKRL
      * TH Tattoo Number required
     C           #1CVNB    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         BFEXIT    ENDSR
      /EJECT
     CSR         CADSDA    BEGSR
      *================================================================
      * Display and process detail screen
      *================================================================
      * Conduct detail screen conversation
      * - repeat until screen control flag is reset:
     C           W0TRN     DOWEQ'Y'
      * Convert internal to external form
     C                     EXSR MOCV#D
      * Display detail screen
     C                     EXSR CBEXFM
      * Process response to detail screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * Redisplay previous screen
     C   12                CAS            CCDSPV
      * HOME: Reset screen fields
     C   30                CAS            CCDSPV
      * Process detail screen input
     C                     CAS            CFPRSC
     C                     END
     C           W0TRN     IFEQ 'R'
     C           W0PMD     IFEQ 'ADD'
     C                     EXSR MAIZ#1
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         CBEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * PUTOVR unless conditioned fields change
     C                     SETON                         86*
     C           *IN89     IFNE CBIN89
     C                     SETOF                         86*
     C                     END
     C                     MOVE *IN89     CBIN89  1
     C                     MOVEL'1'       W0GRP   1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y1SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT2
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1
      * Reset global error indicator
     C                     SETOF                         99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CBEXIT    ENDSR
      /EJECT
     CSR         CCDSPV    BEGSR
      *================================================================
      * Redisplay previous screen
      *================================================================
     C   30                MOVEL'R'       W0TRN
     C   12                MOVEL'K'       W0TRN
      *================================================================
     CSR         CCEXIT    ENDSR
      /EJECT
     CSR         CFPRSC    BEGSR
      *================================================================
      * Validate record
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate details
     C                     EXSR DCVLDL
      * QUIT if error:
     C   99                GOTO CFEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       CFEXIT
      * Prompt for confirmation
     C                     EXSR EAPMCF
      * Quit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO CFEXIT
     C                     END
      * No error: update record
     C                     EXSR EBPR##
      *================================================================
     CSR         CFEXIT    ENDSR
      /EJECT
     CSR         DCVLDL    BEGSR
      *================================================================
      * Validate details
      *================================================================
      * Validate TH Sex
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1E2ST'  IFEQ YPMTFD
      * TH Sex
     C                     MOVEL#1E2ST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHE2ST
     C                     SELEC
     C           W0INVL    WHEQ 'M'                        M
     C                     Z-ADD1         ZHE2ST
     C           W0INVL    WHEQ 'F'                        F
     C                     Z-ADD2         ZHE2ST
     C           W0INVL    WHEQ 'X'                        X
     C                     Z-ADD3         ZHE2ST
     C                     ENDSL
     C                     EXFMTZGE2ST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHE2ST    WHEQ 1
     C                     MOVEL'M'       W0INVL           M
     C           ZHE2ST    WHEQ 2
     C                     MOVEL'F'       W0INVL           F
     C           ZHE2ST    WHEQ 3
     C                     MOVEL'X'       W0INVL           X
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1E2ST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate TH Schedule Kill Shift
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1LIST'  IFEQ YPMTFD
      * TH Schedule Kill Shift
     C                     MOVEL#1LIST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHLIST
     C                     SELEC
     C           W0INVL    WHEQ '1'                        1
     C                     Z-ADD1         ZHLIST
     C           W0INVL    WHEQ '2'                        2
     C                     Z-ADD2         ZHLIST
     C           W0INVL    WHEQ '3'                        3
     C                     Z-ADD3         ZHLIST
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD4         ZHLIST
     C                     ENDSL
     C                     EXFMTZGLIST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHLIST    WHEQ 1
     C                     MOVEL'1'       W0INVL           1
     C           ZHLIST    WHEQ 2
     C                     MOVEL'2'       W0INVL           2
     C           ZHLIST    WHEQ 3
     C                     MOVEL'3'       W0INVL           3
     C           ZHLIST    WHEQ 4
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1LIST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate TH Live Purchase UOM
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1CPST'  IFEQ YPMTFD
      * TH Live Purchase UOM
     C                     MOVEL#1CPST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHCPST
     C                     SELEC
     C           W0INVL    WHEQ 'FL'                       FL
     C                     Z-ADD1         ZHCPST
     C           W0INVL    WHEQ 'LW'                       LW
     C                     Z-ADD2         ZHCPST
     C           W0INVL    WHEQ 'NH'                       NH
     C                     Z-ADD3         ZHCPST
     C           W0INVL    WHEQ 'NL'                       NL
     C                     Z-ADD4         ZHCPST
     C           W0INVL    WHEQ 'SW'                       SW
     C                     Z-ADD5         ZHCPST
     C           W0INVL    WHEQ 'LX'                       LX
     C                     Z-ADD6         ZHCPST
     C           W0INVL    WHEQ 'SX'                       SX
     C                     Z-ADD7         ZHCPST
     C                     ENDSL
     C                     EXFMTZGCPST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHCPST    WHEQ 1
     C                     MOVEL'FL'      W0INVL           FL
     C           ZHCPST    WHEQ 2
     C                     MOVEL'LW'      W0INVL           LW
     C           ZHCPST    WHEQ 3
     C                     MOVEL'NH'      W0INVL           NH
     C           ZHCPST    WHEQ 4
     C                     MOVEL'NL'      W0INVL           NL
     C           ZHCPST    WHEQ 5
     C                     MOVEL'SW'      W0INVL           SW
     C           ZHCPST    WHEQ 6
     C                     MOVEL'LX'      W0INVL           LX
     C           ZHCPST    WHEQ 7
     C                     MOVEL'SX'      W0INVL           SX
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1CPST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate detail screen fields
      * Rtv Producer Name     RT - Producer  * 
     C                     EXSR TFRVGN
      * Rtv Pdctn Loc Name    RT - Producer Location  * 
     C                     EXSR TGRVGN
      * Rtv Hog Class         RT - Hog Classification  * 
     C                     EXSR THRVGN
      * DTL.SR Type Desc = Condition name of DTL.TH Source Type
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1121482   Y2LSNO  70       List number
     C                     PARM #1KAST    W0INVL 25        TH Source Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DISTX    PARM           W0CNNM 25        SR Type Desc
      *
      * Document history on site   Create Str 061508 slm
     C                     EXSR UCSUBR                     Document histor
      * CASE: DTL.PL Site ID Required is Yes
     C           #DQTST    IFEQ 'Y'                        *IF
      * ** F4 = Select Producer Site ID to get mileage and or state code
      * CASE:
      *  - c2 AND c1
      *   |- c2    : DTL.*CMD key is *Prompt
      *   |- c1    : PGM.*Cursor field <IS> DTL.PS Site ID
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#DNYCD'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Sel Prod Site Mileage SR - Producer Site Mileage  * 
     C                     CALL 'PLFQSRR'              90  Sel Prod Site M
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1ABCD    WQ0019  6        PD Producer Cod
     C           #DNYCD    PARM #DNYCD    WQ0020 10        PS Site ID
     C                     PARM P1HMNB    WQ0021  30       PSM Company Num
     C           YL0008    PARM *ZERO     WQ0022  50       PSM Miles to Co
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLFQSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9933  *
     C                     END
      * Rtv Site State ActOnlyRT - Producer Site  * 
     C                     EXSR TIRVGN
     C                     END                             *FI
      * Not a Contract, No Rsl Hogs, then Site Id is req, pull th state
      * CASE: DTL.TH Hog Class Type is Not Resale
     C           #1LLST    IFEQ 'M'                        *IF
     C           #1LLST    OREQ 'S'
      * Site ID will not be required on Resale Hogs
      * E00151 5/16/2008 SLM -- VALIDATE IF REQUIRED REGARDLESS OF CONTRA
      * * do not want to validate on contract
      * validate producer site id if required regardless of contract
      * ** Error if Site ID is blank
      * CASE: DTL.PS Site ID is *Blank
     C           #DNYCD    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DNYCD    ZA0003           PS Site ID
      * Send message 'Producer Site ID Required'
     C                     MOVEL'PRK1140' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     END                             *FI
      * ** 1/4/06 LJB - If Site ID is entered, there must first
      * **   be a record in the Producer Site Mileage file.
      * **   Error if there is not.
      * Rtv PrdSiteMil CoMilStRT - Producer Site Mileage  * 
     C                     EXSR TJRVGN
      * ** Error if no matching record in Producer Site Mileage
      * CASE: LCL.PSM Miles to Company is No Miles
     C           YL0008    IFEQ *ZERO                      *IF
      * Setup message data for message
     C                     MOVEL#DNYCD    ZA0004           PS Site ID
      * Send message 'Producer Site/Mileage NF'
     C                     MOVEL'PRK1153' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     ELSE
      * CASE: DTL.TH State EQ WRK.Blank USR
     C           #1NZTX    IFEQ WUCRTX                     *IF
      * Setup message data for message
     C                     MOVEL#1NZTX    ZA0005           TH State
      * Send message 'State Code Invalid'
     C                     MOVEL'PRK0308' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9941  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
      * Select on Producer Subsidiary
      * CASE: WRK.Producer Subsidiary SUSR is Allow Producer Subsidiary
     C           WUDJSS    IFEQ 'Y'                        *IF
      * ** F4 = Select Producer subsidiary
      * CASE:
      *  - c2 AND c1
      *   |- c2    : DTL.*CMD key is *Prompt
      *   |- c1    : PGM.*Cursor field <IS> DTL.Producer Subsidary Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#DOVCD'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Sel ProdSubsidiary    SR - Producer Subsidiary  * 
     C                     CALL 'PLM2SRR'              90  Sel ProdSubsidi
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1ABCD    WQ0023  6        PD Producer Cod
     C           #DOVCD    PARM #DOVCD    WQ0024  6        Producer Subsid
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLM2SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Validation on Producer subsidiary
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.Producer Subsidary Code is Blank
      *   |- c2    : WRK.Producer Subsidiary SUSR is Allow Producer Subsi
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DOVCD    IFEQ *BLANK                     *IF
     C           WUDJSS    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#DOVCD    ZA0006           Producer Subsid
      * Send message 'Producer Subsidiary Req'
     C                     MOVEL'PRK1215' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.Producer Subsidary Code is Entered
      *   |- c2    : WRK.Producer Subsidiary SUSR is Allow Producer Subsi
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DOVCD    IFNE *BLANK                     *IF
     C           WUDJSS    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
      * Val ProdSubsidiary    RT - Producer Subsidiary  * 
     C                     EXSR TLRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DOVCD    ZA0007           Producer Subsid
      * Send message 'Producer Subsidiary NotFn'
     C                     MOVEL'PRK1216' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * F4  on Defects
     C                     EXSR UDSUBR                     F4  on Defects
      * Validate Defects & bring back classification
      * CASE:
      *  - c1 OR c2 OR c3 OR c4 OR c5 OR c6 OR c7 OR c8 OR c9 OR c10 OR
      *  -  c11
      *   |- c1    : WRK.HC Defect Required is Yes
      *   |- c2    : DTL.Defect User  1 is Entered
      *   |- c3    : DTL.Defect User  2 is Entered
      *   |- c4    : DTL.Defect User  3 is Entered
      *   |- c5    : DTL.Defect User  4 is Entered
      *   |- c6    : DTL.Defect User  5 is Entered
      *   |- c7    : DTL.Defect User  6 is Entered
      *   |- c8    : DTL.Defect User  7 is Entered
      *   |- c9    : DTL.Defect User  8 is Entered
      *   |- c10   : DTL.Defect User  9 is Entered
      *   |- c11   : DTL.Defect User 10 is Entered
      *   '-
     C           WUBXST    IFEQ 'Y'                        *IF
     C           #DGUCD    ORNE *BLANK                     *OR
     C           #DGVCD    ORNE *BLANK                     *OR
     C           #DGWCD    ORNE *BLANK                     *OR
     C           #DGXCD    ORNE *BLANK                     *OR
     C           #DGYCD    ORNE *BLANK                     *OR
     C           #DGZCD    ORNE *BLANK                     *OR
     C           #DG0CD    ORNE *BLANK                     *OR
     C           #DG1CD    ORNE *BLANK                     *OR
     C           #DG2CD    ORNE *BLANK                     *OR
     C           #DG3CD    ORNE *BLANK                     *OR
      * Val def 1
      * CASE: DTL.Defect User  1 NE WRK.Blank Usr 1 fld Usr
     C           #DGUCD    IFNE WUIXTX                     *IF
      * Val Hog Defect&CLS    RT - Hog Defect  * 
     C                     EXSR TMRVGN
      * CASE: WRK.*Return code is Record Found
     C           WURTN     IFEQ '999'                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DGUCD    ZA0008           Defect User  1
      * Send message 'Tattoo Def Not Fnd Error'
     C                     MOVEL'PRK0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9946  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Val def 2
      * CASE: DTL.Defect User  2 NE WRK.Blank Usr 1 fld Usr
     C           #DGVCD    IFNE WUIXTX                     *IF
      * Val Hog Defect&CLS    RT - Hog Defect  * 
     C                     EXSR TNRVGN
      * CASE: WRK.*Return code is Record Found
     C           WURTN     IFEQ '999'                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DGVCD    ZA0009           Defect User  2
      * Send message 'Tattoo Def Not Fnd Error'
     C                     MOVEL'PRK0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9948  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Val def 3
      * CASE: DTL.Defect User  3 NE WRK.Blank Usr 1 fld Usr
     C           #DGWCD    IFNE WUIXTX                     *IF
      * Val Hog Defect&CLS    RT - Hog Defect  * 
     C                     EXSR TORVGN
      * CASE: WRK.*Return code is Record Found
     C           WURTN     IFEQ '999'                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DGWCD    ZA0010           Defect User  3
      * Send message 'Tattoo Def Not Fnd Error'
     C                     MOVEL'PRK0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9950  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Val def 4
      * CASE: DTL.Defect User  4 NE WRK.Blank Usr 1 fld Usr
     C           #DGXCD    IFNE WUIXTX                     *IF
      * Val Hog Defect&CLS    RT - Hog Defect  * 
     C                     EXSR TPRVGN
      * CASE: WRK.*Return code is Record Found
     C           WURTN     IFEQ '999'                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DGXCD    ZA0011           Defect User  4
      * Send message 'Tattoo Def Not Fnd Error'
     C                     MOVEL'PRK0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9952  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Val def 5
      * CASE: DTL.Defect User  5 NE WRK.Blank Usr 1 fld Usr
     C           #DGYCD    IFNE WUIXTX                     *IF
      * Val Hog Defect&CLS    RT - Hog Defect  * 
     C                     EXSR TQRVGN
      * CASE: WRK.*Return code is Record Found
     C           WURTN     IFEQ '999'                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DGYCD    ZA0012           Defect User  5
      * Send message 'Tattoo Def Not Fnd Error'
     C                     MOVEL'PRK0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9954  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Val def 6
      * CASE: DTL.Defect User  6 NE WRK.Blank Usr 1 fld Usr
     C           #DGZCD    IFNE WUIXTX                     *IF
      * Val Hog Defect&CLS    RT - Hog Defect  * 
     C                     EXSR TRRVGN
      * CASE: WRK.*Return code is Record Found
     C           WURTN     IFEQ '999'                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DGZCD    ZA0013           Defect User  6
      * Send message 'Tattoo Def Not Fnd Error'
     C                     MOVEL'PRK0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9956  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Val def 7
      * CASE: DTL.Defect User  7 NE WRK.Blank Usr 1 fld Usr
     C           #DG0CD    IFNE WUIXTX                     *IF
      * Val Hog Defect&CLS    RT - Hog Defect  * 
     C                     EXSR TSRVGN
      * CASE: WRK.*Return code is Record Found
     C           WURTN     IFEQ '999'                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DG0CD    ZA0014           Defect User  7
      * Send message 'Tattoo Def Not Fnd Error'
     C                     MOVEL'PRK0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9958  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Val def 8
      * CASE: DTL.Defect User  8 NE WRK.Blank Usr 1 fld Usr
     C           #DG1CD    IFNE WUIXTX                     *IF
      * Val Hog Defect&CLS    RT - Hog Defect  * 
     C                     EXSR TTRVGN
      * CASE: WRK.*Return code is Record Found
     C           WURTN     IFEQ '999'                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DG1CD    ZA0015           Defect User  8
      * Send message 'Tattoo Def Not Fnd Error'
     C                     MOVEL'PRK0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9960  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Val def 9
      * CASE: DTL.Defect User  9 NE WRK.Blank Usr 1 fld Usr
     C           #DG2CD    IFNE WUIXTX                     *IF
      * Val Hog Defect&CLS    RT - Hog Defect  * 
     C                     EXSR TURVGN
      * CASE: WRK.*Return code is Record Found
     C           WURTN     IFEQ '999'                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DG2CD    ZA0016           Defect User  9
      * Send message 'Tattoo Def Not Fnd Error'
     C                     MOVEL'PRK0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9962  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Val def 10
      * CASE: DTL.Defect User 10 NE WRK.Blank Usr 1 fld Usr
     C           #DG3CD    IFNE WUIXTX                     *IF
      * Val Hog Defect&CLS    RT - Hog Defect  * 
     C                     EXSR TVRVGN
      * CASE: WRK.*Return code is Record Found
     C           WURTN     IFEQ '999'                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DG3CD    ZA0017           Defect User 10
      * Send message 'Tattoo Def Not Fnd Error'
     C                     MOVEL'PRK0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9964  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * CASE: WRK.HC Defect Required is Yes
     C           WUBXST    IFEQ 'Y'                        *IF
      * Validation of defects
      * CASE: DTL.Defect User  1 NE WRK.Blank Usr 1 fld Usr
     C           #DGUCD    IFNE WUIXTX                     *IF
     C                     ELSE
      * CASE: DTL.Defect User  2 NE WRK.Blank Usr 1 fld Usr
     C           #DGVCD    IFNE WUIXTX                     *IF
     C                     ELSE
      * CASE: DTL.Defect User  3 NE WRK.Blank Usr 1 fld Usr
     C           #DGWCD    IFNE WUIXTX                     *IF
     C                     ELSE
      * CASE: DTL.Defect User  4 NE WRK.Blank Usr 1 fld Usr
     C           #DGXCD    IFNE WUIXTX                     *IF
     C                     ELSE
      * CASE: DTL.Defect User  5 NE WRK.Blank Usr 1 fld Usr
     C           #DGYCD    IFNE WUIXTX                     *IF
     C                     ELSE
      * CASE: DTL.Defect User  6 NE WRK.Blank Usr 1 fld Usr
     C           #DGZCD    IFNE WUIXTX                     *IF
     C                     ELSE
      * CASE: DTL.Defect User  7 NE WRK.Blank Usr 1 fld Usr
     C           #DG0CD    IFNE WUIXTX                     *IF
     C                     ELSE
      * CASE: DTL.Defect User  8 NE WRK.Blank Usr 1 fld Usr
     C           #DG1CD    IFNE WUIXTX                     *IF
     C                     ELSE
      * CASE: DTL.Defect User  9 NE WRK.Blank Usr 1 fld Usr
     C           #DG2CD    IFNE WUIXTX                     *IF
     C                     ELSE
      * CASE: DTL.Defect User 10 NE WRK.Blank Usr 1 fld Usr
     C           #DG3CD    IFNE WUIXTX                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Defect required for class'
     C                     MOVEL'PRK0357' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate class code against class type.
      * CASE: WRK.TH Hog Class Type NE DTL.TH Hog Class Type
     C           WULLST    IFNE #1LLST                     *IF
      * Setup message data for message
     C                     MOVEL#1LLST    ZA0018           TH Hog Class Ty
     C                     MOVEL#1BECD    ZA0019           HC Class Code
      * Send message 'Class code inval for type'
     C                     MOVEL'PRK0601' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9934  *
      *
     C                     END                             *FI
      * Prompt on Pen
      * CASE: WRK.Display Output Only 2 USR is No
     C           WUMAST    IFEQ 'N'                        *IF
      * F4  on Pen
      * CASE: DTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * CASE: PGM.*Cursor field <IS> DTL.Pen Number
     C           W0CFL     IFEQ '#DCMCD'                   *IF
      * Sel Pen Open/Hc Type  SR - Pen  * 
     C                     CALL 'PKJWSRR'              90  Sel Pen Open/Hc
     C                     PARM *BLANK    W0RTN   7
     C           #1HMNB    PARM #1HMNB    WQ0035  30       Pen Company Num
     C           #DCMCD    PARM *BLANK    WQ0036  3        Pen Number
     C                     PARM #1LLST    WQ0037  1        TH Hog Class Ty
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKJWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9939  *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate Load Shipped head   *
      * CASE: DTL.BOL Load Shipped Head is *Zeros
     C           #DLDSH    IFEQ *ZERO                      *IF
      * Setup message data for message
     C                     Z-ADD#DLDSH    ZA0020           BOL Shipped Hea
      * Send message 'Enter Head On BOL'
     C                     MOVEL'PRK0911' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.BOL Shipped Head is GT 250
     C           #DLDSH    IFGT 265                        *IF
      * Send message 'Head cannot exceed 250.'
     C                     MOVEL'PRK0774' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate external group reference
      * CASE: DTL.TH Source Type is External
     C           #1KAST    IFEQ 'E'                        *IF
      * Rtv EDI Trading Prt#  RT - Producer  * 
     C                     EXSR TWRVGN
     C                     END                             *FI
      * ** Don't exchange the screen field and the hidden state field
      * ** Just use the screen state field.      03/07/2006 LJB
     C                     MOVELWUCRTX    YL0003           Return Code USR
      * Rtv State Description UP - STR VND Common Routines  * 
     C                     CALL 'STATERET'             90  Rtv State Descr
     C           YL0003    PARM YL0003    WQ0038  7        Return Code USR
     C                     PARM #1NZTX    WQ0039  3        State
     C           #DLXTX    PARM *BLANK    WQ0040 30        State Desc 30 U
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'STATERET'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     9941  *
     C                     END
      * Invalid state code send message
      * CASE: LCL.Return Code USR is *Normal
     C           YL0003    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1NZTX    ZA0021           TH State
      * Send message 'State Code Invalid'
     C                     MOVEL'PRK0308' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9941  *
      *
     C                     END                             *FI
      * Validate live price and UOM
      * CASE: DTL.TH Payment Sts is Paid Producer
     C           #1CWST    IFEQ 'PL'                       *IF
     C           #1CWST    OREQ 'PC'
     C           #1CWST    OREQ 'NC'
     C           #1CWST    OREQ 'NL'
     C                     ELSE
      * CASE: *OTHERWISE
      * Validate live price and live price UOM
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DTL.TH Live Purchase Price is Not Zeros
      *   |- c2    : DTL.TH Live Purchase UOM NE WRK.Blank USR
      *   '-
     C           #1ACPR    IFNE *ZERO                      *IF
     C           #1CPST    ORNE WUCRTX                     *OR
      * CASE: DTL.TH Live Purchase UOM EQ WRK.Blank USR
     C           #1CPST    IFEQ WUCRTX                     *IF
      * Send message 'UOM Required if lv price'
     C                     MOVEL'PRK0382' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Rsl/Int -- Sum Defect hd for Head Total Usr
      * CASE: WRK.@Status Internal (Y/N) is Yes
     C           WUKPST    IFEQ 'Y'                        *IF
      *  Sum head up to HD RCVD if there arent any Scale Wgt Req defects
      * Chk Def Scale Wt Req  IF
      * If any defect has scale weight required, quit checking the defect
     C                     MOVEL'N'       WUR3ST           Scale Wt Requir
      * CASE: PAR.Defect User  1 NE WRK.Blank USR
     C           #DGUCD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR TXRVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Defect User  2 NE WRK.Blank USR
     C           #DGVCD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR TYRVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Defect User  3 NE WRK.Blank USR
     C           #DGWCD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR TZRVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Defect User  4 NE WRK.Blank USR
     C           #DGXCD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR NARVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Defect User  5 NE WRK.Blank USR
     C           #DGYCD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR NBRVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Defect User  6 NE WRK.Blank USR
     C           #DGZCD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR NCRVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Defect User  7 NE WRK.Blank USR
     C           #DG0CD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR NDRVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Defect User  8 NE WRK.Blank USR
     C           #DG1CD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR NERVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Defect User  9 NE WRK.Blank USR
     C           #DG2CD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR NFRVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Defect User 10 NE WRK.Blank USR
     C           #DG3CD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR NGRVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * If Defect Scale Weight is Required or Sts is Spread dont calc hea
      * CASE: WRK.Scale Wt Required     USR is Yes
     C           WUR3ST    IFEQ 'Y'                        *IF
      * In CHANGE mode, a "M"ark for future spread cant be changed to lit
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.TH Resale Spread Sts is Mark for Future Sprd Wgt
      *   |- c2    : PGM.*Program mode is *CHANGE
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1C2ST    IFEQ 'M'                        *IF
     C           W0PMD     IFEQ 'CHG'                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Send message 'Scale Weight required def'
     C                     MOVEL'PRK0779' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     #DB5NB           Head Total USR
     C                     MOVEL*BLANK    #DCMCD           Pen Number
     C                     MOVEL'Y'       WUMAST           Display Output
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Check Resale Spread Status
      * CASE: DTL.TH Resale Spread Sts is Spread
     C           #1C2ST    IFEQ 'P'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'M'       #1C2ST           TH Resale Sprea
     C                     MOVEL'N'       WUMAST           Display Output
      * Rsl/Int-- Sum Defect head
      * DTL.Head Total USR =
      *    *COMPUTE (x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8 + x9 + x10)
      * x1    : DTL.Defect HD user 1
      * +     : PGM.*Synon (17,7) work field
      * x2    : DTL.Defect HD user 2
      * +     : PGM.*Synon (17,7) work field
      * x3    : DTL.Defect HD user 3
      * +     : PGM.*Synon (17,7) work field
      * x4    : DTL.Defect HD user 4
      * +     : PGM.*Synon (17,7) work field
      * x5    : DTL.Defect HD user 5
      * +     : PGM.*Synon (17,7) work field
      * x6    : DTL.Defect HD user 6
      * +     : PGM.*Synon (17,7) work field
      * x7    : DTL.Defect HD user 7
      * +     : PGM.*Synon (17,7) work field
      * x8    : DTL.Defect HD user 8
      * +     : PGM.*Synon (17,7) work field
      * x9    : DTL.Defect HD user 9
      * +     : PGM.*Synon (17,7) work field
      * x10   : DTL.Defect HD user 10
     C           #DF1NB    ADD  #DFWNB    W0WD08           *Synon (17,7) w
     C           W0WD08    ADD  #DFYNB    W0WD07           *Synon (17,7) w
     C           W0WD07    ADD  #DFUNB    W0WD06           *Synon (17,7) w
     C           W0WD06    ADD  #DO3NB    W0WD05           *Synon (17,7) w
     C           W0WD05    ADD  #DO4NB    W0WD04           *Synon (17,7) w
     C           W0WD04    ADD  #DO5NB    W0WD03           *Synon (17,7) w
     C           W0WD03    ADD  #DFONB    W0WD02           *Synon (17,7) w
     C           W0WD02    ADD  #DFXNB    W0WD01           *Synon (17,7) w
     C           W0WD01    ADD  #DFTNB    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    #DB5NB           Head Total USR
     C                     END                             *FI
      * Validate Pen
      * CASE: Empty and marked for spread
      *  - c1 AND c2
      *   |- c1    : DTL.Pen Number is Pen Number is Empty
      *   |- c2    : DTL.TH Resale Spread Sts is Mark for Future Sprd Wgt
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DCMCD    IFEQ *BLANK                     *IF
     C           #1C2ST    IFEQ 'M'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#DCMCD    ZA0022           Pen Number
      * Send message 'Pen is req for rsl/int'
     C                     MOVEL'PRK0780' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Validate Pen if not Empty.
      * CASE: DTL.Pen Number is Pen Number not Empty
     C           #DCMCD    IFGT *BLANK                     *IF
     C                     MOVELWUCRTX    WUFWST           Pen Type
      * Rtv Val Pen,Type      RT - Pen  * 
     C                     EXSR NHRVGN
      * CASE: WRK.Pen Type is Resale
     C           WUFWST    IFEQ 'R'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.Pen Type EQ WRK.Blank USR
     C           WUFWST    IFEQ WUCRTX                     *IF
      * Send message 'Pen                    NF'
     C                     MOVEL'PRK0065' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DCMCD    ZA0023           Pen Number
     C                     MOVEL#1LLST    ZA0024           TH Hog Class Ty
     C                     MOVELWUFWST    ZA0025           Pen Type
      * Send message 'Pen type not the same as'
     C                     MOVEL'PRK0606' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Internals only -- Validate Movement and Group Refs.
      * CASE: DTL.TH Source Type is Internal
     C           #1KAST    IFEQ 'I'                        *IF
      * Validate Movement Reference Number
      * CASE: DTL.TH Movement Reference # EQ WRK.Zero USR
     C           #1OXNB    IFEQ WUE9NB                     *IF
      * Send message 'Movement Rfrnc Invalid'
     C                     MOVEL'PRK0535' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Val HPS Movement Rfrn UP - STR HPS Interface  * 
     C                     CALL 'HP251'                90  Val HPS Movemen
     C           WULMST    PARM WULMST    WQ0041  7        Return Code USR
     C                     PARM #1OXNB    WQ0042  70       TH HPS Movement
     C           WUSHDT    PARM *ZERO     WQ0043  80       Scheduled Kill
     C           WULDSH    PARM *ZERO     WQ0044  50       Scheduled Head
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP251'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
     C                     END
      * CASE: DTL.BOL Shipped Head is *Zeros
     C           #DLDSH    IFEQ *ZERO                      *IF
     C                     Z-ADDWULDSH    YL0005           BOL Shipped Hea
     C                     END                             *FI
      * CASE: WRK.Return Code USR is HPS Movement Rfrnc Err 1
     C           WULMST    IFEQ 'HPSM1'                    *IF
      * Send message 'Movement Rfrnc Invalid'
     C                     MOVEL'PRK0535' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DTL.TH HPS Movement Ref # NE WRK.TH HPS Movement Ref #
     C           #1OXNB    IFNE WUOXNB                     *IF
     C                     Z-ADD#1OXNB    WUOXNB           TH HPS Movement
     C                     END                             *FI
      * CASE: DTL.GN Genetic Code is BLANKS
     C           #1AGCD    IFEQ *BLANK                     *IF
     C                     MOVELWUEQCD    #1AGCD           GN Genetic Code
     C                     END                             *FI
      * CASE: DTL.TH Sex EQ WRK.Blank USR
     C           #1E2ST    IFEQ WUCRTX                     *IF
     C                     MOVELWUE2ST    #1E2ST           TH Sex
     C                     END                             *FI
     C                     END                             *FI
      * If Tattoo not already paid, set up payment sts
      * CASE: DTL.TH Payment Sts is Paid Producer
     C           #1CWST    IFEQ 'PL'                       *IF
     C           #1CWST    OREQ 'PC'
     C           #1CWST    OREQ 'NC'
     C           #1CWST    OREQ 'NL'
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv BOH Pay Type      RT - Buy Order Header  * 
     C                     EXSR NIRVGN
      * Set Payment Status
      * CASE: DTL.TH Live Purchase UOM is Live Payment
     C           #1CPST    IFEQ 'FL'                       *IF
     C           #1CPST    OREQ 'LW'
     C           #1CPST    OREQ 'NH'
     C           #1CPST    OREQ 'NL'
     C           #1CPST    OREQ 'SW'
     C           #1CPST    OREQ 'LX'
     C           #1CPST    OREQ 'SX'
      * Internal or External Live
      * CASE: WRK.BOH Buy Order Type is Internal
     C           WUA5ST    IFEQ 'I'                        *IF
     C                     MOVEL'IL'      #1CWST           TH Payment Sts
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'SL'      #1CWST           TH Payment Sts
     C                     END                             *FI
     C                     ELSE
      * CASE: DTL.TH Hog Class Type is Not Market
     C           #1LLST    IFEQ 'R'                        *IF
     C           #1LLST    OREQ 'S'
      * Live - Internal or External
      * CASE: WRK.BOH Buy Order Type is Internal
     C           WUA5ST    IFEQ 'I'                        *IF
     C                     MOVEL'IL'      #1CWST           TH Payment Sts
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'SL'      #1CWST           TH Payment Sts
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.BOH Payment Type is Carcass Merit
     C           WUA4ST    IFEQ 'C'                        *IF
      * Carcass Merit - Internal or External
      * CASE: WRK.BOH Buy Order Type is Internal
     C           WUA5ST    IFEQ 'I'                        *IF
     C                     MOVEL'IC'      #1CWST           TH Payment Sts
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'SC'      #1CWST           TH Payment Sts
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Live - Internal or External
      * CASE: WRK.BOH Buy Order Type is Internal
     C           WUA5ST    IFEQ 'I'                        *IF
     C                     MOVEL'IL'      #1CWST           TH Payment Sts
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'SL'      #1CWST           TH Payment Sts
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PGM.*Program mode is *ADD
     C           W0PMD     IFEQ 'ADD'                      *IF
      * Rtv Std Time,buyer    RT - Producer  * 
     C                     EXSR NJRVGN
     C                     END                             *FI
     C                     END
      * Check relations
      * Check reference to Tattoo Header Process
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Producer Location
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Hog Buyer
     C                     EXSR VDCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Genetic
     C                     EXSR VECKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9938  *
     C                     END
      * Check reference to Hog Classification
     C                     EXSR VFCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9934  *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * CALC: Detail screen function fields
      * DTL.TH Live Purch UOM  Usr = Condition name of DTL.TH Live Purcha
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100063   Y2LSNO  70       List number
     C                     PARM #1CPST    W0INVL 25        TH Live Purchas
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DEPTX    PARM           W0CNNM 25        TH Live Purch U
      *
      * DTL.Sex Desc Usr = Condition name of DTL.TH Sex
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1135183   Y2LSNO  70       List number
     C                     PARM #1E2ST    W0INVL 25        TH Sex
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DFRTX    PARM           W0CNNM 25        Sex Desc Usr
      *
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
     C                     EXSR NKRVGN
     C                     MOVEL'Y'       WUNEST           Ship Wgt Allow
      * Test of allow ship weight to be input/output
      * CASE: DTL.TH Payment Sts is Paid Anything
     C           #1CWST    IFEQ 'PL'                       *IF
     C           #1CWST    OREQ 'PC'
     C           #1CWST    OREQ 'NC'
     C           #1CWST    OREQ 'NL'
     C                     MOVEL'N'       WUNEST           Ship Wgt Allow
     C                     ELSE
      * CASE: DTL.TH Held Over is greater than 0
     C           #1H9NB    IFGT *ZERO                      *IF
     C                     MOVEL'N'       WUNEST           Ship Wgt Allow
     C                     ELSE
      * CASE: DTL.TH Held Over Record is Yes
     C           #1E1ST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WUNEST           Ship Wgt Allow
     C                     MOVEL'Y'       WUNFST           Held Over Recor
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Test of held over quanity
      * CASE: DTL.TH Held Over is greater than 0
     C           #1H9NB    IFGT *ZERO                      *IF
     C                     MOVEL'Y'       WUNFST           Held Over Recor
     C                     END                             *FI
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate detail screen relations
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is CF03
      *   |- c2    : DTL.*CMD key is *Add
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN03     IFEQ '1'                        *IF
     C           *IN09     IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv and UnAssigned    RT - Tattoo Pending  * 
     C                     EXSR NLRVGN
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
      * Shipped Weight Validation
      * CASE: DTL.TH Live Purchase UOM is Shipped Weight List
     C           #1CPST    IFEQ 'SW'                       *IF
     C           #1CPST    OREQ 'SX'
      * CASE: WRK.Held Over Records Y/N is Yes
     C           WUNFST    IFEQ 'Y'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.TH Shipped Weight is Greater then Zero
     C           #1HGNB    IFGT *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     Z-ADD#1HGNB    ZA0026           TH Shipped Weig
      * Send message 'Shipped Weight is Requird'
     C                     MOVEL'PRK0653' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9945  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Status
      * CASE: DTL.TH Payment Sts is Paid Producer
     C           #1CWST    IFEQ 'PL'                       *IF
     C           #1CWST    OREQ 'PC'
     C           #1CWST    OREQ 'NC'
     C           #1CWST    OREQ 'NL'
     C                     ELSE
      * CASE: *OTHERWISE
      * If UOM or price changes, set Status to Recalulate net
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DTL.TH Live Purchase UOM NE WRK.TH Live Purchase UOM
      *   |- c2    : DTL.TH Live Purchase Price NE WRK.TH Live Purchase P
      *   '-
     C           #1CPST    IFNE WUCPST                     *IF
     C           #1ACPR    ORNE WUACPR                     *OR
     C                     MOVEL'R'       #1JWST           TH Calc Net Sts
     C                     MOVELWUCRTX    #1J9ST           TH Payment Type
     C                     END                             *FI
     C                     END                             *FI
      * Changes in ship information to require reprint of scale ticket
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.TH Shipped Weight NE WRK.TH Shipped Weight
      *   |- c2    : DTL.TH Live Purchase UOM is Shipped Weight List
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1HGNB    IFNE WUHGNB                     *IF
     C           #1CPST    IFEQ 'SW'                       *IF
     C           #1CPST    OREQ 'SX'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'S'       WUCZST           @Print Status
     C                     END                             *FI
      * validation of Defects
     C                     EXSR UESUBR                     validation of D
      * * 01/27/03 PKD PK0495 Replaced HP255 with HP249.
      * 12/12/02 PK0495 Get farm, state from HPS Movement
      * CASE: DTL.TH Source Type is Internal
     C           #1KAST    IFEQ 'I'                        *IF
      * Rtv HPS Farm Info     UP - STR HPS Interface  * 
     C                     CALL 'HP249'                90  Rtv HPS Farm In
     C           WURTN     PARM WURTN     WQ0095  7        *Return code
     C                     PARM #1OXNB    WQ0096  70       TH HPS Movement
     C           WUKQTX    PARM *BLANK    WQ0097 25        Farm site Name
     C           WUETNB    PARM *ZERO     WQ0098  50       Farm Site USR
     C           WUG4CD    PARM *BLANK    WQ0099  5        HPS FS Comp Rel
     C           P2DRTX    PARM *BLANK    WQ0100  3        State
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP249'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
     C                     END
     C                     Z-ADDWUETNB    #1THHD           TH HPS Farm Sit
      * CASE: WRK.Farm Site USR NE WRK.Zero USR
     C           WUETNB    IFNE WUE9NB                     *IF
     C                     MOVELP2DRTX    #1NZTX           TH State
      * 4/26/2006 same routine on validation of state and getting desc
     C                     MOVELWUCRTX    YL0003           Return Code USR
      * Rtv State Description UP - STR VND Common Routines  * 
     C                     CALL 'STATERET'             90  Rtv State Descr
     C           YL0003    PARM YL0003    WQ0101  7        Return Code USR
     C                     PARM #1NZTX    WQ0102  3        State
     C           #DLXTX    PARM *BLANK    WQ0103 30        State Desc 30 U
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'STATERET'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     9941  *
     C                     END
      * Invalid state code send message
      * CASE: LCL.Return Code USR is *Normal
     C           YL0003    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1NZTX    ZA0057           TH State
      * Send message 'State Code Invalid'
     C                     MOVEL'PRK0308' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9941  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * HC Class Code required
     C           #1BECD    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9934  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * TH Sex required
     C           #1E2ST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9937  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * GN Genetic Code required
     C           #1AGCD    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9938  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * TH Schedule Kill Shift required
     C           #1LIST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9940  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         EAPMCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert internal to external form
     C                     EXSR MOCV#D
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Force PUTOVR
     C                     SETON                         86*
      * Update screen time
     C                     TIME           ##TME
      * Refresh screen
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT2
     C                     WRITE#RCDDTL1
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO EAEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'PKVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPR##    BEGSR
      *================================================================
      * Process record:
      *================================================================
      * Process add request
     C           W0PMD     CASEQ'ADD'     ECADRQ
      * Process update request
     C           W0PMD     CASNE'ADD'     EECHRQ
     C                     END
     C           W0RTN     IFEQ *BLANK
      * USER: Process command keys
      * CASE: PGM.*Program mode is *CHANGE
     C           W0PMD     IFEQ 'CHG'                      *IF
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: PGM.*Program mode is *ADD
     C           W0PMD     IFEQ 'ADD'                      *IF
     C                     Z-ADD#1CVNB    P1CVNB           TH Tattoo Numbe
     C                     END                             *FI
     C                     END                             *FI
     C           W0PMD     IFEQ 'ADD'
      * Exit after successful add
     C                     MOVEL'N'       W0RPT
     C                     END
      * Restart program for next record
     C                     MOVEL'N'       W0TRN
     C                     END
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         ECADRQ    BEGSR
      *================================================================
      * Process add request
      *================================================================
      * USER: Create DBF record
      * Crt Ttt Hdr-chg retrn IF
      * 022106 slm Site id must be updated when a record is created
      *        also make sure that the producer is on the record
     C                     MOVEL'Y'       YL0011           Random Tattoo S
      * HPE076 --
      * CASE: PAR.Company Value Code    USR is Last Tattoo - Research
     C           P2FACD    IFEQ @CN,003                    *IF
     C                     MOVEL'R'       YL0012           Tattoo Type USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0012           Tattoo Type USR
     C                     END                             *FI
      * Make sure tattoo is STILL unused, if not, get the next unused nbr
      * CASE: PAR.User modified: 0-not modi is Not modified
     C           P2UMOD    IFEQ '0'                        *IF
      * CASE:
      *  - c1ORc2 OR c3 OR c4
      *   |- c1    : PAR.Company Value Code    USR is Last Tattoo - Marke
      *   |- c2    : PAR.Company Value Code    USR is Last Tattoo - SBD T
      *   |- c3    : LCL.Random Tattoo Sts USR is Yes
      *   |- c4    : PAR.Company Value Code    USR is Last Tattoo - Resea
      *   '-
     C           P2FACD    IFEQ @CN,004                    *IF
     C           P2FACD    OREQ @CN,005                    *OR
     C           YL0011    OREQ 'Y'                        *OR
     C           P2FACD    OREQ @CN,003                    *OR
      * Rtv Val Ttt,Kll Dt    RT - Tattoo Header  * 
     C                     EXSR NNRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * RTV Next Tattoo Nbrs  XF - Tattoo Header  * 
     C                     CALL 'PKY4XFR'              90  RTV Next Tattoo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0104  30       BOH Company Num
     C                     PARM #1LLST    WQ0105  1        HC Class Type
     C           #1CVNB    PARM #1CVNB    WQ0106  50       Tattoo Number U
     C           WUFACD    PARM WUFACD    WQ0107 10        Company Value C
     C                     PARM 'R'       WQ0108  1        Creation Point
     C                     PARM P1B0DT    WQ0109  70       TH Kill Date
     C           WULMST    PARM WULMST    WQ0110  7        Return Code USR
     C                     PARM #1KAST    WQ0111  1        SR Type
     C                     PARM P2WEST    WQ0112  1        SBD Top Load St
     C                     PARM YL0012    WQ0113  1        Tattoo Type USR
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKY4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Prev Kill Date    XF - STR Order Management Sys  * 
     C                     CALL 'PDRUXFR'              90  Rtv Prev Kill D
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0114  30       BOH Company Num
     C                     PARM P1B0DT    WQ0115  70       Cut Date
     C           YL0013    PARM *ZERO     WQ0116  70       Date USR
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDRUXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Rtv Val Ttt,Kll Dt    RT - Tattoo Header  * 
     C                     EXSR NORVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * RTV Next Tattoo Nbrs  XF - Tattoo Header  * 
     C                     CALL 'PKY4XFR'              90  RTV Next Tattoo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0117  30       BOH Company Num
     C                     PARM #1LLST    WQ0118  1        HC Class Type
     C           #1CVNB    PARM #1CVNB    WQ0119  50       Tattoo Number U
     C           WUFACD    PARM WUFACD    WQ0120 10        Company Value C
     C                     PARM 'R'       WQ0121  1        Creation Point
     C                     PARM P1B0DT    WQ0122  70       TH Kill Date
     C           WULMST    PARM WULMST    WQ0123  7        Return Code USR
     C                     PARM #1KAST    WQ0124  1        SR Type
     C                     PARM P2WEST    WQ0125  1        SBD Top Load St
     C                     PARM YL0012    WQ0126  1        Tattoo Type USR
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKY4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Check next kill date **
      * Rtv Nxt Kill Dt 2 OMS XF - STR Order Management Sys  * 
     C                     CALL 'PDUXXFR'              90  Rtv Nxt Kill Dt
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0127  30       CC Company Numb
     C                     PARM P1B0DT    WQ0128  70       Kill Date Usr
     C           YL0014    PARM *ZERO     WQ0129  70       Next Kill Date
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDUXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Rtv Val Ttt,Kll Dt    RT - Tattoo Header  * 
     C                     EXSR NPRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * RTV Next Tattoo Nbrs  XF - Tattoo Header  * 
     C                     CALL 'PKY4XFR'              90  RTV Next Tattoo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0130  30       BOH Company Num
     C                     PARM #1LLST    WQ0131  1        HC Class Type
     C           #1CVNB    PARM #1CVNB    WQ0132  50       Tattoo Number U
     C           WUFACD    PARM WUFACD    WQ0133 10        Company Value C
     C                     PARM 'R'       WQ0134  1        Creation Point
     C                     PARM P1B0DT    WQ0135  70       TH Kill Date
     C           WULMST    PARM WULMST    WQ0136  7        Return Code USR
     C                     PARM #1KAST    WQ0137  1        SR Type
     C                     PARM P2WEST    WQ0138  1        SBD Top Load St
     C                     PARM YL0012    WQ0139  1        Tattoo Type USR
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKY4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Next Tattoo Nbrs  XF - Tattoo Header  * 
     C                     CALL 'PKY4XFR'              90  RTV Next Tattoo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0140  30       BOH Company Num
     C                     PARM #1LLST    WQ0141  1        HC Class Type
     C           #1CVNB    PARM #1CVNB    WQ0142  50       Tattoo Number U
     C           WUFACD    PARM WUFACD    WQ0143 10        Company Value C
     C                     PARM 'R'       WQ0144  1        Creation Point
     C                     PARM P1B0DT    WQ0145  70       TH Kill Date
     C           WULMST    PARM WULMST    WQ0146  7        Return Code USR
     C                     PARM #1KAST    WQ0147  1        SR Type
     C                     PARM P2WEST    WQ0148  1        SBD Top Load St
     C                     PARM YL0012    WQ0149  1        Tattoo Type USR
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKY4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * If internal output head rcvd and create tattoo detail,upd pen
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.@Status Internal (Y/N) is No
      *   |- c2    : PAR.TH Resale Spread Sts is Not Spread/Spread
      *   '-
     C           WUKPST    IFEQ *BLANK                     *IF
     C           #1C2ST    OREQ *BLANK                     *OR
     C           #1C2ST    OREQ 'P'
     C                     Z-ADD#1CWNB    WUCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WUDINB           BOL Live Wgt Re
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD#DB5NB    WUCWNB           TH Head Receive
      * Crt Tattoo Dtl        XF - Tattoo Detail  * 
     C                     CALL 'PKZXXFR'              90  Crt Tattoo Dtl
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0150  30       BOH Company Num
     C                     PARM P1BNNB    WQ0151  50       BOH Buy Order N
     C                     PARM P1BONB    WQ0152  50       BOL Load Number
     C                     PARM P1B0DT    WQ0153  70       TH Kill Date
     C                     PARM *ZERO     WQ0154  51       TD Avg Live Wgt
     C                     PARM *BLANK    WQ0155  1        TD Gen Bal To K
     C                     PARM 'N'       WQ0156  1        TD Recs Created
     C                     PARM 'N'       WQ0157  1        TD User Status
     C                     PARM 'N'       WQ0158  1        TD User Status
     C                     PARM *ZERO     WQ0159  70       TD User Date 1
     C                     PARM *ZERO     WQ0160  70       TD User Date 2
     C                     PARM *ZERO     WQ0161  70       TD Drive Date
     C                     PARM P1HMNB    WQ0162  30       Pen Company Num
     C                     PARM #1CVNB    WQ0163  50       Tattoo Number N
     C                     PARM *ZERO     WQ0164  71       Live Wgt Tot US
     C                     PARM #DB5NB    WQ0165  70       Head Total USR
     C                     PARM #DCMCD    WQ0166  3        Pen Usr
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKZXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9939  *
     C                     END
      * Rtv Dtl hd/Chg Pen    RT - Tattoo Detail  * 
     C                     EXSR NQRVGN
     C                     Z-ADD*ZERO     WUDINB           BOL Live Wgt Re
      * Rtv/Chg Bol Hd rcvd   RT - Buy Order Load  * 
     C                     EXSR OARVGN
      * BOH - Change Status to Locked so BOH info may not be changed!
      * Rtv/Chg BOH Status     RT - Buy Order Header  * 
     C                     EXSR ODRVGN
      * Rtv Chg Lock Sts      RT - Delivery Sched Detail  * 
     C                     EXSR OFRVGN
     C                     END                             *FI
      * Create Tattoo Header - Tattoo Header  * 
     C                     EXSR OHCRRC
      * New File Created(Buy order load EXT) to load Load SHipped Head
      * Upd Shipped Head      RT - Buy Order Load  * 
     C                     EXSR OIRVGN
      * E00144 slm allow defects on Market and Resale
      * Market hogs will only be for LFT OR EUT/KOA
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) #1BECD' defaulted for 'HC Class Code'.
      * Crt Tattoo Def-10     IF
      * Rtv Del Tattoo Def - Tattoo Defect  * 
     C                     EXSR OKRVGN
      * Defect 1
      * CASE: PAR.Defect User  1 NE WRK.Blank Usr 1 fld Usr
     C           #DGUCD    IFNE WUIXTX                     *IF
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
     C                     EXSR OMCRRC
     C                     END                             *FI
      * Defect 2
      * CASE: PAR.Defect User  2 NE WRK.Blank Usr 1 fld Usr
     C           #DGVCD    IFNE WUIXTX                     *IF
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
     C                     EXSR OOCRRC
     C                     END                             *FI
      * Defect 3
      * CASE: PAR.Defect User  3 NE WRK.Blank Usr 1 fld Usr
     C           #DGWCD    IFNE WUIXTX                     *IF
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
     C                     EXSR OQCRRC
     C                     END                             *FI
      * Defect 4
      * CASE: PAR.Defect User  4 NE WRK.Blank Usr 1 fld Usr
     C           #DGXCD    IFNE WUIXTX                     *IF
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
     C                     EXSR OSCRRC
     C                     END                             *FI
      * Defect 5
      * CASE: PAR.Defect User  5 NE WRK.Blank Usr 1 fld Usr
     C           #DGYCD    IFNE WUIXTX                     *IF
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
     C                     EXSR OUCRRC
     C                     END                             *FI
      * Defect 6
      * CASE: PAR.Defect User  6 NE WRK.Blank Usr 1 fld Usr
     C           #DGZCD    IFNE WUIXTX                     *IF
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
     C                     EXSR OWCRRC
     C                     END                             *FI
      * Defect 7
      * CASE: PAR.Defect User  7 NE WRK.Blank Usr 1 fld Usr
     C           #DG0CD    IFNE WUIXTX                     *IF
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
     C                     EXSR OYCRRC
     C                     END                             *FI
      * Defect 8
      * CASE: PAR.Defect User  8 NE WRK.Blank Usr 1 fld Usr
     C           #DG1CD    IFNE WUIXTX                     *IF
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
     C                     EXSR PACRRC
     C                     END                             *FI
      * Defect 9
      * CASE: PAR.Defect User  9 NE WRK.Blank Usr 1 fld Usr
     C           #DG2CD    IFNE WUIXTX                     *IF
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
     C                     EXSR PCCRRC
     C                     END                             *FI
      * Defect 10
      * CASE: PAR.Defect User 10 NE WRK.Blank Usr 1 fld Usr
     C           #DG3CD    IFNE WUIXTX                     *IF
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
     C                     EXSR PECRRC
     C                     END                             *FI
      * CASE: PAR.TH Hog Class Type is Market
     C           #1LLST    IFEQ 'M'                        *IF
      * Chg TaDefTots THdrBol XF - Tattoo Defect  * 
     C                     CALL 'PLL2XFR'              90  Chg TaDefTots T
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0176  30       BOH Company Num
     C                     PARM P1BNNB    WQ0177  50       BOH Buy Order N
     C                     PARM P1BONB    WQ0178  50       BOL Load Number
     C                     PARM #1CVNB    WQ0179  50       TH Tattoo Numbe
     C                     PARM P1B0DT    WQ0180  70       TH Kill Date
     C                     PARM #1LLST    WQ0181  1        TH Hog Class Ty
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLL2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * 4/8/2008 slm Support Issue - Move# and Reference was not
      * getting updated in the delivery tracking if the tattoo was
      * added.  This was getting updated on the change only
      * If External -- change group/movement on Delv Tracking if its ther
      * CASE: PAR.TH Source Type is External
     C           #1KAST    IFEQ 'E'                        *IF
      * Rtv Chg Movemnt/Group RT - Delivery Tracking  * 
     C                     EXSR PGRVGN
     C                     END                             *FI
      * ** 12/28/05 LJB - Create Tattoo hdr ext rec with Producer code an
      * ** site id
      * Crt TatHdrExt WTPrdSitCO - Tattoo Header EXT  * 
     C                     EXSR PICRRC
      * Send "Tatto has been added" message
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     Z-ADD#1CVNB    ZA0058           TH Tattoo Numbe
      * Send message 'Tattoo &1 has been added.'
     C                     MOVEL'PRK0359' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y'       YL0010           Record Added Us
     C                     GOTO ECEXIT                     *QUIT
     C                     END                             *FI
     C           W0RTN     IFEQ *BLANK
      * Send message '*Record added'
     C                     MOVEL'Y2U0011' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
      *================================================================
     CSR         ECEXIT    ENDSR
      /EJECT
     CSR         EECHRQ    BEGSR
      *================================================================
      * Process update request
      *================================================================
      * USER: Change DBF record
      * Chg Tattoo Header,Pen IF
      * IF Internal -- chg td and pen
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.@Status Internal (Y/N) is No
      *   |- c2    : PAR.TH Resale Spread Sts is Not Spread/Spread
      *   '-
     C           WUKPST    IFEQ *BLANK                     *IF
     C           #1C2ST    OREQ *BLANK                     *OR
     C           #1C2ST    OREQ 'P'
     C                     Z-ADD#1CWNB    WUCWNB           TH Head Receive
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD#DB5NB    WUCWNB           TH Head Receive
      * Rtv Crt/Chg hd, pen  RT - Tattoo Detail  * 
     C                     EXSR PJRVGN
      * Update BOL if head received changed with the head diff.
      * CASE: PAR.Head Total USR NE PAR.TH Head Received
     C           #DB5NB    IFNE #1CWNB                     *IF
     C           #DB5NB    SUB  #1CWNB    WUZYNB           Head Total Usr
     C                     Z-ADD*ZERO     WUDINB           BOL Live Wgt Re
      * Rtv/Chg Bol Hd rcvd   RT - Buy Order Load  * 
     C                     EXSR PLRVGN
     C                     END                             *FI
      * Update pen count  -- if head or pen changed
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Head Total USR NE PAR.TH Head Received
      *   |- c2    : PAR.Pen Number NE PAR.Pen Usr
      *   '-
     C           #DB5NB    IFNE #1CWNB                     *IF
     C           #DCMCD    ORNE WUCBCD                     *OR
      * Rtv Dtl hd/Chg Pen    RT - Tattoo Detail  * 
     C                     EXSR PORVGN
     C                     END                             *FI
      * Update pen count -- original pen if pen changed
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Pen Number NE PAR.Pen Usr
      *   |- c2    : PAR.Pen Usr is Pen Number not Empty
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DCMCD    IFNE WUCBCD                     *IF
     C           WUCBCD    IFGT *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Dtl hd/Chg Pen    RT - Tattoo Detail  * 
     C                     EXSR PYRVGN
     C                     END                             *FI
     C                     END                             *FI
      * If External -- change group/movement on Delv Tracking if its ther
      * CASE: PAR.TH Source Type is External
     C           #1KAST    IFEQ 'E'                        *IF
      * Rtv Chg Movemnt/Group RT - Delivery Tracking  * 
     C                     EXSR QIRVGN
     C                     END                             *FI
      * Chg Tattoo Hdr w/new  CH - Tattoo Header  * 
     C                     EXSR QKCHRC
      * Rtv/Chg Ttt's Lv Prc  XF - Tattoo Header  * 
     C                     CALL 'PKR8XFR'              90  Rtv/Chg Ttt's L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0208  30       BOH Company Num
     C                     PARM P1BNNB    WQ0209  50       BOH Buy Order N
     C                     PARM P1BONB    WQ0210  50       BOL Load Number
     C                     PARM #1CVNB    WQ0211  50       TH Tattoo Numbe
     C                     PARM P1B0DT    WQ0212  70       TH Kill Date
     C                     PARM #1AWDT    WQ0213  70       TH Purchase Dat
     C                     PARM #1BICD    WQ0214 10        TH Group Refere
     C                     PARM #1CPST    WQ0215  2        TH Live Purchas
     C                     PARM #1ACPR    WQ0216  52       TH Live Purchas
     C                     PARM #1B9PR    WQ0217  72       TH Live Gross A
     C                     PARM #1CAPR    WQ0218  72       TH LIve Net Amt
     C                     PARM #1C4ST    WQ0219  2        TH Resale UOM
     C                     PARM #1AIPR    WQ0220  52       TH Recalc Live
     C                     PARM #1A6DT    WQ0221  70       TH Pricing Date
     C                     PARM #1C2ST    WQ0222  1        TH Resale Sprea
     C                     PARM #1CXNB    WQ0223  50       TH Dead On Arri
     C                     PARM WUCWNB    WQ0224  50       TH Head Receive
     C                     PARM #1FCNB    WQ0225  50       TH Yard Deads
     C                     PARM #1H9NB    WQ0226  50       TH Held Over
     C                     PARM #1FDNB    WQ0227  50       TH Head Condemn
     C                     PARM #1FENB    WQ0228  50       TH Head Killed
     C                     PARM #1HENB    WQ0229  50       TH Head Adds
     C                     PARM #1HFNB    WQ0230  50       TH Head Accepte
     C                     PARM #1CYNB    WQ0231  71       TH Live Wgt
     C                     PARM #1LRNB    WQ0232  71       TH Adj Live Wgt
     C                     PARM #1E0NB    WQ0233  71       TH Hot Wgt
     C                     PARM #1A5PC    WQ0234  61       TH Tot Loin Eye
     C                     PARM #1FBNB    WQ0235  61       TH Tot Backfat
     C                     PARM #1A4PC    WQ0236  61       TH Tot Light Re
     C                     PARM #1F7NB    WQ0237  51       TH Avg Live Wgt
     C                     PARM #1HDNB    WQ0238  51       TH Avg Hot Wgt
     C                     PARM #1F5NB    WQ0239  31       TH Avg Light Re
     C                     PARM #1F4NB    WQ0240  31       TH Avg Lean Per
     C                     PARM #1F3NB    WQ0241  31       TH Avg Loin Eye
     C                     PARM #1F2NB    WQ0242  31       TH Avg Backfat
     C                     PARM #1AVPC    WQ0243  52       TH Std Yield Pe
     C                     PARM #1AWPC    WQ0244  52       TH Actual Yield
     C                     PARM #1CWPC    WQ0245  52       TH Adj Actual Y
     C                     PARM #1A8PC    WQ0246  52       TH Yield Differ
     C                     PARM #1A7PC    WQ0247  31       TH Recalc Live
     C                     PARM #1B8PR    WQ0248  52       TH CM Market Pr
     C                     PARM #1AMPR    WQ0249  52       TH CM Base Mkt
     C                     PARM #1ANPR    WQ0250  72       TH CM Base Mkt
     C                     PARM #1AYVA    WQ0251  72       TH CM Sort Disc
     C                     PARM #1AWVA    WQ0252  72       TH CM Yield Gai
     C                     PARM #1AOPR    WQ0253  72       TH CM Base Carc
     C                     PARM #1AXVA    WQ0254  72       TH CM LN AddOn/
     C                     PARM #1APPR    WQ0255  72       TH CM Carcass G
     C                     PARM #1ASPR    WQ0256  72       TH Deduction Am
     C                     PARM #1A4VA    WQ0257  72       TH Total Net WO
     C                     PARM #1ATPR    WQ0258  72       TH Carcass Net
     C                     PARM #1A5VA    WQ0259  72       TH Additions Am
     C                     PARM #1CBPR    WQ0260  72       TH Payment Gros
     C                     PARM #1CCPR    WQ0261  72       Th Payment Net
     C                     PARM #1LPNB    WQ0262  80       TH AP Voucher/D
     C                     PARM #1CDPR    WQ0263  72       TH Freight Amou
     C                     PARM #1A7VA    WQ0264  72       TH Accrual Amou
     C                     PARM #1A2PR    WQ0265  72       TH Fixed Cost A
     C                     PARM #1JWST    WQ0266  1        TH Calc Net Sts
     C                     PARM #1CWST    WQ0267  2        TH Payment Sts
     C                     PARM #1D7ST    WQ0268  1        TH Header Error
     C                     PARM #1D8ST    WQ0269  1        TH Detail Error
     C                     PARM #1DWST    WQ0270  1        TH Kill Balanci
     C                     PARM #1D6ST    WQ0271  1        TH Bal to Kill
     C                     PARM #1GHNB    WQ0272  80       TH Commission A
     C                     PARM #1BYDT    WQ0273  70       TH Voucher Paym
     C                     PARM #1E0ST    WQ0274  1        TH User Error O
     C                     PARM #1E1ST    WQ0275  1        TH Held Over Re
     C                     PARM #1E2ST    WQ0276  1        TH Sex
     C                     PARM #1BSDT    WQ0277  70       TH Held/Ovr Com
     C                     PARM #1BTDT    WQ0278  70       TH Commission P
     C                     PARM #1BUDT    WQ0279  70       TH Actual Check
     C                     PARM #1HGNB    WQ0280  71       TH Shipped Weig
     C                     PARM #1HHNB    WQ0281  71       TH Avg Hot Wgt
     C                     PARM #1HINB    WQ0282  31       TH FFLI
     C                     PARM #1A3PR    WQ0283  72       TH Kill Product
     C                     PARM #1A4PR    WQ0284  72       TH Cut Product
     C                     PARM #1A6PR    WQ0285  72       TH Render Produ
     C                     PARM #1J9NB    WQ0286  50       TH Head Exclude
     C                     PARM #1D6PR    WQ0287  52       TH CM Bse Mkt L
     C                     PARM #1D7PR    WQ0288  52       TH CM Bse Mkt C
     C                     PARM #1D8PR    WQ0289  52       TH CM Srt Dsc L
     C                     PARM #1D9PR    WQ0290  52       TH CM Srt Dsc C
     C                     PARM #1EAPR    WQ0291  52       TH CM Yld G/L L
     C                     PARM #1EBPR    WQ0292  52       TH CM Yld G/L C
     C                     PARM #1ECPR    WQ0293  52       TH CM Crc Val L
     C                     PARM #1EDPR    WQ0294  52       TH CM Crc Val C
     C                     PARM #1EEPR    WQ0295  52       TH CM Lean Prem
     C                     PARM #1EFPR    WQ0296  52       TH CM Lean Prem
     C                     PARM #1EGPR    WQ0297  52       TH CM Gross Liv
     C                     PARM #1EHPR    WQ0298  52       TH CM Gross Car
     C                     PARM #1KAST    WQ0299  1        TH Source Type
     C                     PARM #1J7ST    WQ0300  1        TH Scale Ticket
     C                     PARM #1J9ST    WQ0301  1        TH Payment Type
     C                     PARM #1OXNB    WQ0302  70       TH HPS Movement
     C                     PARM #1LKST    WQ0303  3        TH Source Code
     C                     PARM #1LLST    WQ0304  1        TH Hog Class Ty
     C                     PARM #1J8ST    WQ0305  1        TH Posted to HP
     C                     PARM #1LIST    WQ0306  1        TH Schedule Kil
     C                     PARM #1LJST    WQ0307  1        TH Shift Held O
     C                     PARM #1NZTX    WQ0308  3        TH State
     C                     PARM #1HJCD    WQ0309  3        TH Unused Code
     C                     PARM #1R4ST    WQ0310  2        TH Unused Sts 2
     C                     PARM #1R5ST    WQ0311  1        TH Commission S
     C                     PARM #1R6ST    WQ0312  1        TH Paid 2 Week
     C                     PARM #1R7ST    WQ0313  1        TH Unused Sts 1
     C                     PARM #1THWT    WQ0314  71       TH DOA Weight
     C                     PARM #1T2WT    WQ0315  71       TH Avg Lean % E
     C                     PARM #1THHD    WQ0316  50       TH HPS Farm Sit
     C                     PARM #1T2HD    WQ0317  50       TH Shift Held O
     C                     PARM #1OBPR    WQ0318  72       TH Sorting Amou
     C                     PARM #1BDCD    WQ0319  6        DF Defect Code
     C                     PARM #1CSCD    WQ0320  6        THP Process Cod
     C                     PARM P1ABCD    WQ0321  6        PD Producer Cod
     C                     PARM P1AECD    WQ0322  6        PL Location Cod
     C                     PARM #1ACCD    WQ0323  3        HB Buyer Code
     C                     PARM #1AGCD    WQ0324  5        GN Genetic Code
     C                     PARM #1BECD    WQ0325  3        HC Class Code
     C                     PARM #1AAVN    WQ0326 10        RS User Changed
     C                     PARM #1AADT    WQ0327  70       RS Date Changed
     C                     PARM #1AMTM    WQ0328  60       RS Time Changed
     C                     PARM #1AJST    WQ0329  1        RS Record Statu
     C                     PARM #1AHVN    WQ0330 10        RS Job
     C                     PARM #1AGVN    WQ0331 10        RS Program
     C                     PARM #1ABVN    WQ0332 10        RS User Added
     C                     PARM #1ABDT    WQ0333  70       RS Date Added
     C                     PARM #1ABTM    WQ0334  60       RS Time Added
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKR8XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993644*
     C                     SETON                     434237*
     C                     SETON                     453540*
     C                     SETON                     413834*
     C                     END
      * New File Created(buy order head ext) to load load shipped head
      * Upd Shipped Head      RT - Buy Order Load  * 
     C                     EXSR QPRVGN
      * Crt Tattoo Def-10     IF
      * Rtv Del Tattoo Def - Tattoo Defect  * 
     C                     EXSR QRRVGN
      * Defect 1
      * CASE: PAR.Defect User  1 NE WRK.Blank Usr 1 fld Usr
     C           #DGUCD    IFNE WUIXTX                     *IF
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
     C                     EXSR QTCRRC
     C                     END                             *FI
      * Defect 2
      * CASE: PAR.Defect User  2 NE WRK.Blank Usr 1 fld Usr
     C           #DGVCD    IFNE WUIXTX                     *IF
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
     C                     EXSR QVCRRC
     C                     END                             *FI
      * Defect 3
      * CASE: PAR.Defect User  3 NE WRK.Blank Usr 1 fld Usr
     C           #DGWCD    IFNE WUIXTX                     *IF
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
     C                     EXSR QXCRRC
     C                     END                             *FI
      * Defect 4
      * CASE: PAR.Defect User  4 NE WRK.Blank Usr 1 fld Usr
     C           #DGXCD    IFNE WUIXTX                     *IF
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
     C                     EXSR QZCRRC
     C                     END                             *FI
      * Defect 5
      * CASE: PAR.Defect User  5 NE WRK.Blank Usr 1 fld Usr
     C           #DGYCD    IFNE WUIXTX                     *IF
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
     C                     EXSR RBCRRC
     C                     END                             *FI
      * Defect 6
      * CASE: PAR.Defect User  6 NE WRK.Blank Usr 1 fld Usr
     C           #DGZCD    IFNE WUIXTX                     *IF
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
     C                     EXSR RDCRRC
     C                     END                             *FI
      * Defect 7
      * CASE: PAR.Defect User  7 NE WRK.Blank Usr 1 fld Usr
     C           #DG0CD    IFNE WUIXTX                     *IF
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
     C                     EXSR RFCRRC
     C                     END                             *FI
      * Defect 8
      * CASE: PAR.Defect User  8 NE WRK.Blank Usr 1 fld Usr
     C           #DG1CD    IFNE WUIXTX                     *IF
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
     C                     EXSR RHCRRC
     C                     END                             *FI
      * Defect 9
      * CASE: PAR.Defect User  9 NE WRK.Blank Usr 1 fld Usr
     C           #DG2CD    IFNE WUIXTX                     *IF
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
     C                     EXSR RJCRRC
     C                     END                             *FI
      * Defect 10
      * CASE: PAR.Defect User 10 NE WRK.Blank Usr 1 fld Usr
     C           #DG3CD    IFNE WUIXTX                     *IF
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
     C                     EXSR RLCRRC
     C                     END                             *FI
      * CASE: PAR.TH Hog Class Type is Market
     C           #1LLST    IFEQ 'M'                        *IF
      * Chg TaDefTots THdrBol XF - Tattoo Defect  * 
     C                     CALL 'PLL2XFR'              90  Chg TaDefTots T
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0335  30       BOH Company Num
     C                     PARM P1BNNB    WQ0336  50       BOH Buy Order N
     C                     PARM P1BONB    WQ0337  50       BOL Load Number
     C                     PARM #1CVNB    WQ0338  50       TH Tattoo Numbe
     C                     PARM P1B0DT    WQ0339  70       TH Kill Date
     C                     PARM #1LLST    WQ0340  1        TH Hog Class Ty
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLL2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Change pen desc if the genetics for the tattoo changed
      * CASE: PAR.GN Genetic Code NE PAR.Genetic Code USR
     C           #1AGCD    IFNE WUAGCD                     *IF
      * Rtv Dtl Pen/Chg PenDscRT - Tattoo Detail  * 
     C                     EXSR RNRVGN
     C                     END                             *FI
      * ** 12/28/05 LJB - include changes in the Tattoo Header Ext file
      * ** 02/22/06 slm - Add the Producer as well as the Site id.
      * UPDATE only the Producer ID and the Site ID.
      * for all Tattoo Header Ext records without kill date.
      * Read by Key first to get record added. by kill date.
      * Chg TatHdrExt by Key  RT - Tattoo Header EXT  * 
     C                     EXSR RTRVGN
      * This read is to change all records.
      * Chg TatHdrExt All TattRT - Tattoo Header EXT  * 
     C                     EXSR RXRVGN
     C           W0RTN     IFNE *BLANK
      * Data update error
      * Reset screen fields if changed record
     C           W0RTN     CASEQ'Y2U0007' MBFL#1
     C                     END
     C                     ELSE
     C           Y1RDC     IFEQ 'Y'
      * Send message '*Record changed'
     C                     MOVEL'Y2U0012' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *================================================================
     CSR         EEEXIT    ENDSR
      /EJECT
     CSR         FACKPM    BEGSR
      *================================================================
      * Check passed parameters
      *================================================================
      * Is full key present?
     C           P1HMNB    IFEQ *ZERO                      BOH Company Num
     C           P1BNNB    OREQ *ZERO                      BOH Buy Order N
     C           P1BONB    OREQ *ZERO                      BOL Load Number
     C           P1B0DT    OREQ *ZERO                      TH Kill Date
     C           P1CVNB    OREQ *ZERO                      TH Tattoo Numbe
      * Not every key field passed - loop program
     C                     MOVEL'Y'       W0RPT   1
     C                     ELSE
      * Full key passed, so single shot program
     C                     MOVEL'N'       W0RPT
     C                     END
      *================================================================
     CSR         FAEXIT    ENDSR
      /EJECT
     CSR         GADSAK    BEGSR
      *================================================================
      * Set key screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSAD    BEGSR
      *================================================================
      * Set detail screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      * Protect key fields on detail screen
     C                     SETON                     88    *
     C                     MOVEL'0'       *IN79
     C           WUDJSS    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           #DQTST    IFEQ *BLANK                     *IF
     C           #DQTST    OREQ 'N'
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           #1KAST    IFEQ 'I'                        *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL'0'       *IN76
     C           WUKPST    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
     C                     MOVEL'0'       *IN75
     C           WUMAST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN75
     C                     END                             *FI
     C                     MOVEL'0'       *IN74
     C           #DQTST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN74
     C                     END                             *FI
     C                     MOVEL'0'       *IN73
     C           #1CWST    IFEQ 'PL'                       *IF
     C           #1CWST    OREQ 'PC'
     C           #1CWST    OREQ 'NC'
     C           #1CWST    OREQ 'NL'
     C                     MOVEL'1'       *IN73
     C                     END                             *FI
     C                     MOVEL'0'       *IN72
     C           WUNEST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN72
     C                     END                             *FI
     C                     MOVEL'0'       *IN71
     C           WUNFST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN71
     C                     END                             *FI
     C           W0RPT     IFEQ 'N'
      * Disable key screen - not applicable
     C                     SETOF                     87    *
     C                     ELSE
      * Enable key screen
     C                     SETON                     87    *
     C                     END
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise record - except for key fields and "neither" paramete
      *================================================================
     C                     MOVEL*BLANK    #DQTST           PL Site ID Requ
     C                     MOVELP2IHST    #PIHST           Record Added Us
     C                     MOVEL*BLANK    #DBSTX           Name USR
     C                     MOVEL*BLANK    #DAGTX           PD Name
     C                     MOVEL*BLANK    #DA8TX           PL Name
     C                     MOVEL*BLANK    #DEPCD           Group Reference
     C                     MOVEL*BLANK    #DO3TX           OMS State
     C                     Z-ADD*ZERO     #DNVA1           LFT usr
     C                     Z-ADD*ZERO     #DNWA1           EUT/KOA Hogs us
     C                     MOVEL*BLANK    #1BDCD           DF Defect Code
     C                     MOVEL*BLANK    #DBCTX           DF Description
     C                     Z-ADD*ZERO     #1B9PR           TH Live Gross A
     C                     Z-ADD*ZERO     #1CAPR           TH LIve Net Amt
     C                     MOVEL*BLANK    #1C4ST           TH Resale UOM
     C                     Z-ADD*ZERO     #1AIPR           TH Recalc Live
     C                     Z-ADD*ZERO     #1A6DT           TH Pricing Date
     C                     MOVEL*BLANK    #1C2ST           TH Resale Sprea
     C                     Z-ADD*ZERO     #1CWNB           TH Head Receive
     C                     Z-ADD*ZERO     #1FCNB           TH Yard Deads
     C                     Z-ADD*ZERO     #1H9NB           TH Held Over
     C                     Z-ADD*ZERO     #1FDNB           TH Head Condemn
     C                     Z-ADD*ZERO     #1FENB           TH Head Killed
     C                     Z-ADD*ZERO     #1LRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     #1HENB           TH Head Adds
     C                     Z-ADD*ZERO     #1HFNB           TH Head Accepte
     C                     Z-ADD*ZERO     #1CYNB           TH Live Wgt
     C                     Z-ADD*ZERO     #1E0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     #1A5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     #1FBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     #1A4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     #1F7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     #1HDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     #1F5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     #1F4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     #1F3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     #1F2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     #1AVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     #1AWPC           TH Actual Yield
     C                     Z-ADD*ZERO     #1CWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     #1A8PC           TH Yield Differ
     C                     Z-ADD*ZERO     #1A7PC           TH Recalc Live
     C                     Z-ADD*ZERO     #1B8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     #1AMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     #1ANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     #1AYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     #1AWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     #1AOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     #1AXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     #1APPR           TH CM Carcass G
     C                     Z-ADD*ZERO     #1ASPR           TH Deduction Am
     C                     Z-ADD*ZERO     #1A4VA           TH Total Net WO
     C                     Z-ADD*ZERO     #1A5VA           TH Additions Am
     C                     Z-ADD*ZERO     #1CBPR           TH Payment Gros
     C                     Z-ADD*ZERO     #1CCPR           Th Payment Net
     C                     Z-ADD*ZERO     #1LPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     #1CDPR           TH Freight Amou
     C                     Z-ADD*ZERO     #1ATPR           TH Carcass Net
     C                     Z-ADD*ZERO     #1A7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     #1A2PR           TH Fixed Cost A
     C                     MOVEL*BLANK    #1JWST           TH Calc Net Sts
     C                     MOVEL*BLANK    #1CWST           TH Payment Sts
     C                     MOVEL*BLANK    #1D7ST           TH Header Error
     C                     MOVEL*BLANK    #1D8ST           TH Detail Error
     C                     MOVEL*BLANK    #1DWST           TH Kill Balanci
     C                     MOVEL*BLANK    #1D6ST           TH Bal to Kill
     C                     Z-ADD*ZERO     #1GHNB           TH Commission A
     C                     Z-ADD*ZERO     #1BYDT           TH Voucher Paym
     C                     MOVEL*BLANK    #1E0ST           TH User Error O
     C                     MOVEL*BLANK    #1E1ST           TH Held Over Re
     C                     Z-ADD*ZERO     #1BSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     #1BTDT           TH Commission P
     C                     Z-ADD*ZERO     #1BUDT           TH Actual Check
     C                     Z-ADD*ZERO     #1HHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     #1HINB           TH FFLI
     C                     Z-ADD*ZERO     #1A3PR           TH Kill Product
     C                     Z-ADD*ZERO     #1A4PR           TH Cut Product
     C                     Z-ADD*ZERO     #1A6PR           TH Render Produ
     C                     Z-ADD*ZERO     #1J9NB           TH Head Exclude
     C                     Z-ADD*ZERO     #1D6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     #1D7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     #1D8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     #1D9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     #1EAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     #1EBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     #1ECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     #1EDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     #1EEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     #1EFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     #1EGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     #1EHPR           TH CM Gross Car
     C                     MOVEL*BLANK    #1KAST           TH Source Type
     C                     MOVEL*BLANK    #1J7ST           TH Scale Ticket
     C                     MOVEL*BLANK    #1J8ST           TH Posted to HP
     C                     MOVEL*BLANK    #1LJST           TH Shift Held O
     C                     MOVEL*BLANK    #1HJCD           TH Unused Code
     C                     MOVEL*BLANK    #1R4ST           TH Unused Sts 2
     C                     MOVEL*BLANK    #1R5ST           TH Commission S
     C                     MOVEL*BLANK    #1R6ST           TH Paid 2 Week
     C                     MOVEL*BLANK    #1R7ST           TH Unused Sts 1
     C                     Z-ADD*ZERO     #1THWT           TH DOA Weight
     C                     Z-ADD*ZERO     #1T2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     #1THHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     #1T2HD           TH Shift Held O
     C                     Z-ADD*ZERO     #1OBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     #1KOER           TH Head Identif
     C                     Z-ADD*ZERO     #1OPIR           TH Percent Iden
     C                     Z-ADD*ZERO     #1OPEM           TH Percent Acce
     C                     Z-ADD*ZERO     #1IORP           TH Head Adjuste
     C                     Z-ADD*ZERO     #1OWEO           TH PHA Head Add
     C                     MOVEL*BLANK    #1OQET           TH PHA Add Type
     C                     MOVEL*BLANK    #1URST           TH PHA Average
     C                     MOVEL*BLANK    #1USST           TH PHA Add Reas
     C                     Z-ADD*ZERO     #1HHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     #1S9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     #1TAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     #1TBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     #1JFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     #1KRIF           TH Broken Back
     C                     Z-ADD*ZERO     #1KORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     #1KAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     #1KROT           TH Excluded Car
     C                     Z-ADD*ZERO     #1OTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     #1IRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     #1IMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     #1IRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     #1KRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     #1OJRF           TH Break Even P
     C                     Z-ADD*ZERO     #1KFOR           TH Meat Value F
     C                     Z-ADD*ZERO     #1ORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     #1OMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     #1MVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     #1MCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     #1NCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     #1NCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     #1IGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     #1KFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     #1EADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     #1EBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     #1EEDT           TH Unused Date
     C                     MOVEL*BLANK    #1U4ST           TH Unused Sts 1
     C                     MOVEL*BLANK    #1U5ST           TH Unused Sts 2
     C                     MOVEL*BLANK    #1U6ST           TH Unused Sts 3
     C                     MOVEL*BLANK    #1U7ST           TH Unused Sts 4
     C                     MOVEL*BLANK    #1U8ST           TH Unused Sts 5
     C                     MOVEL*BLANK    #1U9ST           TH Unused Sts 6
     C                     MOVEL*BLANK    #1VAST           TH Unused Sts 7
     C                     MOVEL*BLANK    #1VBST           TH Unused Sts 8
     C                     MOVEL*BLANK    #1J9ST           TH Payment Type
     C                     MOVEL*BLANK    #1LKST           TH Source Code
     C                     MOVEL*BLANK    #1CSCD           THP Process Cod
     C                     MOVEL*BLANK    #1ACCD           HB Buyer Code
     C                     MOVEL*BLANK    #1AAVN           RS User Changed
     C                     Z-ADD*ZERO     #1AADT           RS Date Changed
     C                     Z-ADD*ZERO     #1AMTM           RS Time Changed
     C                     MOVEL*BLANK    #1AJST           RS Record Statu
     C                     MOVEL*BLANK    #1AHVN           RS Job
     C                     MOVEL*BLANK    #1AGVN           RS Program
     C                     MOVEL*BLANK    #1ABVN           RS User Added
     C                     Z-ADD*ZERO     #1ABDT           RS Date Added
     C                     Z-ADD*ZERO     #1ABTM           RS Time Added
     C                     MOVEL*BLANK    #DKKTX           Description 30
     C                     MOVELP1ABCD    #1ABCD           PD Producer Cod
     C                     MOVELP1AECD    #1AECD           PL Location Cod
     C                     Z-ADD*ZERO     #1AWDT           TH Purchase Dat
      * Clear external version also
     C                     Z-ADD*ZERO     V1AWDT
     C                     MOVEL*BLANK    #DISTX           SR Type Desc
     C                     MOVELP1LLST    #1LLST           TH Hog Class Ty
     C                     MOVEL*BLANK    #DE6TX           HC Class Type D
     C                     Z-ADD*ZERO     #DLDSH           BOL Shipped Hea
     C                     MOVEL*BLANK    #DOVCD           Producer Subsid
     C                     MOVEL*BLANK    #DNYCD           PS Site ID
     C                     MOVEL*BLANK    #1BECD           HC Class Code
     C                     MOVEL*BLANK    #DBDTX           HC Description
     C                     Z-ADDP1OXNB    #1OXNB           TH HPS Movement
     C                     MOVEL*BLANK    #1BICD           TH Group Refere
     C                     MOVELP1E2ST    #1E2ST           TH Sex
     C                     MOVEL*BLANK    #DFRTX           Sex Desc Usr
     C                     MOVELP1AGCD    #1AGCD           GN Genetic Code
     C                     MOVEL*BLANK    #DCMCD           Pen Number
     C                     MOVEL*BLANK    #1LIST           TH Schedule Kil
     C                     Z-ADD*ZERO     #DB5NB           Head Total USR
     C                     MOVEL*BLANK    #1NZTX           TH State
     C                     MOVEL*BLANK    #DLXTX           State Desc 15 U
     C                     Z-ADD*ZERO     #1CXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     #1ECDT           TH Head LFT
     C                     Z-ADD*ZERO     #1EDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     #1ACPR           TH Live Purchas
     C                     MOVEL*BLANK    #DK5TX           Text 9 USR
     C                     MOVEL*BLANK    #1CPST           TH Live Purchas
     C                     MOVEL*BLANK    #DEPTX           TH Live Purch U
     C                     Z-ADD*ZERO     #1HGNB           TH Shipped Weig
     C                     MOVEL*BLANK    #DGUCD           Defect User  1
     C                     Z-ADD*ZERO     #DF1NB           Defect HD user
     C                     MOVEL*BLANK    #DCLSS           Class Df 1 Usr
     C                     MOVEL*BLANK    #DGVCD           Defect User  2
     C                     Z-ADD*ZERO     #DFWNB           Defect HD user
     C                     MOVEL*BLANK    #DCMSS           Class Df 2 Usr
     C                     MOVEL*BLANK    #DGWCD           Defect User  3
     C                     Z-ADD*ZERO     #DFYNB           Defect HD user
     C                     MOVEL*BLANK    #DCNSS           Class Df 3 Usr
     C                     MOVEL*BLANK    #DGXCD           Defect User  4
     C                     Z-ADD*ZERO     #DFUNB           Defect HD user
     C                     MOVEL*BLANK    #DCOSS           Class Df 4 Usr
     C                     MOVEL*BLANK    #DGYCD           Defect User  5
     C                     Z-ADD*ZERO     #DO3NB           Defect HD user
     C                     MOVEL*BLANK    #DCPSS           Class Df 5 Usr
     C                     MOVEL*BLANK    #DGZCD           Defect User  6
     C                     Z-ADD*ZERO     #DO4NB           Defect HD user
     C                     MOVEL*BLANK    #DCQSS           Class Df 6 Usr
     C                     MOVEL*BLANK    #DG0CD           Defect User  7
     C                     Z-ADD*ZERO     #DO5NB           Defect HD user
     C                     MOVEL*BLANK    #DCRSS           Class Df 7 Usr
     C                     MOVEL*BLANK    #DG1CD           Defect User  8
     C                     Z-ADD*ZERO     #DFONB           Defect HD user
     C                     MOVEL*BLANK    #DCSSS           Class Df 8 Usr
     C                     MOVEL*BLANK    #DG2CD           Defect User  9
     C                     Z-ADD*ZERO     #DFXNB           Defect HD user
     C                     MOVEL*BLANK    #DCTSS           Class Df 9 Usr
     C                     MOVEL*BLANK    #DG3CD           Defect User 10
     C                     Z-ADD*ZERO     #DFTNB           Defect HD user
     C                     MOVEL*BLANK    #DCUSS           Class Df 10 Usr
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @A1CPC4 fields to screen
      *================================================================
     C                     Z-ADDA1HMNB    #1HMNB           BOH Company Num
     C                     MOVELA1BDCD    #1BDCD           DF Defect Code
     C                     Z-ADDA1B9PR    #1B9PR           TH Live Gross A
     C                     Z-ADDA1CAPR    #1CAPR           TH LIve Net Amt
     C                     MOVELA1C4ST    #1C4ST           TH Resale UOM
     C                     Z-ADDA1AIPR    #1AIPR           TH Recalc Live
     C                     Z-ADDA1A6DT    #1A6DT           TH Pricing Date
     C                     MOVELA1C2ST    #1C2ST           TH Resale Sprea
     C                     Z-ADDA1CWNB    #1CWNB           TH Head Receive
     C                     Z-ADDA1FCNB    #1FCNB           TH Yard Deads
     C                     Z-ADDA1H9NB    #1H9NB           TH Held Over
     C                     Z-ADDA1FDNB    #1FDNB           TH Head Condemn
     C                     Z-ADDA1FENB    #1FENB           TH Head Killed
     C                     Z-ADDA1LRNB    #1LRNB           TH Adj Live Wgt
     C                     Z-ADDA1HENB    #1HENB           TH Head Adds
     C                     Z-ADDA1HFNB    #1HFNB           TH Head Accepte
     C                     Z-ADDA1CYNB    #1CYNB           TH Live Wgt
     C                     Z-ADDA1E0NB    #1E0NB           TH Hot Wgt
     C                     Z-ADDA1A5PC    #1A5PC           TH Tot Loin Eye
     C                     Z-ADDA1FBNB    #1FBNB           TH Tot Backfat
     C                     Z-ADDA1A4PC    #1A4PC           TH Tot Light Re
     C                     Z-ADDA1F7NB    #1F7NB           TH Avg Live Wgt
     C                     Z-ADDA1HDNB    #1HDNB           TH Avg Hot Wgt
     C                     Z-ADDA1F5NB    #1F5NB           TH Avg Light Re
     C                     Z-ADDA1F4NB    #1F4NB           TH Avg Lean Per
     C                     Z-ADDA1F3NB    #1F3NB           TH Avg Loin Eye
     C                     Z-ADDA1F2NB    #1F2NB           TH Avg Backfat
     C                     Z-ADDA1AVPC    #1AVPC           TH Std Yield Pe
     C                     Z-ADDA1AWPC    #1AWPC           TH Actual Yield
     C                     Z-ADDA1CWPC    #1CWPC           TH Adj Actual Y
     C                     Z-ADDA1A8PC    #1A8PC           TH Yield Differ
     C                     Z-ADDA1A7PC    #1A7PC           TH Recalc Live
     C                     Z-ADDA1B8PR    #1B8PR           TH CM Market Pr
     C                     Z-ADDA1AMPR    #1AMPR           TH CM Base Mkt
     C                     Z-ADDA1ANPR    #1ANPR           TH CM Base Mkt
     C                     Z-ADDA1AYVA    #1AYVA           TH CM Sort Disc
     C                     Z-ADDA1AWVA    #1AWVA           TH CM Yield Gai
     C                     Z-ADDA1AOPR    #1AOPR           TH CM Base Carc
     C                     Z-ADDA1AXVA    #1AXVA           TH CM LN AddOn/
     C                     Z-ADDA1APPR    #1APPR           TH CM Carcass G
     C                     Z-ADDA1ASPR    #1ASPR           TH Deduction Am
     C                     Z-ADDA1A4VA    #1A4VA           TH Total Net WO
     C                     Z-ADDA1A5VA    #1A5VA           TH Additions Am
     C                     Z-ADDA1CBPR    #1CBPR           TH Payment Gros
     C                     Z-ADDA1CCPR    #1CCPR           Th Payment Net
     C                     Z-ADDA1LPNB    #1LPNB           TH AP Voucher/D
     C                     Z-ADDA1CDPR    #1CDPR           TH Freight Amou
     C                     Z-ADDA1ATPR    #1ATPR           TH Carcass Net
     C                     Z-ADDA1A7VA    #1A7VA           TH Accrual Amou
     C                     Z-ADDA1A2PR    #1A2PR           TH Fixed Cost A
     C                     MOVELA1JWST    #1JWST           TH Calc Net Sts
     C                     MOVELA1CWST    #1CWST           TH Payment Sts
     C                     MOVELA1D7ST    #1D7ST           TH Header Error
     C                     MOVELA1D8ST    #1D8ST           TH Detail Error
     C                     MOVELA1DWST    #1DWST           TH Kill Balanci
     C                     MOVELA1D6ST    #1D6ST           TH Bal to Kill
     C                     Z-ADDA1GHNB    #1GHNB           TH Commission A
     C                     Z-ADDA1BYDT    #1BYDT           TH Voucher Paym
     C                     MOVELA1E0ST    #1E0ST           TH User Error O
     C                     MOVELA1E1ST    #1E1ST           TH Held Over Re
     C                     Z-ADDA1BSDT    #1BSDT           TH Held/Ovr Com
     C                     Z-ADDA1BTDT    #1BTDT           TH Commission P
     C                     Z-ADDA1BUDT    #1BUDT           TH Actual Check
     C                     Z-ADDA1HHNB    #1HHNB           TH Avg Hot Wgt
     C                     Z-ADDA1HINB    #1HINB           TH FFLI
     C                     Z-ADDA1A3PR    #1A3PR           TH Kill Product
     C                     Z-ADDA1A4PR    #1A4PR           TH Cut Product
     C                     Z-ADDA1A6PR    #1A6PR           TH Render Produ
     C                     Z-ADDA1J9NB    #1J9NB           TH Head Exclude
     C                     Z-ADDA1D6PR    #1D6PR           TH CM Bse Mkt L
     C                     Z-ADDA1D7PR    #1D7PR           TH CM Bse Mkt C
     C                     Z-ADDA1D8PR    #1D8PR           TH CM Srt Dsc L
     C                     Z-ADDA1D9PR    #1D9PR           TH CM Srt Dsc C
     C                     Z-ADDA1EAPR    #1EAPR           TH CM Yld G/L L
     C                     Z-ADDA1EBPR    #1EBPR           TH CM Yld G/L C
     C                     Z-ADDA1ECPR    #1ECPR           TH CM Crc Val L
     C                     Z-ADDA1EDPR    #1EDPR           TH CM Crc Val C
     C                     Z-ADDA1EEPR    #1EEPR           TH CM Lean Prem
     C                     Z-ADDA1EFPR    #1EFPR           TH CM Lean Prem
     C                     Z-ADDA1EGPR    #1EGPR           TH CM Gross Liv
     C                     Z-ADDA1EHPR    #1EHPR           TH CM Gross Car
     C                     MOVELA1KAST    #1KAST           TH Source Type
     C                     MOVELA1J7ST    #1J7ST           TH Scale Ticket
     C                     MOVELA1J8ST    #1J8ST           TH Posted to HP
     C                     MOVELA1LJST    #1LJST           TH Shift Held O
     C                     MOVELA1HJCD    #1HJCD           TH Unused Code
     C                     MOVELA1R4ST    #1R4ST           TH Unused Sts 2
     C                     MOVELA1R5ST    #1R5ST           TH Commission S
     C                     MOVELA1R6ST    #1R6ST           TH Paid 2 Week
     C                     MOVELA1R7ST    #1R7ST           TH Unused Sts 1
     C                     Z-ADDA1THWT    #1THWT           TH DOA Weight
     C                     Z-ADDA1T2WT    #1T2WT           TH Avg Lean % E
     C                     Z-ADDA1THHD    #1THHD           TH HPS Farm Sit
     C                     Z-ADDA1T2HD    #1T2HD           TH Shift Held O
     C                     Z-ADDA1OBPR    #1OBPR           TH Sorting Amou
     C                     Z-ADDA1KOER    #1KOER           TH Head Identif
     C                     Z-ADDA1OPIR    #1OPIR           TH Percent Iden
     C                     Z-ADDA1OPEM    #1OPEM           TH Percent Acce
     C                     Z-ADDA1IORP    #1IORP           TH Head Adjuste
     C                     Z-ADDA1OWEO    #1OWEO           TH PHA Head Add
     C                     MOVELA1OQET    #1OQET           TH PHA Add Type
     C                     MOVELA1URST    #1URST           TH PHA Average
     C                     MOVELA1USST    #1USST           TH PHA Add Reas
     C                     Z-ADDA1HHPC    #1HHPC           TH PHA Yield Pe
     C                     Z-ADDA1S9PR    #1S9PR           TH PHA Lean Prm
     C                     Z-ADDA1TAPR    #1TAPR           TH VC Gross Val
     C                     Z-ADDA1TBPR    #1TBPR           TH Excluded Gro
     C                     Z-ADDA1JFUR    #1JFUR           TH Avg Lean %
     C                     Z-ADDA1KRIF    #1KRIF           TH Broken Back
     C                     Z-ADDA1KORF    #1KORF           TH Hot Scl Uplo
     C                     Z-ADDA1KAPR    #1KAPR           TH Unused Nbr 4
     C                     Z-ADDA1KROT    #1KROT           TH Excluded Car
     C                     Z-ADDA1OTJG    #1OTJG           TH Excluded Pre
     C                     Z-ADDA1IRJG    #1IRJG           TH Unused Nbr 7
     C                     Z-ADDA1IMJF    #1IMJF           TH Unused Nbr 8
     C                     Z-ADDA1IRGF    #1IRGF           TH Unused Nbr 9
     C                     Z-ADDA1KRJF    #1KRJF           TH Unused Nbr 1
     C                     Z-ADDA1OJRF    #1OJRF           TH Break Even P
     C                     Z-ADDA1KFOR    #1KFOR           TH Meat Value F
     C                     Z-ADDA1ORJK    #1ORJK           TH Yld Parm Adj
     C                     Z-ADDA1OMVJ    #1OMVJ           TH PHA Sort Dis
     C                     Z-ADDA1MVNF    #1MVNF           TH Avg Loin Eye
     C                     Z-ADDA1MCNF    #1MCNF           TH Avg Backfat
     C                     Z-ADDA1NCNF    #1NCNF           TH HITCH Old Pa
     C                     Z-ADDA1NCHF    #1NCHF           TH MPR Sort Los
     C                     Z-ADDA1IGIR    #1IGIR           TH Unused Nbr 1
     C                     Z-ADDA1KFJR    #1KFJR           TH Unused Nbr 2
     C                     Z-ADDA1EADT    #1EADT           TH Cold Scl Upl
     C                     Z-ADDA1EBDT    #1EBDT           TH Cold Scl Upl
     C                     Z-ADDA1EEDT    #1EEDT           TH Unused Date
     C                     MOVELA1U4ST    #1U4ST           TH Unused Sts 1
     C                     MOVELA1U5ST    #1U5ST           TH Unused Sts 2
     C                     MOVELA1U6ST    #1U6ST           TH Unused Sts 3
     C                     MOVELA1U7ST    #1U7ST           TH Unused Sts 4
     C                     MOVELA1U8ST    #1U8ST           TH Unused Sts 5
     C                     MOVELA1U9ST    #1U9ST           TH Unused Sts 6
     C                     MOVELA1VAST    #1VAST           TH Unused Sts 7
     C                     MOVELA1VBST    #1VBST           TH Unused Sts 8
     C                     MOVELA1J9ST    #1J9ST           TH Payment Type
     C                     MOVELA1LKST    #1LKST           TH Source Code
     C                     MOVELA1CSCD    #1CSCD           THP Process Cod
     C                     MOVELA1ACCD    #1ACCD           HB Buyer Code
     C                     MOVELA1AAVN    #1AAVN           RS User Changed
     C                     Z-ADDA1AADT    #1AADT           RS Date Changed
     C                     Z-ADDA1AMTM    #1AMTM           RS Time Changed
     C                     MOVELA1AJST    #1AJST           RS Record Statu
     C                     MOVELA1AHVN    #1AHVN           RS Job
     C                     MOVELA1AGVN    #1AGVN           RS Program
     C                     MOVELA1ABVN    #1ABVN           RS User Added
     C                     Z-ADDA1ABDT    #1ABDT           RS Date Added
     C                     Z-ADDA1ABTM    #1ABTM           RS Time Added
     C                     MOVELA1ABCD    #1ABCD           PD Producer Cod
     C                     MOVELA1AECD    #1AECD           PL Location Cod
     C                     Z-ADDA1BNNB    #1BNNB           BOH Buy Order N
     C                     Z-ADDA1BONB    #1BONB           BOL Load Number
     C                     Z-ADDA1CVNB    #1CVNB           TH Tattoo Numbe
     C                     Z-ADDA1B0DT    #1B0DT           TH Kill Date
     C                     Z-ADDA1AWDT    #1AWDT           TH Purchase Dat
     C                     MOVELA1LLST    #1LLST           TH Hog Class Ty
     C                     MOVELA1BECD    #1BECD           HC Class Code
     C                     Z-ADDA1OXNB    #1OXNB           TH HPS Movement
     C                     MOVELA1BICD    #1BICD           TH Group Refere
     C                     MOVELA1E2ST    #1E2ST           TH Sex
     C                     MOVELA1AGCD    #1AGCD           GN Genetic Code
     C                     MOVELA1LIST    #1LIST           TH Schedule Kil
     C                     MOVELA1NZTX    #1NZTX           TH State
     C                     Z-ADDA1CXNB    #1CXNB           TH Dead On Arri
     C                     Z-ADDA1ECDT    #1ECDT           TH Head LFT
     C                     Z-ADDA1EDDT    #1EDDT           TH Head EUT/KOA
     C                     Z-ADDA1ACPR    #1ACPR           TH Live Purchas
     C                     MOVELA1CPST    #1CPST           TH Live Purchas
     C                     Z-ADDA1HGNB    #1HGNB           TH Shipped Weig
      * Hold existing record image
     C                     MOVEL@1DBRC    #1DBRC
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MDIZ#K    BEGSR
      *================================================================
      * Initialize key screen
      *================================================================
     C                     MOVELP2IHST    #PIHST           Record Added Us
     C                     Z-ADDP1HMNB    #1HMNB           BOH Company Num
     C                     Z-ADDP1BNNB    #1BNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    #1BONB           BOL Load Number
     C                     Z-ADDP1B0DT    #1B0DT           TH Kill Date
      * Clear external version also
     C                     Z-ADD*ZERO     V1B0DT
     C                     Z-ADDP1CVNB    #1CVNB           TH Tattoo Numbe
      * Check restriction within
     C                     EXSR VGCKRL
      *================================================================
     CSR         MDEXIT    ENDSR
      /EJECT
     CSR         MNCV#K    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert TH Kill Date to display format
      * Convert date
     C           1000000   ADD  #1B0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1B0DT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#D    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert TH Kill Date to display format
      * Convert date
     C           1000000   ADD  #1B0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1B0DT
      * Convert TH Purchase Date to display format
      * Convert date
     C           1000000   ADD  #1AWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1AWDT
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         NARVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNA     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DGXCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSNA     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO NAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         NAEXIT    ENDSR
      /EJECT
     CSR         NBRVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNB     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DGYCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSNB     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO NBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         NBEXIT    ENDSR
      /EJECT
     CSR         NCRVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNC     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DGZCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSNC     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO NCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         NCEXIT    ENDSR
      /EJECT
     CSR         NDRVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSND     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DG0CD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSND     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO NDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         NDEXIT    ENDSR
      /EJECT
     CSR         NERVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNE     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DG1CD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSNE     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO NEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         NEEXIT    ENDSR
      /EJECT
     CSR         NFRVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNF     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DG2CD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSNF     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO NFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         NFEXIT    ENDSR
      /EJECT
     CSR         NGRVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNG     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DG3CD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSNG     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO NGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         NGEXIT    ENDSR
      /EJECT
     CSR         NHRVGN    BEGSR
      *================================================================
      * Rtv Val Pen,Type      RT - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN A3HVNB    WQNH01           Pen Company Num
     C           *LIKE     DEFN A3CMCD    WQNH02           Pen Number
      * Define keylist
     C           KRSNH     KLIST
     C                     KFLD           WQNH01           Pen Company Num
     C                     KFLD           WQNH02           Pen Number
      * Setup key
     C                     Z-ADD#1HMNB    WQNH01           Pen Company Num
     C                     MOVEL#DCMCD    WQNH02           Pen Number
      * Establish starting position
     C           KRSNH     SETLL@A3REKF                    *
     C           KRSNH     READE@A3REKF                  90*
      * Data record not found
     C   90                MOVEL'PRK0065' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA3FWST    WUFWST           Pen Type
     C           KRSNH     READE@A3REKF                  90*
     C                     ENDDO
      *================================================================
     CSR         NHEXIT    ENDSR
      /EJECT
     CSR         NIRVGN    BEGSR
      *================================================================
      * Rtv BOH Pay Type      RT - Buy Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNI     KLIST
     C                     KFLD           AWHMNB           BOH Company Num
     C                     KFLD           AWBNNB           BOH Buy Order N
      * Setup key
     C                     Z-ADD#1HMNB    AWHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    AWBNNB           BOH Buy Order N
      * Establish starting position
     C           KRSNI     CHAIN@AWCPBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0049' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'L'       WUA4ST           BOH Payment Typ
     C                     MOVEL'O'       WUA5ST           BOH Buy Order T
     C                     GOTO NIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAWA4ST    WUA4ST           BOH Payment Typ
     C                     MOVELAWA5ST    WUA5ST           BOH Buy Order T
     C                     ENDIF
      *================================================================
     CSR         NIEXIT    ENDSR
      /EJECT
     CSR         NJRVGN    BEGSR
      *================================================================
      * Rtv Std Time,buyer    RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNJ     KLIST
     C                     KFLD           ACABCD           PD Producer Cod
      * Setup key
     C                     MOVELP1ABCD    ACABCD           PD Producer Cod
      * Establish starting position
     C           KRSNJ     CHAIN@ACREAI              90    *
      * Data record not found
     C   90                MOVEL'PRK0009' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDACAATH    WUAATH           PD Std Delv Tim
     C                     Z-ADDACAMNB    WUAMNB           PD Std Truck Si
     C                     MOVELACIWST    WUIWST           PD Freight Exp
     C                     MOVELACAACD    WUAACD           SR Source Code
     C                     MOVELACACCD    #1ACCD           HB Buyer Code
     C                     ENDIF
      *================================================================
     CSR         NJEXIT    ENDSR
      /EJECT
     CSR         NKRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNK     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#1BDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSNK     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVELWUCRTX    #DBCTX           DF Description
     C                     GOTO NKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7BCTX    #DBCTX           DF Description
     C                     ENDIF
      *================================================================
     CSR         NKEXIT    ENDSR
      /EJECT
     CSR         NLRVGN    BEGSR
      *================================================================
      * Rtv and UnAssigned    RT - Tattoo Pending  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FJHONB    WQNL01           CC Company Numb
     C           *LIKE     DEFN FJHSA1    WQNL02           TP Tattoo Numbe
     C           *LIKE     DEFN FJHMNB    WQNL03           BOH Company Num
     C           *LIKE     DEFN FJBNNB    WQNL04           BOH Buy Order N
     C           *LIKE     DEFN FJBONB    WQNL05           BOL Load Number
      * Define keylist
     C           KRSNL     KLIST
     C                     KFLD           WQNL01           CC Company Numb
     C                     KFLD           WQNL02           TP Tattoo Numbe
     C                     KFLD           WQNL03           BOH Company Num
     C                     KFLD           WQNL04           BOH Buy Order N
     C                     KFLD           WQNL05           BOL Load Number
      * Setup key
     C                     Z-ADDP1HMNB    WQNL01           CC Company Numb
     C                     Z-ADDP1CVNB    WQNL02           TP Tattoo Numbe
     C                     Z-ADDP1HMNB    WQNL03           BOH Company Num
     C                     Z-ADDP1BNNB    WQNL04           BOH Buy Order N
     C                     Z-ADDP1BONB    WQNL05           BOL Load Number
      * Establish starting position
     C           KRSNL     SETLL@FJCPKH                    *
     C           KRSNL     READE@FJCPKH                  90*
      * Data record not found
     C   90                MOVEL'PRK1012' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Tattoo UnAssigned CH - Tattoo Pending  * 
     C                     EXSR NMCHRC
     C           KRSNL     READE@FJCPKH                  90*
     C                     ENDDO
      *================================================================
     CSR         NLEXIT    ENDSR
      /EJECT
     CSR         NMCHRC    BEGSR
      *================================================================
      * Chg Tattoo UnAssigned CH - Tattoo Pending  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  50       Employee ID
     C                     Z-ADD*ZERO     WN0002  60       TP Tattoo Creat
     C                     MOVEL*BLANK    WN0003  1        TP Alley Number
     C                     Z-ADD*ZERO     WN0004  50       Employee Number
     C                     MOVEL*BLANK    WN0005 10        RS User Changed
     C                     Z-ADD*ZERO     WN0006  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0007  60       RS Time Changed
     C                     MOVEL*BLANK    WN0008  1        RS Record Statu
     C                     MOVEL*BLANK    WN0009 10        RS Job
     C                     MOVEL*BLANK    WN0010 10        RS Program
     C                     MOVEL*BLANK    WN0011 10        RS User Added
     C                     Z-ADD*ZERO     WN0012  70       RS Date Added
     C                     Z-ADD*ZERO     WN0013  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @FJCPHV
     C                     Z-ADDFJHONB    WFHONB           CC Company Numb
     C                     Z-ADDFJEZDT    WFEZDT           TP Tattoo Date
     C                     Z-ADDFJHSA1    WFHSA1           TP Tattoo Numbe
      *
     C           KLCHNM    KLIST
     C                     KFLD           WFHONB           CC Company Numb
     C                     KFLD           WFEZDT           TP Tattoo Date
     C                     KFLD           WFHSA1           TP Tattoo Numbe
     C           KLCHNM    CHAIN@FJCPHV              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFJCPL0'MDACP
     C                     MOVEL'@FJCPHV' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NMEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NMEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFJ1    YARDCS
      * Move non-key fields to @FJCPHV
     C                     Z-ADD*ZERO     WFHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WFBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WFBONB           BOL Load Number
     C                     MOVEL'P'       WFWQST    P      TP Tattoo Statu
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFJ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp-SysDtIF
     C                     MOVEL##USR     WFAAVN           RS User Changed
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WFAADT    PARM *ZERO     WQ0053  70       *DATE
     C           WFAMTM    PARM *ZERO     WQ0054  60       *TIME
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##JOB     WFAHVN           RS Job
     C                     MOVEL##PGM     WFAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKFJ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@FJCPHV                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFJCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NMEXIT    ENDSR
      /EJECT
     CSR         NNRVGN    BEGSR
      *================================================================
      * Rtv Val Ttt,Kll Dt    RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGHMNB    WQNN01           BOH Company Num
     C           *LIKE     DEFN WGB0DT    WQNN02           TH Kill Date
     C           *LIKE     DEFN WGCVNB    WQNN03           TH Tattoo Numbe
      * Define keylist
     C           KRSNN     KLIST
     C                     KFLD           WQNN01           BOH Company Num
     C                     KFLD           WQNN02           TH Kill Date
     C                     KFLD           WQNN03           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDP1HMNB    WQNN01           BOH Company Num
     C                     Z-ADDP1B0DT    WQNN02           TH Kill Date
     C                     Z-ADD#1CVNB    WQNN03           TH Tattoo Numbe
      * Establish starting position
     C           KRSNN     SETLL@A1CPL0                    *
     C           KRSNN     READE@A1CPL0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,002   W0RTN            *Return code
     C                     GOTO NNEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         NNEXIT    ENDSR
      /EJECT
     CSR         NORVGN    BEGSR
      *================================================================
      * Rtv Val Ttt,Kll Dt    RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGHMNB    WQNO01           BOH Company Num
     C           *LIKE     DEFN WGB0DT    WQNO02           TH Kill Date
     C           *LIKE     DEFN WGCVNB    WQNO03           TH Tattoo Numbe
      * Define keylist
     C           KRSNO     KLIST
     C                     KFLD           WQNO01           BOH Company Num
     C                     KFLD           WQNO02           TH Kill Date
     C                     KFLD           WQNO03           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDP1HMNB    WQNO01           BOH Company Num
     C                     Z-ADDYL0013    WQNO02           TH Kill Date
     C                     Z-ADD#1CVNB    WQNO03           TH Tattoo Numbe
      * Establish starting position
     C           KRSNO     SETLL@A1CPL0                    *
     C           KRSNO     READE@A1CPL0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,002   W0RTN            *Return code
     C                     GOTO NOEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         NOEXIT    ENDSR
      /EJECT
     CSR         NPRVGN    BEGSR
      *================================================================
      * Rtv Val Ttt,Kll Dt    RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGHMNB    WQNP01           BOH Company Num
     C           *LIKE     DEFN WGB0DT    WQNP02           TH Kill Date
     C           *LIKE     DEFN WGCVNB    WQNP03           TH Tattoo Numbe
      * Define keylist
     C           KRSNP     KLIST
     C                     KFLD           WQNP01           BOH Company Num
     C                     KFLD           WQNP02           TH Kill Date
     C                     KFLD           WQNP03           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDP1HMNB    WQNP01           BOH Company Num
     C                     Z-ADDYL0014    WQNP02           TH Kill Date
     C                     Z-ADD#1CVNB    WQNP03           TH Tattoo Numbe
      * Establish starting position
     C           KRSNP     SETLL@A1CPL0                    *
     C           KRSNP     READE@A1CPL0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,002   W0RTN            *Return code
     C                     GOTO NPEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         NPEXIT    ENDSR
      /EJECT
     CSR         NQRVGN    BEGSR
      *================================================================
      * Rtv Dtl hd/Chg Pen    RT - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Set Pen Totals to Zeros - Pen  * 
     C                     EXSR NRRVGN
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHHMNB    WQNQ01           BOH Company Num
     C           *LIKE     DEFN WHCMCD    WQNQ02           Pen Number
      * Define keylist
     C           KRSNQ     KLIST
     C                     KFLD           WQNQ01           BOH Company Num
     C                     KFLD           WQNQ02           Pen Number
      * Setup key
     C                     Z-ADDP1HMNB    WQNQ01           BOH Company Num
     C                     MOVEL#DCMCD    WQNQ02           Pen Number
      * Establish starting position
     C           KRSNQ     SETLL@A2CPKE                    *
     C           KRSNQ     READE@A2CPKE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0063' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL*BLANK    WUAGCD           GN Genetic Code
      * Chg Pen Genetics      CH - Pen  * 
     C                     EXSR NTCHRC
     C                     GOTO NQEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv/Chg Pen Totals    RT - Pen  * 
     C                     EXSR NURVGN
     C           KRSNQ     READE@A2CPKE                  90*
     C                     ENDDO
      * USER: Exit processing
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL*BLANK    WUAGCD           GN Genetic Code
      * Rtv Pen GENETICS      RT - Tattoo Detail  * 
     C                     EXSR NWRVGN
      * Chg Pen Genetics      CH - Pen  * 
     C                     EXSR NZCHRC
      *================================================================
     CSR         NQEXIT    ENDSR
      /EJECT
     CSR         NRRVGN    BEGSR
      *================================================================
      * Set Pen Totals to Zeros - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNR     KLIST
     C                     KFLD           WIHVNB           Pen Company Num
     C                     KFLD           WICMCD           Pen Number
      * Setup key
     C                     Z-ADDP1HMNB    WIHVNB           Pen Company Num
     C                     MOVEL#DCMCD    WICMCD           Pen Number
      * Establish starting position
     C           KRSNR     CHAIN@A3REDD              90    *
      * Data record not found
     C   90                MOVEL'PRK0065' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Pen               CH - Pen  * 
     C                     EXSR NSCHRC
     C                     ENDIF
      *================================================================
     CSR         NREXIT    ENDSR
      /EJECT
     CSR         NSCHRC    BEGSR
      *================================================================
      * Chg Pen               CH - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @A3REDC
     C                     Z-ADDWIHVNB    WJHVNB           Pen Company Num
     C                     MOVELWICMCD    WJCMCD    P      Pen Number
      *
     C           KLCHNS    KLIST
     C                     KFLD           WJHVNB           Pen Company Num
     C                     KFLD           WJCMCD           Pen Number
     C           KLCHNS    CHAIN@A3REDC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA3REL0'MDACP
     C                     MOVEL'@A3REDC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NSEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NSEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA31    YBRDCS
      * Move non-key fields to @A3REDC
     C                     MOVELWUCRTX    WJBBTX    P      Pen Description
     C                     Z-ADDWICTNB    WJCTNB           Pen Maximun Cap
     C                     Z-ADD*ZERO     WJD6NB           Pen Current Hea
     C                     Z-ADDWIB6CD    WJB6CD           Pen Current Dri
     C                     MOVELWIDGST    WJDGST    P      Pen Sts
     C                     Z-ADDWIEBNB    WJEBNB           Pen Drive Seque
     C                     MOVELWIFWST    WJFWST    P      Pen Type
     C                     Z-ADDWIHBNB    WJHBNB           Pen Adjustment
     C                     MOVELWUCRTX    WJAGCD    P      GN Genetic Code
     C                     MOVELWIAAVN    WJAAVN    P      RS User Changed
     C                     Z-ADDWIAADT    WJAADT           RS Date Changed
     C                     Z-ADDWIAMTM    WJAMTM           RS Time Changed
     C                     MOVELWIAJST    WJAJST    P      RS Record Statu
     C                     MOVELWIAHVN    WJAHVN    P      RS Job
     C                     MOVELWIAGVN    WJAGVN    P      RS Program
     C                     MOVELWIABVN    WJABVN    P      RS User Added
     C                     Z-ADDWIABDT    WJABDT           RS Date Added
     C                     Z-ADDWIABTM    WJABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WJAAVN           RS User Changed
     C                     Z-ADD##JDT     WJAADT           RS Date Changed
     C                     Z-ADD##JTM     WJAMTM           RS Time Changed
     C                     MOVEL##JOB     WJAHVN           RS Job
     C                     MOVEL##PGM     WJAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@A3REDC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA3REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NSEXIT    ENDSR
      /EJECT
     CSR         NTCHRC    BEGSR
      *================================================================
      * Chg Pen Genetics      CH - Pen  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0014  50       Pen Maximun Cap
     C                     Z-ADD*ZERO     WN0015  50       Pen Current Hea
     C                     Z-ADD*ZERO     WN0016  30       Pen Current Dri
     C                     MOVEL*BLANK    WN0017  1        Pen Sts
     C                     Z-ADD*ZERO     WN0018  30       Pen Drive Seque
     C                     MOVEL*BLANK    WN0019  1        Pen Type
     C                     Z-ADD*ZERO     WN0020  50       Pen Adjustment
     C                     MOVEL*BLANK    WN0021 10        RS User Changed
     C                     Z-ADD*ZERO     WN0022  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0023  60       RS Time Changed
     C                     MOVEL*BLANK    WN0024  1        RS Record Statu
     C                     MOVEL*BLANK    WN0025 10        RS Job
     C                     MOVEL*BLANK    WN0026 10        RS Program
     C                     MOVEL*BLANK    WN0027 10        RS User Added
     C                     Z-ADD*ZERO     WN0028  70       RS Date Added
     C                     Z-ADD*ZERO     WN0029  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @A3REDC
     C                     Z-ADDP1HMNB    WJHVNB           Pen Company Num
     C                     MOVEL#DCMCD    WJCMCD    P      Pen Number
      *
     C           KLCHNT    KLIST
     C                     KFLD           WJHVNB           Pen Company Num
     C                     KFLD           WJCMCD           Pen Number
     C           KLCHNT    CHAIN@A3REDC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA3REL0'MDACP
     C                     MOVEL'@A3REDC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NTEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NTEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA31    YCRDCS
      * Move non-key fields to @A3REDC
     C                     MOVELWUBBTX    WJBBTX    P      Pen Description
     C                     MOVELWUAGCD    WJAGCD    P      GN Genetic Code
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WJAAVN           RS User Changed
     C                     Z-ADD##JDT     WJAADT           RS Date Changed
     C                     Z-ADD##JTM     WJAMTM           RS Time Changed
     C                     MOVEL##JOB     WJAHVN           RS Job
     C                     MOVEL##PGM     WJAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@A3REDC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA3REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NTEXIT    ENDSR
      /EJECT
     CSR         NURVGN    BEGSR
      *================================================================
      * Rtv/Chg Pen Totals    RT - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNU     KLIST
     C                     KFLD           WIHVNB           Pen Company Num
     C                     KFLD           WICMCD           Pen Number
      * Setup key
     C                     Z-ADDWHHMNB    WIHVNB           Pen Company Num
     C                     MOVELWHCMCD    WICMCD           Pen Number
      * Establish starting position
     C           KRSNU     CHAIN@A3REDD              90    *
      * Data record not found
     C   90                MOVEL'PRK0065' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WHC0NB    ADD  WID6NB    WUD6NB           Pen Current Hea
     C                     SUB  WHD8NB    WUD6NB           Pen Current Hea
      * Chg Pen               CH - Pen  * 
     C                     EXSR NVCHRC
     C                     ENDIF
      *================================================================
     CSR         NUEXIT    ENDSR
      /EJECT
     CSR         NVCHRC    BEGSR
      *================================================================
      * Chg Pen               CH - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @A3REDC
     C                     Z-ADDWIHVNB    WJHVNB           Pen Company Num
     C                     MOVELWICMCD    WJCMCD    P      Pen Number
      *
     C           KLCHNV    KLIST
     C                     KFLD           WJHVNB           Pen Company Num
     C                     KFLD           WJCMCD           Pen Number
     C           KLCHNV    CHAIN@A3REDC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA3REL0'MDACP
     C                     MOVEL'@A3REDC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NVEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NVEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA31    YDRDCS
      * Move non-key fields to @A3REDC
     C                     MOVELWIBBTX    WJBBTX    P      Pen Description
     C                     Z-ADDWICTNB    WJCTNB           Pen Maximun Cap
     C                     Z-ADDWUD6NB    WJD6NB           Pen Current Hea
     C                     Z-ADDWIB6CD    WJB6CD           Pen Current Dri
     C                     MOVELWIDGST    WJDGST    P      Pen Sts
     C                     Z-ADDWIEBNB    WJEBNB           Pen Drive Seque
     C                     MOVELWIFWST    WJFWST    P      Pen Type
     C                     Z-ADDWIHBNB    WJHBNB           Pen Adjustment
     C                     MOVELWIAGCD    WJAGCD    P      GN Genetic Code
     C                     MOVELWIAAVN    WJAAVN    P      RS User Changed
     C                     Z-ADDWIAADT    WJAADT           RS Date Changed
     C                     Z-ADDWIAMTM    WJAMTM           RS Time Changed
     C                     MOVELWIAJST    WJAJST    P      RS Record Statu
     C                     MOVELWIAHVN    WJAHVN    P      RS Job
     C                     MOVELWIAGVN    WJAGVN    P      RS Program
     C                     MOVELWIABVN    WJABVN    P      RS User Added
     C                     Z-ADDWIABDT    WJABDT           RS Date Added
     C                     Z-ADDWIABTM    WJABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WJAAVN           RS User Changed
     C                     Z-ADD##JDT     WJAADT           RS Date Changed
     C                     Z-ADD##JTM     WJAMTM           RS Time Changed
     C                     MOVEL##JOB     WJAHVN           RS Job
     C                     MOVEL##PGM     WJAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@A3REDC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA3REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NVEXIT    ENDSR
      /EJECT
     CSR         NWRVGN    BEGSR
      *================================================================
      * Rtv Pen GENETICS      RT - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHHMNB    WQNW01           BOH Company Num
     C           *LIKE     DEFN WHCMCD    WQNW02           Pen Number
      * Define keylist
     C           KRSNW     KLIST
     C                     KFLD           WQNW01           BOH Company Num
     C                     KFLD           WQNW02           Pen Number
      * Setup key
     C                     Z-ADDWHHMNB    WQNW01           BOH Company Num
     C                     MOVELWHCMCD    WQNW02           Pen Number
      * Establish starting position
     C           KRSNW     SETLL@A2CPKE                    *
     C           KRSNW     READE@A2CPKE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0063' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL*BLANK    WUAGCD           GN Genetic Code
     C                     GOTO NWEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.TDP Process Code is Drive Card Printed
      *   |- c2    : DB1.TDP Process Code is Open
      *   '-
     C           WHB9CD    IFEQ 'D'                        *IF
     C           WHB9CD    OREQ 'O'                        *OR
      * Rtv Tattoo GENETICS - Tattoo Header  * 
     C                     EXSR NXRVGN
      * CASE: PAR.GN Genetic Code is BLANKS
     C           WUAGCD    IFEQ *BLANK                     *IF
     C                     MOVELWUA1CD    WUAGCD           GN Genetic Code
     C                     MOVELWUJTTX    WUBBTX           Pen Description
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.Genetic Code USR NE PAR.GN Genetic Code
     C           WUA1CD    IFNE WUAGCD                     *IF
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL'MIXED'   WUBBTX           Pen Description
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSNW     READE@A2CPKE                  90*
     C                     ENDDO
      *================================================================
     CSR         NWEXIT    ENDSR
      /EJECT
     CSR         NXRVGN    BEGSR
      *================================================================
      * Rtv Tattoo GENETICS - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN A1HMNB    WQNX01           BOH Company Num
     C           *LIKE     DEFN A1BNNB    WQNX02           BOH Buy Order N
     C           *LIKE     DEFN A1BONB    WQNX03           BOL Load Number
     C           *LIKE     DEFN A1CVNB    WQNX04           TH Tattoo Numbe
      * Define keylist
     C           KRSNX     KLIST
     C                     KFLD           WQNX01           BOH Company Num
     C                     KFLD           WQNX02           BOH Buy Order N
     C                     KFLD           WQNX03           BOL Load Number
     C                     KFLD           WQNX04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWHHMNB    WQNX01           BOH Company Num
     C                     Z-ADDWHBNNB    WQNX02           BOH Buy Order N
     C                     Z-ADDWHBONB    WQNX03           BOL Load Number
     C                     Z-ADDWHCVNB    WQNX04           TH Tattoo Numbe
      * Establish starting position
     C           KRSNX     SETLL@A1CPC4                    *
     C           KRSNX     READE@A1CPC4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUA1CD           GN Genetic Code
     C                     MOVEL*BLANK    WUJTTX           Pen Description
     C                     GOTO NXEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVELA1AGCD    WUA1CD           GN Genetic Code
      * Rtv Genetic Record    RT - Genetic  * 
     C                     EXSR NYRVGN
     C           KRSNX     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         NXEXIT    ENDSR
      /EJECT
     CSR         NYRVGN    BEGSR
      *================================================================
      * Rtv Genetic Record    RT - Genetic  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNY     KLIST
     C                     KFLD           AIAGCD           GN Genetic Code
      * Setup key
     C                     MOVELA1AGCD    AIAGCD           GN Genetic Code
      * Establish starting position
     C           KRSNY     CHAIN@AIREA9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0021' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUJTTX           GN Description
     C                     GOTO NYEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAIAWTX    WUJTTX           GN Description
     C                     ENDIF
      *================================================================
     CSR         NYEXIT    ENDSR
      /EJECT
     CSR         NZCHRC    BEGSR
      *================================================================
      * Chg Pen Genetics      CH - Pen  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0030  50       Pen Maximun Cap
     C                     Z-ADD*ZERO     WN0031  50       Pen Current Hea
     C                     Z-ADD*ZERO     WN0032  30       Pen Current Dri
     C                     MOVEL*BLANK    WN0033  1        Pen Sts
     C                     Z-ADD*ZERO     WN0034  30       Pen Drive Seque
     C                     MOVEL*BLANK    WN0035  1        Pen Type
     C                     Z-ADD*ZERO     WN0036  50       Pen Adjustment
     C                     MOVEL*BLANK    WN0037 10        RS User Changed
     C                     Z-ADD*ZERO     WN0038  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0039  60       RS Time Changed
     C                     MOVEL*BLANK    WN0040  1        RS Record Statu
     C                     MOVEL*BLANK    WN0041 10        RS Job
     C                     MOVEL*BLANK    WN0042 10        RS Program
     C                     MOVEL*BLANK    WN0043 10        RS User Added
     C                     Z-ADD*ZERO     WN0044  70       RS Date Added
     C                     Z-ADD*ZERO     WN0045  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @A3REDC
     C                     Z-ADDP1HMNB    WJHVNB           Pen Company Num
     C                     MOVEL#DCMCD    WJCMCD    P      Pen Number
      *
     C           KLCHNZ    KLIST
     C                     KFLD           WJHVNB           Pen Company Num
     C                     KFLD           WJCMCD           Pen Number
     C           KLCHNZ    CHAIN@A3REDC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA3REL0'MDACP
     C                     MOVEL'@A3REDC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NZEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NZEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA31    YERDCS
      * Move non-key fields to @A3REDC
     C                     MOVELWUBBTX    WJBBTX    P      Pen Description
     C                     MOVELWUAGCD    WJAGCD    P      GN Genetic Code
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WJAAVN           RS User Changed
     C                     Z-ADD##JDT     WJAADT           RS Date Changed
     C                     Z-ADD##JTM     WJAMTM           RS Time Changed
     C                     MOVEL##JOB     WJAHVN           RS Job
     C                     MOVEL##PGM     WJAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@A3REDC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA3REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NZEXIT    ENDSR
      /EJECT
     CSR         OARVGN    BEGSR
      *================================================================
      * Rtv/Chg Bol Hd rcvd   RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOA     KLIST
     C                     KFLD           AXHMNB           BOH Company Num
     C                     KFLD           AXBNNB           BOH Buy Order N
     C                     KFLD           AXBONB           BOL Load Number
      * Setup key
     C                     Z-ADDP1HMNB    AXHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    AXBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    AXBONB           BOL Load Number
      * Establish starting position
     C           KRSOA     CHAIN@AXCPBX              90    *
      * Data record not found
     C   90                MOVEL'PRK0051' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           AXDHNB    ADD  WUCWNB    WUDHNB           BOL Head Receiv
     C                     ADD  AXDINB    WUDINB           BOL Live Wgt Re
      * Calculate freight based on the unit of measure
     C                     Z-ADDAXATVA    WUATVA           BOL Freight Amt
      * Chk tatto Paid for Bol RT - Tattoo Header  * 
     C                     EXSR OBRVGN
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.BOL Freight Allocation is Freight is Allocated
      *   |- c2    : WRK.Tattoo is paid Usr is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           AXI1ST    IFEQ 'Y'                        *IF
     C           WUNPST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: DB1.BOL Trucker Payment Sts is Paid Trucker
     C           AXCNST    IFEQ 'PT'                       *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Clc Freight Amt       XF - STR Unit of Measure Calc  * 
     C                     CALL 'PKQ5XFR'              90  Clc Freight Amt
     C                     PARM *BLANK    W0RTN   7
     C                     PARM AXHMNB    WQ0167  30       BOH Company Num
     C                     PARM AXBNNB    WQ0168  50       BOH Buy Order N
     C                     PARM AXBONB    WQ0169  50       BOL Load Number
     C                     PARM AXCMST    WQ0170  2        BOL Freight UOM
     C                     PARM AXAGPR    WQ0171  72       BOL Freight Uni
     C           WUATVA    PARM WUATVA    WQ0172  72       BOL Freight Amt
     C                     PARM AXI1ST    WQ0173  1        BOL Freight All
     C                     PARM WUDHNB    WQ0174  70       BOL Head Receiv
     C                     PARM WUDINB    WQ0175  71       BOL Live Wgt Re
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKQ5XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : WRK.BOL Freight Amt is Not Zeros
      *   |- c2    : WRK.BOL Head Received is Greater then Zero
      *   |- c3    : DB1.BOL Trucker Payment Sts is Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUATVA    IFNE *ZERO                      *IF
     C           WUDHNB    IFGT *ZERO                      *IF
     C           AXCNST    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'ST'      WUCNST           BOL Trucker Pay
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELAXCNST    WUCNST           BOL Trucker Pay
     C                     END                             *FI
      * Chg Buy Order Detail  CH - Buy Order Load  * 
     C                     EXSR OCCHRC
     C                     ENDIF
      *================================================================
     CSR         OAEXIT    ENDSR
      /EJECT
     CSR         OBRVGN    BEGSR
      *================================================================
      * Chk tatto Paid for Bol RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUK4PR           Tot Frt Spdb af
     C                     MOVEL'N'       WUNFST           Held Over Recor
     C                     MOVEL'N'       WUNPST           Tattoo is paid
      * Declare restrictor key work fields
     C           *LIKE     DEFN A1HMNB    WQOB01           BOH Company Num
     C           *LIKE     DEFN A1BNNB    WQOB02           BOH Buy Order N
     C           *LIKE     DEFN A1BONB    WQOB03           BOL Load Number
      * Define keylist
     C           KRSOB     KLIST
     C                     KFLD           WQOB01           BOH Company Num
     C                     KFLD           WQOB02           BOH Buy Order N
     C                     KFLD           WQOB03           BOL Load Number
      * Setup key
     C                     Z-ADDAXHMNB    WQOB01           BOH Company Num
     C                     Z-ADDAXBNNB    WQOB02           BOH Buy Order N
     C                     Z-ADDAXBONB    WQOB03           BOL Load Number
      * Establish starting position
     C           KRSOB     SETLL@A1CPC4                    *
     C           KRSOB     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * If one tattoo is paid but freight was spread then accumulate
      * what is paid, for held over respread problem
      * when this probelm goes away, then just flag that there is one pai
      * CASE: DB1.TH Payment Sts is Paid Anything
     C           A1CWST    IFEQ 'PL'                       *IF
     C           A1CWST    OREQ 'PC'
     C           A1CWST    OREQ 'NC'
     C           A1CWST    OREQ 'NL'
      * CHECK IF FREIGHT AMOUNT IS IN RECORD
      * CASE: DB1.TH Freight Amount is Not Zeros
     C           A1CDPR    IFNE *ZERO                      *IF
     C                     MOVEL'Y'       WUNPST           Tattoo is paid
     C                     END                             *FI
     C                     ADD  A1CDPR    WUK4PR           Tot Frt Spdb af
     C                     ELSE
      * CASE: *OTHERWISE
      * CHECK FOR HELD OVER RECORD
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.TH Held Over Record is Yes
      *   |- c2    : DB1.TH Held Over is greater than 0
      *   '-
     C           A1E1ST    IFEQ 'Y'                        *IF
     C           A1H9NB    ORGT *ZERO                      *OR
     C                     MOVEL'Y'       WUNFST           Held Over Recor
     C                     END                             *FI
     C                     END                             *FI
     C           KRSOB     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         OBEXIT    ENDSR
      /EJECT
     CSR         OCCHRC    BEGSR
      *================================================================
      * Chg Buy Order Detail  CH - Buy Order Load  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0046  50       BOL Shipped Hea
     C                     MOVEL*BLANK    WN0047  1        Reported to USD
     C                     MOVEL*BLANK    WN0048  1        BOL MPR Prior D
     C                     MOVEL*BLANK    WN0049  1        BOL Status 4
     C                     MOVEL*BLANK    WN0050  2        BOL Status 5
     C                     MOVEL*BLANK    WN0051  2        BOL Status 6
     C                     MOVEL*BLANK    WN0052  3        BOL Status 7
     C                     Z-ADD*ZERO     WN0053  70       BOL HPS Movemen
     C                     Z-ADD*ZERO     WN0054  70       BOL Head LFT
     C                     Z-ADD*ZERO     WN0055  70       BOL Head EUT/KO
     C                     Z-ADD*ZERO     WN0056  70       BOL Unused Nbr
     C                     Z-ADD*ZERO     WN0057  70       BOL Unused Nbr
     C                     Z-ADD*ZERO     WN0058 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0059 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0060 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0061 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0062 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0063  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0064  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0065  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0066  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0067  70       BOL Unused Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @AXCPBY
     C                     Z-ADDAXHMNB    WKHMNB           BOH Company Num
     C                     Z-ADDAXBNNB    WKBNNB           BOH Buy Order N
     C                     Z-ADDAXBONB    WKBONB           BOL Load Number
      *
     C           KLCHOC    KLIST
     C                     KFLD           WKHMNB           BOH Company Num
     C                     KFLD           WKBNNB           BOH Buy Order N
     C                     KFLD           WKBONB           BOL Load Number
     C           KLCHOC    CHAIN@AXCPBY              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKAXCPL1'MDACP
     C                     MOVEL'@AXCPBY' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO OCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO OCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKAX1    YFRDCS
      * Move non-key fields to @AXCPBY
     C                     Z-ADDAXCQDT    WKCQDT           BOL Kill Date
     C                     Z-ADDAXABTH    WKABTH           BOL Pln Delv St
     C                     Z-ADDAXACTH    WKACTH           BOL Pln Delv En
     C                     Z-ADDAXBPNB    WKBPNB           BOL Pln Head De
     C                     Z-ADDAXCSNB    WKCSNB           BOL Shipped Wgt
     C                     Z-ADDAXAUDT    WKAUDT           BOL Pln Delv Da
     C                     MOVELAXCMST    WKCMST    P      BOL Freight UOM
     C                     Z-ADDAXAGPR    WKAGPR           BOL Freight Uni
     C                     Z-ADDWUATVA    WKATVA           BOL Freight Amt
     C                     MOVELAXI1ST    WKI1ST    P      BOL Freight All
     C                     Z-ADDWUDHNB    WKDHNB           BOL Head Receiv
     C                     Z-ADDWUDINB    WKDINB           BOL Live Wgt Re
     C                     MOVELWUCNST    WKCNST    P      BOL Trucker Pay
     C                     Z-ADDAXGINB    WKGINB           BOL Trucker Che
     C                     Z-ADDAXBZDT    WKBZDT           BOL Trucker Che
     C                     Z-ADDAXLSNB    WKLSNB           BOL AP Voucher
     C                     MOVELAXF3TX    WKF3TX    P      BOL Trailer
     C                     MOVELAXO8ST    WKO8ST    P      BOL Freight Exp
     C                     MOVELAXO9ST    WKO9ST    P      BOL Scheduled K
     C                     MOVELAXPAST    WKPAST    P      BOL Truck Scale
     C                     MOVELAXBNCD    WKBNCD    P      TRK Trucker Cod
     C                     MOVELAXABCD    WKABCD    P      PD Producer Cod
     C                     MOVELAXAECD    WKAECD    P      PL Location Cod
     C                     MOVELAXAAVN    WKAAVN    P      RS User Changed
     C                     Z-ADDAXAADT    WKAADT           RS Date Changed
     C                     Z-ADDAXAMTM    WKAMTM           RS Time Changed
     C                     MOVELAXAJST    WKAJST    P      RS Record Statu
     C                     MOVELAXAHVN    WKAHVN    P      RS Job
     C                     MOVELAXAGVN    WKAGVN    P      RS Program
     C                     MOVELAXABVN    WKABVN    P      RS User Added
     C                     Z-ADDAXABDT    WKABDT           RS Date Added
     C                     Z-ADDAXABTM    WKABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WKAAVN           RS User Changed
     C                     Z-ADD##JDT     WKAADT           RS Date Changed
     C                     Z-ADD##JTM     WKAMTM           RS Time Changed
     C                     MOVEL##JOB     WKAHVN           RS Job
     C                     MOVEL##PGM     WKAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@AXCPBY                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKAXCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         OCEXIT    ENDSR
      /EJECT
     CSR         ODRVGN    BEGSR
      *================================================================
      * Rtv/Chg BOH Status     RT - Buy Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOD     KLIST
     C                     KFLD           AWHMNB           BOH Company Num
     C                     KFLD           AWBNNB           BOH Buy Order N
      * Setup key
     C                     Z-ADDP1HMNB    AWHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    AWBNNB           BOH Buy Order N
      * Establish starting position
     C           KRSOD     CHAIN@AWCPBI              90    *
      * Data record not found
     C   90                MOVEL'PRK0049' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) AWETCD' defaulted for 'BOH Commodity Market Code'.
      * Field '(DB1) AWEUCD' defaulted for 'BOH Commodity Price Group'.
      * Field '(DB1) AWJ5TX' defaulted for 'BOH Market Date Method'.
      * Chg BOH Status         CH - Buy Order Header  * 
     C                     EXSR OECHRC
     C                     ENDIF
      *================================================================
     CSR         ODEXIT    ENDSR
      /EJECT
     CSR         OECHRC    BEGSR
      *================================================================
      * Chg BOH Status         CH - Buy Order Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0068  70       BOH MPR Reporti
     C                     Z-ADD*ZERO     WN0069  70       BOH Unused Date
     C                     Z-ADD*ZERO     WN0070  70       BOH Unused Date
     C                     Z-ADD*ZERO     WN0071  70       BOH Unused Date
     C                     Z-ADD*ZERO     WN0072  70       BOH Unused Date
     C                     Z-ADD*ZERO     WN0073  70       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0074  70       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0075  70       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0076  90       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0077  90       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0078  91       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0079  91       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0080 112       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0081 112       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0082 112       BOH Unused Nbr
     C                     MOVEL*BLANK    WN0083  1        BOH MPR Reporti
     C                     MOVEL*BLANK    WN0084  1        BOH Status 2
     C                     MOVEL*BLANK    WN0085  2        BOH Status 3
     C                     MOVEL*BLANK    WN0086  3        BOH Status 4
     C                     MOVEL*BLANK    WN0087  3        BOH Status 5
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YGRDC   1
      *
      * Move key fields to @AWCPAZ
     C                     Z-ADDAWHMNB    WLHMNB           BOH Company Num
     C                     Z-ADDAWBNNB    WLBNNB           BOH Buy Order N
      *
     C           KLCHOE    KLIST
     C                     KFLD           WLHMNB           BOH Company Num
     C                     KFLD           WLBNNB           BOH Buy Order N
     C           KLCHOE    CHAIN@AWCPAZ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKAWCPL0'MDACP
     C                     MOVEL'@AWCPAZ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO OEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO OEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKAW1    YGRDCS
      * Move non-key fields to @AWCPAZ
     C                     Z-ADDAWARDT    WLARDT           BOH Buy Order D
     C                     Z-ADDAWASDT    WLASDT           BOH Kill Date
     C                     MOVELAWA4ST    WLA4ST    P      BOH Payment Typ
     C                     MOVELAWA5ST    WLA5ST    P      BOH Buy Order T
     C                     Z-ADDAWAAPR    WLAAPR           BOH Market Add/
     C                     MOVEL'L'       WLA6ST    P      BOH Status
     C                     MOVELAWA7ST    WLA7ST    P      BOH Delv Plan P
     C                     MOVELAWB3ST    WLB3ST    P      BOH Quote Price
     C                     Z-ADDAWALPR    WLALPR           BOH Quoted Base
     C                     MOVELAWETCD    WLETCD    P      BOH Commodity M
     C                     MOVELAWEUCD    WLEUCD    P      BOH Commodity P
     C                     MOVELAWJ5TX    WLJ5TX    P      BOH Market Date
     C                     Z-ADDAWHXNB    WLHXNB           PPWS Company Nu
     C                     Z-ADDAWGANB    WLGANB           CW Year
     C                     Z-ADDAWGBNB    WLGBNB           CW Week Number
     C                     MOVELAWABCD    WLABCD    P      PD Producer Cod
     C                     MOVELAWAECD    WLAECD    P      PL Location Cod
     C                     MOVELAWAKCD    WLAKCD    P      PC Contract Cod
     C                     MOVELAWALCD    WLALCD    P      PSC Sub-Contrac
     C                     MOVELAWAGCD    WLAGCD    P      GN Genetic Code
     C                     MOVELAWAICD    WLAICD    P      PO Option Code
     C                     MOVELAWAMCD    WLAMCD    P      CMP Program Cod
     C                     MOVELAWACCD    WLACCD    P      HB Buyer Code
     C                     MOVELAWAAVN    WLAAVN    P      RS User Changed
     C                     Z-ADDAWAADT    WLAADT           RS Date Changed
     C                     Z-ADDAWAMTM    WLAMTM           RS Time Changed
     C                     MOVELAWAJST    WLAJST    P      RS Record Statu
     C                     MOVELAWAHVN    WLAHVN    P      RS Job
     C                     MOVELAWAGVN    WLAGVN    P      RS Program
     C                     MOVELAWABVN    WLABVN    P      RS User Added
     C                     Z-ADDAWABDT    WLABDT           RS Date Added
     C                     Z-ADDAWABTM    WLABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKAW1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WLAAVN           RS User Changed
     C                     Z-ADD##JDT     WLAADT           RS Date Changed
     C                     Z-ADD##JTM     WLAMTM           RS Time Changed
     C                     MOVEL##JOB     WLAHVN           RS Job
     C                     MOVEL##PGM     WLAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKAW1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YGRDC     IFEQ 'Y'
     C                     UPDAT@AWCPAZ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKAWCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         OEEXIT    ENDSR
      /EJECT
     CSR         OFRVGN    BEGSR
      *================================================================
      * Rtv Chg Lock Sts      RT - Delivery Sched Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN AEHMNB    WQOF01           BOH Company Num
     C           *LIKE     DEFN AEBNNB    WQOF02           BOH Buy Order N
     C           *LIKE     DEFN AEBONB    WQOF03           BOL Load Number
     C           *LIKE     DEFN AEE0DT    WQOF04           DSH Kill Date
      * Define keylist
     C           KRSOF     KLIST
     C                     KFLD           WQOF01           BOH Company Num
     C                     KFLD           WQOF02           BOH Buy Order N
     C                     KFLD           WQOF03           BOL Load Number
     C                     KFLD           WQOF04           DSH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQOF01           BOH Company Num
     C                     Z-ADDP1BNNB    WQOF02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQOF03           BOL Load Number
     C                     Z-ADDP1B0DT    WQOF04           DSH Kill Date
      * Establish starting position
     C           KRSOF     SETLL@AECPI5                    *
     C           KRSOF     READE@AECPI5                  90*
      * Data record not found
     C   90                MOVEL'PRK1028' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Delv Sched Dtl    CH - Delivery Sched Detail  * 
     C                     EXSR OGCHRC
     C           KRSOF     READE@AECPI5                  90*
     C                     ENDDO
      *================================================================
     CSR         OFEXIT    ENDSR
      /EJECT
     CSR         OGCHRC    BEGSR
      *================================================================
      * Chg Delv Sched Dtl    CH - Delivery Sched Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YHRDC   1
      *
      * Move key fields to @AECPIH
     C                     Z-ADDAEHONB    WMHONB           CC Company Numb
     C                     Z-ADDAEE0DT    WME0DT           DSH Kill Date
     C                     Z-ADDAEE6DT    WME6DT           DSD Delivery Da
     C                     Z-ADDAEAGTH    WMAGTH           DSD Delivery Ti
     C                     Z-ADDAEHZA1    WMHZA1           DSD Delivery Ti
      *
     C           KLCHOG    KLIST
     C                     KFLD           WMHONB           CC Company Numb
     C                     KFLD           WME0DT           DSH Kill Date
     C                     KFLD           WME6DT           DSD Delivery Da
     C                     KFLD           WMAGTH           DSD Delivery Ti
     C                     KFLD           WMHZA1           DSD Delivery Ti
     C           KLCHOG    CHAIN@AECPIH              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLAECPL1'MDACP
     C                     MOVEL'@AECPIH' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL008.
     C                     MOVEL'LBL008'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO OGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO OGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPLAE1    YHRDCS
      * Move non-key fields to @AECPIH
     C                     Z-ADDAEH0A1    WMH0A1           DSD Scheduled H
     C                     Z-ADDAEH1A1    WMH1A1           DSD Farm Site C
     C                     MOVELAEJ4CD    WMJ4CD    P      DSD Building
     C                     MOVELAEJ5CD    WMJ5CD    P      DSD Room
     C                     MOVELAELBCD    WMLBCD    P      DSD Sire Line C
     C                     MOVELAELCCD    WMLCCD    P      DSD Hog Group C
     C                     Z-ADDAEIOA1    WMIOA1           DSD Unused Head
     C                     Z-ADDAEH2A1    WMH2A1           DSD Scheduled D
     C                     Z-ADDAEIJA1    WMIJA1           DSD Scheduled K
     C                     MOVELAEK9CD    WMK9CD    P      DSD Transportat
     C                     MOVELAEK8CD    WMK8CD    P      DSD Trucker Cod
     C                     MOVELAEJ6CD    WMJ6CD    P      DSD Driver
     C                     MOVELAEJ7CD    WMJ7CD    P      DSD Loading Cre
     C                     MOVELAEMGCD    WMMGCD    P      CHR Code
     C                     MOVELAEW1ST    WMW1ST    P      DSD Load Type
     C                     MOVELAEW2ST    WMW2ST    P      DSD Full/Split
     C                     Z-ADDAEH3A1    WMH3A1           DSD Movement Nu
     C                     MOVELAEMECD    WMMECD    P      DSD Truck ID
     C                     MOVELAEMFCD    WMMFCD    P      DSD Trailer ID
     C                     MOVELAEW4ST    WMW4ST    P      DSD Movement Pr
     C                     MOVELAEXWST    WMXWST    P      DSD Sched Route
     C                     Z-ADDAEFRDT    WMFRDT           DSD Sched Route
     C                     Z-ADDAEBOTH    WMBOTH           DSD Sched Route
     C                     Z-ADDAEE7DT    WME7DT           DSD Sch Farm Ar
     C                     Z-ADDAEAHTH    WMAHTH           DSD Sch Farm Ar
     C                     Z-ADDAEE8DT    WME8DT           DSD Sch Start L
     C                     Z-ADDAEAITH    WMAITH           DSD Sch Start L
     C                     MOVELAEXBST    WMXBST    P      DSD Receiving S
     C                     MOVELAEXGST    WMXGST    P      DSD Kill Shift
     C                     MOVELAEXPST    WMXPST    P      DSD BOL Kill Sh
     C                     MOVELAEXNST    WMXNST    P      DSD HPS Post St
     C                     MOVELAEXTST    WMXTST    P      DSD HPE Post St
     C                     MOVEL'L'       WMXLST    P      DSD Lock Status
     C                     MOVELAEW0ST    WMW0ST    P      DSD Source Type
     C                     MOVELAEYEST    WMYEST    P      DSD Transfer St
     C                     Z-ADDAEFZDT    WMFZDT           DSD Unused Date
     C                     Z-ADDAEB1TH    WMB1TH           DSD Unused Time
     C                     MOVELAEAACD    WMAACD    P      SR Source Code
     C                     MOVELAEABCD    WMABCD    P      PD Producer Cod
     C                     MOVELAEAECD    WMAECD    P      PL Location Cod
     C                     Z-ADDAEHMNB    WMHMNB           BOH Company Num
     C                     Z-ADDAEBNNB    WMBNNB           BOH Buy Order N
     C                     Z-ADDAEBONB    WMBONB           BOL Load Number
     C                     MOVELAEAAVN    WMAAVN    P      RS User Changed
     C                     Z-ADDAEAADT    WMAADT           RS Date Changed
     C                     Z-ADDAEAMTM    WMAMTM           RS Time Changed
     C                     MOVELAEAJST    WMAJST    P      RS Record Statu
     C                     MOVELAEAHVN    WMAHVN    P      RS Job
     C                     MOVELAEAGVN    WMAGVN    P      RS Program
     C                     MOVELAEABVN    WMABVN    P      RS User Added
     C                     Z-ADDAEABDT    WMABDT           RS Date Added
     C                     Z-ADDAEABTM    WMABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPLAE1    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WMAAVN           RS User Changed
     C                     Z-ADD##JDT     WMAADT           RS Date Changed
     C                     Z-ADD##JTM     WMAMTM           RS Time Changed
     C                     MOVEL##JOB     WMAHVN           RS Job
     C                     MOVEL##PGM     WMAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPLAE1    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YHRDC     IFEQ 'Y'
     C                     UPDAT@AECPIH                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPLAECPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         OGEXIT    ENDSR
      /EJECT
     CSR         OHCRRC    BEGSR
      *================================================================
      * Create Tattoo Header - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @A1CPC5
     C                     Z-ADDP1HMNB    A1HMNB           BOH Company Num
     C                     Z-ADDP1BNNB    A1BNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    A1BONB           BOL Load Number
     C                     Z-ADD#1CVNB    A1CVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    A1B0DT           TH Kill Date
     C                     Z-ADD#1AWDT    A1AWDT           TH Purchase Dat
     C                     MOVEL#1BICD    A1BICD           TH Group Refere
     C                     MOVEL#1CPST    A1CPST           TH Live Purchas
     C                     Z-ADD#1ACPR    A1ACPR           TH Live Purchas
     C                     Z-ADD#1B9PR    A1B9PR           TH Live Gross A
     C                     Z-ADD#1CAPR    A1CAPR           TH LIve Net Amt
     C                     MOVEL#1C4ST    A1C4ST           TH Resale UOM
     C                     Z-ADD#1AIPR    A1AIPR           TH Recalc Live
     C                     Z-ADD#1A6DT    A1A6DT           TH Pricing Date
     C                     MOVEL#1C2ST    A1C2ST           TH Resale Sprea
     C                     Z-ADD#1CXNB    A1CXNB           TH Dead On Arri
     C                     Z-ADDWUCWNB    A1CWNB           TH Head Receive
     C                     Z-ADD#1FCNB    A1FCNB           TH Yard Deads
     C                     Z-ADD#1H9NB    A1H9NB           TH Held Over
     C                     Z-ADD#1FDNB    A1FDNB           TH Head Condemn
     C                     Z-ADD#1FENB    A1FENB           TH Head Killed
     C                     Z-ADD#1HENB    A1HENB           TH Head Adds
     C                     Z-ADD#1HFNB    A1HFNB           TH Head Accepte
     C                     Z-ADD#1CYNB    A1CYNB           TH Live Wgt
     C                     Z-ADD#1LRNB    A1LRNB           TH Adj Live Wgt
     C                     Z-ADD#1E0NB    A1E0NB           TH Hot Wgt
     C                     Z-ADD#1A5PC    A1A5PC           TH Tot Loin Eye
     C                     Z-ADD#1FBNB    A1FBNB           TH Tot Backfat
     C                     Z-ADD#1A4PC    A1A4PC           TH Tot Light Re
     C                     Z-ADD#1F7NB    A1F7NB           TH Avg Live Wgt
     C                     Z-ADD#1HDNB    A1HDNB           TH Avg Hot Wgt
     C                     Z-ADD#1F5NB    A1F5NB           TH Avg Light Re
     C                     Z-ADD#1F4NB    A1F4NB           TH Avg Lean Per
     C                     Z-ADD#1F3NB    A1F3NB           TH Avg Loin Eye
     C                     Z-ADD#1F2NB    A1F2NB           TH Avg Backfat
     C                     Z-ADD#1AVPC    A1AVPC           TH Std Yield Pe
     C                     Z-ADD#1AWPC    A1AWPC           TH Actual Yield
     C                     Z-ADD#1CWPC    A1CWPC           TH Adj Actual Y
     C                     Z-ADD#1A8PC    A1A8PC           TH Yield Differ
     C                     Z-ADD#1A7PC    A1A7PC           TH Recalc Live
     C                     Z-ADD#1B8PR    A1B8PR           TH CM Market Pr
     C                     Z-ADD#1AMPR    A1AMPR           TH CM Base Mkt
     C                     Z-ADD#1ANPR    A1ANPR           TH CM Base Mkt
     C                     Z-ADD#1AYVA    A1AYVA           TH CM Sort Disc
     C                     Z-ADD#1AWVA    A1AWVA           TH CM Yield Gai
     C                     Z-ADD#1AOPR    A1AOPR           TH CM Base Carc
     C                     Z-ADD#1AXVA    A1AXVA           TH CM LN AddOn/
     C                     Z-ADD#1APPR    A1APPR           TH CM Carcass G
     C                     Z-ADD#1ASPR    A1ASPR           TH Deduction Am
     C                     Z-ADD#1A4VA    A1A4VA           TH Total Net WO
     C                     Z-ADD#1ATPR    A1ATPR           TH Carcass Net
     C                     Z-ADD#1A5VA    A1A5VA           TH Additions Am
     C                     Z-ADD#1CBPR    A1CBPR           TH Payment Gros
     C                     Z-ADD#1CCPR    A1CCPR           Th Payment Net
     C                     Z-ADD#1LPNB    A1LPNB           TH AP Voucher/D
     C                     Z-ADD#1CDPR    A1CDPR           TH Freight Amou
     C                     Z-ADD#1A7VA    A1A7VA           TH Accrual Amou
     C                     Z-ADD#1A2PR    A1A2PR           TH Fixed Cost A
     C                     MOVEL#1JWST    A1JWST           TH Calc Net Sts
     C                     MOVEL#1CWST    A1CWST           TH Payment Sts
     C                     MOVEL#1D7ST    A1D7ST           TH Header Error
     C                     MOVEL#1D8ST    A1D8ST           TH Detail Error
     C                     MOVEL#1DWST    A1DWST           TH Kill Balanci
     C                     MOVEL#1D6ST    A1D6ST           TH Bal to Kill
     C                     Z-ADD#1GHNB    A1GHNB           TH Commission A
     C                     Z-ADD#1BYDT    A1BYDT           TH Voucher Paym
     C                     MOVEL#1E0ST    A1E0ST           TH User Error O
     C                     MOVEL#1E1ST    A1E1ST           TH Held Over Re
     C                     MOVEL#1E2ST    A1E2ST           TH Sex
     C                     Z-ADD#1BSDT    A1BSDT           TH Held/Ovr Com
     C                     Z-ADD#1BTDT    A1BTDT           TH Commission P
     C                     Z-ADD#1BUDT    A1BUDT           TH Actual Check
     C                     Z-ADD#1HGNB    A1HGNB           TH Shipped Weig
     C                     Z-ADD#1HHNB    A1HHNB           TH Avg Hot Wgt
     C                     Z-ADD#1HINB    A1HINB           TH FFLI
     C                     Z-ADD#1A3PR    A1A3PR           TH Kill Product
     C                     Z-ADD#1A4PR    A1A4PR           TH Cut Product
     C                     Z-ADD#1A6PR    A1A6PR           TH Render Produ
     C                     Z-ADD#1J9NB    A1J9NB           TH Head Exclude
     C                     Z-ADD#1D6PR    A1D6PR           TH CM Bse Mkt L
     C                     Z-ADD#1D7PR    A1D7PR           TH CM Bse Mkt C
     C                     Z-ADD#1D8PR    A1D8PR           TH CM Srt Dsc L
     C                     Z-ADD#1D9PR    A1D9PR           TH CM Srt Dsc C
     C                     Z-ADD#1EAPR    A1EAPR           TH CM Yld G/L L
     C                     Z-ADD#1EBPR    A1EBPR           TH CM Yld G/L C
     C                     Z-ADD#1ECPR    A1ECPR           TH CM Crc Val L
     C                     Z-ADD#1EDPR    A1EDPR           TH CM Crc Val C
     C                     Z-ADD#1EEPR    A1EEPR           TH CM Lean Prem
     C                     Z-ADD#1EFPR    A1EFPR           TH CM Lean Prem
     C                     Z-ADD#1EGPR    A1EGPR           TH CM Gross Liv
     C                     Z-ADD#1EHPR    A1EHPR           TH CM Gross Car
     C                     MOVEL#1KAST    A1KAST           TH Source Type
     C                     MOVEL#1J7ST    A1J7ST           TH Scale Ticket
     C                     MOVEL#1J9ST    A1J9ST           TH Payment Type
     C                     Z-ADD#1OXNB    A1OXNB           TH HPS Movement
     C                     MOVEL#1LKST    A1LKST           TH Source Code
     C                     MOVEL#1LLST    A1LLST           TH Hog Class Ty
     C                     MOVEL#1J8ST    A1J8ST           TH Posted to HP
     C                     MOVEL#1LIST    A1LIST           TH Schedule Kil
     C                     MOVEL#1LJST    A1LJST           TH Shift Held O
     C                     MOVEL#1NZTX    A1NZTX           TH State
     C                     MOVEL#1HJCD    A1HJCD           TH Unused Code
     C                     MOVEL#1R4ST    A1R4ST           TH Unused Sts 2
     C                     MOVEL#1R5ST    A1R5ST           TH Commission S
     C                     MOVEL#1R6ST    A1R6ST           TH Paid 2 Week
     C                     MOVEL#1R7ST    A1R7ST           TH Unused Sts 1
     C                     Z-ADD#1THWT    A1THWT           TH DOA Weight
     C                     Z-ADD#1T2WT    A1T2WT           TH Avg Lean % E
     C                     Z-ADD#1THHD    A1THHD           TH HPS Farm Sit
     C                     Z-ADD#1T2HD    A1T2HD           TH Shift Held O
     C                     Z-ADD#1OBPR    A1OBPR           TH Sorting Amou
     C                     Z-ADD#1KOER    A1KOER           TH Head Identif
     C                     Z-ADD#1OPIR    A1OPIR           TH Percent Iden
     C                     Z-ADD#1OPEM    A1OPEM           TH Percent Acce
     C                     Z-ADD#1IORP    A1IORP           TH Head Adjuste
     C                     Z-ADD#1OWEO    A1OWEO           TH PHA Head Add
     C                     MOVEL#1OQET    A1OQET           TH PHA Add Type
     C                     MOVEL#1URST    A1URST           TH PHA Average
     C                     MOVEL#1USST    A1USST           TH PHA Add Reas
     C                     Z-ADD#1HHPC    A1HHPC           TH PHA Yield Pe
     C                     Z-ADD#1S9PR    A1S9PR           TH PHA Lean Prm
     C                     Z-ADD#1TAPR    A1TAPR           TH VC Gross Val
     C                     Z-ADD#1TBPR    A1TBPR           TH Excluded Gro
     C                     Z-ADD#1JFUR    A1JFUR           TH Avg Lean %
     C                     Z-ADD#1KRIF    A1KRIF           TH Broken Back
     C                     Z-ADD#1KORF    A1KORF           TH Hot Scl Uplo
     C                     Z-ADD#1KAPR    A1KAPR           TH Unused Nbr 4
     C                     Z-ADD#1KROT    A1KROT           TH Excluded Car
     C                     Z-ADD#1OTJG    A1OTJG           TH Excluded Pre
     C                     Z-ADD#1IRJG    A1IRJG           TH Unused Nbr 7
     C                     Z-ADD#1IMJF    A1IMJF           TH Unused Nbr 8
     C                     Z-ADD#1IRGF    A1IRGF           TH Unused Nbr 9
     C                     Z-ADD#1KRJF    A1KRJF           TH Unused Nbr 1
     C                     Z-ADD#1OJRF    A1OJRF           TH Break Even P
     C                     Z-ADD#1KFOR    A1KFOR           TH Meat Value F
     C                     Z-ADD#1ORJK    A1ORJK           TH Yld Parm Adj
     C                     Z-ADD#1OMVJ    A1OMVJ           TH PHA Sort Dis
     C                     Z-ADD#1MVNF    A1MVNF           TH Avg Loin Eye
     C                     Z-ADD#1MCNF    A1MCNF           TH Avg Backfat
     C                     Z-ADD#1NCNF    A1NCNF           TH HITCH Old Pa
     C                     Z-ADD#1NCHF    A1NCHF           TH MPR Sort Los
     C                     Z-ADD#1IGIR    A1IGIR           TH Unused Nbr 1
     C                     Z-ADD#1KFJR    A1KFJR           TH Unused Nbr 2
     C                     Z-ADD#1EADT    A1EADT           TH Cold Scl Upl
     C                     Z-ADD#1EBDT    A1EBDT           TH Cold Scl Upl
     C                     Z-ADD#1ECDT    A1ECDT           TH Head LFT
     C                     Z-ADD#1EDDT    A1EDDT           TH Head EUT/KOA
     C                     Z-ADD#1EEDT    A1EEDT           TH Unused Date
     C                     MOVEL#1U4ST    A1U4ST           TH Unused Sts 1
     C                     MOVEL#1U5ST    A1U5ST           TH Unused Sts 2
     C                     MOVEL#1U6ST    A1U6ST           TH Unused Sts 3
     C                     MOVEL#1U7ST    A1U7ST           TH Unused Sts 4
     C                     MOVEL#1U8ST    A1U8ST           TH Unused Sts 5
     C                     MOVEL#1U9ST    A1U9ST           TH Unused Sts 6
     C                     MOVEL#1VAST    A1VAST           TH Unused Sts 7
     C                     MOVEL#1VBST    A1VBST           TH Unused Sts 8
     C                     MOVEL#1BDCD    A1BDCD           DF Defect Code
     C                     MOVE *BLANK    A1CSCD           THP Process Cod
     C                     MOVEL'RECV'    A1CSCD           THP Process Cod
     C                     MOVELP1ABCD    A1ABCD           PD Producer Cod
     C                     MOVELP1AECD    A1AECD           PL Location Cod
     C                     MOVEL#1ACCD    A1ACCD           HB Buyer Code
     C                     MOVEL#1AGCD    A1AGCD           GN Genetic Code
     C                     MOVEL#1BECD    A1BECD           HC Class Code
     C                     MOVEL#1AAVN    A1AAVN           RS User Changed
     C                     Z-ADD#1AADT    A1AADT           RS Date Changed
     C                     Z-ADD#1AMTM    A1AMTM           RS Time Changed
     C                     MOVEL#1AJST    A1AJST           RS Record Statu
     C                     MOVEL#1AHVN    A1AHVN           RS Job
     C                     MOVEL#1AGVN    A1AGVN           RS Program
     C                     MOVEL#1ABVN    A1ABVN           RS User Added
     C                     Z-ADD#1ABDT    A1ABDT           RS Date Added
     C                     Z-ADD#1ABTM    A1ABTM           RS Time Added
      *
      * USER: Processing before Data update
      * HPE056 Payment Type
      * 1/10/96  HPE056   Allow payment type to be update based on
      *                   what the payment status is at the time this
      *                   tattoo is being updated
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       A1AJST           RS Record Statu
     C                     MOVEL##USR     A1ABVN           RS User Added
     C                     Z-ADD##JDT     A1ABDT           RS Date Added
     C                     Z-ADD##JTM     A1ABTM           RS Time Added
     C                     MOVEL##PGM     A1AGVN           RS Program
     C                     MOVEL##JOB     A1AHVN           RS Job
     C                     MOVEL'N'       A1E0ST           TH User Error O
      * Chg/Crt Tatto/Spc Flds IF
      * HPE056 Payment Type
      * 1/10/96  HPE056   Allow payment type to be update based on
      *                   what the payment status is at the time this
      *                   tattoo is being updated
      * Function Description:  If there are any fields that need to be
      * Changed/Created during the Change functions or Create function
      * Presently: Payment Type
      * Add this routine to all of the change objects and create object
      * that update the Payment Type
      * CASE: PAR.TH Payment Sts is Live anything
     C           A1CWST    IFEQ 'ML'                       *IF
     C           A1CWST    OREQ 'PL'
     C           A1CWST    OREQ 'NL'
     C           A1CWST    OREQ 'SL'
     C           A1CWST    OREQ 'IL'
     C                     MOVEL'L'       A1J9ST           TH Payment Type
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'C'       A1J9ST           TH Payment Type
     C                     END                             *FI
     C           KLCROH    KLIST
     C                     KFLD           A1HMNB           BOH Company Num
     C                     KFLD           A1BNNB           BOH Buy Order N
     C                     KFLD           A1BONB           BOL Load Number
     C                     KFLD           A1CVNB           TH Tattoo Numbe
     C                     KFLD           A1B0DT           TH Kill Date
      * Check for duplicate primary key
     C           KLCROH    SETLL@A1CPC5                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0062' W0RTN   7
      * Send message 'Tattoo Header          EX'
     C                     MOVEL'PRK0062' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO OHEXIT
     C                     ENDIF
      *
     C                     WRITE@A1CPC5                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         OHEXIT    ENDSR
      /EJECT
     CSR         OIRVGN    BEGSR
      *================================================================
      * Upd Shipped Head      RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOI     KLIST
     C                     KFLD           AXHMNB           BOH Company Num
     C                     KFLD           AXBNNB           BOH Buy Order N
     C                     KFLD           AXBONB           BOL Load Number
      * Setup key
     C                     Z-ADDP1HMNB    AXHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    AXBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    AXBONB           BOL Load Number
      * Establish starting position
     C           KRSOI     CHAIN@AXCPBX              90    *
      * Data record not found
     C   90                MOVEL'PRK0051' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Shipped Head      CH - Buy Order Load  * 
     C                     EXSR OJCHRC
     C                     ENDIF
      *================================================================
     CSR         OIEXIT    ENDSR
      /EJECT
     CSR         OJCHRC    BEGSR
      *================================================================
      * Chg Shipped Head      CH - Buy Order Load  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0088  70       BOL Kill Date
     C                     Z-ADD*ZERO     WN0089  40       BOL Pln Delv St
     C                     Z-ADD*ZERO     WN0090  40       BOL Pln Delv En
     C                     Z-ADD*ZERO     WN0091  50       BOL Pln Head De
     C                     Z-ADD*ZERO     WN0092  71       BOL Shipped Wgt
     C                     Z-ADD*ZERO     WN0093  70       BOL Pln Delv Da
     C                     MOVEL*BLANK    WN0094  2        BOL Freight UOM
     C                     Z-ADD*ZERO     WN0095  72       BOL Freight Uni
     C                     Z-ADD*ZERO     WN0096  72       BOL Freight Amt
     C                     MOVEL*BLANK    WN0097  1        BOL Freight All
     C                     Z-ADD*ZERO     WN0098  70       BOL Head Receiv
     C                     Z-ADD*ZERO     WN0099  71       BOL Live Wgt Re
     C                     MOVEL*BLANK    WN0100  2        BOL Trucker Pay
     C                     Z-ADD*ZERO     WN0101  80       BOL Trucker Che
     C                     Z-ADD*ZERO     WN0102  70       BOL Trucker Che
     C                     Z-ADD*ZERO     WN0103  80       BOL AP Voucher
     C                     MOVEL*BLANK    WN0104 11        BOL Trailer
     C                     MOVEL*BLANK    WN0105  1        BOL Freight Exp
     C                     MOVEL*BLANK    WN0106  1        BOL Scheduled K
     C                     MOVEL*BLANK    WN0107  1        BOL Truck Scale
     C                     MOVEL*BLANK    WN0108  1        Reported to USD
     C                     MOVEL*BLANK    WN0109  1        BOL MPR Prior D
     C                     MOVEL*BLANK    WN0110  1        BOL Status 4
     C                     MOVEL*BLANK    WN0111  2        BOL Status 5
     C                     MOVEL*BLANK    WN0112  2        BOL Status 6
     C                     MOVEL*BLANK    WN0113  3        BOL Status 7
     C                     Z-ADD*ZERO     WN0114  70       BOL HPS Movemen
     C                     Z-ADD*ZERO     WN0115  70       BOL Head LFT
     C                     Z-ADD*ZERO     WN0116  70       BOL Head EUT/KO
     C                     Z-ADD*ZERO     WN0117  70       BOL Unused Nbr
     C                     Z-ADD*ZERO     WN0118  70       BOL Unused Nbr
     C                     Z-ADD*ZERO     WN0119 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0120 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0121 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0122 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0123 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0124  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0125  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0126  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0127  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0128  70       BOL Unused Date
     C                     MOVEL*BLANK    WN0129  3        TRK Trucker Cod
     C                     MOVEL*BLANK    WN0130  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0131  6        PL Location Cod
     C                     MOVEL*BLANK    WN0132 10        RS User Changed
     C                     Z-ADD*ZERO     WN0133  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0134  60       RS Time Changed
     C                     MOVEL*BLANK    WN0135  1        RS Record Statu
     C                     MOVEL*BLANK    WN0136 10        RS Job
     C                     MOVEL*BLANK    WN0137 10        RS Program
     C                     MOVEL*BLANK    WN0138 10        RS User Added
     C                     Z-ADD*ZERO     WN0139  70       RS Date Added
     C                     Z-ADD*ZERO     WN0140  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YIRDC   1
      *
      * Move key fields to @AXCPBY
     C                     Z-ADDP1HMNB    WKHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WKBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WKBONB           BOL Load Number
      *
     C           KLCHOJ    KLIST
     C                     KFLD           WKHMNB           BOH Company Num
     C                     KFLD           WKBNNB           BOH Buy Order N
     C                     KFLD           WKBONB           BOL Load Number
     C           KLCHOJ    CHAIN@AXCPBY              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKAXCPL1'MDACP
     C                     MOVEL'@AXCPBY' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL009.
     C                     MOVEL'LBL009'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO OJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO OJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKAX1    YIRDCS
      * Move non-key fields to @AXCPBY
     C                     Z-ADD#DLDSH    WKLDSH           BOL Shipped Hea
      *
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WKAAVN           RS User Changed
     C                     Z-ADD##JDT     WKAADT           RS Date Changed
     C                     Z-ADD##JTM     WKAMTM           RS Time Changed
     C                     MOVEL##JOB     WKAHVN           RS Job
     C                     MOVEL##PGM     WKAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YIRDC     IFEQ 'Y'
     C                     UPDAT@AXCPBY                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKAXCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         OJEXIT    ENDSR
      /EJECT
     CSR         OKRVGN    BEGSR
      *================================================================
      * Rtv Del Tattoo Def - Tattoo Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DZHMNB    WQOK01           BOH Company Num
     C           *LIKE     DEFN DZBNNB    WQOK02           BOH Buy Order N
     C           *LIKE     DEFN DZBONB    WQOK03           BOL Load Number
     C           *LIKE     DEFN DZCVNB    WQOK04           TH Tattoo Numbe
     C           *LIKE     DEFN DZB0DT    WQOK05           TH Kill Date
      * Define keylist
     C           KRSOK     KLIST
     C                     KFLD           WQOK01           BOH Company Num
     C                     KFLD           WQOK02           BOH Buy Order N
     C                     KFLD           WQOK03           BOL Load Number
     C                     KFLD           WQOK04           TH Tattoo Numbe
     C                     KFLD           WQOK05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQOK01           BOH Company Num
     C                     Z-ADDP1BNNB    WQOK02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQOK03           BOL Load Number
     C                     Z-ADD#1CVNB    WQOK04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQOK05           TH Kill Date
      * Establish starting position
     C           KRSOK     SETLL@DZREX3                    *
     C           KRSOK     READE@DZREX3                  90*
      * Data record not found
     C   90                MOVEL'PRK0738' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Dlt Tattoo Defect     DO - Tattoo Defect  * 
     C                     EXSR OLDLRC
     C           KRSOK     READE@DZREX3                  90*
     C                     ENDDO
      *================================================================
     CSR         OKEXIT    ENDSR
      /EJECT
     CSR         OLDLRC    BEGSR
      *================================================================
      * Dlt Tattoo Defect     DO - Tattoo Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @DZREX2
     C                     Z-ADDDZHMNB    WOHMNB           BOH Company Num
     C                     Z-ADDDZBNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDDZBONB    WOBONB           BOL Load Number
     C                     Z-ADDDZCVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDDZB0DT    WOB0DT           TH Kill Date
     C                     MOVELDZBDCD    WOBDCD           DF Defect Code
      *
     C           KLDLOL    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOBDCD           DF Defect Code
     C           KLDLOL    CHAIN@DZREX2              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDZREL0'MDACP
     C                     MOVEL'@DZREX2' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL010.
     C                     MOVEL'LBL010'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO OLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO OLEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@DZREX2                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         OLEXIT    ENDSR
      /EJECT
     CSR         OMCRRC    BEGSR
      *================================================================
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0141  1        TDF Classificat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DZREX2
     C                     Z-ADDP1HMNB    WOHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WOBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WOB0DT           TH Kill Date
     C                     MOVEL#DGUCD    WOBDCD           DF Defect Code
     C                     Z-ADD#DF1NB    WOLJNB           TDF Head Defect
     C                     MOVEL#1BECD    WOBECD           HC Class Code
     C                     MOVEL*BLANK    WOB8SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOB9SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOCASS           TDF Unused Sts
     C                     Z-ADD*ZERO     WONXA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONYA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONZA1           TDF Unused Nbr
     C                     MOVEL*BLANK    WOAAVN           RS User Changed
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     MOVELWUAJST    WOAJST           RS Record Statu
     C                     MOVEL*BLANK    WOAHVN           RS Job
     C                     MOVEL*BLANK    WOAGVN           RS Program
     C                     MOVEL*BLANK    WOABVN           RS User Added
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Hog Defect Class  RT - Hog Defect  * 
     C                     EXSR ONRVGN
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WOAJST           RS Record Statu
     C                     MOVEL##USR     WOABVN           RS User Added
     C                     Z-ADD##JDT     WOABDT           RS Date Added
     C                     Z-ADD##JTM     WOABTM           RS Time Added
     C                     MOVEL##PGM     WOAGVN           RS Program
     C                     MOVEL##JOB     WOAHVN           RS Job
     C           KLCROM    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOBDCD           DF Defect Code
      * Check for duplicate primary key
     C           KLCROM    SETLL@DZREX2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0739' W0RTN   7
      * Send message 'Tattoo Defect          EX'
     C                     MOVEL'PRK0739' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO OMEXIT
     C                     ENDIF
      *
     C                     WRITE@DZREX2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         OMEXIT    ENDSR
      /EJECT
     CSR         ONRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Class  RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSON     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELWOBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSON     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WOB7SS           DF Classificati
     C                     GOTO ONEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7RYST    WOB7SS           DF Classificati
     C                     ENDIF
      *================================================================
     CSR         ONEXIT    ENDSR
      /EJECT
     CSR         OOCRRC    BEGSR
      *================================================================
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0142  1        TDF Classificat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DZREX2
     C                     Z-ADDP1HMNB    WOHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WOBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WOB0DT           TH Kill Date
     C                     MOVEL#DGVCD    WOBDCD           DF Defect Code
     C                     Z-ADD#DFWNB    WOLJNB           TDF Head Defect
     C                     MOVEL#1BECD    WOBECD           HC Class Code
     C                     MOVEL*BLANK    WOB8SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOB9SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOCASS           TDF Unused Sts
     C                     Z-ADD*ZERO     WONXA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONYA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONZA1           TDF Unused Nbr
     C                     MOVEL*BLANK    WOAAVN           RS User Changed
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     MOVELWUAJST    WOAJST           RS Record Statu
     C                     MOVEL*BLANK    WOAHVN           RS Job
     C                     MOVEL*BLANK    WOAGVN           RS Program
     C                     MOVEL*BLANK    WOABVN           RS User Added
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Hog Defect Class  RT - Hog Defect  * 
     C                     EXSR OPRVGN
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WOAJST           RS Record Statu
     C                     MOVEL##USR     WOABVN           RS User Added
     C                     Z-ADD##JDT     WOABDT           RS Date Added
     C                     Z-ADD##JTM     WOABTM           RS Time Added
     C                     MOVEL##PGM     WOAGVN           RS Program
     C                     MOVEL##JOB     WOAHVN           RS Job
     C           KLCROO    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOBDCD           DF Defect Code
      * Check for duplicate primary key
     C           KLCROO    SETLL@DZREX2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0739' W0RTN   7
      * Send message 'Tattoo Defect          EX'
     C                     MOVEL'PRK0739' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO OOEXIT
     C                     ENDIF
      *
     C                     WRITE@DZREX2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         OOEXIT    ENDSR
      /EJECT
     CSR         OPRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Class  RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOP     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELWOBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSOP     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WOB7SS           DF Classificati
     C                     GOTO OPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7RYST    WOB7SS           DF Classificati
     C                     ENDIF
      *================================================================
     CSR         OPEXIT    ENDSR
      /EJECT
     CSR         OQCRRC    BEGSR
      *================================================================
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0143  1        TDF Classificat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DZREX2
     C                     Z-ADDP1HMNB    WOHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WOBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WOB0DT           TH Kill Date
     C                     MOVEL#DGWCD    WOBDCD           DF Defect Code
     C                     Z-ADD#DFYNB    WOLJNB           TDF Head Defect
     C                     MOVEL#1BECD    WOBECD           HC Class Code
     C                     MOVEL*BLANK    WOB8SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOB9SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOCASS           TDF Unused Sts
     C                     Z-ADD*ZERO     WONXA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONYA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONZA1           TDF Unused Nbr
     C                     MOVEL*BLANK    WOAAVN           RS User Changed
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     MOVELWUAJST    WOAJST           RS Record Statu
     C                     MOVEL*BLANK    WOAHVN           RS Job
     C                     MOVEL*BLANK    WOAGVN           RS Program
     C                     MOVEL*BLANK    WOABVN           RS User Added
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Hog Defect Class  RT - Hog Defect  * 
     C                     EXSR ORRVGN
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WOAJST           RS Record Statu
     C                     MOVEL##USR     WOABVN           RS User Added
     C                     Z-ADD##JDT     WOABDT           RS Date Added
     C                     Z-ADD##JTM     WOABTM           RS Time Added
     C                     MOVEL##PGM     WOAGVN           RS Program
     C                     MOVEL##JOB     WOAHVN           RS Job
     C           KLCROQ    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOBDCD           DF Defect Code
      * Check for duplicate primary key
     C           KLCROQ    SETLL@DZREX2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0739' W0RTN   7
      * Send message 'Tattoo Defect          EX'
     C                     MOVEL'PRK0739' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO OQEXIT
     C                     ENDIF
      *
     C                     WRITE@DZREX2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         OQEXIT    ENDSR
      /EJECT
     CSR         ORRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Class  RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOR     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELWOBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSOR     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WOB7SS           DF Classificati
     C                     GOTO OREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7RYST    WOB7SS           DF Classificati
     C                     ENDIF
      *================================================================
     CSR         OREXIT    ENDSR
      /EJECT
     CSR         OSCRRC    BEGSR
      *================================================================
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0144  1        TDF Classificat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DZREX2
     C                     Z-ADDP1HMNB    WOHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WOBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WOB0DT           TH Kill Date
     C                     MOVEL#DGXCD    WOBDCD           DF Defect Code
     C                     Z-ADD#DFUNB    WOLJNB           TDF Head Defect
     C                     MOVEL#1BECD    WOBECD           HC Class Code
     C                     MOVEL*BLANK    WOB8SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOB9SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOCASS           TDF Unused Sts
     C                     Z-ADD*ZERO     WONXA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONYA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONZA1           TDF Unused Nbr
     C                     MOVEL*BLANK    WOAAVN           RS User Changed
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     MOVELWUAJST    WOAJST           RS Record Statu
     C                     MOVEL*BLANK    WOAHVN           RS Job
     C                     MOVEL*BLANK    WOAGVN           RS Program
     C                     MOVEL*BLANK    WOABVN           RS User Added
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Hog Defect Class  RT - Hog Defect  * 
     C                     EXSR OTRVGN
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WOAJST           RS Record Statu
     C                     MOVEL##USR     WOABVN           RS User Added
     C                     Z-ADD##JDT     WOABDT           RS Date Added
     C                     Z-ADD##JTM     WOABTM           RS Time Added
     C                     MOVEL##PGM     WOAGVN           RS Program
     C                     MOVEL##JOB     WOAHVN           RS Job
     C           KLCROS    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOBDCD           DF Defect Code
      * Check for duplicate primary key
     C           KLCROS    SETLL@DZREX2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0739' W0RTN   7
      * Send message 'Tattoo Defect          EX'
     C                     MOVEL'PRK0739' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO OSEXIT
     C                     ENDIF
      *
     C                     WRITE@DZREX2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         OSEXIT    ENDSR
      /EJECT
     CSR         OTRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Class  RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOT     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELWOBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSOT     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WOB7SS           DF Classificati
     C                     GOTO OTEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7RYST    WOB7SS           DF Classificati
     C                     ENDIF
      *================================================================
     CSR         OTEXIT    ENDSR
      /EJECT
     CSR         OUCRRC    BEGSR
      *================================================================
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0145  1        TDF Classificat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DZREX2
     C                     Z-ADDP1HMNB    WOHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WOBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WOB0DT           TH Kill Date
     C                     MOVEL#DGYCD    WOBDCD           DF Defect Code
     C                     Z-ADD#DO3NB    WOLJNB           TDF Head Defect
     C                     MOVEL#1BECD    WOBECD           HC Class Code
     C                     MOVEL*BLANK    WOB8SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOB9SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOCASS           TDF Unused Sts
     C                     Z-ADD*ZERO     WONXA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONYA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONZA1           TDF Unused Nbr
     C                     MOVEL*BLANK    WOAAVN           RS User Changed
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     MOVELWUAJST    WOAJST           RS Record Statu
     C                     MOVEL*BLANK    WOAHVN           RS Job
     C                     MOVEL*BLANK    WOAGVN           RS Program
     C                     MOVEL*BLANK    WOABVN           RS User Added
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Hog Defect Class  RT - Hog Defect  * 
     C                     EXSR OVRVGN
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WOAJST           RS Record Statu
     C                     MOVEL##USR     WOABVN           RS User Added
     C                     Z-ADD##JDT     WOABDT           RS Date Added
     C                     Z-ADD##JTM     WOABTM           RS Time Added
     C                     MOVEL##PGM     WOAGVN           RS Program
     C                     MOVEL##JOB     WOAHVN           RS Job
     C           KLCROU    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOBDCD           DF Defect Code
      * Check for duplicate primary key
     C           KLCROU    SETLL@DZREX2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0739' W0RTN   7
      * Send message 'Tattoo Defect          EX'
     C                     MOVEL'PRK0739' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO OUEXIT
     C                     ENDIF
      *
     C                     WRITE@DZREX2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         OUEXIT    ENDSR
      /EJECT
     CSR         OVRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Class  RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOV     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELWOBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSOV     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WOB7SS           DF Classificati
     C                     GOTO OVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7RYST    WOB7SS           DF Classificati
     C                     ENDIF
      *================================================================
     CSR         OVEXIT    ENDSR
      /EJECT
     CSR         OWCRRC    BEGSR
      *================================================================
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0146  1        TDF Classificat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DZREX2
     C                     Z-ADDP1HMNB    WOHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WOBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WOB0DT           TH Kill Date
     C                     MOVEL#DGZCD    WOBDCD           DF Defect Code
     C                     Z-ADD#DO4NB    WOLJNB           TDF Head Defect
     C                     MOVEL#1BECD    WOBECD           HC Class Code
     C                     MOVEL*BLANK    WOB8SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOB9SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOCASS           TDF Unused Sts
     C                     Z-ADD*ZERO     WONXA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONYA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONZA1           TDF Unused Nbr
     C                     MOVEL*BLANK    WOAAVN           RS User Changed
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     MOVELWUAJST    WOAJST           RS Record Statu
     C                     MOVEL*BLANK    WOAHVN           RS Job
     C                     MOVEL*BLANK    WOAGVN           RS Program
     C                     MOVEL*BLANK    WOABVN           RS User Added
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Hog Defect Class  RT - Hog Defect  * 
     C                     EXSR OXRVGN
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WOAJST           RS Record Statu
     C                     MOVEL##USR     WOABVN           RS User Added
     C                     Z-ADD##JDT     WOABDT           RS Date Added
     C                     Z-ADD##JTM     WOABTM           RS Time Added
     C                     MOVEL##PGM     WOAGVN           RS Program
     C                     MOVEL##JOB     WOAHVN           RS Job
     C           KLCROW    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOBDCD           DF Defect Code
      * Check for duplicate primary key
     C           KLCROW    SETLL@DZREX2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0739' W0RTN   7
      * Send message 'Tattoo Defect          EX'
     C                     MOVEL'PRK0739' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO OWEXIT
     C                     ENDIF
      *
     C                     WRITE@DZREX2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         OWEXIT    ENDSR
      /EJECT
     CSR         OXRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Class  RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOX     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELWOBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSOX     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WOB7SS           DF Classificati
     C                     GOTO OXEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7RYST    WOB7SS           DF Classificati
     C                     ENDIF
      *================================================================
     CSR         OXEXIT    ENDSR
      /EJECT
     CSR         OYCRRC    BEGSR
      *================================================================
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0147  1        TDF Classificat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DZREX2
     C                     Z-ADDP1HMNB    WOHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WOBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WOB0DT           TH Kill Date
     C                     MOVEL#DG0CD    WOBDCD           DF Defect Code
     C                     Z-ADD#DO5NB    WOLJNB           TDF Head Defect
     C                     MOVEL#1BECD    WOBECD           HC Class Code
     C                     MOVEL*BLANK    WOB8SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOB9SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOCASS           TDF Unused Sts
     C                     Z-ADD*ZERO     WONXA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONYA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONZA1           TDF Unused Nbr
     C                     MOVEL*BLANK    WOAAVN           RS User Changed
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     MOVELWUAJST    WOAJST           RS Record Statu
     C                     MOVEL*BLANK    WOAHVN           RS Job
     C                     MOVEL*BLANK    WOAGVN           RS Program
     C                     MOVEL*BLANK    WOABVN           RS User Added
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Hog Defect Class  RT - Hog Defect  * 
     C                     EXSR OZRVGN
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WOAJST           RS Record Statu
     C                     MOVEL##USR     WOABVN           RS User Added
     C                     Z-ADD##JDT     WOABDT           RS Date Added
     C                     Z-ADD##JTM     WOABTM           RS Time Added
     C                     MOVEL##PGM     WOAGVN           RS Program
     C                     MOVEL##JOB     WOAHVN           RS Job
     C           KLCROY    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOBDCD           DF Defect Code
      * Check for duplicate primary key
     C           KLCROY    SETLL@DZREX2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0739' W0RTN   7
      * Send message 'Tattoo Defect          EX'
     C                     MOVEL'PRK0739' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO OYEXIT
     C                     ENDIF
      *
     C                     WRITE@DZREX2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         OYEXIT    ENDSR
      /EJECT
     CSR         OZRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Class  RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOZ     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELWOBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSOZ     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WOB7SS           DF Classificati
     C                     GOTO OZEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7RYST    WOB7SS           DF Classificati
     C                     ENDIF
      *================================================================
     CSR         OZEXIT    ENDSR
      /EJECT
     CSR         PACRRC    BEGSR
      *================================================================
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0148  1        TDF Classificat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DZREX2
     C                     Z-ADDP1HMNB    WOHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WOBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WOB0DT           TH Kill Date
     C                     MOVEL#DG1CD    WOBDCD           DF Defect Code
     C                     Z-ADD#DFONB    WOLJNB           TDF Head Defect
     C                     MOVEL#1BECD    WOBECD           HC Class Code
     C                     MOVEL*BLANK    WOB8SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOB9SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOCASS           TDF Unused Sts
     C                     Z-ADD*ZERO     WONXA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONYA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONZA1           TDF Unused Nbr
     C                     MOVEL*BLANK    WOAAVN           RS User Changed
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     MOVELWUAJST    WOAJST           RS Record Statu
     C                     MOVEL*BLANK    WOAHVN           RS Job
     C                     MOVEL*BLANK    WOAGVN           RS Program
     C                     MOVEL*BLANK    WOABVN           RS User Added
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Hog Defect Class  RT - Hog Defect  * 
     C                     EXSR PBRVGN
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WOAJST           RS Record Statu
     C                     MOVEL##USR     WOABVN           RS User Added
     C                     Z-ADD##JDT     WOABDT           RS Date Added
     C                     Z-ADD##JTM     WOABTM           RS Time Added
     C                     MOVEL##PGM     WOAGVN           RS Program
     C                     MOVEL##JOB     WOAHVN           RS Job
     C           KLCRPA    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOBDCD           DF Defect Code
      * Check for duplicate primary key
     C           KLCRPA    SETLL@DZREX2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0739' W0RTN   7
      * Send message 'Tattoo Defect          EX'
     C                     MOVEL'PRK0739' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO PAEXIT
     C                     ENDIF
      *
     C                     WRITE@DZREX2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         PAEXIT    ENDSR
      /EJECT
     CSR         PBRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Class  RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSPB     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELWOBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSPB     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WOB7SS           DF Classificati
     C                     GOTO PBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7RYST    WOB7SS           DF Classificati
     C                     ENDIF
      *================================================================
     CSR         PBEXIT    ENDSR
      /EJECT
     CSR         PCCRRC    BEGSR
      *================================================================
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0149  1        TDF Classificat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DZREX2
     C                     Z-ADDP1HMNB    WOHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WOBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WOB0DT           TH Kill Date
     C                     MOVEL#DG2CD    WOBDCD           DF Defect Code
     C                     Z-ADD#DFXNB    WOLJNB           TDF Head Defect
     C                     MOVEL#1BECD    WOBECD           HC Class Code
     C                     MOVEL*BLANK    WOB8SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOB9SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOCASS           TDF Unused Sts
     C                     Z-ADD*ZERO     WONXA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONYA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONZA1           TDF Unused Nbr
     C                     MOVEL*BLANK    WOAAVN           RS User Changed
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     MOVELWUAJST    WOAJST           RS Record Statu
     C                     MOVEL*BLANK    WOAHVN           RS Job
     C                     MOVEL*BLANK    WOAGVN           RS Program
     C                     MOVEL*BLANK    WOABVN           RS User Added
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Hog Defect Class  RT - Hog Defect  * 
     C                     EXSR PDRVGN
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WOAJST           RS Record Statu
     C                     MOVEL##USR     WOABVN           RS User Added
     C                     Z-ADD##JDT     WOABDT           RS Date Added
     C                     Z-ADD##JTM     WOABTM           RS Time Added
     C                     MOVEL##PGM     WOAGVN           RS Program
     C                     MOVEL##JOB     WOAHVN           RS Job
     C           KLCRPC    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOBDCD           DF Defect Code
      * Check for duplicate primary key
     C           KLCRPC    SETLL@DZREX2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0739' W0RTN   7
      * Send message 'Tattoo Defect          EX'
     C                     MOVEL'PRK0739' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO PCEXIT
     C                     ENDIF
      *
     C                     WRITE@DZREX2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         PCEXIT    ENDSR
      /EJECT
     CSR         PDRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Class  RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSPD     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELWOBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSPD     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WOB7SS           DF Classificati
     C                     GOTO PDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7RYST    WOB7SS           DF Classificati
     C                     ENDIF
      *================================================================
     CSR         PDEXIT    ENDSR
      /EJECT
     CSR         PECRRC    BEGSR
      *================================================================
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0150  1        TDF Classificat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DZREX2
     C                     Z-ADDP1HMNB    WOHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WOBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WOB0DT           TH Kill Date
     C                     MOVEL#DG3CD    WOBDCD           DF Defect Code
     C                     Z-ADD#DFTNB    WOLJNB           TDF Head Defect
     C                     MOVEL#1BECD    WOBECD           HC Class Code
     C                     MOVEL*BLANK    WOB8SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOB9SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOCASS           TDF Unused Sts
     C                     Z-ADD*ZERO     WONXA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONYA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONZA1           TDF Unused Nbr
     C                     MOVEL*BLANK    WOAAVN           RS User Changed
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     MOVELWUAJST    WOAJST           RS Record Statu
     C                     MOVEL*BLANK    WOAHVN           RS Job
     C                     MOVEL*BLANK    WOAGVN           RS Program
     C                     MOVEL*BLANK    WOABVN           RS User Added
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Hog Defect Class  RT - Hog Defect  * 
     C                     EXSR PFRVGN
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WOAJST           RS Record Statu
     C                     MOVEL##USR     WOABVN           RS User Added
     C                     Z-ADD##JDT     WOABDT           RS Date Added
     C                     Z-ADD##JTM     WOABTM           RS Time Added
     C                     MOVEL##PGM     WOAGVN           RS Program
     C                     MOVEL##JOB     WOAHVN           RS Job
     C           KLCRPE    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOBDCD           DF Defect Code
      * Check for duplicate primary key
     C           KLCRPE    SETLL@DZREX2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0739' W0RTN   7
      * Send message 'Tattoo Defect          EX'
     C                     MOVEL'PRK0739' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO PEEXIT
     C                     ENDIF
      *
     C                     WRITE@DZREX2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         PEEXIT    ENDSR
      /EJECT
     CSR         PFRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Class  RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSPF     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELWOBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSPF     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WOB7SS           DF Classificati
     C                     GOTO PFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7RYST    WOB7SS           DF Classificati
     C                     ENDIF
      *================================================================
     CSR         PFEXIT    ENDSR
      /EJECT
     CSR         PGRVGN    BEGSR
      *================================================================
      * Rtv Chg Movemnt/Group RT - Delivery Tracking  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHMNB    WQPG01           BOH Company Num
     C           *LIKE     DEFN WBBNNB    WQPG02           BOH Buy Order N
     C           *LIKE     DEFN WBBONB    WQPG03           BOL Load Number
      * Define keylist
     C           KRSPG     KLIST
     C                     KFLD           WQPG01           BOH Company Num
     C                     KFLD           WQPG02           BOH Buy Order N
     C                     KFLD           WQPG03           BOL Load Number
      * Setup key
     C                     Z-ADDP1HMNB    WQPG01           BOH Company Num
     C                     Z-ADDP1BNNB    WQPG02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQPG03           BOL Load Number
      * Establish starting position
     C           KRSPG     SETLL@AFCPI4                    *
     C           KRSPG     READE@AFCPI4                  90*
      * Data record not found
     C   90                MOVEL'PRK1030' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Movement/Group    CH - Delivery Tracking  * 
     C                     EXSR PHCHRC
     C           KRSPG     READE@AFCPI4                  90*
     C                     ENDDO
      *================================================================
     CSR         PGEXIT    ENDSR
      /EJECT
     CSR         PHCHRC    BEGSR
      *================================================================
      * Chg Movement/Group    CH - Delivery Tracking  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0151  70       DT Actual Kill
     C                     Z-ADD*ZERO     WN0152  20       DT Actual Deliv
     C                     Z-ADD*ZERO     WN0153  20       DT Scheduled Ho
     C                     MOVEL*BLANK    WN0154  1        DT Delivery Ini
     C                     Z-ADD*ZERO     WN0155  50       DT Farm Site Co
     C                     MOVEL*BLANK    WN0156  5        DT Building
     C                     MOVEL*BLANK    WN0157  5        DT Room
     C                     MOVEL*BLANK    WN0158  5        DT Sire Line Co
     C                     Z-ADD*ZERO     WN0159  30       DT Delivered He
     C                     Z-ADD*ZERO     WN0160  71       DT Delivered We
     C                     MOVEL*BLANK    WN0161  5        DT Trucker Code
     C                     MOVEL*BLANK    WN0162  5        DT Driver
     C                     MOVEL*BLANK    WN0163  5        DT Loading Crew
     C                     MOVEL*BLANK    WN0164  6        CHR Code
     C                     MOVEL*BLANK    WN0165  2        DT Load Type
     C                     MOVEL*BLANK    WN0166  1        DT Full/Split L
     C                     MOVEL*BLANK    WN0167 15        DT Truck ID
     C                     MOVEL*BLANK    WN0168 15        DT Trailer ID
     C                     MOVEL*BLANK    WN0169  5        DT Transportati
     C                     Z-ADD*ZERO     WN0170  70       DT Transprtn Of
     C                     Z-ADD*ZERO     WN0171  40       DT Transprtn Of
     C                     Z-ADD*ZERO     WN0172  40       DT Arrive@Frm v
     C                     MOVEL*BLANK    WN0173  1        DT On-Time Farm
     C                     MOVEL*BLANK    WN0174  1        DT Route Start
     C                     Z-ADD*ZERO     WN0175  70       DT Route Start
     C                     Z-ADD*ZERO     WN0176  40       DT Route Start
     C                     Z-ADD*ZERO     WN0177  40       DT Route Start
     C                     Z-ADD*ZERO     WN0178  40       DT Wait @ Trans
     C                     Z-ADD*ZERO     WN0179  70       DT Arrive @ Far
     C                     Z-ADD*ZERO     WN0180  40       DT Arrive @ Far
     C                     Z-ADD*ZERO     WN0181  40       DT Drive Time T
     C                     Z-ADD*ZERO     WN0182  70       DT Start Loadin
     C                     Z-ADD*ZERO     WN0183  40       DT Start Loadin
     C                     Z-ADD*ZERO     WN0184  40       DT Start Loadin
     C                     Z-ADD*ZERO     WN0185  40       DT Wait @ Farm
     C                     Z-ADD*ZERO     WN0186  70       DT Frm End Load
     C                     Z-ADD*ZERO     WN0187  40       DT Frm End Load
     C                     Z-ADD*ZERO     WN0188  40       DT Load Time
     C                     Z-ADD*ZERO     WN0189  70       DT Leave Farm D
     C                     Z-ADD*ZERO     WN0190  40       DT Leave Farm T
     C                     Z-ADD*ZERO     WN0191  40       DT Wait-Depart
     C                     Z-ADD*ZERO     WN0192  70       DT Plt TrkWsh A
     C                     Z-ADD*ZERO     WN0193  40       DT Plt TrkWsh A
     C                     Z-ADD*ZERO     WN0194  70       DT Arrive @ Pla
     C                     Z-ADD*ZERO     WN0195  40       DT Arrive @ Pla
     C                     Z-ADD*ZERO     WN0196  40       DT Wait @ TrkWs
     C                     Z-ADD*ZERO     WN0197  40       DT Drive Time T
     C                     Z-ADD*ZERO     WN0198  40       DT Delv Time Va
     C                     MOVEL*BLANK    WN0199  1        DT On Time Deli
     C                     MOVEL*BLANK    WN0200  6        Delivery Reason
     C                     Z-ADD*ZERO     WN0201  70       DT TrkScl Weigh
     C                     Z-ADD*ZERO     WN0202  40       DT TrkScl Weigh
     C                     Z-ADD*ZERO     WN0203  40       DT Wait @ TrkSc
     C                     Z-ADD*ZERO     WN0204  70       DT To Recv Dock
     C                     Z-ADD*ZERO     WN0205  40       DT To Recv Dock
     C                     Z-ADD*ZERO     WN0206  40       DT Wait-Rcv Doc
     C                     Z-ADD*ZERO     WN0207  70       DT Start Unload
     C                     Z-ADD*ZERO     WN0208  40       DT Start Unload
     C                     Z-ADD*ZERO     WN0209  40       DT Wait @ Rcv D
     C                     Z-ADD*ZERO     WN0210  70       DT End Unload D
     C                     Z-ADD*ZERO     WN0211  40       DT End Unload T
     C                     Z-ADD*ZERO     WN0212  40       DT Unload Time
     C                     Z-ADD*ZERO     WN0213  40       DT Unload Varia
     C                     Z-ADD*ZERO     WN0214  70       DT TrkScl Weigh
     C                     Z-ADD*ZERO     WN0215  40       DT TrkScl Weigh
     C                     Z-ADD*ZERO     WN0216  40       DT Wait Time @
     C                     Z-ADD*ZERO     WN0217  40       DT Formula Wait
     C                     MOVEL*BLANK    WN0218  1        DT Source Type
     C                     MOVEL*BLANK    WN0219  4        DT Unused Sts
     C                     Z-ADD*ZERO     WN0220  70       DT Unused Date
     C                     Z-ADD*ZERO     WN0221  40       DT Unused Time
     C                     Z-ADD*ZERO     WN0222  40       DT Unused Wait
     C                     Z-ADD*ZERO     WN0223  30       DSD Scheduled D
     C                     Z-ADD*ZERO     WN0224  50       DT Head Receive
     C                     Z-ADD*ZERO     WN0225  71       DT Weight Recei
     C                     Z-ADD*ZERO     WN0226  51       DT Avg Weight R
     C                     Z-ADD*ZERO     WN0227  50       DT Head DOA
     C                     Z-ADD*ZERO     WN0228  71       DT Weight DOA
     C                     Z-ADD*ZERO     WN0229  50       DT Head Yard De
     C                     Z-ADD*ZERO     WN0230  71       DT Weight Yard
     C                     Z-ADD*ZERO     WN0231  50       DT Head Condemn
     C                     Z-ADD*ZERO     WN0232  71       DT Weight Conde
     C                     Z-ADD*ZERO     WN0233  50       DT Head Held Ov
     C                     Z-ADD*ZERO     WN0234  71       DT Weight Held
     C                     Z-ADD*ZERO     WN0235  50       DT Head Killed
     C                     Z-ADD*ZERO     WN0236  71       DT Weight Kille
     C                     Z-ADD*ZERO     WN0237  50       DT Head Market
     C                     Z-ADD*ZERO     WN0238  71       DT Weight Marke
     C                     Z-ADD*ZERO     WN0239  51       DT Avg Weight M
     C                     Z-ADD*ZERO     WN0240  50       DT Head Resale
     C                     Z-ADD*ZERO     WN0241  71       DT Weight Resal
     C                     Z-ADD*ZERO     WN0242  51       DT Avg Weight R
     C                     Z-ADD*ZERO     WN0243  50       DT Head Unused
     C                     Z-ADD*ZERO     WN0244  71       DT Weight Unuse
     C                     Z-ADD*ZERO     WN0245  50       DT Head Unused
     C                     Z-ADD*ZERO     WN0246  71       DT Weight Unuse
     C                     MOVEL*BLANK    WN0247  1        DT Error Sts
     C                     MOVEL*BLANK    WN0248  2        DT Error Reason
     C                     MOVEL*BLANK    WN0249  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0250  6        PL Location Cod
     C                     MOVEL*BLANK    WN0251  3        SR Source Code
     C                     Z-ADD*ZERO     WN0252  30       BOH Company Num
     C                     Z-ADD*ZERO     WN0253  50       BOH Buy Order N
     C                     Z-ADD*ZERO     WN0254  50       BOL Load Number
     C                     MOVEL*BLANK    WN0255 10        RS User Changed
     C                     Z-ADD*ZERO     WN0256  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0257  60       RS Time Changed
     C                     MOVEL*BLANK    WN0258  1        RS Record Statu
     C                     MOVEL*BLANK    WN0259 10        RS Job
     C                     MOVEL*BLANK    WN0260 10        RS Program
     C                     MOVEL*BLANK    WN0261 10        RS User Added
     C                     Z-ADD*ZERO     WN0262  70       RS Date Added
     C                     Z-ADD*ZERO     WN0263  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YJRDC   1
      *
      * Move key fields to @AFCPIC
     C                     Z-ADDWBHONB    WRHONB           CC Company Numb
     C                     Z-ADDWBE0DT    WRE0DT           DSH Kill Date
     C                     Z-ADDWBE9DT    WRE9DT           DT Delivery Dat
     C                     Z-ADDWBAJTH    WRAJTH           DT Delivery Tim
     C                     Z-ADDWBH4A1    WRH4A1           DT Delivery Tim
      *
     C           KLCHPH    KLIST
     C                     KFLD           WRHONB           CC Company Numb
     C                     KFLD           WRE0DT           DSH Kill Date
     C                     KFLD           WRE9DT           DT Delivery Dat
     C                     KFLD           WRAJTH           DT Delivery Tim
     C                     KFLD           WRH4A1           DT Delivery Tim
     C           KLCHPH    CHAIN@AFCPIC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLAFCPL0'MDACP
     C                     MOVEL'@AFCPIC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL011.
     C                     MOVEL'LBL011'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO PHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO PHEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPLAF1    YJRDCS
      * Move non-key fields to @AFCPIC
     C                     MOVEL#1BICD    WRLGCD    P      DT Hog Group Re
     C                     Z-ADD#1OXNB    WRIEA1           DT Movement Num
      *
      * Set PGM.*Record Data Changed flag
     C           QPLAF1    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WRAAVN           RS User Changed
     C                     Z-ADD##JDT     WRAADT           RS Date Changed
     C                     Z-ADD##JTM     WRAMTM           RS Time Changed
     C                     MOVEL##JOB     WRAHVN           RS Job
     C                     MOVEL##PGM     WRAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPLAF1    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YJRDC     IFEQ 'Y'
     C                     UPDAT@AFCPIC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPLAFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         PHEXIT    ENDSR
      /EJECT
     CSR         PICRRC    BEGSR
      *================================================================
      * Crt TatHdrExt WTPrdSitCO - Tattoo Header EXT  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0264 10        RS User Changed
     C                     Z-ADD*ZERO     WN0265  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0266  60       RS Time Changed
     C                     MOVEL*BLANK    WN0267  1        RS Record Statu
     C                     MOVEL*BLANK    WN0268 10        RS Job
     C                     MOVEL*BLANK    WN0269 10        RS Program
     C                     MOVEL*BLANK    WN0270 10        RS User Added
     C                     Z-ADD*ZERO     WN0271  70       RS Date Added
     C                     Z-ADD*ZERO     WN0272  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DNCPUX
     C                     Z-ADDP1HMNB    WSHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WSBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WSBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WSCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WSB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WSI5PR           TH CA Market Pr
     C                     Z-ADD*ZERO     WSJBPR           TH CA Base Mark
     C                     Z-ADD*ZERO     WSI6PR           TH CA Base Mkt
     C                     Z-ADD*ZERO     WSI7PR           TH CA Sort Disc
     C                     Z-ADD*ZERO     WSI8PR           TH CA Yield Gai
     C                     Z-ADD*ZERO     WSI9PR           TH CA Base Carc
     C                     Z-ADD*ZERO     WSJAPR           TH CA Lean Prem
     C                     Z-ADD*ZERO     WSJCPR           TH CA Carcass G
     C                     Z-ADD*ZERO     WSJDPR           TH CA Bse Mkt L
     C                     Z-ADD*ZERO     WSJEPR           TH CA Bse Mkt C
     C                     Z-ADD*ZERO     WSJFPR           TH CA Srt Dsc L
     C                     Z-ADD*ZERO     WSJGPR           TH CA Srt Dsc C
     C                     Z-ADD*ZERO     WSJHPR           TH CA Yld G/L L
     C                     Z-ADD*ZERO     WSJIPR           TH CA Yld G/L C
     C                     Z-ADD*ZERO     WSJJPR           TH CA Crc Val L
     C                     Z-ADD*ZERO     WSJKPR           TH CA Crc Val C
     C                     Z-ADD*ZERO     WSJLPR           TH CA Lean Prm
     C                     Z-ADD*ZERO     WSJMPR           TH CA Lean Prm
     C                     Z-ADD*ZERO     WSJNPR           TH CA Gross Liv
     C                     Z-ADD*ZERO     WSJOPR           TH CA Gross Car
     C                     Z-ADD*ZERO     WSLTBF           TH Min LT Backf
     C                     Z-ADD*ZERO     WSHZPC           TH Min LT LoinE
     C                     Z-ADD*ZERO     WSLTHW           TH Min LT Hot W
     C                     Z-ADD*ZERO     WSH0PC           TH Min LT Lean
     C                     Z-ADD*ZERO     WSGTBF           TH Max GT Backf
     C                     Z-ADD*ZERO     WSH1PC           TH Max GT LoinE
     C                     Z-ADD*ZERO     WSGTHW           TH Max GT Hot W
     C                     Z-ADD*ZERO     WSH2PC           TH Max GT Lean
     C                     Z-ADD*ZERO     WSHLBF           TH Head LT Back
     C                     Z-ADD*ZERO     WSHLLE           TH Head LT Loin
     C                     Z-ADD*ZERO     WSHLHW           TH Head LT Hot
     C                     Z-ADD*ZERO     WSHLLP           TH Head LT Lean
     C                     Z-ADD*ZERO     WSHGBF           TH Head GT Back
     C                     Z-ADD*ZERO     WSHGLE           TH Head GT Loin
     C                     Z-ADD*ZERO     WSHGHW           TH Head GT Hot
     C                     Z-ADD*ZERO     WSHFLP           TH Head GT Lean
     C                     Z-ADDYL0015    WSSNA1           TE Unused Numbe
     C                     Z-ADDYL0016    WSSOA1           TE UnUsed Numbe
     C                     Z-ADDYL0017    WSSPA1           TE Unused Numbe
     C                     MOVELYL0018    WSDGSS           TE Unused Statu
     C                     MOVELYL0019    WSDHSS           TE Unused Statu
     C                     MOVELYL0020    WSDISS           TE Unused Statu
     C                     MOVELP1ABCD    WSABCD           PD Producer Cod
     C                     MOVEL#DNYCD    WSNYCD           PS Site ID
     C                     MOVEL#DOVCD    WSOVCD           Producer Subsid
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WSAJST           RS Record Statu
     C                     MOVEL##USR     WSABVN           RS User Added
     C                     Z-ADD##JDT     WSABDT           RS Date Added
     C                     Z-ADD##JTM     WSABTM           RS Time Added
     C                     MOVEL##PGM     WSAGVN           RS Program
     C                     MOVEL##JOB     WSAHVN           RS Job
     C                     MOVEL*BLANK    WSAAVN           RS User Changed
     C                     Z-ADD*ZERO     WSAADT           RS Date Changed
     C                     Z-ADD*ZERO     WSAMTM           RS Time Changed
     C           KLCRPI    KLIST
     C                     KFLD           WSHMNB           BOH Company Num
     C                     KFLD           WSBNNB           BOH Buy Order N
     C                     KFLD           WSBONB           BOL Load Number
     C                     KFLD           WSCVNB           TH Tattoo Numbe
     C                     KFLD           WSB0DT           TH Kill Date
      * Check for duplicate primary key
     C           KLCRPI    SETLL@DNCPUX                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0638' W0RTN   7
      * Send message 'Tattoo Header EXT      EX'
     C                     MOVEL'PRK0638' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO PIEXIT
     C                     ENDIF
      *
     C                     WRITE@DNCPUX                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         PIEXIT    ENDSR
      /EJECT
     CSR         PJRVGN    BEGSR
      *================================================================
      * Rtv Crt/Chg hd, pen  RT - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSPJ     KLIST
     C                     KFLD           A2HMNB           BOH Company Num
     C                     KFLD           A2BNNB           BOH Buy Order N
     C                     KFLD           A2BONB           BOL Load Number
     C                     KFLD           A2CVNB           TH Tattoo Numbe
     C                     KFLD           A2B0DT           TH Kill Date
     C                     KFLD           A2C2NB           TD Sequence Num
      * Setup key
     C                     Z-ADDP1HMNB    A2HMNB           BOH Company Num
     C                     Z-ADDP1BNNB    A2BNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    A2BONB           BOL Load Number
     C                     Z-ADD#1CVNB    A2CVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    A2B0DT           TH Kill Date
     C                     Z-ADD1         A2C2NB           TD Sequence Num
      * Establish starting position
     C           KRSPJ     CHAIN@A2CPDG              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0063' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Tattoo Dtl Rsl    XF - Tattoo Detail  * 
     C                     CALL 'PKMMXFR'              90  Crt Tattoo Dtl
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0182  30       BOH Company Num
     C                     PARM P1BNNB    WQ0183  50       BOH Buy Order N
     C                     PARM P1BONB    WQ0184  50       BOL Load Number
     C                     PARM P1B0DT    WQ0185  70       TH Kill Date
     C                     PARM *ZERO     WQ0186  51       TD Avg Live Wgt
     C                     PARM *BLANK    WQ0187  1        TD Gen Bal To K
     C                     PARM 'N'       WQ0188  1        TD Recs Created
     C                     PARM 'N'       WQ0189  1        TD User Status
     C                     PARM 'N'       WQ0190  1        TD User Status
     C                     PARM *ZERO     WQ0191  70       TD User Date 1
     C                     PARM *ZERO     WQ0192  70       TD User Date 2
     C                     PARM *ZERO     WQ0193  70       TD Drive Date
     C                     PARM P1HMNB    WQ0194  30       Pen Company Num
     C                     PARM #DCMCD    WQ0195  3        Pen Number
     C                     PARM #1CVNB    WQ0196  50       Tattoo Number N
     C                     PARM *ZERO     WQ0197  71       Live Wgt Tot US
     C                     PARM #DB5NB    WQ0198  70       Head Total USR
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9939  *
     C                     END
     C                     GOTO PJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) A2JEA1' defaulted for 'TD Drive Hour'.
      * Chg Tattoo Detail     CH - Tattoo Detail  * 
     C                     EXSR PKCHRC
     C                     ENDIF
      *================================================================
     CSR         PJEXIT    ENDSR
      /EJECT
     CSR         PKCHRC    BEGSR
      *================================================================
      * Chg Tattoo Detail     CH - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YKRDC   1
      *
      * Move key fields to @A2CPDF
     C                     Z-ADDA2HMNB    WTHMNB           BOH Company Num
     C                     Z-ADDA2BNNB    WTBNNB           BOH Buy Order N
     C                     Z-ADDA2BONB    WTBONB           BOL Load Number
     C                     Z-ADDA2CVNB    WTCVNB           TH Tattoo Numbe
     C                     Z-ADDA2B0DT    WTB0DT           TH Kill Date
     C                     Z-ADDA2C2NB    WTC2NB           TD Sequence Num
      *
     C           KLCHPK    KLIST
     C                     KFLD           WTHMNB           BOH Company Num
     C                     KFLD           WTBNNB           BOH Buy Order N
     C                     KFLD           WTBONB           BOL Load Number
     C                     KFLD           WTCVNB           TH Tattoo Numbe
     C                     KFLD           WTB0DT           TH Kill Date
     C                     KFLD           WTC2NB           TD Sequence Num
     C           KLCHPK    CHAIN@A2CPDF              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA2CPL0'MDACP
     C                     MOVEL'@A2CPDF' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL012.
     C                     MOVEL'LBL012'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO PKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO PKEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA21    YKRDCS
      * Move non-key fields to @A2CPDF
     C                     Z-ADDA2CZNB    WTCZNB           TD Live Wgt
     C                     Z-ADD#DB5NB    WTC0NB           TD Pen Head
     C                     Z-ADDA2D8NB    WTD8NB           TD Yard Dead
     C                     Z-ADDA2H7NB    WTH7NB           TD Held Over
     C                     MOVELA2GGST    WTGGST    P      TD Held Over St
     C                     Z-ADDA2AJTM    WTAJTM           TD Drive Time
     C                     Z-ADDA2JEA1    WTJEA1           TD Drive Hour
     C                     Z-ADDA2B7CD    WTB7CD           TD Drive Card N
     C                     Z-ADDA2D7NB    WTD7NB           TD Avg Live Wgt
     C                     MOVELA2D9ST    WTD9ST    P      TD Gen Bal To K
     C                     MOVELA2E3ST    WTE3ST    P      TD Recs Created
     C                     MOVELA2E4ST    WTE4ST    P      TD User Status
     C                     MOVELA2E5ST    WTE5ST    P      TD User Status
     C                     Z-ADDA2BVDT    WTBVDT           TD User Date 1
     C                     Z-ADDA2BWDT    WTBWDT           TD User Date 2
     C                     Z-ADDA2BXDT    WTBXDT           TD Drive Date
     C                     Z-ADDA2HVNB    WTHVNB           Pen Company Num
     C                     MOVEL#DCMCD    WTCMCD    P      Pen Number
     C                     MOVELA2B9CD    WTB9CD    P      TDP Process Cod
     C                     Z-ADDA2H8NB    WTH8NB           Held Over Pen C
     C                     MOVELA2CYCD    WTCYCD    P      Held Over Pen N
     C                     MOVELA2AAVN    WTAAVN    P      RS User Changed
     C                     Z-ADDA2AADT    WTAADT           RS Date Changed
     C                     Z-ADDA2AMTM    WTAMTM           RS Time Changed
     C                     MOVELA2AJST    WTAJST    P      RS Record Statu
     C                     MOVELA2AHVN    WTAHVN    P      RS Job
     C                     MOVELA2AGVN    WTAGVN    P      RS Program
     C                     MOVELA2ABVN    WTABVN    P      RS User Added
     C                     Z-ADDA2ABDT    WTABDT           RS Date Added
     C                     Z-ADDA2ABTM    WTABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA21    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WTAAVN           RS User Changed
     C                     Z-ADD##JDT     WTAADT           RS Date Changed
     C                     Z-ADD##JTM     WTAMTM           RS Time Changed
     C                     MOVEL##JOB     WTAHVN           RS Job
     C                     MOVEL##PGM     WTAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA21    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YKRDC     IFEQ 'Y'
     C                     UPDAT@A2CPDF                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA2CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         PKEXIT    ENDSR
      /EJECT
     CSR         PLRVGN    BEGSR
      *================================================================
      * Rtv/Chg Bol Hd rcvd   RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSPL     KLIST
     C                     KFLD           AXHMNB           BOH Company Num
     C                     KFLD           AXBNNB           BOH Buy Order N
     C                     KFLD           AXBONB           BOL Load Number
      * Setup key
     C                     Z-ADDP1HMNB    AXHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    AXBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    AXBONB           BOL Load Number
      * Establish starting position
     C           KRSPL     CHAIN@AXCPBX              90    *
      * Data record not found
     C   90                MOVEL'PRK0051' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           AXDHNB    ADD  WUZYNB    WUDHNB           BOL Head Receiv
     C                     ADD  AXDINB    WUDINB           BOL Live Wgt Re
      * Calculate freight based on the unit of measure
     C                     Z-ADDAXATVA    WUATVA           BOL Freight Amt
      * Chk tatto Paid for Bol RT - Tattoo Header  * 
     C                     EXSR PMRVGN
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.BOL Freight Allocation is Freight is Allocated
      *   |- c2    : WRK.Tattoo is paid Usr is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           AXI1ST    IFEQ 'Y'                        *IF
     C           WUNPST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: DB1.BOL Trucker Payment Sts is Paid Trucker
     C           AXCNST    IFEQ 'PT'                       *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Clc Freight Amt       XF - STR Unit of Measure Calc  * 
     C                     CALL 'PKQ5XFR'              90  Clc Freight Amt
     C                     PARM *BLANK    W0RTN   7
     C                     PARM AXHMNB    WQ0199  30       BOH Company Num
     C                     PARM AXBNNB    WQ0200  50       BOH Buy Order N
     C                     PARM AXBONB    WQ0201  50       BOL Load Number
     C                     PARM AXCMST    WQ0202  2        BOL Freight UOM
     C                     PARM AXAGPR    WQ0203  72       BOL Freight Uni
     C           WUATVA    PARM WUATVA    WQ0204  72       BOL Freight Amt
     C                     PARM AXI1ST    WQ0205  1        BOL Freight All
     C                     PARM WUDHNB    WQ0206  70       BOL Head Receiv
     C                     PARM WUDINB    WQ0207  71       BOL Live Wgt Re
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKQ5XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : WRK.BOL Freight Amt is Not Zeros
      *   |- c2    : WRK.BOL Head Received is Greater then Zero
      *   |- c3    : DB1.BOL Trucker Payment Sts is Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUATVA    IFNE *ZERO                      *IF
     C           WUDHNB    IFGT *ZERO                      *IF
     C           AXCNST    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'ST'      WUCNST           BOL Trucker Pay
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELAXCNST    WUCNST           BOL Trucker Pay
     C                     END                             *FI
      * Chg Buy Order Detail  CH - Buy Order Load  * 
     C                     EXSR PNCHRC
     C                     ENDIF
      *================================================================
     CSR         PLEXIT    ENDSR
      /EJECT
     CSR         PMRVGN    BEGSR
      *================================================================
      * Chk tatto Paid for Bol RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUK4PR           Tot Frt Spdb af
     C                     MOVEL'N'       WUNFST           Held Over Recor
     C                     MOVEL'N'       WUNPST           Tattoo is paid
      * Declare restrictor key work fields
     C           *LIKE     DEFN A1HMNB    WQPM01           BOH Company Num
     C           *LIKE     DEFN A1BNNB    WQPM02           BOH Buy Order N
     C           *LIKE     DEFN A1BONB    WQPM03           BOL Load Number
      * Define keylist
     C           KRSPM     KLIST
     C                     KFLD           WQPM01           BOH Company Num
     C                     KFLD           WQPM02           BOH Buy Order N
     C                     KFLD           WQPM03           BOL Load Number
      * Setup key
     C                     Z-ADDAXHMNB    WQPM01           BOH Company Num
     C                     Z-ADDAXBNNB    WQPM02           BOH Buy Order N
     C                     Z-ADDAXBONB    WQPM03           BOL Load Number
      * Establish starting position
     C           KRSPM     SETLL@A1CPC4                    *
     C           KRSPM     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * If one tattoo is paid but freight was spread then accumulate
      * what is paid, for held over respread problem
      * when this probelm goes away, then just flag that there is one pai
      * CASE: DB1.TH Payment Sts is Paid Anything
     C           A1CWST    IFEQ 'PL'                       *IF
     C           A1CWST    OREQ 'PC'
     C           A1CWST    OREQ 'NC'
     C           A1CWST    OREQ 'NL'
      * CHECK IF FREIGHT AMOUNT IS IN RECORD
      * CASE: DB1.TH Freight Amount is Not Zeros
     C           A1CDPR    IFNE *ZERO                      *IF
     C                     MOVEL'Y'       WUNPST           Tattoo is paid
     C                     END                             *FI
     C                     ADD  A1CDPR    WUK4PR           Tot Frt Spdb af
     C                     ELSE
      * CASE: *OTHERWISE
      * CHECK FOR HELD OVER RECORD
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.TH Held Over Record is Yes
      *   |- c2    : DB1.TH Held Over is greater than 0
      *   '-
     C           A1E1ST    IFEQ 'Y'                        *IF
     C           A1H9NB    ORGT *ZERO                      *OR
     C                     MOVEL'Y'       WUNFST           Held Over Recor
     C                     END                             *FI
     C                     END                             *FI
     C           KRSPM     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         PMEXIT    ENDSR
      /EJECT
     CSR         PNCHRC    BEGSR
      *================================================================
      * Chg Buy Order Detail  CH - Buy Order Load  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0273  50       BOL Shipped Hea
     C                     MOVEL*BLANK    WN0274  1        Reported to USD
     C                     MOVEL*BLANK    WN0275  1        BOL MPR Prior D
     C                     MOVEL*BLANK    WN0276  1        BOL Status 4
     C                     MOVEL*BLANK    WN0277  2        BOL Status 5
     C                     MOVEL*BLANK    WN0278  2        BOL Status 6
     C                     MOVEL*BLANK    WN0279  3        BOL Status 7
     C                     Z-ADD*ZERO     WN0280  70       BOL HPS Movemen
     C                     Z-ADD*ZERO     WN0281  70       BOL Head LFT
     C                     Z-ADD*ZERO     WN0282  70       BOL Head EUT/KO
     C                     Z-ADD*ZERO     WN0283  70       BOL Unused Nbr
     C                     Z-ADD*ZERO     WN0284  70       BOL Unused Nbr
     C                     Z-ADD*ZERO     WN0285 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0286 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0287 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0288 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0289 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0290  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0291  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0292  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0293  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0294  70       BOL Unused Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YLRDC   1
      *
      * Move key fields to @AXCPBY
     C                     Z-ADDAXHMNB    WKHMNB           BOH Company Num
     C                     Z-ADDAXBNNB    WKBNNB           BOH Buy Order N
     C                     Z-ADDAXBONB    WKBONB           BOL Load Number
      *
     C           KLCHPN    KLIST
     C                     KFLD           WKHMNB           BOH Company Num
     C                     KFLD           WKBNNB           BOH Buy Order N
     C                     KFLD           WKBONB           BOL Load Number
     C           KLCHPN    CHAIN@AXCPBY              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKAXCPL1'MDACP
     C                     MOVEL'@AXCPBY' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL013.
     C                     MOVEL'LBL013'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO PNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO PNEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKAX1    YLRDCS
      * Move non-key fields to @AXCPBY
     C                     Z-ADDAXCQDT    WKCQDT           BOL Kill Date
     C                     Z-ADDAXABTH    WKABTH           BOL Pln Delv St
     C                     Z-ADDAXACTH    WKACTH           BOL Pln Delv En
     C                     Z-ADDAXBPNB    WKBPNB           BOL Pln Head De
     C                     Z-ADDAXCSNB    WKCSNB           BOL Shipped Wgt
     C                     Z-ADDAXAUDT    WKAUDT           BOL Pln Delv Da
     C                     MOVELAXCMST    WKCMST    P      BOL Freight UOM
     C                     Z-ADDAXAGPR    WKAGPR           BOL Freight Uni
     C                     Z-ADDWUATVA    WKATVA           BOL Freight Amt
     C                     MOVELAXI1ST    WKI1ST    P      BOL Freight All
     C                     Z-ADDWUDHNB    WKDHNB           BOL Head Receiv
     C                     Z-ADDWUDINB    WKDINB           BOL Live Wgt Re
     C                     MOVELWUCNST    WKCNST    P      BOL Trucker Pay
     C                     Z-ADDAXGINB    WKGINB           BOL Trucker Che
     C                     Z-ADDAXBZDT    WKBZDT           BOL Trucker Che
     C                     Z-ADDAXLSNB    WKLSNB           BOL AP Voucher
     C                     MOVELAXF3TX    WKF3TX    P      BOL Trailer
     C                     MOVELAXO8ST    WKO8ST    P      BOL Freight Exp
     C                     MOVELAXO9ST    WKO9ST    P      BOL Scheduled K
     C                     MOVELAXPAST    WKPAST    P      BOL Truck Scale
     C                     MOVELAXBNCD    WKBNCD    P      TRK Trucker Cod
     C                     MOVELAXABCD    WKABCD    P      PD Producer Cod
     C                     MOVELAXAECD    WKAECD    P      PL Location Cod
     C                     MOVELAXAAVN    WKAAVN    P      RS User Changed
     C                     Z-ADDAXAADT    WKAADT           RS Date Changed
     C                     Z-ADDAXAMTM    WKAMTM           RS Time Changed
     C                     MOVELAXAJST    WKAJST    P      RS Record Statu
     C                     MOVELAXAHVN    WKAHVN    P      RS Job
     C                     MOVELAXAGVN    WKAGVN    P      RS Program
     C                     MOVELAXABVN    WKABVN    P      RS User Added
     C                     Z-ADDAXABDT    WKABDT           RS Date Added
     C                     Z-ADDAXABTM    WKABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YLRDCS
     C           YLRDC     ANDNE'N'
     C                     MOVE 'Y'       YLRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WKAAVN           RS User Changed
     C                     Z-ADD##JDT     WKAADT           RS Date Changed
     C                     Z-ADD##JTM     WKAMTM           RS Time Changed
     C                     MOVEL##JOB     WKAHVN           RS Job
     C                     MOVEL##PGM     WKAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YLRDCS
     C           YLRDC     ANDNE'N'
     C                     MOVE 'Y'       YLRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YLRDC     IFEQ 'Y'
     C                     UPDAT@AXCPBY                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKAXCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         PNEXIT    ENDSR
      /EJECT
     CSR         PORVGN    BEGSR
      *================================================================
      * Rtv Dtl hd/Chg Pen    RT - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Set Pen Totals to Zeros - Pen  * 
     C                     EXSR PPRVGN
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHHMNB    WQPO01           BOH Company Num
     C           *LIKE     DEFN WHCMCD    WQPO02           Pen Number
      * Define keylist
     C           KRSPO     KLIST
     C                     KFLD           WQPO01           BOH Company Num
     C                     KFLD           WQPO02           Pen Number
      * Setup key
     C                     Z-ADDP1HMNB    WQPO01           BOH Company Num
     C                     MOVEL#DCMCD    WQPO02           Pen Number
      * Establish starting position
     C           KRSPO     SETLL@A2CPKE                    *
     C           KRSPO     READE@A2CPKE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0063' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL*BLANK    WUAGCD           GN Genetic Code
      * Chg Pen Genetics      CH - Pen  * 
     C                     EXSR PRCHRC
     C                     GOTO POEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv/Chg Pen Totals    RT - Pen  * 
     C                     EXSR PSRVGN
     C           KRSPO     READE@A2CPKE                  90*
     C                     ENDDO
      * USER: Exit processing
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL*BLANK    WUAGCD           GN Genetic Code
      * Rtv Pen GENETICS      RT - Tattoo Detail  * 
     C                     EXSR PURVGN
      * Chg Pen Genetics      CH - Pen  * 
     C                     EXSR PXCHRC
      *================================================================
     CSR         POEXIT    ENDSR
      /EJECT
     CSR         PPRVGN    BEGSR
      *================================================================
      * Set Pen Totals to Zeros - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSPP     KLIST
     C                     KFLD           WIHVNB           Pen Company Num
     C                     KFLD           WICMCD           Pen Number
      * Setup key
     C                     Z-ADDP1HMNB    WIHVNB           Pen Company Num
     C                     MOVEL#DCMCD    WICMCD           Pen Number
      * Establish starting position
     C           KRSPP     CHAIN@A3REDD              90    *
      * Data record not found
     C   90                MOVEL'PRK0065' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Pen               CH - Pen  * 
     C                     EXSR PQCHRC
     C                     ENDIF
      *================================================================
     CSR         PPEXIT    ENDSR
      /EJECT
     CSR         PQCHRC    BEGSR
      *================================================================
      * Chg Pen               CH - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YMRDC   1
      *
      * Move key fields to @A3REDC
     C                     Z-ADDWIHVNB    WJHVNB           Pen Company Num
     C                     MOVELWICMCD    WJCMCD    P      Pen Number
      *
     C           KLCHPQ    KLIST
     C                     KFLD           WJHVNB           Pen Company Num
     C                     KFLD           WJCMCD           Pen Number
     C           KLCHPQ    CHAIN@A3REDC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA3REL0'MDACP
     C                     MOVEL'@A3REDC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL014.
     C                     MOVEL'LBL014'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO PQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO PQEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA31    YMRDCS
      * Move non-key fields to @A3REDC
     C                     MOVELWUCRTX    WJBBTX    P      Pen Description
     C                     Z-ADDWICTNB    WJCTNB           Pen Maximun Cap
     C                     Z-ADD*ZERO     WJD6NB           Pen Current Hea
     C                     Z-ADDWIB6CD    WJB6CD           Pen Current Dri
     C                     MOVELWIDGST    WJDGST    P      Pen Sts
     C                     Z-ADDWIEBNB    WJEBNB           Pen Drive Seque
     C                     MOVELWIFWST    WJFWST    P      Pen Type
     C                     Z-ADDWIHBNB    WJHBNB           Pen Adjustment
     C                     MOVELWUCRTX    WJAGCD    P      GN Genetic Code
     C                     MOVELWIAAVN    WJAAVN    P      RS User Changed
     C                     Z-ADDWIAADT    WJAADT           RS Date Changed
     C                     Z-ADDWIAMTM    WJAMTM           RS Time Changed
     C                     MOVELWIAJST    WJAJST    P      RS Record Statu
     C                     MOVELWIAHVN    WJAHVN    P      RS Job
     C                     MOVELWIAGVN    WJAGVN    P      RS Program
     C                     MOVELWIABVN    WJABVN    P      RS User Added
     C                     Z-ADDWIABDT    WJABDT           RS Date Added
     C                     Z-ADDWIABTM    WJABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YMRDCS
     C           YMRDC     ANDNE'N'
     C                     MOVE 'Y'       YMRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WJAAVN           RS User Changed
     C                     Z-ADD##JDT     WJAADT           RS Date Changed
     C                     Z-ADD##JTM     WJAMTM           RS Time Changed
     C                     MOVEL##JOB     WJAHVN           RS Job
     C                     MOVEL##PGM     WJAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YMRDCS
     C           YMRDC     ANDNE'N'
     C                     MOVE 'Y'       YMRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YMRDC     IFEQ 'Y'
     C                     UPDAT@A3REDC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA3REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         PQEXIT    ENDSR
      /EJECT
     CSR         PRCHRC    BEGSR
      *================================================================
      * Chg Pen Genetics      CH - Pen  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0295  50       Pen Maximun Cap
     C                     Z-ADD*ZERO     WN0296  50       Pen Current Hea
     C                     Z-ADD*ZERO     WN0297  30       Pen Current Dri
     C                     MOVEL*BLANK    WN0298  1        Pen Sts
     C                     Z-ADD*ZERO     WN0299  30       Pen Drive Seque
     C                     MOVEL*BLANK    WN0300  1        Pen Type
     C                     Z-ADD*ZERO     WN0301  50       Pen Adjustment
     C                     MOVEL*BLANK    WN0302 10        RS User Changed
     C                     Z-ADD*ZERO     WN0303  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0304  60       RS Time Changed
     C                     MOVEL*BLANK    WN0305  1        RS Record Statu
     C                     MOVEL*BLANK    WN0306 10        RS Job
     C                     MOVEL*BLANK    WN0307 10        RS Program
     C                     MOVEL*BLANK    WN0308 10        RS User Added
     C                     Z-ADD*ZERO     WN0309  70       RS Date Added
     C                     Z-ADD*ZERO     WN0310  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YNRDC   1
      *
      * Move key fields to @A3REDC
     C                     Z-ADDP1HMNB    WJHVNB           Pen Company Num
     C                     MOVEL#DCMCD    WJCMCD    P      Pen Number
      *
     C           KLCHPR    KLIST
     C                     KFLD           WJHVNB           Pen Company Num
     C                     KFLD           WJCMCD           Pen Number
     C           KLCHPR    CHAIN@A3REDC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA3REL0'MDACP
     C                     MOVEL'@A3REDC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL015.
     C                     MOVEL'LBL015'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO PREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO PREXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA31    YNRDCS
      * Move non-key fields to @A3REDC
     C                     MOVELWUBBTX    WJBBTX    P      Pen Description
     C                     MOVELWUAGCD    WJAGCD    P      GN Genetic Code
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YNRDCS
     C           YNRDC     ANDNE'N'
     C                     MOVE 'Y'       YNRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WJAAVN           RS User Changed
     C                     Z-ADD##JDT     WJAADT           RS Date Changed
     C                     Z-ADD##JTM     WJAMTM           RS Time Changed
     C                     MOVEL##JOB     WJAHVN           RS Job
     C                     MOVEL##PGM     WJAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YNRDCS
     C           YNRDC     ANDNE'N'
     C                     MOVE 'Y'       YNRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YNRDC     IFEQ 'Y'
     C                     UPDAT@A3REDC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA3REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         PREXIT    ENDSR
      /EJECT
     CSR         PSRVGN    BEGSR
      *================================================================
      * Rtv/Chg Pen Totals    RT - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSPS     KLIST
     C                     KFLD           WIHVNB           Pen Company Num
     C                     KFLD           WICMCD           Pen Number
      * Setup key
     C                     Z-ADDWHHMNB    WIHVNB           Pen Company Num
     C                     MOVELWHCMCD    WICMCD           Pen Number
      * Establish starting position
     C           KRSPS     CHAIN@A3REDD              90    *
      * Data record not found
     C   90                MOVEL'PRK0065' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WHC0NB    ADD  WID6NB    WUD6NB           Pen Current Hea
     C                     SUB  WHD8NB    WUD6NB           Pen Current Hea
      * Chg Pen               CH - Pen  * 
     C                     EXSR PTCHRC
     C                     ENDIF
      *================================================================
     CSR         PSEXIT    ENDSR
      /EJECT
     CSR         PTCHRC    BEGSR
      *================================================================
      * Chg Pen               CH - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YORDC   1
      *
      * Move key fields to @A3REDC
     C                     Z-ADDWIHVNB    WJHVNB           Pen Company Num
     C                     MOVELWICMCD    WJCMCD    P      Pen Number
      *
     C           KLCHPT    KLIST
     C                     KFLD           WJHVNB           Pen Company Num
     C                     KFLD           WJCMCD           Pen Number
     C           KLCHPT    CHAIN@A3REDC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA3REL0'MDACP
     C                     MOVEL'@A3REDC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL016.
     C                     MOVEL'LBL016'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO PTEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO PTEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA31    YORDCS
      * Move non-key fields to @A3REDC
     C                     MOVELWIBBTX    WJBBTX    P      Pen Description
     C                     Z-ADDWICTNB    WJCTNB           Pen Maximun Cap
     C                     Z-ADDWUD6NB    WJD6NB           Pen Current Hea
     C                     Z-ADDWIB6CD    WJB6CD           Pen Current Dri
     C                     MOVELWIDGST    WJDGST    P      Pen Sts
     C                     Z-ADDWIEBNB    WJEBNB           Pen Drive Seque
     C                     MOVELWIFWST    WJFWST    P      Pen Type
     C                     Z-ADDWIHBNB    WJHBNB           Pen Adjustment
     C                     MOVELWIAGCD    WJAGCD    P      GN Genetic Code
     C                     MOVELWIAAVN    WJAAVN    P      RS User Changed
     C                     Z-ADDWIAADT    WJAADT           RS Date Changed
     C                     Z-ADDWIAMTM    WJAMTM           RS Time Changed
     C                     MOVELWIAJST    WJAJST    P      RS Record Statu
     C                     MOVELWIAHVN    WJAHVN    P      RS Job
     C                     MOVELWIAGVN    WJAGVN    P      RS Program
     C                     MOVELWIABVN    WJABVN    P      RS User Added
     C                     Z-ADDWIABDT    WJABDT           RS Date Added
     C                     Z-ADDWIABTM    WJABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YORDCS
     C           YORDC     ANDNE'N'
     C                     MOVE 'Y'       YORDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WJAAVN           RS User Changed
     C                     Z-ADD##JDT     WJAADT           RS Date Changed
     C                     Z-ADD##JTM     WJAMTM           RS Time Changed
     C                     MOVEL##JOB     WJAHVN           RS Job
     C                     MOVEL##PGM     WJAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YORDCS
     C           YORDC     ANDNE'N'
     C                     MOVE 'Y'       YORDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YORDC     IFEQ 'Y'
     C                     UPDAT@A3REDC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA3REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         PTEXIT    ENDSR
      /EJECT
     CSR         PURVGN    BEGSR
      *================================================================
      * Rtv Pen GENETICS      RT - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHHMNB    WQPU01           BOH Company Num
     C           *LIKE     DEFN WHCMCD    WQPU02           Pen Number
      * Define keylist
     C           KRSPU     KLIST
     C                     KFLD           WQPU01           BOH Company Num
     C                     KFLD           WQPU02           Pen Number
      * Setup key
     C                     Z-ADDWHHMNB    WQPU01           BOH Company Num
     C                     MOVELWHCMCD    WQPU02           Pen Number
      * Establish starting position
     C           KRSPU     SETLL@A2CPKE                    *
     C           KRSPU     READE@A2CPKE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0063' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL*BLANK    WUAGCD           GN Genetic Code
     C                     GOTO PUEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.TDP Process Code is Drive Card Printed
      *   |- c2    : DB1.TDP Process Code is Open
      *   '-
     C           WHB9CD    IFEQ 'D'                        *IF
     C           WHB9CD    OREQ 'O'                        *OR
      * Rtv Tattoo GENETICS - Tattoo Header  * 
     C                     EXSR PVRVGN
      * CASE: PAR.GN Genetic Code is BLANKS
     C           WUAGCD    IFEQ *BLANK                     *IF
     C                     MOVELWUA1CD    WUAGCD           GN Genetic Code
     C                     MOVELWUJTTX    WUBBTX           Pen Description
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.Genetic Code USR NE PAR.GN Genetic Code
     C           WUA1CD    IFNE WUAGCD                     *IF
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL'MIXED'   WUBBTX           Pen Description
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSPU     READE@A2CPKE                  90*
     C                     ENDDO
      *================================================================
     CSR         PUEXIT    ENDSR
      /EJECT
     CSR         PVRVGN    BEGSR
      *================================================================
      * Rtv Tattoo GENETICS - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN A1HMNB    WQPV01           BOH Company Num
     C           *LIKE     DEFN A1BNNB    WQPV02           BOH Buy Order N
     C           *LIKE     DEFN A1BONB    WQPV03           BOL Load Number
     C           *LIKE     DEFN A1CVNB    WQPV04           TH Tattoo Numbe
      * Define keylist
     C           KRSPV     KLIST
     C                     KFLD           WQPV01           BOH Company Num
     C                     KFLD           WQPV02           BOH Buy Order N
     C                     KFLD           WQPV03           BOL Load Number
     C                     KFLD           WQPV04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWHHMNB    WQPV01           BOH Company Num
     C                     Z-ADDWHBNNB    WQPV02           BOH Buy Order N
     C                     Z-ADDWHBONB    WQPV03           BOL Load Number
     C                     Z-ADDWHCVNB    WQPV04           TH Tattoo Numbe
      * Establish starting position
     C           KRSPV     SETLL@A1CPC4                    *
     C           KRSPV     READE@A1CPC4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUA1CD           GN Genetic Code
     C                     MOVEL*BLANK    WUJTTX           Pen Description
     C                     GOTO PVEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVELA1AGCD    WUA1CD           GN Genetic Code
      * Rtv Genetic Record    RT - Genetic  * 
     C                     EXSR PWRVGN
     C           KRSPV     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         PVEXIT    ENDSR
      /EJECT
     CSR         PWRVGN    BEGSR
      *================================================================
      * Rtv Genetic Record    RT - Genetic  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSPW     KLIST
     C                     KFLD           AIAGCD           GN Genetic Code
      * Setup key
     C                     MOVELA1AGCD    AIAGCD           GN Genetic Code
      * Establish starting position
     C           KRSPW     CHAIN@AIREA9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0021' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUJTTX           GN Description
     C                     GOTO PWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAIAWTX    WUJTTX           GN Description
     C                     ENDIF
      *================================================================
     CSR         PWEXIT    ENDSR
      /EJECT
     CSR         PXCHRC    BEGSR
      *================================================================
      * Chg Pen Genetics      CH - Pen  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0311  50       Pen Maximun Cap
     C                     Z-ADD*ZERO     WN0312  50       Pen Current Hea
     C                     Z-ADD*ZERO     WN0313  30       Pen Current Dri
     C                     MOVEL*BLANK    WN0314  1        Pen Sts
     C                     Z-ADD*ZERO     WN0315  30       Pen Drive Seque
     C                     MOVEL*BLANK    WN0316  1        Pen Type
     C                     Z-ADD*ZERO     WN0317  50       Pen Adjustment
     C                     MOVEL*BLANK    WN0318 10        RS User Changed
     C                     Z-ADD*ZERO     WN0319  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0320  60       RS Time Changed
     C                     MOVEL*BLANK    WN0321  1        RS Record Statu
     C                     MOVEL*BLANK    WN0322 10        RS Job
     C                     MOVEL*BLANK    WN0323 10        RS Program
     C                     MOVEL*BLANK    WN0324 10        RS User Added
     C                     Z-ADD*ZERO     WN0325  70       RS Date Added
     C                     Z-ADD*ZERO     WN0326  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YPRDC   1
      *
      * Move key fields to @A3REDC
     C                     Z-ADDP1HMNB    WJHVNB           Pen Company Num
     C                     MOVEL#DCMCD    WJCMCD    P      Pen Number
      *
     C           KLCHPX    KLIST
     C                     KFLD           WJHVNB           Pen Company Num
     C                     KFLD           WJCMCD           Pen Number
     C           KLCHPX    CHAIN@A3REDC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA3REL0'MDACP
     C                     MOVEL'@A3REDC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL017.
     C                     MOVEL'LBL017'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO PXEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO PXEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA31    YPRDCS
      * Move non-key fields to @A3REDC
     C                     MOVELWUBBTX    WJBBTX    P      Pen Description
     C                     MOVELWUAGCD    WJAGCD    P      GN Genetic Code
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YPRDCS
     C           YPRDC     ANDNE'N'
     C                     MOVE 'Y'       YPRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WJAAVN           RS User Changed
     C                     Z-ADD##JDT     WJAADT           RS Date Changed
     C                     Z-ADD##JTM     WJAMTM           RS Time Changed
     C                     MOVEL##JOB     WJAHVN           RS Job
     C                     MOVEL##PGM     WJAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YPRDCS
     C           YPRDC     ANDNE'N'
     C                     MOVE 'Y'       YPRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YPRDC     IFEQ 'Y'
     C                     UPDAT@A3REDC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA3REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         PXEXIT    ENDSR
      /EJECT
     CSR         PYRVGN    BEGSR
      *================================================================
      * Rtv Dtl hd/Chg Pen    RT - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Set Pen Totals to Zeros - Pen  * 
     C                     EXSR PZRVGN
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHHMNB    WQPY01           BOH Company Num
     C           *LIKE     DEFN WHCMCD    WQPY02           Pen Number
      * Define keylist
     C           KRSPY     KLIST
     C                     KFLD           WQPY01           BOH Company Num
     C                     KFLD           WQPY02           Pen Number
      * Setup key
     C                     Z-ADDP1HMNB    WQPY01           BOH Company Num
     C                     MOVELWUCBCD    WQPY02           Pen Number
      * Establish starting position
     C           KRSPY     SETLL@A2CPKE                    *
     C           KRSPY     READE@A2CPKE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0063' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL*BLANK    WUAGCD           GN Genetic Code
      * Chg Pen Genetics      CH - Pen  * 
     C                     EXSR QBCHRC
     C                     GOTO PYEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv/Chg Pen Totals    RT - Pen  * 
     C                     EXSR QCRVGN
     C           KRSPY     READE@A2CPKE                  90*
     C                     ENDDO
      * USER: Exit processing
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL*BLANK    WUAGCD           GN Genetic Code
      * Rtv Pen GENETICS      RT - Tattoo Detail  * 
     C                     EXSR QERVGN
      * Chg Pen Genetics      CH - Pen  * 
     C                     EXSR QHCHRC
      *================================================================
     CSR         PYEXIT    ENDSR
      /EJECT
     CSR         PZRVGN    BEGSR
      *================================================================
      * Set Pen Totals to Zeros - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSPZ     KLIST
     C                     KFLD           WIHVNB           Pen Company Num
     C                     KFLD           WICMCD           Pen Number
      * Setup key
     C                     Z-ADDP1HMNB    WIHVNB           Pen Company Num
     C                     MOVELWUCBCD    WICMCD           Pen Number
      * Establish starting position
     C           KRSPZ     CHAIN@A3REDD              90    *
      * Data record not found
     C   90                MOVEL'PRK0065' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Pen               CH - Pen  * 
     C                     EXSR QACHRC
     C                     ENDIF
      *================================================================
     CSR         PZEXIT    ENDSR
      /EJECT
     CSR         QACHRC    BEGSR
      *================================================================
      * Chg Pen               CH - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YQRDC   1
      *
      * Move key fields to @A3REDC
     C                     Z-ADDWIHVNB    WJHVNB           Pen Company Num
     C                     MOVELWICMCD    WJCMCD    P      Pen Number
      *
     C           KLCHQA    KLIST
     C                     KFLD           WJHVNB           Pen Company Num
     C                     KFLD           WJCMCD           Pen Number
     C           KLCHQA    CHAIN@A3REDC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA3REL0'MDACP
     C                     MOVEL'@A3REDC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL018.
     C                     MOVEL'LBL018'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO QAEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO QAEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA31    YQRDCS
      * Move non-key fields to @A3REDC
     C                     MOVELWUCRTX    WJBBTX    P      Pen Description
     C                     Z-ADDWICTNB    WJCTNB           Pen Maximun Cap
     C                     Z-ADD*ZERO     WJD6NB           Pen Current Hea
     C                     Z-ADDWIB6CD    WJB6CD           Pen Current Dri
     C                     MOVELWIDGST    WJDGST    P      Pen Sts
     C                     Z-ADDWIEBNB    WJEBNB           Pen Drive Seque
     C                     MOVELWIFWST    WJFWST    P      Pen Type
     C                     Z-ADDWIHBNB    WJHBNB           Pen Adjustment
     C                     MOVELWUCRTX    WJAGCD    P      GN Genetic Code
     C                     MOVELWIAAVN    WJAAVN    P      RS User Changed
     C                     Z-ADDWIAADT    WJAADT           RS Date Changed
     C                     Z-ADDWIAMTM    WJAMTM           RS Time Changed
     C                     MOVELWIAJST    WJAJST    P      RS Record Statu
     C                     MOVELWIAHVN    WJAHVN    P      RS Job
     C                     MOVELWIAGVN    WJAGVN    P      RS Program
     C                     MOVELWIABVN    WJABVN    P      RS User Added
     C                     Z-ADDWIABDT    WJABDT           RS Date Added
     C                     Z-ADDWIABTM    WJABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YQRDCS
     C           YQRDC     ANDNE'N'
     C                     MOVE 'Y'       YQRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WJAAVN           RS User Changed
     C                     Z-ADD##JDT     WJAADT           RS Date Changed
     C                     Z-ADD##JTM     WJAMTM           RS Time Changed
     C                     MOVEL##JOB     WJAHVN           RS Job
     C                     MOVEL##PGM     WJAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YQRDCS
     C           YQRDC     ANDNE'N'
     C                     MOVE 'Y'       YQRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YQRDC     IFEQ 'Y'
     C                     UPDAT@A3REDC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA3REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         QAEXIT    ENDSR
      /EJECT
     CSR         QBCHRC    BEGSR
      *================================================================
      * Chg Pen Genetics      CH - Pen  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0327  50       Pen Maximun Cap
     C                     Z-ADD*ZERO     WN0328  50       Pen Current Hea
     C                     Z-ADD*ZERO     WN0329  30       Pen Current Dri
     C                     MOVEL*BLANK    WN0330  1        Pen Sts
     C                     Z-ADD*ZERO     WN0331  30       Pen Drive Seque
     C                     MOVEL*BLANK    WN0332  1        Pen Type
     C                     Z-ADD*ZERO     WN0333  50       Pen Adjustment
     C                     MOVEL*BLANK    WN0334 10        RS User Changed
     C                     Z-ADD*ZERO     WN0335  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0336  60       RS Time Changed
     C                     MOVEL*BLANK    WN0337  1        RS Record Statu
     C                     MOVEL*BLANK    WN0338 10        RS Job
     C                     MOVEL*BLANK    WN0339 10        RS Program
     C                     MOVEL*BLANK    WN0340 10        RS User Added
     C                     Z-ADD*ZERO     WN0341  70       RS Date Added
     C                     Z-ADD*ZERO     WN0342  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YRRDC   1
      *
      * Move key fields to @A3REDC
     C                     Z-ADDP1HMNB    WJHVNB           Pen Company Num
     C                     MOVELWUCBCD    WJCMCD    P      Pen Number
      *
     C           KLCHQB    KLIST
     C                     KFLD           WJHVNB           Pen Company Num
     C                     KFLD           WJCMCD           Pen Number
     C           KLCHQB    CHAIN@A3REDC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA3REL0'MDACP
     C                     MOVEL'@A3REDC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL019.
     C                     MOVEL'LBL019'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO QBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO QBEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA31    YRRDCS
      * Move non-key fields to @A3REDC
     C                     MOVELWUBBTX    WJBBTX    P      Pen Description
     C                     MOVELWUAGCD    WJAGCD    P      GN Genetic Code
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YRRDCS
     C           YRRDC     ANDNE'N'
     C                     MOVE 'Y'       YRRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WJAAVN           RS User Changed
     C                     Z-ADD##JDT     WJAADT           RS Date Changed
     C                     Z-ADD##JTM     WJAMTM           RS Time Changed
     C                     MOVEL##JOB     WJAHVN           RS Job
     C                     MOVEL##PGM     WJAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YRRDCS
     C           YRRDC     ANDNE'N'
     C                     MOVE 'Y'       YRRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YRRDC     IFEQ 'Y'
     C                     UPDAT@A3REDC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA3REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         QBEXIT    ENDSR
      /EJECT
     CSR         QCRVGN    BEGSR
      *================================================================
      * Rtv/Chg Pen Totals    RT - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSQC     KLIST
     C                     KFLD           WIHVNB           Pen Company Num
     C                     KFLD           WICMCD           Pen Number
      * Setup key
     C                     Z-ADDWHHMNB    WIHVNB           Pen Company Num
     C                     MOVELWHCMCD    WICMCD           Pen Number
      * Establish starting position
     C           KRSQC     CHAIN@A3REDD              90    *
      * Data record not found
     C   90                MOVEL'PRK0065' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WHC0NB    ADD  WID6NB    WUD6NB           Pen Current Hea
     C                     SUB  WHD8NB    WUD6NB           Pen Current Hea
      * Chg Pen               CH - Pen  * 
     C                     EXSR QDCHRC
     C                     ENDIF
      *================================================================
     CSR         QCEXIT    ENDSR
      /EJECT
     CSR         QDCHRC    BEGSR
      *================================================================
      * Chg Pen               CH - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YSRDC   1
      *
      * Move key fields to @A3REDC
     C                     Z-ADDWIHVNB    WJHVNB           Pen Company Num
     C                     MOVELWICMCD    WJCMCD    P      Pen Number
      *
     C           KLCHQD    KLIST
     C                     KFLD           WJHVNB           Pen Company Num
     C                     KFLD           WJCMCD           Pen Number
     C           KLCHQD    CHAIN@A3REDC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA3REL0'MDACP
     C                     MOVEL'@A3REDC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL020.
     C                     MOVEL'LBL020'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO QDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO QDEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA31    YSRDCS
      * Move non-key fields to @A3REDC
     C                     MOVELWIBBTX    WJBBTX    P      Pen Description
     C                     Z-ADDWICTNB    WJCTNB           Pen Maximun Cap
     C                     Z-ADDWUD6NB    WJD6NB           Pen Current Hea
     C                     Z-ADDWIB6CD    WJB6CD           Pen Current Dri
     C                     MOVELWIDGST    WJDGST    P      Pen Sts
     C                     Z-ADDWIEBNB    WJEBNB           Pen Drive Seque
     C                     MOVELWIFWST    WJFWST    P      Pen Type
     C                     Z-ADDWIHBNB    WJHBNB           Pen Adjustment
     C                     MOVELWIAGCD    WJAGCD    P      GN Genetic Code
     C                     MOVELWIAAVN    WJAAVN    P      RS User Changed
     C                     Z-ADDWIAADT    WJAADT           RS Date Changed
     C                     Z-ADDWIAMTM    WJAMTM           RS Time Changed
     C                     MOVELWIAJST    WJAJST    P      RS Record Statu
     C                     MOVELWIAHVN    WJAHVN    P      RS Job
     C                     MOVELWIAGVN    WJAGVN    P      RS Program
     C                     MOVELWIABVN    WJABVN    P      RS User Added
     C                     Z-ADDWIABDT    WJABDT           RS Date Added
     C                     Z-ADDWIABTM    WJABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YSRDCS
     C           YSRDC     ANDNE'N'
     C                     MOVE 'Y'       YSRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WJAAVN           RS User Changed
     C                     Z-ADD##JDT     WJAADT           RS Date Changed
     C                     Z-ADD##JTM     WJAMTM           RS Time Changed
     C                     MOVEL##JOB     WJAHVN           RS Job
     C                     MOVEL##PGM     WJAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YSRDCS
     C           YSRDC     ANDNE'N'
     C                     MOVE 'Y'       YSRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YSRDC     IFEQ 'Y'
     C                     UPDAT@A3REDC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA3REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         QDEXIT    ENDSR
      /EJECT
     CSR         QERVGN    BEGSR
      *================================================================
      * Rtv Pen GENETICS      RT - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHHMNB    WQQE01           BOH Company Num
     C           *LIKE     DEFN WHCMCD    WQQE02           Pen Number
      * Define keylist
     C           KRSQE     KLIST
     C                     KFLD           WQQE01           BOH Company Num
     C                     KFLD           WQQE02           Pen Number
      * Setup key
     C                     Z-ADDWHHMNB    WQQE01           BOH Company Num
     C                     MOVELWHCMCD    WQQE02           Pen Number
      * Establish starting position
     C           KRSQE     SETLL@A2CPKE                    *
     C           KRSQE     READE@A2CPKE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0063' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL*BLANK    WUAGCD           GN Genetic Code
     C                     GOTO QEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.TDP Process Code is Drive Card Printed
      *   |- c2    : DB1.TDP Process Code is Open
      *   '-
     C           WHB9CD    IFEQ 'D'                        *IF
     C           WHB9CD    OREQ 'O'                        *OR
      * Rtv Tattoo GENETICS - Tattoo Header  * 
     C                     EXSR QFRVGN
      * CASE: PAR.GN Genetic Code is BLANKS
     C           WUAGCD    IFEQ *BLANK                     *IF
     C                     MOVELWUA1CD    WUAGCD           GN Genetic Code
     C                     MOVELWUJTTX    WUBBTX           Pen Description
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.Genetic Code USR NE PAR.GN Genetic Code
     C           WUA1CD    IFNE WUAGCD                     *IF
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL'MIXED'   WUBBTX           Pen Description
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSQE     READE@A2CPKE                  90*
     C                     ENDDO
      *================================================================
     CSR         QEEXIT    ENDSR
      /EJECT
     CSR         QFRVGN    BEGSR
      *================================================================
      * Rtv Tattoo GENETICS - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN A1HMNB    WQQF01           BOH Company Num
     C           *LIKE     DEFN A1BNNB    WQQF02           BOH Buy Order N
     C           *LIKE     DEFN A1BONB    WQQF03           BOL Load Number
     C           *LIKE     DEFN A1CVNB    WQQF04           TH Tattoo Numbe
      * Define keylist
     C           KRSQF     KLIST
     C                     KFLD           WQQF01           BOH Company Num
     C                     KFLD           WQQF02           BOH Buy Order N
     C                     KFLD           WQQF03           BOL Load Number
     C                     KFLD           WQQF04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWHHMNB    WQQF01           BOH Company Num
     C                     Z-ADDWHBNNB    WQQF02           BOH Buy Order N
     C                     Z-ADDWHBONB    WQQF03           BOL Load Number
     C                     Z-ADDWHCVNB    WQQF04           TH Tattoo Numbe
      * Establish starting position
     C           KRSQF     SETLL@A1CPC4                    *
     C           KRSQF     READE@A1CPC4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUA1CD           GN Genetic Code
     C                     MOVEL*BLANK    WUJTTX           Pen Description
     C                     GOTO QFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVELA1AGCD    WUA1CD           GN Genetic Code
      * Rtv Genetic Record    RT - Genetic  * 
     C                     EXSR QGRVGN
     C           KRSQF     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         QFEXIT    ENDSR
      /EJECT
     CSR         QGRVGN    BEGSR
      *================================================================
      * Rtv Genetic Record    RT - Genetic  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSQG     KLIST
     C                     KFLD           AIAGCD           GN Genetic Code
      * Setup key
     C                     MOVELA1AGCD    AIAGCD           GN Genetic Code
      * Establish starting position
     C           KRSQG     CHAIN@AIREA9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0021' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUJTTX           GN Description
     C                     GOTO QGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAIAWTX    WUJTTX           GN Description
     C                     ENDIF
      *================================================================
     CSR         QGEXIT    ENDSR
      /EJECT
     CSR         QHCHRC    BEGSR
      *================================================================
      * Chg Pen Genetics      CH - Pen  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0343  50       Pen Maximun Cap
     C                     Z-ADD*ZERO     WN0344  50       Pen Current Hea
     C                     Z-ADD*ZERO     WN0345  30       Pen Current Dri
     C                     MOVEL*BLANK    WN0346  1        Pen Sts
     C                     Z-ADD*ZERO     WN0347  30       Pen Drive Seque
     C                     MOVEL*BLANK    WN0348  1        Pen Type
     C                     Z-ADD*ZERO     WN0349  50       Pen Adjustment
     C                     MOVEL*BLANK    WN0350 10        RS User Changed
     C                     Z-ADD*ZERO     WN0351  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0352  60       RS Time Changed
     C                     MOVEL*BLANK    WN0353  1        RS Record Statu
     C                     MOVEL*BLANK    WN0354 10        RS Job
     C                     MOVEL*BLANK    WN0355 10        RS Program
     C                     MOVEL*BLANK    WN0356 10        RS User Added
     C                     Z-ADD*ZERO     WN0357  70       RS Date Added
     C                     Z-ADD*ZERO     WN0358  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YTRDC   1
      *
      * Move key fields to @A3REDC
     C                     Z-ADDP1HMNB    WJHVNB           Pen Company Num
     C                     MOVELWUCBCD    WJCMCD    P      Pen Number
      *
     C           KLCHQH    KLIST
     C                     KFLD           WJHVNB           Pen Company Num
     C                     KFLD           WJCMCD           Pen Number
     C           KLCHQH    CHAIN@A3REDC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA3REL0'MDACP
     C                     MOVEL'@A3REDC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL021.
     C                     MOVEL'LBL021'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO QHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO QHEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA31    YTRDCS
      * Move non-key fields to @A3REDC
     C                     MOVELWUBBTX    WJBBTX    P      Pen Description
     C                     MOVELWUAGCD    WJAGCD    P      GN Genetic Code
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YTRDCS
     C           YTRDC     ANDNE'N'
     C                     MOVE 'Y'       YTRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WJAAVN           RS User Changed
     C                     Z-ADD##JDT     WJAADT           RS Date Changed
     C                     Z-ADD##JTM     WJAMTM           RS Time Changed
     C                     MOVEL##JOB     WJAHVN           RS Job
     C                     MOVEL##PGM     WJAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YTRDCS
     C           YTRDC     ANDNE'N'
     C                     MOVE 'Y'       YTRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YTRDC     IFEQ 'Y'
     C                     UPDAT@A3REDC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA3REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         QHEXIT    ENDSR
      /EJECT
     CSR         QIRVGN    BEGSR
      *================================================================
      * Rtv Chg Movemnt/Group RT - Delivery Tracking  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHMNB    WQQI01           BOH Company Num
     C           *LIKE     DEFN WBBNNB    WQQI02           BOH Buy Order N
     C           *LIKE     DEFN WBBONB    WQQI03           BOL Load Number
      * Define keylist
     C           KRSQI     KLIST
     C                     KFLD           WQQI01           BOH Company Num
     C                     KFLD           WQQI02           BOH Buy Order N
     C                     KFLD           WQQI03           BOL Load Number
      * Setup key
     C                     Z-ADDP1HMNB    WQQI01           BOH Company Num
     C                     Z-ADDP1BNNB    WQQI02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQQI03           BOL Load Number
      * Establish starting position
     C           KRSQI     SETLL@AFCPI4                    *
     C           KRSQI     READE@AFCPI4                  90*
      * Data record not found
     C   90                MOVEL'PRK1030' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Movement/Group    CH - Delivery Tracking  * 
     C                     EXSR QJCHRC
     C           KRSQI     READE@AFCPI4                  90*
     C                     ENDDO
      *================================================================
     CSR         QIEXIT    ENDSR
      /EJECT
     CSR         QJCHRC    BEGSR
      *================================================================
      * Chg Movement/Group    CH - Delivery Tracking  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0359  70       DT Actual Kill
     C                     Z-ADD*ZERO     WN0360  20       DT Actual Deliv
     C                     Z-ADD*ZERO     WN0361  20       DT Scheduled Ho
     C                     MOVEL*BLANK    WN0362  1        DT Delivery Ini
     C                     Z-ADD*ZERO     WN0363  50       DT Farm Site Co
     C                     MOVEL*BLANK    WN0364  5        DT Building
     C                     MOVEL*BLANK    WN0365  5        DT Room
     C                     MOVEL*BLANK    WN0366  5        DT Sire Line Co
     C                     Z-ADD*ZERO     WN0367  30       DT Delivered He
     C                     Z-ADD*ZERO     WN0368  71       DT Delivered We
     C                     MOVEL*BLANK    WN0369  5        DT Trucker Code
     C                     MOVEL*BLANK    WN0370  5        DT Driver
     C                     MOVEL*BLANK    WN0371  5        DT Loading Crew
     C                     MOVEL*BLANK    WN0372  6        CHR Code
     C                     MOVEL*BLANK    WN0373  2        DT Load Type
     C                     MOVEL*BLANK    WN0374  1        DT Full/Split L
     C                     MOVEL*BLANK    WN0375 15        DT Truck ID
     C                     MOVEL*BLANK    WN0376 15        DT Trailer ID
     C                     MOVEL*BLANK    WN0377  5        DT Transportati
     C                     Z-ADD*ZERO     WN0378  70       DT Transprtn Of
     C                     Z-ADD*ZERO     WN0379  40       DT Transprtn Of
     C                     Z-ADD*ZERO     WN0380  40       DT Arrive@Frm v
     C                     MOVEL*BLANK    WN0381  1        DT On-Time Farm
     C                     MOVEL*BLANK    WN0382  1        DT Route Start
     C                     Z-ADD*ZERO     WN0383  70       DT Route Start
     C                     Z-ADD*ZERO     WN0384  40       DT Route Start
     C                     Z-ADD*ZERO     WN0385  40       DT Route Start
     C                     Z-ADD*ZERO     WN0386  40       DT Wait @ Trans
     C                     Z-ADD*ZERO     WN0387  70       DT Arrive @ Far
     C                     Z-ADD*ZERO     WN0388  40       DT Arrive @ Far
     C                     Z-ADD*ZERO     WN0389  40       DT Drive Time T
     C                     Z-ADD*ZERO     WN0390  70       DT Start Loadin
     C                     Z-ADD*ZERO     WN0391  40       DT Start Loadin
     C                     Z-ADD*ZERO     WN0392  40       DT Start Loadin
     C                     Z-ADD*ZERO     WN0393  40       DT Wait @ Farm
     C                     Z-ADD*ZERO     WN0394  70       DT Frm End Load
     C                     Z-ADD*ZERO     WN0395  40       DT Frm End Load
     C                     Z-ADD*ZERO     WN0396  40       DT Load Time
     C                     Z-ADD*ZERO     WN0397  70       DT Leave Farm D
     C                     Z-ADD*ZERO     WN0398  40       DT Leave Farm T
     C                     Z-ADD*ZERO     WN0399  40       DT Wait-Depart
     C                     Z-ADD*ZERO     WN0400  70       DT Plt TrkWsh A
     C                     Z-ADD*ZERO     WN0401  40       DT Plt TrkWsh A
     C                     Z-ADD*ZERO     WN0402  70       DT Arrive @ Pla
     C                     Z-ADD*ZERO     WN0403  40       DT Arrive @ Pla
     C                     Z-ADD*ZERO     WN0404  40       DT Wait @ TrkWs
     C                     Z-ADD*ZERO     WN0405  40       DT Drive Time T
     C                     Z-ADD*ZERO     WN0406  40       DT Delv Time Va
     C                     MOVEL*BLANK    WN0407  1        DT On Time Deli
     C                     MOVEL*BLANK    WN0408  6        Delivery Reason
     C                     Z-ADD*ZERO     WN0409  70       DT TrkScl Weigh
     C                     Z-ADD*ZERO     WN0410  40       DT TrkScl Weigh
     C                     Z-ADD*ZERO     WN0411  40       DT Wait @ TrkSc
     C                     Z-ADD*ZERO     WN0412  70       DT To Recv Dock
     C                     Z-ADD*ZERO     WN0413  40       DT To Recv Dock
     C                     Z-ADD*ZERO     WN0414  40       DT Wait-Rcv Doc
     C                     Z-ADD*ZERO     WN0415  70       DT Start Unload
     C                     Z-ADD*ZERO     WN0416  40       DT Start Unload
     C                     Z-ADD*ZERO     WN0417  40       DT Wait @ Rcv D
     C                     Z-ADD*ZERO     WN0418  70       DT End Unload D
     C                     Z-ADD*ZERO     WN0419  40       DT End Unload T
     C                     Z-ADD*ZERO     WN0420  40       DT Unload Time
     C                     Z-ADD*ZERO     WN0421  40       DT Unload Varia
     C                     Z-ADD*ZERO     WN0422  70       DT TrkScl Weigh
     C                     Z-ADD*ZERO     WN0423  40       DT TrkScl Weigh
     C                     Z-ADD*ZERO     WN0424  40       DT Wait Time @
     C                     Z-ADD*ZERO     WN0425  40       DT Formula Wait
     C                     MOVEL*BLANK    WN0426  1        DT Source Type
     C                     MOVEL*BLANK    WN0427  4        DT Unused Sts
     C                     Z-ADD*ZERO     WN0428  70       DT Unused Date
     C                     Z-ADD*ZERO     WN0429  40       DT Unused Time
     C                     Z-ADD*ZERO     WN0430  40       DT Unused Wait
     C                     Z-ADD*ZERO     WN0431  30       DSD Scheduled D
     C                     Z-ADD*ZERO     WN0432  50       DT Head Receive
     C                     Z-ADD*ZERO     WN0433  71       DT Weight Recei
     C                     Z-ADD*ZERO     WN0434  51       DT Avg Weight R
     C                     Z-ADD*ZERO     WN0435  50       DT Head DOA
     C                     Z-ADD*ZERO     WN0436  71       DT Weight DOA
     C                     Z-ADD*ZERO     WN0437  50       DT Head Yard De
     C                     Z-ADD*ZERO     WN0438  71       DT Weight Yard
     C                     Z-ADD*ZERO     WN0439  50       DT Head Condemn
     C                     Z-ADD*ZERO     WN0440  71       DT Weight Conde
     C                     Z-ADD*ZERO     WN0441  50       DT Head Held Ov
     C                     Z-ADD*ZERO     WN0442  71       DT Weight Held
     C                     Z-ADD*ZERO     WN0443  50       DT Head Killed
     C                     Z-ADD*ZERO     WN0444  71       DT Weight Kille
     C                     Z-ADD*ZERO     WN0445  50       DT Head Market
     C                     Z-ADD*ZERO     WN0446  71       DT Weight Marke
     C                     Z-ADD*ZERO     WN0447  51       DT Avg Weight M
     C                     Z-ADD*ZERO     WN0448  50       DT Head Resale
     C                     Z-ADD*ZERO     WN0449  71       DT Weight Resal
     C                     Z-ADD*ZERO     WN0450  51       DT Avg Weight R
     C                     Z-ADD*ZERO     WN0451  50       DT Head Unused
     C                     Z-ADD*ZERO     WN0452  71       DT Weight Unuse
     C                     Z-ADD*ZERO     WN0453  50       DT Head Unused
     C                     Z-ADD*ZERO     WN0454  71       DT Weight Unuse
     C                     MOVEL*BLANK    WN0455  1        DT Error Sts
     C                     MOVEL*BLANK    WN0456  2        DT Error Reason
     C                     MOVEL*BLANK    WN0457  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0458  6        PL Location Cod
     C                     MOVEL*BLANK    WN0459  3        SR Source Code
     C                     Z-ADD*ZERO     WN0460  30       BOH Company Num
     C                     Z-ADD*ZERO     WN0461  50       BOH Buy Order N
     C                     Z-ADD*ZERO     WN0462  50       BOL Load Number
     C                     MOVEL*BLANK    WN0463 10        RS User Changed
     C                     Z-ADD*ZERO     WN0464  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0465  60       RS Time Changed
     C                     MOVEL*BLANK    WN0466  1        RS Record Statu
     C                     MOVEL*BLANK    WN0467 10        RS Job
     C                     MOVEL*BLANK    WN0468 10        RS Program
     C                     MOVEL*BLANK    WN0469 10        RS User Added
     C                     Z-ADD*ZERO     WN0470  70       RS Date Added
     C                     Z-ADD*ZERO     WN0471  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YURDC   1
      *
      * Move key fields to @AFCPIC
     C                     Z-ADDWBHONB    WRHONB           CC Company Numb
     C                     Z-ADDWBE0DT    WRE0DT           DSH Kill Date
     C                     Z-ADDWBE9DT    WRE9DT           DT Delivery Dat
     C                     Z-ADDWBAJTH    WRAJTH           DT Delivery Tim
     C                     Z-ADDWBH4A1    WRH4A1           DT Delivery Tim
      *
     C           KLCHQJ    KLIST
     C                     KFLD           WRHONB           CC Company Numb
     C                     KFLD           WRE0DT           DSH Kill Date
     C                     KFLD           WRE9DT           DT Delivery Dat
     C                     KFLD           WRAJTH           DT Delivery Tim
     C                     KFLD           WRH4A1           DT Delivery Tim
     C           KLCHQJ    CHAIN@AFCPIC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLAFCPL0'MDACP
     C                     MOVEL'@AFCPIC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL022.
     C                     MOVEL'LBL022'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO QJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO QJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPLAF1    YURDCS
      * Move non-key fields to @AFCPIC
     C                     MOVEL#1BICD    WRLGCD    P      DT Hog Group Re
     C                     Z-ADD#1OXNB    WRIEA1           DT Movement Num
      *
      * Set PGM.*Record Data Changed flag
     C           QPLAF1    IFNE YURDCS
     C           YURDC     ANDNE'N'
     C                     MOVE 'Y'       YURDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WRAAVN           RS User Changed
     C                     Z-ADD##JDT     WRAADT           RS Date Changed
     C                     Z-ADD##JTM     WRAMTM           RS Time Changed
     C                     MOVEL##JOB     WRAHVN           RS Job
     C                     MOVEL##PGM     WRAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPLAF1    IFNE YURDCS
     C           YURDC     ANDNE'N'
     C                     MOVE 'Y'       YURDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YURDC     IFEQ 'Y'
     C                     UPDAT@AFCPIC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPLAFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         QJEXIT    ENDSR
      /EJECT
     CSR         QKCHRC    BEGSR
      *================================================================
      * Chg Tattoo Hdr w/new  CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0472  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0473  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0474  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0475  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0476  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0477  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0478  3        TH PHA Average
     C                     MOVEL*BLANK    WN0479  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0480  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0481  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0482  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0483  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0484  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0485  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0486  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0487  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0488  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0489  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0490  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0491  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0492 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0493 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0494 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0495 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0496  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0497  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0498  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0499  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0500  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0501  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0502  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0503  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0504  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0505  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0506  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0507  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0508  70       TH Unused Date
     C                     MOVEL*BLANK    WN0509  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0510  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0511  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0512  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0513  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0514  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0515  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0516  1        TH Unused Sts 8
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YVRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDP1HMNB    A1HMNB           BOH Company Num
     C                     Z-ADDP1BNNB    A1BNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    A1BONB           BOL Load Number
     C                     Z-ADD#1CVNB    A1CVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    A1B0DT           TH Kill Date
      *
     C           KLCHQK    KLIST
     C                     KFLD           A1HMNB           BOH Company Num
     C                     KFLD           A1BNNB           BOH Buy Order N
     C                     KFLD           A1BONB           BOL Load Number
     C                     KFLD           A1CVNB           TH Tattoo Numbe
     C                     KFLD           A1B0DT           TH Kill Date
     C           KLCHQK    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL023.
     C                     MOVEL'LBL023'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO QKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO QKEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE @1DBRC    YVRDCS
      * USER: Processing after Data read
     C                     Z-ADDA1CXNB    YL0021           TH Dead On Arri
      * Move non-key fields to @A1CPC5
     C                     Z-ADD#1AWDT    A1AWDT           TH Purchase Dat
     C                     MOVEL#1BICD    A1BICD    P      TH Group Refere
     C                     MOVEL#1CPST    A1CPST    P      TH Live Purchas
     C                     Z-ADD#1ACPR    A1ACPR           TH Live Purchas
     C                     Z-ADD#1B9PR    A1B9PR           TH Live Gross A
     C                     Z-ADD#1CAPR    A1CAPR           TH LIve Net Amt
     C                     MOVEL#1C4ST    A1C4ST    P      TH Resale UOM
     C                     Z-ADD#1AIPR    A1AIPR           TH Recalc Live
     C                     Z-ADD#1A6DT    A1A6DT           TH Pricing Date
     C                     MOVEL#1C2ST    A1C2ST    P      TH Resale Sprea
     C                     Z-ADD#1CXNB    A1CXNB           TH Dead On Arri
     C                     Z-ADD#1CWNB    A1CWNB           TH Head Receive
     C                     Z-ADD#1FCNB    A1FCNB           TH Yard Deads
     C                     Z-ADD#1H9NB    A1H9NB           TH Held Over
     C                     Z-ADD#1FDNB    A1FDNB           TH Head Condemn
     C                     Z-ADD#1FENB    A1FENB           TH Head Killed
     C                     Z-ADD#1HENB    A1HENB           TH Head Adds
     C                     Z-ADD#1HFNB    A1HFNB           TH Head Accepte
     C                     Z-ADD#1CYNB    A1CYNB           TH Live Wgt
     C                     Z-ADD#1LRNB    A1LRNB           TH Adj Live Wgt
     C                     Z-ADD#1E0NB    A1E0NB           TH Hot Wgt
     C                     Z-ADD#1A5PC    A1A5PC           TH Tot Loin Eye
     C                     Z-ADD#1FBNB    A1FBNB           TH Tot Backfat
     C                     Z-ADD#1A4PC    A1A4PC           TH Tot Light Re
     C                     Z-ADD#1F7NB    A1F7NB           TH Avg Live Wgt
     C                     Z-ADD#1HDNB    A1HDNB           TH Avg Hot Wgt
     C                     Z-ADD#1F5NB    A1F5NB           TH Avg Light Re
     C                     Z-ADD#1F4NB    A1F4NB           TH Avg Lean Per
     C                     Z-ADD#1F3NB    A1F3NB           TH Avg Loin Eye
     C                     Z-ADD#1F2NB    A1F2NB           TH Avg Backfat
     C                     Z-ADD#1AVPC    A1AVPC           TH Std Yield Pe
     C                     Z-ADD#1AWPC    A1AWPC           TH Actual Yield
     C                     Z-ADD#1CWPC    A1CWPC           TH Adj Actual Y
     C                     Z-ADD#1A8PC    A1A8PC           TH Yield Differ
     C                     Z-ADD#1A7PC    A1A7PC           TH Recalc Live
     C                     Z-ADD#1B8PR    A1B8PR           TH CM Market Pr
     C                     Z-ADD#1AMPR    A1AMPR           TH CM Base Mkt
     C                     Z-ADD#1ANPR    A1ANPR           TH CM Base Mkt
     C                     Z-ADD#1AYVA    A1AYVA           TH CM Sort Disc
     C                     Z-ADD#1AWVA    A1AWVA           TH CM Yield Gai
     C                     Z-ADD#1AOPR    A1AOPR           TH CM Base Carc
     C                     Z-ADD#1AXVA    A1AXVA           TH CM LN AddOn/
     C                     Z-ADD#1APPR    A1APPR           TH CM Carcass G
     C                     Z-ADD#1ASPR    A1ASPR           TH Deduction Am
     C                     Z-ADD#1A4VA    A1A4VA           TH Total Net WO
     C                     Z-ADD#1ATPR    A1ATPR           TH Carcass Net
     C                     Z-ADD#1A5VA    A1A5VA           TH Additions Am
     C                     Z-ADD#1CBPR    A1CBPR           TH Payment Gros
     C                     Z-ADD#1CCPR    A1CCPR           Th Payment Net
     C                     Z-ADD#1LPNB    A1LPNB           TH AP Voucher/D
     C                     Z-ADD#1CDPR    A1CDPR           TH Freight Amou
     C                     Z-ADD#1A7VA    A1A7VA           TH Accrual Amou
     C                     Z-ADD#1A2PR    A1A2PR           TH Fixed Cost A
     C                     MOVEL#1JWST    A1JWST    P      TH Calc Net Sts
     C                     MOVEL#1CWST    A1CWST    P      TH Payment Sts
     C                     MOVEL#1D7ST    A1D7ST    P      TH Header Error
     C                     MOVEL#1D8ST    A1D8ST    P      TH Detail Error
     C                     MOVEL#1DWST    A1DWST    P      TH Kill Balanci
     C                     MOVEL#1D6ST    A1D6ST    P      TH Bal to Kill
     C                     Z-ADD#1GHNB    A1GHNB           TH Commission A
     C                     Z-ADD#1BYDT    A1BYDT           TH Voucher Paym
     C                     MOVEL#1E0ST    A1E0ST    P      TH User Error O
     C                     MOVEL#1E1ST    A1E1ST    P      TH Held Over Re
     C                     MOVEL#1E2ST    A1E2ST    P      TH Sex
     C                     Z-ADD#1BSDT    A1BSDT           TH Held/Ovr Com
     C                     Z-ADD#1BTDT    A1BTDT           TH Commission P
     C                     Z-ADD#1BUDT    A1BUDT           TH Actual Check
     C                     Z-ADD#1HGNB    A1HGNB           TH Shipped Weig
     C                     Z-ADD#1HHNB    A1HHNB           TH Avg Hot Wgt
     C                     Z-ADD#1HINB    A1HINB           TH FFLI
     C                     Z-ADD#1A3PR    A1A3PR           TH Kill Product
     C                     Z-ADD#1A4PR    A1A4PR           TH Cut Product
     C                     Z-ADD#1A6PR    A1A6PR           TH Render Produ
     C                     Z-ADD#1J9NB    A1J9NB           TH Head Exclude
     C                     Z-ADD#1D6PR    A1D6PR           TH CM Bse Mkt L
     C                     Z-ADD#1D7PR    A1D7PR           TH CM Bse Mkt C
     C                     Z-ADD#1D8PR    A1D8PR           TH CM Srt Dsc L
     C                     Z-ADD#1D9PR    A1D9PR           TH CM Srt Dsc C
     C                     Z-ADD#1EAPR    A1EAPR           TH CM Yld G/L L
     C                     Z-ADD#1EBPR    A1EBPR           TH CM Yld G/L C
     C                     Z-ADD#1ECPR    A1ECPR           TH CM Crc Val L
     C                     Z-ADD#1EDPR    A1EDPR           TH CM Crc Val C
     C                     Z-ADD#1EEPR    A1EEPR           TH CM Lean Prem
     C                     Z-ADD#1EFPR    A1EFPR           TH CM Lean Prem
     C                     Z-ADD#1EGPR    A1EGPR           TH CM Gross Liv
     C                     Z-ADD#1EHPR    A1EHPR           TH CM Gross Car
     C                     MOVEL#1KAST    A1KAST    P      TH Source Type
     C                     MOVEL#1J7ST    A1J7ST    P      TH Scale Ticket
     C                     MOVEL#1J9ST    A1J9ST    P      TH Payment Type
     C                     Z-ADD#1OXNB    A1OXNB           TH HPS Movement
     C                     MOVEL#1LKST    A1LKST    P      TH Source Code
     C                     MOVEL#1LLST    A1LLST    P      TH Hog Class Ty
     C                     MOVEL#1J8ST    A1J8ST    P      TH Posted to HP
     C                     MOVEL#1LIST    A1LIST    P      TH Schedule Kil
     C                     MOVEL#1LJST    A1LJST    P      TH Shift Held O
     C                     MOVEL#1NZTX    A1NZTX    P      TH State
     C                     MOVEL#1HJCD    A1HJCD    P      TH Unused Code
     C                     MOVEL#1R4ST    A1R4ST    P      TH Unused Sts 2
     C                     MOVEL#1R5ST    A1R5ST    P      TH Commission S
     C                     MOVEL#1R6ST    A1R6ST    P      TH Paid 2 Week
     C                     MOVEL#1R7ST    A1R7ST    P      TH Unused Sts 1
     C                     Z-ADD#1THWT    A1THWT           TH DOA Weight
     C                     Z-ADD#1T2WT    A1T2WT           TH Avg Lean % E
     C                     Z-ADD#1THHD    A1THHD           TH HPS Farm Sit
     C                     Z-ADD#1T2HD    A1T2HD           TH Shift Held O
     C                     Z-ADD#1OBPR    A1OBPR           TH Sorting Amou
     C                     MOVEL#1BDCD    A1BDCD    P      DF Defect Code
     C                     MOVEL#1CSCD    A1CSCD    P      THP Process Cod
     C                     MOVELP1ABCD    A1ABCD    P      PD Producer Cod
     C                     MOVELP1AECD    A1AECD    P      PL Location Cod
     C                     MOVEL#1ACCD    A1ACCD    P      HB Buyer Code
     C                     MOVEL#1AGCD    A1AGCD    P      GN Genetic Code
     C                     MOVEL#1BECD    A1BECD    P      HC Class Code
     C                     MOVEL#1AAVN    A1AAVN    P      RS User Changed
     C                     Z-ADD#1AADT    A1AADT           RS Date Changed
     C                     Z-ADD#1AMTM    A1AMTM           RS Time Changed
     C                     MOVEL#1AJST    A1AJST    P      RS Record Statu
     C                     MOVEL#1AHVN    A1AHVN    P      RS Job
     C                     MOVEL#1AGVN    A1AGVN    P      RS Program
     C                     MOVEL#1ABVN    A1ABVN    P      RS User Added
     C                     Z-ADD#1ABDT    A1ABDT           RS Date Added
     C                     Z-ADD#1ABTM    A1ABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YVRDCS
     C           YVRDC     ANDNE'N'
     C                     MOVE 'Y'       YVRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     A1AAVN           RS User Changed
     C                     Z-ADD##JDT     A1AADT           RS Date Changed
     C                     Z-ADD##JTM     A1AMTM           RS Time Changed
     C                     MOVEL##JOB     A1AHVN           RS Job
     C                     MOVEL##PGM     A1AGVN           RS Program
      * Chg/Crt Tatto/Spc Flds IF
      * HPE056 Payment Type
      * 1/10/96  HPE056   Allow payment type to be update based on
      *                   what the payment status is at the time this
      *                   tattoo is being updated
      * Function Description:  If there are any fields that need to be
      * Changed/Created during the Change functions or Create function
      * Presently: Payment Type
      * Add this routine to all of the change objects and create object
      * that update the Payment Type
      * CASE: PAR.TH Payment Sts is Live anything
     C           A1CWST    IFEQ 'ML'                       *IF
     C           A1CWST    OREQ 'PL'
     C           A1CWST    OREQ 'NL'
     C           A1CWST    OREQ 'SL'
     C           A1CWST    OREQ 'IL'
     C                     MOVEL'L'       A1J9ST           TH Payment Type
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'C'       A1J9ST           TH Payment Type
     C                     END                             *FI
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YVRDCS
     C           YVRDC     ANDNE'N'
     C                     MOVE 'Y'       YVRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YVRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
      * USER: Processing after Data update
      * CASE: PAR.TH Dead On Arrival NE LCL.TH Dead On Arrival
     C           #1CXNB    IFNE YL0021                     *IF
      * Upd Trk Scl Weigh Sts RT - Buy Order Load  * 
     C                     EXSR QLRVGN
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         QKEXIT    ENDSR
      /EJECT
     CSR         QLRVGN    BEGSR
      *================================================================
      * Upd Trk Scl Weigh Sts RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSQL     KLIST
     C                     KFLD           AXHMNB           BOH Company Num
     C                     KFLD           AXBNNB           BOH Buy Order N
     C                     KFLD           AXBONB           BOL Load Number
      * Setup key
     C                     Z-ADDA1HMNB    AXHMNB           BOH Company Num
     C                     Z-ADDA1BNNB    AXBNNB           BOH Buy Order N
     C                     Z-ADDA1BONB    AXBONB           BOL Load Number
      * Establish starting position
     C           KRSQL     CHAIN@AXCPBX              90    *
      * Data record not found
     C   90                MOVEL'PRK0051' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.BOL Truck Scale Weigh Sts is Respread
      *   |- c2    : DB1.BOL Truck Scale Weigh Sts is Not Spread
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           'R'       IFEQ 'R'                        *IF
     C           AXPAST    IFEQ 'I'                        *IF
     C           AXPAST    OREQ 'N'
     C           AXPAST    OREQ *BLANK
     C           AXPAST    OREQ 'O'
     C           AXPAST    OREQ 'R'
     C           AXPAST    OREQ 'A'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg Trk Scl Weigh Sts CH - Buy Order Load  * 
     C                     EXSR QMCHRC
     C                     END                             *FI
      * CASE: PAR.BOL Truck Scale Weigh Sts is Respread
     C           'R'       IFEQ 'R'                        *IF
      * Upd Hdr/Bal Status    RT - Tattoo Header  * 
     C                     EXSR QNRVGN
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         QLEXIT    ENDSR
      /EJECT
     CSR         QMCHRC    BEGSR
      *================================================================
      * Chg Trk Scl Weigh Sts CH - Buy Order Load  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0517  70       BOL Kill Date
     C                     Z-ADD*ZERO     WN0518  40       BOL Pln Delv St
     C                     Z-ADD*ZERO     WN0519  40       BOL Pln Delv En
     C                     Z-ADD*ZERO     WN0520  50       BOL Pln Head De
     C                     Z-ADD*ZERO     WN0521  71       BOL Shipped Wgt
     C                     Z-ADD*ZERO     WN0522  70       BOL Pln Delv Da
     C                     MOVEL*BLANK    WN0523  2        BOL Freight UOM
     C                     Z-ADD*ZERO     WN0524  72       BOL Freight Uni
     C                     Z-ADD*ZERO     WN0525  72       BOL Freight Amt
     C                     MOVEL*BLANK    WN0526  1        BOL Freight All
     C                     Z-ADD*ZERO     WN0527  70       BOL Head Receiv
     C                     Z-ADD*ZERO     WN0528  71       BOL Live Wgt Re
     C                     MOVEL*BLANK    WN0529  2        BOL Trucker Pay
     C                     Z-ADD*ZERO     WN0530  80       BOL Trucker Che
     C                     Z-ADD*ZERO     WN0531  70       BOL Trucker Che
     C                     Z-ADD*ZERO     WN0532  80       BOL AP Voucher
     C                     MOVEL*BLANK    WN0533 11        BOL Trailer
     C                     MOVEL*BLANK    WN0534  1        BOL Freight Exp
     C                     MOVEL*BLANK    WN0535  1        BOL Scheduled K
     C                     MOVEL*BLANK    WN0536  1        Reported to USD
     C                     MOVEL*BLANK    WN0537  1        BOL MPR Prior D
     C                     MOVEL*BLANK    WN0538  1        BOL Status 4
     C                     MOVEL*BLANK    WN0539  2        BOL Status 5
     C                     MOVEL*BLANK    WN0540  2        BOL Status 6
     C                     MOVEL*BLANK    WN0541  3        BOL Status 7
     C                     Z-ADD*ZERO     WN0542  70       BOL HPS Movemen
     C                     Z-ADD*ZERO     WN0543  70       BOL Head LFT
     C                     Z-ADD*ZERO     WN0544  70       BOL Head EUT/KO
     C                     Z-ADD*ZERO     WN0545  70       BOL Unused Nbr
     C                     Z-ADD*ZERO     WN0546  70       BOL Unused Nbr
     C                     Z-ADD*ZERO     WN0547 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0548 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0549 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0550 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0551 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0552  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0553  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0554  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0555  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0556  70       BOL Unused Date
     C                     MOVEL*BLANK    WN0557  3        TRK Trucker Cod
     C                     MOVEL*BLANK    WN0558  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0559  6        PL Location Cod
     C                     MOVEL*BLANK    WN0560 10        RS User Changed
     C                     Z-ADD*ZERO     WN0561  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0562  60       RS Time Changed
     C                     MOVEL*BLANK    WN0563  1        RS Record Statu
     C                     MOVEL*BLANK    WN0564 10        RS Job
     C                     MOVEL*BLANK    WN0565 10        RS Program
     C                     MOVEL*BLANK    WN0566 10        RS User Added
     C                     Z-ADD*ZERO     WN0567  70       RS Date Added
     C                     Z-ADD*ZERO     WN0568  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YWRDC   1
      *
      * Move key fields to @AXCPBY
     C                     Z-ADDAXHMNB    WKHMNB           BOH Company Num
     C                     Z-ADDAXBNNB    WKBNNB           BOH Buy Order N
     C                     Z-ADDAXBONB    WKBONB           BOL Load Number
      *
     C           KLCHQM    KLIST
     C                     KFLD           WKHMNB           BOH Company Num
     C                     KFLD           WKBNNB           BOH Buy Order N
     C                     KFLD           WKBONB           BOL Load Number
     C           KLCHQM    CHAIN@AXCPBY              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKAXCPL1'MDACP
     C                     MOVEL'@AXCPBY' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL024.
     C                     MOVEL'LBL024'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO QMEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO QMEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKAX1    YWRDCS
      * Move non-key fields to @AXCPBY
     C                     MOVEL'R'       WKPAST    P      BOL Truck Scale
     C                     Z-ADDAXLDSH    WKLDSH           BOL Shipped Hea
      *
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YWRDCS
     C           YWRDC     ANDNE'N'
     C                     MOVE 'Y'       YWRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WKAAVN           RS User Changed
     C                     Z-ADD##JDT     WKAADT           RS Date Changed
     C                     Z-ADD##JTM     WKAMTM           RS Time Changed
     C                     MOVEL##JOB     WKAHVN           RS Job
     C                     MOVEL##PGM     WKAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YWRDCS
     C           YWRDC     ANDNE'N'
     C                     MOVE 'Y'       YWRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YWRDC     IFEQ 'Y'
     C                     UPDAT@AXCPBY                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKAXCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         QMEXIT    ENDSR
      /EJECT
     CSR         QNRVGN    BEGSR
      *================================================================
      * Upd Hdr/Bal Status    RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN A1HMNB    WQQN01           BOH Company Num
     C           *LIKE     DEFN A1BNNB    WQQN02           BOH Buy Order N
     C           *LIKE     DEFN A1BONB    WQQN03           BOL Load Number
      * Define keylist
     C           KRSQN     KLIST
     C                     KFLD           WQQN01           BOH Company Num
     C                     KFLD           WQQN02           BOH Buy Order N
     C                     KFLD           WQQN03           BOL Load Number
      * Setup key
     C                     Z-ADDAXHMNB    WQQN01           BOH Company Num
     C                     Z-ADDAXBNNB    WQQN02           BOH Buy Order N
     C                     Z-ADDAXBONB    WQQN03           BOL Load Number
      * Establish starting position
     C           KRSQN     SETLL@A1CPC4                    *
     C           KRSQN     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.TH Hog Class Type is Not Resale
     C           A1LLST    IFEQ 'M'                        *IF
     C           A1LLST    OREQ 'S'
      * Chg Hdr/Bal Status    CH - Tattoo Header  * 
     C                     EXSR QOCHRC
     C                     END                             *FI
     C           KRSQN     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         QNEXIT    ENDSR
      /EJECT
     CSR         QOCHRC    BEGSR
      *================================================================
      * Chg Hdr/Bal Status    CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0569  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0570 10        TH Group Refere
     C                     MOVEL*BLANK    WN0571  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0572  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0573  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0574  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0575  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0576  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0577  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0578  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0579  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0580  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0581  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0582  50       TH Held Over
     C                     Z-ADD*ZERO     WN0583  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0584  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0585  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0586  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0587  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0588  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0589  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0590  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0591  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0592  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0593  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0594  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0595  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0596  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0597  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0598  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0599  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0600  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0601  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0602  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0603  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0604  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0605  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0606  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0607  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0608  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0609  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0610  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0611  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0612  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0613  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0614  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0615  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0616  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0617  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0618  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0619  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0620  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0621  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0622  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0623  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0624  1        TH Detail Error
     C                     MOVEL*BLANK    WN0625  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0626  80       TH Commission A
     C                     Z-ADD*ZERO     WN0627  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0628  1        TH User Error O
     C                     MOVEL*BLANK    WN0629  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0630  1        TH Sex
     C                     Z-ADD*ZERO     WN0631  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0632  70       TH Commission P
     C                     Z-ADD*ZERO     WN0633  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0634  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0635  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0636  31       TH FFLI
     C                     Z-ADD*ZERO     WN0637  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0638  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0639  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0640  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0641  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0642  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0643  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0644  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0645  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0646  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0647  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0648  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0649  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0650  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0651  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0652  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0653  1        TH Source Type
     C                     MOVEL*BLANK    WN0654  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0655  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0656  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0657  3        TH Source Code
     C                     MOVEL*BLANK    WN0658  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0659  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0660  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0661  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0662  3        TH State
     C                     MOVEL*BLANK    WN0663  3        TH Unused Code
     C                     MOVEL*BLANK    WN0664  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0665  1        TH Commission S
     C                     MOVEL*BLANK    WN0666  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0667  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0668  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0669  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0670  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0671  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0672  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0673  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0674  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0675  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0676  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0677  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0678  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0679  3        TH PHA Average
     C                     MOVEL*BLANK    WN0680  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0681  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0682  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0683  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0684  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0685  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0686  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0687  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0688  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0689  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0690  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0691  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0692  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0693 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0694 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0695 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0696 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0697  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0698  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0699  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0700  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0701  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0702  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0703  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0704  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0705  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0706  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0707  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0708  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0709  70       TH Unused Date
     C                     MOVEL*BLANK    WN0710  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0711  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0712  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0713  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0714  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0715  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0716  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0717  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0718  6        DF Defect Code
     C                     MOVEL*BLANK    WN0719  6        THP Process Cod
     C                     MOVEL*BLANK    WN0720  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0721  6        PL Location Cod
     C                     MOVEL*BLANK    WN0722  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0723  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0724  3        HC Class Code
     C                     MOVEL*BLANK    WN0725 10        RS User Changed
     C                     Z-ADD*ZERO     WN0726  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0727  60       RS Time Changed
     C                     MOVEL*BLANK    WN0728  1        RS Record Statu
     C                     MOVEL*BLANK    WN0729 10        RS Job
     C                     MOVEL*BLANK    WN0730 10        RS Program
     C                     MOVEL*BLANK    WN0731 10        RS User Added
     C                     Z-ADD*ZERO     WN0732  70       RS Date Added
     C                     Z-ADD*ZERO     WN0733  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YXRDC   1
      *
      * Move key fields to @A1CPC5
      *
     C           KLCHQO    KLIST
     C                     KFLD           A1HMNB           BOH Company Num
     C                     KFLD           A1BNNB           BOH Buy Order N
     C                     KFLD           A1BONB           BOL Load Number
     C                     KFLD           A1CVNB           TH Tattoo Numbe
     C                     KFLD           A1B0DT           TH Kill Date
     C           KLCHQO    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL025.
     C                     MOVEL'LBL025'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO QOEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO QOEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE @1DBRC    YXRDCS
      * Move non-key fields to @A1CPC5
     C                     MOVEL'E'       A1D7ST    P      TH Header Error
     C                     MOVEL'E'       A1DWST    P      TH Kill Balanci
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YXRDCS
     C           YXRDC     ANDNE'N'
     C                     MOVE 'Y'       YXRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YXRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         QOEXIT    ENDSR
      /EJECT
     CSR         QPRVGN    BEGSR
      *================================================================
      * Upd Shipped Head      RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSQP     KLIST
     C                     KFLD           AXHMNB           BOH Company Num
     C                     KFLD           AXBNNB           BOH Buy Order N
     C                     KFLD           AXBONB           BOL Load Number
      * Setup key
     C                     Z-ADDP1HMNB    AXHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    AXBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    AXBONB           BOL Load Number
      * Establish starting position
     C           KRSQP     CHAIN@AXCPBX              90    *
      * Data record not found
     C   90                MOVEL'PRK0051' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Shipped Head      CH - Buy Order Load  * 
     C                     EXSR QQCHRC
     C                     ENDIF
      *================================================================
     CSR         QPEXIT    ENDSR
      /EJECT
     CSR         QQCHRC    BEGSR
      *================================================================
      * Chg Shipped Head      CH - Buy Order Load  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0734  70       BOL Kill Date
     C                     Z-ADD*ZERO     WN0735  40       BOL Pln Delv St
     C                     Z-ADD*ZERO     WN0736  40       BOL Pln Delv En
     C                     Z-ADD*ZERO     WN0737  50       BOL Pln Head De
     C                     Z-ADD*ZERO     WN0738  71       BOL Shipped Wgt
     C                     Z-ADD*ZERO     WN0739  70       BOL Pln Delv Da
     C                     MOVEL*BLANK    WN0740  2        BOL Freight UOM
     C                     Z-ADD*ZERO     WN0741  72       BOL Freight Uni
     C                     Z-ADD*ZERO     WN0742  72       BOL Freight Amt
     C                     MOVEL*BLANK    WN0743  1        BOL Freight All
     C                     Z-ADD*ZERO     WN0744  70       BOL Head Receiv
     C                     Z-ADD*ZERO     WN0745  71       BOL Live Wgt Re
     C                     MOVEL*BLANK    WN0746  2        BOL Trucker Pay
     C                     Z-ADD*ZERO     WN0747  80       BOL Trucker Che
     C                     Z-ADD*ZERO     WN0748  70       BOL Trucker Che
     C                     Z-ADD*ZERO     WN0749  80       BOL AP Voucher
     C                     MOVEL*BLANK    WN0750 11        BOL Trailer
     C                     MOVEL*BLANK    WN0751  1        BOL Freight Exp
     C                     MOVEL*BLANK    WN0752  1        BOL Scheduled K
     C                     MOVEL*BLANK    WN0753  1        BOL Truck Scale
     C                     MOVEL*BLANK    WN0754  1        Reported to USD
     C                     MOVEL*BLANK    WN0755  1        BOL MPR Prior D
     C                     MOVEL*BLANK    WN0756  1        BOL Status 4
     C                     MOVEL*BLANK    WN0757  2        BOL Status 5
     C                     MOVEL*BLANK    WN0758  2        BOL Status 6
     C                     MOVEL*BLANK    WN0759  3        BOL Status 7
     C                     Z-ADD*ZERO     WN0760  70       BOL HPS Movemen
     C                     Z-ADD*ZERO     WN0761  70       BOL Head LFT
     C                     Z-ADD*ZERO     WN0762  70       BOL Head EUT/KO
     C                     Z-ADD*ZERO     WN0763  70       BOL Unused Nbr
     C                     Z-ADD*ZERO     WN0764  70       BOL Unused Nbr
     C                     Z-ADD*ZERO     WN0765 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0766 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0767 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0768 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0769 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0770  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0771  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0772  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0773  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0774  70       BOL Unused Date
     C                     MOVEL*BLANK    WN0775  3        TRK Trucker Cod
     C                     MOVEL*BLANK    WN0776  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0777  6        PL Location Cod
     C                     MOVEL*BLANK    WN0778 10        RS User Changed
     C                     Z-ADD*ZERO     WN0779  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0780  60       RS Time Changed
     C                     MOVEL*BLANK    WN0781  1        RS Record Statu
     C                     MOVEL*BLANK    WN0782 10        RS Job
     C                     MOVEL*BLANK    WN0783 10        RS Program
     C                     MOVEL*BLANK    WN0784 10        RS User Added
     C                     Z-ADD*ZERO     WN0785  70       RS Date Added
     C                     Z-ADD*ZERO     WN0786  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YYRDC   1
      *
      * Move key fields to @AXCPBY
     C                     Z-ADDP1HMNB    WKHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WKBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WKBONB           BOL Load Number
      *
     C           KLCHQQ    KLIST
     C                     KFLD           WKHMNB           BOH Company Num
     C                     KFLD           WKBNNB           BOH Buy Order N
     C                     KFLD           WKBONB           BOL Load Number
     C           KLCHQQ    CHAIN@AXCPBY              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKAXCPL1'MDACP
     C                     MOVEL'@AXCPBY' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL026.
     C                     MOVEL'LBL026'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO QQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO QQEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKAX1    YYRDCS
      * Move non-key fields to @AXCPBY
     C                     Z-ADD#DLDSH    WKLDSH           BOL Shipped Hea
      *
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YYRDCS
     C           YYRDC     ANDNE'N'
     C                     MOVE 'Y'       YYRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WKAAVN           RS User Changed
     C                     Z-ADD##JDT     WKAADT           RS Date Changed
     C                     Z-ADD##JTM     WKAMTM           RS Time Changed
     C                     MOVEL##JOB     WKAHVN           RS Job
     C                     MOVEL##PGM     WKAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YYRDCS
     C           YYRDC     ANDNE'N'
     C                     MOVE 'Y'       YYRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YYRDC     IFEQ 'Y'
     C                     UPDAT@AXCPBY                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKAXCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         QQEXIT    ENDSR
      /EJECT
     CSR         QRRVGN    BEGSR
      *================================================================
      * Rtv Del Tattoo Def - Tattoo Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DZHMNB    WQQR01           BOH Company Num
     C           *LIKE     DEFN DZBNNB    WQQR02           BOH Buy Order N
     C           *LIKE     DEFN DZBONB    WQQR03           BOL Load Number
     C           *LIKE     DEFN DZCVNB    WQQR04           TH Tattoo Numbe
     C           *LIKE     DEFN DZB0DT    WQQR05           TH Kill Date
      * Define keylist
     C           KRSQR     KLIST
     C                     KFLD           WQQR01           BOH Company Num
     C                     KFLD           WQQR02           BOH Buy Order N
     C                     KFLD           WQQR03           BOL Load Number
     C                     KFLD           WQQR04           TH Tattoo Numbe
     C                     KFLD           WQQR05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQQR01           BOH Company Num
     C                     Z-ADDP1BNNB    WQQR02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQQR03           BOL Load Number
     C                     Z-ADD#1CVNB    WQQR04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQQR05           TH Kill Date
      * Establish starting position
     C           KRSQR     SETLL@DZREX3                    *
     C           KRSQR     READE@DZREX3                  90*
      * Data record not found
     C   90                MOVEL'PRK0738' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Dlt Tattoo Defect     DO - Tattoo Defect  * 
     C                     EXSR QSDLRC
     C           KRSQR     READE@DZREX3                  90*
     C                     ENDDO
      *================================================================
     CSR         QREXIT    ENDSR
      /EJECT
     CSR         QSDLRC    BEGSR
      *================================================================
      * Dlt Tattoo Defect     DO - Tattoo Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @DZREX2
     C                     Z-ADDDZHMNB    WOHMNB           BOH Company Num
     C                     Z-ADDDZBNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDDZBONB    WOBONB           BOL Load Number
     C                     Z-ADDDZCVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDDZB0DT    WOB0DT           TH Kill Date
     C                     MOVELDZBDCD    WOBDCD           DF Defect Code
      *
     C           KLDLQS    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOBDCD           DF Defect Code
     C           KLDLQS    CHAIN@DZREX2              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDZREL0'MDACP
     C                     MOVEL'@DZREX2' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL027.
     C                     MOVEL'LBL027'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO QSEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO QSEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@DZREX2                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         QSEXIT    ENDSR
      /EJECT
     CSR         QTCRRC    BEGSR
      *================================================================
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0787  1        TDF Classificat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DZREX2
     C                     Z-ADDP1HMNB    WOHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WOBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WOB0DT           TH Kill Date
     C                     MOVEL#DGUCD    WOBDCD           DF Defect Code
     C                     Z-ADD#DF1NB    WOLJNB           TDF Head Defect
     C                     MOVEL#1BECD    WOBECD           HC Class Code
     C                     MOVEL*BLANK    WOB8SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOB9SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOCASS           TDF Unused Sts
     C                     Z-ADD*ZERO     WONXA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONYA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONZA1           TDF Unused Nbr
     C                     MOVEL*BLANK    WOAAVN           RS User Changed
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     MOVELWUAJST    WOAJST           RS Record Statu
     C                     MOVEL*BLANK    WOAHVN           RS Job
     C                     MOVEL*BLANK    WOAGVN           RS Program
     C                     MOVEL*BLANK    WOABVN           RS User Added
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Hog Defect Class  RT - Hog Defect  * 
     C                     EXSR QURVGN
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WOAJST           RS Record Statu
     C                     MOVEL##USR     WOABVN           RS User Added
     C                     Z-ADD##JDT     WOABDT           RS Date Added
     C                     Z-ADD##JTM     WOABTM           RS Time Added
     C                     MOVEL##PGM     WOAGVN           RS Program
     C                     MOVEL##JOB     WOAHVN           RS Job
     C           KLCRQT    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOBDCD           DF Defect Code
      * Check for duplicate primary key
     C           KLCRQT    SETLL@DZREX2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0739' W0RTN   7
      * Send message 'Tattoo Defect          EX'
     C                     MOVEL'PRK0739' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO QTEXIT
     C                     ENDIF
      *
     C                     WRITE@DZREX2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         QTEXIT    ENDSR
      /EJECT
     CSR         QURVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Class  RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSQU     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELWOBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSQU     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WOB7SS           DF Classificati
     C                     GOTO QUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7RYST    WOB7SS           DF Classificati
     C                     ENDIF
      *================================================================
     CSR         QUEXIT    ENDSR
      /EJECT
     CSR         QVCRRC    BEGSR
      *================================================================
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0788  1        TDF Classificat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DZREX2
     C                     Z-ADDP1HMNB    WOHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WOBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WOB0DT           TH Kill Date
     C                     MOVEL#DGVCD    WOBDCD           DF Defect Code
     C                     Z-ADD#DFWNB    WOLJNB           TDF Head Defect
     C                     MOVEL#1BECD    WOBECD           HC Class Code
     C                     MOVEL*BLANK    WOB8SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOB9SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOCASS           TDF Unused Sts
     C                     Z-ADD*ZERO     WONXA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONYA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONZA1           TDF Unused Nbr
     C                     MOVEL*BLANK    WOAAVN           RS User Changed
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     MOVELWUAJST    WOAJST           RS Record Statu
     C                     MOVEL*BLANK    WOAHVN           RS Job
     C                     MOVEL*BLANK    WOAGVN           RS Program
     C                     MOVEL*BLANK    WOABVN           RS User Added
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Hog Defect Class  RT - Hog Defect  * 
     C                     EXSR QWRVGN
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WOAJST           RS Record Statu
     C                     MOVEL##USR     WOABVN           RS User Added
     C                     Z-ADD##JDT     WOABDT           RS Date Added
     C                     Z-ADD##JTM     WOABTM           RS Time Added
     C                     MOVEL##PGM     WOAGVN           RS Program
     C                     MOVEL##JOB     WOAHVN           RS Job
     C           KLCRQV    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOBDCD           DF Defect Code
      * Check for duplicate primary key
     C           KLCRQV    SETLL@DZREX2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0739' W0RTN   7
      * Send message 'Tattoo Defect          EX'
     C                     MOVEL'PRK0739' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO QVEXIT
     C                     ENDIF
      *
     C                     WRITE@DZREX2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         QVEXIT    ENDSR
      /EJECT
     CSR         QWRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Class  RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSQW     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELWOBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSQW     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WOB7SS           DF Classificati
     C                     GOTO QWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7RYST    WOB7SS           DF Classificati
     C                     ENDIF
      *================================================================
     CSR         QWEXIT    ENDSR
      /EJECT
     CSR         QXCRRC    BEGSR
      *================================================================
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0789  1        TDF Classificat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DZREX2
     C                     Z-ADDP1HMNB    WOHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WOBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WOB0DT           TH Kill Date
     C                     MOVEL#DGWCD    WOBDCD           DF Defect Code
     C                     Z-ADD#DFYNB    WOLJNB           TDF Head Defect
     C                     MOVEL#1BECD    WOBECD           HC Class Code
     C                     MOVEL*BLANK    WOB8SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOB9SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOCASS           TDF Unused Sts
     C                     Z-ADD*ZERO     WONXA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONYA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONZA1           TDF Unused Nbr
     C                     MOVEL*BLANK    WOAAVN           RS User Changed
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     MOVELWUAJST    WOAJST           RS Record Statu
     C                     MOVEL*BLANK    WOAHVN           RS Job
     C                     MOVEL*BLANK    WOAGVN           RS Program
     C                     MOVEL*BLANK    WOABVN           RS User Added
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Hog Defect Class  RT - Hog Defect  * 
     C                     EXSR QYRVGN
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WOAJST           RS Record Statu
     C                     MOVEL##USR     WOABVN           RS User Added
     C                     Z-ADD##JDT     WOABDT           RS Date Added
     C                     Z-ADD##JTM     WOABTM           RS Time Added
     C                     MOVEL##PGM     WOAGVN           RS Program
     C                     MOVEL##JOB     WOAHVN           RS Job
     C           KLCRQX    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOBDCD           DF Defect Code
      * Check for duplicate primary key
     C           KLCRQX    SETLL@DZREX2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0739' W0RTN   7
      * Send message 'Tattoo Defect          EX'
     C                     MOVEL'PRK0739' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO QXEXIT
     C                     ENDIF
      *
     C                     WRITE@DZREX2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         QXEXIT    ENDSR
      /EJECT
     CSR         QYRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Class  RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSQY     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELWOBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSQY     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WOB7SS           DF Classificati
     C                     GOTO QYEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7RYST    WOB7SS           DF Classificati
     C                     ENDIF
      *================================================================
     CSR         QYEXIT    ENDSR
      /EJECT
     CSR         QZCRRC    BEGSR
      *================================================================
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0790  1        TDF Classificat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DZREX2
     C                     Z-ADDP1HMNB    WOHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WOBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WOB0DT           TH Kill Date
     C                     MOVEL#DGXCD    WOBDCD           DF Defect Code
     C                     Z-ADD#DFUNB    WOLJNB           TDF Head Defect
     C                     MOVEL#1BECD    WOBECD           HC Class Code
     C                     MOVEL*BLANK    WOB8SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOB9SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOCASS           TDF Unused Sts
     C                     Z-ADD*ZERO     WONXA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONYA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONZA1           TDF Unused Nbr
     C                     MOVEL*BLANK    WOAAVN           RS User Changed
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     MOVELWUAJST    WOAJST           RS Record Statu
     C                     MOVEL*BLANK    WOAHVN           RS Job
     C                     MOVEL*BLANK    WOAGVN           RS Program
     C                     MOVEL*BLANK    WOABVN           RS User Added
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Hog Defect Class  RT - Hog Defect  * 
     C                     EXSR RARVGN
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WOAJST           RS Record Statu
     C                     MOVEL##USR     WOABVN           RS User Added
     C                     Z-ADD##JDT     WOABDT           RS Date Added
     C                     Z-ADD##JTM     WOABTM           RS Time Added
     C                     MOVEL##PGM     WOAGVN           RS Program
     C                     MOVEL##JOB     WOAHVN           RS Job
     C           KLCRQZ    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOBDCD           DF Defect Code
      * Check for duplicate primary key
     C           KLCRQZ    SETLL@DZREX2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0739' W0RTN   7
      * Send message 'Tattoo Defect          EX'
     C                     MOVEL'PRK0739' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO QZEXIT
     C                     ENDIF
      *
     C                     WRITE@DZREX2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         QZEXIT    ENDSR
      /EJECT
     CSR         RARVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Class  RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSRA     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELWOBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSRA     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WOB7SS           DF Classificati
     C                     GOTO RAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7RYST    WOB7SS           DF Classificati
     C                     ENDIF
      *================================================================
     CSR         RAEXIT    ENDSR
      /EJECT
     CSR         RBCRRC    BEGSR
      *================================================================
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0791  1        TDF Classificat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DZREX2
     C                     Z-ADDP1HMNB    WOHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WOBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WOB0DT           TH Kill Date
     C                     MOVEL#DGYCD    WOBDCD           DF Defect Code
     C                     Z-ADD#DO3NB    WOLJNB           TDF Head Defect
     C                     MOVEL#1BECD    WOBECD           HC Class Code
     C                     MOVEL*BLANK    WOB8SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOB9SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOCASS           TDF Unused Sts
     C                     Z-ADD*ZERO     WONXA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONYA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONZA1           TDF Unused Nbr
     C                     MOVEL*BLANK    WOAAVN           RS User Changed
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     MOVELWUAJST    WOAJST           RS Record Statu
     C                     MOVEL*BLANK    WOAHVN           RS Job
     C                     MOVEL*BLANK    WOAGVN           RS Program
     C                     MOVEL*BLANK    WOABVN           RS User Added
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Hog Defect Class  RT - Hog Defect  * 
     C                     EXSR RCRVGN
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WOAJST           RS Record Statu
     C                     MOVEL##USR     WOABVN           RS User Added
     C                     Z-ADD##JDT     WOABDT           RS Date Added
     C                     Z-ADD##JTM     WOABTM           RS Time Added
     C                     MOVEL##PGM     WOAGVN           RS Program
     C                     MOVEL##JOB     WOAHVN           RS Job
     C           KLCRRB    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOBDCD           DF Defect Code
      * Check for duplicate primary key
     C           KLCRRB    SETLL@DZREX2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0739' W0RTN   7
      * Send message 'Tattoo Defect          EX'
     C                     MOVEL'PRK0739' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO RBEXIT
     C                     ENDIF
      *
     C                     WRITE@DZREX2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         RBEXIT    ENDSR
      /EJECT
     CSR         RCRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Class  RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSRC     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELWOBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSRC     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WOB7SS           DF Classificati
     C                     GOTO RCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7RYST    WOB7SS           DF Classificati
     C                     ENDIF
      *================================================================
     CSR         RCEXIT    ENDSR
      /EJECT
     CSR         RDCRRC    BEGSR
      *================================================================
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0792  1        TDF Classificat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DZREX2
     C                     Z-ADDP1HMNB    WOHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WOBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WOB0DT           TH Kill Date
     C                     MOVEL#DGZCD    WOBDCD           DF Defect Code
     C                     Z-ADD#DO4NB    WOLJNB           TDF Head Defect
     C                     MOVEL#1BECD    WOBECD           HC Class Code
     C                     MOVEL*BLANK    WOB8SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOB9SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOCASS           TDF Unused Sts
     C                     Z-ADD*ZERO     WONXA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONYA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONZA1           TDF Unused Nbr
     C                     MOVEL*BLANK    WOAAVN           RS User Changed
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     MOVELWUAJST    WOAJST           RS Record Statu
     C                     MOVEL*BLANK    WOAHVN           RS Job
     C                     MOVEL*BLANK    WOAGVN           RS Program
     C                     MOVEL*BLANK    WOABVN           RS User Added
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Hog Defect Class  RT - Hog Defect  * 
     C                     EXSR RERVGN
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WOAJST           RS Record Statu
     C                     MOVEL##USR     WOABVN           RS User Added
     C                     Z-ADD##JDT     WOABDT           RS Date Added
     C                     Z-ADD##JTM     WOABTM           RS Time Added
     C                     MOVEL##PGM     WOAGVN           RS Program
     C                     MOVEL##JOB     WOAHVN           RS Job
     C           KLCRRD    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOBDCD           DF Defect Code
      * Check for duplicate primary key
     C           KLCRRD    SETLL@DZREX2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0739' W0RTN   7
      * Send message 'Tattoo Defect          EX'
     C                     MOVEL'PRK0739' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO RDEXIT
     C                     ENDIF
      *
     C                     WRITE@DZREX2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         RDEXIT    ENDSR
      /EJECT
     CSR         RERVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Class  RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSRE     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELWOBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSRE     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WOB7SS           DF Classificati
     C                     GOTO REEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7RYST    WOB7SS           DF Classificati
     C                     ENDIF
      *================================================================
     CSR         REEXIT    ENDSR
      /EJECT
     CSR         RFCRRC    BEGSR
      *================================================================
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0793  1        TDF Classificat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DZREX2
     C                     Z-ADDP1HMNB    WOHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WOBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WOB0DT           TH Kill Date
     C                     MOVEL#DG0CD    WOBDCD           DF Defect Code
     C                     Z-ADD#DO5NB    WOLJNB           TDF Head Defect
     C                     MOVEL#1BECD    WOBECD           HC Class Code
     C                     MOVEL*BLANK    WOB8SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOB9SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOCASS           TDF Unused Sts
     C                     Z-ADD*ZERO     WONXA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONYA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONZA1           TDF Unused Nbr
     C                     MOVEL*BLANK    WOAAVN           RS User Changed
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     MOVELWUAJST    WOAJST           RS Record Statu
     C                     MOVEL*BLANK    WOAHVN           RS Job
     C                     MOVEL*BLANK    WOAGVN           RS Program
     C                     MOVEL*BLANK    WOABVN           RS User Added
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Hog Defect Class  RT - Hog Defect  * 
     C                     EXSR RGRVGN
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WOAJST           RS Record Statu
     C                     MOVEL##USR     WOABVN           RS User Added
     C                     Z-ADD##JDT     WOABDT           RS Date Added
     C                     Z-ADD##JTM     WOABTM           RS Time Added
     C                     MOVEL##PGM     WOAGVN           RS Program
     C                     MOVEL##JOB     WOAHVN           RS Job
     C           KLCRRF    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOBDCD           DF Defect Code
      * Check for duplicate primary key
     C           KLCRRF    SETLL@DZREX2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0739' W0RTN   7
      * Send message 'Tattoo Defect          EX'
     C                     MOVEL'PRK0739' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO RFEXIT
     C                     ENDIF
      *
     C                     WRITE@DZREX2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         RFEXIT    ENDSR
      /EJECT
     CSR         RGRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Class  RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSRG     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELWOBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSRG     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WOB7SS           DF Classificati
     C                     GOTO RGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7RYST    WOB7SS           DF Classificati
     C                     ENDIF
      *================================================================
     CSR         RGEXIT    ENDSR
      /EJECT
     CSR         RHCRRC    BEGSR
      *================================================================
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0794  1        TDF Classificat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DZREX2
     C                     Z-ADDP1HMNB    WOHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WOBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WOB0DT           TH Kill Date
     C                     MOVEL#DG1CD    WOBDCD           DF Defect Code
     C                     Z-ADD#DFONB    WOLJNB           TDF Head Defect
     C                     MOVEL#1BECD    WOBECD           HC Class Code
     C                     MOVEL*BLANK    WOB8SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOB9SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOCASS           TDF Unused Sts
     C                     Z-ADD*ZERO     WONXA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONYA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONZA1           TDF Unused Nbr
     C                     MOVEL*BLANK    WOAAVN           RS User Changed
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     MOVELWUAJST    WOAJST           RS Record Statu
     C                     MOVEL*BLANK    WOAHVN           RS Job
     C                     MOVEL*BLANK    WOAGVN           RS Program
     C                     MOVEL*BLANK    WOABVN           RS User Added
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Hog Defect Class  RT - Hog Defect  * 
     C                     EXSR RIRVGN
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WOAJST           RS Record Statu
     C                     MOVEL##USR     WOABVN           RS User Added
     C                     Z-ADD##JDT     WOABDT           RS Date Added
     C                     Z-ADD##JTM     WOABTM           RS Time Added
     C                     MOVEL##PGM     WOAGVN           RS Program
     C                     MOVEL##JOB     WOAHVN           RS Job
     C           KLCRRH    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOBDCD           DF Defect Code
      * Check for duplicate primary key
     C           KLCRRH    SETLL@DZREX2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0739' W0RTN   7
      * Send message 'Tattoo Defect          EX'
     C                     MOVEL'PRK0739' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO RHEXIT
     C                     ENDIF
      *
     C                     WRITE@DZREX2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         RHEXIT    ENDSR
      /EJECT
     CSR         RIRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Class  RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSRI     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELWOBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSRI     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WOB7SS           DF Classificati
     C                     GOTO RIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7RYST    WOB7SS           DF Classificati
     C                     ENDIF
      *================================================================
     CSR         RIEXIT    ENDSR
      /EJECT
     CSR         RJCRRC    BEGSR
      *================================================================
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0795  1        TDF Classificat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DZREX2
     C                     Z-ADDP1HMNB    WOHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WOBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WOB0DT           TH Kill Date
     C                     MOVEL#DG2CD    WOBDCD           DF Defect Code
     C                     Z-ADD#DFXNB    WOLJNB           TDF Head Defect
     C                     MOVEL#1BECD    WOBECD           HC Class Code
     C                     MOVEL*BLANK    WOB8SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOB9SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOCASS           TDF Unused Sts
     C                     Z-ADD*ZERO     WONXA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONYA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONZA1           TDF Unused Nbr
     C                     MOVEL*BLANK    WOAAVN           RS User Changed
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     MOVELWUAJST    WOAJST           RS Record Statu
     C                     MOVEL*BLANK    WOAHVN           RS Job
     C                     MOVEL*BLANK    WOAGVN           RS Program
     C                     MOVEL*BLANK    WOABVN           RS User Added
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Hog Defect Class  RT - Hog Defect  * 
     C                     EXSR RKRVGN
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WOAJST           RS Record Statu
     C                     MOVEL##USR     WOABVN           RS User Added
     C                     Z-ADD##JDT     WOABDT           RS Date Added
     C                     Z-ADD##JTM     WOABTM           RS Time Added
     C                     MOVEL##PGM     WOAGVN           RS Program
     C                     MOVEL##JOB     WOAHVN           RS Job
     C           KLCRRJ    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOBDCD           DF Defect Code
      * Check for duplicate primary key
     C           KLCRRJ    SETLL@DZREX2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0739' W0RTN   7
      * Send message 'Tattoo Defect          EX'
     C                     MOVEL'PRK0739' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO RJEXIT
     C                     ENDIF
      *
     C                     WRITE@DZREX2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         RJEXIT    ENDSR
      /EJECT
     CSR         RKRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Class  RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSRK     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELWOBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSRK     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WOB7SS           DF Classificati
     C                     GOTO RKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7RYST    WOB7SS           DF Classificati
     C                     ENDIF
      *================================================================
     CSR         RKEXIT    ENDSR
      /EJECT
     CSR         RLCRRC    BEGSR
      *================================================================
      * Crt Tattoo Defect     CR - Tattoo Defect  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0796  1        TDF Classificat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DZREX2
     C                     Z-ADDP1HMNB    WOHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WOBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WOB0DT           TH Kill Date
     C                     MOVEL#DG3CD    WOBDCD           DF Defect Code
     C                     Z-ADD#DFTNB    WOLJNB           TDF Head Defect
     C                     MOVEL#1BECD    WOBECD           HC Class Code
     C                     MOVEL*BLANK    WOB8SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOB9SS           TDF Unused Sts
     C                     MOVEL*BLANK    WOCASS           TDF Unused Sts
     C                     Z-ADD*ZERO     WONXA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONYA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONZA1           TDF Unused Nbr
     C                     MOVEL*BLANK    WOAAVN           RS User Changed
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     MOVELWUAJST    WOAJST           RS Record Statu
     C                     MOVEL*BLANK    WOAHVN           RS Job
     C                     MOVEL*BLANK    WOAGVN           RS Program
     C                     MOVEL*BLANK    WOABVN           RS User Added
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Hog Defect Class  RT - Hog Defect  * 
     C                     EXSR RMRVGN
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WOAJST           RS Record Statu
     C                     MOVEL##USR     WOABVN           RS User Added
     C                     Z-ADD##JDT     WOABDT           RS Date Added
     C                     Z-ADD##JTM     WOABTM           RS Time Added
     C                     MOVEL##PGM     WOAGVN           RS Program
     C                     MOVEL##JOB     WOAHVN           RS Job
     C           KLCRRL    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOBDCD           DF Defect Code
      * Check for duplicate primary key
     C           KLCRRL    SETLL@DZREX2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0739' W0RTN   7
      * Send message 'Tattoo Defect          EX'
     C                     MOVEL'PRK0739' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO RLEXIT
     C                     ENDIF
      *
     C                     WRITE@DZREX2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         RLEXIT    ENDSR
      /EJECT
     CSR         RMRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Class  RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSRM     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELWOBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSRM     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WOB7SS           DF Classificati
     C                     GOTO RMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7RYST    WOB7SS           DF Classificati
     C                     ENDIF
      *================================================================
     CSR         RMEXIT    ENDSR
      /EJECT
     CSR         RNRVGN    BEGSR
      *================================================================
      * Rtv Dtl Pen/Chg PenDscRT - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WVHMNB    WQRN01           BOH Company Num
     C           *LIKE     DEFN WVBNNB    WQRN02           BOH Buy Order N
     C           *LIKE     DEFN WVBONB    WQRN03           BOL Load Number
     C           *LIKE     DEFN WVCVNB    WQRN04           TH Tattoo Numbe
     C           *LIKE     DEFN WVB0DT    WQRN05           TH Kill Date
      * Define keylist
     C           KRSRN     KLIST
     C                     KFLD           WQRN01           BOH Company Num
     C                     KFLD           WQRN02           BOH Buy Order N
     C                     KFLD           WQRN03           BOL Load Number
     C                     KFLD           WQRN04           TH Tattoo Numbe
     C                     KFLD           WQRN05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQRN01           BOH Company Num
     C                     Z-ADDP1BNNB    WQRN02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQRN03           BOL Load Number
     C                     Z-ADD#1CVNB    WQRN04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQRN05           TH Kill Date
      * Establish starting position
     C           KRSRN     SETLL@A2CPNP                    *
     C           KRSRN     READE@A2CPNP                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0063' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO RNEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv/Chg Pen Gntcs,descRT - Pen  * 
     C                     EXSR RORVGN
     C           KRSRN     READE@A2CPNP                  90*
     C                     ENDDO
      *================================================================
     CSR         RNEXIT    ENDSR
      /EJECT
     CSR         RORVGN    BEGSR
      *================================================================
      * Rtv/Chg Pen Gntcs,descRT - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSRO     KLIST
     C                     KFLD           WIHVNB           Pen Company Num
     C                     KFLD           WICMCD           Pen Number
      * Setup key
     C                     Z-ADDWVHVNB    WIHVNB           Pen Company Num
     C                     MOVELWVCMCD    WICMCD           Pen Number
      * Establish starting position
     C           KRSRO     CHAIN@A3REDD              90    *
      * Data record not found
     C   90                MOVEL'PRK0065' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWUCRTX    WUAGCD           GN Genetic Code
     C                     MOVELWUCRTX    WUAWTX           GN Description
      * Rtv Pen GENETICS      RT - Tattoo Detail  * 
     C                     EXSR RPRVGN
      * Chg Pen Genetics      CH - Pen  * 
     C                     EXSR RSCHRC
     C                     ENDIF
      *================================================================
     CSR         ROEXIT    ENDSR
      /EJECT
     CSR         RPRVGN    BEGSR
      *================================================================
      * Rtv Pen GENETICS      RT - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHHMNB    WQRP01           BOH Company Num
     C           *LIKE     DEFN WHCMCD    WQRP02           Pen Number
      * Define keylist
     C           KRSRP     KLIST
     C                     KFLD           WQRP01           BOH Company Num
     C                     KFLD           WQRP02           Pen Number
      * Setup key
     C                     Z-ADDWIHVNB    WQRP01           BOH Company Num
     C                     MOVELWICMCD    WQRP02           Pen Number
      * Establish starting position
     C           KRSRP     SETLL@A2CPKE                    *
     C           KRSRP     READE@A2CPKE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0063' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL*BLANK    WUAGCD           GN Genetic Code
     C                     GOTO RPEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.TDP Process Code is Drive Card Printed
      *   |- c2    : DB1.TDP Process Code is Open
      *   '-
     C           WHB9CD    IFEQ 'D'                        *IF
     C           WHB9CD    OREQ 'O'                        *OR
      * Rtv Tattoo GENETICS - Tattoo Header  * 
     C                     EXSR RQRVGN
      * CASE: PAR.GN Genetic Code is BLANKS
     C           WUAGCD    IFEQ *BLANK                     *IF
     C                     MOVELWUA1CD    WUAGCD           GN Genetic Code
     C                     MOVELWUJTTX    WUBBTX           Pen Description
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.Genetic Code USR NE PAR.GN Genetic Code
     C           WUA1CD    IFNE WUAGCD                     *IF
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL'MIXED'   WUBBTX           Pen Description
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSRP     READE@A2CPKE                  90*
     C                     ENDDO
      *================================================================
     CSR         RPEXIT    ENDSR
      /EJECT
     CSR         RQRVGN    BEGSR
      *================================================================
      * Rtv Tattoo GENETICS - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN A1HMNB    WQRQ01           BOH Company Num
     C           *LIKE     DEFN A1BNNB    WQRQ02           BOH Buy Order N
     C           *LIKE     DEFN A1BONB    WQRQ03           BOL Load Number
     C           *LIKE     DEFN A1CVNB    WQRQ04           TH Tattoo Numbe
      * Define keylist
     C           KRSRQ     KLIST
     C                     KFLD           WQRQ01           BOH Company Num
     C                     KFLD           WQRQ02           BOH Buy Order N
     C                     KFLD           WQRQ03           BOL Load Number
     C                     KFLD           WQRQ04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWHHMNB    WQRQ01           BOH Company Num
     C                     Z-ADDWHBNNB    WQRQ02           BOH Buy Order N
     C                     Z-ADDWHBONB    WQRQ03           BOL Load Number
     C                     Z-ADDWHCVNB    WQRQ04           TH Tattoo Numbe
      * Establish starting position
     C           KRSRQ     SETLL@A1CPC4                    *
     C           KRSRQ     READE@A1CPC4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUA1CD           GN Genetic Code
     C                     MOVEL*BLANK    WUJTTX           Pen Description
     C                     GOTO RQEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVELA1AGCD    WUA1CD           GN Genetic Code
      * Rtv Genetic Record    RT - Genetic  * 
     C                     EXSR RRRVGN
     C           KRSRQ     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         RQEXIT    ENDSR
      /EJECT
     CSR         RRRVGN    BEGSR
      *================================================================
      * Rtv Genetic Record    RT - Genetic  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSRR     KLIST
     C                     KFLD           AIAGCD           GN Genetic Code
      * Setup key
     C                     MOVELA1AGCD    AIAGCD           GN Genetic Code
      * Establish starting position
     C           KRSRR     CHAIN@AIREA9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0021' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUJTTX           GN Description
     C                     GOTO RREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAIAWTX    WUJTTX           GN Description
     C                     ENDIF
      *================================================================
     CSR         RREXIT    ENDSR
      /EJECT
     CSR         RSCHRC    BEGSR
      *================================================================
      * Chg Pen Genetics      CH - Pen  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0797  50       Pen Maximun Cap
     C                     Z-ADD*ZERO     WN0798  50       Pen Current Hea
     C                     Z-ADD*ZERO     WN0799  30       Pen Current Dri
     C                     MOVEL*BLANK    WN0800  1        Pen Sts
     C                     Z-ADD*ZERO     WN0801  30       Pen Drive Seque
     C                     MOVEL*BLANK    WN0802  1        Pen Type
     C                     Z-ADD*ZERO     WN0803  50       Pen Adjustment
     C                     MOVEL*BLANK    WN0804 10        RS User Changed
     C                     Z-ADD*ZERO     WN0805  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0806  60       RS Time Changed
     C                     MOVEL*BLANK    WN0807  1        RS Record Statu
     C                     MOVEL*BLANK    WN0808 10        RS Job
     C                     MOVEL*BLANK    WN0809 10        RS Program
     C                     MOVEL*BLANK    WN0810 10        RS User Added
     C                     Z-ADD*ZERO     WN0811  70       RS Date Added
     C                     Z-ADD*ZERO     WN0812  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YZRDC   1
      *
      * Move key fields to @A3REDC
     C                     Z-ADDWIHVNB    WJHVNB           Pen Company Num
     C                     MOVELWICMCD    WJCMCD    P      Pen Number
      *
     C           KLCHRS    KLIST
     C                     KFLD           WJHVNB           Pen Company Num
     C                     KFLD           WJCMCD           Pen Number
     C           KLCHRS    CHAIN@A3REDC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA3REL0'MDACP
     C                     MOVEL'@A3REDC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL028.
     C                     MOVEL'LBL028'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO RSEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO RSEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA31    YZRDCS
      * Move non-key fields to @A3REDC
     C                     MOVELWUBBTX    WJBBTX    P      Pen Description
     C                     MOVELWUAGCD    WJAGCD    P      GN Genetic Code
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YZRDCS
     C           YZRDC     ANDNE'N'
     C                     MOVE 'Y'       YZRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WJAAVN           RS User Changed
     C                     Z-ADD##JDT     WJAADT           RS Date Changed
     C                     Z-ADD##JTM     WJAMTM           RS Time Changed
     C                     MOVEL##JOB     WJAHVN           RS Job
     C                     MOVEL##PGM     WJAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YZRDCS
     C           YZRDC     ANDNE'N'
     C                     MOVE 'Y'       YZRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YZRDC     IFEQ 'Y'
     C                     UPDAT@A3REDC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA3REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         RSEXIT    ENDSR
      /EJECT
     CSR         RTRVGN    BEGSR
      *================================================================
      * Chg TatHdrExt by Key  RT - Tattoo Header EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSRT     KLIST
     C                     KFLD           DNHMNB           BOH Company Num
     C                     KFLD           DNBNNB           BOH Buy Order N
     C                     KFLD           DNBONB           BOL Load Number
     C                     KFLD           DNCVNB           TH Tattoo Numbe
     C                     KFLD           DNB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    DNHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    DNBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    DNBONB           BOL Load Number
     C                     Z-ADD#1CVNB    DNCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    DNB0DT           TH Kill Date
      * Establish starting position
     C           KRSRT     CHAIN@DNCPUY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0637' W0RTN   7
      * USER: Processing if Data record not found
      * Crt TatHdrExt WTPrdSitCO - Tattoo Header EXT  * 
     C                     EXSR RUCRRC
     C                     GOTO RTEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg TatHdrExtWTOPrdSitCH - Tattoo Header EXT  * 
     C                     EXSR RVCHRC
     C                     ENDIF
      *================================================================
     CSR         RTEXIT    ENDSR
      /EJECT
     CSR         RUCRRC    BEGSR
      *================================================================
      * Crt TatHdrExt WTPrdSitCO - Tattoo Header EXT  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0813 10        RS User Changed
     C                     Z-ADD*ZERO     WN0814  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0815  60       RS Time Changed
     C                     MOVEL*BLANK    WN0816  1        RS Record Statu
     C                     MOVEL*BLANK    WN0817 10        RS Job
     C                     MOVEL*BLANK    WN0818 10        RS Program
     C                     MOVEL*BLANK    WN0819 10        RS User Added
     C                     Z-ADD*ZERO     WN0820  70       RS Date Added
     C                     Z-ADD*ZERO     WN0821  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DNCPUX
     C                     Z-ADDP1HMNB    WSHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WSBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WSBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WSCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WSB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WSI5PR           TH CA Market Pr
     C                     Z-ADD*ZERO     WSJBPR           TH CA Base Mark
     C                     Z-ADD*ZERO     WSI6PR           TH CA Base Mkt
     C                     Z-ADD*ZERO     WSI7PR           TH CA Sort Disc
     C                     Z-ADD*ZERO     WSI8PR           TH CA Yield Gai
     C                     Z-ADD*ZERO     WSI9PR           TH CA Base Carc
     C                     Z-ADD*ZERO     WSJAPR           TH CA Lean Prem
     C                     Z-ADD*ZERO     WSJCPR           TH CA Carcass G
     C                     Z-ADD*ZERO     WSJDPR           TH CA Bse Mkt L
     C                     Z-ADD*ZERO     WSJEPR           TH CA Bse Mkt C
     C                     Z-ADD*ZERO     WSJFPR           TH CA Srt Dsc L
     C                     Z-ADD*ZERO     WSJGPR           TH CA Srt Dsc C
     C                     Z-ADD*ZERO     WSJHPR           TH CA Yld G/L L
     C                     Z-ADD*ZERO     WSJIPR           TH CA Yld G/L C
     C                     Z-ADD*ZERO     WSJJPR           TH CA Crc Val L
     C                     Z-ADD*ZERO     WSJKPR           TH CA Crc Val C
     C                     Z-ADD*ZERO     WSJLPR           TH CA Lean Prm
     C                     Z-ADD*ZERO     WSJMPR           TH CA Lean Prm
     C                     Z-ADD*ZERO     WSJNPR           TH CA Gross Liv
     C                     Z-ADD*ZERO     WSJOPR           TH CA Gross Car
     C                     Z-ADD*ZERO     WSLTBF           TH Min LT Backf
     C                     Z-ADD*ZERO     WSHZPC           TH Min LT LoinE
     C                     Z-ADD*ZERO     WSLTHW           TH Min LT Hot W
     C                     Z-ADD*ZERO     WSH0PC           TH Min LT Lean
     C                     Z-ADD*ZERO     WSGTBF           TH Max GT Backf
     C                     Z-ADD*ZERO     WSH1PC           TH Max GT LoinE
     C                     Z-ADD*ZERO     WSGTHW           TH Max GT Hot W
     C                     Z-ADD*ZERO     WSH2PC           TH Max GT Lean
     C                     Z-ADD*ZERO     WSHLBF           TH Head LT Back
     C                     Z-ADD*ZERO     WSHLLE           TH Head LT Loin
     C                     Z-ADD*ZERO     WSHLHW           TH Head LT Hot
     C                     Z-ADD*ZERO     WSHLLP           TH Head LT Lean
     C                     Z-ADD*ZERO     WSHGBF           TH Head GT Back
     C                     Z-ADD*ZERO     WSHGLE           TH Head GT Loin
     C                     Z-ADD*ZERO     WSHGHW           TH Head GT Hot
     C                     Z-ADD*ZERO     WSHFLP           TH Head GT Lean
     C                     Z-ADDYL0022    WSSNA1           TE Unused Numbe
     C                     Z-ADDYL0023    WSSOA1           TE UnUsed Numbe
     C                     Z-ADDYL0024    WSSPA1           TE Unused Numbe
     C                     MOVELYL0025    WSDGSS           TE Unused Statu
     C                     MOVELYL0026    WSDHSS           TE Unused Statu
     C                     MOVELYL0027    WSDISS           TE Unused Statu
     C                     MOVELP1ABCD    WSABCD           PD Producer Cod
     C                     MOVEL#DNYCD    WSNYCD           PS Site ID
     C                     MOVEL#DOVCD    WSOVCD           Producer Subsid
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WSAJST           RS Record Statu
     C                     MOVEL##USR     WSABVN           RS User Added
     C                     Z-ADD##JDT     WSABDT           RS Date Added
     C                     Z-ADD##JTM     WSABTM           RS Time Added
     C                     MOVEL##PGM     WSAGVN           RS Program
     C                     MOVEL##JOB     WSAHVN           RS Job
     C                     MOVEL*BLANK    WSAAVN           RS User Changed
     C                     Z-ADD*ZERO     WSAADT           RS Date Changed
     C                     Z-ADD*ZERO     WSAMTM           RS Time Changed
     C           KLCRRU    KLIST
     C                     KFLD           WSHMNB           BOH Company Num
     C                     KFLD           WSBNNB           BOH Buy Order N
     C                     KFLD           WSBONB           BOL Load Number
     C                     KFLD           WSCVNB           TH Tattoo Numbe
     C                     KFLD           WSB0DT           TH Kill Date
      * Check for duplicate primary key
     C           KLCRRU    SETLL@DNCPUX                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0638' W0RTN   7
      * Send message 'Tattoo Header EXT      EX'
     C                     MOVEL'PRK0638' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO RUEXIT
     C                     ENDIF
      *
     C                     WRITE@DNCPUX                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         RUEXIT    ENDSR
      /EJECT
     CSR         RVCHRC    BEGSR
      *================================================================
      * Chg TatHdrExtWTOPrdSitCH - Tattoo Header EXT  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0822  52       TH CA Market Pr
     C                     Z-ADD*ZERO     WN0823  72       TH CA Base Mark
     C                     Z-ADD*ZERO     WN0824  72       TH CA Base Mkt
     C                     Z-ADD*ZERO     WN0825  72       TH CA Sort Disc
     C                     Z-ADD*ZERO     WN0826  72       TH CA Yield Gai
     C                     Z-ADD*ZERO     WN0827  72       TH CA Base Carc
     C                     Z-ADD*ZERO     WN0828  72       TH CA Lean Prem
     C                     Z-ADD*ZERO     WN0829  72       TH CA Carcass G
     C                     Z-ADD*ZERO     WN0830  52       TH CA Bse Mkt L
     C                     Z-ADD*ZERO     WN0831  52       TH CA Bse Mkt C
     C                     Z-ADD*ZERO     WN0832  52       TH CA Srt Dsc L
     C                     Z-ADD*ZERO     WN0833  52       TH CA Srt Dsc C
     C                     Z-ADD*ZERO     WN0834  52       TH CA Yld G/L L
     C                     Z-ADD*ZERO     WN0835  52       TH CA Yld G/L C
     C                     Z-ADD*ZERO     WN0836  52       TH CA Crc Val L
     C                     Z-ADD*ZERO     WN0837  52       TH CA Crc Val C
     C                     Z-ADD*ZERO     WN0838  52       TH CA Lean Prm
     C                     Z-ADD*ZERO     WN0839  52       TH CA Lean Prm
     C                     Z-ADD*ZERO     WN0840  52       TH CA Gross Liv
     C                     Z-ADD*ZERO     WN0841  52       TH CA Gross Car
     C                     Z-ADD*ZERO     WN0842  31       TH Min LT Backf
     C                     Z-ADD*ZERO     WN0843  31       TH Min LT LoinE
     C                     Z-ADD*ZERO     WN0844  71       TH Min LT Hot W
     C                     Z-ADD*ZERO     WN0845  31       TH Min LT Lean
     C                     Z-ADD*ZERO     WN0846  31       TH Max GT Backf
     C                     Z-ADD*ZERO     WN0847  31       TH Max GT LoinE
     C                     Z-ADD*ZERO     WN0848  71       TH Max GT Hot W
     C                     Z-ADD*ZERO     WN0849  31       TH Max GT Lean
     C                     Z-ADD*ZERO     WN0850  50       TH Head LT Back
     C                     Z-ADD*ZERO     WN0851  50       TH Head LT Loin
     C                     Z-ADD*ZERO     WN0852  50       TH Head LT Hot
     C                     Z-ADD*ZERO     WN0853  50       TH Head LT Lean
     C                     Z-ADD*ZERO     WN0854  50       TH Head GT Back
     C                     Z-ADD*ZERO     WN0855  50       TH Head GT Loin
     C                     Z-ADD*ZERO     WN0856  50       TH Head GT Hot
     C                     Z-ADD*ZERO     WN0857  50       TH Head GT Lean
     C                     MOVEL*BLANK    WN0858 10        RS User Changed
     C                     Z-ADD*ZERO     WN0859  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0860  60       RS Time Changed
     C                     MOVEL*BLANK    WN0861  1        RS Record Statu
     C                     MOVEL*BLANK    WN0862 10        RS Job
     C                     MOVEL*BLANK    WN0863 10        RS Program
     C                     MOVEL*BLANK    WN0864 10        RS User Added
     C                     Z-ADD*ZERO     WN0865  70       RS Date Added
     C                     Z-ADD*ZERO     WN0866  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    Y0RDC   1
      *
      * Move key fields to @DNCPUX
     C                     Z-ADDDNHMNB    WSHMNB           BOH Company Num
     C                     Z-ADDDNBNNB    WSBNNB           BOH Buy Order N
     C                     Z-ADDDNBONB    WSBONB           BOL Load Number
     C                     Z-ADDDNCVNB    WSCVNB           TH Tattoo Numbe
     C                     Z-ADDDNB0DT    WSB0DT           TH Kill Date
      *
     C           KLCHRV    KLIST
     C                     KFLD           WSHMNB           BOH Company Num
     C                     KFLD           WSBNNB           BOH Buy Order N
     C                     KFLD           WSBONB           BOL Load Number
     C                     KFLD           WSCVNB           TH Tattoo Numbe
     C                     KFLD           WSB0DT           TH Kill Date
     C           KLCHRV    CHAIN@DNCPUX              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * USER: Processing if Data record not found
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) DNSNA1' defaulted for 'TE Unused Number 1'.
      * Field '(PAR) DNSOA1' defaulted for 'TE UnUsed Number 2'.
      * Field '(PAR) DNSPA1' defaulted for 'TE Unused Number 3'.
      * Field '(PAR) DNDGSS' defaulted for 'TE Unused Status 1'.
      * Field '(PAR) DNDHSS' defaulted for 'TE Unused Status 2'.
      * Field '(PAR) DNDISS' defaulted for 'TE Unused Status 3'.
      * Field '(PAR) #DOVCD' defaulted for 'Producer Subsidiary Code'.
      * Crt TatHdrExt WTPrdSitCO - Tattoo Header EXT  * 
     C                     EXSR RWCRRC
     C           W0RTN     IFNE *BLANK                     IF
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDNCPL0'MDACP
     C                     MOVEL'@DNCPUX' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL029.
     C                     MOVEL'LBL029'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     ENDIF
     C                     GOTO RVEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO RVEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKDN1    Y0RDCS
      * Move non-key fields to @DNCPUX
     C                     Z-ADDDNSNA1    WSSNA1           TE Unused Numbe
     C                     Z-ADDDNSOA1    WSSOA1           TE UnUsed Numbe
     C                     Z-ADDDNSPA1    WSSPA1           TE Unused Numbe
     C                     MOVELDNDGSS    WSDGSS    P      TE Unused Statu
     C                     MOVELDNDHSS    WSDHSS    P      TE Unused Statu
     C                     MOVELDNDISS    WSDISS    P      TE Unused Statu
     C                     MOVELP1ABCD    WSABCD    P      PD Producer Cod
     C                     MOVEL#DNYCD    WSNYCD    P      PS Site ID
     C                     MOVEL#DOVCD    WSOVCD    P      Producer Subsid
      *
      * Set PGM.*Record Data Changed flag
     C           QPKDN1    IFNE Y0RDCS
     C           Y0RDC     ANDNE'N'
     C                     MOVE 'Y'       Y0RDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp-SysDtIF
     C                     MOVEL##USR     WSAAVN           RS User Changed
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WSAADT    PARM *ZERO     WQ0341  70       *DATE
     C           WSAMTM    PARM *ZERO     WQ0342  60       *TIME
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##JOB     WSAHVN           RS Job
     C                     MOVEL##PGM     WSAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKDN1    IFNE Y0RDCS
     C           Y0RDC     ANDNE'N'
     C                     MOVE 'Y'       Y0RDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           Y0RDC     IFEQ 'Y'
     C                     UPDAT@DNCPUX                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKDNCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         RVEXIT    ENDSR
      /EJECT
     CSR         RWCRRC    BEGSR
      *================================================================
      * Crt TatHdrExt WTPrdSitCO - Tattoo Header EXT  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0867 10        RS User Changed
     C                     Z-ADD*ZERO     WN0868  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0869  60       RS Time Changed
     C                     MOVEL*BLANK    WN0870  1        RS Record Statu
     C                     MOVEL*BLANK    WN0871 10        RS Job
     C                     MOVEL*BLANK    WN0872 10        RS Program
     C                     MOVEL*BLANK    WN0873 10        RS User Added
     C                     Z-ADD*ZERO     WN0874  70       RS Date Added
     C                     Z-ADD*ZERO     WN0875  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DNCPUX
     C                     Z-ADDDNHMNB    WSHMNB           BOH Company Num
     C                     Z-ADDDNBNNB    WSBNNB           BOH Buy Order N
     C                     Z-ADDDNBONB    WSBONB           BOL Load Number
     C                     Z-ADDDNCVNB    WSCVNB           TH Tattoo Numbe
     C                     Z-ADDDNB0DT    WSB0DT           TH Kill Date
     C                     Z-ADDWN0822    WSI5PR           TH CA Market Pr
     C                     Z-ADDWN0823    WSJBPR           TH CA Base Mark
     C                     Z-ADDWN0824    WSI6PR           TH CA Base Mkt
     C                     Z-ADDWN0825    WSI7PR           TH CA Sort Disc
     C                     Z-ADDWN0826    WSI8PR           TH CA Yield Gai
     C                     Z-ADDWN0827    WSI9PR           TH CA Base Carc
     C                     Z-ADDWN0828    WSJAPR           TH CA Lean Prem
     C                     Z-ADDWN0829    WSJCPR           TH CA Carcass G
     C                     Z-ADDWN0830    WSJDPR           TH CA Bse Mkt L
     C                     Z-ADDWN0831    WSJEPR           TH CA Bse Mkt C
     C                     Z-ADDWN0832    WSJFPR           TH CA Srt Dsc L
     C                     Z-ADDWN0833    WSJGPR           TH CA Srt Dsc C
     C                     Z-ADDWN0834    WSJHPR           TH CA Yld G/L L
     C                     Z-ADDWN0835    WSJIPR           TH CA Yld G/L C
     C                     Z-ADDWN0836    WSJJPR           TH CA Crc Val L
     C                     Z-ADDWN0837    WSJKPR           TH CA Crc Val C
     C                     Z-ADDWN0838    WSJLPR           TH CA Lean Prm
     C                     Z-ADDWN0839    WSJMPR           TH CA Lean Prm
     C                     Z-ADDWN0840    WSJNPR           TH CA Gross Liv
     C                     Z-ADDWN0841    WSJOPR           TH CA Gross Car
     C                     Z-ADDWN0842    WSLTBF           TH Min LT Backf
     C                     Z-ADDWN0843    WSHZPC           TH Min LT LoinE
     C                     Z-ADDWN0844    WSLTHW           TH Min LT Hot W
     C                     Z-ADDWN0845    WSH0PC           TH Min LT Lean
     C                     Z-ADDWN0846    WSGTBF           TH Max GT Backf
     C                     Z-ADDWN0847    WSH1PC           TH Max GT LoinE
     C                     Z-ADDWN0848    WSGTHW           TH Max GT Hot W
     C                     Z-ADDWN0849    WSH2PC           TH Max GT Lean
     C                     Z-ADDWN0850    WSHLBF           TH Head LT Back
     C                     Z-ADDWN0851    WSHLLE           TH Head LT Loin
     C                     Z-ADDWN0852    WSHLHW           TH Head LT Hot
     C                     Z-ADDWN0853    WSHLLP           TH Head LT Lean
     C                     Z-ADDWN0854    WSHGBF           TH Head GT Back
     C                     Z-ADDWN0855    WSHGLE           TH Head GT Loin
     C                     Z-ADDWN0856    WSHGHW           TH Head GT Hot
     C                     Z-ADDWN0857    WSHFLP           TH Head GT Lean
     C                     Z-ADDDNSNA1    WSSNA1           TE Unused Numbe
     C                     Z-ADDDNSOA1    WSSOA1           TE UnUsed Numbe
     C                     Z-ADDDNSPA1    WSSPA1           TE Unused Numbe
     C                     MOVELDNDGSS    WSDGSS           TE Unused Statu
     C                     MOVELDNDHSS    WSDHSS           TE Unused Statu
     C                     MOVELDNDISS    WSDISS           TE Unused Statu
     C                     MOVELP1ABCD    WSABCD           PD Producer Cod
     C                     MOVEL#DNYCD    WSNYCD           PS Site ID
     C                     MOVEL#DOVCD    WSOVCD           Producer Subsid
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WSAJST           RS Record Statu
     C                     MOVEL##USR     WSABVN           RS User Added
     C                     Z-ADD##JDT     WSABDT           RS Date Added
     C                     Z-ADD##JTM     WSABTM           RS Time Added
     C                     MOVEL##PGM     WSAGVN           RS Program
     C                     MOVEL##JOB     WSAHVN           RS Job
     C                     MOVEL*BLANK    WSAAVN           RS User Changed
     C                     Z-ADD*ZERO     WSAADT           RS Date Changed
     C                     Z-ADD*ZERO     WSAMTM           RS Time Changed
     C           KLCRRW    KLIST
     C                     KFLD           WSHMNB           BOH Company Num
     C                     KFLD           WSBNNB           BOH Buy Order N
     C                     KFLD           WSBONB           BOL Load Number
     C                     KFLD           WSCVNB           TH Tattoo Numbe
     C                     KFLD           WSB0DT           TH Kill Date
      * Check for duplicate primary key
     C           KLCRRW    SETLL@DNCPUX                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0638' W0RTN   7
      * Send message 'Tattoo Header EXT      EX'
     C                     MOVEL'PRK0638' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO RWEXIT
     C                     ENDIF
      *
     C                     WRITE@DNCPUX                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         RWEXIT    ENDSR
      /EJECT
     CSR         RXRVGN    BEGSR
      *================================================================
      * Chg TatHdrExt All TattRT - Tattoo Header EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNHMNB    WQRX01           BOH Company Num
     C           *LIKE     DEFN DNBNNB    WQRX02           BOH Buy Order N
     C           *LIKE     DEFN DNBONB    WQRX03           BOL Load Number
     C           *LIKE     DEFN DNCVNB    WQRX04           TH Tattoo Numbe
      * Define keylist
     C           KRSRX     KLIST
     C                     KFLD           WQRX01           BOH Company Num
     C                     KFLD           WQRX02           BOH Buy Order N
     C                     KFLD           WQRX03           BOL Load Number
     C                     KFLD           WQRX04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDP1HMNB    WQRX01           BOH Company Num
     C                     Z-ADDP1BNNB    WQRX02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQRX03           BOL Load Number
     C                     Z-ADD#1CVNB    WQRX04           TH Tattoo Numbe
      * Establish starting position
     C           KRSRX     SETLL@DNCPUY                    *
     C           KRSRX     READE@DNCPUY                  90*
      * Data record not found
     C   90                MOVEL'PRK0637' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg TatHdrExtWTOPrdSitCH - Tattoo Header EXT  * 
     C                     EXSR RYCHRC
     C           KRSRX     READE@DNCPUY                  90*
     C                     ENDDO
      *================================================================
     CSR         RXEXIT    ENDSR
      /EJECT
     CSR         RYCHRC    BEGSR
      *================================================================
      * Chg TatHdrExtWTOPrdSitCH - Tattoo Header EXT  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0876  52       TH CA Market Pr
     C                     Z-ADD*ZERO     WN0877  72       TH CA Base Mark
     C                     Z-ADD*ZERO     WN0878  72       TH CA Base Mkt
     C                     Z-ADD*ZERO     WN0879  72       TH CA Sort Disc
     C                     Z-ADD*ZERO     WN0880  72       TH CA Yield Gai
     C                     Z-ADD*ZERO     WN0881  72       TH CA Base Carc
     C                     Z-ADD*ZERO     WN0882  72       TH CA Lean Prem
     C                     Z-ADD*ZERO     WN0883  72       TH CA Carcass G
     C                     Z-ADD*ZERO     WN0884  52       TH CA Bse Mkt L
     C                     Z-ADD*ZERO     WN0885  52       TH CA Bse Mkt C
     C                     Z-ADD*ZERO     WN0886  52       TH CA Srt Dsc L
     C                     Z-ADD*ZERO     WN0887  52       TH CA Srt Dsc C
     C                     Z-ADD*ZERO     WN0888  52       TH CA Yld G/L L
     C                     Z-ADD*ZERO     WN0889  52       TH CA Yld G/L C
     C                     Z-ADD*ZERO     WN0890  52       TH CA Crc Val L
     C                     Z-ADD*ZERO     WN0891  52       TH CA Crc Val C
     C                     Z-ADD*ZERO     WN0892  52       TH CA Lean Prm
     C                     Z-ADD*ZERO     WN0893  52       TH CA Lean Prm
     C                     Z-ADD*ZERO     WN0894  52       TH CA Gross Liv
     C                     Z-ADD*ZERO     WN0895  52       TH CA Gross Car
     C                     Z-ADD*ZERO     WN0896  31       TH Min LT Backf
     C                     Z-ADD*ZERO     WN0897  31       TH Min LT LoinE
     C                     Z-ADD*ZERO     WN0898  71       TH Min LT Hot W
     C                     Z-ADD*ZERO     WN0899  31       TH Min LT Lean
     C                     Z-ADD*ZERO     WN0900  31       TH Max GT Backf
     C                     Z-ADD*ZERO     WN0901  31       TH Max GT LoinE
     C                     Z-ADD*ZERO     WN0902  71       TH Max GT Hot W
     C                     Z-ADD*ZERO     WN0903  31       TH Max GT Lean
     C                     Z-ADD*ZERO     WN0904  50       TH Head LT Back
     C                     Z-ADD*ZERO     WN0905  50       TH Head LT Loin
     C                     Z-ADD*ZERO     WN0906  50       TH Head LT Hot
     C                     Z-ADD*ZERO     WN0907  50       TH Head LT Lean
     C                     Z-ADD*ZERO     WN0908  50       TH Head GT Back
     C                     Z-ADD*ZERO     WN0909  50       TH Head GT Loin
     C                     Z-ADD*ZERO     WN0910  50       TH Head GT Hot
     C                     Z-ADD*ZERO     WN0911  50       TH Head GT Lean
     C                     MOVEL*BLANK    WN0912 10        RS User Changed
     C                     Z-ADD*ZERO     WN0913  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0914  60       RS Time Changed
     C                     MOVEL*BLANK    WN0915  1        RS Record Statu
     C                     MOVEL*BLANK    WN0916 10        RS Job
     C                     MOVEL*BLANK    WN0917 10        RS Program
     C                     MOVEL*BLANK    WN0918 10        RS User Added
     C                     Z-ADD*ZERO     WN0919  70       RS Date Added
     C                     Z-ADD*ZERO     WN0920  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    Y1RDC   1
      *
      * Move key fields to @DNCPUX
     C                     Z-ADDDNHMNB    WSHMNB           BOH Company Num
     C                     Z-ADDDNBNNB    WSBNNB           BOH Buy Order N
     C                     Z-ADDDNBONB    WSBONB           BOL Load Number
     C                     Z-ADDDNCVNB    WSCVNB           TH Tattoo Numbe
     C                     Z-ADDDNB0DT    WSB0DT           TH Kill Date
      *
     C           KLCHRY    KLIST
     C                     KFLD           WSHMNB           BOH Company Num
     C                     KFLD           WSBNNB           BOH Buy Order N
     C                     KFLD           WSBONB           BOL Load Number
     C                     KFLD           WSCVNB           TH Tattoo Numbe
     C                     KFLD           WSB0DT           TH Kill Date
     C           KLCHRY    CHAIN@DNCPUX              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * USER: Processing if Data record not found
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) DNSNA1' defaulted for 'TE Unused Number 1'.
      * Field '(PAR) DNSOA1' defaulted for 'TE UnUsed Number 2'.
      * Field '(PAR) DNSPA1' defaulted for 'TE Unused Number 3'.
      * Field '(PAR) DNDGSS' defaulted for 'TE Unused Status 1'.
      * Field '(PAR) DNDHSS' defaulted for 'TE Unused Status 2'.
      * Field '(PAR) DNDISS' defaulted for 'TE Unused Status 3'.
      * Field '(PAR) #DOVCD' defaulted for 'Producer Subsidiary Code'.
      * Crt TatHdrExt WTPrdSitCO - Tattoo Header EXT  * 
     C                     EXSR RZCRRC
     C           W0RTN     IFNE *BLANK                     IF
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDNCPL0'MDACP
     C                     MOVEL'@DNCPUX' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL030.
     C                     MOVEL'LBL030'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     ENDIF
     C                     GOTO RYEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO RYEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKDN1    Y1RDCS
      * Move non-key fields to @DNCPUX
     C                     Z-ADDDNSNA1    WSSNA1           TE Unused Numbe
     C                     Z-ADDDNSOA1    WSSOA1           TE UnUsed Numbe
     C                     Z-ADDDNSPA1    WSSPA1           TE Unused Numbe
     C                     MOVELDNDGSS    WSDGSS    P      TE Unused Statu
     C                     MOVELDNDHSS    WSDHSS    P      TE Unused Statu
     C                     MOVELDNDISS    WSDISS    P      TE Unused Statu
     C                     MOVELP1ABCD    WSABCD    P      PD Producer Cod
     C                     MOVEL#DNYCD    WSNYCD    P      PS Site ID
     C                     MOVEL#DOVCD    WSOVCD    P      Producer Subsid
      *
      * Set PGM.*Record Data Changed flag
     C           QPKDN1    IFNE Y1RDCS
     C           Y1RDC     ANDNE'N'
     C                     MOVE 'Y'       Y1RDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp-SysDtIF
     C                     MOVEL##USR     WSAAVN           RS User Changed
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WSAADT    PARM *ZERO     WQ0343  70       *DATE
     C           WSAMTM    PARM *ZERO     WQ0344  60       *TIME
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##JOB     WSAHVN           RS Job
     C                     MOVEL##PGM     WSAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKDN1    IFNE Y1RDCS
     C           Y1RDC     ANDNE'N'
     C                     MOVE 'Y'       Y1RDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           Y1RDC     IFEQ 'Y'
     C                     UPDAT@DNCPUX                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKDNCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         RYEXIT    ENDSR
      /EJECT
     CSR         RZCRRC    BEGSR
      *================================================================
      * Crt TatHdrExt WTPrdSitCO - Tattoo Header EXT  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0921 10        RS User Changed
     C                     Z-ADD*ZERO     WN0922  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0923  60       RS Time Changed
     C                     MOVEL*BLANK    WN0924  1        RS Record Statu
     C                     MOVEL*BLANK    WN0925 10        RS Job
     C                     MOVEL*BLANK    WN0926 10        RS Program
     C                     MOVEL*BLANK    WN0927 10        RS User Added
     C                     Z-ADD*ZERO     WN0928  70       RS Date Added
     C                     Z-ADD*ZERO     WN0929  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DNCPUX
     C                     Z-ADDDNHMNB    WSHMNB           BOH Company Num
     C                     Z-ADDDNBNNB    WSBNNB           BOH Buy Order N
     C                     Z-ADDDNBONB    WSBONB           BOL Load Number
     C                     Z-ADDDNCVNB    WSCVNB           TH Tattoo Numbe
     C                     Z-ADDDNB0DT    WSB0DT           TH Kill Date
     C                     Z-ADDWN0876    WSI5PR           TH CA Market Pr
     C                     Z-ADDWN0877    WSJBPR           TH CA Base Mark
     C                     Z-ADDWN0878    WSI6PR           TH CA Base Mkt
     C                     Z-ADDWN0879    WSI7PR           TH CA Sort Disc
     C                     Z-ADDWN0880    WSI8PR           TH CA Yield Gai
     C                     Z-ADDWN0881    WSI9PR           TH CA Base Carc
     C                     Z-ADDWN0882    WSJAPR           TH CA Lean Prem
     C                     Z-ADDWN0883    WSJCPR           TH CA Carcass G
     C                     Z-ADDWN0884    WSJDPR           TH CA Bse Mkt L
     C                     Z-ADDWN0885    WSJEPR           TH CA Bse Mkt C
     C                     Z-ADDWN0886    WSJFPR           TH CA Srt Dsc L
     C                     Z-ADDWN0887    WSJGPR           TH CA Srt Dsc C
     C                     Z-ADDWN0888    WSJHPR           TH CA Yld G/L L
     C                     Z-ADDWN0889    WSJIPR           TH CA Yld G/L C
     C                     Z-ADDWN0890    WSJJPR           TH CA Crc Val L
     C                     Z-ADDWN0891    WSJKPR           TH CA Crc Val C
     C                     Z-ADDWN0892    WSJLPR           TH CA Lean Prm
     C                     Z-ADDWN0893    WSJMPR           TH CA Lean Prm
     C                     Z-ADDWN0894    WSJNPR           TH CA Gross Liv
     C                     Z-ADDWN0895    WSJOPR           TH CA Gross Car
     C                     Z-ADDWN0896    WSLTBF           TH Min LT Backf
     C                     Z-ADDWN0897    WSHZPC           TH Min LT LoinE
     C                     Z-ADDWN0898    WSLTHW           TH Min LT Hot W
     C                     Z-ADDWN0899    WSH0PC           TH Min LT Lean
     C                     Z-ADDWN0900    WSGTBF           TH Max GT Backf
     C                     Z-ADDWN0901    WSH1PC           TH Max GT LoinE
     C                     Z-ADDWN0902    WSGTHW           TH Max GT Hot W
     C                     Z-ADDWN0903    WSH2PC           TH Max GT Lean
     C                     Z-ADDWN0904    WSHLBF           TH Head LT Back
     C                     Z-ADDWN0905    WSHLLE           TH Head LT Loin
     C                     Z-ADDWN0906    WSHLHW           TH Head LT Hot
     C                     Z-ADDWN0907    WSHLLP           TH Head LT Lean
     C                     Z-ADDWN0908    WSHGBF           TH Head GT Back
     C                     Z-ADDWN0909    WSHGLE           TH Head GT Loin
     C                     Z-ADDWN0910    WSHGHW           TH Head GT Hot
     C                     Z-ADDWN0911    WSHFLP           TH Head GT Lean
     C                     Z-ADDDNSNA1    WSSNA1           TE Unused Numbe
     C                     Z-ADDDNSOA1    WSSOA1           TE UnUsed Numbe
     C                     Z-ADDDNSPA1    WSSPA1           TE Unused Numbe
     C                     MOVELDNDGSS    WSDGSS           TE Unused Statu
     C                     MOVELDNDHSS    WSDHSS           TE Unused Statu
     C                     MOVELDNDISS    WSDISS           TE Unused Statu
     C                     MOVELP1ABCD    WSABCD           PD Producer Cod
     C                     MOVEL#DNYCD    WSNYCD           PS Site ID
     C                     MOVEL#DOVCD    WSOVCD           Producer Subsid
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WSAJST           RS Record Statu
     C                     MOVEL##USR     WSABVN           RS User Added
     C                     Z-ADD##JDT     WSABDT           RS Date Added
     C                     Z-ADD##JTM     WSABTM           RS Time Added
     C                     MOVEL##PGM     WSAGVN           RS Program
     C                     MOVEL##JOB     WSAHVN           RS Job
     C                     MOVEL*BLANK    WSAAVN           RS User Changed
     C                     Z-ADD*ZERO     WSAADT           RS Date Changed
     C                     Z-ADD*ZERO     WSAMTM           RS Time Changed
     C           KLCRRZ    KLIST
     C                     KFLD           WSHMNB           BOH Company Num
     C                     KFLD           WSBNNB           BOH Buy Order N
     C                     KFLD           WSBONB           BOL Load Number
     C                     KFLD           WSCVNB           TH Tattoo Numbe
     C                     KFLD           WSB0DT           TH Kill Date
      * Check for duplicate primary key
     C           KLCRRZ    SETLL@DNCPUX                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0638' W0RTN   7
      * Send message 'Tattoo Header EXT      EX'
     C                     MOVEL'PRK0638' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO RZEXIT
     C                     ENDIF
      *
     C                     WRITE@DNCPUX                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         RZEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv PL Vnd Nbr, state RT - Producer Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           AFABCD           PD Producer Cod
     C                     KFLD           AFAECD           PL Location Cod
      * Setup key
     C                     MOVELP1ABCD    AFABCD           PD Producer Cod
     C                     MOVELP1AECD    AFAECD           PL Location Cod
      * Establish starting position
     C           KRSSA     CHAIN@AFREAR              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0015' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DA8TX           PL Name
     C                     Z-ADD*ZERO     WUGLNB           Pl VND Address
     C                     MOVEL*BLANK    #1NZTX           PL State Code
     C                     MOVEL*BLANK    #DQTST           PL Site ID Requ
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAFA8TX    #DA8TX           PL Name
     C                     Z-ADDAFGLNB    WUGLNB           Pl VND Address
     C                     MOVELAFN0TX    #1NZTX           PL State Code
     C                     MOVELAFQTST    #DQTST           PL Site ID Requ
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Site ID            RT - Tattoo Header EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           DNHMNB           BOH Company Num
     C                     KFLD           DNBNNB           BOH Buy Order N
     C                     KFLD           DNBONB           BOL Load Number
     C                     KFLD           DNCVNB           TH Tattoo Numbe
     C                     KFLD           DNB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    DNHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    DNBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    DNBONB           BOL Load Number
     C                     Z-ADDP1CVNB    DNCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    DNB0DT           TH Kill Date
      * Establish starting position
     C           KRSSB     CHAIN@DNCPUY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0637' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0002           PD Producer Cod
     C                     MOVEL*BLANK    #DNYCD           PS Site ID
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNABCD    YL0002           PD Producer Cod
     C                     MOVELDNNYCD    #DNYCD           PS Site ID
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Site State ActOnlyRT - Producer Site  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           ATABCD           PD Producer Cod
     C                     KFLD           ATNYCD           PS Site ID
      * Setup key
     C                     MOVELP1ABCD    ATABCD           PD Producer Cod
     C                     MOVEL#DNYCD    ATNYCD           PS Site ID
      * Establish starting position
     C           KRSSC     CHAIN@ATRELM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1137' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #1NZTX           PS State
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.RS Record Status is Active
     C           ATAJST    IFEQ 'A'                        *IF
      * PAR = DB1 By name
     C                     MOVELATT2TX    #1NZTX           PS State
     C                     ELSE
      * CASE: *OTHERWISE
      * PAR = CON By name
     C                     MOVEL*BLANK    #1NZTX           PS State
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Tattoo Def-10&Cls RT - Tattoo Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1         WUODNB           Defect Count Us
      * Declare restrictor key work fields
     C           *LIKE     DEFN DZHMNB    WQSD01           BOH Company Num
     C           *LIKE     DEFN DZBNNB    WQSD02           BOH Buy Order N
     C           *LIKE     DEFN DZBONB    WQSD03           BOL Load Number
     C           *LIKE     DEFN DZCVNB    WQSD04           TH Tattoo Numbe
     C           *LIKE     DEFN DZB0DT    WQSD05           TH Kill Date
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           BOH Company Num
     C                     KFLD           WQSD02           BOH Buy Order N
     C                     KFLD           WQSD03           BOL Load Number
     C                     KFLD           WQSD04           TH Tattoo Numbe
     C                     KFLD           WQSD05           TH Kill Date
      * Setup key
     C                     Z-ADD#1HMNB    WQSD01           BOH Company Num
     C                     Z-ADD#1BNNB    WQSD02           BOH Buy Order N
     C                     Z-ADD#1BONB    WQSD03           BOL Load Number
     C                     Z-ADD#1CVNB    WQSD04           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    WQSD05           TH Kill Date
      * Establish starting position
     C           KRSSD     SETLL@DZREX3                    *
     C           KRSSD     READE@DZREX3                  90*
      * Data record not found
     C   90                MOVEL'PRK0738' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: WRK.Defect Count Usr is One
     C           WUODNB    IFEQ 1                          *IF
     C                     MOVELDZBDCD    #DGUCD           Defect User  1
     C                     Z-ADDDZLJNB    #DF1NB           Defect HD user
     C                     MOVELDZB7SS    #DCLSS           Defect Cls User
     C                     Z-ADD2         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Two
     C           WUODNB    IFEQ 2                          *IF
     C                     MOVELDZBDCD    #DGVCD           Defect User  2
     C                     Z-ADDDZLJNB    #DFWNB           Defect HD user
     C                     MOVELDZB7SS    #DCMSS           Defect Cls User
     C                     Z-ADD3         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Three
     C           WUODNB    IFEQ 3                          *IF
     C                     MOVELDZBDCD    #DGWCD           Defect User  3
     C                     Z-ADDDZLJNB    #DFYNB           Defect HD user
     C                     MOVELDZB7SS    #DCNSS           Defect Cls User
     C                     Z-ADD4         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Four
     C           WUODNB    IFEQ 4                          *IF
     C                     MOVELDZBDCD    #DGXCD           Defect User  4
     C                     Z-ADDDZLJNB    #DFUNB           Defect HD user
     C                     MOVELDZB7SS    #DCOSS           Defect Cls User
     C                     Z-ADD5         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Five
     C           WUODNB    IFEQ 5                          *IF
     C                     MOVELDZBDCD    #DGYCD           Defect User  5
     C                     Z-ADDDZLJNB    #DO3NB           Defect HD user
     C                     MOVELDZB7SS    #DCPSS           Defect Cls User
     C                     Z-ADD6         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Six
     C           WUODNB    IFEQ 6                          *IF
     C                     MOVELDZBDCD    #DGZCD           Defect User  6
     C                     Z-ADDDZLJNB    #DO4NB           Defect HD user
     C                     MOVELDZB7SS    #DCQSS           Defect Cls User
     C                     Z-ADD7         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Seven
     C           WUODNB    IFEQ 7                          *IF
     C                     MOVELDZBDCD    #DG0CD           Defect User  7
     C                     Z-ADDDZLJNB    #DO5NB           Defect HD user
     C                     MOVELDZB7SS    #DCRSS           Defect Cls User
     C                     Z-ADD8         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Eight
     C           WUODNB    IFEQ 8                          *IF
     C                     MOVELDZBDCD    #DG1CD           Defect User  8
     C                     Z-ADDDZLJNB    #DFONB           Defect HD user
     C                     MOVELDZB7SS    #DCSSS           Defect Cls User
     C                     Z-ADD9         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Nine
     C           WUODNB    IFEQ 9                          *IF
     C                     MOVELDZBDCD    #DG2CD           Defect User  9
     C                     Z-ADDDZLJNB    #DFXNB           Defect HD user
     C                     MOVELDZB7SS    #DCTSS           Defect Cls User
     C                     Z-ADD10        WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Ten
     C           WUODNB    IFEQ 10                         *IF
     C                     MOVELDZBDCD    #DG3CD           Defect User 10
     C                     Z-ADDDZLJNB    #DFTNB           Defect HD user
     C                     MOVELDZB7SS    #DCUSS           Defect Cls User
     C                     Z-ADD11        WUODNB           Defect Count Us
     C                     GOTO SDEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSD     READE@DZREX3                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Movement Number   RT - Buy Order Load Weight  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN EJHONB    WQSE01           CC Company Numb
     C           *LIKE     DEFN EJBNNB    WQSE02           BOH Buy Order N
     C           *LIKE     DEFN EJBONB    WQSE03           BOL Load Number
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           CC Company Numb
     C                     KFLD           WQSE02           BOH Buy Order N
     C                     KFLD           WQSE03           BOL Load Number
      * Setup key
     C                     Z-ADD#1HMNB    WQSE01           CC Company Numb
     C                     Z-ADD#1BNNB    WQSE02           BOH Buy Order N
     C                     Z-ADD#1BONB    WQSE03           BOL Load Number
      * Establish starting position
     C           KRSSE     SETLL@EJCPBK                    *
     C           KRSSE     READE@EJCPBK                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0841' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     #1OXNB           BOLW Movement N
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDEJBOMV    #1OXNB           BOLW Movement N
     C                     GOTO SEEXIT                     *QUIT
     C           KRSSE     READE@EJCPBK                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Hog Class Resale  RT - Hog Classification  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN A8FBST    WQSF01           HC Class Type
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           HC Class Type
      * Setup key
     C                     MOVEL#1LLST    WQSF01           HC Class Type
      * Establish starting position
     C           KRSSF     SETLL@A8RETX                    *
     C           KRSSF     READE@A8RETX                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0075' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #1BECD           HC Class Code
     C                     MOVEL*BLANK    #DBDTX           HC Description
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA8BECD    #1BECD           HC Class Code
     C                     MOVELA8BDTX    #DBDTX           HC Description
     C                     GOTO SFEXIT                     *QUIT
     C           KRSSF     READE@A8RETX                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Hog Class Qualify RT - Hog Classification  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAFBST    WQSG01           HC Class Type
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           HC Class Type
      * Setup key
     C                     MOVEL#1LLST    WQSG01           HC Class Type
      * Establish starting position
     C           KRSSG     SETLL@A8RESC                    *
     C           KRSSG     READE@A8RESC                  90*
      * Data record not found
     C   90                MOVEL'PRK0075' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWABECD    #1BECD           HC Class Code
     C                     MOVELWABDTX    #DBDTX           HC Description
     C                     GOTO SGEXIT                     *QUIT
     C           KRSSG     READE@A8RESC                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Sch Shift/Shp Hd  RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           AXHMNB           BOH Company Num
     C                     KFLD           AXBNNB           BOH Buy Order N
     C                     KFLD           AXBONB           BOL Load Number
      * Setup key
     C                     Z-ADD#1HMNB    AXHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    AXBNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    AXBONB           BOL Load Number
      * Establish starting position
     C           KRSSH     CHAIN@AXCPBX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0051' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0004           BOL Pln Head De
     C                     MOVEL*BLANK    #1LIST           BOL Scheduled K
     C                     Z-ADD*ZERO     YL0005           BOL Shipped Hea
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAXBPNB    YL0004           BOL Pln Head De
     C                     MOVELAXO9ST    #1LIST           BOL Scheduled K
     C                     Z-ADDAXLDSH    YL0005           BOL Shipped Hea
     C                     GOTO SHEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Mvmnt,Farm f/BOL  RT - Delivery Sched Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN AEHMNB    WQSI01           BOH Company Num
     C           *LIKE     DEFN AEBNNB    WQSI02           BOH Buy Order N
     C           *LIKE     DEFN AEBONB    WQSI03           BOL Load Number
     C           *LIKE     DEFN AEE0DT    WQSI04           DSH Kill Date
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           BOH Company Num
     C                     KFLD           WQSI02           BOH Buy Order N
     C                     KFLD           WQSI03           BOL Load Number
     C                     KFLD           WQSI04           DSH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQSI01           BOH Company Num
     C                     Z-ADDP1BNNB    WQSI02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQSI03           BOL Load Number
     C                     Z-ADDP1B0DT    WQSI04           DSH Kill Date
      * Establish starting position
     C           KRSSI     SETLL@AECPI5                    *
     C           KRSSI     READE@AECPI5                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1028' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0006           DSD Farm Site C
     C                     Z-ADD*ZERO     #1OXNB           DSD Movement Nu
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAEH1A1    YL0006           DSD Farm Site C
     C                     Z-ADDAEH3A1    #1OXNB           DSD Movement Nu
     C                     GOTO SIEXIT                     *QUIT
     C           KRSSI     READE@AECPI5                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Movement Number   RT - Delivery Tracking  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHMNB    WQSJ01           BOH Company Num
     C           *LIKE     DEFN WBBNNB    WQSJ02           BOH Buy Order N
     C           *LIKE     DEFN WBBONB    WQSJ03           BOL Load Number
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           BOH Company Num
     C                     KFLD           WQSJ02           BOH Buy Order N
     C                     KFLD           WQSJ03           BOL Load Number
      * Setup key
     C                     Z-ADDP1HMNB    WQSJ01           BOH Company Num
     C                     Z-ADDP1BNNB    WQSJ02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQSJ03           BOL Load Number
      * Establish starting position
     C           KRSSJ     SETLL@AFCPI4                    *
     C           KRSSJ     READE@AFCPI4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1030' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     #1OXNB           DT Movement Num
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBIEA1    #1OXNB           DT Movement Num
     C           KRSSJ     READE@AFCPI4                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#1BDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSSK     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVELWUCRTX    #DBCTX           DF Description
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7BCTX    #DBCTX           DF Description
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Hog Class Desc    RT - Hog Classification  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WCBECD           HC Class Code
      * Setup key
     C                     MOVELA1BECD    WCBECD           HC Class Code
      * Establish starting position
     C           KRSSL     CHAIN@A8REDA              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0075' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVELWUCRTX    #DBDTX           HC Description
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCBDTX    #DBDTX           HC Description
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Prdcr Vendor#,Src RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           ACABCD           PD Producer Cod
      * Setup key
     C                     MOVELP1ABCD    ACABCD           PD Producer Cod
      * Establish starting position
     C           KRSSM     CHAIN@ACREAI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0009' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUGCNB           PD VND Address
     C                     MOVEL*BLANK    #1LKST           SR Source Code
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDACGCNB    WUGCNB           PD VND Address
     C                     MOVELACAACD    #1LKST           SR Source Code
     C                     GOTO SMEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Site ID/Prod Subs RT - Tattoo Header EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           DNHMNB           BOH Company Num
     C                     KFLD           DNBNNB           BOH Buy Order N
     C                     KFLD           DNBONB           BOL Load Number
     C                     KFLD           DNCVNB           TH Tattoo Numbe
     C                     KFLD           DNB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    DNHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    DNBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    DNBONB           BOL Load Number
     C                     Z-ADDP1CVNB    DNCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    DNB0DT           TH Kill Date
      * Establish starting position
     C           KRSSN     CHAIN@DNCPUY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0637' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DNYCD           PS Site ID
     C                     MOVEL*BLANK    #DOVCD           Producer Subsid
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNNYCD    #DNYCD           PS Site ID
     C                     MOVELDNOVCD    #DOVCD           Producer Subsid
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv PL Vnd Nbr, state RT - Producer Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           AFABCD           PD Producer Cod
     C                     KFLD           AFAECD           PL Location Cod
      * Setup key
     C                     MOVELP1ABCD    AFABCD           PD Producer Cod
     C                     MOVELP1AECD    AFAECD           PL Location Cod
      * Establish starting position
     C           KRSSO     CHAIN@AFREAR              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0015' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DA8TX           PL Name
     C                     Z-ADD*ZERO     WUGLNB           Pl VND Address
     C                     MOVEL*BLANK    #1NZTX           PL State Code
     C                     MOVEL*BLANK    #DQTST           PL Site ID Requ
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAFA8TX    #DA8TX           PL Name
     C                     Z-ADDAFGLNB    WUGLNB           Pl VND Address
     C                     MOVELAFN0TX    #1NZTX           PL State Code
     C                     MOVELAFQTST    #DQTST           PL Site ID Requ
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Site State ActOnlyRT - Producer Site  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           ATABCD           PD Producer Cod
     C                     KFLD           ATNYCD           PS Site ID
      * Setup key
     C                     MOVELP1ABCD    ATABCD           PD Producer Cod
     C                     MOVEL#DNYCD    ATNYCD           PS Site ID
      * Establish starting position
     C           KRSSP     CHAIN@ATRELM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1137' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #1NZTX           PS State
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.RS Record Status is Active
     C           ATAJST    IFEQ 'A'                        *IF
      * PAR = DB1 By name
     C                     MOVELATT2TX    #1NZTX           PS State
     C                     ELSE
      * CASE: *OTHERWISE
      * PAR = CON By name
     C                     MOVEL*BLANK    #1NZTX           PS State
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Rtv PL Vnd Nbr, state RT - Producer Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           AFABCD           PD Producer Cod
     C                     KFLD           AFAECD           PL Location Cod
      * Setup key
     C                     MOVELP1ABCD    AFABCD           PD Producer Cod
     C                     MOVELP1AECD    AFAECD           PL Location Cod
      * Establish starting position
     C           KRSSQ     CHAIN@AFREAR              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0015' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DQTST           PL Site ID Requ
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAFQTST    #DQTST           PL Site ID Requ
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv Source Type       RT - Source  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           AAAACD           SR Source Code
      * Setup key
     C                     MOVEL#1LKST    AAAACD           SR Source Code
      * Establish starting position
     C           KRSSR     CHAIN@AAREAC              90    *
      * Data record not found
     C   90                MOVEL'PRK0005' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAAIXST    #1KAST           SR Type
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv Shipped Head      RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           AXHMNB           BOH Company Num
     C                     KFLD           AXBNNB           BOH Buy Order N
     C                     KFLD           AXBONB           BOL Load Number
      * Setup key
     C                     Z-ADD#1HMNB    AXHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    AXBNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    AXBONB           BOL Load Number
      * Establish starting position
     C           KRSSS     CHAIN@AXCPBX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0051' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0005           BOL Shipped Hea
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAXLDSH    YL0005           BOL Shipped Hea
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Rtv Tattoo Def-10&Cls RT - Tattoo Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1         WUODNB           Defect Count Us
      * Declare restrictor key work fields
     C           *LIKE     DEFN DZHMNB    WQST01           BOH Company Num
     C           *LIKE     DEFN DZBNNB    WQST02           BOH Buy Order N
     C           *LIKE     DEFN DZBONB    WQST03           BOL Load Number
     C           *LIKE     DEFN DZCVNB    WQST04           TH Tattoo Numbe
     C           *LIKE     DEFN DZB0DT    WQST05           TH Kill Date
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST01           BOH Company Num
     C                     KFLD           WQST02           BOH Buy Order N
     C                     KFLD           WQST03           BOL Load Number
     C                     KFLD           WQST04           TH Tattoo Numbe
     C                     KFLD           WQST05           TH Kill Date
      * Setup key
     C                     Z-ADD#1HMNB    WQST01           BOH Company Num
     C                     Z-ADD#1BNNB    WQST02           BOH Buy Order N
     C                     Z-ADD#1BONB    WQST03           BOL Load Number
     C                     Z-ADD#1CVNB    WQST04           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    WQST05           TH Kill Date
      * Establish starting position
     C           KRSST     SETLL@DZREX3                    *
     C           KRSST     READE@DZREX3                  90*
      * Data record not found
     C   90                MOVEL'PRK0738' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: WRK.Defect Count Usr is One
     C           WUODNB    IFEQ 1                          *IF
     C                     MOVELDZBDCD    #DGUCD           Defect User  1
     C                     Z-ADDDZLJNB    #DF1NB           Defect HD user
     C                     MOVELDZB7SS    #DCLSS           Defect Cls User
     C                     Z-ADD2         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Two
     C           WUODNB    IFEQ 2                          *IF
     C                     MOVELDZBDCD    #DGVCD           Defect User  2
     C                     Z-ADDDZLJNB    #DFWNB           Defect HD user
     C                     MOVELDZB7SS    #DCMSS           Defect Cls User
     C                     Z-ADD3         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Three
     C           WUODNB    IFEQ 3                          *IF
     C                     MOVELDZBDCD    #DGWCD           Defect User  3
     C                     Z-ADDDZLJNB    #DFYNB           Defect HD user
     C                     MOVELDZB7SS    #DCNSS           Defect Cls User
     C                     Z-ADD4         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Four
     C           WUODNB    IFEQ 4                          *IF
     C                     MOVELDZBDCD    #DGXCD           Defect User  4
     C                     Z-ADDDZLJNB    #DFUNB           Defect HD user
     C                     MOVELDZB7SS    #DCOSS           Defect Cls User
     C                     Z-ADD5         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Five
     C           WUODNB    IFEQ 5                          *IF
     C                     MOVELDZBDCD    #DGYCD           Defect User  5
     C                     Z-ADDDZLJNB    #DO3NB           Defect HD user
     C                     MOVELDZB7SS    #DCPSS           Defect Cls User
     C                     Z-ADD6         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Six
     C           WUODNB    IFEQ 6                          *IF
     C                     MOVELDZBDCD    #DGZCD           Defect User  6
     C                     Z-ADDDZLJNB    #DO4NB           Defect HD user
     C                     MOVELDZB7SS    #DCQSS           Defect Cls User
     C                     Z-ADD7         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Seven
     C           WUODNB    IFEQ 7                          *IF
     C                     MOVELDZBDCD    #DG0CD           Defect User  7
     C                     Z-ADDDZLJNB    #DO5NB           Defect HD user
     C                     MOVELDZB7SS    #DCRSS           Defect Cls User
     C                     Z-ADD8         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Eight
     C           WUODNB    IFEQ 8                          *IF
     C                     MOVELDZBDCD    #DG1CD           Defect User  8
     C                     Z-ADDDZLJNB    #DFONB           Defect HD user
     C                     MOVELDZB7SS    #DCSSS           Defect Cls User
     C                     Z-ADD9         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Nine
     C           WUODNB    IFEQ 9                          *IF
     C                     MOVELDZBDCD    #DG2CD           Defect User  9
     C                     Z-ADDDZLJNB    #DFXNB           Defect HD user
     C                     MOVELDZB7SS    #DCTSS           Defect Cls User
     C                     Z-ADD10        WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Ten
     C           WUODNB    IFEQ 10                         *IF
     C                     MOVELDZBDCD    #DG3CD           Defect User 10
     C                     Z-ADDDZLJNB    #DFTNB           Defect HD user
     C                     MOVELDZB7SS    #DCUSS           Defect Cls User
     C                     Z-ADD11        WUODNB           Defect Count Us
     C                     GOTO STEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSST     READE@DZREX3                  90*
     C                     ENDDO
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DGUCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSSU     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DGVCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSSV     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DGWCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSSW     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DGXCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSSX     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DGYCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSSY     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DGZCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSSZ     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DG0CD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSTA     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DG1CD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSTB     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DG2CD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSTC     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DG3CD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSTD     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * Rtv Tattoo Detail     RT - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           A2HMNB           BOH Company Num
     C                     KFLD           A2BNNB           BOH Buy Order N
     C                     KFLD           A2BONB           BOL Load Number
     C                     KFLD           A2CVNB           TH Tattoo Numbe
     C                     KFLD           A2B0DT           TH Kill Date
     C                     KFLD           A2C2NB           TD Sequence Num
      * Setup key
     C                     Z-ADD#1HMNB    A2HMNB           BOH Company Num
     C                     Z-ADD#1BNNB    A2BNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    A2BONB           BOL Load Number
     C                     Z-ADD#1CVNB    A2CVNB           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    A2B0DT           TH Kill Date
     C                     Z-ADD1         A2C2NB           TD Sequence Num
      * Establish starting position
     C           KRSTE     CHAIN@A2CPDG              90    *
      * Data record not found
     C   90                MOVEL'PRK0063' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDA2HVNB    WUHVNB           Pen Company Num
     C                     MOVELA2CMCD    #DCMCD           Pen Number
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * Rtv Producer Name     RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           ACABCD           PD Producer Cod
      * Setup key
     C                     MOVELP1ABCD    ACABCD           PD Producer Cod
      * Establish starting position
     C           KRSTF     CHAIN@ACREAI              90    *
      * Data record not found
     C   90                MOVEL'PRK0009' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELACAGTX    #DAGTX           PD Name
     C                     ENDIF
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * Rtv Pdctn Loc Name    RT - Producer Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           AFABCD           PD Producer Cod
     C                     KFLD           AFAECD           PL Location Cod
      * Setup key
     C                     MOVELP1ABCD    AFABCD           PD Producer Cod
     C                     MOVELP1AECD    AFAECD           PL Location Cod
      * Establish starting position
     C           KRSTG     CHAIN@AFREAR              90    *
      * Data record not found
     C   90                MOVEL'PRK0015' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAFA8TX    #DA8TX           PL Name
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * Rtv Hog Class         RT - Hog Classification  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           WCBECD           HC Class Code
      * Setup key
     C                     MOVEL#1BECD    WCBECD           HC Class Code
      * Establish starting position
     C           KRSTH     CHAIN@A8REDA              90    *
      * Data record not found
     C   90                MOVEL'PRK0075' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCBDTX    #DBDTX           HC Description
     C                     MOVELWCBXST    WUBXST           HC Defect Requi
     C                     MOVELWCBYST    WUBYST           HC Price Requir
     C                     MOVELWCBITX    WUBITX           HC Resolution
     C                     MOVELWCB0ST    WUB0ST           HC Qualificatio
     C                     MOVELWCFBST    WULLST           HC Class Type
     C                     ENDIF
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * Rtv Site State ActOnlyRT - Producer Site  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           ATABCD           PD Producer Cod
     C                     KFLD           ATNYCD           PS Site ID
      * Setup key
     C                     MOVELP1ABCD    ATABCD           PD Producer Cod
     C                     MOVEL#DNYCD    ATNYCD           PS Site ID
      * Establish starting position
     C           KRSTI     CHAIN@ATRELM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1137' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #1NZTX           PS State
     C                     GOTO TIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.RS Record Status is Active
     C           ATAJST    IFEQ 'A'                        *IF
      * PAR = DB1 By name
     C                     MOVELATT2TX    #1NZTX           PS State
     C                     ELSE
      * CASE: *OTHERWISE
      * PAR = CON By name
     C                     MOVEL*BLANK    #1NZTX           PS State
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * Rtv PrdSiteMil CoMilStRT - Producer Site Mileage  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           ASABCD           PD Producer Cod
     C                     KFLD           ASNYCD           PS Site ID
     C                     KFLD           ASLKA1           PSM Company Num
      * Setup key
     C                     MOVELP1ABCD    ASABCD           PD Producer Cod
     C                     MOVEL#DNYCD    ASNYCD           PS Site ID
     C                     Z-ADDP1HMNB    ASLKA1           PSM Company Num
      * Establish starting position
     C           KRSTJ     CHAIN@ASREK9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1132' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0008           PSM Miles to Co
     C                     MOVEL*BLANK    #1NZTX           PS State
     C                     GOTO TJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Rtv Site State ActOnlyRT - Producer Site  * 
     C                     EXSR TKRVGN
      * PAR = DB1 By name
     C                     Z-ADDASLLA1    YL0008           PSM Miles to Co
     C                     ENDIF
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKRVGN    BEGSR
      *================================================================
      * Rtv Site State ActOnlyRT - Producer Site  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTK     KLIST
     C                     KFLD           ATABCD           PD Producer Cod
     C                     KFLD           ATNYCD           PS Site ID
      * Setup key
     C                     MOVELASABCD    ATABCD           PD Producer Cod
     C                     MOVELASNYCD    ATNYCD           PS Site ID
      * Establish starting position
     C           KRSTK     CHAIN@ATRELM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1137' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #1NZTX           PS State
     C                     GOTO TKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.RS Record Status is Active
     C           ATAJST    IFEQ 'A'                        *IF
      * PAR = DB1 By name
     C                     MOVELATT2TX    #1NZTX           PS State
     C                     ELSE
      * CASE: *OTHERWISE
      * PAR = CON By name
     C                     MOVEL*BLANK    #1NZTX           PS State
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLRVGN    BEGSR
      *================================================================
      * Val ProdSubsidiary    RT - Producer Subsidiary  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTL     KLIST
     C                     KFLD           WDABCD           PD Producer Cod
     C                     KFLD           WDOVCD           Producer Subsid
      * Setup key
     C                     MOVELP1ABCD    WDABCD           PD Producer Cod
     C                     MOVEL#DOVCD    WDOVCD           Producer Subsid
      * Establish starting position
     C           KRSTL     CHAIN@A8REPM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1213' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,002   W0RTN            *Return code
     C                     GOTO TLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMRVGN    BEGSR
      *================================================================
      * Val Hog Defect&CLS    RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEBDCD    WQTM01           DF Defect Code
      * Define keylist
     C           KRSTM     KLIST
     C                     KFLD           WQTM01           DF Defect Code
      * Setup key
     C                     MOVEL#DGUCD    WQTM01           DF Defect Code
      * Establish starting position
     C           KRSTM     SETLL@A7REMM                    *
     C           KRSTM     READE@A7REMM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,002   WURTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #DCLSS           DF Classificati
     C                     MOVEL*BLANK    WURTN            *Return code
     C                     GOTO TMEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    WURTN            *Return code
     C                     MOVEL'999'     WURTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWERYST    #DCLSS           DF Classificati
     C           KRSTM     READE@A7REMM                  90*
     C                     ENDDO
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNRVGN    BEGSR
      *================================================================
      * Val Hog Defect&CLS    RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEBDCD    WQTN01           DF Defect Code
      * Define keylist
     C           KRSTN     KLIST
     C                     KFLD           WQTN01           DF Defect Code
      * Setup key
     C                     MOVEL#DGVCD    WQTN01           DF Defect Code
      * Establish starting position
     C           KRSTN     SETLL@A7REMM                    *
     C           KRSTN     READE@A7REMM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,002   WURTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #DCMSS           DF Classificati
     C                     MOVEL*BLANK    WURTN            *Return code
     C                     GOTO TNEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    WURTN            *Return code
     C                     MOVEL'999'     WURTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWERYST    #DCMSS           DF Classificati
     C           KRSTN     READE@A7REMM                  90*
     C                     ENDDO
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TORVGN    BEGSR
      *================================================================
      * Val Hog Defect&CLS    RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEBDCD    WQTO01           DF Defect Code
      * Define keylist
     C           KRSTO     KLIST
     C                     KFLD           WQTO01           DF Defect Code
      * Setup key
     C                     MOVEL#DGWCD    WQTO01           DF Defect Code
      * Establish starting position
     C           KRSTO     SETLL@A7REMM                    *
     C           KRSTO     READE@A7REMM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,002   WURTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #DCNSS           DF Classificati
     C                     MOVEL*BLANK    WURTN            *Return code
     C                     GOTO TOEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    WURTN            *Return code
     C                     MOVEL'999'     WURTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWERYST    #DCNSS           DF Classificati
     C           KRSTO     READE@A7REMM                  90*
     C                     ENDDO
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPRVGN    BEGSR
      *================================================================
      * Val Hog Defect&CLS    RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEBDCD    WQTP01           DF Defect Code
      * Define keylist
     C           KRSTP     KLIST
     C                     KFLD           WQTP01           DF Defect Code
      * Setup key
     C                     MOVEL#DGXCD    WQTP01           DF Defect Code
      * Establish starting position
     C           KRSTP     SETLL@A7REMM                    *
     C           KRSTP     READE@A7REMM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,002   WURTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #DCOSS           DF Classificati
     C                     MOVEL*BLANK    WURTN            *Return code
     C                     GOTO TPEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    WURTN            *Return code
     C                     MOVEL'999'     WURTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWERYST    #DCOSS           DF Classificati
     C           KRSTP     READE@A7REMM                  90*
     C                     ENDDO
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQRVGN    BEGSR
      *================================================================
      * Val Hog Defect&CLS    RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEBDCD    WQTQ01           DF Defect Code
      * Define keylist
     C           KRSTQ     KLIST
     C                     KFLD           WQTQ01           DF Defect Code
      * Setup key
     C                     MOVEL#DGYCD    WQTQ01           DF Defect Code
      * Establish starting position
     C           KRSTQ     SETLL@A7REMM                    *
     C           KRSTQ     READE@A7REMM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,002   WURTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #DCPSS           DF Classificati
     C                     MOVEL*BLANK    WURTN            *Return code
     C                     GOTO TQEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    WURTN            *Return code
     C                     MOVEL'999'     WURTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWERYST    #DCPSS           DF Classificati
     C           KRSTQ     READE@A7REMM                  90*
     C                     ENDDO
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRRVGN    BEGSR
      *================================================================
      * Val Hog Defect&CLS    RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEBDCD    WQTR01           DF Defect Code
      * Define keylist
     C           KRSTR     KLIST
     C                     KFLD           WQTR01           DF Defect Code
      * Setup key
     C                     MOVEL#DGZCD    WQTR01           DF Defect Code
      * Establish starting position
     C           KRSTR     SETLL@A7REMM                    *
     C           KRSTR     READE@A7REMM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,002   WURTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #DCQSS           DF Classificati
     C                     MOVEL*BLANK    WURTN            *Return code
     C                     GOTO TREXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    WURTN            *Return code
     C                     MOVEL'999'     WURTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWERYST    #DCQSS           DF Classificati
     C           KRSTR     READE@A7REMM                  90*
     C                     ENDDO
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         TSRVGN    BEGSR
      *================================================================
      * Val Hog Defect&CLS    RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEBDCD    WQTS01           DF Defect Code
      * Define keylist
     C           KRSTS     KLIST
     C                     KFLD           WQTS01           DF Defect Code
      * Setup key
     C                     MOVEL#DG0CD    WQTS01           DF Defect Code
      * Establish starting position
     C           KRSTS     SETLL@A7REMM                    *
     C           KRSTS     READE@A7REMM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,002   WURTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #DCRSS           DF Classificati
     C                     MOVEL*BLANK    WURTN            *Return code
     C                     GOTO TSEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    WURTN            *Return code
     C                     MOVEL'999'     WURTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWERYST    #DCRSS           DF Classificati
     C           KRSTS     READE@A7REMM                  90*
     C                     ENDDO
      *================================================================
     CSR         TSEXIT    ENDSR
      /EJECT
     CSR         TTRVGN    BEGSR
      *================================================================
      * Val Hog Defect&CLS    RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEBDCD    WQTT01           DF Defect Code
      * Define keylist
     C           KRSTT     KLIST
     C                     KFLD           WQTT01           DF Defect Code
      * Setup key
     C                     MOVEL#DG1CD    WQTT01           DF Defect Code
      * Establish starting position
     C           KRSTT     SETLL@A7REMM                    *
     C           KRSTT     READE@A7REMM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,002   WURTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #DCSSS           DF Classificati
     C                     MOVEL*BLANK    WURTN            *Return code
     C                     GOTO TTEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    WURTN            *Return code
     C                     MOVEL'999'     WURTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWERYST    #DCSSS           DF Classificati
     C           KRSTT     READE@A7REMM                  90*
     C                     ENDDO
      *================================================================
     CSR         TTEXIT    ENDSR
      /EJECT
     CSR         TURVGN    BEGSR
      *================================================================
      * Val Hog Defect&CLS    RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEBDCD    WQTU01           DF Defect Code
      * Define keylist
     C           KRSTU     KLIST
     C                     KFLD           WQTU01           DF Defect Code
      * Setup key
     C                     MOVEL#DG2CD    WQTU01           DF Defect Code
      * Establish starting position
     C           KRSTU     SETLL@A7REMM                    *
     C           KRSTU     READE@A7REMM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,002   WURTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #DCTSS           DF Classificati
     C                     MOVEL*BLANK    WURTN            *Return code
     C                     GOTO TUEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    WURTN            *Return code
     C                     MOVEL'999'     WURTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWERYST    #DCTSS           DF Classificati
     C           KRSTU     READE@A7REMM                  90*
     C                     ENDDO
      *================================================================
     CSR         TUEXIT    ENDSR
      /EJECT
     CSR         TVRVGN    BEGSR
      *================================================================
      * Val Hog Defect&CLS    RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEBDCD    WQTV01           DF Defect Code
      * Define keylist
     C           KRSTV     KLIST
     C                     KFLD           WQTV01           DF Defect Code
      * Setup key
     C                     MOVEL#DG3CD    WQTV01           DF Defect Code
      * Establish starting position
     C           KRSTV     SETLL@A7REMM                    *
     C           KRSTV     READE@A7REMM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,002   WURTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #DCUSS           DF Classificati
     C                     MOVEL*BLANK    WURTN            *Return code
     C                     GOTO TVEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    WURTN            *Return code
     C                     MOVEL'999'     WURTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWERYST    #DCUSS           DF Classificati
     C           KRSTV     READE@A7REMM                  90*
     C                     ENDDO
      *================================================================
     CSR         TVEXIT    ENDSR
      /EJECT
     CSR         TWRVGN    BEGSR
      *================================================================
      * Rtv EDI Trading Prt#  RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTW     KLIST
     C                     KFLD           ACABCD           PD Producer Cod
      * Setup key
     C                     MOVELP1ABCD    ACABCD           PD Producer Cod
      * Establish starting position
     C           KRSTW     CHAIN@ACREAI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0009' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUGJNB           PD EDI Trading
     C                     GOTO TWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDACGJNB    WUGJNB           PD EDI Trading
     C                     ENDIF
      *================================================================
     CSR         TWEXIT    ENDSR
      /EJECT
     CSR         TXRVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTX     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DGUCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSTX     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO TXEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         TXEXIT    ENDSR
      /EJECT
     CSR         TYRVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTY     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DGVCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSTY     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO TYEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         TYEXIT    ENDSR
      /EJECT
     CSR         TZRVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTZ     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DGWCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSTZ     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO TZEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         TZEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * get defects/hd
      *================================================================
     C                     MOVEL'Y'       WUL9ST           Display Output
     C                     MOVEL'Y'       WUMAST           Display Output
     C                     MOVEL*BLANK    #DGUCD           Defect User  1
     C                     MOVEL*BLANK    #DGVCD           Defect User  2
     C                     MOVEL*BLANK    #DGWCD           Defect User  3
     C                     MOVEL*BLANK    #DGXCD           Defect User  4
     C                     MOVEL*BLANK    #DGYCD           Defect User  5
     C                     MOVEL*BLANK    #DGZCD           Defect User  6
     C                     MOVEL*BLANK    #DG0CD           Defect User  7
     C                     MOVEL*BLANK    #DG1CD           Defect User  8
     C                     MOVEL*BLANK    #DG2CD           Defect User  9
     C                     MOVEL*BLANK    #DG3CD           Defect User 10
     C                     Z-ADD*ZERO     #DF1NB           Defect HD user
     C                     Z-ADD*ZERO     #DFWNB           Defect HD user
     C                     Z-ADD*ZERO     #DFYNB           Defect HD user
     C                     Z-ADD*ZERO     #DFUNB           Defect HD user
     C                     Z-ADD*ZERO     #DO3NB           Defect HD user
     C                     Z-ADD*ZERO     #DO4NB           Defect HD user
     C                     Z-ADD*ZERO     #DO5NB           Defect HD user
     C                     Z-ADD*ZERO     #DFONB           Defect HD user
     C                     Z-ADD*ZERO     #DFXNB           Defect HD user
     C                     Z-ADD*ZERO     #DFTNB           Defect HD user
      * Rtv Tattoo Def-10&Cls RT - Tattoo Defect  * 
     C                     EXSR SDRVGN
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DTL.TH Hog Class Type is Subject
      *   |- c2    : DTL.TH Source Type is External
      *   '-
     C           #1LLST    IFEQ 'S'                        *IF
     C           #1KAST    OREQ 'E'                        *OR
     C                     MOVEL'Y'       WUMAST           Display Output
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Get Defect/Hd
      *================================================================
     C                     MOVEL*BLANK    #DGUCD           Defect User  1
     C                     MOVEL*BLANK    #DGVCD           Defect User  2
     C                     MOVEL*BLANK    #DGWCD           Defect User  3
     C                     MOVEL*BLANK    #DGXCD           Defect User  4
     C                     MOVEL*BLANK    #DGYCD           Defect User  5
     C                     MOVEL*BLANK    #DGZCD           Defect User  6
     C                     MOVEL*BLANK    #DG0CD           Defect User  7
     C                     MOVEL*BLANK    #DG1CD           Defect User  8
     C                     MOVEL*BLANK    #DG2CD           Defect User  9
     C                     MOVEL*BLANK    #DG3CD           Defect User 10
     C                     Z-ADD*ZERO     #DF1NB           Defect HD user
     C                     Z-ADD*ZERO     #DFWNB           Defect HD user
     C                     Z-ADD*ZERO     #DFYNB           Defect HD user
     C                     Z-ADD*ZERO     #DFUNB           Defect HD user
     C                     Z-ADD*ZERO     #DO3NB           Defect HD user
     C                     Z-ADD*ZERO     #DO4NB           Defect HD user
     C                     Z-ADD*ZERO     #DO5NB           Defect HD user
     C                     Z-ADD*ZERO     #DFONB           Defect HD user
     C                     Z-ADD*ZERO     #DFXNB           Defect HD user
     C                     Z-ADD*ZERO     #DFTNB           Defect HD user
      * Rtv Tattoo Def-10&Cls RT - Tattoo Defect  * 
     C                     EXSR STRVGN
      * CASE: DTL.TH Hog Class Type is Not Market
     C           #1LLST    IFEQ 'R'                        *IF
     C           #1LLST    OREQ 'S'
      * If Resale/internal
      * CASE: WRK.@Status Internal (Y/N) is Yes
     C           WUKPST    IFEQ 'Y'                        *IF
      * Chk Def Scale Wt Req  IF
      * If any defect has scale weight required, quit checking the defect
     C                     MOVEL'N'       WUR3ST           Scale Wt Requir
      * CASE: PAR.Defect User  1 NE WRK.Blank USR
     C           #DGUCD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR SURVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Defect User  2 NE WRK.Blank USR
     C           #DGVCD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR SVRVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Defect User  3 NE WRK.Blank USR
     C           #DGWCD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR SWRVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Defect User  4 NE WRK.Blank USR
     C           #DGXCD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR SXRVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Defect User  5 NE WRK.Blank USR
     C           #DGYCD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR SYRVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Defect User  6 NE WRK.Blank USR
     C           #DGZCD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR SZRVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Defect User  7 NE WRK.Blank USR
     C           #DG0CD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR TARVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Defect User  8 NE WRK.Blank USR
     C           #DG1CD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR TBRVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Defect User  9 NE WRK.Blank USR
     C           #DG2CD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR TCRVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Defect User 10 NE WRK.Blank USR
     C           #DG3CD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR TDRVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * If Defect Scale Wgt Req dont calc TH Head Received
      * CASE: WRK.Scale Wt Required     USR is Yes
     C           WUR3ST    IFEQ 'Y'                        *IF
     C                     Z-ADD*ZERO     #DB5NB           Head Total USR
     C                     MOVEL*BLANK    #DCMCD           Pen Number
     C                     MOVEL*BLANK    WUCBCD           Pen Usr
     C                     ELSE
      * CASE: *OTHERWISE
      * Rsl/Int-- Sum Defect head
      * DTL.Head Total USR =
      *    *COMPUTE (x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8 + x9 + x10)
      * x1    : DTL.Defect HD user 1
      * +     : PGM.*Synon (17,7) work field
      * x2    : DTL.Defect HD user 2
      * +     : PGM.*Synon (17,7) work field
      * x3    : DTL.Defect HD user 3
      * +     : PGM.*Synon (17,7) work field
      * x4    : DTL.Defect HD user 4
      * +     : PGM.*Synon (17,7) work field
      * x5    : DTL.Defect HD user 5
      * +     : PGM.*Synon (17,7) work field
      * x6    : DTL.Defect HD user 6
      * +     : PGM.*Synon (17,7) work field
      * x7    : DTL.Defect HD user 7
      * +     : PGM.*Synon (17,7) work field
      * x8    : DTL.Defect HD user 8
      * +     : PGM.*Synon (17,7) work field
      * x9    : DTL.Defect HD user 9
      * +     : PGM.*Synon (17,7) work field
      * x10   : DTL.Defect HD user 10
     C           #DF1NB    ADD  #DFWNB    W0WD08           *Synon (17,7) w
     C           W0WD08    ADD  #DFYNB    W0WD07           *Synon (17,7) w
     C           W0WD07    ADD  #DFUNB    W0WD06           *Synon (17,7) w
     C           W0WD06    ADD  #DO3NB    W0WD05           *Synon (17,7) w
     C           W0WD05    ADD  #DO4NB    W0WD04           *Synon (17,7) w
     C           W0WD04    ADD  #DO5NB    W0WD03           *Synon (17,7) w
     C           W0WD03    ADD  #DFONB    W0WD02           *Synon (17,7) w
     C           W0WD02    ADD  #DFXNB    W0WD01           *Synon (17,7) w
     C           W0WD01    ADD  #DFTNB    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    #DB5NB           Head Total USR
      * Rtv Pen
      * Rtv Tattoo Detail     RT - Tattoo Detail  * 
     C                     EXSR TERVGN
     C                     MOVEL#DCMCD    WUCBCD           Pen Usr
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Document history on site   Create Str 061508 slm
      *================================================================
      * **  042606 Only if the Producer Site is required
      * *********************************************
      * ** 12/28/05 LJB - If F4 to select Site ID or if Site ID was
      * **     manually entered, validate against the Producer
      * **     Site Mileage file. Error if record does not exist.
      * **     If TH Source Code=CPR then Site ID is Required
      * ** 1/4/06 LJB - If Site ID is entered, validate against the
      * **   Producer Site Mileage file. Error if no rec found.
      * *********************************************
      * **  042606 Producer site get the state code
      * **         allow the F4 if producer site is required Y
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * F4  on Defects
      *================================================================
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Cursor field <IS> DTL.Defect User  1
      *   |- c2    : DTL.*CMD key is *Prompt
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0CFL     IFEQ '#DGUCD'                   *IF
     C           *IN04     IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Sel Hog Defect        SR - Hog Defect  * 
     C                     CALL 'PKCWSRR'              90  Sel Hog Defect
     C                     PARM *BLANK    W0RTN   7
     C           #DGUCD    PARM #DGUCD    WQ0025  6        DF Defect Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKCWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9946  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Cursor field <IS> DTL.Defect User  2
      *   |- c2    : DTL.*CMD key is *Prompt
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0CFL     IFEQ '#DGVCD'                   *IF
     C           *IN04     IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Sel Hog Defect        SR - Hog Defect  * 
     C                     CALL 'PKCWSRR'              90  Sel Hog Defect
     C                     PARM *BLANK    W0RTN   7
     C           #DGVCD    PARM #DGVCD    WQ0026  6        DF Defect Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKCWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9948  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Cursor field <IS> DTL.Defect User  3
      *   |- c2    : DTL.*CMD key is *Prompt
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0CFL     IFEQ '#DGWCD'                   *IF
     C           *IN04     IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Sel Hog Defect        SR - Hog Defect  * 
     C                     CALL 'PKCWSRR'              90  Sel Hog Defect
     C                     PARM *BLANK    W0RTN   7
     C           #DGWCD    PARM #DGWCD    WQ0027  6        DF Defect Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKCWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9950  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Cursor field <IS> DTL.Defect User  4
      *   |- c2    : DTL.*CMD key is *Prompt
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0CFL     IFEQ '#DGXCD'                   *IF
     C           *IN04     IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Sel Hog Defect        SR - Hog Defect  * 
     C                     CALL 'PKCWSRR'              90  Sel Hog Defect
     C                     PARM *BLANK    W0RTN   7
     C           #DGXCD    PARM #DGXCD    WQ0028  6        DF Defect Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKCWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9952  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Cursor field <IS> DTL.Defect User  5
      *   |- c2    : DTL.*CMD key is *Prompt
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0CFL     IFEQ '#DGYCD'                   *IF
     C           *IN04     IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Sel Hog Defect        SR - Hog Defect  * 
     C                     CALL 'PKCWSRR'              90  Sel Hog Defect
     C                     PARM *BLANK    W0RTN   7
     C           #DGYCD    PARM #DGYCD    WQ0029  6        DF Defect Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKCWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9954  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Cursor field <IS> DTL.Defect User  6
      *   |- c2    : DTL.*CMD key is *Prompt
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0CFL     IFEQ '#DGZCD'                   *IF
     C           *IN04     IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Sel Hog Defect        SR - Hog Defect  * 
     C                     CALL 'PKCWSRR'              90  Sel Hog Defect
     C                     PARM *BLANK    W0RTN   7
     C           #DGZCD    PARM #DGZCD    WQ0030  6        DF Defect Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKCWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9956  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Cursor field <IS> DTL.Defect User  7
      *   |- c2    : DTL.*CMD key is *Prompt
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0CFL     IFEQ '#DG0CD'                   *IF
     C           *IN04     IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Sel Hog Defect        SR - Hog Defect  * 
     C                     CALL 'PKCWSRR'              90  Sel Hog Defect
     C                     PARM *BLANK    W0RTN   7
     C           #DG0CD    PARM #DG0CD    WQ0031  6        DF Defect Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKCWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9958  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Cursor field <IS> DTL.Defect User  8
      *   |- c2    : DTL.*CMD key is *Prompt
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0CFL     IFEQ '#DG1CD'                   *IF
     C           *IN04     IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Sel Hog Defect        SR - Hog Defect  * 
     C                     CALL 'PKCWSRR'              90  Sel Hog Defect
     C                     PARM *BLANK    W0RTN   7
     C           #DG1CD    PARM #DG1CD    WQ0032  6        DF Defect Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKCWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9960  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Cursor field <IS> DTL.Defect User  9
      *   |- c2    : DTL.*CMD key is *Prompt
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0CFL     IFEQ '#DG2CD'                   *IF
     C           *IN04     IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Sel Hog Defect        SR - Hog Defect  * 
     C                     CALL 'PKCWSRR'              90  Sel Hog Defect
     C                     PARM *BLANK    W0RTN   7
     C           #DG2CD    PARM #DG2CD    WQ0033  6        DF Defect Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKCWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9962  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Cursor field <IS> DTL.Defect User 10
      *   |- c2    : DTL.*CMD key is *Prompt
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0CFL     IFEQ '#DG3CD'                   *IF
     C           *IN04     IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Sel Hog Defect        SR - Hog Defect  * 
     C                     CALL 'PKCWSRR'              90  Sel Hog Defect
     C                     PARM *BLANK    W0RTN   7
     C           #DG3CD    PARM #DG3CD    WQ0034  6        DF Defect Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKCWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9964  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * validation of Defects
      *================================================================
      * Validate Class Type
     C                     EXSR UFSUBR                     Validate Class
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Validate Class Type
      *================================================================
      * val 1
      * CASE: DTL.Defect User  1 is Entered
     C           #DGUCD    IFNE *BLANK                     *IF
      * Val Market Defect     XF - Hog Defect  * 
     C                     CALL 'PLL6XFR'              90  Val Market Defe
     C                     PARM *BLANK    W0RTN   7
     C           #DGUCD    PARM #DGUCD    WQ0055  6        DF Defect Code
     C           #DCLSS    PARM #DCLSS    WQ0056  1        DF Classificati
     C                     PARM #1LLST    WQ0057  1        TH Hog Class Ty
     C           YL0009    PARM *BLANK    WQ0058  7        *Return code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLL6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9946  *
     C                     END
      * CASE: LCL.*Return code is Error Found
     C           YL0009    IFEQ 'ERROR'                    *IF
      * Setup message data for message
     C                     MOVELP1LLST    ZA0027           TH Hog Class Ty
     C                     MOVEL#DGUCD    ZA0028           Defect User  1
     C                     MOVEL#DCLSS    ZA0029           Class Df 1 Usr
      * Send message 'Defect NAllow on Hog Type'
     C                     MOVEL'PRK1197' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9946  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * val 2
      * CASE: DTL.Defect User  2 is Entered
     C           #DGVCD    IFNE *BLANK                     *IF
      * Val Market Defect     XF - Hog Defect  * 
     C                     CALL 'PLL6XFR'              90  Val Market Defe
     C                     PARM *BLANK    W0RTN   7
     C           #DGVCD    PARM #DGVCD    WQ0059  6        DF Defect Code
     C           #DCMSS    PARM #DCMSS    WQ0060  1        DF Classificati
     C                     PARM #1LLST    WQ0061  1        TH Hog Class Ty
     C           YL0009    PARM *BLANK    WQ0062  7        *Return code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLL6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9948  *
     C                     END
      * CASE: LCL.*Return code is Error Found
     C           YL0009    IFEQ 'ERROR'                    *IF
      * Setup message data for message
     C                     MOVELP1LLST    ZA0030           TH Hog Class Ty
     C                     MOVEL#DGVCD    ZA0031           Defect User  2
     C                     MOVEL#DCMSS    ZA0032           Class Df 2 Usr
      * Send message 'Defect NAllow on Hog Type'
     C                     MOVEL'PRK1197' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9948  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * val 3
      * CASE: DTL.Defect User  3 is Entered
     C           #DGWCD    IFNE *BLANK                     *IF
      * Val Market Defect     XF - Hog Defect  * 
     C                     CALL 'PLL6XFR'              90  Val Market Defe
     C                     PARM *BLANK    W0RTN   7
     C           #DGWCD    PARM #DGWCD    WQ0063  6        DF Defect Code
     C           #DCNSS    PARM #DCNSS    WQ0064  1        DF Classificati
     C                     PARM #1LLST    WQ0065  1        TH Hog Class Ty
     C           YL0009    PARM *BLANK    WQ0066  7        *Return code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLL6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9950  *
     C                     END
      * CASE: LCL.*Return code is Error Found
     C           YL0009    IFEQ 'ERROR'                    *IF
      * Setup message data for message
     C                     MOVELP1LLST    ZA0033           TH Hog Class Ty
     C                     MOVEL#DGWCD    ZA0034           Defect User  3
     C                     MOVEL#DCNSS    ZA0035           Class Df 3 Usr
      * Send message 'Defect NAllow on Hog Type'
     C                     MOVEL'PRK1197' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9950  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * val 4
      * CASE: DTL.Defect User  4 is Entered
     C           #DGXCD    IFNE *BLANK                     *IF
      * Val Market Defect     XF - Hog Defect  * 
     C                     CALL 'PLL6XFR'              90  Val Market Defe
     C                     PARM *BLANK    W0RTN   7
     C           #DGXCD    PARM #DGXCD    WQ0067  6        DF Defect Code
     C           #DCOSS    PARM #DCOSS    WQ0068  1        DF Classificati
     C                     PARM #1LLST    WQ0069  1        TH Hog Class Ty
     C           YL0009    PARM *BLANK    WQ0070  7        *Return code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLL6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9952  *
     C                     END
      * CASE: LCL.*Return code is Error Found
     C           YL0009    IFEQ 'ERROR'                    *IF
      * Setup message data for message
     C                     MOVELP1LLST    ZA0036           TH Hog Class Ty
     C                     MOVEL#DGXCD    ZA0037           Defect User  4
     C                     MOVEL#DCOSS    ZA0038           Class Df 4 Usr
      * Send message 'Defect NAllow on Hog Type'
     C                     MOVEL'PRK1197' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9952  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * val 5
      * CASE: DTL.Defect User  5 is Entered
     C           #DGYCD    IFNE *BLANK                     *IF
      * Val Market Defect     XF - Hog Defect  * 
     C                     CALL 'PLL6XFR'              90  Val Market Defe
     C                     PARM *BLANK    W0RTN   7
     C           #DGYCD    PARM #DGYCD    WQ0071  6        DF Defect Code
     C           #DCPSS    PARM #DCPSS    WQ0072  1        DF Classificati
     C                     PARM #1LLST    WQ0073  1        TH Hog Class Ty
     C           YL0009    PARM *BLANK    WQ0074  7        *Return code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLL6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9954  *
     C                     END
      * CASE: LCL.*Return code is Error Found
     C           YL0009    IFEQ 'ERROR'                    *IF
      * Setup message data for message
     C                     MOVELP1LLST    ZA0039           TH Hog Class Ty
     C                     MOVEL#DGYCD    ZA0040           Defect User  5
     C                     MOVEL#DCPSS    ZA0041           Class Df 5 Usr
      * Send message 'Defect NAllow on Hog Type'
     C                     MOVEL'PRK1197' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9954  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * val 6
      * CASE: DTL.Defect User  6 is Entered
     C           #DGZCD    IFNE *BLANK                     *IF
      * Val Market Defect     XF - Hog Defect  * 
     C                     CALL 'PLL6XFR'              90  Val Market Defe
     C                     PARM *BLANK    W0RTN   7
     C           #DGZCD    PARM #DGZCD    WQ0075  6        DF Defect Code
     C           #DCQSS    PARM #DCQSS    WQ0076  1        DF Classificati
     C                     PARM #1LLST    WQ0077  1        TH Hog Class Ty
     C           YL0009    PARM *BLANK    WQ0078  7        *Return code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLL6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9956  *
     C                     END
      * CASE: LCL.*Return code is Error Found
     C           YL0009    IFEQ 'ERROR'                    *IF
      * Setup message data for message
     C                     MOVELP1LLST    ZA0042           TH Hog Class Ty
     C                     MOVEL#DGZCD    ZA0043           Defect User  6
     C                     MOVEL#DCQSS    ZA0044           Class Df 6 Usr
      * Send message 'Defect NAllow on Hog Type'
     C                     MOVEL'PRK1197' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9956  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * val 7
      * CASE: DTL.Defect User  7 is Entered
     C           #DG0CD    IFNE *BLANK                     *IF
      * Val Market Defect     XF - Hog Defect  * 
     C                     CALL 'PLL6XFR'              90  Val Market Defe
     C                     PARM *BLANK    W0RTN   7
     C           #DG0CD    PARM #DG0CD    WQ0079  6        DF Defect Code
     C           #DCRSS    PARM #DCRSS    WQ0080  1        DF Classificati
     C                     PARM #1LLST    WQ0081  1        TH Hog Class Ty
     C           YL0009    PARM *BLANK    WQ0082  7        *Return code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLL6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9958  *
     C                     END
      * CASE: LCL.*Return code is Error Found
     C           YL0009    IFEQ 'ERROR'                    *IF
      * Setup message data for message
     C                     MOVELP1LLST    ZA0045           TH Hog Class Ty
     C                     MOVEL#DG0CD    ZA0046           Defect User  7
     C                     MOVEL#DCRSS    ZA0047           Class Df 7 Usr
      * Send message 'Defect NAllow on Hog Type'
     C                     MOVEL'PRK1197' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9958  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * val 8
      * CASE: DTL.Defect User  8 is Entered
     C           #DG1CD    IFNE *BLANK                     *IF
      * Val Market Defect     XF - Hog Defect  * 
     C                     CALL 'PLL6XFR'              90  Val Market Defe
     C                     PARM *BLANK    W0RTN   7
     C           #DG1CD    PARM #DG1CD    WQ0083  6        DF Defect Code
     C           #DCSSS    PARM #DCSSS    WQ0084  1        DF Classificati
     C                     PARM #1LLST    WQ0085  1        TH Hog Class Ty
     C           YL0009    PARM *BLANK    WQ0086  7        *Return code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLL6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9960  *
     C                     END
      * CASE: LCL.*Return code is Error Found
     C           YL0009    IFEQ 'ERROR'                    *IF
      * Setup message data for message
     C                     MOVELP1LLST    ZA0048           TH Hog Class Ty
     C                     MOVEL#DG1CD    ZA0049           Defect User  8
     C                     MOVEL#DCSSS    ZA0050           Class Df 8 Usr
      * Send message 'Defect NAllow on Hog Type'
     C                     MOVEL'PRK1197' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9960  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * val 9
      * CASE: DTL.Defect User  9 is Entered
     C           #DG2CD    IFNE *BLANK                     *IF
      * Val Market Defect     XF - Hog Defect  * 
     C                     CALL 'PLL6XFR'              90  Val Market Defe
     C                     PARM *BLANK    W0RTN   7
     C           #DG2CD    PARM #DG2CD    WQ0087  6        DF Defect Code
     C           #DCTSS    PARM #DCTSS    WQ0088  1        DF Classificati
     C                     PARM #1LLST    WQ0089  1        TH Hog Class Ty
     C           YL0009    PARM *BLANK    WQ0090  7        *Return code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLL6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9962  *
     C                     END
      * CASE: LCL.*Return code is Error Found
     C           YL0009    IFEQ 'ERROR'                    *IF
      * Setup message data for message
     C                     MOVELP1LLST    ZA0051           TH Hog Class Ty
     C                     MOVEL#DG2CD    ZA0052           Defect User  9
     C                     MOVEL#DCTSS    ZA0053           Class Df 9 Usr
      * Send message 'Defect NAllow on Hog Type'
     C                     MOVEL'PRK1197' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9962  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * val 10
      * CASE: DTL.Defect User 10 is Entered
     C           #DG3CD    IFNE *BLANK                     *IF
      * Val Market Defect     XF - Hog Defect  * 
     C                     CALL 'PLL6XFR'              90  Val Market Defe
     C                     PARM *BLANK    W0RTN   7
     C           #DG3CD    PARM #DG3CD    WQ0091  6        DF Defect Code
     C           #DCUSS    PARM #DCUSS    WQ0092  1        DF Classificati
     C                     PARM #1LLST    WQ0093  1        TH Hog Class Ty
     C           YL0009    PARM *BLANK    WQ0094  7        *Return code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLL6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9964  *
     C                     END
      * CASE: LCL.*Return code is Error Found
     C           YL0009    IFEQ 'ERROR'                    *IF
      * Setup message data for message
     C                     MOVELP1LLST    ZA0054           TH Hog Class Ty
     C                     MOVEL#DG3CD    ZA0055           Defect User 10
     C                     MOVEL#DCUSS    ZA0056           Class Df 10 Usr
      * Send message 'Defect NAllow on Hog Type'
     C                     MOVEL'PRK1197' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9964  *
      *
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGRVGN    BEGSR
      *================================================================
      * RTV THDR NF UnAssnPend RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSUG     KLIST
     C                     KFLD           A1HMNB           BOH Company Num
     C                     KFLD           A1BNNB           BOH Buy Order N
     C                     KFLD           A1BONB           BOL Load Number
     C                     KFLD           A1CVNB           TH Tattoo Numbe
     C                     KFLD           A1B0DT           TH Kill Date
      * Setup key
     C                     Z-ADD#1HMNB    A1HMNB           BOH Company Num
     C                     Z-ADD#1BNNB    A1BNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    A1BONB           BOL Load Number
     C                     Z-ADD#1CVNB    A1CVNB           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    A1B0DT           TH Kill Date
      * Establish starting position
     C           KRSUG     CHAIN@A1CPC4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
      * Rtv and UnAssigned    RT - Tattoo Pending  * 
     C                     EXSR UHRVGN
     C                     GOTO UGEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHRVGN    BEGSR
      *================================================================
      * Rtv and UnAssigned    RT - Tattoo Pending  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FJHONB    WQUH01           CC Company Numb
     C           *LIKE     DEFN FJHSA1    WQUH02           TP Tattoo Numbe
     C           *LIKE     DEFN FJHMNB    WQUH03           BOH Company Num
     C           *LIKE     DEFN FJBNNB    WQUH04           BOH Buy Order N
     C           *LIKE     DEFN FJBONB    WQUH05           BOL Load Number
      * Define keylist
     C           KRSUH     KLIST
     C                     KFLD           WQUH01           CC Company Numb
     C                     KFLD           WQUH02           TP Tattoo Numbe
     C                     KFLD           WQUH03           BOH Company Num
     C                     KFLD           WQUH04           BOH Buy Order N
     C                     KFLD           WQUH05           BOL Load Number
      * Setup key
     C                     Z-ADD#1HMNB    WQUH01           CC Company Numb
     C                     Z-ADD#1CVNB    WQUH02           TP Tattoo Numbe
     C                     Z-ADD#1HMNB    WQUH03           BOH Company Num
     C                     Z-ADD#1BNNB    WQUH04           BOH Buy Order N
     C                     Z-ADD#1BONB    WQUH05           BOL Load Number
      * Establish starting position
     C           KRSUH     SETLL@FJCPKH                    *
     C           KRSUH     READE@FJCPKH                  90*
      * Data record not found
     C   90                MOVEL'PRK1012' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Tattoo UnAssigned CH - Tattoo Pending  * 
     C                     EXSR UICHRC
     C           KRSUH     READE@FJCPKH                  90*
     C                     ENDDO
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UICHRC    BEGSR
      *================================================================
      * Chg Tattoo UnAssigned CH - Tattoo Pending  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0930  50       Employee ID
     C                     Z-ADD*ZERO     WN0931  60       TP Tattoo Creat
     C                     MOVEL*BLANK    WN0932  1        TP Alley Number
     C                     Z-ADD*ZERO     WN0933  50       Employee Number
     C                     MOVEL*BLANK    WN0934 10        RS User Changed
     C                     Z-ADD*ZERO     WN0935  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0936  60       RS Time Changed
     C                     MOVEL*BLANK    WN0937  1        RS Record Statu
     C                     MOVEL*BLANK    WN0938 10        RS Job
     C                     MOVEL*BLANK    WN0939 10        RS Program
     C                     MOVEL*BLANK    WN0940 10        RS User Added
     C                     Z-ADD*ZERO     WN0941  70       RS Date Added
     C                     Z-ADD*ZERO     WN0942  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    Y2RDC   1
      *
      * Move key fields to @FJCPHV
     C                     Z-ADDFJHONB    WFHONB           CC Company Numb
     C                     Z-ADDFJEZDT    WFEZDT           TP Tattoo Date
     C                     Z-ADDFJHSA1    WFHSA1           TP Tattoo Numbe
      *
     C           KLCHUI    KLIST
     C                     KFLD           WFHONB           CC Company Numb
     C                     KFLD           WFEZDT           TP Tattoo Date
     C                     KFLD           WFHSA1           TP Tattoo Numbe
     C           KLCHUI    CHAIN@FJCPHV              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFJCPL0'MDACP
     C                     MOVEL'@FJCPHV' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL031.
     C                     MOVEL'LBL031'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO UIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO UIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFJ1    Y2RDCS
      * Move non-key fields to @FJCPHV
     C                     Z-ADD*ZERO     WFHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WFBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WFBONB           BOL Load Number
     C                     MOVEL'P'       WFWQST    P      TP Tattoo Statu
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFJ1    IFNE Y2RDCS
     C           Y2RDC     ANDNE'N'
     C                     MOVE 'Y'       Y2RDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp-SysDtIF
     C                     MOVEL##USR     WFAAVN           RS User Changed
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WFAADT    PARM *ZERO     WQ0350  70       *DATE
     C           WFAMTM    PARM *ZERO     WQ0351  60       *TIME
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##JOB     WFAHVN           RS Job
     C                     MOVEL##PGM     WFAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKFJ1    IFNE Y2RDCS
     C           Y2RDC     ANDNE'N'
     C                     MOVE 'Y'       Y2RDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           Y2RDC     IFEQ 'Y'
     C                     UPDAT@FJCPHV                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFJCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         UJSUBR    BEGSR
      *================================================================
      * Modification History Created IS 061308 slm
      *================================================================
      * ***** Change log
      * PK0495 12/12/02  1) Remove ref/upd of the Group Reference Code US
      * 2) Update"Delivered Head"in the Delivery Tracking with "Load Head
      * 3) Group Ref is Optional on the screen now. May be used f/ EXT.
      * *****
      * 8/7/03 RMC Per Jancie - dont default BOL Shipped Head
      * *****
      * 12/27/05 LJB - 1. Add PS Site ID to screen - Non-display if
      *    LCL.Site ID Required from Producer Location file = "N"
      *    2. If Site ID is prompted, call Select Producer Site Mileage
      *    3. If Site ID is entered, Producer Site Mileage must exist
      *    else, error
      *    4. If LCL.Site ID Required = Y and DTL.TH Source Code = "CPR"
      *    then Site ID is a requried entry.
      *    5. If Site ID is entered, Tattoo Header EXT is updated
      * *****
      * 01/16/05 SLM -    Additional rules for site id
      *    6. If Resale do not require Site ID
      * *****
      * 03/07/2006 LJB  The State field on the screen was reverting to
      * ** the value retrieved from the file when it had been changed
      * ** on the screen. This was due to the initially retrieved value
      * ** being saved in a hidden field. The screen value was then
      * ** replaced with the hidden value. References to the hidden field
      * ** have been commented out and the entered value is retained.
      * ** The hidden value will only be used if the state is cleared out
      * *****
      * 04/26/06 SLM -    Additional rules for site id
      *   The State Cde will now reside in the Prod site mileage db
      *   get the 3 position field from there to populate the th state co
      *   the th state code
      *   3 pos. TH STATE CODE replace the oms state code usr (2 pos)
      *   use the same routines on the maintenance of the producer
      *   location  - the Vnd Routines.  with a 3 position field
      *   this is also the validation of state code and getting the
      *   description of the state code.
      *   If a Tattoo is in *chg do not replace the State Code if state
      *   is different then site.
      *   If a Tattoo is in *chg and the user select f4 on the site and
      *   selection occurs then replace the th state code
      * 5/16/08 SLM E00151 Producer Site validation regardless of Contrac
      * This is no effect to guymon due to they do not use the
      * the producer site file
      * 6/12/08 SLM E00144 LFT head and EUT/KOA head allow
      *             use of the defect with Market Hogs
      * 9/19/08 SLM E00150 Allow Producer Subsidiary defined at Tattoo
      * Header Ext
      *================================================================
     CSR         UJEXIT    ENDSR
      /EJECT
     CSR         UKSUBR    BEGSR
      *================================================================
      * Producer work for remainder of program
      *================================================================
      * CASE: PAR.TH Hog Class Type is Market
     C           P1LLST    IFEQ 'M'                        *IF
      * Rtv ProdSubsidiaryPrc RT - Producer Subsidiary  * 
     C                     EXSR ULRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUDJSS           Producer Subsid
     C                     END                             *FI
      * Rtv Prdcr Vendor#,Src RT - Producer  * 
     C                     EXSR UMRVGN
      * Rtv Source Type       RT - Source  * 
     C                     EXSR UNRVGN
      * DTL.SR Type Desc = Condition name of DTL.TH Source Type
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1121482   Y2LSNO  70       List number
     C                     PARM #1KAST    W0INVL 25        TH Source Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DISTX    PARM           W0CNNM 25        SR Type Desc
      *
      *================================================================
     CSR         UKEXIT    ENDSR
      /EJECT
     CSR         ULRVGN    BEGSR
      *================================================================
      * Rtv ProdSubsidiaryPrc RT - Producer Subsidiary  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDABCD    WQUL01           PD Producer Cod
      * Define keylist
     C           KRSUL     KLIST
     C                     KFLD           WQUL01           PD Producer Cod
      * Setup key
     C                     MOVELP1ABCD    WQUL01           PD Producer Cod
      * Establish starting position
     C           KRSUL     SETLL@A8REPM                    *
     C           KRSUL     READE@A8REPM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1213' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WUDJSS           Producer Subsid
     C                     GOTO ULEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUDJSS           Producer Subsid
     C                     GOTO ULEXIT                     *QUIT
     C           KRSUL     READE@A8REPM                  90*
     C                     ENDDO
      *================================================================
     CSR         ULEXIT    ENDSR
      /EJECT
     CSR         UMRVGN    BEGSR
      *================================================================
      * Rtv Prdcr Vendor#,Src RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSUM     KLIST
     C                     KFLD           ACABCD           PD Producer Cod
      * Setup key
     C                     MOVELP1ABCD    ACABCD           PD Producer Cod
      * Establish starting position
     C           KRSUM     CHAIN@ACREAI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0009' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUGCNB           PD VND Address
     C                     MOVEL*BLANK    P3AACD           SR Source Code
     C                     GOTO UMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDACGCNB    WUGCNB           PD VND Address
     C                     MOVELACAACD    P3AACD           SR Source Code
     C                     GOTO UMEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         UMEXIT    ENDSR
      /EJECT
     CSR         UNRVGN    BEGSR
      *================================================================
      * Rtv Source Type       RT - Source  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSUN     KLIST
     C                     KFLD           AAAACD           SR Source Code
      * Setup key
     C                     MOVELP3AACD    AAAACD           SR Source Code
      * Establish starting position
     C           KRSUN     CHAIN@AAREAC              90    *
      * Data record not found
     C   90                MOVEL'PRK0005' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAAIXST    P3IXST           SR Type
     C                     ENDIF
      *================================================================
     CSR         UNEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C           YPMTFD    IFEQ '#1HMNB'
     C           YPMTFD    OREQ '#1BNNB'
     C           YPMTFD    OREQ '#1BONB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1HMNB' defaulted for 'BOH Company Number'.
      * Field '(KEY) #1BNNB' defaulted for 'BOH Buy Order Number'.
      * Field '(KEY) #1BONB' defaulted for 'BOL Load Number'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) P1ABCD' defaulted for 'PD Producer Code'.
      * Field '(PAR) P1AECD' defaulted for 'PL Location Code'.
     C                     CALL 'PKQJSRR'              90  Sel Producer BO
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HMNB    WQ0014  30       BOH Company Num
     C           #1BNNB    PARM #1BNNB    WQ0015  50       BOH Buy Order N
     C           #1BONB    PARM #1BONB    WQ0016  50       BOL Load Number
     C                     PARM P1ABCD    WQ0017  6        PD Producer Cod
     C                     PARM P1AECD    WQ0018  6        PL Location Cod
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKQJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1HMNB    IFNE *ZERO                      BOH Company Num
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1BNNB    IFNE *ZERO                      BOH Buy Order N
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1BONB    IFNE *ZERO                      BOL Load Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VA999
     C                     END
     C                     END
      *................................................................
      *
     C           KLVAAX    KLIST
     C                     KFLD           AXHMNB           BOH Company Num
     C                     KFLD           AXBNNB           BOH Buy Order N
     C                     KFLD           AXBONB           BOL Load Number
      * Setup key
     C                     Z-ADD#1HMNB    AXHMNB
     C                     Z-ADD#1BNNB    AXBNNB
     C                     Z-ADD#1BONB    AXBONB
     C           KLVAAX    CHAIN@AXCPBX              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VAEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VAEXIT
     C                     END
     C           VA999     TAG
      * Restrictor relation not satisfied
      * Send message 'Buy Order Load         NF'
     C                     MOVEL'PRK0051' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0051' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Tattoo Header Process
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1CSCD    IFEQ *BLANK                     THP Process Cod
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBCC    KLIST
     C                     KFLD           CCCSCD           THP Process Cod
      * Setup key
     C                     MOVEL#1CSCD    CCCSCD
     C           KLVBCC    CHAIN@CCREH3              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Tattoo Header Process  NF'
     C                     MOVEL'PRK0172' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0172' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Producer Location
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1ABCD    WK1X01  1
     C                     MOVEL#1AECD    WK1X02  1
     C           WK1X01    IFEQ '?'                        PD Producer Cod
     C           YPMTFD    OREQ '#1ABCD'
     C           WK1X02    OREQ '?'                        PL Location Cod
     C           YPMTFD    OREQ '#1AECD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1ABCD' defaulted for 'PD Producer Code'.
      * Field '(DTL) #1AECD' defaulted for 'PL Location Code'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(CON) *ZERO' defaulted for 'BOL Kill Date'.
      * Field '(CON) *ZERO' defaulted for 'MEL Date'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1HMNB' defaulted for 'BOH Company Number'.
     C                     CALL 'PKYJSRR'              90  Sel Prod Loc w/
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1ABCD    WQ0045  6        PD Producer Cod
     C           #1AECD    PARM #1AECD    WQ0046  6        PL Location Cod
     C                     PARM *ZERO     WQ0047  70       BOL Kill Date
     C                     PARM *ZERO     WQ0048  70       MEL Date
     C                     PARM #1HMNB    WQ0049  30       BOH Company Num
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKYJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1ABCD    IFNE *BLANK                     PD Producer Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1AECD    IFNE *BLANK                     PL Location Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1ABCD    IFEQ *BLANK                     PD Producer Cod
     C           #1AECD    ANDEQ*BLANK                     PL Location Cod
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCAF    KLIST
     C                     KFLD           AFABCD           PD Producer Cod
     C                     KFLD           AFAECD           PL Location Cod
      * Setup key
     C                     MOVEL#1ABCD    AFABCD
     C                     MOVEL#1AECD    AFAECD
     C           KLVCAF    CHAIN@AFREAR              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Producer Location      NF'
     C                     MOVEL'PRK0015' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0015' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check reference to Hog Buyer
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1ACCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        HB Buyer Code
     C           YPMTFD    OREQ '#1ACCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1ACCD' defaulted for 'HB Buyer Code'.
     C                     CALL 'PKD3SRR'              90  Sel Hog Buyer
     C                     PARM *BLANK    W0RTN   7
     C           #1ACCD    PARM #1ACCD    WQ0050  3        HB Buyer Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKD3SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1ACCD    IFNE *BLANK                     HB Buyer Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VDEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1ACCD    IFEQ *BLANK                     HB Buyer Code
     C                     GOTO VDEXIT
     C                     END
      *
     C           KLVDAD    KLIST
     C                     KFLD           ADACCD           HB Buyer Code
      * Setup key
     C                     MOVEL#1ACCD    ADACCD
     C           KLVDAD    CHAIN@ADREAF              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VDEXIT
     C                     END
      * Send message 'Hog Buyer              NF'
     C                     MOVEL'PRK0011' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0011' W0RTN
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         VECKRL    BEGSR
      *================================================================
      * Check reference to Genetic
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1AGCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        GN Genetic Code
     C           YPMTFD    OREQ '#1AGCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AGCD' defaulted for 'GN Genetic Code'.
     C                     CALL 'PKNASRR'              90  Sel Genetic Act
     C                     PARM *BLANK    W0RTN   7
     C           #1AGCD    PARM #1AGCD    WQ0051  5        GN Genetic Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKNASRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9938  *
     C                     END
      *
     C           #1AGCD    IFNE *BLANK                     GN Genetic Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VEEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AGCD    IFEQ *BLANK                     GN Genetic Code
     C                     GOTO VEEXIT
     C                     END
      *
     C           KLVEAI    KLIST
     C                     KFLD           AIAGCD           GN Genetic Code
      * Setup key
     C                     MOVEL#1AGCD    AIAGCD
     C           KLVEAI    CHAIN@AIREA9              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VEEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VEEXIT
     C                     END
      * Send message 'Genetic                NF'
     C                     MOVEL'PRK0021' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0021' W0RTN
      *================================================================
     CSR         VEEXIT    ENDSR
      /EJECT
     CSR         VFCKRL    BEGSR
      *================================================================
      * Check reference to Hog Classification
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1BECD    WK1X01  1
     C           WK1X01    IFEQ '?'                        HC Class Code
     C           YPMTFD    OREQ '#1BECD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1BECD' defaulted for 'HC Class Code'.
     C                     CALL 'PKC0SRR'              90  Sel Hog Classif
     C                     PARM *BLANK    W0RTN   7
     C           #1BECD    PARM #1BECD    WQ0052  3        HC Class Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKC0SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9934  *
     C                     END
      *
     C           #1BECD    IFNE *BLANK                     HC Class Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VFEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1BECD    IFEQ *BLANK                     HC Class Code
     C                     GOTO VFEXIT
     C                     END
      *
     C           KLVFWC    KLIST
     C                     KFLD           WCBECD           HC Class Code
      * Setup key
     C                     MOVEL#1BECD    WCBECD
     C           KLVFWC    CHAIN@A8REDA              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VFEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VFEXIT
     C                     END
      * Send message 'Hog Classification     NF'
     C                     MOVEL'PRK0075' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0075' W0RTN
      *================================================================
     CSR         VFEXIT    ENDSR
      /EJECT
     CSR         VGCKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C           YPMTFD    IFEQ '#1HMNB'
     C           YPMTFD    OREQ '#1BNNB'
     C           YPMTFD    OREQ '#1BONB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1HMNB' defaulted for 'BOH Company Number'.
      * Field '(KEY) #1BNNB' defaulted for 'BOH Buy Order Number'.
      * Field '(KEY) #1BONB' defaulted for 'BOL Load Number'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) P1ABCD' defaulted for 'PD Producer Code'.
      * Field '(PAR) P1AECD' defaulted for 'PL Location Code'.
     C                     CALL 'PKQJSRR'              90  Sel Producer BO
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HMNB    WQ0345  30       BOH Company Num
     C           #1BNNB    PARM #1BNNB    WQ0346  50       BOH Buy Order N
     C           #1BONB    PARM #1BONB    WQ0347  50       BOL Load Number
     C                     PARM P1ABCD    WQ0348  6        PD Producer Cod
     C                     PARM P1AECD    WQ0349  6        PL Location Cod
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKQJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1HMNB    IFNE *ZERO                      BOH Company Num
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1BNNB    IFNE *ZERO                      BOH Buy Order N
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1BONB    IFNE *ZERO                      BOL Load Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VG999
     C                     END
     C                     END
      *................................................................
      *
     C           KLVGAX    KLIST
     C                     KFLD           AXHMNB           BOH Company Num
     C                     KFLD           AXBNNB           BOH Buy Order N
     C                     KFLD           AXBONB           BOL Load Number
      * Setup key
     C                     Z-ADD#1HMNB    AXHMNB
     C                     Z-ADD#1BNNB    AXBNNB
     C                     Z-ADD#1BONB    AXBONB
     C           KLVGAX    CHAIN@AXCPBX              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VGEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VGEXIT
     C                     END
     C           VG999     TAG
      * Restrictor relation not satisfied
      * Send message 'Buy Order Load         NF'
     C                     MOVEL'PRK0051' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0051' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         VGEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y1SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
     C           *IN25     IFEQ '0'
      * Bypass when help done
     C                     SETOF                     94    *
     C           W0OVR1    IFEQ '1'
     C           W0OVR1    OREQ '0'
     C           *IN99     ANDEQ'0'
      * If override or no error
     C                     SETON                     94    *
     C                     Z-ADDW0ROW1    ZZCSRW
     C                     Z-ADDW0COL1    ZZCSCL
     C                     END
     C                     END
      *================================================================
     CSR         Y1EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C           @#DFMT    IFEQ '#RCDKEY'
      * KEY Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
     C                     ENDIF
     C           @#DFMT    IFEQ '#RCDDTL1'
      * DETAIL Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW1END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW1BEG,F
     C                     MOVELW1NAM,F   W0CFL
     C                     ENDIF
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
     C                     SETOF                     94    *
     C                     Z-ADD0         W0ROW1  30
     C                     Z-ADD0         W0COL1  30
     C                     MOVE '2'       W0OVR1  1
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           ZHCSRW    IFEQ 008
     C           ZHCSCL    ANDGE031
     C           ZHCSCL    ANDLE033
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1BECD'  YPMTFD           HC Class Code
     C                     END
      *
     C           ZHCSRW    IFEQ 010
     C           ZHCSCL    ANDEQ031
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1E2ST'  YPMTFD           TH Sex
     C                     END
      *
     C           ZHCSRW    IFEQ 011
     C           ZHCSCL    ANDGE031
     C           ZHCSCL    ANDLE035
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1AGCD'  YPMTFD           GN Genetic Code
     C                     END
      *
     C           ZHCSRW    IFEQ 012
     C           ZHCSCL    ANDEQ031
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1LIST'  YPMTFD           TH Schedule Kil
     C                     END
      *
     C           ZHCSRW    IFEQ 016
     C           ZHCSCL    ANDGE031
     C           ZHCSCL    ANDLE032
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN73     ANDEQ'0'
     C                     MOVEL'#1CPST'  YPMTFD           TH Live Purchas
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM 1         YYLGCT  50       # of grps
     C                     PARM W0GRP     YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel and exit from key screen
      *================================================================
      * USER: Exit program processing
      * RTV THDR NF UnAssnPend RT - Tattoo Header  * 
     C                     EXSR UGRVGN
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1CXNB           TH Dead On Arri
     C                     MOVEL*BLANK    P2DRTX           State
     C                     MOVEL*BLANK    P3AACD           SR Source Code
     C                     MOVEL*BLANK    P3AFTX           SR Description
     C                     MOVEL*BLANK    P3IXST           SR Type
      *
      * Initialise indicators for re-entry
     C                     MOVE '0'       *IN
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Pl VND Address Number
     C                     Z-ADD*ZERO     WUGLNB  80
      * Define work field Blank USR
     C                     MOVEL*BLANK    WUCRTX 80
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Display Output Only Usr
     C                     MOVEL*BLANK    WUL9ST  1
      * Define work field Display Output Only 2 USR
     C                     MOVEL*BLANK    WUMAST  1
      * Define work field Defect Count Usr
     C                     Z-ADD*ZERO     WUODNB  30
      * Define work field @Status Internal (Y/N)
     C                     MOVEL*BLANK    WUKPST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Define work field Return Code USR
     C                     MOVEL*BLANK    WULMST  7
      * Define work field @Status (Yes/No)
     C                     MOVEL*BLANK    WUABST  1
      * Define work field Zero USR
     C                     Z-ADD*ZERO     WUE9NB  10
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBHONB           CC Company Numb
     C                     Z-ADD*ZERO     WBE0DT           DSH Kill Date
     C                     Z-ADD*ZERO     WBE9DT           DT Delivery Dat
     C                     Z-ADD*ZERO     WBAJTH           DT Delivery Tim
     C                     Z-ADD*ZERO     WBH4A1           DT Delivery Tim
     C                     Z-ADD*ZERO     WBFXDT           DT Actual Kill
     C                     Z-ADD*ZERO     WBJIA1           DT Actual Deliv
     C                     Z-ADD*ZERO     WBIBA1           DT Scheduled Ho
     C                     Z-ADD*ZERO     WBICA1           DT Farm Site Co
     C                     Z-ADD*ZERO     WBIDA1           DT Delivered He
     C                     Z-ADD*ZERO     WBIPA1           DT Delivered We
     C                     Z-ADD*ZERO     WBIEA1           DT Movement Num
     C                     Z-ADD*ZERO     WBFADT           DT Transprtn Of
     C                     Z-ADD*ZERO     WBAKTH           DT Transprtn Of
     C                     Z-ADD*ZERO     WBBYTH           DT Arrive@Frm v
     C                     Z-ADD*ZERO     WBFBDT           DT Route Start
     C                     Z-ADD*ZERO     WBALTH           DT Route Start
     C                     Z-ADD*ZERO     WBBVTH           DT Route Start
     C                     Z-ADD*ZERO     WBAMTH           DT Wait @ Trans
     C                     Z-ADD*ZERO     WBFCDT           DT Arrive @ Far
     C                     Z-ADD*ZERO     WBANTH           DT Arrive @ Far
     C                     Z-ADD*ZERO     WBBHTH           DT Drive Time T
     C                     Z-ADD*ZERO     WBFDDT           DT Start Loadin
     C                     Z-ADD*ZERO     WBAOTH           DT Start Loadin
     C                     Z-ADD*ZERO     WBBWTH           DT Start Loadin
     C                     Z-ADD*ZERO     WBAPTH           DT Wait @ Farm
     C                     Z-ADD*ZERO     WBFEDT           DT Frm End Load
     C                     Z-ADD*ZERO     WBAQTH           DT Frm End Load
     C                     Z-ADD*ZERO     WBARTH           DT Load Time
     C                     Z-ADD*ZERO     WBFFDT           DT Leave Farm D
     C                     Z-ADD*ZERO     WBASTH           DT Leave Farm T
     C                     Z-ADD*ZERO     WBATTH           DT Wait-Depart
     C                     Z-ADD*ZERO     WBFGDT           DT Plt TrkWsh A
     C                     Z-ADD*ZERO     WBAUTH           DT Plt TrkWsh A
     C                     Z-ADD*ZERO     WBFHDT           DT Arrive @ Pla
     C                     Z-ADD*ZERO     WBAVTH           DT Arrive @ Pla
     C                     Z-ADD*ZERO     WBAWTH           DT Wait @ TrkWs
     C                     Z-ADD*ZERO     WBBKTH           DT Drive Time T
     C                     Z-ADD*ZERO     WBBLTH           DT Delv Time Va
     C                     Z-ADD*ZERO     WBFIDT           DT TrkScl Weigh
     C                     Z-ADD*ZERO     WBAXTH           DT TrkScl Weigh
     C                     Z-ADD*ZERO     WBAYTH           DT Wait @ TrkSc
     C                     Z-ADD*ZERO     WBFJDT           DT To Recv Dock
     C                     Z-ADD*ZERO     WBAZTH           DT To Recv Dock
     C                     Z-ADD*ZERO     WBA0TH           DT Wait-Rcv Doc
     C                     Z-ADD*ZERO     WBFKDT           DT Start Unload
     C                     Z-ADD*ZERO     WBA1TH           DT Start Unload
     C                     Z-ADD*ZERO     WBA2TH           DT Wait @ Rcv D
     C                     Z-ADD*ZERO     WBFLDT           DT End Unload D
     C                     Z-ADD*ZERO     WBA3TH           DT End Unload T
     C                     Z-ADD*ZERO     WBA4TH           DT Unload Time
     C                     Z-ADD*ZERO     WBBTTH           DT Unload Varia
     C                     Z-ADD*ZERO     WBFMDT           DT TrkScl Weigh
     C                     Z-ADD*ZERO     WBA5TH           DT TrkScl Weigh
     C                     Z-ADD*ZERO     WBA6TH           DT Wait Time @
     C                     Z-ADD*ZERO     WBBXTH           DT Formula Wait
     C                     Z-ADD*ZERO     WBFYDT           DT Unused Date
     C                     Z-ADD*ZERO     WBB0TH           DT Unused Time
     C                     Z-ADD*ZERO     WBBZTH           DT Unused Wait
     C                     Z-ADD*ZERO     WBH2A1           DSD Scheduled D
     C                     Z-ADD*ZERO     WBJ2A1           DT Head Receive
     C                     Z-ADD*ZERO     WBJ3A1           DT Weight Recei
     C                     Z-ADD*ZERO     WBKMA1           DT Avg Weight R
     C                     Z-ADD*ZERO     WBJ4A1           DT Head DOA
     C                     Z-ADD*ZERO     WBJ5A1           DT Weight DOA
     C                     Z-ADD*ZERO     WBJ6A1           DT Head Yard De
     C                     Z-ADD*ZERO     WBJ7A1           DT Weight Yard
     C                     Z-ADD*ZERO     WBJ8A1           DT Head Condemn
     C                     Z-ADD*ZERO     WBJ9A1           DT Weight Conde
     C                     Z-ADD*ZERO     WBKAA1           DT Head Held Ov
     C                     Z-ADD*ZERO     WBKBA1           DT Weight Held
     C                     Z-ADD*ZERO     WBKCA1           DT Head Killed
     C                     Z-ADD*ZERO     WBKDA1           DT Weight Kille
     C                     Z-ADD*ZERO     WBKEA1           DT Head Market
     C                     Z-ADD*ZERO     WBKFA1           DT Weight Marke
     C                     Z-ADD*ZERO     WBKNA1           DT Avg Weight M
     C                     Z-ADD*ZERO     WBKGA1           DT Head Resale
     C                     Z-ADD*ZERO     WBKHA1           DT Weight Resal
     C                     Z-ADD*ZERO     WBKOA1           DT Avg Weight R
     C                     Z-ADD*ZERO     WBKIA1           DT Head Unused
     C                     Z-ADD*ZERO     WBKJA1           DT Weight Unuse
     C                     Z-ADD*ZERO     WBKKA1           DT Head Unused
     C                     Z-ADD*ZERO     WBKLA1           DT Weight Unuse
     C                     Z-ADD*ZERO     WBHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WBBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WBBONB           BOL Load Number
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      * Define work field TH HPS Movement Ref #
     C                     Z-ADD*ZERO     WUOXNB  70
      * Define work field Ship Wgt Allow Ent Usr
     C                     MOVEL*BLANK    WUNEST  1
      * Define work field Held Over Records Y/N
     C                     MOVEL*BLANK    WUNFST  1
      * Define work field PD VND Address Number
     C                     Z-ADD*ZERO     WUGCNB  80
      * Define work field Scale Wt Required     USR
     C                     MOVEL*BLANK    WUR3ST  1
      * Define work field DF Scale Weight Required
     C                     MOVEL*BLANK    WUR2ST  1
      * Define work field Pen Usr
     C                     MOVEL*BLANK    WUCBCD  3
      * Define work field Pen Company Number
     C                     Z-ADD*ZERO     WUHVNB  30
      * Define work field TH Live Purchase UOM
     C                     MOVEL*BLANK    WUCPST  2
      * Define work field TH Live Purchase Price
     C                     Z-ADD*ZERO     WUACPR  52
      * Define work field GN Genetic Code
     C                     MOVEL*BLANK    WUAGCD  5
      * Define work field TH Shipped Weight
     C                     Z-ADD*ZERO     WUHGNB  71
      * Define work field HC Defect Required
     C                     MOVEL*BLANK    WUBXST  1
      * Define work field HC Price Required
     C                     MOVEL*BLANK    WUBYST  1
      * Define work field HC Resolution
     C                     MOVEL*BLANK    WUBITX 60
      * Define work field HC Qualification
     C                     MOVEL*BLANK    WUB0ST  1
      * Define work field TH Hog Class Type
     C                     MOVEL*BLANK    WULLST  1
      * Define work field Producer Subsidiary SUSR
     C                     MOVEL*BLANK    WUDJSS  1
      * Define work field Blank Usr 1 fld Usr
     C                     MOVEL*BLANK    WUIXTX  1
      * Define work field *Return code
     C                     MOVEL*BLANK    WURTN   7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAEA1           DF Market Perce
     C                     Z-ADD*ZERO     WEUOPR           DF Unused Price
     C                     Z-ADD*ZERO     WEUPPR           DF Unused Price
     C                     Z-ADD*ZERO     WEUQPR           DF Unused Price
     C                     Z-ADD*ZERO     WEAADT           RS Date Changed
     C                     Z-ADD*ZERO     WEAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WEABDT           RS Date Added
     C                     Z-ADD*ZERO     WEABTM           RS Time Added
      * Define work field PD EDI Trading Partner #
     C                     Z-ADD*ZERO     WUGJNB  80
      * Define work field Pen Type
     C                     MOVEL*BLANK    WUFWST  1
      * Define work field Scheduled Kill Dt 8.0 USR
     C                     Z-ADD*ZERO     WUSHDT  80
      * Define work field BOL Shipped Head
     C                     Z-ADD*ZERO     WULDSH  50
      * Define work field Genetic Code 2 USR
     C                     MOVEL*BLANK    WUEQCD  5
      * Define work field TH Sex
     C                     MOVEL*BLANK    WUE2ST  1
      * Define work field BOH Payment Type
     C                     MOVEL*BLANK    WUA4ST  1
      * Define work field BOH Buy Order Type
     C                     MOVEL*BLANK    WUA5ST  1
      * Define work field PD Std Delv Time
     C                     Z-ADD*ZERO     WUAATH  40
      * Define work field PD Std Truck Size
     C                     Z-ADD*ZERO     WUAMNB  50
      * Define work field PD Freight Exp Paid By
     C                     MOVEL*BLANK    WUIWST  1
      * Define work field SR Source Code
     C                     MOVEL*BLANK    WUAACD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFHONB           CC Company Numb
     C                     Z-ADD*ZERO     WFEZDT           TP Tattoo Date
     C                     Z-ADD*ZERO     WFHSA1           TP Tattoo Numbe
     C                     Z-ADD*ZERO     WFHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WFBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WFBONB           BOL Load Number
     C                     Z-ADD*ZERO     WFHRA1           Employee ID
     C                     Z-ADD*ZERO     WFBKTM           TP Tattoo Creat
     C                     Z-ADD*ZERO     WFMIA1           Employee Number
     C                     Z-ADD*ZERO     WFAADT           RS Date Changed
     C                     Z-ADD*ZERO     WFAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WFABDT           RS Date Added
     C                     Z-ADD*ZERO     WFABTM           RS Time Added
      * Define work field @Print Status
     C                     MOVEL*BLANK    WUCZST  1
      * Define work field Farm site Name f/ HPS USR
     C                     MOVEL*BLANK    WUKQTX 25
      * Define work field Farm Site USR
     C                     Z-ADD*ZERO     WUETNB  50
      * Define work field HPS FS Comp Relation USR
     C                     MOVEL*BLANK    WUG4CD  5
      * Define work field Defect Add/Chg Usr
     C                     MOVEL*BLANK    WUQKST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WGBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WGBONB           BOL Load Number
     C                     Z-ADD*ZERO     WGCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WGB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WGAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WGACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WGB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WGCAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WGAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WGA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WGCXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WGCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WGFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WGH9NB           TH Held Over
     C                     Z-ADD*ZERO     WGFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WGFENB           TH Head Killed
     C                     Z-ADD*ZERO     WGHENB           TH Head Adds
     C                     Z-ADD*ZERO     WGHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WGCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WGLRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WGE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WGA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WGFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WGA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WGF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WGHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WGF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WGF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WGF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WGF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WGAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WGAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WGCWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WGA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WGA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WGB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WGAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WGANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WGAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WGAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WGAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WGAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WGAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WGASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WGA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WGATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WGA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WGCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WGCCPR           Th Payment Net
     C                     Z-ADD*ZERO     WGLPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WGCDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WGA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WGA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WGGHNB           TH Commission A
     C                     Z-ADD*ZERO     WGBYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WGBSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WGBTDT           TH Commission P
     C                     Z-ADD*ZERO     WGBUDT           TH Actual Check
     C                     Z-ADD*ZERO     WGHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WGHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WGHINB           TH FFLI
     C                     Z-ADD*ZERO     WGA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WGA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WGA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WGJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WGD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WGD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WGD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WGD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WGEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WGEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WGECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WGEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WGEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WGEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WGEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WGEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WGOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WGTHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WGT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WGTHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WGT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WGOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WGKOER           TH Head Identif
     C                     Z-ADD*ZERO     WGOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WGOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WGIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WGOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WGHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WGS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WGTAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WGTBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WGJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WGKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WGKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WGKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WGKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WGOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WGIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WGIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WGIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WGKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WGOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WGKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WGORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WGOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WGMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WGMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WGNCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WGNCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WGIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WGKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WGEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WGEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WGECDT           TH Head LFT
     C                     Z-ADD*ZERO     WGEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WGEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WGAADT           RS Date Changed
     C                     Z-ADD*ZERO     WGAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WGABDT           RS Date Added
     C                     Z-ADD*ZERO     WGABTM           RS Time Added
      * Define work field Company Value Code    USR
     C                     MOVEL*BLANK    WUFACD 10
      * Define work field TH Head Received
     C                     Z-ADD*ZERO     WUCWNB  50
      * Define work field BOL Live Wgt Received
     C                     Z-ADD*ZERO     WUDINB  71
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WHBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WHBONB           BOL Load Number
     C                     Z-ADD*ZERO     WHCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WHB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WHC2NB           TD Sequence Num
     C                     Z-ADD*ZERO     WHCZNB           TD Live Wgt
     C                     Z-ADD*ZERO     WHC0NB           TD Pen Head
     C                     Z-ADD*ZERO     WHD8NB           TD Yard Dead
     C                     Z-ADD*ZERO     WHH7NB           TD Held Over
     C                     Z-ADD*ZERO     WHAJTM           TD Drive Time
     C                     Z-ADD*ZERO     WHJEA1           TD Drive Hour
     C                     Z-ADD*ZERO     WHB7CD           TD Drive Card N
     C                     Z-ADD*ZERO     WHD7NB           TD Avg Live Wgt
     C                     Z-ADD*ZERO     WHBVDT           TD User Date 1
     C                     Z-ADD*ZERO     WHBWDT           TD User Date 2
     C                     Z-ADD*ZERO     WHBXDT           TD Drive Date
     C                     Z-ADD*ZERO     WHHVNB           Pen Company Num
     C                     Z-ADD*ZERO     WHH8NB           Held Over Pen C
     C                     Z-ADD*ZERO     WHAADT           RS Date Changed
     C                     Z-ADD*ZERO     WHAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WHABDT           RS Date Added
     C                     Z-ADD*ZERO     WHABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIHVNB           Pen Company Num
     C                     Z-ADD*ZERO     WICTNB           Pen Maximun Cap
     C                     Z-ADD*ZERO     WID6NB           Pen Current Hea
     C                     Z-ADD*ZERO     WIB6CD           Pen Current Dri
     C                     Z-ADD*ZERO     WIEBNB           Pen Drive Seque
     C                     Z-ADD*ZERO     WIHBNB           Pen Adjustment
     C                     Z-ADD*ZERO     WIAADT           RS Date Changed
     C                     Z-ADD*ZERO     WIAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WIABDT           RS Date Added
     C                     Z-ADD*ZERO     WIABTM           RS Time Added
      * Define work field Pen Description
     C                     MOVEL*BLANK    WUBBTX 25
      * Define work field Pen Current Head
     C                     Z-ADD*ZERO     WUD6NB  50
      * Define work field Genetic Code USR
     C                     MOVEL*BLANK    WUA1CD  5
      * Define work field Pen Desc              USR
     C                     MOVEL*BLANK    WUJTTX 25
      * Define work field BOL Head Received
     C                     Z-ADD*ZERO     WUDHNB  70
      * Define work field BOL Freight Amt
     C                     Z-ADD*ZERO     WUATVA  72
      * Define work field Tattoo is paid Usr
     C                     MOVEL*BLANK    WUNPST  1
      * Define work field Tot Frt Spdb aft pay Usr
     C                     Z-ADD*ZERO     WUK4PR  72
      * Define work field BOL Trucker Payment Sts
     C                     MOVEL*BLANK    WUCNST  2
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WKBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WKBONB           BOL Load Number
     C                     Z-ADD*ZERO     WKCQDT           BOL Kill Date
     C                     Z-ADD*ZERO     WKABTH           BOL Pln Delv St
     C                     Z-ADD*ZERO     WKACTH           BOL Pln Delv En
     C                     Z-ADD*ZERO     WKBPNB           BOL Pln Head De
     C                     Z-ADD*ZERO     WKCSNB           BOL Shipped Wgt
     C                     Z-ADD*ZERO     WKAUDT           BOL Pln Delv Da
     C                     Z-ADD*ZERO     WKAGPR           BOL Freight Uni
     C                     Z-ADD*ZERO     WKATVA           BOL Freight Amt
     C                     Z-ADD*ZERO     WKDHNB           BOL Head Receiv
     C                     Z-ADD*ZERO     WKDINB           BOL Live Wgt Re
     C                     Z-ADD*ZERO     WKGINB           BOL Trucker Che
     C                     Z-ADD*ZERO     WKBZDT           BOL Trucker Che
     C                     Z-ADD*ZERO     WKLSNB           BOL AP Voucher
     C                     Z-ADD*ZERO     WKLDSH           BOL Shipped Hea
     C                     Z-ADD*ZERO     WKJKRU           BOL HPS Movemen
     C                     Z-ADD*ZERO     WKKEOR           BOL Head LFT
     C                     Z-ADD*ZERO     WKIOEW           BOL Head EUT/KO
     C                     Z-ADD*ZERO     WKKJIO           BOL Unused Nbr
     C                     Z-ADD*ZERO     WKIOJR           BOL Unused Nbr
     C                     Z-ADD*ZERO     WKEIRR           BOL Unused Wgt
     C                     Z-ADD*ZERO     WKITMF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WKODJE           BOL Unused Wgt
     C                     Z-ADD*ZERO     WKRJIF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WKOEJF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WKD0DT           BOL Unused Date
     C                     Z-ADD*ZERO     WKD1DT           BOL Unused Date
     C                     Z-ADD*ZERO     WKD2DT           BOL Unused Date
     C                     Z-ADD*ZERO     WKD3DT           BOL Unused Date
     C                     Z-ADD*ZERO     WKD4DT           BOL Unused Date
     C                     Z-ADD*ZERO     WKAADT           RS Date Changed
     C                     Z-ADD*ZERO     WKAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WKABDT           RS Date Added
     C                     Z-ADD*ZERO     WKABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WLBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WLARDT           BOH Buy Order D
     C                     Z-ADD*ZERO     WLASDT           BOH Kill Date
     C                     Z-ADD*ZERO     WLAAPR           BOH Market Add/
     C                     Z-ADD*ZERO     WLALPR           BOH Quoted Base
     C                     Z-ADD*ZERO     WLD5DT           BOH MPR Reporti
     C                     Z-ADD*ZERO     WLD6DT           BOH Unused Date
     C                     Z-ADD*ZERO     WLD7DT           BOH Unused Date
     C                     Z-ADD*ZERO     WLD8DT           BOH Unused Date
     C                     Z-ADD*ZERO     WLD9DT           BOH Unused Date
     C                     Z-ADD*ZERO     WLJOEJ           BOH Unused Nbr
     C                     Z-ADD*ZERO     WLKOFF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WLKWPE           BOH Unused Nbr
     C                     Z-ADD*ZERO     WLIMBF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WLOPTR           BOH Unused Nbr
     C                     Z-ADD*ZERO     WLOEJD           BOH Unused Nbr
     C                     Z-ADD*ZERO     WLIRMF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WLJIRM           BOH Unused Nbr
     C                     Z-ADD*ZERO     WLJRKF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WLKFIR           BOH Unused Nbr
     C                     Z-ADD*ZERO     WLHXNB           PPWS Company Nu
     C                     Z-ADD*ZERO     WLGANB           CW Year
     C                     Z-ADD*ZERO     WLGBNB           CW Week Number
     C                     Z-ADD*ZERO     WLAADT           RS Date Changed
     C                     Z-ADD*ZERO     WLAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WLABDT           RS Date Added
     C                     Z-ADD*ZERO     WLABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMHONB           CC Company Numb
     C                     Z-ADD*ZERO     WME0DT           DSH Kill Date
     C                     Z-ADD*ZERO     WME6DT           DSD Delivery Da
     C                     Z-ADD*ZERO     WMAGTH           DSD Delivery Ti
     C                     Z-ADD*ZERO     WMHZA1           DSD Delivery Ti
     C                     Z-ADD*ZERO     WMH0A1           DSD Scheduled H
     C                     Z-ADD*ZERO     WMH1A1           DSD Farm Site C
     C                     Z-ADD*ZERO     WMIOA1           DSD Unused Head
     C                     Z-ADD*ZERO     WMH2A1           DSD Scheduled D
     C                     Z-ADD*ZERO     WMIJA1           DSD Scheduled K
     C                     Z-ADD*ZERO     WMH3A1           DSD Movement Nu
     C                     Z-ADD*ZERO     WMFRDT           DSD Sched Route
     C                     Z-ADD*ZERO     WMBOTH           DSD Sched Route
     C                     Z-ADD*ZERO     WME7DT           DSD Sch Farm Ar
     C                     Z-ADD*ZERO     WMAHTH           DSD Sch Farm Ar
     C                     Z-ADD*ZERO     WME8DT           DSD Sch Start L
     C                     Z-ADD*ZERO     WMAITH           DSD Sch Start L
     C                     Z-ADD*ZERO     WMFZDT           DSD Unused Date
     C                     Z-ADD*ZERO     WMB1TH           DSD Unused Time
     C                     Z-ADD*ZERO     WMHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WMBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WMBONB           BOL Load Number
     C                     Z-ADD*ZERO     WMAADT           RS Date Changed
     C                     Z-ADD*ZERO     WMAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WMABDT           RS Date Added
     C                     Z-ADD*ZERO     WMABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WOBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WOBONB           BOL Load Number
     C                     Z-ADD*ZERO     WOCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WOB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WOLJNB           TDF Head Defect
     C                     Z-ADD*ZERO     WONXA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONYA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WONZA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      * Define work field RS Record Status
     C                     MOVEL*BLANK    WUAJST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WSHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WSBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WSBONB           BOL Load Number
     C                     Z-ADD*ZERO     WSCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WSB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WSI5PR           TH CA Market Pr
     C                     Z-ADD*ZERO     WSJBPR           TH CA Base Mark
     C                     Z-ADD*ZERO     WSI6PR           TH CA Base Mkt
     C                     Z-ADD*ZERO     WSI7PR           TH CA Sort Disc
     C                     Z-ADD*ZERO     WSI8PR           TH CA Yield Gai
     C                     Z-ADD*ZERO     WSI9PR           TH CA Base Carc
     C                     Z-ADD*ZERO     WSJAPR           TH CA Lean Prem
     C                     Z-ADD*ZERO     WSJCPR           TH CA Carcass G
     C                     Z-ADD*ZERO     WSJDPR           TH CA Bse Mkt L
     C                     Z-ADD*ZERO     WSJEPR           TH CA Bse Mkt C
     C                     Z-ADD*ZERO     WSJFPR           TH CA Srt Dsc L
     C                     Z-ADD*ZERO     WSJGPR           TH CA Srt Dsc C
     C                     Z-ADD*ZERO     WSJHPR           TH CA Yld G/L L
     C                     Z-ADD*ZERO     WSJIPR           TH CA Yld G/L C
     C                     Z-ADD*ZERO     WSJJPR           TH CA Crc Val L
     C                     Z-ADD*ZERO     WSJKPR           TH CA Crc Val C
     C                     Z-ADD*ZERO     WSJLPR           TH CA Lean Prm
     C                     Z-ADD*ZERO     WSJMPR           TH CA Lean Prm
     C                     Z-ADD*ZERO     WSJNPR           TH CA Gross Liv
     C                     Z-ADD*ZERO     WSJOPR           TH CA Gross Car
     C                     Z-ADD*ZERO     WSLTBF           TH Min LT Backf
     C                     Z-ADD*ZERO     WSHZPC           TH Min LT LoinE
     C                     Z-ADD*ZERO     WSLTHW           TH Min LT Hot W
     C                     Z-ADD*ZERO     WSH0PC           TH Min LT Lean
     C                     Z-ADD*ZERO     WSGTBF           TH Max GT Backf
     C                     Z-ADD*ZERO     WSH1PC           TH Max GT LoinE
     C                     Z-ADD*ZERO     WSGTHW           TH Max GT Hot W
     C                     Z-ADD*ZERO     WSH2PC           TH Max GT Lean
     C                     Z-ADD*ZERO     WSHLBF           TH Head LT Back
     C                     Z-ADD*ZERO     WSHLLE           TH Head LT Loin
     C                     Z-ADD*ZERO     WSHLHW           TH Head LT Hot
     C                     Z-ADD*ZERO     WSHLLP           TH Head LT Lean
     C                     Z-ADD*ZERO     WSHGBF           TH Head GT Back
     C                     Z-ADD*ZERO     WSHGLE           TH Head GT Loin
     C                     Z-ADD*ZERO     WSHGHW           TH Head GT Hot
     C                     Z-ADD*ZERO     WSHFLP           TH Head GT Lean
     C                     Z-ADD*ZERO     WSSNA1           TE Unused Numbe
     C                     Z-ADD*ZERO     WSSOA1           TE UnUsed Numbe
     C                     Z-ADD*ZERO     WSSPA1           TE Unused Numbe
     C                     Z-ADD*ZERO     WSAADT           RS Date Changed
     C                     Z-ADD*ZERO     WSAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WSABDT           RS Date Added
     C                     Z-ADD*ZERO     WSABTM           RS Time Added
      * Define work field Head Total Usr 2
     C                     Z-ADD*ZERO     WUZYNB  70
      * Define work field GN Description
     C                     MOVEL*BLANK    WUAWTX 25
      * Define work field First Time Flag Usr
     C                     MOVEL*BLANK    WUHBST  1
      * Initialize *SET CURSOR data
     C                     MOVE 'Y'       YSETCS  1
     C                     EXSR Y9CLR
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WD08 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD07 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD06 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD05 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD04 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD03 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local work field TattooPend Set to Pending
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field PD Producer Code
     C                     MOVEL*BLANK    YL0002  6
      * Define local work field Return Code USR
     C                     MOVEL*BLANK    YL0003  7
      * Define local work field BOL Pln Head Delv
     C                     Z-ADD*ZERO     YL0004  50
      * Define local work field BOL Shipped Head
     C                     Z-ADD*ZERO     YL0005  50
      * Define local work field DSD Farm Site Code
     C                     Z-ADD*ZERO     YL0006  50
      * Define local work field Record Change Usr
     C                     MOVEL*BLANK    YL0007  1
      * Define null work field PD Producer Code
     C                     MOVEL*BLANK    YN0001  6
      * Define null work field PL Name
     C                     MOVEL*BLANK    YN0002 40
      * Define null work field Pl VND Address Number
     C                     Z-ADD*ZERO     YN0003  80
      * Define null work field PL State Code
     C                     MOVEL*BLANK    YN0004  3
      * Define local work field PSM Miles to Company
     C                     Z-ADD*ZERO     YL0008  50
      * Define local work field *Return code
     C                     MOVEL*BLANK    YL0009  7
      * Define local work field Record Added Usr
     C                     MOVEL*BLANK    YL0010  1
      * Define local work field Random Tattoo Sts USR
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field Tattoo Type USR
     C                     MOVEL*BLANK    YL0012  1
      * Define local work field TH Kill Date
     C                     Z-ADD*ZERO     YL0013  70
      * Define local work field Next Kill Date
     C                     Z-ADD*ZERO     YL0014  70
      * Define local work field TE Unused Number 1
     C                     Z-ADD*ZERO     YL0015  50
      * Define local work field TE UnUsed Number 2
     C                     Z-ADD*ZERO     YL0016  50
      * Define local work field TE Unused Number 3
     C                     Z-ADD*ZERO     YL0017  50
      * Define local work field TE Unused Status 1
     C                     MOVEL*BLANK    YL0018  1
      * Define local work field TE Unused Status 2
     C                     MOVEL*BLANK    YL0019  1
      * Define local work field TE Unused Status 3
     C                     MOVEL*BLANK    YL0020  1
      * Define local work field TH Dead On Arrival
     C                     Z-ADD*ZERO     YL0021  50
      * Define local work field TE Unused Number 1
     C                     Z-ADD*ZERO     YL0022  50
      * Define local work field TE UnUsed Number 2
     C                     Z-ADD*ZERO     YL0023  50
      * Define local work field TE Unused Number 3
     C                     Z-ADD*ZERO     YL0024  50
      * Define local work field TE Unused Status 1
     C                     MOVEL*BLANK    YL0025  1
      * Define local work field TE Unused Status 2
     C                     MOVEL*BLANK    YL0026  1
      * Define local work field TE Unused Status 3
     C                     MOVEL*BLANK    YL0027  1
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
      * Select initial mode
     C           @1NROP    IFEQ *ZERO
      * Add mode
     C                     MOVEL'ADD'     W0PMD   3
     C                     ELSE
      * Change mode
     C                     MOVEL'CHG'     W0PMD
     C                     END
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * HPE076
      * C1108 -- Duplicate Tattoo Problem
      *   PKLYDTR -- WW Tattoo
      *   PKL0E1R -- Edt TTt Hdr
      *   PKO6PVR-- Edt Ttt Hdr (PV)
      * HPE034
      * Create a Trucker edit. - Dwight Shepard
      * Purpose:
      * Clone the Trucker report that post and remove
      * all update of vouchers.  Producer the report
      * for the user to sight review before continue on.
      * Modification History
      * Date        Person   Description
      * E00150 Prod/Subsidiary
      * 09/19/08 SLM E00150 Add the Producer Subsidiary to the
      * Tattoo Header Ext  -- Only on non Resale hogs
      * Allow the user to inter the Producer Subsidiary for this
      * tattoo if the Producer Subsidiary has records for any subsidiary
      * then the Producer Subsidiary code will be required for this tatto
      * Modification History Created IS 061308 slm
     C                     EXSR UJSUBR                     Modification Hi
      * Mov ApplN to Company  US - STR User Source Functions  * 
     C***   MOVE USER SOURCE                      ***
     C                     MOVELP2EVTX    ##CMP
     C                     MOVEL'N'       WUHBST           First Time Flag
     C                     MOVEL'N'       YL0010           Record Added Us
     C                     MOVEL'N'       YL0007           Record Change U
      * Producer work for remainder of program
     C                     EXSR UKSUBR                     Producer work f
      *================================================================
     CSR         ZZEXIT    ENDSR
** KEY Screen: Field position and name array
0104901305015610181702329
** W0END
0105101309015650182402333
** W0NAM
#1HMNB    #1BNNB    #1BONB    V1B0DT    #1CVNB
** W1BEG
00800010470105401077010830109701303
01328013400155901562016000182301857
02079020920233502369025910260402847
02881031030313703359033720361503633
03647038710388404127041400438304867
04874048800488204889048950489804905
04911049140492104927049300493704943
05123051300513605138051450515105154
05161051670517005177051830518605193
05199
** W1END
00809010520105901081010870110101310
01335013540155901576016040182801866
02081021160234102378025910261302851
02883031030314303361033860361903640
03654038760389204128041640439004872
04878048800488704893048950490304909
04911049190492504927049350494104943
05128051340513605143051490515105159
05165051670517505181051830519105197
05199
** W1NAM
#DKKTX    #1ABCD    #1AECD    #1BNNB    #1BONB    #1CVNB    V1B0DT
V1AWDT    #DISTX    #1LLST    #DE6TX    #DLDSH    #DOVCD    #DNYCD
#1BECD    #DBDTX    #1OXNB    #1BICD    #1E2ST    #DFRTX    #1AGCD
#DCMCD    #1LIST    #DB5NB    #1NZTX    #DLXTX    #1CXNB    #1ECDT
#1EDDT    #1ACPR    #DK5TX    #1CPST    #DEPTX    #1HGNB    #DGUCD
#DF1NB    #DCLSS    #DGVCD    #DFWNB    #DCMSS    #DGWCD    #DFYNB
#DCNSS    #DGXCD    #DFUNB    #DCOSS    #DGYCD    #DO3NB    #DCPSS
#DGZCD    #DO4NB    #DCQSS    #DG0CD    #DO5NB    #DCRSS    #DG1CD
#DFONB    #DCSSS    #DG2CD    #DFXNB    #DCTSS    #DG3CD    #DFTNB
#DCUSS
** @CN
00001 *INSURED*
00002 Y2U0005
00003 LSTTTTRSC
00004 LSTTTTMKT
00005 LSTTTTTOP
