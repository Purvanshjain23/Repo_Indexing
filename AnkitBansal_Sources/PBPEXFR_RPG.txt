     H/TITLE CRT EDI POACK    TEST XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISSHENR
     H* Date          : 04/25/23  Time  : 14:49:23
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FCAEOREL1IF  E           K        DISK
      * RTV : Company Customer          Retrieval index
      *
     FOPBGWKN9IF  E           K        DISK
      * RSQ : Order Detail              Co/Ord/Seqs/not Canc
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FPDJYREL2IF  E           K        DISK
      * RTV : Company Defaults Internal Active Records
      *
     FPDIHREL0IF  E           K        DISK
      * RTV : Price Method Header       Retrieval index
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAASREL3IF  E           K        DISK
      * RTV : Company Control           Retrieval Active Only
      *
     FOMF0CPL2IF  E           K        DISK
      * RSQ : Commodity Mrkt Price      Market Date Descending
      *
     FPDK3CPL2IF  E           K        DISK
      * RSQ : Price Change Audit Log    Co/Ord/Seq1&2/AdtSeq (D)
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FOPEXREL2IF  E           K        DISK
      * RTV : Order Types               Active order Types
      *
     FARBCREL1IF  E           K        DISK
      * RTV : A/R Summary               Retrieval index       NV
      *
     FPNGQREL1IF  E           K        DISK
      * RTV : EDI Bill To Interchange   Retrieval index
      *
     FPMAMREL1IF  E           K        DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FECP004L8IF  E           K        DISK
      * RSQ : EDI Purchase Order Header Trade Partner/PO Number
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     FPDK3CPL0IF  E           K        DISK                      A
      * UPD : Price Change Audit Log    Update index
      *
     FARBCREL0UF  E           K        DISK                      A
      * UPD : A/R Summary               Update index
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     E                    #L7         7  1
      * Long constants
     E                    @CN#    1  02  6   @CN    25
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WAAIC3
     I              BEC4NB                          WAC4NB
     I              BEJNCD                          WAJNCD
     I              BEANC7                          WAANC7
     I              BEBKC7                          WABKC7
     I              BEBRTX                          WABRTX
     I              BEHMNA                          WAHMNA
     I              BEHONA                          WAHONA
     I              BEHPNA                          WAHPNA
     I              BEHNNA                          WAHNNA
     I              BEDBCD                          WADBCD
     I              BECKTX                          WACKTX
     I              BEB0C7                          WAB0C7
     I              BEAETX                          WAAETX
     I              BEB1NA                          WAB1NA
     I              BEB3NA                          WAB3NA
     I              BEB4NA                          WAB4NA
     I              BEB2NA                          WAB2NA
     I              BEBHCD                          WABHCD
     I              BEC8TX                          WAC8TX
     I              BEBCNA                          WABCNA
     I              BEA0DT                          WAA0DT
     I              BEA5DT                          WAA5DT
     I              BEGNDT                          WAGNDT
     I              BEACDT                          WAACDT
     I              BEAQCD                          WAAQCD
     I              BEB6NA                          WAB6NA
     I              BEBYNA                          WABYNA
     I              BEBZNA                          WABZNA
     I              BEGTST                          WAGTST
     I              BEGVST                          WAGVST
     I              BEGUST                          WAGUST
     I              BEQFST                          WAQFST
     I              BECQCD                          WACQCD
     I              BEGJST                          WAGJST
     I              BEGWST                          WAGWST
     I              BEGXST                          WAGXST
     I              BEGYST                          WAGYST
     I              BEAODT                          WAAODT
     I              BEAIVN                          WAAIVN
     I              BECXDT                          WACXDT
     I              BEJZVA                          WAJZVA
     I              BEA1WG                          WAA1WG
     I              BEXIST                          WAXIST
     I              BEXJST                          WAXJST
     I              BEXKST                          WAXKST
     I              BEEIDT                          WAEIDT
     I              BEAFTM                          WAAFTM
     I              BEE8CD                          WAE8CD
     I              BEE9CD                          WAE9CD
     I              BERMNB                          WARMNB
     I              BETBNB                          WATBNB
     I              BER1NB                          WAR1NB
     I              BEPJST                          WAPJST
     I              BEU0ST                          WAU0ST
     I              BEU1ST                          WAU1ST
     I              BEQ2CD                          WAQ2CD
     I              BEU2ST                          WAU2ST
     I              BEVEST                          WAVEST
     I              BEVFST                          WAVFST
     I              BEVGST                          WAVGST
     I              BERPCD                          WARPCD
     I              BERNNB                          WARNNB
     I              BEVDST                          WAVDST
     I              BEATIN                          WAATIN
     I              BEU4ST                          WAU4ST
     I              BEU5ST                          WAU5ST
     I              BERSRN                          WARSRN
     I              BEMHNA                          WAMHNA
     I              BEMINA                          WAMINA
     I              BEWBST                          WAWBST
     I              BER4CD                          WAR4CD
     I              BEBFCD                          WABFCD
     I              BEQ4CD                          WAQ4CD
     I              BET3NB                          WAT3NB
     I              BESICD                          WASICD
     I              BECONB                          WACONB
     I              BECEST                          WACEST
     I              BEAWDT                          WAAWDT
     I              BEJPCD                          WAJPCD
     I              BEXUST                          WAXUST
     I              BEZ1ST                          WAZ1ST
     I              BEVRVA                          WAVRVA
     I              BEOBST                          WAOBST
     I              BEBCST                          WABCST
     I              BEBDST                          WABDST
     I              BEB7VL                          WAB7VL
     I              BEGASX                          WAGASX
     I              BEGBSX                          WAGBSX
     I              BEGCSX                          WAGCSX
     I              BEGDSX                          WAGDSX
     I              BEFNSX                          WAFNSX
     I              BEFOSX                          WAFOSX
     I              BEFPSX                          WAFPSX
     I              BEFQSX                          WAFQSX
     I              BEFRSX                          WAFRSX
     I              BEFSSX                          WAFSSX
     I              BEFTSX                          WAFTSX
     I              BEFUSX                          WAFUSX
     I              BEFVSX                          WAFVSX
     I              BEFWSX                          WAFWSX
     I              BEFXSX                          WAFXSX
     I              BEFYSX                          WAFYSX
     I              BENODT                          WANODT
     I              BENPDT                          WANPDT
     I              BENQDT                          WANQDT
     I              BENRDT                          WANRDT
     I              BENSDT                          WANSDT
     I              BEBPTM                          WABPTM
     I              BEBQTM                          WABQTM
     I              BEBRTM                          WABRTM
     I              BEBSTM                          WABSTM
     I              BEBTTM                          WABTTM
     I              BEH0NX                          WAH0NX
     I              BEH1NX                          WAH1NX
     I              BEH2NX                          WAH2NX
     I              BEH3NX                          WAH3NX
     I              BEH4NX                          WAH4NX
     I              BEC0C7                          WAC0C7
     I              BEUVST                          WAUVST
     I              BEUWST                          WAUWST
     I              BEUXST                          WAUXST
     I              BEAATM                          WAAATM
     I              BEAYNA                          WAAYNA
     I              BEA0NA                          WAA0NA
     I              BEAXDT                          WAAXDT
      *
     I@EOREXM
      * Company Customer          Retrieval index
      * Renamed input format fields
     I              EOAIC3                          WBAIC3
     I              EOBKC7                          WBBKC7
     I              EOAQCD                          WBAQCD
     I              EOR4CD                          WBR4CD
     I              EOBYNA                          WBBYNA
     I              EOB6NA                          WBB6NA
     I              EOBZNA                          WBBZNA
     I              EOLLST                          WBLLST
     I              EOPPST                          WBPPST
     I              EOR5NB                          WBR5NB
     I              EOR6NB                          WBR6NB
     I              EOQGST                          WBQGST
     I              EOBOCD                          WBBOCD
     I              EOTBNB                          WBTBNB
     I              EOMTCU                          WBMTCU
     I              EOW2NB                          WBW2NB
     I              EORPCD                          WBRPCD
     I              EOAJCD                          WBAJCD
     I              EOX9ST                          WBX9ST
     I              EOT9CD                          WBT9CD
     I              EOUBCD                          WBUBCD
     I              EOISTX                          WBISTX
     I              EOLQCD                          WBLQCD
     I              EONJNA                          WBNJNA
     I              EOI0TX                          WBI0TX
     I              EONKNA                          WBNKNA
     I              EOI1TX                          WBI1TX
     I              EOVLST                          WBVLST
     I              EORLST                          WBRLST
     I              EOMMTX                          WBMMTX
     I              EOOHNA                          WBOHNA
     I              EOQ6ST                          WBQ6ST
     I              EOQ8ST                          WBQ8ST
     I              EORBST                          WBRBST
     I              EOREST                          WBREST
     I              EOUVST                          WBUVST
     I              EOUWST                          WBUWST
     I              EOUXST                          WBUXST
     I              EOVSST                          WBVSST
     I              EOAATM                          WBAATM
     I              EOAYNA                          WBAYNA
     I              EOA0NA                          WBA0NA
     I              EOAXDT                          WBAXDT
      *
     I@BGWKJM
      * Order Detail              Co/Ord/Seqs/not Canc
      * Renamed input format fields
     I              OMAIC3                          WCAIC3
     I              OMC4NB                          WCC4NB
     I              OMDPNB                          WCDPNB
     I              OMUENB                          WCUENB
     I              OMHGCD                          WCHGCD
     I              OMAJCD                          WCAJCD
     I              OMBKC7                          WCBKC7
     I              OMCFC7                          WCCFC7
     I              OMGMST                          WCGMST
     I              OMGNST                          WCGNST
     I              OMMAVA                          WCMAVA
     I              OMKDVA                          WCKDVA
     I              OML8VA                          WCL8VA
     I              OML9VA                          WCL9VA
     I              OMGTST                          WCGTST
     I              OMGVST                          WCGVST
     I              OMGUST                          WCGUST
     I              OMQFST                          WCQFST
     I              OMAYVA                          WCAYVA
     I              OMEXDT                          WCEXDT
     I              OMLQCD                          WCLQCD
     I              OMRDCD                          WCRDCD
     I              OMQ7CD                          WCQ7CD
     I              OMBZPR                          WCBZPR
     I              OML6NB                          WCL6NB
     I              OMU1ST                          WCU1ST
     I              OMGIDT                          WCGIDT
     I              OMCRCD                          WCCRCD
     I              OMAGCD                          WCAGCD
     I              OMRZST                          WCRZST
     I              OMR0ST                          WCR0ST
     I              OMR1ST                          WCR1ST
     I              OMG7NA                          WCG7NA
     I              OMG8NA                          WCG8NA
     I              OMRPCD                          WCRPCD
     I              OMVEST                          WCVEST
     I              OMVGST                          WCVGST
     I              OMAVST                          WCAVST
     I              OMU0ST                          WCU0ST
     I              OMRFCD                          WCRFCD
     I              OMFZST                          WCFZST
     I              OMR1NB                          WCR1NB
     I              OMAVQT                          WCAVQT
     I              OMD0WG                          WCD0WG
     I              OMCCQT                          WCCCQT
     I              OMAUWG                          WCAUWG
     I              OMCBQT                          WCCBQT
     I              OMATWG                          WCATWG
     I              OMAQCS                          WCAQCS
     I              OMAGCS                          WCAGCS
     I              OMAKPR                          WCAKPR
     I              OMALPR                          WCALPR
     I              OMAUPR                          WCAUPR
     I              OMAVWG                          WCAVWG
     I              OMA4WG                          WCA4WG
     I              OMA5DT                          WCA5DT
     I              OMAODT                          WCAODT
     I              OMGNDT                          WCGNDT
     I              OMAMST                          WCAMST
     I              OMANST                          WCANST
     I              OMVAST                          WCVAST
     I              OMRGNB                          WCRGNB
     I              OMRHNB                          WCRHNB
     I              OMRINB                          WCRINB
     I              OMRBCD                          WCRBCD
     I              OMHICD                          WCHICD
     I              OMRNCD                          WCRNCD
     I              OMROCD                          WCROCD
     I              OMCXDT                          WCCXDT
     I              OMAJVN                          WCAJVN
     I              OMKXCD                          WCKXCD
     I              OMJPCD                          WCJPCD
     I              OMCQCD                          WCCQCD
     I              OMR4CD                          WCR4CD
     I              OMZ1ST                          WCZ1ST
     I              OMZ3ST                          WCZ3ST
     I              OMZ4ST                          WCZ4ST
     I              OMDUPR                          WCDUPR
     I              OMB6VL                          WCB6VL
     I              OMA1AA                          WCA1AA
     I              OMFZSX                          WCFZSX
     I              OMF0SX                          WCF0SX
     I              OMF1SX                          WCF1SX
     I              OMF2SX                          WCF2SX
     I              OMF3SX                          WCF3SX
     I              OMF4SX                          WCF4SX
     I              OMF5SX                          WCF5SX
     I              OMF6SX                          WCF6SX
     I              OMF7SX                          WCF7SX
     I              OMNTDT                          WCNTDT
     I              OMNUDT                          WCNUDT
     I              OMNVDT                          WCNVDT
     I              OMNWDT                          WCNWDT
     I              OMNXDT                          WCNXDT
     I              OMBUTM                          WCBUTM
     I              OMBVTM                          WCBVTM
     I              OMBWTM                          WCBWTM
     I              OMBXTM                          WCBXTM
     I              OMBYTM                          WCBYTM
     I              OMH5NX                          WCH5NX
     I              OMH6NX                          WCH6NX
     I              OMH7NX                          WCH7NX
     I              OMH8NX                          WCH8NX
     I              OMH9NX                          WCH9NX
     I              OMDVPR                          WCDVPR
     I              OMDWPR                          WCDWPR
     I              OMDXPR                          WCDXPR
     I              OMDYPR                          WCDYPR
     I              OMDZPR                          WCDZPR
     I              OMGSPR                          WCGSPR
     I              OMGTPR                          WCGTPR
     I              OMGUPR                          WCGUPR
     I              OMHOST                          WCHOST
     I              OMHPST                          WCHPST
     I              OMIOST                          WCIOST
     I              OMPEWG                          WCPEWG
     I              OMRINY                          WCRINY
     I              OMTIDT                          WCTIDT
     I              OMTJDT                          WCTJDT
     I              OMH2ST                          WCH2ST
     I              OMH0ST                          WCH0ST
     I              OMH1ST                          WCH1ST
     I              OMTKDT                          WCTKDT
     I              OMTLDT                          WCTLDT
     I              OMTMDT                          WCTMDT
     I              OMUVST                          WCUVST
     I              OMUWST                          WCUWST
     I              OMUXST                          WCUXST
     I              OMAATM                          WCAATM
     I              OMAYNA                          WCAYNA
     I              OMA0NA                          WCA0NA
     I              OMAXDT                          WCAXDT
      *
     I@ADREAO
      * Warehouse Codes           Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WDAJCD
     I              ADF8NA                          WDF8NA
     I              ADACNA                          WDACNA
     I              ADADNA                          WDADNA
     I              ADAENA                          WDAENA
     I              ADAJNA                          WDAJNA
     I              ADBTTX                          WDBTTX
     I              ADAOCD                          WDAOCD
     I              ADBGCD                          WDBGCD
     I              ADVHST                          WDVHST
     I              ADMPNA                          WDMPNA
     I              ADWPST                          WDWPST
     I              ADXUST                          WDXUST
     I              ADT0ST                          WDT0ST
     I              ADT1ST                          WDT1ST
     I              ADDBNB                          WDDBNB
     I              ADT2ST                          WDT2ST
     I              ADT3ST                          WDT3ST
     I              ADT4ST                          WDT4ST
     I              ADT6ST                          WDT6ST
     I              ADBWC3                          WDBWC3
     I              ADBTC3                          WDBTC3
     I              ADBUC3                          WDBUC3
     I              ADBVC3                          WDBVC3
     I              ADFCAA                          WDFCAA
     I              ADRQSX                          WDRQSX
     I              ADRRSX                          WDRRSX
     I              ADRSSX                          WDRSSX
     I              ADRTSX                          WDRTSX
     I              ADT7ST                          WDT7ST
     I              ADT8ST                          WDT8ST
     I              ADRNSX                          WDRNSX
     I              ADROSX                          WDROSX
     I              ADRPSX                          WDRPSX
     I              ADUVST                          WDUVST
     I              ADUWST                          WDUWST
     I              ADUXST                          WDUXST
     I              ADVSST                          WDVSST
     I              ADAATM                          WDAATM
     I              ADAYNA                          WDAYNA
     I              ADA0NA                          WDA0NA
     I              ADAXDT                          WDAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WEAIC3
     I              OMC4NB                          WEC4NB
     I              OMDPNB                          WEDPNB
     I              OMUENB                          WEUENB
     I              OMHGCD                          WEHGCD
     I              OMAJCD                          WEAJCD
     I              OMBKC7                          WEBKC7
     I              OMCFC7                          WECFC7
     I              OMGMST                          WEGMST
     I              OMGNST                          WEGNST
     I              OMMAVA                          WEMAVA
     I              OMKDVA                          WEKDVA
     I              OML8VA                          WEL8VA
     I              OML9VA                          WEL9VA
     I              OMGTST                          WEGTST
     I              OMGVST                          WEGVST
     I              OMGUST                          WEGUST
     I              OMQFST                          WEQFST
     I              OMAYVA                          WEAYVA
     I              OMEXDT                          WEEXDT
     I              OMLQCD                          WELQCD
     I              OMRDCD                          WERDCD
     I              OMQ7CD                          WEQ7CD
     I              OMBZPR                          WEBZPR
     I              OML6NB                          WEL6NB
     I              OMU1ST                          WEU1ST
     I              OMGIDT                          WEGIDT
     I              OMCRCD                          WECRCD
     I              OMAGCD                          WEAGCD
     I              OMRZST                          WERZST
     I              OMR0ST                          WER0ST
     I              OMR1ST                          WER1ST
     I              OMG7NA                          WEG7NA
     I              OMG8NA                          WEG8NA
     I              OMRPCD                          WERPCD
     I              OMVEST                          WEVEST
     I              OMVGST                          WEVGST
     I              OMAVST                          WEAVST
     I              OMU0ST                          WEU0ST
     I              OMRFCD                          WERFCD
     I              OMFZST                          WEFZST
     I              OMR1NB                          WER1NB
     I              OMAVQT                          WEAVQT
     I              OMD0WG                          WED0WG
     I              OMCCQT                          WECCQT
     I              OMAUWG                          WEAUWG
     I              OMCBQT                          WECBQT
     I              OMATWG                          WEATWG
     I              OMAQCS                          WEAQCS
     I              OMAGCS                          WEAGCS
     I              OMAKPR                          WEAKPR
     I              OMALPR                          WEALPR
     I              OMAUPR                          WEAUPR
     I              OMAVWG                          WEAVWG
     I              OMA4WG                          WEA4WG
     I              OMA5DT                          WEA5DT
     I              OMAODT                          WEAODT
     I              OMGNDT                          WEGNDT
     I              OMAMST                          WEAMST
     I              OMANST                          WEANST
     I              OMVAST                          WEVAST
     I              OMRGNB                          WERGNB
     I              OMRHNB                          WERHNB
     I              OMRINB                          WERINB
     I              OMRBCD                          WERBCD
     I              OMHICD                          WEHICD
     I              OMRNCD                          WERNCD
     I              OMROCD                          WEROCD
     I              OMCXDT                          WECXDT
     I              OMAJVN                          WEAJVN
     I              OMKXCD                          WEKXCD
     I              OMJPCD                          WEJPCD
     I              OMCQCD                          WECQCD
     I              OMR4CD                          WER4CD
     I              OMZ1ST                          WEZ1ST
     I              OMZ3ST                          WEZ3ST
     I              OMZ4ST                          WEZ4ST
     I              OMDUPR                          WEDUPR
     I              OMB6VL                          WEB6VL
     I              OMA1AA                          WEA1AA
     I              OMFZSX                          WEFZSX
     I              OMF0SX                          WEF0SX
     I              OMF1SX                          WEF1SX
     I              OMF2SX                          WEF2SX
     I              OMF3SX                          WEF3SX
     I              OMF4SX                          WEF4SX
     I              OMF5SX                          WEF5SX
     I              OMF6SX                          WEF6SX
     I              OMF7SX                          WEF7SX
     I              OMNTDT                          WENTDT
     I              OMNUDT                          WENUDT
     I              OMNVDT                          WENVDT
     I              OMNWDT                          WENWDT
     I              OMNXDT                          WENXDT
     I              OMBUTM                          WEBUTM
     I              OMBVTM                          WEBVTM
     I              OMBWTM                          WEBWTM
     I              OMBXTM                          WEBXTM
     I              OMBYTM                          WEBYTM
     I              OMH5NX                          WEH5NX
     I              OMH6NX                          WEH6NX
     I              OMH7NX                          WEH7NX
     I              OMH8NX                          WEH8NX
     I              OMH9NX                          WEH9NX
     I              OMDVPR                          WEDVPR
     I              OMDWPR                          WEDWPR
     I              OMDXPR                          WEDXPR
     I              OMDYPR                          WEDYPR
     I              OMDZPR                          WEDZPR
     I              OMGSPR                          WEGSPR
     I              OMGTPR                          WEGTPR
     I              OMGUPR                          WEGUPR
     I              OMHOST                          WEHOST
     I              OMHPST                          WEHPST
     I              OMIOST                          WEIOST
     I              OMPEWG                          WEPEWG
     I              OMRINY                          WERINY
     I              OMTIDT                          WETIDT
     I              OMTJDT                          WETJDT
     I              OMH2ST                          WEH2ST
     I              OMH0ST                          WEH0ST
     I              OMH1ST                          WEH1ST
     I              OMTKDT                          WETKDT
     I              OMTLDT                          WETLDT
     I              OMTMDT                          WETMDT
     I              OMUVST                          WEUVST
     I              OMUWST                          WEUWST
     I              OMUXST                          WEUXST
     I              OMAATM                          WEAATM
     I              OMAYNA                          WEAYNA
     I              OMA0NA                          WEA0NA
     I              OMAXDT                          WEAXDT
      *
     I@JYRECE
      * Company Defaults Internal Active Records
      * Renamed input format fields
     I              JYAIC3                          WFAIC3
     I              JYZ9ST                          WFZ9ST
     I              JYCSST                          WFCSST
     I              JYZ8ST                          WFZ8ST
     I              JYCXST                          WFCXST
     I              JYSWST                          WFSWST
     I              JYXXTM                          WFXXTM
     I              JYUECD                          WFUECD
     I              JYHSST                          WFHSST
     I              JYAMEO                          WFAMEO
     I              JYSSDF                          WFSSDF
     I              JYPDFT                          WFPDFT
     I              JYYISX                          WFYISX
     I              JYYJSX                          WFYJSX
     I              JYYKSX                          WFYKSX
     I              JYYLSX                          WFYLSX
     I              JYYMSX                          WFYMSX
     I              JYYNSX                          WFYNSX
     I              JYUVST                          WFUVST
     I              JYUWST                          WFUWST
     I              JYUXST                          WFUXST
     I              JYVSST                          WFVSST
     I              JYAATM                          WFAATM
     I              JYAYNA                          WFAYNA
     I              JYA0NA                          WFA0NA
     I              JYAXDT                          WFAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WGAIC3
     I              OMC4NB                          WGC4NB
     I              OMDPNB                          WGDPNB
     I              OMUENB                          WGUENB
     I              OMHGCD                          WGHGCD
     I              OMAJCD                          WGAJCD
     I              OMBKC7                          WGBKC7
     I              OMCFC7                          WGCFC7
     I              OMGMST                          WGGMST
     I              OMGNST                          WGGNST
     I              OMMAVA                          WGMAVA
     I              OMKDVA                          WGKDVA
     I              OML8VA                          WGL8VA
     I              OML9VA                          WGL9VA
     I              OMGTST                          WGGTST
     I              OMGVST                          WGGVST
     I              OMGUST                          WGGUST
     I              OMQFST                          WGQFST
     I              OMAYVA                          WGAYVA
     I              OMEXDT                          WGEXDT
     I              OMLQCD                          WGLQCD
     I              OMRDCD                          WGRDCD
     I              OMQ7CD                          WGQ7CD
     I              OMBZPR                          WGBZPR
     I              OML6NB                          WGL6NB
     I              OMU1ST                          WGU1ST
     I              OMGIDT                          WGGIDT
     I              OMCRCD                          WGCRCD
     I              OMAGCD                          WGAGCD
     I              OMRZST                          WGRZST
     I              OMR0ST                          WGR0ST
     I              OMR1ST                          WGR1ST
     I              OMG7NA                          WGG7NA
     I              OMG8NA                          WGG8NA
     I              OMRPCD                          WGRPCD
     I              OMVEST                          WGVEST
     I              OMVGST                          WGVGST
     I              OMAVST                          WGAVST
     I              OMU0ST                          WGU0ST
     I              OMRFCD                          WGRFCD
     I              OMFZST                          WGFZST
     I              OMR1NB                          WGR1NB
     I              OMAVQT                          WGAVQT
     I              OMD0WG                          WGD0WG
     I              OMCCQT                          WGCCQT
     I              OMAUWG                          WGAUWG
     I              OMCBQT                          WGCBQT
     I              OMATWG                          WGATWG
     I              OMAQCS                          WGAQCS
     I              OMAGCS                          WGAGCS
     I              OMAKPR                          WGAKPR
     I              OMALPR                          WGALPR
     I              OMAUPR                          WGAUPR
     I              OMAVWG                          WGAVWG
     I              OMA4WG                          WGA4WG
     I              OMA5DT                          WGA5DT
     I              OMAODT                          WGAODT
     I              OMGNDT                          WGGNDT
     I              OMAMST                          WGAMST
     I              OMANST                          WGANST
     I              OMVAST                          WGVAST
     I              OMRGNB                          WGRGNB
     I              OMRHNB                          WGRHNB
     I              OMRINB                          WGRINB
     I              OMRBCD                          WGRBCD
     I              OMHICD                          WGHICD
     I              OMRNCD                          WGRNCD
     I              OMROCD                          WGROCD
     I              OMCXDT                          WGCXDT
     I              OMAJVN                          WGAJVN
     I              OMKXCD                          WGKXCD
     I              OMJPCD                          WGJPCD
     I              OMCQCD                          WGCQCD
     I              OMR4CD                          WGR4CD
     I              OMZ1ST                          WGZ1ST
     I              OMZ3ST                          WGZ3ST
     I              OMZ4ST                          WGZ4ST
     I              OMDUPR                          WGDUPR
     I              OMB6VL                          WGB6VL
     I              OMA1AA                          WGA1AA
     I              OMFZSX                          WGFZSX
     I              OMF0SX                          WGF0SX
     I              OMF1SX                          WGF1SX
     I              OMF2SX                          WGF2SX
     I              OMF3SX                          WGF3SX
     I              OMF4SX                          WGF4SX
     I              OMF5SX                          WGF5SX
     I              OMF6SX                          WGF6SX
     I              OMF7SX                          WGF7SX
     I              OMNTDT                          WGNTDT
     I              OMNUDT                          WGNUDT
     I              OMNVDT                          WGNVDT
     I              OMNWDT                          WGNWDT
     I              OMNXDT                          WGNXDT
     I              OMBUTM                          WGBUTM
     I              OMBVTM                          WGBVTM
     I              OMBWTM                          WGBWTM
     I              OMBXTM                          WGBXTM
     I              OMBYTM                          WGBYTM
     I              OMH5NX                          WGH5NX
     I              OMH6NX                          WGH6NX
     I              OMH7NX                          WGH7NX
     I              OMH8NX                          WGH8NX
     I              OMH9NX                          WGH9NX
     I              OMDVPR                          WGDVPR
     I              OMDWPR                          WGDWPR
     I              OMDXPR                          WGDXPR
     I              OMDYPR                          WGDYPR
     I              OMDZPR                          WGDZPR
     I              OMGSPR                          WGGSPR
     I              OMGTPR                          WGGTPR
     I              OMGUPR                          WGGUPR
     I              OMHOST                          WGHOST
     I              OMHPST                          WGHPST
     I              OMIOST                          WGIOST
     I              OMPEWG                          WGPEWG
     I              OMRINY                          WGRINY
     I              OMTIDT                          WGTIDT
     I              OMTJDT                          WGTJDT
     I              OMH2ST                          WGH2ST
     I              OMH0ST                          WGH0ST
     I              OMH1ST                          WGH1ST
     I              OMTKDT                          WGTKDT
     I              OMTLDT                          WGTLDT
     I              OMTMDT                          WGTMDT
     I              OMUVST                          WGUVST
     I              OMUWST                          WGUWST
     I              OMUXST                          WGUXST
     I              OMAATM                          WGAATM
     I              OMAYNA                          WGAYNA
     I              OMA0NA                          WGA0NA
     I              OMAXDT                          WGAXDT
      *
     I@IHRERN
      * Price Method Header       Retrieval index
      * Renamed input format fields
     I              IHAIC3                          WHAIC3
     I              IHQ7CD                          WHQ7CD
     I              IHMLNA                          WHMLNA
     I              IHU0ST                          WHU0ST
     I              IHV8ST                          WHV8ST
     I              IHBYST                          WHBYST
     I              IHRMNY                          WHRMNY
     I              IHH3ST                          WHH3ST
     I              IHH5ST                          WHH5ST
     I              IHH6ST                          WHH6ST
     I              IHH7ST                          WHH7ST
     I              IHUVST                          WHUVST
     I              IHUWST                          WHUWST
     I              IHUXST                          WHUXST
     I              IHAATM                          WHAATM
     I              IHAYNA                          WHAYNA
     I              IHA0NA                          WHA0NA
     I              IHAXDT                          WHAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WIAIC3
     I              BZHGCD                          WIHGCD
     I              BZAVNA                          WIAVNA
     I              BZAWNA                          WIAWNA
     I              BZL7NA                          WIL7NA
     I              BZL8NA                          WIL8NA
     I              BZL6NA                          WIL6NA
     I              BZMFNA                          WIMFNA
     I              BZADCD                          WIADCD
     I              BZAWPC                          WIAWPC
     I              BZLXST                          WILXST
     I              BZAECD                          WIAECD
     I              BZAXPC                          WIAXPC
     I              BZLYST                          WILYST
     I              BZAFCD                          WIAFCD
     I              BZAICD                          WIAICD
     I              BZAIWG                          WIAIWG
     I              BZHICD                          WIHICD
     I              BZRBCD                          WIRBCD
     I              BZFZST                          WIFZST
     I              BZAVST                          WIAVST
     I              BZCZWG                          WICZWG
     I              BZC0WG                          WIC0WG
     I              BZURTN                          WIURTN
     I              BZAJC8                          WIAJC8
     I              BZRINB                          WIRINB
     I              BZRHNB                          WIRHNB
     I              BZRGNB                          WIRGNB
     I              BZLNCD                          WILNCD
     I              BZTFNB                          WITFNB
     I              BZN0CD                          WIN0CD
     I              BZX4ST                          WIX4ST
     I              BZTMVA                          WITMVA
     I              BZTNVA                          WITNVA
     I              BZBLPR                          WIBLPR
     I              BZBMPR                          WIBMPR
     I              BZLRCD                          WILRCD
     I              BZU9ST                          WIU9ST
     I              BZCMCO                          WICMCO
     I              BZQ1CD                          WIQ1CD
     I              BZQ8CD                          WIQ8CD
     I              BZCHTM                          WICHTM
     I              BZQZCD                          WIQZCD
     I              BZXWST                          WIXWST
     I              BZXXST                          WIXXST
     I              BZVMST                          WIVMST
     I              BZSWGH                          WISWGH
     I              BZPPHE                          WIPPHE
     I              BZR3CD                          WIR3CD
     I              BZSDCD                          WISDCD
     I              BZICN1                          WIICN1
     I              BZSVCD                          WISVCD
     I              BZICN2                          WIICN2
     I              BZSWCD                          WISWCD
     I              BZV2NB                          WIV2NB
     I              BZSXCD                          WISXCD
     I              BZITCN                          WIITCN
     I              BZSYCD                          WISYCD
     I              BZITC5                          WIITC5
     I              BZSZCD                          WISZCD
     I              BZICN6                          WIICN6
     I              BZS0CD                          WIS0CD
     I              BZICN7                          WIICN7
     I              BZS1CD                          WIS1CD
     I              BZICN8                          WIICN8
     I              BZS2CD                          WIS2CD
     I              BZICN9                          WIICN9
     I              BZS3CD                          WIS3CD
     I              BZICN0                          WIICN0
     I              BZS4CD                          WIS4CD
     I              BZSFNB                          WISFNB
     I              BZA3WG                          WIA3WG
     I              BZSJNB                          WISJNB
     I              BZLLCD                          WILLCD
     I              BZLMCD                          WILMCD
     I              BZP3ST                          WIP3ST
     I              BZSKNB                          WISKNB
     I              BZSLNB                          WISLNB
     I              BZSMNB                          WISMNB
     I              BZP4ST                          WIP4ST
     I              BZCFNB                          WICFNB
     I              BZCGNB                          WICGNB
     I              BZILNB                          WIILNB
     I              BZCHNB                          WICHNB
     I              BZCINB                          WICINB
     I              BZCJNB                          WICJNB
     I              BZCMNB                          WICMNB
     I              BZCNNB                          WICNNB
     I              BZCRNB                          WICRNB
     I              BZCSNB                          WICSNB
     I              BZCVNB                          WICVNB
     I              BZCWNB                          WICWNB
     I              BZCXNB                          WICXNB
     I              BZCZNB                          WICZNB
     I              BZC0NB                          WIC0NB
     I              BZN1CD                          WIN1CD
     I              BZB4NB                          WIB4NB
     I              BZB5NB                          WIB5NB
     I              BZX5ST                          WIX5ST
     I              BZX6ST                          WIX6ST
     I              BZX7ST                          WIX7ST
     I              BZPCCT                          WIPCCT
     I              BZBDNB                          WIBDNB
     I              BZBJNB                          WIBJNB
     I              BZSUST                          WISUST
     I              BZSVST                          WISVST
     I              BZSYST                          WISYST
     I              BZSZST                          WISZST
     I              BZS1ST                          WIS1ST
     I              BZXRCD                          WIXRCD
     I              BZXTCD                          WIXTCD
     I              BZXUCD                          WIXUCD
     I              BZF5WG                          WIF5WG
     I              BZF6WG                          WIF6WG
     I              BZF7WG                          WIF7WG
     I              BZBLNB                          WIBLNB
     I              BZBNNB                          WIBNNB
     I              BZS2ST                          WIS2ST
     I              BZS4ST                          WIS4ST
     I              BZS5ST                          WIS5ST
     I              BZS6ST                          WIS6ST
     I              BZS8ST                          WIS8ST
     I              BZS9ST                          WIS9ST
     I              BZTCST                          WITCST
     I              BZTDST                          WITDST
     I              BZUVST                          WIUVST
     I              BZUWST                          WIUWST
     I              BZUXST                          WIUXST
     I              BZVSST                          WIVSST
     I              BZAATM                          WIAATM
     I              BZAYNA                          WIAYNA
     I              BZA0NA                          WIA0NA
     I              BZAXDT                          WIAXDT
      *
     I@ASREVL
      * Company Control           Retrieval Active Only
      * Renamed input format fields
     I              ASAIC3                          WJAIC3
     I              ASAXNB                          WJAXNB
     I              ASNGNB                          WJNGNB
     I              ASBZNB                          WJBZNB
     I              ASC5NB                          WJC5NB
     I              ASC3NB                          WJC3NB
     I              ASCYNB                          WJCYNB
     I              ASIONB                          WJIONB
     I              ASI6NB                          WJI6NB
     I              ASDCNB                          WJDCNB
     I              ASC7NB                          WJC7NB
     I              ASC2NB                          WJC2NB
     I              ASC1NB                          WJC1NB
     I              ASL8NB                          WJL8NB
     I              ASBANB                          WJBANB
     I              ASCHST                          WJCHST
     I              ASCKST                          WJCKST
     I              ASCIST                          WJCIST
     I              ASCGST                          WJCGST
     I              ASAIPC                          WJAIPC
     I              ASASPC                          WJASPC
     I              ASA2VA                          WJA2VA
     I              ASC2ST                          WJC2ST
     I              ASD8ST                          WJD8ST
     I              ASD7ST                          WJD7ST
     I              ASA8NA                          WJA8NA
     I              ASA9NA                          WJA9NA
     I              ASBANA                          WJBANA
     I              ASBBNA                          WJBBNA
     I              ASEUST                          WJEUST
     I              ASAADY                          WJAADY
     I              ASABDY                          WJABDY
     I              ASACDY                          WJACDY
     I              ASADDY                          WJADDY
     I              ASAEDY                          WJAEDY
     I              ASAFDY                          WJAFDY
     I              ASAGDY                          WJAGDY
     I              ASAHDY                          WJAHDY
     I              ASAENB                          WJAENB
     I              ASALNB                          WJALNB
     I              ASEVNB                          WJEVNB
     I              ASRPOP                          WJRPOP
     I              ASDWNB                          WJDWNB
     I              ASR3NB                          WJR3NB
     I              ASPNST                          WJPNST
     I              ASR4NB                          WJR4NB
     I              ASPOST                          WJPOST
     I              ASSCNB                          WJSCNB
     I              ASVIST                          WJVIST
     I              ASVJST                          WJVJST
     I              ASBVVN                          WJBVVN
     I              ASUVST                          WJUVST
     I              ASUWST                          WJUWST
     I              ASUXST                          WJUXST
     I              ASVSST                          WJVSST
     I              ASAATM                          WJAATM
     I              ASAYNA                          WJAYNA
     I              ASA0NA                          WJA0NA
     I              ASAXDT                          WJAXDT
      *
     I@F0CPEP
      * Commodity Mrkt Price      Market Date Descending
      * Renamed input format fields
     I              F0LQCD                          WKLQCD
     I              F0LRCD                          WKLRCD
     I              F0EQDT                          WKEQDT
     I              F0A5PR                          WKA5PR
     I              F0B8PR                          WKB8PR
     I              F0UVST                          WKUVST
     I              F0UWST                          WKUWST
     I              F0UXST                          WKUXST
     I              F0VSST                          WKVSST
     I              F0AATM                          WKAATM
     I              F0AYNA                          WKAYNA
     I              F0A0NA                          WKA0NA
     I              F0AXDT                          WKAXDT
      *
     I@K3CPKR
      * Price Change Audit Log    Co/Ord/Seq1&2/AdtSeq (D)
      * Renamed input format fields
     I              K3AIC3                          WLAIC3
     I              K3C4NB                          WLC4NB
     I              K3DPNB                          WLDPNB
     I              K3UENB                          WLUENB
     I              K3ASNO                          WLASNO
     I              K3HGCD                          WLHGCD
     I              K3GMST                          WLGMST
     I              K3GNST                          WLGNST
     I              K3AYVA                          WLAYVA
     I              K3YJVA                          WLYJVA
     I              K3U1ST                          WLU1ST
     I              K3PSTL                          WLPSTL
     I              K3U0ST                          WLU0ST
     I              K3RFCD                          WLRFCD
     I              K3PALS                          WLPALS
     I              K3WWCD                          WLWWCD
     I              K3AKPR                          WLAKPR
     I              K3DBPR                          WLDBPR
     I              K3ALPR                          WLALPR
     I              K3DCPR                          WLDCPR
     I              K3JPCD                          WLJPCD
     I              K3WXCD                          WLWXCD
     I              K3PREC                          WLPREC
     I              K3PIDX                          WLPIDX
     I              K3UVST                          WLUVST
     I              K3UWST                          WLUWST
     I              K3UXST                          WLUXST
     I              K3AATM                          WLAATM
     I              K3AYNA                          WLAYNA
     I              K3A0NA                          WLA0NA
     I              K3AXDT                          WLAXDT
      *
     I@K3CPKP
      * Price Change Audit Log    Update index
      * Renamed input format fields
     I              K3AIC3                          WMAIC3
     I              K3C4NB                          WMC4NB
     I              K3DPNB                          WMDPNB
     I              K3UENB                          WMUENB
     I              K3ASNO                          WMASNO
     I              K3HGCD                          WMHGCD
     I              K3GMST                          WMGMST
     I              K3GNST                          WMGNST
     I              K3AYVA                          WMAYVA
     I              K3YJVA                          WMYJVA
     I              K3U1ST                          WMU1ST
     I              K3PSTL                          WMPSTL
     I              K3U0ST                          WMU0ST
     I              K3RFCD                          WMRFCD
     I              K3PALS                          WMPALS
     I              K3WWCD                          WMWWCD
     I              K3AKPR                          WMAKPR
     I              K3DBPR                          WMDBPR
     I              K3ALPR                          WMALPR
     I              K3DCPR                          WMDCPR
     I              K3JPCD                          WMJPCD
     I              K3WXCD                          WMWXCD
     I              K3PREC                          WMPREC
     I              K3PIDX                          WMPIDX
     I              K3UVST                          WMUVST
     I              K3UWST                          WMUWST
     I              K3UXST                          WMUXST
     I              K3AATM                          WMAATM
     I              K3AYNA                          WMAYNA
     I              K3A0NA                          WMA0NA
     I              K3AXDT                          WMAXDT
      *
     I@BGWKAE
      * Order Detail              co/
      * Renamed input format fields
     I              OMAIC3                          WOAIC3
     I              OMC4NB                          WOC4NB
     I              OMDPNB                          WODPNB
     I              OMUENB                          WOUENB
     I              OMHGCD                          WOHGCD
     I              OMAJCD                          WOAJCD
     I              OMBKC7                          WOBKC7
     I              OMCFC7                          WOCFC7
     I              OMGMST                          WOGMST
     I              OMGNST                          WOGNST
     I              OMMAVA                          WOMAVA
     I              OMKDVA                          WOKDVA
     I              OML8VA                          WOL8VA
     I              OML9VA                          WOL9VA
     I              OMGTST                          WOGTST
     I              OMGVST                          WOGVST
     I              OMGUST                          WOGUST
     I              OMQFST                          WOQFST
     I              OMAYVA                          WOAYVA
     I              OMEXDT                          WOEXDT
     I              OMLQCD                          WOLQCD
     I              OMRDCD                          WORDCD
     I              OMQ7CD                          WOQ7CD
     I              OMBZPR                          WOBZPR
     I              OML6NB                          WOL6NB
     I              OMU1ST                          WOU1ST
     I              OMGIDT                          WOGIDT
     I              OMCRCD                          WOCRCD
     I              OMAGCD                          WOAGCD
     I              OMRZST                          WORZST
     I              OMR0ST                          WOR0ST
     I              OMR1ST                          WOR1ST
     I              OMG7NA                          WOG7NA
     I              OMG8NA                          WOG8NA
     I              OMRPCD                          WORPCD
     I              OMVEST                          WOVEST
     I              OMVGST                          WOVGST
     I              OMAVST                          WOAVST
     I              OMU0ST                          WOU0ST
     I              OMRFCD                          WORFCD
     I              OMFZST                          WOFZST
     I              OMR1NB                          WOR1NB
     I              OMAVQT                          WOAVQT
     I              OMD0WG                          WOD0WG
     I              OMCCQT                          WOCCQT
     I              OMAUWG                          WOAUWG
     I              OMCBQT                          WOCBQT
     I              OMATWG                          WOATWG
     I              OMAQCS                          WOAQCS
     I              OMAGCS                          WOAGCS
     I              OMAKPR                          WOAKPR
     I              OMALPR                          WOALPR
     I              OMAUPR                          WOAUPR
     I              OMAVWG                          WOAVWG
     I              OMA4WG                          WOA4WG
     I              OMA5DT                          WOA5DT
     I              OMAODT                          WOAODT
     I              OMGNDT                          WOGNDT
     I              OMAMST                          WOAMST
     I              OMANST                          WOANST
     I              OMVAST                          WOVAST
     I              OMRGNB                          WORGNB
     I              OMRHNB                          WORHNB
     I              OMRINB                          WORINB
     I              OMRBCD                          WORBCD
     I              OMHICD                          WOHICD
     I              OMRNCD                          WORNCD
     I              OMROCD                          WOROCD
     I              OMCXDT                          WOCXDT
     I              OMAJVN                          WOAJVN
     I              OMKXCD                          WOKXCD
     I              OMJPCD                          WOJPCD
     I              OMCQCD                          WOCQCD
     I              OMR4CD                          WOR4CD
     I              OMZ1ST                          WOZ1ST
     I              OMZ3ST                          WOZ3ST
     I              OMZ4ST                          WOZ4ST
     I              OMDUPR                          WODUPR
     I              OMB6VL                          WOB6VL
     I              OMA1AA                          WOA1AA
     I              OMFZSX                          WOFZSX
     I              OMF0SX                          WOF0SX
     I              OMF1SX                          WOF1SX
     I              OMF2SX                          WOF2SX
     I              OMF3SX                          WOF3SX
     I              OMF4SX                          WOF4SX
     I              OMF5SX                          WOF5SX
     I              OMF6SX                          WOF6SX
     I              OMF7SX                          WOF7SX
     I              OMNTDT                          WONTDT
     I              OMNUDT                          WONUDT
     I              OMNVDT                          WONVDT
     I              OMNWDT                          WONWDT
     I              OMNXDT                          WONXDT
     I              OMBUTM                          WOBUTM
     I              OMBVTM                          WOBVTM
     I              OMBWTM                          WOBWTM
     I              OMBXTM                          WOBXTM
     I              OMBYTM                          WOBYTM
     I              OMH5NX                          WOH5NX
     I              OMH6NX                          WOH6NX
     I              OMH7NX                          WOH7NX
     I              OMH8NX                          WOH8NX
     I              OMH9NX                          WOH9NX
     I              OMDVPR                          WODVPR
     I              OMDWPR                          WODWPR
     I              OMDXPR                          WODXPR
     I              OMDYPR                          WODYPR
     I              OMDZPR                          WODZPR
     I              OMGSPR                          WOGSPR
     I              OMGTPR                          WOGTPR
     I              OMGUPR                          WOGUPR
     I              OMHOST                          WOHOST
     I              OMHPST                          WOHPST
     I              OMIOST                          WOIOST
     I              OMPEWG                          WOPEWG
     I              OMRINY                          WORINY
     I              OMTIDT                          WOTIDT
     I              OMTJDT                          WOTJDT
     I              OMH2ST                          WOH2ST
     I              OMH0ST                          WOH0ST
     I              OMH1ST                          WOH1ST
     I              OMTKDT                          WOTKDT
     I              OMTLDT                          WOTLDT
     I              OMTMDT                          WOTMDT
     I              OMUVST                          WOUVST
     I              OMUWST                          WOUWST
     I              OMUXST                          WOUXST
     I              OMAATM                          WOAATM
     I              OMAYNA                          WOAYNA
     I              OMA0NA                          WOA0NA
     I              OMAXDT                          WOAXDT
      *
     I@EXRETY
      * Order Types               Active order Types
      * Renamed input format fields
     I              EXJNCD                          WRJNCD
     I              EXJVNA                          WRJVNA
     I              EXOAST                          WROAST
     I              EXOBST                          WROBST
     I              EXOEST                          WROEST
     I              EXOFST                          WROFST
     I              EXVBST                          WRVBST
     I              EXPYST                          WRPYST
     I              EXX8ST                          WRX8ST
     I              EXISTX                          WRISTX
     I              EXUVST                          WRUVST
     I              EXUWST                          WRUWST
     I              EXUXST                          WRUXST
     I              EXVSST                          WRVSST
     I              EXAATM                          WRAATM
     I              EXAYNA                          WRAYNA
     I              EXA0NA                          WRA0NA
     I              EXAXDT                          WRAXDT
      *
     I@BCREFE
      * A/R Summary               Retrieval index       NV
      * Renamed input format fields
     I              BCAIC3                          WSAIC3
     I              BCANC7                          WSANC7
     I              BCAGVA                          WSAGVA
     I              BCACVA                          WSACVA
     I              BCADVA                          WSADVA
     I              BCAEVA                          WSAEVA
     I              BCAFVA                          WSAFVA
     I              BCAHVA                          WSAHVA
     I              BCVIVA                          WSVIVA
     I              BCVJVA                          WSVJVA
     I              BCVKVA                          WSVKVA
     I              BCVLVA                          WSVLVA
     I              BCVMVA                          WSVMVA
     I              BCVNVA                          WSVNVA
     I              BCEEVA                          WSEEVA
     I              BCAKTM                          WSAKTM
     I              BCAHDT                          WSAHDT
     I              BCANDT                          WSANDT
     I              BCANVA                          WSANVA
     I              BCALDT                          WSALDT
     I              BCAMVA                          WSAMVA
     I              BCAIDT                          WSAIDT
     I              BCALVA                          WSALVA
     I              BCDJNB                          WSDJNB
     I              BCDLNB                          WSDLNB
     I              BCDDNB                          WSDDNB
     I              BCDMNB                          WSDMNB
     I              BCDUDT                          WSDUDT
     I              BCLYNO                          WSLYNO
     I              BCLYNC                          WSLYNC
     I              BCLYNP                          WSLYNP
     I              BCLYNI                          WSLYNI
     I              BCADPM                          WSADPM
     I              BCVOVA                          WSVOVA
     I              BCBTDY                          WSBTDY
     I              BCBUDY                          WSBUDY
     I              BCVPVA                          WSVPVA
     I              BCVQVA                          WSVQVA
     I              BCBCCD                          WSBCCD
     I              BCR4CD                          WSR4CD
     I              BCCUMO                          WSCUMO
     I              BCUVST                          WSUVST
     I              BCUWST                          WSUWST
     I              BCUXST                          WSUXST
     I              BCAATM                          WSAATM
     I              BCAYNA                          WSAYNA
     I              BCA0NA                          WSA0NA
     I              BCAXDT                          WSAXDT
      *
     I@BCREFD
      * A/R Summary               Update index
      * Renamed input format fields
     I              BCAIC3                          WTAIC3
     I              BCANC7                          WTANC7
     I              BCAGVA                          WTAGVA
     I              BCACVA                          WTACVA
     I              BCADVA                          WTADVA
     I              BCAEVA                          WTAEVA
     I              BCAFVA                          WTAFVA
     I              BCAHVA                          WTAHVA
     I              BCVIVA                          WTVIVA
     I              BCVJVA                          WTVJVA
     I              BCVKVA                          WTVKVA
     I              BCVLVA                          WTVLVA
     I              BCVMVA                          WTVMVA
     I              BCVNVA                          WTVNVA
     I              BCEEVA                          WTEEVA
     I              BCAKTM                          WTAKTM
     I              BCAHDT                          WTAHDT
     I              BCANDT                          WTANDT
     I              BCANVA                          WTANVA
     I              BCALDT                          WTALDT
     I              BCAMVA                          WTAMVA
     I              BCAIDT                          WTAIDT
     I              BCALVA                          WTALVA
     I              BCDJNB                          WTDJNB
     I              BCDLNB                          WTDLNB
     I              BCDDNB                          WTDDNB
     I              BCDMNB                          WTDMNB
     I              BCDUDT                          WTDUDT
     I              BCLYNO                          WTLYNO
     I              BCLYNC                          WTLYNC
     I              BCLYNP                          WTLYNP
     I              BCLYNI                          WTLYNI
     I              BCADPM                          WTADPM
     I              BCVOVA                          WTVOVA
     I              BCBTDY                          WTBTDY
     I              BCBUDY                          WTBUDY
     I              BCVPVA                          WTVPVA
     I              BCVQVA                          WTVQVA
     I              BCBCCD                          WTBCCD
     I              BCR4CD                          WTR4CD
     I              BCCUMO                          WTCUMO
     I              BCUVST                          WTUVST
     I              BCUWST                          WTUWST
     I              BCUXST                          WTUXST
     I              BCAATM                          WTAATM
     I              BCAYNA                          WTAYNA
     I              BCA0NA                          WTA0NA
     I              BCAXDT                          WTAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WVAIC3
     I              BEC4NB                          WVC4NB
     I              BEJNCD                          WVJNCD
     I              BEANC7                          WVANC7
     I              BEBKC7                          WVBKC7
     I              BEBRTX                          WVBRTX
     I              BEHMNA                          WVHMNA
     I              BEHONA                          WVHONA
     I              BEHPNA                          WVHPNA
     I              BEHNNA                          WVHNNA
     I              BEDBCD                          WVDBCD
     I              BECKTX                          WVCKTX
     I              BEB0C7                          WVB0C7
     I              BEAETX                          WVAETX
     I              BEB1NA                          WVB1NA
     I              BEB3NA                          WVB3NA
     I              BEB4NA                          WVB4NA
     I              BEB2NA                          WVB2NA
     I              BEBHCD                          WVBHCD
     I              BEC8TX                          WVC8TX
     I              BEBCNA                          WVBCNA
     I              BEA0DT                          WVA0DT
     I              BEA5DT                          WVA5DT
     I              BEGNDT                          WVGNDT
     I              BEACDT                          WVACDT
     I              BEAQCD                          WVAQCD
     I              BEB6NA                          WVB6NA
     I              BEBYNA                          WVBYNA
     I              BEBZNA                          WVBZNA
     I              BEGTST                          WVGTST
     I              BEGVST                          WVGVST
     I              BEGUST                          WVGUST
     I              BEQFST                          WVQFST
     I              BECQCD                          WVCQCD
     I              BEGJST                          WVGJST
     I              BEGWST                          WVGWST
     I              BEGXST                          WVGXST
     I              BEGYST                          WVGYST
     I              BEAODT                          WVAODT
     I              BEAIVN                          WVAIVN
     I              BECXDT                          WVCXDT
     I              BEJZVA                          WVJZVA
     I              BEA1WG                          WVA1WG
     I              BEXIST                          WVXIST
     I              BEXJST                          WVXJST
     I              BEXKST                          WVXKST
     I              BEEIDT                          WVEIDT
     I              BEAFTM                          WVAFTM
     I              BEE8CD                          WVE8CD
     I              BEE9CD                          WVE9CD
     I              BERMNB                          WVRMNB
     I              BETBNB                          WVTBNB
     I              BER1NB                          WVR1NB
     I              BEPJST                          WVPJST
     I              BEU0ST                          WVU0ST
     I              BEU1ST                          WVU1ST
     I              BEQ2CD                          WVQ2CD
     I              BEU2ST                          WVU2ST
     I              BEVEST                          WVVEST
     I              BEVFST                          WVVFST
     I              BEVGST                          WVVGST
     I              BERPCD                          WVRPCD
     I              BERNNB                          WVRNNB
     I              BEVDST                          WVVDST
     I              BEATIN                          WVATIN
     I              BEU4ST                          WVU4ST
     I              BEU5ST                          WVU5ST
     I              BERSRN                          WVRSRN
     I              BEMHNA                          WVMHNA
     I              BEMINA                          WVMINA
     I              BEWBST                          WVWBST
     I              BER4CD                          WVR4CD
     I              BEBFCD                          WVBFCD
     I              BEQ4CD                          WVQ4CD
     I              BET3NB                          WVT3NB
     I              BESICD                          WVSICD
     I              BECONB                          WVCONB
     I              BECEST                          WVCEST
     I              BEAWDT                          WVAWDT
     I              BEJPCD                          WVJPCD
     I              BEXUST                          WVXUST
     I              BEZ1ST                          WVZ1ST
     I              BEVRVA                          WVVRVA
     I              BEOBST                          WVOBST
     I              BEBCST                          WVBCST
     I              BEBDST                          WVBDST
     I              BEB7VL                          WVB7VL
     I              BEGASX                          WVGASX
     I              BEGBSX                          WVGBSX
     I              BEGCSX                          WVGCSX
     I              BEGDSX                          WVGDSX
     I              BEFNSX                          WVFNSX
     I              BEFOSX                          WVFOSX
     I              BEFPSX                          WVFPSX
     I              BEFQSX                          WVFQSX
     I              BEFRSX                          WVFRSX
     I              BEFSSX                          WVFSSX
     I              BEFTSX                          WVFTSX
     I              BEFUSX                          WVFUSX
     I              BEFVSX                          WVFVSX
     I              BEFWSX                          WVFWSX
     I              BEFXSX                          WVFXSX
     I              BEFYSX                          WVFYSX
     I              BENODT                          WVNODT
     I              BENPDT                          WVNPDT
     I              BENQDT                          WVNQDT
     I              BENRDT                          WVNRDT
     I              BENSDT                          WVNSDT
     I              BEBPTM                          WVBPTM
     I              BEBQTM                          WVBQTM
     I              BEBRTM                          WVBRTM
     I              BEBSTM                          WVBSTM
     I              BEBTTM                          WVBTTM
     I              BEH0NX                          WVH0NX
     I              BEH1NX                          WVH1NX
     I              BEH2NX                          WVH2NX
     I              BEH3NX                          WVH3NX
     I              BEH4NX                          WVH4NX
     I              BEC0C7                          WVC0C7
     I              BEUVST                          WVUVST
     I              BEUWST                          WVUWST
     I              BEUXST                          WVUXST
     I              BEAATM                          WVAATM
     I              BEAYNA                          WVAYNA
     I              BEA0NA                          WVA0NA
     I              BEAXDT                          WVAXDT
      *
     I@GQREH2
      * EDI Bill To Interchange   Retrieval index
      * Renamed input format fields
     I              GQB0C7                          WWB0C7
     I              GQM4AA                          WWM4AA
     I              GQM7AA                          WWM7AA
     I              GQJ5NX                          WWJ5NX
     I              GQA8U1                          WWA8U1
     I              GQA9U1                          WWA9U1
     I              GQBAU1                          WWBAU1
     I              GQBBU1                          WWBBU1
     I              GQY4NY                          WWY4NY
     I              GQY5NY                          WWY5NY
     I              GQBFU1                          WWBFU1
     I              GQBGU1                          WWBGU1
     I              GQBHU1                          WWBHU1
     I              GQBIU1                          WWBIU1
     I              GQSIAA                          WWSIAA
     I              GQSJAA                          WWSJAA
     I              GQVSST                          WWVSST
     I              GQMJDT                          WWMJDT
     I              GQBETM                          WWBETM
     I              GQCCVN                          WWCCVN
     I              GQCDVN                          WWCDVN
     I              GQMKDT                          WWMKDT
     I              GQBFTM                          WWBFTM
     I              GQCEVN                          WWCEVN
     I              GQCFVN                          WWCFVN
      *
     I@AMREJF
      * Order Header Extension    Retrieval index
      * Renamed input format fields
     I              AMAIC3                          WXAIC3
     I              AMC4NB                          WXC4NB
     I              AMRMNB                          WXRMNB
     I              AMRUNB                          WXRUNB
     I              AMXACD                          WXXACD
     I              AMOANA                          WXOANA
     I              AMHBAA                          WXHBAA
     I              AMJ0T1                          WXJ0T1
     I              AMGENY                          WXGENY
     I              AMJ1T1                          WXJ1T1
     I              AMHCAA                          WXHCAA
     I              AMQWDT                          WXQWDT
     I              AMQXDT                          WXQXDT
     I              AMQYDT                          WXQYDT
     I              AMHDAA                          WXHDAA
     I              AMCCTX                          WXCCTX
     I              AMJ2T1                          WXJ2T1
     I              AMRLNA                          WXRLNA
     I              AMRMNA                          WXRMNA
     I              AMGINY                          WXGINY
     I              AMGFNY                          WXGFNY
     I              AMGGNY                          WXGGNY
     I              AMGHNY                          WXGHNY
     I              AMHEVL                          WXHEVL
     I              AMHFVL                          WXHFVL
     I              AMHGVL                          WXHGVL
     I              AMQZDT                          WXQZDT
     I              AMQ0DT                          WXQ0DT
     I              AMQ1DT                          WXQ1DT
     I              AMQ2DT                          WXQ2DT
     I              AMC2TX                          WXC2TX
     I              AMC3TX                          WXC3TX
     I              AMC6TX                          WXC6TX
     I              AMCHTX                          WXCHTX
     I              AMCITX                          WXCITX
     I              AMCLTX                          WXCLTX
     I              AMB4TX                          WXB4TX
     I              AMCUTX                          WXCUTX
     I              AMCVTX                          WXCVTX
     I              AMB9TX                          WXB9TX
     I              AMJWSC                          WXJWSC
     I              AMITNY                          WXITNY
     I              AMLMT1                          WXLMT1
     I              AMLWAA                          WXLWAA
     I              AMFVST                          WXFVST
     I              AMF0ST                          WXF0ST
     I              AMF2ST                          WXF2ST
     I              AMF3ST                          WXF3ST
     I              AMJUSC                          WXJUSC
     I              AMJVSC                          WXJVSC
     I              AMV3T1                          WXV3T1
     I              AMV4T1                          WXV4T1
     I              AMV5T1                          WXV5T1
     I              AMV6T1                          WXV6T1
     I              AMV7T1                          WXV7T1
     I              AMV8T1                          WXV8T1
     I              AMV9T1                          WXV9T1
     I              AMWAT1                          WXWAT1
     I              AMWBT1                          WXWBT1
     I              AMWCT1                          WXWCT1
     I              AMWDT1                          WXWDT1
     I              AMQJNY                          WXQJNY
     I              AMQKNY                          WXQKNY
     I              AMQLNY                          WXQLNY
     I              AMP8NY                          WXP8NY
     I              AMP9NY                          WXP9NY
     I              AMQANY                          WXQANY
     I              AMQCNY                          WXQCNY
     I              AMQDNY                          WXQDNY
     I              AMQENY                          WXQENY
     I              AMQFNY                          WXQFNY
     I              AMQGNY                          WXQGNY
     I              AMQHNY                          WXQHNY
     I              AMQINY                          WXQINY
     I              AMQMNY                          WXQMNY
     I              AMMYU1                          WXMYU1
     I              AMJXSC                          WXJXSC
     I              AMJYSC                          WXJYSC
     I              AMJZSC                          WXJZSC
     I              AMJ0SC                          WXJ0SC
     I              AMMZU1                          WXMZU1
     I              AMM0U1                          WXM0U1
     I              AMM1U1                          WXM1U1
     I              AMM2U1                          WXM2U1
     I              AMM3U1                          WXM3U1
     I              AMW5DT                          WXW5DT
     I              AMW6DT                          WXW6DT
     I              AMUVST                          WXUVST
     I              AMUWST                          WXUWST
     I              AMUXST                          WXUXST
     I              AMVSST                          WXVSST
     I              AMAATM                          WXAATM
     I              AMAYNA                          WXAYNA
     I              AMA0NA                          WXA0NA
     I              AMAXDT                          WXAXDT
      *
     I@P004SK
      * EDI Purchase Order Header Trade Partner/PO Number
      * Renamed input format fields
     I              BQTSCN                          WYTSCN
     I              BQL3SX                          WYL3SX
     I              BQOSDT                          WYOSDT
     I              BQPONO                          WYPONO
     I              BQDKAA                          WYDKAA
     I              BQNAME                          WYNAME
     I              BQCQLF                          WYCQLF
     I              BQCNUM                          WYCNUM
     I              BQINRF                          WYINRF
     I              BQGNTX                          WYGNTX
     I              BQHUAA                          WYHUAA
     I              BQHUVL                          WYHUVL
     I              BQHVAA                          WYHVAA
     I              BQX8T1                          WYX8T1
     I              BQJ2AA                          WYJ2AA
     I              BQT6DT                          WYT6DT
     I              BQQLFX                          WYQLFX
     I              BQDELV                          WYDELV
     I              BQSHMT                          WYSHMT
     I              BQMTTY                          WYMTTY
     I              BQPLEX                          WYPLEX
     I              BQLDOP                          WYLDOP
     I              BQROUT                          WYROUT
     I              BQFOBP                          WYFOBP
     I              BQD3VL                          WYD3VL
     I              BQUNIT                          WYUNIT
     I              BQD4VL                          WYD4VL
     I              BQAMTX                          WYAMTX
     I              BQDSTS                          WYDSTS
     I              BQSRAA                          WYSRAA
     I              BQBRU1                          WYBRU1
     I              BQSSAA                          WYSSAA
     I              BQBSU1                          WYBSU1
     I              BQSTAA                          WYSTAA
     I              BQBTU1                          WYBTU1
     I              BQSUAA                          WYSUAA
     I              BQBUU1                          WYBUU1
     I              BQSVAA                          WYSVAA
     I              BQBVU1                          WYBVU1
     I              BQSWAA                          WYSWAA
     I              BQBWU1                          WYBWU1
     I              BQSXAA                          WYSXAA
     I              BQBXU1                          WYBXU1
     I              BQYDT1                          WYYDT1
     I              BQNLST                          WYNLST
     I              BQUFDT                          WYUFDT
     I              BQOJAA                          WYOJAA
     I              BQJ5NX                          WYJ5NX
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WGAIC3
     I              OMC4NB                          WGC4NB
     I              OMDPNB                          WGDPNB
     I              OMUENB                          WGUENB
     I              OMHGCD                          WGHGCD
     I              OMAJCD                          WGAJCD
     I              OMBKC7                          WGBKC7
     I              OMCFC7                          WGCFC7
     I              OMGMST                          WGGMST
     I              OMGNST                          WGGNST
     I              OMMAVA                          WGMAVA
     I              OMKDVA                          WGKDVA
     I              OML8VA                          WGL8VA
     I              OML9VA                          WGL9VA
     I              OMGTST                          WGGTST
     I              OMGVST                          WGGVST
     I              OMGUST                          WGGUST
     I              OMQFST                          WGQFST
     I              OMAYVA                          WGAYVA
     I              OMEXDT                          WGEXDT
     I              OMLQCD                          WGLQCD
     I              OMRDCD                          WGRDCD
     I              OMQ7CD                          WGQ7CD
     I              OMBZPR                          WGBZPR
     I              OML6NB                          WGL6NB
     I              OMU1ST                          WGU1ST
     I              OMGIDT                          WGGIDT
     I              OMCRCD                          WGCRCD
     I              OMAGCD                          WGAGCD
     I              OMRZST                          WGRZST
     I              OMR0ST                          WGR0ST
     I              OMR1ST                          WGR1ST
     I              OMG7NA                          WGG7NA
     I              OMG8NA                          WGG8NA
     I              OMRPCD                          WGRPCD
     I              OMVEST                          WGVEST
     I              OMVGST                          WGVGST
     I              OMAVST                          WGAVST
     I              OMU0ST                          WGU0ST
     I              OMRFCD                          WGRFCD
     I              OMFZST                          WGFZST
     I              OMR1NB                          WGR1NB
     I              OMAVQT                          WGAVQT
     I              OMD0WG                          WGD0WG
     I              OMCCQT                          WGCCQT
     I              OMAUWG                          WGAUWG
     I              OMCBQT                          WGCBQT
     I              OMATWG                          WGATWG
     I              OMAQCS                          WGAQCS
     I              OMAGCS                          WGAGCS
     I              OMAKPR                          WGAKPR
     I              OMALPR                          WGALPR
     I              OMAUPR                          WGAUPR
     I              OMAVWG                          WGAVWG
     I              OMA4WG                          WGA4WG
     I              OMA5DT                          WGA5DT
     I              OMAODT                          WGAODT
     I              OMGNDT                          WGGNDT
     I              OMAMST                          WGAMST
     I              OMANST                          WGANST
     I              OMVAST                          WGVAST
     I              OMRGNB                          WGRGNB
     I              OMRHNB                          WGRHNB
     I              OMRINB                          WGRINB
     I              OMRBCD                          WGRBCD
     I              OMHICD                          WGHICD
     I              OMRNCD                          WGRNCD
     I              OMROCD                          WGROCD
     I              OMCXDT                          WGCXDT
     I              OMAJVN                          WGAJVN
     I              OMKXCD                          WGKXCD
     I              OMJPCD                          WGJPCD
     I              OMCQCD                          WGCQCD
     I              OMR4CD                          WGR4CD
     I              OMZ1ST                          WGZ1ST
     I              OMZ3ST                          WGZ3ST
     I              OMZ4ST                          WGZ4ST
     I              OMDUPR                          WGDUPR
     I              OMB6VL                          WGB6VL
     I              OMA1AA                          WGA1AA
     I              OMFZSX                          WGFZSX
     I              OMF0SX                          WGF0SX
     I              OMF1SX                          WGF1SX
     I              OMF2SX                          WGF2SX
     I              OMF3SX                          WGF3SX
     I              OMF4SX                          WGF4SX
     I              OMF5SX                          WGF5SX
     I              OMF6SX                          WGF6SX
     I              OMF7SX                          WGF7SX
     I              OMNTDT                          WGNTDT
     I              OMNUDT                          WGNUDT
     I              OMNVDT                          WGNVDT
     I              OMNWDT                          WGNWDT
     I              OMNXDT                          WGNXDT
     I              OMBUTM                          WGBUTM
     I              OMBVTM                          WGBVTM
     I              OMBWTM                          WGBWTM
     I              OMBXTM                          WGBXTM
     I              OMBYTM                          WGBYTM
     I              OMH5NX                          WGH5NX
     I              OMH6NX                          WGH6NX
     I              OMH7NX                          WGH7NX
     I              OMH8NX                          WGH8NX
     I              OMH9NX                          WGH9NX
     I              OMDVPR                          WGDVPR
     I              OMDWPR                          WGDWPR
     I              OMDXPR                          WGDXPR
     I              OMDYPR                          WGDYPR
     I              OMDZPR                          WGDZPR
     I              OMGSPR                          WGGSPR
     I              OMGTPR                          WGGTPR
     I              OMGUPR                          WGGUPR
     I              OMHOST                          WGHOST
     I              OMHPST                          WGHPST
     I              OMIOST                          WGIOST
     I              OMPEWG                          WGPEWG
     I              OMRINY                          WGRINY
     I              OMTIDT                          WGTIDT
     I              OMTJDT                          WGTJDT
     I              OMH2ST                          WGH2ST
     I              OMH0ST                          WGH0ST
     I              OMH1ST                          WGH1ST
     I              OMTKDT                          WGTKDT
     I              OMTLDT                          WGTLDT
     I              OMTMDT                          WGTMDT
     I              OMUVST                          WGUVST
     I              OMUWST                          WGUWST
     I              OMUXST                          WGUXST
     I              OMAATM                          WGAATM
     I              OMAYNA                          WGAYNA
     I              OMA0NA                          WGA0NA
     I              OMAXDT                          WGAXDT
      *
     IYARDCS      DS                            525
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPDK31    E DSPDK3CPL0
      * UPD : Price Change Audit Log    Update index
      * Renamed input format fields
     I              K3AIC3                          WMAIC3
     I              K3C4NB                          WMC4NB
     I              K3DPNB                          WMDPNB
     I              K3UENB                          WMUENB
     I              K3ASNO                          WMASNO
     I              K3HGCD                          WMHGCD
     I              K3GMST                          WMGMST
     I              K3GNST                          WMGNST
     I              K3AYVA                          WMAYVA
     I              K3YJVA                          WMYJVA
     I              K3U1ST                          WMU1ST
     I              K3PSTL                          WMPSTL
     I              K3U0ST                          WMU0ST
     I              K3RFCD                          WMRFCD
     I              K3PALS                          WMPALS
     I              K3WWCD                          WMWWCD
     I              K3AKPR                          WMAKPR
     I              K3DBPR                          WMDBPR
     I              K3ALPR                          WMALPR
     I              K3DCPR                          WMDCPR
     I              K3JPCD                          WMJPCD
     I              K3WXCD                          WMWXCD
     I              K3PREC                          WMPREC
     I              K3PIDX                          WMPIDX
     I              K3UVST                          WMUVST
     I              K3UWST                          WMUWST
     I              K3UXST                          WMUXST
     I              K3AATM                          WMAATM
     I              K3AYNA                          WMAYNA
     I              K3A0NA                          WMA0NA
     I              K3AXDT                          WMAXDT
      *
     IQARBC1    E DSARBCREL0
      * UPD : A/R Summary               Update index
      * Renamed input format fields
     I              BCAIC3                          WTAIC3
     I              BCANC7                          WTANC7
     I              BCAGVA                          WTAGVA
     I              BCACVA                          WTACVA
     I              BCADVA                          WTADVA
     I              BCAEVA                          WTAEVA
     I              BCAFVA                          WTAFVA
     I              BCAHVA                          WTAHVA
     I              BCVIVA                          WTVIVA
     I              BCVJVA                          WTVJVA
     I              BCVKVA                          WTVKVA
     I              BCVLVA                          WTVLVA
     I              BCVMVA                          WTVMVA
     I              BCVNVA                          WTVNVA
     I              BCEEVA                          WTEEVA
     I              BCAKTM                          WTAKTM
     I              BCAHDT                          WTAHDT
     I              BCANDT                          WTANDT
     I              BCANVA                          WTANVA
     I              BCALDT                          WTALDT
     I              BCAMVA                          WTAMVA
     I              BCAIDT                          WTAIDT
     I              BCALVA                          WTALVA
     I              BCDJNB                          WTDJNB
     I              BCDLNB                          WTDLNB
     I              BCDDNB                          WTDDNB
     I              BCDMNB                          WTDMNB
     I              BCDUDT                          WTDUDT
     I              BCLYNO                          WTLYNO
     I              BCLYNC                          WTLYNC
     I              BCLYNP                          WTLYNP
     I              BCLYNI                          WTLYNI
     I              BCADPM                          WTADPM
     I              BCVOVA                          WTVOVA
     I              BCBTDY                          WTBTDY
     I              BCBUDY                          WTBUDY
     I              BCVPVA                          WTVPVA
     I              BCVQVA                          WTVQVA
     I              BCBCCD                          WTBCCD
     I              BCR4CD                          WTR4CD
     I              BCCUMO                          WTCUMO
     I              BCUVST                          WTUVST
     I              BCUWST                          WTUWST
     I              BCUXST                          WTUXST
     I              BCAATM                          WTAATM
     I              BCAYNA                          WTAYNA
     I              BCA0NA                          WTA0NA
     I              BCAXDT                          WTAXDT
      *
     IYBRDCS      DS                            213
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WVAIC3
     I              BEC4NB                          WVC4NB
     I              BEJNCD                          WVJNCD
     I              BEANC7                          WVANC7
     I              BEBKC7                          WVBKC7
     I              BEBRTX                          WVBRTX
     I              BEHMNA                          WVHMNA
     I              BEHONA                          WVHONA
     I              BEHPNA                          WVHPNA
     I              BEHNNA                          WVHNNA
     I              BEDBCD                          WVDBCD
     I              BECKTX                          WVCKTX
     I              BEB0C7                          WVB0C7
     I              BEAETX                          WVAETX
     I              BEB1NA                          WVB1NA
     I              BEB3NA                          WVB3NA
     I              BEB4NA                          WVB4NA
     I              BEB2NA                          WVB2NA
     I              BEBHCD                          WVBHCD
     I              BEC8TX                          WVC8TX
     I              BEBCNA                          WVBCNA
     I              BEA0DT                          WVA0DT
     I              BEA5DT                          WVA5DT
     I              BEGNDT                          WVGNDT
     I              BEACDT                          WVACDT
     I              BEAQCD                          WVAQCD
     I              BEB6NA                          WVB6NA
     I              BEBYNA                          WVBYNA
     I              BEBZNA                          WVBZNA
     I              BEGTST                          WVGTST
     I              BEGVST                          WVGVST
     I              BEGUST                          WVGUST
     I              BEQFST                          WVQFST
     I              BECQCD                          WVCQCD
     I              BEGJST                          WVGJST
     I              BEGWST                          WVGWST
     I              BEGXST                          WVGXST
     I              BEGYST                          WVGYST
     I              BEAODT                          WVAODT
     I              BEAIVN                          WVAIVN
     I              BECXDT                          WVCXDT
     I              BEJZVA                          WVJZVA
     I              BEA1WG                          WVA1WG
     I              BEXIST                          WVXIST
     I              BEXJST                          WVXJST
     I              BEXKST                          WVXKST
     I              BEEIDT                          WVEIDT
     I              BEAFTM                          WVAFTM
     I              BEE8CD                          WVE8CD
     I              BEE9CD                          WVE9CD
     I              BERMNB                          WVRMNB
     I              BETBNB                          WVTBNB
     I              BER1NB                          WVR1NB
     I              BEPJST                          WVPJST
     I              BEU0ST                          WVU0ST
     I              BEU1ST                          WVU1ST
     I              BEQ2CD                          WVQ2CD
     I              BEU2ST                          WVU2ST
     I              BEVEST                          WVVEST
     I              BEVFST                          WVVFST
     I              BEVGST                          WVVGST
     I              BERPCD                          WVRPCD
     I              BERNNB                          WVRNNB
     I              BEVDST                          WVVDST
     I              BEATIN                          WVATIN
     I              BEU4ST                          WVU4ST
     I              BEU5ST                          WVU5ST
     I              BERSRN                          WVRSRN
     I              BEMHNA                          WVMHNA
     I              BEMINA                          WVMINA
     I              BEWBST                          WVWBST
     I              BER4CD                          WVR4CD
     I              BEBFCD                          WVBFCD
     I              BEQ4CD                          WVQ4CD
     I              BET3NB                          WVT3NB
     I              BESICD                          WVSICD
     I              BECONB                          WVCONB
     I              BECEST                          WVCEST
     I              BEAWDT                          WVAWDT
     I              BEJPCD                          WVJPCD
     I              BEXUST                          WVXUST
     I              BEZ1ST                          WVZ1ST
     I              BEVRVA                          WVVRVA
     I              BEOBST                          WVOBST
     I              BEBCST                          WVBCST
     I              BEBDST                          WVBDST
     I              BEB7VL                          WVB7VL
     I              BEGASX                          WVGASX
     I              BEGBSX                          WVGBSX
     I              BEGCSX                          WVGCSX
     I              BEGDSX                          WVGDSX
     I              BEFNSX                          WVFNSX
     I              BEFOSX                          WVFOSX
     I              BEFPSX                          WVFPSX
     I              BEFQSX                          WVFQSX
     I              BEFRSX                          WVFRSX
     I              BEFSSX                          WVFSSX
     I              BEFTSX                          WVFTSX
     I              BEFUSX                          WVFUSX
     I              BEFVSX                          WVFVSX
     I              BEFWSX                          WVFWSX
     I              BEFXSX                          WVFXSX
     I              BEFYSX                          WVFYSX
     I              BENODT                          WVNODT
     I              BENPDT                          WVNPDT
     I              BENQDT                          WVNQDT
     I              BENRDT                          WVNRDT
     I              BENSDT                          WVNSDT
     I              BEBPTM                          WVBPTM
     I              BEBQTM                          WVBQTM
     I              BEBRTM                          WVBRTM
     I              BEBSTM                          WVBSTM
     I              BEBTTM                          WVBTTM
     I              BEH0NX                          WVH0NX
     I              BEH1NX                          WVH1NX
     I              BEH2NX                          WVH2NX
     I              BEH3NX                          WVH3NX
     I              BEH4NX                          WVH4NX
     I              BEC0C7                          WVC0C7
     I              BEUVST                          WVUVST
     I              BEUWST                          WVUWST
     I              BEUXST                          WVUXST
     I              BEAATM                          WVAATM
     I              BEAYNA                          WVAYNA
     I              BEA0NA                          WVA0NA
     I              BEAXDT                          WVAXDT
      *
     IYCRDCS      DS                            779
      * Outward parameters
     IPARC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Order Number
     I                                    P   3   60PAC4NB
      * I :  Order Type - Sales
     I                                        7   8 PAJNCD
      * I :  AR Customer Number
     I                                    P   9  120PAANC7
      * I :  Ship To Customer
     I                                    P  13  160PABKC7
      * I :  Ship To Name
     I                                       17  46 PABRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PAHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PAHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PAHPNA
      * I :  Ship To City
     I                                      137 156 PAHNNA
      * I :  Ship To State Code
     I                                      157 158 PADBCD
      * I :  Ship To Zip/Postal Code
     I                                      159 169 PACKTX
      * I :  Bill to Customer
     I                                    P 170 1730PAB0C7
      * I :  Bill to Name
     I                                      174 203 PAAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PAB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PAB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PAB4NA
      * I :  Bill to City
     I                                      294 313 PAB2NA
      * I :  Bill to State Code
     I                                      314 315 PABHCD
      * I :  Bill to Zip/Postal Code
     I                                      316 326 PAC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PABCNA
      * I :  Order Date
     I                                    P 342 3450PAA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PAA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PAGNDT
      * I :  Cancel Date
     I                                    P 354 3570PAACDT
      * I :  Terms Code
     I                                      358 359 PAAQCD
      * I :  Special Instructions
     I                                      360 399 PAB6NA
      * I :  Special Instructions 2
     I                                      400 439 PABYNA
      * I :  Carrier Code
     I                                      440 442 PABZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PAGTST
      * I :  Comment Print Inv/Cr.Memo
     I                                      444 444 PAGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PAGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PAQFST
      * I :  Reason Code
     I                                      447 449 PACQCD
      * I :  Order in Use
     I                                      450 450 PAGJST
      * I :  Header Status
     I                                      451 451 PAGWST
      * I :  Header Status Last
     I                                      452 452 PAGXST
      * I :  Order Type Print Status
     I                                      453 453 PAGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PAAODT
      * I :  User Original Entry
     I                                      458 467 PAAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PACXDT
      * I :  Order Value Total
     I                                    P 472 4772PAJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PAA1WG
      * I :  Credit Hold
     I                                      484 484 PAXIST
      * I :  Production Hold
     I                                      485 485 PAXJST
      * I :  New Customer Hold
     I                                      486 486 PAXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PAEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PAAFTM
      * I :  Accounts Receiv. Ent 1
     I                                      494 497 PAE8CD
      * I :  Accounts Receiv. Ent 2
     I                                      498 509 PAE9CD
      * I :  Load ID
     I                                    P 510 5130PARMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PATBNB
      * I :  Rated Freight
     I                                    P 517 5222PAR1NB
      * I :  LTL Flag
     I                                      523 523 PAPJST
      * I :  Price Audit
     I                                      524 524 PAU0ST
      * I :  Price Status
     I                                      525 525 PAU1ST
      * I :  Shipping Method
     I                                      526 527 PAQ2CD
      * I :  Export Status
     I                                      528 528 PAU2ST
      * I :  Palletize
     I                                      529 529 PAVEST
      * I :  Shrink Wrap
     I                                      530 530 PAVFST
      * I :  Slip Sheet
     I                                      531 531 PAVGST
      * I :  Age Code
     I                                      532 532 PARPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PARNNB
      * I :  Load Type
     I                                      536 536 PAVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PAATIN
      * I :  Load Plan Order
     I                                      541 541 PAU4ST
      * I :  Print Pick Slip
     I                                      542 542 PAU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PARSRN
      * I :  Special Comment 1
     I                                      547 576 PAMHNA
      * I :  Special Comment 2
     I                                      577 606 PAMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PAWBST
      * I :  Sales Route Code
     I                                      608 610 PAR4CD
      * I :  Manager Level Code
     I                                      611 612 PABFCD
      * I :  VP Level Code
     I                                      613 615 PAQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PAT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PASICD
      * I :  Invoice Number
     I                                    P 623 6260PACONB
      * I :  Invoice Suffix
     I                                      627 628 PACEST
      * I :  Invoice Date
     I                                    P 629 6320PAAWDT
      * I :  Event Code
     I                                      633 634 PAJPCD
      * I :  Trans Contol AS400_Plant
     I                                      635 635 PAXUST
      * I :  Modified Flag
     I                                      636 636 PAZ1ST
      * I :  A/R order Value Total
     I                                    P 637 6422PAVRVA
      * I :  Billing Activity Type
     I                                      643 643 PAOBST
      * I :  Block Order Flag
     I                                      644 644 PABCST
      * I :  Order Certification Flag
     I                                      645 645 PABDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PAB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PAGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PAGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PAGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PAGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PAFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PAFOSX
      * I :  Order Emailed
     I                                      658 658 PAFPSX
      * I :  Export Docs Go w/Driver
     I                                      659 659 PAFQSX
      * I :  Shipping Temp Code C/F
     I                                      660 660 PAFRSX
      * I :  Broker Order Status
     I                                      661 661 PAFSSX
      * I :  Air Freight Order
     I                                      662 662 PAFTSX
      * I :  Order Requires Review
     I                                      663 664 PAFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PAFVSX
      * I :  Export USDA Approved
     I                                      667 668 PAFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PAFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PAFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PANODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PANPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PANQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PANRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PANSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PABPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PABQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PABRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PABSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PABTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PAH0NX
      * I :  Act Non-Ref Frt Amount
     I                                    P 721 7262PAH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PAH2NX
      * I :  OH Total Non-Ref Frt Amt
     I                                    P 733 7382PAH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PAH4NX
      * I :  Claim Number
     I                                    P 745 7480PAC0C7
      * I :  EDI Status 1
     I                                      749 749 PAUVST
      * I :  EDI Status 2
     I                                      750 750 PAUWST
      * I :  EDI Status 3
     I                                      751 751 PAUXST
      * I :  Job Time
     I                                    P 752 7550PAAATM
      * I :  User Id
     I                                      756 765 PAAYNA
      * I :  Job Name
     I                                      766 775 PAA0NA
      * I :  Job Date
     I                                    P 776 7790PAAXDT
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Detail
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Order Number
     I                                    P   3   60P1C4NB
      * I :  Order Sequence Number
     I                                    P   7   80P1DPNB
      * I :  Order Secondary Line Seq
     I                                    P   9  100P1UENB
     IP2PARM      DS
      * I :  Pricing Event Called From
     I                                        1   3 P2PECF
     IP3PARM      DS
      * FLD: Order Header TRG
      * N :  Order Value Total
     I                                    P   1   62P3JZVA
      * N :  Order Weight Total
     I                                    P   7  122P3A1WG
      * N :  Production Hold
     I                                       13  13 P3XJST
     IP4PARM      DS
      * N :  USR New Order
     I                                        1   4 P4W7ST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Send Price MSG to Seaboar'
      * Order Number
     I                                        1   7 ZA0001
      * Order Sequence Number
     I                                    P   8   90ZA0002
      * Item Code
     I                                       10  16 ZA0003
      * Catch Weight Status
     I                                       17  17 ZA0004
      * Unit Price
     I                                    P  18  234ZA0005
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
     C           P1DPNB    PARM           WP0003  30       Order Sequence
     C           P1UENB    PARM           WP0004  30       Order Secondary
     C           P2PECF    PARM           WP0005  3        Pricing Event C
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * CRT EDI POACK    TEST XF
      * CLC Price/Price Audit  RT - Order Header TRG  * 
     C                     EXSR SARVGN
      * Val for PO Ack        IF
     C                     MOVEL'N'       YL0016           EDI Process Fla
      * Retrieve the BT Customer
      * Rtv Order Info ALL    RT - Order Header TRG  * 
     C                     EXSR SVRVGN
      * Check to see it the BT Cust should get a POA/POAC (ack or chgd ac
      * RTV BT Intrchg BT custRT - EDI Bill To Interchange  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0017    WL0050           Bill to Custome
     C                     MOVEL'POACK'   WL0051    P      Interchange Cod
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0052    YL0020    P      POC/POCA ??
     C                     MOVELWL0053    YL0021    P      EDI Trading Par
      * W95589 DN 01/24/23-Commented Out & Moved Below.
      * W95589 DN 01/24/23-Only Check if Record Exist to Set EDI POA Flag
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Chk to see if BT cust requires a EDI PO ACK
      * CASE: LCL.POC/POCA ?? is PO Ack
     C           YL0020    IFEQ 'POACK'                    *IF
     C                     MOVEL'Y'       YL0022           EDI POA
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0022           EDI POA
     C                     END                             *FI
     C                     END                             *FI
      * RTV BT Intrchg BT custRT - EDI Bill To Interchange  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0017    WL0050           Bill to Custome
     C                     MOVEL'POCACK'  WL0051    P      Interchange Cod
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0052    YL0020    P      POC/POCA ??
     C                     MOVELWL0053    YL0021    P      EDI Trading Par
      * W95589 DN 01/24/23-Commented Out & Moved Below.
      * W95589 DN 01/24/23-Only Check if Record Exist to Set EDI POAC Fla
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Chk to see if BT cust requires a EDI PO Chg ACK
      * CASE: LCL.POC/POCA ?? is PO Change Ack
     C           YL0020    IFEQ @CN,001                    *IF
     C                     MOVEL'Y'       YL0023           EDI POAC
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0023           EDI POAC
     C                     END                             *FI
     C                     END                             *FI
      * See if a rcd has been written to OH ext.
      * RTV EDI PO Flag       RT - Order Header Extension  * 
     C                     EXSR SXRVGN
      * Record found in Order header ext
      * CASE: LCL.Record Found USR is Record Found
     C           YL0025    IFEQ 'Y'                        *IF
      * If flag blank, No ack has been sent for this PO yet.
      * CASE:
      *  - c1ORc2
      *   |- c1    : LCL.OHE PO ACK Flag is *Blank
      *   |- c2    : LCL.OHE PO ACK Flag is *NO
      *   '-
     C           YL0024    IFEQ *BLANK                     *IF
     C           YL0024    OREQ '*NO'                      *OR
      * CASE: LCL.EDI POA is Yes
     C           YL0022    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       YL0016           EDI Process Fla
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * If flag not blank, 855 ack has been sent for this PO. Need to sen
      * another 855(865) if the customer is set up for it.
      * CASE: LCL.EDI POAC is Yes
     C           YL0023    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       YL0016           EDI Process Fla
     C                     END                             *FI
     C                     END                             *FI
      * If record not found and POA is yes, send
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.EDI POA is Yes
     C           YL0022    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       YL0016           EDI Process Fla
     C                     END                             *FI
     C                     END                             *FI
      * When all chks are done, need to check to see if the Cust PO
      * has been entered. If not,do not send to customer.
      * If Cust PO# not entered
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5ORc6
      *   |- c1    : LCL.Customer Purchase Order # is tba
      *   |- c2    : LCL.Customer Purchase Order # is TBA(cap)
      *   |- c3    : LCL.Customer Purchase Order # is TBD(cap)
      *   |- c4    : LCL.Customer Purchase Order # is tbd
      *   |- c5    : LCL.Customer Purchase Order # is BLOCK(cap)
      *   |- c6    : LCL.Customer Purchase Order # is Block
      *   '-
     C           YL0018    IFEQ 'tba'                      *IF
     C           YL0018    OREQ 'TBA'                      *OR
     C           YL0018    OREQ 'TBD'                      *OR
     C           YL0018    OREQ 'tbd'                      *OR
     C           YL0018    OREQ 'BLOCK'                    *OR
     C           YL0018    OREQ 'Block'                    *OR
      * S13599 DN 08/16/18-Added check for 'TBD, tbd, BLOCK & Block'.
     C                     MOVEL'N'       YL0016           EDI Process Fla
     C                     MOVEL'NP'      YL0015           Trans Type 1 PA
     C                     END                             *FI
      * 2014/09/10 PKD/SAZ Check if PO was sent via EDI for SYSCO.  If ye
      *                    Create an 855; otherwise don't do it.
      * E003964 SLM  02/24/2015 logic for SYSCO & DSYSCO Work the same
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.EDI Trading Partner No. is SYSCO Dailys
      *   |- c2    : LCL.EDI Trading Partner No. is SYSCO Foods
      *   '-
     C           YL0021    IFEQ @CN,002                    *IF
     C           YL0021    OREQ 'SYSCO'                    *OR
      * VAL PO Exists         RT - EDI Purchase Order Header  * 
     C                     EXSR SYRVGN
      * VAL: Return Code
      * CASE: LCL.Record Found USR is Record Not Found
     C           YL0025    IFEQ 'N'                        *IF
     C                     MOVEL'N'       YL0016           EDI Process Fla
     C                     MOVEL'TP'      YL0015           Trans Type 1 PA
     C                     END                             *FI
     C                     END                             *FI
      *  7/13/2021 JBB SDD657 - Trading Partner Control
      * Rtv EDI Manual PO Sts XF - EDI Bill To Interchange  * POACK
     C                     CALL 'PUTBXFR'              90  Rtv EDI Manual
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0171  30       Company Number
     C                     PARM P1C4NB    WQ0172  70       Order Number
     C                     PARM 'POACK'   WQ0173  6        Interchange Cod
     C           YL0026    PARM *BLANK    WQ0174  1        Send EDI Docume
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUTBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * If Send EDI Invoice = N, set EDI Process Flag = N
      * CASE: LCL.Send EDI Document Y/N is No
     C           YL0026    IFEQ 'N'                        *IF
     C                     MOVEL'N'       YL0016           EDI Process Fla
     C                     END                             *FI
      * CASE: LCL.EDI Process Flag is Process
     C           YL0016    IFEQ 'Y'                        *IF
      * 2014/09/09 PKD Added Price Audit condition
      * Do we need to EDI 855/865?
      * CASE:
      *  - c1 ORc2ORc3ORc4
      *   |- c1    : PAR.Pricing Event Called From is Market Price Change
      *   |- c2    : PAR.Pricing Event Called From is Order Entry
      *   |- c3    : PAR.Pricing Event Called From is Price Maintenance
      *   |- c4    : PAR.Pricing Event Called From is Price Audit
      *   '-
     C           P2PECF    IFEQ 'MPC'                      *IF
     C           P2PECF    OREQ 'OE'                       *OR
     C           P2PECF    OREQ 'PM'                       *OR
     C           P2PECF    OREQ 'PA'                       *OR
      * CASE: LCL.Price Status is Priced
     C           YL0019    IFEQ 'P'                        *IF
      * Rtv/Crt EDI PO Ack    XF - EDI PO Ack Hdr  * 
     C                     CALL 'PNYLXFR'              90  Rtv/Crt EDI PO
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0175  30       Company Number
     C                     PARM P1C4NB    WQ0176  70       Order Number
     C           YL0015    PARM YL0015    WQ0177  2        Trans Type 1 PA
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNYLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'OP'      YL0015           Trans Type 1 PA
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * CLC Price/Price Audit  RT - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  1        Price Audit
     C                     MOVEL*BLANK    WN0002  1        Price Status
     C                     Z-ADD*ZERO     WN0003 112       A/R order Value
     C                     Z-ADD*ZERO     WN0004 112       USR Order Weigh
     C                     Z-ADD*ZERO     WN0005 112       USR Order Value
     C                     MOVEL*BLANK    WN0006  1        Billing Activit
     C                     MOVEL*BLANK    WN0007  1        Price Status US
     C                     MOVEL*BLANK    WN0008  1        Price Audit USR
     C                     MOVEL*BLANK    WN0009  2        Type Code
     C                     MOVEL*BLANK    WN0010  1        Allow Man/Qt WO
     C                     Z-ADD*ZERO     WN0011  30       Accounting Comp
     C                     Z-ADD*ZERO     WN0012  30       Shipping Compan
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WAAIC3           Company Number
     C                     Z-ADDP1C4NB    WAC4NB           Order Number
      * Establish starting position
     C           KRSSA     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * RTV Allow Man/Qt Flag  RT - Company Customer  * 
     C                     EXSR SBRVGN
      * CASE: DB1.Header Status is Not cancelled
     C           WAGWST    IFEQ 'L'                        *IF
     C           WAGWST    OREQ 'A'
     C           WAGWST    OREQ 'C'
     C           WAGWST    OREQ 'R'
     C           WAGWST    OREQ 'E'
     C           WAGWST    OREQ 'H'
     C           WAGWST    OREQ 'I'
      * Order is not Cancelled.
     C                     EXSR UASUBR                     Order is not Ca
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Allow Man/Qt Flag  RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWAAIC3    WBAIC3           Company Number
     C                     Z-ADDWABKC7    WBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSB     CHAIN@EOREXM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0009           Type Code
     C                     MOVEL*BLANK    WN0010           Allow Man/Qt WO
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBBOCD    WN0009           Type Code
     C                     MOVELWBVLST    WN0010           Allow Man/Qt WO
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv All Prc Sts/Audit  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * RMC 3/30/2022 change lf from OPBGWKLJ TO OPBGWKN9 - TO INCLUDE 'R
     C                     MOVEL'P'       WL0005           Price Status
     C                     MOVEL'M'       WL0006           Price Audit
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSC01           Company Number
     C           *LIKE     DEFN WCC4NB    WQSC02           Order Number
      * Define keylist
     C           KPSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Order Number
     C                     KFLD           WCDPNB           Order Sequence
     C                     KFLD           WCUENB           Order Secondary
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Order Number
      * Setup key
     C                     Z-ADDWL0001    WQSC01           Company Number
     C                     Z-ADDWL0002    WQSC02           Order Number
     C                     Z-ADDWL0003    WCDPNB           Order Sequence
     C                     Z-ADDWL0004    WCUENB           Order Secondary
      * Establish starting position
     C           KPSSC     SETLL@BGWKJM                    *
     C           KRSSC     READE@BGWKJM                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Price Status is Blank or Unpriced
     C           WCU1ST    IFEQ *BLANK                     *IF
     C           WCU1ST    OREQ 'U'
     C                     MOVELWCU1ST    WL0005           Price Status
     C                     END                             *FI
      * CASE: DB1.Price Audit is Not Manually Price Audit
     C           WCU0ST    IFEQ 'A'                        *IF
     C           WCU0ST    OREQ 'N'
     C           WCU0ST    OREQ *BLANK
     C                     MOVELWCU0ST    WL0006           Price Audit
     C                     END                             *FI
      * RTV OD Whs/ShpCo/AccCo RT - Warehouse  * 
     C                     EXSR SDRVGN
     C           KRSSC     READE@BGWKJM                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV OD Whs/ShpCo/AccCo RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAJCD           Warehouse Code
      * Setup key
     C                     MOVELWCAJCD    WDAJCD           Warehouse Code
      * Establish starting position
     C           KRSSD     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0007           Shipping Compan
     C                     Z-ADD*ZERO     WL0008           Accounting Comp
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWDBWC3    WL0007           Shipping Compan
     C                     Z-ADDWDBTC3    WL0008           Accounting Comp
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * CLC Extend Price       RT - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0013 112       Extended Amount
     C                     Z-ADD*ZERO     WN0014 114       Unit Price
     C                     Z-ADD*ZERO     WN0015 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0016 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0017 112       USR Quantity
     C                     Z-ADD*ZERO     WN0018 112       USR Weight
     C                     Z-ADD*ZERO     WN0019 114       Price per Pound
     C                     MOVEL*BLANK    WN0020  1        Company Organiz
     C                     MOVEL*BLANK    WN0021  6        Primal Group Co
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WN0013           Extended Amount
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0009           Company Number
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    YN0001    P      Plant Company S
     C                     MOVELWL0011    WN0020    P      Company Organiz
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIC3    WQSE01           Company Number
     C           *LIKE     DEFN WEC4NB    WQSE02           Order Number
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WQSE02           Order Number
      * Setup key
     C                     Z-ADDWAAIC3    WQSE01           Company Number
     C                     Z-ADDWAC4NB    WQSE02           Order Number
      * Establish starting position
     C           KRSSE     SETLL@BGWKL1                    *
     C           KRSSE     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWEAYVA    WN0013           Extended Amount
     C                     Z-ADDWEAKPR    WN0014           Unit Price
     C                     Z-ADDWEAUPR    WN0015           Unit Price Orde
     C                     Z-ADDWEAVWG    WN0016           Unit Weight Ord
      * Load Quantity Shipped Total field.
      * CASE: DB1.Quantity Shipped Total is Equal to zero
     C           WECBQT    IFEQ 0                          *IF
     C                     Z-ADD1         WUCBQT           Quantity Shippe
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWECBQT    WUCBQT           Quantity Shippe
     C                     END                             *FI
      * Set quantity and weight according to order status
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Detail Line Status is Avail/Alloc/Enter/Hold
      *   |- c2    : DB1.Event Code is Entered Thru 03 Picked
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WEGMST    IFEQ 'L'                        *IF
     C           WEGMST    OREQ 'A'
     C           WEGMST    OREQ 'E'
     C           WEGMST    OREQ 'H'
     C           WEJPCD    IFGE '01'                       *IF
     C           WEJPCD    ANDLE'03'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RMC 6/17/09 FP1054 use qty/wgt ordered instead of sched
     C                     Z-ADDWEAVQT    WN0017           USR Quantity
     C                     Z-ADDWED0WG    WN0018           USR Weight
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWUCBQT    WN0017           USR Quantity
     C                     Z-ADDWEATWG    WN0018           USR Weight
     C                     END                             *FI
      * RTV For Price Extent   XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDXRXFR'              90  RTV For Price E
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WEAIC3    WQ0001  30       Company Number
     C                     PARM WEHGCD    WQ0002  70       Item Code
     C                     PARM *BLANK    WQ0003  2        UOM Pricing
     C                     PARM *ZERO     WQ0004 112       Unit Weight
     C                     PARM *BLANK    WQ0005  1        Catch Weight St
     C           WN0021    PARM *BLANK    WQ0006  6        Primal Group Co
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * 06/25/10 PKD P205 Replace to use the Price Method Type & PMP Pric
      *                   instead of hard coding Price Method Code
      * RTV PrcMthTyp/PrcTyp  XF - Price Method Header  * 
     C                     CALL 'PNS7XFR'              90  RTV PrcMthTyp/P
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WEAIC3    WQ0007  30       Company Number
     C                     PARM WEQ7CD    WQ0008  3        Price Method Co
     C           YL0001    PARM *BLANK    WQ0009  1        Price Method Ty
     C           YL0002    PARM *BLANK    WQ0010  1        PMH Price Type
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNS7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Extend
      * CASE: LCL.Price Method Type is Extended Pricing
     C           YL0001    IFEQ 'X'                        *IF
     C                     Z-ADDWEBZPR    WN0013           Extended Amount
     C                     ELSE
      * CASE: *OTHERWISE
      * 06/25/10 PKD P205 Replace to use the Price Method Type & PMP Pric
      *                   instead of hard coding Price Method Code
      * Extend price with unit price credit if not zeros
      * CASE:
      *  - (c1 AND c2 AND c3 AND c5 AND c7)
      *   |- c1    : DB1.Detail Line Status is Avail/Alloc/Enter/Hold
      *   |- c2    : DB1.Event Code is Entered Thru 03 Picked
      *   |- c3    : DB1.Unit Price - Credit is Not Zeros
      *   |- c5    : DB1.Price Audit is Not Manually Price Audit
      *   |- c7    : PAR.Pricing Event Called From is No Price With Credi
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WEGMST    IFEQ 'L'                        *IF
     C           WEGMST    OREQ 'A'
     C           WEGMST    OREQ 'E'
     C           WEGMST    OREQ 'H'
     C           WEJPCD    IFGE '01'                       *IF
     C           WEJPCD    ANDLE'03'
     C           WEALPR    IFNE 0                          *IF
     C           WEU0ST    IFEQ 'A'                        *IF
     C           WEU0ST    OREQ 'N'
     C           WEU0ST    OREQ *BLANK
     C           P2PECF    IFEQ 'OE'                       *IF
     C           P2PECF    OREQ 'PS'
     C           P2PECF    OREQ 'UWC'
     C           P2PECF    OREQ 'UWT'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 07/07/08 PKD Replaced the following
      * 06/25/10 PKD P205 Replace to use the Price Method Type & PMP Pric
      *                   instead of hard coding Price Method Code
      * Extend Price using Price Overage Override or Unit Price-Credit
      * CASE: Contract Invoice Price
      *  - c1 AND c2
      *   |- c1    : LCL.Price Method Type is Contract Pricing
      *   |- c2    : LCL.PMH Price Type is Invoice Price
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0001    IFEQ 'Q'                        *IF
     C           YL0002    IFEQ 'I'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ----- USE: Price Overage Override
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           WN0013    PARM *ZERO     WQ0011 112       Extended Amount
     C                     PARM WECRCD    WQ0012  2        U/M - Base Pric
     C                     PARM WN0017    WQ0013 112       Quantity Shippe
     C                     PARM WN0018    WQ0014 112       Weight Shipped
     C                     PARM WEBZPR    WQ0015 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: Manual & HPB
      *  - c1 AND c2
      *   |- c1    : LCL.Price Method Type is Manual Pricing
      *   |- c2    : PAR.Company Organization is High Plains Biodiesel
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0001    IFEQ 'M'                        *IF
     C           WN0020    IFEQ 'H'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ----- USE: Price Overage Override
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           WN0013    PARM *ZERO     WQ0016 112       Extended Amount
     C                     PARM WECRCD    WQ0017  2        U/M - Base Pric
     C                     PARM WN0017    WQ0018 112       Quantity Shippe
     C                     PARM WN0018    WQ0019 112       Weight Shipped
     C                     PARM WEBZPR    WQ0020 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: Manual & Not HPB
      *  - c1 AND c2
      *   |- c1    : LCL.Price Method Type is Manual Pricing
      *   |- c2    : PAR.Company Organization is Not HPB
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0001    IFEQ 'M'                        *IF
     C           WN0020    IFEQ 'D'                        *IF
     C           WN0020    OREQ 'S'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ----- USE: Price Overage Override OR Unit Price-Credit
      * CASE: PS Cst | IC Cst | UNID Itm | OTHER Itm | >.01 Prc
      *  - c1 OR c2 OR c3 OR c4 OR c5
      *   |- c1    : PAR.Type Code is Inter Company
      *   |- c2    : PAR.Type Code is Is Promotional/Samples
      *   |- c3    : PAR.Primal Group Code is Samples or Cut Loss
      *   |- c4    : PAR.Primal Group Code is Other
      *   |- c5    : DB1.Price Overage Override is GT .01
      *   '-
     C           WN0009    IFEQ 'IC'                       *IF
     C           WN0009    OREQ 'PS'                       *OR
     C           WN0021    OREQ 'UNID'                     *OR
     C           WN0021    OREQ 'OTHER'                    *OR
     C           WEBZPR    ORGT .01                        *OR
      * ----- USE: Price Overage Override
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           WN0013    PARM *ZERO     WQ0021 112       Extended Amount
     C                     PARM WECRCD    WQ0022  2        U/M - Base Pric
     C                     PARM WN0017    WQ0023 112       Quantity Shippe
     C                     PARM WN0018    WQ0024 112       Weight Shipped
     C                     PARM WEBZPR    WQ0025 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * ----- USE: Unit Price-Credit
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           WN0013    PARM *ZERO     WQ0026 112       Extended Amount
     C                     PARM WECRCD    WQ0027  2        U/M - Base Pric
     C                     PARM WN0017    WQ0028 112       Quantity Shippe
     C                     PARM WN0018    WQ0029 112       Weight Shipped
     C                     PARM WEALPR    WQ0030 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * ---- USE: Unit Price-Credit
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           WN0013    PARM *ZERO     WQ0031 112       Extended Amount
     C                     PARM WECRCD    WQ0032  2        U/M - Base Pric
     C                     PARM WN0017    WQ0033 112       Quantity Shippe
     C                     PARM WN0018    WQ0034 112       Weight Shipped
     C                     PARM WEBZPR    WQ0035 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * *** Determine Extended Amount
      * 08/28/07 PKD Replaced with Clc OrdDtl Ext Amt    XF
      * 04/28/10 PKD If Unit Price is zero, then use Unit Price-Credit.
      * CASE: DB1.Unit Price is Not Zeros
     C           WEAKPR    IFNE 0                          *IF
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           WN0013    PARM *ZERO     WQ0036 112       Extended Amount
     C                     PARM WECRCD    WQ0037  2        U/M - Base Pric
     C                     PARM WN0017    WQ0038 112       Quantity Shippe
     C                     PARM WN0018    WQ0039 112       Weight Shipped
     C                     PARM WEAKPR    WQ0040 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PAR.USR Quantity is not equal zero
     C           WN0017    IFNE 0                          *IF
     C           WN0013    DIV  WN0017    WN0015    H      Unit Price Orde
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           WN0013    PARM *ZERO     WQ0041 112       Extended Amount
     C                     PARM WECRCD    WQ0042  2        U/M - Base Pric
     C                     PARM WN0017    WQ0043 112       Quantity Shippe
     C                     PARM WN0018    WQ0044 112       Weight Shipped
     C                     PARM WEALPR    WQ0045 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CHG Dtl Price/Audit    CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0012           Company Number
     C                     Z-ADDWEC4NB    WL0013           Order Number
     C                     Z-ADDWEDPNB    WL0014           Order Sequence
     C                     Z-ADDWEUENB    WL0015           Order Secondary
     C                     Z-ADDWN0013    WL0016           Billing Detail
     C                     Z-ADDWN0013    WL0017           Extended Amount
     C                     MOVELWEU1ST    WL0018    P      Price Status
     C                     Z-ADDWEGIDT    WL0019           Pricing Date Us
     C                     MOVELWEU0ST    WL0020    P      Price Audit
     C                     MOVELWERFCD    WL0021    P      Price Audit Rea
     C                     Z-ADDWEAKPR    WL0022           Unit Price
     C                     Z-ADDWEALPR    WL0023           Unit Price - Cr
     C                     Z-ADDWN0015    WL0024           Unit Price Orde
     C                     Z-ADDWEAVWG    WL0025           Unit Weight Ord
     C                     Z-ADDWEAODT    WL0026           Scheduled Ship
     C                     MOVELWEZ1ST    WL0027    P      Modified Flag
     C                     MOVELWEZ3ST    WL0028    P      Substituted Fla
     C                     MOVELWEZ4ST    WL0029    P      OD Schedule Ove
     C                     EXSR SGCHRC
     C           KRSSE     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WFAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0009    WFAIC3           Company Number
      * Establish starting position
     C           KRSSF     CHAIN@JYRECE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2025' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0010           Plant Company S
     C                     MOVEL*BLANK    WL0011           Company Organiz
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFYISX    WL0010           Plant Company S
     C                     MOVELWFYJSX    WL0011           Company Organiz
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCHRC    BEGSR
      *================================================================
      * CHG Dtl Price/Audit    CH - Order Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0022  70       Item Code
     C                     MOVEL*BLANK    WN0023  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0024  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0025  70       Order Group Cod
     C                     MOVEL*BLANK    WN0026  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0027  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0028 112       Billing Detail
     C                     Z-ADD*ZERO     WN0029 112       Billing Detail
     C                     Z-ADD*ZERO     WN0030 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0031  1        Comment Print A
     C                     MOVEL*BLANK    WN0032  1        Comment Print I
     C                     MOVEL*BLANK    WN0033  1        Comment Print P
     C                     MOVEL*BLANK    WN0034  1        Comment Print S
     C                     Z-ADD*ZERO     WN0035  70       Market Pricing
     C                     MOVEL*BLANK    WN0036  3        Commodity Marke
     C                     MOVEL*BLANK    WN0037  3        Date Method Cod
     C                     MOVEL*BLANK    WN0038  3        Price Method Co
     C                     Z-ADD*ZERO     WN0039 114       Price Overage O
     C                     Z-ADD*ZERO     WN0040  70       Contract Number
     C                     MOVEL*BLANK    WN0041  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0042  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0043  1        Work Confirm St
     C                     MOVEL*BLANK    WN0044  1        Work Over/Short
     C                     MOVEL*BLANK    WN0045  1        OD Production P
     C                     MOVEL*BLANK    WN0046 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0047 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0048  1        Age Code
     C                     MOVEL*BLANK    WN0049  1        Palletize
     C                     MOVEL*BLANK    WN0050  1        Slip Sheet
     C                     MOVEL*BLANK    WN0051  1        Catch Weight St
     C                     MOVEL*BLANK    WN0052  1        Production Date
     C                     Z-ADD*ZERO     WN0053 112       Rated Freight
     C                     Z-ADD*ZERO     WN0054 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0055 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0056 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0057 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0058 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0059 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0060 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0061 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0062 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0063  70       Requested Ship
     C                     Z-ADD*ZERO     WN0064  70       Actual Shipped
     C                     MOVEL*BLANK    WN0065  1        Affect Inventor
     C                     MOVEL*BLANK    WN0066  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0067  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0068  30       Item Structure
     C                     Z-ADD*ZERO     WN0069  30       Item Structure
     C                     Z-ADD*ZERO     WN0070  30       Item Structure
     C                     MOVEL*BLANK    WN0071  2        Item Level
     C                     MOVEL*BLANK    WN0072  2        Quality Level
     C                     MOVEL*BLANK    WN0073  2        Pricing Product
     C                     MOVEL*BLANK    WN0074  2        Season Product
     C                     Z-ADD*ZERO     WN0075  70       Date of Origina
     C                     MOVEL*BLANK    WN0076 10        User Profile Na
     C                     MOVEL*BLANK    WN0077  6        Country Code
     C                     MOVEL*BLANK    WN0078  2        Event Code
     C                     MOVEL*BLANK    WN0079  3        Reason Code
     C                     MOVEL*BLANK    WN0080  3        Sales Route Cod
     C                     Z-ADD*ZERO     WN0081 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0082 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0083  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0084  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0085  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0086  1        Affect Commissi
     C                     MOVEL*BLANK    WN0087  1        Affect Pricing
     C                     MOVEL*BLANK    WN0088  1        Released by Use
     C                     MOVEL*BLANK    WN0089  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0090  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0091  3        Production Ware
     C                     MOVEL*BLANK    WN0092  3        OD Price Type
     C                     Z-ADD*ZERO     WN0093  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0094  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0095  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0096  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0097  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0098  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0099  60       Price Code
     C                     Z-ADD*ZERO     WN0100  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0101  60       Substitution Li
     C                     Z-ADD*ZERO     WN0102  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0103 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0104 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0105 112       OD Item Target
     C                     Z-ADD*ZERO     WN0106 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0107 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0108 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN0109 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0110 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0111 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0112 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0113 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0114 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0115 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0116  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0117  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0118  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0119 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0120  40       Item Age Days
     C                     Z-ADD*ZERO     WN0121  70       Production Ovr
     C                     Z-ADD*ZERO     WN0122  70       Production Ovr
     C                     MOVEL*BLANK    WN0123  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0124  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0125  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0126  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0127  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0128  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0129  1        EDI Status 1
     C                     MOVEL*BLANK    WN0130  1        EDI Status 2
     C                     MOVEL*BLANK    WN0131  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0132  60       Job Time
     C                     MOVEL*BLANK    WN0133 10        User Id
     C                     MOVEL*BLANK    WN0134 10        Job Name
     C                     Z-ADD*ZERO     WN0135  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWL0012    WGAIC3           Company Number
     C                     Z-ADDWL0013    WGC4NB           Order Number
     C                     Z-ADDWL0014    WGDPNB           Order Sequence
     C                     Z-ADDWL0015    WGUENB           Order Secondary
      *
     C           KLCHSG    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGC4NB           Order Number
     C                     KFLD           WGDPNB           Order Sequence
     C                     KFLD           WGUENB           Order Secondary
     C           KLCHSG    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YARDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADDWL0016    WGKDVA           Billing Detail
     C                     Z-ADDWL0017    WGAYVA           Extended Amount
     C                     MOVELWL0018    WGU1ST    P      Price Status
     C                     Z-ADDWL0019    WGGIDT           Pricing Date Us
     C                     MOVELWL0020    WGU0ST    P      Price Audit
     C                     MOVELWL0021    WGRFCD    P      Price Audit Rea
     C                     Z-ADDWL0022    WGAKPR           Unit Price
     C                     Z-ADDWL0023    WGALPR           Unit Price - Cr
     C                     Z-ADDWL0024    WGAUPR           Unit Price Orde
     C                     Z-ADDWL0025    WGAVWG           Unit Weight Ord
     C                     Z-ADDWL0026    WGAODT           Scheduled Ship
     C                     MOVELWL0027    WGZ1ST    P      Modified Flag
     C                     MOVELWL0028    WGZ3ST    P      Substituted Fla
     C                     MOVELWL0029    WGZ4ST    P      OD Schedule Ove
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##JOB     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * CLC Price/Price Audit  RT - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0136 112       Extended Amount
     C                     MOVEL*BLANK    WN0137  3        Commodity Marke
     C                     MOVEL*BLANK    WN0138  1        Price Status
     C                     Z-ADD*ZERO     WN0139  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0140  1        Price Audit
     C                     MOVEL*BLANK    WN0141  3        Price Audit Rea
     C                     Z-ADD*ZERO     WN0142 114       Unit Price
     C                     Z-ADD*ZERO     WN0143 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0144 114       Unit Price Orde
     C                     MOVEL*BLANK    WN0145  2        Event Code
     C                     MOVEL*BLANK    WN0146  3        Price Audit Rea
     C                     Z-ADD*ZERO     WN0147 112       Unit Weight
     C                     MOVEL*BLANK    WN0148  1        Catch Weight St
     C                     MOVEL*BLANK    WN0149  2        Event Called Fr
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'P'       WN0007           Price Status US
     C                     MOVEL*BLANK    WN0140           Price Audit
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0009           Company Number
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    YN0005    P      Plant Company S
     C                     MOVELWL0011    YL0003    P      Company Organiz
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIC3    WQSH01           Company Number
     C           *LIKE     DEFN WEC4NB    WQSH02           Order Number
      * Define keylist
     C           KPSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WQSH02           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WQSH02           Order Number
      * Setup key
     C                     Z-ADDWAAIC3    WQSH01           Company Number
     C                     Z-ADDWAC4NB    WQSH02           Order Number
     C                     Z-ADDP1DPNB    WEDPNB           Order Sequence
     C                     Z-ADDP1UENB    WEUENB           Order Secondary
      * Establish starting position
     C           KPSSH     SETLL@BGWKL1                    *
     C           KRSSH     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * If only one line item suposed to be repriced
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Order Sequence Number is not equal to zero
      *   |- c2    : PAR.Order Sequence Number NE DB1.Order Sequence Numb
      *   |- c3    : PAR.Order Secondary Line Seq NE DB1.Order Secondary
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1DPNB    IFNE 0                          *IF
     C           P1DPNB    IFNE WEDPNB                     *IF
     C           P1UENB    IFNE WEUENB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     GOTO SHEXIT                     *QUIT
     C                     END                             *FI
      * Process Shipping Detail record if not cancelled
      * CASE: DB1.Detail Line Status is Not cancelled
     C           WEGMST    IFEQ 'L'                        *IF
     C           WEGMST    OREQ 'A'
     C           WEGMST    OREQ 'C'
     C           WEGMST    OREQ 'R'
     C           WEGMST    OREQ 'E'
     C           WEGMST    OREQ 'H'
     C           WEGMST    OREQ 'I'
      * Set hold fields and call pricing routine
     C                     EXSR UCSUBR                     Set hold fields
      * Check price audit options
      * CASE: Sts=Prcd, Adt=Man, Evt=MktGrpChg/CstItmChg/ItmChg
      *  - (c1 AND c2) OR c3 OR c4 OR c5
      *   |- c1    : DB1.Price Status is Priced
      *   |- c2    : DB1.Price Audit is Manually Price Audited
      *   |- c3    : PAR.Pricing Event Called From is Market Group Change
      *   |- c4    : PAR.Pricing Event Called From is Customer/Item Chang
      *   |- c5    : PAR.Pricing Event Called From is Item Change
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WEU1ST    IFEQ 'P'                        *IF
     C           WEU0ST    IFEQ 'M'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           P2PECF    IFEQ 'MGC'                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           P2PECF    IFEQ 'CIC'                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           P2PECF    IFEQ 'IC'                       *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: PAR.Unit Price NE DB1.Unit Price
     C           WN0142    IFNE WEAKPR                     *IF
     C                     MOVEL'N'       WN0140           Price Audit
      * Set reason code for pricing event called from
      * CASE: PAR.Pricing Event Called From is Customer/Item Change
     C           P2PECF    IFEQ 'CIC'                      *IF
     C                     MOVEL'CIT'     WN0141           Price Audit Rea
     C                     ELSE
      * CASE: PAR.Pricing Event Called From is Market Group Change
     C           P2PECF    IFEQ 'MGC'                      *IF
     C                     MOVEL'CGP'     WN0141           Price Audit Rea
     C                     ELSE
      * CASE: PAR.Pricing Event Called From is Market Price Change
     C           P2PECF    IFEQ 'MPC'                      *IF
     C                     MOVEL'CMP'     WN0141           Price Audit Rea
     C                     ELSE
      * CASE: PAR.Pricing Event Called From is Item Change
     C           P2PECF    IFEQ 'IC'                       *IF
     C                     MOVEL'ITM'     WN0141           Price Audit Rea
     C                     ELSE
      * CASE: PAR.Pricing Event Called From is Shipping
     C           P2PECF    IFEQ 'SHP'                      *IF
      * If ship date change use SDC else use price change PC
      * CASE: DB1.Scheduled Ship Date NE DB1.Actual Shipped Date
     C           WEAODT    IFNE WEGNDT                     *IF
     C                     MOVEL'SDC'     WN0141           Price Audit Rea
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WN0141           Price Audit Rea
     C                     MOVEL'PC'      WN0141           Price Audit Rea
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WN0141           Price Audit Rea
     C                     MOVEL'PC'      WN0141           Price Audit Rea
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'M'       WN0140           Price Audit
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Retrieve Pricing Method Price Audit Flag to determine price
      * audit
      * RTV Meth Type/Audit    RT - Price Method Header  * 
     C                     EXSR SIRVGN
      * RTV Price Maint        XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDP6XFR'              90  RTV Price Maint
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WEAIC3    WQ0114  30       Company Number
     C                     PARM WEHGCD    WQ0115  70       Item Code
     C           WULNCD    PARM *BLANK    WQ0116  3        Default Commod
     C           WUTMVA    PARM *ZERO     WQ0117 112       Maximum Audit V
     C           WUTNVA    PARM *ZERO     WQ0118 112       Minimum Audit V
     C           WULRCD    PARM *BLANK    WQ0119  7        Commodity Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDP6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * If price method is audit then audit else check more conditions
      * CASE: WRK.Price Audit is Needs Price Audit
     C           WUU0ST    IFEQ 'N'                        *IF
     C                     MOVELWUU0ST    WN0140           Price Audit
      * Set reason code for pricing event called from
      * CASE: PAR.Pricing Event Called From is Market Price Change
     C           P2PECF    IFEQ 'MPC'                      *IF
     C                     MOVEL'CMP'     WN0141           Price Audit Rea
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'MTH'     WN0141           Price Audit Rea
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * If price falls outside of audit range, then flag for audit
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Unit Price GT WRK.Maximum Audit Value
      *   |- c2    : DB1.Unit Price LT WRK.Minimum Audit Value
      *   '-
     C           WEAKPR    IFGT WUTMVA                     *IF
     C           WEAKPR    ORLT WUTNVA                     *OR
     C                     MOVEL'N'       WN0140           Price Audit
      * Set reason code for pricing event called from
      * CASE: PAR.Pricing Event Called From is Market Price Change
     C           P2PECF    IFEQ 'MPC'                      *IF
     C                     MOVEL'CMP'     WN0141           Price Audit Rea
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'RNG'     WN0141           Price Audit Rea
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * If Contract or MAN EXT Pricing, Price Audit if Allow Man/Qt = N
      * CASE: PAR.Allow Man/Qt WO/Approval is Do Not Allow
     C           WN0010    IFEQ 'N'                        *IF
      * CASE:
      *  - c1 OR c2 OR c3
      *   |- c1    : DB1.Price Method Code is Manual
      *   |- c2    : DB1.Price Method Code is Extended
      *   |- c3    : DB1.Contract Number is Not Zeros
      *   '-
     C           WEQ7CD    IFEQ 'MAN'                      *IF
     C           WEQ7CD    OREQ 'EXT'                      *OR
     C           WEL6NB    ORNE 0                          *OR
     C                     MOVEL'N'       WN0140           Price Audit
      * Set reason code for pricing event called from
      * CASE: PAR.Pricing Event Called From is Market Price Change
     C           P2PECF    IFEQ 'MPC'                      *IF
     C                     MOVEL'CMP'     WN0141           Price Audit Rea
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'MCE'     WN0141           Price Audit Rea
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * If manual pricing and not a transfer order, check price range
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Price Method Code is Manual
      *   |- c2    : PAR.Billing Activity Type is Not Warehouse Transfer
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WEQ7CD    IFEQ 'MAN'                      *IF
     C           WAOBST    IFEQ '2'                        *IF
     C           WAOBST    OREQ '3'
     C           WAOBST    OREQ '1'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Val Manual Price      RT - Company/Item  * 
     C                     EXSR SJRVGN
      * R12926 DN 04/23/18-Do NOT use AFR from Co Customer, use AFR from
      * RTV AbsFrtRt/Type Cde  RT - Company Customer  * 
     C                     EXSR SKRVGN
      * Val Price
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Primal Group Code is NE Samples or Cut Loss
      *   |- c2    : LCL.Type Code is Not Promotional/Samples
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0010    IFNE 'UNID'                     *IF
     C           YL0011    IFNE 'PS'                       *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RMC chg parm lcl.default commod mark basis to lcl.commodity price
      *    on commodity price group parameter         S12258 1/3/2018
      * RMC chg parm lcl.commodity marke code to lcl.default commod mark
      *    on commodity market code parameter         S11258 1/3/2018
      * R12926 DN 04/23/18-Do NOT use AFR from Co Customer, use AFR from
      *
     C                     Z-ADD*ZERO     WN0157  52       Manual Price Ac
     C                     Z-ADD*ZERO     WN0158  52       CoPk/FdSrv ManP
     C                     Z-ADD*ZERO     WN0159  74       Percent 7.4 USR
     C                     Z-ADD*ZERO     WN0160 114       Price Adjustmen
      *
      * VAL Manual Price Range IF
      * *---------------------------------------------------------------*
      * Documentation:
      * This internal function will determine if a manual price entered
      * on an order detail line is within the Manual Pricing Acceptance
      * Percentage from the Company Control file. If it does not fall
      * within the percentage range then the market price will be used.
      * If no market price is found then it is a manual price error
      * *---------------------------------------------------------------*
     C                     Z-ADD*ZERO     WUB8PR           Projected Marke
     C                     Z-ADD*ZERO     YL0012           Minimum Price
     C                     Z-ADD*ZERO     YL0013           Maximum Price
     C                     MOVEL'Y'       WUTXST           Error Status  3
      * RTV Manual Price Accpt RT - Company Control  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0030           Company Number
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0031    WN0157           Manual Price Ac
     C                     Z-ADDWL0032    WN0158           CoPk/FdSrv ManP
      * Food Service and Co-Pack Items
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Default Commod Mark basis is Food Service
      *   |- c2    : PAR.Default Commod Mark basis is Co-Pack
      *   '-
     C           YL0006    IFEQ 'FSV'                      *IF
     C           YL0006    OREQ 'CPK'                      *OR
     C                     Z-ADDWN0158    WN0157           Manual Price Ac
     C                     END                             *FI
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0006    WL0033    P      Commodity Marke
     C                     MOVELYL0009    WL0034    P      Commodity Price
     C                     Z-ADD9999999   WL0035           Market Price Da
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0036    WUB8PR           Commodity Marke
     C                     Z-ADDWL0037    WUE7DT           USR Date Priced
      * Projected Market Price
      * PAR.Projected Market Price =
      *    *COMPUTE (x1 + x2 + (x3 / x4))
      * x1    : PAR.Projected Market Price
      * +     : PGM.*Synon (15,5) work field
      * x2    : PAR.Standard Overage_Underage
      * +     : PGM.*Synon (15,5) work field
      * x3    : PAR.Absorbed Freight Rate CWT
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x4    : CON.100
     C           WUB8PR    ADD  YL0007    W0WB01           *Synon (15,5) w
     C           WATBNB    DIV  100       W0WB02    H      *Synon (15,5) w
     C           W0WB01    ADD  W0WB02    W0WB00           *Synon (15,5) w
     C                     Z-ADDW0WB00    WUB8PR           Projected Marke
      * If a market price is found for co/cust market code default
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Minimum price allowed
      * PAR.Minimum Price   USR =
      *    *COMPUTE (((x4 - (x1 / x2)) * x3))
      * x4    : CON.1
      * -     : PGM.*Synon (17,7) work field
      * x1    : PAR.Manual Price Accept Prcnt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Projected Market Price
     C           WN0157    DIV  100       W0WD02    H      *Synon (17,7) w
     C           1         SUB  W0WD02    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT WUB8PR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0012           Minimum Price
      * Maximum price allowed
      * PAR.Maximum Price  USR =
      *    *COMPUTE ((((x1 / x2) + x4) * x3))
      * x1    : PAR.Manual Price Accept Prcnt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * +     : PGM.*Synon (17,7) work field
      * x4    : CON.1
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Projected Market Price
     C           WN0157    DIV  100       W0WD02    H      *Synon (17,7) w
     C           W0WD02    ADD  1         W0WD01           *Synon (17,7) w
     C           W0WD01    MULT WUB8PR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0013           Maximum Price
      * If the Price Override is within the range then error status is no
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Price Overage Override GE PAR.Minimum Price   US
      *   |- c2    : PAR.Price Overage Override LE PAR.Maximum Price  USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WEBZPR    IFGE YL0012                     *IF
     C           WEBZPR    IFLE YL0013                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       WUTXST           Error Status  3
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * If no price for co/cust market code then use co/item market code
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0006    WL0033    P      Commodity Marke
     C                     MOVELYL0009    WL0034    P      Commodity Price
     C                     Z-ADD9999999   WL0035           Market Price Da
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0036    WUB8PR           Commodity Marke
     C                     Z-ADDWL0037    WUE7DT           USR Date Priced
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Minimum price allowed
      * PAR.Minimum Price   USR =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.Manual Price Accept Prcnt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Projected Market Price
     C           WN0157    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WUB8PR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0012           Minimum Price
      * Maximum price allowed
      * PAR.Maximum Price  USR =
      *    *COMPUTE ((((x1 / x2) + x4) * x3))
      * x1    : PAR.Manual Price Accept Prcnt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * +     : PGM.*Synon (17,7) work field
      * x4    : CON.1
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Projected Market Price
     C           WN0157    DIV  100       W0WD02    H      *Synon (17,7) w
     C           W0WD02    ADD  1         W0WD01           *Synon (17,7) w
     C           W0WD01    MULT WUB8PR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0013           Maximum Price
      * If the Price Override is within the range then error status is no
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Price Overage Override GE PAR.Minimum Price   US
      *   |- c2    : PAR.Price Overage Override LE PAR.Maximum Price  USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WEBZPR    IFGE YL0012                     *IF
     C           WEBZPR    IFLE YL0013                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       WUTXST           Error Status  3
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUB8PR           Projected Marke
     C                     END                             *FI
     C                     END                             *FI
      * CASE: WRK.Error Status  3 is Yes
     C           WUTXST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WN0140           Price Audit
     C                     MOVEL'MPB'     WN0141           Price Audit Rea
      * Price Status will be "U" if Called from OE, Prd Sched
      * CASE: PAR.Pricing Event Called From is No Price With Credit Pric
     C           P2PECF    IFEQ 'OE'                       *IF
     C           P2PECF    OREQ 'PS'
     C           P2PECF    OREQ 'UWC'
     C           P2PECF    OREQ 'UWT'
     C                     MOVEL'U'       WN0138           Price Status
     C                     END                             *FI
     C                     END                             *FI
      * 06/27/08 PKD if the items is priced at .01, then the items is unp
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : DB1.Unit Price is LE .0100
      *   |- c2    : LCL.Primal Group Code is NE Other
      *   |- c3    : LCL.Company Organization is Not HPB
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WEAKPR    IFLE .0100                      *IF
     C           YL0010    IFNE 'OTHER'                    *IF
     C           YL0003    IFEQ 'D'                        *IF
     C           YL0003    OREQ 'S'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'U'       WN0138           Price Status
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * If unpriced order then Audit EQ Blank
      * CASE: PAR.Price Status is Unpriced
     C           WN0138    IFEQ 'U'                        *IF
     C                     MOVEL*BLANK    WN0140           Price Audit
     C                     MOVEL*BLANK    WN0008           Price Audit USR
     C                     END                             *FI
      * If price audit is blank and order is priced then make price audit
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Price Audit is No Audit
      *   |- c2    : PAR.Price Status is Priced
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0140    IFEQ *BLANK                     *IF
     C           WN0138    IFEQ 'P'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'A'       WN0140           Price Audit
     C                     MOVEL*BLANK    WN0141           Price Audit Rea
     C                     END                             *FI
      * If shipped quantities are zero then Value=0, Prc Sts=P, Audit=' '
      * CASE:
      *  - c1 AND c2 AND c3 AND c4
      *   |- c1    : DB1.Quantity Shipped Total is Equal to zero
      *   |- c2    : DB1.Weight Shipped Total is Equal to zero
      *   |- c3    : DB1.Detail Line Status is Confirmed & Complete
      *   |- c4    : DB1.Event Code is Shipped Thru 07 History
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WECBQT    IFEQ 0                          *IF
     C           WEATWG    IFEQ 0                          *IF
     C           WEGMST    IFEQ 'C'                        *IF
     C           WEGMST    OREQ 'R'
     C           WEJPCD    IFGE '04'                       *IF
     C           WEJPCD    ANDLE'07'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'P'       WN0138           Price Status
      * CASE: WRK.Price Audit is Automatically Price Audit
     C           WUU0ST    IFEQ 'A'                        *IF
     C                     MOVELWUU0ST    WN0140           Price Audit
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'M'       WN0140           Price Audit
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * If Price Audit Flag is "N"eeds Audit update Header Parm else blan
      * CASE: PAR.Price Audit is Needs Price Audit
     C           WN0140    IFEQ 'N'                        *IF
     C                     MOVELWN0140    WN0008           Price Audit USR
     C                     MOVELWN0141    WN0146           Price Audit Rea
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WN0141           Price Audit Rea
     C                     END                             *FI
      * Write to audit file if Price flag, Audit or Price change
      * CASE:
      *  - c1 OR c2 OR c3
      *   |- c1    : DB1.Price Status NE PAR.Price Status
      *   |- c2    : DB1.Price Audit NE PAR.Price Audit
      *   |- c3    : DB1.Unit Price NE PAR.Unit Price
      *   '-
     C           WEU1ST    IFNE WN0138                     *IF
     C           WEU0ST    ORNE WN0140                     *OR
     C           WEAKPR    ORNE WN0142                     *OR
      * RTV Next Audit Seq #   RT - PD Price Change Audit Log  * 
     C                     EXSR SNRVGN
      * CRT Price Change Audit CR - PD Price Change Audit Log  * 
     C                     EXSR SOCRRC
     C                     END                             *FI
      * If shipped quantities are zero then Value=0, Prc Sts=P, Audit=' '
      * CASE:
      *  - c1 AND c2 AND c3 AND c4
      *   |- c1    : DB1.Quantity Shipped Total is Equal to zero
      *   |- c2    : DB1.Weight Shipped Total is Equal to zero
      *   |- c3    : DB1.Detail Line Status is Confirmed & Complete
      *   |- c4    : DB1.Event Code is Shipped Thru 07 History
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WECBQT    IFEQ 0                          *IF
     C           WEATWG    IFEQ 0                          *IF
     C           WEGMST    IFEQ 'C'                        *IF
     C           WEGMST    OREQ 'R'
     C           WEJPCD    IFGE '04'                       *IF
     C           WEJPCD    ANDLE'07'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * If mpr sent or Xcluded, set to "M" else set to "N"
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.OD MPR Sent to USDA Sts is Exclude
      *   |- c2    : DB1.OD MPR Sent to USDA Sts is yes
      *   '-
     C           WEHOST    IFEQ 'X'                        *IF
     C           WEHOST    OREQ 'Y'                        *OR
     C                     MOVEL'M'       YL0014           Price Audit
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0014           Price Audit
     C                     END                             *FI
      * 9/9/13 upd with par.price instead of db1.price.. we want new pric
      * CHG Dtl Price/Audit    CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0012           Company Number
     C                     Z-ADDWEC4NB    WL0013           Order Number
     C                     Z-ADDWEDPNB    WL0014           Order Sequence
     C                     Z-ADDWEUENB    WL0015           Order Secondary
     C                     Z-ADD*ZERO     WL0016           Billing Detail
     C                     Z-ADD*ZERO     WL0017           Extended Amount
     C                     MOVEL'P'       WL0018    P      Price Status
     C                     Z-ADDWEGIDT    WL0019           Pricing Date Us
     C                     MOVELYL0014    WL0020    P      Price Audit
     C                     MOVEL*BLANK    WL0021           Price Audit Rea
     C                     Z-ADDWN0142    WL0022           Unit Price
     C                     Z-ADDWEALPR    WL0023           Unit Price - Cr
     C                     Z-ADDWEAUPR    WL0024           Unit Price Orde
     C                     Z-ADDWEAVWG    WL0025           Unit Weight Ord
     C                     Z-ADDWEAODT    WL0026           Scheduled Ship
     C                     MOVELWEZ1ST    WL0027    P      Modified Flag
     C                     MOVELWEZ3ST    WL0028    P      Substituted Fla
     C                     MOVELWEZ4ST    WL0029    P      OD Schedule Ove
     C                     EXSR SGCHRC
     C                     MOVEL'P'       WN0138           Price Status
     C                     ELSE
      * CASE: *OTHERWISE
      * If order detail is priced and manually audited then dont chg pric
      * CASE:
      *  - (c1 AND c2) OR c3 OR c4 OR c5
      *   |- c1    : DB1.Price Status is Priced
      *   |- c2    : DB1.Price Audit is Manually Price Audited
      *   |- c3    : PAR.Pricing Event Called From is Market Group Change
      *   |- c4    : PAR.Pricing Event Called From is Customer/Item Chang
      *   |- c5    : PAR.Pricing Event Called From is Item Change
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WEU1ST    IFEQ 'P'                        *IF
     C           WEU0ST    IFEQ 'M'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           P2PECF    IFEQ 'MGC'                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           P2PECF    IFEQ 'CIC'                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           P2PECF    IFEQ 'IC'                       *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: PAR.Unit Price NE DB1.Unit Price
     C           WN0142    IFNE WEAKPR                     *IF
      * CHG Dtl Price/Audit    CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0012           Company Number
     C                     Z-ADDWEC4NB    WL0013           Order Number
     C                     Z-ADDWEDPNB    WL0014           Order Sequence
     C                     Z-ADDWEUENB    WL0015           Order Secondary
     C                     Z-ADDWEKDVA    WL0016           Billing Detail
     C                     Z-ADDWEAYVA    WL0017           Extended Amount
     C                     MOVELWEU1ST    WL0018    P      Price Status
     C                     Z-ADDWEGIDT    WL0019           Pricing Date Us
     C                     MOVELWN0140    WL0020    P      Price Audit
     C                     MOVELWN0141    WL0021    P      Price Audit Rea
     C                     Z-ADDWEAKPR    WL0022           Unit Price
     C                     Z-ADDWEALPR    WL0023           Unit Price - Cr
     C                     Z-ADDWEAUPR    WL0024           Unit Price Orde
     C                     Z-ADDWEAVWG    WL0025           Unit Weight Ord
     C                     Z-ADDWEAODT    WL0026           Scheduled Ship
     C                     MOVELWEZ1ST    WL0027    P      Modified Flag
     C                     MOVELWEZ3ST    WL0028    P      Substituted Fla
     C                     MOVELWEZ4ST    WL0029    P      OD Schedule Ove
     C                     EXSR SGCHRC
     C                     END                             *FI
      * Extend price incase Shipping Quantities have changed.
      * CLC Extend Price 1 Dtl RT - Order Detail  * 
     C                     EXSR SPRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * CHG Dtl Price/Audit    CH - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0012           Company Number
     C                     Z-ADDWEC4NB    WL0013           Order Number
     C                     Z-ADDWEDPNB    WL0014           Order Sequence
     C                     Z-ADDWEUENB    WL0015           Order Secondary
     C                     Z-ADDWN0136    WL0016           Billing Detail
     C                     Z-ADDWN0136    WL0017           Extended Amount
     C                     MOVELWN0138    WL0018    P      Price Status
     C                     Z-ADDWN0139    WL0019           Pricing Date Us
     C                     MOVELWN0140    WL0020    P      Price Audit
     C                     MOVELWN0141    WL0021    P      Price Audit Rea
     C                     Z-ADDWN0142    WL0022           Unit Price
     C                     Z-ADDWEALPR    WL0023           Unit Price - Cr
     C                     Z-ADDWN0144    WL0024           Unit Price Orde
     C                     Z-ADDWEAVWG    WL0025           Unit Weight Ord
     C                     Z-ADDWEAODT    WL0026           Scheduled Ship
     C                     MOVELWEZ1ST    WL0027    P      Modified Flag
     C                     MOVELWEZ3ST    WL0028    P      Substituted Fla
     C                     MOVELWEZ4ST    WL0029    P      OD Schedule Ove
     C                     EXSR SGCHRC
     C                     END                             *FI
     C                     END                             *FI
      * Mark Header Price Status Flag as Unpriced if Unpriced
      * CASE: PAR.Price Status is Unpriced
     C           WN0138    IFEQ 'U'                        *IF
     C                     MOVEL'U'       WN0007           Price Status US
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSH     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Meth Type/Audit    RT - Price Method Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHQ7CD           Price Method Co
      * Setup key
     C                     Z-ADDWAAIC3    WHAIC3           Company Number
     C                     MOVELWEQ7CD    WHQ7CD           Price Method Co
      * Establish starting position
     C           KRSSI     CHAIN@IHRERN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1665' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUU0ST           Price Audit
     C                     MOVEL*BLANK    WUV8ST           Price Method Ty
     C                     Z-ADD*ZERO     YL0004           Decimal Places
     C                     MOVEL*BLANK    YL0005           PMH Price Type
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHU0ST    WUU0ST           Price Audit
     C                     MOVELWHV8ST    WUV8ST           Price Method Ty
     C                     Z-ADDWHRMNY    YL0004           Decimal Places
     C                     MOVELWHH3ST    YL0005           PMH Price Type
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Val Manual Price      RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIHGCD           Item Code
      * Setup key
     C                     Z-ADDWEAIC3    WIAIC3           Company Number
     C                     Z-ADDWEHGCD    WIHGCD           Item Code
      * Establish starting position
     C           KRSSJ     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAVNA           Description Lin
     C                     MOVEL*BLANK    YL0006           Default Commod
     C                     Z-ADD*ZERO     YL0007           Market Overage
     C                     Z-ADD*ZERO     YL0008           Standard Overag
     C                     MOVEL*BLANK    YL0009           Commodity Price
     C                     Z-ADD*ZERO     WUSWGH           Std Weight_Head
     C                     MOVEL*BLANK    YL0010           Primal Group Co
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWIAVNA    WUAVNA           Description Lin
     C                     MOVELWILNCD    YL0006           Default Commod
     C                     Z-ADDWIBLPR    YL0007           Market Overage
     C                     Z-ADDWIBMPR    YL0008           Standard Overag
     C                     MOVELWILRCD    YL0009           Commodity Price
     C                     Z-ADDWISWGH    WUSWGH           Std Weight_Head
     C                     MOVELWIXRCD    YL0010           Primal Group Co
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV AbsFrtRt/Type Cde  RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWEAIC3    WBAIC3           Company Number
     C                     Z-ADDWEBKC7    WBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSK     CHAIN@EOREXM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0011           Type Code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBBOCD    YL0011           Type Code
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Manual Price Accpt RT - Company Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WJAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0030    WJAIC3           Company Number
      * Establish starting position
     C           KRSSL     CHAIN@ASREVL              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0049' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0031           Manual Price Ac
     C                     Z-ADD*ZERO     WL0032           CoPk/FdSrv ManP
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWJAIPC    WL0031           Manual Price Ac
     C                     Z-ADDWJASPC    WL0032           CoPk/FdSrv ManP
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKLQCD    WQSM01           Commodity Marke
     C           *LIKE     DEFN WKLRCD    WQSM02           Commodity Price
      * Define keylist
     C           KPSSM     KLIST
     C                     KFLD           WQSM01           Commodity Marke
     C                     KFLD           WQSM02           Commodity Price
     C                     KFLD           WKEQDT           Market Price Da
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Commodity Marke
     C                     KFLD           WQSM02           Commodity Price
      * Setup key
     C                     MOVELWL0033    WQSM01           Commodity Marke
     C                     MOVELWL0034    WQSM02           Commodity Price
     C                     Z-ADDWL0035    WKEQDT           Market Price Da
      * Establish starting position
     C           KPSSM     SETLL@F0CPEP                    *
     C           KRSSM     READE@F0CPEP                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1222' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0036           Commodity Marke
     C                     Z-ADD*ZERO     WL0037           USR Date Priced
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWKA5PR    WL0036           Commodity Marke
     C                     Z-ADDWKEQDT    WL0037           USR Date Priced
     C                     GOTO SMEXIT                     *QUIT
     C           KRSSM     READE@F0CPEP                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Next Audit Seq #   RT - PD Price Change Audit Log  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLAIC3    WQSN01           Company Number
     C           *LIKE     DEFN WLC4NB    WQSN02           Order Number
     C           *LIKE     DEFN WLDPNB    WQSN03           Order Sequence
     C           *LIKE     DEFN WLUENB    WQSN04           Order Secondary
      * Define keylist
     C           KPSSN     KLIST
     C                     KFLD           WQSN01           Company Number
     C                     KFLD           WQSN02           Order Number
     C                     KFLD           WQSN03           Order Sequence
     C                     KFLD           WQSN04           Order Secondary
     C                     KFLD           WLASNO           Audit Sequence
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Company Number
     C                     KFLD           WQSN02           Order Number
     C                     KFLD           WQSN03           Order Sequence
     C                     KFLD           WQSN04           Order Secondary
      * Setup key
     C                     Z-ADDWEAIC3    WQSN01           Company Number
     C                     Z-ADDWEC4NB    WQSN02           Order Number
     C                     Z-ADDWEDPNB    WQSN03           Order Sequence
     C                     Z-ADDWEUENB    WQSN04           Order Secondary
     C                     Z-ADD999       WLASNO           Audit Sequence
      * Establish starting position
     C           KPSSN     SETLL@K3CPKR                    *
     C           KRSSN     READE@K3CPKR                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2378' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WUQQNB           USR Sequence Nu
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WLASNO    ADD  1         WUQQNB           USR Sequence Nu
     C                     GOTO SNEXIT                     *QUIT
     C           KRSSN     READE@K3CPKR                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCRRC    BEGSR
      *================================================================
      * CRT Price Change Audit CR - PD Price Change Audit Log  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0161  1        EDI Status 1
     C                     MOVEL*BLANK    WN0162  1        EDI Status 2
     C                     MOVEL*BLANK    WN0163  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0164  60       Job Time
     C                     MOVEL*BLANK    WN0165 10        User Id
     C                     MOVEL*BLANK    WN0166 10        Job Name
     C                     Z-ADD*ZERO     WN0167  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @K3CPKP
     C                     Z-ADDWEAIC3    WMAIC3           Company Number
     C                     Z-ADDWEC4NB    WMC4NB           Order Number
     C                     Z-ADDWEDPNB    WMDPNB           Order Sequence
     C                     Z-ADDWEUENB    WMUENB           Order Secondary
     C                     Z-ADDWUQQNB    WMASNO           Audit Sequence
     C                     Z-ADDWEHGCD    WMHGCD           Item Code
     C                     MOVELWEGMST    WMGMST           Detail Line Sta
     C                     MOVELWEGNST    WMGNST           Detail Line Sta
     C                     Z-ADDWN0136    WMAYVA           Extended Amount
     C                     Z-ADDWEAYVA    WMYJVA           Extended Amount
     C                     MOVELWN0138    WMU1ST           Price Status
     C                     MOVELWEU1ST    WMPSTL           Price Status La
     C                     MOVELWN0140    WMU0ST           Price Audit
     C                     MOVELWN0141    WMRFCD           Price Audit Rea
     C                     MOVELWEU0ST    WMPALS           Price Audit Las
     C                     MOVELWERFCD    WMWWCD           Price Audit Rea
     C                     Z-ADDWN0142    WMAKPR           Unit Price
     C                     Z-ADDWEAKPR    WMDBPR           Unit Price Last
     C                     Z-ADDWN0143    WMALPR           Unit Price - Cr
     C                     Z-ADDWEALPR    WMDCPR           Unit Price - Cr
     C                     MOVELWEJPCD    WMJPCD           Event Code
     C                     MOVELWEJPCD    WMWXCD           Event Code Last
     C                     MOVELP2PECF    WMPREC           Price Event Cal
     C                     MOVEL##PGM     WMPIDX           Program ID . .
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WMAATM           Job Time
     C                     MOVEL##USR     WMAYNA           User Id
     C                     MOVEL##JOB     WMA0NA           Job Name
     C                     Z-ADD##JDT     WMAXDT           Job Date
     C           KLCRSO    KLIST
     C                     KFLD           WMAIC3           Company Number
     C                     KFLD           WMC4NB           Order Number
     C                     KFLD           WMDPNB           Order Sequence
     C                     KFLD           WMUENB           Order Secondary
     C                     KFLD           WMASNO           Audit Sequence
      * Check for duplicate primary key
     C           KLCRSO    SETLL@K3CPKP                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2379' W0RTN   7
      * Send message 'Price Change Audit Log EX'
     C                     MOVEL'USR2379' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C                     WRITE@K3CPKP                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * CLC Extend Price 1 Dtl RT - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0168 112       Extended Amount
     C                     Z-ADD*ZERO     WN0169 114       Unit Price
     C                     Z-ADD*ZERO     WN0170 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0171 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0172 112       USR Quantity
     C                     Z-ADD*ZERO     WN0173 112       USR Weight
     C                     Z-ADD*ZERO     WN0174 114       Price per Pound
     C                     MOVEL*BLANK    WN0175  6        Primal Group Co
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * RMC 6/17/09 FP1054 use qty/wgt ordered instead of sched
     C                     Z-ADD*ZERO     WN0168           Extended Amount
      * Declare restrictor key work fields
     C           *LIKE     DEFN WOAIC3    WQSP01           Company Number
     C           *LIKE     DEFN WOC4NB    WQSP02           Order Number
     C           *LIKE     DEFN WODPNB    WQSP03           Order Sequence
     C           *LIKE     DEFN WOUENB    WQSP04           Order Secondary
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           Company Number
     C                     KFLD           WQSP02           Order Number
     C                     KFLD           WQSP03           Order Sequence
     C                     KFLD           WQSP04           Order Secondary
      * Setup key
     C                     Z-ADDWEAIC3    WQSP01           Company Number
     C                     Z-ADDWEC4NB    WQSP02           Order Number
     C                     Z-ADDWEDPNB    WQSP03           Order Sequence
     C                     Z-ADDWEUENB    WQSP04           Order Secondary
      * Establish starting position
     C           KRSSP     SETLL@BGWKAE                    *
     C           KRSSP     READE@BGWKAE                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWOAYVA    WN0168           Extended Amount
     C                     Z-ADDWOAKPR    WN0169           Unit Price
     C                     Z-ADDWOAUPR    WN0170           Unit Price Orde
     C                     Z-ADDWOAVWG    WN0171           Unit Weight Ord
      * RTV For Price Extent   XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDXRXFR'              90  RTV For Price E
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WOAIC3    WQ0120  30       Company Number
     C                     PARM WOHGCD    WQ0121  70       Item Code
     C                     PARM *BLANK    WQ0122  2        UOM Pricing
     C                     PARM *ZERO     WQ0123 112       Unit Weight
     C                     PARM *BLANK    WQ0124  1        Catch Weight St
     C           WN0175    PARM *BLANK    WQ0125  6        Primal Group Co
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Load Quantity Shipped Total field.
      * CASE: DB1.Quantity Shipped Total is Equal to zero
     C           WOCBQT    IFEQ 0                          *IF
     C                     Z-ADD1         WUCBQT           Quantity Shippe
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWOCBQT    WUCBQT           Quantity Shippe
     C                     END                             *FI
      * Set quantity and weight according to order status
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Detail Line Status is Avail/Alloc/Enter/Hold
      *   |- c2    : DB1.Event Code is Entered Thru 03 Picked
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WOGMST    IFEQ 'L'                        *IF
     C           WOGMST    OREQ 'A'
     C           WOGMST    OREQ 'E'
     C           WOGMST    OREQ 'H'
     C           WOJPCD    IFGE '01'                       *IF
     C           WOJPCD    ANDLE'03'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWOAVQT    WN0172           USR Quantity
     C                     Z-ADDWOD0WG    WN0173           USR Weight
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWUCBQT    WN0172           USR Quantity
     C                     Z-ADDWOATWG    WN0173           USR Weight
     C                     END                             *FI
      * CASE: DB1.Price Method Code is Extended
     C           WOQ7CD    IFEQ 'EXT'                      *IF
     C                     Z-ADDWOBZPR    WN0168           Extended Amount
     C                     ELSE
      * CASE: *OTHERWISE
      * Extend price with unit price credit if not zeros
      * CASE:
      *  - (c1 AND c2 AND c3 AND c5 AND c7)
      *   |- c1    : DB1.Detail Line Status is Avail/Alloc/Enter/Hold
      *   |- c2    : DB1.Event Code is Entered Thru 03 Picked
      *   |- c3    : DB1.Unit Price - Credit is Not Zeros
      *   |- c5    : DB1.Price Audit is Not Manually Price Audit
      *   |- c7    : PAR.Pricing Event Called From is No Price With Credi
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WOGMST    IFEQ 'L'                        *IF
     C           WOGMST    OREQ 'A'
     C           WOGMST    OREQ 'E'
     C           WOGMST    OREQ 'H'
     C           WOJPCD    IFGE '01'                       *IF
     C           WOJPCD    ANDLE'03'
     C           WOALPR    IFNE 0                          *IF
     C           WOU0ST    IFEQ 'A'                        *IF
     C           WOU0ST    OREQ 'N'
     C           WOU0ST    OREQ *BLANK
     C           P2PECF    IFEQ 'OE'                       *IF
     C           P2PECF    OREQ 'PS'
     C           P2PECF    OREQ 'UWC'
     C           P2PECF    OREQ 'UWT'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 07/08/09 PKD Replaced w/consideration to .01 price or less
      * Extend Price using Price Overage Override or Unit Price-Credit
      * CASE: DB1.Price Method Code is Deviated
     C           WOQ7CD    IFEQ 'DEV'                      *IF
      * ----- USE: Price Overage Override
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           WN0168    PARM *ZERO     WQ0126 112       Extended Amount
     C                     PARM WOCRCD    WQ0127  2        U/M - Base Pric
     C                     PARM WN0172    WQ0128 112       Quantity Shippe
     C                     PARM WN0173    WQ0129 112       Weight Shipped
     C                     PARM WOBZPR    WQ0130 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: Manual & HPB
      *  - c1 AND c2
      *   |- c1    : DB1.Price Method Code is Manual
      *   |- c2    : PAR.Company Organization is High Plains Biodiesel
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WOQ7CD    IFEQ 'MAN'                      *IF
     C           YL0003    IFEQ 'H'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ----- USE: Price Overage Override
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           WN0168    PARM *ZERO     WQ0131 112       Extended Amount
     C                     PARM WOCRCD    WQ0132  2        U/M - Base Pric
     C                     PARM WN0172    WQ0133 112       Quantity Shippe
     C                     PARM WN0173    WQ0134 112       Weight Shipped
     C                     PARM WOBZPR    WQ0135 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: Manual & Not HPB
      *  - c1 AND c2
      *   |- c1    : DB1.Price Method Code is Manual
      *   |- c2    : PAR.Company Organization is Not HPB
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WOQ7CD    IFEQ 'MAN'                      *IF
     C           YL0003    IFEQ 'D'                        *IF
     C           YL0003    OREQ 'S'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ----- USE: Price Overage Override OR Unit Price-Credit
      * CASE: PS Cst | IC Cst | UNID Itm | OTHER Itm | >.01 Prc
      *  - c1 OR c2 OR c3 OR c4 OR c5
      *   |- c1    : PAR.Type Code is Inter Company
      *   |- c2    : PAR.Type Code is Is Promotional/Samples
      *   |- c3    : PAR.Primal Group Code is Samples or Cut Loss
      *   |- c4    : PAR.Primal Group Code is Other
      *   |- c5    : DB1.Price Overage Override is GT .01
      *   '-
     C           WN0009    IFEQ 'IC'                       *IF
     C           WN0009    OREQ 'PS'                       *OR
     C           WN0175    OREQ 'UNID'                     *OR
     C           WN0175    OREQ 'OTHER'                    *OR
     C           WOBZPR    ORGT .01                        *OR
      * ----- USE: Price Overage Override
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           WN0168    PARM *ZERO     WQ0136 112       Extended Amount
     C                     PARM WOCRCD    WQ0137  2        U/M - Base Pric
     C                     PARM WN0172    WQ0138 112       Quantity Shippe
     C                     PARM WN0173    WQ0139 112       Weight Shipped
     C                     PARM WOBZPR    WQ0140 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * ----- USE: Unit Price-Credit
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           WN0168    PARM *ZERO     WQ0141 112       Extended Amount
     C                     PARM WOCRCD    WQ0142  2        U/M - Base Pric
     C                     PARM WN0172    WQ0143 112       Quantity Shippe
     C                     PARM WN0173    WQ0144 112       Weight Shipped
     C                     PARM WOALPR    WQ0145 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * ---- USE: Unit Price-Credit
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           WN0168    PARM *ZERO     WQ0146 112       Extended Amount
     C                     PARM WOCRCD    WQ0147  2        U/M - Base Pric
     C                     PARM WN0172    WQ0148 112       Quantity Shippe
     C                     PARM WN0173    WQ0149 112       Weight Shipped
     C                     PARM WOALPR    WQ0150 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * *** Determine Extended Amount
      * 08/28/07 PKD Replaced with Clc OrdDtl Ext Amt    XF
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           WN0168    PARM *ZERO     WQ0151 112       Extended Amount
     C                     PARM WOCRCD    WQ0152  2        U/M - Base Pric
     C                     PARM WN0172    WQ0153 112       Quantity Shippe
     C                     PARM WN0173    WQ0154 112       Weight Shipped
     C                     PARM WOAKPR    WQ0155 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PAR.USR Quantity is not equal zero
     C           WN0172    IFNE 0                          *IF
     C           WN0168    DIV  WN0172    WN0170    H      Unit Price Orde
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CHG Dtl Price/Audit    CH - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWOAIC3    WL0012           Company Number
     C                     Z-ADDWOC4NB    WL0013           Order Number
     C                     Z-ADDWODPNB    WL0014           Order Sequence
     C                     Z-ADDWOUENB    WL0015           Order Secondary
     C                     Z-ADDWN0168    WL0016           Billing Detail
     C                     Z-ADDWN0168    WL0017           Extended Amount
     C                     MOVELWOU1ST    WL0018    P      Price Status
     C                     Z-ADDWOGIDT    WL0019           Pricing Date Us
     C                     MOVELWOU0ST    WL0020    P      Price Audit
     C                     MOVELWORFCD    WL0021    P      Price Audit Rea
     C                     Z-ADDWOAKPR    WL0022           Unit Price
     C                     Z-ADDWOALPR    WL0023           Unit Price - Cr
     C                     Z-ADDWN0170    WL0024           Unit Price Orde
     C                     Z-ADDWOAVWG    WL0025           Unit Weight Ord
     C                     Z-ADDWOAODT    WL0026           Scheduled Ship
     C                     MOVELWOZ1ST    WL0027    P      Modified Flag
     C                     MOVELWOZ3ST    WL0028    P      Substituted Fla
     C                     MOVELWOZ4ST    WL0029    P      OD Schedule Ove
     C                     EXSR SGCHRC
     C           KRSSP     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Affect Fields      RT - Order Types  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WRJNCD           Order Type - Sa
      * Setup key
     C                     MOVELWAJNCD    WRJNCD           Order Type - Sa
      * Establish starting position
     C           KRSSQ     CHAIN@EXRETY              90    *
      * Data record not found
     C   90                MOVEL'USR1063' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWROEST    WUOEST           Affect Inventor
     C                     MOVELWROFST    WUOFST           Affect Sales Do
     C                     MOVELWRVBST    WUVBST           Affect Sales Pn
     C                     MOVELWRPYST    WUPYST           Affect Brokerag
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * UPD Chg Val Open Ord   RT - A/R Summary  * Company
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0176 112       Value of Open O
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WSAIC3           Company Number
     C                     KFLD           WSANC7           AR Customer Num
      * Setup key
     C                     Z-ADDWL0038    WSAIC3           Company Number
     C                     Z-ADDWL0039    WSANC7           AR Customer Num
      * Establish starting position
     C           KRSSR     CHAIN@BCREFE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0172' W0RTN   7
      * USER: Processing if Data record not found
      * This shouldn't be used here--A/R Summary is created when an order
      * is created
      * CRT A/R Summary        CR - A/R Summary  * 
     C                     EXSR SSCRRC
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WSEEVA    ADD  WL0040    WN0176           Value of Open O
      * CHG Value Open Orders  CH - A/R Summary  * 
     C                     EXSR STCHRC
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCRRC    BEGSR
      *================================================================
      * CRT A/R Summary        CR - A/R Summary  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0177  60       Job Time
     C                     MOVEL*BLANK    WN0178 10        User Id
     C                     MOVEL*BLANK    WN0179 10        Job Name
     C                     Z-ADD*ZERO     WN0180  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BCREFD
     C                     Z-ADDWL0038    WTAIC3           Company Number
     C                     Z-ADDWL0039    WTANC7           AR Customer Num
     C                     Z-ADD*ZERO     WTAGVA           Age $ Due - Cur
     C                     Z-ADD*ZERO     WTACVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WTADVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WTAEVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WTAFVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WTAHVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WTVIVA           Age $ Due-Curre
     C                     Z-ADD*ZERO     WTVJVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WTVKVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WTVLVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WTVMVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WTVNVA           Age $ Due-Aging
     C                     Z-ADDWL0040    WTEEVA           Value of Open O
     C                     Z-ADD*ZERO     WTAKTM           Time of Last Ag
     C                     Z-ADD*ZERO     WTAHDT           Date of First S
     C                     Z-ADD*ZERO     WTANDT           Date of Last Sh
     C                     Z-ADD*ZERO     WTANVA           Amount of Last
     C                     Z-ADD*ZERO     WTALDT           Date of Last Pa
     C                     Z-ADD*ZERO     WTAMVA           Amount of Last
     C                     Z-ADD*ZERO     WTAIDT           Date of Highest
     C                     Z-ADD*ZERO     WTALVA           Amount of Highe
     C                     Z-ADD*ZERO     WTDJNB           Number of Invoi
     C                     Z-ADD1         WTDLNB           Number of Order
     C                     Z-ADD*ZERO     WTDDNB           Number of Credi
     C                     Z-ADD*ZERO     WTDMNB           Number of Payme
     C                     Z-ADD*ZERO     WTDUDT           Date of Last Ag
     C                     Z-ADD*ZERO     WTLYNO           Last YTD Nbr of
     C                     Z-ADD*ZERO     WTLYNC           Last YTD Nbr of
     C                     Z-ADD*ZERO     WTLYNP           Last YTD Nbr of
     C                     Z-ADD*ZERO     WTLYNI           Last YTD Nbr of
     C                     Z-ADD*ZERO     WTADPM           MTD Invoices Pa
     C                     Z-ADD*ZERO     WTVOVA           YTD Invoices Pa
     C                     Z-ADD*ZERO     WTBTDY           MTD Days Paid
     C                     Z-ADD*ZERO     WTBUDY           YTD Days Paid
     C                     Z-ADD*ZERO     WTVPVA           YTD Sales Invoi
     C                     Z-ADD*ZERO     WTVQVA           Last Year Sales
     C                     MOVEL*BLANK    WTBCCD           Salesperson Cod
     C                     MOVEL*BLANK    WTR4CD           Sales Route Cod
     C                     Z-ADD*ZERO     WTCUMO           Current Month
     C                     MOVEL*BLANK    WTUVST           EDI Status 1
     C                     MOVEL*BLANK    WTUWST           EDI Status 2
     C                     MOVEL*BLANK    WTUXST           EDI Status 3
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WTAATM           Job Time
     C                     MOVEL##USR     WTAYNA           User Id
     C                     MOVEL##JOB     WTA0NA           Job Name
     C                     Z-ADD##JDT     WTAXDT           Job Date
     C           KLCRSS    KLIST
     C                     KFLD           WTAIC3           Company Number
     C                     KFLD           WTANC7           AR Customer Num
      * Check for duplicate primary key
     C           KLCRSS    SETLL@BCREFD                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0173' W0RTN   7
      * Send message 'A/R Summary            EX'
     C                     MOVEL'USR0173' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C                     WRITE@BCREFD                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STCHRC    BEGSR
      *================================================================
      * CHG Value Open Orders  CH - A/R Summary  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0181 112       Age $ Due - Cur
     C                     Z-ADD*ZERO     WN0182 112       Age $ Due - Agi
     C                     Z-ADD*ZERO     WN0183 112       Age $ Due - Agi
     C                     Z-ADD*ZERO     WN0184 112       Age $ Due - Agi
     C                     Z-ADD*ZERO     WN0185 112       Age $ Due - Agi
     C                     Z-ADD*ZERO     WN0186 112       Age $ Due - Agi
     C                     Z-ADD*ZERO     WN0187 112       Age $ Due-Curre
     C                     Z-ADD*ZERO     WN0188 112       Age $ Due-Aging
     C                     Z-ADD*ZERO     WN0189 112       Age $ Due-Aging
     C                     Z-ADD*ZERO     WN0190 112       Age $ Due-Aging
     C                     Z-ADD*ZERO     WN0191 112       Age $ Due-Aging
     C                     Z-ADD*ZERO     WN0192 112       Age $ Due-Aging
     C                     Z-ADD*ZERO     WN0193  60       Time of Last Ag
     C                     Z-ADD*ZERO     WN0194  70       Date of First S
     C                     Z-ADD*ZERO     WN0195  70       Date of Last Sh
     C                     Z-ADD*ZERO     WN0196 112       Amount of Last
     C                     Z-ADD*ZERO     WN0197  70       Date of Last Pa
     C                     Z-ADD*ZERO     WN0198 112       Amount of Last
     C                     Z-ADD*ZERO     WN0199  70       Date of Highest
     C                     Z-ADD*ZERO     WN0200 112       Amount of Highe
     C                     Z-ADD*ZERO     WN0201  50       Number of Invoi
     C                     Z-ADD*ZERO     WN0202  50       Number of Order
     C                     Z-ADD*ZERO     WN0203  50       Number of Credi
     C                     Z-ADD*ZERO     WN0204  50       Number of Payme
     C                     Z-ADD*ZERO     WN0205  70       Date of Last Ag
     C                     Z-ADD*ZERO     WN0206  50       Last YTD Nbr of
     C                     Z-ADD*ZERO     WN0207  50       Last YTD Nbr of
     C                     Z-ADD*ZERO     WN0208  50       Last YTD Nbr of
     C                     Z-ADD*ZERO     WN0209  50       Last YTD Nbr of
     C                     Z-ADD*ZERO     WN0210  50       MTD Invoices Pa
     C                     Z-ADD*ZERO     WN0211  50       YTD Invoices Pa
     C                     Z-ADD*ZERO     WN0212  50       MTD Days Paid
     C                     Z-ADD*ZERO     WN0213  50       YTD Days Paid
     C                     Z-ADD*ZERO     WN0214 112       YTD Sales Invoi
     C                     Z-ADD*ZERO     WN0215 112       Last Year Sales
     C                     MOVEL*BLANK    WN0216  3        Salesperson Cod
     C                     MOVEL*BLANK    WN0217  3        Sales Route Cod
     C                     Z-ADD*ZERO     WN0218  20       Current Month
     C                     MOVEL*BLANK    WN0219  1        EDI Status 1
     C                     MOVEL*BLANK    WN0220  1        EDI Status 2
     C                     MOVEL*BLANK    WN0221  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0222  60       Job Time
     C                     MOVEL*BLANK    WN0223 10        User Id
     C                     MOVEL*BLANK    WN0224 10        Job Name
     C                     Z-ADD*ZERO     WN0225  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @BCREFD
     C                     Z-ADDWSAIC3    WTAIC3           Company Number
     C                     Z-ADDWSANC7    WTANC7           AR Customer Num
      *
     C           KLCHST    KLIST
     C                     KFLD           WTAIC3           Company Number
     C                     KFLD           WTANC7           AR Customer Num
     C           KLCHST    CHAIN@BCREFD              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'ARBCREL0'MDACP
     C                     MOVEL'@BCREFD' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO STEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QARBC1    YBRDCS
      * Move non-key fields to @BCREFD
     C                     Z-ADDWN0176    WTEEVA           Value of Open O
      *
      * Set PGM.*Record Data Changed flag
     C           QARBC1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WTAATM           Job Time
     C                     MOVEL##USR     WTAYNA           User Id
     C                     MOVEL##JOB     WTA0NA           Job Name
     C                     Z-ADD##JDT     WTAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QARBC1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@BCREFD                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKARBCREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUCHRC    BEGSR
      *================================================================
      * CHG Order Price/PrcAud CH - PD Order Header  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     MOVEL*BLANK    WN0226  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0227  70       AR Customer Num
     C                     Z-ADD*ZERO     WN0228  70       Ship To Custome
     C                     MOVEL*BLANK    WN0229 30        Ship To Name
     C                     MOVEL*BLANK    WN0230 30        Ship To Address
     C                     MOVEL*BLANK    WN0231 30        Ship To Address
     C                     MOVEL*BLANK    WN0232 30        Ship To Address
     C                     MOVEL*BLANK    WN0233 20        Ship To City
     C                     MOVEL*BLANK    WN0234  2        Ship To State C
     C                     MOVEL*BLANK    WN0235 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0236  70       Bill to Custome
     C                     MOVEL*BLANK    WN0237 30        Bill to Name
     C                     MOVEL*BLANK    WN0238 30        Bill to Address
     C                     MOVEL*BLANK    WN0239 30        Bill to Address
     C                     MOVEL*BLANK    WN0240 30        Bill to Address
     C                     MOVEL*BLANK    WN0241 20        Bill to City
     C                     MOVEL*BLANK    WN0242  2        Bill to State C
     C                     MOVEL*BLANK    WN0243 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0244 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0245  70       Order Date
     C                     Z-ADD*ZERO     WN0246  70       Requested Ship
     C                     Z-ADD*ZERO     WN0247  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0248  70       Cancel Date
     C                     MOVEL*BLANK    WN0249  2        Terms Code
     C                     MOVEL*BLANK    WN0250 40        Special Instruc
     C                     MOVEL*BLANK    WN0251 40        Special Instruc
     C                     MOVEL*BLANK    WN0252  3        Carrier Code
     C                     MOVEL*BLANK    WN0253  1        Comment Print A
     C                     MOVEL*BLANK    WN0254  1        Comment Print I
     C                     MOVEL*BLANK    WN0255  1        Comment Print P
     C                     MOVEL*BLANK    WN0256  1        Comment Print S
     C                     MOVEL*BLANK    WN0257  3        Reason Code
     C                     MOVEL*BLANK    WN0258  1        Order in Use
     C                     MOVEL*BLANK    WN0259  1        Header Status
     C                     MOVEL*BLANK    WN0260  1        Header Status L
     C                     MOVEL*BLANK    WN0261  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0262  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0263 10        User Original E
     C                     Z-ADD*ZERO     WN0264  70       Date of Origina
     C                     MOVEL*BLANK    WN0265  1        Credit Hold
     C                     MOVEL*BLANK    WN0266  1        Production Hold
     C                     MOVEL*BLANK    WN0267  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0268  40       Requested Deliv
     C                     MOVEL*BLANK    WN0269  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0270 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0271  70       Load ID
     C                     Z-ADD*ZERO     WN0272  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0273 112       Rated Freight
     C                     MOVEL*BLANK    WN0274  1        LTL Flag
     C                     MOVEL*BLANK    WN0275  2        Shipping Method
     C                     MOVEL*BLANK    WN0276  1        Export Status
     C                     MOVEL*BLANK    WN0277  1        Palletize
     C                     MOVEL*BLANK    WN0278  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0279  1        Slip Sheet
     C                     MOVEL*BLANK    WN0280  1        Age Code
     C                     Z-ADD*ZERO     WN0281  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0282  1        Load Type
     C                     Z-ADD*ZERO     WN0283  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0284  1        Load Plan Order
     C                     MOVEL*BLANK    WN0285  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0286  70       Resell Referenc
     C                     MOVEL*BLANK    WN0287 30        Special Comment
     C                     MOVEL*BLANK    WN0288 30        Special Comment
     C                     MOVEL*BLANK    WN0289  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0290  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0291  2        Manager Level C
     C                     MOVEL*BLANK    WN0292  3        VP Level Code
     C                     Z-ADD*ZERO     WN0293  70       Attach to Order
     C                     MOVEL*BLANK    WN0294  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0295  70       Invoice Number
     C                     MOVEL*BLANK    WN0296  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0297  70       Invoice Date
     C                     MOVEL*BLANK    WN0298  2        Event Code
     C                     MOVEL*BLANK    WN0299  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0300  1        Billing Activit
     C                     MOVEL*BLANK    WN0301  1        Block Order Fla
     C                     MOVEL*BLANK    WN0302  1        Order Certifica
     C                     Z-ADD*ZERO     WN0303 112       Invoice Order V
     C                     MOVEL*BLANK    WN0304  1        Process Sts for
     C                     MOVEL*BLANK    WN0305  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0306  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0307  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0308  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0309  1        Email Cust On O
     C                     MOVEL*BLANK    WN0310  1        Order Emailed
     C                     MOVEL*BLANK    WN0311  1        Export Docs Go
     C                     MOVEL*BLANK    WN0312  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0313  1        Broker Order St
     C                     MOVEL*BLANK    WN0314  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0315  2        Order Requires
     C                     MOVEL*BLANK    WN0316  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0317  2        Export USDA App
     C                     MOVEL*BLANK    WN0318  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0319  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0320  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0321  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0322  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0323  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0324  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0325  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0326  60       Time of Origina
     C                     Z-ADD*ZERO     WN0327  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0328  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0329  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0330 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0331 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0332 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0333 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0334 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0335  70       Claim Number
     C                     MOVEL*BLANK    WN0336  1        EDI Status 1
     C                     MOVEL*BLANK    WN0337  1        EDI Status 2
     C                     MOVEL*BLANK    WN0338  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0339  60       Job Time
     C                     MOVEL*BLANK    WN0340 10        User Id
     C                     MOVEL*BLANK    WN0341 10        Job Name
     C                     Z-ADD*ZERO     WN0342  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWL0041    WVAIC3           Company Number
     C                     Z-ADDWL0042    WVC4NB           Order Number
      *
     C           KLCHSU    KLIST
     C                     KFLD           WVAIC3           Company Number
     C                     KFLD           WVC4NB           Order Number
     C           KLCHSU    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YCRDCS
      * Move non-key fields to @BECPFJ
     C                     Z-ADDWL0043    WVJZVA           Order Value Tot
     C                     Z-ADDWL0044    WVA1WG           Order Weight To
     C                     Z-ADDWL0045    WVEIDT           Requested Deliv
     C                     MOVELWL0046    WVU0ST    P      Price Audit
     C                     MOVELWL0047    WVU1ST    P      Price Status
     C                     MOVELWL0048    WVZ1ST    P      Modified Flag
     C                     Z-ADDWL0049    WVVRVA           A/R order Value
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WVAATM           Job Time
     C                     MOVEL##USR     WVAYNA           User Id
     C                     MOVEL##PGM     WVA0NA           Job Name
     C                     Z-ADD##JDT     WVAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPARC
     C                     Z-ADDWVAIC3    PAAIC3           Company Number
     C                     Z-ADDWVC4NB    PAC4NB           Order Number
     C                     MOVELWVJNCD    PAJNCD    P      Order Type - Sa
     C                     Z-ADDWVANC7    PAANC7           AR Customer Num
     C                     Z-ADDWVBKC7    PABKC7           Ship To Custome
     C                     MOVELWVBRTX    PABRTX    P      Ship To Name
     C                     MOVELWVHMNA    PAHMNA    P      Ship To Address
     C                     MOVELWVHONA    PAHONA    P      Ship To Address
     C                     MOVELWVHPNA    PAHPNA    P      Ship To Address
     C                     MOVELWVHNNA    PAHNNA    P      Ship To City
     C                     MOVELWVDBCD    PADBCD    P      Ship To State C
     C                     MOVELWVCKTX    PACKTX    P      Ship To Zip/Pos
     C                     Z-ADDWVB0C7    PAB0C7           Bill to Custome
     C                     MOVELWVAETX    PAAETX    P      Bill to Name
     C                     MOVELWVB1NA    PAB1NA    P      Bill to Address
     C                     MOVELWVB3NA    PAB3NA    P      Bill to Address
     C                     MOVELWVB4NA    PAB4NA    P      Bill to Address
     C                     MOVELWVB2NA    PAB2NA    P      Bill to City
     C                     MOVELWVBHCD    PABHCD    P      Bill to State C
     C                     MOVELWVC8TX    PAC8TX    P      Bill to Zip/Pos
     C                     MOVELWVBCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDWVA0DT    PAA0DT           Order Date
     C                     Z-ADDWVA5DT    PAA5DT           Requested Ship
     C                     Z-ADDWVGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDWVACDT    PAACDT           Cancel Date
     C                     MOVELWVAQCD    PAAQCD    P      Terms Code
     C                     MOVELWVB6NA    PAB6NA    P      Special Instruc
     C                     MOVELWVBYNA    PABYNA    P      Special Instruc
     C                     MOVELWVBZNA    PABZNA    P      Carrier Code
     C                     MOVELWVGTST    PAGTST    P      Comment Print A
     C                     MOVELWVGVST    PAGVST    P      Comment Print I
     C                     MOVELWVGUST    PAGUST    P      Comment Print P
     C                     MOVELWVQFST    PAQFST    P      Comment Print S
     C                     MOVELWVCQCD    PACQCD    P      Reason Code
     C                     MOVELWVGJST    PAGJST    P      Order in Use
     C                     MOVELWVGWST    PAGWST    P      Header Status
     C                     MOVELWVGXST    PAGXST    P      Header Status L
     C                     MOVELWVGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDWVAODT    PAAODT           Scheduled Ship
     C                     MOVELWVAIVN    PAAIVN    P      User Original E
     C                     Z-ADDWVCXDT    PACXDT           Date of Origina
     C                     Z-ADDWVJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDWVA1WG    PAA1WG           Order Weight To
     C                     MOVELWVXIST    PAXIST    P      Credit Hold
     C                     MOVELWVXJST    PAXJST    P      Production Hold
     C                     MOVELWVXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDWVEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDWVAFTM    PAAFTM           Requested Deliv
     C                     MOVELWVE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELWVE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDWVRMNB    PARMNB           Load ID
     C                     Z-ADDWVTBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDWVR1NB    PAR1NB           Rated Freight
     C                     MOVELWVPJST    PAPJST    P      LTL Flag
     C                     MOVELWVU0ST    PAU0ST    P      Price Audit
     C                     MOVELWVU1ST    PAU1ST    P      Price Status
     C                     MOVELWVQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELWVU2ST    PAU2ST    P      Export Status
     C                     MOVELWVVEST    PAVEST    P      Palletize
     C                     MOVELWVVFST    PAVFST    P      Shrink Wrap
     C                     MOVELWVVGST    PAVGST    P      Slip Sheet
     C                     MOVELWVRPCD    PARPCD    P      Age Code
     C                     Z-ADDWVRNNB    PARNNB           Reefer Temperat
     C                     MOVELWVVDST    PAVDST    P      Load Type
     C                     Z-ADDWVATIN    PAATIN           Attach to Invoi
     C                     MOVELWVU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELWVU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDWVRSRN    PARSRN           Resell Referenc
     C                     MOVELWVMHNA    PAMHNA    P      Special Comment
     C                     MOVELWVMINA    PAMINA    P      Special Comment
     C                     MOVELWVWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELWVR4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELWVBFCD    PABFCD    P      Manager Level C
     C                     MOVELWVQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDWVT3NB    PAT3NB           Attach to Order
     C                     MOVELWVSICD    PASICD    P      Reason for Pric
     C                     Z-ADDWVCONB    PACONB           Invoice Number
     C                     MOVELWVCEST    PACEST    P      Invoice Suffix
     C                     Z-ADDWVAWDT    PAAWDT           Invoice Date
     C                     MOVELWVJPCD    PAJPCD    P      Event Code
     C                     MOVELWVXUST    PAXUST    P      Trans Contol AS
     C                     MOVELWVZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDWVVRVA    PAVRVA           A/R order Value
     C                     MOVELWVOBST    PAOBST    P      Billing Activit
     C                     MOVELWVBCST    PABCST    P      Block Order Fla
     C                     MOVELWVBDST    PABDST    P      Order Certifica
     C                     Z-ADDWVB7VL    PAB7VL           Invoice Order V
     C                     MOVELWVGASX    PAGASX    P      Process Sts for
     C                     MOVELWVGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELWVGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELWVGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELWVFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELWVFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELWVFPSX    PAFPSX    P      Order Emailed
     C                     MOVELWVFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELWVFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELWVFSSX    PAFSSX    P      Broker Order St
     C                     MOVELWVFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELWVFUSX    PAFUSX    P      Order Requires
     C                     MOVELWVFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELWVFWSX    PAFWSX    P      Export USDA App
     C                     MOVELWVFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELWVFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDWVNODT    PANODT           OH Appt Confirm
     C                     Z-ADDWVNPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDWVNQDT    PANQDT           Load Actual Shi
     C                     Z-ADDWVNRDT    PANRDT           Load BOL Comple
     C                     Z-ADDWVNSDT    PANSDT           Load Truck Depa
     C                     Z-ADDWVBPTM    PABPTM           Maximum Gross W
     C                     Z-ADDWVBQTM    PABQTM           Time of Origina
     C                     Z-ADDWVBRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDWVBSTM    PABSTM           Load BOL Comple
     C                     Z-ADDWVBTTM    PABTTM           Load Truck Depa
     C                     Z-ADDWVH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDWVH1NX    PAH1NX           Act Non-Ref Frt
     C                     Z-ADDWVH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDWVH3NX    PAH3NX           OH Total Non-Re
     C                     Z-ADDWVH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDWVC0C7    PAC0C7           Claim Number
     C                     MOVELWVUVST    PAUVST    P      EDI Status 1
     C                     MOVELWVUWST    PAUWST    P      EDI Status 2
     C                     MOVELWVUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDWVAATM    PAAATM           Job Time
     C                     MOVELWVAYNA    PAAYNA    P      User Id
     C                     MOVELWVA0NA    PAA0NA    P      Job Name
     C                     Z-ADDWVAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Rtv Order Info ALL    RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WAAIC3           Company Number
     C                     Z-ADDP1C4NB    WAC4NB           Order Number
      * Establish starting position
     C           KRSSV     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0017           AR Customer Num
     C                     MOVEL*BLANK    YL0018           Customer Purcha
     C                     MOVEL*BLANK    YL0019           Price Status
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWAANC7    YL0017           AR Customer Num
     C                     MOVELWABCNA    YL0018           Customer Purcha
     C                     MOVELWAU1ST    YL0019           Price Status
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * RTV BT Intrchg BT custRT - EDI Bill To Interchange  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0052           POC/POCA ??
     C                     MOVEL*BLANK    WL0053           EDI Trading Par
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WWB0C7           Bill to Custome
     C                     KFLD           WWM4AA           Interchange Cod
      * Setup key
     C                     Z-ADDWL0050    WWB0C7           Bill to Custome
     C                     MOVELWL0051    WWM4AA           Interchange Cod
      * Establish starting position
     C           KRSSW     CHAIN@GQREH2              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4373' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0052           POC/POCA ??
     C                     MOVEL*BLANK    WL0053           EDI Trading Par
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWWJ5NX    WL0053           EDI Trading Par
      * 01/24/23 DN W95589-Check Record Status is Active for both 855 & 8
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Interchange Code is PO Acknowledgement  855
      *   |- c2    : DB1.Record Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WWM4AA    IFEQ 'POACK'                    *IF
     C           WWVSST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL*BLANK    WL0052           POC/POCA ??
     C                     MOVEL'POACK'   WL0052           POC/POCA ??
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Interchange Code is PO Change Ack       865
      *   |- c2    : DB1.Record Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WWM4AA    IFEQ @CN,001                    *IF
     C           WWVSST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'POCACK'  WL0052           POC/POCA ??
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * RTV EDI PO Flag       RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 3/11/14 SAZ If OHE PO ack flag = Blank, initialize to *NO
      * 3/11/14 SAZ If Record not found, initialize  OHE PO Ack Flag to *
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WXAIC3           Company Number
     C                     KFLD           WXC4NB           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WXAIC3           Company Number
     C                     Z-ADDP1C4NB    WXC4NB           Order Number
      * Establish starting position
     C           KRSSX     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0024           OHE PO ACK Flag
     C                     MOVEL*BLANK    YL0025           Record Found US
     C                     MOVEL'N'       YL0025           Record Found US
     C                     MOVEL*BLANK    YL0024           OHE PO ACK Flag
     C                     MOVEL'*NO'     YL0024           OHE PO ACK Flag
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWXC6TX    YL0024           OHE PO ACK Flag
      * CASE: DB1.OHE PO ACK Flag is *Blank
     C           WXC6TX    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    YL0024           OHE PO ACK Flag
     C                     MOVEL'*NO'     YL0024           OHE PO ACK Flag
     C                     END                             *FI
     C                     MOVEL'Y'       YL0025           Record Found US
     C                     GOTO SXEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * VAL PO Exists         RT - EDI Purchase Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WYJ5NX    WQSY01           EDI Trading Par
     C           *LIKE     DEFN WYPONO    WQSY02           G5003-PURCHASE
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WQSY01           EDI Trading Par
     C                     KFLD           WQSY02           G5003-PURCHASE
      * Setup key
     C                     MOVELYL0021    WQSY01           EDI Trading Par
     C                     MOVELYL0018    WQSY02           G5003-PURCHASE
      * Establish starting position
     C           KRSSY     SETLL@P004SK                    *
     C           KRSSY     READE@P004SK                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3103' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       YL0025           Record Found US
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       YL0025           Record Found US
     C                     GOTO SYEXIT                     *QUIT
     C           KRSSY     READE@P004SK                  90*
     C                     ENDDO
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Order is not Cancelled.
      *================================================================
      * CASE: DB1.Billing Activity Type is Invoice
     C           WAOBST    IFEQ '1'                        *IF
      * Invoice.
     C                     EXSR UBSUBR                     Invoice.
     C                     ELSE
      * CASE: DB1.Billing Activity Type is Warehouse Transfer
     C           WAOBST    IFEQ '4'                        *IF
      * Warehouse Transfer.
     C                     EXSR UDSUBR                     Warehouse Trans
     C                     ELSE
      * CASE: *OTHERWISE
      * Credit Memo/Debit Memo
     C                     Z-ADDWAJZVA    WN0005           USR Order Value
     C                     Z-ADDWAA1WG    WN0004           USR Order Weigh
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0005    P3JZVA           Order Value Tot
     C                     Z-ADDWN0004    P3A1WG           Order Weight To
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Invoice.
      *================================================================
      * Rtv All Prc Sts/Audit  RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0001           Company Number
     C                     Z-ADDWAC4NB    WL0002           Order Number
     C                     Z-ADD*ZERO     WL0003           Order Sequence
     C                     Z-ADD*ZERO     WL0004           Order Secondary
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    WN0002    P      Price Status
     C                     MOVELWL0006    WN0001    P      Price Audit
     C                     Z-ADDWL0007    WN0012           Shipping Compan
     C                     Z-ADDWL0008    WN0011           Accounting Comp
     C                     MOVELWN0001    WN0008           Price Audit USR
      * Extend $ if call from OE and Price=P & Audit=M)
      * CASE:
      *  - (c2 AND c3 ANDc4)
      *   |- c2    : PAR.Pricing Event Called From is Order Entry
      *   |- c3    : PAR.Price Audit is Manually Price Audited
      *   |- c4    : PAR.Price Status is Priced
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2PECF    IFEQ 'OE'                       *IF
     C           WN0001    IFEQ 'M'                        *IF
     C           WN0002    IFEQ 'P'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVELWN0002    WN0007           Price Status US
      * CLC Extend Price       RT - Order Detail  * 
     C                     EXSR SERVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * Price OR Reprice
      * C4029:  We won't be using PAR.Price Status USR or PAR.Price Audit
      *         to update order header; re-retrieving it.
      * R12926 DN 04/23/18-Pass in Absorbed Freight Rate. Use AFR at Orde
      * CLC Price/Price Audit  RT - Order Detail  * 
     C                     EXSR SHRVGN
     C                     END                             *FI
      * RTV Affect Fields      RT - Order Types  * 
     C                     EXSR SQRVGN
      * If not a new order remove A/R Summary
      * CASE: PAR.USR New Order is *NO
     C           P4W7ST    IFEQ '*NO'                      *IF
      * Remove old order value from A/R Summary
      * CASE: DB1.Block Order Flag is Block Order
     C           WABCST    IFEQ 'B'                        *IF
      *    **OMS203:  Block Orders don't affect A/R Summary
     C                     ELSE
      * CASE: WRK.Affect Sales Doll Default is yes
     C           WUOFST    IFEQ 'Y'                        *IF
     C           *ZERO     SUB  WAVRVA    WUJZVA           Order Value Tot
      * 08/20/07 RMC PK0040 Use Accounting Company if there, else db1
      * CASE: PAR.Accounting Company is Equal to zero
     C           WN0011    IFEQ 0                          *IF
      * UPD Chg Val Open Ord   RT - A/R Summary  * Company
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0038           Company Number
     C                     Z-ADDWAANC7    WL0039           AR Customer Num
     C                     Z-ADDWUJZVA    WL0040           A/R order Value
     C                     EXSR SRRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * UPD Chg Val Open Ord   RT - A/R Summary  * Accounting Company
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0011    WL0038           Company Number
     C                     Z-ADDWAANC7    WL0039           AR Customer Num
     C                     Z-ADDWUJZVA    WL0040           A/R order Value
     C                     EXSR SRRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CLC Tot Ord Val Ship   XF - Order Detail  * 
     C                     CALL 'PDP1XFR'              90  CLC Tot Ord Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0156  30       Company Number
     C                     PARM WAC4NB    WQ0157  70       Order Number
     C           WN0005    PARM WN0005    WQ0158 112       USR Order Value
     C           WN0004    PARM WN0004    WQ0159 112       USR Order Weigh
     C           P3XJST    PARM P3XJST    WQ0160  1        USR Production
     C           WUR4ST    PARM WUR4ST    WQ0161  1        USR Update Flag
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDP1XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * A/R Summary updated if order type affect sales $/not block order
      * CASE: DB1.Block Order Flag is Block Order
     C           WABCST    IFEQ 'B'                        *IF
     C                     Z-ADD*ZERO     WN0003           A/R order Value
     C                     ELSE
      * CASE: WRK.Affect Sales Doll Default is yes
     C           WUOFST    IFEQ 'Y'                        *IF
      * 12/07/06 PKD PK0040 Use Accounting Company if there
      * CASE: PAR.Accounting Company is Equal to zero
     C           WN0011    IFEQ 0                          *IF
      * UPD Chg Val Open Ord   RT - A/R Summary  * Company
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0038           Company Number
     C                     Z-ADDWAANC7    WL0039           AR Customer Num
     C                     Z-ADDWN0005    WL0040           A/R order Value
     C                     EXSR SRRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * UPD Chg Val Open Ord   RT - A/R Summary  * Accounting Company
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0011    WL0038           Company Number
     C                     Z-ADDWAANC7    WL0039           AR Customer Num
     C                     Z-ADDWN0005    WL0040           A/R order Value
     C                     EXSR SRRVGN
     C                     END                             *FI
     C                     Z-ADDWN0005    WN0003           A/R order Value
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0003           A/R order Value
     C                     END                             *FI
     C                     END                             *FI
      * Load ID NE *zero
      * CASE: DB1.Load ID NE WRK.ZERO
     C           WARMNB    IFNE WUW0NB                     *IF
      * RTV UPD Ld Abs.Frt/Wgt XF - OP Order Header  * 
     C                     CALL 'PDE0XFR'              90  RTV UPD Ld Abs.
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WARMNB    WQ0162  70       Load ID
     C           WURPNB    PARM WURPNB    WQ0163  70       Total Load Orde
     C           WURQNB    PARM WURQNB    WQ0164 112       Total Freight
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDE0XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Update header with Order Value/Weight and Price Status/Audit Valu
      * C4029:  3/20/98 pll  Added code so the header re-gets the price/a
      * Rtv All Prc Sts/Audit  RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0001           Company Number
     C                     Z-ADDWAC4NB    WL0002           Order Number
     C                     Z-ADD*ZERO     WL0003           Order Sequence
     C                     Z-ADD*ZERO     WL0004           Order Secondary
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    WN0007    P      Price Status
     C                     MOVELWL0006    WN0008    P      Price Audit
     C                     Z-ADDWL0007    WN0012           Shipping Compan
     C                     Z-ADDWL0008    WN0011           Accounting Comp
      * CHG Order Price/PrcAud CH - PD Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0041           Company Number
     C                     Z-ADDWAC4NB    WL0042           Order Number
     C                     Z-ADDWN0005    WL0043           Order Value Tot
     C                     Z-ADDWN0004    WL0044           Order Weight To
     C                     Z-ADDWAEIDT    WL0045           Requested Deliv
     C                     MOVELWN0008    WL0046    P      Price Audit
     C                     MOVELWN0007    WL0047    P      Price Status
     C                     MOVELWAZ1ST    WL0048    P      Modified Flag
     C                     Z-ADDWN0003    WL0049           A/R order Value
     C                     EXSR SUCHRC
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Set hold fields and call pricing routine
      *================================================================
     C                     Z-ADDWEAKPR    WN0142           Unit Price
     C                     Z-ADDWEALPR    WN0143           Unit Price - Cr
     C                     Z-ADDWEAUPR    WN0144           Unit Price Orde
     C                     MOVELWEU1ST    WN0138           Price Status
     C                     MOVELWERFCD    WN0141           Price Audit Rea
      * If order is priced and manually price audited then price only
      * CASE:
      *  - (c1 AND c2) OR c3 OR c4 OR c5
      *   |- c1    : DB1.Price Status is Priced
      *   |- c2    : DB1.Price Audit is Manually Price Audited
      *   |- c3    : PAR.Pricing Event Called From is Market Group Change
      *   |- c4    : PAR.Pricing Event Called From is Customer/Item Chang
      *   |- c5    : PAR.Pricing Event Called From is Item Change
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WEU1ST    IFEQ 'P'                        *IF
     C           WEU0ST    IFEQ 'M'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           P2PECF    IFEQ 'MGC'                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           P2PECF    IFEQ 'CIC'                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           P2PECF    IFEQ 'IC'                       *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'99'      WN0149           Event Called Fr
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'AO'      WN0149           Event Called Fr
     C                     END                             *FI
      * CLC Price Item         XF - Price Method Header  * 
     C                     CALL 'PDG9XFR'              90  CLC Price Item
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WEAIC3    WQ0046  30       Company Number
     C                     PARM WEQ7CD    WQ0047  3        Price Method Co
     C                     PARM WEBKC7    WQ0048  70       Ship To Custome
     C                     PARM WEGNDT    WQ0049  70       Actual Shipped
     C                     PARM WEAGCD    WQ0050  2        U/M - Ordered
     C                     PARM WEAVQT    WQ0051 112       Quantity Ordere
     C                     PARM WEA5DT    WQ0052  70       Requested Ship
     C           WN0142    PARM WN0142    WQ0053 114       Unit Price
     C           WN0144    PARM WN0144    WQ0054 114       Unit Price Orde
     C                     PARM WEHGCD    WQ0055  70       Item Code
     C                     PARM WAA0DT    WQ0056  70       Date of Orig. E
     C                     PARM WELQCD    WQ0057  3        Commodity Marke
     C                     PARM WEEXDT    WQ0058  70       Market Pricing
     C           WN0138    PARM WN0138    WQ0059  1        Price Status
     C                     PARM WERDCD    WQ0060  3        Date Method Cod
     C                     PARM WEBZPR    WQ0061 114       Price Overage O
     C           WN0139    PARM WN0139    WQ0062  70       Pricing Date Us
     C                     PARM WN0149    WQ0063  2        Event Called Fr
     C                     PARM WEDWPR    WQ0064 114       OD Ceiling Pric
     C                     PARM WETKDT    WQ0065  70       OD Market Begin
     C                     PARM WETLDT    WQ0066  70       OD Market Endin
     C                     PARM WEC4NB    WQ0067  70       Order Number
     C                     PARM WAEIDT    WQ0068  70       Requested Deliv
     C                     PARM WEDPNB    WQ0069  30       Order Sequence
     C                     PARM WEUENB    WQ0070  30       Order Secondary
     C           WUWZST    PARM WUWZST    WQ0071  5        Error Return
     C                     PARM 'S'       WQ0072  1        Price Type Stat
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDG9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * RMC 6/17/09 FP1054 pass qty/wgt ordered
      *
     C                     MOVEL*BLANK    WN0150  2        UOM Pricing
     C                     Z-ADD*ZERO     WN0151 112       Unit Weight
     C                     MOVEL*BLANK    WN0152  1        Catch Weight St
     C                     MOVEL*BLANK    WN0153  6        Primal Group Co
     C                     Z-ADD*ZERO     WN0154 114       Price per Pound
     C                     Z-ADD*ZERO     WN0155 112       USR Quantity
     C                     Z-ADD*ZERO     WN0156 112       USR Weight
      *
      * CLC Price,Ext,U/M1Prc  IF
      * *****************************************************************
      * Calculate "Price Per Pound", "Extended Amount", "Primary U/M Pric
      * *****************************************************************
     C                     Z-ADD*ZERO     WN0151           Unit Weight
     C                     MOVEL*BLANK    WN0150           UOM Pricing
     C                     MOVEL*BLANK    WN0152           Catch Weight St
      * Load Quantity Shipped Total field. c2742- do -0- shipped from ord
      * CASE: PAR.Quantity Shipped Total is Equal to zero
     C           WECBQT    IFEQ 0                          *IF
     C                     Z-ADD1         WUCBQT           Quantity Shippe
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWECBQT    WUCBQT           Quantity Shippe
     C                     END                             *FI
      * Set quantity and weight according to order status  c2742 -0- shpe
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Detail Line Status is Avail/Alloc/Enter/Hold
      *   |- c2    : PAR.Event Code is Entered Thru 03 Picked
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WEGMST    IFEQ 'L'                        *IF
     C           WEGMST    OREQ 'A'
     C           WEGMST    OREQ 'E'
     C           WEGMST    OREQ 'H'
     C           WEJPCD    IFGE '01'                       *IF
     C           WEJPCD    ANDLE'03'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RMC 6/17/09 FP1054 use qty/wgt ordered instead of sched
     C                     Z-ADDWEAVQT    WN0155           USR Quantity
     C                     Z-ADDWED0WG    WN0156           USR Weight
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWUCBQT    WN0155           USR Quantity
     C                     Z-ADDWEATWG    WN0156           USR Weight
     C                     END                             *FI
      * RTV For Price Extent   XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDXRXFR'              90  RTV For Price E
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WEAIC3    WQ0073  30       Company Number
     C                     PARM WEHGCD    WQ0074  70       Item Code
     C           WN0150    PARM *BLANK    WQ0075  2        UOM Pricing
     C           WN0151    PARM *ZERO     WQ0076 112       Unit Weight
     C           WN0152    PARM *BLANK    WQ0077  1        Catch Weight St
     C           WN0153    PARM *BLANK    WQ0078  6        Primal Group Co
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check retrieve Unit Weight & C/W error
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : PGM.*Return code is *Normal
      *   |- c2    : PAR.Catch Weight Status is Y/N Values
      *   |- c3    : PAR.Unit Weight is Not equal zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ *BLANK                     *IF
     C           WN0152    IFEQ 'N'                        *IF
     C           WN0152    OREQ 'Y'
     C           WN0151    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           *ZERO     IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL*ZERO     WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0001           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0001           CD7 Ext Numeric
     C                     END                             *FI
     C                     Z-ADD*ZERO     ZA0002           Order Sequence
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           WEHGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVELWEHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0003           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0003           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVELWN0152    ZA0004           Catch Weight St
     C                     Z-ADD*ZERO     ZA0005           Unit Price
      *
      * Execute message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2EXMCC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR2306' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN   7
     C                     END
      *
     C           W0RTN     IFNE *BLANK
      * Error detected during execution
     C                     SETON                     99    *
     C                     END
      *
     C                     END                             *FI
      * CASE: PAR.Price Method Code is Extended
     C           WEQ7CD    IFEQ 'EXT'                      *IF
     C                     Z-ADDWEBZPR    WN0136           Extended Amount
      * Calculate Unit Price for Extended
      * CASE: PAR.USR Weight is Not equal zero
     C           WN0156    IFNE 0                          *IF
     C           WN0136    DIV  WN0156    WN0142    H      Unit Price
     C                     END                             *FI
      * Calculate Pricing U/M Price for Extended
      * CASE: PAR.USR Quantity is not equal zero
     C           WN0155    IFNE 0                          *IF
     C           WN0136    DIV  WN0155    WN0144    H      Unit Price Orde
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Extend price with unit price credit if not zeros
      * CASE:
      *  - (c1 AND c2 AND c3 AND c5 AND c7)
      *   |- c1    : PAR.Detail Line Status is Avail/Alloc/Enter/Hold
      *   |- c2    : PAR.Event Code is Entered Thru 03 Picked
      *   |- c3    : PAR.Unit Price - Credit is Not Zeros
      *   |- c5    : PAR.Price Audit is Not Manually Price Audit
      *   |- c7    : PAR.Pricing Event Called From is No Price With Credi
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WEGMST    IFEQ 'L'                        *IF
     C           WEGMST    OREQ 'A'
     C           WEGMST    OREQ 'E'
     C           WEGMST    OREQ 'H'
     C           WEJPCD    IFGE '01'                       *IF
     C           WEJPCD    ANDLE'03'
     C           WEALPR    IFNE 0                          *IF
     C           WEU0ST    IFEQ 'A'                        *IF
     C           WEU0ST    OREQ 'N'
     C           WEU0ST    OREQ *BLANK
     C           P2PECF    IFEQ 'OE'                       *IF
     C           P2PECF    OREQ 'PS'
     C           P2PECF    OREQ 'UWC'
     C           P2PECF    OREQ 'UWT'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 07/07/08 PKD Replaced w/consideration for .01 manual price
      * Extend Price using Price Overage Override or Unit Price-Credit
      * CASE: PAR.Price Method Code is Deviated
     C           WEQ7CD    IFEQ 'DEV'                      *IF
      * ----- USE: Price Overage Override
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           WN0136    PARM *ZERO     WQ0079 112       Extended Amount
     C                     PARM WN0150    WQ0080  2        U/M - Base Pric
     C                     PARM WN0155    WQ0081 112       Quantity Shippe
     C                     PARM WN0156    WQ0082 112       Weight Shipped
     C                     PARM WEBZPR    WQ0083 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: Manual & HPB
      *  - c1 AND c2
      *   |- c1    : PAR.Price Method Code is Manual
      *   |- c2    : PAR.Company Organization is High Plains Biodiesel
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WEQ7CD    IFEQ 'MAN'                      *IF
     C           YL0003    IFEQ 'H'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ----- USE: Price Overage Override
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           WN0136    PARM *ZERO     WQ0084 112       Extended Amount
     C                     PARM WN0150    WQ0085  2        U/M - Base Pric
     C                     PARM WN0155    WQ0086 112       Quantity Shippe
     C                     PARM WN0156    WQ0087 112       Weight Shipped
     C                     PARM WEBZPR    WQ0088 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: Manual & Not HPB
      *  - c1 AND c2
      *   |- c1    : PAR.Price Method Code is Manual
      *   |- c2    : PAR.Company Organization is Not HPB
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WEQ7CD    IFEQ 'MAN'                      *IF
     C           YL0003    IFEQ 'D'                        *IF
     C           YL0003    OREQ 'S'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ----- USE: Price Overage Override OR Unit Price-Credit
      * CASE: PS Cst | IC Cst | UNID Itm | OTHER Itm | >.01 Prc
      *  - c1 OR c2 OR c3 OR c4 OR c5
      *   |- c1    : PAR.Type Code is Inter Company
      *   |- c2    : PAR.Type Code is Is Promotional/Samples
      *   |- c3    : PAR.Primal Group Code is Samples or Cut Loss
      *   |- c4    : PAR.Primal Group Code is Other
      *   |- c5    : PAR.Price Overage Override is GT .01
      *   '-
     C           WN0009    IFEQ 'IC'                       *IF
     C           WN0009    OREQ 'PS'                       *OR
     C           WN0153    OREQ 'UNID'                     *OR
     C           WN0153    OREQ 'OTHER'                    *OR
     C           WEBZPR    ORGT .01                        *OR
      * ----- USE: Price Overage Override
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           WN0136    PARM *ZERO     WQ0089 112       Extended Amount
     C                     PARM WN0150    WQ0090  2        U/M - Base Pric
     C                     PARM WN0155    WQ0091 112       Quantity Shippe
     C                     PARM WN0156    WQ0092 112       Weight Shipped
     C                     PARM WEBZPR    WQ0093 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * ----- USE: Unit Price-Credit
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           WN0136    PARM *ZERO     WQ0094 112       Extended Amount
     C                     PARM WN0150    WQ0095  2        U/M - Base Pric
     C                     PARM WN0155    WQ0096 112       Quantity Shippe
     C                     PARM WN0156    WQ0097 112       Weight Shipped
     C                     PARM WEALPR    WQ0098 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * ---- USE: Unit Price-Credit
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           WN0136    PARM *ZERO     WQ0099 112       Extended Amount
     C                     PARM WN0150    WQ0100  2        U/M - Base Pric
     C                     PARM WN0155    WQ0101 112       Quantity Shippe
     C                     PARM WN0156    WQ0102 112       Weight Shipped
     C                     PARM WEALPR    WQ0103 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * 08/28/07 PKD Replaced with Clc OrdDtl Ext Amt    XF
      * 04/28/10 PKD If Unit Price is zero, then use Unit Price-Credit.
      * ** Added Not .01 to force these orders to use Credit Chk Price.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Unit Price is Not Zeros
      *   |- c2    : PAR.Unit Price is Not .01
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0142    IFNE 0                          *IF
     C           WN0142    IFNE .01                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           WN0136    PARM *ZERO     WQ0104 112       Extended Amount
     C                     PARM WN0150    WQ0105  2        U/M - Base Pric
     C                     PARM WN0155    WQ0106 112       Quantity Shippe
     C                     PARM WN0156    WQ0107 112       Weight Shipped
     C                     PARM WN0142    WQ0108 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Unit Price Ordered U/M
      * CASE: PAR.USR Quantity is not equal zero
     C           WN0155    IFNE 0                          *IF
     C           WN0136    DIV  WN0155    WN0144    H      Unit Price Orde
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           WN0136    PARM *ZERO     WQ0109 112       Extended Amount
     C                     PARM WN0150    WQ0110  2        U/M - Base Pric
     C                     PARM WN0155    WQ0111 112       Quantity Shippe
     C                     PARM WN0156    WQ0112 112       Weight Shipped
     C                     PARM WEALPR    WQ0113 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * *****************************************************************
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Warehouse Transfer.
      *================================================================
      * Rtv All Prc Sts/Audit  RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0001           Company Number
     C                     Z-ADDWAC4NB    WL0002           Order Number
     C                     Z-ADD*ZERO     WL0003           Order Sequence
     C                     Z-ADD*ZERO     WL0004           Order Secondary
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    WN0002    P      Price Status
     C                     MOVELWL0006    WN0001    P      Price Audit
     C                     Z-ADDWL0007    WN0012           Shipping Compan
     C                     Z-ADDWL0008    WN0011           Accounting Comp
      * CLC Tot Ord Val Ship   XF - Order Detail  * 
     C                     CALL 'PDP1XFR'              90  CLC Tot Ord Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0165  30       Company Number
     C                     PARM WAC4NB    WQ0166  70       Order Number
     C           WN0005    PARM WN0005    WQ0167 112       USR Order Value
     C           WN0004    PARM WN0004    WQ0168 112       USR Order Weigh
     C           P3XJST    PARM P3XJST    WQ0169  1        USR Production
     C           WUR4ST    PARM WUR4ST    WQ0170  1        USR Update Flag
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDP1XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CHG Order Price/PrcAud CH - PD Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0041           Company Number
     C                     Z-ADDWAC4NB    WL0042           Order Number
     C                     Z-ADDWN0005    WL0043           Order Value Tot
     C                     Z-ADDWN0004    WL0044           Order Weight To
     C                     Z-ADDWAEIDT    WL0045           Requested Deliv
     C                     MOVELWAU0ST    WL0046    P      Price Audit
     C                     MOVELWN0002    WL0047    P      Price Status
     C                     MOVELWAZ1ST    WL0048    P      Modified Flag
     C                     Z-ADDWN0005    WL0049           A/R order Value
     C                     EXSR SUCHRC
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P3JZVA           Order Value Tot
     C                     Z-ADD*ZERO     P3A1WG           Order Weight To
     C                     MOVEL*BLANK    P3XJST           Production Hold
     C                     MOVEL*BLANK    P4W7ST           USR New Order
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAANC7           AR Customer Num
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WAA0DT           Order Date
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WAACDT           Cancel Date
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WAJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WAA1WG           Order Weight To
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WATBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WAATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WARSRN           Resell Referenc
     C                     Z-ADD*ZERO     WAT3NB           Attach to Order
     C                     Z-ADD*ZERO     WACONB           Invoice Number
     C                     Z-ADD*ZERO     WAAWDT           Invoice Date
     C                     Z-ADD*ZERO     WAVRVA           A/R order Value
     C                     Z-ADD*ZERO     WAB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WANODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WANPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WANQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WANRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WANSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WABPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WABQTM           Time of Origina
     C                     Z-ADD*ZERO     WABRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WABSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WABTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WAH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WAH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WAH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WAH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WAH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WAC0C7           Claim Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBR5NB           Deliver after t
     C                     Z-ADD*ZERO     WBR6NB           Deliver before
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBMTCU           Mileage To Cust
     C                     Z-ADD*ZERO     WBW2NB           Co/Cust Overage
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCDPNB           Order Sequence
     C                     Z-ADD*ZERO     WCUENB           Order Secondary
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WCMAVA           Billing Detail
     C                     Z-ADD*ZERO     WCKDVA           Billing Detail
     C                     Z-ADD*ZERO     WCL8VA           Billing Detail
     C                     Z-ADD*ZERO     WCL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WCAYVA           Extended Amount
     C                     Z-ADD*ZERO     WCEXDT           Market Pricing
     C                     Z-ADD*ZERO     WCBZPR           Price Overage O
     C                     Z-ADD*ZERO     WCL6NB           Contract Number
     C                     Z-ADD*ZERO     WCGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WCD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WCCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WCAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WCCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WCATWG           Weight Shipped
     C                     Z-ADD*ZERO     WCAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WCAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WCAKPR           Unit Price
     C                     Z-ADD*ZERO     WCALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WCAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WCAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WCA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WCA5DT           Requested Ship
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WCRGNB           Item Structure
     C                     Z-ADD*ZERO     WCRHNB           Item Structure
     C                     Z-ADD*ZERO     WCRINB           Item Structure
     C                     Z-ADD*ZERO     WCCXDT           Date of Origina
     C                     Z-ADD*ZERO     WCDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WCB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WCA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WCNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WCNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WCNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WCNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WCNXDT           OD Firm Date
     C                     Z-ADD*ZERO     WCBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WCBVTM           Price Code
     C                     Z-ADD*ZERO     WCBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WCBXTM           Substitution Li
     C                     Z-ADD*ZERO     WCBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WCH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WCH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WCH7NX           OD Item Target
     C                     Z-ADD*ZERO     WCH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WCH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WCDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WCDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WCDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WCDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WCDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WCGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WCGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WCGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WCPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WCRINY           Item Age Days
     C                     Z-ADD*ZERO     WCTIDT           Production Ovr
     C                     Z-ADD*ZERO     WCTJDT           Production Ovr
     C                     Z-ADD*ZERO     WCTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WCTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WCTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WDBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WDBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WDBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WDBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFXXTM           Departure Time
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Define work field Quantity Shipped Total
     C                     Z-ADD*ZERO     WUCBQT 112
      * Define work field Error Return
     C                     MOVEL*BLANK    WUWZST  5
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Price Audit
     C                     MOVEL*BLANK    WUU0ST  1
      * Define work field Price Method Type
     C                     MOVEL*BLANK    WUV8ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHRMNY           Decimal Places
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Define work field Default Commod Mark basis
     C                     MOVEL*BLANK    WULNCD  3
      * Define work field Maximum Audit Value
     C                     Z-ADD*ZERO     WUTMVA 112
      * Define work field Minimum Audit Value
     C                     Z-ADD*ZERO     WUTNVA 112
      * Define work field Commodity Price Group
     C                     MOVEL*BLANK    WULRCD  7
      * Define work field Description Line One
     C                     MOVEL*BLANK    WUAVNA 30
      * Define work field Std Weight_Head_Var_Ren
     C                     Z-ADD*ZERO     WUSWGH 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIHGCD           Item Code
     C                     Z-ADD*ZERO     WIAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WIAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WIAIWG           Unit Weight
     C                     Z-ADD*ZERO     WICZWG           Minimum Weight
     C                     Z-ADD*ZERO     WIC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WIURTN           Number Cases On
     C                     Z-ADD*ZERO     WIAJC8           Vendor Item Def
     C                     Z-ADD*ZERO     WIRINB           Item Structure
     C                     Z-ADD*ZERO     WIRHNB           Item Structure
     C                     Z-ADD*ZERO     WIRGNB           Item Structure
     C                     Z-ADD*ZERO     WITFNB           Transportation
     C                     Z-ADD*ZERO     WITMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WITNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WIBLPR           Market Overage
     C                     Z-ADD*ZERO     WIBMPR           Standard Overag
     C                     Z-ADD*ZERO     WICMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WICHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WISWGH           Std Weight_Head
     C                     Z-ADD*ZERO     WIPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WIICN1           Item Category N
     C                     Z-ADD*ZERO     WIICN2           Item Category N
     C                     Z-ADD*ZERO     WIV2NB           Item Category N
     C                     Z-ADD*ZERO     WIITCN           Item Category N
     C                     Z-ADD*ZERO     WIITC5           Item Category N
     C                     Z-ADD*ZERO     WIICN6           Item Category N
     C                     Z-ADD*ZERO     WIICN7           Item Category N
     C                     Z-ADD*ZERO     WIICN8           Item Category N
     C                     Z-ADD*ZERO     WIICN9           Item Category N
     C                     Z-ADD*ZERO     WIICN0           Item Category N
     C                     Z-ADD*ZERO     WISFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WIA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WISJNB           Production Lead
     C                     Z-ADD*ZERO     WISKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WISLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WISMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WICFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WICGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WIILNB           Packages per ca
     C                     Z-ADD*ZERO     WICHNB           Use_Freeze_Sell
     C                     Z-ADD*ZERO     WICINB           PM Batch Size
     C                     Z-ADD*ZERO     WICJNB           Package Level s
     C                     Z-ADD*ZERO     WICMNB           Partial Item Co
     C                     Z-ADD*ZERO     WICNNB           WIP Item Code
     C                     Z-ADD*ZERO     WICRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WICSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WICVNB           FP Std Green We
     C                     Z-ADD*ZERO     WICWNB           PM Std LBS Man
     C                     Z-ADD*ZERO     WICXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WICZNB           PM Formula LBS
     C                     Z-ADD*ZERO     WIC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WIB4NB           PM Raw Material
     C                     Z-ADD*ZERO     WIB5NB           PM Line Number
     C                     Z-ADD*ZERO     WIBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WIBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WIF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WIF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WIF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WIBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WIBNNB           Production Qty
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Define work field Projected Market Price
     C                     Z-ADD*ZERO     WUB8PR 114
      * Define work field Error Status  3
     C                     MOVEL*BLANK    WUTXST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJAXNB           Current Account
     C                     Z-ADD*ZERO     WJNGNB           Current Account
     C                     Z-ADD*ZERO     WJBZNB           OM Week
     C                     Z-ADD*ZERO     WJC5NB           Next Order Numb
     C                     Z-ADD*ZERO     WJC3NB           Next Invoice Nu
     C                     Z-ADD*ZERO     WJCYNB           Next Credit Mem
     C                     Z-ADD*ZERO     WJIONB           Next Charge Bac
     C                     Z-ADD*ZERO     WJI6NB           Next On Acct Ca
     C                     Z-ADD*ZERO     WJDCNB           Next Voucher Nu
     C                     Z-ADD*ZERO     WJC7NB           Next Customer #
     C                     Z-ADD*ZERO     WJC2NB           Next Inventory
     C                     Z-ADD*ZERO     WJC1NB           Next PFS Batch
     C                     Z-ADD*ZERO     WJL8NB           Next Contract/P
     C                     Z-ADD*ZERO     WJBANB           Next HPB Batch
     C                     Z-ADD*ZERO     WJAIPC           Manual Price Ac
     C                     Z-ADD*ZERO     WJASPC           CoPk/FdSrv ManP
     C                     Z-ADD*ZERO     WJA2VA           Late Charge Min
     C                     Z-ADD*ZERO     WJAADY           A/P Aging Days
     C                     Z-ADD*ZERO     WJABDY           A/P Aging Days
     C                     Z-ADD*ZERO     WJACDY           A/P Aging Days
     C                     Z-ADD*ZERO     WJADDY           A/P Aging Days
     C                     Z-ADD*ZERO     WJAEDY           A/R Aging Days
     C                     Z-ADD*ZERO     WJAFDY           A/R Aging Days
     C                     Z-ADD*ZERO     WJAGDY           A/R Aging Days
     C                     Z-ADD*ZERO     WJAHDY           A/R Aging Days
     C                     Z-ADD*ZERO     WJAENB           Retention Perio
     C                     Z-ADD*ZERO     WJALNB           Retention Perio
     C                     Z-ADD*ZERO     WJEVNB           Retention Perio
     C                     Z-ADD*ZERO     WJRPOP           Retention Perio
     C                     Z-ADD*ZERO     WJDWNB           Retention Perio
     C                     Z-ADD*ZERO     WJR3NB           Next Load ID
     C                     Z-ADD*ZERO     WJR4NB           Next Item Numbe
     C                     Z-ADD*ZERO     WJSCNB           Production Numb
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Define work field USR Date Priced
     C                     Z-ADD*ZERO     WUE7DT  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKEQDT           Market Price Da
     C                     Z-ADD*ZERO     WKA5PR           Commodity Marke
     C                     Z-ADD*ZERO     WKB8PR           Projected Marke
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Define work field USR Sequence Num. New ATR
     C                     Z-ADD*ZERO     WUQQNB  30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLAIC3           Company Number
     C                     Z-ADD*ZERO     WLC4NB           Order Number
     C                     Z-ADD*ZERO     WLDPNB           Order Sequence
     C                     Z-ADD*ZERO     WLUENB           Order Secondary
     C                     Z-ADD*ZERO     WLASNO           Audit Sequence
     C                     Z-ADD*ZERO     WLHGCD           Item Code
     C                     Z-ADD*ZERO     WLAYVA           Extended Amount
     C                     Z-ADD*ZERO     WLYJVA           Extended Amount
     C                     Z-ADD*ZERO     WLAKPR           Unit Price
     C                     Z-ADD*ZERO     WLDBPR           Unit Price Last
     C                     Z-ADD*ZERO     WLALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WLDCPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Clear all neither parameters
      * CRT Price Change Audit CR - PD Price Change Audit Log  * 
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Define work field Affect Inventory Default
     C                     MOVEL*BLANK    WUOEST  1
      * Define work field Affect Sales Doll Default
     C                     MOVEL*BLANK    WUOFST  1
      * Define work field Affect Sales Pnds Default
     C                     MOVEL*BLANK    WUVBST  1
      * Define work field Affect Brokerage Default
     C                     MOVEL*BLANK    WUPYST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WRAATM           Job Time
     C                     Z-ADD*ZERO     WRAXDT           Job Date
      * Define work field Order Value Total
     C                     Z-ADD*ZERO     WUJZVA 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WSAIC3           Company Number
     C                     Z-ADD*ZERO     WSANC7           AR Customer Num
     C                     Z-ADD*ZERO     WSAGVA           Age $ Due - Cur
     C                     Z-ADD*ZERO     WSACVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WSADVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WSAEVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WSAFVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WSAHVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WSVIVA           Age $ Due-Curre
     C                     Z-ADD*ZERO     WSVJVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WSVKVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WSVLVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WSVMVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WSVNVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WSEEVA           Value of Open O
     C                     Z-ADD*ZERO     WSAKTM           Time of Last Ag
     C                     Z-ADD*ZERO     WSAHDT           Date of First S
     C                     Z-ADD*ZERO     WSANDT           Date of Last Sh
     C                     Z-ADD*ZERO     WSANVA           Amount of Last
     C                     Z-ADD*ZERO     WSALDT           Date of Last Pa
     C                     Z-ADD*ZERO     WSAMVA           Amount of Last
     C                     Z-ADD*ZERO     WSAIDT           Date of Highest
     C                     Z-ADD*ZERO     WSALVA           Amount of Highe
     C                     Z-ADD*ZERO     WSDJNB           Number of Invoi
     C                     Z-ADD*ZERO     WSDLNB           Number of Order
     C                     Z-ADD*ZERO     WSDDNB           Number of Credi
     C                     Z-ADD*ZERO     WSDMNB           Number of Payme
     C                     Z-ADD*ZERO     WSDUDT           Date of Last Ag
     C                     Z-ADD*ZERO     WSLYNO           Last YTD Nbr of
     C                     Z-ADD*ZERO     WSLYNC           Last YTD Nbr of
     C                     Z-ADD*ZERO     WSLYNP           Last YTD Nbr of
     C                     Z-ADD*ZERO     WSLYNI           Last YTD Nbr of
     C                     Z-ADD*ZERO     WSADPM           MTD Invoices Pa
     C                     Z-ADD*ZERO     WSVOVA           YTD Invoices Pa
     C                     Z-ADD*ZERO     WSBTDY           MTD Days Paid
     C                     Z-ADD*ZERO     WSBUDY           YTD Days Paid
     C                     Z-ADD*ZERO     WSVPVA           YTD Sales Invoi
     C                     Z-ADD*ZERO     WSVQVA           Last Year Sales
     C                     Z-ADD*ZERO     WSCUMO           Current Month
     C                     Z-ADD*ZERO     WSAATM           Job Time
     C                     Z-ADD*ZERO     WSAXDT           Job Date
      * Clear all neither parameters
      * CRT A/R Summary        CR - A/R Summary  * 
     C                     Z-ADD*ZERO     WTAATM           Job Time
     C                     Z-ADD*ZERO     WTAXDT           Job Date
      * Define work field USR Update Flag
     C                     MOVEL*BLANK    WUR4ST  1
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field Total Load Order Weight
     C                     Z-ADD*ZERO     WURPNB  70
      * Define work field Total Freight
     C                     Z-ADD*ZERO     WURQNB 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WWB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WWY4NY           EDI Alt ST Cust
     C                     Z-ADD*ZERO     WWY5NY           EDI unused nbr
     C                     Z-ADD*ZERO     WWMJDT           Create Date
     C                     Z-ADD*ZERO     WWBETM           Create Time
     C                     Z-ADD*ZERO     WWMKDT           Change Date
     C                     Z-ADD*ZERO     WWBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WXAIC3           Company Number
     C                     Z-ADD*ZERO     WXC4NB           Order Number
     C                     Z-ADD*ZERO     WXRMNB           Load ID
     C                     Z-ADD*ZERO     WXRUNB           Stop_Drop Seque
     C                     Z-ADD*ZERO     WXQWDT           OHE Sail/Flight
     C                     Z-ADD*ZERO     WXQXDT           OHE Port Cut Da
     C                     Z-ADD*ZERO     WXQYDT           OHE Arrival Dat
     C                     Z-ADD*ZERO     WXGINY           OHE Unused Numb
     C                     Z-ADD*ZERO     WXGFNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WXGGNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WXGHNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WXHEVL           OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WXHFVL           OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WXHGVL           Transload Termi
     C                     Z-ADD*ZERO     WXQZDT           OHE Est Arrv at
     C                     Z-ADD*ZERO     WXQ0DT           OHE Backhaul ET
     C                     Z-ADD*ZERO     WXQ1DT           OHE Port/Pier P
     C                     Z-ADD*ZERO     WXQ2DT           OHE Actual Ship
     C                     Z-ADD*ZERO     WXITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WXQJNY           OHE Backhaul Re
     C                     Z-ADD*ZERO     WXQKNY           LD Stop/Drop
     C                     Z-ADD*ZERO     WXQLNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WXP8NY           OHE Pier Pass F
     C                     Z-ADD*ZERO     WXP9NY           OHE Port Check
     C                     Z-ADD*ZERO     WXQANY           OHE Port Cut Ti
     C                     Z-ADD*ZERO     WXQCNY           OHE Backhaul Tr
     C                     Z-ADD*ZERO     WXQDNY           OHE Load Sched
     C                     Z-ADD*ZERO     WXQENY           Original Appoin
     C                     Z-ADD*ZERO     WXQFNY           Original Appoin
     C                     Z-ADD*ZERO     WXQGNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WXQHNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WXQINY           OHE Unused Nume
     C                     Z-ADD*ZERO     WXQMNY           OHE Orig ABS Fr
     C                     Z-ADD*ZERO     WXW5DT           OHE Unused Date
     C                     Z-ADD*ZERO     WXW6DT           OHE Unused Date
     C                     Z-ADD*ZERO     WXAATM           Job Time
     C                     Z-ADD*ZERO     WXAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WYTSCN           ST02-TRANS SET
     C                     Z-ADD*ZERO     WYOSDT           G5002-ORDER DAT
     C                     Z-ADD*ZERO     WYHUVL           SAC05-$$ AMT OF
     C                     Z-ADD*ZERO     WYT6DT           G6202 Ship Date
     C                     Z-ADD*ZERO     WYDELV           G6202-DELIVERY
     C                     Z-ADD*ZERO     WYD3VL           G7601-QUANTITY
     C                     Z-ADD*ZERO     WYD4VL           G7603-WEIGHT OR
     C                     Z-ADD*ZERO     WYAMTX           G7608-ORDER AMO
     C                     Z-ADD*ZERO     WYUFDT           POH Date Stamp
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WB01 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB02 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB00 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     Z-ADD*ZERO     WL0003  30
     C                     Z-ADD*ZERO     WL0004  30
     C                     MOVEL*BLANK    WL0005  1
     C                     MOVEL*BLANK    WL0006  1
     C                     Z-ADD*ZERO     WL0007  30
     C                     Z-ADD*ZERO     WL0008  30
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0009  30
     C                     MOVEL*BLANK    WL0010  1
     C                     MOVEL*BLANK    WL0011  1
      * Define local variables for subroutine SGCHRC.
     C                     Z-ADD*ZERO     WL0012  30
     C                     Z-ADD*ZERO     WL0013  70
     C                     Z-ADD*ZERO     WL0014  30
     C                     Z-ADD*ZERO     WL0015  30
     C                     Z-ADD*ZERO     WL0016 112
     C                     Z-ADD*ZERO     WL0017 112
     C                     MOVEL*BLANK    WL0018  1
     C                     Z-ADD*ZERO     WL0019  70
     C                     MOVEL*BLANK    WL0020  1
     C                     MOVEL*BLANK    WL0021  3
     C                     Z-ADD*ZERO     WL0022 114
     C                     Z-ADD*ZERO     WL0023 114
     C                     Z-ADD*ZERO     WL0024 114
     C                     Z-ADD*ZERO     WL0025 112
     C                     Z-ADD*ZERO     WL0026  70
     C                     MOVEL*BLANK    WL0027  1
     C                     MOVEL*BLANK    WL0028  1
     C                     MOVEL*BLANK    WL0029  1
      * Define local variables for subroutine SLRVGN.
     C                     Z-ADD*ZERO     WL0030  30
     C                     Z-ADD*ZERO     WL0031  52
     C                     Z-ADD*ZERO     WL0032  52
      * Define local variables for subroutine SMRVGN.
     C                     MOVEL*BLANK    WL0033  3
     C                     MOVEL*BLANK    WL0034  7
     C                     Z-ADD*ZERO     WL0035  70
     C                     Z-ADD*ZERO     WL0036 114
     C                     Z-ADD*ZERO     WL0037  70
      * Define local variables for subroutine SRRVGN.
     C                     Z-ADD*ZERO     WL0038  30
     C                     Z-ADD*ZERO     WL0039  70
     C                     Z-ADD*ZERO     WL0040 112
      * Define local variables for subroutine SUCHRC.
     C                     Z-ADD*ZERO     WL0041  30
     C                     Z-ADD*ZERO     WL0042  70
     C                     Z-ADD*ZERO     WL0043 112
     C                     Z-ADD*ZERO     WL0044 112
     C                     Z-ADD*ZERO     WL0045  70
     C                     MOVEL*BLANK    WL0046  1
     C                     MOVEL*BLANK    WL0047  1
     C                     MOVEL*BLANK    WL0048  1
     C                     Z-ADD*ZERO     WL0049 112
      * Define local variables for subroutine SWRVGN.
     C                     Z-ADD*ZERO     WL0050  70
     C                     MOVEL*BLANK    WL0051  6
     C                     MOVEL*BLANK    WL0052  6
     C                     MOVEL*BLANK    WL0053  6
      * Define null work field Plant Company Sts
     C                     MOVEL*BLANK    YN0001  1
      * Define null work field UOM Pricing
     C                     MOVEL*BLANK    YN0002  2
      * Define null work field Unit Weight
     C                     Z-ADD*ZERO     YN0003 112
      * Define null work field Catch Weight Status
     C                     MOVEL*BLANK    YN0004  1
      * Define local work field Price Method Type
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field PMH Price Type
     C                     MOVEL*BLANK    YL0002  1
      * Define null work field Plant Company Sts
     C                     MOVEL*BLANK    YN0005  1
      * Define local work field Company Organization
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field Decimal Places Rounded
     C                     Z-ADD*ZERO     YL0004  20
      * Define local work field PMH Price Type
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field Default Commod Mark basis
     C                     MOVEL*BLANK    YL0006  3
      * Define local work field Market Overage
     C                     Z-ADD*ZERO     YL0007 114
      * Define local work field Standard Overage_Underage
     C                     Z-ADD*ZERO     YL0008 114
      * Define local work field Commodity Price Group
     C                     MOVEL*BLANK    YL0009  7
      * Define local work field Primal Group Code
     C                     MOVEL*BLANK    YL0010  6
      * Define local work field Type Code
     C                     MOVEL*BLANK    YL0011  2
      * Define null work field Absorbed Freight Rate CWT
     C                     Z-ADD*ZERO     YN0006  52
      * Define local work field Minimum Price   USR
     C                     Z-ADD*ZERO     YL0012 114
      * Define local work field Maximum Price  USR
     C                     Z-ADD*ZERO     YL0013 114
      * Define local work field Price Audit
     C                     MOVEL*BLANK    YL0014  1
      * Define null work field UOM Pricing
     C                     MOVEL*BLANK    YN0007  2
      * Define null work field Unit Weight
     C                     Z-ADD*ZERO     YN0008 112
      * Define null work field Catch Weight Status
     C                     MOVEL*BLANK    YN0009  1
      * Define local work field Trans Type 1 PASS     USR
     C                     MOVEL*BLANK    YL0015  2
      * Define local work field EDI Process Flag
     C                     MOVEL*BLANK    YL0016  1
      * Define null work field Order Type - Sales
     C                     MOVEL*BLANK    YN0010  2
      * Define local work field AR Customer Number
     C                     Z-ADD*ZERO     YL0017  70
      * Define null work field Ship To Customer
     C                     Z-ADD*ZERO     YN0011  70
      * Define null work field Ship To Name
     C                     MOVEL*BLANK    YN0012 30
      * Define null work field Ship To Address Line 1
     C                     MOVEL*BLANK    YN0013 30
      * Define null work field Ship To Address Line 2
     C                     MOVEL*BLANK    YN0014 30
      * Define null work field Ship To Address Line 3
     C                     MOVEL*BLANK    YN0015 30
      * Define null work field Ship To City
     C                     MOVEL*BLANK    YN0016 20
      * Define null work field Ship To State Code
     C                     MOVEL*BLANK    YN0017  2
      * Define null work field Ship To Zip/Postal Code
     C                     MOVEL*BLANK    YN0018 11
      * Define null work field Bill to Customer
     C                     Z-ADD*ZERO     YN0019  70
      * Define null work field Bill to Name
     C                     MOVEL*BLANK    YN0020 30
      * Define null work field Bill to Address Line 1
     C                     MOVEL*BLANK    YN0021 30
      * Define null work field Bill to Address Line 2
     C                     MOVEL*BLANK    YN0022 30
      * Define null work field Bill to Address Line 3
     C                     MOVEL*BLANK    YN0023 30
      * Define null work field Bill to City
     C                     MOVEL*BLANK    YN0024 20
      * Define null work field Bill to State Code
     C                     MOVEL*BLANK    YN0025  2
      * Define null work field Bill to Zip/Postal Code
     C                     MOVEL*BLANK    YN0026 11
      * Define local work field Customer Purchase Order #
     C                     MOVEL*BLANK    YL0018 15
      * Define null work field Order Date
     C                     Z-ADD*ZERO     YN0027  70
      * Define null work field Requested Ship Date
     C                     Z-ADD*ZERO     YN0028  70
      * Define null work field Actual Shipped Date
     C                     Z-ADD*ZERO     YN0029  70
      * Define null work field Cancel Date
     C                     Z-ADD*ZERO     YN0030  70
      * Define null work field Terms Code
     C                     MOVEL*BLANK    YN0031  2
      * Define null work field Special Instructions
     C                     MOVEL*BLANK    YN0032 40
      * Define null work field Special Instructions 2
     C                     MOVEL*BLANK    YN0033 40
      * Define null work field Carrier Code
     C                     MOVEL*BLANK    YN0034  3
      * Define null work field Comment Print Acknowledge
     C                     MOVEL*BLANK    YN0035  1
      * Define null work field Comment Print Inv/Cr.Memo
     C                     MOVEL*BLANK    YN0036  1
      * Define null work field Comment Print Pick Slip
     C                     MOVEL*BLANK    YN0037  1
      * Define null work field Comment Print Ship Doc
     C                     MOVEL*BLANK    YN0038  1
      * Define null work field Reason Code
     C                     MOVEL*BLANK    YN0039  3
      * Define null work field Order in Use
     C                     MOVEL*BLANK    YN0040  1
      * Define null work field Header Status
     C                     MOVEL*BLANK    YN0041  1
      * Define null work field Header Status Last
     C                     MOVEL*BLANK    YN0042  1
      * Define null work field Order Type Print Status
     C                     MOVEL*BLANK    YN0043  1
      * Define null work field Scheduled Ship Date
     C                     Z-ADD*ZERO     YN0044  70
      * Define null work field User Original Entry
     C                     MOVEL*BLANK    YN0045 10
      * Define null work field Date of Original Entry
     C                     Z-ADD*ZERO     YN0046  70
      * Define null work field Order Value Total
     C                     Z-ADD*ZERO     YN0047 112
      * Define null work field Order Weight Total
     C                     Z-ADD*ZERO     YN0048 112
      * Define null work field Credit Hold
     C                     MOVEL*BLANK    YN0049  1
      * Define null work field Production Hold
     C                     MOVEL*BLANK    YN0050  1
      * Define null work field New Customer Hold
     C                     MOVEL*BLANK    YN0051  1
      * Define null work field Requested Delivery Date
     C                     Z-ADD*ZERO     YN0052  70
      * Define null work field Requested Delivery Time
     C                     Z-ADD*ZERO     YN0053  40
      * Define null work field Accounts Receiv. Ent 1
     C                     MOVEL*BLANK    YN0054  4
      * Define null work field Accounts Receiv. Ent 2
     C                     MOVEL*BLANK    YN0055 12
      * Define null work field Load ID
     C                     Z-ADD*ZERO     YN0056  70
      * Define null work field Absorbed Freight Rate CWT
     C                     Z-ADD*ZERO     YN0057  52
      * Define null work field Rated Freight
     C                     Z-ADD*ZERO     YN0058 112
      * Define null work field LTL Flag
     C                     MOVEL*BLANK    YN0059  1
      * Define null work field Price Audit
     C                     MOVEL*BLANK    YN0060  1
      * Define local work field Price Status
     C                     MOVEL*BLANK    YL0019  1
      * Define null work field Shipping Method
     C                     MOVEL*BLANK    YN0061  2
      * Define null work field Export Status
     C                     MOVEL*BLANK    YN0062  1
      * Define null work field Palletize
     C                     MOVEL*BLANK    YN0063  1
      * Define null work field Shrink Wrap
     C                     MOVEL*BLANK    YN0064  1
      * Define null work field Slip Sheet
     C                     MOVEL*BLANK    YN0065  1
      * Define null work field Age Code
     C                     MOVEL*BLANK    YN0066  1
      * Define null work field Reefer Temperature
     C                     Z-ADD*ZERO     YN0067  52
      * Define null work field Load Type
     C                     MOVEL*BLANK    YN0068  1
      * Define null work field Attach to Invoice Number
     C                     Z-ADD*ZERO     YN0069  70
      * Define null work field Load Plan Order
     C                     MOVEL*BLANK    YN0070  1
      * Define null work field Print Pick Slip
     C                     MOVEL*BLANK    YN0071  1
      * Define null work field Resell Reference Number
     C                     Z-ADD*ZERO     YN0072  70
      * Define null work field Special Comment 1
     C                     MOVEL*BLANK    YN0073 30
      * Define null work field Special Comment 2
     C                     MOVEL*BLANK    YN0074 30
      * Define null work field Affect Auto Accruals
     C                     MOVEL*BLANK    YN0075  1
      * Define null work field Sales Route Code
     C                     MOVEL*BLANK    YN0076  3
      * Define null work field Manager Level Code
     C                     MOVEL*BLANK    YN0077  2
      * Define null work field VP Level Code
     C                     MOVEL*BLANK    YN0078  3
      * Define null work field Attach to Order Number
     C                     Z-ADD*ZERO     YN0079  70
      * Define null work field Reason for Price Audit
     C                     MOVEL*BLANK    YN0080  3
      * Define null work field Invoice Number
     C                     Z-ADD*ZERO     YN0081  70
      * Define null work field Invoice Suffix
     C                     MOVEL*BLANK    YN0082  2
      * Define null work field Invoice Date
     C                     Z-ADD*ZERO     YN0083  70
      * Define null work field Event Code
     C                     MOVEL*BLANK    YN0084  2
      * Define null work field Trans Contol AS400_Plant
     C                     MOVEL*BLANK    YN0085  1
      * Define null work field Modified Flag
     C                     MOVEL*BLANK    YN0086  1
      * Define null work field A/R order Value Total
     C                     Z-ADD*ZERO     YN0087 112
      * Define null work field Billing Activity Type
     C                     MOVEL*BLANK    YN0088  1
      * Define null work field Block Order Flag
     C                     MOVEL*BLANK    YN0089  1
      * Define null work field Order Certification Flag
     C                     MOVEL*BLANK    YN0090  1
      * Define null work field Invoice Order Value Tot
     C                     Z-ADD*ZERO     YN0091 112
      * Define null work field Process Sts for 3C
     C                     MOVEL*BLANK    YN0092  1
      * Define null work field Order Conf Fax Sts
     C                     MOVEL*BLANK    YN0093  1
      * Define null work field Manifest Fax Sts
     C                     MOVEL*BLANK    YN0094  1
      * Define null work field Invoice Fax Sts
     C                     MOVEL*BLANK    YN0095  1
      * Define null work field Transfer in Storage Ind
     C                     MOVEL*BLANK    YN0096  1
      * Define null work field Email Cust On Order Ship
     C                     MOVEL*BLANK    YN0097  1
      * Define null work field Order Emailed
     C                     MOVEL*BLANK    YN0098  1
      * Define null work field Export Docs Go w/Driver
     C                     MOVEL*BLANK    YN0099  1
      * Define null work field Shipping Temp Code C/F
     C                     MOVEL*BLANK    YN0100  1
      * Define null work field Broker Order Status
     C                     MOVEL*BLANK    YN0101  1
      * Define null work field Air Freight Order
     C                     MOVEL*BLANK    YN0102  1
      * Define null work field Order Requires Review
     C                     MOVEL*BLANK    YN0103  2
      * Define null work field OH Load Plan Ready
     C                     MOVEL*BLANK    YN0104  2
      * Define null work field Export USDA Approved
     C                     MOVEL*BLANK    YN0105  2
      * Define null work field HPB Ship to Warehouse
     C                     MOVEL*BLANK    YN0106  3
      * Define null work field OH TF Exempt Code
     C                     MOVEL*BLANK    YN0107  3
      * Define null work field OH Appt Confirmation Dt
     C                     Z-ADD*ZERO     YN0108  70
      * Define null work field JPN Invoice Issuance Date
     C                     Z-ADD*ZERO     YN0109  70
      * Define null work field Load Actual Shipped Date
     C                     Z-ADD*ZERO     YN0110  70
      * Define null work field Load BOL Complete Date
     C                     Z-ADD*ZERO     YN0111  70
      * Define null work field Load Truck Departure Date
     C                     Z-ADD*ZERO     YN0112  70
      * Define null work field Maximum Gross Weight
     C                     Z-ADD*ZERO     YN0113  60
      * Define null work field Time of Original Entry
     C                     Z-ADD*ZERO     YN0114  60
      * Define null work field OH Appt Confirmation Tm
     C                     Z-ADD*ZERO     YN0115  60
      * Define null work field Load BOL Complete Time
     C                     Z-ADD*ZERO     YN0116  60
      * Define null work field Load Truck Departure Time
     C                     Z-ADD*ZERO     YN0117  60
      * Define null work field Act Frt Reference Amount
     C                     Z-ADD*ZERO     YN0118 112
      * Define null work field Act Non-Ref Frt Amount
     C                     Z-ADD*ZERO     YN0119 112
      * Define null work field OH Fuel Surcharge Amount
     C                     Z-ADD*ZERO     YN0120 112
      * Define null work field OH Total Non-Ref Frt Amt
     C                     Z-ADD*ZERO     YN0121 112
      * Define null work field OH Total Ref Frt Amt
     C                     Z-ADD*ZERO     YN0122 112
      * Define null work field Claim Number
     C                     Z-ADD*ZERO     YN0123  70
      * Define null work field EDI Status 1
     C                     MOVEL*BLANK    YN0124  1
      * Define null work field EDI Status 2
     C                     MOVEL*BLANK    YN0125  1
      * Define null work field EDI Status 3
     C                     MOVEL*BLANK    YN0126  1
      * Define null work field Job Time
     C                     Z-ADD*ZERO     YN0127  60
      * Define null work field User Id
     C                     MOVEL*BLANK    YN0128 10
      * Define null work field Job Name
     C                     MOVEL*BLANK    YN0129 10
      * Define null work field Job Date
     C                     Z-ADD*ZERO     YN0130  70
      * Define local work field POC/POCA ??
     C                     MOVEL*BLANK    YL0020  6
      * Define local work field EDI Trading Partner No.
     C                     MOVEL*BLANK    YL0021  6
      * Define local work field EDI POA
     C                     MOVEL*BLANK    YL0022  1
      * Define local work field EDI POAC
     C                     MOVEL*BLANK    YL0023  1
      * Define local work field OHE PO ACK Flag
     C                     MOVEL*BLANK    YL0024  4
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0025  1
      * Define local work field Send EDI Document Y/N
     C                     MOVEL*BLANK    YL0026  1
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 POCACK
00002 DSYSCO
