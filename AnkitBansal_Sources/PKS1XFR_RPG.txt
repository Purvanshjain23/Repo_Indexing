     H/TITLE Upd Prd Wgt Lots WK   ZZ  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 11/09/20  Time  : 01:35:12
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKC5CPL1IF  E           K        DISK
      * RTV : Crc Sum Tto Wgt Lot  WRK  Retrieval index
      *
     FPKC2CPL2IF  E           K        DISK
      * RSQ : Crc Sum Prd Wgt Lot  WK   Co/WkEnd/Prd/Min/Max
      *
     FPKA1CPLMIF  E           K        DISK
      * RSQ : Tattoo Header             Co/KlDte/Tto PaySts=CM
      *
     FPKC1REL2IF  E           K        DISK
      * RSQ : Crc Sum Wgt Lot           Co/Min(d)
      *
     FPKC2CPL1IF  E           K        DISK
      * RTV : Crc Sum Prd Wgt Lot  WK   Retrieval index
      *
     FPKC5CPL2IF  E           K        DISK
      * RSQ : Crc Sum Tto Wgt Lot  WRK  Co/Min/Max/Prd/Lean%
      *
     FPKC5CPL3IF  E           K        DISK
      * RSQ : Crc Sum Tto Wgt Lot  WRK  Co/Min/Max/Prd/ActYld
      *
     FPKC5CPL4IF  E           K        DISK
      * RSQ : Crc Sum Tto Wgt Lot  WRK  Co/Min/Max/Prd/LnPrmLV
      *
     FPKC5CPL5IF  E           K        DISK
      * RSQ : Crc Sum Tto Wgt Lot  WRK  Co/Min/Max/Prd/SrtDscLV
      *
     FPKC5CPL0UF  E           K        DISK                      A
      * UPD : Crc Sum Tto Wgt Lot  WRK  Update index
      *
     FPKC2CPL0UF  E           K        DISK                      A
      * UPD : Crc Sum Prd Wgt Lot  WK   Update index
      *
     I@C5CPPL
      * Crc Sum Tto Wgt Lot  WRK  Retrieval index
      * Renamed input format fields
     I              C5HONB                          WAHONB
     I              C5MHNB                          WAMHNB
     I              C5MINB                          WAMINB
     I              C5ABCD                          WAABCD
     I              C5HMNB                          WAHMNB
     I              C5BNNB                          WABNNB
     I              C5BONB                          WABONB
     I              C5CVNB                          WACVNB
     I              C5B0DT                          WAB0DT
     I              C5F7NB                          WAF7NB
     I              C5HDNB                          WAHDNB
     I              C5F4NB                          WAF4NB
     I              C5AWPC                          WAAWPC
     I              C5CWPC                          WACWPC
     I              C5EEPR                          WAEEPR
     I              C5EFPR                          WAEFPR
     I              C5D8PR                          WAD8PR
     I              C5D9PR                          WAD9PR
      *
     I@C5CPPK
      * Crc Sum Tto Wgt Lot  WRK  Update index
      * Renamed input format fields
     I              C5HONB                          WBHONB
     I              C5MHNB                          WBMHNB
     I              C5MINB                          WBMINB
     I              C5ABCD                          WBABCD
     I              C5HMNB                          WBHMNB
     I              C5BNNB                          WBBNNB
     I              C5BONB                          WBBONB
     I              C5CVNB                          WBCVNB
     I              C5B0DT                          WBB0DT
     I              C5F7NB                          WBF7NB
     I              C5HDNB                          WBHDNB
     I              C5F4NB                          WBF4NB
     I              C5AWPC                          WBAWPC
     I              C5CWPC                          WBCWPC
     I              C5EEPR                          WBEEPR
     I              C5EFPR                          WBEFPR
     I              C5D8PR                          WBD8PR
     I              C5D9PR                          WBD9PR
      *
     I@C2CPPN
      * Crc Sum Prd Wgt Lot  WK   Co/WkEnd/Prd/Min/Max
      * Renamed input format fields
     I              C2HONB                          WCHONB
     I              C2MHNB                          WCMHNB
     I              C2MINB                          WCMINB
     I              C2ABCD                          WCABCD
     I              C2CIDT                          WCCIDT
     I              C2B0PC                          WCB0PC
     I              C2B1PC                          WCB1PC
     I              C2B2PC                          WCB2PC
     I              C2B3PC                          WCB3PC
     I              C2B4PC                          WCB4PC
     I              C2B5PC                          WCB5PC
     I              C2B6PC                          WCB6PC
     I              C2B7PC                          WCB7PC
     I              C2B8PC                          WCB8PC
     I              C2B9PC                          WCB9PC
     I              C2CAPC                          WCCAPC
     I              C2CBPC                          WCCBPC
     I              C2CCPC                          WCCCPC
     I              C2CDPC                          WCCDPC
     I              C2CEPC                          WCCEPC
     I              C2CFPC                          WCCFPC
     I              C2DAPR                          WCDAPR
     I              C2DBPR                          WCDBPR
     I              C2DCPR                          WCDCPR
     I              C2DDPR                          WCDDPR
     I              C2DEPR                          WCDEPR
     I              C2DFPR                          WCDFPR
     I              C2DGPR                          WCDGPR
     I              C2DHPR                          WCDHPR
     I              C2DIPR                          WCDIPR
     I              C2DJPR                          WCDJPR
     I              C2DKPR                          WCDKPR
     I              C2DLPR                          WCDLPR
     I              C2DMPR                          WCDMPR
     I              C2DNPR                          WCDNPR
     I              C2DOPR                          WCDOPR
     I              C2DPPR                          WCDPPR
     I              C2MMNB                          WCMMNB
     I              C2NUNB                          WCNUNB
     I              C2AAVN                          WCAAVN
     I              C2AADT                          WCAADT
     I              C2AMTM                          WCAMTM
     I              C2AJST                          WCAJST
     I              C2AHVN                          WCAHVN
     I              C2AGVN                          WCAGVN
     I              C2ABVN                          WCABVN
     I              C2ABDT                          WCABDT
     I              C2ABTM                          WCABTM
      *
     I@C2CPOO
      * Crc Sum Prd Wgt Lot  WK   Update index
      * Renamed input format fields
     I              C2HONB                          WDHONB
     I              C2MHNB                          WDMHNB
     I              C2MINB                          WDMINB
     I              C2ABCD                          WDABCD
     I              C2CIDT                          WDCIDT
     I              C2B0PC                          WDB0PC
     I              C2B1PC                          WDB1PC
     I              C2B2PC                          WDB2PC
     I              C2B3PC                          WDB3PC
     I              C2B4PC                          WDB4PC
     I              C2B5PC                          WDB5PC
     I              C2B6PC                          WDB6PC
     I              C2B7PC                          WDB7PC
     I              C2B8PC                          WDB8PC
     I              C2B9PC                          WDB9PC
     I              C2CAPC                          WDCAPC
     I              C2CBPC                          WDCBPC
     I              C2CCPC                          WDCCPC
     I              C2CDPC                          WDCDPC
     I              C2CEPC                          WDCEPC
     I              C2CFPC                          WDCFPC
     I              C2DAPR                          WDDAPR
     I              C2DBPR                          WDDBPR
     I              C2DCPR                          WDDCPR
     I              C2DDPR                          WDDDPR
     I              C2DEPR                          WDDEPR
     I              C2DFPR                          WDDFPR
     I              C2DGPR                          WDDGPR
     I              C2DHPR                          WDDHPR
     I              C2DIPR                          WDDIPR
     I              C2DJPR                          WDDJPR
     I              C2DKPR                          WDDKPR
     I              C2DLPR                          WDDLPR
     I              C2DMPR                          WDDMPR
     I              C2DNPR                          WDDNPR
     I              C2DOPR                          WDDOPR
     I              C2DPPR                          WDDPPR
     I              C2MMNB                          WDMMNB
     I              C2NUNB                          WDNUNB
     I              C2AAVN                          WDAAVN
     I              C2AADT                          WDAADT
     I              C2AMTM                          WDAMTM
     I              C2AJST                          WDAJST
     I              C2AHVN                          WDAHVN
     I              C2AGVN                          WDAGVN
     I              C2ABVN                          WDABVN
     I              C2ABDT                          WDABDT
     I              C2ABTM                          WDABTM
      *
     I@A1CPPT
      * Tattoo Header             Co/KlDte/Tto PaySts=CM
      * Renamed input format fields
     I              A1HMNB                          WEHMNB
     I              A1BNNB                          WEBNNB
     I              A1BONB                          WEBONB
     I              A1CVNB                          WECVNB
     I              A1B0DT                          WEB0DT
     I              A1AWDT                          WEAWDT
     I              A1BICD                          WEBICD
     I              A1CPST                          WECPST
     I              A1ACPR                          WEACPR
     I              A1B9PR                          WEB9PR
     I              A1CAPR                          WECAPR
     I              A1C4ST                          WEC4ST
     I              A1AIPR                          WEAIPR
     I              A1A6DT                          WEA6DT
     I              A1C2ST                          WEC2ST
     I              A1CXNB                          WECXNB
     I              A1CWNB                          WECWNB
     I              A1FCNB                          WEFCNB
     I              A1H9NB                          WEH9NB
     I              A1FDNB                          WEFDNB
     I              A1FENB                          WEFENB
     I              A1HENB                          WEHENB
     I              A1HFNB                          WEHFNB
     I              A1CYNB                          WECYNB
     I              A1LRNB                          WELRNB
     I              A1E0NB                          WEE0NB
     I              A1A5PC                          WEA5PC
     I              A1FBNB                          WEFBNB
     I              A1A4PC                          WEA4PC
     I              A1F7NB                          WEF7NB
     I              A1HDNB                          WEHDNB
     I              A1F5NB                          WEF5NB
     I              A1F4NB                          WEF4NB
     I              A1F3NB                          WEF3NB
     I              A1F2NB                          WEF2NB
     I              A1AVPC                          WEAVPC
     I              A1AWPC                          WEAWPC
     I              A1CWPC                          WECWPC
     I              A1A8PC                          WEA8PC
     I              A1A7PC                          WEA7PC
     I              A1B8PR                          WEB8PR
     I              A1AMPR                          WEAMPR
     I              A1ANPR                          WEANPR
     I              A1AYVA                          WEAYVA
     I              A1AWVA                          WEAWVA
     I              A1AOPR                          WEAOPR
     I              A1AXVA                          WEAXVA
     I              A1APPR                          WEAPPR
     I              A1ASPR                          WEASPR
     I              A1A4VA                          WEA4VA
     I              A1ATPR                          WEATPR
     I              A1A5VA                          WEA5VA
     I              A1CBPR                          WECBPR
     I              A1CCPR                          WECCPR
     I              A1LPNB                          WELPNB
     I              A1CDPR                          WECDPR
     I              A1A7VA                          WEA7VA
     I              A1A2PR                          WEA2PR
     I              A1JWST                          WEJWST
     I              A1CWST                          WECWST
     I              A1D7ST                          WED7ST
     I              A1D8ST                          WED8ST
     I              A1DWST                          WEDWST
     I              A1D6ST                          WED6ST
     I              A1GHNB                          WEGHNB
     I              A1BYDT                          WEBYDT
     I              A1E0ST                          WEE0ST
     I              A1E1ST                          WEE1ST
     I              A1E2ST                          WEE2ST
     I              A1BSDT                          WEBSDT
     I              A1BTDT                          WEBTDT
     I              A1BUDT                          WEBUDT
     I              A1HGNB                          WEHGNB
     I              A1HHNB                          WEHHNB
     I              A1HINB                          WEHINB
     I              A1A3PR                          WEA3PR
     I              A1A4PR                          WEA4PR
     I              A1A6PR                          WEA6PR
     I              A1J9NB                          WEJ9NB
     I              A1D6PR                          WED6PR
     I              A1D7PR                          WED7PR
     I              A1D8PR                          WED8PR
     I              A1D9PR                          WED9PR
     I              A1EAPR                          WEEAPR
     I              A1EBPR                          WEEBPR
     I              A1ECPR                          WEECPR
     I              A1EDPR                          WEEDPR
     I              A1EEPR                          WEEEPR
     I              A1EFPR                          WEEFPR
     I              A1EGPR                          WEEGPR
     I              A1EHPR                          WEEHPR
     I              A1KAST                          WEKAST
     I              A1J7ST                          WEJ7ST
     I              A1J9ST                          WEJ9ST
     I              A1OXNB                          WEOXNB
     I              A1LKST                          WELKST
     I              A1LLST                          WELLST
     I              A1J8ST                          WEJ8ST
     I              A1LIST                          WELIST
     I              A1LJST                          WELJST
     I              A1NZTX                          WENZTX
     I              A1HJCD                          WEHJCD
     I              A1R4ST                          WER4ST
     I              A1R5ST                          WER5ST
     I              A1R6ST                          WER6ST
     I              A1R7ST                          WER7ST
     I              A1THWT                          WETHWT
     I              A1T2WT                          WET2WT
     I              A1THHD                          WETHHD
     I              A1T2HD                          WET2HD
     I              A1OBPR                          WEOBPR
     I              A1KOER                          WEKOER
     I              A1OPIR                          WEOPIR
     I              A1OPEM                          WEOPEM
     I              A1IORP                          WEIORP
     I              A1OWEO                          WEOWEO
     I              A1OQET                          WEOQET
     I              A1URST                          WEURST
     I              A1USST                          WEUSST
     I              A1HHPC                          WEHHPC
     I              A1S9PR                          WES9PR
     I              A1TAPR                          WETAPR
     I              A1TBPR                          WETBPR
     I              A1JFUR                          WEJFUR
     I              A1KRIF                          WEKRIF
     I              A1KORF                          WEKORF
     I              A1KAPR                          WEKAPR
     I              A1KROT                          WEKROT
     I              A1OTJG                          WEOTJG
     I              A1IRJG                          WEIRJG
     I              A1IMJF                          WEIMJF
     I              A1IRGF                          WEIRGF
     I              A1KRJF                          WEKRJF
     I              A1OJRF                          WEOJRF
     I              A1KFOR                          WEKFOR
     I              A1ORJK                          WEORJK
     I              A1OMVJ                          WEOMVJ
     I              A1MVNF                          WEMVNF
     I              A1MCNF                          WEMCNF
     I              A1NCNF                          WENCNF
     I              A1NCHF                          WENCHF
     I              A1IGIR                          WEIGIR
     I              A1KFJR                          WEKFJR
     I              A1EADT                          WEEADT
     I              A1EBDT                          WEEBDT
     I              A1ECDT                          WEECDT
     I              A1EDDT                          WEEDDT
     I              A1EEDT                          WEEEDT
     I              A1U4ST                          WEU4ST
     I              A1U5ST                          WEU5ST
     I              A1U6ST                          WEU6ST
     I              A1U7ST                          WEU7ST
     I              A1U8ST                          WEU8ST
     I              A1U9ST                          WEU9ST
     I              A1VAST                          WEVAST
     I              A1VBST                          WEVBST
     I              A1BDCD                          WEBDCD
     I              A1CSCD                          WECSCD
     I              A1ABCD                          WEABCD
     I              A1AECD                          WEAECD
     I              A1ACCD                          WEACCD
     I              A1AGCD                          WEAGCD
     I              A1BECD                          WEBECD
     I              A1AAVN                          WEAAVN
     I              A1AADT                          WEAADT
     I              A1AMTM                          WEAMTM
     I              A1AJST                          WEAJST
     I              A1AHVN                          WEAHVN
     I              A1AGVN                          WEAGVN
     I              A1ABVN                          WEABVN
     I              A1ABDT                          WEABDT
     I              A1ABTM                          WEABTM
      *
     I@C1REPM
      * Crc Sum Wgt Lot           Co/Min(d)
      * Renamed input format fields
     I              C1HONB                          WFHONB
     I              C1MHNB                          WFMHNB
     I              C1MINB                          WFMINB
     I              C1AAVN                          WFAAVN
     I              C1AADT                          WFAADT
     I              C1AMTM                          WFAMTM
     I              C1AJST                          WFAJST
     I              C1AHVN                          WFAHVN
     I              C1AGVN                          WFAGVN
     I              C1ABVN                          WFABVN
     I              C1ABDT                          WFABDT
     I              C1ABTM                          WFABTM
      *
     I@C2CPOS
      * Crc Sum Prd Wgt Lot  WK   Retrieval index
      * Renamed input format fields
     I              C2HONB                          WGHONB
     I              C2MHNB                          WGMHNB
     I              C2MINB                          WGMINB
     I              C2ABCD                          WGABCD
     I              C2CIDT                          WGCIDT
     I              C2B0PC                          WGB0PC
     I              C2B1PC                          WGB1PC
     I              C2B2PC                          WGB2PC
     I              C2B3PC                          WGB3PC
     I              C2B4PC                          WGB4PC
     I              C2B5PC                          WGB5PC
     I              C2B6PC                          WGB6PC
     I              C2B7PC                          WGB7PC
     I              C2B8PC                          WGB8PC
     I              C2B9PC                          WGB9PC
     I              C2CAPC                          WGCAPC
     I              C2CBPC                          WGCBPC
     I              C2CCPC                          WGCCPC
     I              C2CDPC                          WGCDPC
     I              C2CEPC                          WGCEPC
     I              C2CFPC                          WGCFPC
     I              C2DAPR                          WGDAPR
     I              C2DBPR                          WGDBPR
     I              C2DCPR                          WGDCPR
     I              C2DDPR                          WGDDPR
     I              C2DEPR                          WGDEPR
     I              C2DFPR                          WGDFPR
     I              C2DGPR                          WGDGPR
     I              C2DHPR                          WGDHPR
     I              C2DIPR                          WGDIPR
     I              C2DJPR                          WGDJPR
     I              C2DKPR                          WGDKPR
     I              C2DLPR                          WGDLPR
     I              C2DMPR                          WGDMPR
     I              C2DNPR                          WGDNPR
     I              C2DOPR                          WGDOPR
     I              C2DPPR                          WGDPPR
     I              C2MMNB                          WGMMNB
     I              C2NUNB                          WGNUNB
     I              C2AAVN                          WGAAVN
     I              C2AADT                          WGAADT
     I              C2AMTM                          WGAMTM
     I              C2AJST                          WGAJST
     I              C2AHVN                          WGAHVN
     I              C2AGVN                          WGAGVN
     I              C2ABVN                          WGABVN
     I              C2ABDT                          WGABDT
     I              C2ABTM                          WGABTM
      *
     I@C5CPPP
      * Crc Sum Tto Wgt Lot  WRK  Co/Min/Max/Prd/Lean%
      * Renamed input format fields
     I              C5HONB                          WHHONB
     I              C5MHNB                          WHMHNB
     I              C5MINB                          WHMINB
     I              C5ABCD                          WHABCD
     I              C5HMNB                          WHHMNB
     I              C5BNNB                          WHBNNB
     I              C5BONB                          WHBONB
     I              C5CVNB                          WHCVNB
     I              C5B0DT                          WHB0DT
     I              C5F7NB                          WHF7NB
     I              C5HDNB                          WHHDNB
     I              C5F4NB                          WHF4NB
     I              C5AWPC                          WHAWPC
     I              C5CWPC                          WHCWPC
     I              C5EEPR                          WHEEPR
     I              C5EFPR                          WHEFPR
     I              C5D8PR                          WHD8PR
     I              C5D9PR                          WHD9PR
      *
     I@C5CPPQ
      * Crc Sum Tto Wgt Lot  WRK  Co/Min/Max/Prd/ActYld
      * Renamed input format fields
     I              C5HONB                          WIHONB
     I              C5MHNB                          WIMHNB
     I              C5MINB                          WIMINB
     I              C5ABCD                          WIABCD
     I              C5HMNB                          WIHMNB
     I              C5BNNB                          WIBNNB
     I              C5BONB                          WIBONB
     I              C5CVNB                          WICVNB
     I              C5B0DT                          WIB0DT
     I              C5F7NB                          WIF7NB
     I              C5HDNB                          WIHDNB
     I              C5F4NB                          WIF4NB
     I              C5AWPC                          WIAWPC
     I              C5CWPC                          WICWPC
     I              C5EEPR                          WIEEPR
     I              C5EFPR                          WIEFPR
     I              C5D8PR                          WID8PR
     I              C5D9PR                          WID9PR
      *
     I@C5CPPR
      * Crc Sum Tto Wgt Lot  WRK  Co/Min/Max/Prd/LnPrmLV
      * Renamed input format fields
     I              C5HONB                          WJHONB
     I              C5MHNB                          WJMHNB
     I              C5MINB                          WJMINB
     I              C5ABCD                          WJABCD
     I              C5HMNB                          WJHMNB
     I              C5BNNB                          WJBNNB
     I              C5BONB                          WJBONB
     I              C5CVNB                          WJCVNB
     I              C5B0DT                          WJB0DT
     I              C5F7NB                          WJF7NB
     I              C5HDNB                          WJHDNB
     I              C5F4NB                          WJF4NB
     I              C5AWPC                          WJAWPC
     I              C5CWPC                          WJCWPC
     I              C5EEPR                          WJEEPR
     I              C5EFPR                          WJEFPR
     I              C5D8PR                          WJD8PR
     I              C5D9PR                          WJD9PR
      *
     I@C5CPPS
      * Crc Sum Tto Wgt Lot  WRK  Co/Min/Max/Prd/SrtDscLV
      * Renamed input format fields
     I              C5HONB                          WKHONB
     I              C5MHNB                          WKMHNB
     I              C5MINB                          WKMINB
     I              C5ABCD                          WKABCD
     I              C5HMNB                          WKHMNB
     I              C5BNNB                          WKBNNB
     I              C5BONB                          WKBONB
     I              C5CVNB                          WKCVNB
     I              C5B0DT                          WKB0DT
     I              C5F7NB                          WKF7NB
     I              C5HDNB                          WKHDNB
     I              C5F4NB                          WKF4NB
     I              C5AWPC                          WKAWPC
     I              C5CWPC                          WKCWPC
     I              C5EEPR                          WKEEPR
     I              C5EFPR                          WKEFPR
     I              C5D8PR                          WKD8PR
     I              C5D9PR                          WKD9PR
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPKC51    E DSPKC5CPL0
      * UPD : Crc Sum Tto Wgt Lot  WRK  Update index
      * Renamed input format fields
     I              C5HONB                          WBHONB
     I              C5MHNB                          WBMHNB
     I              C5MINB                          WBMINB
     I              C5ABCD                          WBABCD
     I              C5HMNB                          WBHMNB
     I              C5BNNB                          WBBNNB
     I              C5BONB                          WBBONB
     I              C5CVNB                          WBCVNB
     I              C5B0DT                          WBB0DT
     I              C5F7NB                          WBF7NB
     I              C5HDNB                          WBHDNB
     I              C5F4NB                          WBF4NB
     I              C5AWPC                          WBAWPC
     I              C5CWPC                          WBCWPC
     I              C5EEPR                          WBEEPR
     I              C5EFPR                          WBEFPR
     I              C5D8PR                          WBD8PR
     I              C5D9PR                          WBD9PR
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPKC21    E DSPKC2CPL0
      * UPD : Crc Sum Prd Wgt Lot  WK   Update index
      * Renamed input format fields
     I              C2HONB                          WDHONB
     I              C2MHNB                          WDMHNB
     I              C2MINB                          WDMINB
     I              C2ABCD                          WDABCD
     I              C2CIDT                          WDCIDT
     I              C2B0PC                          WDB0PC
     I              C2B1PC                          WDB1PC
     I              C2B2PC                          WDB2PC
     I              C2B3PC                          WDB3PC
     I              C2B4PC                          WDB4PC
     I              C2B5PC                          WDB5PC
     I              C2B6PC                          WDB6PC
     I              C2B7PC                          WDB7PC
     I              C2B8PC                          WDB8PC
     I              C2B9PC                          WDB9PC
     I              C2CAPC                          WDCAPC
     I              C2CBPC                          WDCBPC
     I              C2CCPC                          WDCCPC
     I              C2CDPC                          WDCDPC
     I              C2CEPC                          WDCEPC
     I              C2CFPC                          WDCFPC
     I              C2DAPR                          WDDAPR
     I              C2DBPR                          WDDBPR
     I              C2DCPR                          WDDCPR
     I              C2DDPR                          WDDDPR
     I              C2DEPR                          WDDEPR
     I              C2DFPR                          WDDFPR
     I              C2DGPR                          WDDGPR
     I              C2DHPR                          WDDHPR
     I              C2DIPR                          WDDIPR
     I              C2DJPR                          WDDJPR
     I              C2DKPR                          WDDKPR
     I              C2DLPR                          WDDLPR
     I              C2DMPR                          WDDMPR
     I              C2DNPR                          WDDNPR
     I              C2DOPR                          WDDOPR
     I              C2DPPR                          WDDPPR
     I              C2MMNB                          WDMMNB
     I              C2NUNB                          WDNUNB
     I              C2AAVN                          WDAAVN
     I              C2AADT                          WDAADT
     I              C2AMTM                          WDAMTM
     I              C2AJST                          WDAJST
     I              C2AHVN                          WDAHVN
     I              C2AGVN                          WDAGVN
     I              C2ABVN                          WDABVN
     I              C2ABDT                          WDABDT
     I              C2ABTM                          WDABTM
      *
     IYARDCS      DS                            171
     IYBRDCS      DS                            171
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Crc Sum Wgt Lot
      * I :  CC Company Number
     I                                    P   1   20P1HONB
     IP2PARM      DS
      * FLD: Calendar Week
      * B :  CW Year
     I                                    P   1   30P2GANB
      * B :  CW Week Number
     I                                    P   4   50P2GBNB
      * B :  CW Week Start Date
     I                                    P   6   90P2BGDT
      * B :  CW Week End Date
     I                                    P  10  130P2BHDT
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HONB    PARM           WP0001  30       CC Company Numb
     C           P2GANB    PARM P2GANB    WP0002  40       CW Year
     C           P2GBNB    PARM P2GBNB    WP0003  20       CW Week Number
     C           P2BGDT    PARM P2BGDT    WP0004  70       CW Week Start D
     C           P2BHDT    PARM P2BHDT    WP0005  70       CW Week End Dat
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Upd Prd Wgt Lots WK   ZZ
      * Modifications and Comments
     C                     EXSR UASUBR                     Modifications a
      * Read me.
      * CASE: WRK.#Sequence Block is NULL
     C           WUJ0ST    IFEQ *BLANK                     *IF
      * Retrieve week number based on the Job Date
      * The following retrieves will be needed when this function
      * is placed with the nightly routine.  The Calendar Week parameters
      * will need to be all 'N'either.
     C                     END                             *FI
      * Del Tto Wgt Lot WRK   RT - Crc Sum Tto Wgt Lot  WRK  * 
     C                     EXSR SARVGN
      * Del Prd Wgt Lot WK    RT - Crc Sum Prd Wgt Lot  WK  * 
     C                     EXSR SCRVGN
      * Upd Prd Wgt Lots WRK  RT - Tattoo Header  * 
     C                     EXSR SERVGN
      * Upd Top/Mid/Low Data  RT - Crc Sum Prd Wgt Lot  WK  * 
     C                     EXSR SKRVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Del Tto Wgt Lot WRK   RT - Crc Sum Tto Wgt Lot  WRK  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHONB    WQSA01           CC Company Numb
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           CC Company Numb
      * Setup key
     C                     Z-ADDP1HONB    WQSA01           CC Company Numb
      * Establish starting position
     C           KRSSA     SETLL@C5CPPL                    *
     C           KRSSA     READE@C5CPPL                  90*
      * Data record not found
     C   90                MOVEL'PRK0444' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del Tto Wgt Lot WRK   DL - Crc Sum Tto Wgt Lot  WRK  * 
     C                     EXSR SBDLRC
     C           KRSSA     READE@C5CPPL                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBDLRC    BEGSR
      *================================================================
      * Del Tto Wgt Lot WRK   DL - Crc Sum Tto Wgt Lot  WRK  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @C5CPPK
     C                     Z-ADDWAHONB    WBHONB           CC Company Numb
     C                     Z-ADDWAMHNB    WBMHNB           CWL Min Adj Liv
     C                     Z-ADDWAMINB    WBMINB           CWL Max Adj Liv
     C                     MOVELWAABCD    WBABCD           PD Producer Cod
     C                     Z-ADDWAHMNB    WBHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WBBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WBBONB           BOL Load Number
     C                     Z-ADDWACVNB    WBCVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WBB0DT           TH Kill Date
      *
     C           KLDLSB    KLIST
     C                     KFLD           WBHONB           CC Company Numb
     C                     KFLD           WBMHNB           CWL Min Adj Liv
     C                     KFLD           WBMINB           CWL Max Adj Liv
     C                     KFLD           WBABCD           PD Producer Cod
     C                     KFLD           WBHMNB           BOH Company Num
     C                     KFLD           WBBNNB           BOH Buy Order N
     C                     KFLD           WBBONB           BOL Load Number
     C                     KFLD           WBCVNB           TH Tattoo Numbe
     C                     KFLD           WBB0DT           TH Kill Date
     C           KLDLSB    CHAIN@C5CPPK              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKC5CPL0'MDACP
     C                     MOVEL'@C5CPPK' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@C5CPPK                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Del Prd Wgt Lot WK    RT - Crc Sum Prd Wgt Lot  WK  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHONB    WQSC01           CC Company Numb
     C           *LIKE     DEFN WCCIDT    WQSC02           PWLW Week Endin
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           CC Company Numb
     C                     KFLD           WQSC02           PWLW Week Endin
      * Setup key
     C                     Z-ADDP1HONB    WQSC01           CC Company Numb
     C                     Z-ADDP2BHDT    WQSC02           PWLW Week Endin
      * Establish starting position
     C           KRSSC     SETLL@C2CPPN                    *
     C           KRSSC     READE@C2CPPN                  90*
      * Data record not found
     C   90                MOVEL'PRK0430' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del Prd Wgt Lot WK    DL - Crc Sum Prd Wgt Lot  WK  * 
     C                     EXSR SDDLRC
     C           KRSSC     READE@C2CPPN                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDDLRC    BEGSR
      *================================================================
      * Del Prd Wgt Lot WK    DL - Crc Sum Prd Wgt Lot  WK  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @C2CPOO
     C                     Z-ADDWCHONB    WDHONB           CC Company Numb
     C                     Z-ADDWCMHNB    WDMHNB           CWL Min Adj Liv
     C                     Z-ADDWCMINB    WDMINB           CWL Max Adj Liv
     C                     MOVELWCABCD    WDABCD           PD Producer Cod
     C                     Z-ADDWCCIDT    WDCIDT           PWLW Week Endin
      *
     C           KLDLSD    KLIST
     C                     KFLD           WDHONB           CC Company Numb
     C                     KFLD           WDMHNB           CWL Min Adj Liv
     C                     KFLD           WDMINB           CWL Max Adj Liv
     C                     KFLD           WDABCD           PD Producer Cod
     C                     KFLD           WDCIDT           PWLW Week Endin
     C           KLDLSD    CHAIN@C2CPOO              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKC2CPL0'MDACP
     C                     MOVEL'@C2CPOO' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@C2CPOO                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Upd Prd Wgt Lots WRK  RT - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  30       CWL Min Adj Liv
     C                     Z-ADD*ZERO     WN0002  30       CWL Max Adj Liv
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEHMNB    WQSE01           BOH Company Num
      * Define keylist
     C           KPSSE     KLIST
     C                     KFLD           WQSE01           BOH Company Num
     C                     KFLD           WEB0DT           TH Kill Date
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           BOH Company Num
      * Setup key
     C                     Z-ADDP1HONB    WQSE01           BOH Company Num
     C                     Z-ADDP2BGDT    WEB0DT           TH Kill Date
      * Establish starting position
     C           KPSSE     SETLL@A1CPPT                    *
     C           KRSSE     READE@A1CPPT                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * QUIT:  DB1.Kill Date GT PAR.Week End Date
      * CASE: DB1.TH Kill Date GT PAR.CW Week End Date
     C           WEB0DT    IFGT P2BHDT                     *IF
     C                     GOTO SEEXIT                     *QUIT
     C                     END                             *FI
      * Rtv Wtg Lot           RT - Crc Sum Wgt Lot  * 
     C                     EXSR SFRVGN
      * Crt Prd Tto WgtLot WRK CR - Crc Sum Tto Wgt Lot  WRK  * 
     C                     EXSR SGCRRC
     C           KRSSE     READE@A1CPPT                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Wtg Lot           RT - Crc Sum Wgt Lot  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFHONB    WQSF01           CC Company Numb
      * Define keylist
     C           KPSSF     KLIST
     C                     KFLD           WQSF01           CC Company Numb
     C                     KFLD           WFMHNB           CWL Min Adj Liv
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           CC Company Numb
      * Setup key
     C                     Z-ADDP1HONB    WQSF01           CC Company Numb
     C                     Z-ADDWEF7NB    WFMHNB           CWL Min Adj Liv
      * Establish starting position
     C           KPSSF     SETLL@C1REPM                    *
     C           KRSSF     READE@C1REPM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0428' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0001           CWL Min Adj Liv
     C                     Z-ADD*ZERO     WN0002           CWL Max Adj Liv
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWFMHNB    WN0001           CWL Min Adj Liv
     C                     Z-ADDWFMINB    WN0002           CWL Max Adj Liv
     C                     GOTO SFEXIT                     *QUIT
     C           KRSSF     READE@C1REPM                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCRRC    BEGSR
      *================================================================
      * Crt Prd Tto WgtLot WRK CR - Crc Sum Tto Wgt Lot  WRK  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @C5CPPK
     C                     Z-ADDP1HONB    WBHONB           CC Company Numb
     C                     Z-ADDWN0001    WBMHNB           CWL Min Adj Liv
     C                     Z-ADDWN0002    WBMINB           CWL Max Adj Liv
     C                     MOVELWEABCD    WBABCD           PD Producer Cod
     C                     Z-ADDWEHMNB    WBHMNB           BOH Company Num
     C                     Z-ADDWEBNNB    WBBNNB           BOH Buy Order N
     C                     Z-ADDWEBONB    WBBONB           BOL Load Number
     C                     Z-ADDWECVNB    WBCVNB           TH Tattoo Numbe
     C                     Z-ADDWEB0DT    WBB0DT           TH Kill Date
     C                     Z-ADDWEF7NB    WBF7NB           TH Avg Live Wgt
     C                     Z-ADDWEHDNB    WBHDNB           TH Avg Hot Wgt
     C                     Z-ADDWEF4NB    WBF4NB           TH Avg Lean Per
     C                     Z-ADDWEAWPC    WBAWPC           TH Actual Yield
     C                     Z-ADDWECWPC    WBCWPC           TH Adj Actual Y
     C                     Z-ADDWEEEPR    WBEEPR           TH CM Lean Prem
     C                     Z-ADDWEEFPR    WBEFPR           TH CM Lean Prem
     C                     Z-ADDWED8PR    WBD8PR           TH CM Srt Dsc L
     C                     Z-ADDWED9PR    WBD9PR           TH CM Srt Dsc C
      *
     C           KLCRSG    KLIST
     C                     KFLD           WBHONB           CC Company Numb
     C                     KFLD           WBMHNB           CWL Min Adj Liv
     C                     KFLD           WBMINB           CWL Max Adj Liv
     C                     KFLD           WBABCD           PD Producer Cod
     C                     KFLD           WBHMNB           BOH Company Num
     C                     KFLD           WBBNNB           BOH Buy Order N
     C                     KFLD           WBBONB           BOL Load Number
     C                     KFLD           WBCVNB           TH Tattoo Numbe
     C                     KFLD           WBB0DT           TH Kill Date
      * Check for duplicate primary key
     C           KLCRSG    SETLL@C5CPPK                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0445' W0RTN   7
      * Send message 'Crc Sum Tto Wgt Lot  W EX'
     C                     MOVEL'PRK0445' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C                     WRITE@C5CPPK                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * Chg Tto Cnt/HdKilled  RT - Crc Sum Prd Wgt Lot  WK  * 
     C                     EXSR SHRVGN
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Chg Tto Cnt/HdKilled  RT - Crc Sum Prd Wgt Lot  WK  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0003  52       PWLW Min Top Yi
     C                     Z-ADD*ZERO     WN0004  52       PWLW Max Top Yi
     C                     Z-ADD*ZERO     WN0005  52       PWLW Min Mid Lo
     C                     Z-ADD*ZERO     WN0006  52       PWLW Max Mid Lo
     C                     Z-ADD*ZERO     WN0007  52       PWLW Min Mid Hi
     C                     Z-ADD*ZERO     WN0008  52       PWLW Max Mid Hi
     C                     Z-ADD*ZERO     WN0009  52       PWLW Min Lower
     C                     Z-ADD*ZERO     WN0010  52       PWLW Max Lower
     C                     Z-ADD*ZERO     WN0011  30       PWLW Min Top Le
     C                     Z-ADD*ZERO     WN0012  30       PWLW Max Top Le
     C                     Z-ADD*ZERO     WN0013  30       PWLW Min Mid Lo
     C                     Z-ADD*ZERO     WN0014  30       PWLW Max Mid Lo
     C                     Z-ADD*ZERO     WN0015  30       PWLW Min Mid Hi
     C                     Z-ADD*ZERO     WN0016  30       PWLW Max Mid Hi
     C                     Z-ADD*ZERO     WN0017  30       PWLW Min Lower
     C                     Z-ADD*ZERO     WN0018  30       PWLW Max Lower
     C                     Z-ADD*ZERO     WN0019  52       PWLW Min Top Le
     C                     Z-ADD*ZERO     WN0020  52       PWLW Max Top Le
     C                     Z-ADD*ZERO     WN0021  52       PWLW Min Mid Lo
     C                     Z-ADD*ZERO     WN0022  52       PWLW Max Mid Lo
     C                     Z-ADD*ZERO     WN0023  52       PWLW Min Mid Hi
     C                     Z-ADD*ZERO     WN0024  52       PWLW Max Mid Hi
     C                     Z-ADD*ZERO     WN0025  52       PWLW Min Lower
     C                     Z-ADD*ZERO     WN0026  52       PWLW Max Lower
     C                     Z-ADD*ZERO     WN0027  52       PWLW Min Top So
     C                     Z-ADD*ZERO     WN0028  52       PWLW Max Top So
     C                     Z-ADD*ZERO     WN0029  52       PWLW Min Mid Lo
     C                     Z-ADD*ZERO     WN0030  52       PWLW Max Mid Lo
     C                     Z-ADD*ZERO     WN0031  52       PWLW Min Mid Hi
     C                     Z-ADD*ZERO     WN0032  52       PWLW Max Mid Hi
     C                     Z-ADD*ZERO     WN0033  52       PWLW Min Lower
     C                     Z-ADD*ZERO     WN0034  52       PWLW Max Lower
     C                     Z-ADD*ZERO     WN0035  70       PWLW Head Kille
     C                     Z-ADD*ZERO     WN0036 110       PWLW Tattoo Cou
     C                     MOVEL*BLANK    WN0037 10        RS User Changed
     C                     Z-ADD*ZERO     WN0038  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0039  60       RS Time Changed
     C                     MOVEL*BLANK    WN0040  1        RS Record Statu
     C                     MOVEL*BLANK    WN0041 10        RS Job
     C                     MOVEL*BLANK    WN0042 10        RS Program
     C                     MOVEL*BLANK    WN0043 10        RS User Added
     C                     Z-ADD*ZERO     WN0044  70       RS Date Added
     C                     Z-ADD*ZERO     WN0045  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WGHONB           CC Company Numb
     C                     KFLD           WGMHNB           CWL Min Adj Liv
     C                     KFLD           WGMINB           CWL Max Adj Liv
     C                     KFLD           WGABCD           PD Producer Cod
     C                     KFLD           WGCIDT           PWLW Week Endin
      * Setup key
     C                     Z-ADDWBHONB    WGHONB           CC Company Numb
     C                     Z-ADDWBMHNB    WGMHNB           CWL Min Adj Liv
     C                     Z-ADDWBMINB    WGMINB           CWL Max Adj Liv
     C                     MOVELWBABCD    WGABCD           PD Producer Cod
     C                     Z-ADDP2BHDT    WGCIDT           PWLW Week Endin
      * Establish starting position
     C           KRSSH     CHAIN@C2CPOS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0430' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Prd Wgt Lot WK    CR - Crc Sum Prd Wgt Lot  WK  * 
     C                     EXSR SICRRC
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WGNUNB    ADD  1         WN0036           PWLW Tattoo Cou
     C           WGMMNB    ADD  WEFENB    WN0035           PWLW Head Kille
      * Chg Tto Cnt/HdKilled  CH - Crc Sum Prd Wgt Lot  WK  * 
     C                     EXSR SJCHRC
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICRRC    BEGSR
      *================================================================
      * Crt Prd Wgt Lot WK    CR - Crc Sum Prd Wgt Lot  WK  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @C2CPOO
     C                     Z-ADDWBHONB    WDHONB           CC Company Numb
     C                     Z-ADDWBMHNB    WDMHNB           CWL Min Adj Liv
     C                     Z-ADDWBMINB    WDMINB           CWL Max Adj Liv
     C                     MOVELWBABCD    WDABCD           PD Producer Cod
     C                     Z-ADDP2BHDT    WDCIDT           PWLW Week Endin
     C                     Z-ADDWN0003    WDB0PC           PWLW Min Top Yi
     C                     Z-ADDWN0004    WDB1PC           PWLW Max Top Yi
     C                     Z-ADDWN0005    WDB2PC           PWLW Min Mid Lo
     C                     Z-ADDWN0006    WDB3PC           PWLW Max Mid Lo
     C                     Z-ADDWN0007    WDB4PC           PWLW Min Mid Hi
     C                     Z-ADDWN0008    WDB5PC           PWLW Max Mid Hi
     C                     Z-ADDWN0009    WDB6PC           PWLW Min Lower
     C                     Z-ADDWN0010    WDB7PC           PWLW Max Lower
     C                     Z-ADDWN0011    WDB8PC           PWLW Min Top Le
     C                     Z-ADDWN0012    WDB9PC           PWLW Max Top Le
     C                     Z-ADDWN0013    WDCAPC           PWLW Min Mid Lo
     C                     Z-ADDWN0014    WDCBPC           PWLW Max Mid Lo
     C                     Z-ADDWN0015    WDCCPC           PWLW Min Mid Hi
     C                     Z-ADDWN0016    WDCDPC           PWLW Max Mid Hi
     C                     Z-ADDWN0017    WDCEPC           PWLW Min Lower
     C                     Z-ADDWN0018    WDCFPC           PWLW Max Lower
     C                     Z-ADDWN0019    WDDAPR           PWLW Min Top Le
     C                     Z-ADDWN0020    WDDBPR           PWLW Max Top Le
     C                     Z-ADDWN0021    WDDCPR           PWLW Min Mid Lo
     C                     Z-ADDWN0022    WDDDPR           PWLW Max Mid Lo
     C                     Z-ADDWN0023    WDDEPR           PWLW Min Mid Hi
     C                     Z-ADDWN0024    WDDFPR           PWLW Max Mid Hi
     C                     Z-ADDWN0025    WDDGPR           PWLW Min Lower
     C                     Z-ADDWN0026    WDDHPR           PWLW Max Lower
     C                     Z-ADDWN0027    WDDIPR           PWLW Min Top So
     C                     Z-ADDWN0028    WDDJPR           PWLW Max Top So
     C                     Z-ADDWN0029    WDDKPR           PWLW Min Mid Lo
     C                     Z-ADDWN0030    WDDLPR           PWLW Max Mid Lo
     C                     Z-ADDWN0031    WDDMPR           PWLW Min Mid Hi
     C                     Z-ADDWN0032    WDDNPR           PWLW Max Mid Hi
     C                     Z-ADDWN0033    WDDOPR           PWLW Min Lower
     C                     Z-ADDWN0034    WDDPPR           PWLW Max Lower
     C                     Z-ADDWEFENB    WDMMNB           PWLW Head Kille
     C                     Z-ADD1         WDNUNB           PWLW Tattoo Cou
     C                     MOVELWN0037    WDAAVN           RS User Changed
     C                     Z-ADDWN0038    WDAADT           RS Date Changed
     C                     Z-ADDWN0039    WDAMTM           RS Time Changed
     C                     MOVELWN0040    WDAJST           RS Record Statu
     C                     MOVELWN0041    WDAHVN           RS Job
     C                     MOVELWN0042    WDAGVN           RS Program
     C                     MOVELWN0043    WDABVN           RS User Added
     C                     Z-ADDWN0044    WDABDT           RS Date Added
     C                     Z-ADDWN0045    WDABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WDAJST           RS Record Statu
     C                     MOVEL##USR     WDABVN           RS User Added
     C                     Z-ADD##JDT     WDABDT           RS Date Added
     C                     Z-ADD##JTM     WDABTM           RS Time Added
     C                     MOVEL##PGM     WDAGVN           RS Program
     C                     MOVEL##JOB     WDAHVN           RS Job
     C           KLCRSI    KLIST
     C                     KFLD           WDHONB           CC Company Numb
     C                     KFLD           WDMHNB           CWL Min Adj Liv
     C                     KFLD           WDMINB           CWL Max Adj Liv
     C                     KFLD           WDABCD           PD Producer Cod
     C                     KFLD           WDCIDT           PWLW Week Endin
      * Check for duplicate primary key
     C           KLCRSI    SETLL@C2CPOO                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0431' W0RTN   7
      * Send message 'Crc Sum Prd Wgt Lot  W EX'
     C                     MOVEL'PRK0431' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C                     WRITE@C2CPOO                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCHRC    BEGSR
      *================================================================
      * Chg Tto Cnt/HdKilled  CH - Crc Sum Prd Wgt Lot  WK  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0046  52       PWLW Min Top Yi
     C                     Z-ADD*ZERO     WN0047  52       PWLW Max Top Yi
     C                     Z-ADD*ZERO     WN0048  52       PWLW Min Mid Lo
     C                     Z-ADD*ZERO     WN0049  52       PWLW Max Mid Lo
     C                     Z-ADD*ZERO     WN0050  52       PWLW Min Mid Hi
     C                     Z-ADD*ZERO     WN0051  52       PWLW Max Mid Hi
     C                     Z-ADD*ZERO     WN0052  52       PWLW Min Lower
     C                     Z-ADD*ZERO     WN0053  52       PWLW Max Lower
     C                     Z-ADD*ZERO     WN0054  30       PWLW Min Top Le
     C                     Z-ADD*ZERO     WN0055  30       PWLW Max Top Le
     C                     Z-ADD*ZERO     WN0056  30       PWLW Min Mid Lo
     C                     Z-ADD*ZERO     WN0057  30       PWLW Max Mid Lo
     C                     Z-ADD*ZERO     WN0058  30       PWLW Min Mid Hi
     C                     Z-ADD*ZERO     WN0059  30       PWLW Max Mid Hi
     C                     Z-ADD*ZERO     WN0060  30       PWLW Min Lower
     C                     Z-ADD*ZERO     WN0061  30       PWLW Max Lower
     C                     Z-ADD*ZERO     WN0062  52       PWLW Min Top Le
     C                     Z-ADD*ZERO     WN0063  52       PWLW Max Top Le
     C                     Z-ADD*ZERO     WN0064  52       PWLW Min Mid Lo
     C                     Z-ADD*ZERO     WN0065  52       PWLW Max Mid Lo
     C                     Z-ADD*ZERO     WN0066  52       PWLW Min Mid Hi
     C                     Z-ADD*ZERO     WN0067  52       PWLW Max Mid Hi
     C                     Z-ADD*ZERO     WN0068  52       PWLW Min Lower
     C                     Z-ADD*ZERO     WN0069  52       PWLW Max Lower
     C                     Z-ADD*ZERO     WN0070  52       PWLW Min Top So
     C                     Z-ADD*ZERO     WN0071  52       PWLW Max Top So
     C                     Z-ADD*ZERO     WN0072  52       PWLW Min Mid Lo
     C                     Z-ADD*ZERO     WN0073  52       PWLW Max Mid Lo
     C                     Z-ADD*ZERO     WN0074  52       PWLW Min Mid Hi
     C                     Z-ADD*ZERO     WN0075  52       PWLW Max Mid Hi
     C                     Z-ADD*ZERO     WN0076  52       PWLW Min Lower
     C                     Z-ADD*ZERO     WN0077  52       PWLW Max Lower
     C                     MOVEL*BLANK    WN0078 10        RS User Changed
     C                     Z-ADD*ZERO     WN0079  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0080  60       RS Time Changed
     C                     MOVEL*BLANK    WN0081  1        RS Record Statu
     C                     MOVEL*BLANK    WN0082 10        RS Job
     C                     MOVEL*BLANK    WN0083 10        RS Program
     C                     MOVEL*BLANK    WN0084 10        RS User Added
     C                     Z-ADD*ZERO     WN0085  70       RS Date Added
     C                     Z-ADD*ZERO     WN0086  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @C2CPOO
     C                     Z-ADDWGHONB    WDHONB           CC Company Numb
     C                     Z-ADDWGMHNB    WDMHNB           CWL Min Adj Liv
     C                     Z-ADDWGMINB    WDMINB           CWL Max Adj Liv
     C                     MOVELWGABCD    WDABCD    P      PD Producer Cod
     C                     Z-ADDWGCIDT    WDCIDT           PWLW Week Endin
      *
     C           KLCHSJ    KLIST
     C                     KFLD           WDHONB           CC Company Numb
     C                     KFLD           WDMHNB           CWL Min Adj Liv
     C                     KFLD           WDMINB           CWL Max Adj Liv
     C                     KFLD           WDABCD           PD Producer Cod
     C                     KFLD           WDCIDT           PWLW Week Endin
     C           KLCHSJ    CHAIN@C2CPOO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKC2CPL0'MDACP
     C                     MOVEL'@C2CPOO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKC21    YARDCS
      * Move non-key fields to @C2CPOO
     C                     Z-ADDWN0035    WDMMNB           PWLW Head Kille
     C                     Z-ADDWN0036    WDNUNB           PWLW Tattoo Cou
      *
      * Set PGM.*Record Data Changed flag
     C           QPKC21    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKC21    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@C2CPOO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKC2CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Upd Top/Mid/Low Data  RT - Crc Sum Prd Wgt Lot  WK  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0087 110       Tattoo Count US
     C                     Z-ADD*ZERO     WN0088  52       PWLW Min Top Yi
     C                     Z-ADD*ZERO     WN0089  52       PWLW Max Top Yi
     C                     Z-ADD*ZERO     WN0090  52       PWLW Min Mid Lo
     C                     Z-ADD*ZERO     WN0091  52       PWLW Max Mid Lo
     C                     Z-ADD*ZERO     WN0092  52       PWLW Min Mid Hi
     C                     Z-ADD*ZERO     WN0093  52       PWLW Max Mid Hi
     C                     Z-ADD*ZERO     WN0094  52       PWLW Min Lower
     C                     Z-ADD*ZERO     WN0095  52       PWLW Max Lower
     C                     Z-ADD*ZERO     WN0096  30       PWLW Min Top Le
     C                     Z-ADD*ZERO     WN0097  30       PWLW Max Top Le
     C                     Z-ADD*ZERO     WN0098  30       PWLW Min Mid Lo
     C                     Z-ADD*ZERO     WN0099  30       PWLW Max Mid Lo
     C                     Z-ADD*ZERO     WN0100  30       PWLW Min Mid Hi
     C                     Z-ADD*ZERO     WN0101  30       PWLW Max Mid Hi
     C                     Z-ADD*ZERO     WN0102  30       PWLW Min Lower
     C                     Z-ADD*ZERO     WN0103  30       PWLW Max Lower
     C                     Z-ADD*ZERO     WN0104  52       PWLW Min Top Le
     C                     Z-ADD*ZERO     WN0105  52       PWLW Max Top Le
     C                     Z-ADD*ZERO     WN0106  52       PWLW Min Mid Lo
     C                     Z-ADD*ZERO     WN0107  52       PWLW Max Mid Lo
     C                     Z-ADD*ZERO     WN0108  52       PWLW Min Mid Hi
     C                     Z-ADD*ZERO     WN0109  52       PWLW Max Mid Hi
     C                     Z-ADD*ZERO     WN0110  52       PWLW Min Lower
     C                     Z-ADD*ZERO     WN0111  52       PWLW Max Lower
     C                     Z-ADD*ZERO     WN0112  52       PWLW Min Top So
     C                     Z-ADD*ZERO     WN0113  52       PWLW Max Top So
     C                     Z-ADD*ZERO     WN0114  52       PWLW Min Mid Lo
     C                     Z-ADD*ZERO     WN0115  52       PWLW Max Mid Lo
     C                     Z-ADD*ZERO     WN0116  52       PWLW Min Mid Hi
     C                     Z-ADD*ZERO     WN0117  52       PWLW Max Mid Hi
     C                     Z-ADD*ZERO     WN0118  52       PWLW Min Lower
     C                     Z-ADD*ZERO     WN0119  52       PWLW Max Lower
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHONB    WQSK01           CC Company Numb
     C           *LIKE     DEFN WCCIDT    WQSK02           PWLW Week Endin
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           CC Company Numb
     C                     KFLD           WQSK02           PWLW Week Endin
      * Setup key
     C                     Z-ADDP1HONB    WQSK01           CC Company Numb
     C                     Z-ADDP2BHDT    WQSK02           PWLW Week Endin
      * Establish starting position
     C           KRSSK     SETLL@C2CPPN                    *
     C           KRSSK     READE@C2CPPN                  90*
      * Data record not found
     C   90                MOVEL'PRK0430' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0087           Tattoo Count US
     C                     Z-ADD*ZERO     WN0088           PWLW Min Top Yi
     C                     Z-ADD*ZERO     WN0089           PWLW Max Top Yi
     C                     Z-ADD*ZERO     WN0090           PWLW Min Mid Lo
     C                     Z-ADD*ZERO     WN0091           PWLW Max Mid Lo
     C                     Z-ADD*ZERO     WN0092           PWLW Min Mid Hi
     C                     Z-ADD*ZERO     WN0093           PWLW Max Mid Hi
     C                     Z-ADD*ZERO     WN0094           PWLW Min Lower
     C                     Z-ADD*ZERO     WN0095           PWLW Max Lower
     C                     Z-ADD*ZERO     WN0096           PWLW Min Top Le
     C                     Z-ADD*ZERO     WN0097           PWLW Max Top Le
     C                     Z-ADD*ZERO     WN0098           PWLW Min Mid Lo
     C                     Z-ADD*ZERO     WN0099           PWLW Max Mid Lo
     C                     Z-ADD*ZERO     WN0100           PWLW Min Mid Hi
     C                     Z-ADD*ZERO     WN0101           PWLW Max Mid Hi
     C                     Z-ADD*ZERO     WN0102           PWLW Min Lower
     C                     Z-ADD*ZERO     WN0103           PWLW Max Lower
     C                     Z-ADD*ZERO     WN0104           PWLW Min Top Le
     C                     Z-ADD*ZERO     WN0105           PWLW Max Top Le
     C                     Z-ADD*ZERO     WN0106           PWLW Min Mid Lo
     C                     Z-ADD*ZERO     WN0107           PWLW Max Mid Lo
     C                     Z-ADD*ZERO     WN0108           PWLW Min Mid Hi
     C                     Z-ADD*ZERO     WN0109           PWLW Max Mid Hi
     C                     Z-ADD*ZERO     WN0110           PWLW Min Lower
     C                     Z-ADD*ZERO     WN0111           PWLW Max Lower
     C                     Z-ADD*ZERO     WN0112           PWLW Min Top So
     C                     Z-ADD*ZERO     WN0113           PWLW Max Top So
     C                     Z-ADD*ZERO     WN0114           PWLW Min Mid Lo
     C                     Z-ADD*ZERO     WN0115           PWLW Max Mid Lo
     C                     Z-ADD*ZERO     WN0116           PWLW Min Mid Hi
     C                     Z-ADD*ZERO     WN0117           PWLW Max Mid Hi
     C                     Z-ADD*ZERO     WN0118           PWLW Min Lower
     C                     Z-ADD*ZERO     WN0119           PWLW Max Lower
     C           WCNUNB    DIV  4         WN0087           Tattoo Count US
      * CASE: PAR.Tattoo Count USR GT WRK.Zero USR
     C           WN0087    IFGT WUE9NB                     *IF
      * Rtv Top/Mid/Low Lean% RT - Crc Sum Tto Wgt Lot  WRK  * 
     C                     EXSR SLRVGN
      * Rtv Top/Mid/Low Yield RT - Crc Sum Tto Wgt Lot  WRK  * 
     C                     EXSR SMRVGN
      * Rtv Top/Mid/Low LnPrm RT - Crc Sum Tto Wgt Lot  WRK  * 
     C                     EXSR SNRVGN
      * Rtv Top/Mid/Low SrtDs RT - Crc Sum Tto Wgt Lot  WRK  * 
     C                     EXSR SORVGN
      * Chg Top/Mid//Low      CH - Crc Sum Prd Wgt Lot  WK  * 
     C                     EXSR SPCHRC
     C                     END                             *FI
     C           KRSSK     READE@C2CPPN                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Top/Mid/Low Lean% RT - Crc Sum Tto Wgt Lot  WRK  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUICNB           Head Count
     C                     Z-ADD1         WUN0NB           Tattoo Quad Cou
     C                     MOVEL'Y'       WUHBST           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHHONB    WQSL01           CC Company Numb
     C           *LIKE     DEFN WHMHNB    WQSL02           CWL Min Adj Liv
     C           *LIKE     DEFN WHMINB    WQSL03           CWL Max Adj Liv
     C           *LIKE     DEFN WHABCD    WQSL04           PD Producer Cod
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           CC Company Numb
     C                     KFLD           WQSL02           CWL Min Adj Liv
     C                     KFLD           WQSL03           CWL Max Adj Liv
     C                     KFLD           WQSL04           PD Producer Cod
      * Setup key
     C                     Z-ADDWCHONB    WQSL01           CC Company Numb
     C                     Z-ADDWCMHNB    WQSL02           CWL Min Adj Liv
     C                     Z-ADDWCMINB    WQSL03           CWL Max Adj Liv
     C                     MOVELWCABCD    WQSL04           PD Producer Cod
      * Establish starting position
     C           KRSSL     SETLL@C5CPPP                    *
     C           KRSSL     READE@C5CPPP                  90*
      * Data record not found
     C   90                MOVEL'PRK0444' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         WUICNB           Head Count
      * Min Lean %
      * CASE: Quad 1 & Head Count = 1
      *  - c1 AND c2
      *   |- c1    : WRK.Tattoo Quad Count USR is = 1
      *   |- c2    : WRK.Head Count is = 1
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUN0NB    IFEQ 1                          *IF
     C           WUICNB    IFEQ 1                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWHF4NB    WN0102           PWLW Min Lower
     C                     ELSE
      * CASE: Quad 2 & Head Count = 1
      *  - c1 AND c2
      *   |- c1    : WRK.Tattoo Quad Count USR is = 2
      *   |- c2    : WRK.Head Count is = 1
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUN0NB    IFEQ 2                          *IF
     C           WUICNB    IFEQ 1                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWHF4NB    WN0098           PWLW Min Mid Lo
     C                     ELSE
      * CASE: Quad 3 & Head Count = 1
      *  - c1 AND c2
      *   |- c1    : WRK.Tattoo Quad Count USR is = 3
      *   |- c2    : WRK.Head Count is = 1
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUN0NB    IFEQ 3                          *IF
     C           WUICNB    IFEQ 1                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWHF4NB    WN0100           PWLW Min Mid Hi
     C                     ELSE
      * CASE: Quad 4 & Head Count = 1
      *  - c1 AND c2
      *   |- c1    : WRK.Tattoo Quad Count USR is = 4
      *   |- c2    : WRK.Head Count is = 1
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUN0NB    IFEQ 4                          *IF
     C           WUICNB    IFEQ 1                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWHF4NB    WN0096           PWLW Min Top Le
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Max Lean %
      * CASE: Quad 1 & Tattoo Count = Head Count
      *  - c1 AND c2
      *   |- c1    : WRK.Tattoo Quad Count USR is = 1
      *   |- c2    : PAR.Tattoo Count USR EQ WRK.Head Count
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUN0NB    IFEQ 1                          *IF
     C           WN0087    IFEQ WUICNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWHF4NB    WN0103           PWLW Max Lower
     C                     Z-ADD*ZERO     WUICNB           Head Count
     C                     ADD  1         WUN0NB           Tattoo Quad Cou
     C                     ELSE
      * CASE: Quad 2 & Tattoo Count = Head Count
      *  - c1 AND c2
      *   |- c1    : WRK.Tattoo Quad Count USR is = 2
      *   |- c2    : PAR.Tattoo Count USR EQ WRK.Head Count
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUN0NB    IFEQ 2                          *IF
     C           WN0087    IFEQ WUICNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWHF4NB    WN0099           PWLW Max Mid Lo
     C                     Z-ADD*ZERO     WUICNB           Head Count
     C                     ADD  1         WUN0NB           Tattoo Quad Cou
     C                     ELSE
      * CASE: Quad 3 & Tattoo Count = Head Count
      *  - c1 AND c2
      *   |- c1    : WRK.Tattoo Quad Count USR is = 3
      *   |- c2    : PAR.Tattoo Count USR EQ WRK.Head Count
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUN0NB    IFEQ 3                          *IF
     C           WN0087    IFEQ WUICNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWHF4NB    WN0101           PWLW Max Mid Hi
     C                     Z-ADD*ZERO     WUICNB           Head Count
     C                     ADD  1         WUN0NB           Tattoo Quad Cou
     C                     ELSE
      * CASE: WRK.Tattoo Quad Count USR is = 4
     C           WUN0NB    IFEQ 4                          *IF
     C                     Z-ADDWHF4NB    WN0097           PWLW Max Top Le
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSL     READE@C5CPPP                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Top/Mid/Low Yield RT - Crc Sum Tto Wgt Lot  WRK  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUICNB           Head Count
     C                     Z-ADD1         WUN0NB           Tattoo Quad Cou
     C                     MOVEL'Y'       WUHBST           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIHONB    WQSM01           CC Company Numb
     C           *LIKE     DEFN WIMHNB    WQSM02           CWL Min Adj Liv
     C           *LIKE     DEFN WIMINB    WQSM03           CWL Max Adj Liv
     C           *LIKE     DEFN WIABCD    WQSM04           PD Producer Cod
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           CC Company Numb
     C                     KFLD           WQSM02           CWL Min Adj Liv
     C                     KFLD           WQSM03           CWL Max Adj Liv
     C                     KFLD           WQSM04           PD Producer Cod
      * Setup key
     C                     Z-ADDWCHONB    WQSM01           CC Company Numb
     C                     Z-ADDWCMHNB    WQSM02           CWL Min Adj Liv
     C                     Z-ADDWCMINB    WQSM03           CWL Max Adj Liv
     C                     MOVELWCABCD    WQSM04           PD Producer Cod
      * Establish starting position
     C           KRSSM     SETLL@C5CPPQ                    *
     C           KRSSM     READE@C5CPPQ                  90*
      * Data record not found
     C   90                MOVEL'PRK0444' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         WUICNB           Head Count
      * Min Actual Yield
      * CASE: Quad 1 & Head Count = 1
      *  - c1 AND c2
      *   |- c1    : WRK.Tattoo Quad Count USR is = 1
      *   |- c2    : WRK.Head Count is = 1
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUN0NB    IFEQ 1                          *IF
     C           WUICNB    IFEQ 1                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWIAWPC    WN0094           PWLW Min Lower
     C                     ELSE
      * CASE: Quad 2 & Head Count = 1
      *  - c1 AND c2
      *   |- c1    : WRK.Tattoo Quad Count USR is = 2
      *   |- c2    : WRK.Head Count is = 1
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUN0NB    IFEQ 2                          *IF
     C           WUICNB    IFEQ 1                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWIAWPC    WN0090           PWLW Min Mid Lo
     C                     ELSE
      * CASE: Quad 3 & Head Count = 1
      *  - c1 AND c2
      *   |- c1    : WRK.Tattoo Quad Count USR is = 3
      *   |- c2    : WRK.Head Count is = 1
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUN0NB    IFEQ 3                          *IF
     C           WUICNB    IFEQ 1                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWIAWPC    WN0092           PWLW Min Mid Hi
     C                     ELSE
      * CASE: Quad 4 & Head Count = 1
      *  - c1 AND c2
      *   |- c1    : WRK.Tattoo Quad Count USR is = 4
      *   |- c2    : WRK.Head Count is = 1
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUN0NB    IFEQ 4                          *IF
     C           WUICNB    IFEQ 1                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWIAWPC    WN0088           PWLW Min Top Yi
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Max Actual Yield
      * CASE: Quad 1 & Tattoo Count = Head Count
      *  - c1 AND c2
      *   |- c1    : WRK.Tattoo Quad Count USR is = 1
      *   |- c2    : PAR.Tattoo Count USR EQ WRK.Head Count
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUN0NB    IFEQ 1                          *IF
     C           WN0087    IFEQ WUICNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWIAWPC    WN0095           PWLW Max Lower
     C                     Z-ADD*ZERO     WUICNB           Head Count
     C                     ADD  1         WUN0NB           Tattoo Quad Cou
     C                     ELSE
      * CASE: Quad 2 & Tattoo Count = Head Count
      *  - c1 AND c2
      *   |- c1    : WRK.Tattoo Quad Count USR is = 2
      *   |- c2    : PAR.Tattoo Count USR EQ WRK.Head Count
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUN0NB    IFEQ 2                          *IF
     C           WN0087    IFEQ WUICNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWIAWPC    WN0091           PWLW Max Mid Lo
     C                     Z-ADD*ZERO     WUICNB           Head Count
     C                     ADD  1         WUN0NB           Tattoo Quad Cou
     C                     ELSE
      * CASE: Quad 3 & Tattoo Count = Head Count
      *  - c1 AND c2
      *   |- c1    : WRK.Tattoo Quad Count USR is = 3
      *   |- c2    : PAR.Tattoo Count USR EQ WRK.Head Count
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUN0NB    IFEQ 3                          *IF
     C           WN0087    IFEQ WUICNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWIAWPC    WN0093           PWLW Max Mid Hi
     C                     Z-ADD*ZERO     WUICNB           Head Count
     C                     ADD  1         WUN0NB           Tattoo Quad Cou
     C                     ELSE
      * CASE: WRK.Tattoo Quad Count USR is = 4
     C           WUN0NB    IFEQ 4                          *IF
     C                     Z-ADDWIAWPC    WN0089           PWLW Max Top Yi
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSM     READE@C5CPPQ                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Top/Mid/Low LnPrm RT - Crc Sum Tto Wgt Lot  WRK  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUICNB           Head Count
     C                     Z-ADD1         WUN0NB           Tattoo Quad Cou
     C                     MOVEL'Y'       WUHBST           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJHONB    WQSN01           CC Company Numb
     C           *LIKE     DEFN WJMHNB    WQSN02           CWL Min Adj Liv
     C           *LIKE     DEFN WJMINB    WQSN03           CWL Max Adj Liv
     C           *LIKE     DEFN WJABCD    WQSN04           PD Producer Cod
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           CC Company Numb
     C                     KFLD           WQSN02           CWL Min Adj Liv
     C                     KFLD           WQSN03           CWL Max Adj Liv
     C                     KFLD           WQSN04           PD Producer Cod
      * Setup key
     C                     Z-ADDWCHONB    WQSN01           CC Company Numb
     C                     Z-ADDWCMHNB    WQSN02           CWL Min Adj Liv
     C                     Z-ADDWCMINB    WQSN03           CWL Max Adj Liv
     C                     MOVELWCABCD    WQSN04           PD Producer Cod
      * Establish starting position
     C           KRSSN     SETLL@C5CPPR                    *
     C           KRSSN     READE@C5CPPR                  90*
      * Data record not found
     C   90                MOVEL'PRK0444' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         WUICNB           Head Count
      * Min Lean Premium Live /CWT
      * CASE: Quad 1 & Head Count = 1
      *  - c1 AND c2
      *   |- c1    : WRK.Tattoo Quad Count USR is = 1
      *   |- c2    : WRK.Head Count is = 1
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUN0NB    IFEQ 1                          *IF
     C           WUICNB    IFEQ 1                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWJEEPR    WN0110           PWLW Min Lower
     C                     ELSE
      * CASE: Quad 2 & Head Count = 1
      *  - c1 AND c2
      *   |- c1    : WRK.Tattoo Quad Count USR is = 2
      *   |- c2    : WRK.Head Count is = 1
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUN0NB    IFEQ 2                          *IF
     C           WUICNB    IFEQ 1                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWJEEPR    WN0106           PWLW Min Mid Lo
     C                     ELSE
      * CASE: Quad 3 & Head Count = 1
      *  - c1 AND c2
      *   |- c1    : WRK.Tattoo Quad Count USR is = 3
      *   |- c2    : WRK.Head Count is = 1
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUN0NB    IFEQ 3                          *IF
     C           WUICNB    IFEQ 1                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWJEEPR    WN0108           PWLW Min Mid Hi
     C                     ELSE
      * CASE: Quad 4 & Head Count = 1
      *  - c1 AND c2
      *   |- c1    : WRK.Tattoo Quad Count USR is = 4
      *   |- c2    : WRK.Head Count is = 1
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUN0NB    IFEQ 4                          *IF
     C           WUICNB    IFEQ 1                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWJEEPR    WN0104           PWLW Min Top Le
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Max Lean Premium Live /CWT
      * CASE: Quad 1 & Tattoo Count = Head Count
      *  - c1 AND c2
      *   |- c1    : WRK.Tattoo Quad Count USR is = 1
      *   |- c2    : PAR.Tattoo Count USR EQ WRK.Head Count
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUN0NB    IFEQ 1                          *IF
     C           WN0087    IFEQ WUICNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWJEEPR    WN0111           PWLW Max Lower
     C                     Z-ADD*ZERO     WUICNB           Head Count
     C                     ADD  1         WUN0NB           Tattoo Quad Cou
     C                     ELSE
      * CASE: Quad 2 & Tattoo Count = Head Count
      *  - c1 AND c2
      *   |- c1    : WRK.Tattoo Quad Count USR is = 2
      *   |- c2    : PAR.Tattoo Count USR EQ WRK.Head Count
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUN0NB    IFEQ 2                          *IF
     C           WN0087    IFEQ WUICNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWJEEPR    WN0107           PWLW Max Mid Lo
     C                     Z-ADD*ZERO     WUICNB           Head Count
     C                     ADD  1         WUN0NB           Tattoo Quad Cou
     C                     ELSE
      * CASE: Quad 3 & Tattoo Count = Head Count
      *  - c1 AND c2
      *   |- c1    : WRK.Tattoo Quad Count USR is = 3
      *   |- c2    : PAR.Tattoo Count USR EQ WRK.Head Count
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUN0NB    IFEQ 3                          *IF
     C           WN0087    IFEQ WUICNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWJEEPR    WN0109           PWLW Max Mid Hi
     C                     Z-ADD*ZERO     WUICNB           Head Count
     C                     ADD  1         WUN0NB           Tattoo Quad Cou
     C                     ELSE
      * CASE: WRK.Tattoo Quad Count USR is = 4
     C           WUN0NB    IFEQ 4                          *IF
     C                     Z-ADDWJEEPR    WN0105           PWLW Max Top Le
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSN     READE@C5CPPR                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Top/Mid/Low SrtDs RT - Crc Sum Tto Wgt Lot  WRK  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUICNB           Head Count
     C                     Z-ADD1         WUN0NB           Tattoo Quad Cou
     C                     MOVEL'Y'       WUHBST           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKHONB    WQSO01           CC Company Numb
     C           *LIKE     DEFN WKMHNB    WQSO02           CWL Min Adj Liv
     C           *LIKE     DEFN WKMINB    WQSO03           CWL Max Adj Liv
     C           *LIKE     DEFN WKABCD    WQSO04           PD Producer Cod
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           CC Company Numb
     C                     KFLD           WQSO02           CWL Min Adj Liv
     C                     KFLD           WQSO03           CWL Max Adj Liv
     C                     KFLD           WQSO04           PD Producer Cod
      * Setup key
     C                     Z-ADDWCHONB    WQSO01           CC Company Numb
     C                     Z-ADDWCMHNB    WQSO02           CWL Min Adj Liv
     C                     Z-ADDWCMINB    WQSO03           CWL Max Adj Liv
     C                     MOVELWCABCD    WQSO04           PD Producer Cod
      * Establish starting position
     C           KRSSO     SETLL@C5CPPS                    *
     C           KRSSO     READE@C5CPPS                  90*
      * Data record not found
     C   90                MOVEL'PRK0444' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         WUICNB           Head Count
      * Min Sort Discount Live /CWT
      * CASE: Quad 1 & Head Count = 1
      *  - c1 AND c2
      *   |- c1    : WRK.Tattoo Quad Count USR is = 1
      *   |- c2    : WRK.Head Count is = 1
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUN0NB    IFEQ 1                          *IF
     C           WUICNB    IFEQ 1                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWKD8PR    WN0118           PWLW Min Lower
     C                     ELSE
      * CASE: Quad 2 & Head Count = 1
      *  - c1 AND c2
      *   |- c1    : WRK.Tattoo Quad Count USR is = 2
      *   |- c2    : WRK.Head Count is = 1
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUN0NB    IFEQ 2                          *IF
     C           WUICNB    IFEQ 1                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWKD8PR    WN0114           PWLW Min Mid Lo
     C                     ELSE
      * CASE: Quad 3 & Head Count = 1
      *  - c1 AND c2
      *   |- c1    : WRK.Tattoo Quad Count USR is = 3
      *   |- c2    : WRK.Head Count is = 1
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUN0NB    IFEQ 3                          *IF
     C           WUICNB    IFEQ 1                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWKD8PR    WN0116           PWLW Min Mid Hi
     C                     ELSE
      * CASE: Quad 4 & Head Count = 1
      *  - c1 AND c2
      *   |- c1    : WRK.Tattoo Quad Count USR is = 4
      *   |- c2    : WRK.Head Count is = 1
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUN0NB    IFEQ 4                          *IF
     C           WUICNB    IFEQ 1                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWKD8PR    WN0112           PWLW Min Top So
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Max Sort Discount Live /CWT
      * CASE: Quad 1 & Tattoo Count = Head Count
      *  - c1 AND c2
      *   |- c1    : WRK.Tattoo Quad Count USR is = 1
      *   |- c2    : PAR.Tattoo Count USR EQ WRK.Head Count
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUN0NB    IFEQ 1                          *IF
     C           WN0087    IFEQ WUICNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWKD8PR    WN0119           PWLW Max Lower
     C                     Z-ADD*ZERO     WUICNB           Head Count
     C                     ADD  1         WUN0NB           Tattoo Quad Cou
     C                     ELSE
      * CASE: Quad 2 & Tattoo Count = Head Count
      *  - c1 AND c2
      *   |- c1    : WRK.Tattoo Quad Count USR is = 2
      *   |- c2    : PAR.Tattoo Count USR EQ WRK.Head Count
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUN0NB    IFEQ 2                          *IF
     C           WN0087    IFEQ WUICNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWKD8PR    WN0115           PWLW Max Mid Lo
     C                     Z-ADD*ZERO     WUICNB           Head Count
     C                     ADD  1         WUN0NB           Tattoo Quad Cou
     C                     ELSE
      * CASE: Quad 3 & Tattoo Count = Head Count
      *  - c1 AND c2
      *   |- c1    : WRK.Tattoo Quad Count USR is = 3
      *   |- c2    : PAR.Tattoo Count USR EQ WRK.Head Count
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUN0NB    IFEQ 3                          *IF
     C           WN0087    IFEQ WUICNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWKD8PR    WN0117           PWLW Max Mid Hi
     C                     Z-ADD*ZERO     WUICNB           Head Count
     C                     ADD  1         WUN0NB           Tattoo Quad Cou
     C                     ELSE
      * CASE: WRK.Tattoo Quad Count USR is = 4
     C           WUN0NB    IFEQ 4                          *IF
     C                     Z-ADDWKD8PR    WN0113           PWLW Max Top So
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSO     READE@C5CPPS                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPCHRC    BEGSR
      *================================================================
      * Chg Top/Mid//Low      CH - Crc Sum Prd Wgt Lot  WK  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0120  70       PWLW Head Kille
     C                     Z-ADD*ZERO     WN0121 110       PWLW Tattoo Cou
     C                     MOVEL*BLANK    WN0122 10        RS User Changed
     C                     Z-ADD*ZERO     WN0123  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0124  60       RS Time Changed
     C                     MOVEL*BLANK    WN0125  1        RS Record Statu
     C                     MOVEL*BLANK    WN0126 10        RS Job
     C                     MOVEL*BLANK    WN0127 10        RS Program
     C                     MOVEL*BLANK    WN0128 10        RS User Added
     C                     Z-ADD*ZERO     WN0129  70       RS Date Added
     C                     Z-ADD*ZERO     WN0130  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @C2CPOO
     C                     Z-ADDWCHONB    WDHONB           CC Company Numb
     C                     Z-ADDWCMHNB    WDMHNB           CWL Min Adj Liv
     C                     Z-ADDWCMINB    WDMINB           CWL Max Adj Liv
     C                     MOVELWCABCD    WDABCD    P      PD Producer Cod
     C                     Z-ADDWCCIDT    WDCIDT           PWLW Week Endin
      *
     C           KLCHSP    KLIST
     C                     KFLD           WDHONB           CC Company Numb
     C                     KFLD           WDMHNB           CWL Min Adj Liv
     C                     KFLD           WDMINB           CWL Max Adj Liv
     C                     KFLD           WDABCD           PD Producer Cod
     C                     KFLD           WDCIDT           PWLW Week Endin
     C           KLCHSP    CHAIN@C2CPOO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKC2CPL0'MDACP
     C                     MOVEL'@C2CPOO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKC21    YBRDCS
      * Move non-key fields to @C2CPOO
     C                     Z-ADDWN0088    WDB0PC           PWLW Min Top Yi
     C                     Z-ADDWN0089    WDB1PC           PWLW Max Top Yi
     C                     Z-ADDWN0090    WDB2PC           PWLW Min Mid Lo
     C                     Z-ADDWN0091    WDB3PC           PWLW Max Mid Lo
     C                     Z-ADDWN0092    WDB4PC           PWLW Min Mid Hi
     C                     Z-ADDWN0093    WDB5PC           PWLW Max Mid Hi
     C                     Z-ADDWN0094    WDB6PC           PWLW Min Lower
     C                     Z-ADDWN0095    WDB7PC           PWLW Max Lower
     C                     Z-ADDWN0096    WDB8PC           PWLW Min Top Le
     C                     Z-ADDWN0097    WDB9PC           PWLW Max Top Le
     C                     Z-ADDWN0098    WDCAPC           PWLW Min Mid Lo
     C                     Z-ADDWN0099    WDCBPC           PWLW Max Mid Lo
     C                     Z-ADDWN0100    WDCCPC           PWLW Min Mid Hi
     C                     Z-ADDWN0101    WDCDPC           PWLW Max Mid Hi
     C                     Z-ADDWN0102    WDCEPC           PWLW Min Lower
     C                     Z-ADDWN0103    WDCFPC           PWLW Max Lower
     C                     Z-ADDWN0104    WDDAPR           PWLW Min Top Le
     C                     Z-ADDWN0105    WDDBPR           PWLW Max Top Le
     C                     Z-ADDWN0106    WDDCPR           PWLW Min Mid Lo
     C                     Z-ADDWN0107    WDDDPR           PWLW Max Mid Lo
     C                     Z-ADDWN0108    WDDEPR           PWLW Min Mid Hi
     C                     Z-ADDWN0109    WDDFPR           PWLW Max Mid Hi
     C                     Z-ADDWN0110    WDDGPR           PWLW Min Lower
     C                     Z-ADDWN0111    WDDHPR           PWLW Max Lower
     C                     Z-ADDWN0112    WDDIPR           PWLW Min Top So
     C                     Z-ADDWN0113    WDDJPR           PWLW Max Top So
     C                     Z-ADDWN0114    WDDKPR           PWLW Min Mid Lo
     C                     Z-ADDWN0115    WDDLPR           PWLW Max Mid Lo
     C                     Z-ADDWN0116    WDDMPR           PWLW Min Mid Hi
     C                     Z-ADDWN0117    WDDNPR           PWLW Max Mid Hi
     C                     Z-ADDWN0118    WDDOPR           PWLW Min Lower
     C                     Z-ADDWN0119    WDDPPR           PWLW Max Lower
      *
      * Set PGM.*Record Data Changed flag
     C           QPKC21    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKC21    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@C2CPOO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKC2CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * H16853 ISE 11/09/2020 - Recompiled due to change in Buy Order Num
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field #Sequence Block
     C                     MOVEL*BLANK    WUJ0ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHONB           CC Company Numb
     C                     Z-ADD*ZERO     WAMHNB           CWL Min Adj Liv
     C                     Z-ADD*ZERO     WAMINB           CWL Max Adj Liv
     C                     Z-ADD*ZERO     WAHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WABNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WABONB           BOL Load Number
     C                     Z-ADD*ZERO     WACVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WAB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WAF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WAHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WAF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WAAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WACWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WAEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WAEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WAD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WAD9PR           TH CM Srt Dsc C
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCHONB           CC Company Numb
     C                     Z-ADD*ZERO     WCMHNB           CWL Min Adj Liv
     C                     Z-ADD*ZERO     WCMINB           CWL Max Adj Liv
     C                     Z-ADD*ZERO     WCCIDT           PWLW Week Endin
     C                     Z-ADD*ZERO     WCB0PC           PWLW Min Top Yi
     C                     Z-ADD*ZERO     WCB1PC           PWLW Max Top Yi
     C                     Z-ADD*ZERO     WCB2PC           PWLW Min Mid Lo
     C                     Z-ADD*ZERO     WCB3PC           PWLW Max Mid Lo
     C                     Z-ADD*ZERO     WCB4PC           PWLW Min Mid Hi
     C                     Z-ADD*ZERO     WCB5PC           PWLW Max Mid Hi
     C                     Z-ADD*ZERO     WCB6PC           PWLW Min Lower
     C                     Z-ADD*ZERO     WCB7PC           PWLW Max Lower
     C                     Z-ADD*ZERO     WCB8PC           PWLW Min Top Le
     C                     Z-ADD*ZERO     WCB9PC           PWLW Max Top Le
     C                     Z-ADD*ZERO     WCCAPC           PWLW Min Mid Lo
     C                     Z-ADD*ZERO     WCCBPC           PWLW Max Mid Lo
     C                     Z-ADD*ZERO     WCCCPC           PWLW Min Mid Hi
     C                     Z-ADD*ZERO     WCCDPC           PWLW Max Mid Hi
     C                     Z-ADD*ZERO     WCCEPC           PWLW Min Lower
     C                     Z-ADD*ZERO     WCCFPC           PWLW Max Lower
     C                     Z-ADD*ZERO     WCDAPR           PWLW Min Top Le
     C                     Z-ADD*ZERO     WCDBPR           PWLW Max Top Le
     C                     Z-ADD*ZERO     WCDCPR           PWLW Min Mid Lo
     C                     Z-ADD*ZERO     WCDDPR           PWLW Max Mid Lo
     C                     Z-ADD*ZERO     WCDEPR           PWLW Min Mid Hi
     C                     Z-ADD*ZERO     WCDFPR           PWLW Max Mid Hi
     C                     Z-ADD*ZERO     WCDGPR           PWLW Min Lower
     C                     Z-ADD*ZERO     WCDHPR           PWLW Max Lower
     C                     Z-ADD*ZERO     WCDIPR           PWLW Min Top So
     C                     Z-ADD*ZERO     WCDJPR           PWLW Max Top So
     C                     Z-ADD*ZERO     WCDKPR           PWLW Min Mid Lo
     C                     Z-ADD*ZERO     WCDLPR           PWLW Max Mid Lo
     C                     Z-ADD*ZERO     WCDMPR           PWLW Min Mid Hi
     C                     Z-ADD*ZERO     WCDNPR           PWLW Max Mid Hi
     C                     Z-ADD*ZERO     WCDOPR           PWLW Min Lower
     C                     Z-ADD*ZERO     WCDPPR           PWLW Max Lower
     C                     Z-ADD*ZERO     WCMMNB           PWLW Head Kille
     C                     Z-ADD*ZERO     WCNUNB           PWLW Tattoo Cou
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WEBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WEBONB           BOL Load Number
     C                     Z-ADD*ZERO     WECVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WEB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WEAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WEACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WEB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WECAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WEAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WEA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WECXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WECWNB           TH Head Receive
     C                     Z-ADD*ZERO     WEFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WEH9NB           TH Held Over
     C                     Z-ADD*ZERO     WEFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WEFENB           TH Head Killed
     C                     Z-ADD*ZERO     WEHENB           TH Head Adds
     C                     Z-ADD*ZERO     WEHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WECYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WELRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WEE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WEA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WEFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WEA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WEF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WEHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WEF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WEF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WEF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WEF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WEAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WEAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WECWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WEA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WEA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WEB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WEAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WEANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WEAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WEAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WEAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WEAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WEAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WEASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WEA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WEATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WEA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WECBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WECCPR           Th Payment Net
     C                     Z-ADD*ZERO     WELPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WECDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WEA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WEA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WEGHNB           TH Commission A
     C                     Z-ADD*ZERO     WEBYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WEBSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WEBTDT           TH Commission P
     C                     Z-ADD*ZERO     WEBUDT           TH Actual Check
     C                     Z-ADD*ZERO     WEHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WEHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WEHINB           TH FFLI
     C                     Z-ADD*ZERO     WEA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WEA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WEA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WEJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WED6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WED7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WED8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WED9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WEEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WEEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WEECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WEEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WEEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WEEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WEEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WEEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WEOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WETHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WET2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WETHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WET2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WEOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WEKOER           TH Head Identif
     C                     Z-ADD*ZERO     WEOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WEOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WEIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WEOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WEHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WES9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WETAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WETBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WEJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WEKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WEKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WEKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WEKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WEOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WEIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WEIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WEIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WEKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WEOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WEKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WEORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WEOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WEMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WEMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WENCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WENCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WEIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WEKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WEEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WEEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WEECDT           TH Head LFT
     C                     Z-ADD*ZERO     WEEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WEEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WEAADT           RS Date Changed
     C                     Z-ADD*ZERO     WEAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WEABDT           RS Date Added
     C                     Z-ADD*ZERO     WEABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFHONB           CC Company Numb
     C                     Z-ADD*ZERO     WFMHNB           CWL Min Adj Liv
     C                     Z-ADD*ZERO     WFMINB           CWL Max Adj Liv
     C                     Z-ADD*ZERO     WFAADT           RS Date Changed
     C                     Z-ADD*ZERO     WFAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WFABDT           RS Date Added
     C                     Z-ADD*ZERO     WFABTM           RS Time Added
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Zero USR
     C                     Z-ADD*ZERO     WUE9NB  10
      * Define work field Head Count
     C                     Z-ADD*ZERO     WUICNB  50
      * Define work field Tattoo Quad Count USR
     C                     Z-ADD*ZERO     WUN0NB 110
      * Define work field First Time Flag Usr
     C                     MOVEL*BLANK    WUHBST  1
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
