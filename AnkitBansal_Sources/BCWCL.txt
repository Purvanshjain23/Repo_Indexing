/*  PRINT BACON CREDIT WORKSHEET    */
/*                                                                   */
/*********************************************************************/
/* MODIFICATIONS:                                                    */
/*                                                                   */
/* 06/27/07   LEANNE RAMSEY                                          */
/*            THE DAILY "COST" REPORTS WILL RUN OVER THE NEW SYNON   */
/*              SALES HISTORY FILE--BUT THE OLD DAILY "COST" FILES.  */
/*            TO HANDLE THIS, WE WILL CREATE A WORKFILE OF SUMMARIZED*/
/*              SALES HISTORY DATA. THE WORKFILE WILL BECOME THE NEW */
/*              PRIMARY FILE IN THE OLD DAILY RPG PROGRAMS.          */
/*            ALSO, THIS CL IS NOW EXPECTING "COMPANY" AS IN INCOMING*/
/*              PARM.                                                */
/* 11/09/07   ROSE CENTONZE  -- ITEM TYPE TO SELECT IS 910 - NOT 200  */
/*                                                                   */
/*********************************************************************/

             PGM        PARM(&AIC3) /* Company */

             DCL        VAR(&QDATA) TYPE(*CHAR) LEN(14)
             DCL        VAR(&AIC3)  TYPE(*DEC)  LEN(3)
             DCL        VAR(&WMQY)  TYPE(*CHAR) LEN(1) VALUE('W')

             CHGJOB     SWS(10000000) /* Set U1 ON for BCWCR File +
                          Update */
             CLRPFM     FILE(BCWCR) /* Clear BCWCR File for Update */

             OVRPRTF    FILE(LIST132) HOLD(*YES) SAVE(*YES) +
                          SECURE(*YES)

/*-------------------------------------------------------------------*/
/* The Daily "cost" files have not yet been converted to SYNON files.*/
/* But, the Sales History file has. So, for the following "Cost"     */
/* report, we will build a Sales History workfile to use as the input*/
/* primary file in the old Daily's program.                          */
/*-------------------------------------------------------------------*/

/* Build workfile                                                    */
             CALL       PGM(OM301CL) PARM(&AIC3 &WMQY)

/* Select workfile records where Item Structure Type is Raw Bacon    */

             CHGVAR     VAR(&QDATA) VALUE(' ')
             CHGVAR     VAR(%SST(&QDATA 1 14)) VALUE('A6VMST *EQ "Y"')

             OVRDBF     FILE(PMA6CPL1) SHARE(*YES)
             OPNQRYF    FILE((PMA6CPL1)) QRYSLT(&QDATA) +
                          KEYFLD(*FILE) SEQONLY(*YES)

             CALL       PGM(BCW) /* BACON CREDIT WORKSHEET */

             CLOF       OPNID(PMA6CPL1)
             DLTOVR     FILE(*ALL)

/*-------------------------------------------------------------------*/
/* NOW, RETURN TO REGULAR PROCESSING.                                */
/*-------------------------------------------------------------------*/

             CHGJOB     SWS(00000000)

             ENDPGM
