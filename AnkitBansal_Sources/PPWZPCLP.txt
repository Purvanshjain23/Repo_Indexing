/********************************************************************/
/*  NAME      - PPWZPCLP                                            */
/*  SYNOPSIS  - JOB CONTROL PROMPT FOR PRINTER OVERRIDE INFORMATION */
/*              PROMPTING FUNCTION FOR CUSTOMER COMPANY TRAFFIC     */
/*              INFORMATION                                         */
/*                                                                  */
/*  SYSTEM    - ORDER MANAGEMENT SYSTEM                             */
/*  PROGRAM   - PRINT CUSTOMER COMPANY TRAFFIC INFORMATION          */
/*  DATE      - 02/09/2006 L. BUSER                                 */
/*                                                                  */
/*      PARAMETERS:                                                 */
/*                                                                  */
/*     O    &RETURN     - RETURN CODE                               */
/*     I    &SBMPGM     - CL PROGRAM TO SUBMIT                      */
/*     I    &CALL PGM   - CL PROGRAM CALLED BY SUBMITTED PGM        */
/*     I    &APPLIC     - APPLICATION CODE FOR PROMPT PGM           */
/*     I    &DESCR      - PROGRAM DESCRIPTION                       */
/*     B    &OUTQ       - OUTPUT QUEUE                              */
/*     B    &HOLD       - HOLD STATUS                               */
/*     B    &SAVE       - SAVE STATUS                               */
/*     B    &NQSTAT     - INDICATOR WHETHER MUST RUN IN NIGHT Q     */
/*     B    &NIGHTQ     - NIGHT JOB QUEUE                           */
/*     B    &COMPNYN    - COMPANY NUMBER (PASSED) AS 15.5           */
/*     B    &COPYN      - NO. OF COPIES  (PASSED)                   */
/*                                                                  */
/********************************************************************/
/* MAINTENANCE                                                      */
/* 07/27/06 LJB L60727A ADD SALESPERSON CODE. REMOVE TEST FOR BLANK */
/*                      OUTQ SO PROMPT WILL BE PRESENTED EACH TIME  */
/*                      F22 IS PRESSED.                             */
/* 08/09/06 RMC ADDED RCDSTS PARM                                   */
/********************************************************************/
 PPWZPCLP:   PGM        PARM(&RETURN &SBMPGM &CALLPGM &APPLIC &DESCR +
                          &OUTQ &HOLD &SAVE &NQSTAT &NIGHTQ +
                          &COMPNYN &COPYN &SALESP  &RCDSTS)
/* PARMS                                                                      */
             DCL        VAR(&RETURN) TYPE(*CHAR) LEN(7) /* Return +
                          Code               */
             DCL        VAR(&DESCR) TYPE(*CHAR) LEN(25) /* PRT Pgm +
                          Description       */
             DCL        VAR(&APPLIC) TYPE(*CHAR) LEN(8) /* +
                          Application for prompt */
             DCL        VAR(&SBMPGM) TYPE(*CHAR) LEN(10) /* +
                          Submitted program name */
             DCL        VAR(&CALLPGM) TYPE(*CHAR) LEN(10) /* Pgm +
                          name called by submitting pgm */
             DCL        VAR(&COPYN) TYPE(*DEC) /* No. of +
                          Copies             */
             DCL        VAR(&OUTQ) TYPE(*CHAR) LEN(10) /* Output +
                          Queue              */
             DCL        VAR(&HOLD) TYPE(*CHAR) LEN(4) /* Hold +
                          Status               */
             DCL        VAR(&SAVE) TYPE(*CHAR) LEN(4) /* Save +
                          Status               */
             DCL        VAR(&NQSTAT) TYPE(*CHAR) LEN(01) /* If MUST +
                          run in Night Q    */
             DCL        VAR(&NIGHTQ) TYPE(*CHAR) LEN(10) /* Night +
                          Job Queue           */
             DCL        VAR(&COMPNYN) TYPE(*DEC) /* Company Number +
                          (Passed)   */
             DCL        VAR(&COPYN) TYPE(*DEC) /* No. of Copies  +
                          (Passed)   */
             DCL        VAR(&COPY) TYPE(*DEC) LEN(2 0) /* Number of +
                          copies          */
             DCL        VAR(&SALESP) TYPE(*CHAR) LEN(3) /* +
                          Salesperson Code */
             DCL        VAR(&RCDSTS) TYPE(*CHAR) LEN(1) /* REC STATUS */

/* ERROR MESSAGE FIELDS                                                       */
             DCL        VAR(&MSG) TYPE(*CHAR) LEN(512) /* +
                          message                   */
             DCL        VAR(&MSGID) TYPE(*CHAR) LEN(7) /* message +
                          id                */
             DCL        VAR(&MSGL) TYPE(*DEC) LEN(5 0)

/********************************************************************/
/*   MONITOR FOR ALL MESSAGES AT PROGRAM LEVEL                      */
/********************************************************************/
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(MSGTRAP))

/********************************************************************/
/*   INITIALIZE VARIABLES                                           */
/********************************************************************/
             CHGVAR     VAR(&RETURN) VALUE('       ')
             CHGVAR     VAR(&COPY) VALUE(&COPYN)

/********************************************************************/
/*   CALL PROMPT PROGRAM                                            */
/********************************************************************/
/*****       IF         COND(&OUTQ *EQ '   ') THEN(DO)          *****/
             CALL       PGM(PDG0PVR) PARM(&RETURN &DESCR &OUTQ &HOLD +
                          &SAVE &COPY &NQSTAT &NIGHTQ &APPLIC)
             IF         COND(&RETURN *NE ' ') THEN(GOTO +
                          CMDLBL(USERQUIT))
/*****       ENDDO                                              *****/
             CHGVAR     VAR(&COPYN) VALUE(&COPY)

/********************************************************************/
/*   SUBMIT PRINT CL PROGRAM - PPU9UPC                              */
/********************************************************************/
 SUBMIT:
             SBMJOB     CMD(CALL PGM(&SBMPGM) PARM(&RETURN &CALLPGM +
                          &DESCR &OUTQ &HOLD &SAVE &NQSTAT &NIGHTQ +
                    &COMPNYN &COPYN &SALESP &RCDSTS)) JOB(SLSTRAFINF)

             GOTO       CMDLBL(END)

/*-------------------------USER QUIT--------------------------------*/
 USERQUIT:   CHGVAR     VAR(&RETURN) VALUE('Y2U0005')
             GOTO       CMDLBL(END)

/*----------------------RECEIVE MESSAGES----------------------------*/

 MSGTRAP:    RCVMSG     MSGTYPE(*EXCP) MSGDTA(&MSG) MSGDTALEN(&MSGL) +
                          MSGID(&MSGID)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(END))

             SNDPGMMSG  MSGID(&MSGID) MSGF(QCPFMSG) MSGDTA(%SST(&MSG +
                          1 &MSGL)) MSGTYPE(*ESCAPE)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(END))

 END:        ENDPGM
