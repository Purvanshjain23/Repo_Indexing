/*********************************************************************/
/* PROGRAM : PVJQUPC                                                 */
/* DESC    : PRT WIM API OUTB SHIPERCL EXECUTE USER PROGRAM          */
/* DATE    : 01/31/2025                                              */
/* PROJECT : WI568 - WAREHOUSE INVENTORY MANAGEMENT (WIM)            */
/* BY      : DANNY NGUYEN                                            */
/* PURPOSE : Process will print all 'E'rrors which failed to update  */
/*           the WIM Inventory tables during the WIM API Outbound    */
/*           Shipping process. These transactions are identified as  */
/*           'TIMEOUT' in the WIM API Failure Log (PVADCPP) table    */
/*           during the WIM API Outbound Shipping process.           */
/*           These transactions should NOT occur but if it is then   */
/*           the API did NOT update the WIM Inventory tables.        */
/*           WIM IT will need to investigate why.                    */
/*                                                                   */
/* HOW USE : The Legacy JS 'WIMAPIOBER' runs every 15 mins.          */
/*                                                                   */
/*********************************************************************/
/* MAINTENANCE LOG:                                                  */
/*-------------------------------------------------------------------*/
/* DATE     BY  PROJ      CHANGE DESCRIPTION                         */
/* -------- --- --------- ------------------------------------------ */
/*                                                                   */
/*********************************************************************/

             PGM

             DCL        VAR(&DATA) TYPE(*CHAR) LEN(10)
             DCL        VAR(&DATAH) TYPE(*CHAR) LEN(10)
             DCL        VAR(&EMAILDL) TYPE(*CHAR) LEN(40) VALUE(' ')
             DCL        VAR(&EMAILTXT) TYPE(*CHAR) LEN(120) +
                          VALUE('WIMAPIOBER Sequel: Timeout +
                          Transactions Failed to Update WIM +
                          Inventory for WIM API Outbound Shipping')


/*------------------------------------------------------------------*/
/* GET DATA LIBRARY.                                                */
/*------------------------------------------------------------------*/
             CALL       PGM(CAQXXFR) PARM(' ' &DATA &DATAH)
             IF         COND(&DATA *NE 'PRKFLIB') THEN(DO)
             CHGVAR     VAR(&EMAILTXT) VALUE(&EMAILTXT *BCAT ' - TEST')
             ENDDO

/* GET SYSTEM VALUE FOR WIMAPIOBER - FOR EMAIL DL */
             CALL       PGM(PPJXXFR) PARM((' ') ('WIMAPIOBER') +
                          (&EMAILDL))

/* EMAIL REPORT */
             EXECUTE    VIEW(*LIBL/WIMAPIOBER) PCFMT(*XLS) +
                          RECIPIENT(&EMAILDL) EMLMSG(&EMAILTXT)


 END:
             ENDPGM
