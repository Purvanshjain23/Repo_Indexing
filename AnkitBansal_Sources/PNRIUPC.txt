/*********************************************************************/
/* PROGRAM    : PNRIUPC                                             */
/* TITLE      : GENERIC PROGRAM TO EXECUTE THE RUNSCRIPT COMMAND      */
/* DATE       : 04/20/2010                                           */
/* Description: EXECUTE THE RUNSCRIPT COMMAND                        */
/*                                                                   */
/*  Parameters:                                                      */
/*  Usage   Field       Field Description                            */
/*  -----   ---------   ------------------------------------------   */
/*********************************************************************/
/* Modifications:                                                    */
/*-------------------------------------------------------------------*/
/*   Date     Pgmr     Description                                   */
/* -------- ---------- --------------------------------------------  */
/*                                                                   */
/*********************************************************************/
 PNIRUPC:    PGM        PARM(&RETURN &SCRIPT)

/*-------------------------------------------------------------------*/
/* Declare Variables                                                 */
/*-------------------------------------------------------------------*/
             DCL        VAR(&RETURN)   TYPE(*CHAR) LEN(7)
             DCL        VAR(&SCRIPT)   TYPE(*CHAR) LEN(10)

/* ERROR MESSAGE FIELDS                                                       */
             DCL        VAR(&MSG)   TYPE(*CHAR) LEN(512)
             DCL        VAR(&MSGID) TYPE(*CHAR) LEN(7)
             DCL        VAR(&MSGL)  TYPE(*DEC) LEN(5 0)
             DCL        VAR(&MSG2)  TYPE(*CHAR) LEN(512)

/*-------------------------------------------------------------------*/
/* EXECUTE THE COMMAND AND MONITOR FOR ERRORS                        */
/*-------------------------------------------------------------------*/
             ADDLIBLE   LIB(ESEND)
             MONMSG     MSGID(CPF2103 CPF9999)

             RUNSCRIPT  SCRIPT(&SCRIPT)
             MONMSG     MSGID(CPF9999 EML9999 CPF0000 EML0000) +
                          EXEC(GOTO CMDLBL(MSGTRAP))

MONMSG     MSGID(CPF0000)

             GOTO       CMDLBL(ENDPGM)

/*----------------------RECEIVE MESSAGES----------------------------*/

 MSGTRAP:    SNDMSG     MSG('ERROR IN RUNSCRIPT FOR ' *CAT &SCRIPT  +
                          *BCAT 'in program PNIRUPC') TOUSR(SEABOARD)
             CHGJOB     LOG(4 0 *SECLVL)


 ENDPGM:     RMVLIBLE   LIB(ESEND)
             MONMSG     MSGID(CPF0000)

             ENDPGM
