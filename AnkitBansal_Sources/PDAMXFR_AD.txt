// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PDAMXFR
// ?Date: 14.08.2025 Time: 03:33:50
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?**** See Change Log for explanation of Status Flags *****
//?** Print the load confirmation. Then fax or email if requested.
//?** Fax/Print flag helps determine if **Revised** is printed or not
//?** "Default Carrier Code" is primary carrier and will print on
//?** the subject line of emails
// Call program PRT Load Confirmation  PF.
CALL PROGRAM(PRT Load Confirmation  PF) ('PNW2PFR');
PARAMETER(PAR.Load_ID);
PARAMETER(PAR.Carrier_Code);
PARAMETER(PAR.USR_Status_Y_N);

//?** Processing if Fax/Email is requested       P000737
CASE;

// IF PAR.USR Status (Y/N) is Fax
IF PAR.USR_Status_Y_N = 'F';

//?** The RTV by Carrier RT is the routine that does all the work
//?** Fax or Email Carrier
CASE;

// IF PAR.Status - Y or N is yes
IF PAR.Status_Y_or_N = 'Y';

EXECUTE FUNCTION(VAL Load Exist        RT) TYPE(RTVOBJ) FILE(OMFJCPP)           AC1197457;
PARAMETER(PAR.Load_ID);
{
 //?USER: Processing if Data record not found

 // PGM.*Return code = CND.*Record does not exist
 PGM.*Return_code = 'Y2U0005';

 //?USER: Process Data record

 // PGM.*Return code = CND.*Normal
 PGM.*Return_code = *BLANK;

 QUIT;

}


CASE;

// IF PGM.*Return code is *Record does not exist
IF PGM.*Return_code = 'Y2U0005';

//?dont pos on load id! it wasnt finding a recd for the carrier
EXECUTE FUNCTION(RTV by Carrier-deleted RT) TYPE(RTVOBJ) FILE(OMFJCPP)          AC2022292;
PARAMETER(PAR.Load_ID);
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Carrier_Code);
PARAMETER(PAR.Status_Y_or_N);
PARAMETER(PAR.Status_Flag_1_Y_N);
PARAMETER(PAR.Status_Description_3_USR);
PARAMETER(PAR.USR_Status_Y_N);
PARAMETER(PAR.Default_Carrier_Code);
PARAMETER(*BLANK);
{
 //?USER: Initialize routine

 //?***** Change Log and comments
 DO;

 //?*****
 //?** 07/07/2011 LJB P000737
 //?** This RTV is called to fax to the carrier only. Whse is not
 //?** available since the load was deleted.
 //?*****
 //?** Status - Y or N = Fax to Carrier
 //?** Status Flag 1 Y/N = Fax to Dispatch
 ENDDO;

 // LCL.Fax Recipient 2 = CON.*BLANK
 LCL.Fax_Recipient_2 = *BLANK;

 // LCL.Fax Number FF = CON.*BLANK
 LCL.Fax_Number_FF = *BLANK;

 //?USER: Process Data record

 //?** Only fax to carrier. No access to info for dispatch.
 //?** Fax/email confirmation to carrier
 CASE;

 // IF PAR.Status Flag 11 Y/N is Yes
 IF PAR.Status_Flag_11_Y_N = 'Y';

 // OR PAR.Status Flag 12 Y/N is Yes
 OR PAR.Status_Flag_12_Y_N = 'Y';

 EXECUTE FUNCTION(RTV Co Document Dflts  RT) TYPE(RTVOBJ) FILE(PPAQREP)          AC1823355;
 PARAMETER(PAR.Company_Number);
 PARAMETER('LC');
 PARAMETER('DSPTCH');
 PARAMETER(NLL.CDD_Name_of_Overlay);
 PARAMETER(NLL.CDD_Program_Name);
 PARAMETER(LCL.CDD_Printer_File_Name);
 PARAMETER(NLL.CDD_Sender_Phone);
 PARAMETER(NLL.CDD_Sender_Fax);
 PARAMETER(LCL.Output_Queue);
 PARAMETER(LCL.Hold_File);
 PARAMETER(LCL.Save_File);
 PARAMETER(NLL.Source_Drawer);
 PARAMETER(NLL.Printer_Device_Type);
 PARAMETER(NLL.Page_Length_2);
 PARAMETER(NLL.Page_Width_2);
 PARAMETER(NLL.Page_LPI);
 PARAMETER(NLL.Page_CPI);
 PARAMETER(NLL.Page_Overflow);
 PARAMETER(NLL.Page_Rotation);
 PARAMETER(NLL.CDD_Comment_1);
 PARAMETER(NLL.CDD_Comment_2);
 PARAMETER(NLL.CDD_Comment_3);
 PARAMETER(NLL.CDD_Comment_4);
 PARAMETER(NLL.CDD_Comment_5);
 {
  //?USER: Initialize routine

  //?** Used by HPE in STR Hog Prcr & Eval Sys-HPE System
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 // Execute command - 'EXE OVRPRTF Hold/Save'
 EXECUTE COMMAND(USR4013);
 PARAMETER(LCL.CDD_Printer_File_Name);
 PARAMETER(LCL.Hold_File);
 PARAMETER(LCL.Save_File);

 EXECUTE FUNCTION(RTV Fax Number & Email RT) TYPE(RTVOBJ) FILE(PLAAREP)          AC1790532;
 PARAMETER(PAR.Company_Number);
 PARAMETER(PAR.Carrier_Code);
 PARAMETER(LCL.Fax_Number);
 PARAMETER(LCL.Email_Address);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

  QUIT;

 }

 //?** Fax to Carrier
 //?** Fax to number in Company Carrier file
 CASE;

 // IF PAR.USR Status (Y/N) is Fax
 IF PAR.USR_Status_Y_N = 'F';

 //?** This rtvobj will loop through all fax numbers and email
 //?** addresses for this Carrier by Company     8/21/2006 TRF021 LJB
 //?** Carrier code usr is Carrier for subject line       P000737
 // WRK.CC Sequence Nbr = CON.1
 WRK.CC_Sequence_Nbr = 1;

 EXECUTE FUNCTION(RTV/Send Fax & Email   RT) TYPE(RTVOBJ) FILE(PLAAREP)          AC1790496;
 PARAMETER(PAR.Company_Number);
 PARAMETER(PAR.Carrier_Code);
 PARAMETER(WRK.CC_Sequence_Nbr);
 PARAMETER(LCL.Name);
 PARAMETER(LCL.Fax_Recipient_2);
 PARAMETER(LCL.Fax_Number_FF);
 PARAMETER(PAR.Load_ID);
 PARAMETER(PAR.Status_Description_3_USR);
 PARAMETER(PAR.Carrier_Code_Usr);
 {
  //?USER: Initialize routine

  // LCL.First Time Flag = CND.Yes
  LCL.First_Time_Flag = 'Y';

  //?***** Change Log and comments
  DO;

  //?*****
  //?** 05/25/2011 LJB P000737
  //?** Add 2nd carrier code to hold primary carrier. This is the
  //?** carrier that is printed on the Load Confirmation and will
  //?** print on the subject line for emails
  //?*****
  //?** 12/07/2006 LJB L61207A
  //?** Put fax to dispatch office outside of the test for a fax
  //?** number in the file, since there may only be an email address
  //?*****
  //?** 11/16/2006 LJB L61110A
  //?** Add Load ID and Carrier Code to the Subject Line when
  //?** the Load Confirmation is emailed to the Carrier dispatch office
  ENDDO;

  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  //?** Build the Subject Line: Load Confirm + Load ID + Carrier Code
  // WRK.Text USR 7 = CVTVAR(PAR.Load ID)
  WRK.Text_USR_7 = CVTVAR(PAR.Load_ID);

  // WRK.Text USR 40 = CONCAT(CON.Load Confirmation:,WRK.Text USR 7,CON.1)
  WRK.Text_USR_40 = 'Load Confirmation:' + WRK.Text_USR_7 (1);

  // WRK.Text USR 40 = CONCAT(WRK.Text USR 40,CON.Carrier:,CON.1)
  WRK.Text_USR_40 = WRK.Text_USR_40 + 'Carrier:' (1);

  // WRK.Text USR 40 = CONCAT(WRK.Text USR 40,PAR.Default Carrier Code,CON.1)
  WRK.Text_USR_40 = WRK.Text_USR_40 + PAR.Default_Carrier_Code (1);

  //?** Moved fax to Seaboard dispatch to calling program.   E00170
  //?** Fax to Company Carrier fax number if not blanks
  CASE;

  // IF DB1.CC Fax Number is Entered
  IF DB1.CC_Fax_Number <> *BLANK;

  // Call program PRC Call Telex         UP.
  CALL PROGRAM(PRC Call Telex         UP) ('PODYUPR');
  PARAMETER(PAR.Status_Description_3_USR);
  PARAMETER(WRK.Text_USR_40);
  PARAMETER(*BLANK);
  PARAMETER(PAR.Fax_Recipient);
  PARAMETER(PAR.Fax_Recipient);
  PARAMETER(DB1.CC_Fax_Number);
  PARAMETER(1);
  PARAMETER(*BLANK);
  PARAMETER(*BLANK);

  ENDIF;

  //?** Email Load Confirmation
  CASE;

  // IF DB1.CC Email Address is Entered
  IF DB1.CC_Email_Address <> *BLANK;

  //?** Send to the address in the file if it is not blanks
  // Call program Exc ESNDMAIL to Co CarrUP.
  CALL PROGRAM(Exc ESNDMAIL to Co CarrUP) ('PLAMUPC');
  PARAMETER(PAR.Status_Description_3_USR);
  PARAMETER(WRK.Text_USR_40);
  PARAMETER(DB1.CC_Email_Address);

  ENDIF;

 }

 QUIT;

 ENDIF;

 ENDIF;

}


// IF *OTHERWISE
IF *OTHERWISE;

EXECUTE FUNCTION(RTV by Carrier         RT) TYPE(RTVOBJ) FILE(OMFJCPP)          AC2016292;
PARAMETER(PAR.Load_ID);
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Carrier_Code);
PARAMETER(PAR.Status_Y_or_N);
PARAMETER(PAR.Status_Flag_1_Y_N);
PARAMETER(PAR.Status_Description_3_USR);
PARAMETER(PAR.USR_Status_Y_N);
PARAMETER(PAR.Default_Carrier_Code);
PARAMETER(*BLANK);
{
 //?USER: Initialize routine

 //?***** Change Log and comments
 DO;

 //?*****
 //?** 04/15/2011 LJB P000737
 //?** This RTV is called multiple times based on the prompt values
 //?** Copied from WF Load Confirmation Work file. Load ID added
 //?** to Parm list, pass in the printer file name,
 //?** call EXC LC Fax or Dupsplf CL from the Load Header file
 //?** Add carrier code usr for subject lines
 //?*****
 //?** Status - Y or N = Fax to Carrier
 //?** Status Flag 1 Y/N = Fax to Dispatch
 //?*****
 //?** 01/14/2009 LJB E00330
 //?** Pass Hold and Save parms from CDD file to Dupsplf program
 //?*****
 //?** 12/22/2008 LJB E00303
 //?** Dupsplf to the outq in CDD Additional Object, if it is entered
 //?*****
 //?** 12/04/2008 LJB S00580
 //?** Update Fax Status flag in Load Header if faxed to Carrier
 //?*****
 //?** 08/28/2008 LJB E00170
 //?** If Fax to Dispatch = Y, then also fax to the Ship From Warehouse
 //?** Change to test the status flags instead of the output queues
 //?** Put the print file on hold so it can be emailed and/or printed.
 //?08/27/2008 LJB E00170 - Get fax number or outq from the Company
 //?  Document Defaults file. Fax or print at the shipping
 //?  office and ship from whse also if fax to dispatch = Yes
 //?5/19/04 RMC PKTR01 - added par.company to use when rtv company values
 //?5/16/06 LJB T00008 - Fax Number was changed to 25 characters
 //?8/21/06 LJB TRF021 - Change to fax to number in Company Carrier
 //?  instead of the Carrier file
 //?11/16/2006 LJB L61110A - Add Load ID and Carrier Code to the
 //?  Description (Subject Line) for the email
 //?01/04/2007 LJB L61207B - Recompile only-comment field was lengthened
 //? in the company carrier file
 ENDDO;

 // LCL.Fax Recipient 2 = CON.*BLANK
 LCL.Fax_Recipient_2 = *BLANK;

 // LCL.Fax Number FF = CON.*BLANK
 LCL.Fax_Number_FF = *BLANK;

 //?USER: Processing if Data record not found

 //?Not an error if no rec found
 //?USER: Process Data record

 //?** Only process if there is someone to send the confirmation to
 //?** the load confirm is already printed, no need to print again P000737
 //?** Fax/email confirmation to carrier, dispatch, ship from whse
 CASE;

 // IF PAR.Status Flag 11 Y/N is Yes
 IF PAR.Status_Flag_11_Y_N = 'Y';

 // OR PAR.Status Flag 12 Y/N is Yes
 OR PAR.Status_Flag_12_Y_N = 'Y';

 EXECUTE FUNCTION(RTV Co Document Dflts  RT) TYPE(RTVOBJ) FILE(PPAQREP)          AC1823355;
 PARAMETER(PAR.Company_Number);
 PARAMETER('LC');
 PARAMETER('DSPTCH');
 PARAMETER(NLL.CDD_Name_of_Overlay);
 PARAMETER(NLL.CDD_Program_Name);
 PARAMETER(LCL.CDD_Printer_File_Name);
 PARAMETER(NLL.CDD_Sender_Phone);
 PARAMETER(NLL.CDD_Sender_Fax);
 PARAMETER(LCL.Output_Queue);
 PARAMETER(LCL.Hold_File);
 PARAMETER(LCL.Save_File);
 PARAMETER(NLL.Source_Drawer);
 PARAMETER(NLL.Printer_Device_Type);
 PARAMETER(NLL.Page_Length_2);
 PARAMETER(NLL.Page_Width_2);
 PARAMETER(NLL.Page_LPI);
 PARAMETER(NLL.Page_CPI);
 PARAMETER(NLL.Page_Overflow);
 PARAMETER(NLL.Page_Rotation);
 PARAMETER(NLL.CDD_Comment_1);
 PARAMETER(NLL.CDD_Comment_2);
 PARAMETER(NLL.CDD_Comment_3);
 PARAMETER(NLL.CDD_Comment_4);
 PARAMETER(NLL.CDD_Comment_5);
 {
  //?USER: Initialize routine

  //?** Used by HPE in STR Hog Prcr & Eval Sys-HPE System
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 // Execute command - 'EXE OVRPRTF Hold/Save'
 EXECUTE COMMAND(USR4013);
 PARAMETER(LCL.CDD_Printer_File_Name);
 PARAMETER(LCL.Hold_File);
 PARAMETER(LCL.Save_File);

 //?** Fax and/or email to Carrier                              E00170
 CASE;

 // IF PAR.Status Flag 11 Y/N is Yes
 IF PAR.Status_Flag_11_Y_N = 'Y';

 EXECUTE FUNCTION(RTV Fax Number & Email RT) TYPE(RTVOBJ) FILE(PLAAREP)          AC1790532;
 PARAMETER(PAR.Company_Number);
 PARAMETER(PAR.Carrier_Code);
 PARAMETER(LCL.Fax_Number);
 PARAMETER(LCL.Email_Address);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

  QUIT;

 }

 //?** Fax to Carriers                             08/27/08 LJB E00170
 //?** Fax to number in Company Carrier file
 CASE;

 // IF PAR.USR Status (Y/N) is Fax
 IF PAR.USR_Status_Y_N = 'F';

 //?** This rtvobj will loop through all fax numbers and email
 //?** addresses for this Carrier by Company     8/21/2006 TRF021 LJB
 //?** Carrier code usr is Carrier for subject line       P000737
 // WRK.CC Sequence Nbr = CON.1
 WRK.CC_Sequence_Nbr = 1;

 EXECUTE FUNCTION(RTV/Send Fax & Email   RT) TYPE(RTVOBJ) FILE(PLAAREP)          AC1790496;
 PARAMETER(PAR.Company_Number);
 PARAMETER(PAR.Carrier_Code);
 PARAMETER(WRK.CC_Sequence_Nbr);
 PARAMETER(LCL.Name);
 PARAMETER(LCL.Fax_Recipient_2);
 PARAMETER(LCL.Fax_Number_FF);
 PARAMETER(PAR.Load_ID);
 PARAMETER(PAR.Status_Description_3_USR);
 PARAMETER(PAR.Carrier_Code_Usr);
 {
  //?USER: Initialize routine

  // LCL.First Time Flag = CND.Yes
  LCL.First_Time_Flag = 'Y';

  //?***** Change Log and comments
  DO;

  //?*****
  //?** 05/25/2011 LJB P000737
  //?** Add 2nd carrier code to hold primary carrier. This is the
  //?** carrier that is printed on the Load Confirmation and will
  //?** print on the subject line for emails
  //?*****
  //?** 12/07/2006 LJB L61207A
  //?** Put fax to dispatch office outside of the test for a fax
  //?** number in the file, since there may only be an email address
  //?*****
  //?** 11/16/2006 LJB L61110A
  //?** Add Load ID and Carrier Code to the Subject Line when
  //?** the Load Confirmation is emailed to the Carrier dispatch office
  ENDDO;

  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  //?** Build the Subject Line: Load Confirm + Load ID + Carrier Code
  // WRK.Text USR 7 = CVTVAR(PAR.Load ID)
  WRK.Text_USR_7 = CVTVAR(PAR.Load_ID);

  // WRK.Text USR 40 = CONCAT(CON.Load Confirmation:,WRK.Text USR 7,CON.1)
  WRK.Text_USR_40 = 'Load Confirmation:' + WRK.Text_USR_7 (1);

  // WRK.Text USR 40 = CONCAT(WRK.Text USR 40,CON.Carrier:,CON.1)
  WRK.Text_USR_40 = WRK.Text_USR_40 + 'Carrier:' (1);

  // WRK.Text USR 40 = CONCAT(WRK.Text USR 40,PAR.Default Carrier Code,CON.1)
  WRK.Text_USR_40 = WRK.Text_USR_40 + PAR.Default_Carrier_Code (1);

  //?** Moved fax to Seaboard dispatch to calling program.   E00170
  //?** Fax to Company Carrier fax number if not blanks
  CASE;

  // IF DB1.CC Fax Number is Entered
  IF DB1.CC_Fax_Number <> *BLANK;

  // Call program PRC Call Telex         UP.
  CALL PROGRAM(PRC Call Telex         UP) ('PODYUPR');
  PARAMETER(PAR.Status_Description_3_USR);
  PARAMETER(WRK.Text_USR_40);
  PARAMETER(*BLANK);
  PARAMETER(PAR.Fax_Recipient);
  PARAMETER(PAR.Fax_Recipient);
  PARAMETER(DB1.CC_Fax_Number);
  PARAMETER(1);
  PARAMETER(*BLANK);
  PARAMETER(*BLANK);

  ENDIF;

  //?** Email Load Confirmation
  CASE;

  // IF DB1.CC Email Address is Entered
  IF DB1.CC_Email_Address <> *BLANK;

  //?** Send to the address in the file if it is not blanks
  // Call program Exc ESNDMAIL to Co CarrUP.
  CALL PROGRAM(Exc ESNDMAIL to Co CarrUP) ('PLAMUPC');
  PARAMETER(PAR.Status_Description_3_USR);
  PARAMETER(WRK.Text_USR_40);
  PARAMETER(DB1.CC_Email_Address);

  ENDIF;

 }

 //?** Update Fax Status flag                       S00580
 EXECUTE FUNCTION(CHG Load Conf Fax Sts  CH) TYPE(CHGOBJ) FILE(OMFJCPP)          AC1609738;
 PARAMETER(PAR.Load_ID);
 PARAMETER('Y');
 {
  //?USER: Processing before Data update

  EXECUTE FUNCTION(Set Date/Time Stamp   IF) TYPE(EXCINTFUN)                      AC1142219;
  PARAMETER(DB1.Job_Time);
  PARAMETER(DB1.User_Id);
  PARAMETER(DB1.Job_Name);
  PARAMETER(DB1.Job_Date);
  {
   //?Execute internal function

   // PAR.Job Time = JOB.*Job time
   PAR.Job_Time = JOB.*Job_time;

   // PAR.User Id = JOB.*USER
   PAR.User_Id = JOB.*USER;

   // PAR.Job Name = JOB.*JOB
   PAR.Job_Name = JOB.*JOB;

   // PAR.Job Date = JOB.*Job date
   PAR.Job_Date = JOB.*Job_date;

  }

 }

 //?there won't be a record for deleted loads
 CASE;

 // IF PGM.*Return code is *Record does not exist
 IF PGM.*Return_code = 'Y2U0005';

 // PGM.*Return code = CND.*Normal
 PGM.*Return_code = *BLANK;

 ENDIF;

 ENDIF;

 ENDIF;

 //?** If Fax to Dispatch = Y, fax also to Ship From Warehouse   E00170
 CASE;

 // IF PAR.Status Flag 12 Y/N is Yes
 IF PAR.Status_Flag_12_Y_N = 'Y';

 //?** Get Dispatch fax number from co doc dflts file & fax   E00170
 DO;

 //?** Retrieve all available fields for Comp Doc Defaults   E00303
 // WRK.CDD Department Code = CND.Dispatch
 WRK.CDD_Department_Code = 'DSPTCH';

 EXECUTE FUNCTION(RTV Co Doc Dflts-All   RT) TYPE(RTVOBJ) FILE(PPAQREP)          AC1912301;
 PARAMETER(PAR.Company_Number);
 PARAMETER('LC');
 PARAMETER(WRK.CDD_Department_Code);
 PARAMETER(NLL.CDD_Name_of_Overlay);
 PARAMETER(NLL.CDD_Program_Name);
 PARAMETER(LCL.CDD_Printer_File_Name);
 PARAMETER(LCL.CDD_Additional_Object);
 PARAMETER(NLL.CDD_Sender_Phone);
 PARAMETER(LCL.CDD_Sender_Fax);
 PARAMETER(LCL.Output_Queue);
 PARAMETER(LCL.Hold_File);
 PARAMETER(LCL.Save_File);
 PARAMETER(NLL.Source_Drawer);
 PARAMETER(NLL.Printer_Device_Type);
 PARAMETER(NLL.Page_Length_2);
 PARAMETER(NLL.Page_Width_2);
 PARAMETER(NLL.Page_LPI);
 PARAMETER(NLL.Page_CPI);
 PARAMETER(NLL.Page_Overflow);
 PARAMETER(NLL.Page_Rotation);
 PARAMETER(NLL.CDD_Valid_Name_1_Unused);
 PARAMETER(NLL.CDD_Valid_Name_2_Unused);
 PARAMETER(NLL.CDD_Valid_Name_3_Unused);
 PARAMETER(NLL.CDD_Copies);
 PARAMETER(NLL.CDD_Number_2_Unused_3_0);
 PARAMETER(NLL.CDD_Number_3_Unused_3_0);
 PARAMETER(NLL.CDD_Number_4_Unused_5_0);
 PARAMETER(NLL.CDD_Number_5_Unused_5_0);
 PARAMETER(NLL.CDD_Comment_1);
 PARAMETER(NLL.CDD_Comment_2);
 PARAMETER(NLL.CDD_Comment_3);
 PARAMETER(NLL.CDD_Comment_4);
 PARAMETER(NLL.CDD_Comment_5);
 PARAMETER(NLL.CDD_Unused_Sts_1_1);
 PARAMETER(NLL.CDD_Unused_Sts_1_2);
 PARAMETER(NLL.CDD_Unused_Sts_2_1);
 PARAMETER(NLL.CDD_Unused_Sts_2_2);
 PARAMETER(NLL.CDD_Unused_Text_1);
 PARAMETER(NLL.CDD_Unused_Text_2);
 PARAMETER(NLL.CDD_Unused_Text_3);
 PARAMETER(NLL.CDD_Unused_Text_4);
 PARAMETER(NLL.CDD_Unused_Text_5);
 PARAMETER(NLL.CDD_Unused_Date_1);
 PARAMETER(NLL.CDD_Unused_Date_2);
 PARAMETER(NLL.CDD_Unused_Date_3);
 PARAMETER(NLL.CDD_Unused_Time_1);
 PARAMETER(NLL.CDD_Unused_Time_2);
 PARAMETER(NLL.CDD_Unused_Time_3);
 PARAMETER(NLL.Record_Status);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 // Execute command - 'EXE OVRPRTF Hold/Save'
 EXECUTE COMMAND(USR4013);
 PARAMETER(LCL.CDD_Printer_File_Name);
 PARAMETER(LCL.Hold_File);
 PARAMETER(LCL.Save_File);

 // LCL.Fax Number FF = LCL.CDD Sender Fax
 LCL.Fax_Number_FF = LCL.CDD_Sender_Fax;

 // LCL.Fax Recipient 2 = CON.DISPATCH
 LCL.Fax_Recipient_2 = 'DISPATCH';

 // WRK.Text USR 7 = CVTVAR(DB1.Load ID)
 WRK.Text_USR_7 = CVTVAR(DB1.Load_ID);

 // WRK.Text USR 40 = CONCAT(CON.Load Confirmation:,WRK.Text USR 7,CON.1)
 WRK.Text_USR_40 = 'Load Confirmation:' + WRK.Text_USR_7 (1);

 // WRK.Text USR 40 = CONCAT(WRK.Text USR 40,CON.Carrier:,CON.1)
 WRK.Text_USR_40 = WRK.Text_USR_40 + 'Carrier:' (1);

 // WRK.Text USR 40 = CONCAT(WRK.Text USR 40,DB1.Carrier Code,CON.1)
 WRK.Text_USR_40 = WRK.Text_USR_40 + DB1.Carrier_Code (1);

 //?** Fax as requested
 // Call program EXC LC Fax or Dupsplf  CL.
 CALL PROGRAM(EXC LC Fax or Dupsplf  CL) ('PNW4UPC');
 PARAMETER(LCL.CDD_Printer_File_Name);
 PARAMETER(WRK.Text_USR_40);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(LCL.Fax_Number_FF);
 PARAMETER(LCL.Fax_Recipient_2);
 PARAMETER(PAR.Status_Flag_11_Y_N);
 PARAMETER(LCL.Output_Queue);
 PARAMETER(LCL.Hold_File);
 PARAMETER(LCL.Save_File);

 //?** Dupsplf if Additional Object is entered for a 2nd outq    E00303
 CASE;

 // IF LCL.CDD Additional Object NE WRK.Blank 6 USR
 IF LCL.CDD_Additional_Object <> WRK.Blank_6_USR;

 // Call program EXC LC Fax or Dupsplf  CL.
 CALL PROGRAM(EXC LC Fax or Dupsplf  CL) ('PNW4UPC');
 PARAMETER(LCL.CDD_Printer_File_Name);
 PARAMETER(WRK.Text_USR_40);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANKS);
 PARAMETER(*blanks);
 PARAMETER(PAR.Status_Flag_11_Y_N);
 PARAMETER(LCL.CDD_Additional_Object);
 PARAMETER(LCL.Hold_File);
 PARAMETER(LCL.Save_File);

 ENDIF;

 ENDDO;

 //?** whse is not available if load has been deleted
 //?** Get fax or outq for ship from whse and send            E00170
 DO;

 EXECUTE FUNCTION(RTV Ship From WarehouseRT) TYPE(RTVOBJ) FILE(OMFJCPP)          AC1897598;
 PARAMETER(PAR.Load_ID);
 PARAMETER(LCL.Ship_From_Warehouse);
 {
  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 // WRK.CDD Department Code = LCL.Ship From Warehouse
 WRK.CDD_Department_Code = LCL.Ship_From_Warehouse;

 EXECUTE FUNCTION(RTV Co Document Dflts  RT) TYPE(RTVOBJ) FILE(PPAQREP)          AC1823355;
 PARAMETER(PAR.Company_Number);
 PARAMETER('LC');
 PARAMETER(WRK.CDD_Department_Code);
 PARAMETER(NLL.CDD_Name_of_Overlay);
 PARAMETER(NLL.CDD_Program_Name);
 PARAMETER(LCL.CDD_Printer_File_Name);
 PARAMETER(NLL.CDD_Sender_Phone);
 PARAMETER(LCL.CDD_Sender_Fax);
 PARAMETER(LCL.Output_Queue);
 PARAMETER(LCL.Hold_File);
 PARAMETER(LCL.Save_File);
 PARAMETER(NLL.Source_Drawer);
 PARAMETER(NLL.Printer_Device_Type);
 PARAMETER(NLL.Page_Length_2);
 PARAMETER(NLL.Page_Width_2);
 PARAMETER(NLL.Page_LPI);
 PARAMETER(NLL.Page_CPI);
 PARAMETER(NLL.Page_Overflow);
 PARAMETER(NLL.Page_Rotation);
 PARAMETER(NLL.CDD_Comment_1);
 PARAMETER(NLL.CDD_Comment_2);
 PARAMETER(NLL.CDD_Comment_3);
 PARAMETER(NLL.CDD_Comment_4);
 PARAMETER(NLL.CDD_Comment_5);
 {
  //?USER: Initialize routine

  //?** Used by HPE in STR Hog Prcr & Eval Sys-HPE System
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 // WRK.Text USR 7 = CVTVAR(DB1.Load ID)
 WRK.Text_USR_7 = CVTVAR(DB1.Load_ID);

 // WRK.Text USR 40 = CONCAT(CON.Load Confirmation:,WRK.Text USR 7,CON.1)
 WRK.Text_USR_40 = 'Load Confirmation:' + WRK.Text_USR_7 (1);

 // WRK.Text USR 40 = CONCAT(WRK.Text USR 40,CON.Carrier:,CON.1)
 WRK.Text_USR_40 = WRK.Text_USR_40 + 'Carrier:' (1);

 // WRK.Text USR 40 = CONCAT(WRK.Text USR 40,DB1.Carrier Code,CON.1)
 WRK.Text_USR_40 = WRK.Text_USR_40 + DB1.Carrier_Code (1);

 // Call program EXC LC Fax or Dupsplf  CL.
 CALL PROGRAM(EXC LC Fax or Dupsplf  CL) ('PNW4UPC');
 PARAMETER(LCL.CDD_Printer_File_Name);
 PARAMETER(WRK.Text_USR_40);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(LCL.CDD_Sender_Fax);
 PARAMETER(LCL.Ship_From_Warehouse);
 PARAMETER(PAR.Status_Flag_11_Y_N);
 PARAMETER(LCL.Output_Queue);
 PARAMETER(LCL.Hold_File);
 PARAMETER(LCL.Save_File);

 ENDDO;

 ENDIF;

 ENDIF;

}


ENDIF;

ENDIF;

//?** Fax or Email Shipping Line
CASE;

// IF PAR.Status Flag 5  Y/N is Yes
IF PAR.Status_Flag_5_Y_N = 'Y';

EXECUTE FUNCTION(RTV by Load-fax LdCnfrmRT) TYPE(RTVOBJ) FILE(OMFJCPP)          AC2019576;
PARAMETER(PAR.Load_ID);
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Shipping_Line);
PARAMETER(PAR.Status_Flag_5_Y_N);
PARAMETER('N');
PARAMETER(PAR.Status_Description_3_USR);
PARAMETER(PAR.USR_Status_Y_N);
PARAMETER(PAR.Default_Carrier_Code);
PARAMETER(*BLANK);
{
 //?USER: Initialize routine

 //?***** Change Log and comments
 DO;

 //?*****
 //?** 04/15/2011 LJB P000737
 //?** Copied from RTV by Carrier.
 //?** Retrieve by Load ID for faxing to Shipper, Transloader,
 //?** Mexican Carrier, Export Coordinator, other email addresses.
 //?** Pass Carrier, as well, to include on load confirm & subject lines
 //?*****
 ENDDO;

 // LCL.Fax Recipient 2 = CON.*BLANK
 LCL.Fax_Recipient_2 = *BLANK;

 // LCL.Fax Number FF = CON.*BLANK
 LCL.Fax_Number_FF = *BLANK;

 //?USER: Exit processing

 //?** Only process if there is someone to send the confirmation to.
 //?** Fax or email load confirmation to requested recipient
 CASE;

 // IF PAR.Status Flag 11 Y/N is Yes
 IF PAR.Status_Flag_11_Y_N = 'Y';

 // OR PAR.Status Flag 12 Y/N is Yes
 OR PAR.Status_Flag_12_Y_N = 'Y';

 EXECUTE FUNCTION(RTV Co Document Dflts  RT) TYPE(RTVOBJ) FILE(PPAQREP)          AC1823355;
 PARAMETER(PAR.Company_Number);
 PARAMETER('LC');
 PARAMETER('DSPTCH');
 PARAMETER(NLL.CDD_Name_of_Overlay);
 PARAMETER(NLL.CDD_Program_Name);
 PARAMETER(LCL.CDD_Printer_File_Name);
 PARAMETER(NLL.CDD_Sender_Phone);
 PARAMETER(NLL.CDD_Sender_Fax);
 PARAMETER(LCL.Output_Queue);
 PARAMETER(LCL.Hold_File);
 PARAMETER(LCL.Save_File);
 PARAMETER(NLL.Source_Drawer);
 PARAMETER(NLL.Printer_Device_Type);
 PARAMETER(NLL.Page_Length_2);
 PARAMETER(NLL.Page_Width_2);
 PARAMETER(NLL.Page_LPI);
 PARAMETER(NLL.Page_CPI);
 PARAMETER(NLL.Page_Overflow);
 PARAMETER(NLL.Page_Rotation);
 PARAMETER(NLL.CDD_Comment_1);
 PARAMETER(NLL.CDD_Comment_2);
 PARAMETER(NLL.CDD_Comment_3);
 PARAMETER(NLL.CDD_Comment_4);
 PARAMETER(NLL.CDD_Comment_5);
 {
  //?USER: Initialize routine

  //?** Used by HPE in STR Hog Prcr & Eval Sys-HPE System
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 // Execute command - 'EXE OVRPRTF Hold/Save'
 EXECUTE COMMAND(USR4013);
 PARAMETER(LCL.CDD_Printer_File_Name);
 PARAMETER(LCL.Hold_File);
 PARAMETER(LCL.Save_File);

 //?** Fax and/or email to Carrier
 CASE;

 // IF PAR.Status Flag 11 Y/N is Yes
 IF PAR.Status_Flag_11_Y_N = 'Y';

 //?** Fax to Carriers - Shipper,Transloader,Mex Carr are in Co Carr File
 //?** Fax to number in Company Carrier file
 CASE;

 // IF PAR.USR Status (Y/N) is Fax
 IF PAR.USR_Status_Y_N = 'F';

 //?** This rtvobj will loop through all fax numbers and email
 //?** addresses for this Carrier by Company
 //?** par.carrier code contains the Shipper, Transloader, Mexican Carrier
 //?** par.carrier code usr contains the Carrier
 // WRK.CC Sequence Nbr = CON.1
 WRK.CC_Sequence_Nbr = 1;

 EXECUTE FUNCTION(RTV/Send Fax & Email   RT) TYPE(RTVOBJ) FILE(PLAAREP)          AC1790496;
 PARAMETER(PAR.Company_Number);
 PARAMETER(PAR.Carrier_Code);
 PARAMETER(WRK.CC_Sequence_Nbr);
 PARAMETER(LCL.Name);
 PARAMETER(LCL.Fax_Recipient_2);
 PARAMETER(LCL.Fax_Number_FF);
 PARAMETER(PAR.Load_ID);
 PARAMETER(PAR.Status_Description_3_USR);
 PARAMETER(PAR.Carrier_Code_Usr);
 {
  //?USER: Initialize routine

  // LCL.First Time Flag = CND.Yes
  LCL.First_Time_Flag = 'Y';

  //?***** Change Log and comments
  DO;

  //?*****
  //?** 05/25/2011 LJB P000737
  //?** Add 2nd carrier code to hold primary carrier. This is the
  //?** carrier that is printed on the Load Confirmation and will
  //?** print on the subject line for emails
  //?*****
  //?** 12/07/2006 LJB L61207A
  //?** Put fax to dispatch office outside of the test for a fax
  //?** number in the file, since there may only be an email address
  //?*****
  //?** 11/16/2006 LJB L61110A
  //?** Add Load ID and Carrier Code to the Subject Line when
  //?** the Load Confirmation is emailed to the Carrier dispatch office
  ENDDO;

  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  //?** Build the Subject Line: Load Confirm + Load ID + Carrier Code
  // WRK.Text USR 7 = CVTVAR(PAR.Load ID)
  WRK.Text_USR_7 = CVTVAR(PAR.Load_ID);

  // WRK.Text USR 40 = CONCAT(CON.Load Confirmation:,WRK.Text USR 7,CON.1)
  WRK.Text_USR_40 = 'Load Confirmation:' + WRK.Text_USR_7 (1);

  // WRK.Text USR 40 = CONCAT(WRK.Text USR 40,CON.Carrier:,CON.1)
  WRK.Text_USR_40 = WRK.Text_USR_40 + 'Carrier:' (1);

  // WRK.Text USR 40 = CONCAT(WRK.Text USR 40,PAR.Default Carrier Code,CON.1)
  WRK.Text_USR_40 = WRK.Text_USR_40 + PAR.Default_Carrier_Code (1);

  //?** Moved fax to Seaboard dispatch to calling program.   E00170
  //?** Fax to Company Carrier fax number if not blanks
  CASE;

  // IF DB1.CC Fax Number is Entered
  IF DB1.CC_Fax_Number <> *BLANK;

  // Call program PRC Call Telex         UP.
  CALL PROGRAM(PRC Call Telex         UP) ('PODYUPR');
  PARAMETER(PAR.Status_Description_3_USR);
  PARAMETER(WRK.Text_USR_40);
  PARAMETER(*BLANK);
  PARAMETER(PAR.Fax_Recipient);
  PARAMETER(PAR.Fax_Recipient);
  PARAMETER(DB1.CC_Fax_Number);
  PARAMETER(1);
  PARAMETER(*BLANK);
  PARAMETER(*BLANK);

  ENDIF;

  //?** Email Load Confirmation
  CASE;

  // IF DB1.CC Email Address is Entered
  IF DB1.CC_Email_Address <> *BLANK;

  //?** Send to the address in the file if it is not blanks
  // Call program Exc ESNDMAIL to Co CarrUP.
  CALL PROGRAM(Exc ESNDMAIL to Co CarrUP) ('PLAMUPC');
  PARAMETER(PAR.Status_Description_3_USR);
  PARAMETER(WRK.Text_USR_40);
  PARAMETER(DB1.CC_Email_Address);

  ENDIF;

 }

 //?** Update Fax Status flag
 EXECUTE FUNCTION(CHG Load Conf Fax Sts  CH) TYPE(CHGOBJ) FILE(OMFJCPP)          AC1609738;
 PARAMETER(PAR.Load_ID);
 PARAMETER('Y');
 {
  //?USER: Processing before Data update

  EXECUTE FUNCTION(Set Date/Time Stamp   IF) TYPE(EXCINTFUN)                      AC1142219;
  PARAMETER(DB1.Job_Time);
  PARAMETER(DB1.User_Id);
  PARAMETER(DB1.Job_Name);
  PARAMETER(DB1.Job_Date);
  {
   //?Execute internal function

   // PAR.Job Time = JOB.*Job time
   PAR.Job_Time = JOB.*Job_time;

   // PAR.User Id = JOB.*USER
   PAR.User_Id = JOB.*USER;

   // PAR.Job Name = JOB.*JOB
   PAR.Job_Name = JOB.*JOB;

   // PAR.Job Date = JOB.*Job date
   PAR.Job_Date = JOB.*Job_date;

  }

 }

 ENDIF;

 ENDIF;

 //?** If Fax to Dispatch = Y, fax also to Ship From Warehouse
 CASE;

 // IF PAR.Status Flag 12 Y/N is Yes
 IF PAR.Status_Flag_12_Y_N = 'Y';

 //?** Get Dispatch fax number from co doc dflts file & fax
 DO;

 //?** Retrieve all available fields for Comp Doc Defaults
 // WRK.CDD Department Code = CND.Dispatch
 WRK.CDD_Department_Code = 'DSPTCH';

 EXECUTE FUNCTION(RTV Co Doc Dflts-All   RT) TYPE(RTVOBJ) FILE(PPAQREP)          AC1912301;
 PARAMETER(PAR.Company_Number);
 PARAMETER('LC');
 PARAMETER(WRK.CDD_Department_Code);
 PARAMETER(NLL.CDD_Name_of_Overlay);
 PARAMETER(NLL.CDD_Program_Name);
 PARAMETER(LCL.CDD_Printer_File_Name);
 PARAMETER(LCL.CDD_Additional_Object);
 PARAMETER(NLL.CDD_Sender_Phone);
 PARAMETER(LCL.CDD_Sender_Fax);
 PARAMETER(LCL.Output_Queue);
 PARAMETER(LCL.Hold_File);
 PARAMETER(LCL.Save_File);
 PARAMETER(NLL.Source_Drawer);
 PARAMETER(NLL.Printer_Device_Type);
 PARAMETER(NLL.Page_Length_2);
 PARAMETER(NLL.Page_Width_2);
 PARAMETER(NLL.Page_LPI);
 PARAMETER(NLL.Page_CPI);
 PARAMETER(NLL.Page_Overflow);
 PARAMETER(NLL.Page_Rotation);
 PARAMETER(NLL.CDD_Valid_Name_1_Unused);
 PARAMETER(NLL.CDD_Valid_Name_2_Unused);
 PARAMETER(NLL.CDD_Valid_Name_3_Unused);
 PARAMETER(NLL.CDD_Copies);
 PARAMETER(NLL.CDD_Number_2_Unused_3_0);
 PARAMETER(NLL.CDD_Number_3_Unused_3_0);
 PARAMETER(NLL.CDD_Number_4_Unused_5_0);
 PARAMETER(NLL.CDD_Number_5_Unused_5_0);
 PARAMETER(NLL.CDD_Comment_1);
 PARAMETER(NLL.CDD_Comment_2);
 PARAMETER(NLL.CDD_Comment_3);
 PARAMETER(NLL.CDD_Comment_4);
 PARAMETER(NLL.CDD_Comment_5);
 PARAMETER(NLL.CDD_Unused_Sts_1_1);
 PARAMETER(NLL.CDD_Unused_Sts_1_2);
 PARAMETER(NLL.CDD_Unused_Sts_2_1);
 PARAMETER(NLL.CDD_Unused_Sts_2_2);
 PARAMETER(NLL.CDD_Unused_Text_1);
 PARAMETER(NLL.CDD_Unused_Text_2);
 PARAMETER(NLL.CDD_Unused_Text_3);
 PARAMETER(NLL.CDD_Unused_Text_4);
 PARAMETER(NLL.CDD_Unused_Text_5);
 PARAMETER(NLL.CDD_Unused_Date_1);
 PARAMETER(NLL.CDD_Unused_Date_2);
 PARAMETER(NLL.CDD_Unused_Date_3);
 PARAMETER(NLL.CDD_Unused_Time_1);
 PARAMETER(NLL.CDD_Unused_Time_2);
 PARAMETER(NLL.CDD_Unused_Time_3);
 PARAMETER(NLL.Record_Status);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 // LCL.Fax Number FF = LCL.CDD Sender Fax
 LCL.Fax_Number_FF = LCL.CDD_Sender_Fax;

 // LCL.Fax Recipient 2 = CON.DISPATCH
 LCL.Fax_Recipient_2 = 'DISPATCH';

 // WRK.Text USR 7 = CVTVAR(DB1.Load ID)
 WRK.Text_USR_7 = CVTVAR(DB1.Load_ID);

 // WRK.Text USR 40 = CONCAT(CON.Load Confirmation:,WRK.Text USR 7,CON.1)
 WRK.Text_USR_40 = 'Load Confirmation:' + WRK.Text_USR_7 (1);

 // WRK.Text USR 40 = CONCAT(WRK.Text USR 40,CON.Carrier:,CON.1)
 WRK.Text_USR_40 = WRK.Text_USR_40 + 'Carrier:' (1);

 // WRK.Text USR 40 = CONCAT(WRK.Text USR 40,DB1.Carrier Code,CON.1)
 WRK.Text_USR_40 = WRK.Text_USR_40 + DB1.Carrier_Code (1);

 //?** Fax as requested
 // Call program EXC LC Fax or Dupsplf  CL.
 CALL PROGRAM(EXC LC Fax or Dupsplf  CL) ('PNW4UPC');
 PARAMETER(LCL.CDD_Printer_File_Name);
 PARAMETER(WRK.Text_USR_40);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(LCL.Fax_Number_FF);
 PARAMETER(LCL.Fax_Recipient_2);
 PARAMETER(PAR.Status_Flag_11_Y_N);
 PARAMETER(LCL.Output_Queue);
 PARAMETER(LCL.Hold_File);
 PARAMETER(LCL.Save_File);

 //?** Dupsplf if Additional Object is entered for a 2nd outq    E00303
 CASE;

 // IF LCL.CDD Additional Object NE WRK.Blank 6 USR
 IF LCL.CDD_Additional_Object <> WRK.Blank_6_USR;

 // Call program EXC LC Fax or Dupsplf  CL.
 CALL PROGRAM(EXC LC Fax or Dupsplf  CL) ('PNW4UPC');
 PARAMETER(LCL.CDD_Printer_File_Name);
 PARAMETER(WRK.Text_USR_40);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANKS);
 PARAMETER(*blanks);
 PARAMETER(PAR.Status_Flag_11_Y_N);
 PARAMETER(LCL.CDD_Additional_Object);
 PARAMETER(LCL.Hold_File);
 PARAMETER(LCL.Save_File);

 ENDIF;

 ENDDO;

 //?** Get fax or outq for ship from whse and send            E00170
 DO;

 EXECUTE FUNCTION(RTV Ship From WarehouseRT) TYPE(RTVOBJ) FILE(OMFJCPP)          AC1897598;
 PARAMETER(PAR.Load_ID);
 PARAMETER(LCL.Ship_From_Warehouse);
 {
  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 // WRK.CDD Department Code = LCL.Ship From Warehouse
 WRK.CDD_Department_Code = LCL.Ship_From_Warehouse;

 EXECUTE FUNCTION(RTV Co Document Dflts  RT) TYPE(RTVOBJ) FILE(PPAQREP)          AC1823355;
 PARAMETER(PAR.Company_Number);
 PARAMETER('LC');
 PARAMETER(WRK.CDD_Department_Code);
 PARAMETER(NLL.CDD_Name_of_Overlay);
 PARAMETER(NLL.CDD_Program_Name);
 PARAMETER(LCL.CDD_Printer_File_Name);
 PARAMETER(NLL.CDD_Sender_Phone);
 PARAMETER(LCL.CDD_Sender_Fax);
 PARAMETER(LCL.Output_Queue);
 PARAMETER(LCL.Hold_File);
 PARAMETER(LCL.Save_File);
 PARAMETER(NLL.Source_Drawer);
 PARAMETER(NLL.Printer_Device_Type);
 PARAMETER(NLL.Page_Length_2);
 PARAMETER(NLL.Page_Width_2);
 PARAMETER(NLL.Page_LPI);
 PARAMETER(NLL.Page_CPI);
 PARAMETER(NLL.Page_Overflow);
 PARAMETER(NLL.Page_Rotation);
 PARAMETER(NLL.CDD_Comment_1);
 PARAMETER(NLL.CDD_Comment_2);
 PARAMETER(NLL.CDD_Comment_3);
 PARAMETER(NLL.CDD_Comment_4);
 PARAMETER(NLL.CDD_Comment_5);
 {
  //?USER: Initialize routine

  //?** Used by HPE in STR Hog Prcr & Eval Sys-HPE System
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 // WRK.Text USR 7 = CVTVAR(DB1.Load ID)
 WRK.Text_USR_7 = CVTVAR(DB1.Load_ID);

 // WRK.Text USR 40 = CONCAT(CON.Load Confirmation:,WRK.Text USR 7,CON.1)
 WRK.Text_USR_40 = 'Load Confirmation:' + WRK.Text_USR_7 (1);

 // WRK.Text USR 40 = CONCAT(WRK.Text USR 40,CON.Carrier:,CON.1)
 WRK.Text_USR_40 = WRK.Text_USR_40 + 'Carrier:' (1);

 // WRK.Text USR 40 = CONCAT(WRK.Text USR 40,DB1.Carrier Code,CON.1)
 WRK.Text_USR_40 = WRK.Text_USR_40 + DB1.Carrier_Code (1);

 // Call program EXC LC Fax or Dupsplf  CL.
 CALL PROGRAM(EXC LC Fax or Dupsplf  CL) ('PNW4UPC');
 PARAMETER(LCL.CDD_Printer_File_Name);
 PARAMETER(WRK.Text_USR_40);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(LCL.CDD_Sender_Fax);
 PARAMETER(LCL.Ship_From_Warehouse);
 PARAMETER(PAR.Status_Flag_11_Y_N);
 PARAMETER(LCL.Output_Queue);
 PARAMETER(LCL.Hold_File);
 PARAMETER(LCL.Save_File);

 ENDDO;

 ENDIF;

 ENDIF;

}


ENDIF;

//?** Fax or Email Transloader
CASE;

// IF PAR.Status Flag 2  Y/N is Yes
IF PAR.Status_Flag_2_Y_N = 'Y';

EXECUTE FUNCTION(RTV by Load-fax LdCnfrmRT) TYPE(RTVOBJ) FILE(OMFJCPP)          AC2019576;
PARAMETER(PAR.Load_ID);
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Transloader_Carrier_Code);
PARAMETER(PAR.Status_Flag_2_Y_N);
PARAMETER('N');
PARAMETER(PAR.Status_Description_3_USR);
PARAMETER(PAR.USR_Status_Y_N);
PARAMETER(PAR.Default_Carrier_Code);
PARAMETER(*BLANK);
{
 //?USER: Initialize routine

 //?***** Change Log and comments
 DO;

 //?*****
 //?** 04/15/2011 LJB P000737
 //?** Copied from RTV by Carrier.
 //?** Retrieve by Load ID for faxing to Shipper, Transloader,
 //?** Mexican Carrier, Export Coordinator, other email addresses.
 //?** Pass Carrier, as well, to include on load confirm & subject lines
 //?*****
 ENDDO;

 // LCL.Fax Recipient 2 = CON.*BLANK
 LCL.Fax_Recipient_2 = *BLANK;

 // LCL.Fax Number FF = CON.*BLANK
 LCL.Fax_Number_FF = *BLANK;

 //?USER: Exit processing

 //?** Only process if there is someone to send the confirmation to.
 //?** Fax or email load confirmation to requested recipient
 CASE;

 // IF PAR.Status Flag 11 Y/N is Yes
 IF PAR.Status_Flag_11_Y_N = 'Y';

 // OR PAR.Status Flag 12 Y/N is Yes
 OR PAR.Status_Flag_12_Y_N = 'Y';

 EXECUTE FUNCTION(RTV Co Document Dflts  RT) TYPE(RTVOBJ) FILE(PPAQREP)          AC1823355;
 PARAMETER(PAR.Company_Number);
 PARAMETER('LC');
 PARAMETER('DSPTCH');
 PARAMETER(NLL.CDD_Name_of_Overlay);
 PARAMETER(NLL.CDD_Program_Name);
 PARAMETER(LCL.CDD_Printer_File_Name);
 PARAMETER(NLL.CDD_Sender_Phone);
 PARAMETER(NLL.CDD_Sender_Fax);
 PARAMETER(LCL.Output_Queue);
 PARAMETER(LCL.Hold_File);
 PARAMETER(LCL.Save_File);
 PARAMETER(NLL.Source_Drawer);
 PARAMETER(NLL.Printer_Device_Type);
 PARAMETER(NLL.Page_Length_2);
 PARAMETER(NLL.Page_Width_2);
 PARAMETER(NLL.Page_LPI);
 PARAMETER(NLL.Page_CPI);
 PARAMETER(NLL.Page_Overflow);
 PARAMETER(NLL.Page_Rotation);
 PARAMETER(NLL.CDD_Comment_1);
 PARAMETER(NLL.CDD_Comment_2);
 PARAMETER(NLL.CDD_Comment_3);
 PARAMETER(NLL.CDD_Comment_4);
 PARAMETER(NLL.CDD_Comment_5);
 {
  //?USER: Initialize routine

  //?** Used by HPE in STR Hog Prcr & Eval Sys-HPE System
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 // Execute command - 'EXE OVRPRTF Hold/Save'
 EXECUTE COMMAND(USR4013);
 PARAMETER(LCL.CDD_Printer_File_Name);
 PARAMETER(LCL.Hold_File);
 PARAMETER(LCL.Save_File);

 //?** Fax and/or email to Carrier
 CASE;

 // IF PAR.Status Flag 11 Y/N is Yes
 IF PAR.Status_Flag_11_Y_N = 'Y';

 //?** Fax to Carriers - Shipper,Transloader,Mex Carr are in Co Carr File
 //?** Fax to number in Company Carrier file
 CASE;

 // IF PAR.USR Status (Y/N) is Fax
 IF PAR.USR_Status_Y_N = 'F';

 //?** This rtvobj will loop through all fax numbers and email
 //?** addresses for this Carrier by Company
 //?** par.carrier code contains the Shipper, Transloader, Mexican Carrier
 //?** par.carrier code usr contains the Carrier
 // WRK.CC Sequence Nbr = CON.1
 WRK.CC_Sequence_Nbr = 1;

 EXECUTE FUNCTION(RTV/Send Fax & Email   RT) TYPE(RTVOBJ) FILE(PLAAREP)          AC1790496;
 PARAMETER(PAR.Company_Number);
 PARAMETER(PAR.Carrier_Code);
 PARAMETER(WRK.CC_Sequence_Nbr);
 PARAMETER(LCL.Name);
 PARAMETER(LCL.Fax_Recipient_2);
 PARAMETER(LCL.Fax_Number_FF);
 PARAMETER(PAR.Load_ID);
 PARAMETER(PAR.Status_Description_3_USR);
 PARAMETER(PAR.Carrier_Code_Usr);
 {
  //?USER: Initialize routine

  // LCL.First Time Flag = CND.Yes
  LCL.First_Time_Flag = 'Y';

  //?***** Change Log and comments
  DO;

  //?*****
  //?** 05/25/2011 LJB P000737
  //?** Add 2nd carrier code to hold primary carrier. This is the
  //?** carrier that is printed on the Load Confirmation and will
  //?** print on the subject line for emails
  //?*****
  //?** 12/07/2006 LJB L61207A
  //?** Put fax to dispatch office outside of the test for a fax
  //?** number in the file, since there may only be an email address
  //?*****
  //?** 11/16/2006 LJB L61110A
  //?** Add Load ID and Carrier Code to the Subject Line when
  //?** the Load Confirmation is emailed to the Carrier dispatch office
  ENDDO;

  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  //?** Build the Subject Line: Load Confirm + Load ID + Carrier Code
  // WRK.Text USR 7 = CVTVAR(PAR.Load ID)
  WRK.Text_USR_7 = CVTVAR(PAR.Load_ID);

  // WRK.Text USR 40 = CONCAT(CON.Load Confirmation:,WRK.Text USR 7,CON.1)
  WRK.Text_USR_40 = 'Load Confirmation:' + WRK.Text_USR_7 (1);

  // WRK.Text USR 40 = CONCAT(WRK.Text USR 40,CON.Carrier:,CON.1)
  WRK.Text_USR_40 = WRK.Text_USR_40 + 'Carrier:' (1);

  // WRK.Text USR 40 = CONCAT(WRK.Text USR 40,PAR.Default Carrier Code,CON.1)
  WRK.Text_USR_40 = WRK.Text_USR_40 + PAR.Default_Carrier_Code (1);

  //?** Moved fax to Seaboard dispatch to calling program.   E00170
  //?** Fax to Company Carrier fax number if not blanks
  CASE;

  // IF DB1.CC Fax Number is Entered
  IF DB1.CC_Fax_Number <> *BLANK;

  // Call program PRC Call Telex         UP.
  CALL PROGRAM(PRC Call Telex         UP) ('PODYUPR');
  PARAMETER(PAR.Status_Description_3_USR);
  PARAMETER(WRK.Text_USR_40);
  PARAMETER(*BLANK);
  PARAMETER(PAR.Fax_Recipient);
  PARAMETER(PAR.Fax_Recipient);
  PARAMETER(DB1.CC_Fax_Number);
  PARAMETER(1);
  PARAMETER(*BLANK);
  PARAMETER(*BLANK);

  ENDIF;

  //?** Email Load Confirmation
  CASE;

  // IF DB1.CC Email Address is Entered
  IF DB1.CC_Email_Address <> *BLANK;

  //?** Send to the address in the file if it is not blanks
  // Call program Exc ESNDMAIL to Co CarrUP.
  CALL PROGRAM(Exc ESNDMAIL to Co CarrUP) ('PLAMUPC');
  PARAMETER(PAR.Status_Description_3_USR);
  PARAMETER(WRK.Text_USR_40);
  PARAMETER(DB1.CC_Email_Address);

  ENDIF;

 }

 //?** Update Fax Status flag
 EXECUTE FUNCTION(CHG Load Conf Fax Sts  CH) TYPE(CHGOBJ) FILE(OMFJCPP)          AC1609738;
 PARAMETER(PAR.Load_ID);
 PARAMETER('Y');
 {
  //?USER: Processing before Data update

  EXECUTE FUNCTION(Set Date/Time Stamp   IF) TYPE(EXCINTFUN)                      AC1142219;
  PARAMETER(DB1.Job_Time);
  PARAMETER(DB1.User_Id);
  PARAMETER(DB1.Job_Name);
  PARAMETER(DB1.Job_Date);
  {
   //?Execute internal function

   // PAR.Job Time = JOB.*Job time
   PAR.Job_Time = JOB.*Job_time;

   // PAR.User Id = JOB.*USER
   PAR.User_Id = JOB.*USER;

   // PAR.Job Name = JOB.*JOB
   PAR.Job_Name = JOB.*JOB;

   // PAR.Job Date = JOB.*Job date
   PAR.Job_Date = JOB.*Job_date;

  }

 }

 ENDIF;

 ENDIF;

 //?** If Fax to Dispatch = Y, fax also to Ship From Warehouse
 CASE;

 // IF PAR.Status Flag 12 Y/N is Yes
 IF PAR.Status_Flag_12_Y_N = 'Y';

 //?** Get Dispatch fax number from co doc dflts file & fax
 DO;

 //?** Retrieve all available fields for Comp Doc Defaults
 // WRK.CDD Department Code = CND.Dispatch
 WRK.CDD_Department_Code = 'DSPTCH';

 EXECUTE FUNCTION(RTV Co Doc Dflts-All   RT) TYPE(RTVOBJ) FILE(PPAQREP)          AC1912301;
 PARAMETER(PAR.Company_Number);
 PARAMETER('LC');
 PARAMETER(WRK.CDD_Department_Code);
 PARAMETER(NLL.CDD_Name_of_Overlay);
 PARAMETER(NLL.CDD_Program_Name);
 PARAMETER(LCL.CDD_Printer_File_Name);
 PARAMETER(LCL.CDD_Additional_Object);
 PARAMETER(NLL.CDD_Sender_Phone);
 PARAMETER(LCL.CDD_Sender_Fax);
 PARAMETER(LCL.Output_Queue);
 PARAMETER(LCL.Hold_File);
 PARAMETER(LCL.Save_File);
 PARAMETER(NLL.Source_Drawer);
 PARAMETER(NLL.Printer_Device_Type);
 PARAMETER(NLL.Page_Length_2);
 PARAMETER(NLL.Page_Width_2);
 PARAMETER(NLL.Page_LPI);
 PARAMETER(NLL.Page_CPI);
 PARAMETER(NLL.Page_Overflow);
 PARAMETER(NLL.Page_Rotation);
 PARAMETER(NLL.CDD_Valid_Name_1_Unused);
 PARAMETER(NLL.CDD_Valid_Name_2_Unused);
 PARAMETER(NLL.CDD_Valid_Name_3_Unused);
 PARAMETER(NLL.CDD_Copies);
 PARAMETER(NLL.CDD_Number_2_Unused_3_0);
 PARAMETER(NLL.CDD_Number_3_Unused_3_0);
 PARAMETER(NLL.CDD_Number_4_Unused_5_0);
 PARAMETER(NLL.CDD_Number_5_Unused_5_0);
 PARAMETER(NLL.CDD_Comment_1);
 PARAMETER(NLL.CDD_Comment_2);
 PARAMETER(NLL.CDD_Comment_3);
 PARAMETER(NLL.CDD_Comment_4);
 PARAMETER(NLL.CDD_Comment_5);
 PARAMETER(NLL.CDD_Unused_Sts_1_1);
 PARAMETER(NLL.CDD_Unused_Sts_1_2);
 PARAMETER(NLL.CDD_Unused_Sts_2_1);
 PARAMETER(NLL.CDD_Unused_Sts_2_2);
 PARAMETER(NLL.CDD_Unused_Text_1);
 PARAMETER(NLL.CDD_Unused_Text_2);
 PARAMETER(NLL.CDD_Unused_Text_3);
 PARAMETER(NLL.CDD_Unused_Text_4);
 PARAMETER(NLL.CDD_Unused_Text_5);
 PARAMETER(NLL.CDD_Unused_Date_1);
 PARAMETER(NLL.CDD_Unused_Date_2);
 PARAMETER(NLL.CDD_Unused_Date_3);
 PARAMETER(NLL.CDD_Unused_Time_1);
 PARAMETER(NLL.CDD_Unused_Time_2);
 PARAMETER(NLL.CDD_Unused_Time_3);
 PARAMETER(NLL.Record_Status);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 // LCL.Fax Number FF = LCL.CDD Sender Fax
 LCL.Fax_Number_FF = LCL.CDD_Sender_Fax;

 // LCL.Fax Recipient 2 = CON.DISPATCH
 LCL.Fax_Recipient_2 = 'DISPATCH';

 // WRK.Text USR 7 = CVTVAR(DB1.Load ID)
 WRK.Text_USR_7 = CVTVAR(DB1.Load_ID);

 // WRK.Text USR 40 = CONCAT(CON.Load Confirmation:,WRK.Text USR 7,CON.1)
 WRK.Text_USR_40 = 'Load Confirmation:' + WRK.Text_USR_7 (1);

 // WRK.Text USR 40 = CONCAT(WRK.Text USR 40,CON.Carrier:,CON.1)
 WRK.Text_USR_40 = WRK.Text_USR_40 + 'Carrier:' (1);

 // WRK.Text USR 40 = CONCAT(WRK.Text USR 40,DB1.Carrier Code,CON.1)
 WRK.Text_USR_40 = WRK.Text_USR_40 + DB1.Carrier_Code (1);

 //?** Fax as requested
 // Call program EXC LC Fax or Dupsplf  CL.
 CALL PROGRAM(EXC LC Fax or Dupsplf  CL) ('PNW4UPC');
 PARAMETER(LCL.CDD_Printer_File_Name);
 PARAMETER(WRK.Text_USR_40);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(LCL.Fax_Number_FF);
 PARAMETER(LCL.Fax_Recipient_2);
 PARAMETER(PAR.Status_Flag_11_Y_N);
 PARAMETER(LCL.Output_Queue);
 PARAMETER(LCL.Hold_File);
 PARAMETER(LCL.Save_File);

 //?** Dupsplf if Additional Object is entered for a 2nd outq    E00303
 CASE;

 // IF LCL.CDD Additional Object NE WRK.Blank 6 USR
 IF LCL.CDD_Additional_Object <> WRK.Blank_6_USR;

 // Call program EXC LC Fax or Dupsplf  CL.
 CALL PROGRAM(EXC LC Fax or Dupsplf  CL) ('PNW4UPC');
 PARAMETER(LCL.CDD_Printer_File_Name);
 PARAMETER(WRK.Text_USR_40);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANKS);
 PARAMETER(*blanks);
 PARAMETER(PAR.Status_Flag_11_Y_N);
 PARAMETER(LCL.CDD_Additional_Object);
 PARAMETER(LCL.Hold_File);
 PARAMETER(LCL.Save_File);

 ENDIF;

 ENDDO;

 //?** Get fax or outq for ship from whse and send            E00170
 DO;

 EXECUTE FUNCTION(RTV Ship From WarehouseRT) TYPE(RTVOBJ) FILE(OMFJCPP)          AC1897598;
 PARAMETER(PAR.Load_ID);
 PARAMETER(LCL.Ship_From_Warehouse);
 {
  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 // WRK.CDD Department Code = LCL.Ship From Warehouse
 WRK.CDD_Department_Code = LCL.Ship_From_Warehouse;

 EXECUTE FUNCTION(RTV Co Document Dflts  RT) TYPE(RTVOBJ) FILE(PPAQREP)          AC1823355;
 PARAMETER(PAR.Company_Number);
 PARAMETER('LC');
 PARAMETER(WRK.CDD_Department_Code);
 PARAMETER(NLL.CDD_Name_of_Overlay);
 PARAMETER(NLL.CDD_Program_Name);
 PARAMETER(LCL.CDD_Printer_File_Name);
 PARAMETER(NLL.CDD_Sender_Phone);
 PARAMETER(LCL.CDD_Sender_Fax);
 PARAMETER(LCL.Output_Queue);
 PARAMETER(LCL.Hold_File);
 PARAMETER(LCL.Save_File);
 PARAMETER(NLL.Source_Drawer);
 PARAMETER(NLL.Printer_Device_Type);
 PARAMETER(NLL.Page_Length_2);
 PARAMETER(NLL.Page_Width_2);
 PARAMETER(NLL.Page_LPI);
 PARAMETER(NLL.Page_CPI);
 PARAMETER(NLL.Page_Overflow);
 PARAMETER(NLL.Page_Rotation);
 PARAMETER(NLL.CDD_Comment_1);
 PARAMETER(NLL.CDD_Comment_2);
 PARAMETER(NLL.CDD_Comment_3);
 PARAMETER(NLL.CDD_Comment_4);
 PARAMETER(NLL.CDD_Comment_5);
 {
  //?USER: Initialize routine

  //?** Used by HPE in STR Hog Prcr & Eval Sys-HPE System
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 // WRK.Text USR 7 = CVTVAR(DB1.Load ID)
 WRK.Text_USR_7 = CVTVAR(DB1.Load_ID);

 // WRK.Text USR 40 = CONCAT(CON.Load Confirmation:,WRK.Text USR 7,CON.1)
 WRK.Text_USR_40 = 'Load Confirmation:' + WRK.Text_USR_7 (1);

 // WRK.Text USR 40 = CONCAT(WRK.Text USR 40,CON.Carrier:,CON.1)
 WRK.Text_USR_40 = WRK.Text_USR_40 + 'Carrier:' (1);

 // WRK.Text USR 40 = CONCAT(WRK.Text USR 40,DB1.Carrier Code,CON.1)
 WRK.Text_USR_40 = WRK.Text_USR_40 + DB1.Carrier_Code (1);

 // Call program EXC LC Fax or Dupsplf  CL.
 CALL PROGRAM(EXC LC Fax or Dupsplf  CL) ('PNW4UPC');
 PARAMETER(LCL.CDD_Printer_File_Name);
 PARAMETER(WRK.Text_USR_40);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(LCL.CDD_Sender_Fax);
 PARAMETER(LCL.Ship_From_Warehouse);
 PARAMETER(PAR.Status_Flag_11_Y_N);
 PARAMETER(LCL.Output_Queue);
 PARAMETER(LCL.Hold_File);
 PARAMETER(LCL.Save_File);

 ENDDO;

 ENDIF;

 ENDIF;

}


ENDIF;

//?** Fax or Email Mexican Carrier
CASE;

// IF PAR.Status Flag 3  Y/N is Yes
IF PAR.Status_Flag_3_Y_N = 'Y';

EXECUTE FUNCTION(RTV by Load-fax LdCnfrmRT) TYPE(RTVOBJ) FILE(OMFJCPP)          AC2019576;
PARAMETER(PAR.Load_ID);
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.OHE_Carrier_SCAC_Code);
PARAMETER(PAR.Status_Flag_3_Y_N);
PARAMETER('N');
PARAMETER(PAR.Status_Description_3_USR);
PARAMETER(PAR.USR_Status_Y_N);
PARAMETER(PAR.Default_Carrier_Code);
PARAMETER(*BLANK);
{
 //?USER: Initialize routine

 //?***** Change Log and comments
 DO;

 //?*****
 //?** 04/15/2011 LJB P000737
 //?** Copied from RTV by Carrier.
 //?** Retrieve by Load ID for faxing to Shipper, Transloader,
 //?** Mexican Carrier, Export Coordinator, other email addresses.
 //?** Pass Carrier, as well, to include on load confirm & subject lines
 //?*****
 ENDDO;

 // LCL.Fax Recipient 2 = CON.*BLANK
 LCL.Fax_Recipient_2 = *BLANK;

 // LCL.Fax Number FF = CON.*BLANK
 LCL.Fax_Number_FF = *BLANK;

 //?USER: Exit processing

 //?** Only process if there is someone to send the confirmation to.
 //?** Fax or email load confirmation to requested recipient
 CASE;

 // IF PAR.Status Flag 11 Y/N is Yes
 IF PAR.Status_Flag_11_Y_N = 'Y';

 // OR PAR.Status Flag 12 Y/N is Yes
 OR PAR.Status_Flag_12_Y_N = 'Y';

 EXECUTE FUNCTION(RTV Co Document Dflts  RT) TYPE(RTVOBJ) FILE(PPAQREP)          AC1823355;
 PARAMETER(PAR.Company_Number);
 PARAMETER('LC');
 PARAMETER('DSPTCH');
 PARAMETER(NLL.CDD_Name_of_Overlay);
 PARAMETER(NLL.CDD_Program_Name);
 PARAMETER(LCL.CDD_Printer_File_Name);
 PARAMETER(NLL.CDD_Sender_Phone);
 PARAMETER(NLL.CDD_Sender_Fax);
 PARAMETER(LCL.Output_Queue);
 PARAMETER(LCL.Hold_File);
 PARAMETER(LCL.Save_File);
 PARAMETER(NLL.Source_Drawer);
 PARAMETER(NLL.Printer_Device_Type);
 PARAMETER(NLL.Page_Length_2);
 PARAMETER(NLL.Page_Width_2);
 PARAMETER(NLL.Page_LPI);
 PARAMETER(NLL.Page_CPI);
 PARAMETER(NLL.Page_Overflow);
 PARAMETER(NLL.Page_Rotation);
 PARAMETER(NLL.CDD_Comment_1);
 PARAMETER(NLL.CDD_Comment_2);
 PARAMETER(NLL.CDD_Comment_3);
 PARAMETER(NLL.CDD_Comment_4);
 PARAMETER(NLL.CDD_Comment_5);
 {
  //?USER: Initialize routine

  //?** Used by HPE in STR Hog Prcr & Eval Sys-HPE System
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 // Execute command - 'EXE OVRPRTF Hold/Save'
 EXECUTE COMMAND(USR4013);
 PARAMETER(LCL.CDD_Printer_File_Name);
 PARAMETER(LCL.Hold_File);
 PARAMETER(LCL.Save_File);

 //?** Fax and/or email to Carrier
 CASE;

 // IF PAR.Status Flag 11 Y/N is Yes
 IF PAR.Status_Flag_11_Y_N = 'Y';

 //?** Fax to Carriers - Shipper,Transloader,Mex Carr are in Co Carr File
 //?** Fax to number in Company Carrier file
 CASE;

 // IF PAR.USR Status (Y/N) is Fax
 IF PAR.USR_Status_Y_N = 'F';

 //?** This rtvobj will loop through all fax numbers and email
 //?** addresses for this Carrier by Company
 //?** par.carrier code contains the Shipper, Transloader, Mexican Carrier
 //?** par.carrier code usr contains the Carrier
 // WRK.CC Sequence Nbr = CON.1
 WRK.CC_Sequence_Nbr = 1;

 EXECUTE FUNCTION(RTV/Send Fax & Email   RT) TYPE(RTVOBJ) FILE(PLAAREP)          AC1790496;
 PARAMETER(PAR.Company_Number);
 PARAMETER(PAR.Carrier_Code);
 PARAMETER(WRK.CC_Sequence_Nbr);
 PARAMETER(LCL.Name);
 PARAMETER(LCL.Fax_Recipient_2);
 PARAMETER(LCL.Fax_Number_FF);
 PARAMETER(PAR.Load_ID);
 PARAMETER(PAR.Status_Description_3_USR);
 PARAMETER(PAR.Carrier_Code_Usr);
 {
  //?USER: Initialize routine

  // LCL.First Time Flag = CND.Yes
  LCL.First_Time_Flag = 'Y';

  //?***** Change Log and comments
  DO;

  //?*****
  //?** 05/25/2011 LJB P000737
  //?** Add 2nd carrier code to hold primary carrier. This is the
  //?** carrier that is printed on the Load Confirmation and will
  //?** print on the subject line for emails
  //?*****
  //?** 12/07/2006 LJB L61207A
  //?** Put fax to dispatch office outside of the test for a fax
  //?** number in the file, since there may only be an email address
  //?*****
  //?** 11/16/2006 LJB L61110A
  //?** Add Load ID and Carrier Code to the Subject Line when
  //?** the Load Confirmation is emailed to the Carrier dispatch office
  ENDDO;

  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  //?** Build the Subject Line: Load Confirm + Load ID + Carrier Code
  // WRK.Text USR 7 = CVTVAR(PAR.Load ID)
  WRK.Text_USR_7 = CVTVAR(PAR.Load_ID);

  // WRK.Text USR 40 = CONCAT(CON.Load Confirmation:,WRK.Text USR 7,CON.1)
  WRK.Text_USR_40 = 'Load Confirmation:' + WRK.Text_USR_7 (1);

  // WRK.Text USR 40 = CONCAT(WRK.Text USR 40,CON.Carrier:,CON.1)
  WRK.Text_USR_40 = WRK.Text_USR_40 + 'Carrier:' (1);

  // WRK.Text USR 40 = CONCAT(WRK.Text USR 40,PAR.Default Carrier Code,CON.1)
  WRK.Text_USR_40 = WRK.Text_USR_40 + PAR.Default_Carrier_Code (1);

  //?** Moved fax to Seaboard dispatch to calling program.   E00170
  //?** Fax to Company Carrier fax number if not blanks
  CASE;

  // IF DB1.CC Fax Number is Entered
  IF DB1.CC_Fax_Number <> *BLANK;

  // Call program PRC Call Telex         UP.
  CALL PROGRAM(PRC Call Telex         UP) ('PODYUPR');
  PARAMETER(PAR.Status_Description_3_USR);
  PARAMETER(WRK.Text_USR_40);
  PARAMETER(*BLANK);
  PARAMETER(PAR.Fax_Recipient);
  PARAMETER(PAR.Fax_Recipient);
  PARAMETER(DB1.CC_Fax_Number);
  PARAMETER(1);
  PARAMETER(*BLANK);
  PARAMETER(*BLANK);

  ENDIF;

  //?** Email Load Confirmation
  CASE;

  // IF DB1.CC Email Address is Entered
  IF DB1.CC_Email_Address <> *BLANK;

  //?** Send to the address in the file if it is not blanks
  // Call program Exc ESNDMAIL to Co CarrUP.
  CALL PROGRAM(Exc ESNDMAIL to Co CarrUP) ('PLAMUPC');
  PARAMETER(PAR.Status_Description_3_USR);
  PARAMETER(WRK.Text_USR_40);
  PARAMETER(DB1.CC_Email_Address);

  ENDIF;

 }

 //?** Update Fax Status flag
 EXECUTE FUNCTION(CHG Load Conf Fax Sts  CH) TYPE(CHGOBJ) FILE(OMFJCPP)          AC1609738;
 PARAMETER(PAR.Load_ID);
 PARAMETER('Y');
 {
  //?USER: Processing before Data update

  EXECUTE FUNCTION(Set Date/Time Stamp   IF) TYPE(EXCINTFUN)                      AC1142219;
  PARAMETER(DB1.Job_Time);
  PARAMETER(DB1.User_Id);
  PARAMETER(DB1.Job_Name);
  PARAMETER(DB1.Job_Date);
  {
   //?Execute internal function

   // PAR.Job Time = JOB.*Job time
   PAR.Job_Time = JOB.*Job_time;

   // PAR.User Id = JOB.*USER
   PAR.User_Id = JOB.*USER;

   // PAR.Job Name = JOB.*JOB
   PAR.Job_Name = JOB.*JOB;

   // PAR.Job Date = JOB.*Job date
   PAR.Job_Date = JOB.*Job_date;

  }

 }

 ENDIF;

 ENDIF;

 //?** If Fax to Dispatch = Y, fax also to Ship From Warehouse
 CASE;

 // IF PAR.Status Flag 12 Y/N is Yes
 IF PAR.Status_Flag_12_Y_N = 'Y';

 //?** Get Dispatch fax number from co doc dflts file & fax
 DO;

 //?** Retrieve all available fields for Comp Doc Defaults
 // WRK.CDD Department Code = CND.Dispatch
 WRK.CDD_Department_Code = 'DSPTCH';

 EXECUTE FUNCTION(RTV Co Doc Dflts-All   RT) TYPE(RTVOBJ) FILE(PPAQREP)          AC1912301;
 PARAMETER(PAR.Company_Number);
 PARAMETER('LC');
 PARAMETER(WRK.CDD_Department_Code);
 PARAMETER(NLL.CDD_Name_of_Overlay);
 PARAMETER(NLL.CDD_Program_Name);
 PARAMETER(LCL.CDD_Printer_File_Name);
 PARAMETER(LCL.CDD_Additional_Object);
 PARAMETER(NLL.CDD_Sender_Phone);
 PARAMETER(LCL.CDD_Sender_Fax);
 PARAMETER(LCL.Output_Queue);
 PARAMETER(LCL.Hold_File);
 PARAMETER(LCL.Save_File);
 PARAMETER(NLL.Source_Drawer);
 PARAMETER(NLL.Printer_Device_Type);
 PARAMETER(NLL.Page_Length_2);
 PARAMETER(NLL.Page_Width_2);
 PARAMETER(NLL.Page_LPI);
 PARAMETER(NLL.Page_CPI);
 PARAMETER(NLL.Page_Overflow);
 PARAMETER(NLL.Page_Rotation);
 PARAMETER(NLL.CDD_Valid_Name_1_Unused);
 PARAMETER(NLL.CDD_Valid_Name_2_Unused);
 PARAMETER(NLL.CDD_Valid_Name_3_Unused);
 PARAMETER(NLL.CDD_Copies);
 PARAMETER(NLL.CDD_Number_2_Unused_3_0);
 PARAMETER(NLL.CDD_Number_3_Unused_3_0);
 PARAMETER(NLL.CDD_Number_4_Unused_5_0);
 PARAMETER(NLL.CDD_Number_5_Unused_5_0);
 PARAMETER(NLL.CDD_Comment_1);
 PARAMETER(NLL.CDD_Comment_2);
 PARAMETER(NLL.CDD_Comment_3);
 PARAMETER(NLL.CDD_Comment_4);
 PARAMETER(NLL.CDD_Comment_5);
 PARAMETER(NLL.CDD_Unused_Sts_1_1);
 PARAMETER(NLL.CDD_Unused_Sts_1_2);
 PARAMETER(NLL.CDD_Unused_Sts_2_1);
 PARAMETER(NLL.CDD_Unused_Sts_2_2);
 PARAMETER(NLL.CDD_Unused_Text_1);
 PARAMETER(NLL.CDD_Unused_Text_2);
 PARAMETER(NLL.CDD_Unused_Text_3);
 PARAMETER(NLL.CDD_Unused_Text_4);
 PARAMETER(NLL.CDD_Unused_Text_5);
 PARAMETER(NLL.CDD_Unused_Date_1);
 PARAMETER(NLL.CDD_Unused_Date_2);
 PARAMETER(NLL.CDD_Unused_Date_3);
 PARAMETER(NLL.CDD_Unused_Time_1);
 PARAMETER(NLL.CDD_Unused_Time_2);
 PARAMETER(NLL.CDD_Unused_Time_3);
 PARAMETER(NLL.Record_Status);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 // LCL.Fax Number FF = LCL.CDD Sender Fax
 LCL.Fax_Number_FF = LCL.CDD_Sender_Fax;

 // LCL.Fax Recipient 2 = CON.DISPATCH
 LCL.Fax_Recipient_2 = 'DISPATCH';

 // WRK.Text USR 7 = CVTVAR(DB1.Load ID)
 WRK.Text_USR_7 = CVTVAR(DB1.Load_ID);

 // WRK.Text USR 40 = CONCAT(CON.Load Confirmation:,WRK.Text USR 7,CON.1)
 WRK.Text_USR_40 = 'Load Confirmation:' + WRK.Text_USR_7 (1);

 // WRK.Text USR 40 = CONCAT(WRK.Text USR 40,CON.Carrier:,CON.1)
 WRK.Text_USR_40 = WRK.Text_USR_40 + 'Carrier:' (1);

 // WRK.Text USR 40 = CONCAT(WRK.Text USR 40,DB1.Carrier Code,CON.1)
 WRK.Text_USR_40 = WRK.Text_USR_40 + DB1.Carrier_Code (1);

 //?** Fax as requested
 // Call program EXC LC Fax or Dupsplf  CL.
 CALL PROGRAM(EXC LC Fax or Dupsplf  CL) ('PNW4UPC');
 PARAMETER(LCL.CDD_Printer_File_Name);
 PARAMETER(WRK.Text_USR_40);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(LCL.Fax_Number_FF);
 PARAMETER(LCL.Fax_Recipient_2);
 PARAMETER(PAR.Status_Flag_11_Y_N);
 PARAMETER(LCL.Output_Queue);
 PARAMETER(LCL.Hold_File);
 PARAMETER(LCL.Save_File);

 //?** Dupsplf if Additional Object is entered for a 2nd outq    E00303
 CASE;

 // IF LCL.CDD Additional Object NE WRK.Blank 6 USR
 IF LCL.CDD_Additional_Object <> WRK.Blank_6_USR;

 // Call program EXC LC Fax or Dupsplf  CL.
 CALL PROGRAM(EXC LC Fax or Dupsplf  CL) ('PNW4UPC');
 PARAMETER(LCL.CDD_Printer_File_Name);
 PARAMETER(WRK.Text_USR_40);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANKS);
 PARAMETER(*blanks);
 PARAMETER(PAR.Status_Flag_11_Y_N);
 PARAMETER(LCL.CDD_Additional_Object);
 PARAMETER(LCL.Hold_File);
 PARAMETER(LCL.Save_File);

 ENDIF;

 ENDDO;

 //?** Get fax or outq for ship from whse and send            E00170
 DO;

 EXECUTE FUNCTION(RTV Ship From WarehouseRT) TYPE(RTVOBJ) FILE(OMFJCPP)          AC1897598;
 PARAMETER(PAR.Load_ID);
 PARAMETER(LCL.Ship_From_Warehouse);
 {
  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 // WRK.CDD Department Code = LCL.Ship From Warehouse
 WRK.CDD_Department_Code = LCL.Ship_From_Warehouse;

 EXECUTE FUNCTION(RTV Co Document Dflts  RT) TYPE(RTVOBJ) FILE(PPAQREP)          AC1823355;
 PARAMETER(PAR.Company_Number);
 PARAMETER('LC');
 PARAMETER(WRK.CDD_Department_Code);
 PARAMETER(NLL.CDD_Name_of_Overlay);
 PARAMETER(NLL.CDD_Program_Name);
 PARAMETER(LCL.CDD_Printer_File_Name);
 PARAMETER(NLL.CDD_Sender_Phone);
 PARAMETER(LCL.CDD_Sender_Fax);
 PARAMETER(LCL.Output_Queue);
 PARAMETER(LCL.Hold_File);
 PARAMETER(LCL.Save_File);
 PARAMETER(NLL.Source_Drawer);
 PARAMETER(NLL.Printer_Device_Type);
 PARAMETER(NLL.Page_Length_2);
 PARAMETER(NLL.Page_Width_2);
 PARAMETER(NLL.Page_LPI);
 PARAMETER(NLL.Page_CPI);
 PARAMETER(NLL.Page_Overflow);
 PARAMETER(NLL.Page_Rotation);
 PARAMETER(NLL.CDD_Comment_1);
 PARAMETER(NLL.CDD_Comment_2);
 PARAMETER(NLL.CDD_Comment_3);
 PARAMETER(NLL.CDD_Comment_4);
 PARAMETER(NLL.CDD_Comment_5);
 {
  //?USER: Initialize routine

  //?** Used by HPE in STR Hog Prcr & Eval Sys-HPE System
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 // WRK.Text USR 7 = CVTVAR(DB1.Load ID)
 WRK.Text_USR_7 = CVTVAR(DB1.Load_ID);

 // WRK.Text USR 40 = CONCAT(CON.Load Confirmation:,WRK.Text USR 7,CON.1)
 WRK.Text_USR_40 = 'Load Confirmation:' + WRK.Text_USR_7 (1);

 // WRK.Text USR 40 = CONCAT(WRK.Text USR 40,CON.Carrier:,CON.1)
 WRK.Text_USR_40 = WRK.Text_USR_40 + 'Carrier:' (1);

 // WRK.Text USR 40 = CONCAT(WRK.Text USR 40,DB1.Carrier Code,CON.1)
 WRK.Text_USR_40 = WRK.Text_USR_40 + DB1.Carrier_Code (1);

 // Call program EXC LC Fax or Dupsplf  CL.
 CALL PROGRAM(EXC LC Fax or Dupsplf  CL) ('PNW4UPC');
 PARAMETER(LCL.CDD_Printer_File_Name);
 PARAMETER(WRK.Text_USR_40);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(LCL.CDD_Sender_Fax);
 PARAMETER(LCL.Ship_From_Warehouse);
 PARAMETER(PAR.Status_Flag_11_Y_N);
 PARAMETER(LCL.Output_Queue);
 PARAMETER(LCL.Hold_File);
 PARAMETER(LCL.Save_File);

 ENDDO;

 ENDIF;

 ENDIF;

}


ENDIF;

//?** Email to Export Coordinator and any additional email addresses
//?** passed in from the load confirm prompt         P000737
//?** Build the Subject Line: Load Confirm + Load ID + Carrier Code
// WRK.Text USR 7 = CVTVAR(PAR.Load ID)
WRK.Text_USR_7 = CVTVAR(PAR.Load_ID);

// WRK.Text USR 40 = CONCAT(CON.Load Confirmation:,WRK.Text USR 7,CON.1)
WRK.Text_USR_40 = 'Load Confirmation:' + WRK.Text_USR_7 (1);

// WRK.Text USR 40 = CONCAT(WRK.Text USR 40,CON.Carrier:,CON.1)
WRK.Text_USR_40 = WRK.Text_USR_40 + 'Carrier:' (1);

// WRK.Text USR 40 = CONCAT(WRK.Text USR 40,PAR.Default Carrier Code,CON.1)
WRK.Text_USR_40 = WRK.Text_USR_40 + PAR.Default_Carrier_Code (1);

CASE;

// IF PAR.Email Address is Entered
IF PAR.Email_Address <> *BLANK;

// Call program Exc ESNDMAIL to Co CarrUP.
CALL PROGRAM(Exc ESNDMAIL to Co CarrUP) ('PLAMUPC');
PARAMETER(PAR.Status_Description_3_USR);
PARAMETER(WRK.Text_USR_40);
PARAMETER(PAR.Email_Address);

ENDIF;

ENDIF;

//?***** Change Log and Comments
DO;

//?*****
//?** 04/24/2011 LJB P000737
//?** Remove WF Load Confirmation WF file, use RTV by Carrier from
//?** the Load Header, remove job code, Add several new parameters,
//?** Move Print of load confirmation outside the retrieve for Print Only
//?** Print the load confirmation. Then fax or email if requested.
//?** Fax/Print flag helps determine if **Revised** is printed or not
//?** Status-Y or N = Fax Carrier, Status Flag 1 Y/N=Fax Dispatcher,
//?** Status Flag 2 Y/N=Fax Transloader, Status Flag 3 Y/N=Fax Mexican,
//?** Status Flag 4 Y/N=Fax Exp Coordn, Status Flag 5 Y/N=Fax Ocean Shpr,
//?** Usr Status (Y/N)=Print Only/Fax, Status Description 3=Printer file
//?*****
//?** 07/14/2009 LJB E00408
//?** Don't skip printing the "Revised" message at the top if the
//?** last revision was internal, there still may be revisions that
//?** need to be flagged. Just blank out the additional text.
//?*****
//?** 01/14/09 LJB E00330
//?** Pass Hold and Save parms from the CDD file
//?*****
//?** 12/22/08 LJB E00303
//?** DUPSPLF to CDD Additional Object, if one is entered
//?*****
//?** 12/04/08 LJB S00580
//?** Update Fax Status flag if confirmation is faxed to carrier
//?*****
//?** 09/03/08 LJB E00170 - Add send Load Confirm to both the Ship From
//?** Whse and Dispatch when Dispatch = Y. Add rtv OUTQ or Fax Number
//?** from the Company Document Defaults file
//?*****
//?5/19/04 RMC PKTR01 - added par.company to use when rtv company values
//?   in rtv by carrier routine
//?*****
//?** 5/17/06 LJB T00008 - recompile to accommodate change in
//?   length of the Fax Number
//?*****
//?** 8/21/06 LJB TRF021 - Change RTV by Carrier to fax to the
//?** fax number in the Company Carrier file instead of the
//?** Carrier file. Carriers can have multiple email and
//?** fax numbers based on the Start Load company number.
//?*****
//?** 11/16/2006 LJB L61110A - Change the Description, which will
//?** become the Subject Line when the Load Confirmation is emailed,
//?** to include the Load ID and the Carrier Code so Traffic will
//?** know who is responding when they receive a return email.
//?*****
//?** 12/07/2006 LJB L61207A - Remove the code that skips out if the
//?** first fax number is blank. There may still be an email
//?** address that is valid.  Also, First time logic is changed so
//?** faxing to the dispatcher is not dependent on db1.fax number
//?** since there may only be an email address.
//?*****
ENDDO;

