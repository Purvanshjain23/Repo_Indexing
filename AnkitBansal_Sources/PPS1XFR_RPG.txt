     H/TITLE TF Crt Order Header   XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISJBADE
     H* Date          : 09/16/16  Time  : 09:33:17
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FARBDCPL3IF  E           K        DISK
      * RTV : A/R Header                Retrieval index       NV
      *
     FARBECPL1IF  E           K        DISK
      * RTV : A/R Detail                Retrieval index       V
      *
     FPOBUREL1IF  E           K        DISK
      * RTV : A/R Header Notes OLD      Retrieval index
      *
     FARBDCPL0IF  E           K        DISK                      A
      * UPD : A/R Header                Update index
      *
     FARBECPL0IF  E           K        DISK                      A
      * UPD : A/R Detail                Update index
      *
     FPOBUREL0IF  E           K        DISK                      A
      * UPD : A/R Header Notes OLD      Update index
      *
     FOPBFCPL0IF  E           K        DISK                      A
      * UPD : Order Header TRG          Update index
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WAAIC3
     I              BEC4NB                          WAC4NB
     I              BEJNCD                          WAJNCD
     I              BEANC7                          WAANC7
     I              BEBKC7                          WABKC7
     I              BEBRTX                          WABRTX
     I              BEHMNA                          WAHMNA
     I              BEHONA                          WAHONA
     I              BEHPNA                          WAHPNA
     I              BEHNNA                          WAHNNA
     I              BEDBCD                          WADBCD
     I              BECKTX                          WACKTX
     I              BEB0C7                          WAB0C7
     I              BEAETX                          WAAETX
     I              BEB1NA                          WAB1NA
     I              BEB3NA                          WAB3NA
     I              BEB4NA                          WAB4NA
     I              BEB2NA                          WAB2NA
     I              BEBHCD                          WABHCD
     I              BEC8TX                          WAC8TX
     I              BEBCNA                          WABCNA
     I              BEA0DT                          WAA0DT
     I              BEA5DT                          WAA5DT
     I              BEGNDT                          WAGNDT
     I              BEACDT                          WAACDT
     I              BEAQCD                          WAAQCD
     I              BEB6NA                          WAB6NA
     I              BEBYNA                          WABYNA
     I              BEBZNA                          WABZNA
     I              BEGTST                          WAGTST
     I              BEGVST                          WAGVST
     I              BEGUST                          WAGUST
     I              BEQFST                          WAQFST
     I              BECQCD                          WACQCD
     I              BEGJST                          WAGJST
     I              BEGWST                          WAGWST
     I              BEGXST                          WAGXST
     I              BEGYST                          WAGYST
     I              BEAODT                          WAAODT
     I              BEAIVN                          WAAIVN
     I              BECXDT                          WACXDT
     I              BEJZVA                          WAJZVA
     I              BEA1WG                          WAA1WG
     I              BEXIST                          WAXIST
     I              BEXJST                          WAXJST
     I              BEXKST                          WAXKST
     I              BEEIDT                          WAEIDT
     I              BEAFTM                          WAAFTM
     I              BEE8CD                          WAE8CD
     I              BEE9CD                          WAE9CD
     I              BERMNB                          WARMNB
     I              BETBNB                          WATBNB
     I              BER1NB                          WAR1NB
     I              BEPJST                          WAPJST
     I              BEU0ST                          WAU0ST
     I              BEU1ST                          WAU1ST
     I              BEQ2CD                          WAQ2CD
     I              BEU2ST                          WAU2ST
     I              BEVEST                          WAVEST
     I              BEVFST                          WAVFST
     I              BEVGST                          WAVGST
     I              BERPCD                          WARPCD
     I              BERNNB                          WARNNB
     I              BEVDST                          WAVDST
     I              BEATIN                          WAATIN
     I              BEU4ST                          WAU4ST
     I              BEU5ST                          WAU5ST
     I              BERSRN                          WARSRN
     I              BEMHNA                          WAMHNA
     I              BEMINA                          WAMINA
     I              BEWBST                          WAWBST
     I              BER4CD                          WAR4CD
     I              BEBFCD                          WABFCD
     I              BEQ4CD                          WAQ4CD
     I              BET3NB                          WAT3NB
     I              BESICD                          WASICD
     I              BECONB                          WACONB
     I              BECEST                          WACEST
     I              BEAWDT                          WAAWDT
     I              BEJPCD                          WAJPCD
     I              BEXUST                          WAXUST
     I              BEZ1ST                          WAZ1ST
     I              BEVRVA                          WAVRVA
     I              BEOBST                          WAOBST
     I              BEBCST                          WABCST
     I              BEBDST                          WABDST
     I              BEB7VL                          WAB7VL
     I              BEGASX                          WAGASX
     I              BEGBSX                          WAGBSX
     I              BEGCSX                          WAGCSX
     I              BEGDSX                          WAGDSX
     I              BEFNSX                          WAFNSX
     I              BEFOSX                          WAFOSX
     I              BEFPSX                          WAFPSX
     I              BEFQSX                          WAFQSX
     I              BEFRSX                          WAFRSX
     I              BEFSSX                          WAFSSX
     I              BEFTSX                          WAFTSX
     I              BEFUSX                          WAFUSX
     I              BEFVSX                          WAFVSX
     I              BEFWSX                          WAFWSX
     I              BEFXSX                          WAFXSX
     I              BEFYSX                          WAFYSX
     I              BENODT                          WANODT
     I              BENPDT                          WANPDT
     I              BENQDT                          WANQDT
     I              BENRDT                          WANRDT
     I              BENSDT                          WANSDT
     I              BEBPTM                          WABPTM
     I              BEBQTM                          WABQTM
     I              BEBRTM                          WABRTM
     I              BEBSTM                          WABSTM
     I              BEBTTM                          WABTTM
     I              BEH0NX                          WAH0NX
     I              BEH1NX                          WAH1NX
     I              BEH2NX                          WAH2NX
     I              BEH3NX                          WAH3NX
     I              BEH4NX                          WAH4NX
     I              BEC0C7                          WAC0C7
     I              BEUVST                          WAUVST
     I              BEUWST                          WAUWST
     I              BEUXST                          WAUXST
     I              BEAATM                          WAAATM
     I              BEAYNA                          WAAYNA
     I              BEA0NA                          WAA0NA
     I              BEAXDT                          WAAXDT
      *
     I@BDCPF7
      * A/R Header                Retrieval index       NV
      * Renamed input format fields
     I              BDAIC3                          WBAIC3
     I              BDCONB                          WBCONB
     I              BDCEST                          WBCEST
     I              BDUHCD                          WBUHCD
     I              BDBSVA                          WBBSVA
     I              BDAIVA                          WBAIVA
     I              BDAOVA                          WBAOVA
     I              BDBGVA                          WBBGVA
     I              BDAJST                          WBAJST
     I              BDE3ST                          WBE3ST
     I              BDG4CD                          WBG4CD
     I              BDCKNB                          WBCKNB
     I              BDCAC7                          WBCAC7
     I              BDBKC7                          WBBKC7
     I              BDBCCD                          WBBCCD
     I              BDR4CD                          WBR4CD
     I              BDB4DT                          WBB4DT
     I              BDATDT                          WBATDT
     I              BDH0DT                          WBH0DT
     I              BDH3DT                          WBH3DT
     I              BDH4DT                          WBH4DT
     I              BDH5DT                          WBH5DT
     I              BDANC7                          WBANC7
     I              BDCPTX                          WBCPTX
     I              BDBSDY                          WBBSDY
     I              BDUVST                          WBUVST
     I              BDUWST                          WBUWST
     I              BDUXST                          WBUXST
     I              BDAATM                          WBAATM
     I              BDAYNA                          WBAYNA
     I              BDA0NA                          WBA0NA
     I              BDAXDT                          WBAXDT
      *
     I@BDCPFG
      * A/R Header                Update index
      * Renamed input format fields
     I              BDAIC3                          WCAIC3
     I              BDCONB                          WCCONB
     I              BDCEST                          WCCEST
     I              BDUHCD                          WCUHCD
     I              BDBSVA                          WCBSVA
     I              BDAIVA                          WCAIVA
     I              BDAOVA                          WCAOVA
     I              BDBGVA                          WCBGVA
     I              BDAJST                          WCAJST
     I              BDE3ST                          WCE3ST
     I              BDG4CD                          WCG4CD
     I              BDCKNB                          WCCKNB
     I              BDCAC7                          WCCAC7
     I              BDBKC7                          WCBKC7
     I              BDBCCD                          WCBCCD
     I              BDR4CD                          WCR4CD
     I              BDB4DT                          WCB4DT
     I              BDATDT                          WCATDT
     I              BDH0DT                          WCH0DT
     I              BDH3DT                          WCH3DT
     I              BDH4DT                          WCH4DT
     I              BDH5DT                          WCH5DT
     I              BDANC7                          WCANC7
     I              BDCPTX                          WCCPTX
     I              BDBSDY                          WCBSDY
     I              BDUVST                          WCUVST
     I              BDUWST                          WCUWST
     I              BDUXST                          WCUXST
     I              BDAATM                          WCAATM
     I              BDAYNA                          WCAYNA
     I              BDA0NA                          WCA0NA
     I              BDAXDT                          WCAXDT
      *
     I@BFCPFO
      * A/R Detail                Retrieval index       V
      * Renamed input format fields
     I              BFAIC3                          WDAIC3
     I              BFCONB                          WDCONB
     I              BFCEST                          WDCEST
     I              BFDXNB                          WDDXNB
     I              BFUHCD                          WDUHCD
     I              BFBSVA                          WDBSVA
     I              BFCPTX                          WDCPTX
     I              BFNGNA                          WDNGNA
     I              BFB4DT                          WDB4DT
     I              BFDVDT                          WDDVDT
     I              BFYXNX                          WDYXNX
     I              BFHYDT                          WDHYDT
     I              BFG4CD                          WDG4CD
     I              BFCKNB                          WDCKNB
     I              BFA5ST                          WDA5ST
     I              BFAJST                          WDAJST
     I              BFB1VN                          WDB1VN
     I              BFEAZT                          WDEAZT
     I              BFC1NY                          WDC1NY
     I              BFIZTX                          WDIZTX
     I              BFETSX                          WDETSX
     I              BFW3SX                          WDW3SX
     I              BFW4SX                          WDW4SX
     I              BFW5SX                          WDW5SX
     I              BFW6SX                          WDW6SX
     I              BFW7SX                          WDW7SX
     I              BFW8SX                          WDW8SX
     I              BFQHDT                          WDQHDT
     I              BFQIDT                          WDQIDT
     I              BFQJDT                          WDQJDT
     I              BFQKDT                          WDQKDT
     I              BFQLDT                          WDQLDT
     I              BFGLVL                          WDGLVL
     I              BFGMVL                          WDGMVL
     I              BFGNVL                          WDGNVL
     I              BFGOVL                          WDGOVL
     I              BFGPVL                          WDGPVL
     I              BFUVST                          WDUVST
     I              BFUWST                          WDUWST
     I              BFUXST                          WDUXST
     I              BFAATM                          WDAATM
     I              BFAYNA                          WDAYNA
     I              BFA0NA                          WDA0NA
     I              BFAXDT                          WDAXDT
      *
     I@BFCPFN
      * A/R Detail                Update index
      * Renamed input format fields
     I              BFAIC3                          WEAIC3
     I              BFCONB                          WECONB
     I              BFCEST                          WECEST
     I              BFDXNB                          WEDXNB
     I              BFUHCD                          WEUHCD
     I              BFBSVA                          WEBSVA
     I              BFCPTX                          WECPTX
     I              BFNGNA                          WENGNA
     I              BFB4DT                          WEB4DT
     I              BFDVDT                          WEDVDT
     I              BFYXNX                          WEYXNX
     I              BFHYDT                          WEHYDT
     I              BFG4CD                          WEG4CD
     I              BFCKNB                          WECKNB
     I              BFA5ST                          WEA5ST
     I              BFAJST                          WEAJST
     I              BFB1VN                          WEB1VN
     I              BFEAZT                          WEEAZT
     I              BFC1NY                          WEC1NY
     I              BFIZTX                          WEIZTX
     I              BFETSX                          WEETSX
     I              BFW3SX                          WEW3SX
     I              BFW4SX                          WEW4SX
     I              BFW5SX                          WEW5SX
     I              BFW6SX                          WEW6SX
     I              BFW7SX                          WEW7SX
     I              BFW8SX                          WEW8SX
     I              BFQHDT                          WEQHDT
     I              BFQIDT                          WEQIDT
     I              BFQJDT                          WEQJDT
     I              BFQKDT                          WEQKDT
     I              BFQLDT                          WEQLDT
     I              BFGLVL                          WEGLVL
     I              BFGMVL                          WEGMVL
     I              BFGNVL                          WEGNVL
     I              BFGOVL                          WEGOVL
     I              BFGPVL                          WEGPVL
     I              BFUVST                          WEUVST
     I              BFUWST                          WEUWST
     I              BFUXST                          WEUXST
     I              BFAATM                          WEAATM
     I              BFAYNA                          WEAYNA
     I              BFA0NA                          WEA0NA
     I              BFAXDT                          WEAXDT
      *
     I@BURELN
      * A/R Header Notes OLD      Retrieval index
      * Renamed input format fields
     I              BUAIC3                          WFAIC3
     I              BUCONB                          WFCONB
     I              BUCEST                          WFCEST
     I              BUOTDT                          WFOTDT
     I              BUDXNB                          WFDXNB
     I              BUL5SX                          WFL5SX
     I              BUOUDT                          WFOUDT
     I              BUA3T1                          WFA3T1
     I              BUA4T1                          WFA4T1
     I              BUA5T1                          WFA5T1
     I              BUL6SX                          WFL6SX
     I              BUL7SX                          WFL7SX
     I              BUL8SX                          WFL8SX
     I              BUBKC7                          WFBKC7
      *
     I@BURELM
      * A/R Header Notes OLD      Update index
      * Renamed input format fields
     I              BUAIC3                          WGAIC3
     I              BUCONB                          WGCONB
     I              BUCEST                          WGCEST
     I              BUOTDT                          WGOTDT
     I              BUDXNB                          WGDXNB
     I              BUL5SX                          WGL5SX
     I              BUOUDT                          WGOUDT
     I              BUA3T1                          WGA3T1
     I              BUA4T1                          WGA4T1
     I              BUA5T1                          WGA5T1
     I              BUL6SX                          WGL6SX
     I              BUL7SX                          WGL7SX
     I              BUL8SX                          WGL8SX
     I              BUBKC7                          WGBKC7
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WHAIC3
     I              BEC4NB                          WHC4NB
     I              BEJNCD                          WHJNCD
     I              BEANC7                          WHANC7
     I              BEBKC7                          WHBKC7
     I              BEBRTX                          WHBRTX
     I              BEHMNA                          WHHMNA
     I              BEHONA                          WHHONA
     I              BEHPNA                          WHHPNA
     I              BEHNNA                          WHHNNA
     I              BEDBCD                          WHDBCD
     I              BECKTX                          WHCKTX
     I              BEB0C7                          WHB0C7
     I              BEAETX                          WHAETX
     I              BEB1NA                          WHB1NA
     I              BEB3NA                          WHB3NA
     I              BEB4NA                          WHB4NA
     I              BEB2NA                          WHB2NA
     I              BEBHCD                          WHBHCD
     I              BEC8TX                          WHC8TX
     I              BEBCNA                          WHBCNA
     I              BEA0DT                          WHA0DT
     I              BEA5DT                          WHA5DT
     I              BEGNDT                          WHGNDT
     I              BEACDT                          WHACDT
     I              BEAQCD                          WHAQCD
     I              BEB6NA                          WHB6NA
     I              BEBYNA                          WHBYNA
     I              BEBZNA                          WHBZNA
     I              BEGTST                          WHGTST
     I              BEGVST                          WHGVST
     I              BEGUST                          WHGUST
     I              BEQFST                          WHQFST
     I              BECQCD                          WHCQCD
     I              BEGJST                          WHGJST
     I              BEGWST                          WHGWST
     I              BEGXST                          WHGXST
     I              BEGYST                          WHGYST
     I              BEAODT                          WHAODT
     I              BEAIVN                          WHAIVN
     I              BECXDT                          WHCXDT
     I              BEJZVA                          WHJZVA
     I              BEA1WG                          WHA1WG
     I              BEXIST                          WHXIST
     I              BEXJST                          WHXJST
     I              BEXKST                          WHXKST
     I              BEEIDT                          WHEIDT
     I              BEAFTM                          WHAFTM
     I              BEE8CD                          WHE8CD
     I              BEE9CD                          WHE9CD
     I              BERMNB                          WHRMNB
     I              BETBNB                          WHTBNB
     I              BER1NB                          WHR1NB
     I              BEPJST                          WHPJST
     I              BEU0ST                          WHU0ST
     I              BEU1ST                          WHU1ST
     I              BEQ2CD                          WHQ2CD
     I              BEU2ST                          WHU2ST
     I              BEVEST                          WHVEST
     I              BEVFST                          WHVFST
     I              BEVGST                          WHVGST
     I              BERPCD                          WHRPCD
     I              BERNNB                          WHRNNB
     I              BEVDST                          WHVDST
     I              BEATIN                          WHATIN
     I              BEU4ST                          WHU4ST
     I              BEU5ST                          WHU5ST
     I              BERSRN                          WHRSRN
     I              BEMHNA                          WHMHNA
     I              BEMINA                          WHMINA
     I              BEWBST                          WHWBST
     I              BER4CD                          WHR4CD
     I              BEBFCD                          WHBFCD
     I              BEQ4CD                          WHQ4CD
     I              BET3NB                          WHT3NB
     I              BESICD                          WHSICD
     I              BECONB                          WHCONB
     I              BECEST                          WHCEST
     I              BEAWDT                          WHAWDT
     I              BEJPCD                          WHJPCD
     I              BEXUST                          WHXUST
     I              BEZ1ST                          WHZ1ST
     I              BEVRVA                          WHVRVA
     I              BEOBST                          WHOBST
     I              BEBCST                          WHBCST
     I              BEBDST                          WHBDST
     I              BEB7VL                          WHB7VL
     I              BEGASX                          WHGASX
     I              BEGBSX                          WHGBSX
     I              BEGCSX                          WHGCSX
     I              BEGDSX                          WHGDSX
     I              BEFNSX                          WHFNSX
     I              BEFOSX                          WHFOSX
     I              BEFPSX                          WHFPSX
     I              BEFQSX                          WHFQSX
     I              BEFRSX                          WHFRSX
     I              BEFSSX                          WHFSSX
     I              BEFTSX                          WHFTSX
     I              BEFUSX                          WHFUSX
     I              BEFVSX                          WHFVSX
     I              BEFWSX                          WHFWSX
     I              BEFXSX                          WHFXSX
     I              BEFYSX                          WHFYSX
     I              BENODT                          WHNODT
     I              BENPDT                          WHNPDT
     I              BENQDT                          WHNQDT
     I              BENRDT                          WHNRDT
     I              BENSDT                          WHNSDT
     I              BEBPTM                          WHBPTM
     I              BEBQTM                          WHBQTM
     I              BEBRTM                          WHBRTM
     I              BEBSTM                          WHBSTM
     I              BEBTTM                          WHBTTM
     I              BEH0NX                          WHH0NX
     I              BEH1NX                          WHH1NX
     I              BEH2NX                          WHH2NX
     I              BEH3NX                          WHH3NX
     I              BEH4NX                          WHH4NX
     I              BEC0C7                          WHC0C7
     I              BEUVST                          WHUVST
     I              BEUWST                          WHUWST
     I              BEUXST                          WHUXST
     I              BEAATM                          WHAATM
     I              BEAYNA                          WHAYNA
     I              BEA0NA                          WHA0NA
     I              BEAXDT                          WHAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQARBD1    E DSARBDCPL0
      * UPD : A/R Header                Update index
      * Renamed input format fields
     I              BDAIC3                          WCAIC3
     I              BDCONB                          WCCONB
     I              BDCEST                          WCCEST
     I              BDUHCD                          WCUHCD
     I              BDBSVA                          WCBSVA
     I              BDAIVA                          WCAIVA
     I              BDAOVA                          WCAOVA
     I              BDBGVA                          WCBGVA
     I              BDAJST                          WCAJST
     I              BDE3ST                          WCE3ST
     I              BDG4CD                          WCG4CD
     I              BDCKNB                          WCCKNB
     I              BDCAC7                          WCCAC7
     I              BDBKC7                          WCBKC7
     I              BDBCCD                          WCBCCD
     I              BDR4CD                          WCR4CD
     I              BDB4DT                          WCB4DT
     I              BDATDT                          WCATDT
     I              BDH0DT                          WCH0DT
     I              BDH3DT                          WCH3DT
     I              BDH4DT                          WCH4DT
     I              BDH5DT                          WCH5DT
     I              BDANC7                          WCANC7
     I              BDCPTX                          WCCPTX
     I              BDBSDY                          WCBSDY
     I              BDUVST                          WCUVST
     I              BDUWST                          WCUWST
     I              BDUXST                          WCUXST
     I              BDAATM                          WCAATM
     I              BDAYNA                          WCAYNA
     I              BDA0NA                          WCA0NA
     I              BDAXDT                          WCAXDT
      *
     IQARBE1    E DSARBECPL0
      * UPD : A/R Detail                Update index
      * Renamed input format fields
     I              BFAIC3                          WEAIC3
     I              BFCONB                          WECONB
     I              BFCEST                          WECEST
     I              BFDXNB                          WEDXNB
     I              BFUHCD                          WEUHCD
     I              BFBSVA                          WEBSVA
     I              BFCPTX                          WECPTX
     I              BFNGNA                          WENGNA
     I              BFB4DT                          WEB4DT
     I              BFDVDT                          WEDVDT
     I              BFYXNX                          WEYXNX
     I              BFHYDT                          WEHYDT
     I              BFG4CD                          WEG4CD
     I              BFCKNB                          WECKNB
     I              BFA5ST                          WEA5ST
     I              BFAJST                          WEAJST
     I              BFB1VN                          WEB1VN
     I              BFEAZT                          WEEAZT
     I              BFC1NY                          WEC1NY
     I              BFIZTX                          WEIZTX
     I              BFETSX                          WEETSX
     I              BFW3SX                          WEW3SX
     I              BFW4SX                          WEW4SX
     I              BFW5SX                          WEW5SX
     I              BFW6SX                          WEW6SX
     I              BFW7SX                          WEW7SX
     I              BFW8SX                          WEW8SX
     I              BFQHDT                          WEQHDT
     I              BFQIDT                          WEQIDT
     I              BFQJDT                          WEQJDT
     I              BFQKDT                          WEQKDT
     I              BFQLDT                          WEQLDT
     I              BFGLVL                          WEGLVL
     I              BFGMVL                          WEGMVL
     I              BFGNVL                          WEGNVL
     I              BFGOVL                          WEGOVL
     I              BFGPVL                          WEGPVL
     I              BFUVST                          WEUVST
     I              BFUWST                          WEUWST
     I              BFUXST                          WEUXST
     I              BFAATM                          WEAATM
     I              BFAYNA                          WEAYNA
     I              BFA0NA                          WEA0NA
     I              BFAXDT                          WEAXDT
      *
     IQPOBU1    E DSPOBUREL0
      * UPD : A/R Header Notes OLD      Update index
      * Renamed input format fields
     I              BUAIC3                          WGAIC3
     I              BUCONB                          WGCONB
     I              BUCEST                          WGCEST
     I              BUOTDT                          WGOTDT
     I              BUDXNB                          WGDXNB
     I              BUL5SX                          WGL5SX
     I              BUOUDT                          WGOUDT
     I              BUA3T1                          WGA3T1
     I              BUA4T1                          WGA4T1
     I              BUA5T1                          WGA5T1
     I              BUL6SX                          WGL6SX
     I              BUL7SX                          WGL7SX
     I              BUL8SX                          WGL8SX
     I              BUBKC7                          WGBKC7
      *
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WHAIC3
     I              BEC4NB                          WHC4NB
     I              BEJNCD                          WHJNCD
     I              BEANC7                          WHANC7
     I              BEBKC7                          WHBKC7
     I              BEBRTX                          WHBRTX
     I              BEHMNA                          WHHMNA
     I              BEHONA                          WHHONA
     I              BEHPNA                          WHHPNA
     I              BEHNNA                          WHHNNA
     I              BEDBCD                          WHDBCD
     I              BECKTX                          WHCKTX
     I              BEB0C7                          WHB0C7
     I              BEAETX                          WHAETX
     I              BEB1NA                          WHB1NA
     I              BEB3NA                          WHB3NA
     I              BEB4NA                          WHB4NA
     I              BEB2NA                          WHB2NA
     I              BEBHCD                          WHBHCD
     I              BEC8TX                          WHC8TX
     I              BEBCNA                          WHBCNA
     I              BEA0DT                          WHA0DT
     I              BEA5DT                          WHA5DT
     I              BEGNDT                          WHGNDT
     I              BEACDT                          WHACDT
     I              BEAQCD                          WHAQCD
     I              BEB6NA                          WHB6NA
     I              BEBYNA                          WHBYNA
     I              BEBZNA                          WHBZNA
     I              BEGTST                          WHGTST
     I              BEGVST                          WHGVST
     I              BEGUST                          WHGUST
     I              BEQFST                          WHQFST
     I              BECQCD                          WHCQCD
     I              BEGJST                          WHGJST
     I              BEGWST                          WHGWST
     I              BEGXST                          WHGXST
     I              BEGYST                          WHGYST
     I              BEAODT                          WHAODT
     I              BEAIVN                          WHAIVN
     I              BECXDT                          WHCXDT
     I              BEJZVA                          WHJZVA
     I              BEA1WG                          WHA1WG
     I              BEXIST                          WHXIST
     I              BEXJST                          WHXJST
     I              BEXKST                          WHXKST
     I              BEEIDT                          WHEIDT
     I              BEAFTM                          WHAFTM
     I              BEE8CD                          WHE8CD
     I              BEE9CD                          WHE9CD
     I              BERMNB                          WHRMNB
     I              BETBNB                          WHTBNB
     I              BER1NB                          WHR1NB
     I              BEPJST                          WHPJST
     I              BEU0ST                          WHU0ST
     I              BEU1ST                          WHU1ST
     I              BEQ2CD                          WHQ2CD
     I              BEU2ST                          WHU2ST
     I              BEVEST                          WHVEST
     I              BEVFST                          WHVFST
     I              BEVGST                          WHVGST
     I              BERPCD                          WHRPCD
     I              BERNNB                          WHRNNB
     I              BEVDST                          WHVDST
     I              BEATIN                          WHATIN
     I              BEU4ST                          WHU4ST
     I              BEU5ST                          WHU5ST
     I              BERSRN                          WHRSRN
     I              BEMHNA                          WHMHNA
     I              BEMINA                          WHMINA
     I              BEWBST                          WHWBST
     I              BER4CD                          WHR4CD
     I              BEBFCD                          WHBFCD
     I              BEQ4CD                          WHQ4CD
     I              BET3NB                          WHT3NB
     I              BESICD                          WHSICD
     I              BECONB                          WHCONB
     I              BECEST                          WHCEST
     I              BEAWDT                          WHAWDT
     I              BEJPCD                          WHJPCD
     I              BEXUST                          WHXUST
     I              BEZ1ST                          WHZ1ST
     I              BEVRVA                          WHVRVA
     I              BEOBST                          WHOBST
     I              BEBCST                          WHBCST
     I              BEBDST                          WHBDST
     I              BEB7VL                          WHB7VL
     I              BEGASX                          WHGASX
     I              BEGBSX                          WHGBSX
     I              BEGCSX                          WHGCSX
     I              BEGDSX                          WHGDSX
     I              BEFNSX                          WHFNSX
     I              BEFOSX                          WHFOSX
     I              BEFPSX                          WHFPSX
     I              BEFQSX                          WHFQSX
     I              BEFRSX                          WHFRSX
     I              BEFSSX                          WHFSSX
     I              BEFTSX                          WHFTSX
     I              BEFUSX                          WHFUSX
     I              BEFVSX                          WHFVSX
     I              BEFWSX                          WHFWSX
     I              BEFXSX                          WHFXSX
     I              BEFYSX                          WHFYSX
     I              BENODT                          WHNODT
     I              BENPDT                          WHNPDT
     I              BENQDT                          WHNQDT
     I              BENRDT                          WHNRDT
     I              BENSDT                          WHNSDT
     I              BEBPTM                          WHBPTM
     I              BEBQTM                          WHBQTM
     I              BEBRTM                          WHBRTM
     I              BEBSTM                          WHBSTM
     I              BEBTTM                          WHBTTM
     I              BEH0NX                          WHH0NX
     I              BEH1NX                          WHH1NX
     I              BEH2NX                          WHH2NX
     I              BEH3NX                          WHH3NX
     I              BEH4NX                          WHH4NX
     I              BEC0C7                          WHC0C7
     I              BEUVST                          WHUVST
     I              BEUWST                          WHUWST
     I              BEUXST                          WHUXST
     I              BEAATM                          WHAATM
     I              BEAYNA                          WHAYNA
     I              BEA0NA                          WHA0NA
     I              BEAXDT                          WHAXDT
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS                              6
      * KEY: Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Order Number
     I                                    P   3   60P1C4NB
     IP2PARM      DS
      * I :  Next Order Number
     I                                    P   1   40P2C5NB
     IP3PARM      DS
      * I :  Next Invoice Number
     I                                    P   1   40P3C3NB
     IP4PARM      DS
      * I :  Load ID USR
     I                                    P   1   40P4LOID
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C                     PARM           P1PARM           KEY: Order Head
     C           P2C5NB    PARM           WP0001  70       Next Order Numb
     C           P3C3NB    PARM           WP0002  70       Next Invoice Nu
     C           P4LOID    PARM           WP0003  70       Load ID USR
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * TF Crt Order Header   XF
      * Modifications and Comments
     C                     EXSR UASUBR                     Modifications a
      * TF Crt Order Header   RT - Order Header TRG  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * TF Crt Order Header   RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WAAIC3           Company Number
     C                     Z-ADDP1C4NB    WAC4NB           Order Number
      * Establish starting position
     C           KRSSA     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * *** Accounts Receivable ***
      * TF Crt A/R Header     RT - A/R Header  * 
     C                     EXSR SBRVGN
      * TF Crt A/R Detail - A/R Detail  * 
     C                     EXSR SDRVGN
      * TF Crt A/R Hdr Notes  RT - A/R Header Notes  * 
     C                     EXSR SFRVGN
      * ---- Won't find a match with Order.
      * CRT Order Header       CR - Order Header TRG  * 
     C                     EXSR SHCRRC
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * TF Crt A/R Header     RT - A/R Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBCONB           Invoice Number
     C                     KFLD           WBCEST           Invoice Suffix
      * Setup key
     C                     Z-ADDWAAIC3    WBAIC3           Company Number
     C                     Z-ADDWACONB    WBCONB           Invoice Number
     C                     MOVELWACEST    WBCEST           Invoice Suffix
      * Establish starting position
     C           KRSSB     CHAIN@BDCPF7              90    *
      * Data record not found
     C   90                MOVEL'USR0174' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CRT A/R Header         CR - A/R Header  * 
     C                     EXSR SCCRRC
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCRRC    BEGSR
      *================================================================
      * CRT A/R Header         CR - A/R Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  60       Job Time
     C                     MOVEL*BLANK    WN0002 10        User Id
     C                     MOVEL*BLANK    WN0003 10        Job Name
     C                     Z-ADD*ZERO     WN0004  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BDCPFG
     C                     Z-ADD960       WCAIC3           Company Number
     C                     Z-ADDP3C3NB    WCCONB           Invoice Number
     C                     MOVELWBCEST    WCCEST           Invoice Suffix
     C                     MOVELWBUHCD    WCUHCD           Adjustment Type
     C                     Z-ADDWBBSVA    WCBSVA           Transaction Amo
     C                     Z-ADDWBAIVA    WCAIVA           Adjustment Amou
     C                     Z-ADDWBAOVA    WCAOVA           Amount Paid
     C                     Z-ADDWBBGVA    WCBGVA           Remaining Balan
     C                     MOVELWBAJST    WCAJST           A/R Processing
     C                     MOVELWBE3ST    WCE3ST           Purge Status
     C                     MOVELWBG4CD    WCG4CD           Bank Code
     C                     Z-ADDWBCKNB    WCCKNB           G/L Document Nu
     C                     Z-ADDP2C5NB    WCCAC7           Order Number Re
     C                     Z-ADDWBBKC7    WCBKC7           Ship To Custome
     C                     MOVELWBBCCD    WCBCCD           Salesperson Cod
     C                     MOVELWBR4CD    WCR4CD           Sales Route Cod
     C                     Z-ADDWBB4DT    WCB4DT           Transaction Dat
     C                     Z-ADDWBATDT    WCATDT           Due Date
     C                     Z-ADDWBH0DT    WCH0DT           Last Payment Da
     C                     Z-ADDWBH3DT    WCH3DT           Original Inv fo
     C                     Z-ADDWBH4DT    WCH4DT           Paid in Full Da
     C                     Z-ADDWBH5DT    WCH5DT           Last G/L Post D
     C                     Z-ADDWBANC7    WCANC7           A/R Customer Nu
     C                     MOVELWBCPTX    WCCPTX           A/R Check Numbe
     C                     Z-ADDWBBSDY    WCBSDY           Days to Pay
     C                     MOVELWBUVST    WCUVST           EDI Status 1
     C                     MOVELWBUWST    WCUWST           EDI Status 2
     C                     MOVELWBUXST    WCUXST           EDI Status 3
      *
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WCAATM           Job Time
     C                     MOVEL##USR     WCAYNA           User Id
     C                     MOVEL##JOB     WCA0NA           Job Name
     C                     Z-ADD##JDT     WCAXDT           Job Date
     C           KLCRSC    KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCCONB           Invoice Number
     C                     KFLD           WCCEST           Invoice Suffix
      * Check for duplicate primary key
     C           KLCRSC    SETLL@BDCPFG                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0175' W0RTN   7
      * Send message 'A/R Header             EX'
     C                     MOVEL'USR0175' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C                     WRITE@BDCPFG                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * E6933 DN  08/12/16 - Create A/R Header Ext record.
      * Crt A/R Header Ext    XF - A/R Header Ext  * 
     C                     CALL 'PBX3XFR'              90  Crt A/R Header
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WCAIC3    WQ0001  30       Company Number
     C                     PARM WCCONB    WQ0002  70       Invoice Number
     C                     PARM WCCEST    WQ0003  2        Invoice Suffix
     C                     PARM WCBGVA    WQ0004 112       Remaining Balan
     C                     PARM WCCAC7    WQ0005  70       Order Number Re
     C                     PARM WCH3DT    WQ0006  70       Original Inv fo
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBX3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * TF Crt A/R Detail - A/R Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSD01           Company Number
     C           *LIKE     DEFN WDCONB    WQSD02           Invoice Number
     C           *LIKE     DEFN WDCEST    WQSD03           Invoice Suffix
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Invoice Number
     C                     KFLD           WQSD03           Invoice Suffix
      * Setup key
     C                     Z-ADDWAAIC3    WQSD01           Company Number
     C                     Z-ADDWACONB    WQSD02           Invoice Number
     C                     MOVELWACEST    WQSD03           Invoice Suffix
      * Establish starting position
     C           KRSSD     SETLL@BFCPFO                    *
     C           KRSSD     READE@BFCPFO                  90*
      * Data record not found
     C   90                MOVEL'USR0178' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CRT A/R Detail (Lckbx) CR - A/R Detail  * 
     C                     EXSR SECRRC
     C           KRSSD     READE@BFCPFO                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECRRC    BEGSR
      *================================================================
      * CRT A/R Detail (Lckbx) CR - A/R Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BFCPFN
     C                     Z-ADD960       WEAIC3           Company Number
     C                     Z-ADDP3C3NB    WECONB           Invoice Number
     C                     MOVELWDCEST    WECEST           Invoice Suffix
     C                     Z-ADDWDDXNB    WEDXNB           Sequence Number
     C                     MOVELWDUHCD    WEUHCD           Adjustment Type
     C                     Z-ADDWDBSVA    WEBSVA           Transaction Amo
     C                     MOVELWDCPTX    WECPTX           A/R Check Numbe
     C                     MOVELWDNGNA    WENGNA           Explanation
     C                     Z-ADDWDB4DT    WEB4DT           Transaction Dat
     C                     Z-ADDWDDVDT    WEDVDT           Payment/Deposit
     C                     Z-ADDWDYXNX    WEYXNX           Deposit Time
     C                     Z-ADDWDHYDT    WEHYDT           G/L Post Date
     C                     MOVELWDG4CD    WEG4CD           Bank Code
     C                     Z-ADDWDCKNB    WECKNB           G/L Document Nu
     C                     MOVELWDA5ST    WEA5ST           Cash/Adj
     C                     MOVELWDAJST    WEAJST           A/R Processing
     C                     MOVELWDB1VN    WEB1VN           Originating Pro
     C                     MOVELWDEAZT    WEEAZT           Effect on Accou
     C                     Z-ADDWDC1NY    WEC1NY           G/L Posting Com
     C                     MOVELWDIZTX    WEIZTX           G/L ID Code JDE
     C                     MOVELWDETSX    WEETSX           Post Adjustment
     C                     MOVELWDW3SX    WEW3SX           A/R TF Exempt C
     C                     MOVELWDW4SX    WEW4SX           A/R Dtl UnUsed
     C                     MOVELWDW5SX    WEW5SX           A/R Dtl UnUsed
     C                     MOVELWDW6SX    WEW6SX           A/R Dtl UnUsed
     C                     MOVELWDW7SX    WEW7SX           A/R Dtl UnUsed
     C                     MOVELWDW8SX    WEW8SX           A/R Dtl UnUsed
     C                     Z-ADDWDQHDT    WEQHDT           TFS Adj Week-En
     C                     Z-ADDWDQIDT    WEQIDT           A/R Orig Inv fo
     C                     Z-ADDWDQJDT    WEQJDT           A/R Dtl UnUsed
     C                     Z-ADDWDQKDT    WEQKDT           A/R Dtl UnUsed
     C                     Z-ADDWDQLDT    WEQLDT           A/R Dtl UnUsed
     C                     Z-ADDWDGLVL    WEGLVL           G/L Sub-Ledger
     C                     Z-ADDWDGMVL    WEGMVL           A/R Dtl UnUsed
     C                     Z-ADDWDGNVL    WEGNVL           A/R Dtl UnUsed
     C                     Z-ADDWDGOVL    WEGOVL           A/R Dtl UnUsed
     C                     Z-ADDWDGPVL    WEGPVL           A/R Dtl UnUsed
     C                     MOVELWDUVST    WEUVST           EDI Status 1
     C                     MOVELWDUWST    WEUWST           EDI Status 2
     C                     MOVELWDUXST    WEUXST           EDI Status 3
     C                     Z-ADDWDAATM    WEAATM           Job Time
     C                     MOVELWDAYNA    WEAYNA           User Id
     C                     MOVELWDA0NA    WEA0NA           Job Name
     C                     Z-ADDWDAXDT    WEAXDT           Job Date
      *
     C           KLCRSE    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WECONB           Invoice Number
     C                     KFLD           WECEST           Invoice Suffix
     C                     KFLD           WEDXNB           Sequence Number
      * Check for duplicate primary key
     C           KLCRSE    SETLL@BFCPFN                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0179' W0RTN   7
      * Send message 'A/R Detail             EX'
     C                     MOVEL'USR0179' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C                     WRITE@BFCPFN                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * TF Crt A/R Hdr Notes  RT - A/R Header Notes  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSF01           Company Number
     C           *LIKE     DEFN WFCONB    WQSF02           Invoice Number
     C           *LIKE     DEFN WFCEST    WQSF03           Invoice Suffix
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Invoice Number
     C                     KFLD           WQSF03           Invoice Suffix
      * Setup key
     C                     Z-ADDWAAIC3    WQSF01           Company Number
     C                     Z-ADDWACONB    WQSF02           Invoice Number
     C                     MOVELWACEST    WQSF03           Invoice Suffix
      * Establish starting position
     C           KRSSF     SETLL@BURELN                    *
     C           KRSSF     READE@BURELN                  90*
      * Data record not found
     C   90                MOVEL'USR3122' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Crt A/R Header Notes  CR - A/R Header Notes  * 
     C                     EXSR SGCRRC
     C           KRSSF     READE@BURELN                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCRRC    BEGSR
      *================================================================
      * Crt A/R Header Notes  CR - A/R Header Notes  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BURELM
     C                     Z-ADD960       WGAIC3           Company Number
     C                     Z-ADDP3C3NB    WGCONB           Invoice Number
     C                     MOVELWFCEST    WGCEST           Invoice Suffix
     C                     Z-ADDWFOTDT    WGOTDT           Note Date
     C                     Z-ADDWFDXNB    WGDXNB           Sequence Number
     C                     MOVELWFL5SX    WGL5SX           Note Type
     C                     Z-ADDWFOUDT    WGOUDT           Follow-up Date
     C                     MOVELWFA3T1    WGA3T1           Initials
     C                     MOVELWFA4T1    WGA4T1           Note Line 1
     C                     MOVELWFA5T1    WGA5T1           Note Line 2
     C                     MOVELWFL6SX    WGL6SX           Remaining Balan
     C                     MOVELWFL7SX    WGL7SX           Notes Unused St
     C                     MOVELWFL8SX    WGL8SX           Notes Unused St
     C                     Z-ADDWFBKC7    WGBKC7           Ship To Custome
      *
      * USER: Processing before Data update
      * CASE: PAR.USR Date - ATR is Entered
     C           0         IFNE 0                          *IF
     C                     Z-ADD0         WGOTDT           Note Date
     C                     END                             *FI
      * CASE: PAR.USR Sequence Num. New ATR is not equal to zero
     C           0         IFNE 0                          *IF
     C                     Z-ADD0         WGDXNB           Sequence Number
     C                     END                             *FI
     C           KLCRSG    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGCONB           Invoice Number
     C                     KFLD           WGCEST           Invoice Suffix
     C                     KFLD           WGOTDT           Note Date
     C                     KFLD           WGDXNB           Sequence Number
      * Check for duplicate primary key
     C           KLCRSG    SETLL@BURELM                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3123' W0RTN   7
      * Send message 'A/R Header Notes OLD   EX'
     C                     MOVEL'USR3123' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C                     WRITE@BURELM                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCRRC    BEGSR
      *================================================================
      * CRT Order Header       CR - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0005  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0006 12        Accounts Receiv
     C                     MOVEL*BLANK    WN0007  1        EDI Status 1
     C                     MOVEL*BLANK    WN0008  1        EDI Status 2
     C                     MOVEL*BLANK    WN0009  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0010  60       Job Time
     C                     MOVEL*BLANK    WN0011 10        User Id
     C                     MOVEL*BLANK    WN0012 10        Job Name
     C                     Z-ADD*ZERO     WN0013  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BECPFJ
     C                     Z-ADD960       WHAIC3           Company Number
     C                     Z-ADDP2C5NB    WHC4NB           Order Number
     C                     MOVELWAJNCD    WHJNCD           Order Type - Sa
     C                     Z-ADDWAANC7    WHANC7           A/R Customer Nu
     C                     Z-ADDWABKC7    WHBKC7           Ship To Custome
     C                     MOVELWABRTX    WHBRTX           Ship To Name
     C                     MOVELWAHMNA    WHHMNA           Ship To Address
     C                     MOVELWAHONA    WHHONA           Ship To Address
     C                     MOVELWAHPNA    WHHPNA           Ship To Address
     C                     MOVELWAHNNA    WHHNNA           Ship To City
     C                     MOVELWADBCD    WHDBCD           Ship To State C
     C                     MOVELWACKTX    WHCKTX           Ship To Zip/Pos
     C                     Z-ADDWAB0C7    WHB0C7           Bill to Custome
     C                     MOVELWAAETX    WHAETX           Bill to Name
     C                     MOVELWAB1NA    WHB1NA           Bill to Address
     C                     MOVELWAB3NA    WHB3NA           Bill to Address
     C                     MOVELWAB4NA    WHB4NA           Bill to Address
     C                     MOVELWAB2NA    WHB2NA           Bill to City
     C                     MOVELWABHCD    WHBHCD           Bill to State C
     C                     MOVELWAC8TX    WHC8TX           Bill to Zip/Pos
     C                     MOVELWABCNA    WHBCNA           Customer Purcha
     C                     Z-ADDWAA0DT    WHA0DT           Order Date
     C                     Z-ADDWAA5DT    WHA5DT           Requested Ship
     C                     Z-ADDWAGNDT    WHGNDT           Actual Shipped
     C                     Z-ADDWAACDT    WHACDT           Cancel Date
     C                     MOVELWAAQCD    WHAQCD           Terms Code
     C                     MOVELWAB6NA    WHB6NA           Special Instruc
     C                     MOVELWABYNA    WHBYNA           Special Instruc
     C                     MOVELWABZNA    WHBZNA           Carrier Code
     C                     MOVELWAGTST    WHGTST           Comment Print A
     C                     MOVELWAGVST    WHGVST           Comment Print I
     C                     MOVELWAGUST    WHGUST           Comment Print P
     C                     MOVELWAQFST    WHQFST           Comment Print S
     C                     MOVELWACQCD    WHCQCD           Reason Code
     C                     MOVELWAGJST    WHGJST           Order in Use
     C                     MOVELWAGWST    WHGWST           Header Status
     C                     MOVELWAGXST    WHGXST           Header Status L
     C                     MOVELWAGYST    WHGYST           Order Type Prin
     C                     Z-ADDWAAODT    WHAODT           Scheduled Ship
     C                     MOVELWAAIVN    WHAIVN           User Original E
     C                     Z-ADDWACXDT    WHCXDT           Date of Origina
     C                     Z-ADDWAJZVA    WHJZVA           Order Value Tot
     C                     Z-ADDWAA1WG    WHA1WG           Order Weight To
     C                     MOVELWAXIST    WHXIST           Credit Hold
     C                     MOVELWAXJST    WHXJST           Production Hold
     C                     MOVELWAXKST    WHXKST           New Customer Ho
     C                     Z-ADDWAEIDT    WHEIDT           Requested Deliv
     C                     Z-ADDWAAFTM    WHAFTM           Requested Deliv
     C                     Z-ADDP4LOID    WHRMNB           Load ID
     C                     Z-ADDWATBNB    WHTBNB           Absorbed Freigh
     C                     Z-ADDWAR1NB    WHR1NB           Rated Freight
     C                     MOVELWAPJST    WHPJST           LTL Flag
     C                     MOVELWAU0ST    WHU0ST           Price Audit
     C                     MOVELWAU1ST    WHU1ST           Price Status
     C                     MOVELWAQ2CD    WHQ2CD           Shipping Method
     C                     MOVELWAU2ST    WHU2ST           Export Status
     C                     MOVELWAVEST    WHVEST           Palletize
     C                     MOVELWAVFST    WHVFST           Shrink Wrap
     C                     MOVELWAVGST    WHVGST           Slip Sheet
     C                     MOVELWARPCD    WHRPCD           Age Code
     C                     Z-ADDWARNNB    WHRNNB           Reefer Temperat
     C                     MOVELWAVDST    WHVDST           Load Type
     C                     Z-ADDWAATIN    WHATIN           Attach to Invoi
     C                     MOVELWAU4ST    WHU4ST           Load Plan Order
     C                     MOVELWAU5ST    WHU5ST           Print Pick Slip
     C                     Z-ADDWARSRN    WHRSRN           Resell Referenc
     C                     MOVELWAMHNA    WHMHNA           Special Comment
     C                     MOVELWAMINA    WHMINA           Special Comment
     C                     MOVELWAWBST    WHWBST           Affect Auto Acc
     C                     MOVELWAR4CD    WHR4CD           Sales Route Cod
     C                     MOVELWABFCD    WHBFCD           Manager Level C
     C                     MOVELWAQ4CD    WHQ4CD           VP Level Code
     C                     Z-ADDWAT3NB    WHT3NB           Attach to Order
     C                     MOVELWASICD    WHSICD           Reason for Pric
     C                     Z-ADDP3C3NB    WHCONB           Invoice Number
     C                     MOVELWACEST    WHCEST           Invoice Suffix
     C                     Z-ADDWAAWDT    WHAWDT           Invoice Date
     C                     MOVELWAJPCD    WHJPCD           Event Code
     C                     MOVELWAXUST    WHXUST           Trans Contol AS
     C                     MOVELWAZ1ST    WHZ1ST           Modified Flag
     C                     Z-ADDWAVRVA    WHVRVA           A/R order Value
     C                     MOVELWAOBST    WHOBST           Billing Activit
     C                     MOVELWABCST    WHBCST           Block Order Fla
     C                     MOVELWABDST    WHBDST           Order Certifica
     C                     Z-ADDWAB7VL    WHB7VL           Invoice Order V
     C                     MOVELWAGASX    WHGASX           Process Sts for
     C                     MOVELWAGBSX    WHGBSX           Order Conf Fax
     C                     MOVELWAGCSX    WHGCSX           Manifest Fax St
     C                     MOVELWAGDSX    WHGDSX           Invoice Fax Sts
     C                     MOVELWAFNSX    WHFNSX           Transfer in Sto
     C                     MOVELWAFOSX    WHFOSX           Email Cust On O
     C                     MOVELWAFPSX    WHFPSX           Order Emailed
     C                     MOVELWAFQSX    WHFQSX           Export Docs Go
     C                     MOVELWAFRSX    WHFRSX           Shipping Temp C
     C                     MOVELWAFSSX    WHFSSX           Broker Order St
     C                     MOVELWAFTSX    WHFTSX           Air Freight Ord
     C                     MOVELWAFUSX    WHFUSX           Order Requires
     C                     MOVELWAFVSX    WHFVSX           OH Load Plan Re
     C                     MOVELWAFWSX    WHFWSX           Export USDA App
     C                     MOVELWAFXSX    WHFXSX           HPB Ship to War
     C                     MOVELWAFYSX    WHFYSX           OH TF Exempt Co
     C                     Z-ADDWANODT    WHNODT           OH Appt Confirm
     C                     Z-ADDWANPDT    WHNPDT           JPN Invoice Iss
     C                     Z-ADDWANQDT    WHNQDT           Load Actual Shi
     C                     Z-ADDWANRDT    WHNRDT           Load BOL Comple
     C                     Z-ADDWANSDT    WHNSDT           Load Truck Depa
     C                     Z-ADDWABPTM    WHBPTM           Maximum Gross W
     C                     Z-ADDWABQTM    WHBQTM           Time of Origina
     C                     Z-ADDWABRTM    WHBRTM           OH Appt Confirm
     C                     Z-ADDWABSTM    WHBSTM           Load BOL Comple
     C                     Z-ADDWABTTM    WHBTTM           Load Truck Depa
     C                     Z-ADDWAH0NX    WHH0NX           Act Frt Referen
     C                     Z-ADDWAH1NX    WHH1NX           Act Non-Ref Frt
     C                     Z-ADDWAH2NX    WHH2NX           OH Fuel Surchar
     C                     Z-ADDWAH3NX    WHH3NX           OH Total Non-Re
     C                     Z-ADDWAH4NX    WHH4NX           OH Total Ref Fr
     C                     Z-ADDWAC0C7    WHC0C7           Claim Number
      *
      * USER: Processing before Data update
     C                     MOVEL*BLANK    WHRPCD           Age Code
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##JOB     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           WHCXDT    PARM *ZERO     WQ0007 155       Current System
     C           WHBQTM    PARM *ZERO     WQ0008 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C           KLCRSH    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHC4NB           Order Number
      * Check for duplicate primary key
     C           KLCRSH    SETLL@BECPFJ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0177' W0RTN   7
      * USER: Processing if Data record already exists
      * ** Set flag so it can be tested on the return    T075 03/28/2006
     C                     MOVEL'Y2U0003' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C                     WRITE@BECPFJ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * E6933 DN  08/12/16 - Create A/R Header Ext record.
      * - Modified CRT A/R Header         CO - A/R Header.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WAA0DT           Order Date
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WAACDT           Cancel Date
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WAJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WAA1WG           Order Weight To
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WATBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WAATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WARSRN           Resell Referenc
     C                     Z-ADD*ZERO     WAT3NB           Attach to Order
     C                     Z-ADD*ZERO     WACONB           Invoice Number
     C                     Z-ADD*ZERO     WAAWDT           Invoice Date
     C                     Z-ADD*ZERO     WAVRVA           A/R order Value
     C                     Z-ADD*ZERO     WAB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WANODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WANPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WANQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WANRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WANSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WABPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WABQTM           Time of Origina
     C                     Z-ADD*ZERO     WABRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WABSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WABTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WAH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WAH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WAH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WAH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WAH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WAC0C7           Claim Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBCONB           Invoice Number
     C                     Z-ADD*ZERO     WBBSVA           Transaction Amo
     C                     Z-ADD*ZERO     WBAIVA           Adjustment Amou
     C                     Z-ADD*ZERO     WBAOVA           Amount Paid
     C                     Z-ADD*ZERO     WBBGVA           Remaining Balan
     C                     Z-ADD*ZERO     WBCKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WBCAC7           Order Number Re
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBB4DT           Transaction Dat
     C                     Z-ADD*ZERO     WBATDT           Due Date
     C                     Z-ADD*ZERO     WBH0DT           Last Payment Da
     C                     Z-ADD*ZERO     WBH3DT           Original Inv fo
     C                     Z-ADD*ZERO     WBH4DT           Paid in Full Da
     C                     Z-ADD*ZERO     WBH5DT           Last G/L Post D
     C                     Z-ADD*ZERO     WBANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WBBSDY           Days to Pay
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Clear all neither parameters
      * CRT A/R Header         CR - A/R Header  * 
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDCONB           Invoice Number
     C                     Z-ADD*ZERO     WDDXNB           Sequence Number
     C                     Z-ADD*ZERO     WDBSVA           Transaction Amo
     C                     Z-ADD*ZERO     WDB4DT           Transaction Dat
     C                     Z-ADD*ZERO     WDDVDT           Payment/Deposit
     C                     Z-ADD*ZERO     WDYXNX           Deposit Time
     C                     Z-ADD*ZERO     WDHYDT           G/L Post Date
     C                     Z-ADD*ZERO     WDCKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WDC1NY           G/L Posting Com
     C                     Z-ADD*ZERO     WDQHDT           TFS Adj Week-En
     C                     Z-ADD*ZERO     WDQIDT           A/R Orig Inv fo
     C                     Z-ADD*ZERO     WDQJDT           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WDQKDT           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WDQLDT           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WDGLVL           G/L Sub-Ledger
     C                     Z-ADD*ZERO     WDGMVL           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WDGNVL           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WDGOVL           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WDGPVL           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFCONB           Invoice Number
     C                     Z-ADD*ZERO     WFOTDT           Note Date
     C                     Z-ADD*ZERO     WFDXNB           Sequence Number
     C                     Z-ADD*ZERO     WFOUDT           Follow-up Date
     C                     Z-ADD*ZERO     WFBKC7           Ship To Custome
      * Clear all neither parameters
      * CRT Order Header       CR - Order Header TRG  * 
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
