/********************************************************************/
/*                                                                  */
/*  SYNOPSIS - CL PROGRAM FOR CALCULATING STANDARD DEVIATION        */
/*                                                                  */
/*  SYSTEM    - HOG PROCUREMENT AND EVALUATION                      */
/*  DATE      - 02/25/02                                            */
/*  DEVELOPER - PURVA DROGE                                         */
/*                                                                  */
/********************************************************************/
/* MODIFICATIONS:                                                   */
/********************************************************************/
             PGM        PARM(&LEVEL &COMP &DATE &KSHFT &SOURCE &SDEV)

/* PARAMETERS */
             DCL        VAR(&TYPE) TYPE(*CHAR) LEN(1)
             DCL        VAR(&COMP) TYPE(*DEC) LEN(3 0)
             DCL        VAR(&DATE) TYPE(*DEC) LEN(7 0)
             DCL        VAR(&KSHFT) TYPE(*CHAR) LEN(1)
             DCL        VAR(&SOURCE) TYPE(*CHAR) LEN(1)
             DCL        VAR(&SDEV) TYPE(*DEC) LEN(9 5)
             DCL        VAR(&LEVEL) TYPE(*CHAR) LEN(1)

/* WORK FIELDS */
             DCL        VAR(&COX) TYPE(*CHAR) LEN(3)
             DCL        VAR(&DATEX) TYPE(*CHAR) LEN(7)

             DCLF       FILE(HWSDEVA)

/********************************************************************/
/* INITIALIZE                                                       */
/********************************************************************/
/* CONVERT DATES */
             CHGVAR     VAR(&COX) VALUE(&COMP)
             CHGVAR     VAR(&DATEX) VALUE(&DATE)

/********************************************************************/
/* CREATE RECORDS FOR SOURCE TYPE                                   */
/****************************************************** *************/
/* CO/KDATE/SHIFT/SOURCE */
             IF         COND(&LEVEL *EQ 'A') THEN(DO)
             EXECUTE    VIEW(HWSDEVA) OUTFILE(QTEMP/HWSDEVA) +
                          SETVAR((&CO &COX) (&KDATE &DATEX) (&SHIFT +
                          &KSHFT) (&SRCTYP &SOURCE))
             ENDDO

/* CO/KDATE/SHIFT        */
             IF         COND(&LEVEL *EQ 'B') THEN(DO)
             EXECUTE    VIEW(HWSDEVB) OUTFILE(QTEMP/HWSDEVA) +
                          SETVAR((&CO &COX) (&KDATE &DATEX) (&SHIFT +
                          &KSHFT))
             ENDDO

/* CO/KDATE              */
             IF         COND(&LEVEL *EQ 'C') THEN(DO)
             EXECUTE    VIEW(HWSDEVC) OUTFILE(QTEMP/HWSDEVA) +
                          SETVAR((&CO &COX) (&KDATE &DATEX))
             ENDDO

/* CO/KDATE/SOURCE       */
             IF         COND(&LEVEL *EQ 'D') THEN(DO)
             EXECUTE    VIEW(HWSDEVD) OUTFILE(QTEMP/HWSDEVA) +
                          SETVAR((&CO &COX) (&KDATE &DATEX) +
                          (&SRCTYP &SOURCE))
             ENDDO

/* READ OUTFILE          */
             OVRDBF     FILE(HWSDEVA) TOFILE(QTEMP/HWSDEVA)
             RCVF
             MONMSG     MSGID(CPF0864) EXEC(GOTO CMDLBL(ENDPGM))

             CHGVAR     VAR(&SDEV) VALUE(&SDEVHWGT)

/********************************************************************/
/* END OF PROGRAM                                                   */
/********************************************************************/
 ENDPGM:
             ENDPGM
