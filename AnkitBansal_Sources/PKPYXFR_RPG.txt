     H/TITLE Prc Crt CDtl/Prc Flg  XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 12/17/20  Time  : 00:44:39
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKA1CPM3IF  E           K        DISK
      * RSQ : Tattoo Header             CO/Kill/Bol/Ttto Unpaid
      *
     FPKA8REL1IF  E           K        DISK
      * RTV : Hog Classification        Retrieval index
      *
     FPKBVCPL7IF  E           K        DISK
      * RSQ : Evl By Ttto/E/B Dec Hot W
      *
     FPKB1CPL1IF  E           K        DISK
      * RTV : Carcass Detail            Retrieval index
      *
     FPKEKCPL1IF  E           K        DISK
      * RTV : Trim Button               Retrieval index
      *
     FPKBSCPL4IF  E           K        DISK
      * RSQ : Loss Trans                RTV Next#
      *
     FPKA1CPL0IF  E           K        DISK
      * RTV : Tattoo Header             Retrieval index
      *
     FPKDCCPL1IF  E           K        DISK
      * RTV : Company Kill Recap        Retrieval index
      *
     FPKC7REL2IF  E           K        DISK
      * RTV : Company Expense           Active Only
      *
     FPKB1CPL0IF  E           K        DISK                      A
      * UPD : Carcass Detail            Update index
      *
     FPKBSCPL0IF  E           K        DISK                      A
      * UPD : Loss Trans                Update index
      *
     FPKA1CPL1UF  E           K        DISK
      * UPD : Tattoo Header             Update index
      *
     FPKDCCPL0UF  E           K        DISK                      A
      * UPD : Company Kill Recap        Update index
      *
     FPKDDCPL0IF  E           K        DISK                      A
      * UPD : Company Kill Expense Rate Update index
      *
      * Long constants
     E                    @CN#    1  04  6   @CN    25
     I@A1CPTB
      * Tattoo Header             CO/Kill/Bol/Ttto Unpaid
      * Renamed input format fields
     I              A1HMNB                          WAHMNB
     I              A1BNNB                          WABNNB
     I              A1BONB                          WABONB
     I              A1CVNB                          WACVNB
     I              A1B0DT                          WAB0DT
     I              A1AWDT                          WAAWDT
     I              A1BICD                          WABICD
     I              A1CPST                          WACPST
     I              A1ACPR                          WAACPR
     I              A1B9PR                          WAB9PR
     I              A1CAPR                          WACAPR
     I              A1C4ST                          WAC4ST
     I              A1AIPR                          WAAIPR
     I              A1A6DT                          WAA6DT
     I              A1C2ST                          WAC2ST
     I              A1CXNB                          WACXNB
     I              A1CWNB                          WACWNB
     I              A1FCNB                          WAFCNB
     I              A1H9NB                          WAH9NB
     I              A1FDNB                          WAFDNB
     I              A1FENB                          WAFENB
     I              A1HENB                          WAHENB
     I              A1HFNB                          WAHFNB
     I              A1CYNB                          WACYNB
     I              A1LRNB                          WALRNB
     I              A1E0NB                          WAE0NB
     I              A1A5PC                          WAA5PC
     I              A1FBNB                          WAFBNB
     I              A1A4PC                          WAA4PC
     I              A1F7NB                          WAF7NB
     I              A1HDNB                          WAHDNB
     I              A1F5NB                          WAF5NB
     I              A1F4NB                          WAF4NB
     I              A1F3NB                          WAF3NB
     I              A1F2NB                          WAF2NB
     I              A1AVPC                          WAAVPC
     I              A1AWPC                          WAAWPC
     I              A1CWPC                          WACWPC
     I              A1A8PC                          WAA8PC
     I              A1A7PC                          WAA7PC
     I              A1B8PR                          WAB8PR
     I              A1AMPR                          WAAMPR
     I              A1ANPR                          WAANPR
     I              A1AYVA                          WAAYVA
     I              A1AWVA                          WAAWVA
     I              A1AOPR                          WAAOPR
     I              A1AXVA                          WAAXVA
     I              A1APPR                          WAAPPR
     I              A1ASPR                          WAASPR
     I              A1A4VA                          WAA4VA
     I              A1ATPR                          WAATPR
     I              A1A5VA                          WAA5VA
     I              A1CBPR                          WACBPR
     I              A1CCPR                          WACCPR
     I              A1LPNB                          WALPNB
     I              A1CDPR                          WACDPR
     I              A1A7VA                          WAA7VA
     I              A1A2PR                          WAA2PR
     I              A1JWST                          WAJWST
     I              A1CWST                          WACWST
     I              A1D7ST                          WAD7ST
     I              A1D8ST                          WAD8ST
     I              A1DWST                          WADWST
     I              A1D6ST                          WAD6ST
     I              A1GHNB                          WAGHNB
     I              A1BYDT                          WABYDT
     I              A1E0ST                          WAE0ST
     I              A1E1ST                          WAE1ST
     I              A1E2ST                          WAE2ST
     I              A1BSDT                          WABSDT
     I              A1BTDT                          WABTDT
     I              A1BUDT                          WABUDT
     I              A1HGNB                          WAHGNB
     I              A1HHNB                          WAHHNB
     I              A1HINB                          WAHINB
     I              A1A3PR                          WAA3PR
     I              A1A4PR                          WAA4PR
     I              A1A6PR                          WAA6PR
     I              A1J9NB                          WAJ9NB
     I              A1D6PR                          WAD6PR
     I              A1D7PR                          WAD7PR
     I              A1D8PR                          WAD8PR
     I              A1D9PR                          WAD9PR
     I              A1EAPR                          WAEAPR
     I              A1EBPR                          WAEBPR
     I              A1ECPR                          WAECPR
     I              A1EDPR                          WAEDPR
     I              A1EEPR                          WAEEPR
     I              A1EFPR                          WAEFPR
     I              A1EGPR                          WAEGPR
     I              A1EHPR                          WAEHPR
     I              A1KAST                          WAKAST
     I              A1J7ST                          WAJ7ST
     I              A1J9ST                          WAJ9ST
     I              A1OXNB                          WAOXNB
     I              A1LKST                          WALKST
     I              A1LLST                          WALLST
     I              A1J8ST                          WAJ8ST
     I              A1LIST                          WALIST
     I              A1LJST                          WALJST
     I              A1NZTX                          WANZTX
     I              A1HJCD                          WAHJCD
     I              A1R4ST                          WAR4ST
     I              A1R5ST                          WAR5ST
     I              A1R6ST                          WAR6ST
     I              A1R7ST                          WAR7ST
     I              A1THWT                          WATHWT
     I              A1T2WT                          WAT2WT
     I              A1THHD                          WATHHD
     I              A1T2HD                          WAT2HD
     I              A1OBPR                          WAOBPR
     I              A1KOER                          WAKOER
     I              A1OPIR                          WAOPIR
     I              A1OPEM                          WAOPEM
     I              A1IORP                          WAIORP
     I              A1OWEO                          WAOWEO
     I              A1OQET                          WAOQET
     I              A1URST                          WAURST
     I              A1USST                          WAUSST
     I              A1HHPC                          WAHHPC
     I              A1S9PR                          WAS9PR
     I              A1TAPR                          WATAPR
     I              A1TBPR                          WATBPR
     I              A1JFUR                          WAJFUR
     I              A1KRIF                          WAKRIF
     I              A1KORF                          WAKORF
     I              A1KAPR                          WAKAPR
     I              A1KROT                          WAKROT
     I              A1OTJG                          WAOTJG
     I              A1IRJG                          WAIRJG
     I              A1IMJF                          WAIMJF
     I              A1IRGF                          WAIRGF
     I              A1KRJF                          WAKRJF
     I              A1OJRF                          WAOJRF
     I              A1KFOR                          WAKFOR
     I              A1ORJK                          WAORJK
     I              A1OMVJ                          WAOMVJ
     I              A1MVNF                          WAMVNF
     I              A1MCNF                          WAMCNF
     I              A1NCNF                          WANCNF
     I              A1NCHF                          WANCHF
     I              A1IGIR                          WAIGIR
     I              A1KFJR                          WAKFJR
     I              A1EADT                          WAEADT
     I              A1EBDT                          WAEBDT
     I              A1ECDT                          WAECDT
     I              A1EDDT                          WAEDDT
     I              A1EEDT                          WAEEDT
     I              A1U4ST                          WAU4ST
     I              A1U5ST                          WAU5ST
     I              A1U6ST                          WAU6ST
     I              A1U7ST                          WAU7ST
     I              A1U8ST                          WAU8ST
     I              A1U9ST                          WAU9ST
     I              A1VAST                          WAVAST
     I              A1VBST                          WAVBST
     I              A1BDCD                          WABDCD
     I              A1CSCD                          WACSCD
     I              A1ABCD                          WAABCD
     I              A1AECD                          WAAECD
     I              A1ACCD                          WAACCD
     I              A1AGCD                          WAAGCD
     I              A1BECD                          WABECD
     I              A1AAVN                          WAAAVN
     I              A1AADT                          WAAADT
     I              A1AMTM                          WAAMTM
     I              A1AJST                          WAAJST
     I              A1AHVN                          WAAHVN
     I              A1AGVN                          WAAGVN
     I              A1ABVN                          WAABVN
     I              A1ABDT                          WAABDT
     I              A1ABTM                          WAABTM
      *
     I@A8REDA
      * Hog Classification        Retrieval index
      * Renamed input format fields
     I              A8BECD                          WBBECD
     I              A8BDTX                          WBBDTX
     I              A8BXST                          WBBXST
     I              A8BYST                          WBBYST
     I              A8BITX                          WBBITX
     I              A8B0ST                          WBB0ST
     I              A8FBST                          WBFBST
     I              A8AAVN                          WBAAVN
     I              A8AADT                          WBAADT
     I              A8AMTM                          WBAMTM
     I              A8AJST                          WBAJST
     I              A8AHVN                          WBAHVN
     I              A8AGVN                          WBAGVN
     I              A8ABVN                          WBABVN
     I              A8ABDT                          WBABDT
     I              A8ABTM                          WBABTM
      *
     I@BVCPL7
      * Evl By Ttto/E/B Dec Hot W
      * Renamed input format fields
     I              BVHSNB                          WCHSNB
     I              BVA9DT                          WCA9DT
     I              BVFJNB                          WCFJNB
     I              BVHCNB                          WCHCNB
     I              BVGDNB                          WCGDNB
     I              BVFINB                          WCFINB
     I              BVLKNB                          WCLKNB
     I              BVEAST                          WCEAST
     I              BVAMPC                          WCAMPC
     I              BVAIPC                          WCAIPC
     I              BVAJPC                          WCAJPC
     I              BVAKPC                          WCAKPC
     I              BVX8NB                          WCX8NB
     I              BVFVPC                          WCFVPC
     I              BVFWPC                          WCFWPC
     I              BVFXPC                          WCFXPC
     I              BVALPC                          WCALPC
     I              BVDIST                          WCDIST
     I              BVFYST                          WCFYST
     I              BVD2ST                          WCD2ST
     I              BVEHST                          WCEHST
     I              BVG1ST                          WCG1ST
     I              BVH4ST                          WCH4ST
     I              BVJLST                          WCJLST
     I              BVUUST                          WCUUST
     I              BVVHST                          WCVHST
     I              BVVIST                          WCVIST
     I              BVVJST                          WCVJST
     I              BVVKST                          WCVKST
     I              BVVLST                          WCVLST
     I              BVHMNB                          WCHMNB
     I              BVBNNB                          WCBNNB
     I              BVBONB                          WCBONB
     I              BVCVNB                          WCCVNB
     I              BVB0DT                          WCB0DT
     I              BVAAVN                          WCAAVN
     I              BVAADT                          WCAADT
     I              BVAMTM                          WCAMTM
     I              BVAJST                          WCAJST
     I              BVAHVN                          WCAHVN
     I              BVAGVN                          WCAGVN
     I              BVABVN                          WCABVN
     I              BVABDT                          WCABDT
     I              BVABTM                          WCABTM
     I              BVB8DT                          WCB8DT
     I              BVAOTM                          WCAOTM
      *
     I@B1CPG7
      * Carcass Detail            Retrieval index
      * Renamed input format fields
     I              B1HMNB                          WDHMNB
     I              B1BNNB                          WDBNNB
     I              B1BONB                          WDBONB
     I              B1CVNB                          WDCVNB
     I              B1B0DT                          WDB0DT
     I              B1LGNB                          WDLGNB
     I              B1EUNB                          WDEUNB
     I              B1LHNB                          WDLHNB
     I              B1INST                          WDINST
     I              B1BEPR                          WDBEPR
     I              B1ASPC                          WDASPC
     I              B1EWNB                          WDEWNB
     I              B1B4PR                          WDB4PR
     I              B1EYNB                          WDEYNB
     I              B1B1PR                          WDB1PR
     I              B1AVPR                          WDAVPR
     I              B1AUPC                          WDAUPC
     I              B1AWPR                          WDAWPR
     I              B1AXPR                          WDAXPR
     I              B1EZNB                          WDEZNB
     I              B1AYPR                          WDAYPR
     I              B1BBDT                          WDBBDT
     I              B1AKTM                          WDAKTM
     I              B1IQST                          WDIQST
     I              B1EFST                          WDEFST
     I              B1H6NB                          WDH6NB
     I              B1BEPC                          WDBEPC
     I              B1GCST                          WDGCST
     I              B1GDST                          WDGDST
     I              B1GEST                          WDGEST
     I              B1BHPC                          WDBHPC
     I              B1IOST                          WDIOST
     I              B1IPST                          WDIPST
     I              B1LTNB                          WDLTNB
     I              B1JNST                          WDJNST
     I              B1X4NB                          WDX4NB
     I              B1FNPC                          WDFNPC
     I              B1FOPC                          WDFOPC
     I              B1FPPC                          WDFPPC
     I              B1K2ST                          WDK2ST
     I              B1K3ST                          WDK3ST
     I              B1JWPR                          WDJWPR
     I              B1F5PC                          WDF5PC
     I              B1JXPR                          WDJXPR
     I              B1JYPR                          WDJYPR
     I              B1JZPR                          WDJZPR
     I              B1J0PR                          WDJ0PR
     I              B1J1PR                          WDJ1PR
     I              B1J2PR                          WDJ2PR
     I              B1J3PR                          WDJ3PR
     I              B1J4PR                          WDJ4PR
     I              B1UTST                          WDUTST
     I              B1HVCD                          WDHVCD
     I              B1DKJR                          WDDKJR
     I              B1ITJF                          WDITJF
     I              B1IJGR                          WDIJGR
     I              B1ORJE                          WDORJE
     I              B1OTJR                          WDOTJR
     I              B1PEIR                          WDPEIR
     I              B1IEUF                          WDIEUF
     I              B1ORUE                          WDORUE
     I              B1IUTR                          WDIUTR
     I              B1IJRR                          WDIJRR
     I              B1VCST                          WDVCST
     I              B1VDST                          WDVDST
     I              B1VEST                          WDVEST
     I              B1VFST                          WDVFST
     I              B1VGST                          WDVGST
     I              B1ABCD                          WDABCD
     I              B1AACD                          WDAACD
     I              B1AAVN                          WDAAVN
     I              B1AADT                          WDAADT
     I              B1AMTM                          WDAMTM
     I              B1AJST                          WDAJST
     I              B1AHVN                          WDAHVN
     I              B1AGVN                          WDAGVN
     I              B1ABVN                          WDABVN
     I              B1ABDT                          WDABDT
     I              B1ABTM                          WDABTM
      *
     I@B1CPG6
      * Carcass Detail            Update index
      * Renamed input format fields
     I              B1HMNB                          WEHMNB
     I              B1BNNB                          WEBNNB
     I              B1BONB                          WEBONB
     I              B1CVNB                          WECVNB
     I              B1B0DT                          WEB0DT
     I              B1LGNB                          WELGNB
     I              B1EUNB                          WEEUNB
     I              B1LHNB                          WELHNB
     I              B1INST                          WEINST
     I              B1BEPR                          WEBEPR
     I              B1ASPC                          WEASPC
     I              B1EWNB                          WEEWNB
     I              B1B4PR                          WEB4PR
     I              B1EYNB                          WEEYNB
     I              B1B1PR                          WEB1PR
     I              B1AVPR                          WEAVPR
     I              B1AUPC                          WEAUPC
     I              B1AWPR                          WEAWPR
     I              B1AXPR                          WEAXPR
     I              B1EZNB                          WEEZNB
     I              B1AYPR                          WEAYPR
     I              B1BBDT                          WEBBDT
     I              B1AKTM                          WEAKTM
     I              B1IQST                          WEIQST
     I              B1EFST                          WEEFST
     I              B1H6NB                          WEH6NB
     I              B1BEPC                          WEBEPC
     I              B1GCST                          WEGCST
     I              B1GDST                          WEGDST
     I              B1GEST                          WEGEST
     I              B1BHPC                          WEBHPC
     I              B1IOST                          WEIOST
     I              B1IPST                          WEIPST
     I              B1LTNB                          WELTNB
     I              B1JNST                          WEJNST
     I              B1X4NB                          WEX4NB
     I              B1FNPC                          WEFNPC
     I              B1FOPC                          WEFOPC
     I              B1FPPC                          WEFPPC
     I              B1K2ST                          WEK2ST
     I              B1K3ST                          WEK3ST
     I              B1JWPR                          WEJWPR
     I              B1F5PC                          WEF5PC
     I              B1JXPR                          WEJXPR
     I              B1JYPR                          WEJYPR
     I              B1JZPR                          WEJZPR
     I              B1J0PR                          WEJ0PR
     I              B1J1PR                          WEJ1PR
     I              B1J2PR                          WEJ2PR
     I              B1J3PR                          WEJ3PR
     I              B1J4PR                          WEJ4PR
     I              B1UTST                          WEUTST
     I              B1HVCD                          WEHVCD
     I              B1DKJR                          WEDKJR
     I              B1ITJF                          WEITJF
     I              B1IJGR                          WEIJGR
     I              B1ORJE                          WEORJE
     I              B1OTJR                          WEOTJR
     I              B1PEIR                          WEPEIR
     I              B1IEUF                          WEIEUF
     I              B1ORUE                          WEORUE
     I              B1IUTR                          WEIUTR
     I              B1IJRR                          WEIJRR
     I              B1VCST                          WEVCST
     I              B1VDST                          WEVDST
     I              B1VEST                          WEVEST
     I              B1VFST                          WEVFST
     I              B1VGST                          WEVGST
     I              B1ABCD                          WEABCD
     I              B1AACD                          WEAACD
     I              B1AAVN                          WEAAVN
     I              B1AADT                          WEAADT
     I              B1AMTM                          WEAMTM
     I              B1AJST                          WEAJST
     I              B1AHVN                          WEAHVN
     I              B1AGVN                          WEAGVN
     I              B1ABVN                          WEABVN
     I              B1ABDT                          WEABDT
     I              B1ABTM                          WEABTM
      *
     I@EKCPB4
      * Trim Button               Retrieval index
      * Renamed input format fields
     I              EKHONB                          WFHONB
     I              EKTEST                          WFTEST
     I              EKTFST                          WFTFST
     I              EKTGST                          WFTGST
     I              EKGQPC                          WFGQPC
     I              EKAAVN                          WFAAVN
     I              EKAADT                          WFAADT
     I              EKAMTM                          WFAMTM
     I              EKAJST                          WFAJST
     I              EKAHVN                          WFAHVN
     I              EKAGVN                          WFAGVN
     I              EKABVN                          WFABVN
     I              EKABDT                          WFABDT
     I              EKABTM                          WFABTM
      *
     IZBSCPNG
      * Loss Trans                RTV Next#
      * Renamed input format fields
     I              BSHUNB                          WGHUNB
     I              BSA7DT                          WGA7DT
     I              BSFHNB                          WGFHNB
     I              BSFFNB                          WGFFNB
     I              BSEBST                          WGEBST
     I              BSDSNB                          WGDSNB
     I              BSS3NB                          WGS3NB
     I              BSS4NB                          WGS4NB
     I              BSD1ST                          WGD1ST
     I              BSH5ST                          WGH5ST
     I              BSJMST                          WGJMST
     I              BSSMST                          WGSMST
     I              BSBWCD                          WGBWCD
     I              BSBYCD                          WGBYCD
     I              BSHMNB                          WGHMNB
     I              BSBNNB                          WGBNNB
     I              BSBONB                          WGBONB
     I              BSCVNB                          WGCVNB
     I              BSB0DT                          WGB0DT
     I              BSAAVN                          WGAAVN
     I              BSAADT                          WGAADT
     I              BSAMTM                          WGAMTM
     I              BSAJST                          WGAJST
     I              BSAHVN                          WGAHVN
     I              BSAGVN                          WGAGVN
     I              BSABVN                          WGABVN
     I              BSABDT                          WGABDT
     I              BSABTM                          WGABTM
     I              BSB8DT                          WGB8DT
     I              BSAOTM                          WGAOTM
      *
     I@BSCPFS
      * Loss Trans                Update index
      * Renamed input format fields
     I              BSHUNB                          WHHUNB
     I              BSA7DT                          WHA7DT
     I              BSFHNB                          WHFHNB
     I              BSFFNB                          WHFFNB
     I              BSEBST                          WHEBST
     I              BSDSNB                          WHDSNB
     I              BSS3NB                          WHS3NB
     I              BSS4NB                          WHS4NB
     I              BSD1ST                          WHD1ST
     I              BSH5ST                          WHH5ST
     I              BSJMST                          WHJMST
     I              BSSMST                          WHSMST
     I              BSBWCD                          WHBWCD
     I              BSBYCD                          WHBYCD
     I              BSHMNB                          WHHMNB
     I              BSBNNB                          WHBNNB
     I              BSBONB                          WHBONB
     I              BSCVNB                          WHCVNB
     I              BSB0DT                          WHB0DT
     I              BSAAVN                          WHAAVN
     I              BSAADT                          WHAADT
     I              BSAMTM                          WHAMTM
     I              BSAJST                          WHAJST
     I              BSAHVN                          WHAHVN
     I              BSAGVN                          WHAGVN
     I              BSABVN                          WHABVN
     I              BSABDT                          WHABDT
     I              BSABTM                          WHABTM
     I              BSB8DT                          WHB8DT
     I              BSAOTM                          WHAOTM
      *
     I@A1CPC5
      * Tattoo Header             Update index
      * Renamed input format fields
     I              A1HMNB                          WIHMNB
     I              A1BNNB                          WIBNNB
     I              A1BONB                          WIBONB
     I              A1CVNB                          WICVNB
     I              A1B0DT                          WIB0DT
     I              A1AWDT                          WIAWDT
     I              A1BICD                          WIBICD
     I              A1CPST                          WICPST
     I              A1ACPR                          WIACPR
     I              A1B9PR                          WIB9PR
     I              A1CAPR                          WICAPR
     I              A1C4ST                          WIC4ST
     I              A1AIPR                          WIAIPR
     I              A1A6DT                          WIA6DT
     I              A1C2ST                          WIC2ST
     I              A1CXNB                          WICXNB
     I              A1CWNB                          WICWNB
     I              A1FCNB                          WIFCNB
     I              A1H9NB                          WIH9NB
     I              A1FDNB                          WIFDNB
     I              A1FENB                          WIFENB
     I              A1HENB                          WIHENB
     I              A1HFNB                          WIHFNB
     I              A1CYNB                          WICYNB
     I              A1LRNB                          WILRNB
     I              A1E0NB                          WIE0NB
     I              A1A5PC                          WIA5PC
     I              A1FBNB                          WIFBNB
     I              A1A4PC                          WIA4PC
     I              A1F7NB                          WIF7NB
     I              A1HDNB                          WIHDNB
     I              A1F5NB                          WIF5NB
     I              A1F4NB                          WIF4NB
     I              A1F3NB                          WIF3NB
     I              A1F2NB                          WIF2NB
     I              A1AVPC                          WIAVPC
     I              A1AWPC                          WIAWPC
     I              A1CWPC                          WICWPC
     I              A1A8PC                          WIA8PC
     I              A1A7PC                          WIA7PC
     I              A1B8PR                          WIB8PR
     I              A1AMPR                          WIAMPR
     I              A1ANPR                          WIANPR
     I              A1AYVA                          WIAYVA
     I              A1AWVA                          WIAWVA
     I              A1AOPR                          WIAOPR
     I              A1AXVA                          WIAXVA
     I              A1APPR                          WIAPPR
     I              A1ASPR                          WIASPR
     I              A1A4VA                          WIA4VA
     I              A1ATPR                          WIATPR
     I              A1A5VA                          WIA5VA
     I              A1CBPR                          WICBPR
     I              A1CCPR                          WICCPR
     I              A1LPNB                          WILPNB
     I              A1CDPR                          WICDPR
     I              A1A7VA                          WIA7VA
     I              A1A2PR                          WIA2PR
     I              A1JWST                          WIJWST
     I              A1CWST                          WICWST
     I              A1D7ST                          WID7ST
     I              A1D8ST                          WID8ST
     I              A1DWST                          WIDWST
     I              A1D6ST                          WID6ST
     I              A1GHNB                          WIGHNB
     I              A1BYDT                          WIBYDT
     I              A1E0ST                          WIE0ST
     I              A1E1ST                          WIE1ST
     I              A1E2ST                          WIE2ST
     I              A1BSDT                          WIBSDT
     I              A1BTDT                          WIBTDT
     I              A1BUDT                          WIBUDT
     I              A1HGNB                          WIHGNB
     I              A1HHNB                          WIHHNB
     I              A1HINB                          WIHINB
     I              A1A3PR                          WIA3PR
     I              A1A4PR                          WIA4PR
     I              A1A6PR                          WIA6PR
     I              A1J9NB                          WIJ9NB
     I              A1D6PR                          WID6PR
     I              A1D7PR                          WID7PR
     I              A1D8PR                          WID8PR
     I              A1D9PR                          WID9PR
     I              A1EAPR                          WIEAPR
     I              A1EBPR                          WIEBPR
     I              A1ECPR                          WIECPR
     I              A1EDPR                          WIEDPR
     I              A1EEPR                          WIEEPR
     I              A1EFPR                          WIEFPR
     I              A1EGPR                          WIEGPR
     I              A1EHPR                          WIEHPR
     I              A1KAST                          WIKAST
     I              A1J7ST                          WIJ7ST
     I              A1J9ST                          WIJ9ST
     I              A1OXNB                          WIOXNB
     I              A1LKST                          WILKST
     I              A1LLST                          WILLST
     I              A1J8ST                          WIJ8ST
     I              A1LIST                          WILIST
     I              A1LJST                          WILJST
     I              A1NZTX                          WINZTX
     I              A1HJCD                          WIHJCD
     I              A1R4ST                          WIR4ST
     I              A1R5ST                          WIR5ST
     I              A1R6ST                          WIR6ST
     I              A1R7ST                          WIR7ST
     I              A1THWT                          WITHWT
     I              A1T2WT                          WIT2WT
     I              A1THHD                          WITHHD
     I              A1T2HD                          WIT2HD
     I              A1OBPR                          WIOBPR
     I              A1KOER                          WIKOER
     I              A1OPIR                          WIOPIR
     I              A1OPEM                          WIOPEM
     I              A1IORP                          WIIORP
     I              A1OWEO                          WIOWEO
     I              A1OQET                          WIOQET
     I              A1URST                          WIURST
     I              A1USST                          WIUSST
     I              A1HHPC                          WIHHPC
     I              A1S9PR                          WIS9PR
     I              A1TAPR                          WITAPR
     I              A1TBPR                          WITBPR
     I              A1JFUR                          WIJFUR
     I              A1KRIF                          WIKRIF
     I              A1KORF                          WIKORF
     I              A1KAPR                          WIKAPR
     I              A1KROT                          WIKROT
     I              A1OTJG                          WIOTJG
     I              A1IRJG                          WIIRJG
     I              A1IMJF                          WIIMJF
     I              A1IRGF                          WIIRGF
     I              A1KRJF                          WIKRJF
     I              A1OJRF                          WIOJRF
     I              A1KFOR                          WIKFOR
     I              A1ORJK                          WIORJK
     I              A1OMVJ                          WIOMVJ
     I              A1MVNF                          WIMVNF
     I              A1MCNF                          WIMCNF
     I              A1NCNF                          WINCNF
     I              A1NCHF                          WINCHF
     I              A1IGIR                          WIIGIR
     I              A1KFJR                          WIKFJR
     I              A1EADT                          WIEADT
     I              A1EBDT                          WIEBDT
     I              A1ECDT                          WIECDT
     I              A1EDDT                          WIEDDT
     I              A1EEDT                          WIEEDT
     I              A1U4ST                          WIU4ST
     I              A1U5ST                          WIU5ST
     I              A1U6ST                          WIU6ST
     I              A1U7ST                          WIU7ST
     I              A1U8ST                          WIU8ST
     I              A1U9ST                          WIU9ST
     I              A1VAST                          WIVAST
     I              A1VBST                          WIVBST
     I              A1BDCD                          WIBDCD
     I              A1CSCD                          WICSCD
     I              A1ABCD                          WIABCD
     I              A1AECD                          WIAECD
     I              A1ACCD                          WIACCD
     I              A1AGCD                          WIAGCD
     I              A1BECD                          WIBECD
     I              A1AAVN                          WIAAVN
     I              A1AADT                          WIAADT
     I              A1AMTM                          WIAMTM
     I              A1AJST                          WIAJST
     I              A1AHVN                          WIAHVN
     I              A1AGVN                          WIAGVN
     I              A1ABVN                          WIABVN
     I              A1ABDT                          WIABDT
     I              A1ABTM                          WIABTM
      *
     I@A1CPC4
      * Tattoo Header             Retrieval index
      * Renamed input format fields
     I              A1HMNB                          WJHMNB
     I              A1BNNB                          WJBNNB
     I              A1BONB                          WJBONB
     I              A1CVNB                          WJCVNB
     I              A1B0DT                          WJB0DT
     I              A1AWDT                          WJAWDT
     I              A1BICD                          WJBICD
     I              A1CPST                          WJCPST
     I              A1ACPR                          WJACPR
     I              A1B9PR                          WJB9PR
     I              A1CAPR                          WJCAPR
     I              A1C4ST                          WJC4ST
     I              A1AIPR                          WJAIPR
     I              A1A6DT                          WJA6DT
     I              A1C2ST                          WJC2ST
     I              A1CXNB                          WJCXNB
     I              A1CWNB                          WJCWNB
     I              A1FCNB                          WJFCNB
     I              A1H9NB                          WJH9NB
     I              A1FDNB                          WJFDNB
     I              A1FENB                          WJFENB
     I              A1HENB                          WJHENB
     I              A1HFNB                          WJHFNB
     I              A1CYNB                          WJCYNB
     I              A1LRNB                          WJLRNB
     I              A1E0NB                          WJE0NB
     I              A1A5PC                          WJA5PC
     I              A1FBNB                          WJFBNB
     I              A1A4PC                          WJA4PC
     I              A1F7NB                          WJF7NB
     I              A1HDNB                          WJHDNB
     I              A1F5NB                          WJF5NB
     I              A1F4NB                          WJF4NB
     I              A1F3NB                          WJF3NB
     I              A1F2NB                          WJF2NB
     I              A1AVPC                          WJAVPC
     I              A1AWPC                          WJAWPC
     I              A1CWPC                          WJCWPC
     I              A1A8PC                          WJA8PC
     I              A1A7PC                          WJA7PC
     I              A1B8PR                          WJB8PR
     I              A1AMPR                          WJAMPR
     I              A1ANPR                          WJANPR
     I              A1AYVA                          WJAYVA
     I              A1AWVA                          WJAWVA
     I              A1AOPR                          WJAOPR
     I              A1AXVA                          WJAXVA
     I              A1APPR                          WJAPPR
     I              A1ASPR                          WJASPR
     I              A1A4VA                          WJA4VA
     I              A1ATPR                          WJATPR
     I              A1A5VA                          WJA5VA
     I              A1CBPR                          WJCBPR
     I              A1CCPR                          WJCCPR
     I              A1LPNB                          WJLPNB
     I              A1CDPR                          WJCDPR
     I              A1A7VA                          WJA7VA
     I              A1A2PR                          WJA2PR
     I              A1JWST                          WJJWST
     I              A1CWST                          WJCWST
     I              A1D7ST                          WJD7ST
     I              A1D8ST                          WJD8ST
     I              A1DWST                          WJDWST
     I              A1D6ST                          WJD6ST
     I              A1GHNB                          WJGHNB
     I              A1BYDT                          WJBYDT
     I              A1E0ST                          WJE0ST
     I              A1E1ST                          WJE1ST
     I              A1E2ST                          WJE2ST
     I              A1BSDT                          WJBSDT
     I              A1BTDT                          WJBTDT
     I              A1BUDT                          WJBUDT
     I              A1HGNB                          WJHGNB
     I              A1HHNB                          WJHHNB
     I              A1HINB                          WJHINB
     I              A1A3PR                          WJA3PR
     I              A1A4PR                          WJA4PR
     I              A1A6PR                          WJA6PR
     I              A1J9NB                          WJJ9NB
     I              A1D6PR                          WJD6PR
     I              A1D7PR                          WJD7PR
     I              A1D8PR                          WJD8PR
     I              A1D9PR                          WJD9PR
     I              A1EAPR                          WJEAPR
     I              A1EBPR                          WJEBPR
     I              A1ECPR                          WJECPR
     I              A1EDPR                          WJEDPR
     I              A1EEPR                          WJEEPR
     I              A1EFPR                          WJEFPR
     I              A1EGPR                          WJEGPR
     I              A1EHPR                          WJEHPR
     I              A1KAST                          WJKAST
     I              A1J7ST                          WJJ7ST
     I              A1J9ST                          WJJ9ST
     I              A1OXNB                          WJOXNB
     I              A1LKST                          WJLKST
     I              A1LLST                          WJLLST
     I              A1J8ST                          WJJ8ST
     I              A1LIST                          WJLIST
     I              A1LJST                          WJLJST
     I              A1NZTX                          WJNZTX
     I              A1HJCD                          WJHJCD
     I              A1R4ST                          WJR4ST
     I              A1R5ST                          WJR5ST
     I              A1R6ST                          WJR6ST
     I              A1R7ST                          WJR7ST
     I              A1THWT                          WJTHWT
     I              A1T2WT                          WJT2WT
     I              A1THHD                          WJTHHD
     I              A1T2HD                          WJT2HD
     I              A1OBPR                          WJOBPR
     I              A1KOER                          WJKOER
     I              A1OPIR                          WJOPIR
     I              A1OPEM                          WJOPEM
     I              A1IORP                          WJIORP
     I              A1OWEO                          WJOWEO
     I              A1OQET                          WJOQET
     I              A1URST                          WJURST
     I              A1USST                          WJUSST
     I              A1HHPC                          WJHHPC
     I              A1S9PR                          WJS9PR
     I              A1TAPR                          WJTAPR
     I              A1TBPR                          WJTBPR
     I              A1JFUR                          WJJFUR
     I              A1KRIF                          WJKRIF
     I              A1KORF                          WJKORF
     I              A1KAPR                          WJKAPR
     I              A1KROT                          WJKROT
     I              A1OTJG                          WJOTJG
     I              A1IRJG                          WJIRJG
     I              A1IMJF                          WJIMJF
     I              A1IRGF                          WJIRGF
     I              A1KRJF                          WJKRJF
     I              A1OJRF                          WJOJRF
     I              A1KFOR                          WJKFOR
     I              A1ORJK                          WJORJK
     I              A1OMVJ                          WJOMVJ
     I              A1MVNF                          WJMVNF
     I              A1MCNF                          WJMCNF
     I              A1NCNF                          WJNCNF
     I              A1NCHF                          WJNCHF
     I              A1IGIR                          WJIGIR
     I              A1KFJR                          WJKFJR
     I              A1EADT                          WJEADT
     I              A1EBDT                          WJEBDT
     I              A1ECDT                          WJECDT
     I              A1EDDT                          WJEDDT
     I              A1EEDT                          WJEEDT
     I              A1U4ST                          WJU4ST
     I              A1U5ST                          WJU5ST
     I              A1U6ST                          WJU6ST
     I              A1U7ST                          WJU7ST
     I              A1U8ST                          WJU8ST
     I              A1U9ST                          WJU9ST
     I              A1VAST                          WJVAST
     I              A1VBST                          WJVBST
     I              A1BDCD                          WJBDCD
     I              A1CSCD                          WJCSCD
     I              A1ABCD                          WJABCD
     I              A1AECD                          WJAECD
     I              A1ACCD                          WJACCD
     I              A1AGCD                          WJAGCD
     I              A1BECD                          WJBECD
     I              A1AAVN                          WJAAVN
     I              A1AADT                          WJAADT
     I              A1AMTM                          WJAMTM
     I              A1AJST                          WJAJST
     I              A1AHVN                          WJAHVN
     I              A1AGVN                          WJAGVN
     I              A1ABVN                          WJABVN
     I              A1ABDT                          WJABDT
     I              A1ABTM                          WJABTM
      *
     I@DCCPSF
      * Company Kill Recap        Retrieval index
      * Renamed input format fields
     I              DCHONB                          WKHONB
     I              DCCRDT                          WKCRDT
     I              DCTBNB                          WKTBNB
     I              DCTDNB                          WKTDNB
     I              DCTCNB                          WKTCNB
     I              DCTENB                          WKTENB
     I              DCTFNB                          WKTFNB
     I              DCTKNB                          WKTKNB
     I              DCTGNB                          WKTGNB
     I              DCTINB                          WKTINB
     I              DCTHNB                          WKTHNB
     I              DCAAVN                          WKAAVN
     I              DCAADT                          WKAADT
     I              DCAMTM                          WKAMTM
     I              DCAJST                          WKAJST
     I              DCAHVN                          WKAHVN
     I              DCAGVN                          WKAGVN
     I              DCABVN                          WKABVN
     I              DCABDT                          WKABDT
     I              DCABTM                          WKABTM
      *
     I@DCCPSE
      * Company Kill Recap        Update index
      * Renamed input format fields
     I              DCHONB                          WLHONB
     I              DCCRDT                          WLCRDT
     I              DCTBNB                          WLTBNB
     I              DCTDNB                          WLTDNB
     I              DCTCNB                          WLTCNB
     I              DCTENB                          WLTENB
     I              DCTFNB                          WLTFNB
     I              DCTKNB                          WLTKNB
     I              DCTGNB                          WLTGNB
     I              DCTINB                          WLTINB
     I              DCTHNB                          WLTHNB
     I              DCAAVN                          WLAAVN
     I              DCAADT                          WLAADT
     I              DCAMTM                          WLAMTM
     I              DCAJST                          WLAJST
     I              DCAHVN                          WLAHVN
     I              DCAGVN                          WLAGVN
     I              DCABVN                          WLABVN
     I              DCABDT                          WLABDT
     I              DCABTM                          WLABTM
      *
     I@C7RESK
      * Company Expense           Active Only
      * Renamed input format fields
     I              C7P9NB                          WMP9NB
     I              C7ELCD                          WMELCD
     I              C7I7TX                          WMI7TX
     I              C7KSST                          WMKSST
     I              C7KQST                          WMKQST
     I              C7E9PR                          WME9PR
     I              C7AAVN                          WMAAVN
     I              C7AADT                          WMAADT
     I              C7AMTM                          WMAMTM
     I              C7AJST                          WMAJST
     I              C7AHVN                          WMAHVN
     I              C7AGVN                          WMAGVN
     I              C7ABVN                          WMABVN
     I              C7ABDT                          WMABDT
     I              C7ABTM                          WMABTM
      *
     I@DDCPSI
      * Company Kill Expense Rate Update index
      * Renamed input format fields
     I              DDP9NB                          WOP9NB
     I              DDELCD                          WOELCD
     I              DDCSDT                          WOCSDT
     I              DDL7ST                          WOL7ST
     I              DDF5PR                          WOF5PR
     I              DDAAVN                          WOAAVN
     I              DDAADT                          WOAADT
     I              DDAMTM                          WOAMTM
     I              DDAJST                          WOAJST
     I              DDAHVN                          WOAHVN
     I              DDAGVN                          WOAGVN
     I              DDABVN                          WOABVN
     I              DDABDT                          WOABDT
     I              DDABTM                          WOABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPKB11    E DSPKB1CPL0
      * UPD : Carcass Detail            Update index
      * Renamed input format fields
     I              B1HMNB                          WEHMNB
     I              B1BNNB                          WEBNNB
     I              B1BONB                          WEBONB
     I              B1CVNB                          WECVNB
     I              B1B0DT                          WEB0DT
     I              B1LGNB                          WELGNB
     I              B1EUNB                          WEEUNB
     I              B1LHNB                          WELHNB
     I              B1INST                          WEINST
     I              B1BEPR                          WEBEPR
     I              B1ASPC                          WEASPC
     I              B1EWNB                          WEEWNB
     I              B1B4PR                          WEB4PR
     I              B1EYNB                          WEEYNB
     I              B1B1PR                          WEB1PR
     I              B1AVPR                          WEAVPR
     I              B1AUPC                          WEAUPC
     I              B1AWPR                          WEAWPR
     I              B1AXPR                          WEAXPR
     I              B1EZNB                          WEEZNB
     I              B1AYPR                          WEAYPR
     I              B1BBDT                          WEBBDT
     I              B1AKTM                          WEAKTM
     I              B1IQST                          WEIQST
     I              B1EFST                          WEEFST
     I              B1H6NB                          WEH6NB
     I              B1BEPC                          WEBEPC
     I              B1GCST                          WEGCST
     I              B1GDST                          WEGDST
     I              B1GEST                          WEGEST
     I              B1BHPC                          WEBHPC
     I              B1IOST                          WEIOST
     I              B1IPST                          WEIPST
     I              B1LTNB                          WELTNB
     I              B1JNST                          WEJNST
     I              B1X4NB                          WEX4NB
     I              B1FNPC                          WEFNPC
     I              B1FOPC                          WEFOPC
     I              B1FPPC                          WEFPPC
     I              B1K2ST                          WEK2ST
     I              B1K3ST                          WEK3ST
     I              B1JWPR                          WEJWPR
     I              B1F5PC                          WEF5PC
     I              B1JXPR                          WEJXPR
     I              B1JYPR                          WEJYPR
     I              B1JZPR                          WEJZPR
     I              B1J0PR                          WEJ0PR
     I              B1J1PR                          WEJ1PR
     I              B1J2PR                          WEJ2PR
     I              B1J3PR                          WEJ3PR
     I              B1J4PR                          WEJ4PR
     I              B1UTST                          WEUTST
     I              B1HVCD                          WEHVCD
     I              B1DKJR                          WEDKJR
     I              B1ITJF                          WEITJF
     I              B1IJGR                          WEIJGR
     I              B1ORJE                          WEORJE
     I              B1OTJR                          WEOTJR
     I              B1PEIR                          WEPEIR
     I              B1IEUF                          WEIEUF
     I              B1ORUE                          WEORUE
     I              B1IUTR                          WEIUTR
     I              B1IJRR                          WEIJRR
     I              B1VCST                          WEVCST
     I              B1VDST                          WEVDST
     I              B1VEST                          WEVEST
     I              B1VFST                          WEVFST
     I              B1VGST                          WEVGST
     I              B1ABCD                          WEABCD
     I              B1AACD                          WEAACD
     I              B1AAVN                          WEAAVN
     I              B1AADT                          WEAADT
     I              B1AMTM                          WEAMTM
     I              B1AJST                          WEAJST
     I              B1AHVN                          WEAHVN
     I              B1AGVN                          WEAGVN
     I              B1ABVN                          WEABVN
     I              B1ABDT                          WEABDT
     I              B1ABTM                          WEABTM
      *
     IQPKBS1    E DSPKBSCPL0
      * UPD : Loss Trans                Update index
      * Renamed input format fields
     I              BSHUNB                          WHHUNB
     I              BSA7DT                          WHA7DT
     I              BSFHNB                          WHFHNB
     I              BSFFNB                          WHFFNB
     I              BSEBST                          WHEBST
     I              BSDSNB                          WHDSNB
     I              BSS3NB                          WHS3NB
     I              BSS4NB                          WHS4NB
     I              BSD1ST                          WHD1ST
     I              BSH5ST                          WHH5ST
     I              BSJMST                          WHJMST
     I              BSSMST                          WHSMST
     I              BSBWCD                          WHBWCD
     I              BSBYCD                          WHBYCD
     I              BSHMNB                          WHHMNB
     I              BSBNNB                          WHBNNB
     I              BSBONB                          WHBONB
     I              BSCVNB                          WHCVNB
     I              BSB0DT                          WHB0DT
     I              BSAAVN                          WHAAVN
     I              BSAADT                          WHAADT
     I              BSAMTM                          WHAMTM
     I              BSAJST                          WHAJST
     I              BSAHVN                          WHAHVN
     I              BSAGVN                          WHAGVN
     I              BSABVN                          WHABVN
     I              BSABDT                          WHABDT
     I              BSABTM                          WHABTM
     I              BSB8DT                          WHB8DT
     I              BSAOTM                          WHAOTM
      *
     IQPKA11    E DSPKA1CPL1
      * UPD : Tattoo Header             Update index
      * Renamed input format fields
     I              A1HMNB                          WIHMNB
     I              A1BNNB                          WIBNNB
     I              A1BONB                          WIBONB
     I              A1CVNB                          WICVNB
     I              A1B0DT                          WIB0DT
     I              A1AWDT                          WIAWDT
     I              A1BICD                          WIBICD
     I              A1CPST                          WICPST
     I              A1ACPR                          WIACPR
     I              A1B9PR                          WIB9PR
     I              A1CAPR                          WICAPR
     I              A1C4ST                          WIC4ST
     I              A1AIPR                          WIAIPR
     I              A1A6DT                          WIA6DT
     I              A1C2ST                          WIC2ST
     I              A1CXNB                          WICXNB
     I              A1CWNB                          WICWNB
     I              A1FCNB                          WIFCNB
     I              A1H9NB                          WIH9NB
     I              A1FDNB                          WIFDNB
     I              A1FENB                          WIFENB
     I              A1HENB                          WIHENB
     I              A1HFNB                          WIHFNB
     I              A1CYNB                          WICYNB
     I              A1LRNB                          WILRNB
     I              A1E0NB                          WIE0NB
     I              A1A5PC                          WIA5PC
     I              A1FBNB                          WIFBNB
     I              A1A4PC                          WIA4PC
     I              A1F7NB                          WIF7NB
     I              A1HDNB                          WIHDNB
     I              A1F5NB                          WIF5NB
     I              A1F4NB                          WIF4NB
     I              A1F3NB                          WIF3NB
     I              A1F2NB                          WIF2NB
     I              A1AVPC                          WIAVPC
     I              A1AWPC                          WIAWPC
     I              A1CWPC                          WICWPC
     I              A1A8PC                          WIA8PC
     I              A1A7PC                          WIA7PC
     I              A1B8PR                          WIB8PR
     I              A1AMPR                          WIAMPR
     I              A1ANPR                          WIANPR
     I              A1AYVA                          WIAYVA
     I              A1AWVA                          WIAWVA
     I              A1AOPR                          WIAOPR
     I              A1AXVA                          WIAXVA
     I              A1APPR                          WIAPPR
     I              A1ASPR                          WIASPR
     I              A1A4VA                          WIA4VA
     I              A1ATPR                          WIATPR
     I              A1A5VA                          WIA5VA
     I              A1CBPR                          WICBPR
     I              A1CCPR                          WICCPR
     I              A1LPNB                          WILPNB
     I              A1CDPR                          WICDPR
     I              A1A7VA                          WIA7VA
     I              A1A2PR                          WIA2PR
     I              A1JWST                          WIJWST
     I              A1CWST                          WICWST
     I              A1D7ST                          WID7ST
     I              A1D8ST                          WID8ST
     I              A1DWST                          WIDWST
     I              A1D6ST                          WID6ST
     I              A1GHNB                          WIGHNB
     I              A1BYDT                          WIBYDT
     I              A1E0ST                          WIE0ST
     I              A1E1ST                          WIE1ST
     I              A1E2ST                          WIE2ST
     I              A1BSDT                          WIBSDT
     I              A1BTDT                          WIBTDT
     I              A1BUDT                          WIBUDT
     I              A1HGNB                          WIHGNB
     I              A1HHNB                          WIHHNB
     I              A1HINB                          WIHINB
     I              A1A3PR                          WIA3PR
     I              A1A4PR                          WIA4PR
     I              A1A6PR                          WIA6PR
     I              A1J9NB                          WIJ9NB
     I              A1D6PR                          WID6PR
     I              A1D7PR                          WID7PR
     I              A1D8PR                          WID8PR
     I              A1D9PR                          WID9PR
     I              A1EAPR                          WIEAPR
     I              A1EBPR                          WIEBPR
     I              A1ECPR                          WIECPR
     I              A1EDPR                          WIEDPR
     I              A1EEPR                          WIEEPR
     I              A1EFPR                          WIEFPR
     I              A1EGPR                          WIEGPR
     I              A1EHPR                          WIEHPR
     I              A1KAST                          WIKAST
     I              A1J7ST                          WIJ7ST
     I              A1J9ST                          WIJ9ST
     I              A1OXNB                          WIOXNB
     I              A1LKST                          WILKST
     I              A1LLST                          WILLST
     I              A1J8ST                          WIJ8ST
     I              A1LIST                          WILIST
     I              A1LJST                          WILJST
     I              A1NZTX                          WINZTX
     I              A1HJCD                          WIHJCD
     I              A1R4ST                          WIR4ST
     I              A1R5ST                          WIR5ST
     I              A1R6ST                          WIR6ST
     I              A1R7ST                          WIR7ST
     I              A1THWT                          WITHWT
     I              A1T2WT                          WIT2WT
     I              A1THHD                          WITHHD
     I              A1T2HD                          WIT2HD
     I              A1OBPR                          WIOBPR
     I              A1KOER                          WIKOER
     I              A1OPIR                          WIOPIR
     I              A1OPEM                          WIOPEM
     I              A1IORP                          WIIORP
     I              A1OWEO                          WIOWEO
     I              A1OQET                          WIOQET
     I              A1URST                          WIURST
     I              A1USST                          WIUSST
     I              A1HHPC                          WIHHPC
     I              A1S9PR                          WIS9PR
     I              A1TAPR                          WITAPR
     I              A1TBPR                          WITBPR
     I              A1JFUR                          WIJFUR
     I              A1KRIF                          WIKRIF
     I              A1KORF                          WIKORF
     I              A1KAPR                          WIKAPR
     I              A1KROT                          WIKROT
     I              A1OTJG                          WIOTJG
     I              A1IRJG                          WIIRJG
     I              A1IMJF                          WIIMJF
     I              A1IRGF                          WIIRGF
     I              A1KRJF                          WIKRJF
     I              A1OJRF                          WIOJRF
     I              A1KFOR                          WIKFOR
     I              A1ORJK                          WIORJK
     I              A1OMVJ                          WIOMVJ
     I              A1MVNF                          WIMVNF
     I              A1MCNF                          WIMCNF
     I              A1NCNF                          WINCNF
     I              A1NCHF                          WINCHF
     I              A1IGIR                          WIIGIR
     I              A1KFJR                          WIKFJR
     I              A1EADT                          WIEADT
     I              A1EBDT                          WIEBDT
     I              A1ECDT                          WIECDT
     I              A1EDDT                          WIEDDT
     I              A1EEDT                          WIEEDT
     I              A1U4ST                          WIU4ST
     I              A1U5ST                          WIU5ST
     I              A1U6ST                          WIU6ST
     I              A1U7ST                          WIU7ST
     I              A1U8ST                          WIU8ST
     I              A1U9ST                          WIU9ST
     I              A1VAST                          WIVAST
     I              A1VBST                          WIVBST
     I              A1BDCD                          WIBDCD
     I              A1CSCD                          WICSCD
     I              A1ABCD                          WIABCD
     I              A1AECD                          WIAECD
     I              A1ACCD                          WIACCD
     I              A1AGCD                          WIAGCD
     I              A1BECD                          WIBECD
     I              A1AAVN                          WIAAVN
     I              A1AADT                          WIAADT
     I              A1AMTM                          WIAMTM
     I              A1AJST                          WIAJST
     I              A1AHVN                          WIAHVN
     I              A1AGVN                          WIAGVN
     I              A1ABVN                          WIABVN
     I              A1ABDT                          WIABDT
     I              A1ABTM                          WIABTM
      *
     IYARDCS      DS                            583
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IYBRDCS      DS                            583
     IQPKDC1    E DSPKDCCPL0
      * UPD : Company Kill Recap        Update index
      * Renamed input format fields
     I              DCHONB                          WLHONB
     I              DCCRDT                          WLCRDT
     I              DCTBNB                          WLTBNB
     I              DCTDNB                          WLTDNB
     I              DCTCNB                          WLTCNB
     I              DCTENB                          WLTENB
     I              DCTFNB                          WLTFNB
     I              DCTKNB                          WLTKNB
     I              DCTGNB                          WLTGNB
     I              DCTINB                          WLTINB
     I              DCTHNB                          WLTHNB
     I              DCAAVN                          WLAAVN
     I              DCAADT                          WLAADT
     I              DCAMTM                          WLAMTM
     I              DCAJST                          WLAJST
     I              DCAHVN                          WLAHVN
     I              DCAGVN                          WLAGVN
     I              DCABVN                          WLABVN
     I              DCABDT                          WLABDT
     I              DCABTM                          WLABTM
      *
     IYCRDCS      DS                            101
     IQPKDD1    E DSPKDDCPL0
      * UPD : Company Kill Expense Rate Update index
      * Renamed input format fields
     I              DDP9NB                          WOP9NB
     I              DDELCD                          WOELCD
     I              DDCSDT                          WOCSDT
     I              DDL7ST                          WOL7ST
     I              DDF5PR                          WOF5PR
     I              DDAAVN                          WOAAVN
     I              DDAADT                          WOAADT
     I              DDAMTM                          WOAMTM
     I              DDAJST                          WOAJST
     I              DDAHVN                          WOAHVN
     I              DDAGVN                          WOAGVN
     I              DDABVN                          WOABVN
     I              DDABDT                          WOABDT
     I              DDABTM                          WOABTM
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Payment Processing Parms
      * I :  CC Company Number
     I                                    P   1   20P1HONB
      * I :  Pmt Current Payment Date
     I                                    P   3   60P1CKDT
     IP2PARM      DS
      * I : MAP Oms System Value Alpha
     I                                        1  40 P2EVTX
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HONB    PARM           WP0001  30       CC Company Numb
     C           P1CKDT    PARM           WP0002  70       Pmt Current Pay
     C           P2EVTX    PARM           WP0003 40        Oms System Valu
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prc Crt CDtl/Prc Flg  XF
      * Modifications and Comments
     C                     EXSR UASUBR                     Modifications a
      * 05/28/04 SLM HPEBAL - Balancing with Producer's History Average
      * Step 2.
      * Read each Tattoo and if market,subject read then the evaluation
      * transaction file and create carcass detail records
      * Create Carcass Detail for Unpaid Tattoo's.
      * PayEdt Create Crc Dtl RT - Tattoo Header  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * PayEdt Create Crc Dtl RT - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001 111       Live wgt total
     C                     MOVEL*BLANK    WN0002  1        Status 1
     C                     Z-ADD*ZERO     WN0003  52       TH Recalc Live
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Modifications and Comments
     C                     EXSR UBSUBR                     Modifications a
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0001  30       BOH Company Num
     C                     PARM @CN,001   WQ0002 10        Company Value C
     C           WN0002    PARM *BLANK    WQ0003 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PAR.Status 1 is Yes
     C           WN0002    IFEQ 'Y'                        *IF
      * Rtv Company Value Nbr XF - STR Order Management Sys  * 
     C                     CALL 'PDHGXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0004  30       BOH Company Num
     C                     PARM @CN,002   WQ0005 10        Company Value C
     C           WN0003    PARM *ZERO     WQ0006 155       System Value Nu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHGXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * E2423 Mtech Live or Not Live *** Interfaces to HPS ***
      * Get the MTech Live Yes or No
     C                     EXSR UCSUBR                     Get the MTech L
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHMNB    WQSA01           BOH Company Num
      * Define keylist
     C           KPSSA     KLIST
     C                     KFLD           WQSA01           BOH Company Num
     C                     KFLD           WAB0DT           TH Kill Date
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           BOH Company Num
      * Setup key
     C                     Z-ADDP1HONB    WQSA01           BOH Company Num
     C                     Z-ADDP1CKDT    WAB0DT           TH Kill Date
      * Establish starting position
     C           KPSSA     SETLL@A1CPTB                    *
     C           KRSSA     READE@A1CPTB                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - (c1 AND c2) OR c3 OR c4
      *   |- c1    : DB1.TH Held Over is greater than 0
      *   |- c2    : DB1.TH Held/Ovr Completed Dte is EQ Zero
      *   |- c3    : DB1.TH Kill Balancing Sts is Not Balanced Carcass
      *   |- c4    : DB1.THP Process Code is Payment
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAH9NB    IFGT 0                          *IF
     C           WABSDT    IFEQ 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WADWST    IFEQ 'E'                        *IF
     C           WADWST    OREQ *BLANK
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WACSCD    IFEQ @CN,004                    *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Hog Class         RT - Hog Classification  * 
     C                     EXSR SBRVGN
      * Farm Site
      * CASE: DB1.TH Source Type is Internal
     C           WAKAST    IFEQ 'I'                        *IF
      * CASE: LCL.MTech Live Yes or No is No MTech not Live
     C           YL0001    IFEQ 'N'                        *IF
      * Z1v HPS Farm Info     UP - STR HPS Interface  * 
     C                     CALL 'HP249'                90  Z1v HPS Farm In
     C           W0RTN     PARM W0RTN     WQ0010  7        *Return code
     C                     PARM WAOXNB    WQ0011  70       TH HPS Movement
     C           WUKQTX    PARM *BLANK    WQ0012 25        Farm site Name
     C           YL0002    PARM *ZERO     WQ0013  50       Farm Site USR
     C           WUG4CD    PARM *BLANK    WQ0014  5        HPS FS Comp Rel
     C           WUDRTX    PARM *BLANK    WQ0015  3        State
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP249'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: LCL.MTech Live Yes or No is Yes MTech is Live
     C           YL0001    IFEQ 'Y'                        *IF
      * e2423
      * *** The Tattoo header has the farm site
     C                     Z-ADDWATHHD    YL0002           TH HPS Farm Sit
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0002           TH HPS Farm Sit
     C                     END                             *FI
     C                     Z-ADD*ZERO     YL0003           CD Carcass Numb
     C                     Z-ADD*ZERO     WN0001           Live wgt total
      * Read the Evaluation trans and create Carcass Detail Records
     C                     Z-ADD*ZERO     YL0004           Backfat * Wgt U
     C                     Z-ADD*ZERO     YL0005           Loin-Eye * Wgt
     C                     Z-ADD*ZERO     YL0006           TH Broken Back
      * 01/19/06 PKD User Standard Yield from the Company Values
      *              or use what is in the file.
      * CASE: PAR.Status 1 is Yes
     C           WN0002    IFEQ 'Y'                        *IF
      * CASE: DB1.TH Live Wgt is Zeros
     C           WACYNB    IFEQ 0                          *IF
     C                     Z-ADD1         YL0007           TH Recalc Live
     C                     Z-ADDWN0003    YL0008           TH Recalc Live
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWAA7PC    YL0007           TH Recalc Live
     C                     Z-ADDWAAIPR    YL0008           TH Recalc Live
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWAA7PC    YL0007           TH Recalc Live
     C                     Z-ADDWAAIPR    YL0008           TH Recalc Live
     C                     END                             *FI
      * PayEdt Create Crc Dtl RT - Eval Trans  * 
     C                     EXSR SCRVGN
      * 9/20/02  RMC  Calc Avg Backfat and Loin eye with 2 dec.
      * CASE: DB1.TH Hot Wgt is Not Zero
     C           WAE0NB    IFGT 0                          *IF
     C           YL0004    DIV  WAE0NB    YL0025           TH Avg Backfat
     C           YL0005    DIV  WAE0NB    YL0026           TH Avg Loin Eye
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0025           TH Avg Backfat
     C                     Z-ADD*ZERO     YL0026           TH Avg Loin Eye
     C                     END                             *FI
      * Update Tattoo Header with Payment and Recalculate Net
     C                     MOVEL'PAYMNT'  YL0027           THP Process Cod
      * Calculate Net Status & Recalc Avg Value for the Lot
      * CASE: DB1.TH Payment Sts is Paid Producer
     C           WACWST    IFEQ 'PL'                       *IF
     C           WACWST    OREQ 'PC'
     C           WACWST    OREQ 'NC'
     C           WACWST    OREQ 'NL'
     C                     MOVEL'C'       YL0028           TH Calc Net Sts
     C                     Z-ADDWATAPR    YL0029           TH VC Gross Val
     C                     ELSE
      * CASE: DB1.TH Payment Sts is Unpaid Producer
     C           WACWST    IFEQ 'ML'                       *IF
     C           WACWST    OREQ 'SL'
     C           WACWST    OREQ 'SC'
     C           WACWST    OREQ 'IC'
     C           WACWST    OREQ 'IL'
     C           WACWST    OREQ *BLANK
     C                     MOVEL'R'       YL0028           TH Calc Net Sts
     C                     Z-ADD0         YL0029           TH VC Gross Val
     C                     END                             *FI
     C                     END                             *FI
      * PK0418 3/19/02 Do for External too, so dont check Internal db1.th
      * Mkt, subj : Calc Live wgt, yields from carc dtl calc'd live wgt
      * CASE:
      *  - c2 AND c3 AND c4
      *   |- c2    : DB1.TH Hog Class Type is Not Resale
      *   |- c3    : DB1.TH Head Killed is Not Zero
      *   |- c4    : LCL.TH Recalc Live Wgt is Greater than 0
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WALLST    IFEQ 'M'                        *IF
     C           WALLST    OREQ 'S'
     C           WAFENB    IFNE 0                          *IF
     C           YL0007    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWN0001    YL0030           TH Adj Live Wgt
      * Average Live Weight
      * CASE: DB1.TH Head Killed is Not Zero
     C           WAFENB    IFNE 0                          *IF
     C           WN0001    DIV  WAFENB    YL0031           TH Avg Live Wgt
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0031           TH Avg Live Wgt
     C                     END                             *FI
      * Compute: Live wgt f/adj
      * LCL.TH Live Wgt =
      *    *COMPUTE (x1 + (x2 * (x3 + x4)))
      * x1    : LCL.TH Adj Live Wgt
      * +     : PGM.*Synon (17,7) work field
      * x2    : LCL.TH Avg Live Wgt
      * *     : PGM.*Synon (17,7) work field *
      * x3    : DB1.TH Yard Deads
      * +     : PGM.*Synon (17,7) work field
      * x4    : DB1.TH Head Condemned
     C           WAFCNB    ADD  WAFDNB    W0WD02           *Synon (17,7) w
     C           YL0031    MULT W0WD02    W0WD01           *Synon (17,7) w
     C           YL0030    ADD  W0WD01    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0032           TH Live Wgt
      * Actual Yield
      * CASE: LCL.TH Live Wgt is Greater then Zero
     C           YL0032    IFGT 0                          *IF
      * Compute: Actual Yield %
      * LCL.TH Actual Yield % =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : DB1.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *
      * x2    : LCL.TH Live Wgt
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           WAE0NB    DIV  YL0032    W0WB01           *Synon (15,5) w
     C           W0WB01    MULT 100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0033           TH Actual Yield
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0033           TH Actual Yield
     C                     END                             *FI
      * Adj Actual Yield
      * CASE: LCL.TH Adj Live Wgt is Greater then Zero
     C           YL0030    IFGT 0                          *IF
      * Compute: Adj Actual Yield
      * LCL.TH Adj Actual Yield % =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : DB1.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *
      * x2    : LCL.TH Adj Live Wgt
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           WAE0NB    DIV  YL0030    W0WB01           *Synon (15,5) w
     C           W0WB01    MULT 100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0034           TH Adj Actual Y
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0034           TH Adj Actual Y
     C                     END                             *FI
     C           YL0033    SUB  WAAVPC    YL0035           TH Yield Differ
     C                     ELSE
      * CASE: *OTHERWISE
      * move db1 to wrk for update
     C                     Z-ADDWACYNB    YL0032           TH Live Wgt
     C                     Z-ADDWAF7NB    YL0031           TH Avg Live Wgt
     C                     Z-ADDWALRNB    YL0030           TH Adj Live Wgt
     C                     Z-ADDWAAWPC    YL0033           TH Actual Yield
     C                     Z-ADDWACWPC    YL0034           TH Adj Actual Y
     C                     Z-ADDWAA8PC    YL0035           TH Yield Differ
     C                     END                             *FI
      * Chg Prcs Cd/Cal Net   CH - Tattoo Header  * 
     C                     EXSR SICHRC
      * Check for HeldOvers Completed, If so upd Completed Date, INT avg
      * CASE: DB1.TH Held Over Record is Yes
     C           WAE1ST    IFEQ 'Y'                        *IF
     C                     Z-ADDWAB0DT    YL0036           TH Held/Ovr Com
      * UPD Held/Ovrs Cmpl Dte RT - Tattoo Header  * 
     C                     EXSR SJRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0036           TH Held/Ovr Com
     C                     END                             *FI
      * If tattoo is balance, all should be except resale send balance co
      * CASE: DB1.TH Kill Balancing Sts is Balance
     C           WADWST    IFEQ 'B'                        *IF
      * Crt Tattoo Action Comm XF - Tattoo Header Comment  * 
     C                     CALL 'PKV4XFR'              90  Crt Tattoo Acti
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAHMNB    WQ0029  30       BOH Company Num
     C                     PARM WABNNB    WQ0030  70       BOH Buy Order N
     C                     PARM WABONB    WQ0031  50       BOL Load Number
     C                     PARM WACVNB    WQ0032  50       TH Tattoo Numbe
     C                     PARM WAB0DT    WQ0033  70       TH Kill Date
     C                     PARM *ZERO     WQ0034  50       TH Head Receive
     C                     PARM *ZERO     WQ0035  50       TH Held Over
     C                     PARM *ZERO     WQ0036  80       TH AP Voucher/D
     C                     PARM *ZERO     WQ0037  70       TH Voucher Paym
     C                     PARM 'TB'      WQ0038  2        Tattoo Action U
     C                     PARM *BLANK    WQ0039  5        Tattoo Nbr Alph
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKV4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Upd Company Kill Recap RT - Company Kill Recap  * 
     C                     EXSR SLRVGN
     C                     END                             *FI
     C           KRSSA     READE@A1CPTB                  90*
     C                     ENDDO
      * USER: Exit processing
      * Crt Co Exp Rate Data  RT - Company Expense  * 
     C                     EXSR SORVGN
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Hog Class         RT - Hog Classification  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBBECD           HC Class Code
      * Setup key
     C                     MOVELWABECD    WBBECD           HC Class Code
      * Establish starting position
     C           KRSSB     CHAIN@A8REDA              90    *
      * Data record not found
     C   90                MOVEL'PRK0075' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBBDTX    WUBDTX           HC Description
     C                     MOVELWBBXST    WUBXST           HC Defect Requi
     C                     MOVELWBBYST    WUBYST           HC Price Requir
     C                     MOVELWBBITX    WUBITX           HC Resolution
     C                     MOVELWBB0ST    WUB0ST           HC Qualificatio
     C                     MOVELWBFBST    WUFBST           HC Class Type
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * PayEdt Create Crc Dtl RT - Eval Trans  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0004 112       Live Weight 11.
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Modifications and Comments
     C                     EXSR UDSUBR                     Modifications a
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQSC01           BOH Company Num
     C           *LIKE     DEFN WCBNNB    WQSC02           BOH Buy Order N
     C           *LIKE     DEFN WCBONB    WQSC03           BOL Load Number
     C           *LIKE     DEFN WCCVNB    WQSC04           TH Tattoo Numbe
     C           *LIKE     DEFN WCB0DT    WQSC05           TH Kill Date
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           BOH Company Num
     C                     KFLD           WQSC02           BOH Buy Order N
     C                     KFLD           WQSC03           BOL Load Number
     C                     KFLD           WQSC04           TH Tattoo Numbe
     C                     KFLD           WQSC05           TH Kill Date
      * Setup key
     C                     Z-ADDWAHMNB    WQSC01           BOH Company Num
     C                     Z-ADDWABNNB    WQSC02           BOH Buy Order N
     C                     Z-ADDWABONB    WQSC03           BOL Load Number
     C                     Z-ADDWACVNB    WQSC04           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WQSC05           TH Kill Date
      * Establish starting position
     C           KRSSC     SETLL@BVCPL7                    *
     C           KRSSC     READE@BVCPL7                  90*
      * Data record not found
     C   90                MOVEL'PRK0121' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.RS Record Status is Active
     C           WCAJST    IFEQ 'A'                        *IF
     C                     ADD  1         YL0003           CD Carcass Numb
      * Producer/Farm Site
      * CASE: PAR.TH Source Type is External
     C           WAKAST    IFEQ 'E'                        *IF
     C                     MOVELWAAECD    YL0009           PL Location Cod
     C                     ELSE
      * CASE: PAR.TH Source Type is Internal
     C           WAKAST    IFEQ 'I'                        *IF
     C                     Z-ADDYL0002    YL0010           Farm Site 6.0 U
     C                     MOVEL*BLANK    YL0009           PL Location Cod
     C                     MOVELYL0010    YL0009           PL Location Cod
     C                     END                             *FI
     C                     END                             *FI
      * Crt Carcass Detail    Rt - Carcass Detail  * 
     C                     EXSR SDRVGN
      * New 6/4/03
      * CASE: DB1.ET Broken Back Sts is Yes
     C           WCVHST    IFEQ '1'                        *IF
     C                     ADD  1         YL0006           TH Broken Back
     C                     END                             *FI
      * PK0418 3/19/02 Do this for External, so dont check Internal par.t
      *   If market, subject calc the live wgt to update the TH
      * 05/28/04 SLM HPEBAL - Balancing with Producer's
      *   The following is being change, to work with External
      *   or Internal
      * Recalc   processing
      * CASE:
      *  - c2 AND c3 AND c4
      *   |- c2    : PAR.TH Hog Class Type is Not Resale
      *   |- c3    : PAR.TH Recalc Live Wgt is Greater than 0
      *   |- c4    : DB1.ET Record Add/Del Sts is Add/Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WALLST    IFEQ 'M'                        *IF
     C           WALLST    OREQ 'S'
     C           YL0007    IFGT 0                          *IF
     C           WCEHST    IFEQ 'A'                        *IF
     C           WCEHST    OREQ *BLANK
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 05/28/04 SLM HPEBAL - Test on how to calculate live weight
      *                       * out org code
      * E9904 JJH 08/26/17 - Add logic to prevent Divide by zero for the
      *   TH Recalc Live Wgt Yld
      * External/Internal Live Wgt Total 11.1  Divide by zero not protect
      * CASE: PAR.TH Source Type is External
     C           WAKAST    IFEQ 'E'                        *IF
      * Live wgt total 11.1   USR
      * WRK.Live wgt total 11.1   USR =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : DB1.ET Hot Wgt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Recalc Live Wgt Yld
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0008    DIV  100       W0WB01    H      *Synon (15,5) w
     C           WCAMPC    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUZ7NB           Live wgt total
     C                     ELSE
      * CASE: *OTHERWISE
      * Internal live wgt
      * Clc Live Weight       XF - STR Order Management Sys  * 
     C                     CALL 'PDO1XFR'              90  Clc Live Weight
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAHMNB    WQ0024  30       CC Company Numb
     C                     PARM WCAMPC    WQ0025 112       Hot Weight 11.2
     C           WUNNND    PARM *ZERO     WQ0026 112       Live Weight 11.
     C           WUZ7NB    PARM *ZERO     WQ0027 111       Live wgt total
     C           WUNNND    PARM *ZERO     WQ0028  50       Live Weight 5.0
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDO1XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ADD  WUZ7NB    WN0001           Live wgt total
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSC     READE@BVCPL7                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Crt Carcass Detail    Rt - Carcass Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0005  2        TB Trim Locatio
     C                     MOVEL*BLANK    WN0006  2        TB Extent
     C                     Z-ADD*ZERO     WN0007  74       Loss Percent
     C                     Z-ADD*ZERO     WN0008  74       Loss Percent
     C                     Z-ADD*ZERO     WN0009  60       LTN Record Numb
     C                     Z-ADD*ZERO     WN0010  71       LTN Wgt
     C                     MOVEL*BLANK    WN0011  2        LTN Extent
     C                     MOVEL*BLANK    WN0012  2        LTN Trim Locati
     C                     Z-ADD*ZERO     WN0013  71       LTA Wgt
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDHMNB           BOH Company Num
     C                     KFLD           WDBNNB           BOH Buy Order N
     C                     KFLD           WDBONB           BOL Load Number
     C                     KFLD           WDCVNB           TH Tattoo Numbe
     C                     KFLD           WDB0DT           TH Kill Date
     C                     KFLD           WDLGNB           CD Scale Sequen
     C                     KFLD           WDEUNB           CD Carcass Numb
     C                     KFLD           WDLHNB           CD Carcass Numb
      * Setup key
     C                     Z-ADDWCHMNB    WDHMNB           BOH Company Num
     C                     Z-ADDWCBNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDWCBONB    WDBONB           BOL Load Number
     C                     Z-ADDWCCVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADDWCB0DT    WDB0DT           TH Kill Date
     C                     Z-ADDWCFJNB    WDLGNB           CD Scale Sequen
     C                     Z-ADDYL0003    WDEUNB           CD Carcass Numb
     C                     Z-ADD*ZERO     WDLHNB           CD Carcass Numb
      * Establish starting position
     C           KRSSD     CHAIN@B1CPG7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0138' W0RTN   7
      * USER: Processing if Data record not found
      * 9/20/02  RMC  -- Calc 2 dec. backfat and loin eye
      *   and accum weighted for TH Avg Backf & Loin eye calc
      * CLC MM to Inch -2 dec XF - Eval Trans  * 
     C                     CALL 'PKMMINC2'             90  CLC MM to Inch
     C                     PARM *BLANK    W0RTN   7
     C           YL0023    PARM YL0023    WQ0016  52       CD Backfat Inch
     C           YL0024    PARM YL0024    WQ0017  52       CD Loin Eye Inc
     C                     PARM WCX8NB    WQ0018  31       CD Backfat Thic
     C                     PARM WCFVPC    WQ0019  31       CD Loin-Eye Dep
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKMMINC2'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Accum: Backfat * wgt
      * PAR.Backfat * Wgt USR =
      *    *COMPUTE (x1 * x2 + x3)
      * x1    : LCL.CD Backfat Inch - 2 dec
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.CD Carcass/Hot Weight
      * +     : PGM.*Synon (15,2) work field
      * x3    : PAR.Backfat * Wgt USR
     C           YL0023    MULT WCAMPC    W0WA01           *Synon (15,2) w
     C           W0WA01    ADD  YL0004    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0004           Backfat * Wgt U
      * Accum: Loin eye * wgt
      * PAR.Loin-Eye * Wgt USR =
      *    *COMPUTE (x1 * x2 + x3)
      * x1    : LCL.CD Loin Eye Inch - 2 dec
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.CD Carcass/Hot Weight
      * +     : PGM.*Synon (15,2) work field
      * x3    : PAR.Loin-Eye * Wgt USR
     C           YL0024    MULT WCAMPC    W0WA01           *Synon (15,2) w
     C           W0WA01    ADD  YL0005    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0005           Loin-Eye * Wgt
      * Crt Carcass Detail    CR - Carcass Detail  * 
     C                     EXSR SECRRC
      * PK0071 Fat-O-Meter
      * CASE: PAR.CD Trim Area is *Blank
     C           WCDIST    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Loss Percent       RT - Trim Button  * 
     C                     EXSR SFRVGN
     C           WN0007    DIV  100       WN0008           Loss Percent
     C           WCAMPC    MULT WN0008    WN0013           LTA Wgt
      * Rtv Loss Trans Next   RT - Loss Trans  * 
     C                     EXSR SGRVGN
      * Crt Loss Transaction  CR - Loss Trans  * 
     C                     EXSR SHCRRC
     C                     END                             *FI
     C                     GOTO SDEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECRRC    BEGSR
      *================================================================
      * Crt Carcass Detail    CR - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1CPG6
     C                     Z-ADDWCHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWCBNNB    WEBNNB           BOH Buy Order N
     C                     Z-ADDWCBONB    WEBONB           BOL Load Number
     C                     Z-ADDWCCVNB    WECVNB           TH Tattoo Numbe
     C                     Z-ADDWCB0DT    WEB0DT           TH Kill Date
     C                     Z-ADDWCFJNB    WELGNB           CD Scale Sequen
     C                     Z-ADDYL0003    WEEUNB           CD Carcass Numb
     C                     Z-ADD*ZERO     WELHNB           CD Carcass Numb
     C                     MOVELWCEHST    WEINST           CD Record Add/D
     C                     Z-ADDYL0011    WEBEPR           CD Sort Loss
     C                     Z-ADDYL0012    WEASPC           CD STD Yield
     C                     Z-ADDWCAMPC    WEEWNB           CD Carcass/Hot
     C                     Z-ADDYL0013    WEB4PR           CD Base Carcass
     C                     Z-ADDYL0014    WEEYNB           CD Crc Value Pe
     C                     Z-ADDYL0015    WEB1PR           CD Base Carc Va
     C                     Z-ADDYL0016    WEAVPR           CD Crc Value $
     C                     Z-ADDWCAKPC    WEAUPC           CD Lean Percent
     C                     Z-ADDYL0017    WEAWPR           CD Lean Premium
     C                     Z-ADDYL0018    WEAXPR           CD Lean Premium
     C                     Z-ADDYL0019    WEEZNB           CD Gross Value
     C                     Z-ADDYL0020    WEAYPR           CD Gross Value
     C                     Z-ADDWCA9DT    WEBBDT           CD Kill Date
     C                     Z-ADDWCAOTM    WEAKTM           CD Kill Time
     C                     MOVELWCEAST    WEIQST           CD Shift
     C                     MOVELYL0021    WEEFST           CD Carcass Acti
     C                     Z-ADDWCAIPC    WEH6NB           CD Backfat Thic
     C                     Z-ADDWCAJPC    WEBEPC           CD Loin-Eye Dep
     C                     Z-ADDWCALPC    WEGCST           CD Light Reflec
     C                     MOVELWCDIST    WEGDST           CD Trim Area
     C                     MOVELWCFYST    WEGEST           CD Carcass Sex
     C                     Z-ADDYL0022    WEBHPC           CD FFLI
     C                     MOVELWCG1ST    WEIOST           CD Record Creat
     C                     MOVELWCH4ST    WEIPST           CD Record Creat
     C                     Z-ADDWCLKNB    WELTNB           CD LOT
     C                     MOVELWCJLST    WEJNST           CD User Error O
     C                     Z-ADDWCX8NB    WEX4NB           CD Backfat Thic
     C                     Z-ADDWCFVPC    WEFNPC           CD Loin-Eye Dep
     C                     Z-ADDWCFWPC    WEFOPC           CD Light Reflec
     C                     Z-ADDWCFXPC    WEFPPC           CD Lean Percent
     C                     MOVELWAKAST    WEK2ST           CD Source Type
     C                     MOVELWAJ9ST    WEK3ST           CD Payment Type
     C                     Z-ADDWUJWPR    WEJWPR           CD CA Sort Loss
     C                     Z-ADDWUF5PC    WEF5PC           CD CA Std Yield
     C                     Z-ADDWUJXPR    WEJXPR           CD CA Base Carc
     C                     Z-ADDWUJYPR    WEJYPR           CD CA Crc Value
     C                     Z-ADDWUJZPR    WEJZPR           CD CA Base Carc
     C                     Z-ADDWUJ0PR    WEJ0PR           CD CA Crc Value
     C                     Z-ADDWUJ1PR    WEJ1PR           CD CA Lean Prem
     C                     Z-ADDWUJ2PR    WEJ2PR           CD CA Lean Prem
     C                     Z-ADDWUJ3PR    WEJ3PR           CD CA Gross Val
     C                     Z-ADDWUJ4PR    WEJ4PR           CD CA Gross Val
     C                     MOVELWCUUST    WEUTST           CD Adjust/Add T
     C                     MOVELYL0009    WEHVCD           CD Producer Loc
     C                     Z-ADDYL0024    WEDKJR           CD Loin Eye Inc
     C                     Z-ADDYL0023    WEITJF           CD Backfat Inch
     C                     Z-ADD*ZERO     WEIJGR           CD Meat Value F
     C                     Z-ADD*ZERO     WEORJE           CD Lean Prem/Di
     C                     Z-ADD*ZERO     WEOTJR           CD Fixed Cost F
     C                     Z-ADD*ZERO     WEPEIR           CD MPR Sort Los
     C                     Z-ADD*ZERO     WEIEUF           CD Meat Value F
     C                     Z-ADD*ZERO     WEORUE           CD Fixed Cost F
     C                     Z-ADD*ZERO     WEIUTR           CD Gross Before
     C                     Z-ADD*ZERO     WEIJRR           CD Gross Before
     C                     MOVELWCVHST    WEVCST           CD Broken Back
     C                     MOVELWUVDST    WEVDST           CD Adjust/Add S
     C                     MOVELWUVEST    WEVEST           CD Unused Sts 3
     C                     MOVELWUVFST    WEVFST           CD Unused Sts 4
     C                     MOVELWUVGST    WEVGST           CD Unused Sts 5
     C                     MOVELWAABCD    WEABCD           PD Producer Cod
     C                     MOVELWALKST    WEAACD           SR Source Code
     C                     MOVELWUAAVN    WEAAVN           RS User Changed
     C                     Z-ADDWUAADT    WEAADT           RS Date Changed
     C                     Z-ADDWUAMTM    WEAMTM           RS Time Changed
     C                     MOVELWUAJST    WEAJST           RS Record Statu
     C                     MOVELWUAHVN    WEAHVN           RS Job
     C                     MOVELWUAGVN    WEAGVN           RS Program
     C                     MOVELWUABVN    WEABVN           RS User Added
     C                     Z-ADDWUABDT    WEABDT           RS Date Added
     C                     Z-ADDWUABTM    WEABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       WEAJST           RS Record Statu
     C                     MOVEL##USR     WEABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WEABDT    PARM *ZERO     WQ0020  70       *DATE
     C           WEABTM    PARM *ZERO     WQ0021  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     WEAGVN           RS Program
     C                     MOVEL##JOB     WEAHVN           RS Job
     C           KLCRSE    KLIST
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
     C                     KFLD           WEBONB           BOL Load Number
     C                     KFLD           WECVNB           TH Tattoo Numbe
     C                     KFLD           WEB0DT           TH Kill Date
     C                     KFLD           WELGNB           CD Scale Sequen
     C                     KFLD           WEEUNB           CD Carcass Numb
     C                     KFLD           WELHNB           CD Carcass Numb
      * Check for duplicate primary key
     C           KLCRSE    SETLL@B1CPG6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0139' W0RTN   7
      * Send message 'Carcass Detail         EX'
     C                     MOVEL'PRK0139' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C                     WRITE@B1CPG6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Loss Percent       RT - Trim Button  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WFHONB           CC Company Numb
     C                     KFLD           WFTEST           TB Trim Area
      * Setup key
     C                     Z-ADDWCHMNB    WFHONB           CC Company Numb
     C                     MOVELWCDIST    WFTEST           TB Trim Area
      * Establish starting position
     C           KRSSF     CHAIN@EKCPB4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0870' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0005           TB Trim Locatio
     C                     MOVEL*BLANK    WN0006           TB Extent
     C                     Z-ADD*ZERO     WN0007           Loss Percent
     C                     GOTO SFEXIT                     *QUIT
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFTFST    WN0005           TB Trim Locatio
     C                     MOVELWFTGST    WN0006           TB Extent
     C                     Z-ADDWFGQPC    WN0007           Loss Percent
     C                     GOTO SFEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Loss Trans Next   RT - Loss Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGHUNB    WQSG01           LTN Company Num
     C           *LIKE     DEFN WGA7DT    WQSG02           LTN Kill Date
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           LTN Company Num
     C                     KFLD           WQSG02           LTN Kill Date
      * Setup key
     C                     Z-ADDWCHMNB    WQSG01           LTN Company Num
     C                     Z-ADDWCB0DT    WQSG02           LTN Kill Date
      * Establish starting position
     C           KRSSG     SETLLZBSCPNG                    *
     C           KRSSG     READEZBSCPNG                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0115' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WN0009           LTN Record Numb
     C                     GOTO SGEXIT                     *QUIT
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.LTN Record Number is Entry Allowed
     C           WGFHNB    IFGE 000001                     *IF
     C           WGFHNB    ANDLE699999
     C           WGFHNB    ADD  1         WN0009           LTN Record Numb
     C                     GOTO SGEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSG     READEZBSCPNG                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCRRC    BEGSR
      *================================================================
      * Crt Loss Transaction  CR - Loss Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BSCPFS
     C                     Z-ADDWCHMNB    WHHUNB           LTN Company Num
     C                     Z-ADDWCB0DT    WHA7DT           LTN Kill Date
     C                     Z-ADDWN0009    WHFHNB           LTN Record Numb
     C                     Z-ADDWCCVNB    WHFFNB           LTN Tattoo Numb
     C                     MOVELWCEAST    WHEBST           LTN Shift
     C                     Z-ADDWN0013    WHDSNB           LTN Wgt
     C                     MOVELWN0006    WHS3NB           LTN Extent
     C                     MOVELWN0005    WHS4NB           LTN Trim Locati
     C                     MOVEL'B'       WHD1ST           LTN Error Sts
     C                     MOVEL'P'       WHH5ST           LTN Record Crea
     C                     MOVEL*BLANK    WHJMST           LTN User Error
     C                     MOVELWAKAST    WHSMST           LTN Source Type
     C                     Z-ADD03        WHBWCD           LT Type Code
     C                     Z-ADD*ZERO     WHBYCD           LR Reason Code
     C                     Z-ADDWCHMNB    WHHMNB           BOH Company Num
     C                     Z-ADDWCBNNB    WHBNNB           BOH Buy Order N
     C                     Z-ADDWCBONB    WHBONB           BOL Load Number
     C                     Z-ADDWCCVNB    WHCVNB           TH Tattoo Numbe
     C                     Z-ADDWCB0DT    WHB0DT           TH Kill Date
     C                     MOVELWUAAVN    WHAAVN           RS User Changed
     C                     Z-ADDWUAADT    WHAADT           RS Date Changed
     C                     Z-ADDWUAMTM    WHAMTM           RS Time Changed
     C                     MOVELWUAJST    WHAJST           RS Record Statu
     C                     MOVELWUAHVN    WHAHVN           RS Job
     C                     MOVELWUAGVN    WHAGVN           RS Program
     C                     MOVELWUABVN    WHABVN           RS User Added
     C                     Z-ADDWUABDT    WHABDT           RS Date Added
     C                     Z-ADDWUABTM    WHABTM           RS Time Added
     C                     Z-ADD##JDT     WHB8DT           RU Date
     C                     Z-ADD##JTM     WHAOTM           RU Time
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       WHAJST           RS Record Statu
     C                     MOVEL##USR     WHABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WHABDT    PARM *ZERO     WQ0022  70       *DATE
     C           WHABTM    PARM *ZERO     WQ0023  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     WHAGVN           RS Program
     C                     MOVEL##JOB     WHAHVN           RS Job
     C           KLCRSH    KLIST
     C                     KFLD           WHHUNB           LTN Company Num
     C                     KFLD           WHA7DT           LTN Kill Date
     C                     KFLD           WHFHNB           LTN Record Numb
      * Check for duplicate primary key
     C           KLCRSH    SETLL@BSCPFS                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0116' W0RTN   7
      * Send message 'Loss Trans             EX'
     C                     MOVEL'PRK0116' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C                     WRITE@BSCPFS                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICHRC    BEGSR
      *================================================================
      * Chg Prcs Cd/Cal Net   CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0014  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0015 10        TH Group Refere
     C                     MOVEL*BLANK    WN0016  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0017  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0018  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0019  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0020  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0021  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0022  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0023  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0024  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0025  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0026  50       TH Held Over
     C                     Z-ADD*ZERO     WN0027  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0028  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0029  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0030  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0031  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0032  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0033  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0034  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0035  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0036  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0037  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0038  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0039  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0040  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0041  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0042  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0043  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0044  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0045  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0046  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0047  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0048  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0049  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0050  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0051  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0052  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0053  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0054  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0055  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0056  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0057  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0058  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0059  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0060  1        TH Header Error
     C                     MOVEL*BLANK    WN0061  1        TH Detail Error
     C                     MOVEL*BLANK    WN0062  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0063  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0064  80       TH Commission A
     C                     Z-ADD*ZERO     WN0065  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0066  1        TH User Error O
     C                     MOVEL*BLANK    WN0067  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0068  1        TH Sex
     C                     Z-ADD*ZERO     WN0069  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0070  70       TH Commission P
     C                     Z-ADD*ZERO     WN0071  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0072  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0073  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0074  31       TH FFLI
     C                     Z-ADD*ZERO     WN0075  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0076  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0077  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0078  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0079  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0080  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0081  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0082  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0083  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0084  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0085  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0086  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0087  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0088  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0089  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0090  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0091  1        TH Source Type
     C                     MOVEL*BLANK    WN0092  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0093  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0094  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0095  3        TH Source Code
     C                     MOVEL*BLANK    WN0096  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0097  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0098  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0099  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0100  3        TH State
     C                     MOVEL*BLANK    WN0101  3        TH Unused Code
     C                     MOVEL*BLANK    WN0102  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0103  1        TH Commission S
     C                     MOVEL*BLANK    WN0104  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0105  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0106  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0107  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0108  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0109  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0110  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0111  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0112  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0113  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0114  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0115  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0116  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0117  3        TH PHA Average
     C                     MOVEL*BLANK    WN0118  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0119  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0120  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0121  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0122  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0123  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0124  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0125  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0126  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0127  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0128  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0129 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0130 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0131 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0132 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0133  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0134  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0135  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0136  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0137  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0138  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0139  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0140  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0141  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0142  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0143  70       TH Unused Date
     C                     MOVEL*BLANK    WN0144  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0145  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0146  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0147  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0148  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0149  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0150  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0151  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0152  6        DF Defect Code
     C                     MOVEL*BLANK    WN0153  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0154  6        PL Location Cod
     C                     MOVEL*BLANK    WN0155  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0156  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0157  3        HC Class Code
     C                     MOVEL*BLANK    WN0158 10        RS User Changed
     C                     Z-ADD*ZERO     WN0159  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0160  60       RS Time Changed
     C                     MOVEL*BLANK    WN0161  1        RS Record Statu
     C                     MOVEL*BLANK    WN0162 10        RS Job
     C                     MOVEL*BLANK    WN0163 10        RS Program
     C                     MOVEL*BLANK    WN0164 10        RS User Added
     C                     Z-ADD*ZERO     WN0165  70       RS Date Added
     C                     Z-ADD*ZERO     WN0166  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWAHMNB    WIHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WIBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WIBONB           BOL Load Number
     C                     Z-ADDWACVNB    WICVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WIB0DT           TH Kill Date
      *
     C           KLCHSI    KLIST
     C                     KFLD           WIHMNB           BOH Company Num
     C                     KFLD           WIBNNB           BOH Buy Order N
     C                     KFLD           WIBONB           BOL Load Number
     C                     KFLD           WICVNB           TH Tattoo Numbe
     C                     KFLD           WIB0DT           TH Kill Date
     C           KLCHSI    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YARDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADDYL0008    WIAIPR           TH Recalc Live
     C                     Z-ADDYL0032    WICYNB           TH Live Wgt
     C                     Z-ADDYL0030    WILRNB           TH Adj Live Wgt
     C                     Z-ADDYL0031    WIF7NB           TH Avg Live Wgt
     C                     Z-ADDYL0033    WIAWPC           TH Actual Yield
     C                     Z-ADDYL0034    WICWPC           TH Adj Actual Y
     C                     Z-ADDYL0035    WIA8PC           TH Yield Differ
     C                     Z-ADDYL0007    WIA7PC           TH Recalc Live
     C                     MOVELYL0028    WIJWST    P      TH Calc Net Sts
     C                     Z-ADDYL0029    WITAPR           TH VC Gross Val
     C                     Z-ADDYL0006    WIKRIF           TH Broken Back
     C                     Z-ADDYL0026    WIMVNF           TH Avg Loin Eye
     C                     Z-ADDYL0025    WIMCNF           TH Avg Backfat
     C                     MOVELYL0027    WICSCD    P      THP Process Cod
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WIAAVN           RS User Changed
     C                     Z-ADD##JDT     WIAADT           RS Date Changed
     C                     Z-ADD##JTM     WIAMTM           RS Time Changed
     C                     MOVEL##JOB     WIAHVN           RS Job
     C                     MOVEL##PGM     WIAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * UPD Held/Ovrs Cmpl Dte RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJHMNB    WQSJ01           BOH Company Num
     C           *LIKE     DEFN WJBNNB    WQSJ02           BOH Buy Order N
     C           *LIKE     DEFN WJBONB    WQSJ03           BOL Load Number
     C           *LIKE     DEFN WJCVNB    WQSJ04           TH Tattoo Numbe
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           BOH Company Num
     C                     KFLD           WQSJ02           BOH Buy Order N
     C                     KFLD           WQSJ03           BOL Load Number
     C                     KFLD           WQSJ04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWAHMNB    WQSJ01           BOH Company Num
     C                     Z-ADDWABNNB    WQSJ02           BOH Buy Order N
     C                     Z-ADDWABONB    WQSJ03           BOL Load Number
     C                     Z-ADDWACVNB    WQSJ04           TH Tattoo Numbe
      * Establish starting position
     C           KRSSJ     SETLL@A1CPC4                    *
     C           KRSSJ     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * If Internal & avg live wgt is 0, then update avg live wgt for hps
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.TH Source Type is Internal
      *   |- c2    : DB1.TH Avg Live Wgt is EQ Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WJKAST    IFEQ 'I'                        *IF
     C           WJF7NB    IFEQ 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDYL0031    WUF7NB           TH Avg Live Wgt
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWJF7NB    WUF7NB           TH Avg Live Wgt
     C                     END                             *FI
      * Chg Held/Ovr Compl Dte CH - Tattoo Header  * 
     C                     EXSR SKCHRC
     C           KRSSJ     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCHRC    BEGSR
      *================================================================
      * Chg Held/Ovr Compl Dte CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0167  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0168 10        TH Group Refere
     C                     MOVEL*BLANK    WN0169  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0170  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0171  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0172  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0173  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0174  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0175  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0176  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0177  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0178  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0179  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0180  50       TH Held Over
     C                     Z-ADD*ZERO     WN0181  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0182  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0183  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0184  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0185  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0186  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0187  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0188  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0189  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0190  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0191  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0192  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0193  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0194  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0195  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0196  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0197  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0198  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0199  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0200  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0201  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0202  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0203  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0204  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0205  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0206  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0207  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0208  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0209  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0210  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0211  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0212  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0213  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0214  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0215  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0216  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0217  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0218  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0219  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0220  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0221  1        TH Header Error
     C                     MOVEL*BLANK    WN0222  1        TH Detail Error
     C                     MOVEL*BLANK    WN0223  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0224  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0225  80       TH Commission A
     C                     Z-ADD*ZERO     WN0226  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0227  1        TH User Error O
     C                     MOVEL*BLANK    WN0228  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0229  1        TH Sex
     C                     Z-ADD*ZERO     WN0230  70       TH Commission P
     C                     Z-ADD*ZERO     WN0231  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0232  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0233  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0234  31       TH FFLI
     C                     Z-ADD*ZERO     WN0235  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0236  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0237  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0238  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0239  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0240  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0241  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0242  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0243  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0244  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0245  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0246  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0247  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0248  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0249  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0250  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0251  1        TH Source Type
     C                     MOVEL*BLANK    WN0252  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0253  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0254  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0255  3        TH Source Code
     C                     MOVEL*BLANK    WN0256  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0257  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0258  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0259  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0260  3        TH State
     C                     MOVEL*BLANK    WN0261  3        TH Unused Code
     C                     MOVEL*BLANK    WN0262  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0263  1        TH Commission S
     C                     MOVEL*BLANK    WN0264  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0265  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0266  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0267  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0268  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0269  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0270  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0271  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0272  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0273  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0274  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0275  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0276  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0277  3        TH PHA Average
     C                     MOVEL*BLANK    WN0278  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0279  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0280  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0281  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0282  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0283  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0284  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0285  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0286  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0287  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0288  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0289  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0290  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0291 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0292 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0293 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0294 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0295  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0296  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0297  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0298  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0299  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0300  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0301  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0302  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0303  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0304  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0305  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0306  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0307  70       TH Unused Date
     C                     MOVEL*BLANK    WN0308  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0309  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0310  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0311  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0312  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0313  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0314  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0315  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0316  6        DF Defect Code
     C                     MOVEL*BLANK    WN0317  6        THP Process Cod
     C                     MOVEL*BLANK    WN0318  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0319  6        PL Location Cod
     C                     MOVEL*BLANK    WN0320  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0321  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0322  3        HC Class Code
     C                     MOVEL*BLANK    WN0323 10        RS User Changed
     C                     Z-ADD*ZERO     WN0324  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0325  60       RS Time Changed
     C                     MOVEL*BLANK    WN0326  1        RS Record Statu
     C                     MOVEL*BLANK    WN0327 10        RS Job
     C                     MOVEL*BLANK    WN0328 10        RS Program
     C                     MOVEL*BLANK    WN0329 10        RS User Added
     C                     Z-ADD*ZERO     WN0330  70       RS Date Added
     C                     Z-ADD*ZERO     WN0331  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWJHMNB    WIHMNB           BOH Company Num
     C                     Z-ADDWJBNNB    WIBNNB           BOH Buy Order N
     C                     Z-ADDWJBONB    WIBONB           BOL Load Number
     C                     Z-ADDWJCVNB    WICVNB           TH Tattoo Numbe
     C                     Z-ADDWJB0DT    WIB0DT           TH Kill Date
      *
     C           KLCHSK    KLIST
     C                     KFLD           WIHMNB           BOH Company Num
     C                     KFLD           WIBNNB           BOH Buy Order N
     C                     KFLD           WIBONB           BOL Load Number
     C                     KFLD           WICVNB           TH Tattoo Numbe
     C                     KFLD           WIB0DT           TH Kill Date
     C           KLCHSK    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YBRDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADDWUF7NB    WIF7NB           TH Avg Live Wgt
     C                     Z-ADDYL0036    WIBSDT           TH Held/Ovr Com
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WIAAVN           RS User Changed
     C                     Z-ADD##JDT     WIAADT           RS Date Changed
     C                     Z-ADD##JTM     WIAMTM           RS Time Changed
     C                     MOVEL##JOB     WIAHVN           RS Job
     C                     MOVEL##PGM     WIAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Upd Company Kill Recap RT - Company Kill Recap  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUTBNB           CKR Head Receiv
     C                     Z-ADD*ZERO     WUTDNB           CKR Live Weight
     C                     Z-ADD*ZERO     WUTCNB           CKR Dead On Arr
     C                     Z-ADD*ZERO     WUTENB           CKR Head Resale
     C                     Z-ADD*ZERO     WUTFNB           CKR Yard Deads
     C                     Z-ADD*ZERO     WUTKNB           CKR Held Over
     C                     Z-ADD*ZERO     WUTGNB           CKR Head Killed
     C                     Z-ADD*ZERO     WUTINB           CKR Hot Weight
     C                     Z-ADD*ZERO     WUTHNB           CKR Head Comdem
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WKHONB           CC Company Numb
     C                     KFLD           WKCRDT           CKR Kill Date
      * Setup key
     C                     Z-ADDWAHMNB    WKHONB           CC Company Numb
     C                     Z-ADDWAB0DT    WKCRDT           CKR Kill Date
      * Establish starting position
     C           KRSSL     CHAIN@DCCPSF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0531' W0RTN   7
      * USER: Processing if Data record not found
      * Accumulate from tattoo header, to company kill recap
     C                     Z-ADDWACWNB    WUTBNB           CKR Head Receiv
     C                     Z-ADDWACYNB    WUTDNB           CKR Live Weight
     C                     Z-ADDWACXNB    WUTCNB           CKR Dead On Arr
      * CASE: PAR.TH Hog Class Type is Resale
     C           WALLST    IFEQ 'R'                        *IF
     C                     Z-ADDWACWNB    WUTENB           CKR Head Resale
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUTENB           CKR Head Resale
     C                     END                             *FI
     C                     Z-ADDWAFCNB    WUTFNB           CKR Yard Deads
     C                     Z-ADDWAH9NB    WUTKNB           CKR Held Over
     C                     Z-ADDWAFENB    WUTGNB           CKR Head Killed
     C                     Z-ADDWAE0NB    WUTINB           CKR Hot Weight
     C                     Z-ADDWAFDNB    WUTHNB           CKR Head Comdem
      * Create Company Kill Recap - Company Kill Recap  * 
     C                     EXSR SMCRRC
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Accumulate from tattoo header, to company kill recap
     C           WACWNB    ADD  WKTBNB    WUTBNB           CKR Head Receiv
     C           WACYNB    ADD  WKTDNB    WUTDNB           CKR Live Weight
     C           WACXNB    ADD  WKTCNB    WUTCNB           CKR Dead On Arr
      * CASE: PAR.TH Hog Class Type is Resale
     C           WALLST    IFEQ 'R'                        *IF
     C           WACWNB    ADD  WKTENB    WUTENB           CKR Head Resale
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  WKTENB    WUTENB           CKR Head Resale
     C                     END                             *FI
     C           WAFCNB    ADD  WKTFNB    WUTFNB           CKR Yard Deads
     C           WAH9NB    ADD  WKTKNB    WUTKNB           CKR Held Over
     C           WAFENB    ADD  WKTGNB    WUTGNB           CKR Head Killed
     C           WAE0NB    ADD  WKTINB    WUTINB           CKR Hot Weight
     C           WAFDNB    ADD  WKTHNB    WUTHNB           CKR Head Comdem
      * Change Company Kill Recap - Company Kill Recap  * 
     C                     EXSR SNCHRC
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCRRC    BEGSR
      *================================================================
      * Create Company Kill Recap - Company Kill Recap  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DCCPSE
     C                     Z-ADDWAHMNB    WLHONB           CC Company Numb
     C                     Z-ADDWAB0DT    WLCRDT           CKR Kill Date
     C                     Z-ADDWUTBNB    WLTBNB           CKR Head Receiv
     C                     Z-ADDWUTDNB    WLTDNB           CKR Live Weight
     C                     Z-ADDWUTCNB    WLTCNB           CKR Dead On Arr
     C                     Z-ADDWUTENB    WLTENB           CKR Head Resale
     C                     Z-ADDWUTFNB    WLTFNB           CKR Yard Deads
     C                     Z-ADDWUTKNB    WLTKNB           CKR Held Over
     C                     Z-ADDWUTGNB    WLTGNB           CKR Head Killed
     C                     Z-ADDWUTINB    WLTINB           CKR Hot Weight
     C                     Z-ADDWUTHNB    WLTHNB           CKR Head Comdem
     C                     MOVEL*BLANK    WLAAVN           RS User Changed
     C                     Z-ADD*ZERO     WLAADT           RS Date Changed
     C                     Z-ADD*ZERO     WLAMTM           RS Time Changed
     C                     MOVEL'A'       WLAJST           RS Record Statu
     C                     MOVEL##JOB     WLAHVN           RS Job
     C                     MOVEL##PGM     WLAGVN           RS Program
     C                     MOVEL##USR     WLABVN           RS User Added
     C                     Z-ADD##JDT     WLABDT           RS Date Added
     C                     Z-ADD##JTM     WLABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WLAJST           RS Record Statu
     C                     MOVEL##USR     WLABVN           RS User Added
     C                     Z-ADD##JDT     WLABDT           RS Date Added
     C                     Z-ADD##JTM     WLABTM           RS Time Added
     C                     MOVEL##PGM     WLAGVN           RS Program
     C                     MOVEL##JOB     WLAHVN           RS Job
     C           KLCRSM    KLIST
     C                     KFLD           WLHONB           CC Company Numb
     C                     KFLD           WLCRDT           CKR Kill Date
      * Check for duplicate primary key
     C           KLCRSM    SETLL@DCCPSE                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0532' W0RTN   7
      * Send message 'Company Kill Recap     EX'
     C                     MOVEL'PRK0532' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C                     WRITE@DCCPSE                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNCHRC    BEGSR
      *================================================================
      * Change Company Kill Recap - Company Kill Recap  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @DCCPSE
     C                     Z-ADDWAHMNB    WLHONB           CC Company Numb
     C                     Z-ADDWAB0DT    WLCRDT           CKR Kill Date
      *
     C           KLCHSN    KLIST
     C                     KFLD           WLHONB           CC Company Numb
     C                     KFLD           WLCRDT           CKR Kill Date
     C           KLCHSN    CHAIN@DCCPSE              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDCCPL0'MDACP
     C                     MOVEL'@DCCPSE' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKDC1    YCRDCS
      * USER: Processing after Data read
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WLAAVN           RS User Changed
     C                     Z-ADD##JDT     WLAADT           RS Date Changed
     C                     Z-ADD##JTM     WLAMTM           RS Time Changed
     C                     MOVEL##JOB     WLAHVN           RS Job
     C                     MOVEL##PGM     WLAGVN           RS Program
      * Move non-key fields to @DCCPSE
     C                     Z-ADDWUTBNB    WLTBNB           CKR Head Receiv
     C                     Z-ADDWUTDNB    WLTDNB           CKR Live Weight
     C                     Z-ADDWUTCNB    WLTCNB           CKR Dead On Arr
     C                     Z-ADDWUTENB    WLTENB           CKR Head Resale
     C                     Z-ADDWUTFNB    WLTFNB           CKR Yard Deads
     C                     Z-ADDWUTKNB    WLTKNB           CKR Held Over
     C                     Z-ADDWUTGNB    WLTGNB           CKR Head Killed
     C                     Z-ADDWUTINB    WLTINB           CKR Hot Weight
     C                     Z-ADDWUTHNB    WLTHNB           CKR Head Comdem
     C                     MOVEL*BLANK    WLAAVN    P      RS User Changed
     C                     Z-ADD*ZERO     WLAADT           RS Date Changed
     C                     Z-ADD*ZERO     WLAMTM           RS Time Changed
     C                     MOVEL'A'       WLAJST    P      RS Record Statu
     C                     MOVEL##JOB     WLAHVN    P      RS Job
     C                     MOVEL##PGM     WLAGVN    P      RS Program
     C                     MOVEL##USR     WLABVN    P      RS User Added
     C                     Z-ADD##JDT     WLABDT           RS Date Added
     C                     Z-ADD##JTM     WLABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKDC1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@DCCPSE                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKDCCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Crt Co Exp Rate Data  RT - Company Expense  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * AS400 Error Message Hot scale records were not up and the
      * Head Killed was zero
      * do not div by head killed if head killed is zero
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMP9NB    WQSO01           CE Company
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           CE Company
      * Setup key
     C                     Z-ADDP1HONB    WQSO01           CE Company
      * Establish starting position
     C           KRSSO     SETLL@C7RESK                    *
     C           KRSSO     READE@C7RESK                  90*
      * Data record not found
     C   90                MOVEL'PRK0469' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.CE Expense Type is Daily Summarization
     C           WMKSST    IFEQ 'D'                        *IF
      * Rtv Company Kill Recap RT - Company Kill Recap  * 
     C                     EXSR SPRVGN
      * Clc Co Daily Rate     IF
      * Calculate amount
      * CASE: PAR.CE Unit of Measure is Co Head UOM
     C           WMKQST    IFEQ 'CH'                       *IF
     C           WMKQST    OREQ 'DH'
     C           WMKQST    OREQ 'KH'
     C           WMKQST    OREQ 'RH'
     C           WMKQST    OREQ 'YH'
      * * * * * *    HEAD   * * * * *
      * HEAD
      * CASE: PAR.CE Unit of Measure is Received Head
     C           WMKQST    IFEQ 'RH'                       *IF
     C           WME9PR    DIV  WUTBNB    WUCEPR    H      Trans Unit Amt
     C                     ELSE
      * CASE: PAR.CE Unit of Measure is Killed Head
     C           WMKQST    IFEQ 'KH'                       *IF
      * slm 05/30/2008 S00258
      * as400 error message on 5/30 head kill was zero due to NO hot scal
      * records
      * CASE: PAR.CKR Head Killed is Equals 0
     C           WUTGNB    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WUCEPR           Trans Unit Amt
     C                     ELSE
      * CASE: *OTHERWISE
     C           WME9PR    DIV  WUTGNB    WUCEPR    H      Trans Unit Amt
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.CE Unit of Measure is Condemned Head
     C           WMKQST    IFEQ 'CH'                       *IF
     C           WME9PR    DIV  WUTHNB    WUCEPR    H      Trans Unit Amt
     C                     ELSE
      * CASE: PAR.CE Unit of Measure is Yard Deads Head
     C           WMKQST    IFEQ 'YH'                       *IF
     C           WME9PR    DIV  WUTFNB    WUCEPR    H      Trans Unit Amt
     C                     ELSE
      * CASE: PAR.CE Unit of Measure is DOA Head
     C           WMKQST    IFEQ 'DH'                       *IF
     C           WME9PR    DIV  WUTCNB    WUCEPR    H      Trans Unit Amt
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.CE Unit of Measure is Co Weight UOM
     C           WMKQST    IFEQ 'CW'                       *IF
     C           WMKQST    OREQ 'LW'
      * * * * * *    WEIGHT   * * * * *
      * WEIGHT
      * CASE: PAR.CE Unit of Measure is Live Hundred Weight
     C           WMKQST    IFEQ 'LW'                       *IF
      * Live hundred weght
      * PAR.Trans Unit Amt Usr =
      *    *COMPUTE ((x1 / (x2 / x3)))
      * x1    : PAR.Trans Unit Amt Usr
      * /     : PGM.*Synon (17,7) work field *
      * x2    : PAR.CKR Live Weight
      * /     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           WUTDNB    DIV  100       W0WD01           *Synon (17,7) w
     C           WUCEPR    DIV  W0WD01    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCEPR           Trans Unit Amt
     C                     ELSE
      * CASE: PAR.CE Unit of Measure is Carcass Hundred Weight
     C           WMKQST    IFEQ 'CW'                       *IF
      * Carcass Hundred Wgt
      * PAR.Trans Unit Amt Usr =
      *    *COMPUTE ((x1 / (x2 / x3)))
      * x1    : PAR.Trans Unit Amt Usr
      * /     : PGM.*Synon (17,7) work field *
      * x2    : PAR.CKR Hot Weight
      * /     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           WUTINB    DIV  100       W0WD01           *Synon (17,7) w
     C           WUCEPR    DIV  W0WD01    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCEPR           Trans Unit Amt
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.CE Unit of Measure is Co Value Uom
     C           WMKQST    IFEQ 'GV'                       *IF
      * * * * * *    VALUE    * * * * *
      * VALUE
      * CASE: PAR.CE Unit of Measure is Carcass Hundred Weight
     C           WMKQST    IFEQ 'CW'                       *IF
      * Carcass Hundred Value
      * PAR.Trans Unit Amt Usr =
      *    *COMPUTE ((x1 / (x2 / x3)))
      * x1    : PAR.Trans Unit Amt Usr
      * /     : PGM.*Synon (17,7) work field *
      * x2    : PAR.CKR Hot Weight
      * /     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           WUTINB    DIV  100       W0WD01           *Synon (17,7) w
     C           WUCEPR    DIV  W0WD01    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCEPR           Trans Unit Amt
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Create Company Kill Expen - Company Kill Expense Rate  * 
     C                     EXSR SQCRRC
     C                     ELSE
      * CASE: DB1.CE Expense Type is *Blank
     C           WMKSST    IFEQ *BLANK                     *IF
      * Create Company Kill Expen - Company Kill Expense Rate  * 
     C                     EXSR SRCRRC
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSO     READE@C7RESK                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Company Kill Recap RT - Company Kill Recap  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WKHONB           CC Company Numb
     C                     KFLD           WKCRDT           CKR Kill Date
      * Setup key
     C                     Z-ADDP1HONB    WKHONB           CC Company Numb
     C                     Z-ADDP1CKDT    WKCRDT           CKR Kill Date
      * Establish starting position
     C           KRSSP     CHAIN@DCCPSF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0531' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUTBNB           CKR Head Receiv
     C                     Z-ADD*ZERO     WUTDNB           CKR Live Weight
     C                     Z-ADD*ZERO     WUTCNB           CKR Dead On Arr
     C                     Z-ADD*ZERO     WUTENB           CKR Head Resale
     C                     Z-ADD*ZERO     WUTFNB           CKR Yard Deads
     C                     Z-ADD*ZERO     WUTKNB           CKR Held Over
     C                     Z-ADD*ZERO     WUTGNB           CKR Head Killed
     C                     Z-ADD*ZERO     WUTINB           CKR Hot Weight
     C                     Z-ADD*ZERO     WUTHNB           CKR Head Comdem
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWKTBNB    WUTBNB           CKR Head Receiv
     C                     Z-ADDWKTDNB    WUTDNB           CKR Live Weight
     C                     Z-ADDWKTCNB    WUTCNB           CKR Dead On Arr
     C                     Z-ADDWKTENB    WUTENB           CKR Head Resale
     C                     Z-ADDWKTFNB    WUTFNB           CKR Yard Deads
     C                     Z-ADDWKTKNB    WUTKNB           CKR Held Over
     C                     Z-ADDWKTGNB    WUTGNB           CKR Head Killed
     C                     Z-ADDWKTINB    WUTINB           CKR Hot Weight
     C                     Z-ADDWKTHNB    WUTHNB           CKR Head Comdem
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQCRRC    BEGSR
      *================================================================
      * Create Company Kill Expen - Company Kill Expense Rate  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DDCPSI
     C                     Z-ADDP1HONB    WOP9NB           CE Company
     C                     MOVELWMELCD    WOELCD           CE Expense Code
     C                     Z-ADDP1CKDT    WOCSDT           CKE Kill Date
     C                     MOVELWMKQST    WOL7ST           CKE Unit of Mea
     C                     Z-ADDWUCEPR    WOF5PR           CKE Unit Amount
     C                     MOVEL*BLANK    WOAAVN           RS User Changed
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     MOVEL'A'       WOAJST           RS Record Statu
     C                     MOVEL*BLANK    WOAHVN           RS Job
     C                     MOVEL*BLANK    WOAGVN           RS Program
     C                     MOVEL*BLANK    WOABVN           RS User Added
     C                     Z-ADDWMABDT    WOABDT           RS Date Added
     C                     Z-ADDWMABTM    WOABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WOAJST           RS Record Statu
     C                     MOVEL##USR     WOABVN           RS User Added
     C                     Z-ADD##JDT     WOABDT           RS Date Added
     C                     Z-ADD##JTM     WOABTM           RS Time Added
     C                     MOVEL##PGM     WOAGVN           RS Program
     C                     MOVEL##JOB     WOAHVN           RS Job
     C           KLCRSQ    KLIST
     C                     KFLD           WOP9NB           CE Company
     C                     KFLD           WOELCD           CE Expense Code
     C                     KFLD           WOCSDT           CKE Kill Date
      * Check for duplicate primary key
     C           KLCRSQ    SETLL@DDCPSI                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0544' W0RTN   7
      * Send message 'Company Kill Expense R EX'
     C                     MOVEL'PRK0544' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C                     WRITE@DDCPSI                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRCRRC    BEGSR
      *================================================================
      * Create Company Kill Expen - Company Kill Expense Rate  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DDCPSI
     C                     Z-ADDP1HONB    WOP9NB           CE Company
     C                     MOVELWMELCD    WOELCD           CE Expense Code
     C                     Z-ADDP1CKDT    WOCSDT           CKE Kill Date
     C                     MOVELWMKQST    WOL7ST           CKE Unit of Mea
     C                     Z-ADDWME9PR    WOF5PR           CKE Unit Amount
     C                     MOVEL*BLANK    WOAAVN           RS User Changed
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     MOVEL'A'       WOAJST           RS Record Statu
     C                     MOVEL*BLANK    WOAHVN           RS Job
     C                     MOVEL*BLANK    WOAGVN           RS Program
     C                     MOVEL*BLANK    WOABVN           RS User Added
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WOAJST           RS Record Statu
     C                     MOVEL##USR     WOABVN           RS User Added
     C                     Z-ADD##JDT     WOABDT           RS Date Added
     C                     Z-ADD##JTM     WOABTM           RS Time Added
     C                     MOVEL##PGM     WOAGVN           RS Program
     C                     MOVEL##JOB     WOAHVN           RS Job
     C           KLCRSR    KLIST
     C                     KFLD           WOP9NB           CE Company
     C                     KFLD           WOELCD           CE Expense Code
     C                     KFLD           WOCSDT           CKE Kill Date
      * Check for duplicate primary key
     C           KLCRSR    SETLL@DDCPSI                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0544' W0RTN   7
      * Send message 'Company Kill Expense R EX'
     C                     MOVEL'PRK0544' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C                     WRITE@DDCPSI                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * E9904 JBB 08/29/17 - Push Payment for TF2
      * - Removed the logic that prevented the divide by zero.  Rose
      *   wanted the divide by zero error to stop the program so support
      *   could look into the data error that caused the divide by zero.
      * E9904 JJH 08/26/17 - Push Payment for TF2
      * - Add logic to prevent Divide by zero for TH Recalc Live Wgt Yld
      *   in the PayEdt Create Crc Dtl RT - Eval Trans function.
      * H16853 ISE 11/02/20 - Increased the Buy Order Number field
      *                       length from 5 to 7.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * E9904 JBB 08/29/17 - Push Payment for TF2
      * - Removed the logic that prevented the divide by zero.  Rose
      *   wanted the divide by zero error to stop the program so support
      *   could look into the data error that caused the divide by zero.
      * E9904 JJH 08/26/17 - Push Payment for TF2
      * - Add logic to prevent Divide by zero for TH Recalc Live Wgt Yld
      *   in the PayEdt Create Crc Dtl RT - Eval Trans function.
      * 01/19/06 PKD Triumph Foods will not be weighing hogs on a Truck
      *              or a scale inside.  The Live Weight needs to be
      *              estimated based on a Standard Yield.
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Get the MTech Live Yes or No
      *================================================================
      * Mtech Live Yes or no
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0007  30       BOH Company Num
     C                     PARM @CN,003   WQ0008 10        Company Value C
     C           WUKBTX    PARM *BLANK    WQ0009 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUKBTX    YL0001           MTech Live Yes
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * E9904 JBB 08/29/17 - Push Payment for TF2
      * - Removed the logic that prevented the divide by zero.  Rose
      *   wanted the divide by zero error to stop the program so support
      *   could look into the data error that caused the divide by zero.
      * E9904 JJH 08/26/17 - Push Payment for TF2
      * - Add logic to prevent Divide by zero for TH Recalc Live Wgt Yld
      *   in the PayEdt Create Crc Dtl RT - Eval Trans function.
      * 06/08/04 SLM HPEBAL Changes to use the Recalc Live Wgt Yld
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WABNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WABONB           BOL Load Number
     C                     Z-ADD*ZERO     WACVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WAB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WAAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WAACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WAB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WACAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WAAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WAA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WACXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WACWNB           TH Head Receive
     C                     Z-ADD*ZERO     WAFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WAH9NB           TH Held Over
     C                     Z-ADD*ZERO     WAFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WAFENB           TH Head Killed
     C                     Z-ADD*ZERO     WAHENB           TH Head Adds
     C                     Z-ADD*ZERO     WAHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WACYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WALRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WAE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WAA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WAFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WAA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WAF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WAHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WAF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WAF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WAF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WAF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WAAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WAAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WACWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WAA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WAA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WAB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WAAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WAANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WAAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WAAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WAAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WAAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WAAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WAASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WAA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WAATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WAA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WACBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WACCPR           Th Payment Net
     C                     Z-ADD*ZERO     WALPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WACDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WAA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WAA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WAGHNB           TH Commission A
     C                     Z-ADD*ZERO     WABYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WABSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WABTDT           TH Commission P
     C                     Z-ADD*ZERO     WABUDT           TH Actual Check
     C                     Z-ADD*ZERO     WAHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WAHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WAHINB           TH FFLI
     C                     Z-ADD*ZERO     WAA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WAA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WAA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WAJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WAD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WAD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WAD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WAD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WAEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WAEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WAECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WAEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WAEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WAEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WAEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WAEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WAOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WATHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WAT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WATHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WAT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WAOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WAKOER           TH Head Identif
     C                     Z-ADD*ZERO     WAOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WAOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WAIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WAOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WAHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WAS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WATAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WATBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WAJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WAKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WAKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WAKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WAKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WAOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WAIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WAIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WAIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WAKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WAOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WAKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WAORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WAOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WAMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WAMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WANCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WANCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WAIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WAKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WAEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WAEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WAECDT           TH Head LFT
     C                     Z-ADD*ZERO     WAEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WAEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Define work field System Value Alpha    USR
     C                     MOVEL*BLANK    WUKBTX 40
      * Define work field HC Description
     C                     MOVEL*BLANK    WUBDTX 25
      * Define work field HC Defect Required
     C                     MOVEL*BLANK    WUBXST  1
      * Define work field HC Price Required
     C                     MOVEL*BLANK    WUBYST  1
      * Define work field HC Resolution
     C                     MOVEL*BLANK    WUBITX 60
      * Define work field HC Qualification
     C                     MOVEL*BLANK    WUB0ST  1
      * Define work field HC Class Type
     C                     MOVEL*BLANK    WUFBST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      * Define work field Farm site Name f/ HPS USR
     C                     MOVEL*BLANK    WUKQTX 25
      * Define work field HPS FS Comp Relation USR
     C                     MOVEL*BLANK    WUG4CD  5
      * Define work field State
     C                     MOVEL*BLANK    WUDRTX  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCHSNB           ET Company Numb
     C                     Z-ADD*ZERO     WCA9DT           ET Kill Date
     C                     Z-ADD*ZERO     WCFJNB           ET Scale Sequen
     C                     Z-ADD*ZERO     WCHCNB           ET Carcass Numb
     C                     Z-ADD*ZERO     WCGDNB           ET Carcass Numb
     C                     Z-ADD*ZERO     WCFINB           ET Tattoo Numbe
     C                     Z-ADD*ZERO     WCLKNB           ET Lot
     C                     Z-ADD*ZERO     WCAMPC           ET Hot Wgt
     C                     Z-ADD*ZERO     WCAIPC           ET Backfat Thic
     C                     Z-ADD*ZERO     WCAJPC           ET Loin-Eye Dep
     C                     Z-ADD*ZERO     WCAKPC           ET Lean Percent
     C                     Z-ADD*ZERO     WCX8NB           ET Backfat Thic
     C                     Z-ADD*ZERO     WCFVPC           ET Loineye Dept
     C                     Z-ADD*ZERO     WCFWPC           ET Light Reflec
     C                     Z-ADD*ZERO     WCFXPC           ET Lean Percent
     C                     Z-ADD*ZERO     WCALPC           ET Light Reflec
     C                     Z-ADD*ZERO     WCHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WCBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WCBONB           BOL Load Number
     C                     Z-ADD*ZERO     WCCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WCB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
     C                     Z-ADD*ZERO     WCB8DT           RU Date
     C                     Z-ADD*ZERO     WCAOTM           RU Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WDBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WDBONB           BOL Load Number
     C                     Z-ADD*ZERO     WDCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WDB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WDLGNB           CD Scale Sequen
     C                     Z-ADD*ZERO     WDEUNB           CD Carcass Numb
     C                     Z-ADD*ZERO     WDLHNB           CD Carcass Numb
     C                     Z-ADD*ZERO     WDBEPR           CD Sort Loss
     C                     Z-ADD*ZERO     WDASPC           CD STD Yield
     C                     Z-ADD*ZERO     WDEWNB           CD Carcass/Hot
     C                     Z-ADD*ZERO     WDB4PR           CD Base Carcass
     C                     Z-ADD*ZERO     WDEYNB           CD Crc Value Pe
     C                     Z-ADD*ZERO     WDB1PR           CD Base Carc Va
     C                     Z-ADD*ZERO     WDAVPR           CD Crc Value $
     C                     Z-ADD*ZERO     WDAUPC           CD Lean Percent
     C                     Z-ADD*ZERO     WDAWPR           CD Lean Premium
     C                     Z-ADD*ZERO     WDAXPR           CD Lean Premium
     C                     Z-ADD*ZERO     WDEZNB           CD Gross Value
     C                     Z-ADD*ZERO     WDAYPR           CD Gross Value
     C                     Z-ADD*ZERO     WDBBDT           CD Kill Date
     C                     Z-ADD*ZERO     WDAKTM           CD Kill Time
     C                     Z-ADD*ZERO     WDH6NB           CD Backfat Thic
     C                     Z-ADD*ZERO     WDBEPC           CD Loin-Eye Dep
     C                     Z-ADD*ZERO     WDGCST           CD Light Reflec
     C                     Z-ADD*ZERO     WDBHPC           CD FFLI
     C                     Z-ADD*ZERO     WDLTNB           CD LOT
     C                     Z-ADD*ZERO     WDX4NB           CD Backfat Thic
     C                     Z-ADD*ZERO     WDFNPC           CD Loin-Eye Dep
     C                     Z-ADD*ZERO     WDFOPC           CD Light Reflec
     C                     Z-ADD*ZERO     WDFPPC           CD Lean Percent
     C                     Z-ADD*ZERO     WDJWPR           CD CA Sort Loss
     C                     Z-ADD*ZERO     WDF5PC           CD CA Std Yield
     C                     Z-ADD*ZERO     WDJXPR           CD CA Base Carc
     C                     Z-ADD*ZERO     WDJYPR           CD CA Crc Value
     C                     Z-ADD*ZERO     WDJZPR           CD CA Base Carc
     C                     Z-ADD*ZERO     WDJ0PR           CD CA Crc Value
     C                     Z-ADD*ZERO     WDJ1PR           CD CA Lean Prem
     C                     Z-ADD*ZERO     WDJ2PR           CD CA Lean Prem
     C                     Z-ADD*ZERO     WDJ3PR           CD CA Gross Val
     C                     Z-ADD*ZERO     WDJ4PR           CD CA Gross Val
     C                     Z-ADD*ZERO     WDDKJR           CD Loin Eye Inc
     C                     Z-ADD*ZERO     WDITJF           CD Backfat Inch
     C                     Z-ADD*ZERO     WDIJGR           CD Meat Value F
     C                     Z-ADD*ZERO     WDORJE           CD Lean Prem/Di
     C                     Z-ADD*ZERO     WDOTJR           CD Fixed Cost F
     C                     Z-ADD*ZERO     WDPEIR           CD MPR Sort Los
     C                     Z-ADD*ZERO     WDIEUF           CD Meat Value F
     C                     Z-ADD*ZERO     WDORUE           CD Fixed Cost F
     C                     Z-ADD*ZERO     WDIUTR           CD Gross Before
     C                     Z-ADD*ZERO     WDIJRR           CD Gross Before
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
      * Define work field CD CA Sort Loss
     C                     Z-ADD*ZERO     WUJWPR  72
      * Define work field CD CA Std Yield
     C                     Z-ADD*ZERO     WUF5PC  52
      * Define work field CD CA Base Carcass CWT
     C                     Z-ADD*ZERO     WUJXPR  72
      * Define work field CD CA Crc Value Per CWT
     C                     Z-ADD*ZERO     WUJYPR  52
      * Define work field CD CA Base Carc Value
     C                     Z-ADD*ZERO     WUJZPR  72
      * Define work field CD CA Crc Value $ Per Hd
     C                     Z-ADD*ZERO     WUJ0PR  72
      * Define work field CD CA Lean Premium CWT
     C                     Z-ADD*ZERO     WUJ1PR  72
      * Define work field CD CA Lean Premium $ P Hd
     C                     Z-ADD*ZERO     WUJ2PR  72
      * Define work field CD CA Gross Value Per CWT
     C                     Z-ADD*ZERO     WUJ3PR  52
      * Define work field CD CA Gross Value $ P Hd
     C                     Z-ADD*ZERO     WUJ4PR  72
      * Define work field CD Adjust/Add Source
     C                     MOVEL*BLANK    WUVDST  2
      * Define work field CD Unused Sts 3
     C                     MOVEL*BLANK    WUVEST  3
      * Define work field CD Unused Sts 4
     C                     MOVEL*BLANK    WUVFST  3
      * Define work field CD Unused Sts 5
     C                     MOVEL*BLANK    WUVGST  6
      * Define work field RS User Changed
     C                     MOVEL*BLANK    WUAAVN 10
      * Define work field RS Date Changed
     C                     Z-ADD*ZERO     WUAADT  70
      * Define work field RS Time Changed
     C                     Z-ADD*ZERO     WUAMTM  60
      * Define work field RS Record Status
     C                     MOVEL*BLANK    WUAJST  1
      * Define work field RS Job
     C                     MOVEL*BLANK    WUAHVN 10
      * Define work field RS Program
     C                     MOVEL*BLANK    WUAGVN 10
      * Define work field RS User Added
     C                     MOVEL*BLANK    WUABVN 10
      * Define work field RS Date Added
     C                     Z-ADD*ZERO     WUABDT  70
      * Define work field RS Time Added
     C                     Z-ADD*ZERO     WUABTM  60
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFHONB           CC Company Numb
     C                     Z-ADD*ZERO     WFGQPC           Loss Percent
     C                     Z-ADD*ZERO     WFAADT           RS Date Changed
     C                     Z-ADD*ZERO     WFAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WFABDT           RS Date Added
     C                     Z-ADD*ZERO     WFABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGHUNB           LTN Company Num
     C                     Z-ADD*ZERO     WGA7DT           LTN Kill Date
     C                     Z-ADD*ZERO     WGFHNB           LTN Record Numb
     C                     Z-ADD*ZERO     WGFFNB           LTN Tattoo Numb
     C                     Z-ADD*ZERO     WGDSNB           LTN Wgt
     C                     Z-ADD*ZERO     WGBWCD           LT Type Code
     C                     Z-ADD*ZERO     WGBYCD           LR Reason Code
     C                     Z-ADD*ZERO     WGHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WGBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WGBONB           BOL Load Number
     C                     Z-ADD*ZERO     WGCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WGB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WGAADT           RS Date Changed
     C                     Z-ADD*ZERO     WGAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WGABDT           RS Date Added
     C                     Z-ADD*ZERO     WGABTM           RS Time Added
     C                     Z-ADD*ZERO     WGB8DT           RU Date
     C                     Z-ADD*ZERO     WGAOTM           RU Time
      * Define work field Live wgt total 11.1   USR
     C                     Z-ADD*ZERO     WUZ7NB 111
      * Define work field Num Field Not Needed
     C                     Z-ADD*ZERO     WUNNND  50
      * Define work field TH Avg Live Wgt
     C                     Z-ADD*ZERO     WUF7NB  51
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKHONB           CC Company Numb
     C                     Z-ADD*ZERO     WKCRDT           CKR Kill Date
     C                     Z-ADD*ZERO     WKTBNB           CKR Head Receiv
     C                     Z-ADD*ZERO     WKTDNB           CKR Live Weight
     C                     Z-ADD*ZERO     WKTCNB           CKR Dead On Arr
     C                     Z-ADD*ZERO     WKTENB           CKR Head Resale
     C                     Z-ADD*ZERO     WKTFNB           CKR Yard Deads
     C                     Z-ADD*ZERO     WKTKNB           CKR Held Over
     C                     Z-ADD*ZERO     WKTGNB           CKR Head Killed
     C                     Z-ADD*ZERO     WKTINB           CKR Hot Weight
     C                     Z-ADD*ZERO     WKTHNB           CKR Head Comdem
     C                     Z-ADD*ZERO     WKAADT           RS Date Changed
     C                     Z-ADD*ZERO     WKAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WKABDT           RS Date Added
     C                     Z-ADD*ZERO     WKABTM           RS Time Added
      * Define work field CKR Head Received/Hld Ovr
     C                     Z-ADD*ZERO     WUTBNB  70
      * Define work field CKR Live Weight
     C                     Z-ADD*ZERO     WUTDNB  81
      * Define work field CKR Dead On Arrival
     C                     Z-ADD*ZERO     WUTCNB  70
      * Define work field CKR Head Resale
     C                     Z-ADD*ZERO     WUTENB  70
      * Define work field CKR Yard Deads
     C                     Z-ADD*ZERO     WUTFNB  70
      * Define work field CKR Held Over
     C                     Z-ADD*ZERO     WUTKNB  70
      * Define work field CKR Head Killed
     C                     Z-ADD*ZERO     WUTGNB  70
      * Define work field CKR Hot Weight
     C                     Z-ADD*ZERO     WUTINB  81
      * Define work field CKR Head Comdemned
     C                     Z-ADD*ZERO     WUTHNB  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMP9NB           CE Company
     C                     Z-ADD*ZERO     WME9PR           CE Unit Amount
     C                     Z-ADD*ZERO     WMAADT           RS Date Changed
     C                     Z-ADD*ZERO     WMAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WMABDT           RS Date Added
     C                     Z-ADD*ZERO     WMABTM           RS Time Added
      * Define work field Trans Unit Amt Usr
     C                     Z-ADD*ZERO     WUCEPR  72
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOP9NB           CE Company
     C                     Z-ADD*ZERO     WOCSDT           CKE Kill Date
     C                     Z-ADD*ZERO     WOF5PR           CKE Unit Amount
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WB01 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local work field MTech Live Yes or No
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field TH HPS Farm Site
     C                     Z-ADD*ZERO     YL0002  50
      * Define local work field CD Carcass Number
     C                     Z-ADD*ZERO     YL0003  30
      * Define local work field Backfat * Wgt USR
     C                     Z-ADD*ZERO     YL0004 152
      * Define local work field Loin-Eye * Wgt USR
     C                     Z-ADD*ZERO     YL0005 152
      * Define local work field TH Broken Back Hd Count
     C                     Z-ADD*ZERO     YL0006  50
      * Define local work field TH Recalc Live Wgt
     C                     Z-ADD*ZERO     YL0007  31
      * Define local work field TH Recalc Live Wgt Yld
     C                     Z-ADD*ZERO     YL0008  52
      * Define local work field PL Location Code
     C                     MOVEL*BLANK    YL0009  6
      * Define local work field Farm Site 6.0 USR
     C                     Z-ADD*ZERO     YL0010  60
      * Define local work field CD Sort Loss
     C                     Z-ADD*ZERO     YL0011  72
      * Define local work field CD STD Yield
     C                     Z-ADD*ZERO     YL0012  52
      * Define local work field CD Base Carcass CWT
     C                     Z-ADD*ZERO     YL0013  72
      * Define local work field CD Crc Value Per CWT
     C                     Z-ADD*ZERO     YL0014  52
      * Define local work field CD Base Carc Value
     C                     Z-ADD*ZERO     YL0015  72
      * Define local work field CD Crc Value $ Per Hd
     C                     Z-ADD*ZERO     YL0016  72
      * Define local work field CD Lean Premium CWT
     C                     Z-ADD*ZERO     YL0017  72
      * Define local work field CD Lean Premium $ Per Hd
     C                     Z-ADD*ZERO     YL0018  72
      * Define local work field CD Gross Value Per CWT
     C                     Z-ADD*ZERO     YL0019  52
      * Define local work field CD Gross Value $ Per HD
     C                     Z-ADD*ZERO     YL0020  72
      * Define local work field CD Carcass Activity Sts
     C                     MOVEL*BLANK    YL0021  1
      * Define local work field CD FFLI
     C                     Z-ADD*ZERO     YL0022  31
      * Define local work field CD Backfat Inch - 2 dec
     C                     Z-ADD*ZERO     YL0023  52
      * Define local work field CD Loin Eye Inch - 2 dec
     C                     Z-ADD*ZERO     YL0024  52
      * Define local work field TH Avg Backfat - 2 Dec
     C                     Z-ADD*ZERO     YL0025  52
      * Define local work field TH Avg Loin Eye - 2 dec
     C                     Z-ADD*ZERO     YL0026  52
      * Define local work field THP Process Code
     C                     MOVEL*BLANK    YL0027  6
      * Define local work field TH Calc Net Sts
     C                     MOVEL*BLANK    YL0028  1
      * Define local work field TH VC Gross Value /HD
     C                     Z-ADD*ZERO     YL0029  52
      * Define local work field TH Adj Live Wgt
     C                     Z-ADD*ZERO     YL0030  71
      * Define local work field TH Avg Live Wgt
     C                     Z-ADD*ZERO     YL0031  51
      * Define local work field TH Live Wgt
     C                     Z-ADD*ZERO     YL0032  71
      * Define local work field TH Actual Yield %
     C                     Z-ADD*ZERO     YL0033  52
      * Define local work field TH Adj Actual Yield %
     C                     Z-ADD*ZERO     YL0034  52
      * Define local work field TH Yield Difference
     C                     Z-ADD*ZERO     YL0035  52
      * Define local work field TH Held/Ovr Completed Dte
     C                     Z-ADD*ZERO     YL0036  70
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 RLWSY-Y/N
00002 RLWSY-YLD
00003 MTECHLIVE
00004 PAYMNT
