     H/TITLE zzS Move Plan to Schd zz  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by AllFusion 2E release 8.1SP2 (1250)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISSMASO
     H* Date          : 02/22/10  Time  : 17:05:16
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAAFREL8IF  E           K        DISK
      * RTV : Calendar                  Co/Date PrdDaySts=Y
      *
     FPDI8CPLJIF  E           K        DISK
      * RSQ : PS Prod Item Schedule     Co/PrdDte/Grp/Class/Itm
      *
     FPDI8CPL1IF  E           K        DISK
      * RTV : PS Prod Item Schedule     Retrieval index
      *
     FPDKNCPL1IF  E           K        DISK
      * RTV : Order Detail Schedule     Retrieval index
      *
     FOPBGWKLIIF  E           K        DISK
      * RSQ : Order Detail              Co/SSD/Ord/Sq/SSq Opn
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPDI8CPL0UF  E           K        DISK
      * UPD : PS Prod Item Schedule     Update index
      *
     FPDKNCPL0UF  E           K        DISK
      * UPD : Order Detail Schedule     Update index
      *
     I@AFREY1
      * Calendar                  Co/Date PrdDaySts=Y
      * Renamed input format fields
     I              AFAIC3                          WAAIC3
     I              AFBCDT                          WABCDT
     I              AFCQNB                          WACQNB
     I              AFESNB                          WAESNB
     I              AFETNB                          WAETNB
     I              AFBZNB                          WABZNB
     I              AFA9ST                          WAA9ST
     I              AFEINB                          WAEINB
     I              AFC5ST                          WAC5ST
     I              AFAQNB                          WAAQNB
     I              AFCMST                          WACMST
     I              AFV9ST                          WAV9ST
     I              AFWAST                          WAWAST
     I              AFX2ST                          WAX2ST
     I              AFOJDT                          WAOJDT
     I              AFNQNX                          WANQNX
     I              AFNRNX                          WANRNX
     I              AFI9SX                          WAI9SX
     I              AFJASX                          WAJASX
     I              AFOKDT                          WAOKDT
     I              AFOLDT                          WAOLDT
     I              AFUVST                          WAUVST
     I              AFUWST                          WAUWST
     I              AFUXST                          WAUXST
     I              AFAATM                          WAAATM
     I              AFAYNA                          WAAYNA
     I              AFA0NA                          WAA0NA
     I              AFAXDT                          WAAXDT
      *
     I@I8CPGN
      * PS Prod Item Schedule     Co/PrdDte/Grp/Class/Itm
      * Renamed input format fields
     I              I8AIC3                          WBAIC3
     I              I8V5ST                          WBV5ST
     I              I8ELDT                          WBELDT
     I              I8HGCD                          WBHGCD
     I              I8AJCD                          WBAJCD
     I              I8GPDT                          WBGPDT
     I              I8WTSP                          WBWTSP
     I              I8QTSP                          WBQTSP
     I              I8DJPC                          WBDJPC
     I              I8F8WG                          WBF8WG
     I              I8WTIN                          WBWTIN
     I              I8D5NB                          WBD5NB
     I              I8DXWG                          WBDXWG
     I              I8B2NB                          WBB2NB
     I              I8WTCN                          WBWTCN
     I              I8PSCV                          WBPSCV
     I              I8SAWT                          WBSAWT
     I              I8B9NB                          WBB9NB
     I              I8D1WG                          WBD1WG
     I              I8CBNB                          WBCBNB
     I              I8EZWG                          WBEZWG
     I              I8CCNB                          WBCCNB
     I              I8E0WG                          WBE0WG
     I              I8D6NB                          WBD6NB
     I              I8OAWT                          WBOAWT
     I              I8CDNB                          WBCDNB
     I              I8UNW2                          WBUNW2
     I              I8CENB                          WBCENB
     I              I8F9WG                          WBF9WG
     I              I8BPNB                          WBBPNB
     I              I8GAWG                          WBGAWG
     I              I8BQNB                          WBBQNB
     I              I8GBWG                          WBGBWG
     I              I8BRNB                          WBBRNB
     I              I8GCWG                          WBGCWG
     I              I8BSNB                          WBBSNB
     I              I8GDWG                          WBGDWG
     I              I8BWNB                          WBBWNB
     I              I8GEWG                          WBGEWG
     I              I8PS6U                          WBPS6U
     I              I8WCST                          WBWCST
     I              I8WPST                          WBWPST
     I              I8B5ST                          WBB5ST
     I              I8TFST                          WBTFST
     I              I8TEST                          WBTEST
     I              I8THST                          WBTHST
     I              I8UDST                          WBUDST
     I              I8UFST                          WBUFST
     I              I8UGST                          WBUGST
     I              I8UHST                          WBUHST
     I              I8B6ST                          WBB6ST
     I              I8B7ST                          WBB7ST
     I              I8DVWG                          WBDVWG
     I              I8D7NB                          WBD7NB
     I              I8FCAD                          WBFCAD
     I              I8D9NB                          WBD9NB
     I              I8DWWG                          WBDWWG
     I              I8EANB                          WBEANB
     I              I8SHWT                          WBSHWT
     I              I8EBNB                          WBEBNB
     I              I8AVWT                          WBAVWT
     I              I8ECNB                          WBECNB
     I              I8WTON                          WBWTON
     I              I8EDNB                          WBEDNB
     I              I8FNWT                          WBFNWT
     I              I8EENB                          WBEENB
     I              I8QTAS                          WBQTAS
     I              I8EFNB                          WBEFNB
     I              I8WAIO                          WBWAIO
     I              I8EGNB                          WBEGNB
     I              I8R3CD                          WBR3CD
     I              I8RGNB                          WBRGNB
     I              I8RHNB                          WBRHNB
     I              I8RINB                          WBRINB
     I              I8XRCD                          WBXRCD
     I              I8UVST                          WBUVST
     I              I8UWST                          WBUWST
     I              I8UXST                          WBUXST
     I              I8VSST                          WBVSST
     I              I8AATM                          WBAATM
     I              I8AYNA                          WBAYNA
     I              I8A0NA                          WBA0NA
     I              I8AXDT                          WBAXDT
      *
     I@I8CPUS
      * PS Prod Item Schedule     Retrieval index
      * Renamed input format fields
     I              I8AIC3                          WCAIC3
     I              I8V5ST                          WCV5ST
     I              I8ELDT                          WCELDT
     I              I8HGCD                          WCHGCD
     I              I8AJCD                          WCAJCD
     I              I8GPDT                          WCGPDT
     I              I8WTSP                          WCWTSP
     I              I8QTSP                          WCQTSP
     I              I8DJPC                          WCDJPC
     I              I8F8WG                          WCF8WG
     I              I8WTIN                          WCWTIN
     I              I8D5NB                          WCD5NB
     I              I8DXWG                          WCDXWG
     I              I8B2NB                          WCB2NB
     I              I8WTCN                          WCWTCN
     I              I8PSCV                          WCPSCV
     I              I8SAWT                          WCSAWT
     I              I8B9NB                          WCB9NB
     I              I8D1WG                          WCD1WG
     I              I8CBNB                          WCCBNB
     I              I8EZWG                          WCEZWG
     I              I8CCNB                          WCCCNB
     I              I8E0WG                          WCE0WG
     I              I8D6NB                          WCD6NB
     I              I8OAWT                          WCOAWT
     I              I8CDNB                          WCCDNB
     I              I8UNW2                          WCUNW2
     I              I8CENB                          WCCENB
     I              I8F9WG                          WCF9WG
     I              I8BPNB                          WCBPNB
     I              I8GAWG                          WCGAWG
     I              I8BQNB                          WCBQNB
     I              I8GBWG                          WCGBWG
     I              I8BRNB                          WCBRNB
     I              I8GCWG                          WCGCWG
     I              I8BSNB                          WCBSNB
     I              I8GDWG                          WCGDWG
     I              I8BWNB                          WCBWNB
     I              I8GEWG                          WCGEWG
     I              I8PS6U                          WCPS6U
     I              I8WCST                          WCWCST
     I              I8WPST                          WCWPST
     I              I8B5ST                          WCB5ST
     I              I8TFST                          WCTFST
     I              I8TEST                          WCTEST
     I              I8THST                          WCTHST
     I              I8UDST                          WCUDST
     I              I8UFST                          WCUFST
     I              I8UGST                          WCUGST
     I              I8UHST                          WCUHST
     I              I8B6ST                          WCB6ST
     I              I8B7ST                          WCB7ST
     I              I8DVWG                          WCDVWG
     I              I8D7NB                          WCD7NB
     I              I8FCAD                          WCFCAD
     I              I8D9NB                          WCD9NB
     I              I8DWWG                          WCDWWG
     I              I8EANB                          WCEANB
     I              I8SHWT                          WCSHWT
     I              I8EBNB                          WCEBNB
     I              I8AVWT                          WCAVWT
     I              I8ECNB                          WCECNB
     I              I8WTON                          WCWTON
     I              I8EDNB                          WCEDNB
     I              I8FNWT                          WCFNWT
     I              I8EENB                          WCEENB
     I              I8QTAS                          WCQTAS
     I              I8EFNB                          WCEFNB
     I              I8WAIO                          WCWAIO
     I              I8EGNB                          WCEGNB
     I              I8R3CD                          WCR3CD
     I              I8RGNB                          WCRGNB
     I              I8RHNB                          WCRHNB
     I              I8RINB                          WCRINB
     I              I8XRCD                          WCXRCD
     I              I8UVST                          WCUVST
     I              I8UWST                          WCUWST
     I              I8UXST                          WCUXST
     I              I8VSST                          WCVSST
     I              I8AATM                          WCAATM
     I              I8AYNA                          WCAYNA
     I              I8A0NA                          WCA0NA
     I              I8AXDT                          WCAXDT
      *
     I@I8CPUR
      * PS Prod Item Schedule     Update index
      * Renamed input format fields
     I              I8AIC3                          WDAIC3
     I              I8V5ST                          WDV5ST
     I              I8ELDT                          WDELDT
     I              I8HGCD                          WDHGCD
     I              I8AJCD                          WDAJCD
     I              I8GPDT                          WDGPDT
     I              I8WTSP                          WDWTSP
     I              I8QTSP                          WDQTSP
     I              I8DJPC                          WDDJPC
     I              I8F8WG                          WDF8WG
     I              I8WTIN                          WDWTIN
     I              I8D5NB                          WDD5NB
     I              I8DXWG                          WDDXWG
     I              I8B2NB                          WDB2NB
     I              I8WTCN                          WDWTCN
     I              I8PSCV                          WDPSCV
     I              I8SAWT                          WDSAWT
     I              I8B9NB                          WDB9NB
     I              I8D1WG                          WDD1WG
     I              I8CBNB                          WDCBNB
     I              I8EZWG                          WDEZWG
     I              I8CCNB                          WDCCNB
     I              I8E0WG                          WDE0WG
     I              I8D6NB                          WDD6NB
     I              I8OAWT                          WDOAWT
     I              I8CDNB                          WDCDNB
     I              I8UNW2                          WDUNW2
     I              I8CENB                          WDCENB
     I              I8F9WG                          WDF9WG
     I              I8BPNB                          WDBPNB
     I              I8GAWG                          WDGAWG
     I              I8BQNB                          WDBQNB
     I              I8GBWG                          WDGBWG
     I              I8BRNB                          WDBRNB
     I              I8GCWG                          WDGCWG
     I              I8BSNB                          WDBSNB
     I              I8GDWG                          WDGDWG
     I              I8BWNB                          WDBWNB
     I              I8GEWG                          WDGEWG
     I              I8PS6U                          WDPS6U
     I              I8WCST                          WDWCST
     I              I8WPST                          WDWPST
     I              I8B5ST                          WDB5ST
     I              I8TFST                          WDTFST
     I              I8TEST                          WDTEST
     I              I8THST                          WDTHST
     I              I8UDST                          WDUDST
     I              I8UFST                          WDUFST
     I              I8UGST                          WDUGST
     I              I8UHST                          WDUHST
     I              I8B6ST                          WDB6ST
     I              I8B7ST                          WDB7ST
     I              I8DVWG                          WDDVWG
     I              I8D7NB                          WDD7NB
     I              I8FCAD                          WDFCAD
     I              I8D9NB                          WDD9NB
     I              I8DWWG                          WDDWWG
     I              I8EANB                          WDEANB
     I              I8SHWT                          WDSHWT
     I              I8EBNB                          WDEBNB
     I              I8AVWT                          WDAVWT
     I              I8ECNB                          WDECNB
     I              I8WTON                          WDWTON
     I              I8EDNB                          WDEDNB
     I              I8FNWT                          WDFNWT
     I              I8EENB                          WDEENB
     I              I8QTAS                          WDQTAS
     I              I8EFNB                          WDEFNB
     I              I8WAIO                          WDWAIO
     I              I8EGNB                          WDEGNB
     I              I8R3CD                          WDR3CD
     I              I8RGNB                          WDRGNB
     I              I8RHNB                          WDRHNB
     I              I8RINB                          WDRINB
     I              I8XRCD                          WDXRCD
     I              I8UVST                          WDUVST
     I              I8UWST                          WDUWST
     I              I8UXST                          WDUXST
     I              I8VSST                          WDVSST
     I              I8AATM                          WDAATM
     I              I8AYNA                          WDAYNA
     I              I8A0NA                          WDA0NA
     I              I8AXDT                          WDAXDT
      *
     I@KNCPHO
      * Order Detail Schedule     Retrieval index
      * Renamed input format fields
     I              KNAIC3                          WEAIC3
     I              KNC4NB                          WEC4NB
     I              KNDPNB                          WEDPNB
     I              KNUENB                          WEUENB
     I              KNJGDT                          WEJGDT
     I              KNAODT                          WEAODT
     I              KNAJCD                          WEAJCD
     I              KNAYAA                          WEAYAA
     I              KNHGCD                          WEHGCD
     I              KNIGQT                          WEIGQT
     I              KNFLWG                          WEFLWG
     I              KNIUQT                          WEIUQT
     I              KNF3WG                          WEF3WG
     I              KNIVQT                          WEIVQT
     I              KNF4WG                          WEF4WG
     I              KNP7ST                          WEP7ST
     I              KNP8ST                          WEP8ST
     I              KNQAST                          WEQAST
     I              KNUVST                          WEUVST
     I              KNUWST                          WEUWST
     I              KNUXST                          WEUXST
     I              KNVSST                          WEVSST
     I              KNAATM                          WEAATM
     I              KNAYNA                          WEAYNA
     I              KNA0NA                          WEA0NA
     I              KNAXDT                          WEAXDT
      *
     I@KNCPHN
      * Order Detail Schedule     Update index
      * Renamed input format fields
     I              KNAIC3                          WFAIC3
     I              KNC4NB                          WFC4NB
     I              KNDPNB                          WFDPNB
     I              KNUENB                          WFUENB
     I              KNJGDT                          WFJGDT
     I              KNAODT                          WFAODT
     I              KNAJCD                          WFAJCD
     I              KNAYAA                          WFAYAA
     I              KNHGCD                          WFHGCD
     I              KNIGQT                          WFIGQT
     I              KNFLWG                          WFFLWG
     I              KNIUQT                          WFIUQT
     I              KNF3WG                          WFF3WG
     I              KNIVQT                          WFIVQT
     I              KNF4WG                          WFF4WG
     I              KNP7ST                          WFP7ST
     I              KNP8ST                          WFP8ST
     I              KNQAST                          WFQAST
     I              KNUVST                          WFUVST
     I              KNUWST                          WFUWST
     I              KNUXST                          WFUXST
     I              KNVSST                          WFVSST
     I              KNAATM                          WFAATM
     I              KNAYNA                          WFAYNA
     I              KNA0NA                          WFA0NA
     I              KNAXDT                          WFAXDT
      *
     I@BGWKKJ
      * Order Detail              Co/SSD/Ord/Sq/SSq Opn
      * Renamed input format fields
     I              OMAIC3                          WGAIC3
     I              OMC4NB                          WGC4NB
     I              OMDPNB                          WGDPNB
     I              OMUENB                          WGUENB
     I              OMHGCD                          WGHGCD
     I              OMAJCD                          WGAJCD
     I              OMBKC7                          WGBKC7
     I              OMCFC7                          WGCFC7
     I              OMGMST                          WGGMST
     I              OMGNST                          WGGNST
     I              OMMAVA                          WGMAVA
     I              OMKDVA                          WGKDVA
     I              OML8VA                          WGL8VA
     I              OML9VA                          WGL9VA
     I              OMGTST                          WGGTST
     I              OMGVST                          WGGVST
     I              OMGUST                          WGGUST
     I              OMQFST                          WGQFST
     I              OMAYVA                          WGAYVA
     I              OMEXDT                          WGEXDT
     I              OMLQCD                          WGLQCD
     I              OMRDCD                          WGRDCD
     I              OMQ7CD                          WGQ7CD
     I              OMBZPR                          WGBZPR
     I              OML6NB                          WGL6NB
     I              OMU1ST                          WGU1ST
     I              OMGIDT                          WGGIDT
     I              OMCRCD                          WGCRCD
     I              OMAGCD                          WGAGCD
     I              OMRZST                          WGRZST
     I              OMR0ST                          WGR0ST
     I              OMR1ST                          WGR1ST
     I              OMG7NA                          WGG7NA
     I              OMG8NA                          WGG8NA
     I              OMRPCD                          WGRPCD
     I              OMVEST                          WGVEST
     I              OMVGST                          WGVGST
     I              OMAVST                          WGAVST
     I              OMU0ST                          WGU0ST
     I              OMRFCD                          WGRFCD
     I              OMFZST                          WGFZST
     I              OMR1NB                          WGR1NB
     I              OMAVQT                          WGAVQT
     I              OMD0WG                          WGD0WG
     I              OMCCQT                          WGCCQT
     I              OMAUWG                          WGAUWG
     I              OMCBQT                          WGCBQT
     I              OMATWG                          WGATWG
     I              OMAQCS                          WGAQCS
     I              OMAGCS                          WGAGCS
     I              OMAKPR                          WGAKPR
     I              OMALPR                          WGALPR
     I              OMAUPR                          WGAUPR
     I              OMAVWG                          WGAVWG
     I              OMA4WG                          WGA4WG
     I              OMA5DT                          WGA5DT
     I              OMAODT                          WGAODT
     I              OMGNDT                          WGGNDT
     I              OMAMST                          WGAMST
     I              OMANST                          WGANST
     I              OMVAST                          WGVAST
     I              OMRGNB                          WGRGNB
     I              OMRHNB                          WGRHNB
     I              OMRINB                          WGRINB
     I              OMRBCD                          WGRBCD
     I              OMHICD                          WGHICD
     I              OMRNCD                          WGRNCD
     I              OMROCD                          WGROCD
     I              OMCXDT                          WGCXDT
     I              OMAJVN                          WGAJVN
     I              OMKXCD                          WGKXCD
     I              OMJPCD                          WGJPCD
     I              OMCQCD                          WGCQCD
     I              OMR4CD                          WGR4CD
     I              OMZ1ST                          WGZ1ST
     I              OMZ3ST                          WGZ3ST
     I              OMZ4ST                          WGZ4ST
     I              OMDUPR                          WGDUPR
     I              OMB6VL                          WGB6VL
     I              OMA1AA                          WGA1AA
     I              OMFZSX                          WGFZSX
     I              OMF0SX                          WGF0SX
     I              OMF1SX                          WGF1SX
     I              OMF2SX                          WGF2SX
     I              OMF3SX                          WGF3SX
     I              OMF4SX                          WGF4SX
     I              OMF5SX                          WGF5SX
     I              OMF6SX                          WGF6SX
     I              OMF7SX                          WGF7SX
     I              OMNTDT                          WGNTDT
     I              OMNUDT                          WGNUDT
     I              OMNVDT                          WGNVDT
     I              OMNWDT                          WGNWDT
     I              OMNXDT                          WGNXDT
     I              OMBUTM                          WGBUTM
     I              OMBVTM                          WGBVTM
     I              OMBWTM                          WGBWTM
     I              OMBXTM                          WGBXTM
     I              OMBYTM                          WGBYTM
     I              OMH5NX                          WGH5NX
     I              OMH6NX                          WGH6NX
     I              OMH7NX                          WGH7NX
     I              OMH8NX                          WGH8NX
     I              OMH9NX                          WGH9NX
     I              OMDVPR                          WGDVPR
     I              OMDWPR                          WGDWPR
     I              OMDXPR                          WGDXPR
     I              OMDYPR                          WGDYPR
     I              OMDZPR                          WGDZPR
     I              OMGSPR                          WGGSPR
     I              OMGTPR                          WGGTPR
     I              OMGUPR                          WGGUPR
     I              OMHOST                          WGHOST
     I              OMHPST                          WGHPST
     I              OMIOST                          WGIOST
     I              OMPEWG                          WGPEWG
     I              OMRINY                          WGRINY
     I              OMTIDT                          WGTIDT
     I              OMTJDT                          WGTJDT
     I              OMH2ST                          WGH2ST
     I              OMH0ST                          WGH0ST
     I              OMH1ST                          WGH1ST
     I              OMTKDT                          WGTKDT
     I              OMTLDT                          WGTLDT
     I              OMTMDT                          WGTMDT
     I              OMUVST                          WGUVST
     I              OMUWST                          WGUWST
     I              OMUXST                          WGUXST
     I              OMAATM                          WGAATM
     I              OMAYNA                          WGAYNA
     I              OMA0NA                          WGA0NA
     I              OMAXDT                          WGAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WHAIC3
     I              BEC4NB                          WHC4NB
     I              BEJNCD                          WHJNCD
     I              BEANC7                          WHANC7
     I              BEBKC7                          WHBKC7
     I              BEBRTX                          WHBRTX
     I              BEHMNA                          WHHMNA
     I              BEHONA                          WHHONA
     I              BEHPNA                          WHHPNA
     I              BEHNNA                          WHHNNA
     I              BEDBCD                          WHDBCD
     I              BECKTX                          WHCKTX
     I              BEB0C7                          WHB0C7
     I              BEAETX                          WHAETX
     I              BEB1NA                          WHB1NA
     I              BEB3NA                          WHB3NA
     I              BEB4NA                          WHB4NA
     I              BEB2NA                          WHB2NA
     I              BEBHCD                          WHBHCD
     I              BEC8TX                          WHC8TX
     I              BEBCNA                          WHBCNA
     I              BEA0DT                          WHA0DT
     I              BEA5DT                          WHA5DT
     I              BEGNDT                          WHGNDT
     I              BEACDT                          WHACDT
     I              BEAQCD                          WHAQCD
     I              BEB6NA                          WHB6NA
     I              BEBYNA                          WHBYNA
     I              BEBZNA                          WHBZNA
     I              BEGTST                          WHGTST
     I              BEGVST                          WHGVST
     I              BEGUST                          WHGUST
     I              BEQFST                          WHQFST
     I              BECQCD                          WHCQCD
     I              BEGJST                          WHGJST
     I              BEGWST                          WHGWST
     I              BEGXST                          WHGXST
     I              BEGYST                          WHGYST
     I              BEAODT                          WHAODT
     I              BEAIVN                          WHAIVN
     I              BECXDT                          WHCXDT
     I              BEJZVA                          WHJZVA
     I              BEA1WG                          WHA1WG
     I              BEXIST                          WHXIST
     I              BEXJST                          WHXJST
     I              BEXKST                          WHXKST
     I              BEEIDT                          WHEIDT
     I              BEAFTM                          WHAFTM
     I              BEE8CD                          WHE8CD
     I              BEE9CD                          WHE9CD
     I              BERMNB                          WHRMNB
     I              BETBNB                          WHTBNB
     I              BER1NB                          WHR1NB
     I              BEPJST                          WHPJST
     I              BEU0ST                          WHU0ST
     I              BEU1ST                          WHU1ST
     I              BEQ2CD                          WHQ2CD
     I              BEU2ST                          WHU2ST
     I              BEVEST                          WHVEST
     I              BEVFST                          WHVFST
     I              BEVGST                          WHVGST
     I              BERPCD                          WHRPCD
     I              BERNNB                          WHRNNB
     I              BEVDST                          WHVDST
     I              BEATIN                          WHATIN
     I              BEU4ST                          WHU4ST
     I              BEU5ST                          WHU5ST
     I              BERSRN                          WHRSRN
     I              BEMHNA                          WHMHNA
     I              BEMINA                          WHMINA
     I              BEWBST                          WHWBST
     I              BER4CD                          WHR4CD
     I              BEBFCD                          WHBFCD
     I              BEQ4CD                          WHQ4CD
     I              BET3NB                          WHT3NB
     I              BESICD                          WHSICD
     I              BECONB                          WHCONB
     I              BECEST                          WHCEST
     I              BEAWDT                          WHAWDT
     I              BEJPCD                          WHJPCD
     I              BEXUST                          WHXUST
     I              BEZ1ST                          WHZ1ST
     I              BEVRVA                          WHVRVA
     I              BEOBST                          WHOBST
     I              BEBCST                          WHBCST
     I              BEBDST                          WHBDST
     I              BEB7VL                          WHB7VL
     I              BEGASX                          WHGASX
     I              BEGBSX                          WHGBSX
     I              BEGCSX                          WHGCSX
     I              BEGDSX                          WHGDSX
     I              BEFNSX                          WHFNSX
     I              BEFOSX                          WHFOSX
     I              BEFPSX                          WHFPSX
     I              BEFQSX                          WHFQSX
     I              BEFRSX                          WHFRSX
     I              BEFSSX                          WHFSSX
     I              BEFTSX                          WHFTSX
     I              BEFUSX                          WHFUSX
     I              BEFVSX                          WHFVSX
     I              BEFWSX                          WHFWSX
     I              BEFXSX                          WHFXSX
     I              BEFYSX                          WHFYSX
     I              BENODT                          WHNODT
     I              BENPDT                          WHNPDT
     I              BENQDT                          WHNQDT
     I              BENRDT                          WHNRDT
     I              BENSDT                          WHNSDT
     I              BEBPTM                          WHBPTM
     I              BEBQTM                          WHBQTM
     I              BEBRTM                          WHBRTM
     I              BEBSTM                          WHBSTM
     I              BEBTTM                          WHBTTM
     I              BEH0NX                          WHH0NX
     I              BEH1NX                          WHH1NX
     I              BEH2NX                          WHH2NX
     I              BEH3NX                          WHH3NX
     I              BEH4NX                          WHH4NX
     I              BEC0C7                          WHC0C7
     I              BEUVST                          WHUVST
     I              BEUWST                          WHUWST
     I              BEUXST                          WHUXST
     I              BEAATM                          WHAATM
     I              BEAYNA                          WHAYNA
     I              BEA0NA                          WHA0NA
     I              BEAXDT                          WHAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPDI81    E DSPDI8CPL0
      * UPD : PS Prod Item Schedule     Update index
      * Renamed input format fields
     I              I8AIC3                          WDAIC3
     I              I8V5ST                          WDV5ST
     I              I8ELDT                          WDELDT
     I              I8HGCD                          WDHGCD
     I              I8AJCD                          WDAJCD
     I              I8GPDT                          WDGPDT
     I              I8WTSP                          WDWTSP
     I              I8QTSP                          WDQTSP
     I              I8DJPC                          WDDJPC
     I              I8F8WG                          WDF8WG
     I              I8WTIN                          WDWTIN
     I              I8D5NB                          WDD5NB
     I              I8DXWG                          WDDXWG
     I              I8B2NB                          WDB2NB
     I              I8WTCN                          WDWTCN
     I              I8PSCV                          WDPSCV
     I              I8SAWT                          WDSAWT
     I              I8B9NB                          WDB9NB
     I              I8D1WG                          WDD1WG
     I              I8CBNB                          WDCBNB
     I              I8EZWG                          WDEZWG
     I              I8CCNB                          WDCCNB
     I              I8E0WG                          WDE0WG
     I              I8D6NB                          WDD6NB
     I              I8OAWT                          WDOAWT
     I              I8CDNB                          WDCDNB
     I              I8UNW2                          WDUNW2
     I              I8CENB                          WDCENB
     I              I8F9WG                          WDF9WG
     I              I8BPNB                          WDBPNB
     I              I8GAWG                          WDGAWG
     I              I8BQNB                          WDBQNB
     I              I8GBWG                          WDGBWG
     I              I8BRNB                          WDBRNB
     I              I8GCWG                          WDGCWG
     I              I8BSNB                          WDBSNB
     I              I8GDWG                          WDGDWG
     I              I8BWNB                          WDBWNB
     I              I8GEWG                          WDGEWG
     I              I8PS6U                          WDPS6U
     I              I8WCST                          WDWCST
     I              I8WPST                          WDWPST
     I              I8B5ST                          WDB5ST
     I              I8TFST                          WDTFST
     I              I8TEST                          WDTEST
     I              I8THST                          WDTHST
     I              I8UDST                          WDUDST
     I              I8UFST                          WDUFST
     I              I8UGST                          WDUGST
     I              I8UHST                          WDUHST
     I              I8B6ST                          WDB6ST
     I              I8B7ST                          WDB7ST
     I              I8DVWG                          WDDVWG
     I              I8D7NB                          WDD7NB
     I              I8FCAD                          WDFCAD
     I              I8D9NB                          WDD9NB
     I              I8DWWG                          WDDWWG
     I              I8EANB                          WDEANB
     I              I8SHWT                          WDSHWT
     I              I8EBNB                          WDEBNB
     I              I8AVWT                          WDAVWT
     I              I8ECNB                          WDECNB
     I              I8WTON                          WDWTON
     I              I8EDNB                          WDEDNB
     I              I8FNWT                          WDFNWT
     I              I8EENB                          WDEENB
     I              I8QTAS                          WDQTAS
     I              I8EFNB                          WDEFNB
     I              I8WAIO                          WDWAIO
     I              I8EGNB                          WDEGNB
     I              I8R3CD                          WDR3CD
     I              I8RGNB                          WDRGNB
     I              I8RHNB                          WDRHNB
     I              I8RINB                          WDRINB
     I              I8XRCD                          WDXRCD
     I              I8UVST                          WDUVST
     I              I8UWST                          WDUWST
     I              I8UXST                          WDUXST
     I              I8VSST                          WDVSST
     I              I8AATM                          WDAATM
     I              I8AYNA                          WDAYNA
     I              I8A0NA                          WDA0NA
     I              I8AXDT                          WDAXDT
      *
     IYARDCS      DS                            326
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPDKN1    E DSPDKNCPL0
      * UPD : Order Detail Schedule     Update index
      * Renamed input format fields
     I              KNAIC3                          WFAIC3
     I              KNC4NB                          WFC4NB
     I              KNDPNB                          WFDPNB
     I              KNUENB                          WFUENB
     I              KNJGDT                          WFJGDT
     I              KNAODT                          WFAODT
     I              KNAJCD                          WFAJCD
     I              KNAYAA                          WFAYAA
     I              KNHGCD                          WFHGCD
     I              KNIGQT                          WFIGQT
     I              KNFLWG                          WFFLWG
     I              KNIUQT                          WFIUQT
     I              KNF3WG                          WFF3WG
     I              KNIVQT                          WFIVQT
     I              KNF4WG                          WFF4WG
     I              KNP7ST                          WFP7ST
     I              KNP8ST                          WFP8ST
     I              KNQAST                          WFQAST
     I              KNUVST                          WFUVST
     I              KNUWST                          WFUWST
     I              KNUXST                          WFUXST
     I              KNVSST                          WFVSST
     I              KNAATM                          WFAATM
     I              KNAYNA                          WFAYNA
     I              KNA0NA                          WFA0NA
     I              KNAXDT                          WFAXDT
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * N :  Production Date RGT
     I                                    P   3   60P1GWDT
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * zzS Move Plan to Schd zz
      * Doc:  Move plan into schedule
     C                     EXSR UASUBR                     Doc:  Move plan
      * Rtv PrdDay Dte -Durtn RT - Calendar  * 
     C                     EXSR SARVGN
      * Move planned prod to scheduled prod, clear remaining values
      * RTV Chg Schd to Plan  RT - PS Prod Item Schedule  * 
     C                     EXSR SBRVGN
      * UPS Apply PR +Adj     PF - PS Production Adjustment  * 
     C                     CALL 'PDMAPFR'              90  UPS Apply PR +A
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0001  30       Company Number
     C                     PARM ##JDT     WQ0002  70       Production Date
     C                     PARM ##JDT     WQ0003  70       Production Date
     C                     PARM P1GWDT    WQ0004  70       Production Date
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMAPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * UPS Apply PR -Adj     PF - PS Production Adjustment  * 
     C                     CALL 'PDVZPFR'              90  UPS Apply PR -A
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0005  30       Company Number
     C                     PARM ##JDT     WQ0006  70       Production Date
     C                     PARM ##JDT     WQ0007  70       Production Date
     C                     PARM P1GWDT    WQ0008  70       Production Date
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDVZPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * UPS Re-Alc Ord By SD  IF
      * C6096 Deallocate order instead
      * Delete OP Order Detail Schedule
      * DLT Ord Dtl Schedule   RT - Order Detail Schedule  * 
     C                     EXSR SERVGN
      * Allocate the Orders
      * UPS Re-Alc Ord by SD  RT - PD Order Detail  * 
     C                     EXSR SGRVGN
      * UPS Apply FC +Adj     PF - PS Production Adjustment  * 
     C                     CALL 'PDXYPFR'              90  UPS Apply FC +A
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0051  30       Company Number
     C                     PARM ##JDT     WQ0052  70       Production Date
     C                     PARM ##JDT     WQ0053  70       Production Date
     C                     PARM P1GWDT    WQ0054  70       Production Date
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXYPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv PrdDay Dte -Durtn RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
      * Define keylist
     C           KPSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           WABCDT           Post to G/L Dat
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSA01           Company Number
     C                     Z-ADD##JDT     WABCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSA     SETLL@AFREY1                    *
     C           KRSSA     READE@AFREY1                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: WRK.Count USR EQ PAR.*Duration (factor)
     C           WUCNTU    IFEQ 21                         *IF
     C                     Z-ADDWABCDT    P1GWDT           *DATE
     C                     GOTO SAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C           KRSSA     READE@AFREY1                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Chg Schd to Plan  RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0002  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0003  70       PS Pieces Stand
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Establish starting position
     C           *LOVAL    SETLL@I8CPGN                    *
     C                     READ @I8CPGN                  90*
      * Data record not found
     C   90                MOVEL'USR1763' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Production Type is Schedule Saved in the am
     C           WBV5ST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.Production Type is Schedule
     C           WBV5ST    IFEQ 'S'                        *IF
      * Rtv Standard Wgt/Pcs  RT - PS Prod Item Schedule  * 
     C                     EXSR SCRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWBDXWG    WN0002           PS Weight Stand
     C                     Z-ADDWBB2NB    WN0003           PS Pieces Stand
     C                     END                             *FI
      * CASE: PAR.PS Pieces Standard is GT Zero
     C           WN0003    IFGT *ZERO                      *IF
     C           WN0002    DIV  WN0003    WN0001           PS Avg Piece Wg
     C                     END                             *FI
      * Chg Prod Item Schedule CH - PS Prod Item Schedule  * 
     C                     EXSR SDCHRC
     C                     END                             *FI
     C                     READ @I8CPGN                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Standard Wgt/Pcs  RT - PS Prod Item Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCV5ST           Production Type
     C                     KFLD           WCELDT           Production Date
     C                     KFLD           WCHGCD           Item Code
     C                     KFLD           WCAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWBAIC3    WCAIC3           Company Number
     C                     MOVEL'P'       WCV5ST           Production Type
     C                     Z-ADDWBELDT    WCELDT           Production Date
     C                     Z-ADDWBHGCD    WCHGCD           Item Code
     C                     MOVELWBAJCD    WCAJCD           Warehouse Code
      * Establish starting position
     C           KRSSC     CHAIN@I8CPUS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0002           PS Weight Stand
     C                     Z-ADD*ZERO     WN0003           PS Pieces Stand
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCDXWG    WN0002           PS Weight Stand
     C                     Z-ADDWCB2NB    WN0003           PS Pieces Stand
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCHRC    BEGSR
      *================================================================
      * Chg Prod Item Schedule CH - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0004  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0005  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0006  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0007  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0008  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0009  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0010  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0011  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0012 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0013  70       PS Pieces Whse
     C                     Z-ADD*ZERO     WN0014 112       PS Weight Whse
     C                     Z-ADD*ZERO     WN0015  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0016 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0017  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0018 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0019  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0020 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0021  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0022 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0023  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0024  3        PS Item Id
     C                     MOVEL*BLANK    WN0025  2        Warehouse Type
     C                     MOVEL*BLANK    WN0026  1        PS Lock Status
     C                     MOVEL*BLANK    WN0027  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0028  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0029  1        PS Piece Count
     C                     MOVEL*BLANK    WN0030  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0031  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0032  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0033  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0034  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0035  3        PS Production W
     C                     Z-ADD*ZERO     WN0036  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0037  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0038  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0039  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0040  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0041  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0042  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0043  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0044  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0045  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0046  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0047  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0048  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0049  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0050  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0051  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0052  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0053  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0054  6        Department Code
     C                     Z-ADD*ZERO     WN0055  30       Item Structure
     C                     Z-ADD*ZERO     WN0056  30       Item Structure
     C                     Z-ADD*ZERO     WN0057  30       Item Structure
     C                     MOVEL*BLANK    WN0058  6        Primal Group Co
     C                     MOVEL*BLANK    WN0059  1        EDI Status 1
     C                     MOVEL*BLANK    WN0060  1        EDI Status 2
     C                     MOVEL*BLANK    WN0061  1        EDI Status 3
     C                     MOVEL*BLANK    WN0062  1        Record Status
     C                     Z-ADD*ZERO     WN0063  60       Job Time
     C                     MOVEL*BLANK    WN0064 10        User Id
     C                     MOVEL*BLANK    WN0065 10        Job Name
     C                     Z-ADD*ZERO     WN0066  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @I8CPUR
     C                     Z-ADDWBAIC3    WDAIC3           Company Number
     C                     MOVELWBV5ST    WDV5ST    P      Production Type
     C                     Z-ADDWBELDT    WDELDT           Production Date
     C                     Z-ADDWBHGCD    WDHGCD           Item Code
     C                     MOVELWBAJCD    WDAJCD    P      Warehouse Code
      *
     C           KLCHSD    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDV5ST           Production Type
     C                     KFLD           WDELDT           Production Date
     C                     KFLD           WDHGCD           Item Code
     C                     KFLD           WDAJCD           Warehouse Code
     C           KLCHSD    CHAIN@I8CPUR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI8CPL0'MDACP
     C                     MOVEL'@I8CPUR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDI81    YARDCS
      * Move non-key fields to @I8CPUR
     C                     Z-ADDWN0001    WDF8WG           PS Avg Piece Wg
     C                     Z-ADDWBWTIN    WDWTIN           PS Weight Inv O
     C                     Z-ADDWBD5NB    WDD5NB           PS Pieces Inv O
     C                     Z-ADDWN0002    WDDXWG           PS Weight Stand
     C                     Z-ADDWN0003    WDB2NB           PS Pieces Stand
     C                     Z-ADD*ZERO     WDWTCN           PS Weight Conve
     C                     Z-ADD*ZERO     WDPSCV           PS Pieces Conve
     C                     Z-ADD*ZERO     WDD1WG           PS Weight Prod
     C                     Z-ADD*ZERO     WDCBNB           PS Pieces Prod
     C                     Z-ADDWBEZWG    WDEZWG           PS Weight Inv A
     C                     Z-ADDWBCCNB    WDCCNB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WDOAWT           PS Weight Prod
     C                     Z-ADD*ZERO     WDCDNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WDUNW2           PS Weight Inv A
     C                     Z-ADD*ZERO     WDCENB           PS Pieces Inv A
      *
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * UPS CHGOBJ Stamp      IF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##PGM     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@I8CPUR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDI8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * DLT Ord Dtl Schedule   RT - Order Detail Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIC3    WQSE01           Company Number
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSE01           Company Number
      * Establish starting position
     C           KRSSE     SETLL@KNCPHO                    *
     C           KRSSE     READE@KNCPHO                  90*
      * Data record not found
     C   90                MOVEL'USR2238' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DLT Ord Detail Sched   DL - Order Detail Schedule  * 
     C                     EXSR SFDLRC
     C           KRSSE     READE@KNCPHO                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFDLRC    BEGSR
      *================================================================
      * DLT Ord Detail Sched   DL - Order Detail Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @KNCPHN
     C                     Z-ADDWEAIC3    WFAIC3           Company Number
     C                     Z-ADDWEC4NB    WFC4NB           Order Number
     C                     Z-ADDWEDPNB    WFDPNB           Order Sequence
     C                     Z-ADDWEUENB    WFUENB           Order Secondary
     C                     Z-ADDWEJGDT    WFJGDT           OD Production D
      *
     C           KLDLSF    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFC4NB           Order Number
     C                     KFLD           WFDPNB           Order Sequence
     C                     KFLD           WFUENB           Order Secondary
     C                     KFLD           WFJGDT           OD Production D
     C           KLDLSF    CHAIN@KNCPHN              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDKNCPL0'MDACP
     C                     MOVEL'@KNCPHN' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@KNCPHN                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * UPS Re-Alc Ord by SD  RT - PD Order Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0067  1        Order Scheduled
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGAIC3    WQSG01           Company Number
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSG01           Company Number
      * Establish starting position
     C           KRSSG     SETLL@BGWKKJ                    *
     C           KRSSG     READE@BGWKKJ                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Header Status      RT - PD Order Header  * 
     C                     EXSR SHRVGN
      * CASE: WRK.Header Status is Conf/Comp/Canc
     C           WUGWST    IFEQ 'X'                        *IF
     C           WUGWST    OREQ 'C'
     C           WUGWST    OREQ 'R'
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Order Sched Today  RT - Order Detail Schedule  * 
     C                     EXSR SIRVGN
      * Re-Allocate Order if Quantity Scheduled > 0 & order not scheduled
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Quantity Scheduled is Greater than zero
      *   |- c2    : PAR.Order Scheduled Today USR is no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WGCCQT    IFGT *ZERO                      *IF
     C           WN0067    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: PAR.Order De-Alc/Alc Sts USR is De-Allocate
     C           'A'       IFEQ 'D'                        *IF
     C                     Z-ADDWGCCQT    WUCCQT           Quantity Schedu
     C                     Z-ADDWGAUWG    WUAUWG           Weight Schedule
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WGAIC3    WQ0009  30       Company Number
     C                     PARM WGC4NB    WQ0010  70       Order Number
     C                     PARM WGDPNB    WQ0011  30       Order Sequence
     C                     PARM WGUENB    WQ0012  30       Order Secondary
     C                     PARM WGHGCD    WQ0013  70       Item Code
     C                     PARM WGAJCD    WQ0014  3        Warehouse Code
     C                     PARM WGRPCD    WQ0015  1        Age Code
     C                     PARM WGAODT    WQ0016  70       Ship Date USR
     C                     PARM *ZERO     WQ0017 112       Quantity Ordere
     C                     PARM *ZERO     WQ0018 112       Weight Ordered
     C           WUCCQT    PARM WUCCQT    WQ0019 112       Quantity Schedu
     C           WUAUWG    PARM WUAUWG    WQ0020 112       Weight Schedule
     C                     PARM 'OD'      WQ0021  2        ATS Adj Type US
     C                     PARM 'REALC'   WQ0022 10        PSAA Program Na
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: PAR.Order De-Alc/Alc Sts USR is Allocate
     C           'A'       IFEQ 'A'                        *IF
      * *-------------------------------------------------------------*
      * * 05/17/02 PKD PK0421 Commented the deallocate.
      * C6096 Deallocate order instead of deleted Detail Schedule
     C                     Z-ADD*ZERO     WUCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WUAUWG           Weight Schedule
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WGAIC3    WQ0023  30       Company Number
     C                     PARM WGC4NB    WQ0024  70       Order Number
     C                     PARM WGDPNB    WQ0025  30       Order Sequence
     C                     PARM WGUENB    WQ0026  30       Order Secondary
     C                     PARM WGHGCD    WQ0027  70       Item Code
     C                     PARM WGAJCD    WQ0028  3        Warehouse Code
     C                     PARM WGRPCD    WQ0029  1        Age Code
     C                     PARM WGAODT    WQ0030  70       Ship Date USR
     C                     PARM WGCCQT    WQ0031 112       Quantity Ordere
     C                     PARM WGAUWG    WQ0032 112       Weight Ordered
     C           WUCCQT    PARM WUCCQT    WQ0033 112       Quantity Schedu
     C           WUAUWG    PARM WUAUWG    WQ0034 112       Weight Schedule
     C                     PARM 'OA'      WQ0035  2        ATS Adj Type US
     C                     PARM 'REALC'   WQ0036 10        PSAA Program Na
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: DB1.Quantity Scheduled GT WRK.Quantity Scheduled
     C           WGCCQT    IFGT WUCCQT                     *IF
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WGAIC3    WQ0037  30       Company Number
     C                     PARM WGC4NB    WQ0038  70       Order Number
     C                     PARM WGDPNB    WQ0039  30       Order Sequence
     C                     PARM WGUENB    WQ0040  30       Order Secondary
     C                     PARM WGHGCD    WQ0041  70       Item Code
     C                     PARM WGAJCD    WQ0042  3        Warehouse Code
     C                     PARM WGRPCD    WQ0043  1        Age Code
     C                     PARM WGAODT    WQ0044  70       Ship Date USR
     C                     PARM WGCCQT    WQ0045 112       Quantity Ordere
     C                     PARM WGAUWG    WQ0046 112       Weight Ordered
     C           WUCCQT    PARM WUCCQT    WQ0047 112       Quantity Schedu
     C           WUAUWG    PARM WUAUWG    WQ0048 112       Weight Schedule
     C                     PARM 'AO'      WQ0049  2        ATS Adj Type US
     C                     PARM 'REALC'   WQ0050 10        PSAA Program Na
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSG     READE@BGWKKJ                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Header Status      RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHC4NB           Order Number
      * Setup key
     C                     Z-ADDWGAIC3    WHAIC3           Company Number
     C                     Z-ADDWGC4NB    WHC4NB           Order Number
      * Establish starting position
     C           KRSSH     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHGWST    WUGWST           Header Status
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Order Sched Today  RT - Order Detail Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WN0067           Order Scheduled
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIC3    WQSI01           Company Number
     C           *LIKE     DEFN WEC4NB    WQSI02           Order Number
     C           *LIKE     DEFN WEDPNB    WQSI03           Order Sequence
     C           *LIKE     DEFN WEUENB    WQSI04           Order Secondary
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Company Number
     C                     KFLD           WQSI02           Order Number
     C                     KFLD           WQSI03           Order Sequence
     C                     KFLD           WQSI04           Order Secondary
      * Setup key
     C                     Z-ADDWGAIC3    WQSI01           Company Number
     C                     Z-ADDWGC4NB    WQSI02           Order Number
     C                     Z-ADDWGDPNB    WQSI03           Order Sequence
     C                     Z-ADDWGUENB    WQSI04           Order Secondary
      * Establish starting position
     C           KRSSI     SETLL@KNCPHO                    *
     C           KRSSI     READE@KNCPHO                  90*
      * Data record not found
     C   90                MOVEL'USR2238' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.OD Production Date EQ JOB.*Job date
     C           WEJGDT    IFEQ ##JDT                      *IF
     C                     MOVEL'Y'       WN0067           Order Scheduled
     C                     GOTO SIEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSI     READE@KNCPHO                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Doc:  Move plan into schedule
      *================================================================
      * This program will move the planned production into the scheduled
      * production for today.  Basically moving from the schedule to the
      * plan
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1GWDT           Production Date
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WABCDT           Post to G/L Dat
     C                     Z-ADD*ZERO     WACQNB           Julian Date
     C                     Z-ADD*ZERO     WAESNB           Accounting Year
     C                     Z-ADD*ZERO     WAETNB           Accounting Peri
     C                     Z-ADD*ZERO     WABZNB           OM Week
     C                     Z-ADD*ZERO     WAEINB           Week Number
     C                     Z-ADD*ZERO     WAAQNB           Billing Cycle
     C                     Z-ADD*ZERO     WAOJDT           HPS PIC Date
     C                     Z-ADD*ZERO     WANQNX           HPS Calendar Ye
     C                     Z-ADD*ZERO     WANRNX           HPS Calendar We
     C                     Z-ADD*ZERO     WAOKDT           Calendar Unused
     C                     Z-ADD*ZERO     WAOLDT           Calendar Unused
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Count USR
     C                     Z-ADD*ZERO     WUCNTU  50
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBELDT           Production Date
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBGPDT           PS Available Sh
     C                     Z-ADD*ZERO     WBWTSP           PS Weight Plann
     C                     Z-ADD*ZERO     WBQTSP           PS Pieces Plann
     C                     Z-ADD*ZERO     WBDJPC           PS % of Carcass
     C                     Z-ADD*ZERO     WBF8WG           PS Avg Piece Wg
     C                     Z-ADD*ZERO     WBWTIN           PS Weight Inv O
     C                     Z-ADD*ZERO     WBD5NB           PS Pieces Inv O
     C                     Z-ADD*ZERO     WBDXWG           PS Weight Stand
     C                     Z-ADD*ZERO     WBB2NB           PS Pieces Stand
     C                     Z-ADD*ZERO     WBWTCN           PS Weight Conve
     C                     Z-ADD*ZERO     WBPSCV           PS Pieces Conve
     C                     Z-ADD*ZERO     WBSAWT           PS Weight Shipp
     C                     Z-ADD*ZERO     WBB9NB           PS Pieces Shipp
     C                     Z-ADD*ZERO     WBD1WG           PS Weight Prod
     C                     Z-ADD*ZERO     WBCBNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WBEZWG           PS Weight Inv A
     C                     Z-ADD*ZERO     WBCCNB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WBE0WG           PS Weight Ship
     C                     Z-ADD*ZERO     WBD6NB           PS Pieces Ship
     C                     Z-ADD*ZERO     WBOAWT           PS Weight Prod
     C                     Z-ADD*ZERO     WBCDNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WBUNW2           PS Weight Inv A
     C                     Z-ADD*ZERO     WBCENB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WBF9WG           PS Unit Weight
     C                     Z-ADD*ZERO     WBBPNB           PS Pieces Whse
     C                     Z-ADD*ZERO     WBGAWG           PS Weight Whse
     C                     Z-ADD*ZERO     WBBQNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WBGBWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WBBRNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WBGCWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WBBSNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WBGDWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WBBWNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WBGEWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WBPS6U           PS Pieces Unuse
     C                     Z-ADD*ZERO     WBDVWG           PS Weight Order
     C                     Z-ADD*ZERO     WBD7NB           PS Pieces Order
     C                     Z-ADD*ZERO     WBFCAD           PS Weight FC Ad
     C                     Z-ADD*ZERO     WBD9NB           PS Pieces FC Ad
     C                     Z-ADD*ZERO     WBDWWG           PS Weight FX Ad
     C                     Z-ADD*ZERO     WBEANB           PS Pieces FX Ad
     C                     Z-ADD*ZERO     WBSHWT           PS Weight Sched
     C                     Z-ADD*ZERO     WBEBNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WBAVWT           PS Weight Avail
     C                     Z-ADD*ZERO     WBECNB           PS Pieces Avail
     C                     Z-ADD*ZERO     WBWTON           PS Weight Produ
     C                     Z-ADD*ZERO     WBEDNB           PS Pieces Produ
     C                     Z-ADD*ZERO     WBFNWT           PS Weight Fab N
     C                     Z-ADD*ZERO     WBEENB           PS Pieces Fab N
     C                     Z-ADD*ZERO     WBQTAS           PS Weight Sched
     C                     Z-ADD*ZERO     WBEFNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WBWAIO           PS Weight Sched
     C                     Z-ADD*ZERO     WBEGNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WBRGNB           Item Structure
     C                     Z-ADD*ZERO     WBRHNB           Item Structure
     C                     Z-ADD*ZERO     WBRINB           Item Structure
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEC4NB           Order Number
     C                     Z-ADD*ZERO     WEDPNB           Order Sequence
     C                     Z-ADD*ZERO     WEUENB           Order Secondary
     C                     Z-ADD*ZERO     WEJGDT           OD Production D
     C                     Z-ADD*ZERO     WEAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WEHGCD           Item Code
     C                     Z-ADD*ZERO     WEIGQT           OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WEFLWG           OD Weight Sched
     C                     Z-ADD*ZERO     WEIUQT           OD Quantity Inv
     C                     Z-ADD*ZERO     WEF3WG           OD Weight Inv S
     C                     Z-ADD*ZERO     WEIVQT           OD Quantity Unu
     C                     Z-ADD*ZERO     WEF4WG           OD Weight Unuse
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGC4NB           Order Number
     C                     Z-ADD*ZERO     WGDPNB           Order Sequence
     C                     Z-ADD*ZERO     WGUENB           Order Secondary
     C                     Z-ADD*ZERO     WGHGCD           Item Code
     C                     Z-ADD*ZERO     WGBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WGCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WGMAVA           Billing Detail
     C                     Z-ADD*ZERO     WGKDVA           Billing Detail
     C                     Z-ADD*ZERO     WGL8VA           Billing Detail
     C                     Z-ADD*ZERO     WGL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WGAYVA           Extended Amount
     C                     Z-ADD*ZERO     WGEXDT           Market Pricing
     C                     Z-ADD*ZERO     WGBZPR           Price Overage O
     C                     Z-ADD*ZERO     WGL6NB           Contract Number
     C                     Z-ADD*ZERO     WGGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WGR1NB           Rated Freight
     C                     Z-ADD*ZERO     WGAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WGD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WGCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WGAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WGCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WGATWG           Weight Shipped
     C                     Z-ADD*ZERO     WGAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WGAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WGAKPR           Unit Price
     C                     Z-ADD*ZERO     WGALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WGAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WGAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WGA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WGA5DT           Requested Ship
     C                     Z-ADD*ZERO     WGAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WGGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WGRGNB           Item Structure
     C                     Z-ADD*ZERO     WGRHNB           Item Structure
     C                     Z-ADD*ZERO     WGRINB           Item Structure
     C                     Z-ADD*ZERO     WGCXDT           Date of Origina
     C                     Z-ADD*ZERO     WGDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WGB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WGA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WGNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WGNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WGNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WGNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WGNXDT           OD Unused Date
     C                     Z-ADD*ZERO     WGBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WGBVTM           Price Code
     C                     Z-ADD*ZERO     WGBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WGBXTM           Substitution Li
     C                     Z-ADD*ZERO     WGBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WGH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WGH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WGH7NX           OD Item Target
     C                     Z-ADD*ZERO     WGH8NX           OD Minimum Unit
     C                     Z-ADD*ZERO     WGH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WGDVPR           Order Gate Pric
     C                     Z-ADD*ZERO     WGDWPR           OD Base MKT Ovr
     C                     Z-ADD*ZERO     WGDXPR           OD Unused Prc 3
     C                     Z-ADD*ZERO     WGDYPR           OD Unused Prc 4
     C                     Z-ADD*ZERO     WGDZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WGGSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     WGGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WGGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WGPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WGRINY           Delv Ageing Day
     C                     Z-ADD*ZERO     WGTIDT           Production Ovr
     C                     Z-ADD*ZERO     WGTJDT           Production Ovr
     C                     Z-ADD*ZERO     WGTKDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WGTLDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WGTMDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Define work field Header Status
     C                     MOVEL*BLANK    WUGWST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHC4NB           Order Number
     C                     Z-ADD*ZERO     WHANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WHBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WHB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WHA0DT           Order Date
     C                     Z-ADD*ZERO     WHA5DT           Requested Ship
     C                     Z-ADD*ZERO     WHGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WHACDT           Cancel Date
     C                     Z-ADD*ZERO     WHAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WHCXDT           Date of Origina
     C                     Z-ADD*ZERO     WHJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WHA1WG           Order Weight To
     C                     Z-ADD*ZERO     WHEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WHAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WHRMNB           Load ID
     C                     Z-ADD*ZERO     WHTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WHR1NB           Rated Freight
     C                     Z-ADD*ZERO     WHRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WHATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WHRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WHT3NB           Attach to Order
     C                     Z-ADD*ZERO     WHCONB           Invoice Number
     C                     Z-ADD*ZERO     WHAWDT           Invoice Date
     C                     Z-ADD*ZERO     WHVRVA           A/R order Value
     C                     Z-ADD*ZERO     WHB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WHNODT           OH Unused Date
     C                     Z-ADD*ZERO     WHNPDT           OH Unused Date
     C                     Z-ADD*ZERO     WHNQDT           OH Unused Date
     C                     Z-ADD*ZERO     WHNRDT           OH Unused Date
     C                     Z-ADD*ZERO     WHNSDT           OH Unused Date
     C                     Z-ADD*ZERO     WHBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WHBQTM           Time of Origina
     C                     Z-ADD*ZERO     WHBRTM           OH Unused Time
     C                     Z-ADD*ZERO     WHBSTM           OH Unused Time
     C                     Z-ADD*ZERO     WHBTTM           OH Unused Time
     C                     Z-ADD*ZERO     WHH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WHH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WHH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WHH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WHH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WHC0C7           Claim Number
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Define work field Quantity Scheduled
     C                     Z-ADD*ZERO     WUCCQT 112
      * Define work field Weight Scheduled
     C                     Z-ADD*ZERO     WUAUWG 112
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
