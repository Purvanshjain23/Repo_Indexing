// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PBL6XFR
// ?Date: 14.08.2025 Time: 03:48:30
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?Change Log
DO;

//?PIO 03/05/24 CHANGED FILE NAME FROM PDLHCPLI TO PDLHCPLM
DO;

ENDDO;

ENDDO;

//?Log order changes
DO;

EXECUTE FUNCTION(RTV Last OrdSeq-NoLID RT) TYPE(RTVOBJ) FILE(PDLHCPP)           AC2086450;
PARAMETER(PAR.Order_Number);
PARAMETER(PAR.Created_Date);
PARAMETER(PAR.Created_Time);
PARAMETER(PAR.Sequence_Number);
{
 //?USER: Processing if Data record not found

 // PAR.Sequence Number = CON.1
 PAR.Sequence_Number = 1;

 // PGM.*Return code = CND.*Record does not exist
 PGM.*Return_code = 'Y2U0005';

 //?USER: Process Data record

 CASE;

 // IF DB1.Sequence Number is EQ 999
 IF DB1.Sequence_Number = 999;

 // IF *OTHERWISE
 IF *OTHERWISE;

 // PAR.Sequence Number = DB1.Sequence Number + CON.1
 PAR.Sequence_Number = DB1.Sequence_Number + 1;

 ENDIF;

}


// PGM.*Return code = CND.*Record already exists
PGM.*Return_code = 'Y2U0003';

//?Loop thru to do create
// DOW PGM.*Return code is *Record already exists
DOW PGM.*Return_code = 'Y2U0003';

EXECUTE FUNCTION(CRT Load/Order Chg Log CR) TYPE(CRTOBJ) FILE(PDLHCPP)          AC1465744;
PARAMETER(JOB.*Job_date);
PARAMETER(JOB.*Job_time);
PARAMETER(PAR.Sequence_Number);
PARAMETER(PAR.Load_ID);
PARAMETER(PAR.USR_Stop_Drop);
PARAMETER(PAR.Load_Change_Type);
PARAMETER(PAR.Department_Control_Code);
PARAMETER(PAR.Change_Log_Prior_Value);
PARAMETER(PAR.Change_Log_New_Value);
PARAMETER(PAR.User_Id);
PARAMETER(PAR.Job_Name);
PARAMETER(PAR.Carrier_Code);
PARAMETER(PAR.Carrier_Broker_Carrier_Co);
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Order_Number);
{
 //?USER: Processing if Data record already exists

 // PGM.*Return code = CND.*Record already exists
 PGM.*Return_code = 'Y2U0003';

 //?USER: Processing after Data update

 // PGM.*Return code = CND.*Normal
 PGM.*Return_code = *BLANK;

}


CASE;

// IF PGM.*Return code is *Record already exists
IF PGM.*Return_code = 'Y2U0003';

// PAR.Sequence Number = PAR.Sequence Number + CON.1
PAR.Sequence_Number = PAR.Sequence_Number + 1;

ENDIF;

ENDDO;

ENDDO;

