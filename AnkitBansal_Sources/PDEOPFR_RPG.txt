     H/TITLE PRT Sls Tax by Cnt/St PF  Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by  : 2E  Version:  1135
     H* Function type : Print file
      *
     H* Company       : OMS Development Model         lopment-
     H* System        : OMS Development Model
     H* User name     : ISSMASO
     H* Date          : 07/12/04  Time  : 16:09:13
     H* Copyright     : OMS Development Model         lopment-
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FOMHSTPLJIF  E           K        DISK
      * RSQ : Sales History            RSQ Co/Exprt Cntry/Shp St
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FOMFAREL1IF  E           K        DISK
      * RTV : Item Structure Class      Retrieval index
      *
     FCAACREL1IF  E           K        DISK
      * RTV : State                     Retrieval index       NV
      *
     FOPEXREL2IF  E           K        DISK
      * RTV : Order Types               Active order Types
      *
     FOMHSTPM5IF  E           K        DISK
      * RSQ : Sales History             Co/ExCnt/St/ShDt/Cls/Itm
      *
     FOMBYREL1IF  E           K        DISK
      * RTV : Item Default              Retrieval index
      *
     FPDEOPFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: PRT Sls Tax by Cnt/St PF  Print file
      *
     E                    UCT        40  1               CENTER TABLE
     E                    #L3         3  1
     E                    #L7         7  1
      * Long constants
     E                    @CN#    1   3  6   @CN    25
     I@HSTPYX
      * Sales History             Co/ExCnt/St/ShDt/Cls/Itm
      * Renamed input format fields
     I              F4AIC3                          WAAIC3
     I              F4C4NB                          WAC4NB
     I              F4DPNB                          WADPNB
     I              F4UENB                          WAUENB
     I              F4MONA                          WAMONA
     I              F4RJCD                          WARJCD
     I              F4RKCD                          WARKCD
     I              F4GPTX                          WAGPTX
     I              F4ABTX                          WAABTX
     I              F4KXCD                          WAKXCD
     I              F4BOCD                          WABOCD
     I              F4BTC7                          WABTC7
     I              F4ANC7                          WAANC7
     I              F4AQTX                          WAAQTX
     I              F4BKC7                          WABKC7
     I              F4BRTX                          WABRTX
     I              F4HNNA                          WAHNNA
     I              F4DBCD                          WADBCD
     I              F4CKTX                          WACKTX
     I              F4BCNA                          WABCNA
     I              F4A0DT                          WAA0DT
     I              F4ACDT                          WAACDT
     I              F4R4CD                          WAR4CD
     I              F4R5CD                          WAR5CD
     I              F4BFCD                          WABFCD
     I              F4Q4CD                          WAQ4CD
     I              F4AQCD                          WAAQCD
     I              F4TBNB                          WATBNB
     I              F4BZNA                          WABZNA
     I              F4RLCD                          WARLCD
     I              F4JNCD                          WAJNCD
     I              F4Q2CD                          WAQ2CD
     I              F4U2ST                          WAU2ST
     I              F4ATIN                          WAATIN
     I              F4T3NB                          WAT3NB
     I              F4RSRN                          WARSRN
     I              F4ORIT                          WAORIT
     I              F4AJCD                          WAAJCD
     I              F4AVQT                          WAAVQT
     I              F4D0WG                          WAD0WG
     I              F4CCQT                          WACCQT
     I              F4AUWG                          WAAUWG
     I              F4AGCD                          WAAGCD
     I              F4AKPR                          WAAKPR
     I              F4AUPR                          WAAUPR
     I              F4CRCD                          WACRCD
     I              F4A5DT                          WAA5DT
     I              F4AWDT                          WAAWDT
     I              F4HDDT                          WAHDDT
     I              F4AGCS                          WAAGCS
     I              F4AQCS                          WAAQCS
     I              F4AVWG                          WAAVWG
     I              F4AYVA                          WAAYVA
     I              F4AMST                          WAAMST
     I              F4ANST                          WAANST
     I              F4VAST                          WAVAST
     I              F4L6NB                          WAL6NB
     I              F4UMCD                          WAUMCD
     I              F4HCDT                          WAHCDT
     I              F4ESNB                          WAESNB
     I              F4ETNB                          WAETNB
     I              F4BZNB                          WABZNB
     I              F4EXQT                          WAEXQT
     I              F4BYWG                          WABYWG
     I              F4S5NB                          WAS5NB
     I              F4MAVA                          WAMAVA
     I              F4KDVA                          WAKDVA
     I              F4USVA                          WAUSVA
     I              F4UTVA                          WAUTVA
     I              F4A4WG                          WAA4WG
     I              F4CKNB                          WACKNB
     I              F4BMST                          WABMST
     I              F4R8NB                          WAR8NB
     I              F4RMCD                          WARMCD
     I              F4BZPR                          WABZPR
     I              F4RDCD                          WARDCD
     I              F4Q7CD                          WAQ7CD
     I              F4EXDT                          WAEXDT
     I              F4LQCD                          WALQCD
     I              F4HICD                          WAHICD
     I              F4RBCD                          WARBCD
     I              F4RGNB                          WARGNB
     I              F4RHNB                          WARHNB
     I              F4RINB                          WARINB
     I              F4R1NB                          WAR1NB
     I              F4CONB                          WACONB
     I              F4CEST                          WACEST
     I              F4GNDT                          WAGNDT
     I              F4RMNB                          WARMNB
     I              F4AODT                          WAAODT
     I              F4LLCD                          WALLCD
     I              F4LMCD                          WALMCD
     I              F4SKNB                          WASKNB
     I              F4SLNB                          WASLNB
     I              F4SMNB                          WASMNB
     I              F4G7NA                          WAG7NA
     I              F4ONVA                          WAONVA
     I              F4N0CD                          WAN0CD
     I              F4B4NB                          WAB4NB
     I              F4B5NB                          WAB5NB
     I              F4N1CD                          WAN1CD
     I              F4GIDT                          WAGIDT
     I              F4Z1ST                          WAZ1ST
     I              F4ULVA                          WAULVA
     I              F4UNVA                          WAUNVA
     I              F4UOVA                          WAUOVA
     I              F4UPVA                          WAUPVA
     I              F4UQVA                          WAUQVA
     I              F4SDCD                          WASDCD
     I              F4QZCD                          WAQZCD
     I              F4XWST                          WAXWST
     I              F4T9CD                          WAT9CD
     I              F4UBCD                          WAUBCD
     I              F4CFC7                          WACFC7
     I              F4X1CD                          WAX1CD
     I              F4GASX                          WAGASX
     I              F4DUPR                          WADUPR
     I              F4B6VL                          WAB6VL
     I              F4IANX                          WAIANX
     I              F4IBNX                          WAIBNX
     I              F4RPCD                          WARPCD
     I              F4NYDT                          WANYDT
     I              F4BZTM                          WABZTM
     I              F4Z4NB                          WAZ4NB
     I              F4XACD                          WAXACD
     I              F4OANA                          WAOANA
     I              F4OKTX                          WAOKTX
     I              F4K4TX                          WAK4TX
     I              F4NBBO                          WANBBO
     I              F4OCFR                          WAOCFR
     I              F4C0C7                          WAC0C7
     I              F4A1AA                          WAA1AA
     I              F4VEST                          WAVEST
     I              F4A5PR                          WAA5PR
     I              F4CDPR                          WACDPR
     I              F4D0PR                          WAD0PR
     I              F4D0VL                          WAD0VL
     I              F4IRSX                          WAIRSX
     I              F4CEVL                          WACEVL
     I              F4ISSX                          WAISSX
     I              F4ITSX                          WAITSX
     I              F4IUSX                          WAIUSX
     I              F4OHDT                          WAOHDT
     I              F4D9PR                          WAD9PR
     I              F4CFVL                          WACFVL
     I              F4UVST                          WAUVST
     I              F4UWST                          WAUWST
     I              F4UXST                          WAUXST
     I              F4AATM                          WAAATM
     I              F4AYNA                          WAAYNA
     I              F4A0NA                          WAA0NA
     I              F4AXDT                          WAAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS                             10
      * KEY: Sales History            RSQ Co/Exprt Cntry/Shp St
      * I : RST Company Number
     I                                    P   1   20P1AIC3
     IP2PARM      DS
      * I :  USR From Date
     I                                    P   1   40P2BDDT
     IP3PARM      DS
      * I :  USR To Date
     I                                    P   1   40P3FDDT
     IP4PARM      DS
      * FLD: *Arrays
      * B :  USR Warehouse Code
     I                                        1   3 P4CPCD
      * B :  USR CDE Parm 1
     I                                        4   6 P4VSCD
      * B :  USR CDE Parm 2
     I                                        7   9 P4VTCD
      * B :  USR CDE Parm 3
     I                                       10  12 P4VUCD
      * B :  USR CDE Parm 4
     I                                       13  15 P4VVCD
      * B :  USR CDE Parm 5
     I                                       16  18 P4VWCD
      * B :  USR CDE Parm 6
     I                                       19  21 P4VXCD
      * B :  USR CDE Parm 7
     I                                       22  24 P4VYCD
      * B :  USR CDE Parm 8
     I                                       25  27 P4VZCD
      * B :  USR CDE Parm 9
     I                                       28  30 P4V0CD
      * B :  USR Select/Omit Flag
     I                                       31  31 P4CYST
     IP5PARM      DS
      * I :  Export Status
     I                                        1   1 P5U2ST
     IP6PARM      DS
      * I :  Report seq-State/CntryUSR
     I                                        1   1 P6Y8ST
     IP7PARM      DS
      * I :  Report Type USR
     I                                        1   1 P7QBST
     IP8PARM      DS
      * I :  Item Structure Class Code
     I                                    P   1   20P8RINB
     IP9PARM      DS
      * I :  State
     I                                        1   2 P9EINA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C                     PARM           P1PARM           KEY: Sales Hist
     C           P2BDDT    PARM           WP0001  70       USR From Date
     C           P3FDDT    PARM           WP0002  70       USR To Date
     C           P4CPCD    PARM P4CPCD    WP0003  3        USR Warehouse C
     C           P4VSCD    PARM P4VSCD    WP0004  3        USR CDE Parm 1
     C           P4VTCD    PARM P4VTCD    WP0005  3        USR CDE Parm 2
     C           P4VUCD    PARM P4VUCD    WP0006  3        USR CDE Parm 3
     C           P4VVCD    PARM P4VVCD    WP0007  3        USR CDE Parm 4
     C           P4VWCD    PARM P4VWCD    WP0008  3        USR CDE Parm 5
     C           P4VXCD    PARM P4VXCD    WP0009  3        USR CDE Parm 6
     C           P4VYCD    PARM P4VYCD    WP0010  3        USR CDE Parm 7
     C           P4VZCD    PARM P4VZCD    WP0011  3        USR CDE Parm 8
     C           P4V0CD    PARM P4V0CD    WP0012  3        USR CDE Parm 9
     C           P4CYST    PARM P4CYST    WP0013  1        USR Select/Omit
     C           P5U2ST    PARM           WP0014  1        Export Status
     C           P6Y8ST    PARM           WP0015  1        Report seq-Stat
     C           P7QBST    PARM           WP0016  1        Report Type USR
     C           P8RINB    PARM           WP0017  30       Item Structure
     C           P9EINA    PARM           WP0018  2        State
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * PRT Sls Tax by Cnt/St PF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$XENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * PRT Sls Tax by Cnt/St PF: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN F4AIC3    WQKA01           Company Number
      * Define keylist
     C           KRSA      KLIST
     C                     KFLD           WQKA01           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WQKA01           Company Number
      * Establish starting position
     C           KRSA      SETLL@HSTPRD                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
      * USER: Null report processing
      * CLC Set for Null Rpt   US - /UT User Source  * 
     C                     MOVEL'Y'       W0AP1P
     C                     MOVEL'Y'       W0NEWP
     C                     MOVEL'Y'       WUGGST           USR Display fie
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        Company Number
     C                     MOVEL'Y'       W0AL01  1        Export Country
     C                     MOVEL'Y'       W0AL02  1        Ship To State C
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADD*ZERO     $WOQNB           Billing Detail
     C                     Z-ADD*ZERO     $WORNB           FOB Gross Amoun
     C                     Z-ADD*ZERO     $WNTNX           Weight Billed S
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADD*ZERO     $VNTNX           Weight Billed S
     C                     Z-ADDF4AIC3    $VAIC3           Company Number
     C                     Z-ADD*ZERO     $VOQNB           Billing Detail
     C                     Z-ADD*ZERO     $VORNB           FOB Gross Amoun
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Load key header format
     C                     MOVELF4UMCD    $CUMCD           Export Country
      * Load related totals format
     C                     Z-ADD*ZERO     $UOQNB           Billing Detail
     C                     Z-ADD*ZERO     $UORNB           FOB Gross Amoun
     C                     Z-ADD*ZERO     $UNTNX           Weight Billed S
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP01  1
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADDF4AIC3    $EAIC3           Company Number
     C                     MOVELF4DBCD    $EDBCD           Ship To State C
     C                     Z-ADD*ZERO     $EOQNB           Billing Detail
     C                     Z-ADD*ZERO     $EORNB           FOB Gross Amoun
     C                     Z-ADD*ZERO     $ENTNX           Weight Billed S
     C                     MOVELF4UMCD    $EUMCD           Export Country
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP02  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDF4KDVA    $DKDVA           Billing Detail
     C                     Z-ADDF4USVA    $DUSVA           FOB Gross Amoun
     C                     Z-ADDF4BYWG    $DBYWG           Weight Billed
     C                     MOVELF4GASX    $DGASX           Invoice Price T
     C                     Z-ADDF4DUPR    $DDUPR           Invoice Unit Pr
     C                     Z-ADDF4B6VL    $DB6VL           Invoice Extende
     C                     Z-ADDF4IANX    $DIANX           Req Shipping Te
     C                     Z-ADDF4IBNX    $DIBNX           Actual Shipping
     C                     MOVELF4RPCD    $DRPCD           Age Code
     C                     Z-ADDF4NYDT    $DNYDT           Req Delivery Da
     C                     Z-ADDF4BZTM    $DBZTM           Req Delivery Ti
     C                     Z-ADDF4Z4NB    $DZ4NB           MPC Number
     C                     MOVELF4XACD    $DXACD           Shipping Line
     C                     MOVELF4OANA    $DOANA           Sail Port Delv
     C                     MOVELF4OKTX    $DOKTX           Sail Port City
     C                     MOVELF4K4TX    $DK4TX           Vessel Name
     C                     MOVELF4NBBO    $DNBBO           Booking Number
     C                     Z-ADDF4OCFR    $DOCFR           Ocean Freight
     C                     Z-ADDF4C0C7    $DC0C7           Claim Number
     C                     Z-ADDF4A1AA    $DA1AA           Ham Group Numbe
     C                     MOVELF4VEST    $DVEST           Palletize
     C                     Z-ADDF4A5PR    $DA5PR           Commodity Marke
     C                     Z-ADDF4CDPR    $DCDPR           Market Value
     C                     Z-ADDF4D0PR    $DD0PR           Default Cmdty M
     C                     Z-ADDF4D0VL    $DD0VL           Raw Material Co
     C                     MOVELF4IRSX    $DIRSX           Sales Expense P
     C                     Z-ADDF4CEVL    $DCEVL           Sales Expense T
     C                     MOVELF4ISSX    $DISSX           Data Mart Proce
     C                     MOVELF4ITSX    $DITSX           LH Load Type
     C                     MOVELF4IUSX    $DIUSX           Sale Country
     C                     Z-ADDF4OHDT    $DOHDT           LD Sail Date
     C                     Z-ADDF4D9PR    $DD9PR           HST Unused Pric
     C                     Z-ADDF4CFVL    $DCFVL           HST Item Target
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * USER: Process after print of detail format
     C                     ADD  $DKDVA    $EOQNB           Billing Detail
     C                     ADD  $DUSVA    $EORNB           FOB Gross Amoun
     C                     ADD  $DBYWG    $ENTNX           Weight Billed S
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN F4AIC3    WZA001           Company Number
     C                     Z-ADDF4AIC3    WZA001
     C           *LIKE     DEFN F4UMCD    WZA002           Export Country
     C                     MOVELF4UMCD    WZA002
     C           *LIKE     DEFN F4DBCD    WZA003           Ship To State C
     C                     MOVELF4DBCD    WZA003
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C           KRSA      READE@HSTPRD                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * *** Check Warehouse Selections ***
      * CASE: WRK.Select all Warehouses USR is no
     C           WUYFST    IFEQ 'N'                        *IF
      * Check Warehouse Select/Omit
     C                     EXSR UFSUBR                     Check Warehouse
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        Company Number
     C                     MOVEL*BLANK    W0AL01  1        Export Country
     C                     MOVEL*BLANK    W0AL02  1        Ship To State C
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        Company Number
     C                     MOVEL'Y'       W0AL01  1        Export Country
     C                     MOVEL'Y'       W0AL02  1        Ship To State C
     C                     ELSE
      * Next record - Detect level breaks
     C           F4AIC3    IFNE WZA001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C           F4UMCD    IFNE WZA002                     Export Country
     C           W0AL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL01
     C                     END
     C           F4DBCD    IFNE WZA003                     Ship To State C
     C           W0AL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL02
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL02    IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 1
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$EKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP02
      * PRTOBJ calls after print of Ship To State Code format
      * Embedded PRTOBJ : PRT Shpd Items by Cls PO
     C                     EXSR UISUBR                     Embedded PRTOBJ
      * USER: Process after print of Ship To State Code format
     C                     ADD  $EOQNB    $UOQNB           Billing Detail
     C                     ADD  $EORNB    $UORNB           FOB Gross Amoun
     C                     ADD  $ENTNX    $UNTNX           Weight Billed S
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Export Country Code format
      * Setup Country Print Format
     C                     EXSR UMSUBR                     Setup Country P
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$UKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP01
      * USER: Process after print of Export Country Code format
     C                     ADD  $UOQNB    $VOQNB           Billing Detail
     C                     ADD  $UORNB    $VORNB           FOB Gross Amoun
     C                     ADD  $UNTNX    $VNTNX           Weight Billed S
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Mention hidden format
     C   99N99             WRITE$VKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
      * USER: Process after print of Company Number format
     C                     ADD  $VORNB    $WORNB           FOB Gross Amoun
     C                     ADD  $VOQNB    $WOQNB           Billing Detail
     C                     ADD  $VNTNX    $WNTNX           Weight Billed S
     C                     END
      *
     C           W0EOFA    IFEQ '1'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$WFINTTL
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         B0MAIN    BEGSR
      *================================================================
      * PRT Shpd Items by Cls PO: Mainline
      *================================================================
      * PRT Shpd Items by Cls PO: Initialise
     C                     EXSR ZBINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQKB01           Company Number
     C           *LIKE     DEFN WAUMCD    WQKB02           Export Country
     C           *LIKE     DEFN WADBCD    WQKB03           Ship To State C
      * Define keylist
     C           KPSB      KLIST
     C                     KFLD           WQKB01           Company Number
     C                     KFLD           WQKB02           Export Country
     C                     KFLD           WQKB03           Ship To State C
     C                     KFLD           WAGNDT           Actual Shipped
      * Define keylist
     C           KRSB      KLIST
     C                     KFLD           WQKB01           Company Number
     C                     KFLD           WQKB02           Export Country
     C                     KFLD           WQKB03           Ship To State C
      * Setup key
     C                     Z-ADD$EAIC3    WQKB01           Company Number
     C                     MOVEL$EUMCD    WQKB02           Export Country
     C                     MOVEL$EDBCD    WQKB03           Ship To State C
     C                     Z-ADDP2BDDT    WAGNDT           Actual Shipped
      * Establish starting position
     C           KPSB      SETLL@HSTPYX                    *
      * Read first record with user selection
     C                     EXSR B3READ
     C           W0EOFB    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0BL1P  1        First page
     C                     MOVEL'Y'       W0BL00  1        Company Number
     C                     MOVEL'Y'       W0BL01  1        Export Country
     C                     MOVEL'Y'       W0BL02  1        Ship To State C
     C                     MOVEL'Y'       W0BL03  1        Actual Shipped
     C                     MOVEL'Y'       W0BL04  1        Item Structure
     C                     MOVEL'Y'       W0BL05  1        Shipped Item Co
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      * Print report body
     C           W0EOFB    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR B1PHDR
      * Print report detail line
     C                     EXSR B2PDTL
      * Read next record with user selection
     C                     EXSR B3READ
      * Print totals
     C                     EXSR B4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         B0EXIT    ENDSR
      /EJECT
     CSR         B1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0BL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP1P  1
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDWAAIC3    $GAIC3           Company Number
      * Load related totals format
     C                     Z-ADDWAAIC3    $SAIC3           Company Number
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP00  1
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDWAAIC3    $HAIC3           Company Number
     C                     MOVELWAUMCD    $HUMCD           Export Country
      * Load related totals format
     C                     Z-ADDWAAIC3    $RAIC3           Company Number
     C                     MOVELWAUMCD    $RUMCD           Export Country
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP01  1
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDWAAIC3    $IAIC3           Company Number
     C                     MOVELWADBCD    $IDBCD           Ship To State C
     C                     MOVELWAUMCD    $IUMCD           Export Country
      * Load related totals format
     C                     Z-ADDWAAIC3    $QAIC3           Company Number
     C                     MOVELWADBCD    $QDBCD           Ship To State C
     C                     MOVELWAUMCD    $QUMCD           Export Country
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP02  1
     C                     END
      *
     C           W0BL03    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDWAAIC3    $JAIC3           Company Number
     C                     MOVELWADBCD    $JDBCD           Ship To State C
     C                     MOVELWAUMCD    $JUMCD           Export Country
     C                     Z-ADDWAGNDT    $JGNDT           Actual Shipped
      * Load related totals format
     C                     Z-ADDWAAIC3    $PAIC3           Company Number
     C                     MOVELWADBCD    $PDBCD           Ship To State C
     C                     MOVELWAUMCD    $PUMCD           Export Country
     C                     Z-ADDWAGNDT    $PGNDT           Actual Shipped
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP03  1
     C                     END
      *
     C           W0BL04    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDWAAIC3    $KAIC3           Company Number
     C                     MOVELWADBCD    $KDBCD           Ship To State C
     C                     MOVELWAUMCD    $KUMCD           Export Country
     C                     Z-ADDWARINB    $KRINB           Item Structure
      * Load related totals format
     C                     Z-ADDWAAIC3    $OAIC3           Company Number
     C                     MOVELWADBCD    $ODBCD           Ship To State C
     C                     MOVELWAUMCD    $OUMCD           Export Country
     C                     Z-ADDWARINB    $ORINB           Item Structure
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP04  1
     C                     END
      *
     C           W0BL05    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDWAAIC3    $LAIC3           Company Number
     C                     MOVELWADBCD    $LDBCD           Ship To State C
     C                     MOVELWAUMCD    $LUMCD           Export Country
     C                     Z-ADDWAS5NB    $LS5NB           Shipped Item Co
     C                     Z-ADDWARINB    $LRINB           Item Structure
      * Load related totals format
     C                     Z-ADDWAAIC3    $NAIC3           Company Number
     C                     MOVELWADBCD    $NDBCD           Ship To State C
     C                     MOVELWAUMCD    $NUMCD           Export Country
     C                     Z-ADDWARINB    $NRINB           Item Structure
     C                     Z-ADDWAS5NB    $NS5NB           Shipped Item Co
     C                     MOVEL*BLANK    $NOONA           Item Desc DRV
     C                     Z-ADD*ZERO     $NL7QT           Quantity Billed
     C                     Z-ADD*ZERO     $NFNWG           Weight Billed S
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP05  1
     C                     END
      *
      *================================================================
     CSR         B1EXIT    ENDSR
      /EJECT
     CSR         B2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDWAAIC3    $MAIC3           Company Number
     C                     Z-ADDWAC4NB    $MC4NB           Order Number
     C                     Z-ADDWADPNB    $MDPNB           Order Sequence
     C                     Z-ADDWAUENB    $MUENB           Order Secondary
     C                     MOVELWAMONA    $MMONA           A/R City
     C                     MOVELWARJCD    $MRJCD           A/R State
     C                     MOVELWARKCD    $MRKCD           A/R County Code
     C                     MOVELWAGPTX    $MGPTX           A/R Zip/Postal
     C                     MOVELWAABTX    $MABTX           Alpha Search
     C                     MOVELWAKXCD    $MKXCD           Country Code
     C                     MOVELWABOCD    $MBOCD           Type Code
     C                     Z-ADDWABTC7    $MBTC7           Parent Customer
     C                     Z-ADDWAANC7    $MANC7           A/R Customer Nu
     C                     MOVELWAAQTX    $MAQTX           A/R Customer Na
     C                     Z-ADDWABKC7    $MBKC7           Ship To Custome
     C                     MOVELWABRTX    $MBRTX           Ship To Name
     C                     MOVELWAHNNA    $MHNNA           Ship To City
     C                     MOVELWADBCD    $MDBCD           Ship To State C
     C                     MOVELWACKTX    $MCKTX           Ship To Zip/Pos
     C                     MOVELWABCNA    $MBCNA           Customer Purcha
     C                     Z-ADDWAA0DT    $MA0DT           Order Date
     C                     Z-ADDWAACDT    $MACDT           Cancel Date
     C                     MOVELWAR4CD    $MR4CD           Sales Route Cod
     C                     MOVELWAR5CD    $MR5CD           Original Salesp
     C                     MOVELWABFCD    $MBFCD           Manager Level C
     C                     MOVELWAQ4CD    $MQ4CD           VP Level Code
     C                     MOVELWAAQCD    $MAQCD           Terms Code
     C                     Z-ADDWATBNB    $MTBNB           Absorbed Freigh
     C                     MOVELWABZNA    $MBZNA           Carrier Code
     C                     MOVELWARLCD    $MRLCD           Order Header Re
     C                     MOVELWAJNCD    $MJNCD           Order Type - Sa
     C                     MOVELWAQ2CD    $MQ2CD           Shipping Method
     C                     MOVELWAU2ST    $MU2ST           Export Status
     C                     Z-ADDWAATIN    $MATIN           Attach to Invoi
     C                     Z-ADDWAT3NB    $MT3NB           Attach to Order
     C                     Z-ADDWARSRN    $MRSRN           Resell Referenc
     C                     Z-ADDWAORIT    $MORIT           Original Item
     C                     MOVELWAAJCD    $MAJCD           Warehouse Code
     C                     Z-ADDWAAVQT    $MAVQT           Quantity Ordere
     C                     Z-ADDWAD0WG    $MD0WG           Weight Ordered
     C                     Z-ADDWACCQT    $MCCQT           Quantity Schedu
     C                     Z-ADDWAAUWG    $MAUWG           Weight Schedule
     C                     MOVELWAAGCD    $MAGCD           U/M - Ordered
     C                     Z-ADDWAAKPR    $MAKPR           Unit Price
     C                     Z-ADDWAAUPR    $MAUPR           Unit Price Orde
     C                     MOVELWACRCD    $MCRCD           U/M - Base Pric
     C                     Z-ADDWAA5DT    $MA5DT           Requested Ship
     C                     Z-ADDWAAWDT    $MAWDT           Invoice Date
     C                     Z-ADDWAHDDT    $MHDDT           Deadline Depart
     C                     Z-ADDWAAGCS    $MAGCS           Unit Cost Per P
     C                     Z-ADDWAAQCS    $MAQCS           Unit Cost Order
     C                     Z-ADDWAAVWG    $MAVWG           Unit Weight Ord
     C                     Z-ADDWAAYVA    $MAYVA           Extended Amount
     C                     MOVELWAAMST    $MAMST           Affect Inventor
     C                     MOVELWAANST    $MANST           Affect Sales Do
     C                     MOVELWAVAST    $MVAST           Affect Sales Pn
     C                     Z-ADDWAL6NB    $ML6NB           Contract Number
     C                     MOVELWAUMCD    $MUMCD           Export Country
     C                     Z-ADDWAHCDT    $MHCDT           LD Arrival Date
     C                     Z-ADDWAESNB    $MESNB           Accounting Year
     C                     Z-ADDWAETNB    $METNB           Accounting Peri
     C                     Z-ADDWABZNB    $MBZNB           OM Week
     C                     Z-ADDWAEXQT    $MEXQT           Quantity Billed
     C                     Z-ADDWABYWG    $MBYWG           Weight Billed
     C                     Z-ADDWAS5NB    $MS5NB           Shipped Item Co
     C                     Z-ADDWAMAVA    $MMAVA           Billing Detail
     C                     Z-ADDWAKDVA    $MKDVA           Billing Detail
     C                     Z-ADDWAUSVA    $MUSVA           FOB Gross Amoun
     C                     Z-ADDWAUTVA    $MUTVA           Standard Overag
     C                     Z-ADDWAA4WG    $MA4WG           Tare Weight Tot
     C                     Z-ADDWACKNB    $MCKNB           G/L Document Nu
     C                     MOVELWABMST    $MBMST           G/L Update Stat
     C                     Z-ADDWAR8NB    $MR8NB           Original Order
     C                     MOVELWARMCD    $MRMCD           Order Detail Re
     C                     Z-ADDWABZPR    $MBZPR           Price Overage O
     C                     MOVELWARDCD    $MRDCD           Date Method Cod
     C                     MOVELWAQ7CD    $MQ7CD           Price Method Co
     C                     Z-ADDWAEXDT    $MEXDT           Market Pricing
     C                     MOVELWALQCD    $MLQCD           Commodity Marke
     C                     MOVELWAHICD    $MHICD           Quality Level
     C                     MOVELWARBCD    $MRBCD           Item Level
     C                     Z-ADDWARGNB    $MRGNB           Item Structure
     C                     Z-ADDWARHNB    $MRHNB           Item Structure
     C                     Z-ADDWARINB    $MRINB           Item Structure
     C                     Z-ADDWAR1NB    $MR1NB           Rated Freight
     C                     Z-ADDWACONB    $MCONB           Invoice Number
     C                     MOVELWACEST    $MCEST           Invoice Suffix
     C                     Z-ADDWAGNDT    $MGNDT           Actual Shipped
     C                     Z-ADDWARMNB    $MRMNB           Load ID
     C                     Z-ADDWAAODT    $MAODT           Scheduled Ship
     C                     MOVELWALLCD    $MLLCD           Packaging Code
     C                     MOVELWALMCD    $MLMCD           Grade Code
     C                     Z-ADDWASKNB    $MSKNB           Agrimetrics gro
     C                     Z-ADDWASLNB    $MSLNB           Agrimetrics pac
     C                     Z-ADDWASMNB    $MSMNB           Agrimetrics gra
     C                     MOVELWAG7NA    $MG7NA           Order Desc. Lin
     C                     Z-ADDWAONVA    $MONVA           Actual Freight
     C                     MOVELWAN0CD    $MN0CD           Item Type Code
     C                     Z-ADDWAB4NB    $MB4NB           PM R/M Type Cod
     C                     Z-ADDWAB5NB    $MB5NB           PM Line Number
     C                     MOVELWAN1CD    $MN1CD           SH Broker Code
     C                     Z-ADDWAGIDT    $MGIDT           Pricing Date Us
     C                     MOVELWAZ1ST    $MZ1ST           Modified Flag
     C                     Z-ADDWAULVA    $MULVA           Absorbed Freigh
     C                     Z-ADDWAUNVA    $MUNVA           Automatic Accru
     C                     Z-ADDWAUOVA    $MUOVA           Non Automatic A
     C                     Z-ADDWAUPVA    $MUPVA           Financials Amou
     C                     Z-ADDWAUQVA    $MUQVA           Financials Amou
     C                     MOVELWASDCD    $MSDCD           Group for Packa
     C                     MOVELWAQZCD    $MQZCD           Base/Conv/Loss
     C                     MOVELWAXWST    $MXWST           Variety/Rendere
     C                     MOVELWAT9CD    $MT9CD           Customer Group
     C                     MOVELWAUBCD    $MUBCD           Customer Group
     C                     Z-ADDWACFC7    $MCFC7           Order Group Cod
     C                     MOVELWAX1CD    $MX1CD           Shipping Zone C
     C                     MOVELWAGASX    $MGASX           Invoice Price T
     C                     Z-ADDWADUPR    $MDUPR           Invoice Unit Pr
     C                     Z-ADDWAB6VL    $MB6VL           Invoice Extende
     C                     Z-ADDWAIANX    $MIANX           Req Shipping Te
     C                     Z-ADDWAIBNX    $MIBNX           Actual Shipping
     C                     MOVELWARPCD    $MRPCD           Age Code
     C                     Z-ADDWANYDT    $MNYDT           Req Delivery Da
     C                     Z-ADDWABZTM    $MBZTM           Req Delivery Ti
     C                     Z-ADDWAZ4NB    $MZ4NB           MPC Number
     C                     MOVELWAXACD    $MXACD           Shipping Line
     C                     MOVELWAOANA    $MOANA           Sail Port Delv
     C                     MOVELWAOKTX    $MOKTX           Sail Port City
     C                     MOVELWAK4TX    $MK4TX           Vessel Name
     C                     MOVELWANBBO    $MNBBO           Booking Number
     C                     Z-ADDWAOCFR    $MOCFR           Ocean Freight
     C                     Z-ADDWAC0C7    $MC0C7           Claim Number
     C                     Z-ADDWAA1AA    $MA1AA           Ham Group Numbe
     C                     MOVELWAVEST    $MVEST           Palletize
     C                     Z-ADDWAA5PR    $MA5PR           Commodity Marke
     C                     Z-ADDWACDPR    $MCDPR           Market Value
     C                     Z-ADDWAD0PR    $MD0PR           Default Cmdty M
     C                     Z-ADDWAD0VL    $MD0VL           Raw Material Co
     C                     MOVELWAIRSX    $MIRSX           Sales Expense P
     C                     Z-ADDWACEVL    $MCEVL           Sales Expense T
     C                     MOVELWAISSX    $MISSX           Data Mart Proce
     C                     MOVELWAITSX    $MITSX           LH Load Type
     C                     MOVELWAIUSX    $MIUSX           Sale Country
     C                     Z-ADDWAOHDT    $MOHDT           LD Sail Date
     C                     Z-ADDWAD9PR    $MD9PR           HST Unused Pric
     C                     Z-ADDWACFVL    $MCFVL           HST Item Target
     C                     MOVELWAUVST    $MUVST           EDI Status 1
     C                     MOVELWAUWST    $MUWST           EDI Status 2
     C                     MOVELWAUXST    $MUXST           EDI Status 3
     C                     Z-ADDWAAATM    $MAATM           Job Time
     C                     MOVELWAAYNA    $MAYNA           User Id
     C                     MOVELWAA0NA    $MA0NA           Job Name
     C                     Z-ADDWAAXDT    $MAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * USER: Process after print of detail format
     C                     ADD  $MEXQT    $NL7QT           Quantity Billed
     C                     ADD  $MBYWG    $NFNWG           Weight Billed S
      *
      *================================================================
     CSR         B2EXIT    ENDSR
      /EJECT
     CSR         B3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN WAAIC3    WZB001           Company Number
     C                     Z-ADDWAAIC3    WZB001
     C           *LIKE     DEFN WAUMCD    WZB002           Export Country
     C                     MOVELWAUMCD    WZB002
     C           *LIKE     DEFN WADBCD    WZB003           Ship To State C
     C                     MOVELWADBCD    WZB003
     C           *LIKE     DEFN WAGNDT    WZB004           Actual Shipped
     C                     Z-ADDWAGNDT    WZB004
     C           *LIKE     DEFN WARINB    WZB005           Item Structure
     C                     Z-ADDWARINB    WZB005
     C           *LIKE     DEFN WAS5NB    WZB006           Shipped Item Co
     C                     Z-ADDWAS5NB    WZB006
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFB    OREQ '1'
     C           KRSB      READE@HSTPYX                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFB  1
      * Quit if no record read
     C           W0EOFB    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * CASE: DB1.Actual Shipped Date GT PAR.USR To Date
     C           WAGNDT    IFGT P3FDDT                     *IF
      * SET End of File 'B'    US - /UT User Source  * 
     C                     MOVEL'1'       W0EOFB           END OF FILE 'B'
     C                     END                             *FI
      * SEL:  Item Structure Class
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Item Structure Class Code is Entered
      *   |- c2    : PAR.Item Structure Class Code NE DB1.Item Structure
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P8RINB    IFNE *ZERO                      *IF
     C           P8RINB    IFNE WARINB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * SEL:  Warehouse
      * CASE: WRK.Select all Warehouses USR is no
     C           WUYFST    IFEQ 'N'                        *IF
      * Check Warehouse Select/Omit
     C                     EXSR UJSUBR                     Check Warehouse
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0BL00  1        Company Number
     C                     MOVEL*BLANK    W0BL01  1        Export Country
     C                     MOVEL*BLANK    W0BL02  1        Ship To State C
     C                     MOVEL*BLANK    W0BL03  1        Actual Shipped
     C                     MOVEL*BLANK    W0BL04  1        Item Structure
     C                     MOVEL*BLANK    W0BL05  1        Shipped Item Co
     C           W0EOFB    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0BL00  1        Company Number
     C                     MOVEL'Y'       W0BL01  1        Export Country
     C                     MOVEL'Y'       W0BL02  1        Ship To State C
     C                     MOVEL'Y'       W0BL03  1        Actual Shipped
     C                     MOVEL'Y'       W0BL04  1        Item Structure
     C                     MOVEL'Y'       W0BL05  1        Shipped Item Co
     C                     ELSE
      * Next record - Detect level breaks
     C           WAAIC3    IFNE WZB001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL00
     C                     END
     C           WAUMCD    IFNE WZB002                     Export Country
     C           W0BL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL01
     C                     END
     C           WADBCD    IFNE WZB003                     Ship To State C
     C           W0BL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL02
     C                     END
     C           WAGNDT    IFNE WZB004                     Actual Shipped
     C           W0BL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL03
     C                     END
     C           WARINB    IFNE WZB005                     Item Structure
     C           W0BL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL04
     C                     END
     C           WAS5NB    IFNE WZB006                     Shipped Item Co
     C           W0BL04    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL05
     C                     END
     C                     END
      *================================================================
     CSR         B3EXIT    ENDSR
      /EJECT
     CSR         B4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0BL05    IFEQ 'Y'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Shipped Item Code format
     C                     MOVEL*BLANK    $NOONA           Item Desc DRV
      * Item Desc DRV
      * Rtv Item Descriptions  RT - OM Item  * 
     C                     EXSR SGRVGN
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 1
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Convert fields to external form
      * Convert Shipped Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $NS5NB    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$NS5NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VNS5NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VNS5NB           CD7 Ext Numeric
     C                     END                             *FI
      * Print format
     C                     WRITE$NKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP05
     C                     END
      *
     C           W0BL04    IFEQ 'Y'
      * Mention hidden format
     C   99N99             WRITE$OKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP04
     C                     END
      *
     C           W0BL03    IFEQ 'Y'
      * Mention hidden format
     C   99N99             WRITE$PKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP03
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Mention hidden format
     C   99N99             WRITE$QKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP02
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Mention hidden format
     C   99N99             WRITE$RKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP01
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Mention hidden format
     C   99N99             WRITE$SKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP00
     C                     END
      *
     C           W0EOFB    IFEQ '1'
      * Mention hidden format
     C   99N99             WRITE$TFINTTL
     C                     END
      *
      *================================================================
     CSR         B4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of PRT Sls Tax by Cnt/St PF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of PRT Sls Tax by Cnt/St PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print Company Number of PRT Sls Tax by Cnt/St PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP00
     C                     END                             FI
      * Print Export Country Code of PRT Sls Tax by Cnt/St PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP01    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Export Country Code format
      * Setup Country Print Format
     C                     EXSR UESUBR                     Setup Country P
     C           W0PFM     IFEQ 'Y'
      * Print format
     C                     WRITE$CKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP01
     C                     END                             FI
      * Print Ship To State Code of PRT Sls Tax by Cnt/St PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP02
     C                     END                             FI
      * Print Detail line. of PRT Sls Tax by Cnt/St PF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
      * USER: On print of detail format
      * 7/09/02 Process cm/dm by flags
      * RTV Billing Type       RT - Order Types  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELF4JNCD    WL0001    P      Order Type - Sa
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YL0001    P      Billing Activit
      * CASE: LCL.Billing Activity Type is Not Invoice
     C           YL0001    IFEQ '2'                        *IF
     C           YL0001    OREQ '3'
     C           YL0001    OREQ '4'
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.Affect Sales Pnds Status is no
      *   |- c2    : DB1.Affect Sales Doll Status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           F4VAST    IFEQ 'N'                        *IF
     C           F4ANST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD*ZERO     $DBYWG           Weight Billed
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDF4BYWG    $DBYWG           Weight Billed
     C                     END                             *FI
     C                     END                             *FI
      * reverse sign if credit memo and positive
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Billing Activity Type is Credit Memo
      *   |- c2    : CUR.Weight Billed is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0001    IFEQ '2'                        *IF
     C           $DBYWG    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           *ZERO     SUB  $DBYWG    $DBYWG           Weight Billed
     C                     END                             *FI
      * Mention hidden format
     C   99N99             WRITE$DDTLRCD
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Print First Page Format of PRT Shpd Items by Cls PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP1P    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$F1STPAG
      * Reset format print flag
     C                     MOVE *BLANK    W0BP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0BL1P
     C                     END                             FI
      * Print Company Number of PRT Shpd Items by Cls PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP00    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$GKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0BP00
     C                     END                             FI
      * Print Export Country Code of PRT Shpd Items by Cls PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP01    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$HKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0BP01
     C                     END                             FI
      * Print Ship To State Code of PRT Shpd Items by Cls PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP02    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$IKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0BP02
     C                     END                             FI
      * Print Actual Shipped Date of PRT Shpd Items by Cls PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP03    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$JKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0BP03
     C                     END                             FI
      * Print Item Structure Class Code of PRT Shpd Items by Cls PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP04    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$KKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0BP04
     C                     END                             FI
      * Print Shipped Item Code of PRT Shpd Items by Cls PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP05    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP05    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$LKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0BP05
     C                     END                             FI
      * Print Detail line. of PRT Shpd Items by Cls PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0BCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BPDT    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$MDTLRCD
      * Reset format print flag
     C                     MOVE *BLANK    W0BPDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of PRT Sls Tax by Cnt/St PF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of PRT Sls Tax by Cnt/St PF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Export Country Code of PRT Sls Tax by Cnt/St PF
     C           W0AP01    IFEQ 'Y'
     C                     ADD  1         W0FSUM
     C                     END                             FI
      *
      * * Ship To State Code of PRT Sls Tax by Cnt/St PF
     C           W0AP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Sls Tax by Cnt/St PF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD0         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT Shpd Items by Cls PO
     C           W0BP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of PRT Shpd Items by Cls PO
     C           W0BP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Export Country Code of PRT Shpd Items by Cls PO
     C           W0BP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Ship To State Code of PRT Shpd Items by Cls PO
     C           W0BP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Actual Shipped Date of PRT Shpd Items by Cls PO
     C           W0BP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Item Structure Class Code of PRT Shpd Items by Cls PO
     C           W0BP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Shipped Item Code of PRT Shpd Items by Cls PO
     C           W0BP05    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Shpd Items by Cls PO
     C           W0BPDT    IFEQ 'Y'
     C                     Z-ADD0         W0DTLN
     C           W0BCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
      * USER: Process top of page
      * Load TOP Selection Criteria.
     C                     EXSR UBSUBR                     Load TOP Select
      * Convert fields to external form
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $BAIC3    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$BAIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VBAIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VBAIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert USR From Date to display format
      * Convert date
     C           1000000   ADD  $BBDDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBBDDT
      * Convert USR To Date to display format
      * Convert date
     C           1000000   ADD  $BFDDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBFDDT
     C                     MOVEL'0'       *IN79
     C           P7QBST    IFEQ 'S'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           P6Y8ST    IFEQ '2'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           WUGGST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSA01           Application Cod
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSA01           Application Cod
     C                     MOVEL'OMS'     WQSA01           Application Cod
      * Establish starting position
     C           KRSSA     SETLL@DNRESF                    *
     C           KRSSA     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
     C           KRSSA     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSB01           Application Cod
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSB01           Application Cod
      * Establish starting position
     C           KRSSB     SETLL@DNRESF                    *
     C           KRSSB     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSB     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADD$BAIC3    ABAIC3           Company Number
      * Establish starting position
     C           KRSSC     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $BAPTX           Name
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    $BAPTX           Name
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Item Class Desc    RT - OM Item Structure Class  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           FARINB           Item Structure
      * Setup key
     C                     Z-ADD$BRINB    FARINB           Item Structure
      * Establish starting position
     C           KRSSD     CHAIN@FAREBE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1170' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    $BDETX           Item Structure
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFADETX    $BDETX           Item Structure
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV State Description  RT - State  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           ACBGCD           State Code
      * Setup key
     C                     MOVEL$BEINA    ACBGCD           State Code
      * Establish starting position
     C           KRSSE     CHAIN@ACREAH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0005' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $BHSNA           Description
     C                     MOVEL*BLANK    WUVSST           Record Status
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELACAUNA    $BHSNA           Description
     C                     MOVELACVSST    WUVSST           Record Status
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Billing Type       RT - Order Types  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           EXJNCD           Order Type - Sa
      * Setup key
     C                     MOVELWL0001    EXJNCD           Order Type - Sa
      * Establish starting position
     C           KRSSF     CHAIN@EXRETY              90    *
      * Data record not found
     C   90                MOVEL'USR1063' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELEXOBST    WL0002           Billing Activit
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Item Descriptions  RT - OM Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           BYHGCD           Item Code
      * Setup key
     C                     Z-ADD$NS5NB    BYHGCD           Item Code
      * Establish starting position
     C           KRSSG     CHAIN@BYREA1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1160' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $NOONA           Description Lin
     C                     MOVEL*BLANK    WUAWNA           Description Lin
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBYAVNA    $NOONA           Description Lin
     C                     MOVELBYAWNA    WUAWNA           Description Lin
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Change Log.
      *================================================================
      * *****************************************************************
      * *** OMS305 - 12/17/97                                         ***
      * ***          Added "Pounds" (Weight Billed) to the report.    ***
      * ***          Also added a selection for Warehouse.            ***
      * ***          Also added a new sort by state or country.       ***
      * ***          Also added a new selection Export/Domestic.      ***
      * *****************************************************************
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Load TOP Selection Criteria.
      *================================================================
      * TOP = PAR By name
     C                     Z-ADDP1AIC3    $BAIC3           Company Number
     C                     Z-ADDP2BDDT    $BBDDT           USR From Date
     C                     Z-ADDP3FDDT    $BFDDT           USR To Date
     C                     MOVELP7QBST    $BQBST           Report Type USR
     C                     Z-ADDP8RINB    $BRINB           Item Structure
     C                     MOVELP9EINA    $BEINA           State
     C                     MOVELP4CPCD    $BCPCD           USR Warehouse C
     C                     MOVELP4VSCD    $BVSCD           USR CDE Parm 1
     C                     MOVELP4VTCD    $BVTCD           USR CDE Parm 2
     C                     MOVELP4VUCD    $BVUCD           USR CDE Parm 3
     C                     MOVELP4VVCD    $BVVCD           USR CDE Parm 4
     C                     MOVELP4VWCD    $BVWCD           USR CDE Parm 5
     C                     MOVELP4VXCD    $BVXCD           USR CDE Parm 6
     C                     MOVELP4VYCD    $BVYCD           USR CDE Parm 7
     C                     MOVELP4VZCD    $BVZCD           USR CDE Parm 8
     C                     MOVELP4V0CD    $BV0CD           USR CDE Parm 9
     C                     Z-ADDP1AIC3    $BAIC3           Company Number
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SCRVGN
     C                     Z-ADDP2BDDT    $BBDDT           USR From Date
     C                     Z-ADDP3FDDT    $BFDDT           USR To Date
      * TOP.Condition Desc. 1  USR = Condition name of TOP.Report Type US
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1456722   Y2LSNO  70       List number
     C                     PARM $BQBST    W0INVL 25        Report Type USR
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $BHLTX    PARM           W0CNNM 25        Condition Desc.
      *
      * Determine & Load Select/Omit Descriptor.
      * CASE: PAR.USR Select/Omit Flag is Select
     C           P4CYST    IFEQ 'S'                        *IF
     C                     MOVEL*BLANK    $BNCNA           USR Desc. 10
     C                     MOVEL'Select'  $BNCNA           USR Desc. 10
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $BNCNA           USR Desc. 10
     C                     MOVEL'Omit'    $BNCNA           USR Desc. 10
     C                     END                             *FI
      * Determine & Load Export/Domestic Descriptor.
      * CASE: PAR.Export Status is yes
     C           P5U2ST    IFEQ 'Y'                        *IF
     C                     MOVEL@CN,01    $BL3NA           USR Description
     C                     ELSE
      * CASE: PAR.Export Status is no
     C           P5U2ST    IFEQ 'N'                        *IF
     C                     MOVEL@CN,02    $BL3NA           USR Description
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL@CN,03    $BL3NA           USR Description
     C                     END                             *FI
     C                     END                             *FI
      * Determine & Load Warehouse Descriptor.
      * CASE: WRK.Select all Warehouses USR is yes
     C           WUYFST    IFEQ 'Y'                        *IF
      * Load Defaults for All Warehouse Selections in 1PG.
     C                     EXSR UCSUBR                     Load Defaults f
     C                     ELSE
      * CASE: *OTHERWISE
      * Load Warehouse Codes on 1PG Format.
     C                     EXSR UDSUBR                     Load Warehouse
     C                     END                             *FI
      * Determine & Load Item Structure Class Descriptor.
      * CASE: PAR.Item Structure Class Code is Entered
     C           P8RINB    IFNE *ZERO                      *IF
      * Rtv Item Class Desc    RT - OM Item Structure Class  * 
     C                     EXSR SDRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $BDETX           Item Structure
     C                     MOVEL'*ALL'    $BDETX           Item Structure
     C                     END                             *FI
      * Determine & Load State Descriptor.
      * CASE: PAR.State is *Not Blank
     C           P9EINA    IFNE *BLANK                     *IF
      * RTV State Description  RT - State  * 
     C                     EXSR SERVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $BHSNA           State Descripti
     C                     MOVEL'*ALL'    $BHSNA           State Descripti
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Load Defaults for All Warehouse Selections in 1PG.
      *================================================================
     C                     MOVEL'ALL'     $BCPCD           USR Warehouse C
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Load Warehouse Codes on 1PG Format.
      *================================================================
     C                     MOVELP4CPCD    $BCPCD           USR Warehouse C
     C                     MOVELP4VSCD    $BVSCD           USR CDE Parm 1
     C                     MOVELP4VTCD    $BVTCD           USR CDE Parm 2
     C                     MOVELP4VUCD    $BVUCD           USR CDE Parm 3
     C                     MOVELP4VVCD    $BVVCD           USR CDE Parm 4
     C                     MOVELP4VWCD    $BVWCD           USR CDE Parm 5
     C                     MOVELP4VXCD    $BVXCD           USR CDE Parm 6
     C                     MOVELP4VYCD    $BVYCD           USR CDE Parm 7
     C                     MOVELP4VZCD    $BVZCD           USR CDE Parm 8
     C                     MOVELP4V0CD    $BV0CD           USR CDE Parm 9
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Setup Country Print Format
      *================================================================
      * CASE: CUR.Export Country Code is Blank
     C           $CUMCD    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    $CUMCD           Export Country
     C                     MOVEL'BLANK'   $CUMCD           Export Country
     C                     END                             *FI
      * CASE: PAR.Report seq-State/CntryUSR is By State
     C           P6Y8ST    IFEQ '2'                        *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Check Warehouse Select/Omit
      *================================================================
      * CASE:
      *  - c1 OR c2 OR c3 OR c4 OR c5 OR c6 OR c7 OR c8 OR c9 OR c10
      *   |- c1    : PAR.USR Warehouse Code EQ DB1.Warehouse Code
      *   |- c2    : PAR.USR CDE Parm 1 EQ DB1.Warehouse Code
      *   |- c3    : PAR.USR CDE Parm 2 EQ DB1.Warehouse Code
      *   |- c4    : PAR.USR CDE Parm 3 EQ DB1.Warehouse Code
      *   |- c5    : PAR.USR CDE Parm 4 EQ DB1.Warehouse Code
      *   |- c6    : PAR.USR CDE Parm 5 EQ DB1.Warehouse Code
      *   |- c7    : PAR.USR CDE Parm 6 EQ DB1.Warehouse Code
      *   |- c8    : PAR.USR CDE Parm 7 EQ DB1.Warehouse Code
      *   |- c9    : PAR.USR CDE Parm 8 EQ DB1.Warehouse Code
      *   |- c10   : PAR.USR CDE Parm 9 EQ DB1.Warehouse Code
      *   '-
     C           P4CPCD    IFEQ F4AJCD                     *IF
     C           P4VSCD    OREQ F4AJCD                     *OR
     C           P4VTCD    OREQ F4AJCD                     *OR
     C           P4VUCD    OREQ F4AJCD                     *OR
     C           P4VVCD    OREQ F4AJCD                     *OR
     C           P4VWCD    OREQ F4AJCD                     *OR
     C           P4VXCD    OREQ F4AJCD                     *OR
     C           P4VYCD    OREQ F4AJCD                     *OR
     C           P4VZCD    OREQ F4AJCD                     *OR
     C           P4V0CD    OREQ F4AJCD                     *OR
      * Match (Skip Record if S/O Flag is Omit).
     C                     EXSR UGSUBR                     Match (Skip Rec
     C                     ELSE
      * CASE: *OTHERWISE
      * No Match (Skip Record if S/O Flag is Select).
     C                     EXSR UHSUBR                     No Match (Skip
     C                     END                             *FI
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Match (Skip Record if S/O Flag is Omit).
      *================================================================
      * CASE: PAR.USR Select/Omit Flag is Omit
     C           P4CYST    IFEQ 'O'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * No Match (Skip Record if S/O Flag is Select).
      *================================================================
      * CASE: PAR.USR Select/Omit Flag is Select
     C           P4CYST    IFEQ 'S'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Shpd Items by Cls PO
      *================================================================
      * CASE: PAR.Report Type USR is Summary
     C           P7QBST    IFEQ 'S'                        *IF
     C                     GOTO UIEXIT                     *QUIT
     C                     END                             *FI
      * PRT Shpd Items by Cls PO: Mainline
     C                     EXSR B0MAIN
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         UJSUBR    BEGSR
      *================================================================
      * Check Warehouse Select/Omit
      *================================================================
      * CASE:
      *  - c1 OR c2 OR c3 OR c4 OR c5 OR c6 OR c7 OR c8 OR c9 OR c10
      *   |- c1    : PAR.USR Warehouse Code EQ DB1.Warehouse Code
      *   |- c2    : PAR.USR CDE Parm 1 EQ DB1.Warehouse Code
      *   |- c3    : PAR.USR CDE Parm 2 EQ DB1.Warehouse Code
      *   |- c4    : PAR.USR CDE Parm 3 EQ DB1.Warehouse Code
      *   |- c5    : PAR.USR CDE Parm 4 EQ DB1.Warehouse Code
      *   |- c6    : PAR.USR CDE Parm 5 EQ DB1.Warehouse Code
      *   |- c7    : PAR.USR CDE Parm 6 EQ DB1.Warehouse Code
      *   |- c8    : PAR.USR CDE Parm 7 EQ DB1.Warehouse Code
      *   |- c9    : PAR.USR CDE Parm 8 EQ DB1.Warehouse Code
      *   |- c10   : PAR.USR CDE Parm 9 EQ DB1.Warehouse Code
      *   '-
     C           P4CPCD    IFEQ WAAJCD                     *IF
     C           P4VSCD    OREQ WAAJCD                     *OR
     C           P4VTCD    OREQ WAAJCD                     *OR
     C           P4VUCD    OREQ WAAJCD                     *OR
     C           P4VVCD    OREQ WAAJCD                     *OR
     C           P4VWCD    OREQ WAAJCD                     *OR
     C           P4VXCD    OREQ WAAJCD                     *OR
     C           P4VYCD    OREQ WAAJCD                     *OR
     C           P4VZCD    OREQ WAAJCD                     *OR
     C           P4V0CD    OREQ WAAJCD                     *OR
      * Match (Skip Record if S/O Flag is Omit).
     C                     EXSR UKSUBR                     Match (Skip Rec
     C                     ELSE
      * CASE: *OTHERWISE
      * No Match (Skip Record if S/O Flag is Select).
     C                     EXSR ULSUBR                     No Match (Skip
     C                     END                             *FI
      *================================================================
     CSR         UJEXIT    ENDSR
      /EJECT
     CSR         UKSUBR    BEGSR
      *================================================================
      * Match (Skip Record if S/O Flag is Omit).
      *================================================================
      * CASE: PAR.USR Select/Omit Flag is Omit
     C           P4CYST    IFEQ 'O'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      *================================================================
     CSR         UKEXIT    ENDSR
      /EJECT
     CSR         ULSUBR    BEGSR
      *================================================================
      * No Match (Skip Record if S/O Flag is Select).
      *================================================================
      * CASE: PAR.USR Select/Omit Flag is Select
     C           P4CYST    IFEQ 'S'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      *================================================================
     CSR         ULEXIT    ENDSR
      /EJECT
     CSR         UMSUBR    BEGSR
      *================================================================
      * Setup Country Print Format
      *================================================================
      * CASE: PAR.Report seq-State/CntryUSR is By State
     C           P6Y8ST    IFEQ '2'                        *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
      *================================================================
     CSR         UMEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZBINIT    BEGSR
      *================================================================
      * PRT Shpd Items by Cls PO: Initialise
      *================================================================
      * USER: Initialize program
      * Determine Warehouse Selection Criteria.
      * CASE:
      *  - c1 AND c2 AND c3 AND c4 AND c5 AND c6 AND c7 AND c8 AND c9
      *  -  AND c10
      *   |- c1    : PAR.USR Warehouse Code is Warehouse Code Blank
      *   |- c2    : PAR.USR CDE Parm 1 is Warehouse Code Blank
      *   |- c3    : PAR.USR CDE Parm 2 is Warehouse Code Blank
      *   |- c4    : PAR.USR CDE Parm 3 is Warehouse Code Blank
      *   |- c5    : PAR.USR CDE Parm 4 is Warehouse Code Blank
      *   |- c6    : PAR.USR CDE Parm 5 is Warehouse Code Blank
      *   |- c7    : PAR.USR CDE Parm 6 is Warehouse Code Blank
      *   |- c8    : PAR.USR CDE Parm 7 is Warehouse Code Blank
      *   |- c9    : PAR.USR CDE Parm 8 is Warehouse Code Blank
      *   |- c10   : PAR.USR CDE Parm 9 is Warehouse Code Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P4CPCD    IFEQ *BLANK                     *IF
     C           P4VSCD    IFEQ *BLANK                     *IF
     C           P4VTCD    IFEQ *BLANK                     *IF
     C           P4VUCD    IFEQ *BLANK                     *IF
     C           P4VVCD    IFEQ *BLANK                     *IF
     C           P4VWCD    IFEQ *BLANK                     *IF
     C           P4VXCD    IFEQ *BLANK                     *IF
     C           P4VYCD    IFEQ *BLANK                     *IF
     C           P4VZCD    IFEQ *BLANK                     *IF
     C           P4V0CD    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUYFST           Select all Ware
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUYFST           Select all Ware
     C                     END                             *FI
      *================================================================
     CSR         ZBEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Define work field USR Display field
     C                     MOVEL*BLANK    WUGGST  1
      * Define work field Select all Warehouses USR
     C                     MOVEL*BLANK    WUYFST  1
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    F4AIC3           Company Number
     C                     MOVEL*LOVAL    F4UMCD           Export Country
     C                     MOVEL*LOVAL    F4DBCD           Ship To State C
      * Define work field Record Status
     C                     MOVEL*BLANK    WUVSST  1
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
     C                     Z-ADD*ZERO     WABTC7           Parent Customer
     C                     Z-ADD*ZERO     WAANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAA0DT           Order Date
     C                     Z-ADD*ZERO     WAACDT           Cancel Date
     C                     Z-ADD*ZERO     WATBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WAATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WAT3NB           Attach to Order
     C                     Z-ADD*ZERO     WARSRN           Resell Referenc
     C                     Z-ADD*ZERO     WAORIT           Original Item
     C                     Z-ADD*ZERO     WAAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WAD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WACCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WAAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WAAKPR           Unit Price
     C                     Z-ADD*ZERO     WAAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAAWDT           Invoice Date
     C                     Z-ADD*ZERO     WAHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WAAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WAAQCS           Unit Cost Order
     C                     Z-ADD*ZERO     WAAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WAAYVA           Extended Amount
     C                     Z-ADD*ZERO     WAL6NB           Contract Number
     C                     Z-ADD*ZERO     WAHCDT           LD Arrival Date
     C                     Z-ADD*ZERO     WAESNB           Accounting Year
     C                     Z-ADD*ZERO     WAETNB           Accounting Peri
     C                     Z-ADD*ZERO     WABZNB           OM Week
     C                     Z-ADD*ZERO     WAEXQT           Quantity Billed
     C                     Z-ADD*ZERO     WABYWG           Weight Billed
     C                     Z-ADD*ZERO     WAS5NB           Shipped Item Co
     C                     Z-ADD*ZERO     WAMAVA           Billing Detail
     C                     Z-ADD*ZERO     WAKDVA           Billing Detail
     C                     Z-ADD*ZERO     WAUSVA           FOB Gross Amoun
     C                     Z-ADD*ZERO     WAUTVA           Standard Overag
     C                     Z-ADD*ZERO     WAA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WACKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WAR8NB           Original Order
     C                     Z-ADD*ZERO     WABZPR           Price Overage O
     C                     Z-ADD*ZERO     WAEXDT           Market Pricing
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WACONB           Invoice Number
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WASKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WASLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WASMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WAONVA           Actual Freight
     C                     Z-ADD*ZERO     WAB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WAB5NB           PM Line Number
     C                     Z-ADD*ZERO     WAGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WAULVA           Absorbed Freigh
     C                     Z-ADD*ZERO     WAUNVA           Automatic Accru
     C                     Z-ADD*ZERO     WAUOVA           Non Automatic A
     C                     Z-ADD*ZERO     WAUPVA           Financials Amou
     C                     Z-ADD*ZERO     WAUQVA           Financials Amou
     C                     Z-ADD*ZERO     WACFC7           Order Group Cod
     C                     Z-ADD*ZERO     WADUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WAB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WAIANX           Req Shipping Te
     C                     Z-ADD*ZERO     WAIBNX           Actual Shipping
     C                     Z-ADD*ZERO     WANYDT           Req Delivery Da
     C                     Z-ADD*ZERO     WABZTM           Req Delivery Ti
     C                     Z-ADD*ZERO     WAZ4NB           MPC Number
     C                     Z-ADD*ZERO     WAOCFR           Ocean Freight
     C                     Z-ADD*ZERO     WAC0C7           Claim Number
     C                     Z-ADD*ZERO     WAA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WAA5PR           Commodity Marke
     C                     Z-ADD*ZERO     WACDPR           Market Value
     C                     Z-ADD*ZERO     WAD0PR           Default Cmdty M
     C                     Z-ADD*ZERO     WAD0VL           Raw Material Co
     C                     Z-ADD*ZERO     WACEVL           Sales Expense T
     C                     Z-ADD*ZERO     WAOHDT           LD Sail Date
     C                     Z-ADD*ZERO     WAD9PR           HST Unused Pric
     C                     Z-ADD*ZERO     WACFVL           HST Item Target
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    WAAIC3           Company Number
     C                     MOVEL*LOVAL    WAUMCD           Export Country
     C                     MOVEL*LOVAL    WADBCD           Ship To State C
     C                     MOVEL*LOVAL    WAGNDT           Actual Shipped
     C                     MOVEL*LOVAL    WARINB           Item Structure
     C                     MOVEL*LOVAL    WAS5NB           Shipped Item Co
      * Define work field Description Line Two
     C                     MOVEL*BLANK    WUAWNA 30
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SFRVGN.
     C                     MOVEL*BLANK    WL0001  2
     C                     MOVEL*BLANK    WL0002  1
      * Define local work field Billing Activity Type
     C                     MOVEL*BLANK    YL0001  1
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * Change Log.
     C                     EXSR UASUBR                     Change Log.
      * VAL Rtv & Ctr Prt Hdg  IF
      * SET Setup Prt Headings IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SARVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * Center Txt String 40 - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc to PrtCo US - /UT User Source  * 
     C                     MOVE WUDE40    $ACMP
     C                     MOVEL'N'       WUGGST           USR Display fie
      * Determine Warehouse Selection Criteria.
      * CASE:
      *  - c1 AND c2 AND c3 AND c4 AND c5 AND c6 AND c7 AND c8 AND c9
      *  -  AND c10
      *   |- c1    : PAR.USR Warehouse Code is Warehouse Code Blank
      *   |- c2    : PAR.USR CDE Parm 1 is Warehouse Code Blank
      *   |- c3    : PAR.USR CDE Parm 2 is Warehouse Code Blank
      *   |- c4    : PAR.USR CDE Parm 3 is Warehouse Code Blank
      *   |- c5    : PAR.USR CDE Parm 4 is Warehouse Code Blank
      *   |- c6    : PAR.USR CDE Parm 5 is Warehouse Code Blank
      *   |- c7    : PAR.USR CDE Parm 6 is Warehouse Code Blank
      *   |- c8    : PAR.USR CDE Parm 7 is Warehouse Code Blank
      *   |- c9    : PAR.USR CDE Parm 8 is Warehouse Code Blank
      *   |- c10   : PAR.USR CDE Parm 9 is Warehouse Code Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P4CPCD    IFEQ *BLANK                     *IF
     C           P4VSCD    IFEQ *BLANK                     *IF
     C           P4VTCD    IFEQ *BLANK                     *IF
     C           P4VUCD    IFEQ *BLANK                     *IF
     C           P4VVCD    IFEQ *BLANK                     *IF
     C           P4VWCD    IFEQ *BLANK                     *IF
     C           P4VXCD    IFEQ *BLANK                     *IF
     C           P4VYCD    IFEQ *BLANK                     *IF
     C           P4VZCD    IFEQ *BLANK                     *IF
     C           P4V0CD    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUYFST           Select all Ware
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUYFST           Select all Ware
     C                     END                             *FI
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Export Only
00002 Domestic Only
00003 Domestic & Export
