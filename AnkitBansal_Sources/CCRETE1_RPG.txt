     H/TITLE Rtv BU/CC Desc     E1 XF  Execute external functio
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) BNDDIR(YBNDDIR) DBGVIEW(*SOURCE)
     Z* CVTOPT(*DATETIME) ACTGRP(*CALLER) OPTIMIZE(*BASIC)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Execute external function
     H* Object type   : *PGM
      *
     H* Company       : E1IDEVMDL
     H* System        : E1IDEVMDL
     H* User name     : ISRCENT
     H* Date          : 11/14/21  Time  : 11:17:33
     H* Copyright     : E1IDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FE10006LB  IF   E           K DISK
      * RSQ : Business Unit Mstr F0006  Co/BizUnit
      *
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  WP0001         S              3
     D  WP0002         S             12
     D  WP0003         S             30
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  YL0001         S              3  0
     D  YL0002         S              5  0
     D  YL0003         S              5
     D  WQSA01         S                   LIKE(WACO)
     D  WQSA02         S                   LIKE(WAMCU)
     D  W0PMT          S              1
      /EJECT
      * Parameter declarations
     D P1PARM          DS
      * I :  OMS Company Number Alpha
     D  P1LVTX                 1      3
     D P2PARM          DS
      * I :  Business Unit/Cost Center
     D  P2MCU                  1     12
     D P3PARM          DS
      * O :  Description
     D  P3DL01                 1     30
     II0006LB
      * Business Unit Mstr F0006  Co/BizUnit
      * Renamed input format fields
     I              MCMCU                       WAMCU
     I              MCSTYL                      WASTYL
     I              MCDC                        WADC
     I              MCLDM                       WALDM
     I              MCCO                        WACO
     I              MCAN8                       WAAN8
     I              MCAN8O                      WAAN8O
     I              MCCNTY                      WACNTY
     I              MCADDS                      WAADDS
     I              MCFMOD                      WAFMOD
     I              MCDL01                      WADL01
     I              MCDL02                      WADL02
     I              MCDL03                      WADL03
     I              MCDL04                      WADL04
     I              MCRP01                      WARP01
     I              MCRP02                      WARP02
     I              MCRP03                      WARP03
     I              MCRP04                      WARP04
     I              MCRP05                      WARP05
     I              MCRP06                      WARP06
     I              MCRP07                      WARP07
     I              MCRP08                      WARP08
     I              MCRP09                      WARP09
     I              MCRP10                      WARP10
     I              MCRP11                      WARP11
     I              MCRP12                      WARP12
     I              MCRP13                      WARP13
     I              MCRP14                      WARP14
     I              MCRP15                      WARP15
     I              MCRP16                      WARP16
     I              MCRP17                      WARP17
     I              MCRP18                      WARP18
     I              MCRP19                      WARP19
     I              MCRP20                      WARP20
     I              MCRP21                      WARP21
     I              MCRP22                      WARP22
     I              MCRP23                      WARP23
     I              MCRP24                      WARP24
     I              MCRP25                      WARP25
     I              MCRP26                      WARP26
     I              MCRP27                      WARP27
     I              MCRP28                      WARP28
     I              MCRP29                      WARP29
     I              MCRP30                      WARP30
     I              MCTA                        WATA
     I              MCTXJS                      WATXJS
     I              MCTXA1                      WATXA1
     I              MCEXR1                      WAEXR1
     I              MCTC01                      WATC01
     I              MCTC02                      WATC02
     I              MCTC03                      WATC03
     I              MCTC04                      WATC04
     I              MCTC05                      WATC05
     I              MCTC06                      WATC06
     I              MCTC07                      WATC07
     I              MCTC08                      WATC08
     I              MCBDCD                      WABDCD
     I              MCTC10                      WATC10
     I              MCND01                      WAND01
     I              MCND02                      WAND02
     I              MCND03                      WAND03
     I              MCND04                      WAND04
     I              MCND05                      WAND05
     I              MCND06                      WAND06
     I              MCND07                      WAND07
     I              MCND08                      WAND08
     I              MCND09                      WAND09
     I              MCND10                      WAND10
     I              MCCC01                      WACC01
     I              MCCC02                      WACC02
     I              MCCC03                      WACC03
     I              MCCC04                      WACC04
     I              MCCC05                      WACC05
     I              MCCC06                      WACC06
     I              MCG1ST                      WAG1ST
     I              MCG2ST                      WAG2ST
     I              MCG3ST                      WAG3ST
     I              MCG4ST                      WAG4ST
     I              MCPECC                      WAPECC
     I              MCCALS                      WACALS
     I              MCCISS                      WACISS
     I              MCGLBA                      WAGLBA
     I              MCALCL                      WAALCL
     I              MCLMTH                      WALMTH
     I              MCLF                        WALF
     I              MCOBJ1                      WAOBJ1
     I              MCOBJ2                      WAOBJ2
     I              MCOBJ3                      WAOBJ3
     I              MCSUB1                      WASUB1
     I              MCTOU                       WATOU
     I              MCSBLI                      WASBLI
     I              MCANPA                      WAANPA
     I              MCCT                        WACT
     I              MCCERT                      WACERT
     I              MCMCUS                      WAMCUS
     I              MCBTYP                      WABTYP
     I              MCPC                        WAPC
     I              MCPCA                       WAPCA
     I              MCPCC                       WAPCC
     I              MCINTA                      WAINTA
     I              MCINTL                      WAINTL
     I              MCD1J                       WAD1J
     I              MCD2J                       WAD2J
     I              MCD3J                       WAD3J
     I              MCD4J                       WAD4J
     I              MCD5J                       WAD5J
     I              MCD6J                       WAD6J
     I              MCFPDJ                      WAFPDJ
     I              MCCAC                       WACAC
     I              MCPAC                       WAPAC
     I              MCEEO                       WAEEO
     I              MCERC                       WAERC
     I              MCUSER                      WAUSER
     I              MCPID                       WAPID
     I              MCUPMJ                      WAUPMJ
     I              MCJOBN                      WAJOBN
     I              MCUPMT                      WAUPMT
     I              MCBPTP                      WABPTP
     I              MCAPSB                      WAAPSB
     I              MCTSBU                      WATSBU
     I              MCRP31                      WARP31
     I              MCRP32                      WARP32
     I              MCRP33                      WARP33
     I              MCRP34                      WARP34
     I              MCRP35                      WARP35
     I              MCRP36                      WARP36
     I              MCRP37                      WARP37
     I              MCRP38                      WARP38
     I              MCRP39                      WARP39
     I              MCRP40                      WARP40
     I              MCRP41                      WARP41
     I              MCRP42                      WARP42
     I              MCRP43                      WARP43
     I              MCRP44                      WARP44
     I              MCRP45                      WARP45
     I              MCRP46                      WARP46
     I              MCRP47                      WARP47
     I              MCRP48                      WARP48
     I              MCRP49                      WARP49
     I              MCRP50                      WARP50
     I              MCGCA1                      WAGCA1
     I              MCGCA2                      WAGCA2
     I              MCGCA3                      WAGCA3
     I              MCGCA4                      WAGCA4
     I              MCGCA5                      WAGCA5
     I              MCMCU1                      WAMCU1
     I              MCDOCO                      WADOCO
     I              MCPCTN                      WAPCTN
     I              MCCLNU                      WACLNU
     I              MCBUCA                      WABUCA
     I              MCADJE                      WAADJE
     I              MCUAFL                      WAUAFL
      *
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
     C     P1LVTX        PARM                    WP0001                         OMS Company Num
     C     P2MCU         PARM                    WP0002                         Business Unit/C
     C     P3DL01        PARM      P3DL01        WP0003                         Description
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * Rtv BU/CC Desc     E1 XF
      * Modification history
     C                   EXSR      UASUBR                                       Modification hi
     C                   MOVE      P1LVTX        YL0001                         OMS Company Num
     C                   Z-ADD     YL0001        YL0002                         Company Number
     C                   MOVEL     YL0002        YL0003                         Company
      * Rtv BU/CC Desc     E1 RT - Business Unit Mstr F0006  * 
     C                   EXSR      SARVGN
     C                   MOVEL     W0RTN         P0RTN                          *Return code
     C                   EXSR      ZYEXPG
      *----------------------------------------------------------------
      * Exit program
     C     AAEXIT        TAG
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
      /EJECT
     CSR   SARVGN        BEGSR
      *================================================================
      * Rtv BU/CC Desc     E1 RT - Business Unit Mstr F0006  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSA         KLIST
     C                   KFLD                    WQSA01                         Company
     C                   KFLD                    WQSA02                         Business Unit/C
      * Setup key
     C                   MOVEL     YL0003        WQSA01                         Company
     C                   MOVEL     P2MCU         WQSA02                         Business Unit/C
      * Establish starting position
     C     KRSSA         SETLL     I0006LB                                      *
     C     KRSSA         READE     I0006LB                                90    *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'E1I0090'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      P3DL01 = ' '                                 Description
     C                   EVAL      W0RTN = ' '                                  *Return code
     C                   MOVEL     'ERR'         W0RTN                          *Return code
     C                   GOTO      SAEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * If Posting Edit is Non-Post, set return code to ERR
      * CASE: DB1.Posting Edit - Biz Unit is Non-Post
     C                   DOW       NOT *IN90
      * PAR = CON By name
     C                   IF        WAPECC = 'N'
     C                   EVAL      P3DL01 = ' '                                 Description
     C                   EVAL      W0RTN = ' '                                  *Return code
     C                   MOVEL     'ERR'         W0RTN                          *Return code
     C                   ELSE
      * CASE: *OTHERWISE
      * PAR = DB1 By name
     C                   MOVEL     WADL01        P3DL01                         Description
     C                   EVAL      W0RTN = ' '                                  *Return code
     C                   END                                                    *FI
     C     KRSSA         READE     I0006LB                                90    *
     C                   ENDDO
      *================================================================
     CSR   SAEXIT        ENDSR
      /EJECT
     CSR   UASUBR        BEGSR
      *================================================================
      * Modification history
      *================================================================
      *  3/18/2020 JBB SDN465 - JDE World to JDE Enterprise 1
      *                P16969  Function created.  Logic is same as World
      *                        program CCRETW.
      *================================================================
     CSR   UAEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      *
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WAAN8                          Address Number
     C                   Z-ADD     *ZERO         WAAN8O                         Address Number
     C                   Z-ADD     *ZERO         WATXJS                         Tax Entity
     C                   Z-ADD     *ZERO         WALF                           Labor Distrib M
     C                   Z-ADD     *ZERO         WATOU                          Units - Total
     C                   Z-ADD     *ZERO         WAANPA                         Supervisor
     C                   Z-ADD     *ZERO         WAPC                           Percent Complet
     C                   Z-ADD     *ZERO         WAPCA                          Percent Complet
     C                   Z-ADD     *ZERO         WAPCC                          Amount - Cost t
     C                   Z-ADD     *ZERO         WAD1J                          Date - Planned
     C                   Z-ADD     *ZERO         WAD2J                          Date - Actual S
     C                   Z-ADD     *ZERO         WAD3J                          Date - Planned
     C                   Z-ADD     *ZERO         WAD4J                          Date - Actual C
     C                   Z-ADD     *ZERO         WAD5J                          Date - Other 5
     C                   Z-ADD     *ZERO         WAD6J                          Date - Other 6
     C                   Z-ADD     *ZERO         WAFPDJ                         Date - Final Pa
     C                   Z-ADD     *ZERO         WACAC                          Amount-Cost at
     C                   Z-ADD     *ZERO         WAPAC                          Amount-Profit a
     C                   Z-ADD     *ZERO         WAUPMJ                         Date - Updated
     C                   Z-ADD     *ZERO         WAUPMT                         Time - Last Upd
     C                   Z-ADD     *ZERO         WAGCA1                         Address Number
     C                   Z-ADD     *ZERO         WAGCA2                         Address Number
     C                   Z-ADD     *ZERO         WAGCA3                         Address Number
     C                   Z-ADD     *ZERO         WAGCA4                         Address Number
     C                   Z-ADD     *ZERO         WAGCA5                         Address Number
     C                   Z-ADD     *ZERO         WADOCO                         Document Number
     C                   Z-ADD     *ZERO         WAPCTN                         Parent Contract
     C                   Z-ADD     *ZERO         WACLNU                         Contract Level
     C                   MOVEL     'N'           W0PMT
      * Define local work field OMS Company Number
     C                   Z-ADD     *ZERO         YL0001
      * Define local work field Company Number 5.0
     C                   Z-ADD     *ZERO         YL0002
      * Define local work field Company
     C                   EVAL      YL0003 = ' '
      *================================================================
     CSR   ZZEXIT        ENDSR
