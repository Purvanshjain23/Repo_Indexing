     H/TITLE Clc/Crt FuelSrchg Itm XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 10/05/22  Time  : 10:01:56
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOPBFCPL8IF  E           K        DISK
      * RSQ : Order Header TRG          Load #/All orders
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FOPBFCPMNIF  E           K        DISK
      * RSQ : Order Header TRG          Load ID/Order(sts=C,R
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse Codes           Active records only
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FOPBGWKL0UF  E           K        DISK                      A
      * UPD : Order Detail              Update index
      *
     I@BFCPD9
      * Order Header TRG          Load #/All orders
      * Renamed input format fields
     I              BEAIC3                          WAAIC3
     I              BEC4NB                          WAC4NB
     I              BEJNCD                          WAJNCD
     I              BEANC7                          WAANC7
     I              BEBKC7                          WABKC7
     I              BEBRTX                          WABRTX
     I              BEHMNA                          WAHMNA
     I              BEHONA                          WAHONA
     I              BEHPNA                          WAHPNA
     I              BEHNNA                          WAHNNA
     I              BEDBCD                          WADBCD
     I              BECKTX                          WACKTX
     I              BEB0C7                          WAB0C7
     I              BEAETX                          WAAETX
     I              BEB1NA                          WAB1NA
     I              BEB3NA                          WAB3NA
     I              BEB4NA                          WAB4NA
     I              BEB2NA                          WAB2NA
     I              BEBHCD                          WABHCD
     I              BEC8TX                          WAC8TX
     I              BEBCNA                          WABCNA
     I              BEA0DT                          WAA0DT
     I              BEA5DT                          WAA5DT
     I              BEGNDT                          WAGNDT
     I              BEACDT                          WAACDT
     I              BEAQCD                          WAAQCD
     I              BEB6NA                          WAB6NA
     I              BEBYNA                          WABYNA
     I              BEBZNA                          WABZNA
     I              BEGTST                          WAGTST
     I              BEGVST                          WAGVST
     I              BEGUST                          WAGUST
     I              BEQFST                          WAQFST
     I              BECQCD                          WACQCD
     I              BEGJST                          WAGJST
     I              BEGWST                          WAGWST
     I              BEGXST                          WAGXST
     I              BEGYST                          WAGYST
     I              BEAODT                          WAAODT
     I              BEAIVN                          WAAIVN
     I              BECXDT                          WACXDT
     I              BEJZVA                          WAJZVA
     I              BEA1WG                          WAA1WG
     I              BEXIST                          WAXIST
     I              BEXJST                          WAXJST
     I              BEXKST                          WAXKST
     I              BEEIDT                          WAEIDT
     I              BEAFTM                          WAAFTM
     I              BEE8CD                          WAE8CD
     I              BEE9CD                          WAE9CD
     I              BERMNB                          WARMNB
     I              BETBNB                          WATBNB
     I              BER1NB                          WAR1NB
     I              BEPJST                          WAPJST
     I              BEU0ST                          WAU0ST
     I              BEU1ST                          WAU1ST
     I              BEQ2CD                          WAQ2CD
     I              BEU2ST                          WAU2ST
     I              BEVEST                          WAVEST
     I              BEVFST                          WAVFST
     I              BEVGST                          WAVGST
     I              BERPCD                          WARPCD
     I              BERNNB                          WARNNB
     I              BEVDST                          WAVDST
     I              BEATIN                          WAATIN
     I              BEU4ST                          WAU4ST
     I              BEU5ST                          WAU5ST
     I              BERSRN                          WARSRN
     I              BEMHNA                          WAMHNA
     I              BEMINA                          WAMINA
     I              BEWBST                          WAWBST
     I              BER4CD                          WAR4CD
     I              BEBFCD                          WABFCD
     I              BEQ4CD                          WAQ4CD
     I              BET3NB                          WAT3NB
     I              BESICD                          WASICD
     I              BECONB                          WACONB
     I              BECEST                          WACEST
     I              BEAWDT                          WAAWDT
     I              BEJPCD                          WAJPCD
     I              BEXUST                          WAXUST
     I              BEZ1ST                          WAZ1ST
     I              BEVRVA                          WAVRVA
     I              BEOBST                          WAOBST
     I              BEBCST                          WABCST
     I              BEBDST                          WABDST
     I              BEB7VL                          WAB7VL
     I              BEGASX                          WAGASX
     I              BEGBSX                          WAGBSX
     I              BEGCSX                          WAGCSX
     I              BEGDSX                          WAGDSX
     I              BEFNSX                          WAFNSX
     I              BEFOSX                          WAFOSX
     I              BEFPSX                          WAFPSX
     I              BEFQSX                          WAFQSX
     I              BEFRSX                          WAFRSX
     I              BEFSSX                          WAFSSX
     I              BEFTSX                          WAFTSX
     I              BEFUSX                          WAFUSX
     I              BEFVSX                          WAFVSX
     I              BEFWSX                          WAFWSX
     I              BEFXSX                          WAFXSX
     I              BEFYSX                          WAFYSX
     I              BENODT                          WANODT
     I              BENPDT                          WANPDT
     I              BENQDT                          WANQDT
     I              BENRDT                          WANRDT
     I              BENSDT                          WANSDT
     I              BEBPTM                          WABPTM
     I              BEBQTM                          WABQTM
     I              BEBRTM                          WABRTM
     I              BEBSTM                          WABSTM
     I              BEBTTM                          WABTTM
     I              BEH0NX                          WAH0NX
     I              BEH1NX                          WAH1NX
     I              BEH2NX                          WAH2NX
     I              BEH3NX                          WAH3NX
     I              BEH4NX                          WAH4NX
     I              BEC0C7                          WAC0C7
     I              BEUVST                          WAUVST
     I              BEUWST                          WAUWST
     I              BEUXST                          WAUXST
     I              BEAATM                          WAAATM
     I              BEAYNA                          WAAYNA
     I              BEA0NA                          WAA0NA
     I              BEAXDT                          WAAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WBAIC3
     I              OMC4NB                          WBC4NB
     I              OMDPNB                          WBDPNB
     I              OMUENB                          WBUENB
     I              OMHGCD                          WBHGCD
     I              OMAJCD                          WBAJCD
     I              OMBKC7                          WBBKC7
     I              OMCFC7                          WBCFC7
     I              OMGMST                          WBGMST
     I              OMGNST                          WBGNST
     I              OMMAVA                          WBMAVA
     I              OMKDVA                          WBKDVA
     I              OML8VA                          WBL8VA
     I              OML9VA                          WBL9VA
     I              OMGTST                          WBGTST
     I              OMGVST                          WBGVST
     I              OMGUST                          WBGUST
     I              OMQFST                          WBQFST
     I              OMAYVA                          WBAYVA
     I              OMEXDT                          WBEXDT
     I              OMLQCD                          WBLQCD
     I              OMRDCD                          WBRDCD
     I              OMQ7CD                          WBQ7CD
     I              OMBZPR                          WBBZPR
     I              OML6NB                          WBL6NB
     I              OMU1ST                          WBU1ST
     I              OMGIDT                          WBGIDT
     I              OMCRCD                          WBCRCD
     I              OMAGCD                          WBAGCD
     I              OMRZST                          WBRZST
     I              OMR0ST                          WBR0ST
     I              OMR1ST                          WBR1ST
     I              OMG7NA                          WBG7NA
     I              OMG8NA                          WBG8NA
     I              OMRPCD                          WBRPCD
     I              OMVEST                          WBVEST
     I              OMVGST                          WBVGST
     I              OMAVST                          WBAVST
     I              OMU0ST                          WBU0ST
     I              OMRFCD                          WBRFCD
     I              OMFZST                          WBFZST
     I              OMR1NB                          WBR1NB
     I              OMAVQT                          WBAVQT
     I              OMD0WG                          WBD0WG
     I              OMCCQT                          WBCCQT
     I              OMAUWG                          WBAUWG
     I              OMCBQT                          WBCBQT
     I              OMATWG                          WBATWG
     I              OMAQCS                          WBAQCS
     I              OMAGCS                          WBAGCS
     I              OMAKPR                          WBAKPR
     I              OMALPR                          WBALPR
     I              OMAUPR                          WBAUPR
     I              OMAVWG                          WBAVWG
     I              OMA4WG                          WBA4WG
     I              OMA5DT                          WBA5DT
     I              OMAODT                          WBAODT
     I              OMGNDT                          WBGNDT
     I              OMAMST                          WBAMST
     I              OMANST                          WBANST
     I              OMVAST                          WBVAST
     I              OMRGNB                          WBRGNB
     I              OMRHNB                          WBRHNB
     I              OMRINB                          WBRINB
     I              OMRBCD                          WBRBCD
     I              OMHICD                          WBHICD
     I              OMRNCD                          WBRNCD
     I              OMROCD                          WBROCD
     I              OMCXDT                          WBCXDT
     I              OMAJVN                          WBAJVN
     I              OMKXCD                          WBKXCD
     I              OMJPCD                          WBJPCD
     I              OMCQCD                          WBCQCD
     I              OMR4CD                          WBR4CD
     I              OMZ1ST                          WBZ1ST
     I              OMZ3ST                          WBZ3ST
     I              OMZ4ST                          WBZ4ST
     I              OMDUPR                          WBDUPR
     I              OMB6VL                          WBB6VL
     I              OMA1AA                          WBA1AA
     I              OMFZSX                          WBFZSX
     I              OMF0SX                          WBF0SX
     I              OMF1SX                          WBF1SX
     I              OMF2SX                          WBF2SX
     I              OMF3SX                          WBF3SX
     I              OMF4SX                          WBF4SX
     I              OMF5SX                          WBF5SX
     I              OMF6SX                          WBF6SX
     I              OMF7SX                          WBF7SX
     I              OMNTDT                          WBNTDT
     I              OMNUDT                          WBNUDT
     I              OMNVDT                          WBNVDT
     I              OMNWDT                          WBNWDT
     I              OMNXDT                          WBNXDT
     I              OMBUTM                          WBBUTM
     I              OMBVTM                          WBBVTM
     I              OMBWTM                          WBBWTM
     I              OMBXTM                          WBBXTM
     I              OMBYTM                          WBBYTM
     I              OMH5NX                          WBH5NX
     I              OMH6NX                          WBH6NX
     I              OMH7NX                          WBH7NX
     I              OMH8NX                          WBH8NX
     I              OMH9NX                          WBH9NX
     I              OMDVPR                          WBDVPR
     I              OMDWPR                          WBDWPR
     I              OMDXPR                          WBDXPR
     I              OMDYPR                          WBDYPR
     I              OMDZPR                          WBDZPR
     I              OMGSPR                          WBGSPR
     I              OMGTPR                          WBGTPR
     I              OMGUPR                          WBGUPR
     I              OMHOST                          WBHOST
     I              OMHPST                          WBHPST
     I              OMIOST                          WBIOST
     I              OMPEWG                          WBPEWG
     I              OMRINY                          WBRINY
     I              OMTIDT                          WBTIDT
     I              OMTJDT                          WBTJDT
     I              OMH2ST                          WBH2ST
     I              OMH0ST                          WBH0ST
     I              OMH1ST                          WBH1ST
     I              OMTKDT                          WBTKDT
     I              OMTLDT                          WBTLDT
     I              OMTMDT                          WBTMDT
     I              OMUVST                          WBUVST
     I              OMUWST                          WBUWST
     I              OMUXST                          WBUXST
     I              OMAATM                          WBAATM
     I              OMAYNA                          WBAYNA
     I              OMA0NA                          WBA0NA
     I              OMAXDT                          WBAXDT
      *
     I@BFCPEQ
      * Order Header TRG          Load ID/Order(sts=C,R
      * Renamed input format fields
     I              BEAIC3                          WCAIC3
     I              BEC4NB                          WCC4NB
     I              BEJNCD                          WCJNCD
     I              BEANC7                          WCANC7
     I              BEBKC7                          WCBKC7
     I              BEBRTX                          WCBRTX
     I              BEHMNA                          WCHMNA
     I              BEHONA                          WCHONA
     I              BEHPNA                          WCHPNA
     I              BEHNNA                          WCHNNA
     I              BEDBCD                          WCDBCD
     I              BECKTX                          WCCKTX
     I              BEB0C7                          WCB0C7
     I              BEAETX                          WCAETX
     I              BEB1NA                          WCB1NA
     I              BEB3NA                          WCB3NA
     I              BEB4NA                          WCB4NA
     I              BEB2NA                          WCB2NA
     I              BEBHCD                          WCBHCD
     I              BEC8TX                          WCC8TX
     I              BEBCNA                          WCBCNA
     I              BEA0DT                          WCA0DT
     I              BEA5DT                          WCA5DT
     I              BEGNDT                          WCGNDT
     I              BEACDT                          WCACDT
     I              BEAQCD                          WCAQCD
     I              BEB6NA                          WCB6NA
     I              BEBYNA                          WCBYNA
     I              BEBZNA                          WCBZNA
     I              BEGTST                          WCGTST
     I              BEGVST                          WCGVST
     I              BEGUST                          WCGUST
     I              BEQFST                          WCQFST
     I              BECQCD                          WCCQCD
     I              BEGJST                          WCGJST
     I              BEGWST                          WCGWST
     I              BEGXST                          WCGXST
     I              BEGYST                          WCGYST
     I              BEAODT                          WCAODT
     I              BEAIVN                          WCAIVN
     I              BECXDT                          WCCXDT
     I              BEJZVA                          WCJZVA
     I              BEA1WG                          WCA1WG
     I              BEXIST                          WCXIST
     I              BEXJST                          WCXJST
     I              BEXKST                          WCXKST
     I              BEEIDT                          WCEIDT
     I              BEAFTM                          WCAFTM
     I              BEE8CD                          WCE8CD
     I              BEE9CD                          WCE9CD
     I              BERMNB                          WCRMNB
     I              BETBNB                          WCTBNB
     I              BER1NB                          WCR1NB
     I              BEPJST                          WCPJST
     I              BEU0ST                          WCU0ST
     I              BEU1ST                          WCU1ST
     I              BEQ2CD                          WCQ2CD
     I              BEU2ST                          WCU2ST
     I              BEVEST                          WCVEST
     I              BEVFST                          WCVFST
     I              BEVGST                          WCVGST
     I              BERPCD                          WCRPCD
     I              BERNNB                          WCRNNB
     I              BEVDST                          WCVDST
     I              BEATIN                          WCATIN
     I              BEU4ST                          WCU4ST
     I              BEU5ST                          WCU5ST
     I              BERSRN                          WCRSRN
     I              BEMHNA                          WCMHNA
     I              BEMINA                          WCMINA
     I              BEWBST                          WCWBST
     I              BER4CD                          WCR4CD
     I              BEBFCD                          WCBFCD
     I              BEQ4CD                          WCQ4CD
     I              BET3NB                          WCT3NB
     I              BESICD                          WCSICD
     I              BECONB                          WCCONB
     I              BECEST                          WCCEST
     I              BEAWDT                          WCAWDT
     I              BEJPCD                          WCJPCD
     I              BEXUST                          WCXUST
     I              BEZ1ST                          WCZ1ST
     I              BEVRVA                          WCVRVA
     I              BEOBST                          WCOBST
     I              BEBCST                          WCBCST
     I              BEBDST                          WCBDST
     I              BEB7VL                          WCB7VL
     I              BEGASX                          WCGASX
     I              BEGBSX                          WCGBSX
     I              BEGCSX                          WCGCSX
     I              BEGDSX                          WCGDSX
     I              BEFNSX                          WCFNSX
     I              BEFOSX                          WCFOSX
     I              BEFPSX                          WCFPSX
     I              BEFQSX                          WCFQSX
     I              BEFRSX                          WCFRSX
     I              BEFSSX                          WCFSSX
     I              BEFTSX                          WCFTSX
     I              BEFUSX                          WCFUSX
     I              BEFVSX                          WCFVSX
     I              BEFWSX                          WCFWSX
     I              BEFXSX                          WCFXSX
     I              BEFYSX                          WCFYSX
     I              BENODT                          WCNODT
     I              BENPDT                          WCNPDT
     I              BENQDT                          WCNQDT
     I              BENRDT                          WCNRDT
     I              BENSDT                          WCNSDT
     I              BEBPTM                          WCBPTM
     I              BEBQTM                          WCBQTM
     I              BEBRTM                          WCBRTM
     I              BEBSTM                          WCBSTM
     I              BEBTTM                          WCBTTM
     I              BEH0NX                          WCH0NX
     I              BEH1NX                          WCH1NX
     I              BEH2NX                          WCH2NX
     I              BEH3NX                          WCH3NX
     I              BEH4NX                          WCH4NX
     I              BEC0C7                          WCC0C7
     I              BEUVST                          WCUVST
     I              BEUWST                          WCUWST
     I              BEUXST                          WCUXST
     I              BEAATM                          WCAATM
     I              BEAYNA                          WCAYNA
     I              BEA0NA                          WCA0NA
     I              BEAXDT                          WCAXDT
      *
     I@BGWKAE
      * Order Detail              co/
      * Renamed input format fields
     I              OMAIC3                          WDAIC3
     I              OMC4NB                          WDC4NB
     I              OMDPNB                          WDDPNB
     I              OMUENB                          WDUENB
     I              OMHGCD                          WDHGCD
     I              OMAJCD                          WDAJCD
     I              OMBKC7                          WDBKC7
     I              OMCFC7                          WDCFC7
     I              OMGMST                          WDGMST
     I              OMGNST                          WDGNST
     I              OMMAVA                          WDMAVA
     I              OMKDVA                          WDKDVA
     I              OML8VA                          WDL8VA
     I              OML9VA                          WDL9VA
     I              OMGTST                          WDGTST
     I              OMGVST                          WDGVST
     I              OMGUST                          WDGUST
     I              OMQFST                          WDQFST
     I              OMAYVA                          WDAYVA
     I              OMEXDT                          WDEXDT
     I              OMLQCD                          WDLQCD
     I              OMRDCD                          WDRDCD
     I              OMQ7CD                          WDQ7CD
     I              OMBZPR                          WDBZPR
     I              OML6NB                          WDL6NB
     I              OMU1ST                          WDU1ST
     I              OMGIDT                          WDGIDT
     I              OMCRCD                          WDCRCD
     I              OMAGCD                          WDAGCD
     I              OMRZST                          WDRZST
     I              OMR0ST                          WDR0ST
     I              OMR1ST                          WDR1ST
     I              OMG7NA                          WDG7NA
     I              OMG8NA                          WDG8NA
     I              OMRPCD                          WDRPCD
     I              OMVEST                          WDVEST
     I              OMVGST                          WDVGST
     I              OMAVST                          WDAVST
     I              OMU0ST                          WDU0ST
     I              OMRFCD                          WDRFCD
     I              OMFZST                          WDFZST
     I              OMR1NB                          WDR1NB
     I              OMAVQT                          WDAVQT
     I              OMD0WG                          WDD0WG
     I              OMCCQT                          WDCCQT
     I              OMAUWG                          WDAUWG
     I              OMCBQT                          WDCBQT
     I              OMATWG                          WDATWG
     I              OMAQCS                          WDAQCS
     I              OMAGCS                          WDAGCS
     I              OMAKPR                          WDAKPR
     I              OMALPR                          WDALPR
     I              OMAUPR                          WDAUPR
     I              OMAVWG                          WDAVWG
     I              OMA4WG                          WDA4WG
     I              OMA5DT                          WDA5DT
     I              OMAODT                          WDAODT
     I              OMGNDT                          WDGNDT
     I              OMAMST                          WDAMST
     I              OMANST                          WDANST
     I              OMVAST                          WDVAST
     I              OMRGNB                          WDRGNB
     I              OMRHNB                          WDRHNB
     I              OMRINB                          WDRINB
     I              OMRBCD                          WDRBCD
     I              OMHICD                          WDHICD
     I              OMRNCD                          WDRNCD
     I              OMROCD                          WDROCD
     I              OMCXDT                          WDCXDT
     I              OMAJVN                          WDAJVN
     I              OMKXCD                          WDKXCD
     I              OMJPCD                          WDJPCD
     I              OMCQCD                          WDCQCD
     I              OMR4CD                          WDR4CD
     I              OMZ1ST                          WDZ1ST
     I              OMZ3ST                          WDZ3ST
     I              OMZ4ST                          WDZ4ST
     I              OMDUPR                          WDDUPR
     I              OMB6VL                          WDB6VL
     I              OMA1AA                          WDA1AA
     I              OMFZSX                          WDFZSX
     I              OMF0SX                          WDF0SX
     I              OMF1SX                          WDF1SX
     I              OMF2SX                          WDF2SX
     I              OMF3SX                          WDF3SX
     I              OMF4SX                          WDF4SX
     I              OMF5SX                          WDF5SX
     I              OMF6SX                          WDF6SX
     I              OMF7SX                          WDF7SX
     I              OMNTDT                          WDNTDT
     I              OMNUDT                          WDNUDT
     I              OMNVDT                          WDNVDT
     I              OMNWDT                          WDNWDT
     I              OMNXDT                          WDNXDT
     I              OMBUTM                          WDBUTM
     I              OMBVTM                          WDBVTM
     I              OMBWTM                          WDBWTM
     I              OMBXTM                          WDBXTM
     I              OMBYTM                          WDBYTM
     I              OMH5NX                          WDH5NX
     I              OMH6NX                          WDH6NX
     I              OMH7NX                          WDH7NX
     I              OMH8NX                          WDH8NX
     I              OMH9NX                          WDH9NX
     I              OMDVPR                          WDDVPR
     I              OMDWPR                          WDDWPR
     I              OMDXPR                          WDDXPR
     I              OMDYPR                          WDDYPR
     I              OMDZPR                          WDDZPR
     I              OMGSPR                          WDGSPR
     I              OMGTPR                          WDGTPR
     I              OMGUPR                          WDGUPR
     I              OMHOST                          WDHOST
     I              OMHPST                          WDHPST
     I              OMIOST                          WDIOST
     I              OMPEWG                          WDPEWG
     I              OMRINY                          WDRINY
     I              OMTIDT                          WDTIDT
     I              OMTJDT                          WDTJDT
     I              OMH2ST                          WDH2ST
     I              OMH0ST                          WDH0ST
     I              OMH1ST                          WDH1ST
     I              OMTKDT                          WDTKDT
     I              OMTLDT                          WDTLDT
     I              OMTMDT                          WDTMDT
     I              OMUVST                          WDUVST
     I              OMUWST                          WDUWST
     I              OMUXST                          WDUXST
     I              OMAATM                          WDAATM
     I              OMAYNA                          WDAYNA
     I              OMA0NA                          WDA0NA
     I              OMAXDT                          WDAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WEAIC3
     I              BEC4NB                          WEC4NB
     I              BEJNCD                          WEJNCD
     I              BEANC7                          WEANC7
     I              BEBKC7                          WEBKC7
     I              BEBRTX                          WEBRTX
     I              BEHMNA                          WEHMNA
     I              BEHONA                          WEHONA
     I              BEHPNA                          WEHPNA
     I              BEHNNA                          WEHNNA
     I              BEDBCD                          WEDBCD
     I              BECKTX                          WECKTX
     I              BEB0C7                          WEB0C7
     I              BEAETX                          WEAETX
     I              BEB1NA                          WEB1NA
     I              BEB3NA                          WEB3NA
     I              BEB4NA                          WEB4NA
     I              BEB2NA                          WEB2NA
     I              BEBHCD                          WEBHCD
     I              BEC8TX                          WEC8TX
     I              BEBCNA                          WEBCNA
     I              BEA0DT                          WEA0DT
     I              BEA5DT                          WEA5DT
     I              BEGNDT                          WEGNDT
     I              BEACDT                          WEACDT
     I              BEAQCD                          WEAQCD
     I              BEB6NA                          WEB6NA
     I              BEBYNA                          WEBYNA
     I              BEBZNA                          WEBZNA
     I              BEGTST                          WEGTST
     I              BEGVST                          WEGVST
     I              BEGUST                          WEGUST
     I              BEQFST                          WEQFST
     I              BECQCD                          WECQCD
     I              BEGJST                          WEGJST
     I              BEGWST                          WEGWST
     I              BEGXST                          WEGXST
     I              BEGYST                          WEGYST
     I              BEAODT                          WEAODT
     I              BEAIVN                          WEAIVN
     I              BECXDT                          WECXDT
     I              BEJZVA                          WEJZVA
     I              BEA1WG                          WEA1WG
     I              BEXIST                          WEXIST
     I              BEXJST                          WEXJST
     I              BEXKST                          WEXKST
     I              BEEIDT                          WEEIDT
     I              BEAFTM                          WEAFTM
     I              BEE8CD                          WEE8CD
     I              BEE9CD                          WEE9CD
     I              BERMNB                          WERMNB
     I              BETBNB                          WETBNB
     I              BER1NB                          WER1NB
     I              BEPJST                          WEPJST
     I              BEU0ST                          WEU0ST
     I              BEU1ST                          WEU1ST
     I              BEQ2CD                          WEQ2CD
     I              BEU2ST                          WEU2ST
     I              BEVEST                          WEVEST
     I              BEVFST                          WEVFST
     I              BEVGST                          WEVGST
     I              BERPCD                          WERPCD
     I              BERNNB                          WERNNB
     I              BEVDST                          WEVDST
     I              BEATIN                          WEATIN
     I              BEU4ST                          WEU4ST
     I              BEU5ST                          WEU5ST
     I              BERSRN                          WERSRN
     I              BEMHNA                          WEMHNA
     I              BEMINA                          WEMINA
     I              BEWBST                          WEWBST
     I              BER4CD                          WER4CD
     I              BEBFCD                          WEBFCD
     I              BEQ4CD                          WEQ4CD
     I              BET3NB                          WET3NB
     I              BESICD                          WESICD
     I              BECONB                          WECONB
     I              BECEST                          WECEST
     I              BEAWDT                          WEAWDT
     I              BEJPCD                          WEJPCD
     I              BEXUST                          WEXUST
     I              BEZ1ST                          WEZ1ST
     I              BEVRVA                          WEVRVA
     I              BEOBST                          WEOBST
     I              BEBCST                          WEBCST
     I              BEBDST                          WEBDST
     I              BEB7VL                          WEB7VL
     I              BEGASX                          WEGASX
     I              BEGBSX                          WEGBSX
     I              BEGCSX                          WEGCSX
     I              BEGDSX                          WEGDSX
     I              BEFNSX                          WEFNSX
     I              BEFOSX                          WEFOSX
     I              BEFPSX                          WEFPSX
     I              BEFQSX                          WEFQSX
     I              BEFRSX                          WEFRSX
     I              BEFSSX                          WEFSSX
     I              BEFTSX                          WEFTSX
     I              BEFUSX                          WEFUSX
     I              BEFVSX                          WEFVSX
     I              BEFWSX                          WEFWSX
     I              BEFXSX                          WEFXSX
     I              BEFYSX                          WEFYSX
     I              BENODT                          WENODT
     I              BENPDT                          WENPDT
     I              BENQDT                          WENQDT
     I              BENRDT                          WENRDT
     I              BENSDT                          WENSDT
     I              BEBPTM                          WEBPTM
     I              BEBQTM                          WEBQTM
     I              BEBRTM                          WEBRTM
     I              BEBSTM                          WEBSTM
     I              BEBTTM                          WEBTTM
     I              BEH0NX                          WEH0NX
     I              BEH1NX                          WEH1NX
     I              BEH2NX                          WEH2NX
     I              BEH3NX                          WEH3NX
     I              BEH4NX                          WEH4NX
     I              BEC0C7                          WEC0C7
     I              BEUVST                          WEUVST
     I              BEUWST                          WEUWST
     I              BEUXST                          WEUXST
     I              BEAATM                          WEAATM
     I              BEAYNA                          WEAYNA
     I              BEA0NA                          WEA0NA
     I              BEAXDT                          WEAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WFAIC3
     I              BZHGCD                          WFHGCD
     I              BZAVNA                          WFAVNA
     I              BZAWNA                          WFAWNA
     I              BZL7NA                          WFL7NA
     I              BZL8NA                          WFL8NA
     I              BZL6NA                          WFL6NA
     I              BZMFNA                          WFMFNA
     I              BZADCD                          WFADCD
     I              BZAWPC                          WFAWPC
     I              BZLXST                          WFLXST
     I              BZAECD                          WFAECD
     I              BZAXPC                          WFAXPC
     I              BZLYST                          WFLYST
     I              BZAFCD                          WFAFCD
     I              BZAICD                          WFAICD
     I              BZAIWG                          WFAIWG
     I              BZHICD                          WFHICD
     I              BZRBCD                          WFRBCD
     I              BZFZST                          WFFZST
     I              BZAVST                          WFAVST
     I              BZCZWG                          WFCZWG
     I              BZC0WG                          WFC0WG
     I              BZURTN                          WFURTN
     I              BZAJC8                          WFAJC8
     I              BZRINB                          WFRINB
     I              BZRHNB                          WFRHNB
     I              BZRGNB                          WFRGNB
     I              BZLNCD                          WFLNCD
     I              BZTFNB                          WFTFNB
     I              BZN0CD                          WFN0CD
     I              BZX4ST                          WFX4ST
     I              BZTMVA                          WFTMVA
     I              BZTNVA                          WFTNVA
     I              BZBLPR                          WFBLPR
     I              BZBMPR                          WFBMPR
     I              BZLRCD                          WFLRCD
     I              BZU9ST                          WFU9ST
     I              BZCMCO                          WFCMCO
     I              BZQ1CD                          WFQ1CD
     I              BZQ8CD                          WFQ8CD
     I              BZCHTM                          WFCHTM
     I              BZQZCD                          WFQZCD
     I              BZXWST                          WFXWST
     I              BZXXST                          WFXXST
     I              BZVMST                          WFVMST
     I              BZSWGH                          WFSWGH
     I              BZPPHE                          WFPPHE
     I              BZR3CD                          WFR3CD
     I              BZSDCD                          WFSDCD
     I              BZICN1                          WFICN1
     I              BZSVCD                          WFSVCD
     I              BZICN2                          WFICN2
     I              BZSWCD                          WFSWCD
     I              BZV2NB                          WFV2NB
     I              BZSXCD                          WFSXCD
     I              BZITCN                          WFITCN
     I              BZSYCD                          WFSYCD
     I              BZITC5                          WFITC5
     I              BZSZCD                          WFSZCD
     I              BZICN6                          WFICN6
     I              BZS0CD                          WFS0CD
     I              BZICN7                          WFICN7
     I              BZS1CD                          WFS1CD
     I              BZICN8                          WFICN8
     I              BZS2CD                          WFS2CD
     I              BZICN9                          WFICN9
     I              BZS3CD                          WFS3CD
     I              BZICN0                          WFICN0
     I              BZS4CD                          WFS4CD
     I              BZSFNB                          WFSFNB
     I              BZA3WG                          WFA3WG
     I              BZSJNB                          WFSJNB
     I              BZLLCD                          WFLLCD
     I              BZLMCD                          WFLMCD
     I              BZP3ST                          WFP3ST
     I              BZSKNB                          WFSKNB
     I              BZSLNB                          WFSLNB
     I              BZSMNB                          WFSMNB
     I              BZP4ST                          WFP4ST
     I              BZCFNB                          WFCFNB
     I              BZCGNB                          WFCGNB
     I              BZILNB                          WFILNB
     I              BZCHNB                          WFCHNB
     I              BZCINB                          WFCINB
     I              BZCJNB                          WFCJNB
     I              BZCMNB                          WFCMNB
     I              BZCNNB                          WFCNNB
     I              BZCRNB                          WFCRNB
     I              BZCSNB                          WFCSNB
     I              BZCVNB                          WFCVNB
     I              BZCWNB                          WFCWNB
     I              BZCXNB                          WFCXNB
     I              BZCZNB                          WFCZNB
     I              BZC0NB                          WFC0NB
     I              BZN1CD                          WFN1CD
     I              BZB4NB                          WFB4NB
     I              BZB5NB                          WFB5NB
     I              BZX5ST                          WFX5ST
     I              BZX6ST                          WFX6ST
     I              BZX7ST                          WFX7ST
     I              BZPCCT                          WFPCCT
     I              BZBDNB                          WFBDNB
     I              BZBJNB                          WFBJNB
     I              BZSUST                          WFSUST
     I              BZSVST                          WFSVST
     I              BZSYST                          WFSYST
     I              BZSZST                          WFSZST
     I              BZS1ST                          WFS1ST
     I              BZXRCD                          WFXRCD
     I              BZXTCD                          WFXTCD
     I              BZXUCD                          WFXUCD
     I              BZF5WG                          WFF5WG
     I              BZF6WG                          WFF6WG
     I              BZF7WG                          WFF7WG
     I              BZBLNB                          WFBLNB
     I              BZBNNB                          WFBNNB
     I              BZS2ST                          WFS2ST
     I              BZS4ST                          WFS4ST
     I              BZS5ST                          WFS5ST
     I              BZS6ST                          WFS6ST
     I              BZS8ST                          WFS8ST
     I              BZS9ST                          WFS9ST
     I              BZTCST                          WFTCST
     I              BZTDST                          WFTDST
     I              BZUVST                          WFUVST
     I              BZUWST                          WFUWST
     I              BZUXST                          WFUXST
     I              BZVSST                          WFVSST
     I              BZAATM                          WFAATM
     I              BZAYNA                          WFAYNA
     I              BZA0NA                          WFA0NA
     I              BZAXDT                          WFAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WGAIC3
     I              OMC4NB                          WGC4NB
     I              OMDPNB                          WGDPNB
     I              OMUENB                          WGUENB
     I              OMHGCD                          WGHGCD
     I              OMAJCD                          WGAJCD
     I              OMBKC7                          WGBKC7
     I              OMCFC7                          WGCFC7
     I              OMGMST                          WGGMST
     I              OMGNST                          WGGNST
     I              OMMAVA                          WGMAVA
     I              OMKDVA                          WGKDVA
     I              OML8VA                          WGL8VA
     I              OML9VA                          WGL9VA
     I              OMGTST                          WGGTST
     I              OMGVST                          WGGVST
     I              OMGUST                          WGGUST
     I              OMQFST                          WGQFST
     I              OMAYVA                          WGAYVA
     I              OMEXDT                          WGEXDT
     I              OMLQCD                          WGLQCD
     I              OMRDCD                          WGRDCD
     I              OMQ7CD                          WGQ7CD
     I              OMBZPR                          WGBZPR
     I              OML6NB                          WGL6NB
     I              OMU1ST                          WGU1ST
     I              OMGIDT                          WGGIDT
     I              OMCRCD                          WGCRCD
     I              OMAGCD                          WGAGCD
     I              OMRZST                          WGRZST
     I              OMR0ST                          WGR0ST
     I              OMR1ST                          WGR1ST
     I              OMG7NA                          WGG7NA
     I              OMG8NA                          WGG8NA
     I              OMRPCD                          WGRPCD
     I              OMVEST                          WGVEST
     I              OMVGST                          WGVGST
     I              OMAVST                          WGAVST
     I              OMU0ST                          WGU0ST
     I              OMRFCD                          WGRFCD
     I              OMFZST                          WGFZST
     I              OMR1NB                          WGR1NB
     I              OMAVQT                          WGAVQT
     I              OMD0WG                          WGD0WG
     I              OMCCQT                          WGCCQT
     I              OMAUWG                          WGAUWG
     I              OMCBQT                          WGCBQT
     I              OMATWG                          WGATWG
     I              OMAQCS                          WGAQCS
     I              OMAGCS                          WGAGCS
     I              OMAKPR                          WGAKPR
     I              OMALPR                          WGALPR
     I              OMAUPR                          WGAUPR
     I              OMAVWG                          WGAVWG
     I              OMA4WG                          WGA4WG
     I              OMA5DT                          WGA5DT
     I              OMAODT                          WGAODT
     I              OMGNDT                          WGGNDT
     I              OMAMST                          WGAMST
     I              OMANST                          WGANST
     I              OMVAST                          WGVAST
     I              OMRGNB                          WGRGNB
     I              OMRHNB                          WGRHNB
     I              OMRINB                          WGRINB
     I              OMRBCD                          WGRBCD
     I              OMHICD                          WGHICD
     I              OMRNCD                          WGRNCD
     I              OMROCD                          WGROCD
     I              OMCXDT                          WGCXDT
     I              OMAJVN                          WGAJVN
     I              OMKXCD                          WGKXCD
     I              OMJPCD                          WGJPCD
     I              OMCQCD                          WGCQCD
     I              OMR4CD                          WGR4CD
     I              OMZ1ST                          WGZ1ST
     I              OMZ3ST                          WGZ3ST
     I              OMZ4ST                          WGZ4ST
     I              OMDUPR                          WGDUPR
     I              OMB6VL                          WGB6VL
     I              OMA1AA                          WGA1AA
     I              OMFZSX                          WGFZSX
     I              OMF0SX                          WGF0SX
     I              OMF1SX                          WGF1SX
     I              OMF2SX                          WGF2SX
     I              OMF3SX                          WGF3SX
     I              OMF4SX                          WGF4SX
     I              OMF5SX                          WGF5SX
     I              OMF6SX                          WGF6SX
     I              OMF7SX                          WGF7SX
     I              OMNTDT                          WGNTDT
     I              OMNUDT                          WGNUDT
     I              OMNVDT                          WGNVDT
     I              OMNWDT                          WGNWDT
     I              OMNXDT                          WGNXDT
     I              OMBUTM                          WGBUTM
     I              OMBVTM                          WGBVTM
     I              OMBWTM                          WGBWTM
     I              OMBXTM                          WGBXTM
     I              OMBYTM                          WGBYTM
     I              OMH5NX                          WGH5NX
     I              OMH6NX                          WGH6NX
     I              OMH7NX                          WGH7NX
     I              OMH8NX                          WGH8NX
     I              OMH9NX                          WGH9NX
     I              OMDVPR                          WGDVPR
     I              OMDWPR                          WGDWPR
     I              OMDXPR                          WGDXPR
     I              OMDYPR                          WGDYPR
     I              OMDZPR                          WGDZPR
     I              OMGSPR                          WGGSPR
     I              OMGTPR                          WGGTPR
     I              OMGUPR                          WGGUPR
     I              OMHOST                          WGHOST
     I              OMHPST                          WGHPST
     I              OMIOST                          WGIOST
     I              OMPEWG                          WGPEWG
     I              OMRINY                          WGRINY
     I              OMTIDT                          WGTIDT
     I              OMTJDT                          WGTJDT
     I              OMH2ST                          WGH2ST
     I              OMH0ST                          WGH0ST
     I              OMH1ST                          WGH1ST
     I              OMTKDT                          WGTKDT
     I              OMTLDT                          WGTLDT
     I              OMTMDT                          WGTMDT
     I              OMUVST                          WGUVST
     I              OMUWST                          WGUWST
     I              OMUXST                          WGUXST
     I              OMAATM                          WGAATM
     I              OMAYNA                          WGAYNA
     I              OMA0NA                          WGA0NA
     I              OMAXDT                          WGAXDT
      *
     I@ADRET1
      * Warehouse Codes           Active records only
      * Renamed input format fields
     I              ADAJCD                          WHAJCD
     I              ADF8NA                          WHF8NA
     I              ADACNA                          WHACNA
     I              ADADNA                          WHADNA
     I              ADAENA                          WHAENA
     I              ADAJNA                          WHAJNA
     I              ADBTTX                          WHBTTX
     I              ADAOCD                          WHAOCD
     I              ADBGCD                          WHBGCD
     I              ADVHST                          WHVHST
     I              ADMPNA                          WHMPNA
     I              ADWPST                          WHWPST
     I              ADXUST                          WHXUST
     I              ADT0ST                          WHT0ST
     I              ADT1ST                          WHT1ST
     I              ADDBNB                          WHDBNB
     I              ADT2ST                          WHT2ST
     I              ADT3ST                          WHT3ST
     I              ADT4ST                          WHT4ST
     I              ADT6ST                          WHT6ST
     I              ADBWC3                          WHBWC3
     I              ADBTC3                          WHBTC3
     I              ADBUC3                          WHBUC3
     I              ADBVC3                          WHBVC3
     I              ADFCAA                          WHFCAA
     I              ADRQSX                          WHRQSX
     I              ADRRSX                          WHRRSX
     I              ADRSSX                          WHRSSX
     I              ADRTSX                          WHRTSX
     I              ADT7ST                          WHT7ST
     I              ADT8ST                          WHT8ST
     I              ADRNSX                          WHRNSX
     I              ADROSX                          WHROSX
     I              ADRPSX                          WHRPSX
     I              ADUVST                          WHUVST
     I              ADUWST                          WHUWST
     I              ADUXST                          WHUXST
     I              ADVSST                          WHVSST
     I              ADAATM                          WHAATM
     I              ADAYNA                          WHAYNA
     I              ADA0NA                          WHA0NA
     I              ADAXDT                          WHAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WIAIC3
     I              BEC4NB                          WIC4NB
     I              BEJNCD                          WIJNCD
     I              BEANC7                          WIANC7
     I              BEBKC7                          WIBKC7
     I              BEBRTX                          WIBRTX
     I              BEHMNA                          WIHMNA
     I              BEHONA                          WIHONA
     I              BEHPNA                          WIHPNA
     I              BEHNNA                          WIHNNA
     I              BEDBCD                          WIDBCD
     I              BECKTX                          WICKTX
     I              BEB0C7                          WIB0C7
     I              BEAETX                          WIAETX
     I              BEB1NA                          WIB1NA
     I              BEB3NA                          WIB3NA
     I              BEB4NA                          WIB4NA
     I              BEB2NA                          WIB2NA
     I              BEBHCD                          WIBHCD
     I              BEC8TX                          WIC8TX
     I              BEBCNA                          WIBCNA
     I              BEA0DT                          WIA0DT
     I              BEA5DT                          WIA5DT
     I              BEGNDT                          WIGNDT
     I              BEACDT                          WIACDT
     I              BEAQCD                          WIAQCD
     I              BEB6NA                          WIB6NA
     I              BEBYNA                          WIBYNA
     I              BEBZNA                          WIBZNA
     I              BEGTST                          WIGTST
     I              BEGVST                          WIGVST
     I              BEGUST                          WIGUST
     I              BEQFST                          WIQFST
     I              BECQCD                          WICQCD
     I              BEGJST                          WIGJST
     I              BEGWST                          WIGWST
     I              BEGXST                          WIGXST
     I              BEGYST                          WIGYST
     I              BEAODT                          WIAODT
     I              BEAIVN                          WIAIVN
     I              BECXDT                          WICXDT
     I              BEJZVA                          WIJZVA
     I              BEA1WG                          WIA1WG
     I              BEXIST                          WIXIST
     I              BEXJST                          WIXJST
     I              BEXKST                          WIXKST
     I              BEEIDT                          WIEIDT
     I              BEAFTM                          WIAFTM
     I              BEE8CD                          WIE8CD
     I              BEE9CD                          WIE9CD
     I              BERMNB                          WIRMNB
     I              BETBNB                          WITBNB
     I              BER1NB                          WIR1NB
     I              BEPJST                          WIPJST
     I              BEU0ST                          WIU0ST
     I              BEU1ST                          WIU1ST
     I              BEQ2CD                          WIQ2CD
     I              BEU2ST                          WIU2ST
     I              BEVEST                          WIVEST
     I              BEVFST                          WIVFST
     I              BEVGST                          WIVGST
     I              BERPCD                          WIRPCD
     I              BERNNB                          WIRNNB
     I              BEVDST                          WIVDST
     I              BEATIN                          WIATIN
     I              BEU4ST                          WIU4ST
     I              BEU5ST                          WIU5ST
     I              BERSRN                          WIRSRN
     I              BEMHNA                          WIMHNA
     I              BEMINA                          WIMINA
     I              BEWBST                          WIWBST
     I              BER4CD                          WIR4CD
     I              BEBFCD                          WIBFCD
     I              BEQ4CD                          WIQ4CD
     I              BET3NB                          WIT3NB
     I              BESICD                          WISICD
     I              BECONB                          WICONB
     I              BECEST                          WICEST
     I              BEAWDT                          WIAWDT
     I              BEJPCD                          WIJPCD
     I              BEXUST                          WIXUST
     I              BEZ1ST                          WIZ1ST
     I              BEVRVA                          WIVRVA
     I              BEOBST                          WIOBST
     I              BEBCST                          WIBCST
     I              BEBDST                          WIBDST
     I              BEB7VL                          WIB7VL
     I              BEGASX                          WIGASX
     I              BEGBSX                          WIGBSX
     I              BEGCSX                          WIGCSX
     I              BEGDSX                          WIGDSX
     I              BEFNSX                          WIFNSX
     I              BEFOSX                          WIFOSX
     I              BEFPSX                          WIFPSX
     I              BEFQSX                          WIFQSX
     I              BEFRSX                          WIFRSX
     I              BEFSSX                          WIFSSX
     I              BEFTSX                          WIFTSX
     I              BEFUSX                          WIFUSX
     I              BEFVSX                          WIFVSX
     I              BEFWSX                          WIFWSX
     I              BEFXSX                          WIFXSX
     I              BEFYSX                          WIFYSX
     I              BENODT                          WINODT
     I              BENPDT                          WINPDT
     I              BENQDT                          WINQDT
     I              BENRDT                          WINRDT
     I              BENSDT                          WINSDT
     I              BEBPTM                          WIBPTM
     I              BEBQTM                          WIBQTM
     I              BEBRTM                          WIBRTM
     I              BEBSTM                          WIBSTM
     I              BEBTTM                          WIBTTM
     I              BEH0NX                          WIH0NX
     I              BEH1NX                          WIH1NX
     I              BEH2NX                          WIH2NX
     I              BEH3NX                          WIH3NX
     I              BEH4NX                          WIH4NX
     I              BEC0C7                          WIC0C7
     I              BEUVST                          WIUVST
     I              BEUWST                          WIUWST
     I              BEUXST                          WIUXST
     I              BEAATM                          WIAATM
     I              BEAYNA                          WIAYNA
     I              BEA0NA                          WIA0NA
     I              BEAXDT                          WIAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WEAIC3
     I              BEC4NB                          WEC4NB
     I              BEJNCD                          WEJNCD
     I              BEANC7                          WEANC7
     I              BEBKC7                          WEBKC7
     I              BEBRTX                          WEBRTX
     I              BEHMNA                          WEHMNA
     I              BEHONA                          WEHONA
     I              BEHPNA                          WEHPNA
     I              BEHNNA                          WEHNNA
     I              BEDBCD                          WEDBCD
     I              BECKTX                          WECKTX
     I              BEB0C7                          WEB0C7
     I              BEAETX                          WEAETX
     I              BEB1NA                          WEB1NA
     I              BEB3NA                          WEB3NA
     I              BEB4NA                          WEB4NA
     I              BEB2NA                          WEB2NA
     I              BEBHCD                          WEBHCD
     I              BEC8TX                          WEC8TX
     I              BEBCNA                          WEBCNA
     I              BEA0DT                          WEA0DT
     I              BEA5DT                          WEA5DT
     I              BEGNDT                          WEGNDT
     I              BEACDT                          WEACDT
     I              BEAQCD                          WEAQCD
     I              BEB6NA                          WEB6NA
     I              BEBYNA                          WEBYNA
     I              BEBZNA                          WEBZNA
     I              BEGTST                          WEGTST
     I              BEGVST                          WEGVST
     I              BEGUST                          WEGUST
     I              BEQFST                          WEQFST
     I              BECQCD                          WECQCD
     I              BEGJST                          WEGJST
     I              BEGWST                          WEGWST
     I              BEGXST                          WEGXST
     I              BEGYST                          WEGYST
     I              BEAODT                          WEAODT
     I              BEAIVN                          WEAIVN
     I              BECXDT                          WECXDT
     I              BEJZVA                          WEJZVA
     I              BEA1WG                          WEA1WG
     I              BEXIST                          WEXIST
     I              BEXJST                          WEXJST
     I              BEXKST                          WEXKST
     I              BEEIDT                          WEEIDT
     I              BEAFTM                          WEAFTM
     I              BEE8CD                          WEE8CD
     I              BEE9CD                          WEE9CD
     I              BERMNB                          WERMNB
     I              BETBNB                          WETBNB
     I              BER1NB                          WER1NB
     I              BEPJST                          WEPJST
     I              BEU0ST                          WEU0ST
     I              BEU1ST                          WEU1ST
     I              BEQ2CD                          WEQ2CD
     I              BEU2ST                          WEU2ST
     I              BEVEST                          WEVEST
     I              BEVFST                          WEVFST
     I              BEVGST                          WEVGST
     I              BERPCD                          WERPCD
     I              BERNNB                          WERNNB
     I              BEVDST                          WEVDST
     I              BEATIN                          WEATIN
     I              BEU4ST                          WEU4ST
     I              BEU5ST                          WEU5ST
     I              BERSRN                          WERSRN
     I              BEMHNA                          WEMHNA
     I              BEMINA                          WEMINA
     I              BEWBST                          WEWBST
     I              BER4CD                          WER4CD
     I              BEBFCD                          WEBFCD
     I              BEQ4CD                          WEQ4CD
     I              BET3NB                          WET3NB
     I              BESICD                          WESICD
     I              BECONB                          WECONB
     I              BECEST                          WECEST
     I              BEAWDT                          WEAWDT
     I              BEJPCD                          WEJPCD
     I              BEXUST                          WEXUST
     I              BEZ1ST                          WEZ1ST
     I              BEVRVA                          WEVRVA
     I              BEOBST                          WEOBST
     I              BEBCST                          WEBCST
     I              BEBDST                          WEBDST
     I              BEB7VL                          WEB7VL
     I              BEGASX                          WEGASX
     I              BEGBSX                          WEGBSX
     I              BEGCSX                          WEGCSX
     I              BEGDSX                          WEGDSX
     I              BEFNSX                          WEFNSX
     I              BEFOSX                          WEFOSX
     I              BEFPSX                          WEFPSX
     I              BEFQSX                          WEFQSX
     I              BEFRSX                          WEFRSX
     I              BEFSSX                          WEFSSX
     I              BEFTSX                          WEFTSX
     I              BEFUSX                          WEFUSX
     I              BEFVSX                          WEFVSX
     I              BEFWSX                          WEFWSX
     I              BEFXSX                          WEFXSX
     I              BEFYSX                          WEFYSX
     I              BENODT                          WENODT
     I              BENPDT                          WENPDT
     I              BENQDT                          WENQDT
     I              BENRDT                          WENRDT
     I              BENSDT                          WENSDT
     I              BEBPTM                          WEBPTM
     I              BEBQTM                          WEBQTM
     I              BEBRTM                          WEBRTM
     I              BEBSTM                          WEBSTM
     I              BEBTTM                          WEBTTM
     I              BEH0NX                          WEH0NX
     I              BEH1NX                          WEH1NX
     I              BEH2NX                          WEH2NX
     I              BEH3NX                          WEH3NX
     I              BEH4NX                          WEH4NX
     I              BEC0C7                          WEC0C7
     I              BEUVST                          WEUVST
     I              BEUWST                          WEUWST
     I              BEUXST                          WEUXST
     I              BEAATM                          WEAATM
     I              BEAYNA                          WEAYNA
     I              BEA0NA                          WEA0NA
     I              BEAXDT                          WEAXDT
      *
     IYARDCS      DS                            779
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      * Outward parameters
     IPARC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Order Number
     I                                    P   3   60PAC4NB
      * I :  Order Type - Sales
     I                                        7   8 PAJNCD
      * I :  A/R Customer Number
     I                                    P   9  120PAANC7
      * I :  Ship To Customer
     I                                    P  13  160PABKC7
      * I :  Ship To Name
     I                                       17  46 PABRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PAHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PAHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PAHPNA
      * I :  Ship To City
     I                                      137 156 PAHNNA
      * I :  Ship To State Code
     I                                      157 158 PADBCD
      * I :  Ship To Zip/Postal Code
     I                                      159 169 PACKTX
      * I :  Bill to Customer
     I                                    P 170 1730PAB0C7
      * I :  Bill to Name
     I                                      174 203 PAAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PAB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PAB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PAB4NA
      * I :  Bill to City
     I                                      294 313 PAB2NA
      * I :  Bill to State Code
     I                                      314 315 PABHCD
      * I :  Bill to Zip/Postal Code
     I                                      316 326 PAC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PABCNA
      * I :  Order Date
     I                                    P 342 3450PAA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PAA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PAGNDT
      * I :  Cancel Date
     I                                    P 354 3570PAACDT
      * I :  Terms Code
     I                                      358 359 PAAQCD
      * I :  Special Instructions
     I                                      360 399 PAB6NA
      * I :  Special Instructions 2
     I                                      400 439 PABYNA
      * I :  Carrier Code
     I                                      440 442 PABZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PAGTST
      * I :  Comment Print Inv/Cr.Memo
     I                                      444 444 PAGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PAGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PAQFST
      * I :  Reason Code
     I                                      447 449 PACQCD
      * I :  Order in Use
     I                                      450 450 PAGJST
      * I :  Header Status
     I                                      451 451 PAGWST
      * I :  Header Status Last
     I                                      452 452 PAGXST
      * I :  Order Type Print Status
     I                                      453 453 PAGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PAAODT
      * I :  User Original Entry
     I                                      458 467 PAAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PACXDT
      * I :  Order Value Total
     I                                    P 472 4772PAJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PAA1WG
      * I :  Credit Hold
     I                                      484 484 PAXIST
      * I :  Production Hold
     I                                      485 485 PAXJST
      * I :  New Customer Hold
     I                                      486 486 PAXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PAEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PAAFTM
      * I :  Accounts Receiv. Ent 1
     I                                      494 497 PAE8CD
      * I :  Accounts Receiv. Ent 2
     I                                      498 509 PAE9CD
      * I :  Load ID
     I                                    P 510 5130PARMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PATBNB
      * I :  Rated Freight
     I                                    P 517 5222PAR1NB
      * I :  LTL Flag
     I                                      523 523 PAPJST
      * I :  Price Audit
     I                                      524 524 PAU0ST
      * I :  Price Status
     I                                      525 525 PAU1ST
      * I :  Shipping Method
     I                                      526 527 PAQ2CD
      * I :  Export Status
     I                                      528 528 PAU2ST
      * I :  Palletize
     I                                      529 529 PAVEST
      * I :  Shrink Wrap
     I                                      530 530 PAVFST
      * I :  Slip Sheet
     I                                      531 531 PAVGST
      * I :  Age Code
     I                                      532 532 PARPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PARNNB
      * I :  Load Type
     I                                      536 536 PAVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PAATIN
      * I :  Load Plan Order
     I                                      541 541 PAU4ST
      * I :  Print Pick Slip
     I                                      542 542 PAU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PARSRN
      * I :  Special Comment 1
     I                                      547 576 PAMHNA
      * I :  Special Comment 2
     I                                      577 606 PAMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PAWBST
      * I :  Sales Route Code
     I                                      608 610 PAR4CD
      * I :  Manager Level Code
     I                                      611 612 PABFCD
      * I :  VP Level Code
     I                                      613 615 PAQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PAT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PASICD
      * I :  Invoice Number
     I                                    P 623 6260PACONB
      * I :  Invoice Suffix
     I                                      627 628 PACEST
      * I :  Invoice Date
     I                                    P 629 6320PAAWDT
      * I :  Event Code
     I                                      633 634 PAJPCD
      * I :  Trans Contol AS400_Plant
     I                                      635 635 PAXUST
      * I :  Modified Flag
     I                                      636 636 PAZ1ST
      * I :  A/R order Value Total
     I                                    P 637 6422PAVRVA
      * I :  Billing Activity Type
     I                                      643 643 PAOBST
      * I :  Block Order Flag
     I                                      644 644 PABCST
      * I :  Order Certification Flag
     I                                      645 645 PABDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PAB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PAGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PAGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PAGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PAGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PAFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PAFOSX
      * I :  Order Emailed
     I                                      658 658 PAFPSX
      * I :  Export Docs Go w/Driver
     I                                      659 659 PAFQSX
      * I :  Shipping Temp Code C/F
     I                                      660 660 PAFRSX
      * I :  Broker Order Status
     I                                      661 661 PAFSSX
      * I :  Air Freight Order
     I                                      662 662 PAFTSX
      * I :  Order Requires Review
     I                                      663 664 PAFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PAFVSX
      * I :  Export USDA Approved
     I                                      667 668 PAFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PAFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PAFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PANODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PANPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PANQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PANRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PANSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PABPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PABQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PABRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PABSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PABTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PAH0NX
      * I :  Act Non-Ref Frt Amount
     I                                    P 721 7262PAH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PAH2NX
      * I :  OH Total Non-Ref Frt Amt
     I                                    P 733 7382PAH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PAH4NX
      * I :  Claim Number
     I                                    P 745 7480PAC0C7
      * I :  EDI Status 1
     I                                      749 749 PAUVST
      * I :  EDI Status 2
     I                                      750 750 PAUWST
      * I :  EDI Status 3
     I                                      751 751 PAUXST
      * I :  Job Time
     I                                    P 752 7550PAAATM
      * I :  User Id
     I                                      756 765 PAAYNA
      * I :  Job Name
     I                                      766 775 PAA0NA
      * I :  Job Date
     I                                    P 776 7790PAAXDT
      *
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WGAIC3
     I              OMC4NB                          WGC4NB
     I              OMDPNB                          WGDPNB
     I              OMUENB                          WGUENB
     I              OMHGCD                          WGHGCD
     I              OMAJCD                          WGAJCD
     I              OMBKC7                          WGBKC7
     I              OMCFC7                          WGCFC7
     I              OMGMST                          WGGMST
     I              OMGNST                          WGGNST
     I              OMMAVA                          WGMAVA
     I              OMKDVA                          WGKDVA
     I              OML8VA                          WGL8VA
     I              OML9VA                          WGL9VA
     I              OMGTST                          WGGTST
     I              OMGVST                          WGGVST
     I              OMGUST                          WGGUST
     I              OMQFST                          WGQFST
     I              OMAYVA                          WGAYVA
     I              OMEXDT                          WGEXDT
     I              OMLQCD                          WGLQCD
     I              OMRDCD                          WGRDCD
     I              OMQ7CD                          WGQ7CD
     I              OMBZPR                          WGBZPR
     I              OML6NB                          WGL6NB
     I              OMU1ST                          WGU1ST
     I              OMGIDT                          WGGIDT
     I              OMCRCD                          WGCRCD
     I              OMAGCD                          WGAGCD
     I              OMRZST                          WGRZST
     I              OMR0ST                          WGR0ST
     I              OMR1ST                          WGR1ST
     I              OMG7NA                          WGG7NA
     I              OMG8NA                          WGG8NA
     I              OMRPCD                          WGRPCD
     I              OMVEST                          WGVEST
     I              OMVGST                          WGVGST
     I              OMAVST                          WGAVST
     I              OMU0ST                          WGU0ST
     I              OMRFCD                          WGRFCD
     I              OMFZST                          WGFZST
     I              OMR1NB                          WGR1NB
     I              OMAVQT                          WGAVQT
     I              OMD0WG                          WGD0WG
     I              OMCCQT                          WGCCQT
     I              OMAUWG                          WGAUWG
     I              OMCBQT                          WGCBQT
     I              OMATWG                          WGATWG
     I              OMAQCS                          WGAQCS
     I              OMAGCS                          WGAGCS
     I              OMAKPR                          WGAKPR
     I              OMALPR                          WGALPR
     I              OMAUPR                          WGAUPR
     I              OMAVWG                          WGAVWG
     I              OMA4WG                          WGA4WG
     I              OMA5DT                          WGA5DT
     I              OMAODT                          WGAODT
     I              OMGNDT                          WGGNDT
     I              OMAMST                          WGAMST
     I              OMANST                          WGANST
     I              OMVAST                          WGVAST
     I              OMRGNB                          WGRGNB
     I              OMRHNB                          WGRHNB
     I              OMRINB                          WGRINB
     I              OMRBCD                          WGRBCD
     I              OMHICD                          WGHICD
     I              OMRNCD                          WGRNCD
     I              OMROCD                          WGROCD
     I              OMCXDT                          WGCXDT
     I              OMAJVN                          WGAJVN
     I              OMKXCD                          WGKXCD
     I              OMJPCD                          WGJPCD
     I              OMCQCD                          WGCQCD
     I              OMR4CD                          WGR4CD
     I              OMZ1ST                          WGZ1ST
     I              OMZ3ST                          WGZ3ST
     I              OMZ4ST                          WGZ4ST
     I              OMDUPR                          WGDUPR
     I              OMB6VL                          WGB6VL
     I              OMA1AA                          WGA1AA
     I              OMFZSX                          WGFZSX
     I              OMF0SX                          WGF0SX
     I              OMF1SX                          WGF1SX
     I              OMF2SX                          WGF2SX
     I              OMF3SX                          WGF3SX
     I              OMF4SX                          WGF4SX
     I              OMF5SX                          WGF5SX
     I              OMF6SX                          WGF6SX
     I              OMF7SX                          WGF7SX
     I              OMNTDT                          WGNTDT
     I              OMNUDT                          WGNUDT
     I              OMNVDT                          WGNVDT
     I              OMNWDT                          WGNWDT
     I              OMNXDT                          WGNXDT
     I              OMBUTM                          WGBUTM
     I              OMBVTM                          WGBVTM
     I              OMBWTM                          WGBWTM
     I              OMBXTM                          WGBXTM
     I              OMBYTM                          WGBYTM
     I              OMH5NX                          WGH5NX
     I              OMH6NX                          WGH6NX
     I              OMH7NX                          WGH7NX
     I              OMH8NX                          WGH8NX
     I              OMH9NX                          WGH9NX
     I              OMDVPR                          WGDVPR
     I              OMDWPR                          WGDWPR
     I              OMDXPR                          WGDXPR
     I              OMDYPR                          WGDYPR
     I              OMDZPR                          WGDZPR
     I              OMGSPR                          WGGSPR
     I              OMGTPR                          WGGTPR
     I              OMGUPR                          WGGUPR
     I              OMHOST                          WGHOST
     I              OMHPST                          WGHPST
     I              OMIOST                          WGIOST
     I              OMPEWG                          WGPEWG
     I              OMRINY                          WGRINY
     I              OMTIDT                          WGTIDT
     I              OMTJDT                          WGTJDT
     I              OMH2ST                          WGH2ST
     I              OMH0ST                          WGH0ST
     I              OMH1ST                          WGH1ST
     I              OMTKDT                          WGTKDT
     I              OMTLDT                          WGTLDT
     I              OMTMDT                          WGTMDT
     I              OMUVST                          WGUVST
     I              OMUWST                          WGUWST
     I              OMUXST                          WGUXST
     I              OMAATM                          WGAATM
     I              OMAYNA                          WGAYNA
     I              OMA0NA                          WGA0NA
     I              OMAXDT                          WGAXDT
      *
     IYBRDCS      DS                            525
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Load Header
      * I :  Load ID
     I                                    P   1   40P1RMNB
      * I :  Company Number
     I                                    P   5   60P1AIC3
      * I :  Total Load Miles
     I                                    P   7  100P1TLMI
      * I :  Actual Ship Date
     I                                    P  11  140P1F9DT
      * I :  Override Total Load Miles
     I                                    P  15  180P1K2DT
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1RMNB    PARM           WP0001  70       Load ID
     C           P1AIC3    PARM           WP0002  30       Company Number
     C           P1TLMI    PARM           WP0003  70       Total Load Mile
     C           P1F9DT    PARM           WP0004  70       Actual Ship Dat
     C           P1K2DT    PARM           WP0005  70       Override Total
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Clc/Crt FuelSrchg Itm XF
      * Rtv Fuel Srchg Exp    XF - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'PKUOXFR'              90  Rtv Fuel Srchg
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0001  30       Company Number
     C                     PARM 'FS'      WQ0002  5        Expense Code
     C           YL0001    PARM *BLANK    WQ0003 25        Expense Descrip
     C           YL0002    PARM *BLANK    WQ0004  1        Expense type
     C           YL0003    PARM *BLANK    WQ0005  2        Unit of Measure
     C           YL0004    PARM *ZERO     WQ0006  72       Fuel Surcharge
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKUOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * ** Use override load miles, if enterd             E00207 8/12/08
      * CASE: PAR.Override Total Load Miles is Entered
     C           P1K2DT    IFNE *ZERO                      *IF
     C                     Z-ADDP1K2DT    YL0005           Total Load Mile
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP1TLMI    YL0005           Total Load Mile
     C                     END                             *FI
     C           YL0005    MULT YL0004    YL0006           Fuel Surcharge
      * CASE: LCL.Fuel Surcharge for Load NE WRK.ZERO
     C           YL0006    IFNE WUW0NB                     *IF
      * RTV Wgt Shipped Tot    RT - PD Order Header      TRG  * 
     C                     EXSR SARVGN
      * CASE: LCL.USR Weight   9.1  3 NE WRK.ZERO
     C           YL0007    IFNE WUW0NB                     *IF
     C           YL0006    DIV  YL0007    YL0008    H      Fuel Surcharge
      * Rtv Ords for FuelSrchg RT - PD Order Header      TRG  * 
     C                     EXSR SCRVGN
      * If any fuel surcharge is unapplied, add it to the last order.
      * CASE: LCL.Fuel Surcharge for Load NE WRK.ZERO
     C           YL0006    IFNE WUW0NB                     *IF
      * Rtv/Add Fuel Surcharg RT - PD Order Detail  * 
     C                     EXSR SJRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Wgt Shipped Tot    RT - PD Order Header      TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
      * Declare restrictor key work fields
     C           *LIKE     DEFN WARMNB    WQSA02           Load ID
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA02           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WQSA02           Load ID
      * Establish starting position
     C           KRSSA     SETLL@BFCPD9                    *
     C           KRSSA     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADD*ZERO     WUH8WG           USR Weight   9.
      * RTV Weight Shipped Tot RT - PD Order Detail  * 
     C                     EXSR SBRVGN
     C                     Z-ADD*ZERO     WUH9WG           USR Weight   9.
      * CASE: WRK.USR Weight   9.1  3 EQ WRK.USR Weight   9.1  4
     C           WUH8WG    IFEQ WUH9WG                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  WUH8WG    YL0007           USR Weight   9.
     C                     END                             *FI
     C           KRSSA     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Weight Shipped Tot RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUH8WG           USR Weight   9.
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSB01           Company Number
     C           *LIKE     DEFN WBC4NB    WQSB02           Order Number
      * Define keylist
     C           KPSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Order Number
     C                     KFLD           WBDPNB           Order Sequence
     C                     KFLD           WBUENB           Order Secondary
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Order Number
      * Setup key
     C                     Z-ADDWAAIC3    WQSB01           Company Number
     C                     Z-ADDWAC4NB    WQSB02           Order Number
     C                     Z-ADD1         WBDPNB           Order Sequence
     C                     Z-ADD1         WBUENB           Order Secondary
      * Establish starting position
     C           KPSSB     SETLL@BGWKL1                    *
     C           KRSSB     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WBATWG    WUH8WG           USR Weight   9.
     C           KRSSB     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Ords for FuelSrchg RT - PD Order Header      TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/12/04 SLM PKTR01 Multi-Company - Function was changed
      *                                     to remove Company RST or Pos
     C                     Z-ADDYL0006    YL0011           Fuel Surcharge
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCRMNB    WQSC02           Load ID
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC02           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WQSC02           Load ID
      * Establish starting position
     C           KRSSC     SETLL@BFCPEQ                    *
     C           KRSSC     READE@BFCPEQ                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADD*ZERO     WUATWG           Weight Shipped
      * RTV Actual Wgt Shipped RT - PD Order Detail  * 
     C                     EXSR SDRVGN
     C           YL0008    MULT WUATWG    YL0012    H      Extended Amount
      * Write Line item for Fuel Surcharge.
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Extended Amount is not equal to zeros
      *   |- c2    : LCL.Extended Amount LE LCL.Fuel Surcharge for Load
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0012    IFNE 0                          *IF
     C           YL0012    IFLE YL0011                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: LCL.Extended Amount GE LCL.Fuel Surcharge for Load
     C           YL0012    IFGE YL0011                     *IF
     C                     Z-ADDYL0011    YL0012           Extended Amount
     C                     END                             *FI
     C           WCJZVA    ADD  YL0012    YL0013           Order Value Tot
      * CHG Order Value & Wght CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0001           Company Number
     C                     Z-ADDWCC4NB    WL0002           Order Number
     C                     Z-ADDYL0013    WL0003           Order Value Tot
     C                     Z-ADDWCA1WG    WL0004           Order Weight To
     C                     EXSR SECHRC
     C                     Z-ADD*ZERO     WUDPNB           Order Sequence
      * RTV Next Sequence/Whse RT - PD Order Detail  * 
     C                     EXSR SFRVGN
     C                     ADD  1         WUDPNB           Order Sequence
     C                     Z-ADD99400     YL0014           Item Code
      * Rtv Base f/Misc Item   RT - Company/Item  * 
     C                     EXSR SGRVGN
      * CRT PD Order Detail    CR - Order Detail  * 
     C                     EXSR SHCRRC
      * Reduce the fuel surcharge for the load with what was applied to t
     C                     SUB  YL0012    YL0011           Fuel Surcharge
      * Save the last order dtl created in case a $surcharge is left unap
     C                     Z-ADDWCC4NB    YL0009           Order Number
     C                     Z-ADDWUDPNB    YL0010           Order Sequence
     C                     END                             *FI
     C           KRSSC     READE@BFCPEQ                  90*
     C                     ENDDO
      * USER: Exit processing
     C                     Z-ADDYL0011    YL0006           Fuel Surcharge
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Actual Wgt Shipped RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSD01           Company Number
     C           *LIKE     DEFN WDC4NB    WQSD02           Order Number
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Order Number
      * Setup key
     C                     Z-ADDWCAIC3    WQSD01           Company Number
     C                     Z-ADDWCC4NB    WQSD02           Order Number
      * Establish starting position
     C           KRSSD     SETLL@BGWKAE                    *
     C           KRSSD     READE@BGWKAE                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WDATWG    WUATWG           Weight Shipped
     C           KRSSD     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECHRC    BEGSR
      *================================================================
      * CHG Order Value & Wght CH - Order Header TRG  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0002  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0003  70       Ship To Custome
     C                     MOVEL*BLANK    WN0004 30        Ship To Name
     C                     MOVEL*BLANK    WN0005 30        Ship To Address
     C                     MOVEL*BLANK    WN0006 30        Ship To Address
     C                     MOVEL*BLANK    WN0007 30        Ship To Address
     C                     MOVEL*BLANK    WN0008 20        Ship To City
     C                     MOVEL*BLANK    WN0009  2        Ship To State C
     C                     MOVEL*BLANK    WN0010 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0011  70       Bill to Custome
     C                     MOVEL*BLANK    WN0012 30        Bill to Name
     C                     MOVEL*BLANK    WN0013 30        Bill to Address
     C                     MOVEL*BLANK    WN0014 30        Bill to Address
     C                     MOVEL*BLANK    WN0015 30        Bill to Address
     C                     MOVEL*BLANK    WN0016 20        Bill to City
     C                     MOVEL*BLANK    WN0017  2        Bill to State C
     C                     MOVEL*BLANK    WN0018 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0019 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0020  70       Order Date
     C                     Z-ADD*ZERO     WN0021  70       Requested Ship
     C                     Z-ADD*ZERO     WN0022  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0023  70       Cancel Date
     C                     MOVEL*BLANK    WN0024  2        Terms Code
     C                     MOVEL*BLANK    WN0025 40        Special Instruc
     C                     MOVEL*BLANK    WN0026 40        Special Instruc
     C                     MOVEL*BLANK    WN0027  3        Carrier Code
     C                     MOVEL*BLANK    WN0028  1        Comment Print A
     C                     MOVEL*BLANK    WN0029  1        Comment Print I
     C                     MOVEL*BLANK    WN0030  1        Comment Print P
     C                     MOVEL*BLANK    WN0031  1        Comment Print S
     C                     MOVEL*BLANK    WN0032  3        Reason Code
     C                     MOVEL*BLANK    WN0033  1        Order in Use
     C                     MOVEL*BLANK    WN0034  1        Header Status
     C                     MOVEL*BLANK    WN0035  1        Header Status L
     C                     MOVEL*BLANK    WN0036  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0037  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0038 10        User Original E
     C                     Z-ADD*ZERO     WN0039  70       Date of Origina
     C                     MOVEL*BLANK    WN0040  1        Credit Hold
     C                     MOVEL*BLANK    WN0041  1        Production Hold
     C                     MOVEL*BLANK    WN0042  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0043  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0044  40       Requested Deliv
     C                     MOVEL*BLANK    WN0045  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0046 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0047  70       Load ID
     C                     Z-ADD*ZERO     WN0048  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0049 112       Rated Freight
     C                     MOVEL*BLANK    WN0050  1        LTL Flag
     C                     MOVEL*BLANK    WN0051  1        Price Audit
     C                     MOVEL*BLANK    WN0052  1        Price Status
     C                     MOVEL*BLANK    WN0053  2        Shipping Method
     C                     MOVEL*BLANK    WN0054  1        Export Status
     C                     MOVEL*BLANK    WN0055  1        Palletize
     C                     MOVEL*BLANK    WN0056  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0057  1        Slip Sheet
     C                     MOVEL*BLANK    WN0058  1        Age Code
     C                     Z-ADD*ZERO     WN0059  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0060  1        Load Type
     C                     Z-ADD*ZERO     WN0061  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0062  1        Load Plan Order
     C                     MOVEL*BLANK    WN0063  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0064  70       Resell Referenc
     C                     MOVEL*BLANK    WN0065 30        Special Comment
     C                     MOVEL*BLANK    WN0066 30        Special Comment
     C                     MOVEL*BLANK    WN0067  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0068  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0069  2        Manager Level C
     C                     MOVEL*BLANK    WN0070  3        VP Level Code
     C                     Z-ADD*ZERO     WN0071  70       Attach to Order
     C                     MOVEL*BLANK    WN0072  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0073  70       Invoice Number
     C                     MOVEL*BLANK    WN0074  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0075  70       Invoice Date
     C                     MOVEL*BLANK    WN0076  2        Event Code
     C                     MOVEL*BLANK    WN0077  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0078  1        Modified Flag
     C                     Z-ADD*ZERO     WN0079 112       A/R order Value
     C                     MOVEL*BLANK    WN0080  1        Billing Activit
     C                     MOVEL*BLANK    WN0081  1        Block Order Fla
     C                     MOVEL*BLANK    WN0082  1        Order Certifica
     C                     Z-ADD*ZERO     WN0083 112       Invoice Order V
     C                     MOVEL*BLANK    WN0084  1        Process Sts for
     C                     MOVEL*BLANK    WN0085  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0086  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0087  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0088  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0089  1        Email Cust On O
     C                     MOVEL*BLANK    WN0090  1        Order Emailed
     C                     MOVEL*BLANK    WN0091  1        Export Docs Go
     C                     MOVEL*BLANK    WN0092  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0093  1        Broker Order St
     C                     MOVEL*BLANK    WN0094  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0095  2        Order Requires
     C                     MOVEL*BLANK    WN0096  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0097  2        Export USDA App
     C                     MOVEL*BLANK    WN0098  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0099  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0100  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0101  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0102  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0103  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0104  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0105  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0106  60       Time of Origina
     C                     Z-ADD*ZERO     WN0107  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0108  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0109  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0110 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0111 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0112 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0113 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0114 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0115  70       Claim Number
     C                     MOVEL*BLANK    WN0116  1        EDI Status 1
     C                     MOVEL*BLANK    WN0117  1        EDI Status 2
     C                     MOVEL*BLANK    WN0118  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0119  60       Job Time
     C                     MOVEL*BLANK    WN0120 10        User Id
     C                     MOVEL*BLANK    WN0121 10        Job Name
     C                     Z-ADD*ZERO     WN0122  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWL0001    WEAIC3           Company Number
     C                     Z-ADDWL0002    WEC4NB           Order Number
      *
     C           KLCHSE    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C           KLCHSE    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YARDCS
      * Move non-key fields to @BECPFJ
     C                     Z-ADDWL0003    WEJZVA           Order Value Tot
     C                     Z-ADDWL0004    WEA1WG           Order Weight To
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##PGM     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - Order Header TRG  * 
     C                     CLEARPARC
     C                     Z-ADDWEAIC3    PAAIC3           Company Number
     C                     Z-ADDWEC4NB    PAC4NB           Order Number
     C                     MOVELWEJNCD    PAJNCD    P      Order Type - Sa
     C                     Z-ADDWEANC7    PAANC7           A/R Customer Nu
     C                     Z-ADDWEBKC7    PABKC7           Ship To Custome
     C                     MOVELWEBRTX    PABRTX    P      Ship To Name
     C                     MOVELWEHMNA    PAHMNA    P      Ship To Address
     C                     MOVELWEHONA    PAHONA    P      Ship To Address
     C                     MOVELWEHPNA    PAHPNA    P      Ship To Address
     C                     MOVELWEHNNA    PAHNNA    P      Ship To City
     C                     MOVELWEDBCD    PADBCD    P      Ship To State C
     C                     MOVELWECKTX    PACKTX    P      Ship To Zip/Pos
     C                     Z-ADDWEB0C7    PAB0C7           Bill to Custome
     C                     MOVELWEAETX    PAAETX    P      Bill to Name
     C                     MOVELWEB1NA    PAB1NA    P      Bill to Address
     C                     MOVELWEB3NA    PAB3NA    P      Bill to Address
     C                     MOVELWEB4NA    PAB4NA    P      Bill to Address
     C                     MOVELWEB2NA    PAB2NA    P      Bill to City
     C                     MOVELWEBHCD    PABHCD    P      Bill to State C
     C                     MOVELWEC8TX    PAC8TX    P      Bill to Zip/Pos
     C                     MOVELWEBCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDWEA0DT    PAA0DT           Order Date
     C                     Z-ADDWEA5DT    PAA5DT           Requested Ship
     C                     Z-ADDWEGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDWEACDT    PAACDT           Cancel Date
     C                     MOVELWEAQCD    PAAQCD    P      Terms Code
     C                     MOVELWEB6NA    PAB6NA    P      Special Instruc
     C                     MOVELWEBYNA    PABYNA    P      Special Instruc
     C                     MOVELWEBZNA    PABZNA    P      Carrier Code
     C                     MOVELWEGTST    PAGTST    P      Comment Print A
     C                     MOVELWEGVST    PAGVST    P      Comment Print I
     C                     MOVELWEGUST    PAGUST    P      Comment Print P
     C                     MOVELWEQFST    PAQFST    P      Comment Print S
     C                     MOVELWECQCD    PACQCD    P      Reason Code
     C                     MOVELWEGJST    PAGJST    P      Order in Use
     C                     MOVELWEGWST    PAGWST    P      Header Status
     C                     MOVELWEGXST    PAGXST    P      Header Status L
     C                     MOVELWEGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDWEAODT    PAAODT           Scheduled Ship
     C                     MOVELWEAIVN    PAAIVN    P      User Original E
     C                     Z-ADDWECXDT    PACXDT           Date of Origina
     C                     Z-ADDWEJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDWEA1WG    PAA1WG           Order Weight To
     C                     MOVELWEXIST    PAXIST    P      Credit Hold
     C                     MOVELWEXJST    PAXJST    P      Production Hold
     C                     MOVELWEXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDWEEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDWEAFTM    PAAFTM           Requested Deliv
     C                     MOVELWEE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELWEE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDWERMNB    PARMNB           Load ID
     C                     Z-ADDWETBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDWER1NB    PAR1NB           Rated Freight
     C                     MOVELWEPJST    PAPJST    P      LTL Flag
     C                     MOVELWEU0ST    PAU0ST    P      Price Audit
     C                     MOVELWEU1ST    PAU1ST    P      Price Status
     C                     MOVELWEQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELWEU2ST    PAU2ST    P      Export Status
     C                     MOVELWEVEST    PAVEST    P      Palletize
     C                     MOVELWEVFST    PAVFST    P      Shrink Wrap
     C                     MOVELWEVGST    PAVGST    P      Slip Sheet
     C                     MOVELWERPCD    PARPCD    P      Age Code
     C                     Z-ADDWERNNB    PARNNB           Reefer Temperat
     C                     MOVELWEVDST    PAVDST    P      Load Type
     C                     Z-ADDWEATIN    PAATIN           Attach to Invoi
     C                     MOVELWEU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELWEU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDWERSRN    PARSRN           Resell Referenc
     C                     MOVELWEMHNA    PAMHNA    P      Special Comment
     C                     MOVELWEMINA    PAMINA    P      Special Comment
     C                     MOVELWEWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELWER4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELWEBFCD    PABFCD    P      Manager Level C
     C                     MOVELWEQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDWET3NB    PAT3NB           Attach to Order
     C                     MOVELWESICD    PASICD    P      Reason for Pric
     C                     Z-ADDWECONB    PACONB           Invoice Number
     C                     MOVELWECEST    PACEST    P      Invoice Suffix
     C                     Z-ADDWEAWDT    PAAWDT           Invoice Date
     C                     MOVELWEJPCD    PAJPCD    P      Event Code
     C                     MOVELWEXUST    PAXUST    P      Trans Contol AS
     C                     MOVELWEZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDWEVRVA    PAVRVA           A/R order Value
     C                     MOVELWEOBST    PAOBST    P      Billing Activit
     C                     MOVELWEBCST    PABCST    P      Block Order Fla
     C                     MOVELWEBDST    PABDST    P      Order Certifica
     C                     Z-ADDWEB7VL    PAB7VL           Invoice Order V
     C                     MOVELWEGASX    PAGASX    P      Process Sts for
     C                     MOVELWEGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELWEGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELWEGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELWEFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELWEFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELWEFPSX    PAFPSX    P      Order Emailed
     C                     MOVELWEFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELWEFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELWEFSSX    PAFSSX    P      Broker Order St
     C                     MOVELWEFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELWEFUSX    PAFUSX    P      Order Requires
     C                     MOVELWEFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELWEFWSX    PAFWSX    P      Export USDA App
     C                     MOVELWEFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELWEFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDWENODT    PANODT           OH Appt Confirm
     C                     Z-ADDWENPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDWENQDT    PANQDT           Load Actual Shi
     C                     Z-ADDWENRDT    PANRDT           Load BOL Comple
     C                     Z-ADDWENSDT    PANSDT           Load Truck Depa
     C                     Z-ADDWEBPTM    PABPTM           Maximum Gross W
     C                     Z-ADDWEBQTM    PABQTM           Time of Origina
     C                     Z-ADDWEBRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDWEBSTM    PABSTM           Load BOL Comple
     C                     Z-ADDWEBTTM    PABTTM           Load Truck Depa
     C                     Z-ADDWEH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDWEH1NX    PAH1NX           Act Non-Ref Frt
     C                     Z-ADDWEH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDWEH3NX    PAH3NX           OH Total Non-Re
     C                     Z-ADDWEH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDWEC0C7    PAC0C7           Claim Number
     C                     MOVELWEUVST    PAUVST    P      EDI Status 1
     C                     MOVELWEUWST    PAUWST    P      EDI Status 2
     C                     MOVELWEUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDWEAATM    PAAATM           Job Time
     C                     MOVELWEAYNA    PAAYNA    P      User Id
     C                     MOVELWEA0NA    PAA0NA    P      Job Name
     C                     Z-ADDWEAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Next Sequence/Whse RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSF01           Company Number
     C           *LIKE     DEFN WBC4NB    WQSF02           Order Number
      * Define keylist
     C           KPSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Order Number
     C                     KFLD           WBDPNB           Order Sequence
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Order Number
      * Setup key
     C                     Z-ADDWCAIC3    WQSF01           Company Number
     C                     Z-ADDWCC4NB    WQSF02           Order Number
     C                     Z-ADDWUDPNB    WBDPNB           Order Sequence
      * Establish starting position
     C           KPSSF     SETLL@BGWKL1                    *
     C           KRSSF     READE@BGWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
     C                     ADD  1         WUDPNB           Order Sequence
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBDPNB    WUDPNB           Order Sequence
     C                     MOVELWBAJCD    WUAJCD           Warehouse Code
     C           KRSSF     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Base f/Misc Item   RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFHGCD           Item Code
      * Setup key
     C                     Z-ADDWCAIC3    WFAIC3           Company Number
     C                     Z-ADDYL0014    WFHGCD           Item Code
      * Establish starting position
     C           KRSSG     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAVNA           Description Lin
     C                     MOVEL*BLANK    WUAWNA           Description Lin
     C                     MOVEL*BLANK    WUADCD           UOM Primary
     C                     Z-ADD*ZERO     WUAWPC           Conversion Fact
     C                     MOVEL*BLANK    WULXST           Operation Facto
     C                     MOVEL*BLANK    WUAECD           UOM Second
     C                     Z-ADD*ZERO     WUAXPC           Conversion Fact
     C                     MOVEL*BLANK    WULYST           Operation Facto
     C                     MOVEL*BLANK    WUAFCD           UOM Third
     C                     MOVEL*BLANK    WUAICD           UOM Pricing
     C                     Z-ADD*ZERO     WUAIWG           Unit Weight
     C                     MOVEL*BLANK    WUFZST           Production Date
     C                     MOVEL*BLANK    WUAVST           Catch Weight St
     C                     Z-ADD*ZERO     WURINB           Item Structure
     C                     Z-ADD*ZERO     WURHNB           Item Structure
     C                     Z-ADD*ZERO     WURGNB           Item Structure
     C                     MOVEL*BLANK    WUQ1CD           Default Warehou
     C                     MOVEL*BLANK    WUQ8CD           Price Method De
     C                     Z-ADD*ZERO     WUCHTM           Fresh Chilling
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFAVNA    WUAVNA           Description Lin
     C                     MOVELWFAWNA    WUAWNA           Description Lin
     C                     MOVELWFADCD    WUADCD           UOM Primary
     C                     Z-ADDWFAWPC    WUAWPC           Conversion Fact
     C                     MOVELWFLXST    WULXST           Operation Facto
     C                     MOVELWFAECD    WUAECD           UOM Second
     C                     Z-ADDWFAXPC    WUAXPC           Conversion Fact
     C                     MOVELWFLYST    WULYST           Operation Facto
     C                     MOVELWFAFCD    WUAFCD           UOM Third
     C                     MOVELWFAICD    WUAICD           UOM Pricing
     C                     Z-ADDWFAIWG    WUAIWG           Unit Weight
     C                     MOVELWFFZST    WUFZST           Production Date
     C                     MOVELWFAVST    WUAVST           Catch Weight St
     C                     Z-ADDWFRINB    WURINB           Item Structure
     C                     Z-ADDWFRHNB    WURHNB           Item Structure
     C                     Z-ADDWFRGNB    WURGNB           Item Structure
     C                     MOVELWFQ1CD    WUQ1CD           Default Warehou
     C                     MOVELWFQ8CD    WUQ8CD           Price Method De
     C                     Z-ADDWFCHTM    WUCHTM           Fresh Chilling
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCRRC    BEGSR
      *================================================================
      * CRT PD Order Detail    CR - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0123  60       Job Time
     C                     MOVEL*BLANK    WN0124 10        User Id
     C                     MOVEL*BLANK    WN0125 10        Job Name
     C                     Z-ADD*ZERO     WN0126  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BGWKL0
     C                     Z-ADDWCAIC3    WGAIC3           Company Number
     C                     Z-ADDWCC4NB    WGC4NB           Order Number
     C                     Z-ADDWUDPNB    WGDPNB           Order Sequence
     C                     Z-ADD1         WGUENB           Order Secondary
     C                     Z-ADDYL0014    WGHGCD           Item Code
     C                     MOVELWUAJCD    WGAJCD           Warehouse Code
     C                     Z-ADDWCBKC7    WGBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WGCFC7           Order Group Cod
     C                     MOVEL'R'       WGGMST           Detail Line Sta
     C                     MOVEL*BLANK    WGGNST           Detail Line Sta
     C                     Z-ADD*ZERO     WGMAVA           Billing Detail
     C                     Z-ADDYL0012    WGKDVA           Billing Detail
     C                     Z-ADD*ZERO     WGL8VA           Billing Detail
     C                     Z-ADD*ZERO     WGL9VA           Quantity to Sub
     C                     MOVEL*BLANK    WGGTST           Comment Print A
     C                     MOVEL*BLANK    WGGVST           Comment Print I
     C                     MOVEL*BLANK    WGGUST           Comment Print P
     C                     MOVEL*BLANK    WGQFST           Comment Print S
     C                     Z-ADDYL0012    WGAYVA           Extended Amount
     C                     Z-ADD*ZERO     WGEXDT           Market Pricing
     C                     MOVELWULQCD    WGLQCD           Commodity Marke
     C                     MOVEL*BLANK    WGRDCD           Date Method Cod
     C                     MOVELWUQ8CD    WGQ7CD           Price Method Co
     C                     Z-ADDYL0012    WGBZPR           Price Overage O
     C                     Z-ADD*ZERO     WGL6NB           Contract Number
     C                     MOVEL'P'       WGU1ST           Price Status
     C                     Z-ADD*ZERO     WGGIDT           Pricing Date Us
     C                     MOVELWUADCD    WGCRCD           U/M - Base Pric
     C                     MOVELWUADCD    WGAGCD           U/M - Ordered
     C                     MOVEL*BLANK    WGRZST           Work Confirm St
     C                     MOVEL*BLANK    WGR0ST           Work Over/Short
     C                     MOVEL*BLANK    WGR1ST           OD Production P
     C                     MOVELWUAVNA    WGG7NA           Order Desc. Lin
     C                     MOVEL*BLANK    WGG8NA           Order Desc. Lin
     C                     MOVEL*BLANK    WGRPCD           Age Code
     C                     MOVEL*BLANK    WGVEST           Palletize
     C                     MOVEL*BLANK    WGVGST           Slip Sheet
     C                     MOVEL'N'       WGAVST           Catch Weight St
     C                     MOVEL*BLANK    WGU0ST           Price Audit
     C                     MOVEL*BLANK    WGRFCD           Price Audit Rea
     C                     MOVELWUFZST    WGFZST           Production Date
     C                     Z-ADD*ZERO     WGR1NB           Rated Freight
     C                     Z-ADD1         WGAVQT           Quantity Ordere
     C                     Z-ADD1         WGD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WGCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WGAUWG           Weight Schedule
     C                     Z-ADD1         WGCBQT           Quantity Shippe
     C                     Z-ADD1         WGATWG           Weight Shipped
     C                     Z-ADD*ZERO     WGAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WGAGCS           Unit Cost Per P
     C                     Z-ADDYL0012    WGAKPR           Unit Price
     C                     Z-ADD*ZERO     WGALPR           Unit Price - Cr
     C                     Z-ADDYL0012    WGAUPR           Unit Price Orde
     C                     Z-ADD1         WGAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WGA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WGA5DT           Requested Ship
     C                     Z-ADD*ZERO     WGAODT           Scheduled Ship
     C                     Z-ADDWCGNDT    WGGNDT           Actual Shipped
     C                     MOVEL'N'       WGAMST           Affect Inventor
     C                     MOVEL'N'       WGANST           Affect Sales Do
     C                     MOVEL'N'       WGVAST           Affect Sales Pn
     C                     Z-ADDWURGNB    WGRGNB           Item Structure
     C                     Z-ADDWURHNB    WGRHNB           Item Structure
     C                     Z-ADDWURINB    WGRINB           Item Structure
     C                     MOVEL*BLANK    WGRBCD           Item Level
     C                     MOVEL*BLANK    WGHICD           Quality Level
     C                     MOVEL*BLANK    WGRNCD           Pricing Product
     C                     MOVEL*BLANK    WGROCD           Season Product
     C                     Z-ADD##JDT     WGCXDT           Date of Origina
     C                     MOVEL##USR     WGAJVN           User Profile Na
     C                     MOVEL*BLANK    WGKXCD           Country Code
     C                     MOVELWCJPCD    WGJPCD           Event Code
     C                     MOVEL*BLANK    WGCQCD           Reason Code
     C                     MOVEL*BLANK    WGR4CD           Sales Route Cod
     C                     MOVEL*BLANK    WGZ1ST           Modified Flag
     C                     MOVEL*BLANK    WGZ3ST           Substituted Fla
     C                     MOVEL*BLANK    WGZ4ST           OD Schedule Ove
     C                     Z-ADD*ZERO     WGDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WGB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WGA1AA           Ham Group Numbe
     C                     MOVEL*BLANK    WGFZSX           OD Adj Type Ove
     C                     MOVEL'N'       WGF0SX           Affect Trade Fu
     C                     MOVEL'N'       WGF1SX           Affect Commissi
     C                     MOVEL'N'       WGF2SX           Affect Pricing
     C                     MOVEL*BLANK    WGF3SX           Released by Use
     C                     MOVEL'NE'      WGF4SX           Ord TF Exempt C
     C                     MOVEL*BLANK    WGF5SX           OD Pallet Type
     C                     MOVELWUUAT1    WGF6SX           Production Ware
     C                     MOVEL'NEG'     WGF7SX           OD Price Type
     C                     Z-ADD*ZERO     WGNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WGNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WGNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WGNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WGNXDT           OD Firm Date
     C                     Z-ADD*ZERO     WGBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WGBVTM           Price Code
     C                     Z-ADD*ZERO     WGBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WGBXTM           Substitution Li
     C                     Z-ADD*ZERO     WGBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WGH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WGH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WGH7NX           OD Item Target
     C                     Z-ADD*ZERO     WGH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WGH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WGDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WGDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WGDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WGDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WGDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WGGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WGGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WGGUPR           OD Unused Prc 8
     C                     MOVEL'X'       WGHOST           OD MPR Sent to
     C                     MOVEL*BLANK    WGHPST           OD MPR Prc Read
     C                     MOVEL*BLANK    WGIOST           OD UnUsed Price
     C                     Z-ADD*ZERO     WGPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WGRINY           Item Age Days
     C                     Z-ADD*ZERO     WGTIDT           Production Ovr
     C                     Z-ADD*ZERO     WGTJDT           Production Ovr
     C                     MOVEL*BLANK    WGH2ST           OD Spot Buy
     C                     MOVEL*BLANK    WGH0ST           OD Clm Full Ret
     C                     MOVEL*BLANK    WGH1ST           Order Line Erro
     C                     Z-ADD*ZERO     WGTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WGTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WGTMDT           OD Atch to Ord
     C                     MOVELWCUVST    WGUVST           EDI Status 1
     C                     MOVELWCUWST    WGUWST           EDI Status 2
     C                     MOVELWCUXST    WGUXST           EDI Status 3
      *
      * USER: Processing before Data update
     C                     MOVEL*BLANK    WGRPCD           Age Code
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##PGM     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
      * Rtv First Consumed Itm XF - Item Bill Of Material  * 
     C                     CALL 'POP1XFR'              90  Rtv First Consu
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WGAIC3    WQ0007  30       Company Number
     C                     PARM WGHGCD    WQ0008  70       Item Code
     C           WGNUDT    PARM *ZERO     WQ0009  70       Component Item
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POP1XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Rtv Productin Whs     RT - Warehouse  * 
     C                     EXSR SIRVGN
      * Calc Gross Weight from tares...    copied from Dsp Gross Wgt func
     C                     EXSR UASUBR                     Calc Gross Weig
     C           KLCRSH    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGC4NB           Order Number
     C                     KFLD           WGDPNB           Order Sequence
     C                     KFLD           WGUENB           Order Secondary
      * Check for duplicate primary key
     C           KLCRSH    SETLL@BGWKL0                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1310' W0RTN   7
      * Send message 'Order Detail           EX'
     C                     MOVEL'USR1310' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C                     WRITE@BGWKL0                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Productin Whs     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WHAJCD           Warehouse Code
      * Setup key
     C                     MOVELWGAJCD    WHAJCD           Warehouse Code
      * Establish starting position
     C           KRSSI     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WGF6SX           Production Ware
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHAOCD    WGF6SX           Production Ware
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv/Add Fuel Surcharg RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
     C                     KFLD           WBDPNB           Order Sequence
     C                     KFLD           WBUENB           Order Secondary
      * Setup key
     C                     Z-ADDP1AIC3    WBAIC3           Company Number
     C                     Z-ADDYL0009    WBC4NB           Order Number
     C                     Z-ADDYL0010    WBDPNB           Order Sequence
     C                     Z-ADD1         WBUENB           Order Secondary
      * Establish starting position
     C           KRSSJ     CHAIN@BGWKL1              90    *
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WBAYVA    ADD  YL0006    YL0023           Extended Amount
      * CHG for fuel surcharge CH - PD Order Detail  * 
     C                     EXSR SKCHRC
      * Rtv/Chg Order Value tt RT - PD Order Header      TRG  * 
     C                     EXSR SLRVGN
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCHRC    BEGSR
      *================================================================
      * CHG for fuel surcharge CH - PD Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0127  70       Item Code
     C                     MOVEL*BLANK    WN0128  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0129  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0130  70       Order Group Cod
     C                     MOVEL*BLANK    WN0131  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0132  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0133 112       Billing Detail
     C                     Z-ADD*ZERO     WN0134 112       Billing Detail
     C                     Z-ADD*ZERO     WN0135 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0136  1        Comment Print A
     C                     MOVEL*BLANK    WN0137  1        Comment Print I
     C                     MOVEL*BLANK    WN0138  1        Comment Print P
     C                     MOVEL*BLANK    WN0139  1        Comment Print S
     C                     Z-ADD*ZERO     WN0140  70       Market Pricing
     C                     MOVEL*BLANK    WN0141  3        Commodity Marke
     C                     MOVEL*BLANK    WN0142  3        Date Method Cod
     C                     MOVEL*BLANK    WN0143  3        Price Method Co
     C                     Z-ADD*ZERO     WN0144  70       Contract Number
     C                     MOVEL*BLANK    WN0145  1        Price Status
     C                     Z-ADD*ZERO     WN0146  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0147  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0148  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0149  1        Work Confirm St
     C                     MOVEL*BLANK    WN0150  1        Work Over/Short
     C                     MOVEL*BLANK    WN0151  1        OD Production P
     C                     MOVEL*BLANK    WN0152 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0153 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0154  1        Age Code
     C                     MOVEL*BLANK    WN0155  1        Palletize
     C                     MOVEL*BLANK    WN0156  1        Slip Sheet
     C                     MOVEL*BLANK    WN0157  1        Catch Weight St
     C                     MOVEL*BLANK    WN0158  1        Price Audit
     C                     MOVEL*BLANK    WN0159  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0160  1        Production Date
     C                     Z-ADD*ZERO     WN0161 112       Rated Freight
     C                     Z-ADD*ZERO     WN0162 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0163 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0164 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0165 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0166 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0167 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0168 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0169 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0170 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0171 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0172 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0173  70       Requested Ship
     C                     Z-ADD*ZERO     WN0174  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0175  70       Actual Shipped
     C                     MOVEL*BLANK    WN0176  1        Affect Inventor
     C                     MOVEL*BLANK    WN0177  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0178  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0179  30       Item Structure
     C                     Z-ADD*ZERO     WN0180  30       Item Structure
     C                     Z-ADD*ZERO     WN0181  30       Item Structure
     C                     MOVEL*BLANK    WN0182  2        Item Level
     C                     MOVEL*BLANK    WN0183  2        Quality Level
     C                     MOVEL*BLANK    WN0184  2        Pricing Product
     C                     MOVEL*BLANK    WN0185  2        Season Product
     C                     Z-ADD*ZERO     WN0186  70       Date of Origina
     C                     MOVEL*BLANK    WN0187 10        User Profile Na
     C                     MOVEL*BLANK    WN0188  6        Country Code
     C                     MOVEL*BLANK    WN0189  2        Event Code
     C                     MOVEL*BLANK    WN0190  3        Reason Code
     C                     MOVEL*BLANK    WN0191  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0192  1        Modified Flag
     C                     MOVEL*BLANK    WN0193  1        Substituted Fla
     C                     MOVEL*BLANK    WN0194  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0195 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0196 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0197  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0198  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0199  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0200  1        Affect Commissi
     C                     MOVEL*BLANK    WN0201  1        Affect Pricing
     C                     MOVEL*BLANK    WN0202  1        Released by Use
     C                     MOVEL*BLANK    WN0203  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0204  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0205  3        Production Ware
     C                     MOVEL*BLANK    WN0206  3        OD Price Type
     C                     Z-ADD*ZERO     WN0207  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0208  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0209  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0210  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0211  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0212  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0213  60       Price Code
     C                     Z-ADD*ZERO     WN0214  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0215  60       Substitution Li
     C                     Z-ADD*ZERO     WN0216  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0217 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0218 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0219 112       OD Item Target
     C                     Z-ADD*ZERO     WN0220 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0221 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0222 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN0223 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0224 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0225 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0226 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0227 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0228 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0229 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0230  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0231  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0232  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0233 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0234  40       Item Age Days
     C                     Z-ADD*ZERO     WN0235  70       Production Ovr
     C                     Z-ADD*ZERO     WN0236  70       Production Ovr
     C                     MOVEL*BLANK    WN0237  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0238  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0239  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0240  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0241  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0242  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0243  1        EDI Status 1
     C                     MOVEL*BLANK    WN0244  1        EDI Status 2
     C                     MOVEL*BLANK    WN0245  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0246  60       Job Time
     C                     MOVEL*BLANK    WN0247 10        User Id
     C                     MOVEL*BLANK    WN0248 10        Job Name
     C                     Z-ADD*ZERO     WN0249  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWBAIC3    WGAIC3           Company Number
     C                     Z-ADDWBC4NB    WGC4NB           Order Number
     C                     Z-ADDWBDPNB    WGDPNB           Order Sequence
     C                     Z-ADDWBUENB    WGUENB           Order Secondary
      *
     C           KLCHSK    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGC4NB           Order Number
     C                     KFLD           WGDPNB           Order Sequence
     C                     KFLD           WGUENB           Order Secondary
     C           KLCHSK    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YBRDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADDYL0023    WGKDVA           Billing Detail
     C                     Z-ADDYL0023    WGAYVA           Extended Amount
     C                     Z-ADDYL0023    WGBZPR           Price Overage O
     C                     Z-ADDYL0023    WGAKPR           Unit Price
     C                     Z-ADDYL0023    WGAUPR           Unit Price Orde
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##JOB     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv/Chg Order Value tt RT - PD Order Header      TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIC4NB           Order Number
      * Setup key
     C                     Z-ADDWBAIC3    WIAIC3           Company Number
     C                     Z-ADDWBC4NB    WIC4NB           Order Number
      * Establish starting position
     C           KRSSL     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WIJZVA    ADD  YL0006    YL0024           Order Value Tot
      * CHG Order Value & Wght CH - PD Order Header      TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWIAIC3    WL0001           Company Number
     C                     Z-ADDWIC4NB    WL0002           Order Number
     C                     Z-ADDYL0024    WL0003           Order Value Tot
     C                     Z-ADDWIA1WG    WL0004           Order Weight To
     C                     EXSR SECHRC
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Calc Gross Weight from tares...    copied from Dsp Gross Wgt fun
      *================================================================
      * Rtv Tare Weight        XF - Company Item  * 
     C                     CALL 'PBI3XFR'              90  Rtv Tare Weight
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WGAIC3    WQ0010  30       Company Number
     C                     PARM WGHGCD    WQ0011  70       Item Code
     C           YL0015    PARM YL0015    WQ0012  52       Misc Tare Weigh
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBI3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * wi464
      * RTV Itm BxID & Tares  XF - Item Bill Of Material  * 
     C                     CALL 'PBI4XFR'              90  RTV Itm BxID &
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WGAIC3    WQ0013  30       Company Number
     C                     PARM WGHGCD    WQ0014  70       Item Code
     C           YL0016    PARM *ZERO     WQ0015  52       Box Weight
     C           YL0017    PARM *ZERO     WQ0016  50       Number Cases On
     C           YL0018    PARM *ZERO     WQ0017  52       Pallet Tare Wei
     C           YL0019    PARM *ZERO     WQ0018  70       Box iD
     C                     PARM WGF5SX    WQ0019  2        OD Pallet Type
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBI4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C           YL0016    ADD  YL0015    YL0020           Total Tare USR
      * Box + Misc Tare
      * LCL.Weight 1.1             .U =
      *    *COMPUTE ((x1 + x2) * x3)
      * x1    : LCL.Box Weight
      * +     : PGM.*Synon (15,2) work field
      * x2    : LCL.Misc Tare Weight
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : DB1.Quantity Ordered
     C           YL0016    ADD  YL0015    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT WGAVQT    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0021           Weight 1.1
      * Pallet Tare
      * CASE: DB1.Palletize is yes
     C           WGVEST    IFEQ 'Y'                        *IF
      * CASE: LCL.Number Cases On A Pallet is GT Zero
     C           YL0017    IFGT 0                          *IF
      * Pallet Weight
      * LCL.Weight 1.2             .U =
      *    *COMPUTE (x1 / x2 * x3)
      * x1    : DB1.Quantity Ordered
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : LCL.Number Cases On A Pallet
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : LCL.Pallet Tare Weight
     C           WGAVQT    DIV  YL0017    W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT YL0018    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0022           Weight 1.2
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0022           Weight 1.2
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0022           Weight 1.2
     C                     END                             *FI
      * Estimated Gross
      * DB1.OD Minimum Unit Weight =
      *    *COMPUTE (x1 + x2 + x3)
      * x1    : DB1.Weight Ordered
      * +     : PGM.*Synon (15,2) work field
      * x2    : LCL.Weight 1.1             .U
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.Weight 1.2             .U
     C           WGD0WG    ADD  YL0021    W0WA01           *Synon (15,2) w
     C           W0WA01    ADD  YL0022    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WGH8NX           OD Estimated Gr
      * E00196 RMC 8/24/12 chk pfs interface SHPTRN too
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WAA0DT           Order Date
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WAACDT           Cancel Date
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WAJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WAA1WG           Order Weight To
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WATBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WAATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WARSRN           Resell Referenc
     C                     Z-ADD*ZERO     WAT3NB           Attach to Order
     C                     Z-ADD*ZERO     WACONB           Invoice Number
     C                     Z-ADD*ZERO     WAAWDT           Invoice Date
     C                     Z-ADD*ZERO     WAVRVA           A/R order Value
     C                     Z-ADD*ZERO     WAB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WANODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WANPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WANQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WANRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WANSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WABPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WABQTM           Time of Origina
     C                     Z-ADD*ZERO     WABRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WABSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WABTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WAH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WAH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WAH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WAH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WAH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WAC0C7           Claim Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field USR Weight   9.1  3
     C                     Z-ADD*ZERO     WUH8WG  91
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBDPNB           Order Sequence
     C                     Z-ADD*ZERO     WBUENB           Order Secondary
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WBMAVA           Billing Detail
     C                     Z-ADD*ZERO     WBKDVA           Billing Detail
     C                     Z-ADD*ZERO     WBL8VA           Billing Detail
     C                     Z-ADD*ZERO     WBL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WBAYVA           Extended Amount
     C                     Z-ADD*ZERO     WBEXDT           Market Pricing
     C                     Z-ADD*ZERO     WBBZPR           Price Overage O
     C                     Z-ADD*ZERO     WBL6NB           Contract Number
     C                     Z-ADD*ZERO     WBGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WBD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WBCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WBAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WBCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WBATWG           Weight Shipped
     C                     Z-ADD*ZERO     WBAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WBAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WBAKPR           Unit Price
     C                     Z-ADD*ZERO     WBALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WBAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WBAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WBA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBRGNB           Item Structure
     C                     Z-ADD*ZERO     WBRHNB           Item Structure
     C                     Z-ADD*ZERO     WBRINB           Item Structure
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WBB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WBA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WBNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WBNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WBNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WBNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WBNXDT           OD Firm Date
     C                     Z-ADD*ZERO     WBBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WBBVTM           Price Code
     C                     Z-ADD*ZERO     WBBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WBBXTM           Substitution Li
     C                     Z-ADD*ZERO     WBBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WBH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WBH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WBH7NX           OD Item Target
     C                     Z-ADD*ZERO     WBH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WBH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WBDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WBDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WBDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WBDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WBDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WBGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WBGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WBGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WBPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WBRINY           Item Age Days
     C                     Z-ADD*ZERO     WBTIDT           Production Ovr
     C                     Z-ADD*ZERO     WBTJDT           Production Ovr
     C                     Z-ADD*ZERO     WBTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WBTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WBTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field USR Weight   9.1  4
     C                     Z-ADD*ZERO     WUH9WG  91
      * Define work field Weight Shipped Total
     C                     Z-ADD*ZERO     WUATWG 112
      * Define work field Order Sequence Number
     C                     Z-ADD*ZERO     WUDPNB  30
      * Define work field Warehouse Code
     C                     MOVEL*BLANK    WUAJCD  3
      * Define work field Description Line One
     C                     MOVEL*BLANK    WUAVNA 30
      * Define work field Description Line Two
     C                     MOVEL*BLANK    WUAWNA 30
      * Define work field UOM Primary
     C                     MOVEL*BLANK    WUADCD  2
      * Define work field Conversion Factor 1
     C                     Z-ADD*ZERO     WUAWPC  94
      * Define work field Operation Factor 1
     C                     MOVEL*BLANK    WULXST  1
      * Define work field UOM Second
     C                     MOVEL*BLANK    WUAECD  2
      * Define work field Conversion Factor 2
     C                     Z-ADD*ZERO     WUAXPC  94
      * Define work field Operation Factor 2
     C                     MOVEL*BLANK    WULYST  1
      * Define work field UOM Third
     C                     MOVEL*BLANK    WUAFCD  2
      * Define work field UOM Pricing
     C                     MOVEL*BLANK    WUAICD  2
      * Define work field Unit Weight
     C                     Z-ADD*ZERO     WUAIWG 112
      * Define work field Production Date Control
     C                     MOVEL*BLANK    WUFZST  1
      * Define work field Catch Weight Status
     C                     MOVEL*BLANK    WUAVST  1
      * Define work field Item Structure Class Code
     C                     Z-ADD*ZERO     WURINB  30
      * Define work field Item Structure Group Code
     C                     Z-ADD*ZERO     WURHNB  30
      * Define work field Item Structure Type Code
     C                     Z-ADD*ZERO     WURGNB  30
      * Define work field Default Warehouse
     C                     MOVEL*BLANK    WUQ1CD  3
      * Define work field Price Method Default
     C                     MOVEL*BLANK    WUQ8CD  3
      * Define work field Fresh Chilling Time
     C                     Z-ADD*ZERO     WUCHTM  52
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFHGCD           Item Code
     C                     Z-ADD*ZERO     WFAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WFAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WFAIWG           Unit Weight
     C                     Z-ADD*ZERO     WFCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WFC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WFURTN           Number Cases On
     C                     Z-ADD*ZERO     WFAJC8           Vendor Item Def
     C                     Z-ADD*ZERO     WFRINB           Item Structure
     C                     Z-ADD*ZERO     WFRHNB           Item Structure
     C                     Z-ADD*ZERO     WFRGNB           Item Structure
     C                     Z-ADD*ZERO     WFTFNB           Transportation
     C                     Z-ADD*ZERO     WFTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WFTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WFBLPR           Market Overage
     C                     Z-ADD*ZERO     WFBMPR           Standard Overag
     C                     Z-ADD*ZERO     WFCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WFCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WFSWGH           Std Weight_Head
     C                     Z-ADD*ZERO     WFPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WFICN1           Item Category N
     C                     Z-ADD*ZERO     WFICN2           Item Category N
     C                     Z-ADD*ZERO     WFV2NB           Item Category N
     C                     Z-ADD*ZERO     WFITCN           Item Category N
     C                     Z-ADD*ZERO     WFITC5           Item Category N
     C                     Z-ADD*ZERO     WFICN6           Item Category N
     C                     Z-ADD*ZERO     WFICN7           Item Category N
     C                     Z-ADD*ZERO     WFICN8           Item Category N
     C                     Z-ADD*ZERO     WFICN9           Item Category N
     C                     Z-ADD*ZERO     WFICN0           Item Category N
     C                     Z-ADD*ZERO     WFSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WFA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WFSJNB           Production Lead
     C                     Z-ADD*ZERO     WFSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WFSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WFSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WFCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WFCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WFILNB           Packages per ca
     C                     Z-ADD*ZERO     WFCHNB           Use_Freeze_Sell
     C                     Z-ADD*ZERO     WFCINB           PM Batch Size
     C                     Z-ADD*ZERO     WFCJNB           Package Level s
     C                     Z-ADD*ZERO     WFCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WFCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WFCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WFCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WFCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WFCWNB           PM Std LBS Man
     C                     Z-ADD*ZERO     WFCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WFCZNB           PM Formula LBS
     C                     Z-ADD*ZERO     WFC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WFB4NB           PM Raw Material
     C                     Z-ADD*ZERO     WFB5NB           PM Line Number
     C                     Z-ADD*ZERO     WFBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WFBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WFF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WFF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WFF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WFBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WFBNNB           Production Qty
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Define work field Commodity Market Code
     C                     MOVEL*BLANK    WULQCD  3
      * Define work field Blank for 3          USR
     C                     MOVEL*BLANK    WUUAT1  3
      * Clear all neither parameters
      * CRT PD Order Detail    CR - Order Detail  * 
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WHBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WHBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WHBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WHBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SECHRC.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     Z-ADD*ZERO     WL0003 112
     C                     Z-ADD*ZERO     WL0004 112
      * Define local work field Expense Description  USR
     C                     MOVEL*BLANK    YL0001 25
      * Define local work field Expense type         USR
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field Unit of Measure. . . . .
     C                     MOVEL*BLANK    YL0003  2
      * Define local work field Fuel Surcharge Amount
     C                     Z-ADD*ZERO     YL0004  72
      * Define local work field Total Load Miles
     C                     Z-ADD*ZERO     YL0005  70
      * Define local work field Fuel Surcharge for Load
     C                     Z-ADD*ZERO     YL0006 112
      * Define local work field USR Weight   9.1  3
     C                     Z-ADD*ZERO     YL0007  91
      * Define local work field Fuel Surcharge per LB USR
     C                     Z-ADD*ZERO     YL0008 117
      * Define local work field Order Number
     C                     Z-ADD*ZERO     YL0009  70
      * Define local work field Order Sequence Number
     C                     Z-ADD*ZERO     YL0010  30
      * Define local work field Fuel Surcharge for Load
     C                     Z-ADD*ZERO     YL0011 112
      * Define local work field Extended Amount
     C                     Z-ADD*ZERO     YL0012 112
      * Define local work field Order Value Total
     C                     Z-ADD*ZERO     YL0013 112
      * Define local work field Item Code
     C                     Z-ADD*ZERO     YL0014  70
      * Define null work field Accounting Company
     C                     Z-ADD*ZERO     YN0001  30
      * Define local work field Misc Tare Weight
     C                     Z-ADD*ZERO     YL0015  52
      * Define local work field Box Weight
     C                     Z-ADD*ZERO     YL0016  52
      * Define local work field Number Cases On A Pallet
     C                     Z-ADD*ZERO     YL0017  50
      * Define local work field Pallet Tare Weight
     C                     Z-ADD*ZERO     YL0018  52
      * Define local work field Box iD
     C                     Z-ADD*ZERO     YL0019  70
      * Define local work field Total Tare USR
     C                     Z-ADD*ZERO     YL0020  52
      * Define local work field Weight 1.1             .U
     C                     Z-ADD*ZERO     YL0021  92
      * Define local work field Weight 1.2             .U
     C                     Z-ADD*ZERO     YL0022  92
      * Define local work field Extended Amount
     C                     Z-ADD*ZERO     YL0023 112
      * Define local work field Order Value Total
     C                     Z-ADD*ZERO     YL0024 112
      *================================================================
     CSR         ZZEXIT    ENDSR
