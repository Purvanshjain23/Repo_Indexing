/********************************************************************/
/*                                                                  */
/*  SYNOPSIS - PRINT PROGRAM WITH SELECTIONS FOR DAILY HOLDOVER RPT.*/
/*             COMPANY, SCHEDULED SHIP DATE                         */
/*                                                                  */
/*  SYSTEM    - ORDER MANAGEMENT SYSTEM                             */
/*  PROGRAM   - PRINT DAILY HOLDOVER REPORT                         */
/*  DATE      -  3/26/97                                            */
/*                                                                  */
/*      PARAMETERS RECEIVED:                                        */
/*                                                                  */
/*          &COMPNYN    - COMPANY NUMBER - BLANK FOR ALL            */
/*          &FRMDATN    - SCHEDULED SHIP DATE                       */
/*          &OUTQ       - OUTPUT QUEUE                              */
/*          &HOLD       - HOLD PRINT                                */
/*          &SAVE       - SAVE PRINT                                */
/*          &COPYN      - NUMBER OF COPIES                          */
/*          &NIGHTQ     - NIGHT OUTPUT QUEUE                        */
/********************************************************************/
 PDX9CLP:    PGM        PARM(&FRMDATN)

/* PARMS */
             DCL  VAR(&FRMDATN) TYPE(*DEC)

/* INTERNAL FIELDS */
             DCL  VAR(&COPYN)   TYPE(*DEC)           VALUE(1)
             DCL  VAR(&OUTQ)    TYPE(*CHAR) LEN(10)  VALUE('ISPRT08')
             DCL  VAR(&HOLD)    TYPE(*CHAR) LEN(4)   VALUE('*YES')
             DCL  VAR(&SAVE)    TYPE(*CHAR) LEN(4)   VALUE('*NO')
             DCL  VAR(&NIGHTQ)  TYPE(*CHAR) LEN(10)
             DCL  VAR(&COMMAND) TYPE(*CHAR) LEN(512)
             DCL  VAR(&COPY)    TYPE(*DEC)  LEN(2 0)
             DCL  VAR(&COMPANY) TYPE(*DEC)  LEN(3 0)
             DCL  VAR(&FRMDAT)  TYPE(*DEC)  LEN(7 0)

/* OPENQRYF FIELDS */
             DCL  VAR(&FRMDATA) TYPE(*CHAR) LEN(7)
             DCL  VAR(&A)       TYPE(*CHAR) LEN(25)

/********************************************************************/
/* CHANGE VARIABLES FOR USE IN PROGRAM                              */
/********************************************************************/
             CHGVAR VAR(&FRMDAT)  VALUE(&FRMDATN)
             CHGVAR VAR(&FRMDATA) VALUE(&FRMDAT)
             CHGVAR VAR(&COPY)    VALUE(&COPYN)

/*********************************************************************/
/*   CREATE OPEN QUERY FILE TO BE USED FOR REPORTING                 */
/*********************************************************************/
             CHGVAR VAR(&A) VALUE('F4GNDT *EQ ' *CAT &FRMDATA)

             OVRDBF FILE(OMHSTPLM) SHARE(*YES)
             OPNQRYF FILE((OMHSTPLM)) +
                     QRYSLT(&A) +
                     KEYFLD(*FILE)

/********************************************************************/
/* OVERRIDE PRINTER FILE WITH USER SPECIFIED SELECTION VALUES       */
/********************************************************************/
             SBDPRTOVR CMDVAR(&COMMAND) FILE(PDE9PFR$) OUTQ(&OUTQ) +
                       DRAWER(1) COPIES(&COPY) HOLD(&HOLD) +
                       SAVE(&SAVE)
             CALL PGM(QCMDEXC) PARM(&COMMAND 512)

/*********************************************************************/
/*   CALL PRINT PROGRAM -
/*********************************************************************/
             CALL PGM(PDX9PFR) PARM(' ' &COMPANY &FRMDAT)
END:
     ENDPGM
