// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PUS6XFR
// ?Date: 14.08.2025 Time: 03:51:17
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?** W77844 DN  06/11/21
//?** One time conversion to update the Spot Buy flag values.
//?** Selecting All Orders!
//?** Convert Spot Buy Flag values for the following files:
//?**   PMAMREP - Order Header Extsn - Field 'OHE Spot Buy'.
//?**     From Value: '*YES' -> 'S'pot  and '*NO' -> 'T'urn.
//?**   OPBGWKP - Order Detail - Field 'OD Spot Buy'.
//?**     From Value: 'Y' -> 'S'pot  and 'N' -> 'T'urn.
//?**   PMD0CPP - Sales History Ext - Field 'SH Spot Buy Sts'.
//?**     From Value: 'Y' -> 'S'pot  and 'N' -> 'T'urn.
//?!!! TESTING ONLY-COMMENT OUT when finish Testing!!!
//?DN-Remove RST after Finish Testing!!!
EXECUTE FUNCTION(Cnv Upd Spot Buy Flag RT) TYPE(RTVOBJ) FILE(OPBFCPP)           AC2197357;
{
 //?USER: Process Data record

 //?Update Field 'OHE Spot Buy' values in OHE file.
 EXECUTE FUNCTION(Cnv Upd Spot Buy Flag RT) TYPE(RTVOBJ) FILE(PMAMREP)           AC2197358;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Order_Number);
 {
  //?USER: Process Data record

  CASE;

  // IF DB1.OHE Spot Buy is *Blank
  IF DB1.OHE_Spot_Buy = *BLANK;

  // IF *OTHERWISE
  IF *OTHERWISE;

  //?Convert Old to New Values:
  CASE;

  // IF DB1.OHE Spot Buy is *YES
  IF DB1.OHE_Spot_Buy = *YES;

  // LCL.OHE Spot Buy = CND.Spot
  LCL.OHE_Spot_Buy = 'S';

  //?Convert Old to New Values:
  // IF DB1.OHE Spot Buy is *NO
  IF DB1.OHE_Spot_Buy = *NO;

  // LCL.OHE Spot Buy = CND.Turn
  LCL.OHE_Spot_Buy = 'T';

  ENDIF;

  EXECUTE FUNCTION(Cnv Upd Spot Buy Flag  CH) TYPE(CHGOBJ) FILE(PMAMREP)          AC2197365;
  PARAMETER(DB1.Company_Number);
  PARAMETER(DB1.Order_Number);
  PARAMETER(LCL.OHE_Spot_Buy);
  ENDIF;

 }

 //?Update Field 'OD Spot Buy' values in OD file.
 EXECUTE FUNCTION(Cnv Upd Spot Buy Flag RT) TYPE(RTVOBJ) FILE(OPBGWKP)           AC2197366;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Order_Number);
 {
  //?USER: Process Data record

  CASE;

  // IF DB1.OD Spot Buy is No-blank
  IF DB1.OD_Spot_Buy = *BLANK;

  // IF *OTHERWISE
  IF *OTHERWISE;

  //?Convert Old to New Values:
  CASE;

  // IF DB1.OD Spot Buy is Yes
  IF DB1.OD_Spot_Buy = 'Y';

  // LCL.OD Spot Buy = CND.Spot
  LCL.OD_Spot_Buy = 'S';

  //?Convert Old to New Values:
  // IF DB1.OD Spot Buy is No
  IF DB1.OD_Spot_Buy = 'N';

  // LCL.OD Spot Buy = CND.Turn
  LCL.OD_Spot_Buy = 'T';

  ENDIF;

  EXECUTE FUNCTION(Cnv Upd OD Spot Buy   CH) TYPE(CHGOBJ) FILE(OPBGWKP)           AC2194813;
  PARAMETER(DB1.Company_Number);
  PARAMETER(DB1.Order_Number);
  PARAMETER(DB1.Order_Sequence_Number);
  PARAMETER(DB1.Order_Secondary_Line_Seq);
  PARAMETER(LCL.OD_Spot_Buy);
  ENDIF;

 }

 //?Update Field 'SH Spot Buy Sts' values in SHE file.
 EXECUTE FUNCTION(Cnv Upd Spot Buy Flag RT) TYPE(RTVOBJ) FILE(PMD0CPP)           AC2197367;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Order_Number);
 {
  //?USER: Process Data record

  CASE;

  // IF DB1.SH Spot Buy Sts is Blank
  IF DB1.SH_Spot_Buy_Sts = *BLANK;

  // IF *OTHERWISE
  IF *OTHERWISE;

  //?Convert Old to New Values:
  CASE;

  // IF DB1.SH Spot Buy Sts is Yes
  IF DB1.SH_Spot_Buy_Sts = 'Y';

  // LCL.SH Spot Buy Sts = CND.Spot
  LCL.SH_Spot_Buy_Sts = 'S';

  //?Convert Old to New Values:
  // IF DB1.SH Spot Buy Sts is No
  IF DB1.SH_Spot_Buy_Sts = 'N';

  // LCL.SH Spot Buy Sts = CND.Turn
  LCL.SH_Spot_Buy_Sts = 'T';

  ENDIF;

  EXECUTE FUNCTION(Cnv Upd Spot Buy Flag CH) TYPE(CHGOBJ) FILE(PMD0CPP)           AC2197368;
  PARAMETER(DB1.Company_Number);
  PARAMETER(DB1.Order_Number);
  PARAMETER(DB1.Order_Sequence_Number);
  PARAMETER(DB1.Order_Secondary_Line_Seq);
  PARAMETER(LCL.SH_Spot_Buy_Sts);
  ENDIF;

 }

}


//?!!! TESTING ONLY-COMMENT OUT when finish Testing!!!
