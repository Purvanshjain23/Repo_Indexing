     H/TITLE Upd Block Order Qtemp XF  Execute external functio
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) BNDDIR(YBNDDIR) DBGVIEW(*SOURCE)
     Z* CVTOPT(*DATETIME) ACTGRP(*CALLER) OPTIMIZE(*BASIC)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Execute external function
     H* Object type   : *PGM
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISJMIST
     H* Date          : 04/12/24  Time  : 01:10:12
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOPBGWKL1  IF   E           K DISK
      * RTV : Order Detail              Retrieval index
      *
     FOPBGWKL0  UF   E           K DISK
      * UPD : Order Detail              Update index
      *
      * Long constants
     D @CN#            S              6    DIM(02)CTDATA PERRCD(1)
     D @CN             S             25    DIM(02) ALT(@CN#)
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
     D QOPBG1        E DS                  EXTNAME(OPBGWKL0)
      * UPD : Order Detail              Update index
      * Renamed input format fields
     D  WBAIC3       E                     EXTFLD(OMAIC3)
     D  WBC4NB       E                     EXTFLD(OMC4NB)
     D  WBDPNB       E                     EXTFLD(OMDPNB)
     D  WBUENB       E                     EXTFLD(OMUENB)
     D  WBHGCD       E                     EXTFLD(OMHGCD)
     D  WBAJCD       E                     EXTFLD(OMAJCD)
     D  WBBKC7       E                     EXTFLD(OMBKC7)
     D  WBCFC7       E                     EXTFLD(OMCFC7)
     D  WBGMST       E                     EXTFLD(OMGMST)
     D  WBGNST       E                     EXTFLD(OMGNST)
     D  WBMAVA       E                     EXTFLD(OMMAVA)
     D  WBKDVA       E                     EXTFLD(OMKDVA)
     D  WBL8VA       E                     EXTFLD(OML8VA)
     D  WBL9VA       E                     EXTFLD(OML9VA)
     D  WBGTST       E                     EXTFLD(OMGTST)
     D  WBGVST       E                     EXTFLD(OMGVST)
     D  WBGUST       E                     EXTFLD(OMGUST)
     D  WBQFST       E                     EXTFLD(OMQFST)
     D  WBAYVA       E                     EXTFLD(OMAYVA)
     D  WBEXDT       E                     EXTFLD(OMEXDT)
     D  WBLQCD       E                     EXTFLD(OMLQCD)
     D  WBRDCD       E                     EXTFLD(OMRDCD)
     D  WBQ7CD       E                     EXTFLD(OMQ7CD)
     D  WBBZPR       E                     EXTFLD(OMBZPR)
     D  WBL6NB       E                     EXTFLD(OML6NB)
     D  WBU1ST       E                     EXTFLD(OMU1ST)
     D  WBGIDT       E                     EXTFLD(OMGIDT)
     D  WBCRCD       E                     EXTFLD(OMCRCD)
     D  WBAGCD       E                     EXTFLD(OMAGCD)
     D  WBRZST       E                     EXTFLD(OMRZST)
     D  WBR0ST       E                     EXTFLD(OMR0ST)
     D  WBR1ST       E                     EXTFLD(OMR1ST)
     D  WBG7NA       E                     EXTFLD(OMG7NA)
     D  WBG8NA       E                     EXTFLD(OMG8NA)
     D  WBRPCD       E                     EXTFLD(OMRPCD)
     D  WBVEST       E                     EXTFLD(OMVEST)
     D  WBVGST       E                     EXTFLD(OMVGST)
     D  WBAVST       E                     EXTFLD(OMAVST)
     D  WBU0ST       E                     EXTFLD(OMU0ST)
     D  WBRFCD       E                     EXTFLD(OMRFCD)
     D  WBFZST       E                     EXTFLD(OMFZST)
     D  WBR1NB       E                     EXTFLD(OMR1NB)
     D  WBAVQT       E                     EXTFLD(OMAVQT)
     D  WBD0WG       E                     EXTFLD(OMD0WG)
     D  WBCCQT       E                     EXTFLD(OMCCQT)
     D  WBAUWG       E                     EXTFLD(OMAUWG)
     D  WBCBQT       E                     EXTFLD(OMCBQT)
     D  WBATWG       E                     EXTFLD(OMATWG)
     D  WBAQCS       E                     EXTFLD(OMAQCS)
     D  WBAGCS       E                     EXTFLD(OMAGCS)
     D  WBAKPR       E                     EXTFLD(OMAKPR)
     D  WBALPR       E                     EXTFLD(OMALPR)
     D  WBAUPR       E                     EXTFLD(OMAUPR)
     D  WBAVWG       E                     EXTFLD(OMAVWG)
     D  WBA4WG       E                     EXTFLD(OMA4WG)
     D  WBA5DT       E                     EXTFLD(OMA5DT)
     D  WBAODT       E                     EXTFLD(OMAODT)
     D  WBGNDT       E                     EXTFLD(OMGNDT)
     D  WBAMST       E                     EXTFLD(OMAMST)
     D  WBANST       E                     EXTFLD(OMANST)
     D  WBVAST       E                     EXTFLD(OMVAST)
     D  WBRGNB       E                     EXTFLD(OMRGNB)
     D  WBRHNB       E                     EXTFLD(OMRHNB)
     D  WBRINB       E                     EXTFLD(OMRINB)
     D  WBRBCD       E                     EXTFLD(OMRBCD)
     D  WBHICD       E                     EXTFLD(OMHICD)
     D  WBRNCD       E                     EXTFLD(OMRNCD)
     D  WBROCD       E                     EXTFLD(OMROCD)
     D  WBCXDT       E                     EXTFLD(OMCXDT)
     D  WBAJVN       E                     EXTFLD(OMAJVN)
     D  WBKXCD       E                     EXTFLD(OMKXCD)
     D  WBJPCD       E                     EXTFLD(OMJPCD)
     D  WBCQCD       E                     EXTFLD(OMCQCD)
     D  WBR4CD       E                     EXTFLD(OMR4CD)
     D  WBZ1ST       E                     EXTFLD(OMZ1ST)
     D  WBZ3ST       E                     EXTFLD(OMZ3ST)
     D  WBZ4ST       E                     EXTFLD(OMZ4ST)
     D  WBDUPR       E                     EXTFLD(OMDUPR)
     D  WBB6VL       E                     EXTFLD(OMB6VL)
     D  WBA1AA       E                     EXTFLD(OMA1AA)
     D  WBFZSX       E                     EXTFLD(OMFZSX)
     D  WBF0SX       E                     EXTFLD(OMF0SX)
     D  WBF1SX       E                     EXTFLD(OMF1SX)
     D  WBF2SX       E                     EXTFLD(OMF2SX)
     D  WBF3SX       E                     EXTFLD(OMF3SX)
     D  WBF4SX       E                     EXTFLD(OMF4SX)
     D  WBF5SX       E                     EXTFLD(OMF5SX)
     D  WBF6SX       E                     EXTFLD(OMF6SX)
     D  WBF7SX       E                     EXTFLD(OMF7SX)
     D  WBNTDT       E                     EXTFLD(OMNTDT)
     D  WBNUDT       E                     EXTFLD(OMNUDT)
     D  WBNVDT       E                     EXTFLD(OMNVDT)
     D  WBNWDT       E                     EXTFLD(OMNWDT)
     D  WBNXDT       E                     EXTFLD(OMNXDT)
     D  WBBUTM       E                     EXTFLD(OMBUTM)
     D  WBBVTM       E                     EXTFLD(OMBVTM)
     D  WBBWTM       E                     EXTFLD(OMBWTM)
     D  WBBXTM       E                     EXTFLD(OMBXTM)
     D  WBBYTM       E                     EXTFLD(OMBYTM)
     D  WBH5NX       E                     EXTFLD(OMH5NX)
     D  WBH6NX       E                     EXTFLD(OMH6NX)
     D  WBH7NX       E                     EXTFLD(OMH7NX)
     D  WBH8NX       E                     EXTFLD(OMH8NX)
     D  WBH9NX       E                     EXTFLD(OMH9NX)
     D  WBDVPR       E                     EXTFLD(OMDVPR)
     D  WBDWPR       E                     EXTFLD(OMDWPR)
     D  WBDXPR       E                     EXTFLD(OMDXPR)
     D  WBDYPR       E                     EXTFLD(OMDYPR)
     D  WBDZPR       E                     EXTFLD(OMDZPR)
     D  WBGSPR       E                     EXTFLD(OMGSPR)
     D  WBGTPR       E                     EXTFLD(OMGTPR)
     D  WBGUPR       E                     EXTFLD(OMGUPR)
     D  WBHOST       E                     EXTFLD(OMHOST)
     D  WBHPST       E                     EXTFLD(OMHPST)
     D  WBIOST       E                     EXTFLD(OMIOST)
     D  WBPEWG       E                     EXTFLD(OMPEWG)
     D  WBRINY       E                     EXTFLD(OMRINY)
     D  WBTIDT       E                     EXTFLD(OMTIDT)
     D  WBTJDT       E                     EXTFLD(OMTJDT)
     D  WBH2ST       E                     EXTFLD(OMH2ST)
     D  WBH0ST       E                     EXTFLD(OMH0ST)
     D  WBH1ST       E                     EXTFLD(OMH1ST)
     D  WBTKDT       E                     EXTFLD(OMTKDT)
     D  WBTLDT       E                     EXTFLD(OMTLDT)
     D  WBTMDT       E                     EXTFLD(OMTMDT)
     D  WBUVST       E                     EXTFLD(OMUVST)
     D  WBUWST       E                     EXTFLD(OMUWST)
     D  WBUXST       E                     EXTFLD(OMUXST)
     D  WBAATM       E                     EXTFLD(OMAATM)
     D  WBAYNA       E                     EXTFLD(OMAYNA)
     D  WBA0NA       E                     EXTFLD(OMA0NA)
     D  WBAXDT       E                     EXTFLD(OMAXDT)
      *
     D YARDCS          DS           525
      * Message data for message Y2U0009.
     D MD0009          DS
     D  MDPGM                  1     10
     D  MDACP                 11     20
     D  MDFMT                 21     30
     D  MDACT                 31     34
     D  MDLBL                 35     40
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  WP0001         S              3  0
     D  WP0002         S              7  0
     D  WP0003         S              3  0
     D  WP0004         S              3  0
     D  WP0005         S              7  0
     D  WP0006         S              3
     D  WP0007         S              3
     D  WP0008         S              3
     D  WP0009         S             11  4
     D  WP0010         S             11  2
     D  WP0011         S             11  4
     D  WP0012         S             11  4
     D  WP0013         S              7  0
     D  WP0014         S              7  0
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  WN0001         S              7  0
     D  WN0002         S              3
     D  WN0003         S              7  0
     D  WN0004         S              7  0
     D  WN0005         S              1
     D  WN0006         S              1
     D  WN0007         S             11  2
     D  WN0008         S             11  2
     D  WN0009         S             11  2
     D  WN0010         S             11  2
     D  WN0011         S              1
     D  WN0012         S              1
     D  WN0013         S              1
     D  WN0014         S              1
     D  WN0015         S             11  2
     D  WN0016         S              7  0
     D  WN0017         S              1
     D  WN0018         S              7  0
     D  WN0019         S              2
     D  WN0020         S              2
     D  WN0021         S              1
     D  WN0022         S              1
     D  WN0023         S              1
     D  WN0024         S             30
     D  WN0025         S             30
     D  WN0026         S              1
     D  WN0027         S              1
     D  WN0028         S              1
     D  WN0029         S              1
     D  WN0030         S              1
     D  WN0031         S              3
     D  WN0032         S              1
     D  WN0033         S             11  2
     D  WN0034         S             11  2
     D  WN0035         S             11  2
     D  WN0036         S             11  2
     D  WN0037         S             11  2
     D  WN0038         S             11  2
     D  WN0039         S             11  4
     D  WN0040         S             11  4
     D  WN0041         S             11  4
     D  WN0042         S             11  4
     D  WN0043         S             11  2
     D  WN0044         S             11  2
     D  WN0045         S              7  0
     D  WN0046         S              7  0
     D  WN0047         S              7  0
     D  WN0048         S              1
     D  WN0049         S              1
     D  WN0050         S              1
     D  WN0051         S              3  0
     D  WN0052         S              3  0
     D  WN0053         S              3  0
     D  WN0054         S              2
     D  WN0055         S              2
     D  WN0056         S              2
     D  WN0057         S              2
     D  WN0058         S              7  0
     D  WN0059         S             10
     D  WN0060         S              6
     D  WN0061         S              2
     D  WN0062         S              3
     D  WN0063         S              3
     D  WN0064         S              1
     D  WN0065         S              1
     D  WN0066         S              1
     D  WN0067         S             11  4
     D  WN0068         S             11  2
     D  WN0069         S              3  0
     D  WN0070         S              1
     D  WN0071         S              1
     D  WN0072         S              1
     D  WN0073         S              1
     D  WN0074         S              1
     D  WN0075         S              2
     D  WN0076         S              2
     D  WN0077         S              3
     D  WN0078         S              3
     D  WN0079         S              7  0
     D  WN0080         S              7  0
     D  WN0081         S              7  0
     D  WN0082         S              7  0
     D  WN0083         S              7  0
     D  WN0084         S              6  0
     D  WN0085         S              6  0
     D  WN0086         S              6  0
     D  WN0087         S              6  0
     D  WN0088         S              6  0
     D  WN0089         S             11  2
     D  WN0090         S             11  2
     D  WN0091         S             11  2
     D  WN0092         S             11  2
     D  WN0093         S             11  2
     D  WN0094         S             11  4
     D  WN0095         S             11  4
     D  WN0096         S             11  4
     D  WN0097         S             11  4
     D  WN0098         S             11  4
     D  WN0099         S             11  4
     D  WN0100         S             11  4
     D  WN0101         S              1
     D  WN0102         S              1
     D  WN0103         S              1
     D  WN0104         S             11  2
     D  WN0105         S              4  0
     D  WN0106         S              7  0
     D  WN0107         S              7  0
     D  WN0108         S              1
     D  WN0109         S              2
     D  WN0110         S              3
     D  WN0111         S              7  0
     D  WN0112         S              1
     D  WN0113         S              1
     D  WN0114         S              1
     D  WN0115         S              6  0
     D  WN0116         S             10
     D  WN0117         S             10
     D  WN0118         S              7  0
     D  YARDC          S              1
     D  YL0001         S              5  2
     D  WQ0001         S              3  0
     D  WQ0002         S              7  0
     D  WQ0003         S              5  2
     D  W0CLPG         S             10
     D  YL0002         S              5  2
     D  YL0003         S              5  0
     D  YL0004         S              5  2
     D  YL0005         S              7  0
     D  WQ0004         S              3  0
     D  WQ0005         S              7  0
     D  WQ0006         S              5  2
     D  WQ0007         S              5  0
     D  WQ0008         S              5  2
     D  WQ0009         S              7  0
     D  WQ0010         S              2
     D  YL0006         S              5  2
     D  YL0007         S              9  2
     D  YL0008         S              9  2
     D  ZAPGMQ         S             10
     D  ZAPGRL         S              5
     D  ZAMSID         S              7
     D  ZAMSGF         S             10
     D  ZAMSTP         S              7
     D  YILE           S              1
     D  W0WA01         S             15  2
     D  W0WA00         S             15  2
     D  W0PMT          S              1
      /EJECT
      * Parameter declarations
     D P1PARM          DS
      * FLD: Order Detail
      * I :  Company Number
     D  P1AIC3                 1      2P 0
      * I :  Order Number
     D  P1C4NB                 3      6P 0
      * I :  Order Sequence Number
     D  P1DPNB                 7      8P 0
      * I :  Order Secondary Line Seq
     D  P1UENB                 9     10P 0
      * I :  Market Pricing Date
     D  P1EXDT                11     14P 0
      * I :  Commodity Market Code
     D  P1LQCD                15     17
      * I :  Date Method Code
     D  P1RDCD                18     20
      * I :  Price Method Code
     D  P1Q7CD                21     23
      * I :  Price Overage Override
     D  P1BZPR                24     29P 4
      * I :  Weight Ordered
     D  P1D0WG                30     35P 2
      * I :  Unit Price_Credit
     D  P1ALPR                36     41P 4
      * I :  OD Ceiling Price
     D  P1DWPR                42     47P 4
      * I :  OD Market Begin Date
     D  P1TKDT                48     51P 0
      * I :  OD Market Ending Date
     D  P1TLDT                52     55P 0
     D                 DS
     D  ZAMSDA                 1    132
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                      WAAIC3
     I              OMC4NB                      WAC4NB
     I              OMDPNB                      WADPNB
     I              OMUENB                      WAUENB
     I              OMHGCD                      WAHGCD
     I              OMAJCD                      WAAJCD
     I              OMBKC7                      WABKC7
     I              OMCFC7                      WACFC7
     I              OMGMST                      WAGMST
     I              OMGNST                      WAGNST
     I              OMMAVA                      WAMAVA
     I              OMKDVA                      WAKDVA
     I              OML8VA                      WAL8VA
     I              OML9VA                      WAL9VA
     I              OMGTST                      WAGTST
     I              OMGVST                      WAGVST
     I              OMGUST                      WAGUST
     I              OMQFST                      WAQFST
     I              OMAYVA                      WAAYVA
     I              OMEXDT                      WAEXDT
     I              OMLQCD                      WALQCD
     I              OMRDCD                      WARDCD
     I              OMQ7CD                      WAQ7CD
     I              OMBZPR                      WABZPR
     I              OML6NB                      WAL6NB
     I              OMU1ST                      WAU1ST
     I              OMGIDT                      WAGIDT
     I              OMCRCD                      WACRCD
     I              OMAGCD                      WAAGCD
     I              OMRZST                      WARZST
     I              OMR0ST                      WAR0ST
     I              OMR1ST                      WAR1ST
     I              OMG7NA                      WAG7NA
     I              OMG8NA                      WAG8NA
     I              OMRPCD                      WARPCD
     I              OMVEST                      WAVEST
     I              OMVGST                      WAVGST
     I              OMAVST                      WAAVST
     I              OMU0ST                      WAU0ST
     I              OMRFCD                      WARFCD
     I              OMFZST                      WAFZST
     I              OMR1NB                      WAR1NB
     I              OMAVQT                      WAAVQT
     I              OMD0WG                      WAD0WG
     I              OMCCQT                      WACCQT
     I              OMAUWG                      WAAUWG
     I              OMCBQT                      WACBQT
     I              OMATWG                      WAATWG
     I              OMAQCS                      WAAQCS
     I              OMAGCS                      WAAGCS
     I              OMAKPR                      WAAKPR
     I              OMALPR                      WAALPR
     I              OMAUPR                      WAAUPR
     I              OMAVWG                      WAAVWG
     I              OMA4WG                      WAA4WG
     I              OMA5DT                      WAA5DT
     I              OMAODT                      WAAODT
     I              OMGNDT                      WAGNDT
     I              OMAMST                      WAAMST
     I              OMANST                      WAANST
     I              OMVAST                      WAVAST
     I              OMRGNB                      WARGNB
     I              OMRHNB                      WARHNB
     I              OMRINB                      WARINB
     I              OMRBCD                      WARBCD
     I              OMHICD                      WAHICD
     I              OMRNCD                      WARNCD
     I              OMROCD                      WAROCD
     I              OMCXDT                      WACXDT
     I              OMAJVN                      WAAJVN
     I              OMKXCD                      WAKXCD
     I              OMJPCD                      WAJPCD
     I              OMCQCD                      WACQCD
     I              OMR4CD                      WAR4CD
     I              OMZ1ST                      WAZ1ST
     I              OMZ3ST                      WAZ3ST
     I              OMZ4ST                      WAZ4ST
     I              OMDUPR                      WADUPR
     I              OMB6VL                      WAB6VL
     I              OMA1AA                      WAA1AA
     I              OMFZSX                      WAFZSX
     I              OMF0SX                      WAF0SX
     I              OMF1SX                      WAF1SX
     I              OMF2SX                      WAF2SX
     I              OMF3SX                      WAF3SX
     I              OMF4SX                      WAF4SX
     I              OMF5SX                      WAF5SX
     I              OMF6SX                      WAF6SX
     I              OMF7SX                      WAF7SX
     I              OMNTDT                      WANTDT
     I              OMNUDT                      WANUDT
     I              OMNVDT                      WANVDT
     I              OMNWDT                      WANWDT
     I              OMNXDT                      WANXDT
     I              OMBUTM                      WABUTM
     I              OMBVTM                      WABVTM
     I              OMBWTM                      WABWTM
     I              OMBXTM                      WABXTM
     I              OMBYTM                      WABYTM
     I              OMH5NX                      WAH5NX
     I              OMH6NX                      WAH6NX
     I              OMH7NX                      WAH7NX
     I              OMH8NX                      WAH8NX
     I              OMH9NX                      WAH9NX
     I              OMDVPR                      WADVPR
     I              OMDWPR                      WADWPR
     I              OMDXPR                      WADXPR
     I              OMDYPR                      WADYPR
     I              OMDZPR                      WADZPR
     I              OMGSPR                      WAGSPR
     I              OMGTPR                      WAGTPR
     I              OMGUPR                      WAGUPR
     I              OMHOST                      WAHOST
     I              OMHPST                      WAHPST
     I              OMIOST                      WAIOST
     I              OMPEWG                      WAPEWG
     I              OMRINY                      WARINY
     I              OMTIDT                      WATIDT
     I              OMTJDT                      WATJDT
     I              OMH2ST                      WAH2ST
     I              OMH0ST                      WAH0ST
     I              OMH1ST                      WAH1ST
     I              OMTKDT                      WATKDT
     I              OMTLDT                      WATLDT
     I              OMTMDT                      WATMDT
     I              OMUVST                      WAUVST
     I              OMUWST                      WAUWST
     I              OMUXST                      WAUXST
     I              OMAATM                      WAAATM
     I              OMAYNA                      WAAYNA
     I              OMA0NA                      WAA0NA
     I              OMAXDT                      WAAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                      WBAIC3
     I              OMC4NB                      WBC4NB
     I              OMDPNB                      WBDPNB
     I              OMUENB                      WBUENB
     I              OMHGCD                      WBHGCD
     I              OMAJCD                      WBAJCD
     I              OMBKC7                      WBBKC7
     I              OMCFC7                      WBCFC7
     I              OMGMST                      WBGMST
     I              OMGNST                      WBGNST
     I              OMMAVA                      WBMAVA
     I              OMKDVA                      WBKDVA
     I              OML8VA                      WBL8VA
     I              OML9VA                      WBL9VA
     I              OMGTST                      WBGTST
     I              OMGVST                      WBGVST
     I              OMGUST                      WBGUST
     I              OMQFST                      WBQFST
     I              OMAYVA                      WBAYVA
     I              OMEXDT                      WBEXDT
     I              OMLQCD                      WBLQCD
     I              OMRDCD                      WBRDCD
     I              OMQ7CD                      WBQ7CD
     I              OMBZPR                      WBBZPR
     I              OML6NB                      WBL6NB
     I              OMU1ST                      WBU1ST
     I              OMGIDT                      WBGIDT
     I              OMCRCD                      WBCRCD
     I              OMAGCD                      WBAGCD
     I              OMRZST                      WBRZST
     I              OMR0ST                      WBR0ST
     I              OMR1ST                      WBR1ST
     I              OMG7NA                      WBG7NA
     I              OMG8NA                      WBG8NA
     I              OMRPCD                      WBRPCD
     I              OMVEST                      WBVEST
     I              OMVGST                      WBVGST
     I              OMAVST                      WBAVST
     I              OMU0ST                      WBU0ST
     I              OMRFCD                      WBRFCD
     I              OMFZST                      WBFZST
     I              OMR1NB                      WBR1NB
     I              OMAVQT                      WBAVQT
     I              OMD0WG                      WBD0WG
     I              OMCCQT                      WBCCQT
     I              OMAUWG                      WBAUWG
     I              OMCBQT                      WBCBQT
     I              OMATWG                      WBATWG
     I              OMAQCS                      WBAQCS
     I              OMAGCS                      WBAGCS
     I              OMAKPR                      WBAKPR
     I              OMALPR                      WBALPR
     I              OMAUPR                      WBAUPR
     I              OMAVWG                      WBAVWG
     I              OMA4WG                      WBA4WG
     I              OMA5DT                      WBA5DT
     I              OMAODT                      WBAODT
     I              OMGNDT                      WBGNDT
     I              OMAMST                      WBAMST
     I              OMANST                      WBANST
     I              OMVAST                      WBVAST
     I              OMRGNB                      WBRGNB
     I              OMRHNB                      WBRHNB
     I              OMRINB                      WBRINB
     I              OMRBCD                      WBRBCD
     I              OMHICD                      WBHICD
     I              OMRNCD                      WBRNCD
     I              OMROCD                      WBROCD
     I              OMCXDT                      WBCXDT
     I              OMAJVN                      WBAJVN
     I              OMKXCD                      WBKXCD
     I              OMJPCD                      WBJPCD
     I              OMCQCD                      WBCQCD
     I              OMR4CD                      WBR4CD
     I              OMZ1ST                      WBZ1ST
     I              OMZ3ST                      WBZ3ST
     I              OMZ4ST                      WBZ4ST
     I              OMDUPR                      WBDUPR
     I              OMB6VL                      WBB6VL
     I              OMA1AA                      WBA1AA
     I              OMFZSX                      WBFZSX
     I              OMF0SX                      WBF0SX
     I              OMF1SX                      WBF1SX
     I              OMF2SX                      WBF2SX
     I              OMF3SX                      WBF3SX
     I              OMF4SX                      WBF4SX
     I              OMF5SX                      WBF5SX
     I              OMF6SX                      WBF6SX
     I              OMF7SX                      WBF7SX
     I              OMNTDT                      WBNTDT
     I              OMNUDT                      WBNUDT
     I              OMNVDT                      WBNVDT
     I              OMNWDT                      WBNWDT
     I              OMNXDT                      WBNXDT
     I              OMBUTM                      WBBUTM
     I              OMBVTM                      WBBVTM
     I              OMBWTM                      WBBWTM
     I              OMBXTM                      WBBXTM
     I              OMBYTM                      WBBYTM
     I              OMH5NX                      WBH5NX
     I              OMH6NX                      WBH6NX
     I              OMH7NX                      WBH7NX
     I              OMH8NX                      WBH8NX
     I              OMH9NX                      WBH9NX
     I              OMDVPR                      WBDVPR
     I              OMDWPR                      WBDWPR
     I              OMDXPR                      WBDXPR
     I              OMDYPR                      WBDYPR
     I              OMDZPR                      WBDZPR
     I              OMGSPR                      WBGSPR
     I              OMGTPR                      WBGTPR
     I              OMGUPR                      WBGUPR
     I              OMHOST                      WBHOST
     I              OMHPST                      WBHPST
     I              OMIOST                      WBIOST
     I              OMPEWG                      WBPEWG
     I              OMRINY                      WBRINY
     I              OMTIDT                      WBTIDT
     I              OMTJDT                      WBTJDT
     I              OMH2ST                      WBH2ST
     I              OMH0ST                      WBH0ST
     I              OMH1ST                      WBH1ST
     I              OMTKDT                      WBTKDT
     I              OMTLDT                      WBTLDT
     I              OMTMDT                      WBTMDT
     I              OMUVST                      WBUVST
     I              OMUWST                      WBUWST
     I              OMUXST                      WBUXST
     I              OMAATM                      WBAATM
     I              OMAYNA                      WBAYNA
     I              OMA0NA                      WBA0NA
     I              OMAXDT                      WBAXDT
      *
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
     C     P1AIC3        PARM                    WP0001                         Company Number
     C     P1C4NB        PARM                    WP0002                         Order Number
     C     P1DPNB        PARM                    WP0003                         Order Sequence
     C     P1UENB        PARM                    WP0004                         Order Secondary
     C     P1EXDT        PARM                    WP0005                         Market Pricing
     C     P1LQCD        PARM                    WP0006                         Commodity Marke
     C     P1RDCD        PARM                    WP0007                         Date Method Cod
     C     P1Q7CD        PARM                    WP0008                         Price Method Co
     C     P1BZPR        PARM                    WP0009                         Price Overage O
     C     P1D0WG        PARM                    WP0010                         Weight Ordered
     C     P1ALPR        PARM                    WP0011                         Unit Price_Cred
     C     P1DWPR        PARM                    WP0012                         OD Ceiling Pric
     C     P1TKDT        PARM                    WP0013                         OD Market Begin
     C     P1TLDT        PARM                    WP0014                         OD Market Endin
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * Upd Block Order Qtemp XF
      * Update Order Detail (OPBGWKP) Record in QTEMP.
      * The following needs to be updated after 'Additional Validations'
      * routine has been called:
      * Market Pricing Date
      * Commodity Market Code
      * Date Method Code
      * Price Method Code
      * Price Overage Override
      * Weight Ordered
      * Unit Price_Credit
      * OD Ceiling Price
      * OD Market Begin Date
      * OD Market Ending Date
      * Upd Block Order Qtemp RT - Order Detail  * 
     C                   EXSR      SARVGN
      *----------------------------------------------------------------
      * Exit program
     C     AAEXIT        TAG
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
      /EJECT
     CSR   SARVGN        BEGSR
      *================================================================
      * Upd Block Order Qtemp RT - Order Detail  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSA         KLIST
     C                   KFLD                    WAAIC3                         Company Number
     C                   KFLD                    WAC4NB                         Order Number
     C                   KFLD                    WADPNB                         Order Sequence
     C                   KFLD                    WAUENB                         Order Secondary
      * Setup key
     C                   Z-ADD     P1AIC3        WAAIC3                         Company Number
     C                   Z-ADD     P1C4NB        WAC4NB                         Order Number
     C                   Z-ADD     P1DPNB        WADPNB                         Order Sequence
     C                   Z-ADD     P1UENB        WAUENB                         Order Secondary
      * Establish starting position
     C     KRSSA         CHAIN     @BGWKL1                            90        *
      * Data record not found
     C   90              MOVEL     'USR1309'     W0RTN
      * USER: Process Data record
      * Chg Block Order Qtemp CH - Order Detail  * 
     C                   IF        NOT *IN90
     C                   EXSR      SBCHRC
     C                   ENDIF
      *================================================================
     CSR   SAEXIT        ENDSR
      /EJECT
     CSR   SBCHRC        BEGSR
      *================================================================
      * Chg Block Order Qtemp CH - Order Detail  * 
      *================================================================
      *
     C                   Z-ADD     *ZERO         WN0001                         Item Code
     C                   EVAL      WN0002 = ' '                                 Warehouse Code
     C                   Z-ADD     *ZERO         WN0003                         Ship To Custome
     C                   Z-ADD     *ZERO         WN0004                         Order Group Cod
     C                   EVAL      WN0005 = ' '                                 Detail Line Sta
     C                   EVAL      WN0006 = ' '                                 Detail Line Sta
     C                   Z-ADD     *ZERO         WN0007                         Billing Detail
     C                   Z-ADD     *ZERO         WN0008                         Billing Detail
     C                   Z-ADD     *ZERO         WN0009                         Billing Detail
     C                   Z-ADD     *ZERO         WN0010                         Quantity to Sub
     C                   EVAL      WN0011 = ' '                                 Comment Print A
     C                   EVAL      WN0012 = ' '                                 Comment Print I
     C                   EVAL      WN0013 = ' '                                 Comment Print P
     C                   EVAL      WN0014 = ' '                                 Comment Print S
     C                   Z-ADD     *ZERO         WN0015                         Extended Amount
     C                   Z-ADD     *ZERO         WN0016                         Contract Number
     C                   EVAL      WN0017 = ' '                                 Price Status
     C                   Z-ADD     *ZERO         WN0018                         Pricing Date Us
     C                   EVAL      WN0019 = ' '                                 U_M_Base Price
     C                   EVAL      WN0020 = ' '                                 U_M_Ordered
     C                   EVAL      WN0021 = ' '                                 Work Confirm St
     C                   EVAL      WN0022 = ' '                                 Work Over_Short
     C                   EVAL      WN0023 = ' '                                 OD Production P
     C                   EVAL      WN0024 = ' '                                 Order Desc_Line
     C                   EVAL      WN0025 = ' '                                 Order Desc_Line
     C                   EVAL      WN0026 = ' '                                 Age Code
     C                   EVAL      WN0027 = ' '                                 Palletize
     C                   EVAL      WN0028 = ' '                                 Slip Sheet
     C                   EVAL      WN0029 = ' '                                 Catch Weight St
     C                   EVAL      WN0030 = ' '                                 Price Audit
     C                   EVAL      WN0031 = ' '                                 Price Audit Rea
     C                   EVAL      WN0032 = ' '                                 Production Date
     C                   Z-ADD     *ZERO         WN0033                         Rated Freight
     C                   Z-ADD     *ZERO         WN0034                         Quantity Ordere
     C                   Z-ADD     *ZERO         WN0035                         Quantity Schedu
     C                   Z-ADD     *ZERO         WN0036                         Weight Schedule
     C                   Z-ADD     *ZERO         WN0037                         Quantity Shippe
     C                   Z-ADD     *ZERO         WN0038                         Weight Shipped
     C                   Z-ADD     *ZERO         WN0039                         Unit Cost Prici
     C                   Z-ADD     *ZERO         WN0040                         Unit Cost Per P
     C                   Z-ADD     *ZERO         WN0041                         Unit Price
     C                   Z-ADD     *ZERO         WN0042                         Unit Price Orde
     C                   Z-ADD     *ZERO         WN0043                         Unit Weight Ord
     C                   Z-ADD     *ZERO         WN0044                         Tare Weight Tot
     C                   Z-ADD     *ZERO         WN0045                         Requested Ship
     C                   Z-ADD     *ZERO         WN0046                         Scheduled Ship
     C                   Z-ADD     *ZERO         WN0047                         Actual Shipped
     C                   EVAL      WN0048 = ' '                                 Affect Inventor
     C                   EVAL      WN0049 = ' '                                 Affect Sales Do
     C                   EVAL      WN0050 = ' '                                 Affect Sales Pn
     C                   Z-ADD     *ZERO         WN0051                         Item Structure
     C                   Z-ADD     *ZERO         WN0052                         Item Structure
     C                   Z-ADD     *ZERO         WN0053                         Item Structure
     C                   EVAL      WN0054 = ' '                                 Item Level
     C                   EVAL      WN0055 = ' '                                 Quality Level
     C                   EVAL      WN0056 = ' '                                 Pricing Product
     C                   EVAL      WN0057 = ' '                                 Season Product
     C                   Z-ADD     *ZERO         WN0058                         Date of Origina
     C                   EVAL      WN0059 = ' '                                 User Profile Na
     C                   EVAL      WN0060 = ' '                                 Country Code
     C                   EVAL      WN0061 = ' '                                 Event Code
     C                   EVAL      WN0062 = ' '                                 Reason Code
     C                   EVAL      WN0063 = ' '                                 Sales Route Cod
     C                   EVAL      WN0064 = ' '                                 Modified Flag
     C                   EVAL      WN0065 = ' '                                 Substituted Fla
     C                   EVAL      WN0066 = ' '                                 OD Schedule Ove
     C                   Z-ADD     *ZERO         WN0067                         Invoice Unit Pr
     C                   Z-ADD     *ZERO         WN0068                         Invoice Extende
     C                   Z-ADD     *ZERO         WN0069                         Ham Group Numbe
     C                   EVAL      WN0070 = ' '                                 OD Adj Type Ove
     C                   EVAL      WN0071 = ' '                                 Affect Trade Fu
     C                   EVAL      WN0072 = ' '                                 Affect Commissi
     C                   EVAL      WN0073 = ' '                                 Affect Pricing
     C                   EVAL      WN0074 = ' '                                 Released by Use
     C                   EVAL      WN0075 = ' '                                 Ord TF Exempt C
     C                   EVAL      WN0076 = ' '                                 OD Pallet Type
     C                   EVAL      WN0077 = ' '                                 Production Ware
     C                   EVAL      WN0078 = ' '                                 OD Price Type
     C                   Z-ADD     *ZERO         WN0079                         Warehouse Palle
     C                   Z-ADD     *ZERO         WN0080                         Consumed Item C
     C                   Z-ADD     *ZERO         WN0081                         Deadline Depart
     C                   Z-ADD     *ZERO         WN0082                         OD Price Type R
     C                   Z-ADD     *ZERO         WN0083                         OD Firm Date
     C                   Z-ADD     *ZERO         WN0084                         Deadline Depart
     C                   Z-ADD     *ZERO         WN0085                         Price Code
     C                   Z-ADD     *ZERO         WN0086                         Maximum Net Wei
     C                   Z-ADD     *ZERO         WN0087                         Substitution Li
     C                   Z-ADD     *ZERO         WN0088                         Max Qty to sche
     C                   Z-ADD     *ZERO         WN0089                         Warehouse Palle
     C                   Z-ADD     *ZERO         WN0090                         Warehouse Avg P
     C                   Z-ADD     *ZERO         WN0091                         OD Item Target
     C                   Z-ADD     *ZERO         WN0092                         OD Estimated Gr
     C                   Z-ADD     *ZERO         WN0093                         OD Maximum Unit
     C                   Z-ADD     *ZERO         WN0094                         Order Gate_Fina
     C                   Z-ADD     *ZERO         WN0095                         OD Gate_Final P
     C                   Z-ADD     *ZERO         WN0096                         OD Weighted Avg
     C                   Z-ADD     *ZERO         WN0097                         OD Original Ord
     C                   Z-ADD     *ZERO         WN0098                         OD Cancel Date
     C                   Z-ADD     *ZERO         WN0099                         OD Unused Prc 7
     C                   Z-ADD     *ZERO         WN0100                         OD Unused Prc 8
     C                   EVAL      WN0101 = ' '                                 OD MPR Sent to
     C                   EVAL      WN0102 = ' '                                 OD MPR Prc Read
     C                   EVAL      WN0103 = ' '                                 OD UnUsed Price
     C                   Z-ADD     *ZERO         WN0104                         Weight Amount E
     C                   Z-ADD     *ZERO         WN0105                         Item Age Days
     C                   Z-ADD     *ZERO         WN0106                         Production Ovr
     C                   Z-ADD     *ZERO         WN0107                         Production Ovr
     C                   EVAL      WN0108 = ' '                                 OD Spot Buy
     C                   EVAL      WN0109 = ' '                                 OD Clm Full Ret
     C                   EVAL      WN0110 = ' '                                 Order Line Erro
     C                   Z-ADD     *ZERO         WN0111                         OD Atch to Ord
     C                   EVAL      WN0112 = ' '                                 EDI Status 1
     C                   EVAL      WN0113 = ' '                                 EDI Status 2
     C                   EVAL      WN0114 = ' '                                 EDI Status 3
     C                   Z-ADD     *ZERO         WN0115                         Job Time
     C                   EVAL      WN0116 = ' '                                 User Id
     C                   EVAL      WN0117 = ' '                                 Job Name
     C                   Z-ADD     *ZERO         WN0118                         Job Date
      *
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YARDC = ' '
      *
      * Move key fields to @BGWKL0
     C                   Z-ADD     WAAIC3        WBAIC3                         Company Number
     C                   Z-ADD     WAC4NB        WBC4NB                         Order Number
     C                   Z-ADD     WADPNB        WBDPNB                         Order Sequence
     C                   Z-ADD     WAUENB        WBUENB                         Order Secondary
      *
     C     KLCHSB        KLIST
     C                   KFLD                    WBAIC3                         Company Number
     C                   KFLD                    WBC4NB                         Order Number
     C                   KFLD                    WBDPNB                         Order Sequence
     C                   KFLD                    WBUENB                         Order Secondary
     C     KLCHSB        CHAIN     @BGWKL0                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'OPBGWKL0'    MDACP
     C                   MOVEL     '@BGWKL0'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL001.
     C                   MOVEL     'LBL001'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      SBEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      SBEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QOPBG1        YARDCS
      * Move non-key fields to @BGWKL0
     C                   Z-ADD     P1EXDT        WBEXDT                         Market Pricing
     C                   MOVEL(P)  P1LQCD        WBLQCD                         Commodity Marke
     C                   MOVEL(P)  P1RDCD        WBRDCD                         Date Method Cod
     C                   MOVEL(P)  P1Q7CD        WBQ7CD                         Price Method Co
     C                   Z-ADD     P1BZPR        WBBZPR                         Price Overage O
     C                   Z-ADD     P1D0WG        WBD0WG                         Weight Ordered
     C                   Z-ADD     P1ALPR        WBALPR                         Unit Price_Cred
     C                   Z-ADD     WADWPR        WBDWPR                         OD Ceiling Pric
     C                   Z-ADD     WATKDT        WBTKDT                         OD Market Begin
     C                   Z-ADD     WATLDT        WBTLDT                         OD Market Endin
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QOPBG1 <> YARDCS AND
     C                             YARDC <> 'N'
     C                   MOVE      'Y'           YARDC
     C                   ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp 2 IF
     C                   Z-ADD     ##JTM         WBAATM                         Job Time
     C                   MOVEL     ##USR         WBAYNA                         User Id
     C                   MOVEL     ##PGM         WBA0NA                         Job Name
     C                   Z-ADD     ##JDT         WBAXDT                         Job Date
     C                   MOVEL     @CN(001)      WBAJVN                         User Profile Na
     C                   MOVEL     @CN(001)      WBAYNA                         User Id
     C                   MOVEL     @CN(002)      WBA0NA                         Job Name
      * Calc Gross Weight from tares...    copied from Dsp Gross Wgt func
     C                   EXSR      UASUBR                                       Calc Gross Weig
      * Set PGM.*Record Data Changed flag
     C                   IF        QOPBG1 <> YARDCS AND
     C                             YARDC <> 'N'
     C                   MOVE      'Y'           YARDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YARDC = 'Y'
     C                   UPDATE    @BGWKL0                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    OPBGWKL0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   SBEXIT        ENDSR
      /EJECT
     CSR   UASUBR        BEGSR
      *================================================================
      * Calc Gross Weight from tares...    copied from Dsp Gross Wgt fun
      *================================================================
      * Rtv Tare Weight        XF - Company Item  * 
     C                   CALL      'PBI3XFR'                            90      Rtv Tare Weight
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WBAIC3        WQ0001                         Company Number
     C                   PARM      WBHGCD        WQ0002                         Item Code
     C     YL0001        PARM      YL0001        WQ0003                         Misc Tare Weigh
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PBI3XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * wi464 change
      * RTV Itm BxID & Tares  XF - Item Bill Of Material  * 
     C                   CALL      'PBI4XFR'                            90      RTV Itm BxID &
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WBAIC3        WQ0004                         Company Number
     C                   PARM      WBHGCD        WQ0005                         Item Code
     C     YL0002        PARM      *ZERO         WQ0006                         Box Weight
     C     YL0003        PARM      *ZERO         WQ0007                         Number Cases On
     C     YL0004        PARM      *ZERO         WQ0008                         Pallet Tare Wei
     C     YL0005        PARM      *ZERO         WQ0009                         Box iD
     C                   PARM      WBF5SX        WQ0010                         OD Pallet Type
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PBI4XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C     YL0002        ADD       YL0001        YL0006                         Total Tare USR
      * Box + Misc Tare
      * LCL.Weight 1.1             .U =
      *    *COMPUTE ((x1 + x2) * x3)
      * x1    : LCL.Box Weight
      * +     : PGM.*Synon (15,2) work field
      * x2    : LCL.Misc Tare Weight
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : DB1.Quantity Ordered
     C     YL0002        ADD       YL0001        W0WA01                         *Synon (15,2) w
     C     W0WA01        MULT(H)   WBAVQT        W0WA00                         *Synon (15,2) w
     C                   Z-ADD     W0WA00        YL0007                         Weight 1.1
      * Pallet Tare
      * CASE: DB1.Palletize is yes
      * CASE: LCL.Number Cases On A Pallet is GT Zero
     C                   IF        WBVEST = 'Y'
      * Pallet Weight
      * LCL.Weight 1.2             .U =
      *    *COMPUTE (x1 / x2 * x3)
      * x1    : DB1.Quantity Ordered
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : LCL.Number Cases On A Pallet
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : LCL.Pallet Tare Weight
     C                   IF        YL0003 > 0
     C     WBAVQT        DIV(H)    YL0003        W0WA01                         *Synon (15,2) w
     C     W0WA01        MULT(H)   YL0004        W0WA00                         *Synon (15,2) w
     C                   Z-ADD     W0WA00        YL0008                         Weight 1.2
     C                   ELSE
      * CASE: *OTHERWISE
     C                   Z-ADD     *ZERO         YL0008                         Weight 1.2
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
     C                   Z-ADD     *ZERO         YL0008                         Weight 1.2
     C                   END                                                    *FI
      * Estimated Gross
      * DB1.OD Minimum Unit Weight =
      *    *COMPUTE (x1 + x2 + x3)
      * x1    : DB1.Weight Ordered
      * +     : PGM.*Synon (15,2) work field
      * x2    : LCL.Weight 1.1             .U
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.Weight 1.2             .U
     C     WBD0WG        ADD       YL0007        W0WA01                         *Synon (15,2) w
     C     W0WA01        ADD       YL0008        W0WA00                         *Synon (15,2) w
     C                   Z-ADD     W0WA00        WBH8NX                         OD Estimated Gr
      *================================================================
     CSR   UAEXIT        ENDSR
      /EJECT
     CSR   ZASNMS        BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C                   IF        ZAPGMQ = ' '
     C                   MOVEL     ##PGM         ZAPGMQ
     C                   END
     C                   CALL      'Y2SNMGC'
     C                   PARM                    ZAPGMQ                         Program queue
     C                   PARM                    ZAPGRL                         Rel queue
     C                   PARM                    ZAMSID                         Message ID
     C                   PARM                    ZAMSGF                         Message file
     C                   PARM                    ZAMSDA                         Message data
     C                   PARM                    ZAMSTP                         Message type
     C                   PARM      'Y'           YILE
      * Clear all fields for default mechanism next time
     C                   EVAL      ZAPGMQ = ' '
     C                   EVAL      ZAPGRL = ' '
     C                   EVAL      ZAMSID = ' '
     C                   EVAL      ZAMSGF = ' '
     C                   EVAL      ZAMSDA = ' '
     C                   EVAL      ZAMSTP = ' '
      *================================================================
     CSR   ZAEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      *
      *
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WAAIC3                         Company Number
     C                   Z-ADD     *ZERO         WAC4NB                         Order Number
     C                   Z-ADD     *ZERO         WADPNB                         Order Sequence
     C                   Z-ADD     *ZERO         WAUENB                         Order Secondary
     C                   Z-ADD     *ZERO         WAHGCD                         Item Code
     C                   Z-ADD     *ZERO         WABKC7                         Ship To Custome
     C                   Z-ADD     *ZERO         WACFC7                         Order Group Cod
     C                   Z-ADD     *ZERO         WAMAVA                         Billing Detail
     C                   Z-ADD     *ZERO         WAKDVA                         Billing Detail
     C                   Z-ADD     *ZERO         WAL8VA                         Billing Detail
     C                   Z-ADD     *ZERO         WAL9VA                         Quantity to Sub
     C                   Z-ADD     *ZERO         WAAYVA                         Extended Amount
     C                   Z-ADD     *ZERO         WAEXDT                         Market Pricing
     C                   Z-ADD     *ZERO         WABZPR                         Price Overage O
     C                   Z-ADD     *ZERO         WAL6NB                         Contract Number
     C                   Z-ADD     *ZERO         WAGIDT                         Pricing Date Us
     C                   Z-ADD     *ZERO         WAR1NB                         Rated Freight
     C                   Z-ADD     *ZERO         WAAVQT                         Quantity Ordere
     C                   Z-ADD     *ZERO         WAD0WG                         Weight Ordered
     C                   Z-ADD     *ZERO         WACCQT                         Quantity Schedu
     C                   Z-ADD     *ZERO         WAAUWG                         Weight Schedule
     C                   Z-ADD     *ZERO         WACBQT                         Quantity Shippe
     C                   Z-ADD     *ZERO         WAATWG                         Weight Shipped
     C                   Z-ADD     *ZERO         WAAQCS                         Unit Cost Prici
     C                   Z-ADD     *ZERO         WAAGCS                         Unit Cost Per P
     C                   Z-ADD     *ZERO         WAAKPR                         Unit Price
     C                   Z-ADD     *ZERO         WAALPR                         Unit Price_Cred
     C                   Z-ADD     *ZERO         WAAUPR                         Unit Price Orde
     C                   Z-ADD     *ZERO         WAAVWG                         Unit Weight Ord
     C                   Z-ADD     *ZERO         WAA4WG                         Tare Weight Tot
     C                   Z-ADD     *ZERO         WAA5DT                         Requested Ship
     C                   Z-ADD     *ZERO         WAAODT                         Scheduled Ship
     C                   Z-ADD     *ZERO         WAGNDT                         Actual Shipped
     C                   Z-ADD     *ZERO         WARGNB                         Item Structure
     C                   Z-ADD     *ZERO         WARHNB                         Item Structure
     C                   Z-ADD     *ZERO         WARINB                         Item Structure
     C                   Z-ADD     *ZERO         WACXDT                         Date of Origina
     C                   Z-ADD     *ZERO         WADUPR                         Invoice Unit Pr
     C                   Z-ADD     *ZERO         WAB6VL                         Invoice Extende
     C                   Z-ADD     *ZERO         WAA1AA                         Ham Group Numbe
     C                   Z-ADD     *ZERO         WANTDT                         Warehouse Palle
     C                   Z-ADD     *ZERO         WANUDT                         Consumed Item C
     C                   Z-ADD     *ZERO         WANVDT                         Deadline Depart
     C                   Z-ADD     *ZERO         WANWDT                         OD Price Type R
     C                   Z-ADD     *ZERO         WANXDT                         OD Firm Date
     C                   Z-ADD     *ZERO         WABUTM                         Deadline Depart
     C                   Z-ADD     *ZERO         WABVTM                         Price Code
     C                   Z-ADD     *ZERO         WABWTM                         Maximum Net Wei
     C                   Z-ADD     *ZERO         WABXTM                         Substitution Li
     C                   Z-ADD     *ZERO         WABYTM                         Max Qty to sche
     C                   Z-ADD     *ZERO         WAH5NX                         Warehouse Palle
     C                   Z-ADD     *ZERO         WAH6NX                         Warehouse Avg P
     C                   Z-ADD     *ZERO         WAH7NX                         OD Item Target
     C                   Z-ADD     *ZERO         WAH8NX                         OD Estimated Gr
     C                   Z-ADD     *ZERO         WAH9NX                         OD Maximum Unit
     C                   Z-ADD     *ZERO         WADVPR                         Order Gate_Fina
     C                   Z-ADD     *ZERO         WADWPR                         OD Ceiling Pric
     C                   Z-ADD     *ZERO         WADXPR                         OD Gate_Final P
     C                   Z-ADD     *ZERO         WADYPR                         OD Weighted Avg
     C                   Z-ADD     *ZERO         WADZPR                         OD Original Ord
     C                   Z-ADD     *ZERO         WAGSPR                         OD Cancel Date
     C                   Z-ADD     *ZERO         WAGTPR                         OD Unused Prc 7
     C                   Z-ADD     *ZERO         WAGUPR                         OD Unused Prc 8
     C                   Z-ADD     *ZERO         WAPEWG                         Weight Amount E
     C                   Z-ADD     *ZERO         WARINY                         Item Age Days
     C                   Z-ADD     *ZERO         WATIDT                         Production Ovr
     C                   Z-ADD     *ZERO         WATJDT                         Production Ovr
     C                   Z-ADD     *ZERO         WATKDT                         OD Market Begin
     C                   Z-ADD     *ZERO         WATLDT                         OD Market Endin
     C                   Z-ADD     *ZERO         WATMDT                         OD Atch to Ord
     C                   Z-ADD     *ZERO         WAAATM                         Job Time
     C                   Z-ADD     *ZERO         WAAXDT                         Job Date
      * Define *Synon program work fields
     C                   Z-ADD     *ZEROS        W0WA01                         *Synon (15,2) w
     C                   Z-ADD     *ZEROS        W0WA00                         *Synon (15,2) w
      * Dummy move for compiler
     C                   MOVE      '0'           @CN#(1)
     C                   MOVEL     @CN(1)        @CN(1)
     C                   MOVEL     'N'           W0PMT
      * Define local work field Misc Tare Weight
     C                   Z-ADD     *ZERO         YL0001
      * Define local work field Box Weight
     C                   Z-ADD     *ZERO         YL0002
      * Define local work field Number Cases On A Pallet
     C                   Z-ADD     *ZERO         YL0003
      * Define local work field Pallet Tare Weight
     C                   Z-ADD     *ZERO         YL0004
      * Define local work field Box iD
     C                   Z-ADD     *ZERO         YL0005
      * Define local work field Total Tare USR
     C                   Z-ADD     *ZERO         YL0006
      * Define local work field Weight 1.1             .U
     C                   Z-ADD     *ZERO         YL0007
      * Define local work field Weight 1.2             .U
     C                   Z-ADD     *ZERO         YL0008
      *================================================================
     CSR   ZZEXIT        ENDSR
** @CN
00001 INFORMATIC
00002 AUTOUPLOAD
