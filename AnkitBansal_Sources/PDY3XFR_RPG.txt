     H/TITLE Upd Add Unit Weight    XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by  : SYNON/2  Version:  1035
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model         lopment-
     H* System        : OMS Development Model
     H* User name     : ISMAREN
     H* Date          : 05/09/99  Time  : 10:20:39
     H* Copyright     : OMS Development Model         lopment-
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDI8CPL1IF  E           K        DISK
      * RTV : PS Prod Item Schedule     Retrieval index
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company/Item              Retrieval index       NV
      *
     FPDI8CPL0UF  E           K        DISK
      * UPD : PS Prod Item Schedule     Update index
      *
     I@I8CPUS
      * PS Prod Item Schedule     Retrieval index
      * Renamed input format fields
     I              I8AIC3                          WAAIC3
     I              I8V5ST                          WAV5ST
     I              I8ELDT                          WAELDT
     I              I8HGCD                          WAHGCD
     I              I8AJCD                          WAAJCD
     I              I8GPDT                          WAGPDT
     I              I8WTSP                          WAWTSP
     I              I8QTSP                          WAQTSP
     I              I8DJPC                          WADJPC
     I              I8F8WG                          WAF8WG
     I              I8WTIN                          WAWTIN
     I              I8D5NB                          WAD5NB
     I              I8DXWG                          WADXWG
     I              I8B2NB                          WAB2NB
     I              I8WTCN                          WAWTCN
     I              I8PSCV                          WAPSCV
     I              I8SAWT                          WASAWT
     I              I8B9NB                          WAB9NB
     I              I8D1WG                          WAD1WG
     I              I8CBNB                          WACBNB
     I              I8EZWG                          WAEZWG
     I              I8CCNB                          WACCNB
     I              I8E0WG                          WAE0WG
     I              I8D6NB                          WAD6NB
     I              I8OAWT                          WAOAWT
     I              I8CDNB                          WACDNB
     I              I8UNW2                          WAUNW2
     I              I8CENB                          WACENB
     I              I8F9WG                          WAF9WG
     I              I8BPNB                          WABPNB
     I              I8GAWG                          WAGAWG
     I              I8BQNB                          WABQNB
     I              I8GBWG                          WAGBWG
     I              I8BRNB                          WABRNB
     I              I8GCWG                          WAGCWG
     I              I8BSNB                          WABSNB
     I              I8GDWG                          WAGDWG
     I              I8BWNB                          WABWNB
     I              I8GEWG                          WAGEWG
     I              I8PS6U                          WAPS6U
     I              I8WCST                          WAWCST
     I              I8WPST                          WAWPST
     I              I8B5ST                          WAB5ST
     I              I8TFST                          WATFST
     I              I8TEST                          WATEST
     I              I8THST                          WATHST
     I              I8UDST                          WAUDST
     I              I8UFST                          WAUFST
     I              I8UGST                          WAUGST
     I              I8UHST                          WAUHST
     I              I8B6ST                          WAB6ST
     I              I8B7ST                          WAB7ST
     I              I8DVWG                          WADVWG
     I              I8D7NB                          WAD7NB
     I              I8FCAD                          WAFCAD
     I              I8D9NB                          WAD9NB
     I              I8DWWG                          WADWWG
     I              I8EANB                          WAEANB
     I              I8SHWT                          WASHWT
     I              I8EBNB                          WAEBNB
     I              I8AVWT                          WAAVWT
     I              I8ECNB                          WAECNB
     I              I8WTON                          WAWTON
     I              I8EDNB                          WAEDNB
     I              I8FNWT                          WAFNWT
     I              I8EENB                          WAEENB
     I              I8QTAS                          WAQTAS
     I              I8EFNB                          WAEFNB
     I              I8WAIO                          WAWAIO
     I              I8EGNB                          WAEGNB
     I              I8R3CD                          WAR3CD
     I              I8RGNB                          WARGNB
     I              I8RHNB                          WARHNB
     I              I8RINB                          WARINB
     I              I8XRCD                          WAXRCD
     I              I8UVST                          WAUVST
     I              I8UWST                          WAUWST
     I              I8UXST                          WAUXST
     I              I8VSST                          WAVSST
     I              I8AATM                          WAAATM
     I              I8AYNA                          WAAYNA
     I              I8A0NA                          WAA0NA
     I              I8AXDT                          WAAXDT
      *
     I@BZREJU
      * Company/Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WBAIC3
     I              BZHGCD                          WBHGCD
     I              BZAVNA                          WBAVNA
     I              BZAWNA                          WBAWNA
     I              BZL7NA                          WBL7NA
     I              BZL8NA                          WBL8NA
     I              BZL6NA                          WBL6NA
     I              BZMFNA                          WBMFNA
     I              BZADCD                          WBADCD
     I              BZAWPC                          WBAWPC
     I              BZLXST                          WBLXST
     I              BZAECD                          WBAECD
     I              BZAXPC                          WBAXPC
     I              BZLYST                          WBLYST
     I              BZAFCD                          WBAFCD
     I              BZAICD                          WBAICD
     I              BZAIWG                          WBAIWG
     I              BZHICD                          WBHICD
     I              BZRBCD                          WBRBCD
     I              BZFZST                          WBFZST
     I              BZAVST                          WBAVST
     I              BZCZWG                          WBCZWG
     I              BZC0WG                          WBC0WG
     I              BZURTN                          WBURTN
     I              BZAJC8                          WBAJC8
     I              BZRINB                          WBRINB
     I              BZRHNB                          WBRHNB
     I              BZRGNB                          WBRGNB
     I              BZLNCD                          WBLNCD
     I              BZTFNB                          WBTFNB
     I              BZN0CD                          WBN0CD
     I              BZX4ST                          WBX4ST
     I              BZTMVA                          WBTMVA
     I              BZTNVA                          WBTNVA
     I              BZBLPR                          WBBLPR
     I              BZBMPR                          WBBMPR
     I              BZLRCD                          WBLRCD
     I              BZU9ST                          WBU9ST
     I              BZCMCO                          WBCMCO
     I              BZQ1CD                          WBQ1CD
     I              BZQ8CD                          WBQ8CD
     I              BZCHTM                          WBCHTM
     I              BZQZCD                          WBQZCD
     I              BZXWST                          WBXWST
     I              BZXXST                          WBXXST
     I              BZVMST                          WBVMST
     I              BZSWGH                          WBSWGH
     I              BZPPHE                          WBPPHE
     I              BZR3CD                          WBR3CD
     I              BZSDCD                          WBSDCD
     I              BZICN1                          WBICN1
     I              BZSVCD                          WBSVCD
     I              BZICN2                          WBICN2
     I              BZSWCD                          WBSWCD
     I              BZV2NB                          WBV2NB
     I              BZSXCD                          WBSXCD
     I              BZITCN                          WBITCN
     I              BZSYCD                          WBSYCD
     I              BZITC5                          WBITC5
     I              BZSZCD                          WBSZCD
     I              BZICN6                          WBICN6
     I              BZS0CD                          WBS0CD
     I              BZICN7                          WBICN7
     I              BZS1CD                          WBS1CD
     I              BZICN8                          WBICN8
     I              BZS2CD                          WBS2CD
     I              BZICN9                          WBICN9
     I              BZS3CD                          WBS3CD
     I              BZICN0                          WBICN0
     I              BZS4CD                          WBS4CD
     I              BZSFNB                          WBSFNB
     I              BZA3WG                          WBA3WG
     I              BZSJNB                          WBSJNB
     I              BZLLCD                          WBLLCD
     I              BZLMCD                          WBLMCD
     I              BZP3ST                          WBP3ST
     I              BZSKNB                          WBSKNB
     I              BZSLNB                          WBSLNB
     I              BZSMNB                          WBSMNB
     I              BZP4ST                          WBP4ST
     I              BZCFNB                          WBCFNB
     I              BZCGNB                          WBCGNB
     I              BZILNB                          WBILNB
     I              BZCHNB                          WBCHNB
     I              BZCINB                          WBCINB
     I              BZCJNB                          WBCJNB
     I              BZCMNB                          WBCMNB
     I              BZCNNB                          WBCNNB
     I              BZCRNB                          WBCRNB
     I              BZCSNB                          WBCSNB
     I              BZCVNB                          WBCVNB
     I              BZCWNB                          WBCWNB
     I              BZCXNB                          WBCXNB
     I              BZCZNB                          WBCZNB
     I              BZC0NB                          WBC0NB
     I              BZN1CD                          WBN1CD
     I              BZB4NB                          WBB4NB
     I              BZB5NB                          WBB5NB
     I              BZX5ST                          WBX5ST
     I              BZX6ST                          WBX6ST
     I              BZX7ST                          WBX7ST
     I              BZPCCT                          WBPCCT
     I              BZBDNB                          WBBDNB
     I              BZBJNB                          WBBJNB
     I              BZSUST                          WBSUST
     I              BZSVST                          WBSVST
     I              BZSYST                          WBSYST
     I              BZSZST                          WBSZST
     I              BZS1ST                          WBS1ST
     I              BZXRCD                          WBXRCD
     I              BZXTCD                          WBXTCD
     I              BZXUCD                          WBXUCD
     I              BZF5WG                          WBF5WG
     I              BZF6WG                          WBF6WG
     I              BZF7WG                          WBF7WG
     I              BZBLNB                          WBBLNB
     I              BZBNNB                          WBBNNB
     I              BZS2ST                          WBS2ST
     I              BZS4ST                          WBS4ST
     I              BZS5ST                          WBS5ST
     I              BZS6ST                          WBS6ST
     I              BZS8ST                          WBS8ST
     I              BZS9ST                          WBS9ST
     I              BZTCST                          WBTCST
     I              BZTDST                          WBTDST
     I              BZUVST                          WBUVST
     I              BZUWST                          WBUWST
     I              BZUXST                          WBUXST
     I              BZVSST                          WBVSST
     I              BZAATM                          WBAATM
     I              BZAYNA                          WBAYNA
     I              BZA0NA                          WBA0NA
     I              BZAXDT                          WBAXDT
      *
     I@I8CPUR
      * PS Prod Item Schedule     Update index
      * Renamed input format fields
     I              I8AIC3                          WCAIC3
     I              I8V5ST                          WCV5ST
     I              I8ELDT                          WCELDT
     I              I8HGCD                          WCHGCD
     I              I8AJCD                          WCAJCD
     I              I8GPDT                          WCGPDT
     I              I8WTSP                          WCWTSP
     I              I8QTSP                          WCQTSP
     I              I8DJPC                          WCDJPC
     I              I8F8WG                          WCF8WG
     I              I8WTIN                          WCWTIN
     I              I8D5NB                          WCD5NB
     I              I8DXWG                          WCDXWG
     I              I8B2NB                          WCB2NB
     I              I8WTCN                          WCWTCN
     I              I8PSCV                          WCPSCV
     I              I8SAWT                          WCSAWT
     I              I8B9NB                          WCB9NB
     I              I8D1WG                          WCD1WG
     I              I8CBNB                          WCCBNB
     I              I8EZWG                          WCEZWG
     I              I8CCNB                          WCCCNB
     I              I8E0WG                          WCE0WG
     I              I8D6NB                          WCD6NB
     I              I8OAWT                          WCOAWT
     I              I8CDNB                          WCCDNB
     I              I8UNW2                          WCUNW2
     I              I8CENB                          WCCENB
     I              I8F9WG                          WCF9WG
     I              I8BPNB                          WCBPNB
     I              I8GAWG                          WCGAWG
     I              I8BQNB                          WCBQNB
     I              I8GBWG                          WCGBWG
     I              I8BRNB                          WCBRNB
     I              I8GCWG                          WCGCWG
     I              I8BSNB                          WCBSNB
     I              I8GDWG                          WCGDWG
     I              I8BWNB                          WCBWNB
     I              I8GEWG                          WCGEWG
     I              I8PS6U                          WCPS6U
     I              I8WCST                          WCWCST
     I              I8WPST                          WCWPST
     I              I8B5ST                          WCB5ST
     I              I8TFST                          WCTFST
     I              I8TEST                          WCTEST
     I              I8THST                          WCTHST
     I              I8UDST                          WCUDST
     I              I8UFST                          WCUFST
     I              I8UGST                          WCUGST
     I              I8UHST                          WCUHST
     I              I8B6ST                          WCB6ST
     I              I8B7ST                          WCB7ST
     I              I8DVWG                          WCDVWG
     I              I8D7NB                          WCD7NB
     I              I8FCAD                          WCFCAD
     I              I8D9NB                          WCD9NB
     I              I8DWWG                          WCDWWG
     I              I8EANB                          WCEANB
     I              I8SHWT                          WCSHWT
     I              I8EBNB                          WCEBNB
     I              I8AVWT                          WCAVWT
     I              I8ECNB                          WCECNB
     I              I8WTON                          WCWTON
     I              I8EDNB                          WCEDNB
     I              I8FNWT                          WCFNWT
     I              I8EENB                          WCEENB
     I              I8QTAS                          WCQTAS
     I              I8EFNB                          WCEFNB
     I              I8WAIO                          WCWAIO
     I              I8EGNB                          WCEGNB
     I              I8R3CD                          WCR3CD
     I              I8RGNB                          WCRGNB
     I              I8RHNB                          WCRHNB
     I              I8RINB                          WCRINB
     I              I8XRCD                          WCXRCD
     I              I8UVST                          WCUVST
     I              I8UWST                          WCUWST
     I              I8UXST                          WCUXST
     I              I8VSST                          WCVSST
     I              I8AATM                          WCAATM
     I              I8AYNA                          WCAYNA
     I              I8A0NA                          WCA0NA
     I              I8AXDT                          WCAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPDI81    E DSPDI8CPL0
      * UPD : PS Prod Item Schedule     Update index
      * Renamed input format fields
     I              I8AIC3                          WCAIC3
     I              I8V5ST                          WCV5ST
     I              I8ELDT                          WCELDT
     I              I8HGCD                          WCHGCD
     I              I8AJCD                          WCAJCD
     I              I8GPDT                          WCGPDT
     I              I8WTSP                          WCWTSP
     I              I8QTSP                          WCQTSP
     I              I8DJPC                          WCDJPC
     I              I8F8WG                          WCF8WG
     I              I8WTIN                          WCWTIN
     I              I8D5NB                          WCD5NB
     I              I8DXWG                          WCDXWG
     I              I8B2NB                          WCB2NB
     I              I8WTCN                          WCWTCN
     I              I8PSCV                          WCPSCV
     I              I8SAWT                          WCSAWT
     I              I8B9NB                          WCB9NB
     I              I8D1WG                          WCD1WG
     I              I8CBNB                          WCCBNB
     I              I8EZWG                          WCEZWG
     I              I8CCNB                          WCCCNB
     I              I8E0WG                          WCE0WG
     I              I8D6NB                          WCD6NB
     I              I8OAWT                          WCOAWT
     I              I8CDNB                          WCCDNB
     I              I8UNW2                          WCUNW2
     I              I8CENB                          WCCENB
     I              I8F9WG                          WCF9WG
     I              I8BPNB                          WCBPNB
     I              I8GAWG                          WCGAWG
     I              I8BQNB                          WCBQNB
     I              I8GBWG                          WCGBWG
     I              I8BRNB                          WCBRNB
     I              I8GCWG                          WCGCWG
     I              I8BSNB                          WCBSNB
     I              I8GDWG                          WCGDWG
     I              I8BWNB                          WCBWNB
     I              I8GEWG                          WCGEWG
     I              I8PS6U                          WCPS6U
     I              I8WCST                          WCWCST
     I              I8WPST                          WCWPST
     I              I8B5ST                          WCB5ST
     I              I8TFST                          WCTFST
     I              I8TEST                          WCTEST
     I              I8THST                          WCTHST
     I              I8UDST                          WCUDST
     I              I8UFST                          WCUFST
     I              I8UGST                          WCUGST
     I              I8UHST                          WCUHST
     I              I8B6ST                          WCB6ST
     I              I8B7ST                          WCB7ST
     I              I8DVWG                          WCDVWG
     I              I8D7NB                          WCD7NB
     I              I8FCAD                          WCFCAD
     I              I8D9NB                          WCD9NB
     I              I8DWWG                          WCDWWG
     I              I8EANB                          WCEANB
     I              I8SHWT                          WCSHWT
     I              I8EBNB                          WCEBNB
     I              I8AVWT                          WCAVWT
     I              I8ECNB                          WCECNB
     I              I8WTON                          WCWTON
     I              I8EDNB                          WCEDNB
     I              I8FNWT                          WCFNWT
     I              I8EENB                          WCEENB
     I              I8QTAS                          WCQTAS
     I              I8EFNB                          WCEFNB
     I              I8WAIO                          WCWAIO
     I              I8EGNB                          WCEGNB
     I              I8R3CD                          WCR3CD
     I              I8RGNB                          WCRGNB
     I              I8RHNB                          WCRHNB
     I              I8RINB                          WCRINB
     I              I8XRCD                          WCXRCD
     I              I8UVST                          WCUVST
     I              I8UWST                          WCUWST
     I              I8UXST                          WCUXST
     I              I8VSST                          WCVSST
     I              I8AATM                          WCAATM
     I              I8AYNA                          WCAYNA
     I              I8A0NA                          WCA0NA
     I              I8AXDT                          WCAXDT
      *
     IYARDCS      DS                            326
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: PS Prod Item Schedule
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Production Type
     I                                        3   3 P1V5ST
      * I :  Production Date
     I                                    P   4   70P1ELDT
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1V5ST    PARM           WP0002  1        Production Type
     C           P1ELDT    PARM           WP0003  70       Production Date
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Upd Add Unit Weight    XF
      * Upd Add Unit Weight    RT - PS Prod Item Schedule  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Upd Add Unit Weight    RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001 112       PS Unit Weight
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
     C           *LIKE     DEFN WAV5ST    WQSA02           Production Type
     C           *LIKE     DEFN WAELDT    WQSA03           Production Date
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           WQSA02           Production Type
     C                     KFLD           WQSA03           Production Date
      * Setup key
     C                     Z-ADDP1AIC3    WQSA01           Company Number
     C                     MOVELP1V5ST    WQSA02           Production Type
     C                     Z-ADDP1ELDT    WQSA03           Production Date
      * Establish starting position
     C           KRSSA     SETLL@I8CPUS                    *
     C           KRSSA     READE@I8CPUS                  90*
      * Data record not found
     C   90                MOVEL'USR1763' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV CtchWgt & Unit Wgt RT - Company/Item  * 
     C                     EXSR SBRVGN
      * Chg PS Unit Weight     CH - PS Prod Item Schedule  * 
     C                     EXSR SCCHRC
     C           KRSSA     READE@I8CPUS                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV CtchWgt & Unit Wgt RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBHGCD           Item Code
      * Setup key
     C                     Z-ADDWAAIC3    WBAIC3           Company Number
     C                     Z-ADDWAHGCD    WBHGCD           Item Code
      * Establish starting position
     C           KRSSB     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWBAICD    WUAICD           U/M - Pricing
     C                     Z-ADDWBAIWG    WN0001           Unit Weight
     C                     MOVELWBAVST    WUAVST           Catch Weight St
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCHRC    BEGSR
      *================================================================
      * Chg PS Unit Weight     CH - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0002  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0003  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0004  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0005  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0006  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0007  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0008  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0009  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0010  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0011  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0012  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0013  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0014  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0015  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0016  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0017  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0018  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0019  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0020  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0021  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0022  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0023  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0024  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0025  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0026 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0027  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0028 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0029  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0030 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0031  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0032 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0033  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0034 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0035  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0036  3        PS Item Id
     C                     MOVEL*BLANK    WN0037  2        Warehouse Type
     C                     MOVEL*BLANK    WN0038  1        PS Lock Status
     C                     MOVEL*BLANK    WN0039  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0040  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0041  1        PS Piece Count
     C                     MOVEL*BLANK    WN0042  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0043  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0044  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0045  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0046  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0047  3        PS Unused Sts 6
     C                     Z-ADD*ZERO     WN0048  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0049  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0050  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0051  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0052  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0053  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0054  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0055  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0056  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0057  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0058  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0059  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0060  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0061  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0062  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0063  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0064  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0065  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0066  6        Department Code
     C                     Z-ADD*ZERO     WN0067  30       Item Structure
     C                     Z-ADD*ZERO     WN0068  30       Item Structure
     C                     Z-ADD*ZERO     WN0069  30       Item Structure
     C                     MOVEL*BLANK    WN0070  6        Primal Group Co
     C                     MOVEL*BLANK    WN0071  1        EDI Status 1
     C                     MOVEL*BLANK    WN0072  1        EDI Status 2
     C                     MOVEL*BLANK    WN0073  1        EDI Status 3
     C                     MOVEL*BLANK    WN0074  1        Record Status
     C                     Z-ADD*ZERO     WN0075  60       Job Time
     C                     MOVEL*BLANK    WN0076 10        User Id
     C                     MOVEL*BLANK    WN0077 10        Job Name
     C                     Z-ADD*ZERO     WN0078  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @I8CPUR
     C                     Z-ADDWAAIC3    WCAIC3           Company Number
     C                     MOVELWAV5ST    WCV5ST           Production Type
     C                     Z-ADDWAELDT    WCELDT           Production Date
     C                     Z-ADDWAHGCD    WCHGCD           Item Code
     C                     MOVELWAAJCD    WCAJCD           Warehouse Code
      *
     C           KLCHSC    KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCV5ST           Production Type
     C                     KFLD           WCELDT           Production Date
     C                     KFLD           WCHGCD           Item Code
     C                     KFLD           WCAJCD           Warehouse Code
     C           KLCHSC    CHAIN@I8CPUR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI8CPL0'MDACP
     C                     MOVEL'@I8CPUR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDI81    YARDCS
      * Move non-key fields to @I8CPUR
     C                     Z-ADDWN0001    WCF9WG           PS Unit Weight
      *
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@I8CPUR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDI8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Setup job date/time
      *
     C                     Z-ADDUDATE     ##JDT
      * Set century digit (If YY prior to 1940 treat as 20YY)
     C           ##JYY     IFLT 40
     C                     Z-ADD1         ##JCC
     C                     ELSE
     C                     Z-ADD0         ##JCC
     C                     END
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3  30       Company Number
     C                     Z-ADD*ZERO     WAELDT  70       Production Date
     C                     Z-ADD*ZERO     WAHGCD  70       Item Code
     C                     Z-ADD*ZERO     WAGPDT  70       PS Available Sh
     C                     Z-ADD*ZERO     WAWTSP  92       PS Weight Plann
     C                     Z-ADD*ZERO     WAQTSP  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WADJPC  72       PS % of Carcass
     C                     Z-ADD*ZERO     WAF8WG  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WAWTIN  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WAD5NB  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WADXWG  92       PS Weight Stand
     C                     Z-ADD*ZERO     WAB2NB  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WAWTCN  92       PS Weight Conve
     C                     Z-ADD*ZERO     WAPSCV  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WASAWT  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WAB9NB  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WAD1WG  92       PS Weight Prod
     C                     Z-ADD*ZERO     WACBNB  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WAEZWG  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WACCNB  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WAE0WG  92       PS Weight Ship
     C                     Z-ADD*ZERO     WAD6NB  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WAOAWT  92       PS Weight Prod
     C                     Z-ADD*ZERO     WACDNB  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WAUNW2  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WACENB  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WAF9WG 112       PS Unit Weight
     C                     Z-ADD*ZERO     WABPNB  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WAGAWG 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WABQNB  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WAGBWG 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WABRNB  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WAGCWG 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WABSNB  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WAGDWG 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WABWNB  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WAGEWG 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WAPS6U  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WADVWG  92       PS Weight Order
     C                     Z-ADD*ZERO     WAD7NB  70       PS Pieces Order
     C                     Z-ADD*ZERO     WAFCAD  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WAD9NB  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WADWWG  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WAEANB  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WASHWT  92       PS Weight Sched
     C                     Z-ADD*ZERO     WAEBNB  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WAAVWT  92       PS Weight Avail
     C                     Z-ADD*ZERO     WAECNB  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WAWTON  92       PS Weight Produ
     C                     Z-ADD*ZERO     WAEDNB  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WAFNWT  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WAEENB  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WAQTAS  92       PS Weight Sched
     C                     Z-ADD*ZERO     WAEFNB  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WAWAIO  92       PS Weight Sched
     C                     Z-ADD*ZERO     WAEGNB  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WARGNB  30       Item Structure
     C                     Z-ADD*ZERO     WARHNB  30       Item Structure
     C                     Z-ADD*ZERO     WARINB  30       Item Structure
     C                     Z-ADD*ZERO     WAAATM  60       Job Time
     C                     Z-ADD*ZERO     WAAXDT  70       Job Date
      * Define work field U/M - Pricing
     C                     MOVEL*BLANK    WUAICD  2
      * Define work field Catch Weight Status
     C                     MOVEL*BLANK    WUAVST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3  30       Company Number
     C                     Z-ADD*ZERO     WBHGCD  70       Item Code
     C                     Z-ADD*ZERO     WBAWPC  94       Conversion Fact
     C                     Z-ADD*ZERO     WBAXPC  94       Conversion Fact
     C                     Z-ADD*ZERO     WBAIWG 112       Unit Weight
     C                     Z-ADD*ZERO     WBCZWG 112       Minimum Weight
     C                     Z-ADD*ZERO     WBC0WG 112       Maximum Weight
     C                     Z-ADD*ZERO     WBURTN  50       Number Cases On
     C                     Z-ADD*ZERO     WBAJC8  80       Vendor - Item D
     C                     Z-ADD*ZERO     WBRINB  30       Item Structure
     C                     Z-ADD*ZERO     WBRHNB  30       Item Structure
     C                     Z-ADD*ZERO     WBRGNB  30       Item Structure
     C                     Z-ADD*ZERO     WBTFNB  30       Transportation
     C                     Z-ADD*ZERO     WBTMVA 112       Maximum Audit V
     C                     Z-ADD*ZERO     WBTNVA 112       Minimum Audit V
     C                     Z-ADD*ZERO     WBBLPR 114       Market Overage
     C                     Z-ADD*ZERO     WBBMPR 114       Standard Overag
     C                     Z-ADD*ZERO     WBCMCO 114       Item Pricing Co
     C                     Z-ADD*ZERO     WBCHTM  52       Fresh Chilling
     C                     Z-ADD*ZERO     WBSWGH 112       Std Weight/Head
     C                     Z-ADD*ZERO     WBPPHE  70       Pieces Per Head
     C                     Z-ADD*ZERO     WBICN1  20       Item Category N
     C                     Z-ADD*ZERO     WBICN2  20       Item Category N
     C                     Z-ADD*ZERO     WBV2NB  20       Item Category N
     C                     Z-ADD*ZERO     WBITCN  20       Item Category N
     C                     Z-ADD*ZERO     WBITC5  20       Item Category N
     C                     Z-ADD*ZERO     WBICN6  20       Item Category N
     C                     Z-ADD*ZERO     WBICN7  20       Item Category N
     C                     Z-ADD*ZERO     WBICN8  20       Item Category N
     C                     Z-ADD*ZERO     WBICN9  20       Item Category N
     C                     Z-ADD*ZERO     WBICN0  20       Iten Category N
     C                     Z-ADD*ZERO     WBSFNB  52       UnUsed NBR 5.2
     C                     Z-ADD*ZERO     WBA3WG  52       Misc Tare Weigh
     C                     Z-ADD*ZERO     WBSJNB  30       Packages (Trays
     C                     Z-ADD*ZERO     WBSKNB  20       Agrimetrics gro
     C                     Z-ADD*ZERO     WBSLNB  10       Agrimetrics pac
     C                     Z-ADD*ZERO     WBSMNB  20       Agrimetrics gra
     C                     Z-ADD*ZERO     WBCFNB 114       PM Pounds per H
     C                     Z-ADD*ZERO     WBCGNB  74       PM Line Time Ef
     C                     Z-ADD*ZERO     WBILNB  74       PM % 2nds Facto
     C                     Z-ADD*ZERO     WBCHNB  30       PM Crew Size
     C                     Z-ADD*ZERO     WBCINB 114       PM Batch Size
     C                     Z-ADD*ZERO     WBCJNB 114       PM Lot Size
     C                     Z-ADD*ZERO     WBCMNB  70       PM BOM Spec Dat
     C                     Z-ADD*ZERO     WBCNNB  70       PM Seaboard Spe
     C                     Z-ADD*ZERO     WBCRNB  70       PM Seaboard Rep
     C                     Z-ADD*ZERO     WBCSNB  92       PM Raw Yield
     C                     Z-ADD*ZERO     WBCVNB  92       PM Formula Yiel
     C                     Z-ADD*ZERO     WBCWNB 114       PM Standard LBS
     C                     Z-ADD*ZERO     WBCXNB 114       PM Raw Meat LBS
     C                     Z-ADD*ZERO     WBCZNB 114       PM Formula LBS/
     C                     Z-ADD*ZERO     WBC0NB 114       PM Finished LBS
     C                     Z-ADD*ZERO     WBB4NB  30       PM R/M Type Cod
     C                     Z-ADD*ZERO     WBB5NB  50       PM Line Number
     C                     Z-ADD*ZERO     WBBDNB  70       Pieces Per Bag
     C                     Z-ADD*ZERO     WBBJNB  70       Bags Per Unit
     C                     Z-ADD*ZERO     WBF5WG 112       CI Unused Wgt 1
     C                     Z-ADD*ZERO     WBF6WG 112       CI Unused Wgt 2
     C                     Z-ADD*ZERO     WBF7WG 112       CI Unused Wgt 3
     C                     Z-ADD*ZERO     WBBLNB  70       CI Unused Nbr 1
     C                     Z-ADD*ZERO     WBBNNB  70       CI Unused Nbr 2
     C                     Z-ADD*ZERO     WBAATM  60       Job Time
     C                     Z-ADD*ZERO     WBAXDT  70       Job Date
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
