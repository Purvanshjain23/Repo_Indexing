     H/TITLE Rtv Mkt SlsVol b/FcsGp XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISPPATE
     H* Date          : 01/19/15  Time  : 16:23:25
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAAFRELDIF  E           K        DISK
      * RSQ : Calendar                  Co/Acct-Yr/HPS-Wk/Dte
      *
     FPDNEREL5IF  E           K        DISK
      * RSQ : Customer EXT              SMkt/Cust -Active
      *
     FPME3CPL2IF  E           K        DISK
      * RSQ : Item Sales Product Type   FcsGrp/Item
      *
     FOMBYREL1IF  E           K        DISK
      * RTV : Item Default              Retrieval index
      *
     FOMHSTPOHIF  E           K        DISK
      * RSQ : Sales History             ShpTo/Itm/ASD(d)
      *
     FOPEXREL2IF  E           K        DISK
      * RTV : Order Types               Active order Types
      *
     I@AFREUB
      * Calendar                  Co/Acct-Yr/HPS-Wk/Dte
      * Renamed input format fields
     I              AFAIC3                          WAAIC3
     I              AFBCDT                          WABCDT
     I              AFCQNB                          WACQNB
     I              AFESNB                          WAESNB
     I              AFETNB                          WAETNB
     I              AFBZNB                          WABZNB
     I              AFA9ST                          WAA9ST
     I              AFEINB                          WAEINB
     I              AFC5ST                          WAC5ST
     I              AFAQNB                          WAAQNB
     I              AFCMST                          WACMST
     I              AFV9ST                          WAV9ST
     I              AFWAST                          WAWAST
     I              AFX2ST                          WAX2ST
     I              AFOJDT                          WAOJDT
     I              AFNQNX                          WANQNX
     I              AFNRNX                          WANRNX
     I              AFI9SX                          WAI9SX
     I              AFJASX                          WAJASX
     I              AFOKDT                          WAOKDT
     I              AFOLDT                          WAOLDT
     I              AFUVST                          WAUVST
     I              AFUWST                          WAUWST
     I              AFUXST                          WAUXST
     I              AFAATM                          WAAATM
     I              AFAYNA                          WAAYNA
     I              AFA0NA                          WAA0NA
     I              AFAXDT                          WAAXDT
      *
     I@NEREXK
      * Customer EXT              SMkt/Cust -Active
      * Renamed input format fields
     I              NEBKC7                          WBBKC7
     I              NEUFTX                          WBUFTX
     I              NEUGTX                          WBUGTX
     I              NEPFNA                          WBPFNA
     I              NEJ5NX                          WBJ5NX
     I              NEU5TX                          WBU5TX
     I              NEU6TX                          WBU6TX
     I              NEW0TX                          WBW0TX
     I              NEHSSX                          WBHSSX
     I              NEHUSX                          WBHUSX
     I              NEHVSX                          WBHVSX
     I              NEAAC8                          WBAAC8
     I              NEP0SX                          WBP0SX
     I              NEP1SX                          WBP1SX
     I              NEP2SX                          WBP2SX
     I              NEP3SX                          WBP3SX
     I              NEP4SX                          WBP4SX
     I              NEP5SX                          WBP5SX
     I              NEP6SX                          WBP6SX
     I              NEUVST                          WBUVST
     I              NEUWST                          WBUWST
     I              NEUXST                          WBUXST
     I              NEVSST                          WBVSST
     I              NEAATM                          WBAATM
     I              NEAYNA                          WBAYNA
     I              NEA0NA                          WBA0NA
     I              NEAXDT                          WBAXDT
      *
     I@E3CPZK
      * Item Sales Product Type   FcsGrp/Item
      * Renamed input format fields
     I              E3HGCD                          WCHGCD
     I              E3IWAA                          WCIWAA
     I              E3VFNY                          WCVFNY
     I              E3PCAA                          WCPCAA
     I              E3VGNY                          WCVGNY
     I              E3PDAA                          WCPDAA
     I              E3VHNY                          WCVHNY
     I              E3PEAA                          WCPEAA
     I              E3VINY                          WCVINY
     I              E3PFAA                          WCPFAA
     I              E3VJNY                          WCVJNY
     I              E3PGAA                          WCPGAA
     I              E3VSST                          WCVSST
     I              E3MJDT                          WCMJDT
     I              E3BETM                          WCBETM
     I              E3CCVN                          WCCCVN
     I              E3CDVN                          WCCDVN
     I              E3MKDT                          WCMKDT
     I              E3BFTM                          WCBFTM
     I              E3CEVN                          WCCEVN
     I              E3CFVN                          WCCFVN
      *
     I@BYREA1
      * Item Default              Retrieval index
      * Renamed input format fields
     I              BYHGCD                          WDHGCD
     I              BYAVNA                          WDAVNA
     I              BYAWNA                          WDAWNA
     I              BYL7NA                          WDL7NA
     I              BYL8NA                          WDL8NA
     I              BYL6NA                          WDL6NA
     I              BYMFNA                          WDMFNA
     I              BYHHCD                          WDHHCD
     I              BYAWPC                          WDAWPC
     I              BYLXST                          WDLXST
     I              BYLGCD                          WDLGCD
     I              BYAXPC                          WDAXPC
     I              BYLYST                          WDLYST
     I              BYLHCD                          WDLHCD
     I              BYLICD                          WDLICD
     I              BYAIWG                          WDAIWG
     I              BYHICD                          WDHICD
     I              BYRBCD                          WDRBCD
     I              BYFZST                          WDFZST
     I              BYAVST                          WDAVST
     I              BYCZWG                          WDCZWG
     I              BYC0WG                          WDC0WG
     I              BYURTN                          WDURTN
     I              BYACC8                          WDACC8
     I              BYRINB                          WDRINB
     I              BYRHNB                          WDRHNB
     I              BYRGNB                          WDRGNB
     I              BYLNCD                          WDLNCD
     I              BYTFNB                          WDTFNB
     I              BYN0CD                          WDN0CD
     I              BYX4ST                          WDX4ST
     I              BYCHTM                          WDCHTM
     I              BYQZCD                          WDQZCD
     I              BYXWST                          WDXWST
     I              BYXXST                          WDXXST
     I              BYVMST                          WDVMST
     I              BYSWGH                          WDSWGH
     I              BYPPHE                          WDPPHE
     I              BYLRCD                          WDLRCD
     I              BYSFNB                          WDSFNB
     I              BYA3WG                          WDA3WG
     I              BYSJNB                          WDSJNB
     I              BYLLCD                          WDLLCD
     I              BYLMCD                          WDLMCD
     I              BYP3ST                          WDP3ST
     I              BYSKNB                          WDSKNB
     I              BYSLNB                          WDSLNB
     I              BYSMNB                          WDSMNB
     I              BYP4ST                          WDP4ST
     I              BYCFNB                          WDCFNB
     I              BYCGNB                          WDCGNB
     I              BYILNB                          WDILNB
     I              BYCHNB                          WDCHNB
     I              BYCINB                          WDCINB
     I              BYCJNB                          WDCJNB
     I              BYCMNB                          WDCMNB
     I              BYCNNB                          WDCNNB
     I              BYCRNB                          WDCRNB
     I              BYCSNB                          WDCSNB
     I              BYCVNB                          WDCVNB
     I              BYCWNB                          WDCWNB
     I              BYCXNB                          WDCXNB
     I              BYCZNB                          WDCZNB
     I              BYC0NB                          WDC0NB
     I              BYN1CD                          WDN1CD
     I              BYB4NB                          WDB4NB
     I              BYX5ST                          WDX5ST
     I              BYX6ST                          WDX6ST
     I              BYX7ST                          WDX7ST
     I              BYTMVA                          WDTMVA
     I              BYTNVA                          WDTNVA
     I              BYBLPR                          WDBLPR
     I              BYBMPR                          WDBMPR
     I              BYU9ST                          WDU9ST
     I              BYCMCO                          WDCMCO
     I              BYQ1CD                          WDQ1CD
     I              BYAIC3                          WDAIC3
     I              BYQ8CD                          WDQ8CD
     I              BYR3CD                          WDR3CD
     I              BYSDCD                          WDSDCD
     I              BYICN1                          WDICN1
     I              BYSVCD                          WDSVCD
     I              BYICN2                          WDICN2
     I              BYSWCD                          WDSWCD
     I              BYV2NB                          WDV2NB
     I              BYSXCD                          WDSXCD
     I              BYITCN                          WDITCN
     I              BYSYCD                          WDSYCD
     I              BYITC5                          WDITC5
     I              BYSZCD                          WDSZCD
     I              BYICN6                          WDICN6
     I              BYS0CD                          WDS0CD
     I              BYICN7                          WDICN7
     I              BYS1CD                          WDS1CD
     I              BYICN8                          WDICN8
     I              BYS2CD                          WDS2CD
     I              BYICN9                          WDICN9
     I              BYS3CD                          WDS3CD
     I              BYICN0                          WDICN0
     I              BYS4CD                          WDS4CD
     I              BYB5NB                          WDB5NB
     I              BYXRCD                          WDXRCD
     I              BYPCCT                          WDPCCT
     I              BYBDNB                          WDBDNB
     I              BYBJNB                          WDBJNB
     I              BYSUST                          WDSUST
     I              BYSVST                          WDSVST
     I              BYSYST                          WDSYST
     I              BYSZST                          WDSZST
     I              BYS1ST                          WDS1ST
     I              BYXTCD                          WDXTCD
     I              BYXUCD                          WDXUCD
     I              BYF5WG                          WDF5WG
     I              BYF6WG                          WDF6WG
     I              BYF7WG                          WDF7WG
     I              BYBLNB                          WDBLNB
     I              BYBNNB                          WDBNNB
     I              BYS2ST                          WDS2ST
     I              BYS4ST                          WDS4ST
     I              BYS5ST                          WDS5ST
     I              BYS6ST                          WDS6ST
     I              BYS8ST                          WDS8ST
     I              BYS9ST                          WDS9ST
     I              BYTCST                          WDTCST
     I              BYTDST                          WDTDST
     I              BYUVST                          WDUVST
     I              BYUWST                          WDUWST
     I              BYUXST                          WDUXST
     I              BYVSST                          WDVSST
     I              BYAHTM                          WDAHTM
     I              BYBEVN                          WDBEVN
     I              BYBFVN                          WDBFVN
     I              BYEKDT                          WDEKDT
      *
     I@HSTPRY
      * Sales History             ShpTo/Itm/ASD(d)
      * Renamed input format fields
     I              F4AIC3                          WEAIC3
     I              F4C4NB                          WEC4NB
     I              F4DPNB                          WEDPNB
     I              F4UENB                          WEUENB
     I              F4MONA                          WEMONA
     I              F4RJCD                          WERJCD
     I              F4RKCD                          WERKCD
     I              F4GPTX                          WEGPTX
     I              F4ABTX                          WEABTX
     I              F4KXCD                          WEKXCD
     I              F4BOCD                          WEBOCD
     I              F4BTC7                          WEBTC7
     I              F4ANC7                          WEANC7
     I              F4AQTX                          WEAQTX
     I              F4BKC7                          WEBKC7
     I              F4BRTX                          WEBRTX
     I              F4HNNA                          WEHNNA
     I              F4DBCD                          WEDBCD
     I              F4CKTX                          WECKTX
     I              F4BCNA                          WEBCNA
     I              F4A0DT                          WEA0DT
     I              F4ACDT                          WEACDT
     I              F4R4CD                          WER4CD
     I              F4R5CD                          WER5CD
     I              F4BFCD                          WEBFCD
     I              F4Q4CD                          WEQ4CD
     I              F4AQCD                          WEAQCD
     I              F4TBNB                          WETBNB
     I              F4BZNA                          WEBZNA
     I              F4RLCD                          WERLCD
     I              F4JNCD                          WEJNCD
     I              F4Q2CD                          WEQ2CD
     I              F4U2ST                          WEU2ST
     I              F4ATIN                          WEATIN
     I              F4T3NB                          WET3NB
     I              F4RSRN                          WERSRN
     I              F4ORIT                          WEORIT
     I              F4AJCD                          WEAJCD
     I              F4AVQT                          WEAVQT
     I              F4D0WG                          WED0WG
     I              F4CCQT                          WECCQT
     I              F4AUWG                          WEAUWG
     I              F4AGCD                          WEAGCD
     I              F4AKPR                          WEAKPR
     I              F4AUPR                          WEAUPR
     I              F4CRCD                          WECRCD
     I              F4A5DT                          WEA5DT
     I              F4AWDT                          WEAWDT
     I              F4HDDT                          WEHDDT
     I              F4AGCS                          WEAGCS
     I              F4AQCS                          WEAQCS
     I              F4AVWG                          WEAVWG
     I              F4AYVA                          WEAYVA
     I              F4AMST                          WEAMST
     I              F4ANST                          WEANST
     I              F4VAST                          WEVAST
     I              F4L6NB                          WEL6NB
     I              F4UMCD                          WEUMCD
     I              F4HCDT                          WEHCDT
     I              F4ESNB                          WEESNB
     I              F4ETNB                          WEETNB
     I              F4BZNB                          WEBZNB
     I              F4EXQT                          WEEXQT
     I              F4BYWG                          WEBYWG
     I              F4S5NB                          WES5NB
     I              F4MAVA                          WEMAVA
     I              F4KDVA                          WEKDVA
     I              F4USVA                          WEUSVA
     I              F4UTVA                          WEUTVA
     I              F4A4WG                          WEA4WG
     I              F4CKNB                          WECKNB
     I              F4BMST                          WEBMST
     I              F4R8NB                          WER8NB
     I              F4RMCD                          WERMCD
     I              F4BZPR                          WEBZPR
     I              F4RDCD                          WERDCD
     I              F4Q7CD                          WEQ7CD
     I              F4EXDT                          WEEXDT
     I              F4LQCD                          WELQCD
     I              F4HICD                          WEHICD
     I              F4RBCD                          WERBCD
     I              F4RGNB                          WERGNB
     I              F4RHNB                          WERHNB
     I              F4RINB                          WERINB
     I              F4R1NB                          WER1NB
     I              F4CONB                          WECONB
     I              F4CEST                          WECEST
     I              F4GNDT                          WEGNDT
     I              F4RMNB                          WERMNB
     I              F4AODT                          WEAODT
     I              F4LLCD                          WELLCD
     I              F4LMCD                          WELMCD
     I              F4SKNB                          WESKNB
     I              F4SLNB                          WESLNB
     I              F4SMNB                          WESMNB
     I              F4G7NA                          WEG7NA
     I              F4ONVA                          WEONVA
     I              F4N0CD                          WEN0CD
     I              F4B4NB                          WEB4NB
     I              F4B5NB                          WEB5NB
     I              F4N1CD                          WEN1CD
     I              F4GIDT                          WEGIDT
     I              F4Z1ST                          WEZ1ST
     I              F4ULVA                          WEULVA
     I              F4UNVA                          WEUNVA
     I              F4UOVA                          WEUOVA
     I              F4UPVA                          WEUPVA
     I              F4UQVA                          WEUQVA
     I              F4SDCD                          WESDCD
     I              F4QZCD                          WEQZCD
     I              F4XWST                          WEXWST
     I              F4T9CD                          WET9CD
     I              F4UBCD                          WEUBCD
     I              F4CFC7                          WECFC7
     I              F4X1CD                          WEX1CD
     I              F4GASX                          WEGASX
     I              F4DUPR                          WEDUPR
     I              F4B6VL                          WEB6VL
     I              F4IANX                          WEIANX
     I              F4IBNX                          WEIBNX
     I              F4RPCD                          WERPCD
     I              F4NYDT                          WENYDT
     I              F4BZTM                          WEBZTM
     I              F4Z4NB                          WEZ4NB
     I              F4XACD                          WEXACD
     I              F4OANA                          WEOANA
     I              F4OKTX                          WEOKTX
     I              F4K4TX                          WEK4TX
     I              F4NBBO                          WENBBO
     I              F4OCFR                          WEOCFR
     I              F4C0C7                          WEC0C7
     I              F4A1AA                          WEA1AA
     I              F4VEST                          WEVEST
     I              F4A5PR                          WEA5PR
     I              F4CDPR                          WECDPR
     I              F4D0PR                          WED0PR
     I              F4D0VL                          WED0VL
     I              F4IRSX                          WEIRSX
     I              F4CEVL                          WECEVL
     I              F4ISSX                          WEISSX
     I              F4ITSX                          WEITSX
     I              F4IUSX                          WEIUSX
     I              F4OHDT                          WEOHDT
     I              F4D9PR                          WED9PR
     I              F4CFVL                          WECFVL
     I              F4UVST                          WEUVST
     I              F4UWST                          WEUWST
     I              F4UXST                          WEUXST
     I              F4AATM                          WEAATM
     I              F4AYNA                          WEAYNA
     I              F4A0NA                          WEA0NA
     I              F4AXDT                          WEAXDT
      *
     I@EXRETY
      * Order Types               Active order Types
      * Renamed input format fields
     I              EXJNCD                          WFJNCD
     I              EXJVNA                          WFJVNA
     I              EXOAST                          WFOAST
     I              EXOBST                          WFOBST
     I              EXOEST                          WFOEST
     I              EXOFST                          WFOFST
     I              EXVBST                          WFVBST
     I              EXPYST                          WFPYST
     I              EXX8ST                          WFX8ST
     I              EXISTX                          WFISTX
     I              EXUVST                          WFUVST
     I              EXUWST                          WFUWST
     I              EXUXST                          WFUXST
     I              EXVSST                          WFVSST
     I              EXAATM                          WFAATM
     I              EXAYNA                          WFAYNA
     I              EXA0NA                          WFA0NA
     I              EXAXDT                          WFAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  Company Number
     I                                    P   1   20P1AIC3
     IP2PARM      DS
      * FLD: Sales Market PT Qtr Quota
      * I :  Market Code
     I                                        1   3 P2ISAA
      * I :  Product Type Code
     I                                        4  19 P2IWAA
      * N :  Period Ending Date
     I                                    P  20  230P2A2DT
      * I :  Accounting Year
     I                                    P  24  260P2ANNB
      * I :  Accounting Quarter
     I                                    P  27  280P2J8NY
      * B :  Prior Year Actual Volume
     I                                    P  29  340P2PPWG
     IP3PARM      DS
      * N :  Period Beginning Date
     I                                    P   1   40P3BFDT
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P2ISAA    PARM           WP0002  3        Market Code
     C           P2IWAA    PARM           WP0003 16        Product Type Co
     C           P2ANNB    PARM           WP0004  40       Accounting Year
     C           P2J8NY    PARM           WP0005  20       Accounting Quar
     C           P2PPWG    PARM P2PPWG    WP0006 110       Prior Year Actu
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Rtv Mkt SlsVol b/FcsGp XF
     C           P2ANNB    SUB  1         YL0001           Accounting Year
      * Rtv Acct Qtr B/E Dte  RT - Calendar  * 
     C                     EXSR SARVGN
     C                     Z-ADD*ZERO     P2PPWG           Prior Year Actu
      * Rtv Mkt SlsVol b/FcsGp RT - Customer EXT  * 
     C                     EXSR SBRVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Acct Qtr B/E Dte  RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       YL0002           First Time Flag
     C                     Z-ADD0         YL0003           Count USR
     C                     Z-ADD0         YL0004           Day NBR USR
     C                     Z-ADD0         YL0005           Accounting Quar
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
     C           *LIKE     DEFN WAESNB    WQSA02           Accounting Year
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           WQSA02           Accounting Year
      * Setup key
     C                     Z-ADDP1AIC3    WQSA01           Company Number
     C                     Z-ADDYL0001    WQSA02           Accounting Year
      * Establish starting position
     C           KRSSA     SETLL@AFREUB                    *
     C           KRSSA     READE@AFREUB                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * FIRST TIME
      * CASE: LCL.First Time Flag is Yes
     C           YL0002    IFEQ 'Y'                        *IF
     C                     Z-ADD1         YL0003           Count USR
     C                     Z-ADD1         YL0004           Day NBR USR
     C                     Z-ADDWANRNX    YL0006           HPS Calendar We
     C                     Z-ADDWABCDT    P3BFDT           Period Beginnin
     C                     MOVEL'N'       YL0002           First Time Flag
     C                     END                             *FI
      * CHG: HPS Calendar Week
      * CASE: DB1.HPS Calendar Week NE LCL.HPS Calendar Week
     C           WANRNX    IFNE YL0006                     *IF
     C                     ADD  1         YL0003           Count USR
     C                     Z-ADD1         YL0004           Day NBR USR
     C                     Z-ADDWANRNX    YL0006           HPS Calendar We
      * CASE: LCL.Count USR is One
     C           YL0003    IFEQ 1                          *IF
     C                     Z-ADDWABCDT    P3BFDT           Period Beginnin
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         YL0004           Day NBR USR
     C                     END                             *FI
      * Last Day of the 13th Week
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Count USR is Thirteen
      *   |- c2    : LCL.Day NBR USR is Seven
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0003    IFEQ 13                         *IF
     C           YL0004    IFEQ 7                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  1         YL0005           Accounting Quar
      * CASE: LCL.Accounting Quarter EQ PAR.Accounting Quarter
     C           YL0005    IFEQ P2J8NY                     *IF
     C                     Z-ADDWABCDT    P2A2DT           Period Ending D
     C                     GOTO SAEXIT                     *QUIT
     C                     END                             *FI
     C                     Z-ADD0         YL0003           Count USR
     C                     END                             *FI
     C           KRSSA     READE@AFREUB                  90*
     C                     ENDDO
      * USER: Exit processing
     C                     Z-ADDWABCDT    P2A2DT           Period Ending D
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Mkt SlsVol b/FcsGp RT - Customer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBP6SX    WQSB01           Customer Market
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Customer Market
      * Setup key
     C                     MOVELP2ISAA    WQSB01           Customer Market
      * Establish starting position
     C           KRSSB     SETLL@NEREXK                    *
     C           KRSSB     READE@NEREXK                  90*
      * Data record not found
     C   90                MOVEL'USR2880' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Mkt SlsVol b/FcsGp RT - Item Sales Product Type  * 
     C                     EXSR SCRVGN
     C           KRSSB     READE@NEREXK                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Mkt SlsVol b/FcsGp RT - Item Sales Product Type  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCIWAA    WQSC01           Product Type Co
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Product Type Co
      * Setup key
     C                     MOVELP2IWAA    WQSC01           Product Type Co
      * Establish starting position
     C           KRSSC     SETLL@E3CPZK                    *
     C           KRSSC     READE@E3CPZK                  90*
      * Data record not found
     C   90                MOVEL'USR4100' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Item Market Code  RT - Item Default  * 
     C                     EXSR SDRVGN
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Item Market Code is Entered
      *   |- c2    : LCL.Item Market Code NE PAR.Market Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0007    IFNE *BLANK                     *IF
     C           YL0007    IFNE P2ISAA                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Mkt SlsVol b/FcsGp RT - Sales History  * 
     C                     EXSR SERVGN
     C                     END                             *FI
     C           KRSSC     READE@E3CPZK                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Item Market Code  RT - Item Default  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDHGCD           Item Code
      * Setup key
     C                     Z-ADDWCHGCD    WDHGCD           Item Code
      * Establish starting position
     C           KRSSD     CHAIN@BYREA1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1160' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0007           Item Market Cod
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDLMCD    YL0007           Item Market Cod
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Mkt SlsVol b/FcsGp RT - Sales History  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEBKC7    WQSE01           Ship To Custome
     C           *LIKE     DEFN WES5NB    WQSE02           Shipped Item Co
      * Define keylist
     C           KPSSE     KLIST
     C                     KFLD           WQSE01           Ship To Custome
     C                     KFLD           WQSE02           Shipped Item Co
     C                     KFLD           WEGNDT           Actual Shipped
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Ship To Custome
     C                     KFLD           WQSE02           Shipped Item Co
      * Setup key
     C                     Z-ADDWBBKC7    WQSE01           Ship To Custome
     C                     Z-ADDWCHGCD    WQSE02           Shipped Item Co
     C                     Z-ADDP2A2DT    WEGNDT           Actual Shipped
      * Establish starting position
     C           KPSSE     SETLL@HSTPRY                    *
     C           KRSSE     READE@HSTPRY                  90*
      * Data record not found
     C   90                MOVEL'USR1241' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       YL0008           *Record selecte
      * QUIT: Actual Ship Date < Period Begin Date
      * CASE: DB1.Actual Shipped Date LT PAR.Period Beginning Date
     C           WEGNDT    IFLT P3BFDT                     *IF
     C                     GOTO SEEXIT                     *QUIT
     C                     END                             *FI
      * OMT: Employee and Inter-Plant Sales
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Type Code is Inter-Plant Transfer
      *   |- c2    : DB1.Type Code is Employee Sale
      *   '-
     C           WEBOCD    IFEQ 'IP'                       *IF
     C           WEBOCD    OREQ 'EM'                       *OR
     C                     MOVEL'N'       YL0008           *Record selecte
     C                     END                             *FI
      * Process Record
      * CASE: LCL.*Record selected is *YES
     C           YL0008    IFEQ 'Y'                        *IF
      * RTV Billing Type       RT - Order Types  * 
     C                     EXSR SFRVGN
      * CASE: LCL.Billing Activity Type is Invoice or Debit Memo
     C           YL0009    IFEQ '3'                        *IF
     C           YL0009    OREQ '1'
     C                     ADD  WEBYWG    P2PPWG           Prior Year Actu
     C                     ELSE
      * CASE: LCL.Billing Activity Type is Credit Memo
     C           YL0009    IFEQ '2'                        *IF
      * CASE: DB1.Affect Sales Pnds Status is yes
     C           WEVAST    IFEQ 'Y'                        *IF
     C           WEBYWG    MULT -1        YL0010           Weight Billed
     C                     END                             *FI
     C                     ADD  YL0010    P2PPWG           Prior Year Actu
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSE     READE@HSTPRY                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Billing Type       RT - Order Types  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WFJNCD           Order Type - Sa
      * Setup key
     C                     MOVELWEJNCD    WFJNCD           Order Type - Sa
      * Establish starting position
     C           KRSSF     CHAIN@EXRETY              90    *
      * Data record not found
     C   90                MOVEL'USR1063' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFOBST    YL0009           Billing Activit
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P2A2DT           Period Ending D
     C                     Z-ADD*ZERO     P3BFDT           Period Beginnin
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WABCDT           Post to G/L Dat
     C                     Z-ADD*ZERO     WACQNB           Julian Date
     C                     Z-ADD*ZERO     WAESNB           Accounting Year
     C                     Z-ADD*ZERO     WAETNB           Accounting Peri
     C                     Z-ADD*ZERO     WABZNB           OM Week
     C                     Z-ADD*ZERO     WAEINB           Week Number
     C                     Z-ADD*ZERO     WAAQNB           Billing Cycle
     C                     Z-ADD*ZERO     WAOJDT           HPS PIC Date
     C                     Z-ADD*ZERO     WANQNX           HPS Calendar Ye
     C                     Z-ADD*ZERO     WANRNX           HPS Calendar We
     C                     Z-ADD*ZERO     WAOKDT           Calendar Unused
     C                     Z-ADD*ZERO     WAOLDT           Calendar Unused
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBAAC8           Customer G/L Ve
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCVFNY           Item Report Gro
     C                     Z-ADD*ZERO     WCVGNY           Item Report Gro
     C                     Z-ADD*ZERO     WCVHNY           Item Report Gro
     C                     Z-ADD*ZERO     WCVINY           Item Report Gro
     C                     Z-ADD*ZERO     WCVJNY           Item Report Gro
     C                     Z-ADD*ZERO     WCMJDT           Create Date
     C                     Z-ADD*ZERO     WCBETM           Create Time
     C                     Z-ADD*ZERO     WCMKDT           Change Date
     C                     Z-ADD*ZERO     WCBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDHGCD           Item Code
     C                     Z-ADD*ZERO     WDAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WDAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WDAIWG           Unit Weight
     C                     Z-ADD*ZERO     WDCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WDC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WDURTN           Number Cases On
     C                     Z-ADD*ZERO     WDACC8           Vendor item Def
     C                     Z-ADD*ZERO     WDRINB           Item Structure
     C                     Z-ADD*ZERO     WDRHNB           Item Structure
     C                     Z-ADD*ZERO     WDRGNB           Item Structure
     C                     Z-ADD*ZERO     WDTFNB           Transportation
     C                     Z-ADD*ZERO     WDCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WDSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WDPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WDSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WDA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WDSJNB           Production Lead
     C                     Z-ADD*ZERO     WDSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WDSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WDSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WDCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WDCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WDILNB           Packages per ca
     C                     Z-ADD*ZERO     WDCHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WDCINB           PM Batch Size
     C                     Z-ADD*ZERO     WDCJNB           Package Level s
     C                     Z-ADD*ZERO     WDCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WDCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WDCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WDCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WDCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WDCWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WDCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WDCZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WDC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WDB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WDTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WDTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WDBLPR           Market Overage
     C                     Z-ADD*ZERO     WDBMPR           Standard Overag
     C                     Z-ADD*ZERO     WDCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDICN1           Item Category N
     C                     Z-ADD*ZERO     WDICN2           Item Category N
     C                     Z-ADD*ZERO     WDV2NB           Item Category N
     C                     Z-ADD*ZERO     WDITCN           Item Category N
     C                     Z-ADD*ZERO     WDITC5           Item Category N
     C                     Z-ADD*ZERO     WDICN6           Item Category N
     C                     Z-ADD*ZERO     WDICN7           Item Category N
     C                     Z-ADD*ZERO     WDICN8           Item Category N
     C                     Z-ADD*ZERO     WDICN9           Item Category N
     C                     Z-ADD*ZERO     WDICN0           Item Category N
     C                     Z-ADD*ZERO     WDB5NB           PM Line Number
     C                     Z-ADD*ZERO     WDBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WDBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WDF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WDF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WDF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WDBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WDBNNB           Production Qty
     C                     Z-ADD*ZERO     WDAHTM           Job Time
     C                     Z-ADD*ZERO     WDEKDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEC4NB           Order Number
     C                     Z-ADD*ZERO     WEDPNB           Order Sequence
     C                     Z-ADD*ZERO     WEUENB           Order Secondary
     C                     Z-ADD*ZERO     WEBTC7           Parent Customer
     C                     Z-ADD*ZERO     WEANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WEBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WEA0DT           Order Date
     C                     Z-ADD*ZERO     WEACDT           Cancel Date
     C                     Z-ADD*ZERO     WETBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WEATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WET3NB           Attach to Order
     C                     Z-ADD*ZERO     WERSRN           Resell Referenc
     C                     Z-ADD*ZERO     WEORIT           Original Item
     C                     Z-ADD*ZERO     WEAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WED0WG           Weight Ordered
     C                     Z-ADD*ZERO     WECCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WEAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WEAKPR           Unit Price
     C                     Z-ADD*ZERO     WEAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WEA5DT           Requested Ship
     C                     Z-ADD*ZERO     WEAWDT           Invoice Date
     C                     Z-ADD*ZERO     WEHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WEAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WEAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WEAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WEAYVA           Extended Amount
     C                     Z-ADD*ZERO     WEL6NB           Contract Number
     C                     Z-ADD*ZERO     WEHCDT           LD Arrival Date
     C                     Z-ADD*ZERO     WEESNB           Accounting Year
     C                     Z-ADD*ZERO     WEETNB           Accounting Peri
     C                     Z-ADD*ZERO     WEBZNB           OM Week
     C                     Z-ADD*ZERO     WEEXQT           Quantity Billed
     C                     Z-ADD*ZERO     WEBYWG           Weight Billed
     C                     Z-ADD*ZERO     WES5NB           Shipped Item Co
     C                     Z-ADD*ZERO     WEMAVA           Billing Detail
     C                     Z-ADD*ZERO     WEKDVA           Billing Detail
     C                     Z-ADD*ZERO     WEUSVA           FOB Gross Amoun
     C                     Z-ADD*ZERO     WEUTVA           Standard Overag
     C                     Z-ADD*ZERO     WEA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WECKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WER8NB           Shipping Compan
     C                     Z-ADD*ZERO     WEBZPR           Price Overage O
     C                     Z-ADD*ZERO     WEEXDT           Market Pricing
     C                     Z-ADD*ZERO     WERGNB           Item Structure
     C                     Z-ADD*ZERO     WERHNB           Item Structure
     C                     Z-ADD*ZERO     WERINB           Item Structure
     C                     Z-ADD*ZERO     WER1NB           Rated Freight
     C                     Z-ADD*ZERO     WECONB           Invoice Number
     C                     Z-ADD*ZERO     WEGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WERMNB           Load ID
     C                     Z-ADD*ZERO     WEAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WESKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WESLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WESMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WEONVA           Actual Freight
     C                     Z-ADD*ZERO     WEB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WEB5NB           PM Line Number
     C                     Z-ADD*ZERO     WEGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WEULVA           Absorbed Freigh
     C                     Z-ADD*ZERO     WEUNVA           Ledgrd Trd Fund
     C                     Z-ADD*ZERO     WEUOVA           Commission Amou
     C                     Z-ADD*ZERO     WEUPVA           Financials Amou
     C                     Z-ADD*ZERO     WEUQVA           Financials Amou
     C                     Z-ADD*ZERO     WECFC7           Order Group Cod
     C                     Z-ADD*ZERO     WEDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WEB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WEIANX           Req Shipping Te
     C                     Z-ADD*ZERO     WEIBNX           Actual Shipping
     C                     Z-ADD*ZERO     WENYDT           Req Delivery Da
     C                     Z-ADD*ZERO     WEBZTM           Req Delivery Ti
     C                     Z-ADD*ZERO     WEZ4NB           MPC Number
     C                     Z-ADD*ZERO     WEOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WEC0C7           Claim Number
     C                     Z-ADD*ZERO     WEA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WEA5PR           Commodity Marke
     C                     Z-ADD*ZERO     WECDPR           Market Value
     C                     Z-ADD*ZERO     WED0PR           Default Cmdty M
     C                     Z-ADD*ZERO     WED0VL           Raw Material Co
     C                     Z-ADD*ZERO     WECEVL           Sales Expense T
     C                     Z-ADD*ZERO     WEOHDT           LD Sail Date
     C                     Z-ADD*ZERO     WED9PR           NonLedgrd TrdFn
     C                     Z-ADD*ZERO     WECFVL           HST Item Target
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
     C                     MOVEL'N'       W0PMT   1
      * Define local work field Accounting Year
     C                     Z-ADD*ZERO     YL0001  40
      * Define local work field First Time Flag
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field Count USR
     C                     Z-ADD*ZERO     YL0003  50
      * Define local work field Day NBR USR
     C                     Z-ADD*ZERO     YL0004  20
      * Define local work field Accounting Quarter
     C                     Z-ADD*ZERO     YL0005  20
      * Define local work field HPS Calendar Week
     C                     Z-ADD*ZERO     YL0006  20
      * Define local work field Item Market Code
     C                     MOVEL*BLANK    YL0007  3
      * Define local work field *Record selected
     C                     MOVEL*BLANK    YL0008  1
      * Define local work field Billing Activity Type
     C                     MOVEL*BLANK    YL0009  1
      * Define local work field Weight Billed
     C                     Z-ADD*ZERO     YL0010 112
      *================================================================
     CSR         ZZEXIT    ENDSR
