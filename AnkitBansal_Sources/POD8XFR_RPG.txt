     H/TITLE Prc Sales History Exp XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by AllFusion 2E release 8.1SP2 (1250)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISSMASO
     H* Date          : 02/23/10  Time  : 09:06:30
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOMHSTPMAIF  E           K        DISK
      * RSQ : Sales History             Co/Order/Seq/SelAffctSal
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPOAGREL2IF  E           K        DISK
      * RSQ : Sales Expenses            Active Sales Expenses
      *
     FPOAHREL2IF  E           K        DISK
      * RSQ : Sales Exp Brokerage Fee   Co/Cust/EffDate (D)
      *
     FPOAIREL2IF  E           K        DISK
      * RSQ : Sales Exp Freezer Storage Co/Whs/Unit/EffctDate (D
      *
     FPOAKCPL2IF  E           K        DISK
      * RSQ : Sales Exp Payment Intrst  Co/Cust/Effctv Date (D)
      *
     FPOAJREL2IF  E           K        DISK
      * RSQ : Sales Exp Pallet Usage    Co/Effective Date (D)
      *
     FPOAMCPL2IF  E           K        DISK
      * RSQ : Sales Exp Brokerage /Item Co/Cust/Effctv Dt (D)
      *
     FPOAOCPL2IF  E           K        DISK
      * RSQ : Sales Exp Brokerage /Ctry Co/Country/Eff Dt (D)
      *
     FOMFNCPL1IF  E           K        DISK
      * RTV : Manifest Detail           Retrieval index
      *
     FOMHSTPL0UF  E           K        DISK
      * UPD : Sales History             Update index
      *
     FPOALCPL0IF  E           K        DISK                      A
      * UPD : Sales History Expense Dtl Update index
      *
     E                    YDOW        7  1               *Days of week
     I@HSTPFT
      * Sales History             Co/Order/Seq/SelAffctSal
      * Renamed input format fields
     I              F4AIC3                          WAAIC3
     I              F4C4NB                          WAC4NB
     I              F4DPNB                          WADPNB
     I              F4UENB                          WAUENB
     I              F4MONA                          WAMONA
     I              F4RJCD                          WARJCD
     I              F4RKCD                          WARKCD
     I              F4GPTX                          WAGPTX
     I              F4ABTX                          WAABTX
     I              F4KXCD                          WAKXCD
     I              F4BOCD                          WABOCD
     I              F4BTC7                          WABTC7
     I              F4ANC7                          WAANC7
     I              F4AQTX                          WAAQTX
     I              F4BKC7                          WABKC7
     I              F4BRTX                          WABRTX
     I              F4HNNA                          WAHNNA
     I              F4DBCD                          WADBCD
     I              F4CKTX                          WACKTX
     I              F4BCNA                          WABCNA
     I              F4A0DT                          WAA0DT
     I              F4ACDT                          WAACDT
     I              F4R4CD                          WAR4CD
     I              F4R5CD                          WAR5CD
     I              F4BFCD                          WABFCD
     I              F4Q4CD                          WAQ4CD
     I              F4AQCD                          WAAQCD
     I              F4TBNB                          WATBNB
     I              F4BZNA                          WABZNA
     I              F4RLCD                          WARLCD
     I              F4JNCD                          WAJNCD
     I              F4Q2CD                          WAQ2CD
     I              F4U2ST                          WAU2ST
     I              F4ATIN                          WAATIN
     I              F4T3NB                          WAT3NB
     I              F4RSRN                          WARSRN
     I              F4ORIT                          WAORIT
     I              F4AJCD                          WAAJCD
     I              F4AVQT                          WAAVQT
     I              F4D0WG                          WAD0WG
     I              F4CCQT                          WACCQT
     I              F4AUWG                          WAAUWG
     I              F4AGCD                          WAAGCD
     I              F4AKPR                          WAAKPR
     I              F4AUPR                          WAAUPR
     I              F4CRCD                          WACRCD
     I              F4A5DT                          WAA5DT
     I              F4AWDT                          WAAWDT
     I              F4HDDT                          WAHDDT
     I              F4AGCS                          WAAGCS
     I              F4AQCS                          WAAQCS
     I              F4AVWG                          WAAVWG
     I              F4AYVA                          WAAYVA
     I              F4AMST                          WAAMST
     I              F4ANST                          WAANST
     I              F4VAST                          WAVAST
     I              F4L6NB                          WAL6NB
     I              F4UMCD                          WAUMCD
     I              F4HCDT                          WAHCDT
     I              F4ESNB                          WAESNB
     I              F4ETNB                          WAETNB
     I              F4BZNB                          WABZNB
     I              F4EXQT                          WAEXQT
     I              F4BYWG                          WABYWG
     I              F4S5NB                          WAS5NB
     I              F4MAVA                          WAMAVA
     I              F4KDVA                          WAKDVA
     I              F4USVA                          WAUSVA
     I              F4UTVA                          WAUTVA
     I              F4A4WG                          WAA4WG
     I              F4CKNB                          WACKNB
     I              F4BMST                          WABMST
     I              F4R8NB                          WAR8NB
     I              F4RMCD                          WARMCD
     I              F4BZPR                          WABZPR
     I              F4RDCD                          WARDCD
     I              F4Q7CD                          WAQ7CD
     I              F4EXDT                          WAEXDT
     I              F4LQCD                          WALQCD
     I              F4HICD                          WAHICD
     I              F4RBCD                          WARBCD
     I              F4RGNB                          WARGNB
     I              F4RHNB                          WARHNB
     I              F4RINB                          WARINB
     I              F4R1NB                          WAR1NB
     I              F4CONB                          WACONB
     I              F4CEST                          WACEST
     I              F4GNDT                          WAGNDT
     I              F4RMNB                          WARMNB
     I              F4AODT                          WAAODT
     I              F4LLCD                          WALLCD
     I              F4LMCD                          WALMCD
     I              F4SKNB                          WASKNB
     I              F4SLNB                          WASLNB
     I              F4SMNB                          WASMNB
     I              F4G7NA                          WAG7NA
     I              F4ONVA                          WAONVA
     I              F4N0CD                          WAN0CD
     I              F4B4NB                          WAB4NB
     I              F4B5NB                          WAB5NB
     I              F4N1CD                          WAN1CD
     I              F4GIDT                          WAGIDT
     I              F4Z1ST                          WAZ1ST
     I              F4ULVA                          WAULVA
     I              F4UNVA                          WAUNVA
     I              F4UOVA                          WAUOVA
     I              F4UPVA                          WAUPVA
     I              F4UQVA                          WAUQVA
     I              F4SDCD                          WASDCD
     I              F4QZCD                          WAQZCD
     I              F4XWST                          WAXWST
     I              F4T9CD                          WAT9CD
     I              F4UBCD                          WAUBCD
     I              F4CFC7                          WACFC7
     I              F4X1CD                          WAX1CD
     I              F4GASX                          WAGASX
     I              F4DUPR                          WADUPR
     I              F4B6VL                          WAB6VL
     I              F4IANX                          WAIANX
     I              F4IBNX                          WAIBNX
     I              F4RPCD                          WARPCD
     I              F4NYDT                          WANYDT
     I              F4BZTM                          WABZTM
     I              F4Z4NB                          WAZ4NB
     I              F4XACD                          WAXACD
     I              F4OANA                          WAOANA
     I              F4OKTX                          WAOKTX
     I              F4K4TX                          WAK4TX
     I              F4NBBO                          WANBBO
     I              F4OCFR                          WAOCFR
     I              F4C0C7                          WAC0C7
     I              F4A1AA                          WAA1AA
     I              F4VEST                          WAVEST
     I              F4A5PR                          WAA5PR
     I              F4CDPR                          WACDPR
     I              F4D0PR                          WAD0PR
     I              F4D0VL                          WAD0VL
     I              F4IRSX                          WAIRSX
     I              F4CEVL                          WACEVL
     I              F4ISSX                          WAISSX
     I              F4ITSX                          WAITSX
     I              F4IUSX                          WAIUSX
     I              F4OHDT                          WAOHDT
     I              F4D9PR                          WAD9PR
     I              F4CFVL                          WACFVL
     I              F4UVST                          WAUVST
     I              F4UWST                          WAUWST
     I              F4UXST                          WAUXST
     I              F4AATM                          WAAATM
     I              F4AYNA                          WAAYNA
     I              F4A0NA                          WAA0NA
     I              F4AXDT                          WAAXDT
      *
     I@FHSTD2
      * Sales History             Update index
      * Renamed input format fields
     I              F4AIC3                          WBAIC3
     I              F4C4NB                          WBC4NB
     I              F4DPNB                          WBDPNB
     I              F4UENB                          WBUENB
     I              F4MONA                          WBMONA
     I              F4RJCD                          WBRJCD
     I              F4RKCD                          WBRKCD
     I              F4GPTX                          WBGPTX
     I              F4ABTX                          WBABTX
     I              F4KXCD                          WBKXCD
     I              F4BOCD                          WBBOCD
     I              F4BTC7                          WBBTC7
     I              F4ANC7                          WBANC7
     I              F4AQTX                          WBAQTX
     I              F4BKC7                          WBBKC7
     I              F4BRTX                          WBBRTX
     I              F4HNNA                          WBHNNA
     I              F4DBCD                          WBDBCD
     I              F4CKTX                          WBCKTX
     I              F4BCNA                          WBBCNA
     I              F4A0DT                          WBA0DT
     I              F4ACDT                          WBACDT
     I              F4R4CD                          WBR4CD
     I              F4R5CD                          WBR5CD
     I              F4BFCD                          WBBFCD
     I              F4Q4CD                          WBQ4CD
     I              F4AQCD                          WBAQCD
     I              F4TBNB                          WBTBNB
     I              F4BZNA                          WBBZNA
     I              F4RLCD                          WBRLCD
     I              F4JNCD                          WBJNCD
     I              F4Q2CD                          WBQ2CD
     I              F4U2ST                          WBU2ST
     I              F4ATIN                          WBATIN
     I              F4T3NB                          WBT3NB
     I              F4RSRN                          WBRSRN
     I              F4ORIT                          WBORIT
     I              F4AJCD                          WBAJCD
     I              F4AVQT                          WBAVQT
     I              F4D0WG                          WBD0WG
     I              F4CCQT                          WBCCQT
     I              F4AUWG                          WBAUWG
     I              F4AGCD                          WBAGCD
     I              F4AKPR                          WBAKPR
     I              F4AUPR                          WBAUPR
     I              F4CRCD                          WBCRCD
     I              F4A5DT                          WBA5DT
     I              F4AWDT                          WBAWDT
     I              F4HDDT                          WBHDDT
     I              F4AGCS                          WBAGCS
     I              F4AQCS                          WBAQCS
     I              F4AVWG                          WBAVWG
     I              F4AYVA                          WBAYVA
     I              F4AMST                          WBAMST
     I              F4ANST                          WBANST
     I              F4VAST                          WBVAST
     I              F4L6NB                          WBL6NB
     I              F4UMCD                          WBUMCD
     I              F4HCDT                          WBHCDT
     I              F4ESNB                          WBESNB
     I              F4ETNB                          WBETNB
     I              F4BZNB                          WBBZNB
     I              F4EXQT                          WBEXQT
     I              F4BYWG                          WBBYWG
     I              F4S5NB                          WBS5NB
     I              F4MAVA                          WBMAVA
     I              F4KDVA                          WBKDVA
     I              F4USVA                          WBUSVA
     I              F4UTVA                          WBUTVA
     I              F4A4WG                          WBA4WG
     I              F4CKNB                          WBCKNB
     I              F4BMST                          WBBMST
     I              F4R8NB                          WBR8NB
     I              F4RMCD                          WBRMCD
     I              F4BZPR                          WBBZPR
     I              F4RDCD                          WBRDCD
     I              F4Q7CD                          WBQ7CD
     I              F4EXDT                          WBEXDT
     I              F4LQCD                          WBLQCD
     I              F4HICD                          WBHICD
     I              F4RBCD                          WBRBCD
     I              F4RGNB                          WBRGNB
     I              F4RHNB                          WBRHNB
     I              F4RINB                          WBRINB
     I              F4R1NB                          WBR1NB
     I              F4CONB                          WBCONB
     I              F4CEST                          WBCEST
     I              F4GNDT                          WBGNDT
     I              F4RMNB                          WBRMNB
     I              F4AODT                          WBAODT
     I              F4LLCD                          WBLLCD
     I              F4LMCD                          WBLMCD
     I              F4SKNB                          WBSKNB
     I              F4SLNB                          WBSLNB
     I              F4SMNB                          WBSMNB
     I              F4G7NA                          WBG7NA
     I              F4ONVA                          WBONVA
     I              F4N0CD                          WBN0CD
     I              F4B4NB                          WBB4NB
     I              F4B5NB                          WBB5NB
     I              F4N1CD                          WBN1CD
     I              F4GIDT                          WBGIDT
     I              F4Z1ST                          WBZ1ST
     I              F4ULVA                          WBULVA
     I              F4UNVA                          WBUNVA
     I              F4UOVA                          WBUOVA
     I              F4UPVA                          WBUPVA
     I              F4UQVA                          WBUQVA
     I              F4SDCD                          WBSDCD
     I              F4QZCD                          WBQZCD
     I              F4XWST                          WBXWST
     I              F4T9CD                          WBT9CD
     I              F4UBCD                          WBUBCD
     I              F4CFC7                          WBCFC7
     I              F4X1CD                          WBX1CD
     I              F4GASX                          WBGASX
     I              F4DUPR                          WBDUPR
     I              F4B6VL                          WBB6VL
     I              F4IANX                          WBIANX
     I              F4IBNX                          WBIBNX
     I              F4RPCD                          WBRPCD
     I              F4NYDT                          WBNYDT
     I              F4BZTM                          WBBZTM
     I              F4Z4NB                          WBZ4NB
     I              F4XACD                          WBXACD
     I              F4OANA                          WBOANA
     I              F4OKTX                          WBOKTX
     I              F4K4TX                          WBK4TX
     I              F4NBBO                          WBNBBO
     I              F4OCFR                          WBOCFR
     I              F4C0C7                          WBC0C7
     I              F4A1AA                          WBA1AA
     I              F4VEST                          WBVEST
     I              F4A5PR                          WBA5PR
     I              F4CDPR                          WBCDPR
     I              F4D0PR                          WBD0PR
     I              F4D0VL                          WBD0VL
     I              F4IRSX                          WBIRSX
     I              F4CEVL                          WBCEVL
     I              F4ISSX                          WBISSX
     I              F4ITSX                          WBITSX
     I              F4IUSX                          WBIUSX
     I              F4OHDT                          WBOHDT
     I              F4D9PR                          WBD9PR
     I              F4CFVL                          WBCFVL
     I              F4UVST                          WBUVST
     I              F4UWST                          WBUWST
     I              F4UXST                          WBUXST
     I              F4AATM                          WBAATM
     I              F4AYNA                          WBAYNA
     I              F4A0NA                          WBA0NA
     I              F4AXDT                          WBAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WCAIC3
     I              BEC4NB                          WCC4NB
     I              BEJNCD                          WCJNCD
     I              BEANC7                          WCANC7
     I              BEBKC7                          WCBKC7
     I              BEBRTX                          WCBRTX
     I              BEHMNA                          WCHMNA
     I              BEHONA                          WCHONA
     I              BEHPNA                          WCHPNA
     I              BEHNNA                          WCHNNA
     I              BEDBCD                          WCDBCD
     I              BECKTX                          WCCKTX
     I              BEB0C7                          WCB0C7
     I              BEAETX                          WCAETX
     I              BEB1NA                          WCB1NA
     I              BEB3NA                          WCB3NA
     I              BEB4NA                          WCB4NA
     I              BEB2NA                          WCB2NA
     I              BEBHCD                          WCBHCD
     I              BEC8TX                          WCC8TX
     I              BEBCNA                          WCBCNA
     I              BEA0DT                          WCA0DT
     I              BEA5DT                          WCA5DT
     I              BEGNDT                          WCGNDT
     I              BEACDT                          WCACDT
     I              BEAQCD                          WCAQCD
     I              BEB6NA                          WCB6NA
     I              BEBYNA                          WCBYNA
     I              BEBZNA                          WCBZNA
     I              BEGTST                          WCGTST
     I              BEGVST                          WCGVST
     I              BEGUST                          WCGUST
     I              BEQFST                          WCQFST
     I              BECQCD                          WCCQCD
     I              BEGJST                          WCGJST
     I              BEGWST                          WCGWST
     I              BEGXST                          WCGXST
     I              BEGYST                          WCGYST
     I              BEAODT                          WCAODT
     I              BEAIVN                          WCAIVN
     I              BECXDT                          WCCXDT
     I              BEJZVA                          WCJZVA
     I              BEA1WG                          WCA1WG
     I              BEXIST                          WCXIST
     I              BEXJST                          WCXJST
     I              BEXKST                          WCXKST
     I              BEEIDT                          WCEIDT
     I              BEAFTM                          WCAFTM
     I              BEE8CD                          WCE8CD
     I              BEE9CD                          WCE9CD
     I              BERMNB                          WCRMNB
     I              BETBNB                          WCTBNB
     I              BER1NB                          WCR1NB
     I              BEPJST                          WCPJST
     I              BEU0ST                          WCU0ST
     I              BEU1ST                          WCU1ST
     I              BEQ2CD                          WCQ2CD
     I              BEU2ST                          WCU2ST
     I              BEVEST                          WCVEST
     I              BEVFST                          WCVFST
     I              BEVGST                          WCVGST
     I              BERPCD                          WCRPCD
     I              BERNNB                          WCRNNB
     I              BEVDST                          WCVDST
     I              BEATIN                          WCATIN
     I              BEU4ST                          WCU4ST
     I              BEU5ST                          WCU5ST
     I              BERSRN                          WCRSRN
     I              BEMHNA                          WCMHNA
     I              BEMINA                          WCMINA
     I              BEWBST                          WCWBST
     I              BER4CD                          WCR4CD
     I              BEBFCD                          WCBFCD
     I              BEQ4CD                          WCQ4CD
     I              BET3NB                          WCT3NB
     I              BESICD                          WCSICD
     I              BECONB                          WCCONB
     I              BECEST                          WCCEST
     I              BEAWDT                          WCAWDT
     I              BEJPCD                          WCJPCD
     I              BEXUST                          WCXUST
     I              BEZ1ST                          WCZ1ST
     I              BEVRVA                          WCVRVA
     I              BEOBST                          WCOBST
     I              BEBCST                          WCBCST
     I              BEBDST                          WCBDST
     I              BEB7VL                          WCB7VL
     I              BEGASX                          WCGASX
     I              BEGBSX                          WCGBSX
     I              BEGCSX                          WCGCSX
     I              BEGDSX                          WCGDSX
     I              BEFNSX                          WCFNSX
     I              BEFOSX                          WCFOSX
     I              BEFPSX                          WCFPSX
     I              BEFQSX                          WCFQSX
     I              BEFRSX                          WCFRSX
     I              BEFSSX                          WCFSSX
     I              BEFTSX                          WCFTSX
     I              BEFUSX                          WCFUSX
     I              BEFVSX                          WCFVSX
     I              BEFWSX                          WCFWSX
     I              BEFXSX                          WCFXSX
     I              BEFYSX                          WCFYSX
     I              BENODT                          WCNODT
     I              BENPDT                          WCNPDT
     I              BENQDT                          WCNQDT
     I              BENRDT                          WCNRDT
     I              BENSDT                          WCNSDT
     I              BEBPTM                          WCBPTM
     I              BEBQTM                          WCBQTM
     I              BEBRTM                          WCBRTM
     I              BEBSTM                          WCBSTM
     I              BEBTTM                          WCBTTM
     I              BEH0NX                          WCH0NX
     I              BEH1NX                          WCH1NX
     I              BEH2NX                          WCH2NX
     I              BEH3NX                          WCH3NX
     I              BEH4NX                          WCH4NX
     I              BEC0C7                          WCC0C7
     I              BEUVST                          WCUVST
     I              BEUWST                          WCUWST
     I              BEUXST                          WCUXST
     I              BEAATM                          WCAATM
     I              BEAYNA                          WCAYNA
     I              BEA0NA                          WCA0NA
     I              BEAXDT                          WCAXDT
      *
     I@AGREFD
      * Sales Expenses            Active Sales Expenses
      * Renamed input format fields
     I              AGBGAA                          WDBGAA
     I              AGAUNA                          WDAUNA
     I              AGINSX                          WDINSX
     I              AGIOSX                          WDIOSX
     I              AGUVST                          WDUVST
     I              AGUWST                          WDUWST
     I              AGUXST                          WDUXST
     I              AGVSST                          WDVSST
     I              AGAATM                          WDAATM
     I              AGAYNA                          WDAYNA
     I              AGA0NA                          WDA0NA
     I              AGAXDT                          WDAXDT
      *
     I@AHREE9
      * Sales Exp Brokerage Fee   Co/Cust/EffDate (D)
      * Renamed input format fields
     I              AHAIC3                          WEAIC3
     I              AHDUC7                          WEDUC7
     I              AHAUDT                          WEAUDT
     I              AHE5PC                          WEE5PC
     I              AHUVST                          WEUVST
     I              AHUWST                          WEUWST
     I              AHUXST                          WEUXST
     I              AHVSST                          WEVSST
     I              AHAATM                          WEAATM
     I              AHAYNA                          WEAYNA
     I              AHA0NA                          WEA0NA
     I              AHAXDT                          WEAXDT
      *
     I@AIREFC
      * Sales Exp Freezer Storage Co/Whs/Unit/EffctDate (D
      * Renamed input format fields
     I              AIAIC3                          WFAIC3
     I              AIAJCD                          WFAJCD
     I              AIIWSX                          WFIWSX
     I              AIAUDT                          WFAUDT
     I              AIBGCS                          WFBGCS
     I              AIMVNX                          WFMVNX
     I              AIUVST                          WFUVST
     I              AIUWST                          WFUWST
     I              AIUXST                          WFUXST
     I              AIVSST                          WFVSST
     I              AIAATM                          WFAATM
     I              AIAYNA                          WFAYNA
     I              AIA0NA                          WFA0NA
     I              AIAXDT                          WFAXDT
      *
     I@AKCPFB
      * Sales Exp Payment Intrst  Co/Cust/Effctv Date (D)
      * Renamed input format fields
     I              AKAIC3                          WGAIC3
     I              AKDUC7                          WGDUC7
     I              AKAUDT                          WGAUDT
     I              AKE6PC                          WGE6PC
     I              AKUVST                          WGUVST
     I              AKUWST                          WGUWST
     I              AKUXST                          WGUXST
     I              AKVSST                          WGVSST
     I              AKAATM                          WGAATM
     I              AKAYNA                          WGAYNA
     I              AKA0NA                          WGA0NA
     I              AKAXDT                          WGAXDT
      *
     I@AJREFA
      * Sales Exp Pallet Usage    Co/Effective Date (D)
      * Renamed input format fields
     I              AJAIC3                          WHAIC3
     I              AJAUDT                          WHAUDT
     I              AJBDCS                          WHBDCS
     I              AJUVST                          WHUVST
     I              AJUWST                          WHUWST
     I              AJUXST                          WHUXST
     I              AJVSST                          WHVSST
     I              AJAATM                          WHAATM
     I              AJAYNA                          WHAYNA
     I              AJA0NA                          WHA0NA
     I              AJAXDT                          WHAXDT
      *
     I@AMCPFZ
      * Sales Exp Brokerage /Item Co/Cust/Effctv Dt (D)
      * Renamed input format fields
     I              AMAIC3                          WIAIC3
     I              AMHGCD                          WIHGCD
     I              AMAUDT                          WIAUDT
     I              AMBFCS                          WIBFCS
     I              AMUVST                          WIUVST
     I              AMUWST                          WIUWST
     I              AMUXST                          WIUXST
     I              AMVSST                          WIVSST
     I              AMAATM                          WIAATM
     I              AMAYNA                          WIAYNA
     I              AMA0NA                          WIA0NA
     I              AMAXDT                          WIAXDT
      *
     I@AOCPGA
      * Sales Exp Brokerage /Ctry Co/Country/Eff Dt (D)
      * Renamed input format fields
     I              AOAIC3                          WJAIC3
     I              AOUMCD                          WJUMCD
     I              AOAUDT                          WJAUDT
     I              AOE5PC                          WJE5PC
     I              AOUVST                          WJUVST
     I              AOUWST                          WJUWST
     I              AOUXST                          WJUXST
     I              AOVSST                          WJVSST
     I              AOAATM                          WJAATM
     I              AOAYNA                          WJAYNA
     I              AOA0NA                          WJA0NA
     I              AOAXDT                          WJAXDT
      *
     I@ALCPE7
      * Sales History Expense Dtl Update index
      * Renamed input format fields
     I              ALAIC3                          WKAIC3
     I              ALC4NB                          WKC4NB
     I              ALDPNB                          WKDPNB
     I              ALUENB                          WKUENB
     I              ALBGAA                          WKBGAA
     I              ALDUC7                          WKDUC7
     I              ALCBVL                          WKCBVL
     I              ALCGVL                          WKCGVL
     I              ALCHVL                          WKCHVL
     I              ALE7PC                          WKE7PC
     I              ALE8PC                          WKE8PC
     I              ALMONX                          WKMONX
     I              ALIPSX                          WKIPSX
     I              ALIQSX                          WKIQSX
     I              ALOBDT                          WKOBDT
     I              ALOCDT                          WKOCDT
     I              ALBHAA                          WKBHAA
     I              ALUVST                          WKUVST
     I              ALUWST                          WKUWST
     I              ALUXST                          WKUXST
     I              ALAATM                          WKAATM
     I              ALAYNA                          WKAYNA
     I              ALA0NA                          WKA0NA
     I              ALAXDT                          WKAXDT
      *
     I@FNCPCT
      * Manifest Detail           Retrieval index
      * Renamed input format fields
     I              FNAIC3                          WLAIC3
     I              FNC4NB                          WLC4NB
     I              FNDPNB                          WLDPNB
     I              FNUENB                          WLUENB
     I              FNRZNB                          WLRZNB
     I              FNFOQT                          WLFOQT
     I              FNR0NB                          WLR0NB
     I              FNPMST                          WLPMST
     I              FNK7DT                          WLK7DT
     I              FNPFNX                          WLPFNX
     I              FNHGCD                          WLHGCD
     I              FNAJCD                          WLAJCD
     I              FNELDT                          WLELDT
     I              FNN5WG                          WLN5WG
     I              FNRZNA                          WLRZNA
     I              FNH5NY                          WLH5NY
     I              FNH6NY                          WLH6NY
     I              FNH7NY                          WLH7NY
     I              FNGBTX                          WLGBTX
     I              FNN6WG                          WLN6WG
     I              FNN7WG                          WLN7WG
     I              FNGCTX                          WLGCTX
     I              FNGDTX                          WLGDTX
     I              FNRBDT                          WLRBDT
     I              FNITNY                          WLITNY
     I              FNIVNY                          WLIVNY
     I              FNIUNY                          WLIUNY
     I              FNIWNY                          WLIWNY
     I              FNIXNY                          WLIXNY
     I              FNIYNY                          WLIYNY
     I              FNUVST                          WLUVST
     I              FNUWST                          WLUWST
     I              FNUXST                          WLUXST
     I              FNVSST                          WLVSST
     I              FNAATM                          WLAATM
     I              FNAYNA                          WLAYNA
     I              FNA0NA                          WLA0NA
     I              FNAXDT                          WLAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQOMHS1    E DSOMHSTPL0
      * UPD : Sales History             Update index
      * Renamed input format fields
     I              F4AIC3                          WBAIC3
     I              F4C4NB                          WBC4NB
     I              F4DPNB                          WBDPNB
     I              F4UENB                          WBUENB
     I              F4MONA                          WBMONA
     I              F4RJCD                          WBRJCD
     I              F4RKCD                          WBRKCD
     I              F4GPTX                          WBGPTX
     I              F4ABTX                          WBABTX
     I              F4KXCD                          WBKXCD
     I              F4BOCD                          WBBOCD
     I              F4BTC7                          WBBTC7
     I              F4ANC7                          WBANC7
     I              F4AQTX                          WBAQTX
     I              F4BKC7                          WBBKC7
     I              F4BRTX                          WBBRTX
     I              F4HNNA                          WBHNNA
     I              F4DBCD                          WBDBCD
     I              F4CKTX                          WBCKTX
     I              F4BCNA                          WBBCNA
     I              F4A0DT                          WBA0DT
     I              F4ACDT                          WBACDT
     I              F4R4CD                          WBR4CD
     I              F4R5CD                          WBR5CD
     I              F4BFCD                          WBBFCD
     I              F4Q4CD                          WBQ4CD
     I              F4AQCD                          WBAQCD
     I              F4TBNB                          WBTBNB
     I              F4BZNA                          WBBZNA
     I              F4RLCD                          WBRLCD
     I              F4JNCD                          WBJNCD
     I              F4Q2CD                          WBQ2CD
     I              F4U2ST                          WBU2ST
     I              F4ATIN                          WBATIN
     I              F4T3NB                          WBT3NB
     I              F4RSRN                          WBRSRN
     I              F4ORIT                          WBORIT
     I              F4AJCD                          WBAJCD
     I              F4AVQT                          WBAVQT
     I              F4D0WG                          WBD0WG
     I              F4CCQT                          WBCCQT
     I              F4AUWG                          WBAUWG
     I              F4AGCD                          WBAGCD
     I              F4AKPR                          WBAKPR
     I              F4AUPR                          WBAUPR
     I              F4CRCD                          WBCRCD
     I              F4A5DT                          WBA5DT
     I              F4AWDT                          WBAWDT
     I              F4HDDT                          WBHDDT
     I              F4AGCS                          WBAGCS
     I              F4AQCS                          WBAQCS
     I              F4AVWG                          WBAVWG
     I              F4AYVA                          WBAYVA
     I              F4AMST                          WBAMST
     I              F4ANST                          WBANST
     I              F4VAST                          WBVAST
     I              F4L6NB                          WBL6NB
     I              F4UMCD                          WBUMCD
     I              F4HCDT                          WBHCDT
     I              F4ESNB                          WBESNB
     I              F4ETNB                          WBETNB
     I              F4BZNB                          WBBZNB
     I              F4EXQT                          WBEXQT
     I              F4BYWG                          WBBYWG
     I              F4S5NB                          WBS5NB
     I              F4MAVA                          WBMAVA
     I              F4KDVA                          WBKDVA
     I              F4USVA                          WBUSVA
     I              F4UTVA                          WBUTVA
     I              F4A4WG                          WBA4WG
     I              F4CKNB                          WBCKNB
     I              F4BMST                          WBBMST
     I              F4R8NB                          WBR8NB
     I              F4RMCD                          WBRMCD
     I              F4BZPR                          WBBZPR
     I              F4RDCD                          WBRDCD
     I              F4Q7CD                          WBQ7CD
     I              F4EXDT                          WBEXDT
     I              F4LQCD                          WBLQCD
     I              F4HICD                          WBHICD
     I              F4RBCD                          WBRBCD
     I              F4RGNB                          WBRGNB
     I              F4RHNB                          WBRHNB
     I              F4RINB                          WBRINB
     I              F4R1NB                          WBR1NB
     I              F4CONB                          WBCONB
     I              F4CEST                          WBCEST
     I              F4GNDT                          WBGNDT
     I              F4RMNB                          WBRMNB
     I              F4AODT                          WBAODT
     I              F4LLCD                          WBLLCD
     I              F4LMCD                          WBLMCD
     I              F4SKNB                          WBSKNB
     I              F4SLNB                          WBSLNB
     I              F4SMNB                          WBSMNB
     I              F4G7NA                          WBG7NA
     I              F4ONVA                          WBONVA
     I              F4N0CD                          WBN0CD
     I              F4B4NB                          WBB4NB
     I              F4B5NB                          WBB5NB
     I              F4N1CD                          WBN1CD
     I              F4GIDT                          WBGIDT
     I              F4Z1ST                          WBZ1ST
     I              F4ULVA                          WBULVA
     I              F4UNVA                          WBUNVA
     I              F4UOVA                          WBUOVA
     I              F4UPVA                          WBUPVA
     I              F4UQVA                          WBUQVA
     I              F4SDCD                          WBSDCD
     I              F4QZCD                          WBQZCD
     I              F4XWST                          WBXWST
     I              F4T9CD                          WBT9CD
     I              F4UBCD                          WBUBCD
     I              F4CFC7                          WBCFC7
     I              F4X1CD                          WBX1CD
     I              F4GASX                          WBGASX
     I              F4DUPR                          WBDUPR
     I              F4B6VL                          WBB6VL
     I              F4IANX                          WBIANX
     I              F4IBNX                          WBIBNX
     I              F4RPCD                          WBRPCD
     I              F4NYDT                          WBNYDT
     I              F4BZTM                          WBBZTM
     I              F4Z4NB                          WBZ4NB
     I              F4XACD                          WBXACD
     I              F4OANA                          WBOANA
     I              F4OKTX                          WBOKTX
     I              F4K4TX                          WBK4TX
     I              F4NBBO                          WBNBBO
     I              F4OCFR                          WBOCFR
     I              F4C0C7                          WBC0C7
     I              F4A1AA                          WBA1AA
     I              F4VEST                          WBVEST
     I              F4A5PR                          WBA5PR
     I              F4CDPR                          WBCDPR
     I              F4D0PR                          WBD0PR
     I              F4D0VL                          WBD0VL
     I              F4IRSX                          WBIRSX
     I              F4CEVL                          WBCEVL
     I              F4ISSX                          WBISSX
     I              F4ITSX                          WBITSX
     I              F4IUSX                          WBIUSX
     I              F4OHDT                          WBOHDT
     I              F4D9PR                          WBD9PR
     I              F4CFVL                          WBCFVL
     I              F4UVST                          WBUVST
     I              F4UWST                          WBUWST
     I              F4UXST                          WBUXST
     I              F4AATM                          WBAATM
     I              F4AYNA                          WBAYNA
     I              F4A0NA                          WBA0NA
     I              F4AXDT                          WBAXDT
      *
     IYARDCS      DS                            792
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPOAL1    E DSPOALCPL0
      * UPD : Sales History Expense Dtl Update index
      * Renamed input format fields
     I              ALAIC3                          WKAIC3
     I              ALC4NB                          WKC4NB
     I              ALDPNB                          WKDPNB
     I              ALUENB                          WKUENB
     I              ALBGAA                          WKBGAA
     I              ALDUC7                          WKDUC7
     I              ALCBVL                          WKCBVL
     I              ALCGVL                          WKCGVL
     I              ALCHVL                          WKCHVL
     I              ALE7PC                          WKE7PC
     I              ALE8PC                          WKE8PC
     I              ALMONX                          WKMONX
     I              ALIPSX                          WKIPSX
     I              ALIQSX                          WKIQSX
     I              ALOBDT                          WKOBDT
     I              ALOCDT                          WKOCDT
     I              ALBHAA                          WKBHAA
     I              ALUVST                          WKUVST
     I              ALUWST                          WKUWST
     I              ALUXST                          WKUXST
     I              ALAATM                          WKAATM
     I              ALAYNA                          WKAYNA
     I              ALA0NA                          WKA0NA
     I              ALAXDT                          WKAXDT
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Sales History
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Order Number
     I                                    P   3   60P1C4NB
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prc Sales History Exp XF
      * Prc Sales History Exp RT - Sales History  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Prc Sales History Exp RT - Sales History  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       YL0001           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
     C           *LIKE     DEFN WAC4NB    WQSA02           Order Number
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           WQSA02           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSA01           Company Number
     C                     Z-ADDP1C4NB    WQSA02           Order Number
      * Establish starting position
     C           KRSSA     SETLL@HSTPFT                    *
     C           KRSSA     READE@HSTPFT                  90*
      * Data record not found
     C   90                MOVEL'USR1241' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Record Selection processing
      * CASE: DB1.Invoice Suffix is IN, DM, or CM
     C           WACEST    IFEQ 'CM'                       *IF
     C           WACEST    OREQ 'DM'
     C           WACEST    OREQ 'IN'
      * Break in Order Seq
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.Order Sequence Number NE LCL.Order Sequence Numb
      *   |- c2    : DB1.Order Secondary Line Seq NE LCL.Order Secondary
      *   '-
     C           WADPNB    IFNE YL0002                     *IF
     C           WAUENB    ORNE YL0003                     *OR
      * CASE: LCL.First Time Flag is NO
     C           YL0001    IFEQ 'N'                        *IF
      * Update Sales history with status and total
      * CHG Exp Total Amt     CH - Sales History  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0004    WL0001           Company Number
     C                     Z-ADDYL0005    WL0002           Order Number
     C                     Z-ADDYL0002    WL0003           Order Sequence
     C                     Z-ADDYL0003    WL0004           Order Secondary
     C                     MOVEL'Y'       WL0005    P      Sales Expense P
     C                     Z-ADDYL0006    WL0006           Sales Expense T
     C                     EXSR SBCHRC
     C                     END                             *FI
     C                     Z-ADDWAAIC3    YL0004           Company Number
     C                     Z-ADDWAC4NB    YL0005           Order Number
     C                     Z-ADDWADPNB    YL0002           Order Sequence
     C                     Z-ADDWAUENB    YL0003           Order Secondary
     C                     Z-ADD0         YL0006           Total Amount
     C                     Z-ADDWAGNDT    YL0007           Actual Shipped
      * If CM/DM, get Attach to Order's Actual Shipped Date
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.Invoice Suffix is CM or DM
      *   |- c2    : DB1.Attach to Order Number is Not equal to zeros
      *   '-
     C           WACEST    IFEQ 'CM'                       *IF
     C           WACEST    OREQ 'DM'
     C           WAT3NB    ORNE *ZERO                      *OR
      * 12/08/06 PKD Use PAR.Shipping Company Number
      * Rtv Actual Ship Date  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAR8NB    WL0007           Company Number
     C                     Z-ADDWAT3NB    WL0008           Order Number
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0009    YN0001    P      Ship To Name
     C                     MOVELWL0010    YN0002    P      Ship To City
     C                     MOVELWL0011    YN0003    P      Ship To State C
     C                     Z-ADDWL0012    YL0007           Actual Shipped
      * CASE: LCL.Actual Shipped Date is not entered
     C           YL0007    IFEQ *ZERO                      *IF
     C                     Z-ADDWAGNDT    YL0007           Actual Shipped
     C                     END                             *FI
     C                     END                             *FI
      * Get Order's Expense Calculator Values
      * Rtv Sales Expns Actv  RT - Sales Expenses  * 
     C                     EXSR SDRVGN
     C                     MOVEL'N'       YL0001           First Time Flag
     C                     END                             *FI
      * Calculate & Accum the costs for this item
      * DSO Payment Interest Percent
     C                     EXSR UASUBR                     DSO Payment Int
      * Brokerage Fee %
     C                     EXSR UBSUBR                     Brokerage Fee %
      * Pallet Usage Cost
     C                     EXSR UCSUBR                     Pallet Usage Co
      * Freezer Cost
     C                     EXSR UDSUBR                     Freezer Cost
      * Brokerage Fee per Item and CWT
     C                     EXSR UESUBR                     Brokerage Fee p
      * Brokerage Fee per Export Country and CWT
     C                     EXSR UFSUBR                     Brokerage Fee p
     C                     END                             *FI
     C           KRSSA     READE@HSTPFT                  90*
     C                     ENDDO
      * USER: Exit processing
      * Update Last History Rcd
      * CASE: LCL.First Time Flag is NO
     C           YL0001    IFEQ 'N'                        *IF
      * Update Sales history with status and total
      * CHG Exp Total Amt     CH - Sales History  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0004    WL0001           Company Number
     C                     Z-ADDYL0005    WL0002           Order Number
     C                     Z-ADDYL0002    WL0003           Order Sequence
     C                     Z-ADDYL0003    WL0004           Order Secondary
     C                     MOVEL'Y'       WL0005    P      Sales Expense P
     C                     Z-ADDYL0006    WL0006           Sales Expense T
     C                     EXSR SBCHRC
     C                     END                             *FI
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCHRC    BEGSR
      *================================================================
      * CHG Exp Total Amt     CH - Sales History  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001 20        A/R City
     C                     MOVEL*BLANK    WN0002  2        A/R State
     C                     MOVEL*BLANK    WN0003  6        A/R County Code
     C                     MOVEL*BLANK    WN0004 11        A/R Zip/Postal
     C                     MOVEL*BLANK    WN0005 25        Alpha Search
     C                     MOVEL*BLANK    WN0006  6        Country Code
     C                     MOVEL*BLANK    WN0007  2        Type Code
     C                     Z-ADD*ZERO     WN0008  70       Parent Customer
     C                     Z-ADD*ZERO     WN0009  70       A/R Customer Nu
     C                     MOVEL*BLANK    WN0010 30        A/R Customer Na
     C                     Z-ADD*ZERO     WN0011  70       Ship To Custome
     C                     MOVEL*BLANK    WN0012 30        Ship To Name
     C                     MOVEL*BLANK    WN0013 20        Ship To City
     C                     MOVEL*BLANK    WN0014  2        Ship To State C
     C                     MOVEL*BLANK    WN0015 11        Ship To Zip/Pos
     C                     MOVEL*BLANK    WN0016 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0017  70       Order Date
     C                     Z-ADD*ZERO     WN0018  70       Cancel Date
     C                     MOVEL*BLANK    WN0019  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0020  3        Original Salesp
     C                     MOVEL*BLANK    WN0021  2        Manager Level C
     C                     MOVEL*BLANK    WN0022  3        VP Level Code
     C                     MOVEL*BLANK    WN0023  2        Terms Code
     C                     Z-ADD*ZERO     WN0024  52       Absorbed Freigh
     C                     MOVEL*BLANK    WN0025  3        Carrier Code
     C                     MOVEL*BLANK    WN0026  3        Order Header Re
     C                     MOVEL*BLANK    WN0027  2        Order Type - Sa
     C                     MOVEL*BLANK    WN0028  2        Shipping Method
     C                     MOVEL*BLANK    WN0029  1        Export Status
     C                     Z-ADD*ZERO     WN0030  70       Attach to Invoi
     C                     Z-ADD*ZERO     WN0031  70       Attach to Order
     C                     Z-ADD*ZERO     WN0032  70       Resell Referenc
     C                     Z-ADD*ZERO     WN0033  70       Original Item
     C                     MOVEL*BLANK    WN0034  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0035 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0036 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0037 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0038 112       Weight Schedule
     C                     MOVEL*BLANK    WN0039  2        U/M - Ordered
     C                     Z-ADD*ZERO     WN0040 114       Unit Price
     C                     Z-ADD*ZERO     WN0041 114       Unit Price Orde
     C                     MOVEL*BLANK    WN0042  2        U/M - Base Pric
     C                     Z-ADD*ZERO     WN0043  70       Requested Ship
     C                     Z-ADD*ZERO     WN0044  70       Invoice Date
     C                     Z-ADD*ZERO     WN0045  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0046 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0047 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0048 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0049 112       Extended Amount
     C                     MOVEL*BLANK    WN0050  1        Affect Inventor
     C                     MOVEL*BLANK    WN0051  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0052  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0053  70       Contract Number
     C                     MOVEL*BLANK    WN0054  6        Export Country
     C                     Z-ADD*ZERO     WN0055  70       LD Arrival Date
     C                     Z-ADD*ZERO     WN0056  40       Accounting Year
     C                     Z-ADD*ZERO     WN0057  20       Accounting Peri
     C                     Z-ADD*ZERO     WN0058  30       OM Week
     C                     Z-ADD*ZERO     WN0059 112       Quantity Billed
     C                     Z-ADD*ZERO     WN0060 112       Weight Billed
     C                     Z-ADD*ZERO     WN0061  70       Shipped Item Co
     C                     Z-ADD*ZERO     WN0062 112       Billing Detail
     C                     Z-ADD*ZERO     WN0063 112       Billing Detail
     C                     Z-ADD*ZERO     WN0064 112       FOB Gross Amoun
     C                     Z-ADD*ZERO     WN0065 112       Standard Overag
     C                     Z-ADD*ZERO     WN0066 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0067  80       G/L Document Nu
     C                     MOVEL*BLANK    WN0068  1        G/L Update Stat
     C                     Z-ADD*ZERO     WN0069  30       Shipping Compan
     C                     MOVEL*BLANK    WN0070  3        Order Detail Re
     C                     Z-ADD*ZERO     WN0071 114       Price Overage O
     C                     MOVEL*BLANK    WN0072  3        Date Method Cod
     C                     MOVEL*BLANK    WN0073  3        Price Method Co
     C                     Z-ADD*ZERO     WN0074  70       Market Pricing
     C                     MOVEL*BLANK    WN0075  3        Commodity Marke
     C                     MOVEL*BLANK    WN0076  2        Quality Level
     C                     MOVEL*BLANK    WN0077  2        Item Level
     C                     Z-ADD*ZERO     WN0078  30       Item Structure
     C                     Z-ADD*ZERO     WN0079  30       Item Structure
     C                     Z-ADD*ZERO     WN0080  30       Item Structure
     C                     Z-ADD*ZERO     WN0081 112       Rated Freight
     C                     Z-ADD*ZERO     WN0082  70       Invoice Number
     C                     MOVEL*BLANK    WN0083  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0084  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0085  70       Load ID
     C                     Z-ADD*ZERO     WN0086  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0087  3        Packaging Code
     C                     MOVEL*BLANK    WN0088  3        Item Market Cod
     C                     Z-ADD*ZERO     WN0089  20       Agrimetrics gro
     C                     Z-ADD*ZERO     WN0090  10       Agrimetrics pac
     C                     Z-ADD*ZERO     WN0091  20       Agrimetrics gra
     C                     MOVEL*BLANK    WN0092 30        Order Desc. Lin
     C                     Z-ADD*ZERO     WN0093 112       Actual Freight
     C                     MOVEL*BLANK    WN0094  3        Item Type Code
     C                     Z-ADD*ZERO     WN0095  30       PM R/M Type Cod
     C                     Z-ADD*ZERO     WN0096  50       PM Line Number
     C                     MOVEL*BLANK    WN0097  3        SH Unused (was
     C                     Z-ADD*ZERO     WN0098  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0099  1        Modified Flag
     C                     Z-ADD*ZERO     WN0100 112       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0101 112       Ledgrd Trd Fund
     C                     Z-ADD*ZERO     WN0102 112       Commission Amou
     C                     Z-ADD*ZERO     WN0103 112       Financials Amou
     C                     Z-ADD*ZERO     WN0104 112       Financials Amou
     C                     MOVEL*BLANK    WN0105  1        Group for Packa
     C                     MOVEL*BLANK    WN0106  2        Base/Conv/Loss
     C                     MOVEL*BLANK    WN0107  1        Variety/Rendere
     C                     MOVEL*BLANK    WN0108  3        Customer Group
     C                     MOVEL*BLANK    WN0109  3        Customer Group
     C                     Z-ADD*ZERO     WN0110  70       Order Group Cod
     C                     MOVEL*BLANK    WN0111  4        Shipping Zone C
     C                     MOVEL*BLANK    WN0112  1        Invoice Price T
     C                     Z-ADD*ZERO     WN0113 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0114 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0115  30       Req Shipping Te
     C                     Z-ADD*ZERO     WN0116  30       Actual Shipping
     C                     MOVEL*BLANK    WN0117  1        Age Code
     C                     Z-ADD*ZERO     WN0118  70       Req Delivery Da
     C                     Z-ADD*ZERO     WN0119  60       Req Delivery Ti
     C                     Z-ADD*ZERO     WN0120  70       MPC Number
     C                     MOVEL*BLANK    WN0121  3        Shipping Line
     C                     MOVEL*BLANK    WN0122 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0123 25        Port City
     C                     MOVEL*BLANK    WN0124 30        Vessel Name
     C                     MOVEL*BLANK    WN0125 12        Booking Number
     C                     Z-ADD*ZERO     WN0126 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0127  70       Claim Number
     C                     Z-ADD*ZERO     WN0128  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0129  1        Palletize
     C                     Z-ADD*ZERO     WN0130 114       Commodity Marke
     C                     Z-ADD*ZERO     WN0131 114       Market Value
     C                     Z-ADD*ZERO     WN0132 114       Default Cmdty M
     C                     Z-ADD*ZERO     WN0133 114       Raw Material Co
     C                     MOVEL*BLANK    WN0134  1        Data Mart Proce
     C                     MOVEL*BLANK    WN0135  1        LH Load Type
     C                     MOVEL*BLANK    WN0136  2        Order TF Exempt
     C                     Z-ADD*ZERO     WN0137  70       LD Sail Date
     C                     Z-ADD*ZERO     WN0138 114       NonLedgrd TrdFn
     C                     Z-ADD*ZERO     WN0139 112       HST Item Target
     C                     MOVEL*BLANK    WN0140  1        EDI Status 1
     C                     MOVEL*BLANK    WN0141  1        EDI Status 2
     C                     MOVEL*BLANK    WN0142  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0143  60       Job Time
     C                     MOVEL*BLANK    WN0144 10        User Id
     C                     MOVEL*BLANK    WN0145 10        Job Name
     C                     Z-ADD*ZERO     WN0146  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @FHSTD2
     C                     Z-ADDWL0001    WBAIC3           Company Number
     C                     Z-ADDWL0002    WBC4NB           Order Number
     C                     Z-ADDWL0003    WBDPNB           Order Sequence
     C                     Z-ADDWL0004    WBUENB           Order Secondary
      *
     C           KLCHSB    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
     C                     KFLD           WBDPNB           Order Sequence
     C                     KFLD           WBUENB           Order Secondary
     C           KLCHSB    CHAIN@FHSTD2              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMHSTPL0'MDACP
     C                     MOVEL'@FHSTD2' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMHS1    YARDCS
      * USER: Processing after Data read
     C                     MOVEL'N'       WBISSX           Data Mart Proce
      * Move non-key fields to @FHSTD2
     C                     MOVELWL0005    WBIRSX    P      Sales Expense P
     C                     Z-ADDWL0006    WBCEVL           Sales Expense T
      *
      * Set PGM.*Record Data Changed flag
     C           QOMHS1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@FHSTD2                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMHSTPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Actual Ship Date  RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0007    WCAIC3           Company Number
     C                     Z-ADDWL0008    WCC4NB           Order Number
      * Establish starting position
     C           KRSSC     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0009           Ship To Name
     C                     MOVEL*BLANK    WL0010           Ship To City
     C                     MOVEL*BLANK    WL0011           Ship To State C
     C                     Z-ADD*ZERO     WL0012           Actual Shipped
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCBRTX    WL0009           Ship To Name
     C                     MOVELWCHNNA    WL0010           Ship To City
     C                     MOVELWCDBCD    WL0011           Ship To State C
     C                     Z-ADDWCGNDT    WL0012           Actual Shipped
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Sales Expns Actv  RT - Sales Expenses  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Establish starting position
     C           *LOVAL    SETLL@AGREFD                    *
     C                     READ @AGREFD                  90*
      * Data record not found
     C   90                MOVEL'USR2952' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Sales Expense Code is Brokerage Fee %
     C           WDBGAA    IFEQ 'BRK%1'                    *IF
      * Rtv Sales Exp Brk Fee RT - Sales Exp Brokerage Fee  * 
     C                     EXSR SERVGN
     C                     ELSE
      * CASE: DB1.Sales Expense Code is Freezer Storage Cost
     C           WDBGAA    IFEQ 'FRZ#1'                    *IF
     C                     MOVEL'CWT'     YL0010           Freezer Stg per
      * Rtv Freezer Expense   RT - Sales Exp Freezer Storage  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0013           Company Number
     C                     MOVELWAAJCD    WL0014    P      Warehouse Code
     C                     MOVEL'CWT'     WL0015    P      Freezer Stg per
     C                     Z-ADDYL0007    WL0016           Effective Date
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0017    YL0011           Freezer Storage
     C                     Z-ADDWL0018    WUMVNX           Freezer Free Da
     C                     MOVEL'DAY'     YL0018           Freezer Storage
      * Rtv Freezer Expense   RT - Sales Exp Freezer Storage  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0013           Company Number
     C                     MOVELWAAJCD    WL0014    P      Warehouse Code
     C                     MOVEL'DAY'     WL0015    P      Freezer Stg per
     C                     Z-ADDYL0007    WL0016           Effective Date
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0017    YL0019           Freezer Storage
     C                     Z-ADDWL0018    YL0012           Freezer Free Da
     C                     ELSE
      * CASE: DB1.Sales Expense Code is Payment Interest %
     C           WDBGAA    IFEQ 'PAY%1'                    *IF
      * Rtv Payment Intrst %  RT - Sales Exp Payment Intrst  * 
     C                     EXSR SGRVGN
     C                     ELSE
      * CASE: DB1.Sales Expense Code is Pallet Usage Cost
     C           WDBGAA    IFEQ 'PLT#1'                    *IF
      * Pallet usage
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Palletize is yes
      *   |- c2    : PAR.Affect Sales Pnds Status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAVEST    IFEQ 'Y'                        *IF
     C           WAVAST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Pallet Usage      RT - Sales Exp Pallet Usage  * 
     C                     EXSR SHRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD0         YL0013           Pallet Usage Co
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.Sales Expense Code is Brokerage Fee by Item
     C           WDBGAA    IFEQ 'BRK#1'                    *IF
      * Rtv Sales Exp Brkr Itm RT - Sales Exp Brokerage /Item  * 
     C                     EXSR SIRVGN
     C                     ELSE
      * CASE: DB1.Sales Expense Code is Brokerage Fee by Country
     C           WDBGAA    IFEQ 'BRKX1'                    *IF
      * Rtv Sales Exp Brkr Ctr RT - Sales Exp Brokerage /Ctry  * 
     C                     EXSR SJRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     READ @AGREFD                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Sales Exp Brk Fee RT - Sales Exp Brokerage Fee  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIC3    WQSE01           Company Number
     C           *LIKE     DEFN WEDUC7    WQSE02           A/R Customer
      * Define keylist
     C           KPSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WQSE02           A/R Customer
     C                     KFLD           WEAUDT           Effective Date
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WQSE02           A/R Customer
      * Setup key
     C                     Z-ADDWAAIC3    WQSE01           Company Number
     C                     Z-ADDWAANC7    WQSE02           A/R Customer
     C                     Z-ADDYL0007    WEAUDT           Effective Date
      * Establish starting position
     C           KPSSE     SETLL@AHREE9                    *
     C           KRSSE     READE@AHREE9                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2954' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0008           Brokerage Fee P
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWEE5PC    YL0008           Brokerage Fee P
     C                     GOTO SEEXIT                     *QUIT
     C           KRSSE     READE@AHREE9                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Freezer Expense   RT - Sales Exp Freezer Storage  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSF01           Company Number
     C           *LIKE     DEFN WFAJCD    WQSF02           Warehouse Code
     C           *LIKE     DEFN WFIWSX    WQSF03           Freezer Stg per
      * Define keylist
     C           KPSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Warehouse Code
     C                     KFLD           WQSF03           Freezer Stg per
     C                     KFLD           WFAUDT           Effective Date
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Warehouse Code
     C                     KFLD           WQSF03           Freezer Stg per
      * Setup key
     C                     Z-ADDWL0013    WQSF01           Company Number
     C                     MOVELWL0014    WQSF02           Warehouse Code
     C                     MOVELWL0015    WQSF03           Freezer Stg per
     C                     Z-ADDWL0016    WFAUDT           Effective Date
      * Establish starting position
     C           KPSSF     SETLL@AIREFC                    *
     C           KRSSF     READE@AIREFC                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2956' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0017           Freezer Storage
     C                     Z-ADD*ZERO     WL0018           Freezer Free Da
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWFBGCS    WL0017           Freezer Storage
     C                     Z-ADDWFMVNX    WL0018           Freezer Free Da
     C                     GOTO SFEXIT                     *QUIT
     C           KRSSF     READE@AIREFC                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Payment Intrst %  RT - Sales Exp Payment Intrst  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGAIC3    WQSG01           Company Number
     C           *LIKE     DEFN WGDUC7    WQSG02           A/R Customer
      * Define keylist
     C           KPSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           A/R Customer
     C                     KFLD           WGAUDT           Effective Date
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           A/R Customer
      * Setup key
     C                     Z-ADDWAAIC3    WQSG01           Company Number
     C                     Z-ADDWAANC7    WQSG02           A/R Customer
     C                     Z-ADDYL0007    WGAUDT           Effective Date
      * Establish starting position
     C           KPSSG     SETLL@AKCPFB                    *
     C           KRSSG     READE@AKCPFB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2960' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0009           Payment Interes
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWGE6PC    YL0009           Payment Interes
     C                     GOTO SGEXIT                     *QUIT
     C           KRSSG     READE@AKCPFB                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Pallet Usage      RT - Sales Exp Pallet Usage  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHAIC3    WQSH01           Company Number
      * Define keylist
     C           KPSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WHAUDT           Effective Date
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Company Number
      * Setup key
     C                     Z-ADDWAAIC3    WQSH01           Company Number
     C                     Z-ADDYL0007    WHAUDT           Effective Date
      * Establish starting position
     C           KPSSH     SETLL@AJREFA                    *
     C           KRSSH     READE@AJREFA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2958' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0013           Pallet Usage Co
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWHBDCS    YL0013           Pallet Usage Co
     C                     GOTO SHEXIT                     *QUIT
     C           KRSSH     READE@AJREFA                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Sales Exp Brkr Itm RT - Sales Exp Brokerage /Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIAIC3    WQSI01           Company Number
     C           *LIKE     DEFN WIHGCD    WQSI02           Item Code
      * Define keylist
     C           KPSSI     KLIST
     C                     KFLD           WQSI01           Company Number
     C                     KFLD           WQSI02           Item Code
     C                     KFLD           WIAUDT           Effective Date
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Company Number
     C                     KFLD           WQSI02           Item Code
      * Setup key
     C                     Z-ADDWAAIC3    WQSI01           Company Number
     C                     Z-ADDWAS5NB    WQSI02           Item Code
     C                     Z-ADDYL0007    WIAUDT           Effective Date
      * Establish starting position
     C           KPSSI     SETLL@AMCPFZ                    *
     C           KRSSI     READE@AMCPFZ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2968' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD*ZERO     YL0020           Brokerage Fee C
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWIBFCS    YL0020           Brokerage Fee C
     C                     GOTO SIEXIT                     *QUIT
     C           KRSSI     READE@AMCPFZ                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Sales Exp Brkr Ctr RT - Sales Exp Brokerage /Ctry  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJAIC3    WQSJ01           Company Number
     C           *LIKE     DEFN WJUMCD    WQSJ02           Export Country
      * Define keylist
     C           KPSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           Export Country
     C                     KFLD           WJAUDT           Effective Date
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           Export Country
      * Setup key
     C                     Z-ADDWAAIC3    WQSJ01           Company Number
     C                     MOVELWAUMCD    WQSJ02           Export Country
     C                     Z-ADDYL0007    WJAUDT           Effective Date
      * Establish starting position
     C           KPSSJ     SETLL@AOCPGA                    *
     C           KRSSJ     READE@AOCPGA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2974' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0017           Brokerage Fee P
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWJE5PC    YL0017           Brokerage Fee P
     C                     GOTO SJEXIT                     *QUIT
     C           KRSSJ     READE@AOCPGA                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCRRC    BEGSR
      *================================================================
      * Crt Sales History Exp CR - Sales History Expense Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @ALCPE7
     C                     Z-ADDWL0019    WKAIC3           Company Number
     C                     Z-ADDWL0020    WKC4NB           Order Number
     C                     Z-ADDWL0021    WKDPNB           Order Sequence
     C                     Z-ADDWL0022    WKUENB           Order Secondary
     C                     MOVELWL0023    WKBGAA           Sales Expense C
     C                     Z-ADDWL0024    WKDUC7           A/R Customer
     C                     Z-ADDWL0025    WKCBVL           Sales Expense A
     C                     Z-ADDWL0026    WKCGVL           SHE Unused Cost
     C                     Z-ADDWL0027    WKCHVL           SHE Unused Cost
     C                     Z-ADDWL0028    WKE7PC           SHE Unused Pct
     C                     Z-ADDWL0029    WKE8PC           SHE Unused Pct
     C                     Z-ADDWL0030    WKMONX           SHE Unused nbr
     C                     MOVELWL0031    WKIPSX           SHE Unused Sts
     C                     MOVELWL0032    WKIQSX           SHE Unused Sts
     C                     Z-ADDWL0033    WKOBDT           SHE Actual Ship
     C                     Z-ADDWL0034    WKOCDT           SHE Unused Date
     C                     MOVELWL0035    WKBHAA           SHE Unused Code
     C                     MOVELWL0036    WKUVST           EDI Status 1
     C                     MOVELWL0037    WKUWST           EDI Status 2
     C                     MOVELWL0038    WKUXST           EDI Status 3
     C                     Z-ADDWL0039    WKAATM           Job Time
     C                     MOVELWL0040    WKAYNA           User Id
     C                     MOVELWL0041    WKA0NA           Job Name
     C                     Z-ADDWL0042    WKAXDT           Job Date
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WKAATM           Job Time
     C                     MOVEL##USR     WKAYNA           User Id
     C                     MOVEL##JOB     WKA0NA           Job Name
     C                     Z-ADD##JDT     WKAXDT           Job Date
     C           KLCRSK    KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKC4NB           Order Number
     C                     KFLD           WKDPNB           Order Sequence
     C                     KFLD           WKUENB           Order Secondary
     C                     KFLD           WKBGAA           Sales Expense C
      * Check for duplicate primary key
     C           KLCRSK    SETLL@ALCPE7                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2963' W0RTN   7
      * Send message 'Sales History Expense  EX'
     C                     MOVEL'USR2963' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C                     WRITE@ALCPE7                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv to Calc Frzr Cost RT - Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLAIC3    WQSL01           Company Number
     C           *LIKE     DEFN WLC4NB    WQSL02           Order Number
     C           *LIKE     DEFN WLDPNB    WQSL03           Order Sequence
     C           *LIKE     DEFN WLUENB    WQSL04           Order Secondary
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Company Number
     C                     KFLD           WQSL02           Order Number
     C                     KFLD           WQSL03           Order Sequence
     C                     KFLD           WQSL04           Order Secondary
      * Setup key
     C                     Z-ADDWL0043    WQSL01           Company Number
     C                     Z-ADDWL0044    WQSL02           Order Number
     C                     Z-ADDWL0045    WQSL03           Order Sequence
     C                     Z-ADDWL0046    WQSL04           Order Secondary
      * Establish starting position
     C           KRSSL     SETLL@FNCPCT                    *
     C           KRSSL     READE@FNCPCT                  90*
      * Data record not found
     C   90                MOVEL'USR1196' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * There are 2 types of Freezer Expenses:
      *    If the unit on the FRZ#1 expense code for the warehouse is DAY
      *       the expense is calculated by taking the
      *        CWT * freezer cost * the number of days in the freezer.
      *    If the unit on the FRZ#1 expense code for the warehouse is CWT
      *       the expense is calculated by taking the
      *        CWT times the freezer cost.
      * Calc Freezer Expense if Unit is DAY on the Warehouse Freezer Exp
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Freezer Storage Unit 2 is Day
      *   |- c2    : PAR.Freezer Stg Cost/Unit 2 NE WRK.ZERO
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0051    IFEQ 'DAY'                      *IF
     C           WL0053    IFNE WUW0NB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * This expense is takes the CWT times the number of days in the fre
      * LCL.Days in Freezer       USR = PAR.Actual Shipped Date - DB1.Pro
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C           WLELDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           WL0048    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     YL0024
     C                     ELSE
     C           XDURR     MULT -1        YL0024
     C                     END
     C                     SUB  WL0052    YL0024           Days in Freezer
      * CASE: LCL.Days in Freezer       USR is GT Zero
     C           YL0024    IFGT 0                          *IF
      * Compute/Accum: Frzr p/day
      * PAR.Sales Expense Amount =
      *    *COMPUTE ((x1 * x2 * (x3/x4)) + x5)
      * x1    : LCL.Days in Freezer       USR
      * *     : PGM.*Synon (17,7) work field *
      * x2    : PAR.Freezer Stg Cost/Unit 2
      * *     : PGM.*Synon (17,7) work field *
      * x3    : DB1.Case Weight
      * /     : PGM.*Synon (17,7) work field *
      * x4    : CON.100
      * +     : PGM.*Synon (17,7) work field
      * x5    : PAR.Sales Expense Amount
     C           YL0024    MULT WL0053    W0WD02           *Synon (17,7) w
     C           WLR0NB    DIV  100       W0WD03           *Synon (17,7) w
     C           W0WD02    MULT W0WD03    W0WD01           *Synon (17,7) w
     C           W0WD01    ADD  WL0047    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WL0047           Sales Expense A
     C                     END                             *FI
     C                     END                             *FI
      * Calc freezer cost if unit is CWT.This is a one time expense per C
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Freezer Stg per Unit is Hundred Weight
      *   |- c2    : PAR.Freezer Storage Cost/Unit is Not equal to Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0050    IFEQ 'CWT'                      *IF
     C           WL0049    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Compute/Accum: Frzr p/cwt
      * PAR.Sales Expense Amount =
      *    *COMPUTE (x2 * (x3/x4) + x5)
      * x2    : PAR.Freezer Storage Cost/Unit
      * *     : PGM.*Synon (17,7) work field *
      * x3    : DB1.Case Weight
      * /     : PGM.*Synon (17,7) work field *
      * x4    : CON.100
      * +     : PGM.*Synon (17,7) work field
      * x5    : PAR.Sales Expense Amount
     C           WLR0NB    DIV  100       W0WD02           *Synon (17,7) w
     C           WL0049    MULT W0WD02    W0WD01           *Synon (17,7) w
     C           W0WD01    ADD  WL0047    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WL0047           Sales Expense A
     C                     END                             *FI
     C           KRSSL     READE@FNCPCT                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * DSO Payment Interest Percent
      *================================================================
      * Compute:Paym intrst cost
      * LCL.Sales Expense Amount =
      *    *COMPUTE (x1 * (x2/x3))
      * x1    : DB1.Billing Detail Gross Dol.
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : LCL.Payment Interest Pct
      * /     : PGM.*Synon (17,9) work field *
      * x3    : CON.100
     C           YL0009    DIV  100       W0WE01           *Synon (17,9) w
     C           WAKDVA    MULT W0WE01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0021           Sales Expense A
      * CASE: LCL.Sales Expense Amount NE WRK.ZERO
     C           YL0021    IFNE WUW0NB                     *IF
      * CASE: LCL.Sales Expense Amount LT WRK.ZERO
     C           YL0021    IFLT WUW0NB                     *IF
     C                     MULT -1        YL0021           Sales Expense A
     C                     END                             *FI
      * Crt Sales History Exp CR - Sales History Expense Dtl  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0019           Company Number
     C                     Z-ADDWAC4NB    WL0020           Order Number
     C                     Z-ADDWADPNB    WL0021           Order Sequence
     C                     Z-ADDWAUENB    WL0022           Order Secondary
     C                     MOVEL'PAY%1'   WL0023    P      Sales Expense C
     C                     Z-ADDWAANC7    WL0024           A/R Customer
     C                     Z-ADDYL0021    WL0025           Sales Expense A
     C                     Z-ADD*ZERO     WL0026           SHE Unused Cost
     C                     Z-ADD*ZERO     WL0027           SHE Unused Cost
     C                     Z-ADD*ZERO     WL0028           SHE Unused Pct
     C                     Z-ADD*ZERO     WL0029           SHE Unused Pct
     C                     Z-ADD*ZERO     WL0030           SHE Unused nbr
     C                     MOVELWUGSTX    WL0031    P      SHE Unused Sts
     C                     MOVELWUGSTX    WL0032    P      SHE Unused Sts
     C                     Z-ADDYL0007    WL0033           SHE Actual Ship
     C                     Z-ADD*ZERO     WL0034           SHE Unused Date
     C                     MOVELWUGSTX    WL0035    P      SHE Unused Code
     C                     MOVELWAUVST    WL0036    P      EDI Status 1
     C                     MOVELWAUWST    WL0037    P      EDI Status 2
     C                     MOVELWAUXST    WL0038    P      EDI Status 3
     C                     Z-ADDWAAATM    WL0039           Job Time
     C                     MOVELWAAYNA    WL0040    P      User Id
     C                     MOVELWAA0NA    WL0041    P      Job Name
     C                     Z-ADDWAAXDT    WL0042           Job Date
     C                     EXSR SKCRRC
     C                     ADD  YL0021    YL0006           Total Amount
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Brokerage Fee %
      *================================================================
      * Compute:broker fee amt
      * LCL.Sales Expense Amount =
      *    *COMPUTE (x1 * (x2/x3))
      * x1    : DB1.FOB Gross Amount
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : LCL.Brokerage Fee Pct
      * /     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           YL0008    DIV  100       W0WD01           *Synon (17,7) w
     C           WAUSVA    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0021           Sales Expense A
      * CASE: LCL.Sales Expense Amount NE WRK.ZERO
     C           YL0021    IFNE WUW0NB                     *IF
      * CASE: LCL.Sales Expense Amount LT WRK.ZERO
     C           YL0021    IFLT WUW0NB                     *IF
     C                     MULT -1        YL0021           Sales Expense A
     C                     END                             *FI
      * Crt Sales History Exp CR - Sales History Expense Dtl  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0019           Company Number
     C                     Z-ADDWAC4NB    WL0020           Order Number
     C                     Z-ADDWADPNB    WL0021           Order Sequence
     C                     Z-ADDWAUENB    WL0022           Order Secondary
     C                     MOVEL'BRK%1'   WL0023    P      Sales Expense C
     C                     Z-ADDWAANC7    WL0024           A/R Customer
     C                     Z-ADDYL0021    WL0025           Sales Expense A
     C                     Z-ADD*ZERO     WL0026           SHE Unused Cost
     C                     Z-ADD*ZERO     WL0027           SHE Unused Cost
     C                     Z-ADD*ZERO     WL0028           SHE Unused Pct
     C                     Z-ADD*ZERO     WL0029           SHE Unused Pct
     C                     Z-ADD*ZERO     WL0030           SHE Unused nbr
     C                     MOVELYL0022    WL0031    P      SHE Unused Sts
     C                     MOVELYL0023    WL0032    P      SHE Unused Sts
     C                     Z-ADDYL0007    WL0033           SHE Actual Ship
     C                     Z-ADD*ZERO     WL0034           SHE Unused Date
     C                     MOVELWUGSTX    WL0035    P      SHE Unused Code
     C                     MOVELWAUVST    WL0036    P      EDI Status 1
     C                     MOVELWAUWST    WL0037    P      EDI Status 2
     C                     MOVELWAUXST    WL0038    P      EDI Status 3
     C                     Z-ADDWAAATM    WL0039           Job Time
     C                     MOVELWAAYNA    WL0040    P      User Id
     C                     MOVELWAA0NA    WL0041    P      Job Name
     C                     Z-ADDWAAXDT    WL0042           Job Date
     C                     EXSR SKCRRC
     C                     ADD  YL0021    YL0006           Total Amount
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Pallet Usage Cost
      *================================================================
      * Compute: pallet usage
      * LCL.Sales Expense Amount =
      *    *COMPUTE (x1 * (x2/x3))
      * x1    : LCL.Pallet Usage Cost/CWT
      * *     : LCL.Sales Expense Amount *Rounded
      * x2    : DB1.Weight Billed
      * /     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           WABYWG    DIV  100       W0WD00           *Synon (17,7) w
     C           YL0013    MULT W0WD00    YL0021    H      Sales Expense A
     C                     Z-ADDYL0021    YL0021           Sales Expense A
      * CASE: LCL.Sales Expense Amount NE WRK.ZERO
     C           YL0021    IFNE WUW0NB                     *IF
      * CASE: LCL.Sales Expense Amount LT WRK.ZERO
     C           YL0021    IFLT WUW0NB                     *IF
     C                     MULT -1        YL0021           Sales Expense A
     C                     END                             *FI
      * Crt Sales History Exp CR - Sales History Expense Dtl  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0019           Company Number
     C                     Z-ADDWAC4NB    WL0020           Order Number
     C                     Z-ADDWADPNB    WL0021           Order Sequence
     C                     Z-ADDWAUENB    WL0022           Order Secondary
     C                     MOVEL'PLT#1'   WL0023    P      Sales Expense C
     C                     Z-ADDWAANC7    WL0024           A/R Customer
     C                     Z-ADDYL0021    WL0025           Sales Expense A
     C                     Z-ADD*ZERO     WL0026           SHE Unused Cost
     C                     Z-ADD*ZERO     WL0027           SHE Unused Cost
     C                     Z-ADD*ZERO     WL0028           SHE Unused Pct
     C                     Z-ADD*ZERO     WL0029           SHE Unused Pct
     C                     Z-ADD*ZERO     WL0030           SHE Unused nbr
     C                     MOVELYL0022    WL0031    P      SHE Unused Sts
     C                     MOVELYL0023    WL0032    P      SHE Unused Sts
     C                     Z-ADDYL0007    WL0033           SHE Actual Ship
     C                     Z-ADD*ZERO     WL0034           SHE Unused Date
     C                     MOVELWUGSTX    WL0035    P      SHE Unused Code
     C                     MOVELWAUVST    WL0036    P      EDI Status 1
     C                     MOVELWAUWST    WL0037    P      EDI Status 2
     C                     MOVELWAUXST    WL0038    P      EDI Status 3
     C                     Z-ADDWAAATM    WL0039           Job Time
     C                     MOVELWAAYNA    WL0040    P      User Id
     C                     MOVELWAA0NA    WL0041    P      Job Name
     C                     Z-ADDWAAXDT    WL0042           Job Date
     C                     EXSR SKCRRC
     C                     ADD  YL0021    YL0006           Total Amount
     C                     END                             *FI
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Freezer Cost
      *================================================================
      * CASE: LCL.Freezer Storage Cost/Unit is Not equal to Zero
     C           YL0011    IFNE 0                          *IF
     C                     Z-ADD*ZERO     YL0021           Sales Expense A
      * 12/08/06 PKD User Shipping Company Number
      * Rtv to Calc Frzr Cost RT - Manifest Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAR8NB    WL0043           Company Number
     C                     Z-ADDWAC4NB    WL0044           Order Number
     C                     Z-ADDWADPNB    WL0045           Order Sequence
     C                     Z-ADDWAUENB    WL0046           Order Secondary
     C                     Z-ADDYL0021    WL0047           Sales Expense A
     C                     Z-ADDYL0007    WL0048           Actual Shipped
     C                     Z-ADDYL0011    WL0049           Freezer Storage
     C                     MOVELYL0010    WL0050    P      Freezer Stg per
     C                     MOVELYL0018    WL0051    P      Freezer Storage
     C                     Z-ADDYL0012    WL0052           Freezer Free Da
     C                     Z-ADDYL0019    WL0053           Freezer Stg Cos
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0047    YL0021           Sales Expense A
      * CASE: LCL.Sales Expense Amount NE WRK.ZERO
     C           YL0021    IFNE WUW0NB                     *IF
      * Crt Sales History Exp CR - Sales History Expense Dtl  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0019           Company Number
     C                     Z-ADDWAC4NB    WL0020           Order Number
     C                     Z-ADDWADPNB    WL0021           Order Sequence
     C                     Z-ADDWAUENB    WL0022           Order Secondary
     C                     MOVEL'FRZ#1'   WL0023    P      Sales Expense C
     C                     Z-ADDWAANC7    WL0024           A/R Customer
     C                     Z-ADDYL0021    WL0025           Sales Expense A
     C                     Z-ADD*ZERO     WL0026           SHE Unused Cost
     C                     Z-ADD*ZERO     WL0027           SHE Unused Cost
     C                     Z-ADD*ZERO     WL0028           SHE Unused Pct
     C                     Z-ADD*ZERO     WL0029           SHE Unused Pct
     C                     Z-ADD*ZERO     WL0030           SHE Unused nbr
     C                     MOVELYL0022    WL0031    P      SHE Unused Sts
     C                     MOVELYL0023    WL0032    P      SHE Unused Sts
     C                     Z-ADDYL0007    WL0033           SHE Actual Ship
     C                     Z-ADD*ZERO     WL0034           SHE Unused Date
     C                     MOVELWUGSTX    WL0035    P      SHE Unused Code
     C                     MOVELWAUVST    WL0036    P      EDI Status 1
     C                     MOVELWAUWST    WL0037    P      EDI Status 2
     C                     MOVELWAUXST    WL0038    P      EDI Status 3
     C                     Z-ADDWAAATM    WL0039           Job Time
     C                     MOVELWAAYNA    WL0040    P      User Id
     C                     MOVELWAA0NA    WL0041    P      Job Name
     C                     Z-ADDWAAXDT    WL0042           Job Date
     C                     EXSR SKCRRC
     C                     ADD  YL0021    YL0006           Total Amount
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Brokerage Fee per Item and CWT
      *================================================================
      * Compute:broker fee /item
      * LCL.Sales Expense Amount =
      *    *COMPUTE (x1 * (x2/x3))
      * x1    : LCL.Brokerage Fee Cost/CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.Weight Billed
      * /     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           WABYWG    DIV  100       W0WD01           *Synon (17,7) w
     C           YL0020    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0021           Sales Expense A
      * CASE: LCL.Sales Expense Amount NE WRK.ZERO
     C           YL0021    IFNE WUW0NB                     *IF
      * CASE: LCL.Sales Expense Amount LT WRK.ZERO
     C           YL0021    IFLT WUW0NB                     *IF
     C                     MULT -1        YL0021           Sales Expense A
     C                     END                             *FI
      * Crt Sales History Exp CR - Sales History Expense Dtl  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0019           Company Number
     C                     Z-ADDWAC4NB    WL0020           Order Number
     C                     Z-ADDWADPNB    WL0021           Order Sequence
     C                     Z-ADDWAUENB    WL0022           Order Secondary
     C                     MOVEL'BRK#1'   WL0023    P      Sales Expense C
     C                     Z-ADDWAANC7    WL0024           A/R Customer
     C                     Z-ADDYL0021    WL0025           Sales Expense A
     C                     Z-ADD*ZERO     WL0026           SHE Unused Cost
     C                     Z-ADD*ZERO     WL0027           SHE Unused Cost
     C                     Z-ADD*ZERO     WL0028           SHE Unused Pct
     C                     Z-ADD*ZERO     WL0029           SHE Unused Pct
     C                     Z-ADD*ZERO     WL0030           SHE Unused nbr
     C                     MOVELYL0022    WL0031    P      SHE Unused Sts
     C                     MOVELYL0023    WL0032    P      SHE Unused Sts
     C                     Z-ADDYL0007    WL0033           SHE Actual Ship
     C                     Z-ADD*ZERO     WL0034           SHE Unused Date
     C                     MOVELWUGSTX    WL0035    P      SHE Unused Code
     C                     MOVELWAUVST    WL0036    P      EDI Status 1
     C                     MOVELWAUWST    WL0037    P      EDI Status 2
     C                     MOVELWAUXST    WL0038    P      EDI Status 3
     C                     Z-ADDWAAATM    WL0039           Job Time
     C                     MOVELWAAYNA    WL0040    P      User Id
     C                     MOVELWAA0NA    WL0041    P      Job Name
     C                     Z-ADDWAAXDT    WL0042           Job Date
     C                     EXSR SKCRRC
     C                     ADD  YL0021    YL0006           Total Amount
     C                     END                             *FI
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Brokerage Fee per Export Country and CWT
      *================================================================
      * Compute:broker fee /ctry
      * LCL.Sales Expense Amount =
      *    *COMPUTE (x1 * (x2/x3))
      * x1    : DB1.FOB Gross Amount
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : LCL.USR Brokerage Fee Pct/Ctr
      * /     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           YL0017    DIV  100       W0WD01           *Synon (17,7) w
     C           WAUSVA    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0021           Sales Expense A
      * CASE: LCL.Sales Expense Amount NE WRK.ZERO
     C           YL0021    IFNE WUW0NB                     *IF
      * CASE: LCL.Sales Expense Amount LT WRK.ZERO
     C           YL0021    IFLT WUW0NB                     *IF
     C                     MULT -1        YL0021           Sales Expense A
     C                     END                             *FI
      * Crt Sales History Exp CR - Sales History Expense Dtl  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0019           Company Number
     C                     Z-ADDWAC4NB    WL0020           Order Number
     C                     Z-ADDWADPNB    WL0021           Order Sequence
     C                     Z-ADDWAUENB    WL0022           Order Secondary
     C                     MOVEL'BRKX1'   WL0023    P      Sales Expense C
     C                     Z-ADDWAANC7    WL0024           A/R Customer
     C                     Z-ADDYL0021    WL0025           Sales Expense A
     C                     Z-ADD*ZERO     WL0026           SHE Unused Cost
     C                     Z-ADD*ZERO     WL0027           SHE Unused Cost
     C                     Z-ADD*ZERO     WL0028           SHE Unused Pct
     C                     Z-ADD*ZERO     WL0029           SHE Unused Pct
     C                     Z-ADD*ZERO     WL0030           SHE Unused nbr
     C                     MOVELYL0022    WL0031    P      SHE Unused Sts
     C                     MOVELYL0023    WL0032    P      SHE Unused Sts
     C                     Z-ADDYL0007    WL0033           SHE Actual Ship
     C                     Z-ADD*ZERO     WL0034           SHE Unused Date
     C                     MOVELWUGSTX    WL0035    P      SHE Unused Code
     C                     MOVELWAUVST    WL0036    P      EDI Status 1
     C                     MOVELWAUWST    WL0037    P      EDI Status 2
     C                     MOVELWAUXST    WL0038    P      EDI Status 3
     C                     Z-ADDWAAATM    WL0039           Job Time
     C                     MOVELWAAYNA    WL0040    P      User Id
     C                     MOVELWAA0NA    WL0041    P      Job Name
     C                     Z-ADDWAAXDT    WL0042           Job Date
     C                     EXSR SKCRRC
     C                     ADD  YL0021    YL0006           Total Amount
     C                     END                             *FI
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDUDY     BEGSR
      *================================================================
      * Calculate duration, *DAYS
      *================================================================
     C           XDAY1     IFLT 1
     C           XDAY2     ORLT 1
     C                     Z-ADD0         XDURR
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     GOTO XDUDYE
     C                     END
     C           XDAY1     IFGE XDAY2
      * From date2 to date1
     C                     Z-ADDXDAY2     XABEG   60
     C                     Z-ADDXDAY1     XAEND   60
     C                     ELSE
      * From date1 to date2
     C                     Z-ADDXDAY1     XABEG   60
     C                     Z-ADDXDAY2     XAEND   60
     C                     END
     C           XDWSL     IFEQ 0
      * None days of week selected
     C                     Z-ADD0         XDURR
     C                     GOTO XDUDYC
     C                     END
     C           XAEND     SUB  XABEG     XDURR   80
     C           XDWSL     IFEQ 7
      * All days of week selected
     C                     GOTO XDUDYC
     C                     END
      * Some days of week selected
     C                     DIV  7         XDURR
     C                     MVR            XDLSW   10
     C                     MULT XDWSL     XDURR
     C           XDLSW     IFNE 0
      * Determine day of week of the beginning date
     C           XABEG     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
      * Loop: Increment the date by the last week
     C           XDLSW     DOWGT0
      * Increment the day of week
     C                     ADD  1         YY
     C                     SUB  1         XDLSW
      * Put day of week into the range 1-7
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     END
      * Selected day of the last week has been processed
     C           YDOW,YY   IFEQ XDSEL
      * Increment duration
     C                     ADD  1         XDURR
     C                     END
      * End of loop
     C                     END
     C                     END
     C           XDUDYC    TAG
     C           XDURR     IFEQ 0
      * Return Code: Unable to calculate duration
     C                     MOVEL'Y2U0060' W0RTN   7
     C                     ELSE
     C                     MOVEL*BLANK    W0RTN   7
     C                     END
      *================================================================
     CSR         XDUDYE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
     C                     Z-ADD*ZERO     WABTC7           Parent Customer
     C                     Z-ADD*ZERO     WAANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAA0DT           Order Date
     C                     Z-ADD*ZERO     WAACDT           Cancel Date
     C                     Z-ADD*ZERO     WATBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WAATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WAT3NB           Attach to Order
     C                     Z-ADD*ZERO     WARSRN           Resell Referenc
     C                     Z-ADD*ZERO     WAORIT           Original Item
     C                     Z-ADD*ZERO     WAAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WAD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WACCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WAAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WAAKPR           Unit Price
     C                     Z-ADD*ZERO     WAAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAAWDT           Invoice Date
     C                     Z-ADD*ZERO     WAHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WAAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WAAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WAAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WAAYVA           Extended Amount
     C                     Z-ADD*ZERO     WAL6NB           Contract Number
     C                     Z-ADD*ZERO     WAHCDT           LD Arrival Date
     C                     Z-ADD*ZERO     WAESNB           Accounting Year
     C                     Z-ADD*ZERO     WAETNB           Accounting Peri
     C                     Z-ADD*ZERO     WABZNB           OM Week
     C                     Z-ADD*ZERO     WAEXQT           Quantity Billed
     C                     Z-ADD*ZERO     WABYWG           Weight Billed
     C                     Z-ADD*ZERO     WAS5NB           Shipped Item Co
     C                     Z-ADD*ZERO     WAMAVA           Billing Detail
     C                     Z-ADD*ZERO     WAKDVA           Billing Detail
     C                     Z-ADD*ZERO     WAUSVA           FOB Gross Amoun
     C                     Z-ADD*ZERO     WAUTVA           Standard Overag
     C                     Z-ADD*ZERO     WAA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WACKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WAR8NB           Shipping Compan
     C                     Z-ADD*ZERO     WABZPR           Price Overage O
     C                     Z-ADD*ZERO     WAEXDT           Market Pricing
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WACONB           Invoice Number
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WASKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WASLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WASMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WAONVA           Actual Freight
     C                     Z-ADD*ZERO     WAB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WAB5NB           PM Line Number
     C                     Z-ADD*ZERO     WAGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WAULVA           Absorbed Freigh
     C                     Z-ADD*ZERO     WAUNVA           Ledgrd Trd Fund
     C                     Z-ADD*ZERO     WAUOVA           Commission Amou
     C                     Z-ADD*ZERO     WAUPVA           Financials Amou
     C                     Z-ADD*ZERO     WAUQVA           Financials Amou
     C                     Z-ADD*ZERO     WACFC7           Order Group Cod
     C                     Z-ADD*ZERO     WADUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WAB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WAIANX           Req Shipping Te
     C                     Z-ADD*ZERO     WAIBNX           Actual Shipping
     C                     Z-ADD*ZERO     WANYDT           Req Delivery Da
     C                     Z-ADD*ZERO     WABZTM           Req Delivery Ti
     C                     Z-ADD*ZERO     WAZ4NB           MPC Number
     C                     Z-ADD*ZERO     WAOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WAC0C7           Claim Number
     C                     Z-ADD*ZERO     WAA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WAA5PR           Commodity Marke
     C                     Z-ADD*ZERO     WACDPR           Market Value
     C                     Z-ADD*ZERO     WAD0PR           Default Cmdty M
     C                     Z-ADD*ZERO     WAD0VL           Raw Material Co
     C                     Z-ADD*ZERO     WACEVL           Sales Expense T
     C                     Z-ADD*ZERO     WAOHDT           LD Sail Date
     C                     Z-ADD*ZERO     WAD9PR           NonLedgrd TrdFn
     C                     Z-ADD*ZERO     WACFVL           HST Item Target
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WCA0DT           Order Date
     C                     Z-ADD*ZERO     WCA5DT           Requested Ship
     C                     Z-ADD*ZERO     WCGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WCACDT           Cancel Date
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCCXDT           Date of Origina
     C                     Z-ADD*ZERO     WCJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WCA1WG           Order Weight To
     C                     Z-ADD*ZERO     WCEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WCAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WCRMNB           Load ID
     C                     Z-ADD*ZERO     WCTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WCATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WCRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WCT3NB           Attach to Order
     C                     Z-ADD*ZERO     WCCONB           Invoice Number
     C                     Z-ADD*ZERO     WCAWDT           Invoice Date
     C                     Z-ADD*ZERO     WCVRVA           A/R order Value
     C                     Z-ADD*ZERO     WCB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WCNODT           OH Unused Date
     C                     Z-ADD*ZERO     WCNPDT           OH Unused Date
     C                     Z-ADD*ZERO     WCNQDT           OH Unused Date
     C                     Z-ADD*ZERO     WCNRDT           OH Unused Date
     C                     Z-ADD*ZERO     WCNSDT           OH Unused Date
     C                     Z-ADD*ZERO     WCBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WCBQTM           Time of Origina
     C                     Z-ADD*ZERO     WCBRTM           OH Unused Time
     C                     Z-ADD*ZERO     WCBSTM           OH Unused Time
     C                     Z-ADD*ZERO     WCBTTM           OH Unused Time
     C                     Z-ADD*ZERO     WCH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WCH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WCH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WCH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WCH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WCC0C7           Claim Number
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEDUC7           A/R Customer
     C                     Z-ADD*ZERO     WEAUDT           Effective Date
     C                     Z-ADD*ZERO     WEE5PC           Brokerage Fee P
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Define work field Freezer Free Days
     C                     Z-ADD*ZERO     WUMVNX  50
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFAUDT           Effective Date
     C                     Z-ADD*ZERO     WFBGCS           Freezer Storage
     C                     Z-ADD*ZERO     WFMVNX           Freezer Free Da
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGDUC7           A/R Customer
     C                     Z-ADD*ZERO     WGAUDT           Effective Date
     C                     Z-ADD*ZERO     WGE6PC           Payment Interes
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHAUDT           Effective Date
     C                     Z-ADD*ZERO     WHBDCS           Pallet Usage Co
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIHGCD           Item Code
     C                     Z-ADD*ZERO     WIAUDT           Effective Date
     C                     Z-ADD*ZERO     WIBFCS           Brokerage Fee C
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJAUDT           Effective Date
     C                     Z-ADD*ZERO     WJE5PC           Brokerage Fee P
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKC4NB           Order Number
     C                     Z-ADD*ZERO     WKDPNB           Order Sequence
     C                     Z-ADD*ZERO     WKUENB           Order Secondary
     C                     Z-ADD*ZERO     WKDUC7           A/R Customer
     C                     Z-ADD*ZERO     WKCBVL           Sales Expense A
     C                     Z-ADD*ZERO     WKCGVL           SHE Unused Cost
     C                     Z-ADD*ZERO     WKCHVL           SHE Unused Cost
     C                     Z-ADD*ZERO     WKE7PC           SHE Unused Pct
     C                     Z-ADD*ZERO     WKE8PC           SHE Unused Pct
     C                     Z-ADD*ZERO     WKMONX           SHE Unused nbr
     C                     Z-ADD*ZERO     WKOBDT           SHE Actual Ship
     C                     Z-ADD*ZERO     WKOCDT           SHE Unused Date
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLAIC3           Company Number
     C                     Z-ADD*ZERO     WLC4NB           Order Number
     C                     Z-ADD*ZERO     WLDPNB           Order Sequence
     C                     Z-ADD*ZERO     WLUENB           Order Secondary
     C                     Z-ADD*ZERO     WLRZNB           Case Sequence N
     C                     Z-ADD*ZERO     WLFOQT           Case Quantity
     C                     Z-ADD*ZERO     WLR0NB           Case Weight
     C                     Z-ADD*ZERO     WLK7DT           Label Date
     C                     Z-ADD*ZERO     WLPFNX           PT Serial Numbe
     C                     Z-ADD*ZERO     WLHGCD           Item Code
     C                     Z-ADD*ZERO     WLELDT           Production Date
     C                     Z-ADD*ZERO     WLN5WG           Manifest Gross
     C                     Z-ADD*ZERO     WLH5NY           Manifest Total
     C                     Z-ADD*ZERO     WLH6NY           Manifest Co-Par
     C                     Z-ADD*ZERO     WLH7NY           Manifest Pallet
     C                     Z-ADD*ZERO     WLN6WG           HPB Meter Net G
     C                     Z-ADD*ZERO     WLN7WG           Manifest Unused
     C                     Z-ADD*ZERO     WLRBDT           Manifest Unused
     C                     Z-ADD*ZERO     WLITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WLIVNY           HPB Meter Start
     C                     Z-ADD*ZERO     WLIUNY           HPB Meter Endin
     C                     Z-ADD*ZERO     WLIWNY           HPB Meter Total
     C                     Z-ADD*ZERO     WLIXNY           HPB Meter Net W
     C                     Z-ADD*ZERO     WLIYNY           HPB Density Ref
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WE01 179       *Synon (17,9) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD03 177       *Synon (17,7) w
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SBCHRC.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     Z-ADD*ZERO     WL0003  30
     C                     Z-ADD*ZERO     WL0004  30
     C                     MOVEL*BLANK    WL0005  1
     C                     Z-ADD*ZERO     WL0006 112
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0007  30
     C                     Z-ADD*ZERO     WL0008  70
     C                     MOVEL*BLANK    WL0009 30
     C                     MOVEL*BLANK    WL0010 20
     C                     MOVEL*BLANK    WL0011  2
     C                     Z-ADD*ZERO     WL0012  70
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0013  30
     C                     MOVEL*BLANK    WL0014  3
     C                     MOVEL*BLANK    WL0015  3
     C                     Z-ADD*ZERO     WL0016  70
     C                     Z-ADD*ZERO     WL0017  75
     C                     Z-ADD*ZERO     WL0018  50
      * Define local variables for subroutine SKCRRC.
     C                     Z-ADD*ZERO     WL0019  30
     C                     Z-ADD*ZERO     WL0020  70
     C                     Z-ADD*ZERO     WL0021  30
     C                     Z-ADD*ZERO     WL0022  30
     C                     MOVEL*BLANK    WL0023  5
     C                     Z-ADD*ZERO     WL0024  70
     C                     Z-ADD*ZERO     WL0025 112
     C                     Z-ADD*ZERO     WL0026  52
     C                     Z-ADD*ZERO     WL0027  52
     C                     Z-ADD*ZERO     WL0028  52
     C                     Z-ADD*ZERO     WL0029  52
     C                     Z-ADD*ZERO     WL0030  50
     C                     MOVEL*BLANK    WL0031  1
     C                     MOVEL*BLANK    WL0032  2
     C                     Z-ADD*ZERO     WL0033  70
     C                     Z-ADD*ZERO     WL0034  70
     C                     MOVEL*BLANK    WL0035  3
     C                     MOVEL*BLANK    WL0036  1
     C                     MOVEL*BLANK    WL0037  1
     C                     MOVEL*BLANK    WL0038  1
     C                     Z-ADD*ZERO     WL0039  60
     C                     MOVEL*BLANK    WL0040 10
     C                     MOVEL*BLANK    WL0041 10
     C                     Z-ADD*ZERO     WL0042  70
      * Define local variables for subroutine SLRVGN.
     C                     Z-ADD*ZERO     WL0043  30
     C                     Z-ADD*ZERO     WL0044  70
     C                     Z-ADD*ZERO     WL0045  30
     C                     Z-ADD*ZERO     WL0046  30
     C                     Z-ADD*ZERO     WL0047 112
     C                     Z-ADD*ZERO     WL0048  70
     C                     Z-ADD*ZERO     WL0049  75
     C                     MOVEL*BLANK    WL0050  3
     C                     MOVEL*BLANK    WL0051  3
     C                     Z-ADD*ZERO     WL0052  50
     C                     Z-ADD*ZERO     WL0053  75
      * Define local work field First Time Flag
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Order Sequence Number
     C                     Z-ADD*ZERO     YL0002  30
      * Define local work field Order Secondary Line Seq
     C                     Z-ADD*ZERO     YL0003  30
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0004  30
      * Define local work field Order Number
     C                     Z-ADD*ZERO     YL0005  70
      * Define local work field Total Amount
     C                     Z-ADD*ZERO     YL0006 112
      * Define local work field Actual Shipped Date
     C                     Z-ADD*ZERO     YL0007  70
      * Define null work field Ship To Name
     C                     MOVEL*BLANK    YN0001 30
      * Define null work field Ship To City
     C                     MOVEL*BLANK    YN0002 20
      * Define null work field Ship To State Code
     C                     MOVEL*BLANK    YN0003  2
      * Define local work field Brokerage Fee Pct
     C                     Z-ADD*ZERO     YL0008  52
      * Define local work field Payment Interest Pct
     C                     Z-ADD*ZERO     YL0009  96
      * Define local work field Freezer Stg per Unit
     C                     MOVEL*BLANK    YL0010  3
      * Define local work field Freezer Storage Cost/Unit
     C                     Z-ADD*ZERO     YL0011  75
      * Define local work field Freezer Free Days
     C                     Z-ADD*ZERO     YL0012  50
      * Define local work field Pallet Usage Cost/CWT
     C                     Z-ADD*ZERO     YL0013  52
      * Define local work field Terms Code
     C                     MOVEL*BLANK    YL0014  2
      * Define local work field Std Daily Interest Cost
     C                     Z-ADD*ZERO     YL0015 112
      * Define local work field Days Early or Late    USR
     C                     Z-ADD*ZERO     YL0016  50
      * Define local work field USR Brokerage Fee Pct/Ctr
     C                     Z-ADD*ZERO     YL0017  52
      * Define local work field Freezer Storage Unit 2
     C                     MOVEL*BLANK    YL0018  3
      * Define local work field Freezer Stg Cost/Unit 2
     C                     Z-ADD*ZERO     YL0019  75
      * Define local work field Brokerage Fee Cost/CWT
     C                     Z-ADD*ZERO     YL0020  52
      * Define local work field Sales Expense Amount
     C                     Z-ADD*ZERO     YL0021 112
      * Define local work field SHE Unused Sts 1
     C                     MOVEL*BLANK    YL0022  1
      * Define local work field SHE Unused Sts 2
     C                     MOVEL*BLANK    YL0023  2
      * Define local work field Days in Freezer       USR
     C                     Z-ADD*ZERO     YL0024  50
      *================================================================
     CSR         ZZEXIT    ENDSR
