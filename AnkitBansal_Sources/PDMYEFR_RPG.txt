     H/TITLE WW Manifest Detail     DF Edit file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Maintain database file using subfile display
     H* - Existing records may be updated or deleted
     H* - Key changes are not allowed
     H* - Program functions in two modes : *ADD and *CHANGE
     H* - Multiple new records may be added by changing to add mode
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Edit file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISABANS
     H* Date          : 11/24/24  Time  : 12:13:50
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPDMYEFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: WW Manifest Detail     DF Edit file
      *
     FOMFNCPL2IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RSQ : Manifest Detail           RSQ for Order Confirm
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FOPBGWKLDIF  E           K        DISK
      * RSQ : Order Detail              Co/Order#/Item/Whse Not
      *
     FOMFNCPL1IF  E           K        DISK
      * RTV : Manifest Detail           Retrieval index
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FPMCCCPL5IF  E           K        DISK
      * RSQ : COA Batch Header          Comp/Batch
      *
     FPMCAREL1IF  E           K        DISK
      * RTV : COA Property Define Hdr   Retrieval index
      *
     FCABZRELDIF  E           K        DISK
      * RTV : Company Item              Active Items Only
      *
     FPMAMREL1IF  E           K        DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FOMFLCPL5IF  E           K        DISK
      * RSQ : Load Detail               Co/Load/Order
      *
     FCAB1REL0IF  E           K        DISK
      * RTV : Item Balance Detail       Retrieval index       NV
      *
     FPNGJREL1IF  E           K        DISK
      * RTV : RFS API Volume Corr Table Retrieval index
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FPDIOREL1IF  E           K        DISK
      * RTV : Item Bill Of Material     Retrieval index
      *
     FPUB6CPL1IF  E           K        DISK
      * RTV : Pallet Master             Retrieval index
      *
     FPPBUREL1IF  E           K        DISK
      * RTV : PFS Interface             Retrieval index
      *
     FPDJYREL2IF  E           K        DISK
      * RTV : Company Defaults Internal Active Records
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     FPMAMREL0UF  E           K        DISK                      A
      * UPD : Order Header Extension    Update index
      *
     FOMFNCPL0UF  E           K        DISK                      A
      * UPD : Manifest Detail           Update index
      *
      * Days in month for date validation
     E                    @XD    12  12  2 0
     E                    #L3         3  1
     E                    #L7         7  1
     E                    UCT        40  1               CENTER TABLE
      * Screen: Field position and name array
     E                    W0BEG   7 024  5 0A
     E                    W0END   7 024  5 0A
     E                    W0NAM   7 024 10
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     I@BGWKFW
      * Order Detail              Co/Order#/Item/Whse Not
      * Renamed input format fields
     I              OMAIC3                          WAAIC3
     I              OMC4NB                          WAC4NB
     I              OMDPNB                          WADPNB
     I              OMUENB                          WAUENB
     I              OMHGCD                          WAHGCD
     I              OMAJCD                          WAAJCD
     I              OMBKC7                          WABKC7
     I              OMCFC7                          WACFC7
     I              OMGMST                          WAGMST
     I              OMGNST                          WAGNST
     I              OMMAVA                          WAMAVA
     I              OMKDVA                          WAKDVA
     I              OML8VA                          WAL8VA
     I              OML9VA                          WAL9VA
     I              OMGTST                          WAGTST
     I              OMGVST                          WAGVST
     I              OMGUST                          WAGUST
     I              OMQFST                          WAQFST
     I              OMAYVA                          WAAYVA
     I              OMEXDT                          WAEXDT
     I              OMLQCD                          WALQCD
     I              OMRDCD                          WARDCD
     I              OMQ7CD                          WAQ7CD
     I              OMBZPR                          WABZPR
     I              OML6NB                          WAL6NB
     I              OMU1ST                          WAU1ST
     I              OMGIDT                          WAGIDT
     I              OMCRCD                          WACRCD
     I              OMAGCD                          WAAGCD
     I              OMRZST                          WARZST
     I              OMR0ST                          WAR0ST
     I              OMR1ST                          WAR1ST
     I              OMG7NA                          WAG7NA
     I              OMG8NA                          WAG8NA
     I              OMRPCD                          WARPCD
     I              OMVEST                          WAVEST
     I              OMVGST                          WAVGST
     I              OMAVST                          WAAVST
     I              OMU0ST                          WAU0ST
     I              OMRFCD                          WARFCD
     I              OMFZST                          WAFZST
     I              OMR1NB                          WAR1NB
     I              OMAVQT                          WAAVQT
     I              OMD0WG                          WAD0WG
     I              OMCCQT                          WACCQT
     I              OMAUWG                          WAAUWG
     I              OMCBQT                          WACBQT
     I              OMATWG                          WAATWG
     I              OMAQCS                          WAAQCS
     I              OMAGCS                          WAAGCS
     I              OMAKPR                          WAAKPR
     I              OMALPR                          WAALPR
     I              OMAUPR                          WAAUPR
     I              OMAVWG                          WAAVWG
     I              OMA4WG                          WAA4WG
     I              OMA5DT                          WAA5DT
     I              OMAODT                          WAAODT
     I              OMGNDT                          WAGNDT
     I              OMAMST                          WAAMST
     I              OMANST                          WAANST
     I              OMVAST                          WAVAST
     I              OMRGNB                          WARGNB
     I              OMRHNB                          WARHNB
     I              OMRINB                          WARINB
     I              OMRBCD                          WARBCD
     I              OMHICD                          WAHICD
     I              OMRNCD                          WARNCD
     I              OMROCD                          WAROCD
     I              OMCXDT                          WACXDT
     I              OMAJVN                          WAAJVN
     I              OMKXCD                          WAKXCD
     I              OMJPCD                          WAJPCD
     I              OMCQCD                          WACQCD
     I              OMR4CD                          WAR4CD
     I              OMZ1ST                          WAZ1ST
     I              OMZ3ST                          WAZ3ST
     I              OMZ4ST                          WAZ4ST
     I              OMDUPR                          WADUPR
     I              OMB6VL                          WAB6VL
     I              OMA1AA                          WAA1AA
     I              OMFZSX                          WAFZSX
     I              OMF0SX                          WAF0SX
     I              OMF1SX                          WAF1SX
     I              OMF2SX                          WAF2SX
     I              OMF3SX                          WAF3SX
     I              OMF4SX                          WAF4SX
     I              OMF5SX                          WAF5SX
     I              OMF6SX                          WAF6SX
     I              OMF7SX                          WAF7SX
     I              OMNTDT                          WANTDT
     I              OMNUDT                          WANUDT
     I              OMNVDT                          WANVDT
     I              OMNWDT                          WANWDT
     I              OMNXDT                          WANXDT
     I              OMBUTM                          WABUTM
     I              OMBVTM                          WABVTM
     I              OMBWTM                          WABWTM
     I              OMBXTM                          WABXTM
     I              OMBYTM                          WABYTM
     I              OMH5NX                          WAH5NX
     I              OMH6NX                          WAH6NX
     I              OMH7NX                          WAH7NX
     I              OMH8NX                          WAH8NX
     I              OMH9NX                          WAH9NX
     I              OMDVPR                          WADVPR
     I              OMDWPR                          WADWPR
     I              OMDXPR                          WADXPR
     I              OMDYPR                          WADYPR
     I              OMDZPR                          WADZPR
     I              OMGSPR                          WAGSPR
     I              OMGTPR                          WAGTPR
     I              OMGUPR                          WAGUPR
     I              OMHOST                          WAHOST
     I              OMHPST                          WAHPST
     I              OMIOST                          WAIOST
     I              OMPEWG                          WAPEWG
     I              OMRINY                          WARINY
     I              OMTIDT                          WATIDT
     I              OMTJDT                          WATJDT
     I              OMH2ST                          WAH2ST
     I              OMH0ST                          WAH0ST
     I              OMH1ST                          WAH1ST
     I              OMTKDT                          WATKDT
     I              OMTLDT                          WATLDT
     I              OMTMDT                          WATMDT
     I              OMUVST                          WAUVST
     I              OMUWST                          WAUWST
     I              OMUXST                          WAUXST
     I              OMAATM                          WAAATM
     I              OMAYNA                          WAAYNA
     I              OMA0NA                          WAA0NA
     I              OMAXDT                          WAAXDT
      *
     I@FNCPCT
      * Manifest Detail           Retrieval index
      * Renamed input format fields
     I              FNAIC3                          WBAIC3
     I              FNC4NB                          WBC4NB
     I              FNDPNB                          WBDPNB
     I              FNUENB                          WBUENB
     I              FNRZNB                          WBRZNB
     I              FNFOQT                          WBFOQT
     I              FNR0NB                          WBR0NB
     I              FNPMST                          WBPMST
     I              FNK7DT                          WBK7DT
     I              FNPFNX                          WBPFNX
     I              FNHGCD                          WBHGCD
     I              FNAJCD                          WBAJCD
     I              FNELDT                          WBELDT
     I              FNN5WG                          WBN5WG
     I              FNRZNA                          WBRZNA
     I              FNH5NY                          WBH5NY
     I              FNH6NY                          WBH6NY
     I              FNH7NY                          WBH7NY
     I              FNGBTX                          WBGBTX
     I              FNN6WG                          WBN6WG
     I              FNN7WG                          WBN7WG
     I              FNGCTX                          WBGCTX
     I              FNGDTX                          WBGDTX
     I              FNRBDT                          WBRBDT
     I              FNITNY                          WBITNY
     I              FNIVNY                          WBIVNY
     I              FNIUNY                          WBIUNY
     I              FNIWNY                          WBIWNY
     I              FNIXNY                          WBIXNY
     I              FNIYNY                          WBIYNY
     I              FNUVST                          WBUVST
     I              FNUWST                          WBUWST
     I              FNUXST                          WBUXST
     I              FNVSST                          WBVSST
     I              FNAATM                          WBAATM
     I              FNAYNA                          WBAYNA
     I              FNA0NA                          WBA0NA
     I              FNAXDT                          WBAXDT
     I              FNLPNZ                          WBLPNZ
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WCAIC3
     I              OMC4NB                          WCC4NB
     I              OMDPNB                          WCDPNB
     I              OMUENB                          WCUENB
     I              OMHGCD                          WCHGCD
     I              OMAJCD                          WCAJCD
     I              OMBKC7                          WCBKC7
     I              OMCFC7                          WCCFC7
     I              OMGMST                          WCGMST
     I              OMGNST                          WCGNST
     I              OMMAVA                          WCMAVA
     I              OMKDVA                          WCKDVA
     I              OML8VA                          WCL8VA
     I              OML9VA                          WCL9VA
     I              OMGTST                          WCGTST
     I              OMGVST                          WCGVST
     I              OMGUST                          WCGUST
     I              OMQFST                          WCQFST
     I              OMAYVA                          WCAYVA
     I              OMEXDT                          WCEXDT
     I              OMLQCD                          WCLQCD
     I              OMRDCD                          WCRDCD
     I              OMQ7CD                          WCQ7CD
     I              OMBZPR                          WCBZPR
     I              OML6NB                          WCL6NB
     I              OMU1ST                          WCU1ST
     I              OMGIDT                          WCGIDT
     I              OMCRCD                          WCCRCD
     I              OMAGCD                          WCAGCD
     I              OMRZST                          WCRZST
     I              OMR0ST                          WCR0ST
     I              OMR1ST                          WCR1ST
     I              OMG7NA                          WCG7NA
     I              OMG8NA                          WCG8NA
     I              OMRPCD                          WCRPCD
     I              OMVEST                          WCVEST
     I              OMVGST                          WCVGST
     I              OMAVST                          WCAVST
     I              OMU0ST                          WCU0ST
     I              OMRFCD                          WCRFCD
     I              OMFZST                          WCFZST
     I              OMR1NB                          WCR1NB
     I              OMAVQT                          WCAVQT
     I              OMD0WG                          WCD0WG
     I              OMCCQT                          WCCCQT
     I              OMAUWG                          WCAUWG
     I              OMCBQT                          WCCBQT
     I              OMATWG                          WCATWG
     I              OMAQCS                          WCAQCS
     I              OMAGCS                          WCAGCS
     I              OMAKPR                          WCAKPR
     I              OMALPR                          WCALPR
     I              OMAUPR                          WCAUPR
     I              OMAVWG                          WCAVWG
     I              OMA4WG                          WCA4WG
     I              OMA5DT                          WCA5DT
     I              OMAODT                          WCAODT
     I              OMGNDT                          WCGNDT
     I              OMAMST                          WCAMST
     I              OMANST                          WCANST
     I              OMVAST                          WCVAST
     I              OMRGNB                          WCRGNB
     I              OMRHNB                          WCRHNB
     I              OMRINB                          WCRINB
     I              OMRBCD                          WCRBCD
     I              OMHICD                          WCHICD
     I              OMRNCD                          WCRNCD
     I              OMROCD                          WCROCD
     I              OMCXDT                          WCCXDT
     I              OMAJVN                          WCAJVN
     I              OMKXCD                          WCKXCD
     I              OMJPCD                          WCJPCD
     I              OMCQCD                          WCCQCD
     I              OMR4CD                          WCR4CD
     I              OMZ1ST                          WCZ1ST
     I              OMZ3ST                          WCZ3ST
     I              OMZ4ST                          WCZ4ST
     I              OMDUPR                          WCDUPR
     I              OMB6VL                          WCB6VL
     I              OMA1AA                          WCA1AA
     I              OMFZSX                          WCFZSX
     I              OMF0SX                          WCF0SX
     I              OMF1SX                          WCF1SX
     I              OMF2SX                          WCF2SX
     I              OMF3SX                          WCF3SX
     I              OMF4SX                          WCF4SX
     I              OMF5SX                          WCF5SX
     I              OMF6SX                          WCF6SX
     I              OMF7SX                          WCF7SX
     I              OMNTDT                          WCNTDT
     I              OMNUDT                          WCNUDT
     I              OMNVDT                          WCNVDT
     I              OMNWDT                          WCNWDT
     I              OMNXDT                          WCNXDT
     I              OMBUTM                          WCBUTM
     I              OMBVTM                          WCBVTM
     I              OMBWTM                          WCBWTM
     I              OMBXTM                          WCBXTM
     I              OMBYTM                          WCBYTM
     I              OMH5NX                          WCH5NX
     I              OMH6NX                          WCH6NX
     I              OMH7NX                          WCH7NX
     I              OMH8NX                          WCH8NX
     I              OMH9NX                          WCH9NX
     I              OMDVPR                          WCDVPR
     I              OMDWPR                          WCDWPR
     I              OMDXPR                          WCDXPR
     I              OMDYPR                          WCDYPR
     I              OMDZPR                          WCDZPR
     I              OMGSPR                          WCGSPR
     I              OMGTPR                          WCGTPR
     I              OMGUPR                          WCGUPR
     I              OMHOST                          WCHOST
     I              OMHPST                          WCHPST
     I              OMIOST                          WCIOST
     I              OMPEWG                          WCPEWG
     I              OMRINY                          WCRINY
     I              OMTIDT                          WCTIDT
     I              OMTJDT                          WCTJDT
     I              OMH2ST                          WCH2ST
     I              OMH0ST                          WCH0ST
     I              OMH1ST                          WCH1ST
     I              OMTKDT                          WCTKDT
     I              OMTLDT                          WCTLDT
     I              OMTMDT                          WCTMDT
     I              OMUVST                          WCUVST
     I              OMUWST                          WCUWST
     I              OMUXST                          WCUXST
     I              OMAATM                          WCAATM
     I              OMAYNA                          WCAYNA
     I              OMA0NA                          WCA0NA
     I              OMAXDT                          WCAXDT
      *
     I@AMREJE
      * Order Header Extension    Update index
      * Renamed input format fields
     I              AMAIC3                          WDAIC3
     I              AMC4NB                          WDC4NB
     I              AMRMNB                          WDRMNB
     I              AMRUNB                          WDRUNB
     I              AMXACD                          WDXACD
     I              AMOANA                          WDOANA
     I              AMHBAA                          WDHBAA
     I              AMJ0T1                          WDJ0T1
     I              AMGENY                          WDGENY
     I              AMJ1T1                          WDJ1T1
     I              AMHCAA                          WDHCAA
     I              AMQWDT                          WDQWDT
     I              AMQXDT                          WDQXDT
     I              AMQYDT                          WDQYDT
     I              AMHDAA                          WDHDAA
     I              AMCCTX                          WDCCTX
     I              AMJ2T1                          WDJ2T1
     I              AMRLNA                          WDRLNA
     I              AMRMNA                          WDRMNA
     I              AMGINY                          WDGINY
     I              AMGFNY                          WDGFNY
     I              AMGGNY                          WDGGNY
     I              AMGHNY                          WDGHNY
     I              AMHEVL                          WDHEVL
     I              AMHFVL                          WDHFVL
     I              AMHGVL                          WDHGVL
     I              AMQZDT                          WDQZDT
     I              AMQ0DT                          WDQ0DT
     I              AMQ1DT                          WDQ1DT
     I              AMQ2DT                          WDQ2DT
     I              AMC2TX                          WDC2TX
     I              AMC3TX                          WDC3TX
     I              AMC6TX                          WDC6TX
     I              AMCHTX                          WDCHTX
     I              AMCITX                          WDCITX
     I              AMCLTX                          WDCLTX
     I              AMB4TX                          WDB4TX
     I              AMCUTX                          WDCUTX
     I              AMCVTX                          WDCVTX
     I              AMB9TX                          WDB9TX
     I              AMJWSC                          WDJWSC
     I              AMITNY                          WDITNY
     I              AMLMT1                          WDLMT1
     I              AMLWAA                          WDLWAA
     I              AMFVST                          WDFVST
     I              AMF0ST                          WDF0ST
     I              AMF2ST                          WDF2ST
     I              AMF3ST                          WDF3ST
     I              AMJUSC                          WDJUSC
     I              AMJVSC                          WDJVSC
     I              AMV3T1                          WDV3T1
     I              AMV4T1                          WDV4T1
     I              AMV5T1                          WDV5T1
     I              AMV6T1                          WDV6T1
     I              AMV7T1                          WDV7T1
     I              AMV8T1                          WDV8T1
     I              AMV9T1                          WDV9T1
     I              AMWAT1                          WDWAT1
     I              AMWBT1                          WDWBT1
     I              AMWCT1                          WDWCT1
     I              AMWDT1                          WDWDT1
     I              AMQJNY                          WDQJNY
     I              AMQKNY                          WDQKNY
     I              AMQLNY                          WDQLNY
     I              AMP8NY                          WDP8NY
     I              AMP9NY                          WDP9NY
     I              AMQANY                          WDQANY
     I              AMQCNY                          WDQCNY
     I              AMQDNY                          WDQDNY
     I              AMQENY                          WDQENY
     I              AMQFNY                          WDQFNY
     I              AMQGNY                          WDQGNY
     I              AMQHNY                          WDQHNY
     I              AMQINY                          WDQINY
     I              AMQMNY                          WDQMNY
     I              AMMYU1                          WDMYU1
     I              AMJXSC                          WDJXSC
     I              AMJYSC                          WDJYSC
     I              AMJZSC                          WDJZSC
     I              AMJ0SC                          WDJ0SC
     I              AMMZU1                          WDMZU1
     I              AMM0U1                          WDM0U1
     I              AMM1U1                          WDM1U1
     I              AMM2U1                          WDM2U1
     I              AMM3U1                          WDM3U1
     I              AMW5DT                          WDW5DT
     I              AMW6DT                          WDW6DT
     I              AMUVST                          WDUVST
     I              AMUWST                          WDUWST
     I              AMUXST                          WDUXST
     I              AMVSST                          WDVSST
     I              AMAATM                          WDAATM
     I              AMAYNA                          WDAYNA
     I              AMA0NA                          WDA0NA
     I              AMAXDT                          WDAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WEAIC3
     I              BZHGCD                          WEHGCD
     I              BZAVNA                          WEAVNA
     I              BZAWNA                          WEAWNA
     I              BZL7NA                          WEL7NA
     I              BZL8NA                          WEL8NA
     I              BZL6NA                          WEL6NA
     I              BZMFNA                          WEMFNA
     I              BZADCD                          WEADCD
     I              BZAWPC                          WEAWPC
     I              BZLXST                          WELXST
     I              BZAECD                          WEAECD
     I              BZAXPC                          WEAXPC
     I              BZLYST                          WELYST
     I              BZAFCD                          WEAFCD
     I              BZAICD                          WEAICD
     I              BZAIWG                          WEAIWG
     I              BZHICD                          WEHICD
     I              BZRBCD                          WERBCD
     I              BZFZST                          WEFZST
     I              BZAVST                          WEAVST
     I              BZCZWG                          WECZWG
     I              BZC0WG                          WEC0WG
     I              BZURTN                          WEURTN
     I              BZAJC8                          WEAJC8
     I              BZRINB                          WERINB
     I              BZRHNB                          WERHNB
     I              BZRGNB                          WERGNB
     I              BZLNCD                          WELNCD
     I              BZTFNB                          WETFNB
     I              BZN0CD                          WEN0CD
     I              BZX4ST                          WEX4ST
     I              BZTMVA                          WETMVA
     I              BZTNVA                          WETNVA
     I              BZBLPR                          WEBLPR
     I              BZBMPR                          WEBMPR
     I              BZLRCD                          WELRCD
     I              BZU9ST                          WEU9ST
     I              BZCMCO                          WECMCO
     I              BZQ1CD                          WEQ1CD
     I              BZQ8CD                          WEQ8CD
     I              BZCHTM                          WECHTM
     I              BZQZCD                          WEQZCD
     I              BZXWST                          WEXWST
     I              BZXXST                          WEXXST
     I              BZVMST                          WEVMST
     I              BZSWGH                          WESWGH
     I              BZPPHE                          WEPPHE
     I              BZR3CD                          WER3CD
     I              BZSDCD                          WESDCD
     I              BZICN1                          WEICN1
     I              BZSVCD                          WESVCD
     I              BZICN2                          WEICN2
     I              BZSWCD                          WESWCD
     I              BZV2NB                          WEV2NB
     I              BZSXCD                          WESXCD
     I              BZITCN                          WEITCN
     I              BZSYCD                          WESYCD
     I              BZITC5                          WEITC5
     I              BZSZCD                          WESZCD
     I              BZICN6                          WEICN6
     I              BZS0CD                          WES0CD
     I              BZICN7                          WEICN7
     I              BZS1CD                          WES1CD
     I              BZICN8                          WEICN8
     I              BZS2CD                          WES2CD
     I              BZICN9                          WEICN9
     I              BZS3CD                          WES3CD
     I              BZICN0                          WEICN0
     I              BZS4CD                          WES4CD
     I              BZSFNB                          WESFNB
     I              BZA3WG                          WEA3WG
     I              BZSJNB                          WESJNB
     I              BZLLCD                          WELLCD
     I              BZLMCD                          WELMCD
     I              BZP3ST                          WEP3ST
     I              BZSKNB                          WESKNB
     I              BZSLNB                          WESLNB
     I              BZSMNB                          WESMNB
     I              BZP4ST                          WEP4ST
     I              BZCFNB                          WECFNB
     I              BZCGNB                          WECGNB
     I              BZILNB                          WEILNB
     I              BZCHNB                          WECHNB
     I              BZCINB                          WECINB
     I              BZCJNB                          WECJNB
     I              BZCMNB                          WECMNB
     I              BZCNNB                          WECNNB
     I              BZCRNB                          WECRNB
     I              BZCSNB                          WECSNB
     I              BZCVNB                          WECVNB
     I              BZCWNB                          WECWNB
     I              BZCXNB                          WECXNB
     I              BZCZNB                          WECZNB
     I              BZC0NB                          WEC0NB
     I              BZN1CD                          WEN1CD
     I              BZB4NB                          WEB4NB
     I              BZB5NB                          WEB5NB
     I              BZX5ST                          WEX5ST
     I              BZX6ST                          WEX6ST
     I              BZX7ST                          WEX7ST
     I              BZPCCT                          WEPCCT
     I              BZBDNB                          WEBDNB
     I              BZBJNB                          WEBJNB
     I              BZSUST                          WESUST
     I              BZSVST                          WESVST
     I              BZSYST                          WESYST
     I              BZSZST                          WESZST
     I              BZS1ST                          WES1ST
     I              BZXRCD                          WEXRCD
     I              BZXTCD                          WEXTCD
     I              BZXUCD                          WEXUCD
     I              BZF5WG                          WEF5WG
     I              BZF6WG                          WEF6WG
     I              BZF7WG                          WEF7WG
     I              BZBLNB                          WEBLNB
     I              BZBNNB                          WEBNNB
     I              BZS2ST                          WES2ST
     I              BZS4ST                          WES4ST
     I              BZS5ST                          WES5ST
     I              BZS6ST                          WES6ST
     I              BZS8ST                          WES8ST
     I              BZS9ST                          WES9ST
     I              BZTCST                          WETCST
     I              BZTDST                          WETDST
     I              BZUVST                          WEUVST
     I              BZUWST                          WEUWST
     I              BZUXST                          WEUXST
     I              BZVSST                          WEVSST
     I              BZAATM                          WEAATM
     I              BZAYNA                          WEAYNA
     I              BZA0NA                          WEA0NA
     I              BZAXDT                          WEAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     I@1DBRC    E DSOMFNCPL0
      * UPD : Manifest Detail           Update index
      * Current/previous master file format fields for change control
      *
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WCAIC3
     I              OMC4NB                          WCC4NB
     I              OMDPNB                          WCDPNB
     I              OMUENB                          WCUENB
     I              OMHGCD                          WCHGCD
     I              OMAJCD                          WCAJCD
     I              OMBKC7                          WCBKC7
     I              OMCFC7                          WCCFC7
     I              OMGMST                          WCGMST
     I              OMGNST                          WCGNST
     I              OMMAVA                          WCMAVA
     I              OMKDVA                          WCKDVA
     I              OML8VA                          WCL8VA
     I              OML9VA                          WCL9VA
     I              OMGTST                          WCGTST
     I              OMGVST                          WCGVST
     I              OMGUST                          WCGUST
     I              OMQFST                          WCQFST
     I              OMAYVA                          WCAYVA
     I              OMEXDT                          WCEXDT
     I              OMLQCD                          WCLQCD
     I              OMRDCD                          WCRDCD
     I              OMQ7CD                          WCQ7CD
     I              OMBZPR                          WCBZPR
     I              OML6NB                          WCL6NB
     I              OMU1ST                          WCU1ST
     I              OMGIDT                          WCGIDT
     I              OMCRCD                          WCCRCD
     I              OMAGCD                          WCAGCD
     I              OMRZST                          WCRZST
     I              OMR0ST                          WCR0ST
     I              OMR1ST                          WCR1ST
     I              OMG7NA                          WCG7NA
     I              OMG8NA                          WCG8NA
     I              OMRPCD                          WCRPCD
     I              OMVEST                          WCVEST
     I              OMVGST                          WCVGST
     I              OMAVST                          WCAVST
     I              OMU0ST                          WCU0ST
     I              OMRFCD                          WCRFCD
     I              OMFZST                          WCFZST
     I              OMR1NB                          WCR1NB
     I              OMAVQT                          WCAVQT
     I              OMD0WG                          WCD0WG
     I              OMCCQT                          WCCCQT
     I              OMAUWG                          WCAUWG
     I              OMCBQT                          WCCBQT
     I              OMATWG                          WCATWG
     I              OMAQCS                          WCAQCS
     I              OMAGCS                          WCAGCS
     I              OMAKPR                          WCAKPR
     I              OMALPR                          WCALPR
     I              OMAUPR                          WCAUPR
     I              OMAVWG                          WCAVWG
     I              OMA4WG                          WCA4WG
     I              OMA5DT                          WCA5DT
     I              OMAODT                          WCAODT
     I              OMGNDT                          WCGNDT
     I              OMAMST                          WCAMST
     I              OMANST                          WCANST
     I              OMVAST                          WCVAST
     I              OMRGNB                          WCRGNB
     I              OMRHNB                          WCRHNB
     I              OMRINB                          WCRINB
     I              OMRBCD                          WCRBCD
     I              OMHICD                          WCHICD
     I              OMRNCD                          WCRNCD
     I              OMROCD                          WCROCD
     I              OMCXDT                          WCCXDT
     I              OMAJVN                          WCAJVN
     I              OMKXCD                          WCKXCD
     I              OMJPCD                          WCJPCD
     I              OMCQCD                          WCCQCD
     I              OMR4CD                          WCR4CD
     I              OMZ1ST                          WCZ1ST
     I              OMZ3ST                          WCZ3ST
     I              OMZ4ST                          WCZ4ST
     I              OMDUPR                          WCDUPR
     I              OMB6VL                          WCB6VL
     I              OMA1AA                          WCA1AA
     I              OMFZSX                          WCFZSX
     I              OMF0SX                          WCF0SX
     I              OMF1SX                          WCF1SX
     I              OMF2SX                          WCF2SX
     I              OMF3SX                          WCF3SX
     I              OMF4SX                          WCF4SX
     I              OMF5SX                          WCF5SX
     I              OMF6SX                          WCF6SX
     I              OMF7SX                          WCF7SX
     I              OMNTDT                          WCNTDT
     I              OMNUDT                          WCNUDT
     I              OMNVDT                          WCNVDT
     I              OMNWDT                          WCNWDT
     I              OMNXDT                          WCNXDT
     I              OMBUTM                          WCBUTM
     I              OMBVTM                          WCBVTM
     I              OMBWTM                          WCBWTM
     I              OMBXTM                          WCBXTM
     I              OMBYTM                          WCBYTM
     I              OMH5NX                          WCH5NX
     I              OMH6NX                          WCH6NX
     I              OMH7NX                          WCH7NX
     I              OMH8NX                          WCH8NX
     I              OMH9NX                          WCH9NX
     I              OMDVPR                          WCDVPR
     I              OMDWPR                          WCDWPR
     I              OMDXPR                          WCDXPR
     I              OMDYPR                          WCDYPR
     I              OMDZPR                          WCDZPR
     I              OMGSPR                          WCGSPR
     I              OMGTPR                          WCGTPR
     I              OMGUPR                          WCGUPR
     I              OMHOST                          WCHOST
     I              OMHPST                          WCHPST
     I              OMIOST                          WCIOST
     I              OMPEWG                          WCPEWG
     I              OMRINY                          WCRINY
     I              OMTIDT                          WCTIDT
     I              OMTJDT                          WCTJDT
     I              OMH2ST                          WCH2ST
     I              OMH0ST                          WCH0ST
     I              OMH1ST                          WCH1ST
     I              OMTKDT                          WCTKDT
     I              OMTLDT                          WCTLDT
     I              OMTMDT                          WCTMDT
     I              OMUVST                          WCUVST
     I              OMUWST                          WCUWST
     I              OMUXST                          WCUXST
     I              OMAATM                          WCAATM
     I              OMAYNA                          WCAYNA
     I              OMA0NA                          WCA0NA
     I              OMAXDT                          WCAXDT
      *
     IYARDCS      DS                            525
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPMAM1    E DSPMAMREL0
      * UPD : Order Header Extension    Update index
      * Renamed input format fields
     I              AMAIC3                          WDAIC3
     I              AMC4NB                          WDC4NB
     I              AMRMNB                          WDRMNB
     I              AMRUNB                          WDRUNB
     I              AMXACD                          WDXACD
     I              AMOANA                          WDOANA
     I              AMHBAA                          WDHBAA
     I              AMJ0T1                          WDJ0T1
     I              AMGENY                          WDGENY
     I              AMJ1T1                          WDJ1T1
     I              AMHCAA                          WDHCAA
     I              AMQWDT                          WDQWDT
     I              AMQXDT                          WDQXDT
     I              AMQYDT                          WDQYDT
     I              AMHDAA                          WDHDAA
     I              AMCCTX                          WDCCTX
     I              AMJ2T1                          WDJ2T1
     I              AMRLNA                          WDRLNA
     I              AMRMNA                          WDRMNA
     I              AMGINY                          WDGINY
     I              AMGFNY                          WDGFNY
     I              AMGGNY                          WDGGNY
     I              AMGHNY                          WDGHNY
     I              AMHEVL                          WDHEVL
     I              AMHFVL                          WDHFVL
     I              AMHGVL                          WDHGVL
     I              AMQZDT                          WDQZDT
     I              AMQ0DT                          WDQ0DT
     I              AMQ1DT                          WDQ1DT
     I              AMQ2DT                          WDQ2DT
     I              AMC2TX                          WDC2TX
     I              AMC3TX                          WDC3TX
     I              AMC6TX                          WDC6TX
     I              AMCHTX                          WDCHTX
     I              AMCITX                          WDCITX
     I              AMCLTX                          WDCLTX
     I              AMB4TX                          WDB4TX
     I              AMCUTX                          WDCUTX
     I              AMCVTX                          WDCVTX
     I              AMB9TX                          WDB9TX
     I              AMJWSC                          WDJWSC
     I              AMITNY                          WDITNY
     I              AMLMT1                          WDLMT1
     I              AMLWAA                          WDLWAA
     I              AMFVST                          WDFVST
     I              AMF0ST                          WDF0ST
     I              AMF2ST                          WDF2ST
     I              AMF3ST                          WDF3ST
     I              AMJUSC                          WDJUSC
     I              AMJVSC                          WDJVSC
     I              AMV3T1                          WDV3T1
     I              AMV4T1                          WDV4T1
     I              AMV5T1                          WDV5T1
     I              AMV6T1                          WDV6T1
     I              AMV7T1                          WDV7T1
     I              AMV8T1                          WDV8T1
     I              AMV9T1                          WDV9T1
     I              AMWAT1                          WDWAT1
     I              AMWBT1                          WDWBT1
     I              AMWCT1                          WDWCT1
     I              AMWDT1                          WDWDT1
     I              AMQJNY                          WDQJNY
     I              AMQKNY                          WDQKNY
     I              AMQLNY                          WDQLNY
     I              AMP8NY                          WDP8NY
     I              AMP9NY                          WDP9NY
     I              AMQANY                          WDQANY
     I              AMQCNY                          WDQCNY
     I              AMQDNY                          WDQDNY
     I              AMQENY                          WDQENY
     I              AMQFNY                          WDQFNY
     I              AMQGNY                          WDQGNY
     I              AMQHNY                          WDQHNY
     I              AMQINY                          WDQINY
     I              AMQMNY                          WDQMNY
     I              AMMYU1                          WDMYU1
     I              AMJXSC                          WDJXSC
     I              AMJYSC                          WDJYSC
     I              AMJZSC                          WDJZSC
     I              AMJ0SC                          WDJ0SC
     I              AMMZU1                          WDMZU1
     I              AMM0U1                          WDM0U1
     I              AMM1U1                          WDM1U1
     I              AMM2U1                          WDM2U1
     I              AMM3U1                          WDM3U1
     I              AMW5DT                          WDW5DT
     I              AMW6DT                          WDW6DT
     I              AMUVST                          WDUVST
     I              AMUWST                          WDUWST
     I              AMUXST                          WDUXST
     I              AMVSST                          WDVSST
     I              AMAATM                          WDAATM
     I              AMAYNA                          WDAYNA
     I              AMA0NA                          WDA0NA
     I              AMAXDT                          WDAXDT
      *
     IYBRDCS      DS                            894
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
     IYCRDCS      DS                            179
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Manifest Detail
      * I : RST Company Number
     I                                    P   1   20P1AIC3
      * I : RST Order Number
     I                                    P   3   60P1C4NB
      * I : RST Order Sequence Number
     I                                    P   7   80P1DPNB
      * I : RST Order Secondary Line Seq
     I                                    P   9  100P1UENB
      * N :  Case Sequence Number
     I                                    P  11  130P1RZNB
      * I : MAP Item Code
     I                                    P  14  170P1HGCD
      * I : MAP Warehouse Code
     I                                       18  20 P1AJCD
      * I :  HPB COA Batch Number
     I                                    P  21  230P1ITNY
     IP2PARM      DS
      * FLD: Order Detail
      * N : MAP U_M_Ordered
     I                                        1   2 P2AGCD
      * I : MAP Order Desc_Line One
     I                                        3  32 P2G7NA
      * N :  Catch Weight Status
     I                                       33  33 P2AVST
      * N :  Production Date Control
     I                                       34  34 P2FZST
      * I : MAP Quantity Scheduled
     I                                    P  35  402P2CCQT
      * I : MAP Weight Scheduled
     I                                    P  41  462P2AUWG
      * N :  Unit Weight Ordered U_M
     I                                    P  47  522P2AVWG
     IP3PARM      DS
      * FLD: *Arrays
      * B :  USR Case Quantity
     I                                    P   1   30P3FYQT
      * B :  USR Case Weight
     I                                    P   4   92P3ZPNB
      * N :  USR Update Flag
     I                                       10  10 P3R4ST
      * N :  USR Display field
     I                                       11  11 P3GGST
      * N :  USR Display 1
     I                                       12  12 P3TIST
      * N :  USR Min Weight
     I                                    P  13  160P3MNWT
      * N :  USR Max Weight
     I                                    P  17  200P3MXWT
      * N :  USR Under Min
     I                                       21  21 P3GQST
      * N :  USR Over Max
     I                                       22  22 P3GSST
      * N :  USR Display 2
     I                                       23  23 P3TJST
     IP4PARM      DS
      * FLD: *Arrays
      * N :  Application Code
     I                                        1   6 P4DNCD
      * N :  Salesperson Code
     I                                        7   9 P4BCCD
      * N :  System Date Format
     I                                       10  12 P4B8NA
      * N :  Allow Multi_Company
     I                                       13  13 P4I6ST
      * N :  Default Printer
     I                                       14  23 P4MPNA
      * N :  Company Organization
     I                                       24  24 P4YJSX
     IP5PARM      DS
      * FLD: Company Item
      * N :  Unit Weight
     I                                    P   1   62P5AIWG
      * N :  Minimum Weight Per Case
     I                                    P   7  122P5CZWG
      * N :  Maximum Weight Per Case
     I                                    P  13  182P5C0WG
     IP6PARM      DS
      * N :  USR Exit Program
     I                                        1   1 P6STYN
     IP7PARM      DS
      * FLD: Order Header TRG
      * I :  Ship To Customer
     I                                    P   1   40P7BKC7
      * I :  Ship To Name
     I                                        5  34 P7BRTX
      * I :  Customer Purchase Order #
     I                                       35  49 P7BCNA
      * I :  Load ID
     I                                    P  50  530P7RMNB
     IP8PARM      DS
      * N :  COA RIN Modified Sts
     I                                        1   1 P8RINS
     IP9PARM      DS
      * N :  Status Flag 1  Y/N
     I                                        1   1 P9Q1ST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Weight Shipped Less than'
      * Case Weight
     I                                    P   1   62ZA0001
      * Message data for 'Weight Shipped Greater th'
      * Case Weight
     I                                    P   1   62ZA0002
      * Message data for 'Qty & Wgt must be 0'
      * USR Case Quantity
     I                                    P   1   30ZA0003
      * USR Case Weight
     I                                    P   4   92ZA0004
      * Message data for 'Quantity and Weight Rqd'
      * Case Quantity
     I                                    P   1   30ZA0005
      * Case Weight
     I                                    P   4   92ZA0006
      * Message data for 'Prod Date must be entered'
      * Production Date
     I                                    P   1   40ZA0007
      * Message data for 'Date Must Be LE Job Date'
      * Date                  USR
     I                                    P   1   40ZA0008
      * Message data for 'Incorrect Label Date ent'
      * Production Date
     I                                    P   1   40ZA0009
      * Message data for 'Label Date < Prod Date'
      * Label Date
     I                                    P   1   40ZA0010
      * Message data for 'Meter Start must be<end'
      * HPB Meter Start Gallon
     I                                    P   1   50ZA0011
      * HPB Meter Ending Gallon
     I                                    P   6  100ZA0012
      * Message data for 'Quantity and gallons <>'
      * Case Quantity
     I                                    P   1   30ZA0013
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0014
      * Application Code
     I                                       11  16 ZA0015
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0016
      * Application Code
     I                                       11  16 ZA0017
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
     C           P1DPNB    PARM           WP0003  30       Order Sequence
     C           P1UENB    PARM           WP0004  30       Order Secondary
     C           P1HGCD    PARM           WP0005  70       Item Code
     C           P1AJCD    PARM           WP0006  3        Warehouse Code
     C           P1ITNY    PARM           WP0007  50       HPB COA Batch N
     C           P2G7NA    PARM           WP0008 30        Order Desc_Line
     C           P2CCQT    PARM           WP0009 112       Quantity Schedu
     C           P2AUWG    PARM           WP0010 112       Weight Schedule
     C           P3FYQT    PARM P3FYQT    WP0011  50       USR Case Quanti
     C           P3ZPNB    PARM P3ZPNB    WP0012 112       USR Case Weight
     C           P7BKC7    PARM           WP0013  70       Ship To Custome
     C           P7BRTX    PARM           WP0014 30        Ship To Name
     C           P7BCNA    PARM           WP0015 15        Customer Purcha
     C           P7RMNB    PARM           WP0016  70       Load ID
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise and load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END
     C                     END
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise & load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
     C           YPMTFD    IFEQ *BLANKS
      * USER: Initialize subfile header
     C                     MOVELP7BCNA    #CBCNA           Customer Purcha
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0001           Company Number
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #CAPTX    P      Name
     C                     Z-ADDP2CCQT    #PCCQT           Quantity Schedu
     C                     Z-ADDP2AUWG    #PAUWG           Weight Schedule
      * RTV Manifest detail    RT - PD Order Detail  * 
     C                     EXSR SBRVGN
      * WI464
      * Rtv Pallet Type 2     RT - Order Detail  * 
     C                     EXSR SCRVGN
      * RTV for Ord.Detail     XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDC3XFR'              90  RTV for Ord.Det
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0001  30       Company Number
     C                     PARM #PHGCD    WQ0002  70       Item Code
     C           #CJ2NA    PARM *BLANK    WQ0003 30        Description Lin
     C           WUAWNA    PARM *BLANK    WQ0004 30        Description Lin
     C           WUADCD    PARM *BLANK    WQ0005  2        UOM Primary
     C           WUAICD    PARM *BLANK    WQ0006  2        UOM Pricing
     C           P5AIWG    PARM *ZERO     WQ0007 112       Unit Weight
     C           WURBCD    PARM *BLANK    WQ0008  2        Item Level
     C           WUG0TX    PARM *BLANK    WQ0009  1        Production Date
     C           P2AVST    PARM *BLANK    WQ0010  1        Catch Weight St
     C           WURINB    PARM *ZERO     WQ0011  30       Item Structure
     C           WURHNB    PARM *ZERO     WQ0012  30       Item Structure
     C           WURGNB    PARM *ZERO     WQ0013  30       Item Structure
     C           WULNCD    PARM *BLANK    WQ0014  3        Default Commod
     C           WUTFNB    PARM *ZERO     WQ0015  30       Transportation
     C           WUN0CD    PARM *BLANK    WQ0016  3        Item Type Code
     C           WULRCD    PARM *BLANK    WQ0017  7        Commodity Price
     C           WUQ1CD    PARM *BLANK    WQ0018  3        Default Warehou
     C           WUQ8CD    PARM *BLANK    WQ0019  3        Price Method De
     C           #CCHMT    PARM *ZERO     WQ0020  52       Fresh Chilling
     C           WUXWST    PARM *BLANK    WQ0021  1        Variety_Rendere
     C           WUF5WG    PARM *ZERO     WQ0022 112       Item Target Pri
     C           WUECST    PARM *BLANK    WQ0023  1        Error Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDC3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * If CW sts not found for item, use what's on order
      * CASE: PAR.Catch Weight Status EQ WRK.BLANK
     C           P2AVST    IFEQ WUGSTX                     *IF
     C                     MOVELWUAVST    P2AVST           Catch Weight St
     C                     END                             *FI
     C                     Z-ADD*ZERO     WURZNB           Case Sequence N
      * RTV Next Key           RT - OM Manifest Detail  * 
     C                     EXSR SDRVGN
     C                     MOVEL*BLANK    P3R4ST           USR Update Flag
      * If production date control is no then do not display label date
      * CASE: PAR.Production Date Control is no
     C           P2FZST    IFEQ 'N'                        *IF
     C                     MOVEL'N'       P3TJST           USR Display 2
     C                     END                             *FI
     C                     Z-ADDP7BKC7    #CBKC7           Ship To Custome
     C                     MOVELP7BRTX    #CBRTX           Ship To Name
      * FP1110 HPB modifications - RMC 11/07/7
     C                     Z-ADDP1ITNY    #CI3NY           COA Batch Numbe
      * RTV Prod Temp-HPB     RT - Load Header  * 
     C                     EXSR SERVGN
     C                     Z-ADDYL0002    YL0003           COA Temperature
      * Rtv HPB fields        RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#PAJCD    WL0003    P      Warehouse Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    YL0004    P      Production Ware
     C                     MOVELWL0005    YL0005    P      Warehouse Locat
     C                     MOVELWL0006    #CRTSX    P      WHS Req Meter R
      * FP1322 chk for an open tank per prod whse on the order's whse
      * Rtv Acct Co          RT - Warehouse  * 
     C                     EXSR SGRVGN
      * RTV Get Batch Dens,Ld RT - COA Batch Header  * get open batch
     C                     EXSR SHRVGN
     C                     END
      *................................................................
      * If CHANGE mode, then position file:
     C           W0PMD     IFNE 'ADD'
     C           KPOS      KLIST
     C                     KFLD           FNAIC3           Company Number
     C                     KFLD           FNC4NB           Order Number
     C                     KFLD           FNDPNB           Order Sequence
     C                     KFLD           FNUENB           Order Secondary
      * Setup key
     C                     Z-ADD#2AIC3    FNAIC3
     C                     Z-ADD#2C4NB    FNC4NB
     C                     Z-ADD#2DPNB    FNDPNB
     C                     Z-ADD#2UENB    FNUENB
      * 82=EOF
     C           KPOS      SETLL@FNCPE5              82    *
      * 82=EOF
     C           KRST      KLIST
     C                     KFLD           FNAIC3           Company Number
     C                     KFLD           FNC4NB           Order Number
     C                     KFLD           FNDPNB           Order Sequence
     C                     KFLD           FNUENB           Order Secondary
      * Setup key
     C                     Z-ADD#2AIC3    FNAIC3
     C                     Z-ADD#2C4NB    FNC4NB
     C                     Z-ADD#2DPNB    FNDPNB
     C                     Z-ADD#2UENB    FNUENB
     C  N82      KRST      READE@FNCPE5                9182*
     C                     ELSE
     C                     SETOF                     82    *
     C                     END
      * Load subfile page
     C                     EXSR BBLDSF
      * If no records (first time only), switch to add mode and load agai
     C           W0APM     IFEQ 'Y'
     C           ##RR      ANDEQ*ZERO
     C                     MOVEL'ADD'     W0PMD
     C                     SETOF                     82    *
     C                     EXSR BBLDSF
     C                     END
     C                     MOVEL'N'       W0APM   1
      *................................................................
      * If no records found, display error message
     C   82      ##RR      IFEQ *ZERO                      IF
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
      *
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page (write empty page if add mode)
      *================================================================
     C                     SETOF                     84    No SFLNXTCHG
      * Re-establish fields in read-ahead record
     C   27      W0PMD     IFNE 'ADD'
     C  N82                READP@FNCPE5                  90*
     C  N82                READ @FNCPE5                  90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVE *ALL'0'   WKIND0  8
     C                     MOVE *ALL'1'   WKIND1  8
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
     C                     Z-ADD*ZERO     ##RROK  50
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next subfile page
     C  N82      ##RROK    DOWLT##SFLN                     DO
     C                     ADD  1         ##RR
     C                     MOVEAWKIND0    *IN,31
     C                     SETOF                     87    *
      * Clear subfile fields
     C                     EXSR MAIZ#1
      * If CHANGE mode, load subfile fields
     C           W0PMD     IFNE 'ADD'
     C                     EXSR MBFL#1
      * Record will be selected unless overridden
     C                     MOVEL'Y'       W0RSL   1
      * USER: Initialize subfile record (existing record)
     C                     Z-ADDFNRZNB    WURZNB           Case Sequence N
     C                     Z-ADDWURZNB    #1RZNB           Case Sequence N
      * FP1110
     C                     Z-ADDFNIVNY    #1IVNY           HPB Meter Start
     C                     Z-ADDFNIUNY    #1IUNY           HPB Meter Endin
      * If record dropped...
     C                     SUB  1         ##RR
     C           W0RSL     CABNE'Y'       BB020
     C                     ADD  1         ##RR
      * Validate subfile record and calculate derived fields
     C                     EXSR DFV2RC
     C                     ELSE
     C           YPMTFD    IFEQ *BLANKS
      * USER: Initialize subfile record (new record)
     C                     ADD  1         WURZNB           Case Sequence N
     C                     Z-ADDWURZNB    #1RZNB           Case Sequence N
     C                     END
     C                     END
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Output to subfile
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     WRITE#SFLRCD
     C           BB020     TAG
     C           W0PMD     IFNE 'ADD'
      * 82=EOF
     C           KRST      READE@FNCPE5                  82*
     C                     END
     C  N82                END
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Convert fields to external form
     C  N30N27             EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate subfile control
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0001           Company Number
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #CAPTX    P      Name
      * CASE: CTL.*CMD key is CF10
     C           *IN10     IFEQ '1'                        *IF
      * CASE: PAR.USR Display 1 is No
     C           P3TIST    IFEQ 'N'                        *IF
     C                     MOVEL'Y'       P3TIST           USR Display 1
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       P3TIST           USR Display 1
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END
      * Quit if reload requested
     C           W0RSF     CABEQ'Y'       DAEXIT
      *
     C   81                DO
      * No data entered as yet
     C                     MOVEL'N'       WKIPIN  1
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Process subfile records
     C                     EXSR DBPRSF
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * If data entered
     C           WKIPIN    IFEQ 'Y'
      * Prompt for confirmation
     C                     EXSR DHPRCF
      * Exit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO DAEXIT
     C                     END
      * Update DBF from subfile
     C                     EXSR EAPRSF
      * If error during update, exit:
     C           *IN99     CABEQ'1'       DAEXIT
     C                     END                             WKIPIN
     C                     END
      * Switch between *ADD/*CHANGE modes
     C   09                EXSR FACHMD
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process command keys
      * Subfile has been updated
      * CASE: PAR.USR Update Flag is Yes
     C           P3R4ST    IFEQ 'Y'                        *IF
      * RTV Chg for Confirm    RT - Order Detail  * 
     C                     EXSR SJRVGN
      * RTV Crt/Chg HPB Batch RT - Order Header Extension  * 
     C                     EXSR SNRVGN
      * CASE: PAR.USR Exit Program is yes
     C           P6STYN    IFEQ 'Y'                        *IF
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'CHG'     W0PMD            *Program mode
      * Weight entered as shipped is less than Minimum
      * CASE: PAR.USR Under Min is yes
     C           P3GQST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     Z-ADDWUR0NB    ZA0001           Case Weight
      * Send message 'Weight Shipped Less than'
     C                     MOVEL'USR2283' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'N'       P3GQST           USR Under Min
     C                     END                             *FI
      * Weight entered is greater than the maxiumum
      * CASE: PAR.USR Over Max is yes
     C           P3GSST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     Z-ADDWUR0NB    ZA0002           Case Weight
      * Send message 'Weight Shipped Greater th'
     C                     MOVEL'USR2284' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'N'       P3GSST           USR Over Max
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
     C                     EXSR DCPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
     C                     SETOF                     87    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,31
      * No errors
     C                     SETOF                     98
      * No SFLNXTCHG
     C                     SETOF                     84
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C           W0PMD     IFEQ 'ADD'
      * Check for null record
     C                     EXSR DDNLRC
     C           W0NLR     IFEQ 'Y'
     C           ##RR      ANDNEYPMRRN
      * Clear all record fields
     C                     EXSR MAIZ#1
     C                     GOTO DCEXIT
     C                     END
      * If not null record, continue
     C                     END
      * Data entered
     C                     MOVEL'Y'       WKIPIN
      * SFLNXTCHG
     C                     SETON                     84
      * If delete request, bypass validation
     C           #1SEL     IFEQ '4'
     C                     GOTO DCEXIT
     C                     END
      * Validate subfile record
     C                     EXSR DEV1RC
      * If SFLRCD invalid, note the fact
     C   98N99             Z-ADD##RR      ##SFRC     99    *
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         DDNLRC    BEGSR
      *================================================================
      * Check for null record
      *================================================================
     C                     MOVEL'N'       W0NLR   1
     C           #1FOQT    CABNE*ZERO     DDEXIT           Case Quantity
     C           #1R0NB    CABNE*ZERO     DDEXIT           Case Weight
     C           V1ELDT    CABNE*ZERO     DDEXIT           Production Date
     C           #RUEST    CABNE*BLANK    DDEXIT           USR Zero Value
     C           #1RZNA    CABNE*BLANK    DDEXIT           Manifest Lot ID
     C           #1IVNY    CABNE*ZERO     DDEXIT           HPB Meter Start
     C           #1IUNY    CABNE*ZERO     DDEXIT           HPB Meter Endin
     C                     MOVEL'Y'       W0NLR
      *================================================================
     CSR         DDEXIT    ENDSR
      /EJECT
     CSR         DEV1RC    BEGSR
      *================================================================
      * Validate subfile record
      *================================================================
      * Validate Production Date
      * External date
     C                     Z-ADDV1ELDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9834  *
     C                     END
     C                     Z-ADDXDINDT    #1ELDT
      * Validate USR Zero Value
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#RUEST    W0NSRQ  1        USR Zero Value
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#RUEST'  OREQ YPMTFD
     C           ##RR      ANDEQYPMRRN
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1232581   Y2LSNO  70
     C           #RUEST    PARM #RUEST    W0EXVL 25        USR Zero Value
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate subfile record fields
      * Select Production Date
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> RCD.Production Date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CSRR    IFEQ ##RR                       *
     C           W0CFL     ANDEQ'V1ELDT'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Sel Prod Date-Manifest SR - Item Balance Detail  * 
     C                     CALL 'PDZESRR'              90  Sel Prod Date-M
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0024  30       Company Number
     C                     PARM #PHGCD    WQ0025  70       Item Code
     C                     PARM #PAJCD    WQ0026  3        Warehouse Code
     C           #1ELDT    PARM #1ELDT    WQ0027  70       Production Date
     C           #1K7DT    PARM *ZERO     WQ0028  70       Label Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDZESRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9834  *
     C                     END
     C                     END                             *FI
      * Delete Manifest Record
      * CASE: RCD.*SFLSEL is *Delete request
     C           #1SEL     IFEQ '4'                        *IF
     C           #1SEL     OREQ ' 4'
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DEEXIT                     *QUIT
     C                     END                             *FI
      * Compute standard weight for non-catchweight items
      * CASE: PAR.Catch Weight Status is Not Yes
     C           P2AVST    IFEQ *BLANK                     *IF
     C           P2AVST    OREQ 'N'
     C           #1FOQT    MULT P5AIWG    #1R0NB           Case Weight
     C                     END                             *FI
      * If Y is entered for USR edit for Quantity & Weight
      * CASE: RCD.USR Zero Value is Yes
     C           #RUEST    IFEQ 'Y'                        *IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : RCD.Case Quantity is NE *ZERO
      *   |- c2    : RCD.Case Weight is NE *ZERO
      *   '-
     C           #1FOQT    IFNE *ZERO                      *IF
     C           #1R0NB    ORNE *ZERO                      *OR
      * Setup message data for message
     C                     Z-ADD#RFYQT    ZA0003           USR Case Quanti
     C                     Z-ADD#RZPNB    ZA0004           USR Case Weight
      * Send message 'Qty & Wgt must be 0'
     C                     MOVEL'USR1588' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * IF " " Entered for Zero Quantity flag
      * CASE: RCD.USR Zero Value is No
     C           #RUEST    IFEQ *BLANK                     *IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : RCD.Case Quantity is EQ *ZERO
      *   |- c2    : RCD.Case Weight is EQ *ZERO
      *   '-
     C           #1FOQT    IFEQ *ZERO                      *IF
     C           #1R0NB    OREQ *ZERO                      *OR
      * Setup message data for message
     C                     Z-ADD#1FOQT    ZA0005           Case Quantity
     C                     Z-ADD#1R0NB    ZA0006           Case Weight
      * Send message 'Quantity and Weight Rqd'
     C                     MOVEL'USR1325' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     983233*
      *
     C                     END                             *FI
     C                     END                             *FI
      * Production Date
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Production Date Control is yes
      *   |- c2    : RCD.Production Date is not entered
      *   |- c3    : RCD.USR Zero Value is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2FZST    IFEQ 'Y'                        *IF
     C           #1ELDT    IFEQ *ZERO                      *IF
     C           #RUEST    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
      * Convert Production Date to display format
      * Convert date
     C           1000000   ADD  #1ELDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0007
      * Send message 'Prod Date must be entered'
     C                     MOVEL'USR1916' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9834  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Production Date must be <= current date
      * CASE: RCD.Production Date GT JOB.*Job date
     C           #1ELDT    IFGT ##JDT                      *IF
      * Setup message data for message
      * Convert Production Date to display format
      * Convert date
     C           1000000   ADD  #1ELDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0008
      * Send message 'Date Must Be LE Job Date'
     C                     MOVEL'USR3001' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9834  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD#1ELDT    #1K7DT           Label Date
     C                     END                             *FI
     C                     END                             *FI
      * Label Date edit
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Production Date Control is yes
      *   |- c2    : RCD.USR Zero Value is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2FZST    IFEQ 'Y'                        *IF
     C           #RUEST    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Label Date         RT - IC Item Balance Detail  * 
     C                     EXSR SRRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Info Message if entered a different label date
      * CASE:
      *  - c1 AND c2
      *   |- c1    : RCD.Label Date NE WRK.Label Date
      *   |- c2    : RCD.Label Date NE WRK.ZERO
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1K7DT    IFNE WUK7DT                     *IF
     C           #1K7DT    IFNE WUW0NB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
      * Convert Production Date to display format
      * Convert date
     C           1000000   ADD  #1ELDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0009
      * Send message 'Incorrect Label Date ent'
     C                     MOVEL'USR2536' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     Z-ADDWUK7DT    #1K7DT           Label Date
     C                     END                             *FI
      * Label Date must be >= Prod Date
      * CASE: RCD.Label Date LT RCD.Production Date
     C           #1K7DT    IFLT #1ELDT                     *IF
      * Setup message data for message
      * Convert Label Date to display format
      * Convert date
     C           1000000   ADD  #1K7DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0010
      * Send message 'Label Date < Prod Date'
     C                     MOVEL'USR2537' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * FP1110 HPB project - new validation for meter readings, weight ca
      * CASE: CTL.WHS Req Meter Reading Shp is Yes
     C           #CRTSX    IFEQ 'Y'                        *IF
     C                     Z-ADD#CI3NY    #1ITNY           HPB COA Batch N
      * Calc HPB Net Gallons
      * CASE: RCD.HPB Meter Start Gallon GT RCD.HPB Meter Ending Gallon
     C           #1IVNY    IFGT #1IUNY                     *IF
      * Setup message data for message
     C                     Z-ADD#1IVNY    ZA0011           HPB Meter Start
     C                     Z-ADD#1IUNY    ZA0012           HPB Meter Endin
      * Send message 'Meter Start must be<end'
     C                     MOVEL'USR3843' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     983738*
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Calc Total Gross Gallon for manifest detail
      * CASE: RCD.Case Quantity is EQ *ZERO
     C           #1FOQT    IFEQ *ZERO                      *IF
     C           #1IUNY    SUB  #1IVNY    #1FOQT           Case Quantity
      * add 1 to make it inclusive
     C                     ADD  1         #1FOQT           Case Quantity
     C                     Z-ADD#1FOQT    #1IWNY           HPB Meter Total
     C                     ELSE
      * CASE: *OTHERWISE
     C           #1IUNY    SUB  #1IVNY    #1IWNY           HPB Meter Total
     C                     ADD  1         #1IWNY           HPB Meter Total
      * CASE: RCD.Case Quantity NE RCD.HPB Meter Total Gallon
     C           #1FOQT    IFNE #1IWNY                     *IF
      * Setup message data for message
     C                     Z-ADD#1FOQT    ZA0013           Case Quantity
      * Send message 'Quantity and gallons <>'
     C                     MOVEL'USR3844' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9832  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * RMC -- Round Net Gallons to a whole number per Tom 4/23/08
      * Calc Factor or Use API Table - 7/14/10
      * CASE: LCL.RFS Volume Corr Mthd  USR is Calculate factor per Prop
     C           YL0039    IFEQ 'C'                        *IF
      * New formula - after 6/27/10 -  goes in with RFS2/EMTS    P000579
     C                     Z-ADD-.00045767WUJQNY           COA Temp Conv F
     C                     Z-ADD1.02746025WUJRNY           COA Temp Conv F
      * Compute: rcd.Net gallons
      * WRK.Quantity 7.0 USR =
      *    *COMPUTE (x1* (x2 * x3 +x4))
      * x1    : RCD.HPB Meter Total Gallon
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x2    : WRK.COA Temp Conv Factor 1
      * *     : PGM.*Synon (17,9) work field *
      * x3    : LCL.COA Temperature Loadout
      * +     : PGM.*Synon (17,9) work field
      * x4    : WRK.COA Temp Conv Factor 2
     C           WUJQNY    MULT YL0003    W0WE02           *Synon (17,9) w
     C           W0WE02    ADD  WUJRNY    W0WE01           *Synon (17,9) w
     C           #1IWNY    MULT W0WE01    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WUTQTC           Quantity 7.0 US
      * Compute: density ref NEW
      * WRK.COA Density Ref Adj 4 dec =
      *    *COMPUTE ((x1 *x2 +x3) * x5)
      * x1    : WRK.COA Temp Conv Factor 1
      * *     : PGM.*Synon (17,9) work field *
      * x2    : LCL.COA Temperature Loadout
      * +     : PGM.*Synon (17,9) work field
      * x3    : WRK.COA Temp Conv Factor 2
      * *     : PGM.*Synon (17,9) work field *
      * x5    : LCL.COA Density Loadout
     C           WUJQNY    MULT YL0003    W0WE02           *Synon (17,9) w
     C           W0WE02    ADD  WUJRNY    W0WE01           *Synon (17,9) w
     C           W0WE01    MULT YL0007    W0WE00           *Synon (17,9) w
     C                     Z-ADDW0WE00    WULRNY           COA Density Ref
     C                     ELSE
      * CASE: LCL.RFS Volume Corr Mthd  USR is API Volume Corr Table
     C           YL0039    IFEQ 'A'                        *IF
     C                     Z-ADDYL0003    YL0040           RFS Loadout Tem
      * Rtv API Vol Cor Fctor RT - RFS API Volume Corr Table  * 
     C                     EXSR SSRVGN
     C                     Z-ADDYL0041    WUJSNY           HPB Temperature
      * Compute: rcd.Net gallons
      * WRK.Quantity 7.0 USR =
      *    *COMPUTE (x1* x2)
      * x1    : RCD.HPB Meter Total Gallon
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x2    : WRK.HPB Temperature Adjustmnt
     C           #1IWNY    MULT WUJSNY    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WUTQTC           Quantity 7.0 US
      * Compute: density ref NEW
      * WRK.COA Density Ref Adj 4 dec =
      *    *COMPUTE (x1 * x5)
      * x1    : WRK.HPB Temperature Adjustmnt
      * *     : PGM.*Synon (17,9) work field *Rounded
      * x5    : LCL.COA Density Loadout
     C           WUJSNY    MULT YL0007    W0WE00    H      *Synon (17,9) w
     C                     Z-ADDW0WE00    WULRNY           COA Density Ref
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWUTQTC    #1N6WG           HPB Meter Net G
     C                     Z-ADDWULRNY    #1IYNY           HPB Density Ref
     C                     END                             *FI
      * Calc Gross weight from density loadout and other factor
      * Compute: Fuel Weight
      * RCD.Case Weight =
      *    *COMPUTE (x1*x2*x3)
      * x1    : RCD.HPB Meter Total Gallon
      * *     : PGM.*Synon (17,7) work field *
      * x2    : LCL.COA Density Loadout
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.8.33
     C           #1IWNY    MULT YL0007    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT 8.33      W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    #1R0NB           Case Weight
      * Calc Net weight from density loadout and other factor
      * Compute: Fuel Weight
      * RCD.HPB Meter Net Weight =
      *    *COMPUTE (x1*x2*x3)
      * x1    : RCD.HPB Meter Net Gallon
      * *     : PGM.*Synon (17,7) work field *
      * x2    : LCL.COA Density Loadout
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.8.33
     C           #1N6WG    MULT YL0007    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT 8.33      W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    #1IXNY           HPB Meter Net W
     C                     END                             *FI
      * E4119L MG project -- calc gross weight   8/10/16 RMC
      * Rtv Tare Weight        RT - Company Item  * 
     C                     EXSR STRVGN
      * RTV Itm BxID & Tares  RT - Item Bill Of Material  * 
     C                     EXSR SURVGN
     C           YL0044    ADD  YL0043    YL0048           Total Tare USR
      * WI464 get wt for order's pallet type
      * CASE: LCL.OD Pallet Type is None
     C           YL0001    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Pallet Weight     RT - Pallet Master  * 
     C                     EXSR SWRVGN
     C                     END                             *FI
      * Pallet Tare
      * CASE: LCL.Palletize is yes
     C           YL0049    IFEQ 'Y'                        *IF
      * CASE: LCL.Number Cases On A Pallet is GT Zero
     C           YL0045    IFGT *ZERO                      *IF
      * Pallet Weight
      * LCL.Weight 1.2             .U =
      *    *COMPUTE (x1 / x2 * x3)
      * x1    : RCD.Case Quantity
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : LCL.Number Cases On A Pallet
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : LCL.Pallet Tare Weight
     C           #1FOQT    DIV  YL0045    W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT YL0046    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0050           Weight 1.2
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0050           Weight 1.2
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0050           Weight 1.2
     C                     END                             *FI
      * Rtv Live w/Carlisle   RT - Warehouse  * 
     C                     EXSR SXRVGN
      * E00196 RMC 8/24/12 chk pfs interface SHPTRN too
      * Rtv Active Status     RT - PFS Interface  * 
     C                     EXSR SYRVGN
      * Box & Miscellaneous Tare
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.WHS Live w/Carlisle is Yes
      *   |- c2    : LCL.PFS Carlisle Active is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0051    IFEQ 'Y'                        *IF
     C           YL0053    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Box + Misc Tare
      * LCL.Weight 2.1             .U =
      *    *COMPUTE ((x1 + x2) * x3)
      * x1    : LCL.Box Weight
      * +     : PGM.*Synon (15,2) work field
      * x2    : LCL.Misc Tare Weight
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : RCD.Case Quantity
     C           YL0044    ADD  YL0043    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT #1FOQT    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0054           Weight 2.1
     C                     END                             *FI
     C           #1R0NB    ADD  YL0054    #1N5WG           Manifest Gross
     C                     ADD  #1FOQT    P3FYQT           USR Case Quanti
     C                     ADD  #1R0NB    P3ZPNB           USR Case Weight
      * R11974 DN 11/08/17-Calc Manifest Net Weight in Kg for Seaboard Or
      * CASE: *OTHERWISE
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
     C                     EXSR SZRVGN
      * CASE: LCL.Company Organization is Seaboard
     C           YL0055    IFEQ 'S'                        *IF
      * CASE: RCD.Case Weight is NE *ZERO
     C           #1R0NB    IFNE *ZERO                      *IF
      * Clc Weight to Kilogram IF
      * Round Case Weight to 1 Decimal Place.
      * RMC 10/14/19 increase precision - DO NOT DO THIS  10/16/19 PER AA
     C           #1R0NB    MULT .45359    YL0056           Net Weight Kg U
     C           YL0056    MULT 1         YL0057    H      Net Weight Kilo
     C                     Z-ADDYL0057    #1N7WG           Manifest Net We
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * Validate subfile record relations
     C                     EXSR DFV2RC
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      *================================================================
     CSR         DEEXIT    ENDSR
      /EJECT
     CSR         DFV2RC    BEGSR
      *================================================================
      * Validate subfile record relations
      *================================================================
      *================================================================
     CSR         DFEXIT    ENDSR
      /EJECT
     CSR         DHPRCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      * Update screen time
     C                     TIME           ##TME
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'Y'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#SFLCTL
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         EAPRSF    BEGSR
      *================================================================
      * Update DBF from subfile
      *================================================================
      * Initialise subfile reload flag
     C           W0PMD     IFEQ 'ADD'
     C                     MOVEL'Y'       W0RSF
     C                     ELSE
     C                     MOVEL'N'       W0RSF
     C                     END
      * Process all modified subfile records
     C                     READC#SFLRCD                  92*
     C           *IN92     DOWEQ'0'
      * Process modified subfile record
     C                     EXSR EBPRSR
     C                     MOVEL*BLANK    #1SEL
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      * If any errors, cancel reload
     C           *IN99     IFEQ '1'
     C                     MOVEL'N'       W0RSF   1
     C                     END
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPRSR    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,31
     C                     SETOF                     98
      *
     C           W0PMD     IFEQ 'ADD'
      * Process add request
     C           #1SEL     IFNE '4'
     C                     EXSR DDNLRC
     C           W0NLR     IFNE 'Y'
     C                     EXSR ECADRQ
     C                     END
     C                     END
     C                     ELSE
     C           #1SEL     IFEQ '4'
      * Process delete request
     C                     EXSR EDDLRQ
     C                     ELSE
      * Process change request
     C                     EXSR EECHRQ
     C                     END
     C                     END
      * If error occurred on update, note the fact
     C           *IN98     IFEQ '1'
     C           *IN99     IFEQ '0'
     C                     Z-ADD##RR      ##SFRC     99    *
     C                     END
     C                     END
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         ECADRQ    BEGSR
      *================================================================
      * Process add request
      *================================================================
      * USER: Create DBF record
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1LPNZ' defaulted for 'Manifest Pallet Nbr 3PL'.
      * ADD Manifest Detl Rec  CR - Manifest Detail  * 
     C                     EXSR TACRRC
     C           W0RTN     IFNE *BLANK
      * Write error detected
      * Screen errors
     C                     MOVEAWKIND1    *IN,31
      * Format error
     C                     SETON                     98    *
      * Enable entry
     C                     SETOF                     87    *
      * SFLNXTCHG
     C                     SETON                     84    *
     C                     ELSE
      * DBF write successful
      * disable entry
     C                     SETON                     87    *
      * No SFLNXTCHG
     C                     SETOF                     84    *
     C                     END
      *================================================================
     CSR         ECEXIT    ENDSR
      /EJECT
     CSR         EDDLRQ    BEGSR
      *================================================================
      * Process delete request
      *================================================================
      * USER: Delete DBF record
      * DLT Manifest Detail    DL - Manifest Detail  * 
     C                     EXSR TBDLRC
     C           W0RTN     IFNE *BLANK
      * Delete unsuccessful
      * Screen errors
     C                     MOVEAWKIND1    *IN,31
      * Format error
     C                     SETON                     98    *
      * Enable entry
     C                     SETOF                     87    *
      * SFLNXTCHG
     C                     SETON                     84    *
      * If record altered, reset subfile record
     C           W0RTN     CASEQ'Y2U0007' MBFL#1           IF
     C                     END
     C                     ELSE
      * DBF delete successful
      * Blank out record and protect from entry
     C                     EXSR MAIZ#1
      * disable entry
     C                     SETON                     87    *
      * No SFLNXTCHG
     C                     SETOF                     84    *
      * Reload subfile
     C                     MOVEL'Y'       W0RSF   1
     C                     END
      *================================================================
     CSR         EDEXIT    ENDSR
      /EJECT
     CSR         EECHRQ    BEGSR
      *================================================================
      * Process update request
      *================================================================
      * USER: Change DBF record
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1LPNZ' defaulted for 'Manifest Pallet Nbr 3PL'.
      * CHG OM Manifest Detail CH - Manifest Detail  * 
     C                     EXSR TCCHRC
     C           W0RTN     IFNE *BLANK
      * Data update error
      * Screen errors
     C                     MOVEAWKIND1    *IN,31
      * Format error
     C                     SETON                     98    *
      * Enable entry
     C                     SETOF                     87    *
      * SFLNXTCHG
     C                     SETON                     84    *
      * Reset subfile record if changed record
     C           W0RTN     CASEQ'Y2U0007' MBFL#1           IF
     C                     END
     C                     ELSE
      * DBF update successful
      * Enable entry
     C                     SETOF                     87    *
      * No SFLNXTCHG
     C                     SETOF                     84    *
     C                     END
      *================================================================
     CSR         EEEXIT    ENDSR
      /EJECT
     CSR         FACHMD    BEGSR
      *================================================================
      * Switch between *ADD/*CHANGE modes
      *================================================================
     C           W0PMD     IFNE 'ADD'
     C                     MOVEL'ADD'     W0PMD
     C                     ELSE
     C                     MOVEL'CHG'     W0PMD
     C                     END
     C                     EXSR FBRQRL
      *================================================================
     CSR         FAEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for Subfile record
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      * Protect keys if change mode or updated record
     C                     SETON                     88    *
     C   89N87             SETOF                     88    *
     C                     MOVEL*IN87     *IN77
     C           W0PMD     IFEQ 'ADD'                      *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL*IN87     *IN76
     C           P2AVST    IFEQ *BLANK                     *IF
     C           P2AVST    OREQ 'N'
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
     C                     MOVEL*IN87     *IN75
     C           P2FZST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN75
     C                     END                             *FI
     C                     MOVEL*IN87     *IN74
     C           P3TIST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN74
     C                     END                             *FI
     C                     MOVEL*IN87     *IN73
     C           #CRTSX    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN73
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSA2    BEGSR
      *================================================================
      * Set display attributes for Subfile control
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
     C                     MOVEL'0'       *IN79
     C           #CRTSX    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           W0PMD     IFEQ 'ADD'                      *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise subfile record
      *================================================================
      * Previous values
     C                     MOVEL*BLANK    #1DBRC
     C                     Z-ADDP1AIC3    #1AIC3           Company Number
     C                     Z-ADDP1HGCD    #1HGCD           Item Code
     C                     MOVELP1AJCD    #1AJCD           Warehouse Code
     C                     MOVEL*BLANK    #1UVST           EDI Status 1
     C                     MOVEL*BLANK    #1UWST           EDI Status 2
     C                     MOVEL*BLANK    #1UXST           EDI Status 3
     C                     MOVEL*BLANK    #1VSST           Record Status
     C                     Z-ADD*ZERO     #RZPNB           USR Case Weight
     C                     Z-ADD*ZERO     #1N5WG           Manifest Gross
     C                     Z-ADD*ZERO     #1H5NY           Manifest Total
     C                     Z-ADD*ZERO     #1H6NY           Manifest Co_Par
     C                     Z-ADD*ZERO     #1H7NY           Manifest Pallet
     C                     MOVEL*BLANK    #1GBTX           Manifest Shift
     C                     Z-ADD*ZERO     #1N6WG           HPB Meter Net G
     C                     Z-ADD*ZERO     #1N7WG           Manifest Net We
     C                     MOVEL*BLANK    #1GCTX           Manifest Unused
     C                     MOVEL*BLANK    #1GDTX           Manifest Unused
     C                     Z-ADD*ZERO     #1RBDT           Manifest Unused
     C                     Z-ADD*ZERO     #1ITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     #1IWNY           HPB Meter Total
     C                     Z-ADD*ZERO     #1IXNY           HPB Meter Net W
     C                     Z-ADD*ZERO     #1IYNY           HPB Density Ref
     C                     Z-ADD*ZERO     #1K7DT           Label Date
     C                     Z-ADD*ZERO     #1PFNX           PT Serial Numbe
     C                     Z-ADD*ZERO     #1RZNB           Case Sequence N
     C                     MOVEL*BLANK    #RH2NA           USR Location Zo
     C                     MOVEL*BLANK    #RH3NA           USR Location Ai
     C                     MOVEL*BLANK    #RH4NA           USR Location Ti
     C                     MOVEL*BLANK    #RH5NA           USR Location Bi
     C                     Z-ADD*ZERO     #RFYQT           USR Case Quanti
     C                     MOVEL*BLANK    #1PMST           Inventory Updat
     C                     Z-ADDP1C4NB    #1C4NB           Order Number
     C                     Z-ADDP1DPNB    #1DPNB           Order Sequence
     C                     Z-ADDP1UENB    #1UENB           Order Secondary
     C                     Z-ADD*ZERO     #1AATM           Job Time
     C                     MOVEL*BLANK    #1AYNA           User Id
     C                     MOVEL*BLANK    #1A0NA           Job Name
     C                     Z-ADD*ZERO     #1AXDT           Job Date
     C                     Z-ADD*ZERO     #1LPNZ           Manifest Pallet
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     Z-ADD*ZERO     #1FOQT           Case Quantity
     C                     Z-ADD*ZERO     #1R0NB           Case Weight
     C                     Z-ADD*ZERO     #1ELDT           Production Date
      * Clear external version also
     C                     Z-ADD*ZERO     V1ELDT
     C                     MOVEL*BLANK    #RUEST           USR Zero Value
     C                     MOVEL*BLANK    #1RZNA           Manifest Lot ID
     C                     Z-ADD*ZERO     #1IVNY           HPB Meter Start
     C                     Z-ADD*ZERO     #1IUNY           HPB Meter Endin
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @FNCPE5 fields to subfile
      *================================================================
     C                     Z-ADDFNAIC3    #1AIC3           Company Number
     C                     Z-ADDFNHGCD    #1HGCD           Item Code
     C                     MOVELFNAJCD    #1AJCD           Warehouse Code
     C                     MOVELFNUVST    #1UVST           EDI Status 1
     C                     MOVELFNUWST    #1UWST           EDI Status 2
     C                     MOVELFNUXST    #1UXST           EDI Status 3
     C                     MOVELFNVSST    #1VSST           Record Status
     C                     Z-ADDFNN5WG    #1N5WG           Manifest Gross
     C                     Z-ADDFNH5NY    #1H5NY           Manifest Total
     C                     Z-ADDFNH6NY    #1H6NY           Manifest Co_Par
     C                     Z-ADDFNH7NY    #1H7NY           Manifest Pallet
     C                     MOVELFNGBTX    #1GBTX           Manifest Shift
     C                     Z-ADDFNN6WG    #1N6WG           HPB Meter Net G
     C                     Z-ADDFNN7WG    #1N7WG           Manifest Net We
     C                     MOVELFNGCTX    #1GCTX           Manifest Unused
     C                     MOVELFNGDTX    #1GDTX           Manifest Unused
     C                     Z-ADDFNRBDT    #1RBDT           Manifest Unused
     C                     Z-ADDFNITNY    #1ITNY           HPB COA Batch N
     C                     Z-ADDFNIWNY    #1IWNY           HPB Meter Total
     C                     Z-ADDFNIXNY    #1IXNY           HPB Meter Net W
     C                     Z-ADDFNIYNY    #1IYNY           HPB Density Ref
     C                     Z-ADDFNK7DT    #1K7DT           Label Date
     C                     Z-ADDFNPFNX    #1PFNX           PT Serial Numbe
     C                     Z-ADDFNRZNB    #1RZNB           Case Sequence N
     C                     MOVELFNPMST    #1PMST           Inventory Updat
     C                     Z-ADDFNC4NB    #1C4NB           Order Number
     C                     Z-ADDFNDPNB    #1DPNB           Order Sequence
     C                     Z-ADDFNUENB    #1UENB           Order Secondary
     C                     Z-ADDFNAATM    #1AATM           Job Time
     C                     MOVELFNAYNA    #1AYNA           User Id
     C                     MOVELFNA0NA    #1A0NA           Job Name
     C                     Z-ADDFNAXDT    #1AXDT           Job Date
     C                     Z-ADDFNLPNZ    #1LPNZ           Manifest Pallet
     C                     Z-ADDFNFOQT    #1FOQT           Case Quantity
     C                     Z-ADDFNR0NB    #1R0NB           Case Weight
     C                     Z-ADDFNELDT    #1ELDT           Production Date
     C                     MOVELFNRZNA    #1RZNA           Manifest Lot ID
     C                     Z-ADDFNIVNY    #1IVNY           HPB Meter Start
     C                     Z-ADDFNIUNY    #1IUNY           HPB Meter Endin
      * Hold current record image for change detection
     C                     MOVEL@1DBRC    #1DBRC
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     MOVEL*BLANK    #CRTSX           WHS Req Meter R
     C                     MOVEL*BLANK    #CJ2NA           USR Item Type D
     C                     Z-ADD*ZERO     #CFVQT           USR Quantity Ac
     C                     Z-ADD*ZERO     #CCDWG           USR Weight Accu
     C                     Z-ADDP1DPNB    #2DPNB           Order Sequence
     C                     Z-ADDP1UENB    #2UENB           Order Secondary
     C                     Z-ADDP1AIC3    #2AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V2AIC3
     C                     MOVEL*BLANK    #CAPTX           Company Name
     C                     MOVEL*BLANK    #CBCNA           Customer Purcha
     C                     Z-ADD*ZERO     #CBKC7           Ship To Custome
      * Clear external version also
     C                     MOVEL*BLANK    VCBKC7
     C                     MOVEL*BLANK    #CBRTX           Ship To Name
     C                     Z-ADD*ZERO     #CI3NY           COA Batch Numbe
     C                     Z-ADDP1C4NB    #2C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V2C4NB
     C                     Z-ADDP1HGCD    #PHGCD           Item Code
      * Clear external version also
     C                     MOVEL*BLANK    VPHGCD
     C                     MOVELP2G7NA    #PG7NA           Order Desc_Line
     C                     MOVELP2AGCD    #PAGCD           U_M_Ordered
     C                     Z-ADD*ZERO     #CCHMT           Chilling Time U
     C                     MOVELP1AJCD    #PAJCD           Warehouse Code
     C                     Z-ADDP2CCQT    #PCCQT           Quantity Schedu
     C                     Z-ADDP2AUWG    #PAUWG           Weight Schedule
      * Check restriction within
     C                     EXSR VACKRL
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert subfile fields into external form
      *================================================================
      * Convert Production Date to display format
      * Convert date
     C           1000000   ADD  #1ELDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1ELDT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#2    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #2AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V2AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #CBKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#CBKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VCBKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VCBKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #PHGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#PHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VPHGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VPHGCD           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0001    ABAIC3           Company Number
      * Establish starting position
     C           KRSSA     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0002           Name
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    WL0002           Name
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Manifest detail    RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           OMAIC3           Company Number
     C                     KFLD           OMC4NB           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Setup key
     C                     Z-ADD#2AIC3    OMAIC3           Company Number
     C                     Z-ADD#2C4NB    OMC4NB           Order Number
     C                     Z-ADD#2DPNB    OMDPNB           Order Sequence
     C                     Z-ADD#2UENB    OMUENB           Order Secondary
      * Establish starting position
     C           KRSSB     CHAIN@BGWKL1              90    *
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELOMAGCD    #PAGCD           U_M_Ordered
     C                     MOVELOMAVST    WUAVST           Catch Weight St
     C                     MOVELOMFZST    P2FZST           Production Date
     C                     Z-ADDOMCCQT    #PCCQT           Quantity Schedu
     C                     Z-ADDOMAUWG    #PAUWG           Weight Schedule
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Pallet Type 2     RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0001           OD Pallet Type
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSC01           Company Number
     C           *LIKE     DEFN WAC4NB    WQSC02           Order Number
     C           *LIKE     DEFN WAHGCD    WQSC03           Item Code
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Order Number
     C                     KFLD           WQSC03           Item Code
      * Setup key
     C                     Z-ADD#2AIC3    WQSC01           Company Number
     C                     Z-ADD#2C4NB    WQSC02           Order Number
     C                     Z-ADD#PHGCD    WQSC03           Item Code
      * Establish starting position
     C           KRSSC     SETLL@BGWKFW                    *
     C           KRSSC     READE@BGWKFW                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAF5SX    YL0001           OD Pallet Type
     C                     GOTO SCEXIT                     *QUIT
     C           KRSSC     READE@BGWKFW                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Next Key           RT - OM Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSD01           Company Number
     C           *LIKE     DEFN WBC4NB    WQSD02           Order Number
     C           *LIKE     DEFN WBDPNB    WQSD03           Order Sequence
     C           *LIKE     DEFN WBUENB    WQSD04           Order Secondary
      * Define keylist
     C           KPSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Order Number
     C                     KFLD           WQSD03           Order Sequence
     C                     KFLD           WQSD04           Order Secondary
     C                     KFLD           WBRZNB           Case Sequence N
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Order Number
     C                     KFLD           WQSD03           Order Sequence
     C                     KFLD           WQSD04           Order Secondary
      * Setup key
     C                     Z-ADD#2AIC3    WQSD01           Company Number
     C                     Z-ADD#2C4NB    WQSD02           Order Number
     C                     Z-ADD#2DPNB    WQSD03           Order Sequence
     C                     Z-ADD#2UENB    WQSD04           Order Secondary
     C                     Z-ADDWURZNB    WBRZNB           Case Sequence N
      * Establish starting position
     C           KPSSD     SETLL@FNCPCT                    *
     C           KRSSD     READE@FNCPCT                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1196' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WURZNB           Case Sequence N
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT                     *QUIT
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2 AND c3 AND c4
      *   |- c1    : PAR.Company Number EQ DB1.Company Number
      *   |- c2    : PAR.Order Number EQ DB1.Order Number
      *   |- c3    : PAR.Order Sequence Number EQ DB1.Order Sequence Numb
      *   |- c4    : PAR.Order Secondary Line Seq EQ DB1.Order Secondary
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #2AIC3    IFEQ WBAIC3                     *IF
     C           #2C4NB    IFEQ WBC4NB                     *IF
     C           #2DPNB    IFEQ WBDPNB                     *IF
     C           #2UENB    IFEQ WBUENB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWBRZNB    WURZNB           Case Sequence N
     C                     ELSE
      * CASE: *OTHERWISE
     C                     GOTO SDEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSD     READE@FNCPCT                  90*
     C                     ENDDO
      * USER: Exit processing
     C                     ADD  1         WURZNB           Case Sequence N
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Prod Temp-HPB     RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDP7RMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSSE     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFJPRTM    YL0002           Product Tempera
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv HPB fields        RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0003    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSF     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0004           Production Ware
     C                     MOVEL*BLANK    WL0005           Warehouse Locat
     C                     MOVEL*BLANK    WL0006           WHS Req Meter R
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADAOCD    WL0004           Production Ware
     C                     MOVELADT0ST    WL0005           Warehouse Locat
     C                     MOVELADRTSX    WL0006           WHS Req Meter R
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Acct Co          RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELYL0004    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSG     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0006           Accounting Comp
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDADBTC3    YL0006           Accounting Comp
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Get Batch Dens,Ld RT - COA Batch Header  * get open batch
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0007           COA Density Loa
     C                     Z-ADD*ZERO     YL0008           COA Density Ref
     C                     Z-ADD*ZERO     YL0009           COA Temperature
      * Declare restrictor key work fields
     C           *LIKE     DEFN CCAIC3    WQSH01           Company Number
     C           *LIKE     DEFN CCI3NY    WQSH02           COA Batch Numbe
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WQSH02           COA Batch Numbe
      * Setup key
     C                     Z-ADDYL0006    WQSH01           Company Number
     C                     Z-ADD#CI3NY    WQSH02           COA Batch Numbe
      * Establish starting position
     C           KRSSH     SETLL@CCCPDJ                    *
     C           KRSSH     READE@CCCPDJ                  90*
      * Data record not found
     C   90                MOVEL'USR3803' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDCCJCNY    YL0007           COA Density Loa
     C                     Z-ADDCCJDNY    YL0008           COA Density Ref
      * RTV Temp Reference    RT - COA Property Define Hdr  * 
     C                     EXSR SIRVGN
     C                     GOTO SHEXIT                     *QUIT
     C           KRSSH     READE@CCCPDJ                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Temp Reference    RT - COA Property Define Hdr  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           CAAIC3           Company Number
     C                     KFLD           CAIDAA           COA Bio-diesel
      * Setup key
     C                     Z-ADDCCAIC3    CAAIC3           Company Number
     C                     MOVELCCIDAA    CAIDAA           COA Bio-diesel
      * Establish starting position
     C           KRSSI     CHAIN@CAREOB              90    *
      * Data record not found
     C   90                MOVEL'USR3799' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDCAJFNY    YL0009           COA Temperature
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Chg for Confirm    RT - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  70       USR Min Weight
     C                     Z-ADD*ZERO     WN0002  70       USR Max Weight
     C                     Z-ADD*ZERO     WN0003 112       Minimum Weight
     C                     Z-ADD*ZERO     WN0004 112       Maximum Weight
     C                     Z-ADD*ZERO     WN0005 112       HPB Meter Net G
     C                     Z-ADD*ZERO     WN0006  80       HPB Meter Net W
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       P6STYN           USR Exit Progra
     C                     MOVEL'N'       P3GSST           USR Over Max
     C                     MOVEL'N'       P3GQST           USR Under Min
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           OMAIC3           Company Number
     C                     KFLD           OMC4NB           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Setup key
     C                     Z-ADD#2AIC3    OMAIC3           Company Number
     C                     Z-ADD#2C4NB    OMC4NB           Order Number
     C                     Z-ADD#2DPNB    OMDPNB           Order Sequence
     C                     Z-ADD#2UENB    OMUENB           Order Secondary
      * Establish starting position
     C           KRSSJ     CHAIN@BGWKL1              90    *
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * RTV Total Confirmed    RT - Manifest Detail  * 
     C                     EXSR SKRVGN
      * Check min/max from the item master
     C                     Z-ADD*ZERO     WN0001           USR Min Weight
     C                     Z-ADD*ZERO     WN0002           USR Max Weight
      * RTV Qty Min/Max        RT - Company/Item  * 
     C                     EXSR SLRVGN
     C           WN0003    MULT P3FYQT    WN0001    H      USR Min Weight
     C           WN0004    MULT P3FYQT    WN0002    H      USR Max Weight
      * Weight entered as shipped is less than Minimum
      * CASE: PAR.USR Case Weight LT PAR.USR Min Weight
     C           P3ZPNB    IFLT WN0001                     *IF
     C                     MOVEL'Y'       P3GQST           USR Under Min
     C                     MOVEL'N'       P6STYN           USR Exit Progra
      * Exit Prog. No  will set the program back to beginning
     C                     END                             *FI
      * Weight entered is greater than the maxiumum
      * CASE: PAR.USR Case Weight GT PAR.USR Max Weight
     C           P3ZPNB    IFGT WN0002                     *IF
     C                     MOVEL'Y'       P3GSST           USR Over Max
     C                     MOVEL'N'       P6STYN           USR Exit Progra
      * Exit prog. no will set program back to beginning
     C                     END                             *FI
      * CASE: PAR.USR Case Quantity GT DB1.Quantity Allocated
     C           P3FYQT    IFGT OMCCQT                     *IF
     C                     MOVEL'O'       WUR0ST           Work Over_Short
     C                     END                             *FI
      * CASE: PAR.USR Case Quantity LT DB1.Quantity Allocated
     C           P3FYQT    IFLT OMCCQT                     *IF
     C                     MOVEL'S'       WUR0ST           Work Over_Short
     C                     END                             *FI
     C                     MOVEL'R'       WUGMST           Detail Line Sta
     C                     MOVELOMGMST    WUGNST           Detail Line Sta
      * FP1110 HPB ONLY 4/14/08 Output net gallons and net weight to Ord
      *   if Warehouse is Req Meter Readings is YES.
      *   Every other warehouse puts out the gross from manifest dtl
      * Rtv HPB fields        RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELOMAJCD    WL0003    P      Warehouse Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    YL0010    P      Production Ware
     C                     MOVELWL0005    YL0011    P      Warehouse Locat
     C                     MOVELWL0006    YL0012    P      WHS Req Meter R
      * CASE: LCL.WHS Req Meter Reading Shp is Yes
     C           YL0012    IFEQ 'Y'                        *IF
      * CHG Confirmed Qty      CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDOMAIC3    WL0007           Company Number
     C                     Z-ADDOMC4NB    WL0008           Order Number
     C                     Z-ADDOMDPNB    WL0009           Order Sequence
     C                     Z-ADDOMUENB    WL0010           Order Secondary
     C                     MOVELWUGMST    WL0011    P      Detail Line Sta
     C                     MOVELWUGNST    WL0012    P      Detail Line Sta
     C                     MOVEL'P'       WL0013    P      Work Confirm St
     C                     MOVELWUR0ST    WL0014    P      Work Over_Short
     C                     Z-ADDWN0005    WL0015           Quantity Shippe
     C                     Z-ADDWN0006    WL0016           Weight Shipped
     C                     Z-ADDOMAODT    WL0017           Scheduled Ship
     C                     Z-ADDOMGNDT    WL0018           Actual Shipped
     C                     MOVELOMZ1ST    WL0019    P      Modified Flag
     C                     MOVELOMZ3ST    WL0020    P      Substituted Fla
     C                     MOVELOMZ4ST    WL0021    P      OD Schedule Ove
     C                     EXSR SMCHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * CHG Confirmed Qty      CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDOMAIC3    WL0007           Company Number
     C                     Z-ADDOMC4NB    WL0008           Order Number
     C                     Z-ADDOMDPNB    WL0009           Order Sequence
     C                     Z-ADDOMUENB    WL0010           Order Secondary
     C                     MOVELWUGMST    WL0011    P      Detail Line Sta
     C                     MOVELWUGNST    WL0012    P      Detail Line Sta
     C                     MOVEL'P'       WL0013    P      Work Confirm St
     C                     MOVELWUR0ST    WL0014    P      Work Over_Short
     C                     Z-ADDP3FYQT    WL0015           Quantity Shippe
     C                     Z-ADDP3ZPNB    WL0016           Weight Shipped
     C                     Z-ADDOMAODT    WL0017           Scheduled Ship
     C                     Z-ADDOMGNDT    WL0018           Actual Shipped
     C                     MOVELOMZ1ST    WL0019    P      Modified Flag
     C                     MOVELOMZ3ST    WL0020    P      Substituted Fla
     C                     MOVELOMZ4ST    WL0021    P      OD Schedule Ove
     C                     EXSR SMCHRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Total Confirmed    RT - Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     P3FYQT           USR Case Quanti
     C                     Z-ADD*ZERO     P3ZPNB           USR Case Weight
     C                     Z-ADD*ZERO     WN0005           HPB Meter Net G
     C                     Z-ADD*ZERO     WN0006           HPB Meter Net W
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSK01           Company Number
     C           *LIKE     DEFN WBC4NB    WQSK02           Order Number
     C           *LIKE     DEFN WBDPNB    WQSK03           Order Sequence
     C           *LIKE     DEFN WBUENB    WQSK04           Order Secondary
      * Define keylist
     C           KPSSK     KLIST
     C                     KFLD           WQSK01           Company Number
     C                     KFLD           WQSK02           Order Number
     C                     KFLD           WQSK03           Order Sequence
     C                     KFLD           WQSK04           Order Secondary
     C                     KFLD           WBRZNB           Case Sequence N
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           Company Number
     C                     KFLD           WQSK02           Order Number
     C                     KFLD           WQSK03           Order Sequence
     C                     KFLD           WQSK04           Order Secondary
      * Setup key
     C                     Z-ADDOMAIC3    WQSK01           Company Number
     C                     Z-ADDOMC4NB    WQSK02           Order Number
     C                     Z-ADDOMDPNB    WQSK03           Order Sequence
     C                     Z-ADDOMUENB    WQSK04           Order Secondary
     C                     Z-ADD*ZERO     WBRZNB           Case Sequence N
      * Establish starting position
     C           KPSSK     SETLL@FNCPCT                    *
     C           KRSSK     READE@FNCPCT                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1196' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WBFOQT    P3FYQT           USR Case Quanti
     C                     ADD  WBR0NB    P3ZPNB           USR Case Weight
      * Only HPB will have these   4/14/08
     C                     ADD  WBN6WG    WN0005           HPB Meter Net G
     C                     ADD  WBIXNY    WN0006           HPB Meter Net W
     C           KRSSK     READE@FNCPCT                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Qty Min/Max        RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADD#2AIC3    BZAIC3           Company Number
     C                     Z-ADD#PHGCD    BZHGCD           Item Code
      * Establish starting position
     C           KRSSL     CHAIN@BZREZG              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBZCZWG    WN0003           Minimum Weight
     C                     Z-ADDBZC0WG    WN0004           Maximum Weight
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCHRC    BEGSR
      *================================================================
      * CHG Confirmed Qty      CH - Order Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0007  70       Item Code
     C                     MOVEL*BLANK    WN0008  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0009  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0010  70       Order Group Cod
     C                     Z-ADD*ZERO     WN0011 112       Billing Detail
     C                     Z-ADD*ZERO     WN0012 112       Billing Detail
     C                     Z-ADD*ZERO     WN0013 112       Billing Detail
     C                     Z-ADD*ZERO     WN0014 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0015  1        Comment Print A
     C                     MOVEL*BLANK    WN0016  1        Comment Print I
     C                     MOVEL*BLANK    WN0017  1        Comment Print P
     C                     MOVEL*BLANK    WN0018  1        Comment Print S
     C                     Z-ADD*ZERO     WN0019 112       Extended Amount
     C                     Z-ADD*ZERO     WN0020  70       Market Pricing
     C                     MOVEL*BLANK    WN0021  3        Commodity Marke
     C                     MOVEL*BLANK    WN0022  3        Date Method Cod
     C                     MOVEL*BLANK    WN0023  3        Price Method Co
     C                     Z-ADD*ZERO     WN0024 114       Price Overage O
     C                     Z-ADD*ZERO     WN0025  70       Contract Number
     C                     MOVEL*BLANK    WN0026  1        Price Status
     C                     Z-ADD*ZERO     WN0027  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0028  2        U_M_Base Price
     C                     MOVEL*BLANK    WN0029  2        U_M_Ordered
     C                     MOVEL*BLANK    WN0030  1        OD Production P
     C                     MOVEL*BLANK    WN0031 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0032 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0033  1        Age Code
     C                     MOVEL*BLANK    WN0034  1        Palletize
     C                     MOVEL*BLANK    WN0035  1        Slip Sheet
     C                     MOVEL*BLANK    WN0036  1        Catch Weight St
     C                     MOVEL*BLANK    WN0037  1        Price Audit
     C                     MOVEL*BLANK    WN0038  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0039  1        Production Date
     C                     Z-ADD*ZERO     WN0040 112       Rated Freight
     C                     Z-ADD*ZERO     WN0041 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0042 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0043 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0044 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0045 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0046 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0047 114       Unit Price
     C                     Z-ADD*ZERO     WN0048 114       Unit Price_Cred
     C                     Z-ADD*ZERO     WN0049 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0050 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0051 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0052  70       Requested Ship
     C                     MOVEL*BLANK    WN0053  1        Affect Inventor
     C                     MOVEL*BLANK    WN0054  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0055  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0056  30       Item Structure
     C                     Z-ADD*ZERO     WN0057  30       Item Structure
     C                     Z-ADD*ZERO     WN0058  30       Item Structure
     C                     MOVEL*BLANK    WN0059  2        Item Level
     C                     MOVEL*BLANK    WN0060  2        Quality Level
     C                     MOVEL*BLANK    WN0061  2        Pricing Product
     C                     MOVEL*BLANK    WN0062  2        Season Product
     C                     Z-ADD*ZERO     WN0063  70       Date of Origina
     C                     MOVEL*BLANK    WN0064 10        User Profile Na
     C                     MOVEL*BLANK    WN0065  6        Country Code
     C                     MOVEL*BLANK    WN0066  2        Event Code
     C                     MOVEL*BLANK    WN0067  3        Reason Code
     C                     MOVEL*BLANK    WN0068  3        Sales Route Cod
     C                     Z-ADD*ZERO     WN0069 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0070 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0071  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0072  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0073  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0074  1        Affect Commissi
     C                     MOVEL*BLANK    WN0075  1        Affect Pricing
     C                     MOVEL*BLANK    WN0076  1        Released by Use
     C                     MOVEL*BLANK    WN0077  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0078  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0079  3        Production Ware
     C                     MOVEL*BLANK    WN0080  3        OD Price Type
     C                     Z-ADD*ZERO     WN0081  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0082  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0083  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0084  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0085  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0086  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0087  60       Price Code
     C                     Z-ADD*ZERO     WN0088  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0089  60       Substitution Li
     C                     Z-ADD*ZERO     WN0090  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0091 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0092 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0093 112       OD Item Target
     C                     Z-ADD*ZERO     WN0094 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0095 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0096 114       Order Gate_Fina
     C                     Z-ADD*ZERO     WN0097 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0098 114       OD Gate_Final P
     C                     Z-ADD*ZERO     WN0099 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0100 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0101 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0102 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0103 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0104  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0105  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0106  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0107 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0108  40       Item Age Days
     C                     Z-ADD*ZERO     WN0109  70       Production Ovr
     C                     Z-ADD*ZERO     WN0110  70       Production Ovr
     C                     MOVEL*BLANK    WN0111  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0112  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0113  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0114  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0115  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0116  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0117  1        EDI Status 1
     C                     MOVEL*BLANK    WN0118  1        EDI Status 2
     C                     MOVEL*BLANK    WN0119  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0120  60       Job Time
     C                     MOVEL*BLANK    WN0121 10        User Id
     C                     MOVEL*BLANK    WN0122 10        Job Name
     C                     Z-ADD*ZERO     WN0123  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWL0007    WCAIC3           Company Number
     C                     Z-ADDWL0008    WCC4NB           Order Number
     C                     Z-ADDWL0009    WCDPNB           Order Sequence
     C                     Z-ADDWL0010    WCUENB           Order Secondary
      *
     C           KLCHSM    KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
     C                     KFLD           WCDPNB           Order Sequence
     C                     KFLD           WCUENB           Order Secondary
     C           KLCHSM    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YARDCS
      * Move non-key fields to @BGWKL0
     C                     MOVELWL0011    WCGMST    P      Detail Line Sta
     C                     MOVELWL0012    WCGNST    P      Detail Line Sta
     C                     MOVELWL0013    WCRZST    P      Work Confirm St
     C                     MOVELWL0014    WCR0ST    P      Work Over_Short
     C                     Z-ADDWL0015    WCCBQT           Quantity Shippe
     C                     Z-ADDWL0016    WCATWG           Weight Shipped
     C                     Z-ADDWL0017    WCAODT           Scheduled Ship
     C                     Z-ADDWL0018    WCGNDT           Actual Shipped
     C                     MOVELWL0019    WCZ1ST    P      Modified Flag
     C                     MOVELWL0020    WCZ3ST    P      Substituted Fla
     C                     MOVELWL0021    WCZ4ST    P      OD Schedule Ove
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Crt/Chg HPB Batch RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           AMAIC3           Company Number
     C                     KFLD           AMC4NB           Order Number
      * Setup key
     C                     Z-ADD#2AIC3    AMAIC3           Company Number
     C                     Z-ADD#2C4NB    AMC4NB           Order Number
      * Establish starting position
     C           KRSSN     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
      * RTV Stop Drop Seq     RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP7RMNB    WL0022           Load ID
     C                     Z-ADD#2C4NB    WL0024           Order Number
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0023    YL0013           Stop_Drop Seque
      * CRT Existing OHE       CR - Order Header Extension  * 
     C                     EXSR SPCRRC
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Load ID is Blank
     C           AMRMNB    IFEQ 0                          *IF
     C                     Z-ADDP7RMNB    YL0038           Load ID
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDAMRMNB    YL0038           Load ID
     C                     END                             *FI
      * CASE: DB1.Stop/Drop Sequence Number is Not Entered
     C           AMRUNB    IFEQ 0                          *IF
      * RTV Stop Drop Seq     RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP7RMNB    WL0022           Load ID
     C                     Z-ADD#2C4NB    WL0024           Order Number
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0023    YL0013           Stop_Drop Seque
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDAMRUNB    YL0013           Stop_Drop Seque
     C                     END                             *FI
      * CHG HPB Batch/Load    CH - Order Header Extension  * 
     C                     EXSR SQCHRC
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Stop Drop Seq     RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0023           Stop_Drop Seque
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQSO02           Load ID
     C           *LIKE     DEFN FLC4NB    WQSO03           Order Number
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO02           Load ID
     C                     KFLD           WQSO03           Order Number
      * Setup key
     C                     Z-ADDWL0022    WQSO02           Load ID
     C                     Z-ADDWL0024    WQSO03           Order Number
      * Establish starting position
     C           KRSSO     SETLL@FLCPKF                    *
     C           KRSSO     READE@FLCPKF                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFLRUNB    WL0023           Stop_Drop Seque
     C           KRSSO     READE@FLCPKF                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPCRRC    BEGSR
      *================================================================
      * CRT Existing OHE       CR - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AMREJE
     C                     Z-ADD#2AIC3    WDAIC3           Company Number
     C                     Z-ADD#2C4NB    WDC4NB           Order Number
     C                     Z-ADDP7RMNB    WDRMNB           Load ID
     C                     Z-ADDYL0013    WDRUNB           Stop_Drop Seque
     C                     MOVEL*BLANK    WDXACD           Shipping Line
     C                     MOVEL*BLANK    WDOANA           Port Delv Termi
     C                     MOVEL*BLANK    WDHBAA           OHE City
     C                     MOVEL*BLANK    WDJ0T1           OHE Vessel_Airl
     C                     MOVEL*BLANK    WDGENY           OHE Voyage_Flig
     C                     MOVEL*BLANK    WDJ1T1           OHE Booking Num
     C                     MOVEL*BLANK    WDHCAA           OHE Discharge P
     C                     Z-ADD*ZERO     WDQWDT           OHE Sail_Flight
     C                     Z-ADD*ZERO     WDQXDT           OHE Port Cut Da
     C                     Z-ADD*ZERO     WDQYDT           OHE Arrival Dat
     C                     MOVEL*BLANK    WDHDAA           OHE Late Delive
     C                     MOVEL'R'       WDCCTX           OHE Ship Status
     C                     MOVEL*BLANK    WDJ2T1           OHE Container N
     C                     MOVEL*BLANK    WDRLNA           OHE Comment 1
     C                     MOVEL*BLANK    WDRMNA           OHE Comment 2
     C                     Z-ADD*ZERO     WDGINY           OHE Unused Numb
     C                     Z-ADD*ZERO     WDGFNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WDGGNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WDGHNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WDHEVL           OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WDHFVL           OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WDHGVL           Transload Termi
     C                     Z-ADD*ZERO     WDQZDT           OHE Est Arrv at
     C                     Z-ADD*ZERO     WDQ0DT           OHE Backhaul ET
     C                     Z-ADD*ZERO     WDQ1DT           OHE Port_Pier P
     C                     Z-ADD*ZERO     WDQ2DT           OHE Actual Ship
     C                     MOVELYL0014    WDC2TX           OHE Carrier SCA
     C                     MOVELYL0015    WDC3TX           OHE Spot Buy
     C                     MOVELYL0016    WDC6TX           OHE PO ACK Flag
     C                     MOVELYL0017    WDCHTX           OHE Override Ty
     C                     MOVELYL0018    WDCITX           OHE Backhaul St
     C                     MOVELYL0019    WDCLTX           OHE Backhaul ET
     C                     MOVELYL0020    WDB4TX           OHE Load Haul T
     C                     MOVELYL0021    WDCUTX           OHE Backhaul Ca
     C                     MOVELYL0022    WDCVTX           OHE Bookings Co
     C                     MOVELYL0023    WDB9TX           OHE EDI Error R
     C                     MOVELYL0024    WDJWSC           OHE EDI Error R
     C                     Z-ADD#CI3NY    WDITNY           HPB COA Batch N
     C                     MOVEL*BLANK    WDLMT1           Delivery P_O  N
     C                     MOVEL*BLANK    WDLWAA           OHE Intended fo
     C                     MOVELYL0025    WDFVST           OHE EDI 943 Act
     C                     MOVELYL0026    WDF0ST           OHE EDI 944 Act
     C                     MOVELYL0027    WDF2ST           OHE EDI 940 Act
     C                     MOVELYL0028    WDF3ST           OHE EDI 945 Act
     C                     MOVELYL0029    WDJUSC           OHE EDI 856 Act
     C                     MOVELYL0030    WDJVSC           OHE EDI 824 Act
     C                     MOVEL*BLANK    WDV3T1           OHE Transload S
     C                     MOVEL*BLANK    WDV4T1           OHE Abs Rate Ov
     C                     MOVEL*BLANK    WDV5T1           OHE Appt Confir
     C                     MOVEL*BLANK    WDV6T1           OHE Backhaul Co
     C                     MOVEL*BLANK    WDV7T1           OHE Backhaul Ch
     C                     MOVEL*BLANK    WDV8T1           OHE Transload C
     C                     MOVEL*BLANK    WDV9T1           OHE Pier Pass I
     C                     MOVEL*BLANK    WDWAT1           OHE Carrier Nm
     C                     MOVEL*BLANK    WDWBT1           OHE Appt Confir
     C                     MOVEL*BLANK    WDWCT1           OHE Backhaul Co
     C                     MOVEL*BLANK    WDWDT1           Letter of Credi
     C                     Z-ADD*ZERO     WDQJNY           OHE Backhaul Re
     C                     Z-ADD*ZERO     WDQKNY           LD Stop_Drop
     C                     Z-ADD*ZERO     WDQLNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WDP8NY           OHE Pier Pass F
     C                     Z-ADD*ZERO     WDP9NY           OHE Port Check
     C                     Z-ADD*ZERO     WDQANY           OHE Port Cut Ti
     C                     Z-ADD*ZERO     WDQCNY           OHE Backhaul Tr
     C                     Z-ADD*ZERO     WDQDNY           OHE Load Sched
     C                     Z-ADD*ZERO     WDQENY           Original Appoin
     C                     Z-ADD*ZERO     WDQFNY           Original Appoin
     C                     Z-ADD*ZERO     WDQGNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WDQHNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WDQINY           OHE Unused Nume
     C                     Z-ADD*ZERO     WDQMNY           OHE Orig ABS Fr
     C                     MOVEL*BLANK    WDMYU1           OHE Genset Numb
     C                     MOVELYL0031    WDJXSC           OHE Email BOL_S
     C                     MOVELYL0032    WDJYSC           OHE EDI Order A
     C                     MOVELYL0033    WDJZSC           OHE EDI 601 Act
     C                     MOVELYL0034    WDJ0SC           OHE Unused Stat
     C                     MOVEL*BLANK    WDMZU1           OHE Unused Text
     C                     MOVEL*BLANK    WDM0U1           OHE Unused Text
     C                     MOVEL*BLANK    WDM1U1           OHE Customer Ve
     C                     MOVEL*BLANK    WDM2U1           OHE EDI 824 AES
     C                     MOVEL*BLANK    WDM3U1           OHE Unused Text
     C                     Z-ADD*ZERO     WDW5DT           OHE Unused Date
     C                     Z-ADD*ZERO     WDW6DT           OHE Unused Date
     C                     MOVELYL0035    WDUVST           EDI Status 1
     C                     MOVELYL0036    WDUWST           EDI Status 2
     C                     MOVELYL0037    WDUXST           EDI Status 3
     C                     MOVEL'A'       WDVSST           Record Status
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     MOVEL*BLANK    WDAYNA           User Id
     C                     MOVEL*BLANK    WDA0NA           Job Name
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      *
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     Z-ADD##JDT     WDAXDT           Job Date
     C                     MOVEL##PGM     WDA0NA           Job Name
     C                     MOVEL##USR     WDAYNA           User Id
     C           KLCRSP    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
      * Check for duplicate primary key
     C           KLCRSP    SETLL@AMREJE                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3698' W0RTN   7
      * Send message 'Order Header Extension EX'
     C                     MOVEL'USR3698' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C                     WRITE@AMREJE                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQCHRC    BEGSR
      *================================================================
      * CHG HPB Batch/Load    CH - Order Header Extension  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0124  3        Shipping Line
     C                     MOVEL*BLANK    WN0125 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0126 25        OHE City
     C                     MOVEL*BLANK    WN0127 30        OHE Vessel_Airl
     C                     MOVEL*BLANK    WN0128 15        OHE Voyage_Flig
     C                     MOVEL*BLANK    WN0129 15        OHE Booking Num
     C                     MOVEL*BLANK    WN0130 20        OHE Discharge P
     C                     Z-ADD*ZERO     WN0131  70       OHE Sail_Flight
     C                     Z-ADD*ZERO     WN0132  70       OHE Port Cut Da
     C                     Z-ADD*ZERO     WN0133  70       OHE Arrival Dat
     C                     MOVEL*BLANK    WN0134  3        OHE Late Delive
     C                     MOVEL*BLANK    WN0135  1        OHE Ship Status
     C                     MOVEL*BLANK    WN0136 12        OHE Container N
     C                     MOVEL*BLANK    WN0137 35        OHE Comment 1
     C                     MOVEL*BLANK    WN0138 75        OHE Comment 2
     C                     Z-ADD*ZERO     WN0139 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0140 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0141 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0142 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0143 112       OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WN0144 112       OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WN0145 112       Transload Termi
     C                     Z-ADD*ZERO     WN0146  70       OHE Est Arrv at
     C                     Z-ADD*ZERO     WN0147  70       OHE Backhaul ET
     C                     Z-ADD*ZERO     WN0148  70       OHE Port_Pier P
     C                     Z-ADD*ZERO     WN0149  70       OHE Actual Ship
     C                     MOVEL*BLANK    WN0150  4        OHE Carrier SCA
     C                     MOVEL*BLANK    WN0151  4        OHE Spot Buy
     C                     MOVEL*BLANK    WN0152  4        OHE PO ACK Flag
     C                     MOVEL*BLANK    WN0153  2        OHE Override Ty
     C                     MOVEL*BLANK    WN0154  2        OHE Backhaul St
     C                     MOVEL*BLANK    WN0155  2        OHE Backhaul ET
     C                     MOVEL*BLANK    WN0156  3        OHE Load Haul T
     C                     MOVEL*BLANK    WN0157  3        OHE Backhaul Ca
     C                     MOVEL*BLANK    WN0158  3        OHE Bookings Co
     C                     MOVEL*BLANK    WN0159  5        OHE EDI Error R
     C                     MOVEL*BLANK    WN0160  5        OHE EDI Error R
     C                     MOVEL*BLANK    WN0161 38        Delivery P_O  N
     C                     MOVEL*BLANK    WN0162  6        OHE Intended fo
     C                     MOVEL*BLANK    WN0163  6        OHE EDI 943 Act
     C                     MOVEL*BLANK    WN0164  6        OHE EDI 944 Act
     C                     MOVEL*BLANK    WN0165  6        OHE EDI 940 Act
     C                     MOVEL*BLANK    WN0166  6        OHE EDI 945 Act
     C                     MOVEL*BLANK    WN0167  1        OHE EDI 856 Act
     C                     MOVEL*BLANK    WN0168  1        OHE EDI 824 Act
     C                     MOVEL*BLANK    WN0169 10        OHE Transload S
     C                     MOVEL*BLANK    WN0170 10        OHE Abs Rate Ov
     C                     MOVEL*BLANK    WN0171 10        OHE Appt Confir
     C                     MOVEL*BLANK    WN0172 15        OHE Backhaul Co
     C                     MOVEL*BLANK    WN0173 15        OHE Backhaul Ch
     C                     MOVEL*BLANK    WN0174 15        OHE Transload C
     C                     MOVEL*BLANK    WN0175 30        OHE Pier Pass I
     C                     MOVEL*BLANK    WN0176 30        OHE Carrier Nm
     C                     MOVEL*BLANK    WN0177 30        OHE Appt Confir
     C                     MOVEL*BLANK    WN0178 50        OHE Backhaul Co
     C                     MOVEL*BLANK    WN0179 50        Letter of Credi
     C                     Z-ADD*ZERO     WN0180  30       OHE Backhaul Re
     C                     Z-ADD*ZERO     WN0181  30       LD Stop_Drop
     C                     Z-ADD*ZERO     WN0182  30       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0183  52       OHE Pier Pass F
     C                     Z-ADD*ZERO     WN0184  52       OHE Port Check
     C                     Z-ADD*ZERO     WN0185  50       OHE Port Cut Ti
     C                     Z-ADD*ZERO     WN0186  60       OHE Backhaul Tr
     C                     Z-ADD*ZERO     WN0187  60       OHE Load Sched
     C                     Z-ADD*ZERO     WN0188  60       Original Appoin
     C                     Z-ADD*ZERO     WN0189  60       Original Appoin
     C                     Z-ADD*ZERO     WN0190  90       OHE PowerPro Lo
     C                     Z-ADD*ZERO     WN0191  90       OHE PowerPro Lo
     C                     Z-ADD*ZERO     WN0192  90       OHE Unused Nume
     C                     Z-ADD*ZERO     WN0193  96       OHE Orig ABS Fr
     C                     MOVEL*BLANK    WN0194 15        OHE Genset Numb
     C                     MOVEL*BLANK    WN0195  1        OHE Email BOL_S
     C                     MOVEL*BLANK    WN0196  1        OHE EDI Order A
     C                     MOVEL*BLANK    WN0197  2        OHE EDI 601 Act
     C                     MOVEL*BLANK    WN0198  2        OHE Unused Stat
     C                     MOVEL*BLANK    WN0199  5        OHE Unused Text
     C                     MOVEL*BLANK    WN0200  5        OHE Unused Text
     C                     MOVEL*BLANK    WN0201 15        OHE Customer Ve
     C                     MOVEL*BLANK    WN0202 15        OHE EDI 824 AES
     C                     MOVEL*BLANK    WN0203 30        OHE Unused Text
     C                     Z-ADD*ZERO     WN0204  70       OHE Unused Date
     C                     Z-ADD*ZERO     WN0205  70       OHE Unused Date
     C                     MOVEL*BLANK    WN0206  1        EDI Status 1
     C                     MOVEL*BLANK    WN0207  1        EDI Status 2
     C                     MOVEL*BLANK    WN0208  1        EDI Status 3
     C                     MOVEL*BLANK    WN0209  1        Record Status
     C                     Z-ADD*ZERO     WN0210  60       Job Time
     C                     MOVEL*BLANK    WN0211 10        User Id
     C                     MOVEL*BLANK    WN0212 10        Job Name
     C                     Z-ADD*ZERO     WN0213  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @AMREJE
     C                     Z-ADD#2AIC3    WDAIC3           Company Number
     C                     Z-ADD#2C4NB    WDC4NB           Order Number
      *
     C           KLCHSQ    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
     C           KLCHSQ    CHAIN@AMREJE              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PMAMREL0'MDACP
     C                     MOVEL'@AMREJE' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SQEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPMAM1    YBRDCS
      * Move non-key fields to @AMREJE
     C                     Z-ADDYL0038    WDRMNB           Load ID
     C                     Z-ADDYL0013    WDRUNB           Stop_Drop Seque
     C                     Z-ADD#CI3NY    WDITNY           HPB COA Batch N
      *
      * Set PGM.*Record Data Changed flag
     C           QPMAM1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     Z-ADD##JDT     WDAXDT           Job Date
     C                     MOVEL##PGM     WDA0NA           Job Name
     C                     MOVEL##USR     WDAYNA           User Id
      * Set PGM.*Record Data Changed flag
     C           QPMAM1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@AMREJE                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPMAMREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV Label Date         RT - IC Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           B1AIC3           Company Number
     C                     KFLD           B1HGCD           Item Code
     C                     KFLD           B1AJCD           Warehouse Code
     C                     KFLD           B1ELDT           Production Date
      * Setup key
     C                     Z-ADD#1AIC3    B1AIC3           Company Number
     C                     Z-ADD#1HGCD    B1HGCD           Item Code
     C                     MOVEL#1AJCD    B1AJCD           Warehouse Code
     C                     Z-ADD#1ELDT    B1ELDT           Production Date
      * Establish starting position
     C           KRSSR     CHAIN@B1REJ0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0330' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDB1K7DT    WUK7DT           Label Date
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv API Vol Cor Fctor RT - RFS API Volume Corr Table  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           GJSSNY           RFS API Gravity
     C                     KFLD           GJSTNY           RFS Loadout Tem
      * Setup key
     C                     Z-ADD30        GJSSNY           RFS API Gravity
     C                     Z-ADDYL0040    GJSTNY           RFS Loadout Tem
      * Establish starting position
     C           KRSSS     CHAIN@GJREHH              90    *
      * Data record not found
     C   90                MOVEL'USR4345' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDGJSUNY    YL0041           RFS API Vol Cor
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Rtv Tare Weight        RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEHGCD           Item Code
      * Setup key
     C                     Z-ADD#1AIC3    WEAIC3           Company Number
     C                     Z-ADD#1HGCD    WEHGCD           Item Code
      * Establish starting position
     C           KRSST     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEAVNA    YL0042           Description Lin
     C                     Z-ADDWEA3WG    YL0043           Misc Tare Weigh
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * RTV Itm BxID & Tares  RT - Item Bill Of Material  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0214  3        Item Type Code
     C                     MOVEL*BLANK    WN0215  1        Package Type Co
     C                     Z-ADD*ZERO     WN0216 112       Unit Weight USR
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     YL0044           Unit Weight
     C                     Z-ADD*ZERO     YL0046           Pallet Tare Wei
     C                     Z-ADD*ZERO     YL0045           Number Cases On
     C                     Z-ADD*ZERO     YL0047           Box iD
      * Declare restrictor key work fields
     C           *LIKE     DEFN IOAIC3    WQSU01           Company Number
     C           *LIKE     DEFN IOHGCD    WQSU02           Item Code
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WQSU01           Company Number
     C                     KFLD           WQSU02           Item Code
      * Setup key
     C                     Z-ADD#1AIC3    WQSU01           Company Number
     C                     Z-ADD#1HGCD    WQSU02           Item Code
      * Establish starting position
     C           KRSSU     SETLL@IORETI                    *
     C           KRSSU     READE@IORETI                  90*
      * Data record not found
     C   90                MOVEL'USR1679' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADD*ZERO     YL0044           Unit Weight
      * RTV Typ/Pk/UntWgt/Plt RT - Company Item  * 
     C                     EXSR SVRVGN
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Item Type Code is Packaging and Supplies
      *   |- c2    : PAR.Package Type Code is Box
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0214    IFEQ 'PS'                       *IF
     C           WN0215    IFEQ 'B'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDIOC9NB    YL0047           Box iD
     C                     GOTO SUEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0044           Unit Weight
     C                     END                             *FI
     C           KRSSU     READE@IORETI                  90*
     C                     ENDDO
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * RTV Typ/Pk/UntWgt/Plt RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEHGCD           Item Code
      * Setup key
     C                     Z-ADDIOAIC3    WEAIC3           Company Number
     C                     Z-ADDIOC9NB    WEHGCD           Item Code
      * Establish starting position
     C           KRSSV     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWEAIWG    YL0044           Unit Weight
     C                     Z-ADDWEURTN    YL0045           Number Cases On
     C                     MOVELWEN0CD    WN0214           Item Type Code
     C                     MOVELWEX4ST    WN0215           Package Type Co
     C                     Z-ADDWESFNB    YL0046           Pallet Tare Wei
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Rtv Pallet Weight     RT - Pallet Master  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           B6LWSC           PM Pallet Type
      * Setup key
     C                     MOVELYL0001    B6LWSC           PM Pallet Type
      * Establish starting position
     C           KRSSW     CHAIN@B6CPH3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR5203' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0046           Misc Tare Weigh
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDB6A3WG    YL0046           Misc Tare Weigh
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * Rtv Live w/Carlisle   RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#1AJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSX     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0051           WHS Live with C
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADRRSX    YL0051           WHS Live with C
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * Rtv Active Status     RT - PFS Interface  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           BUY1NX           PFS Company Num
     C                     KFLD           BUGYAA           PFS Interface C
      * Setup key
     C                     Z-ADD#1AIC3    BUY1NX           PFS Company Num
     C                     MOVEL'SHPTRN'  BUGYAA           PFS Interface C
      * Establish starting position
     C           KRSSY     CHAIN@BUREBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3541' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0052           PFS AccuSort Ac
     C                     MOVEL*BLANK    YL0053           PFS Carlisle Ac
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBUWSSX    YL0052           PFS AccuSort Ac
     C                     MOVELBUWUSX    YL0053           PFS Carlisle Ac
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           JYAIC3           Company Number
      * Setup key
     C                     Z-ADD#1AIC3    JYAIC3           Company Number
      * Establish starting position
     C           KRSSZ     CHAIN@JYRECE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2025' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0055           Company Organiz
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELJYYJSX    YL0055           Company Organiz
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TACRRC    BEGSR
      *================================================================
      * ADD Manifest Detl Rec  CR - Manifest Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0217  60       Job Time
     C                     MOVEL*BLANK    WN0218 10        User Id
     C                     MOVEL*BLANK    WN0219 10        Job Name
     C                     Z-ADD*ZERO     WN0220  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FNCPCS
     C                     Z-ADDP1AIC3    FNAIC3           Company Number
     C                     Z-ADDP1C4NB    FNC4NB           Order Number
     C                     Z-ADD#1DPNB    FNDPNB           Order Sequence
     C                     Z-ADD#1UENB    FNUENB           Order Secondary
     C                     Z-ADD#1RZNB    FNRZNB           Case Sequence N
     C                     Z-ADD#1FOQT    FNFOQT           Case Quantity
     C                     Z-ADD#1R0NB    FNR0NB           Case Weight
     C                     MOVEL#1PMST    FNPMST           Inventory Updat
     C                     Z-ADD#1K7DT    FNK7DT           Label Date
     C                     Z-ADD#1PFNX    FNPFNX           PT Serial Numbe
     C                     Z-ADD#1HGCD    FNHGCD           Item Code
     C                     MOVEL#1AJCD    FNAJCD           Warehouse Code
     C                     Z-ADD#1ELDT    FNELDT           Production Date
     C                     Z-ADD#1N5WG    FNN5WG           Manifest Gross
     C                     MOVEL#1RZNA    FNRZNA           Manifest Lot ID
     C                     Z-ADD#1H5NY    FNH5NY           Manifest Total
     C                     Z-ADD#1H6NY    FNH6NY           Manifest Co_Par
     C                     Z-ADD#1H7NY    FNH7NY           Manifest Pallet
     C                     MOVEL#1GBTX    FNGBTX           Manifest Shift
     C                     Z-ADD#1N6WG    FNN6WG           HPB Meter Net G
     C                     Z-ADD#1N7WG    FNN7WG           Manifest Net We
     C                     MOVEL#1GCTX    FNGCTX           Manifest Unused
     C                     MOVEL#1GDTX    FNGDTX           Manifest Unused
     C                     Z-ADD#1RBDT    FNRBDT           Manifest Unused
     C                     Z-ADD#1ITNY    FNITNY           HPB COA Batch N
     C                     Z-ADD#1IVNY    FNIVNY           HPB Meter Start
     C                     Z-ADD#1IUNY    FNIUNY           HPB Meter Endin
     C                     Z-ADD#1IWNY    FNIWNY           HPB Meter Total
     C                     Z-ADD#1IXNY    FNIXNY           HPB Meter Net W
     C                     Z-ADD#1IYNY    FNIYNY           HPB Density Ref
     C                     MOVEL#1UVST    FNUVST           EDI Status 1
     C                     MOVEL#1UWST    FNUWST           EDI Status 2
     C                     MOVEL#1UXST    FNUXST           EDI Status 3
     C                     MOVEL'A'       FNVSST           Record Status
     C                     Z-ADD#1LPNZ    FNLPNZ           Manifest Pallet
      *
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) FNAATM' defaulted for 'Job Time'.
      * Field '(DB1) FNAYNA' defaulted for 'User Id'.
      * Field '(DB1) FNA0NA' defaulted for 'Job Name'.
      * Field '(DB1) FNAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     FNAATM           Job Time
     C                     MOVEL##USR     FNAYNA           User Id
     C                     MOVEL##JOB     FNA0NA           Job Name
     C                     Z-ADD##JDT     FNAXDT           Job Date
     C           KLCRTA    KLIST
     C                     KFLD           FNAIC3           Company Number
     C                     KFLD           FNC4NB           Order Number
     C                     KFLD           FNDPNB           Order Sequence
     C                     KFLD           FNUENB           Order Secondary
     C                     KFLD           FNRZNB           Case Sequence N
      * Check for duplicate primary key
     C           KLCRTA    SETLL@FNCPCS                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1197' W0RTN   7
      * Send message 'Manifest Detail        EX'
     C                     MOVEL'USR1197' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C                     WRITE@FNCPCS                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
     C                     MOVEL'Y'       P3R4ST           USR Update Flag
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBDLRC    BEGSR
      *================================================================
      * DLT Manifest Detail    DL - Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @FNCPCS
     C                     Z-ADD#1AIC3    FNAIC3           Company Number
     C                     Z-ADD#1C4NB    FNC4NB           Order Number
     C                     Z-ADD#1DPNB    FNDPNB           Order Sequence
     C                     Z-ADD#1UENB    FNUENB           Order Secondary
     C                     Z-ADD#1RZNB    FNRZNB           Case Sequence N
      *
     C           KLDLTB    KLIST
     C                     KFLD           FNAIC3           Company Number
     C                     KFLD           FNC4NB           Order Number
     C                     KFLD           FNDPNB           Order Sequence
     C                     KFLD           FNUENB           Order Secondary
     C                     KFLD           FNRZNB           Case Sequence N
     C           KLDLTB    CHAIN@FNCPCS              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFNCPL0'MDACP
     C                     MOVEL'@FNCPCS' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TBEXIT
     C                     ENDIF
      *
      * Check for changed record
     C           #1DBRC    IFNE @1DBRC                     IF
     C                     MOVEL'Y2U0007' W0RTN   7
      * Send message '*Update not accepted'
     C                     MOVEL'Y2U0007' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
      * Release record lock
     C           KLDLTB    SETLL@FNCPCS              9091  *
     C                     GOTO TBEXIT
     C                     ENDIF                           FI #1DBRC
      *................................................................
     C                     DELET@FNCPCS                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * DBF delete successful
      * USER: Processing after Data update
     C                     MOVEL'Y'       P3R4ST           USR Update Flag
     C                     MOVEL'Y'       P8RINS           COA RIN Modifie
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCCHRC    BEGSR
      *================================================================
      * CHG OM Manifest Detail CH - Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @FNCPCS
     C                     Z-ADD#1AIC3    FNAIC3           Company Number
     C                     Z-ADD#1C4NB    FNC4NB           Order Number
     C                     Z-ADD#1DPNB    FNDPNB           Order Sequence
     C                     Z-ADD#1UENB    FNUENB           Order Secondary
     C                     Z-ADD#1RZNB    FNRZNB           Case Sequence N
      *
     C           KLCHTC    KLIST
     C                     KFLD           FNAIC3           Company Number
     C                     KFLD           FNC4NB           Order Number
     C                     KFLD           FNDPNB           Order Sequence
     C                     KFLD           FNUENB           Order Secondary
     C                     KFLD           FNRZNB           Case Sequence N
     C           KLCHTC    CHAIN@FNCPCS              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFNCPL0'MDACP
     C                     MOVEL'@FNCPCS' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TCEXIT
     C                     ENDIF
      *
      * Check for changed record
     C           #1DBRC    IFNE @1DBRC                     IF
     C                     MOVEL'Y2U0007' W0RTN   7
      * Send message '*Update not accepted'
     C                     MOVEL'Y2U0007' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
      * Release record lock
     C                     UNLCKOMFNCPL0               91  *
     C                     GOTO TCEXIT
     C                     ENDIF                           FI #1DBRC
      * Store record data for null update check
     C                     MOVE @1DBRC    YCRDCS
      * Move non-key fields to @FNCPCS
     C                     Z-ADD#1FOQT    FNFOQT           Case Quantity
     C                     Z-ADD#1R0NB    FNR0NB           Case Weight
     C                     MOVEL#1PMST    FNPMST    P      Inventory Updat
     C                     Z-ADD#1K7DT    FNK7DT           Label Date
     C                     Z-ADD#1PFNX    FNPFNX           PT Serial Numbe
     C                     Z-ADD#1HGCD    FNHGCD           Item Code
     C                     MOVEL#1AJCD    FNAJCD    P      Warehouse Code
     C                     Z-ADD#1ELDT    FNELDT           Production Date
     C                     Z-ADD#1N5WG    FNN5WG           Manifest Gross
     C                     MOVEL#1RZNA    FNRZNA    P      Manifest Lot ID
     C                     Z-ADD#1H5NY    FNH5NY           Manifest Total
     C                     Z-ADD#1H6NY    FNH6NY           Manifest Co_Par
     C                     Z-ADD#1H7NY    FNH7NY           Manifest Pallet
     C                     MOVEL#1GBTX    FNGBTX    P      Manifest Shift
     C                     Z-ADD#1N6WG    FNN6WG           HPB Meter Net G
     C                     Z-ADD#1N7WG    FNN7WG           Manifest Net We
     C                     MOVEL#1GCTX    FNGCTX    P      Manifest Unused
     C                     MOVEL#1GDTX    FNGDTX    P      Manifest Unused
     C                     Z-ADD#1RBDT    FNRBDT           Manifest Unused
     C                     Z-ADD#1ITNY    FNITNY           HPB COA Batch N
     C                     Z-ADD#1IVNY    FNIVNY           HPB Meter Start
     C                     Z-ADD#1IUNY    FNIUNY           HPB Meter Endin
     C                     Z-ADD#1IWNY    FNIWNY           HPB Meter Total
     C                     Z-ADD#1IXNY    FNIXNY           HPB Meter Net W
     C                     Z-ADD#1IYNY    FNIYNY           HPB Density Ref
     C                     MOVEL#1UVST    FNUVST    P      EDI Status 1
     C                     MOVEL#1UWST    FNUWST    P      EDI Status 2
     C                     MOVEL#1UXST    FNUXST    P      EDI Status 3
     C                     MOVEL#1VSST    FNVSST    P      Record Status
     C                     Z-ADD#1AATM    FNAATM           Job Time
     C                     MOVEL#1AYNA    FNAYNA    P      User Id
     C                     MOVEL#1A0NA    FNA0NA    P      Job Name
     C                     Z-ADD#1AXDT    FNAXDT           Job Date
     C                     Z-ADD#1LPNZ    FNLPNZ           Manifest Pallet
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) FNAATM' defaulted for 'Job Time'.
      * Field '(DB1) FNAYNA' defaulted for 'User Id'.
      * Field '(DB1) FNA0NA' defaulted for 'Job Name'.
      * Field '(DB1) FNAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     FNAATM           Job Time
     C                     MOVEL##USR     FNAYNA           User Id
     C                     MOVEL##JOB     FNA0NA           Job Name
     C                     Z-ADD##JDT     FNAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@FNCPCS                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFNCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * Update saved record image
     C                     MOVEL@1DBRC    #1DBRC
      * DBF change successful
      * USER: Processing after Data update
     C                     MOVEL'Y'       P3R4ST           USR Update Flag
     C                     MOVEL'Y'       P8RINS           COA RIN Modifie
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0221    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSTD     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI6ST    P4I6ST           Allow Multi_Com
     C                     MOVELDRMPNA    P4MPNA           Default Printer
     C                     MOVELDRBCCD    P4BCCD           Salesperson Cod
     C                     Z-ADDDRAIC3    YL0060           Company Number
     C                     MOVELDRBUVN    WN0222           User Code Model
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - User Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0025    DTAJVN           User Profile Na
     C                     MOVELWL0026    DTDNCD           Application Cod
      * Establish starting position
     C           KRSTE     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0027           Company Number
     C                     MOVELDTAJCD    WL0028           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQTF01           Application Cod
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           WQTF01           Application Cod
      * Setup key
     C                     MOVELP4DNCD    WQTF01           Application Cod
      * Establish starting position
     C           KRSTF     SETLL@DNRESF                    *
     C           KRSTF     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR TGRVGN
     C                     END                             *FI
     C           KRSTF     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQTG01           Application Cod
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           WQTG01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQTG01           Application Cod
      * Establish starting position
     C           KRSTG     SETLL@DNRESF                    *
     C           KRSTG     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSTG     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C                     MOVELV2AIC3    WK1X01  1
     C                     MOVELV2C4NB    WK1X02  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#2AIC3'
     C           WK1X02    OREQ '?'                        Order Number
     C           YPMTFD    OREQ '#2C4NB'
     C           YPMTFD    OREQ '#2DPNB'
     C           YPMTFD    OREQ '#2UENB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(CTL) #2AIC3' defaulted for 'Company Number'.
      * Field '(CTL) #2C4NB' defaulted for 'Order Number'.
      * Field '(CTL) #2DPNB' defaulted for 'Order Sequence Number'.
      * Field '(CTL) #2UENB' defaulted for 'Order Secondary Line Seq'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(CTL) #PHGCD' defaulted for 'Item Code'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(LCL) YL0058' defaulted for 'Price Overage Override'.
      * Field '(LCL) YL0059' defaulted for 'Record Selected       USR'.
     C                     CALL 'POKJSRR'              90  Sel Item f/Pric
     C                     PARM *BLANK    W0RTN   7
     C           #2AIC3    PARM #2AIC3    WQ0029  30       Company Number
     C           #2C4NB    PARM #2C4NB    WQ0030  70       Order Number
     C           #2DPNB    PARM *ZERO     WQ0031  30       Order Sequence
     C           #2UENB    PARM *ZERO     WQ0032  30       Order Secondary
     C           #PHGCD    PARM #PHGCD    WQ0033  70       Item Code
     C           YL0058    PARM *ZERO     WQ0034 114       Price Overage O
     C           YL0059    PARM YL0059    WQ0035  1        Record Selected
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POKJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #2AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #2C4NB    IFNE *ZERO                      Order Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #2DPNB    IFNE *ZERO                      Order Sequence
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #2UENB    IFNE *ZERO                      Order Secondary
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VA999
     C                     END
     C                     END
      *................................................................
      *
     C           KLVAOM    KLIST
     C                     KFLD           OMAIC3           Company Number
     C                     KFLD           OMC4NB           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Setup key
     C                     Z-ADD#2AIC3    OMAIC3
     C                     Z-ADD#2C4NB    OMC4NB
     C                     Z-ADD#2DPNB    OMDPNB
     C                     Z-ADD#2UENB    OMUENB
     C           KLVAOM    CHAIN@BGWKL1              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VAEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VAEXIT
     C                     END
     C           VA999     TAG
      * Restrictor relation not satisfied
      * Send message 'Order Detail           NF'
     C                     MOVEL'USR1309' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'USR1309' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C           ZINPOS    IFGE 03840
     C           ZINPOS    ANDLE05632
      * Cursor in the subfile record area
      * Reset cursor position to the basic (first) record for lookup
     C           W0CRW     SUB  15        W0CSRR  50
     C           03840     ADD  W0CCL     ZINPOS
      * Calculate rrn of the cursor position
     C                     ADD  ##SFRC    W0CSRR
     C                     ENDIF
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
     C           W0CFL     IFEQ *BLANK
     C                     Z-ADD0         W0CSRR
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD15        ZHSTRW  40
     C                     Z-ADD21        ZHNDRW  40
     C                     Z-ADD1         ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
      *
     C           YPMRRN    IFGT *ZERO
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
     C                     END
     C                     END
      *
     C           ZHF4RW    IFEQ 015
     C           ZHCSCL    ANDEQ039
     C           *IN74     ANDEQ'0'
     C                     MOVEL'#RUEST'  YPMTFD           USR Zero Value
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1RZNB           Case Sequence N
      * Clear all neither parameters
     C                     MOVEL*BLANK    P2AGCD           U_M_Ordered
     C                     MOVEL*BLANK    P2AVST           Catch Weight St
     C                     MOVEL*BLANK    P2FZST           Production Date
     C                     Z-ADD*ZERO     P2AVWG           Unit Weight Ord
      * Clear all neither parameters
     C                     MOVEL*BLANK    P3R4ST           USR Update Flag
     C                     MOVEL*BLANK    P3GGST           USR Display fie
     C                     MOVEL*BLANK    P3TIST           USR Display 1
     C                     Z-ADD*ZERO     P3MNWT           USR Min Weight
     C                     Z-ADD*ZERO     P3MXWT           USR Max Weight
     C                     MOVEL*BLANK    P3GQST           USR Under Min
     C                     MOVEL*BLANK    P3GSST           USR Over Max
     C                     MOVEL*BLANK    P3TJST           USR Display 2
      * Clear all neither parameters
     C                     MOVEL*BLANK    P4DNCD           Application Cod
     C                     MOVEL*BLANK    P4BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P4B8NA           System Date For
     C                     MOVEL*BLANK    P4I6ST           Allow Multi_Com
     C                     MOVEL*BLANK    P4MPNA           Default Printer
     C                     MOVEL*BLANK    P4YJSX           Company Organiz
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P5AIWG           Unit Weight
     C                     Z-ADD*ZERO     P5CZWG           Minimum Weight
     C                     Z-ADD*ZERO     P5C0WG           Maximum Weight
      * Clear all neither parameters
     C                     MOVEL*BLANK    P6STYN           USR Exit Progra
      * Clear all neither parameters
     C                     MOVEL*BLANK    P8RINS           COA RIN Modifie
      * Clear all neither parameters
     C                     MOVEL*BLANK    P9Q1ST           Status Flag 1
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Catch Weight Status
     C                     MOVEL*BLANK    WUAVST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WACFC7           Order Group Cod
     C                     Z-ADD*ZERO     WAMAVA           Billing Detail
     C                     Z-ADD*ZERO     WAKDVA           Billing Detail
     C                     Z-ADD*ZERO     WAL8VA           Billing Detail
     C                     Z-ADD*ZERO     WAL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WAAYVA           Extended Amount
     C                     Z-ADD*ZERO     WAEXDT           Market Pricing
     C                     Z-ADD*ZERO     WABZPR           Price Overage O
     C                     Z-ADD*ZERO     WAL6NB           Contract Number
     C                     Z-ADD*ZERO     WAGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WAAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WAD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WACCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WAAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WACBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WAATWG           Weight Shipped
     C                     Z-ADD*ZERO     WAAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WAAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WAAKPR           Unit Price
     C                     Z-ADD*ZERO     WAALPR           Unit Price_Cred
     C                     Z-ADD*ZERO     WAAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WAAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WAA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WADUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WAB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WAA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WANTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WANUDT           Consumed Item C
     C                     Z-ADD*ZERO     WANVDT           Deadline Depart
     C                     Z-ADD*ZERO     WANWDT           OD Price Type R
     C                     Z-ADD*ZERO     WANXDT           OD Firm Date
     C                     Z-ADD*ZERO     WABUTM           Deadline Depart
     C                     Z-ADD*ZERO     WABVTM           Price Code
     C                     Z-ADD*ZERO     WABWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WABXTM           Substitution Li
     C                     Z-ADD*ZERO     WABYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WAH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WAH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WAH7NX           OD Item Target
     C                     Z-ADD*ZERO     WAH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WAH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WADVPR           Order Gate_Fina
     C                     Z-ADD*ZERO     WADWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WADXPR           OD Gate_Final P
     C                     Z-ADD*ZERO     WADYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WADZPR           OD Original Ord
     C                     Z-ADD*ZERO     WAGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WAGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WAGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WAPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WARINY           Item Age Days
     C                     Z-ADD*ZERO     WATIDT           Production Ovr
     C                     Z-ADD*ZERO     WATJDT           Production Ovr
     C                     Z-ADD*ZERO     WATKDT           OD Market Begin
     C                     Z-ADD*ZERO     WATLDT           OD Market Endin
     C                     Z-ADD*ZERO     WATMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Description Line Two
     C                     MOVEL*BLANK    WUAWNA 30
      * Define work field UOM Primary
     C                     MOVEL*BLANK    WUADCD  2
      * Define work field UOM Pricing
     C                     MOVEL*BLANK    WUAICD  2
      * Define work field Item Level
     C                     MOVEL*BLANK    WURBCD  2
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Define work field Item Structure Class Code
     C                     Z-ADD*ZERO     WURINB  30
      * Define work field Item Structure Group Code
     C                     Z-ADD*ZERO     WURHNB  30
      * Define work field Item Structure Type Code
     C                     Z-ADD*ZERO     WURGNB  30
      * Define work field Default Commod Mark basis
     C                     MOVEL*BLANK    WULNCD  3
      * Define work field Transportation Temp
     C                     Z-ADD*ZERO     WUTFNB  30
      * Define work field Item Type Code
     C                     MOVEL*BLANK    WUN0CD  3
      * Define work field Commodity Price Group
     C                     MOVEL*BLANK    WULRCD  7
      * Define work field Default Warehouse
     C                     MOVEL*BLANK    WUQ1CD  3
      * Define work field Price Method Default
     C                     MOVEL*BLANK    WUQ8CD  3
      * Define work field Variety_Rendered_Cut
     C                     MOVEL*BLANK    WUXWST  1
      * Define work field Item Target Price
     C                     Z-ADD*ZERO     WUF5WG 112
      * Define work field Error Status
     C                     MOVEL*BLANK    WUECST  1
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Define work field Case Sequence Number
     C                     Z-ADD*ZERO     WURZNB  50
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBDPNB           Order Sequence
     C                     Z-ADD*ZERO     WBUENB           Order Secondary
     C                     Z-ADD*ZERO     WBRZNB           Case Sequence N
     C                     Z-ADD*ZERO     WBFOQT           Case Quantity
     C                     Z-ADD*ZERO     WBR0NB           Case Weight
     C                     Z-ADD*ZERO     WBK7DT           Label Date
     C                     Z-ADD*ZERO     WBPFNX           PT Serial Numbe
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBELDT           Production Date
     C                     Z-ADD*ZERO     WBN5WG           Manifest Gross
     C                     Z-ADD*ZERO     WBH5NY           Manifest Total
     C                     Z-ADD*ZERO     WBH6NY           Manifest Co_Par
     C                     Z-ADD*ZERO     WBH7NY           Manifest Pallet
     C                     Z-ADD*ZERO     WBN6WG           HPB Meter Net G
     C                     Z-ADD*ZERO     WBN7WG           Manifest Net We
     C                     Z-ADD*ZERO     WBRBDT           Manifest Unused
     C                     Z-ADD*ZERO     WBITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WBIVNY           HPB Meter Start
     C                     Z-ADD*ZERO     WBIUNY           HPB Meter Endin
     C                     Z-ADD*ZERO     WBIWNY           HPB Meter Total
     C                     Z-ADD*ZERO     WBIXNY           HPB Meter Net W
     C                     Z-ADD*ZERO     WBIYNY           HPB Density Ref
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
     C                     Z-ADD*ZERO     WBLPNZ           Manifest Pallet
      * Define work field Work Over_Short Status
     C                     MOVEL*BLANK    WUR0ST  1
      * Define work field Detail Line Status
     C                     MOVEL*BLANK    WUGMST  1
      * Define work field Detail Line Status Last
     C                     MOVEL*BLANK    WUGNST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDRUNB           Stop_Drop Seque
     C                     Z-ADD*ZERO     WDQWDT           OHE Sail_Flight
     C                     Z-ADD*ZERO     WDQXDT           OHE Port Cut Da
     C                     Z-ADD*ZERO     WDQYDT           OHE Arrival Dat
     C                     Z-ADD*ZERO     WDGINY           OHE Unused Numb
     C                     Z-ADD*ZERO     WDGFNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WDGGNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WDGHNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WDHEVL           OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WDHFVL           OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WDHGVL           Transload Termi
     C                     Z-ADD*ZERO     WDQZDT           OHE Est Arrv at
     C                     Z-ADD*ZERO     WDQ0DT           OHE Backhaul ET
     C                     Z-ADD*ZERO     WDQ1DT           OHE Port_Pier P
     C                     Z-ADD*ZERO     WDQ2DT           OHE Actual Ship
     C                     Z-ADD*ZERO     WDITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WDQJNY           OHE Backhaul Re
     C                     Z-ADD*ZERO     WDQKNY           LD Stop_Drop
     C                     Z-ADD*ZERO     WDQLNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WDP8NY           OHE Pier Pass F
     C                     Z-ADD*ZERO     WDP9NY           OHE Port Check
     C                     Z-ADD*ZERO     WDQANY           OHE Port Cut Ti
     C                     Z-ADD*ZERO     WDQCNY           OHE Backhaul Tr
     C                     Z-ADD*ZERO     WDQDNY           OHE Load Sched
     C                     Z-ADD*ZERO     WDQENY           Original Appoin
     C                     Z-ADD*ZERO     WDQFNY           Original Appoin
     C                     Z-ADD*ZERO     WDQGNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WDQHNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WDQINY           OHE Unused Nume
     C                     Z-ADD*ZERO     WDQMNY           OHE Orig ABS Fr
     C                     Z-ADD*ZERO     WDW5DT           OHE Unused Date
     C                     Z-ADD*ZERO     WDW6DT           OHE Unused Date
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Case Weight
     C                     Z-ADD*ZERO     WUR0NB 112
      * Define work field Label Date
     C                     Z-ADD*ZERO     WUK7DT  70
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field COA Temp Conv Factor 1
     C                     Z-ADD*ZERO     WUJQNY 118
      * Define work field COA Temp Conv Factor 2
     C                     Z-ADD*ZERO     WUJRNY 118
      * Define work field Quantity 7.0 USR
     C                     Z-ADD*ZERO     WUTQTC  70
      * Define work field COA Density Ref Adj 4 dec
     C                     Z-ADD*ZERO     WULRNY  64
      * Define work field HPB Temperature Adjustmnt
     C                     Z-ADD*ZERO     WUJSNY  96
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEHGCD           Item Code
     C                     Z-ADD*ZERO     WEAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WEAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WEAIWG           Unit Weight
     C                     Z-ADD*ZERO     WECZWG           Minimum Weight
     C                     Z-ADD*ZERO     WEC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WEURTN           Number Cases On
     C                     Z-ADD*ZERO     WEAJC8           Vendor Item Def
     C                     Z-ADD*ZERO     WERINB           Item Structure
     C                     Z-ADD*ZERO     WERHNB           Item Structure
     C                     Z-ADD*ZERO     WERGNB           Item Structure
     C                     Z-ADD*ZERO     WETFNB           Transportation
     C                     Z-ADD*ZERO     WETMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WETNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WEBLPR           Market Overage
     C                     Z-ADD*ZERO     WEBMPR           Standard Overag
     C                     Z-ADD*ZERO     WECMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WECHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WESWGH           Std Weight_Head
     C                     Z-ADD*ZERO     WEPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WEICN1           Item Category N
     C                     Z-ADD*ZERO     WEICN2           Item Category N
     C                     Z-ADD*ZERO     WEV2NB           Item Category N
     C                     Z-ADD*ZERO     WEITCN           Item Category N
     C                     Z-ADD*ZERO     WEITC5           Item Category N
     C                     Z-ADD*ZERO     WEICN6           Item Category N
     C                     Z-ADD*ZERO     WEICN7           Item Category N
     C                     Z-ADD*ZERO     WEICN8           Item Category N
     C                     Z-ADD*ZERO     WEICN9           Item Category N
     C                     Z-ADD*ZERO     WEICN0           Item Category N
     C                     Z-ADD*ZERO     WESFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WEA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WESJNB           Production Lead
     C                     Z-ADD*ZERO     WESKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WESLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WESMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WECFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WECGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WEILNB           Packages per ca
     C                     Z-ADD*ZERO     WECHNB           Use_Freeze_Sell
     C                     Z-ADD*ZERO     WECINB           PM Batch Size
     C                     Z-ADD*ZERO     WECJNB           Package Level s
     C                     Z-ADD*ZERO     WECMNB           Partial Item Co
     C                     Z-ADD*ZERO     WECNNB           WIP Item Code
     C                     Z-ADD*ZERO     WECRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WECSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WECVNB           FP Std Green We
     C                     Z-ADD*ZERO     WECWNB           PM Std LBS Man
     C                     Z-ADD*ZERO     WECXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WECZNB           PM Formula LBS
     C                     Z-ADD*ZERO     WEC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WEB4NB           PM Raw Material
     C                     Z-ADD*ZERO     WEB5NB           PM Line Number
     C                     Z-ADD*ZERO     WEBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WEBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WEF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WEF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WEF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WEBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WEBNNB           Production Qty
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Clear all neither parameters
      * ADD Manifest Detl Rec  CR - Manifest Detail  * 
     C                     Z-ADD*ZERO     FNAATM           Job Time
     C                     Z-ADD*ZERO     FNAXDT           Job Date
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Define work field Company Number
     C                     Z-ADD*ZERO     WUAIC3  30
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0WE02 179       *Synon (17,9) w
     C                     Z-ADD*ZEROS    W0WE01 179       *Synon (17,9) w
     C                     Z-ADD*ZEROS    W0WJ00 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WE00 179       *Synon (17,9) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL@CN,1     @CN,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SARVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     MOVEL*BLANK    WL0002 30
      * Define local variables for subroutine SFRVGN.
     C                     MOVEL*BLANK    WL0003  3
     C                     MOVEL*BLANK    WL0004  3
     C                     MOVEL*BLANK    WL0005  1
     C                     MOVEL*BLANK    WL0006  1
      * Define local variables for subroutine SMCHRC.
     C                     Z-ADD*ZERO     WL0007  30
     C                     Z-ADD*ZERO     WL0008  70
     C                     Z-ADD*ZERO     WL0009  30
     C                     Z-ADD*ZERO     WL0010  30
     C                     MOVEL*BLANK    WL0011  1
     C                     MOVEL*BLANK    WL0012  1
     C                     MOVEL*BLANK    WL0013  1
     C                     MOVEL*BLANK    WL0014  1
     C                     Z-ADD*ZERO     WL0015 112
     C                     Z-ADD*ZERO     WL0016 112
     C                     Z-ADD*ZERO     WL0017  70
     C                     Z-ADD*ZERO     WL0018  70
     C                     MOVEL*BLANK    WL0019  1
     C                     MOVEL*BLANK    WL0020  1
     C                     MOVEL*BLANK    WL0021  1
      * Define local variables for subroutine SORVGN.
     C                     Z-ADD*ZERO     WL0022  70
     C                     Z-ADD*ZERO     WL0023  50
     C                     Z-ADD*ZERO     WL0024  70
      * Define local variables for subroutine TERVGN.
     C                     MOVEL*BLANK    WL0025 10
     C                     MOVEL*BLANK    WL0026  6
     C                     Z-ADD*ZERO     WL0027  30
     C                     MOVEL*BLANK    WL0028  3
      * Define local work field OD Pallet Type
     C                     MOVEL*BLANK    YL0001  2
      * Define local work field Product Temperature
     C                     Z-ADD*ZERO     YL0002  52
      * Define local work field COA Temperature Loadout
     C                     Z-ADD*ZERO     YL0003  30
      * Define local work field Production Warehouse Code
     C                     MOVEL*BLANK    YL0004  3
      * Define local work field Warehouse Location
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0006  30
      * Define local work field COA Density Loadout
     C                     Z-ADD*ZERO     YL0007  75
      * Define local work field COA Density Reference
     C                     Z-ADD*ZERO     YL0008  75
      * Define local work field COA Temperature Ref
     C                     Z-ADD*ZERO     YL0009  30
      * Define local work field Production Warehouse Code
     C                     MOVEL*BLANK    YL0010  3
      * Define local work field Warehouse Location
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field WHS Req Meter Reading Shp
     C                     MOVEL*BLANK    YL0012  1
      * Define local work field Stop_Drop Sequence Number
     C                     Z-ADD*ZERO     YL0013  50
      * Define local work field OHE Carrier SCAC Code
     C                     MOVEL*BLANK    YL0014  4
      * Define local work field OHE Spot Buy
     C                     MOVEL*BLANK    YL0015  4
      * Define local work field OHE PO ACK Flag
     C                     MOVEL*BLANK    YL0016  4
      * Define local work field OHE Override Type Code
     C                     MOVEL*BLANK    YL0017  2
      * Define local work field OHE Backhaul Status
     C                     MOVEL*BLANK    YL0018  2
      * Define local work field OHE Backhaul ETA AM_PM
     C                     MOVEL*BLANK    YL0019  2
      * Define local work field OHE Load Haul Type
     C                     MOVEL*BLANK    YL0020  3
      * Define local work field OHE Backhaul Carrier Code
     C                     MOVEL*BLANK    YL0021  3
      * Define local work field OHE Bookings Confirmed
     C                     MOVEL*BLANK    YL0022  3
      * Define local work field OHE EDI Error Reasons
     C                     MOVEL*BLANK    YL0023  5
      * Define local work field OHE EDI Error Reasons 2
     C                     MOVEL*BLANK    YL0024  5
      * Define local work field OHE EDI 943 Action
     C                     MOVEL*BLANK    YL0025  6
      * Define local work field OHE EDI 944 Action
     C                     MOVEL*BLANK    YL0026  6
      * Define local work field OHE EDI 940 Action
     C                     MOVEL*BLANK    YL0027  6
      * Define local work field OHE EDI 945 Action
     C                     MOVEL*BLANK    YL0028  6
      * Define local work field OHE EDI 856 Action
     C                     MOVEL*BLANK    YL0029  1
      * Define local work field OHE EDI 824 Action
     C                     MOVEL*BLANK    YL0030  1
      * Define local work field OHE Email BOL_Sent
     C                     MOVEL*BLANK    YL0031  1
      * Define local work field OHE EDI Order Automated
     C                     MOVEL*BLANK    YL0032  1
      * Define local work field OHE EDI 601 Action
     C                     MOVEL*BLANK    YL0033  2
      * Define local work field OHE Unused Status 4
     C                     MOVEL*BLANK    YL0034  2
      * Define local work field EDI Status 1
     C                     MOVEL*BLANK    YL0035  1
      * Define local work field EDI Status 2
     C                     MOVEL*BLANK    YL0036  1
      * Define local work field EDI Status 3
     C                     MOVEL*BLANK    YL0037  1
      * Define local work field Load ID
     C                     Z-ADD*ZERO     YL0038  70
      * Define local work field RFS Volume Corr Mthd  USR
     C                     MOVEL*BLANK    YL0039  1
      * Define local work field RFS Loadout Temperature
     C                     Z-ADD*ZERO     YL0040  41
      * Define local work field RFS API Vol Corr Factor
     C                     Z-ADD*ZERO     YL0041  54
      * Define local work field Description Line One
     C                     MOVEL*BLANK    YL0042 30
      * Define local work field Misc Tare Weight
     C                     Z-ADD*ZERO     YL0043  52
      * Define local work field Box Weight
     C                     Z-ADD*ZERO     YL0044  52
      * Define local work field Number Cases On A Pallet
     C                     Z-ADD*ZERO     YL0045  50
      * Define local work field Pallet Tare Weight
     C                     Z-ADD*ZERO     YL0046  52
      * Define local work field Box iD
     C                     Z-ADD*ZERO     YL0047  70
      * Define local work field Total Tare USR
     C                     Z-ADD*ZERO     YL0048  52
      * Define local work field Palletize
     C                     MOVEL*BLANK    YL0049  1
      * Define local work field Weight 1.2             .U
     C                     Z-ADD*ZERO     YL0050  92
      * Define local work field WHS Live with Carlisle
     C                     MOVEL*BLANK    YL0051  1
      * Define local work field PFS AccuSort Active
     C                     MOVEL*BLANK    YL0052  1
      * Define local work field PFS Carlisle Active
     C                     MOVEL*BLANK    YL0053  1
      * Define local work field Weight 2.1             .U
     C                     Z-ADD*ZERO     YL0054  92
      * Define null work field Plant Company Sts
     C                     MOVEL*BLANK    YN0001  1
      * Define local work field Company Organization
     C                     MOVEL*BLANK    YL0055  1
      * Define local work field Net Weight Kg USR 11.4
     C                     Z-ADD*ZERO     YL0056 114
      * Define local work field Net Weight Kilograms
     C                     Z-ADD*ZERO     YL0057  71
      * Define local work field Price Overage Override
     C                     Z-ADD*ZERO     YL0058 114
      * Define local work field Record Selected       USR
     C                     MOVEL*BLANK    YL0059  1
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0060  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0061  3
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
      *
     C                     Z-ADD07        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
      * Set to *CHANGE mode
     C                     MOVEL'CHG'     W0PMD   3
     C                     MOVEL'Y'       W0APM   1
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
     C                     MOVEL*BLANK    P4DNCD           Application Cod
     C                     MOVEL'OMS'     P4DNCD           Application Cod
      *
     C                     MOVEL*BLANK    WN0221 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0221           User Profile Na
      *
     C                     MOVEL*BLANK    WN0222 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR TDRVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0221    ZA0014           User Profile Na
     C                     MOVELP4DNCD    ZA0015           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0222    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0221    WL0025    P      User Profile Na
     C                     MOVELP4DNCD    WL0026    P      Application Cod
     C                     EXSR TERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0027    WUAIC3           Company Number
     C                     MOVELWL0028    YL0061    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0222    WL0025    P      User Profile Na
     C                     MOVELP4DNCD    WL0026    P      Application Cod
     C                     EXSR TERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0027    WUAIC3           Company Number
     C                     MOVELWL0028    YL0061    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0061    #PAJCD           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0221    ZA0016           User Profile Na
     C                     MOVELP4DNCD    ZA0017           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0060    IFNE 0                          *IF
     C                     Z-ADDYL0060    WUAIC3           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0061    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           #PAJCD    PARM *BLANK    WQ0036  3        Warehouse Code
     C                     PARM YL0060    WQ0037  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR TFRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
     C                     Z-ADD*ZERO     P3FYQT           USR Case Quanti
     C                     Z-ADD*ZERO     P3ZPNB           USR Case Weight
     C                     MOVEL'Y'       P3GGST           USR Display fie
     C                     MOVEL'Y'       P3TIST           USR Display 1
     C                     MOVEL'Y'       P3TJST           USR Display 2
     C                     MOVEL'A'       YL0039           RFS Volume Corr
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** W0BEG
01038010460108801294013020135402306
02314023220234302346023530235702371
02562028180384203845038520386603879
038830389603906
** W0END
01040010750110201300013310135802312
02320023400234402351023550236902383
02639028950384203849038630387303879
038920390303913
** W0NAM
V2AIC3    #CAPTX    #CBCNA    VCBKC7    #CBRTX    #CI3NY    V2C4NB
VPHGCD    #PG7NA    #PAGCD    #CCHMT    #PAJCD    #PCCQT    #PAUWG
**SPT     #2ST1     #1SEL     #1FOQT    #1R0NB    V1ELDT    #RUEST
#1RZNA    #1IVNY    #1IUNY
** @CN
00001 Y2U0005
