     H/TITLE Del Production Sched  XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISPPATE
     H* Date          : 06/11/15  Time  : 17:33:43
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FPDJCCPL1IF  E           K        DISK
      * RTV : PS Prod Schedule          Retrieval index
      *
     FPDLMCPL1IF  E           K        DISK
      * RTV : PS Prod Dept Schedule     Retrieval index
      *
     FPDI8CPL1IF  E           K        DISK
      * RTV : PS Prod Item Schedule     Retrieval index
      *
     FPDKNCPL2IF  E           K        DISK
      * RSQ : Order Detail Schedule     Co/PrdDte/Item/Whs
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FCAAFREL0UF  E           K        DISK
      * UPD : Calendar                  Update index
      *
     FPDJCCPL0UF  E           K        DISK
      * UPD : PS Prod Schedule          Update index
      *
     FPDLMCPL0UF  E           K        DISK
      * UPD : PS Prod Dept Schedule     Update index
      *
     FPDI8CPL0UF  E           K        DISK
      * UPD : PS Prod Item Schedule     Update index
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     E                    #L3         3  1
     E                    #L7         7  1
      * Long constants
     E                    @CN#    1  02  6   @CN    25
     I@AFREBE
      * Calendar                  Retrieval index       NV
      * Renamed input format fields
     I              AFAIC3                          WAAIC3
     I              AFBCDT                          WABCDT
     I              AFCQNB                          WACQNB
     I              AFESNB                          WAESNB
     I              AFETNB                          WAETNB
     I              AFBZNB                          WABZNB
     I              AFA9ST                          WAA9ST
     I              AFEINB                          WAEINB
     I              AFC5ST                          WAC5ST
     I              AFAQNB                          WAAQNB
     I              AFCMST                          WACMST
     I              AFV9ST                          WAV9ST
     I              AFWAST                          WAWAST
     I              AFX2ST                          WAX2ST
     I              AFOJDT                          WAOJDT
     I              AFNQNX                          WANQNX
     I              AFNRNX                          WANRNX
     I              AFI9SX                          WAI9SX
     I              AFJASX                          WAJASX
     I              AFOKDT                          WAOKDT
     I              AFOLDT                          WAOLDT
     I              AFUVST                          WAUVST
     I              AFUWST                          WAUWST
     I              AFUXST                          WAUXST
     I              AFAATM                          WAAATM
     I              AFAYNA                          WAAYNA
     I              AFA0NA                          WAA0NA
     I              AFAXDT                          WAAXDT
      *
     I@AFREBD
      * Calendar                  Update index
      * Renamed input format fields
     I              AFAIC3                          WBAIC3
     I              AFBCDT                          WBBCDT
     I              AFCQNB                          WBCQNB
     I              AFESNB                          WBESNB
     I              AFETNB                          WBETNB
     I              AFBZNB                          WBBZNB
     I              AFA9ST                          WBA9ST
     I              AFEINB                          WBEINB
     I              AFC5ST                          WBC5ST
     I              AFAQNB                          WBAQNB
     I              AFCMST                          WBCMST
     I              AFV9ST                          WBV9ST
     I              AFWAST                          WBWAST
     I              AFX2ST                          WBX2ST
     I              AFOJDT                          WBOJDT
     I              AFNQNX                          WBNQNX
     I              AFNRNX                          WBNRNX
     I              AFI9SX                          WBI9SX
     I              AFJASX                          WBJASX
     I              AFOKDT                          WBOKDT
     I              AFOLDT                          WBOLDT
     I              AFUVST                          WBUVST
     I              AFUWST                          WBUWST
     I              AFUXST                          WBUXST
     I              AFAATM                          WBAATM
     I              AFAYNA                          WBAYNA
     I              AFA0NA                          WBA0NA
     I              AFAXDT                          WBAXDT
      *
     I@JCCPVC
      * PS Prod Schedule          Retrieval index
      * Renamed input format fields
     I              JCAIC3                          WCAIC3
     I              JCV5ST                          WCV5ST
     I              JCELDT                          WCELDT
     I              JCHVHD                          WCHVHD
     I              JCZ6NB                          WCZ6NB
     I              JCZ7NB                          WCZ7NB
     I              JCDGPC                          WCDGPC
     I              JCAVCW                          WCAVCW
     I              JCDIPC                          WCDIPC
     I              JCZ0NB                          WCZ0NB
     I              JCAVLE                          WCAVLE
     I              JCECWG                          WCECWG
     I              JCUVST                          WCUVST
     I              JCUWST                          WCUWST
     I              JCUXST                          WCUXST
     I              JCVSST                          WCVSST
     I              JCAATM                          WCAATM
     I              JCAYNA                          WCAYNA
     I              JCA0NA                          WCA0NA
     I              JCAXDT                          WCAXDT
      *
     I@JCCPVB
      * PS Prod Schedule          Update index
      * Renamed input format fields
     I              JCAIC3                          WDAIC3
     I              JCV5ST                          WDV5ST
     I              JCELDT                          WDELDT
     I              JCHVHD                          WDHVHD
     I              JCZ6NB                          WDZ6NB
     I              JCZ7NB                          WDZ7NB
     I              JCDGPC                          WDDGPC
     I              JCAVCW                          WDAVCW
     I              JCDIPC                          WDDIPC
     I              JCZ0NB                          WDZ0NB
     I              JCAVLE                          WDAVLE
     I              JCECWG                          WDECWG
     I              JCUVST                          WDUVST
     I              JCUWST                          WDUWST
     I              JCUXST                          WDUXST
     I              JCVSST                          WDVSST
     I              JCAATM                          WDAATM
     I              JCAYNA                          WDAYNA
     I              JCA0NA                          WDA0NA
     I              JCAXDT                          WDAXDT
      *
     I@LMCPO1
      * PS Prod Dept Schedule     Retrieval index
      * Renamed input format fields
     I              LMAIC3                          WEAIC3
     I              LMV5ST                          WEV5ST
     I              LMELDT                          WEELDT
     I              LMR3CD                          WER3CD
     I              LMRMPA                          WERMPA
     I              LMGFWG                          WEGFWG
     I              LMGGWG                          WEGGWG
     I              LMCLNB                          WECLNB
     I              LMGHWG                          WEGHWG
     I              LMDVNB                          WEDVNB
     I              LMGNWG                          WEGNWG
     I              LMDZNB                          WEDZNB
     I              LMGOWG                          WEGOWG
     I              LMD0NB                          WED0NB
     I              LMGPWG                          WEGPWG
     I              LMD1NB                          WED1NB
     I              LMGQWG                          WEGQWG
     I              LMD4NB                          WED4NB
     I              LMGRWG                          WEGRWG
     I              LMTKST                          WETKST
     I              LMTLST                          WETLST
     I              LMTNST                          WETNST
     I              LMCD3S                          WECD3S
     I              LMTVST                          WETVST
     I              LMTWST                          WETWST
     I              LMUVST                          WEUVST
     I              LMUWST                          WEUWST
     I              LMUXST                          WEUXST
     I              LMVSST                          WEVSST
     I              LMAATM                          WEAATM
     I              LMAYNA                          WEAYNA
     I              LMA0NA                          WEA0NA
     I              LMAXDT                          WEAXDT
      *
     I@LMCPO0
      * PS Prod Dept Schedule     Update index
      * Renamed input format fields
     I              LMAIC3                          WFAIC3
     I              LMV5ST                          WFV5ST
     I              LMELDT                          WFELDT
     I              LMR3CD                          WFR3CD
     I              LMRMPA                          WFRMPA
     I              LMGFWG                          WFGFWG
     I              LMGGWG                          WFGGWG
     I              LMCLNB                          WFCLNB
     I              LMGHWG                          WFGHWG
     I              LMDVNB                          WFDVNB
     I              LMGNWG                          WFGNWG
     I              LMDZNB                          WFDZNB
     I              LMGOWG                          WFGOWG
     I              LMD0NB                          WFD0NB
     I              LMGPWG                          WFGPWG
     I              LMD1NB                          WFD1NB
     I              LMGQWG                          WFGQWG
     I              LMD4NB                          WFD4NB
     I              LMGRWG                          WFGRWG
     I              LMTKST                          WFTKST
     I              LMTLST                          WFTLST
     I              LMTNST                          WFTNST
     I              LMCD3S                          WFCD3S
     I              LMTVST                          WFTVST
     I              LMTWST                          WFTWST
     I              LMUVST                          WFUVST
     I              LMUWST                          WFUWST
     I              LMUXST                          WFUXST
     I              LMVSST                          WFVSST
     I              LMAATM                          WFAATM
     I              LMAYNA                          WFAYNA
     I              LMA0NA                          WFA0NA
     I              LMAXDT                          WFAXDT
      *
     I@I8CPUS
      * PS Prod Item Schedule     Retrieval index
      * Renamed input format fields
     I              I8AIC3                          WGAIC3
     I              I8V5ST                          WGV5ST
     I              I8ELDT                          WGELDT
     I              I8HGCD                          WGHGCD
     I              I8AJCD                          WGAJCD
     I              I8GPDT                          WGGPDT
     I              I8WTSP                          WGWTSP
     I              I8QTSP                          WGQTSP
     I              I8DJPC                          WGDJPC
     I              I8F8WG                          WGF8WG
     I              I8WTIN                          WGWTIN
     I              I8D5NB                          WGD5NB
     I              I8DXWG                          WGDXWG
     I              I8B2NB                          WGB2NB
     I              I8WTCN                          WGWTCN
     I              I8PSCV                          WGPSCV
     I              I8SAWT                          WGSAWT
     I              I8B9NB                          WGB9NB
     I              I8D1WG                          WGD1WG
     I              I8CBNB                          WGCBNB
     I              I8EZWG                          WGEZWG
     I              I8CCNB                          WGCCNB
     I              I8E0WG                          WGE0WG
     I              I8D6NB                          WGD6NB
     I              I8OAWT                          WGOAWT
     I              I8CDNB                          WGCDNB
     I              I8UNW2                          WGUNW2
     I              I8CENB                          WGCENB
     I              I8F9WG                          WGF9WG
     I              I8BPNB                          WGBPNB
     I              I8GAWG                          WGGAWG
     I              I8BQNB                          WGBQNB
     I              I8GBWG                          WGGBWG
     I              I8BRNB                          WGBRNB
     I              I8GCWG                          WGGCWG
     I              I8BSNB                          WGBSNB
     I              I8GDWG                          WGGDWG
     I              I8BWNB                          WGBWNB
     I              I8GEWG                          WGGEWG
     I              I8PS6U                          WGPS6U
     I              I8WCST                          WGWCST
     I              I8WPST                          WGWPST
     I              I8B5ST                          WGB5ST
     I              I8TFST                          WGTFST
     I              I8TEST                          WGTEST
     I              I8THST                          WGTHST
     I              I8UDST                          WGUDST
     I              I8UFST                          WGUFST
     I              I8UGST                          WGUGST
     I              I8UHST                          WGUHST
     I              I8B6ST                          WGB6ST
     I              I8B7ST                          WGB7ST
     I              I8DVWG                          WGDVWG
     I              I8D7NB                          WGD7NB
     I              I8FCAD                          WGFCAD
     I              I8D9NB                          WGD9NB
     I              I8DWWG                          WGDWWG
     I              I8EANB                          WGEANB
     I              I8SHWT                          WGSHWT
     I              I8EBNB                          WGEBNB
     I              I8AVWT                          WGAVWT
     I              I8ECNB                          WGECNB
     I              I8WTON                          WGWTON
     I              I8EDNB                          WGEDNB
     I              I8FNWT                          WGFNWT
     I              I8EENB                          WGEENB
     I              I8QTAS                          WGQTAS
     I              I8EFNB                          WGEFNB
     I              I8WAIO                          WGWAIO
     I              I8EGNB                          WGEGNB
     I              I8R3CD                          WGR3CD
     I              I8RGNB                          WGRGNB
     I              I8RHNB                          WGRHNB
     I              I8RINB                          WGRINB
     I              I8XRCD                          WGXRCD
     I              I8UVST                          WGUVST
     I              I8UWST                          WGUWST
     I              I8UXST                          WGUXST
     I              I8VSST                          WGVSST
     I              I8AATM                          WGAATM
     I              I8AYNA                          WGAYNA
     I              I8A0NA                          WGA0NA
     I              I8AXDT                          WGAXDT
      *
     I@I8CPUR
      * PS Prod Item Schedule     Update index
      * Renamed input format fields
     I              I8AIC3                          WHAIC3
     I              I8V5ST                          WHV5ST
     I              I8ELDT                          WHELDT
     I              I8HGCD                          WHHGCD
     I              I8AJCD                          WHAJCD
     I              I8GPDT                          WHGPDT
     I              I8WTSP                          WHWTSP
     I              I8QTSP                          WHQTSP
     I              I8DJPC                          WHDJPC
     I              I8F8WG                          WHF8WG
     I              I8WTIN                          WHWTIN
     I              I8D5NB                          WHD5NB
     I              I8DXWG                          WHDXWG
     I              I8B2NB                          WHB2NB
     I              I8WTCN                          WHWTCN
     I              I8PSCV                          WHPSCV
     I              I8SAWT                          WHSAWT
     I              I8B9NB                          WHB9NB
     I              I8D1WG                          WHD1WG
     I              I8CBNB                          WHCBNB
     I              I8EZWG                          WHEZWG
     I              I8CCNB                          WHCCNB
     I              I8E0WG                          WHE0WG
     I              I8D6NB                          WHD6NB
     I              I8OAWT                          WHOAWT
     I              I8CDNB                          WHCDNB
     I              I8UNW2                          WHUNW2
     I              I8CENB                          WHCENB
     I              I8F9WG                          WHF9WG
     I              I8BPNB                          WHBPNB
     I              I8GAWG                          WHGAWG
     I              I8BQNB                          WHBQNB
     I              I8GBWG                          WHGBWG
     I              I8BRNB                          WHBRNB
     I              I8GCWG                          WHGCWG
     I              I8BSNB                          WHBSNB
     I              I8GDWG                          WHGDWG
     I              I8BWNB                          WHBWNB
     I              I8GEWG                          WHGEWG
     I              I8PS6U                          WHPS6U
     I              I8WCST                          WHWCST
     I              I8WPST                          WHWPST
     I              I8B5ST                          WHB5ST
     I              I8TFST                          WHTFST
     I              I8TEST                          WHTEST
     I              I8THST                          WHTHST
     I              I8UDST                          WHUDST
     I              I8UFST                          WHUFST
     I              I8UGST                          WHUGST
     I              I8UHST                          WHUHST
     I              I8B6ST                          WHB6ST
     I              I8B7ST                          WHB7ST
     I              I8DVWG                          WHDVWG
     I              I8D7NB                          WHD7NB
     I              I8FCAD                          WHFCAD
     I              I8D9NB                          WHD9NB
     I              I8DWWG                          WHDWWG
     I              I8EANB                          WHEANB
     I              I8SHWT                          WHSHWT
     I              I8EBNB                          WHEBNB
     I              I8AVWT                          WHAVWT
     I              I8ECNB                          WHECNB
     I              I8WTON                          WHWTON
     I              I8EDNB                          WHEDNB
     I              I8FNWT                          WHFNWT
     I              I8EENB                          WHEENB
     I              I8QTAS                          WHQTAS
     I              I8EFNB                          WHEFNB
     I              I8WAIO                          WHWAIO
     I              I8EGNB                          WHEGNB
     I              I8R3CD                          WHR3CD
     I              I8RGNB                          WHRGNB
     I              I8RHNB                          WHRHNB
     I              I8RINB                          WHRINB
     I              I8XRCD                          WHXRCD
     I              I8UVST                          WHUVST
     I              I8UWST                          WHUWST
     I              I8UXST                          WHUXST
     I              I8VSST                          WHVSST
     I              I8AATM                          WHAATM
     I              I8AYNA                          WHAYNA
     I              I8A0NA                          WHA0NA
     I              I8AXDT                          WHAXDT
      *
     I@KNCPHP
      * Order Detail Schedule     Co/PrdDte/Item/Whs
      * Renamed input format fields
     I              KNAIC3                          WIAIC3
     I              KNC4NB                          WIC4NB
     I              KNDPNB                          WIDPNB
     I              KNUENB                          WIUENB
     I              KNJGDT                          WIJGDT
     I              KNAODT                          WIAODT
     I              KNAJCD                          WIAJCD
     I              KNAYAA                          WIAYAA
     I              KNHGCD                          WIHGCD
     I              KNIGQT                          WIIGQT
     I              KNFLWG                          WIFLWG
     I              KNIUQT                          WIIUQT
     I              KNF3WG                          WIF3WG
     I              KNIVQT                          WIIVQT
     I              KNF4WG                          WIF4WG
     I              KNP7ST                          WIP7ST
     I              KNP8ST                          WIP8ST
     I              KNQAST                          WIQAST
     I              KNUVST                          WIUVST
     I              KNUWST                          WIUWST
     I              KNUXST                          WIUXST
     I              KNVSST                          WIVSST
     I              KNAATM                          WIAATM
     I              KNAYNA                          WIAYNA
     I              KNA0NA                          WIA0NA
     I              KNAXDT                          WIAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WJAIC3
     I              OMC4NB                          WJC4NB
     I              OMDPNB                          WJDPNB
     I              OMUENB                          WJUENB
     I              OMHGCD                          WJHGCD
     I              OMAJCD                          WJAJCD
     I              OMBKC7                          WJBKC7
     I              OMCFC7                          WJCFC7
     I              OMGMST                          WJGMST
     I              OMGNST                          WJGNST
     I              OMMAVA                          WJMAVA
     I              OMKDVA                          WJKDVA
     I              OML8VA                          WJL8VA
     I              OML9VA                          WJL9VA
     I              OMGTST                          WJGTST
     I              OMGVST                          WJGVST
     I              OMGUST                          WJGUST
     I              OMQFST                          WJQFST
     I              OMAYVA                          WJAYVA
     I              OMEXDT                          WJEXDT
     I              OMLQCD                          WJLQCD
     I              OMRDCD                          WJRDCD
     I              OMQ7CD                          WJQ7CD
     I              OMBZPR                          WJBZPR
     I              OML6NB                          WJL6NB
     I              OMU1ST                          WJU1ST
     I              OMGIDT                          WJGIDT
     I              OMCRCD                          WJCRCD
     I              OMAGCD                          WJAGCD
     I              OMRZST                          WJRZST
     I              OMR0ST                          WJR0ST
     I              OMR1ST                          WJR1ST
     I              OMG7NA                          WJG7NA
     I              OMG8NA                          WJG8NA
     I              OMRPCD                          WJRPCD
     I              OMVEST                          WJVEST
     I              OMVGST                          WJVGST
     I              OMAVST                          WJAVST
     I              OMU0ST                          WJU0ST
     I              OMRFCD                          WJRFCD
     I              OMFZST                          WJFZST
     I              OMR1NB                          WJR1NB
     I              OMAVQT                          WJAVQT
     I              OMD0WG                          WJD0WG
     I              OMCCQT                          WJCCQT
     I              OMAUWG                          WJAUWG
     I              OMCBQT                          WJCBQT
     I              OMATWG                          WJATWG
     I              OMAQCS                          WJAQCS
     I              OMAGCS                          WJAGCS
     I              OMAKPR                          WJAKPR
     I              OMALPR                          WJALPR
     I              OMAUPR                          WJAUPR
     I              OMAVWG                          WJAVWG
     I              OMA4WG                          WJA4WG
     I              OMA5DT                          WJA5DT
     I              OMAODT                          WJAODT
     I              OMGNDT                          WJGNDT
     I              OMAMST                          WJAMST
     I              OMANST                          WJANST
     I              OMVAST                          WJVAST
     I              OMRGNB                          WJRGNB
     I              OMRHNB                          WJRHNB
     I              OMRINB                          WJRINB
     I              OMRBCD                          WJRBCD
     I              OMHICD                          WJHICD
     I              OMRNCD                          WJRNCD
     I              OMROCD                          WJROCD
     I              OMCXDT                          WJCXDT
     I              OMAJVN                          WJAJVN
     I              OMKXCD                          WJKXCD
     I              OMJPCD                          WJJPCD
     I              OMCQCD                          WJCQCD
     I              OMR4CD                          WJR4CD
     I              OMZ1ST                          WJZ1ST
     I              OMZ3ST                          WJZ3ST
     I              OMZ4ST                          WJZ4ST
     I              OMDUPR                          WJDUPR
     I              OMB6VL                          WJB6VL
     I              OMA1AA                          WJA1AA
     I              OMFZSX                          WJFZSX
     I              OMF0SX                          WJF0SX
     I              OMF1SX                          WJF1SX
     I              OMF2SX                          WJF2SX
     I              OMF3SX                          WJF3SX
     I              OMF4SX                          WJF4SX
     I              OMF5SX                          WJF5SX
     I              OMF6SX                          WJF6SX
     I              OMF7SX                          WJF7SX
     I              OMNTDT                          WJNTDT
     I              OMNUDT                          WJNUDT
     I              OMNVDT                          WJNVDT
     I              OMNWDT                          WJNWDT
     I              OMNXDT                          WJNXDT
     I              OMBUTM                          WJBUTM
     I              OMBVTM                          WJBVTM
     I              OMBWTM                          WJBWTM
     I              OMBXTM                          WJBXTM
     I              OMBYTM                          WJBYTM
     I              OMH5NX                          WJH5NX
     I              OMH6NX                          WJH6NX
     I              OMH7NX                          WJH7NX
     I              OMH8NX                          WJH8NX
     I              OMH9NX                          WJH9NX
     I              OMDVPR                          WJDVPR
     I              OMDWPR                          WJDWPR
     I              OMDXPR                          WJDXPR
     I              OMDYPR                          WJDYPR
     I              OMDZPR                          WJDZPR
     I              OMGSPR                          WJGSPR
     I              OMGTPR                          WJGTPR
     I              OMGUPR                          WJGUPR
     I              OMHOST                          WJHOST
     I              OMHPST                          WJHPST
     I              OMIOST                          WJIOST
     I              OMPEWG                          WJPEWG
     I              OMRINY                          WJRINY
     I              OMTIDT                          WJTIDT
     I              OMTJDT                          WJTJDT
     I              OMH2ST                          WJH2ST
     I              OMH0ST                          WJH0ST
     I              OMH1ST                          WJH1ST
     I              OMTKDT                          WJTKDT
     I              OMTLDT                          WJTLDT
     I              OMTMDT                          WJTMDT
     I              OMUVST                          WJUVST
     I              OMUWST                          WJUWST
     I              OMUXST                          WJUXST
     I              OMAATM                          WJAATM
     I              OMAYNA                          WJAYNA
     I              OMA0NA                          WJA0NA
     I              OMAXDT                          WJAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WKAIC3
     I              BEC4NB                          WKC4NB
     I              BEJNCD                          WKJNCD
     I              BEANC7                          WKANC7
     I              BEBKC7                          WKBKC7
     I              BEBRTX                          WKBRTX
     I              BEHMNA                          WKHMNA
     I              BEHONA                          WKHONA
     I              BEHPNA                          WKHPNA
     I              BEHNNA                          WKHNNA
     I              BEDBCD                          WKDBCD
     I              BECKTX                          WKCKTX
     I              BEB0C7                          WKB0C7
     I              BEAETX                          WKAETX
     I              BEB1NA                          WKB1NA
     I              BEB3NA                          WKB3NA
     I              BEB4NA                          WKB4NA
     I              BEB2NA                          WKB2NA
     I              BEBHCD                          WKBHCD
     I              BEC8TX                          WKC8TX
     I              BEBCNA                          WKBCNA
     I              BEA0DT                          WKA0DT
     I              BEA5DT                          WKA5DT
     I              BEGNDT                          WKGNDT
     I              BEACDT                          WKACDT
     I              BEAQCD                          WKAQCD
     I              BEB6NA                          WKB6NA
     I              BEBYNA                          WKBYNA
     I              BEBZNA                          WKBZNA
     I              BEGTST                          WKGTST
     I              BEGVST                          WKGVST
     I              BEGUST                          WKGUST
     I              BEQFST                          WKQFST
     I              BECQCD                          WKCQCD
     I              BEGJST                          WKGJST
     I              BEGWST                          WKGWST
     I              BEGXST                          WKGXST
     I              BEGYST                          WKGYST
     I              BEAODT                          WKAODT
     I              BEAIVN                          WKAIVN
     I              BECXDT                          WKCXDT
     I              BEJZVA                          WKJZVA
     I              BEA1WG                          WKA1WG
     I              BEXIST                          WKXIST
     I              BEXJST                          WKXJST
     I              BEXKST                          WKXKST
     I              BEEIDT                          WKEIDT
     I              BEAFTM                          WKAFTM
     I              BEE8CD                          WKE8CD
     I              BEE9CD                          WKE9CD
     I              BERMNB                          WKRMNB
     I              BETBNB                          WKTBNB
     I              BER1NB                          WKR1NB
     I              BEPJST                          WKPJST
     I              BEU0ST                          WKU0ST
     I              BEU1ST                          WKU1ST
     I              BEQ2CD                          WKQ2CD
     I              BEU2ST                          WKU2ST
     I              BEVEST                          WKVEST
     I              BEVFST                          WKVFST
     I              BEVGST                          WKVGST
     I              BERPCD                          WKRPCD
     I              BERNNB                          WKRNNB
     I              BEVDST                          WKVDST
     I              BEATIN                          WKATIN
     I              BEU4ST                          WKU4ST
     I              BEU5ST                          WKU5ST
     I              BERSRN                          WKRSRN
     I              BEMHNA                          WKMHNA
     I              BEMINA                          WKMINA
     I              BEWBST                          WKWBST
     I              BER4CD                          WKR4CD
     I              BEBFCD                          WKBFCD
     I              BEQ4CD                          WKQ4CD
     I              BET3NB                          WKT3NB
     I              BESICD                          WKSICD
     I              BECONB                          WKCONB
     I              BECEST                          WKCEST
     I              BEAWDT                          WKAWDT
     I              BEJPCD                          WKJPCD
     I              BEXUST                          WKXUST
     I              BEZ1ST                          WKZ1ST
     I              BEVRVA                          WKVRVA
     I              BEOBST                          WKOBST
     I              BEBCST                          WKBCST
     I              BEBDST                          WKBDST
     I              BEB7VL                          WKB7VL
     I              BEGASX                          WKGASX
     I              BEGBSX                          WKGBSX
     I              BEGCSX                          WKGCSX
     I              BEGDSX                          WKGDSX
     I              BEFNSX                          WKFNSX
     I              BEFOSX                          WKFOSX
     I              BEFPSX                          WKFPSX
     I              BEFQSX                          WKFQSX
     I              BEFRSX                          WKFRSX
     I              BEFSSX                          WKFSSX
     I              BEFTSX                          WKFTSX
     I              BEFUSX                          WKFUSX
     I              BEFVSX                          WKFVSX
     I              BEFWSX                          WKFWSX
     I              BEFXSX                          WKFXSX
     I              BEFYSX                          WKFYSX
     I              BENODT                          WKNODT
     I              BENPDT                          WKNPDT
     I              BENQDT                          WKNQDT
     I              BENRDT                          WKNRDT
     I              BENSDT                          WKNSDT
     I              BEBPTM                          WKBPTM
     I              BEBQTM                          WKBQTM
     I              BEBRTM                          WKBRTM
     I              BEBSTM                          WKBSTM
     I              BEBTTM                          WKBTTM
     I              BEH0NX                          WKH0NX
     I              BEH1NX                          WKH1NX
     I              BEH2NX                          WKH2NX
     I              BEH3NX                          WKH3NX
     I              BEH4NX                          WKH4NX
     I              BEC0C7                          WKC0C7
     I              BEUVST                          WKUVST
     I              BEUWST                          WKUWST
     I              BEUXST                          WKUXST
     I              BEAATM                          WKAATM
     I              BEAYNA                          WKAYNA
     I              BEA0NA                          WKA0NA
     I              BEAXDT                          WKAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WLAIC3
     I              OMC4NB                          WLC4NB
     I              OMDPNB                          WLDPNB
     I              OMUENB                          WLUENB
     I              OMHGCD                          WLHGCD
     I              OMAJCD                          WLAJCD
     I              OMBKC7                          WLBKC7
     I              OMCFC7                          WLCFC7
     I              OMGMST                          WLGMST
     I              OMGNST                          WLGNST
     I              OMMAVA                          WLMAVA
     I              OMKDVA                          WLKDVA
     I              OML8VA                          WLL8VA
     I              OML9VA                          WLL9VA
     I              OMGTST                          WLGTST
     I              OMGVST                          WLGVST
     I              OMGUST                          WLGUST
     I              OMQFST                          WLQFST
     I              OMAYVA                          WLAYVA
     I              OMEXDT                          WLEXDT
     I              OMLQCD                          WLLQCD
     I              OMRDCD                          WLRDCD
     I              OMQ7CD                          WLQ7CD
     I              OMBZPR                          WLBZPR
     I              OML6NB                          WLL6NB
     I              OMU1ST                          WLU1ST
     I              OMGIDT                          WLGIDT
     I              OMCRCD                          WLCRCD
     I              OMAGCD                          WLAGCD
     I              OMRZST                          WLRZST
     I              OMR0ST                          WLR0ST
     I              OMR1ST                          WLR1ST
     I              OMG7NA                          WLG7NA
     I              OMG8NA                          WLG8NA
     I              OMRPCD                          WLRPCD
     I              OMVEST                          WLVEST
     I              OMVGST                          WLVGST
     I              OMAVST                          WLAVST
     I              OMU0ST                          WLU0ST
     I              OMRFCD                          WLRFCD
     I              OMFZST                          WLFZST
     I              OMR1NB                          WLR1NB
     I              OMAVQT                          WLAVQT
     I              OMD0WG                          WLD0WG
     I              OMCCQT                          WLCCQT
     I              OMAUWG                          WLAUWG
     I              OMCBQT                          WLCBQT
     I              OMATWG                          WLATWG
     I              OMAQCS                          WLAQCS
     I              OMAGCS                          WLAGCS
     I              OMAKPR                          WLAKPR
     I              OMALPR                          WLALPR
     I              OMAUPR                          WLAUPR
     I              OMAVWG                          WLAVWG
     I              OMA4WG                          WLA4WG
     I              OMA5DT                          WLA5DT
     I              OMAODT                          WLAODT
     I              OMGNDT                          WLGNDT
     I              OMAMST                          WLAMST
     I              OMANST                          WLANST
     I              OMVAST                          WLVAST
     I              OMRGNB                          WLRGNB
     I              OMRHNB                          WLRHNB
     I              OMRINB                          WLRINB
     I              OMRBCD                          WLRBCD
     I              OMHICD                          WLHICD
     I              OMRNCD                          WLRNCD
     I              OMROCD                          WLROCD
     I              OMCXDT                          WLCXDT
     I              OMAJVN                          WLAJVN
     I              OMKXCD                          WLKXCD
     I              OMJPCD                          WLJPCD
     I              OMCQCD                          WLCQCD
     I              OMR4CD                          WLR4CD
     I              OMZ1ST                          WLZ1ST
     I              OMZ3ST                          WLZ3ST
     I              OMZ4ST                          WLZ4ST
     I              OMDUPR                          WLDUPR
     I              OMB6VL                          WLB6VL
     I              OMA1AA                          WLA1AA
     I              OMFZSX                          WLFZSX
     I              OMF0SX                          WLF0SX
     I              OMF1SX                          WLF1SX
     I              OMF2SX                          WLF2SX
     I              OMF3SX                          WLF3SX
     I              OMF4SX                          WLF4SX
     I              OMF5SX                          WLF5SX
     I              OMF6SX                          WLF6SX
     I              OMF7SX                          WLF7SX
     I              OMNTDT                          WLNTDT
     I              OMNUDT                          WLNUDT
     I              OMNVDT                          WLNVDT
     I              OMNWDT                          WLNWDT
     I              OMNXDT                          WLNXDT
     I              OMBUTM                          WLBUTM
     I              OMBVTM                          WLBVTM
     I              OMBWTM                          WLBWTM
     I              OMBXTM                          WLBXTM
     I              OMBYTM                          WLBYTM
     I              OMH5NX                          WLH5NX
     I              OMH6NX                          WLH6NX
     I              OMH7NX                          WLH7NX
     I              OMH8NX                          WLH8NX
     I              OMH9NX                          WLH9NX
     I              OMDVPR                          WLDVPR
     I              OMDWPR                          WLDWPR
     I              OMDXPR                          WLDXPR
     I              OMDYPR                          WLDYPR
     I              OMDZPR                          WLDZPR
     I              OMGSPR                          WLGSPR
     I              OMGTPR                          WLGTPR
     I              OMGUPR                          WLGUPR
     I              OMHOST                          WLHOST
     I              OMHPST                          WLHPST
     I              OMIOST                          WLIOST
     I              OMPEWG                          WLPEWG
     I              OMRINY                          WLRINY
     I              OMTIDT                          WLTIDT
     I              OMTJDT                          WLTJDT
     I              OMH2ST                          WLH2ST
     I              OMH0ST                          WLH0ST
     I              OMH1ST                          WLH1ST
     I              OMTKDT                          WLTKDT
     I              OMTLDT                          WLTLDT
     I              OMTMDT                          WLTMDT
     I              OMUVST                          WLUVST
     I              OMUWST                          WLUWST
     I              OMUXST                          WLUXST
     I              OMAATM                          WLAATM
     I              OMAYNA                          WLAYNA
     I              OMA0NA                          WLA0NA
     I              OMAXDT                          WLAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQCAAF1    E DSCAAFREL0
      * UPD : Calendar                  Update index
      * Renamed input format fields
     I              AFAIC3                          WBAIC3
     I              AFBCDT                          WBBCDT
     I              AFCQNB                          WBCQNB
     I              AFESNB                          WBESNB
     I              AFETNB                          WBETNB
     I              AFBZNB                          WBBZNB
     I              AFA9ST                          WBA9ST
     I              AFEINB                          WBEINB
     I              AFC5ST                          WBC5ST
     I              AFAQNB                          WBAQNB
     I              AFCMST                          WBCMST
     I              AFV9ST                          WBV9ST
     I              AFWAST                          WBWAST
     I              AFX2ST                          WBX2ST
     I              AFOJDT                          WBOJDT
     I              AFNQNX                          WBNQNX
     I              AFNRNX                          WBNRNX
     I              AFI9SX                          WBI9SX
     I              AFJASX                          WBJASX
     I              AFOKDT                          WBOKDT
     I              AFOLDT                          WBOLDT
     I              AFUVST                          WBUVST
     I              AFUWST                          WBUWST
     I              AFUXST                          WBUXST
     I              AFAATM                          WBAATM
     I              AFAYNA                          WBAYNA
     I              AFA0NA                          WBA0NA
     I              AFAXDT                          WBAXDT
      *
     IYARDCS      DS                             75
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPDJC1    E DSPDJCCPL0
      * UPD : PS Prod Schedule          Update index
      * Renamed input format fields
     I              JCAIC3                          WDAIC3
     I              JCV5ST                          WDV5ST
     I              JCELDT                          WDELDT
     I              JCHVHD                          WDHVHD
     I              JCZ6NB                          WDZ6NB
     I              JCZ7NB                          WDZ7NB
     I              JCDGPC                          WDDGPC
     I              JCAVCW                          WDAVCW
     I              JCDIPC                          WDDIPC
     I              JCZ0NB                          WDZ0NB
     I              JCAVLE                          WDAVLE
     I              JCECWG                          WDECWG
     I              JCUVST                          WDUVST
     I              JCUWST                          WDUWST
     I              JCUXST                          WDUXST
     I              JCVSST                          WDVSST
     I              JCAATM                          WDAATM
     I              JCAYNA                          WDAYNA
     I              JCA0NA                          WDA0NA
     I              JCAXDT                          WDAXDT
      *
     IQPDLM1    E DSPDLMCPL0
      * UPD : PS Prod Dept Schedule     Update index
      * Renamed input format fields
     I              LMAIC3                          WFAIC3
     I              LMV5ST                          WFV5ST
     I              LMELDT                          WFELDT
     I              LMR3CD                          WFR3CD
     I              LMRMPA                          WFRMPA
     I              LMGFWG                          WFGFWG
     I              LMGGWG                          WFGGWG
     I              LMCLNB                          WFCLNB
     I              LMGHWG                          WFGHWG
     I              LMDVNB                          WFDVNB
     I              LMGNWG                          WFGNWG
     I              LMDZNB                          WFDZNB
     I              LMGOWG                          WFGOWG
     I              LMD0NB                          WFD0NB
     I              LMGPWG                          WFGPWG
     I              LMD1NB                          WFD1NB
     I              LMGQWG                          WFGQWG
     I              LMD4NB                          WFD4NB
     I              LMGRWG                          WFGRWG
     I              LMTKST                          WFTKST
     I              LMTLST                          WFTLST
     I              LMTNST                          WFTNST
     I              LMCD3S                          WFCD3S
     I              LMTVST                          WFTVST
     I              LMTWST                          WFTWST
     I              LMUVST                          WFUVST
     I              LMUWST                          WFUWST
     I              LMUXST                          WFUXST
     I              LMVSST                          WFVSST
     I              LMAATM                          WFAATM
     I              LMAYNA                          WFAYNA
     I              LMA0NA                          WFA0NA
     I              LMAXDT                          WFAXDT
      *
     IQPDI81    E DSPDI8CPL0
      * UPD : PS Prod Item Schedule     Update index
      * Renamed input format fields
     I              I8AIC3                          WHAIC3
     I              I8V5ST                          WHV5ST
     I              I8ELDT                          WHELDT
     I              I8HGCD                          WHHGCD
     I              I8AJCD                          WHAJCD
     I              I8GPDT                          WHGPDT
     I              I8WTSP                          WHWTSP
     I              I8QTSP                          WHQTSP
     I              I8DJPC                          WHDJPC
     I              I8F8WG                          WHF8WG
     I              I8WTIN                          WHWTIN
     I              I8D5NB                          WHD5NB
     I              I8DXWG                          WHDXWG
     I              I8B2NB                          WHB2NB
     I              I8WTCN                          WHWTCN
     I              I8PSCV                          WHPSCV
     I              I8SAWT                          WHSAWT
     I              I8B9NB                          WHB9NB
     I              I8D1WG                          WHD1WG
     I              I8CBNB                          WHCBNB
     I              I8EZWG                          WHEZWG
     I              I8CCNB                          WHCCNB
     I              I8E0WG                          WHE0WG
     I              I8D6NB                          WHD6NB
     I              I8OAWT                          WHOAWT
     I              I8CDNB                          WHCDNB
     I              I8UNW2                          WHUNW2
     I              I8CENB                          WHCENB
     I              I8F9WG                          WHF9WG
     I              I8BPNB                          WHBPNB
     I              I8GAWG                          WHGAWG
     I              I8BQNB                          WHBQNB
     I              I8GBWG                          WHGBWG
     I              I8BRNB                          WHBRNB
     I              I8GCWG                          WHGCWG
     I              I8BSNB                          WHBSNB
     I              I8GDWG                          WHGDWG
     I              I8BWNB                          WHBWNB
     I              I8GEWG                          WHGEWG
     I              I8PS6U                          WHPS6U
     I              I8WCST                          WHWCST
     I              I8WPST                          WHWPST
     I              I8B5ST                          WHB5ST
     I              I8TFST                          WHTFST
     I              I8TEST                          WHTEST
     I              I8THST                          WHTHST
     I              I8UDST                          WHUDST
     I              I8UFST                          WHUFST
     I              I8UGST                          WHUGST
     I              I8UHST                          WHUHST
     I              I8B6ST                          WHB6ST
     I              I8B7ST                          WHB7ST
     I              I8DVWG                          WHDVWG
     I              I8D7NB                          WHD7NB
     I              I8FCAD                          WHFCAD
     I              I8D9NB                          WHD9NB
     I              I8DWWG                          WHDWWG
     I              I8EANB                          WHEANB
     I              I8SHWT                          WHSHWT
     I              I8EBNB                          WHEBNB
     I              I8AVWT                          WHAVWT
     I              I8ECNB                          WHECNB
     I              I8WTON                          WHWTON
     I              I8EDNB                          WHEDNB
     I              I8FNWT                          WHFNWT
     I              I8EENB                          WHEENB
     I              I8QTAS                          WHQTAS
     I              I8EFNB                          WHEFNB
     I              I8WAIO                          WHWAIO
     I              I8EGNB                          WHEGNB
     I              I8R3CD                          WHR3CD
     I              I8RGNB                          WHRGNB
     I              I8RHNB                          WHRHNB
     I              I8RINB                          WHRINB
     I              I8XRCD                          WHXRCD
     I              I8UVST                          WHUVST
     I              I8UWST                          WHUWST
     I              I8UXST                          WHUXST
     I              I8VSST                          WHVSST
     I              I8AATM                          WHAATM
     I              I8AYNA                          WHAYNA
     I              I8A0NA                          WHA0NA
     I              I8AXDT                          WHAXDT
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WLAIC3
     I              OMC4NB                          WLC4NB
     I              OMDPNB                          WLDPNB
     I              OMUENB                          WLUENB
     I              OMHGCD                          WLHGCD
     I              OMAJCD                          WLAJCD
     I              OMBKC7                          WLBKC7
     I              OMCFC7                          WLCFC7
     I              OMGMST                          WLGMST
     I              OMGNST                          WLGNST
     I              OMMAVA                          WLMAVA
     I              OMKDVA                          WLKDVA
     I              OML8VA                          WLL8VA
     I              OML9VA                          WLL9VA
     I              OMGTST                          WLGTST
     I              OMGVST                          WLGVST
     I              OMGUST                          WLGUST
     I              OMQFST                          WLQFST
     I              OMAYVA                          WLAYVA
     I              OMEXDT                          WLEXDT
     I              OMLQCD                          WLLQCD
     I              OMRDCD                          WLRDCD
     I              OMQ7CD                          WLQ7CD
     I              OMBZPR                          WLBZPR
     I              OML6NB                          WLL6NB
     I              OMU1ST                          WLU1ST
     I              OMGIDT                          WLGIDT
     I              OMCRCD                          WLCRCD
     I              OMAGCD                          WLAGCD
     I              OMRZST                          WLRZST
     I              OMR0ST                          WLR0ST
     I              OMR1ST                          WLR1ST
     I              OMG7NA                          WLG7NA
     I              OMG8NA                          WLG8NA
     I              OMRPCD                          WLRPCD
     I              OMVEST                          WLVEST
     I              OMVGST                          WLVGST
     I              OMAVST                          WLAVST
     I              OMU0ST                          WLU0ST
     I              OMRFCD                          WLRFCD
     I              OMFZST                          WLFZST
     I              OMR1NB                          WLR1NB
     I              OMAVQT                          WLAVQT
     I              OMD0WG                          WLD0WG
     I              OMCCQT                          WLCCQT
     I              OMAUWG                          WLAUWG
     I              OMCBQT                          WLCBQT
     I              OMATWG                          WLATWG
     I              OMAQCS                          WLAQCS
     I              OMAGCS                          WLAGCS
     I              OMAKPR                          WLAKPR
     I              OMALPR                          WLALPR
     I              OMAUPR                          WLAUPR
     I              OMAVWG                          WLAVWG
     I              OMA4WG                          WLA4WG
     I              OMA5DT                          WLA5DT
     I              OMAODT                          WLAODT
     I              OMGNDT                          WLGNDT
     I              OMAMST                          WLAMST
     I              OMANST                          WLANST
     I              OMVAST                          WLVAST
     I              OMRGNB                          WLRGNB
     I              OMRHNB                          WLRHNB
     I              OMRINB                          WLRINB
     I              OMRBCD                          WLRBCD
     I              OMHICD                          WLHICD
     I              OMRNCD                          WLRNCD
     I              OMROCD                          WLROCD
     I              OMCXDT                          WLCXDT
     I              OMAJVN                          WLAJVN
     I              OMKXCD                          WLKXCD
     I              OMJPCD                          WLJPCD
     I              OMCQCD                          WLCQCD
     I              OMR4CD                          WLR4CD
     I              OMZ1ST                          WLZ1ST
     I              OMZ3ST                          WLZ3ST
     I              OMZ4ST                          WLZ4ST
     I              OMDUPR                          WLDUPR
     I              OMB6VL                          WLB6VL
     I              OMA1AA                          WLA1AA
     I              OMFZSX                          WLFZSX
     I              OMF0SX                          WLF0SX
     I              OMF1SX                          WLF1SX
     I              OMF2SX                          WLF2SX
     I              OMF3SX                          WLF3SX
     I              OMF4SX                          WLF4SX
     I              OMF5SX                          WLF5SX
     I              OMF6SX                          WLF6SX
     I              OMF7SX                          WLF7SX
     I              OMNTDT                          WLNTDT
     I              OMNUDT                          WLNUDT
     I              OMNVDT                          WLNVDT
     I              OMNWDT                          WLNWDT
     I              OMNXDT                          WLNXDT
     I              OMBUTM                          WLBUTM
     I              OMBVTM                          WLBVTM
     I              OMBWTM                          WLBWTM
     I              OMBXTM                          WLBXTM
     I              OMBYTM                          WLBYTM
     I              OMH5NX                          WLH5NX
     I              OMH6NX                          WLH6NX
     I              OMH7NX                          WLH7NX
     I              OMH8NX                          WLH8NX
     I              OMH9NX                          WLH9NX
     I              OMDVPR                          WLDVPR
     I              OMDWPR                          WLDWPR
     I              OMDXPR                          WLDXPR
     I              OMDYPR                          WLDYPR
     I              OMDZPR                          WLDZPR
     I              OMGSPR                          WLGSPR
     I              OMGTPR                          WLGTPR
     I              OMGUPR                          WLGUPR
     I              OMHOST                          WLHOST
     I              OMHPST                          WLHPST
     I              OMIOST                          WLIOST
     I              OMPEWG                          WLPEWG
     I              OMRINY                          WLRINY
     I              OMTIDT                          WLTIDT
     I              OMTJDT                          WLTJDT
     I              OMH2ST                          WLH2ST
     I              OMH0ST                          WLH0ST
     I              OMH1ST                          WLH1ST
     I              OMTKDT                          WLTKDT
     I              OMTLDT                          WLTLDT
     I              OMTMDT                          WLTMDT
     I              OMUVST                          WLUVST
     I              OMUWST                          WLUWST
     I              OMUXST                          WLUXST
     I              OMAATM                          WLAATM
     I              OMAYNA                          WLAYNA
     I              OMA0NA                          WLA0NA
     I              OMAXDT                          WLAXDT
      *
     IYBRDCS      DS                            525
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  Company Number
     I                                    P   1   20P1AIC3
     IP2PARM      DS
      * I :  Production Type
     I                                        1   1 P2V5ST
     IP3PARM      DS
      * I :  Production Date
     I                                    P   1   40P3ELDT
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'PS Delete Error'
      * Company Number
     I                                        1   3 ZA0001
      * Production Type
     I                                        4   4 ZA0002
      * Production Date
     I                                    P   5   80ZA0003
      * Item Code
     I                                        9  15 ZA0004
      * Warehouse Code
     I                                       16  18 ZA0005
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P2V5ST    PARM           WP0002  1        Production Type
     C           P3ELDT    PARM           WP0003  70       Production Date
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Del Production Sched  XF
      * Chg Kill/Prod Day Sts RT - Calendar  * 
     C                     EXSR SARVGN
      * UPS Del Sched/Plan    RT - PS Prod Schedule  * 
     C                     EXSR SCRVGN
      * UPS Delete Dept Sch   RT - PS Prod Dept Schedule  * 
     C                     EXSR SERVGN
      * UPS Del Schd/Plan Dtl RT - PS Prod Item Schedule  * 
     C                     EXSR SGRVGN
      * UPS Re-Alc Item Prod  RT - Order Detail Schedule  * 
     C                     EXSR SIRVGN
      * Upd Kill/Cut Pln 4OMS XF - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'PLDBXFR'              90  Upd Kill/Cut Pl
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0057  30       Company Number
     C                     PARM P3ELDT    WQ0058  70       Date
     C                     PARM *ZERO     WQ0059  50       Hog Volume
     C                     PARM *ZERO     WQ0060  50       Hog Volume USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLDBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Chg Kill/Prod Day Sts RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WABCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADDP1AIC3    WAAIC3           Company Number
     C                     Z-ADDP3ELDT    WABCDT           Post to G/L Dat
      * Establish starting position
     C           KRSSA     CHAIN@AFREBE              90    *
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Kill/Prod Day Sts CH - Calendar  * 
     C                     EXSR SBCHRC
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCHRC    BEGSR
      *================================================================
      * Chg Kill/Prod Day Sts CH - Calendar  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  50       Julian Date
     C                     Z-ADD*ZERO     WN0002  40       Accounting Year
     C                     Z-ADD*ZERO     WN0003  20       Accounting Peri
     C                     Z-ADD*ZERO     WN0004  30       OM Week
     C                     MOVEL*BLANK    WN0005  1        Day of Week
     C                     Z-ADD*ZERO     WN0006  20       Week Number
     C                     MOVEL*BLANK    WN0007  1        Public Holiday
     C                     Z-ADD*ZERO     WN0008  20       Billing Cycle
     C                     MOVEL*BLANK    WN0009  1        Payroll Quarter
     C                     MOVEL*BLANK    WN0010  1        Prodcution Sch/
     C                     Z-ADD*ZERO     WN0011  50       HPS PIC Date
     C                     Z-ADD*ZERO     WN0012  40       HPS Calendar Ye
     C                     Z-ADD*ZERO     WN0013  20       HPS Calendar We
     C                     MOVEL*BLANK    WN0014  1        Number of Prod
     C                     MOVEL*BLANK    WN0015  1        Calendar Unused
     C                     Z-ADD*ZERO     WN0016  70       Calendar Unused
     C                     Z-ADD*ZERO     WN0017  70       Calendar Unused
     C                     MOVEL*BLANK    WN0018  1        EDI Status 1
     C                     MOVEL*BLANK    WN0019  1        EDI Status 2
     C                     MOVEL*BLANK    WN0020  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0021  60       Job Time
     C                     MOVEL*BLANK    WN0022 10        User Id
     C                     MOVEL*BLANK    WN0023 10        Job Name
     C                     Z-ADD*ZERO     WN0024  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @AFREBD
     C                     Z-ADDWAAIC3    WBAIC3           Company Number
     C                     Z-ADDWABCDT    WBBCDT           Post to G/L Dat
      *
     C           KLCHSB    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBBCDT           Post to G/L Dat
     C           KLCHSB    CHAIN@AFREBD              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAAFREL0'MDACP
     C                     MOVEL'@AFREBD' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAAF1    YARDCS
      * Move non-key fields to @AFREBD
     C                     MOVEL'N'       WBV9ST    P      Kill Day Status
     C                     MOVEL'N'       WBWAST    P      Production Day
      *
      * Set PGM.*Record Data Changed flag
     C           QCAAF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@AFREBD                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAAFREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * UPS Del Sched/Plan    RT - PS Prod Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCV5ST           Production Type
     C                     KFLD           WCELDT           Production Date
      * Setup key
     C                     Z-ADDP1AIC3    WCAIC3           Company Number
     C                     MOVELP2V5ST    WCV5ST           Production Type
     C                     Z-ADDP3ELDT    WCELDT           Production Date
      * Establish starting position
     C           KRSSC     CHAIN@JCCPVC              90    *
      * Data record not found
     C   90                MOVEL'USR1795' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Delete the Production Header record
      * DLT Production Hdr     DL - PS Prod Schedule  * 
     C                     EXSR SDDLRC
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDDLRC    BEGSR
      *================================================================
      * DLT Production Hdr     DL - PS Prod Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @JCCPVB
     C                     Z-ADDWCAIC3    WDAIC3           Company Number
     C                     MOVELWCV5ST    WDV5ST           Production Type
     C                     Z-ADDWCELDT    WDELDT           Production Date
      *
     C           KLDLSD    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDV5ST           Production Type
     C                     KFLD           WDELDT           Production Date
     C           KLDLSD    CHAIN@JCCPVB              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDJCCPL0'MDACP
     C                     MOVEL'@JCCPVB' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@JCCPVB                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * UPS Delete Dept Sch   RT - PS Prod Dept Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIC3    WQSE01           Company Number
     C           *LIKE     DEFN WEV5ST    WQSE02           Production Type
     C           *LIKE     DEFN WEELDT    WQSE03           Production Date
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WQSE02           Production Type
     C                     KFLD           WQSE03           Production Date
      * Setup key
     C                     Z-ADDP1AIC3    WQSE01           Company Number
     C                     MOVELP2V5ST    WQSE02           Production Type
     C                     Z-ADDP3ELDT    WQSE03           Production Date
      * Establish starting position
     C           KRSSE     SETLL@LMCPO1                    *
     C           KRSSE     READE@LMCPO1                  90*
      * Data record not found
     C   90                MOVEL'USR2507' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Delete PS Prod Dept Sched - PS Prod Dept Schedule  * 
     C                     EXSR SFDLRC
     C           KRSSE     READE@LMCPO1                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFDLRC    BEGSR
      *================================================================
      * Delete PS Prod Dept Sched - PS Prod Dept Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @LMCPO0
     C                     Z-ADDWEAIC3    WFAIC3           Company Number
     C                     MOVELWEV5ST    WFV5ST           Production Type
     C                     Z-ADDWEELDT    WFELDT           Production Date
     C                     MOVELWER3CD    WFR3CD           Department Code
      *
     C           KLDLSF    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFV5ST           Production Type
     C                     KFLD           WFELDT           Production Date
     C                     KFLD           WFR3CD           Department Code
     C           KLDLSF    CHAIN@LMCPO0              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDLMCPL0'MDACP
     C                     MOVEL'@LMCPO0' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@LMCPO0                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * UPS Del Schd/Plan Dtl RT - PS Prod Item Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGAIC3    WQSG01           Company Number
     C           *LIKE     DEFN WGV5ST    WQSG02           Production Type
     C           *LIKE     DEFN WGELDT    WQSG03           Production Date
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Production Type
     C                     KFLD           WQSG03           Production Date
      * Setup key
     C                     Z-ADDP1AIC3    WQSG01           Company Number
     C                     MOVELP2V5ST    WQSG02           Production Type
     C                     Z-ADDP3ELDT    WQSG03           Production Date
      * Establish starting position
     C           KRSSG     SETLL@I8CPUS                    *
     C           KRSSG     READE@I8CPUS                  90*
      * Data record not found
     C   90                MOVEL'USR1763' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DLT Production Dtl     DL - PS Prod Item Schedule  * 
     C                     EXSR SHDLRC
      * CASE: PGM.*Return code is *Data update error
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           WGAIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVELWGAIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0001           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0001           CD3 Ext Numeric
     C                     END                             *FI
     C                     MOVELWGV5ST    ZA0002           Production Type
      * Convert Production Date to display format
      * Convert date
     C           1000000   ADD  WGELDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0003
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           WGHGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVELWGHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0004           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0004           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVELWGAJCD    ZA0005           Warehouse Code
      * Retrieve message PS Delete Error
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR2305' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           WUKRTX    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * SND Pager Msg (MPLUS) UP - /UT User Programs  * 
     C                     CALL 'POMSUPC'              90  SND Pager Msg (
     C                     PARM @CN,002   WQ0001 10        DL List ID
     C                     PARM WUKRTX    WQ0002132        Office Message
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMSUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C           KRSSG     READE@I8CPUS                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHDLRC    BEGSR
      *================================================================
      * DLT Production Dtl     DL - PS Prod Item Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @I8CPUR
     C                     Z-ADDWGAIC3    WHAIC3           Company Number
     C                     MOVELWGV5ST    WHV5ST           Production Type
     C                     Z-ADDWGELDT    WHELDT           Production Date
     C                     Z-ADDWGHGCD    WHHGCD           Item Code
     C                     MOVELWGAJCD    WHAJCD           Warehouse Code
      *
     C           KLDLSH    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHV5ST           Production Type
     C                     KFLD           WHELDT           Production Date
     C                     KFLD           WHHGCD           Item Code
     C                     KFLD           WHAJCD           Warehouse Code
     C           KLDLSH    CHAIN@I8CPUR              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI8CPL0'MDACP
     C                     MOVEL'@I8CPUR' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@I8CPUR                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * UPS Re-Alc Item Prod  RT - Order Detail Schedule  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0025  1        Age Code
     C                     Z-ADD*ZERO     WN0026 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0027 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0028 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0029 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0030  70       Requested Ship
     C                     Z-ADD*ZERO     WN0031  40       Item Age Days
     C                     Z-ADD*ZERO     WN0032  70       Production Ovr
     C                     Z-ADD*ZERO     WN0033  70       Production Ovr
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * ***** PA PROCESS - USE REQUESTED SHIP DATE FOR Ship Date USR ****
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIAIC3    WQSI01           Company Number
     C           *LIKE     DEFN WIJGDT    WQSI02           OD Production D
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Company Number
     C                     KFLD           WQSI02           OD Production D
      * Setup key
     C                     Z-ADDP1AIC3    WQSI01           Company Number
     C                     Z-ADDP3ELDT    WQSI02           OD Production D
      * Establish starting position
     C           KRSSI     SETLL@KNCPHP                    *
     C           KRSSI     READE@KNCPHP                  90*
      * Data record not found
     C   90                MOVEL'USR2238' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Deallocate
      * RTV Qty/Wgt Ord/Sched RT - Order Detail  * 
     C                     EXSR SJRVGN
      * RTV Ship To Info       RT - Order Header TRG  * 
     C                     EXSR SKRVGN
     C                     Z-ADD0         YL0002           Quantity Ordere
     C                     Z-ADD0         YL0003           Weight Ordered
     C                     Z-ADDWN0028    YL0004           Quantity Schedu
     C                     Z-ADDWN0029    YL0005           Weight Schedule
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WIAIC3    WQ0003  30       Company Number
     C                     PARM WIC4NB    WQ0004  70       Order Number
     C                     PARM WIDPNB    WQ0005  30       Order Sequence
     C                     PARM WIUENB    WQ0006  30       Order Secondary
     C                     PARM WIHGCD    WQ0007  70       Item Code
     C                     PARM WIAJCD    WQ0008  3        Warehouse Code
     C                     PARM WN0030    WQ0009  70       Ship Date USR
     C                     PARM YL0002    WQ0010 112       Quantity Ordere
     C                     PARM YL0003    WQ0011 112       Weight Ordered
     C           YL0004    PARM YL0004    WQ0012 112       Quantity Schedu
     C           YL0005    PARM YL0005    WQ0013 112       Weight Schedule
     C                     PARM 'OD'      WQ0014  2        ATS Adj Type US
     C                     PARM ##PGM     WQ0015 10        PSAA Program Na
     C                     PARM WN0031    WQ0016  40       Item Age Days
     C                     PARM WN0032    WQ0017  70       Production Ovr
     C                     PARM WN0033    WQ0018  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Chg Qty/Wgt Scheduled CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWIAIC3    WL0001           Company Number
     C                     Z-ADDWIC4NB    WL0002           Order Number
     C                     Z-ADDWIDPNB    WL0003           Order Sequence
     C                     Z-ADDWIUENB    WL0004           Order Secondary
     C                     Z-ADDYL0004    WL0005           Quantity Schedu
     C                     Z-ADDYL0005    WL0006           Weight Schedule
     C                     EXSR SLCHRC
      * Allocate
     C                     Z-ADDWN0026    YL0002           Quantity Ordere
     C                     Z-ADDWN0027    YL0003           Weight Ordered
     C                     Z-ADD0         YL0004           Quantity Schedu
     C                     Z-ADD0         YL0005           Weight Schedule
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WIAIC3    WQ0019  30       Company Number
     C                     PARM WIC4NB    WQ0020  70       Order Number
     C                     PARM WIDPNB    WQ0021  30       Order Sequence
     C                     PARM WIUENB    WQ0022  30       Order Secondary
     C                     PARM WIHGCD    WQ0023  70       Item Code
     C                     PARM WIAJCD    WQ0024  3        Warehouse Code
     C                     PARM WN0030    WQ0025  70       Ship Date USR
     C                     PARM YL0002    WQ0026 112       Quantity Ordere
     C                     PARM YL0003    WQ0027 112       Weight Ordered
     C           YL0004    PARM YL0004    WQ0028 112       Quantity Schedu
     C           YL0005    PARM YL0005    WQ0029 112       Weight Schedule
     C                     PARM 'OA'      WQ0030  2        ATS Adj Type US
     C                     PARM ##PGM     WQ0031 10        PSAA Program Na
     C                     PARM WN0031    WQ0032  40       Item Age Days
     C                     PARM WN0032    WQ0033  70       Production Ovr
     C                     PARM WN0033    WQ0034  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Chg Qty/Wgt Scheduled CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWIAIC3    WL0001           Company Number
     C                     Z-ADDWIC4NB    WL0002           Order Number
     C                     Z-ADDWIDPNB    WL0003           Order Sequence
     C                     Z-ADDWIUENB    WL0004           Order Secondary
     C                     Z-ADDYL0004    WL0005           Quantity Schedu
     C                     Z-ADDYL0005    WL0006           Weight Schedule
     C                     EXSR SLCHRC
      * Schedule As Ordered
      * CASE: LCL.Quantity Ordered NE LCL.Quantity Scheduled
     C           YL0002    IFNE YL0004                     *IF
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WIAIC3    WQ0035  30       Company Number
     C                     PARM WIC4NB    WQ0036  70       Order Number
     C                     PARM WIDPNB    WQ0037  30       Order Sequence
     C                     PARM WIUENB    WQ0038  30       Order Secondary
     C                     PARM WIHGCD    WQ0039  70       Item Code
     C                     PARM WIAJCD    WQ0040  3        Warehouse Code
     C                     PARM WN0030    WQ0041  70       Ship Date USR
     C                     PARM YL0002    WQ0042 112       Quantity Ordere
     C                     PARM YL0003    WQ0043 112       Weight Ordered
     C           YL0004    PARM YL0004    WQ0044 112       Quantity Schedu
     C           YL0005    PARM YL0005    WQ0045 112       Weight Schedule
     C                     PARM 'AO'      WQ0046  2        ATS Adj Type US
     C                     PARM ##PGM     WQ0047 10        PSAA Program Na
     C                     PARM WN0031    WQ0048  40       Item Age Days
     C                     PARM WN0032    WQ0049  70       Production Ovr
     C                     PARM WN0033    WQ0050  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Chg Qty/Wgt Scheduled CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWIAIC3    WL0001           Company Number
     C                     Z-ADDWIC4NB    WL0002           Order Number
     C                     Z-ADDWIDPNB    WL0003           Order Sequence
     C                     Z-ADDWIUENB    WL0004           Order Secondary
     C                     Z-ADDYL0004    WL0005           Quantity Schedu
     C                     Z-ADDYL0005    WL0006           Weight Schedule
     C                     EXSR SLCHRC
     C                     END                             *FI
      * EDT Post Open Orders   XF - Order Header TRG  * 
     C                     CALL 'PDHRXFR'              90  EDT Post Open O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WIAIC3    WQ0051  30       Company Number
     C                     PARM WIC4NB    WQ0052  70       Order Number
     C                     PARM YL0001    WQ0053  70       Ship To Custome
     C           WUB5VL    PARM WUB5VL    WQ0054 112       Order Value Tot
     C           WUA1WG    PARM *ZERO     WQ0055 112       Order Weight To
     C                     PARM 'PS'      WQ0056  3        Pricing Event C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C           KRSSI     READE@KNCPHP                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Qty/Wgt Ord/Sched RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJC4NB           Order Number
     C                     KFLD           WJDPNB           Order Sequence
     C                     KFLD           WJUENB           Order Secondary
      * Setup key
     C                     Z-ADDWIAIC3    WJAIC3           Company Number
     C                     Z-ADDWIC4NB    WJC4NB           Order Number
     C                     Z-ADDWIDPNB    WJDPNB           Order Sequence
     C                     Z-ADDWIUENB    WJUENB           Order Secondary
      * Establish starting position
     C           KRSSJ     CHAIN@BGWKL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUGMST           Detail Line Sta
     C                     Z-ADD*ZERO     WN0026           Quantity Ordere
     C                     Z-ADD*ZERO     WN0027           Weight Ordered
     C                     Z-ADD*ZERO     WN0028           Quantity Schedu
     C                     Z-ADD*ZERO     WN0029           Weight Schedule
     C                     Z-ADD*ZERO     WN0030           Requested Ship
     C                     Z-ADD*ZERO     WUNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WN0031           Item Age Days
     C                     Z-ADD*ZERO     WN0032           Production Ovr
     C                     Z-ADD*ZERO     WN0033           Production Ovr
     C                     MOVEL*BLANK    WUWXST           Record Found US
     C                     MOVEL'N'       WUWXST           Record Found US
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWJGMST    WUGMST           Detail Line Sta
     C                     Z-ADDWJAVQT    WN0026           Quantity Ordere
     C                     Z-ADDWJD0WG    WN0027           Weight Ordered
     C                     Z-ADDWJCCQT    WN0028           Quantity Schedu
     C                     Z-ADDWJAUWG    WN0029           Weight Schedule
     C                     Z-ADDWJA5DT    WN0030           Requested Ship
     C                     Z-ADDWJNUDT    WUNUDT           Consumed Item C
     C                     Z-ADDWJRINY    WN0031           Item Age Days
     C                     Z-ADDWJTIDT    WN0032           Production Ovr
     C                     Z-ADDWJTJDT    WN0033           Production Ovr
     C                     MOVEL'Y'       WUWXST           Record Found US
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Ship To Info       RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKC4NB           Order Number
      * Setup key
     C                     Z-ADDWIAIC3    WKAIC3           Company Number
     C                     Z-ADDWIC4NB    WKC4NB           Order Number
      * Establish starting position
     C           KRSSK     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWKBKC7    YL0001           Ship To Custome
     C                     MOVELWKBRTX    WUBRTX           Ship To Name
     C                     MOVELWKHNNA    WUHNNA           Ship To City
     C                     MOVELWKDBCD    WUDBCD           Ship To State C
     C                     MOVELWKBCNA    WUBCNA           Customer Purcha
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCHRC    BEGSR
      *================================================================
      * Chg Qty/Wgt Scheduled CH - Order Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0034  70       Item Code
     C                     MOVEL*BLANK    WN0035  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0036  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0037  70       Order Group Cod
     C                     MOVEL*BLANK    WN0038  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0039  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0040 112       Billing Detail
     C                     Z-ADD*ZERO     WN0041 112       Billing Detail
     C                     Z-ADD*ZERO     WN0042 112       Billing Detail
     C                     Z-ADD*ZERO     WN0043 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0044  1        Comment Print A
     C                     MOVEL*BLANK    WN0045  1        Comment Print I
     C                     MOVEL*BLANK    WN0046  1        Comment Print P
     C                     MOVEL*BLANK    WN0047  1        Comment Print S
     C                     Z-ADD*ZERO     WN0048 112       Extended Amount
     C                     Z-ADD*ZERO     WN0049  70       Market Pricing
     C                     MOVEL*BLANK    WN0050  3        Commodity Marke
     C                     MOVEL*BLANK    WN0051  3        Date Method Cod
     C                     MOVEL*BLANK    WN0052  3        Price Method Co
     C                     Z-ADD*ZERO     WN0053 114       Price Overage O
     C                     Z-ADD*ZERO     WN0054  70       Contract Number
     C                     MOVEL*BLANK    WN0055  1        Price Status
     C                     Z-ADD*ZERO     WN0056  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0057  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0058  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0059  1        Work Confirm St
     C                     MOVEL*BLANK    WN0060  1        Work Over/Short
     C                     MOVEL*BLANK    WN0061  1        OD Production P
     C                     MOVEL*BLANK    WN0062 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0063 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0064  1        Age Code
     C                     MOVEL*BLANK    WN0065  1        Palletize
     C                     MOVEL*BLANK    WN0066  1        Slip Sheet
     C                     MOVEL*BLANK    WN0067  1        Catch Weight St
     C                     MOVEL*BLANK    WN0068  1        Price Audit
     C                     MOVEL*BLANK    WN0069  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0070  1        Production Date
     C                     Z-ADD*ZERO     WN0071 112       Rated Freight
     C                     Z-ADD*ZERO     WN0072 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0073 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0074 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0075 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0076 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0077 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0078 114       Unit Price
     C                     Z-ADD*ZERO     WN0079 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0080 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0081 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0082 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0083  70       Requested Ship
     C                     Z-ADD*ZERO     WN0084  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0085  70       Actual Shipped
     C                     MOVEL*BLANK    WN0086  1        Affect Inventor
     C                     MOVEL*BLANK    WN0087  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0088  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0089  30       Item Structure
     C                     Z-ADD*ZERO     WN0090  30       Item Structure
     C                     Z-ADD*ZERO     WN0091  30       Item Structure
     C                     MOVEL*BLANK    WN0092  2        Item Level
     C                     MOVEL*BLANK    WN0093  2        Quality Level
     C                     MOVEL*BLANK    WN0094  2        Pricing Product
     C                     MOVEL*BLANK    WN0095  2        Season Product
     C                     Z-ADD*ZERO     WN0096  70       Date of Origina
     C                     MOVEL*BLANK    WN0097 10        User Profile Na
     C                     MOVEL*BLANK    WN0098  6        Country Code
     C                     MOVEL*BLANK    WN0099  2        Event Code
     C                     MOVEL*BLANK    WN0100  3        Reason Code
     C                     MOVEL*BLANK    WN0101  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0102  1        Modified Flag
     C                     MOVEL*BLANK    WN0103  1        Substituted Fla
     C                     MOVEL*BLANK    WN0104  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0105 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0106 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0107  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0108  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0109  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0110  1        Affect Commissi
     C                     MOVEL*BLANK    WN0111  1        Affect Pricing
     C                     MOVEL*BLANK    WN0112  1        Released by Use
     C                     MOVEL*BLANK    WN0113  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0114  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0115  3        Production Ware
     C                     MOVEL*BLANK    WN0116  3        OD Price Type
     C                     Z-ADD*ZERO     WN0117  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0118  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0119  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0120  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0121  70       OD Unused Date
     C                     Z-ADD*ZERO     WN0122  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0123  60       Price Code
     C                     Z-ADD*ZERO     WN0124  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0125  60       Substitution Li
     C                     Z-ADD*ZERO     WN0126  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0127 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0128 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0129 112       OD Item Target
     C                     Z-ADD*ZERO     WN0130 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0131 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0132 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN0133 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0134 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0135 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0136 114       OD Unused Prc 5
     C                     Z-ADD*ZERO     WN0137 114       OD Unused Prc 6
     C                     Z-ADD*ZERO     WN0138 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0139 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0140  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0141  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0142  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0143 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0144  40       Item Age Days
     C                     Z-ADD*ZERO     WN0145  70       Production Ovr
     C                     Z-ADD*ZERO     WN0146  70       Production Ovr
     C                     MOVEL*BLANK    WN0147  1        OD UnUsed Statu
     C                     MOVEL*BLANK    WN0148  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0149  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0150  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0151  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0152  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0153  1        EDI Status 1
     C                     MOVEL*BLANK    WN0154  1        EDI Status 2
     C                     MOVEL*BLANK    WN0155  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0156  60       Job Time
     C                     MOVEL*BLANK    WN0157 10        User Id
     C                     MOVEL*BLANK    WN0158 10        Job Name
     C                     Z-ADD*ZERO     WN0159  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWL0001    WLAIC3           Company Number
     C                     Z-ADDWL0002    WLC4NB           Order Number
     C                     Z-ADDWL0003    WLDPNB           Order Sequence
     C                     Z-ADDWL0004    WLUENB           Order Secondary
      *
     C           KLCHSL    KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLC4NB           Order Number
     C                     KFLD           WLDPNB           Order Sequence
     C                     KFLD           WLUENB           Order Secondary
     C           KLCHSL    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YBRDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADDWL0005    WLCCQT           Quantity Schedu
     C                     Z-ADDWL0006    WLAUWG           Weight Schedule
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WLAATM           Job Time
     C                     MOVEL##USR     WLAYNA           User Id
     C                     MOVEL##JOB     WLA0NA           Job Name
     C                     Z-ADD##JDT     WLAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WABCDT           Post to G/L Dat
     C                     Z-ADD*ZERO     WACQNB           Julian Date
     C                     Z-ADD*ZERO     WAESNB           Accounting Year
     C                     Z-ADD*ZERO     WAETNB           Accounting Peri
     C                     Z-ADD*ZERO     WABZNB           OM Week
     C                     Z-ADD*ZERO     WAEINB           Week Number
     C                     Z-ADD*ZERO     WAAQNB           Billing Cycle
     C                     Z-ADD*ZERO     WAOJDT           HPS PIC Date
     C                     Z-ADD*ZERO     WANQNX           HPS Calendar Ye
     C                     Z-ADD*ZERO     WANRNX           HPS Calendar We
     C                     Z-ADD*ZERO     WAOKDT           Calendar Unused
     C                     Z-ADD*ZERO     WAOLDT           Calendar Unused
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCELDT           Production Date
     C                     Z-ADD*ZERO     WCHVHD           Hog Volume
     C                     Z-ADD*ZERO     WCZ6NB           Average Live We
     C                     Z-ADD*ZERO     WCZ7NB           Average Hot Wei
     C                     Z-ADD*ZERO     WCDGPC           Cooler Shrink P
     C                     Z-ADD*ZERO     WCAVCW           Average Cold We
     C                     Z-ADD*ZERO     WCDIPC           Average Lean Pe
     C                     Z-ADD*ZERO     WCZ0NB           Average Backfat
     C                     Z-ADD*ZERO     WCAVLE           Average Loin-Ey
     C                     Z-ADD*ZERO     WCECWG           Hot Weight Tota
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEELDT           Production Date
     C                     Z-ADD*ZERO     WERMPA           CDS RM Pieces A
     C                     Z-ADD*ZERO     WEGFWG           CDS RM Weight A
     C                     Z-ADD*ZERO     WEGGWG           CDS Avg Piece W
     C                     Z-ADD*ZERO     WECLNB           CDS CV Pieces A
     C                     Z-ADD*ZERO     WEGHWG           CDS CV Weight A
     C                     Z-ADD*ZERO     WEDVNB           CDS Pieces Unus
     C                     Z-ADD*ZERO     WEGNWG           CDS Weight Unus
     C                     Z-ADD*ZERO     WEDZNB           CDS Pieces Unus
     C                     Z-ADD*ZERO     WEGOWG           CDS Weight Unus
     C                     Z-ADD*ZERO     WED0NB           CDS Pieces Unus
     C                     Z-ADD*ZERO     WEGPWG           CDS Weight Unus
     C                     Z-ADD*ZERO     WED1NB           CDS Pieces Unus
     C                     Z-ADD*ZERO     WEGQWG           CDS Weight Unus
     C                     Z-ADD*ZERO     WED4NB           CDS Pieces Unus
     C                     Z-ADD*ZERO     WEGRWG           CDS Weight Unus
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGELDT           Production Date
     C                     Z-ADD*ZERO     WGHGCD           Item Code
     C                     Z-ADD*ZERO     WGGPDT           PS Available Sh
     C                     Z-ADD*ZERO     WGWTSP           PS Weight Plann
     C                     Z-ADD*ZERO     WGQTSP           PS Pieces Plann
     C                     Z-ADD*ZERO     WGDJPC           PS % of Carcass
     C                     Z-ADD*ZERO     WGF8WG           PS Avg Piece Wg
     C                     Z-ADD*ZERO     WGWTIN           PS Weight Inv O
     C                     Z-ADD*ZERO     WGD5NB           PS Pieces Inv O
     C                     Z-ADD*ZERO     WGDXWG           PS Weight Stand
     C                     Z-ADD*ZERO     WGB2NB           PS Pieces Stand
     C                     Z-ADD*ZERO     WGWTCN           PS Weight Conve
     C                     Z-ADD*ZERO     WGPSCV           PS Pieces Conve
     C                     Z-ADD*ZERO     WGSAWT           PS Weight Shipp
     C                     Z-ADD*ZERO     WGB9NB           PS Pieces Shipp
     C                     Z-ADD*ZERO     WGD1WG           PS Weight Prod
     C                     Z-ADD*ZERO     WGCBNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WGEZWG           PS Weight Inv A
     C                     Z-ADD*ZERO     WGCCNB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WGE0WG           PS Weight Ship
     C                     Z-ADD*ZERO     WGD6NB           PS Pieces Ship
     C                     Z-ADD*ZERO     WGOAWT           PS Weight Prod
     C                     Z-ADD*ZERO     WGCDNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WGUNW2           PS Weight Inv A
     C                     Z-ADD*ZERO     WGCENB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WGF9WG           PS Unit Weight
     C                     Z-ADD*ZERO     WGBPNB           PS Pieces Whse
     C                     Z-ADD*ZERO     WGGAWG           PS Weight Whse
     C                     Z-ADD*ZERO     WGBQNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WGGBWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WGBRNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WGGCWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WGBSNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WGGDWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WGBWNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WGGEWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WGPS6U           PS Pieces Unuse
     C                     Z-ADD*ZERO     WGDVWG           PS Weight Order
     C                     Z-ADD*ZERO     WGD7NB           PS Pieces Order
     C                     Z-ADD*ZERO     WGFCAD           PS Weight FC Ad
     C                     Z-ADD*ZERO     WGD9NB           PS Pieces FC Ad
     C                     Z-ADD*ZERO     WGDWWG           PS Weight FX Ad
     C                     Z-ADD*ZERO     WGEANB           PS Pieces FX Ad
     C                     Z-ADD*ZERO     WGSHWT           PS Weight Sched
     C                     Z-ADD*ZERO     WGEBNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WGAVWT           PS Weight Avail
     C                     Z-ADD*ZERO     WGECNB           PS Pieces Avail
     C                     Z-ADD*ZERO     WGWTON           PS Weight Produ
     C                     Z-ADD*ZERO     WGEDNB           PS Pieces Produ
     C                     Z-ADD*ZERO     WGFNWT           PS Weight Fab N
     C                     Z-ADD*ZERO     WGEENB           PS Pieces Fab N
     C                     Z-ADD*ZERO     WGQTAS           PS Weight Sched
     C                     Z-ADD*ZERO     WGEFNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WGWAIO           PS Weight Sched
     C                     Z-ADD*ZERO     WGEGNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WGRGNB           Item Structure
     C                     Z-ADD*ZERO     WGRHNB           Item Structure
     C                     Z-ADD*ZERO     WGRINB           Item Structure
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Define work field Office Message USR
     C                     MOVEL*BLANK    WUKRTX132
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIC4NB           Order Number
     C                     Z-ADD*ZERO     WIDPNB           Order Sequence
     C                     Z-ADD*ZERO     WIUENB           Order Secondary
     C                     Z-ADD*ZERO     WIJGDT           OD Production D
     C                     Z-ADD*ZERO     WIAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WIHGCD           Item Code
     C                     Z-ADD*ZERO     WIIGQT           OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WIFLWG           OD Weight Sched
     C                     Z-ADD*ZERO     WIIUQT           OD Quantity Inv
     C                     Z-ADD*ZERO     WIF3WG           OD Weight Inv S
     C                     Z-ADD*ZERO     WIIVQT           OD Quantity Unu
     C                     Z-ADD*ZERO     WIF4WG           OD Unused weigh
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Define work field Detail Line Status
     C                     MOVEL*BLANK    WUGMST  1
      * Define work field Consumed Item Code
     C                     Z-ADD*ZERO     WUNUDT  70
      * Define work field Record Found USR
     C                     MOVEL*BLANK    WUWXST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJC4NB           Order Number
     C                     Z-ADD*ZERO     WJDPNB           Order Sequence
     C                     Z-ADD*ZERO     WJUENB           Order Secondary
     C                     Z-ADD*ZERO     WJHGCD           Item Code
     C                     Z-ADD*ZERO     WJBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WJCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WJMAVA           Billing Detail
     C                     Z-ADD*ZERO     WJKDVA           Billing Detail
     C                     Z-ADD*ZERO     WJL8VA           Billing Detail
     C                     Z-ADD*ZERO     WJL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WJAYVA           Extended Amount
     C                     Z-ADD*ZERO     WJEXDT           Market Pricing
     C                     Z-ADD*ZERO     WJBZPR           Price Overage O
     C                     Z-ADD*ZERO     WJL6NB           Contract Number
     C                     Z-ADD*ZERO     WJGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WJR1NB           Rated Freight
     C                     Z-ADD*ZERO     WJAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WJD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WJCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WJAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WJCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WJATWG           Weight Shipped
     C                     Z-ADD*ZERO     WJAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WJAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WJAKPR           Unit Price
     C                     Z-ADD*ZERO     WJALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WJAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WJAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WJA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WJA5DT           Requested Ship
     C                     Z-ADD*ZERO     WJAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WJGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WJRGNB           Item Structure
     C                     Z-ADD*ZERO     WJRHNB           Item Structure
     C                     Z-ADD*ZERO     WJRINB           Item Structure
     C                     Z-ADD*ZERO     WJCXDT           Date of Origina
     C                     Z-ADD*ZERO     WJDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WJB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WJA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WJNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WJNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WJNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WJNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WJNXDT           OD Unused Date
     C                     Z-ADD*ZERO     WJBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WJBVTM           Price Code
     C                     Z-ADD*ZERO     WJBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WJBXTM           Substitution Li
     C                     Z-ADD*ZERO     WJBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WJH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WJH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WJH7NX           OD Item Target
     C                     Z-ADD*ZERO     WJH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WJH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WJDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WJDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WJDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WJDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WJDZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WJGSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     WJGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WJGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WJPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WJRINY           Item Age Days
     C                     Z-ADD*ZERO     WJTIDT           Production Ovr
     C                     Z-ADD*ZERO     WJTJDT           Production Ovr
     C                     Z-ADD*ZERO     WJTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WJTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WJTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Define work field Ship To Name
     C                     MOVEL*BLANK    WUBRTX 30
      * Define work field Ship To City
     C                     MOVEL*BLANK    WUHNNA 20
      * Define work field Ship To State Code
     C                     MOVEL*BLANK    WUDBCD  2
      * Define work field Customer Purchase Order #
     C                     MOVEL*BLANK    WUBCNA 15
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKC4NB           Order Number
     C                     Z-ADD*ZERO     WKANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WKBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WKB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WKA0DT           Order Date
     C                     Z-ADD*ZERO     WKA5DT           Requested Ship
     C                     Z-ADD*ZERO     WKGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WKACDT           Cancel Date
     C                     Z-ADD*ZERO     WKAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WKCXDT           Date of Origina
     C                     Z-ADD*ZERO     WKJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WKA1WG           Order Weight To
     C                     Z-ADD*ZERO     WKEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WKAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WKRMNB           Load ID
     C                     Z-ADD*ZERO     WKTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WKR1NB           Rated Freight
     C                     Z-ADD*ZERO     WKRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WKATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WKRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WKT3NB           Attach to Order
     C                     Z-ADD*ZERO     WKCONB           Invoice Number
     C                     Z-ADD*ZERO     WKAWDT           Invoice Date
     C                     Z-ADD*ZERO     WKVRVA           A/R order Value
     C                     Z-ADD*ZERO     WKB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WKNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WKNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WKNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WKNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WKNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WKBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WKBQTM           Time of Origina
     C                     Z-ADD*ZERO     WKBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WKBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WKBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WKH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WKH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WKH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WKH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WKH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WKC0C7           Claim Number
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Define work field Unused Parm - Value   USR
     C                     Z-ADD*ZERO     WUB5VL 112
      * Define work field Order Weight Total
     C                     Z-ADD*ZERO     WUA1WG 112
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SLCHRC.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     Z-ADD*ZERO     WL0003  30
     C                     Z-ADD*ZERO     WL0004  30
     C                     Z-ADD*ZERO     WL0005 112
     C                     Z-ADD*ZERO     WL0006 112
      * Define local work field Ship To Customer
     C                     Z-ADD*ZERO     YL0001  70
      * Define local work field Quantity Ordered
     C                     Z-ADD*ZERO     YL0002 112
      * Define local work field Weight Ordered
     C                     Z-ADD*ZERO     YL0003 112
      * Define local work field Quantity Scheduled
     C                     Z-ADD*ZERO     YL0004 112
      * Define local work field Weight Scheduled
     C                     Z-ADD*ZERO     YL0005 112
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Y2U0004
00002 PRKDEV
