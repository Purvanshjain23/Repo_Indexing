// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PPBZXFR
// ?Date: 14.08.2025 Time: 03:39:56
// ?------------------------------------------------------------------------------------------------

//?Execute user function

// LCL.USR Date  6.0 = PAR.Date - ATR
LCL.USR_Date_6_0 = PAR.Date_ATR;

// LCL.Date (Char-6) USR = CVTVAR(LCL.USR Date  6.0)
LCL.Date_Char_6_USR = CVTVAR(LCL.USR_Date_6_0);

// PAR.Production Date UPL = CONCAT(CON.20,LCL.Date (Char-6) USR,CON.*ZERO)
PAR.Production_Date_UPL = '20' + LCL.Date_Char_6_USR (*ZERO);

EXECUTE FUNCTION(Read all rcds for Prg RT) TYPE(RTVOBJ) FILE(POB1CPP)           AC1680772;
PARAMETER(PAR.Production_Date_UPL);
PARAMETER(PAR.Date_From_USR);
PARAMETER(PAR.Date_In);
{
 //?USER: Initialize routine

 // WRK.First Time Flag = CND.Yes
 WRK.First_Time_Flag = 'Y';

 //?USER: Process Data record

 // LCL.PT Prod Date YYYYMMDD = CVTVAR(DB1.Production Date UPL)
 LCL.PT_Prod_Date_YYYYMMDD = CVTVAR(DB1.Production_Date_UPL);

 // LCL.Production Date = LCL.PT Prod Date YYYYMMDD
 LCL.Production_Date = LCL.PT_Prod_Date_YYYYMMDD;

 //?Set Century
 CASE;

 // IF LCL.Production Date is < 410101
 IF LCL.Production_Date < 410101;

 // LCL.Production Date = LCL.Production Date + CON.1000000
 LCL.Production_Date = LCL.Production_Date + 1000000;

 ENDIF;

 //?First Time processing Only
 CASE;

 // IF WRK.First Time Flag is Yes
 IF WRK.First_Time_Flag = 'Y';

 CASE;

 // IF PAR.Date From             USR LT LCL.Production Date
 IF PAR.Date_From_USR < LCL.Production_Date;

 // OR PAR.Date From             USR is Not Entered
 OR PAR.Date_From_USR = *ZERO;

 // PAR.Date From             USR = LCL.Production Date
 PAR.Date_From_USR = LCL.Production_Date;

 ENDIF;

 // WRK.First Time Flag = CND.NO
 WRK.First_Time_Flag = 'N';

 ENDIF;

 EXECUTE FUNCTION(Create Cold Scale Tattoo) TYPE(CRTOBJ) FILE(POB1CPP)           AC1646324;
 PARAMETER(DB1.Production_Date_UPL);
 PARAMETER(DB1.Production_Time_UPL);
 PARAMETER(DB1.Shift_Number_UPL);
 PARAMETER(DB1.Equilibration_Bay_UPL);
 PARAMETER(DB1.Tattoo_Number_UPL);
 EXECUTE FUNCTION(Delete Cold Scale Tattoo) TYPE(DLTOBJ) FILE(POB1CPP)           AC1646326;
 PARAMETER(DB1.Production_Date_UPL);
 PARAMETER(DB1.Production_Time_UPL);
 PARAMETER(DB1.Shift_Number_UPL);
 CASE;

 // IF PAR.Date In GT LCL.Production Date
 IF PAR.Date_In > LCL.Production_Date;

 // OR PAR.Date In is not entered
 OR PAR.Date_In = *ZERO;

 // PAR.Date In = LCL.Production Date
 PAR.Date_In = LCL.Production_Date;

 ENDIF;

}


