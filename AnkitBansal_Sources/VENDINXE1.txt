     H OPTION(*SRCSTMT : *NODEBUGIO)
     H*DFTACTGRP(*no)
     H BNDDIR('RDB2000')

      *****************************************************************
     H* ‚Company       : Seaboard Foods
     H* ‚Function      : JD Edwards Upgrade
     H* ‚                Check  F0411 for Duplicate Vendor Invoice - replaces VENDINV-COPY
     H*                 ‚COPIED FROM E1INT1TST.QRPGLESRC.CHKSUPINV -
     H* ‚Programmer    : Rose Centonze
     H* ‚Date          : 2020/06/10
      *****************************************************************
     H* ‚Date          Changed by    Ticket    Description
     H* ‚----------    ----------    -------   -----------------------------------------------------
     H* ‚2020-06-10    R Centonze    P16169    Original version
     H* ‚2021-06-15    R Centonze    P16169    Change p_doc to p_vinv
     H* ‚
     H*                 ‚TO COMPILE: ADDLIBLE RDB50 , CRTPGMMOD  WITH INCDIR('/e1int/fp')
     H*           THEN: ‚CRTPGM PGM(E1IDEVGEN/VENDINXE1)
     H*****************************************************************
     FF55CONFIG1IF   E           K DISK
      // RDB Example program
      //
      // This program provides and example of the use of the RDB APIs
      //*******************************************************************************
      * ‚Entry parameters ....
     dVENDINXE1        PR                  extpgm('VENDINXE1')
     d @p_AN8                         8a                                        VENDOR
     d @p_VINV                       25a                                        INVOICE
     d @p_FOUND                       1a                                        POD

     dVENDINXE1        PI
     d @p_AN8                         8a                                        VENDOR
     d @p_VINV                       25a                                        INVOICE
     d @p_FOUND                       1a                                        POD


      /COPY RDB50/RDBSRC,RDBPROTO
     D Id              S             10I 0
     D rc              S             10I 0
     D @ErrId          S              7A
     D @ErrText        S            100A
     D vBatch          S              8  0 inz
     D $$DOC           S             10  0 inz
     D X_A7            S             30A   inz
     D X_A8            S             30A   inz
     D X_AN8           S              8S 0 inz
     D X_VINV          S             25A   inz
     d sFileSchema     s             30a   inz
      //
      //     Connect to the remote system using created in the RDB
      //     configuration screen (RDBCFG)
      /FREE
           setll *start F55CONFIG1;
           READ F55CONFIG1;
           Dow Not %EOF(F55CONFIG1);
           X_A7=%TRIML(%TRIMR(S2DL01));
           X_A8=%TRIML(%TRIMR(S2DL02));
           READ F55CONFIG1;
           EndDo;
           X_AN8=%int(@p_AN8);
           X_VINV=%triml(@p_VINV);
       Id = RdbConnect(X_A7);
       If Id >= 0;
         sFileSchema = '[' + %trimr(X_A8) + '].[F0411]';
         //     After the connection is established, prepare the statement.
         rc = RdbPrepStmt(Id:
             'Select * from' + %trimr(sFileSchema) +
             ' where RPAN8 = ?' +
             ' and RPVINV = ?');
         rc = RdbSetNum(Id: 1: X_AN8);
         rc = RdbSetStr(Id: 2: X_VINV);
         rc = RdbPrepExec(Id);
         //     Fetch the first record of the result set that was generated with the
         //     previously executed statement.
         rc = RdbFetchNxt(Id);
          //  Load the local variables from the remote server.  The get type must match
          // the remote type and the local variable.
         dow  rc >= 0;
           @p_FOUND='1';                                                        //|Get a number
           rc = RdbFetchNxt(Id);
         enddo;
       EndIf;
         //
         //-------------------------------
         // Free the Statement
         //-------------------------------
           RdbFreeStmt(id);
         //
         //     Close the connection to the remote system.
         RdbClose(Id);
       //
       *Inlr = *On;
      /END-FREE

