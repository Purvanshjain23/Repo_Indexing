// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PPV7PFR
// ?Date: 14.08.2025 Time: 12:06:42
// ?------------------------------------------------------------------------------------------------

//?USER: Record selection processing

// PGM.*Record selected = CND.*YES
PGM.*Record_selected = 'Y';

// WRK.Actual Shipped Date = CON.1060101
WRK.Actual_Shipped_Date = 1060101;

// LCL.Actual Shipped Date = CON.1061231
LCL.Actual_Shipped_Date = 1061231;

// PGM.*Record selected = CND.*YES
PGM.*Record_selected = 'Y';

//?also all of the header status of a without check actual ship date
//?dont for get billing
CASE;

// IF DB1.Billing Activity Type is Not Credit Memo
IF DB1.Billing_Activity_Type = '3'/'1'/'5'/'4';

//?Must be PC and either Available, or Confirmed
CASE;

// IF DB1.OH TF Exempt Code is Pre-Commencement
IF DB1.OH_TF_Exempt_Code = 'PC';

// AND DB1.Header Status is Available
AND DB1.Header_Status = 'A';

//?Must be PC and either Available, or Confirmed
// IF DB1.OH TF Exempt Code is Pre-Commencement
IF DB1.OH_TF_Exempt_Code = 'PC';

// AND DB1.Header Status is Confirmed
AND DB1.Header_Status = 'R';

//?Must be PC and either Available, or Confirmed
// IF *OTHERWISE
IF *OTHERWISE;

// PGM.*Record selected = CND.*NO
PGM.*Record_selected = 'N';

ENDIF;

//?Check on Actual shipped Date on the Confirmed orders & rec sel yes
CASE;

// IF PGM.*Record selected is *YES
IF PGM.*Record_selected = 'Y';

// AND DB1.Header Status is Confirmed
AND DB1.Header_Status = 'R';

CASE;

// IF DB1.Actual Shipped Date GE WRK.Actual Shipped Date
IF DB1.Actual_Shipped_Date >= WRK.Actual_Shipped_Date;

CASE;

// IF DB1.Actual Shipped Date LE LCL.Actual Shipped Date
IF DB1.Actual_Shipped_Date <= LCL.Actual_Shipped_Date;

// IF *OTHERWISE
IF *OTHERWISE;

// PGM.*Record selected = CND.*NO
PGM.*Record_selected = 'N';

ENDIF;

// IF *OTHERWISE
IF *OTHERWISE;

// PGM.*Record selected = CND.*NO
PGM.*Record_selected = 'N';

ENDIF;

ENDIF;

// IF *OTHERWISE
IF *OTHERWISE;

// PGM.*Record selected = CND.*NO
PGM.*Record_selected = 'N';

ENDIF;

//?USER: Print required level headings

CASE;

IF NEW Company_Number;
// SUPPRESSED PRINT Company Number header format

ENDIF;

//?USER: On print of detail format

CASE;

// IF PGM.*Record selected is *NO
IF PGM.*Record_selected = 'N';

// PGM.*Print format = CND.Do not print format
PGM.*Print_format = 'N';

QUIT;

// IF *OTHERWISE
IF *OTHERWISE;

// Call program Rtv Cust Tf Exempt    XF.
CALL PROGRAM(Rtv Cust Tf Exempt    XF) ('PPSMXFR');
PARAMETER(CUR.Ship_To_Customer);
PARAMETER(LCL.Customer_TF_Exempt_Code);

// PGM.*Print format = CND.Print format
PGM.*Print_format = 'Y';

ENDIF;

//?PRTOBJ calls after print of detail format

//?Embedded PRTOBJ : PRT ORDDTL TFEXEMPT   PO
CASE;

// IF PGM.*Record selected is *NO
IF PGM.*Record_selected = 'N';

QUIT;

ENDIF;

EXECUTE FUNCTION(PRT ORDDTL TFEXEMPT   PO) TYPE(PRTOBJ);
PARAMETER(CUR.Company_Number);
PARAMETER(CUR.Order_Number);
PARAMETER(CUR.OH_TF_Exempt_Code);
PARAMETER(LCL.Customer_TF_Exempt_Code);
PARAMETER('N');

//?USER: Print required level totals

// SUPPRESSED PRINT Company Number totals format

