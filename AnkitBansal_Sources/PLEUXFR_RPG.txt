     H/TITLE Exc Upl Crt PrimalScl XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* OPTION(*SRCDBG) CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISPJAKH
     H* Date          : 09/19/24  Time  : 08:43:52
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPLARCPL3IF  E           K        DISK
      * RTV : Cold Scale UPL            fifo to allow duplicates
      *
     FPKCPCPLGIF  E           K        DISK
      * RSQ : Eval Trans UPL            Co/Trolley/Kill Date
      *
     FPKA1CPLAIF  E           K        DISK
      * RSQ : Tattoo Header             Co/Kill/Tattoo Active
      *
     FPKCPCPLHIF  E           K        DISK
      * RSQ : Eval Trans UPL            Co/Kill Date/RU Date/Tm
      *
     FPKCPCPLKIF  E           K        DISK
      * RSQ : Eval Trans UPL            Co/Kill Date/RU Date/Tm(
      *
     FPKDLCPL0IF  E           K        DISK                      A
      * UPD : Primal Scale Detail       Update index
      *
      * Long constants
     E                    @CN#    1  35  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@ARCPK6
      * Cold Scale UPL            fifo to allow duplicates
      * Renamed input format fields
     I              ARA2VN                          WAA2VN
     I              ARM2CD                          WAM2CD
     I              ARM3CD                          WAM3CD
     I              ARM4CD                          WAM4CD
     I              ARYLNB                          WAYLNB
     I              ARM5CD                          WAM5CD
     I              ARFKCD                          WAFKCD
     I              ARM6CD                          WAM6CD
     I              ARPUST                          WAPUST
      *
     I@CPCPK1
      * Eval Trans UPL            Co/Trolley/Kill Date
      * Renamed input format fields
     I              CPHKST                          WBHKST
     I              CPB7DT                          WBB7DT
     I              CPKINB                          WBKINB
     I              CPKHNB                          WBKHNB
     I              CPLNNB                          WBLNNB
     I              CPHLST                          WBHLST
     I              CPKJNB                          WBKJNB
     I              CPKKNB                          WBKKNB
     I              CPBQPC                          WBBQPC
     I              CPBRPC                          WBBRPC
     I              CPHMST                          WBHMST
     I              CPHNST                          WBHNST
     I              CPHTST                          WBHTST
     I              CPHUST                          WBHUST
     I              CPX6NB                          WBX6NB
     I              CPFQPC                          WBFQPC
     I              CPFRPC                          WBFRPC
     I              CPM7CD                          WBM7CD
     I              CPX7ST                          WBX7ST
     I              CPX8ST                          WBX8ST
     I              CPX9ST                          WBX9ST
     I              CPYAST                          WBYAST
     I              CPYBST                          WBYBST
     I              CPYCST                          WBYCST
     I              CPZJST                          WBZJST
     I              CPZKST                          WBZKST
     I              CPZLST                          WBZLST
     I              CPB8DT                          WBB8DT
     I              CPAOTM                          WBAOTM
      *
     I@A1CPL0
      * Tattoo Header             Co/Kill/Tattoo Active
      * Renamed input format fields
     I              A1HMNB                          WCHMNB
     I              A1BNNB                          WCBNNB
     I              A1BONB                          WCBONB
     I              A1CVNB                          WCCVNB
     I              A1B0DT                          WCB0DT
     I              A1AWDT                          WCAWDT
     I              A1BICD                          WCBICD
     I              A1CPST                          WCCPST
     I              A1ACPR                          WCACPR
     I              A1B9PR                          WCB9PR
     I              A1CAPR                          WCCAPR
     I              A1C4ST                          WCC4ST
     I              A1AIPR                          WCAIPR
     I              A1A6DT                          WCA6DT
     I              A1C2ST                          WCC2ST
     I              A1CXNB                          WCCXNB
     I              A1CWNB                          WCCWNB
     I              A1FCNB                          WCFCNB
     I              A1H9NB                          WCH9NB
     I              A1FDNB                          WCFDNB
     I              A1FENB                          WCFENB
     I              A1HENB                          WCHENB
     I              A1HFNB                          WCHFNB
     I              A1CYNB                          WCCYNB
     I              A1LRNB                          WCLRNB
     I              A1E0NB                          WCE0NB
     I              A1A5PC                          WCA5PC
     I              A1FBNB                          WCFBNB
     I              A1A4PC                          WCA4PC
     I              A1F7NB                          WCF7NB
     I              A1HDNB                          WCHDNB
     I              A1F5NB                          WCF5NB
     I              A1F4NB                          WCF4NB
     I              A1F3NB                          WCF3NB
     I              A1F2NB                          WCF2NB
     I              A1AVPC                          WCAVPC
     I              A1AWPC                          WCAWPC
     I              A1CWPC                          WCCWPC
     I              A1A8PC                          WCA8PC
     I              A1A7PC                          WCA7PC
     I              A1B8PR                          WCB8PR
     I              A1AMPR                          WCAMPR
     I              A1ANPR                          WCANPR
     I              A1AYVA                          WCAYVA
     I              A1AWVA                          WCAWVA
     I              A1AOPR                          WCAOPR
     I              A1AXVA                          WCAXVA
     I              A1APPR                          WCAPPR
     I              A1ASPR                          WCASPR
     I              A1A4VA                          WCA4VA
     I              A1ATPR                          WCATPR
     I              A1A5VA                          WCA5VA
     I              A1CBPR                          WCCBPR
     I              A1CCPR                          WCCCPR
     I              A1LPNB                          WCLPNB
     I              A1CDPR                          WCCDPR
     I              A1A7VA                          WCA7VA
     I              A1A2PR                          WCA2PR
     I              A1JWST                          WCJWST
     I              A1CWST                          WCCWST
     I              A1D7ST                          WCD7ST
     I              A1D8ST                          WCD8ST
     I              A1DWST                          WCDWST
     I              A1D6ST                          WCD6ST
     I              A1GHNB                          WCGHNB
     I              A1BYDT                          WCBYDT
     I              A1E0ST                          WCE0ST
     I              A1E1ST                          WCE1ST
     I              A1E2ST                          WCE2ST
     I              A1BSDT                          WCBSDT
     I              A1BTDT                          WCBTDT
     I              A1BUDT                          WCBUDT
     I              A1HGNB                          WCHGNB
     I              A1HHNB                          WCHHNB
     I              A1HINB                          WCHINB
     I              A1A3PR                          WCA3PR
     I              A1A4PR                          WCA4PR
     I              A1A6PR                          WCA6PR
     I              A1J9NB                          WCJ9NB
     I              A1D6PR                          WCD6PR
     I              A1D7PR                          WCD7PR
     I              A1D8PR                          WCD8PR
     I              A1D9PR                          WCD9PR
     I              A1EAPR                          WCEAPR
     I              A1EBPR                          WCEBPR
     I              A1ECPR                          WCECPR
     I              A1EDPR                          WCEDPR
     I              A1EEPR                          WCEEPR
     I              A1EFPR                          WCEFPR
     I              A1EGPR                          WCEGPR
     I              A1EHPR                          WCEHPR
     I              A1KAST                          WCKAST
     I              A1J7ST                          WCJ7ST
     I              A1J9ST                          WCJ9ST
     I              A1OXNB                          WCOXNB
     I              A1LKST                          WCLKST
     I              A1LLST                          WCLLST
     I              A1J8ST                          WCJ8ST
     I              A1LIST                          WCLIST
     I              A1LJST                          WCLJST
     I              A1NZTX                          WCNZTX
     I              A1HJCD                          WCHJCD
     I              A1R4ST                          WCR4ST
     I              A1R5ST                          WCR5ST
     I              A1R6ST                          WCR6ST
     I              A1R7ST                          WCR7ST
     I              A1THWT                          WCTHWT
     I              A1T2WT                          WCT2WT
     I              A1THHD                          WCTHHD
     I              A1T2HD                          WCT2HD
     I              A1OBPR                          WCOBPR
     I              A1KOER                          WCKOER
     I              A1OPIR                          WCOPIR
     I              A1OPEM                          WCOPEM
     I              A1IORP                          WCIORP
     I              A1OWEO                          WCOWEO
     I              A1OQET                          WCOQET
     I              A1URST                          WCURST
     I              A1USST                          WCUSST
     I              A1HHPC                          WCHHPC
     I              A1S9PR                          WCS9PR
     I              A1TAPR                          WCTAPR
     I              A1TBPR                          WCTBPR
     I              A1JFUR                          WCJFUR
     I              A1KRIF                          WCKRIF
     I              A1KORF                          WCKORF
     I              A1KAPR                          WCKAPR
     I              A1KROT                          WCKROT
     I              A1OTJG                          WCOTJG
     I              A1IRJG                          WCIRJG
     I              A1IMJF                          WCIMJF
     I              A1IRGF                          WCIRGF
     I              A1KRJF                          WCKRJF
     I              A1OJRF                          WCOJRF
     I              A1KFOR                          WCKFOR
     I              A1ORJK                          WCORJK
     I              A1OMVJ                          WCOMVJ
     I              A1MVNF                          WCMVNF
     I              A1MCNF                          WCMCNF
     I              A1NCNF                          WCNCNF
     I              A1NCHF                          WCNCHF
     I              A1IGIR                          WCIGIR
     I              A1KFJR                          WCKFJR
     I              A1EADT                          WCEADT
     I              A1EBDT                          WCEBDT
     I              A1ECDT                          WCECDT
     I              A1EDDT                          WCEDDT
     I              A1EEDT                          WCEEDT
     I              A1U4ST                          WCU4ST
     I              A1U5ST                          WCU5ST
     I              A1U6ST                          WCU6ST
     I              A1U7ST                          WCU7ST
     I              A1U8ST                          WCU8ST
     I              A1U9ST                          WCU9ST
     I              A1VAST                          WCVAST
     I              A1VBST                          WCVBST
     I              A1BDCD                          WCBDCD
     I              A1CSCD                          WCCSCD
     I              A1ABCD                          WCABCD
     I              A1AECD                          WCAECD
     I              A1ACCD                          WCACCD
     I              A1AGCD                          WCAGCD
     I              A1BECD                          WCBECD
     I              A1AAVN                          WCAAVN
     I              A1AADT                          WCAADT
     I              A1AMTM                          WCAMTM
     I              A1AJST                          WCAJST
     I              A1AHVN                          WCAHVN
     I              A1AGVN                          WCAGVN
     I              A1ABVN                          WCABVN
     I              A1ABDT                          WCABDT
     I              A1ABTM                          WCABTM
      *
     I@CPCPO6
      * Eval Trans UPL            Co/Kill Date/RU Date/Tm
      * Renamed input format fields
     I              CPHKST                          WDHKST
     I              CPB7DT                          WDB7DT
     I              CPKINB                          WDKINB
     I              CPKHNB                          WDKHNB
     I              CPLNNB                          WDLNNB
     I              CPHLST                          WDHLST
     I              CPKJNB                          WDKJNB
     I              CPKKNB                          WDKKNB
     I              CPBQPC                          WDBQPC
     I              CPBRPC                          WDBRPC
     I              CPHMST                          WDHMST
     I              CPHNST                          WDHNST
     I              CPHTST                          WDHTST
     I              CPHUST                          WDHUST
     I              CPX6NB                          WDX6NB
     I              CPFQPC                          WDFQPC
     I              CPFRPC                          WDFRPC
     I              CPM7CD                          WDM7CD
     I              CPX7ST                          WDX7ST
     I              CPX8ST                          WDX8ST
     I              CPX9ST                          WDX9ST
     I              CPYAST                          WDYAST
     I              CPYBST                          WDYBST
     I              CPYCST                          WDYCST
     I              CPZJST                          WDZJST
     I              CPZKST                          WDZKST
     I              CPZLST                          WDZLST
     I              CPB8DT                          WDB8DT
     I              CPAOTM                          WDAOTM
      *
     I@CPCPO7
      * Eval Trans UPL            Co/Kill Date/RU Date/Tm(
      * Renamed input format fields
     I              CPHKST                          WEHKST
     I              CPB7DT                          WEB7DT
     I              CPKINB                          WEKINB
     I              CPKHNB                          WEKHNB
     I              CPLNNB                          WELNNB
     I              CPHLST                          WEHLST
     I              CPKJNB                          WEKJNB
     I              CPKKNB                          WEKKNB
     I              CPBQPC                          WEBQPC
     I              CPBRPC                          WEBRPC
     I              CPHMST                          WEHMST
     I              CPHNST                          WEHNST
     I              CPHTST                          WEHTST
     I              CPHUST                          WEHUST
     I              CPX6NB                          WEX6NB
     I              CPFQPC                          WEFQPC
     I              CPFRPC                          WEFRPC
     I              CPM7CD                          WEM7CD
     I              CPX7ST                          WEX7ST
     I              CPX8ST                          WEX8ST
     I              CPX9ST                          WEX9ST
     I              CPYAST                          WEYAST
     I              CPYBST                          WEYBST
     I              CPYCST                          WEYCST
     I              CPZJST                          WEZJST
     I              CPZKST                          WEZKST
     I              CPZLST                          WEZLST
     I              CPB8DT                          WEB8DT
     I              CPAOTM                          WEAOTM
      *
     I@DLCPUI
      * Primal Scale Detail       Update index
      * Renamed input format fields
     I              DLHONB                          WFHONB
     I              DLYSNB                          WFYSNB
     I              DLCZDT                          WFCZDT
     I              DLAQTM                          WFAQTM
     I              DLYZNB                          WFYZNB
     I              DLYUNB                          WFYUNB
     I              DLYWNB                          WFYWNB
     I              DLYXNB                          WFYXNB
     I              DLPWST                          WFPWST
     I              DLM9CD                          WFM9CD
     I              DLAAVN                          WFAAVN
     I              DLAADT                          WFAADT
     I              DLAMTM                          WFAMTM
     I              DLAJST                          WFAJST
     I              DLAHVN                          WFAHVN
     I              DLAGVN                          WFAGVN
     I              DLABVN                          WFABVN
     I              DLABDT                          WFABDT
     I              DLABTM                          WFABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IQPKDL1    E DSPKDLCPL0
      * UPD : Primal Scale Detail       Update index
      * Renamed input format fields
     I              DLHONB                          WFHONB
     I              DLYSNB                          WFYSNB
     I              DLCZDT                          WFCZDT
     I              DLAQTM                          WFAQTM
     I              DLYZNB                          WFYZNB
     I              DLYUNB                          WFYUNB
     I              DLYWNB                          WFYWNB
     I              DLYXNB                          WFYXNB
     I              DLPWST                          WFPWST
     I              DLM9CD                          WFM9CD
     I              DLAAVN                          WFAAVN
     I              DLAADT                          WFAADT
     I              DLAMTM                          WFAMTM
     I              DLAJST                          WFAJST
     I              DLAHVN                          WFAHVN
     I              DLAGVN                          WFAGVN
     I              DLABVN                          WFABVN
     I              DLABDT                          WFABDT
     I              DLABTM                          WFABTM
      *
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * N :  Oms Warehouse Code
     I                                        1   3 P1J8NB
      * N :  CC Company Number
     I                                    P   4   50P1HONB
      * N :  Oms Application Code
     I                                        6  11 P1C7CD
     IP2PARM      DS
      * N :  Date USR
     I                                    P   1   40P2B5DT
     IP3PARM      DS
      * N :  Date 2 USR
     I                                    P   1   40P3CVDT
     IP4PARM      DS
      * N :  Production Date UPL
     I                                    P   1   50P4SYTX
      * Submit job processing data structures.
     I#SRQS       DS                           3000
     I                                        1   1 #SDMY1
     I#SSTR       DS                           3000
     I                                        1   1 #SDMY2
     I#SWRK       DS                           3000
     I                                        1   1 #SDMY3
     I#SMRG       DS                            256
     I                                        1   1 #SDMY4
     I            DS
     I I            'CMD(CALL PGM('           1  13 #SCLL
     I I            'PARM('                  14  18 #SPRM
     I I            ')'                      19  19 #SPRN
     I I            '          '             20  29 #SPRG
      * Submit job command strings.
     I            DS
     I I            'SBMJOB     JOB(PRODT-    1 256 #S0001
     I              'RACE)               '
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Clrpfm File'
      * @OBJECT NAME
     I                                        1  10 ZA0001
      * Job Name
     I                                       11  20 ZA0002
      * Message data for 'Primal Cold Scale Upl'
      * Date USR
     I                                    P   1   40ZA0003
      * CC Company Number
     I                                    P   5   60ZA0004
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Exc Upl Crt PrimalScl XF
      * JJH 01/23/19 E14409 - Save the PLARCPP file into PRKFSAVF before
      *     clearing the file.
      * RMC 06/01/04  Read Vande Berg Cold Scale upload and create Primal
      * RMC 10/26/04  & Kick off the Product Trace Tattoo match job
      * RMC 05/18/06  use tattoo on rcd for St Jo
      * RMC 11/15/07  use trolley tracking for St Jo too per Dan Norman
      * RMC 07/11/08  S00321 when getting tattoo from Eval Trans Upl, if
      *    valid, then get the next Eval Trans Upl rcd per Co/Kill/Ru dat
      *    if not found for date, get prev tattoo per RU Time
      * RMC 01/18/10  dont cpyf plarcpp to save file for Tf
      * RMC 10/27/11 C1787  For 960 -  the weight doesnt have the decimal
      *    so expect it as '01798' instead of '179.8'
      * RMC 12/13/17 S12202 For 440 -  the weight doesnt have the decimal
      *    so expect it as '01798' instead of '179.8' -- like TFs
      * H16853 ISE 11/05/2020 - Recompiled due to change in Buy Order Num
      * PIO 04/16/24 CHANGED FILE NAME FROM PKCPCPLI TO PKCPCPLK
      * Val Application/User  XF - STR Order Management Sys  * 
     C                     CALL 'PDGXXFR'              90  Val Application
     C                     PARM *BLANK    W0RTN   7
     C           WUJ8NB    PARM *BLANK    WQ0001  3        Oms Warehouse C
     C           P1HONB    PARM *ZERO     WQ0002  30       CC Company Numb
     C                     PARM 'HPE'     WQ0003  6        Oms Application
     C           WUC8CD    PARM *BLANK    WQ0004  3        Oms SalesPerson
     C           WUG8ST    PARM *BLANK    WQ0005  1        Oms Allow Multi
     C           WUG9ST    PARM *BLANK    WQ0006 10        Oms Default Pri
     C           WUEUTX    PARM *BLANK    WQ0007 30        Oms Name
     C           WUEVTX    PARM *BLANK    WQ0008 40        Oms System Valu
     C           WUHAST    PARM *BLANK    WQ0009  1        Oms Access Deni
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Rtv Crt Primal Scl Dt RT - Cold Scale UPL  * 
     C                     EXSR SARVGN
      * 4/03/02   BUILD EXPORT LOIN WEIGHT RANGE SUMMARY FOR THE CUT DATE
      * CASE: PAR.Date USR is NE 0
     C           P2B5DT    IFNE 0                          *IF
      * Susan look at this with a debug
      * Rtv Loin Range Count  XF - Primal Scale Detail  * 
     C                     CALL 'PKYMXFR'              90  Rtv Loin Range
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P2B5DT    WQ0020  70       Production Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKYMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * CASE: PAR.Date 2 USR is NE 0
     C           P3CVDT    IFNE 0                          *IF
      * Susan look at this with a debug
      * Rtv Loin Range Count  XF - Primal Scale Detail  * 
     C                     CALL 'PKYMXFR'              90  Rtv Loin Range
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P3CVDT    WQ0021  70       Production Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKYMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * SBMJOB: Ext Prod Trace Upd TT XF - STR Order Management Sys  * 
      *
     C                     MOVEL*BLANK    W0RTN
      * Build call string for processing in batch.
     C                     MOVEL#S0001    #SRQS     P
     C           #SRQS     CAT  #SCLL:1   #SRQS            Call command
     C                     MOVEL'POP7XFR '#SPRG     P      Load pgm name
     C           #SRQS     CAT  #SPRG:0   #SRQS            Add pgm name
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
      * Build parameters string.
     C           #SRQS     CAT  #SPRM:1   #SRQS            Parameters
      *
     C                     MOVELW0RTN     #SSTR     P      *Return code
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 7         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADDP4SYTX    #SPAK  309       Production Date
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 8         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *
     C           W0RTN     IFNE *BLANK
      * Build of submit job string ended in error.
     C                     MOVEL'Y2U0065' W0RTN
     C                     MOVEL'POP7XFR 'W0CLPG 10 P
      * Send message '*Error occured on SBMJOB'
     C                     MOVEL'Y2U0065' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     ELSE
      *
     C           W0SJO     IFNE *BLANK
      * Merge variable submit job overrides.
     C                     CALL 'Y2MGRQR'              90  *
     C                     PARM #SRQS     #SWRK
     C                     PARM W0SJO     #SMRG
     C  N90                MOVEL#SWRK     #SRQS     P
     C                     MOVE *BLANK    W0SJO
     C                     END
      * Submit request.
     C                     CALL 'Y2CMEXC'              90  *
     C                     PARM           #SRQS
     C                     PARM 3000      #SRQL  155
     C                     PARM           W0JVN  10
     C                     PARM           W0JUN  10
     C                     PARM           W0JNB   6
     C                     END
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POP7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * E14409 JJH 01/23/19 - SAVF PLARCPP into PRKFSAVF/PLARxxx
      * CPYF PLARCPP to PRKFSAV before CLRPFM
      * CASE: JOB.*USER is PorkISTesting
     C           ##USR     IFEQ @CN,006                    *IF
     C           ##USR     OREQ @CN,007
     C           ##USR     OREQ @CN,008
     C           ##USR     OREQ @CN,009
     C           ##USR     OREQ @CN,010
     C           ##USR     OREQ @CN,011
     C           ##USR     OREQ @CN,012
     C           ##USR     OREQ @CN,013
     C           ##USR     OREQ @CN,014
     C           ##USR     OREQ @CN,015
     C           ##USR     OREQ @CN,016
     C           ##USR     OREQ @CN,017
     C           ##USR     OREQ @CN,018
     C           ##USR     OREQ @CN,019
     C           ##USR     OREQ @CN,020
     C           ##USR     OREQ @CN,021
     C           ##USR     OREQ @CN,022
     C           ##USR     OREQ @CN,023
     C           ##USR     OREQ @CN,024
     C           ##USR     OREQ @CN,025
     C           ##USR     OREQ @CN,026
     C           ##USR     OREQ @CN,027
     C           ##USR     OREQ @CN,028
     C           ##USR     OREQ @CN,029
     C           ##USR     OREQ @CN,030
     C           ##USR     OREQ @CN,031
     C           ##USR     OREQ @CN,032
      * Do not copy PLARCPP to PRKFSAV
     C                     ELSE
      * CASE: *OTHERWISE
      * Cpy Cold Scale UPL    XF - Cold Scale UPL  * 
     C                     CALL 'PWIGXFR'              90  Cpy Cold Scale
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0022  30       CC Company Numb
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWIGXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Setup message data for message
     C                     MOVEL@CN,033   ZA0001           @OBJECT NAME
     C                     MOVEL@CN,034   ZA0002           Job Name
      *
      * Execute message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2EXMCC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0481' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN   7
     C                     END
      *
     C           W0RTN     IFNE *BLANK
      * Error detected during execution
     C                     SETON                     99    *
     C                     END
      *
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0023  30       BOH Company Num
     C                     PARM @CN,035   WQ0024 10        Company Value C
     C           WUAKVN    PARM *BLANK    WQ0025 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Setup message data for message
      * Convert *Job date to display format
      * Convert date
     C           1000000   ADD  ##JDT     XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0003
     C                     Z-ADDP1HONB    ZA0004           CC Company Numb
      * Retrieve message Primal Cold Scale Upl
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1122' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           WUKGTX    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Snd Pager Msg (MPLUS) UP - STR Order Management Sys  * 
     C                     CALL 'POMSUPC'              90  Snd Pager Msg (
     C                     PARM WUAKVN    WQ0026 10        Office Dist Lis
     C                     PARM WUKGTX    WQ0027132        Office Dist Mes
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMSUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Crt Primal Scl Dt RT - Cold Scale UPL  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  2        PSA Scale ID
     C                     Z-ADD*ZERO     WN0002  70       PSA Cut Date
     C                     Z-ADD*ZERO     WN0003  60       PSA Cut Time
     C                     Z-ADD*ZERO     WN0004  50       PSA Sequence
     C                     Z-ADD*ZERO     WN0005  50       PSA Count
     C                     Z-ADD*ZERO     WN0006  41       PSA Weight
     C                     Z-ADD*ZERO     WN0007  50       PSA Tattoo
     C                     MOVEL*BLANK    WN0008  1        PSA Shift
     C                     MOVEL*BLANK    WN0009  6        PSA Trolley Id
     C                     MOVEL*BLANK    WN0010 10        RS User Changed
     C                     Z-ADD*ZERO     WN0011  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0012  60       RS Time Changed
     C                     MOVEL*BLANK    WN0013  1        RS Record Statu
     C                     MOVEL*BLANK    WN0014 10        RS Job
     C                     MOVEL*BLANK    WN0015 10        RS Program
     C                     MOVEL*BLANK    WN0016 10        RS User Added
     C                     Z-ADD*ZERO     WN0017  70       RS Date Added
     C                     Z-ADD*ZERO     WN0018  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Rtv Last Prd/Shft OMS XF - STR Order Management Sys  * 
     C                     CALL 'POVEXFR'              90  Rtv Last Prd/Sh
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0010  30       Company Number
     C           YL0001    PARM *ZERO     WQ0011  70       Date USR
     C           YL0002    PARM *BLANK    WQ0012  1        KP Shift
     C                     PARM 'PM'      WQ0013  2        Production Upl
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POVEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Establish starting position
     C           *LOVAL    SETLL@ARCPK6                    *
     C                     READ @ARCPK6                  90*
      * Data record not found
     C   90                MOVEL'PRK1110' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Check Numeric
     C                     EXSR UASUBR                     Check Numeric
      * Setup/Create Detail Record From Cold Scale Upl
      * CASE: WRK.Error Type Found is Critical Error
     C           WUGYST    IFEQ 'Y'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWAYLNB    WN0001           PSA Scale ID
      * Default a 00 scale id to 07
      * CASE: DB1.CS Scale ID is eq 00
     C           WAYLNB    IFEQ '00'                       *IF
     C                     MOVEL'46'      WN0001           PSA Scale ID
     C                     END                             *FI
     C                     MOVE WAM2CD    WUTANB           Date Num 6 Usr
     C                     MOVEL*BLANK    WUPSTX           End date USR
     C                     MOVELWUTANB    WUPSTX           End date USR
     C                     Z-ADD*ZERO     ZQ      50
     C           '1'       CAT  WUPSTX:ZQ WUCZCD    P      Date Alpha USR
     C                     MOVE WUCZCD    WN0002           PSA Cut Date
     C                     MOVE WAM3CD    WN0003           PSA Cut Time
     C                     ADD  1         WN0004           PSA Sequence
     C                     MOVE WAM4CD    WN0005           PSA Count
      * Grab weight when dec point sent (360) and not sent (960,440)
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.CC Company Number is Triumph Foods Market
      *   |- c2    : PAR.CC Company Number is Sioux City
      *   '-
     C           P1HONB    IFEQ 960                        *IF
     C           P1HONB    OREQ 440                        *OR
      * sent as '01798'
     C                     Z-ADD3         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00005
     C           ZQ        ORGT 00005
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWAFKCD:ZQ WUFPCD    P  90  Text 3 USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * sent as '179.8'
     C                     Z-ADD3         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00005
     C           ZQ        ORGT 00005
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWAFKCD:ZQ WUFPCD    P  90  Text 3 USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     END                             *FI
     C                     MOVE WUFPCD    WUNSNB           Carcass number
     C                     Z-ADD1         YRSW00
     C                     Z-ADD5         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00005
     C           ZQ        ORGT 00005
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWAFKCD:ZQ WUFQCD    P  90  Text 1 USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     WUFMCD           Number 1 USR
     C                     MOVE WUFQCD    WUFMCD           Number 1 USR
      * PSA Weight
      * PAR.PSA Weight =
      *    *COMPUTE (x1 + (x2 / x3))
      * x1    : WRK.Carcass number        USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : WRK.Number 1 USR
      * /     : PGM.*Synon (17,7) work field *
      * x3    : CON.10
     C           WUFMCD    DIV  10        W0WD01           *Synon (17,7) w
     C           WUNSNB    ADD  W0WD01    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0006           PSA Weight
     C                     MOVELWAM6CD    WN0009           PSA Trolley Id
      * CASE: PAR.CC Company Number is SBD Farms of Guymon, Ok
     C           P1HONB    IFEQ 360                        *IF
      * **** Get tattoo from Eval Trans Upl per Trolley/Kill dt
      * Rtv Prev Kill Date    XF - STR Order Management Sys  * 
     C                     CALL 'PDRUXFR'              90  Rtv Prev Kill D
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0014  30       BOH Company Num
     C                     PARM WN0002    WQ0015  70       Cut Date
     C           P2B5DT    PARM *ZERO     WQ0016  70       Date USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDRUXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Rtv Tattoo f/trolley  RT - Eval Trans UPL  * 
     C                     EXSR SBRVGN
      * ****
     C                     ELSE
      * CASE: *OTHERWISE
      * RMC 11/15/07 Tf changed to Trolley Tracking per Dan Norman
      * **** Get tattoo from Eval Trans Upl per Trolley/Kill dt
      * Rtv Prev Kill Date    XF - STR Order Management Sys  * 
     C                     CALL 'PDRUXFR'              90  Rtv Prev Kill D
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0017  30       BOH Company Num
     C                     PARM WN0002    WQ0018  70       Cut Date
     C           P2B5DT    PARM *ZERO     WQ0019  70       Date USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDRUXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Rtv Tattoo f/trolley  RT - Eval Trans UPL  * 
     C                     EXSR SHRVGN
     C                     END                             *FI
     C                     MOVELWAPUST    WN0008           PSA Shift
      * Crt Primal Scale Dtl  CR - Primal Scale Detail  * 
     C                     EXSR SNCRRC
      * 4/10/02 -- Save the cut dates for creating the Primal Summary
      * CASE: PAR.Date USR is Eq 0
     C           P2B5DT    IFEQ 0                          *IF
     C                     Z-ADDWN0002    P2B5DT           Date USR
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.PSA Cut Date NE PAR.Date USR
     C           WN0002    IFNE P2B5DT                     *IF
     C                     Z-ADDWN0002    P3CVDT           Date 2 USR
     C                     END                             *FI
     C                     END                             *FI
      * 10/27/04 -- Save the earliest cut date for positioning prod trace
      * CASE: PAR.Production Date UPL is Zero
     C           P4SYTX    IFEQ 0                          *IF
     C                     MOVE WAM2CD    P4SYTX           Production Date
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WAM2CD    WUSYTX           Production Date
      * CASE: WRK.Production Date UPL LT PAR.Production Date UPL
     C           WUSYTX    IFLT P4SYTX                     *IF
     C                     Z-ADDWUSYTX    P4SYTX           Production Date
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     READ @ARCPK6                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Tattoo f/trolley  RT - Eval Trans UPL  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WN0007           EA Tattoo Numbe
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHKST    WQSB01           EA Company Numb
     C           *LIKE     DEFN WBM7CD    WQSB02           EA Trolley Id
      * Define keylist
     C           KPSSB     KLIST
     C                     KFLD           WQSB01           EA Company Numb
     C                     KFLD           WQSB02           EA Trolley Id
     C                     KFLD           WBB7DT           EA Kill Date
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           EA Company Numb
     C                     KFLD           WQSB02           EA Trolley Id
      * Setup key
     C                     Z-ADDP1HONB    WQSB01           EA Company Numb
     C                     MOVELWAM6CD    WQSB02           EA Trolley Id
     C                     Z-ADDP2B5DT    WBB7DT           EA Kill Date
      * Establish starting position
     C           KPSSB     SETLL@CPCPK1                    *
     C           KRSSB     READE@CPCPK1                  90*
      * Data record not found
     C   90                MOVEL'PRK0341' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Look for a match on trolley id going back only 2 days.
      * CASE: DB1.EA Kill Date NE PAR.EA Kill Date
     C           WBB7DT    IFNE P2B5DT                     *IF
      * WRK.Days USR = DB1.EA Kill Date - PAR.EA Kill Date *DAYS
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111110' XDCDW   7
     C                     EXSR XDOWS
     C           P2B5DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           WBB7DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     WUCPA1
     C                     ELSE
     C           XDURR     MULT -1        WUCPA1
     C                     END
      * CASE: WRK.Days USR is GT 2
     C           WUCPA1    IFGT 2                          *IF
     C                     GOTO SBEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * S00321 RMC 7/11/08 If tattoo found within 2 days, validate it.
      * Rtv Val Ttt,Kll Dt    RT - Tattoo Header  * 
     C                     EXSR SCRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,005                    *IF
      * S00321 RMC 7/11/08
      * if its not valid, get next Eval Trans Upl rcd per RU Date/Time
      * Rtv Tattoo f/RU Dt/Tm RT - Eval Trans UPL  * 
     C                     EXSR SDRVGN
      * CASE: LCL.EA Tattoo Number is Not found
     C           YL0003    IFEQ 0                          *IF
      * if one later isnt found, get prev Eval Trans Upl rcd per RU Time
      * Rtv Tattoo f/RU DtTmD RT - Eval Trans UPL  * 
     C                     EXSR SFRVGN
     C                     END                             *FI
     C                     Z-ADDYL0003    WN0007           EA Tattoo Numbe
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWBKHNB    WN0007           EA Tattoo Numbe
     C                     END                             *FI
     C                     GOTO SBEXIT                     *QUIT
     C           KRSSB     READE@CPCPK1                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Val Ttt,Kll Dt    RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQSC01           BOH Company Num
     C           *LIKE     DEFN WCB0DT    WQSC02           TH Kill Date
     C           *LIKE     DEFN WCCVNB    WQSC03           TH Tattoo Numbe
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           BOH Company Num
     C                     KFLD           WQSC02           TH Kill Date
     C                     KFLD           WQSC03           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWBHKST    WQSC01           BOH Company Num
     C                     Z-ADDWBB7DT    WQSC02           TH Kill Date
     C                     Z-ADDWBKHNB    WQSC03           TH Tattoo Numbe
      * Establish starting position
     C           KRSSC     SETLL@A1CPL0                    *
     C           KRSSC     READE@A1CPL0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Tattoo f/RU Dt/Tm RT - Eval Trans UPL  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     YL0003           EA Tattoo Numbe
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDHKST    WQSD01           EA Company Numb
     C           *LIKE     DEFN WDB7DT    WQSD02           EA Kill Date
      * Define keylist
     C           KPSSD     KLIST
     C                     KFLD           WQSD01           EA Company Numb
     C                     KFLD           WQSD02           EA Kill Date
     C                     KFLD           WDB8DT           RU Date
     C                     KFLD           WDAOTM           RU Time
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           EA Company Numb
     C                     KFLD           WQSD02           EA Kill Date
      * Setup key
     C                     Z-ADDWBHKST    WQSD01           EA Company Numb
     C                     Z-ADDWBB7DT    WQSD02           EA Kill Date
     C                     Z-ADDWBB8DT    WDB8DT           RU Date
     C                     Z-ADDWBAOTM    WDAOTM           RU Time
      * Establish starting position
     C           KPSSD     SETLL@CPCPO6                    *
     C           KRSSD     READE@CPCPO6                  90*
      * Data record not found
     C   90                MOVEL'PRK0341' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * S00321 RMC new -- Validate tattoo number - quit when valid
      * Rtv Val Ttt,Kll Dt    RT - Tattoo Header  * 
     C                     EXSR SERVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,005                    *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWDKHNB    YL0003           EA Tattoo Numbe
     C                     GOTO SDEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSD     READE@CPCPO6                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Val Ttt,Kll Dt    RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQSE01           BOH Company Num
     C           *LIKE     DEFN WCB0DT    WQSE02           TH Kill Date
     C           *LIKE     DEFN WCCVNB    WQSE03           TH Tattoo Numbe
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           BOH Company Num
     C                     KFLD           WQSE02           TH Kill Date
     C                     KFLD           WQSE03           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWDHKST    WQSE01           BOH Company Num
     C                     Z-ADDWDB7DT    WQSE02           TH Kill Date
     C                     Z-ADDWDKHNB    WQSE03           TH Tattoo Numbe
      * Establish starting position
     C           KRSSE     SETLL@A1CPL0                    *
     C           KRSSE     READE@A1CPL0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Tattoo f/RU DtTmD RT - Eval Trans UPL  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * get prev ru date/time rcd
     C                     Z-ADD*ZERO     YL0003           EA Tattoo Numbe
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEHKST    WQSF01           EA Company Numb
     C           *LIKE     DEFN WEB7DT    WQSF02           EA Kill Date
      * Define keylist
     C           KPSSF     KLIST
     C                     KFLD           WQSF01           EA Company Numb
     C                     KFLD           WQSF02           EA Kill Date
     C                     KFLD           WEB8DT           RU Date
     C                     KFLD           WEAOTM           RU Time
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           EA Company Numb
     C                     KFLD           WQSF02           EA Kill Date
      * Setup key
     C                     Z-ADDWBHKST    WQSF01           EA Company Numb
     C                     Z-ADDWBB7DT    WQSF02           EA Kill Date
     C                     Z-ADDWBB8DT    WEB8DT           RU Date
     C                     Z-ADDWBAOTM    WEAOTM           RU Time
      * Establish starting position
     C           KPSSF     SETLL@CPCPO7                    *
     C           KRSSF     READE@CPCPO7                  90*
      * Data record not found
     C   90                MOVEL'PRK0341' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * S00321 RMC new -- Validate tattoo number - quit when valid
      * Rtv Val Ttt,Kll Dt    RT - Tattoo Header  * 
     C                     EXSR SGRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,005                    *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWEKHNB    YL0003           EA Tattoo Numbe
     C                     GOTO SFEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSF     READE@CPCPO7                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Val Ttt,Kll Dt    RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQSG01           BOH Company Num
     C           *LIKE     DEFN WCB0DT    WQSG02           TH Kill Date
     C           *LIKE     DEFN WCCVNB    WQSG03           TH Tattoo Numbe
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           BOH Company Num
     C                     KFLD           WQSG02           TH Kill Date
     C                     KFLD           WQSG03           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWEHKST    WQSG01           BOH Company Num
     C                     Z-ADDWEB7DT    WQSG02           TH Kill Date
     C                     Z-ADDWEKHNB    WQSG03           TH Tattoo Numbe
      * Establish starting position
     C           KRSSG     SETLL@A1CPL0                    *
     C           KRSSG     READE@A1CPL0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Tattoo f/trolley  RT - Eval Trans UPL  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WN0007           EA Tattoo Numbe
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHKST    WQSH01           EA Company Numb
     C           *LIKE     DEFN WBM7CD    WQSH02           EA Trolley Id
      * Define keylist
     C           KPSSH     KLIST
     C                     KFLD           WQSH01           EA Company Numb
     C                     KFLD           WQSH02           EA Trolley Id
     C                     KFLD           WBB7DT           EA Kill Date
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           EA Company Numb
     C                     KFLD           WQSH02           EA Trolley Id
      * Setup key
     C                     Z-ADDP1HONB    WQSH01           EA Company Numb
     C                     MOVELWAM6CD    WQSH02           EA Trolley Id
     C                     Z-ADDP2B5DT    WBB7DT           EA Kill Date
      * Establish starting position
     C           KPSSH     SETLL@CPCPK1                    *
     C           KRSSH     READE@CPCPK1                  90*
      * Data record not found
     C   90                MOVEL'PRK0341' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Look for a match on trolley id going back only 2 days.
      * CASE: DB1.EA Kill Date NE PAR.EA Kill Date
     C           WBB7DT    IFNE P2B5DT                     *IF
      * WRK.Days USR = DB1.EA Kill Date - PAR.EA Kill Date *DAYS
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111110' XDCDW   7
     C                     EXSR XDOWS
     C           P2B5DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           WBB7DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     WUCPA1
     C                     ELSE
     C           XDURR     MULT -1        WUCPA1
     C                     END
      * CASE: WRK.Days USR is GT 2
     C           WUCPA1    IFGT 2                          *IF
     C                     GOTO SHEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * S00321 RMC 7/11/08 If tattoo found within 2 days, validate it.
      * Rtv Val Ttt,Kll Dt    RT - Tattoo Header  * 
     C                     EXSR SIRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,005                    *IF
      * S00321 RMC 7/11/08
      * if its not valid, get next Eval Trans Upl rcd per RU Date/Time
      * Rtv Tattoo f/RU Dt/Tm RT - Eval Trans UPL  * 
     C                     EXSR SJRVGN
      * CASE: LCL.EA Tattoo Number is Not found
     C           YL0003    IFEQ 0                          *IF
      * if one later isnt found, get prev Eval Trans Upl rcd per RU Time
      * Rtv Tattoo f/RU DtTmD RT - Eval Trans UPL  * 
     C                     EXSR SLRVGN
     C                     END                             *FI
     C                     Z-ADDYL0003    WN0007           EA Tattoo Numbe
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWBKHNB    WN0007           EA Tattoo Numbe
     C                     END                             *FI
     C                     GOTO SHEXIT                     *QUIT
     C           KRSSH     READE@CPCPK1                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Val Ttt,Kll Dt    RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQSI01           BOH Company Num
     C           *LIKE     DEFN WCB0DT    WQSI02           TH Kill Date
     C           *LIKE     DEFN WCCVNB    WQSI03           TH Tattoo Numbe
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           BOH Company Num
     C                     KFLD           WQSI02           TH Kill Date
     C                     KFLD           WQSI03           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWBHKST    WQSI01           BOH Company Num
     C                     Z-ADDWBB7DT    WQSI02           TH Kill Date
     C                     Z-ADDWBKHNB    WQSI03           TH Tattoo Numbe
      * Establish starting position
     C           KRSSI     SETLL@A1CPL0                    *
     C           KRSSI     READE@A1CPL0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Tattoo f/RU Dt/Tm RT - Eval Trans UPL  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     YL0003           EA Tattoo Numbe
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDHKST    WQSJ01           EA Company Numb
     C           *LIKE     DEFN WDB7DT    WQSJ02           EA Kill Date
      * Define keylist
     C           KPSSJ     KLIST
     C                     KFLD           WQSJ01           EA Company Numb
     C                     KFLD           WQSJ02           EA Kill Date
     C                     KFLD           WDB8DT           RU Date
     C                     KFLD           WDAOTM           RU Time
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           EA Company Numb
     C                     KFLD           WQSJ02           EA Kill Date
      * Setup key
     C                     Z-ADDWBHKST    WQSJ01           EA Company Numb
     C                     Z-ADDWBB7DT    WQSJ02           EA Kill Date
     C                     Z-ADDWBB8DT    WDB8DT           RU Date
     C                     Z-ADDWBAOTM    WDAOTM           RU Time
      * Establish starting position
     C           KPSSJ     SETLL@CPCPO6                    *
     C           KRSSJ     READE@CPCPO6                  90*
      * Data record not found
     C   90                MOVEL'PRK0341' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * S00321 RMC new -- Validate tattoo number - quit when valid
      * Rtv Val Ttt,Kll Dt    RT - Tattoo Header  * 
     C                     EXSR SKRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,005                    *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWDKHNB    YL0003           EA Tattoo Numbe
     C                     GOTO SJEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSJ     READE@CPCPO6                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Val Ttt,Kll Dt    RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQSK01           BOH Company Num
     C           *LIKE     DEFN WCB0DT    WQSK02           TH Kill Date
     C           *LIKE     DEFN WCCVNB    WQSK03           TH Tattoo Numbe
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           BOH Company Num
     C                     KFLD           WQSK02           TH Kill Date
     C                     KFLD           WQSK03           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWDHKST    WQSK01           BOH Company Num
     C                     Z-ADDWDB7DT    WQSK02           TH Kill Date
     C                     Z-ADDWDKHNB    WQSK03           TH Tattoo Numbe
      * Establish starting position
     C           KRSSK     SETLL@A1CPL0                    *
     C           KRSSK     READE@A1CPL0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Tattoo f/RU DtTmD RT - Eval Trans UPL  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * get prev ru date/time rcd
     C                     Z-ADD*ZERO     YL0003           EA Tattoo Numbe
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEHKST    WQSL01           EA Company Numb
     C           *LIKE     DEFN WEB7DT    WQSL02           EA Kill Date
      * Define keylist
     C           KPSSL     KLIST
     C                     KFLD           WQSL01           EA Company Numb
     C                     KFLD           WQSL02           EA Kill Date
     C                     KFLD           WEB8DT           RU Date
     C                     KFLD           WEAOTM           RU Time
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           EA Company Numb
     C                     KFLD           WQSL02           EA Kill Date
      * Setup key
     C                     Z-ADDWBHKST    WQSL01           EA Company Numb
     C                     Z-ADDWBB7DT    WQSL02           EA Kill Date
     C                     Z-ADDWBB8DT    WEB8DT           RU Date
     C                     Z-ADDWBAOTM    WEAOTM           RU Time
      * Establish starting position
     C           KPSSL     SETLL@CPCPO7                    *
     C           KRSSL     READE@CPCPO7                  90*
      * Data record not found
     C   90                MOVEL'PRK0341' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * S00321 RMC new -- Validate tattoo number - quit when valid
      * Rtv Val Ttt,Kll Dt    RT - Tattoo Header  * 
     C                     EXSR SMRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,005                    *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWEKHNB    YL0003           EA Tattoo Numbe
     C                     GOTO SLEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSL     READE@CPCPO7                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Val Ttt,Kll Dt    RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQSM01           BOH Company Num
     C           *LIKE     DEFN WCB0DT    WQSM02           TH Kill Date
     C           *LIKE     DEFN WCCVNB    WQSM03           TH Tattoo Numbe
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           BOH Company Num
     C                     KFLD           WQSM02           TH Kill Date
     C                     KFLD           WQSM03           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWEHKST    WQSM01           BOH Company Num
     C                     Z-ADDWEB7DT    WQSM02           TH Kill Date
     C                     Z-ADDWEKHNB    WQSM03           TH Tattoo Numbe
      * Establish starting position
     C           KRSSM     SETLL@A1CPL0                    *
     C           KRSSM     READE@A1CPL0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SMEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNCRRC    BEGSR
      *================================================================
      * Crt Primal Scale Dtl  CR - Primal Scale Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DLCPUI
     C                     Z-ADDP1HONB    WFHONB           CC Company Numb
     C                     MOVELWN0001    WFYSNB           PSA Scale ID
     C                     Z-ADDWN0002    WFCZDT           PSA Cut Date
     C                     Z-ADDWN0003    WFAQTM           PSA Cut Time
     C                     Z-ADDWN0004    WFYZNB           PSA Sequence
     C                     Z-ADDWN0005    WFYUNB           PSA Count
     C                     Z-ADDWN0006    WFYWNB           PSA Weight
     C                     Z-ADDWN0007    WFYXNB           PSA Tattoo
     C                     MOVELWN0008    WFPWST           PSA Shift
     C                     MOVELWN0009    WFM9CD           PSA Trolley Id
     C                     MOVELWN0010    WFAAVN           RS User Changed
     C                     Z-ADDWN0011    WFAADT           RS Date Changed
     C                     Z-ADDWN0012    WFAMTM           RS Time Changed
     C                     MOVELWN0013    WFAJST           RS Record Statu
     C                     MOVELWN0014    WFAHVN           RS Job
     C                     MOVELWN0015    WFAGVN           RS Program
     C                     MOVELWN0016    WFABVN           RS User Added
     C                     Z-ADDWN0017    WFABDT           RS Date Added
     C                     Z-ADDWN0018    WFABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WFAJST           RS Record Statu
     C                     MOVEL##USR     WFABVN           RS User Added
     C                     Z-ADD##JDT     WFABDT           RS Date Added
     C                     Z-ADD##JTM     WFABTM           RS Time Added
     C                     MOVEL##PGM     WFAGVN           RS Program
     C                     MOVEL##JOB     WFAHVN           RS Job
     C           KLCRSN    KLIST
     C                     KFLD           WFHONB           CC Company Numb
     C                     KFLD           WFYSNB           PSA Scale ID
     C                     KFLD           WFCZDT           PSA Cut Date
     C                     KFLD           WFAQTM           PSA Cut Time
     C                     KFLD           WFYZNB           PSA Sequence
      * Check for duplicate primary key
     C           KLCRSN    SETLL@DLCPUI                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0623' W0RTN   7
      * Send message 'Primal Scale Detail    EX'
     C                     MOVEL'PRK0623' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C                     WRITE@DLCPUI                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Check Numeric
      *================================================================
     C                     MOVEL'N'       WUGYST           Error Type Foun
     C                     MOVELWAM4CD    WUKPTX           Text 5
      * RPG Testn for 5 pos   US - STR User Source Functions  * 
     C                     TESTN          WUKPTX  5  60
     C           *IN60     IFEQ '0'
     C                     MOVE 'ERROR  ' WULMST
     C                     ELSE
     C                     MOVE '       ' WULMST
     C                     END
      * Count
      * CASE: WRK.Return Code USR is Error Found
     C           WULMST    IFEQ 'ERROR'                    *IF
     C                     MOVEL'Y'       WUGYST           Error Type Foun
     C                     END                             *FI
     C                     MOVELWAYLNB    WUFRCD           Text 2 USR
      * RPG Testn for 2 pos   US - STR User Source Functions  * 
     C                     TESTN          WUFRCD  2  60
     C           *IN60     IFEQ '0'
     C                     MOVE 'ERROR  ' WULMST
     C                     ELSE
     C                     MOVE '       ' WULMST
     C                     END
      * Scale Id
      * CASE: WRK.Return Code USR is Error Found
     C           WULMST    IFEQ 'ERROR'                    *IF
     C                     MOVEL'Y'       WUGYST           Error Type Foun
     C                     END                             *FI
     C                     Z-ADD3         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00005
     C           ZQ        ORGT 00005
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWAFKCD:ZQ WUFPCD    P  90  Text 3 USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD1         YRSW00
     C                     Z-ADD5         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00005
     C           ZQ        ORGT 00005
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWAFKCD:ZQ WUFQCD    P  90  Text 1 USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * Weight
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Text 3 USR is Numeric
      *   |- c2    : WRK.Text 1 USR is Numeric
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUFPCD    IFGE '000'                      *IF
     C           WUFPCD    ANDLE'999'
     C           WUFQCD    IFGE '0'                        *IF
     C           WUFQCD    ANDLE'9'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUGYST           Error Type Foun
     C                     END                             *FI
      * Calendar date
      * CASE: DB1.CS Calendar Date is Numeric
     C           WAA2VN    IFGE @CN,001                    *IF
     C           WAA2VN    ANDLE@CN,002
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUGYST           Error Type Foun
     C                     END                             *FI
      * Business date
      * CASE: DB1.CS Date is Numeric
     C           WAM2CD    IFGE @CN,001                    *IF
     C           WAM2CD    ANDLE@CN,002
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUGYST           Error Type Foun
     C                     END                             *FI
      * Time
      * CASE: DB1.CS Time is Numeric
     C           WAM3CD    IFGE @CN,003                    *IF
     C           WAM3CD    ANDLE@CN,004
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUGYST           Error Type Foun
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDUDY     BEGSR
      *================================================================
      * Calculate duration, *DAYS
      *================================================================
     C           XDAY1     IFLT 1
     C           XDAY2     ORLT 1
     C                     Z-ADD0         XDURR
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     GOTO XDUDYE
     C                     END
     C           XDAY1     IFGE XDAY2
      * From date2 to date1
     C                     Z-ADDXDAY2     XABEG   60
     C                     Z-ADDXDAY1     XAEND   60
     C                     ELSE
      * From date1 to date2
     C                     Z-ADDXDAY1     XABEG   60
     C                     Z-ADDXDAY2     XAEND   60
     C                     END
     C           XDWSL     IFEQ 0
      * None days of week selected
     C                     Z-ADD0         XDURR
     C                     GOTO XDUDYC
     C                     END
     C           XAEND     SUB  XABEG     XDURR   80
     C           XDWSL     IFEQ 7
      * All days of week selected
     C                     GOTO XDUDYC
     C                     END
      * Some days of week selected
     C                     DIV  7         XDURR
     C                     MVR            XDLSW   10
     C                     MULT XDWSL     XDURR
     C           XDLSW     IFNE 0
      * Determine day of week of the beginning date
     C           XABEG     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
      * Loop: Increment the date by the last week
     C           XDLSW     DOWGT0
      * Increment the day of week
     C                     ADD  1         YY
     C                     SUB  1         XDLSW
      * Put day of week into the range 1-7
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     END
      * Selected day of the last week has been processed
     C           YDOW,YY   IFEQ XDSEL
      * Increment duration
     C                     ADD  1         XDURR
     C                     END
      * End of loop
     C                     END
     C                     END
     C           XDUDYC    TAG
     C           XDURR     IFEQ 0
      * Return Code: Unable to calculate duration
     C                     MOVEL'Y2U0060' W0RTN   7
     C                     ELSE
     C                     MOVEL*BLANK    W0RTN   7
     C                     END
      *================================================================
     CSR         XDUDYE    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1J8NB           Oms Warehouse C
     C                     Z-ADD*ZERO     P1HONB           CC Company Numb
     C                     MOVEL*BLANK    P1C7CD           Oms Application
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P2B5DT           Date USR
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P3CVDT           Date 2 USR
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P4SYTX           Production Date
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Oms Warehouse Code
     C                     MOVEL*BLANK    WUJ8NB  3
      * Define work field Oms SalesPerson Code
     C                     MOVEL*BLANK    WUC8CD  3
      * Define work field Oms Allow Multi-Company
     C                     MOVEL*BLANK    WUG8ST  1
      * Define work field Oms Default Printer
     C                     MOVEL*BLANK    WUG9ST 10
      * Define work field Oms Name
     C                     MOVEL*BLANK    WUEUTX 30
      * Define work field Oms System Value Alpha
     C                     MOVEL*BLANK    WUEVTX 40
      * Define work field Oms Access Denied (Y/N)
     C                     MOVEL*BLANK    WUHAST  1
      * Initialize renamed input format fields
      * Define work field Error Type Found
     C                     MOVEL*BLANK    WUGYST  1
      * Define work field Text 5                USR
     C                     MOVEL*BLANK    WUKPTX  5
      * Define work field Return Code USR
     C                     MOVEL*BLANK    WULMST  7
      * Define work field Text 2 USR
     C                     MOVEL*BLANK    WUFRCD  2
      * Define work field Text 3 USR
     C                     MOVEL*BLANK    WUFPCD  3
      * Define work field Text 1 USR
     C                     MOVEL*BLANK    WUFQCD  1
      * Define work field Date Num 6 Usr
     C                     Z-ADD*ZERO     WUTANB  60
      * Define work field End date USR
     C                     MOVEL*BLANK    WUPSTX  6
      * Define work field Date Alpha USR
     C                     MOVEL*BLANK    WUCZCD  7
      * Define work field Carcass number        USR
     C                     Z-ADD*ZERO     WUNSNB  30
      * Define work field Number 1 USR
     C                     Z-ADD*ZERO     WUFMCD  20
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBHKST           EA Company Numb
     C                     Z-ADD*ZERO     WBB7DT           EA Kill Date
     C                     Z-ADD*ZERO     WBKINB           EA Scale Sequen
     C                     Z-ADD*ZERO     WBKHNB           EA Tattoo Numbe
     C                     Z-ADD*ZERO     WBLNNB           EA Lot
     C                     Z-ADD*ZERO     WBKJNB           EA Hot Weight
     C                     Z-ADD*ZERO     WBKKNB           EA Backfat Thic
     C                     Z-ADD*ZERO     WBBQPC           EA Loin Eye Dep
     C                     Z-ADD*ZERO     WBBRPC           EA Light Reflec
     C                     Z-ADD*ZERO     WBX6NB           EA Backfat MM
     C                     Z-ADD*ZERO     WBFQPC           EA LoinEye MM
     C                     Z-ADD*ZERO     WBFRPC           EA Light Refl M
     C                     Z-ADD*ZERO     WBB8DT           RU Date
     C                     Z-ADD*ZERO     WBAOTM           RU Time
      * Define work field Days USR
     C                     Z-ADD*ZERO     WUCPA1  50
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WCBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WCBONB           BOL Load Number
     C                     Z-ADD*ZERO     WCCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WCB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WCAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WCACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WCB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WCCAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WCAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WCA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WCCXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WCCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WCFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WCH9NB           TH Held Over
     C                     Z-ADD*ZERO     WCFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WCFENB           TH Head Killed
     C                     Z-ADD*ZERO     WCHENB           TH Head Adds
     C                     Z-ADD*ZERO     WCHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WCCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WCLRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WCE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WCA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WCFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WCA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WCF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WCHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WCF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WCF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WCF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WCF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WCAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WCAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WCCWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WCA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WCA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WCB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WCAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WCANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WCAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WCAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WCAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WCAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WCAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WCASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WCA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WCATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WCA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WCCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WCCCPR           Th Payment Net
     C                     Z-ADD*ZERO     WCLPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WCCDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WCA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WCA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WCGHNB           TH Commission A
     C                     Z-ADD*ZERO     WCBYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WCBSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WCBTDT           TH Commission P
     C                     Z-ADD*ZERO     WCBUDT           TH Actual Check
     C                     Z-ADD*ZERO     WCHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WCHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WCHINB           TH FFLI
     C                     Z-ADD*ZERO     WCA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WCA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WCA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WCJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WCD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WCD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WCD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WCD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WCEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WCEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WCECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WCEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WCEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WCEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WCEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WCEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WCOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WCTHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WCT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WCTHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WCT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WCOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WCKOER           TH Head Identif
     C                     Z-ADD*ZERO     WCOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WCOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WCIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WCOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WCHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WCS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WCTAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WCTBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WCJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WCKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WCKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WCKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WCKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WCOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WCIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WCIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WCIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WCKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WCOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WCKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WCORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WCOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WCMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WCMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WCNCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WCNCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WCIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WCKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WCEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WCEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WCECDT           TH Head LFT
     C                     Z-ADD*ZERO     WCEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WCEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFHONB           CC Company Numb
     C                     Z-ADD*ZERO     WFCZDT           PSA Cut Date
     C                     Z-ADD*ZERO     WFAQTM           PSA Cut Time
     C                     Z-ADD*ZERO     WFYZNB           PSA Sequence
     C                     Z-ADD*ZERO     WFYUNB           PSA Count
     C                     Z-ADD*ZERO     WFYWNB           PSA Weight
     C                     Z-ADD*ZERO     WFYXNB           PSA Tattoo
     C                     Z-ADD*ZERO     WFAADT           RS Date Changed
     C                     Z-ADD*ZERO     WFAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WFABDT           RS Date Added
     C                     Z-ADD*ZERO     WFABTM           RS Time Added
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Production Date UPL
     C                     Z-ADD*ZERO     WUSYTX  80
      * Define work field Office Dist List USR
     C                     MOVEL*BLANK    WUAKVN 10
      * Define work field Office Dist Message USR
     C                     MOVEL*BLANK    WUKGTX132
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL@CN,1     @CN,1
     C                     MOVEL'N'       W0PMT   1
      *
     C                     MOVEL*BLANK    W0SJO 132        *Sbmjob overrid
      * Define local work field Production Date
     C                     Z-ADD*ZERO     YL0001  70
      * Define local work field KP Shift
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field EA Tattoo Number
     C                     Z-ADD*ZERO     YL0003  50
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 00000000
00002 99999999
00003 000000
00004 999999
00005 Y2U0005
00006 PRKTEST
00007 ISPPATE
00008 ISSMASO
00009 ISRCENT
00010 ISPURVAP
00011 ISROSEM
00012 ISSHARONZ
00013 ISSZURN
00014 ISJHIGH
00015 ISJBADE
00016 ISJAMESB
00017 ISDNGUY
00018 ISDANNYN
00019 PRKTESTGU
00020 PRKTESTST
00021 PRKTESTTF
00022 TPMTEST
00023 TFTST961
00024 ISSUSANM
00025 ISJULIUSH
00026 ISBGUTI
00027 ISBARBG
00028 ISBBARK
00029 ISNFOY
00030 ISNATHANF
00031 ISDREDD
00032 ISABANS
00033 PLARCPP
00034 CLRPKDJ
00035 PRKPRMUP
