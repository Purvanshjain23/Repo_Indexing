// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PLU3XFR
// ?Date: 14.08.2025 Time: 02:55:31
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?Modifications
//?11/05/2020 ISE H16853 - Recompiled due to change in Buy Order Number
// WRK.ER Company Number = CVTVAR(PAR.Company Number Alpha Usr)
WRK.ER_Company_Number = CVTVAR(PAR.Company_Number_Alpha_Usr);

EXECUTE FUNCTION(Rtv Chg Eval TrUpl ErpRT) TYPE(RTVOBJ) FILE(PLBUCPP)           AB1320649;
PARAMETER(WRK.ER_Company_Number);
{
 //?USER: Process Data record

 // LCL.Erp Sp Producer/Text = CON.*BLANK
 LCL.Erp_Sp_Producer_Text = *BLANK;

 // LCL.Erp Hot Wgt Description = CON.*BLANK
 LCL.Erp_Hot_Wgt_Description = *BLANK;

 // LCL.PD Producer Code = CON.*BLANK
 LCL.PD_Producer_Code = *BLANK;

 // LCL.PL Location Code = CON.*BLANK
 LCL.PL_Location_Code = *BLANK;

 EXECUTE FUNCTION(Val Tto/KlDt ExistErp RT) TYPE(RTVOBJ) FILE(PKA1CPP)           AB1320753;
 PARAMETER(DB1.ER_Company_Number);
 PARAMETER(DB1.ER_Tattoo_Number);
 PARAMETER(DB1.ER_Kill_Date);
 PARAMETER(LCL.PD_Producer_Code);
 PARAMETER(LCL.PL_Location_Code);
 PARAMETER(LCL.Erp_Sp_Producer_Erp_Code);
 PARAMETER(LCL.Erp_Sp_Producer_Text);
 {
  //?USER: Processing if Data record not found

  // PAR.PD Producer Code = CON.*BLANK
  PAR.PD_Producer_Code = *BLANK;

  // PAR.PL Location Code = CON.*BLANK
  PAR.PL_Location_Code = *BLANK;

  // PAR.Erp Sp Producer/Text = CON.*BLANK
  PAR.Erp_Sp_Producer_Text = *BLANK;

  //?Get the text for the invalid tattoo numbers
  // LCL.Erp Sp Producer Erp Code = CVTVAR(CND.Invalid Tattoo)
  LCL.Erp_Sp_Producer_Erp_Code = CVTVAR('INVTAT');

  // Call program Rtv Erp Sp Producer PoXP.
  CALL PROGRAM(Rtv Erp Sp Producer PoXP) ('PLUUXFR');
  PARAMETER(PAR.BOH_Company_Number);
  PARAMETER(LCL.Erp_Sp_Producer_Erp_Code);
  PARAMETER(PAR.Erp_Sp_Producer_Text);
  PARAMETER(WRK.Return_Code_USR);

  //?USER: Process Data record

  // PAR.PD Producer Code = DB1.PD Producer Code
  PAR.PD_Producer_Code = DB1.PD_Producer_Code;

  // PAR.PL Location Code = DB1.PL Location Code
  PAR.PL_Location_Code = DB1.PL_Location_Code;

  // PAR.Erp Sp Producer/Text = CON.*BLANK
  PAR.Erp_Sp_Producer_Text = *BLANK;

  CASE;

  // IF DB1.TH Source Type is Internal
  IF DB1.TH_Source_Type = 'I';

  //?SEABOARD ONLY
  // Call program Rtv Erp Sp Producer PoXP.
  CALL PROGRAM(Rtv Erp Sp Producer PoXP) ('PLUUXFR');
  PARAMETER(DB1.BOH_Company_Number);
  PARAMETER(DB1.PD_Producer_Code);
  PARAMETER(PAR.Erp_Sp_Producer_Text);
  PARAMETER(WRK.Return_Code_USR);

  // IF PAR.BOH Company Number is SBD Farms of Guymon, Ok
  IF PAR.BOH_Company_Number = 360;

  //?Guymon EXTERNAL producers
  // Call program Rtv Erp Sp Producer PoXP.
  CALL PROGRAM(Rtv Erp Sp Producer PoXP) ('PLUUXFR');
  PARAMETER(PAR.BOH_Company_Number);
  PARAMETER(DB1.PD_Producer_Code);
  PARAMETER(PAR.Erp_Sp_Producer_Text);
  PARAMETER(WRK.Return_Code_USR);

  CASE;

  // IF WRK.Return Code USR is *Record does not exist
  IF WRK.Return_Code_USR = 'Y2U0005';

  //?Get the text for the other external producers
  // LCL.Erp Sp Producer Erp Code = CND.OTHER
  LCL.Erp_Sp_Producer_Erp_Code = 'OTHER';

  // Call program Rtv Erp Sp Producer PoXP.
  CALL PROGRAM(Rtv Erp Sp Producer PoXP) ('PLUUXFR');
  PARAMETER(PAR.BOH_Company_Number);
  PARAMETER(LCL.Erp_Sp_Producer_Erp_Code);
  PARAMETER(PAR.Erp_Sp_Producer_Text);
  PARAMETER(WRK.Return_Code_USR);

  ENDIF;

  // IF *OTHERWISE
  IF *OTHERWISE;

  // Call program Rtv Erp Sp Producer PoXP.
  CALL PROGRAM(Rtv Erp Sp Producer PoXP) ('PLUUXFR');
  PARAMETER(PAR.BOH_Company_Number);
  PARAMETER('ALLPRD');
  PARAMETER(PAR.Erp_Sp_Producer_Text);
  PARAMETER(WRK.Return_Code_USR);

  ENDIF;

 }

 // Call program Rtv Erp Hog Hot Wgt RgXF.
 CALL PROGRAM(Rtv Erp Hog Hot Wgt RgXF) ('PLUTXFR');
 PARAMETER(DB1.ER_Hot_Weight);
 PARAMETER(LCL.Erp_Hot_Wgt_Description);

 // LCL.ER HOTRGS WGT Group = DB1.ER Hot Weight * CON.1 *
 LCL.ER_HOTRGS_WGT_Group = DB1.ER_Hot_Weight * 1;

 // Call program Zzz/CHG Eval UplErp   XP.
 CALL PROGRAM(Zzz/CHG Eval UplErp   XP) ('PLU4XFR');
 PARAMETER(DB1.ER_Company_Number);
 PARAMETER(DB1.ER_Kill_Date);
 PARAMETER(DB1.ER_Scale_Sequence_Number);
 PARAMETER(DB1.ER_Tattoo_Number);
 PARAMETER(DB1.ER_Hot_Weight);
 PARAMETER(DB1.ER_Record_Processed);
 PARAMETER(DB1.ER_Backfat_MM);
 PARAMETER(DB1.ER_LoinEye_MM);
 PARAMETER(DB1.ER_Light_Refl_MM);
 PARAMETER(DB1.ER_Trolley_Id);
 PARAMETER(DB1.ER_Broken_Back_Sts);
 PARAMETER(DB1.ER_Unused_Sts_1);
 PARAMETER(DB1.ER_Unused_Sts_2);
 PARAMETER(DB1.ER_Unused_Sts_3);
 PARAMETER(DB1.ER_Unused_Sts_4);
 PARAMETER(DB1.ER_Unused_Sts_5);
 PARAMETER(DB1.RU_Date);
 PARAMETER(DB1.RU_Time);
 PARAMETER(LCL.Erp_Sp_Producer_Text);
 PARAMETER(LCL.Erp_Hot_Wgt_Description);
 PARAMETER(LCL.ER_HOTRGS_WGT_Group);
 PARAMETER(LCL.PD_Producer_Code);
 PARAMETER(LCL.PL_Location_Code);
 PARAMETER(*MISSING);
 PARAMETER(*MISSING);
 PARAMETER(*MISSING);
 PARAMETER(*MISSING);
 PARAMETER(*MISSING);
 PARAMETER(DB1.RS_User_Changed);
 PARAMETER(DB1.RS_Date_Changed);
 PARAMETER(DB1.RS_Time_Changed);
 PARAMETER(DB1.RS_Record_Status);
 PARAMETER(DB1.RS_Job);
 PARAMETER(DB1.RS_Program);
 PARAMETER(DB1.RS_User_Added);
 PARAMETER(DB1.RS_Date_Added);
 PARAMETER(DB1.RS_Time_Added);

}


