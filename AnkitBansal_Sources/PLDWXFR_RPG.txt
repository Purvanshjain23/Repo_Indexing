     H/TITLE Exc Kill to Cut Tm OMS XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 12/17/20  Time  : 01:21:18
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKA1CPLAIF  E           K        DISK
      * RSQ : Tattoo Header             Co/Kill/Tattoo Active
      *
     FPKFDCPL1IF  E           K        DISK
      * RTV : Export Rate HPE Summary   Retrieval index
      *
     FPKFDCPL0UF  E           K        DISK
      * UPD : Export Rate HPE Summary   Update index
      *
     E                    YDOW        7  1               *Days of week
     I@A1CPL0
      * Tattoo Header             Co/Kill/Tattoo Active
      * Renamed input format fields
     I              A1HMNB                          WAHMNB
     I              A1BNNB                          WABNNB
     I              A1BONB                          WABONB
     I              A1CVNB                          WACVNB
     I              A1B0DT                          WAB0DT
     I              A1AWDT                          WAAWDT
     I              A1BICD                          WABICD
     I              A1CPST                          WACPST
     I              A1ACPR                          WAACPR
     I              A1B9PR                          WAB9PR
     I              A1CAPR                          WACAPR
     I              A1C4ST                          WAC4ST
     I              A1AIPR                          WAAIPR
     I              A1A6DT                          WAA6DT
     I              A1C2ST                          WAC2ST
     I              A1CXNB                          WACXNB
     I              A1CWNB                          WACWNB
     I              A1FCNB                          WAFCNB
     I              A1H9NB                          WAH9NB
     I              A1FDNB                          WAFDNB
     I              A1FENB                          WAFENB
     I              A1HENB                          WAHENB
     I              A1HFNB                          WAHFNB
     I              A1CYNB                          WACYNB
     I              A1LRNB                          WALRNB
     I              A1E0NB                          WAE0NB
     I              A1A5PC                          WAA5PC
     I              A1FBNB                          WAFBNB
     I              A1A4PC                          WAA4PC
     I              A1F7NB                          WAF7NB
     I              A1HDNB                          WAHDNB
     I              A1F5NB                          WAF5NB
     I              A1F4NB                          WAF4NB
     I              A1F3NB                          WAF3NB
     I              A1F2NB                          WAF2NB
     I              A1AVPC                          WAAVPC
     I              A1AWPC                          WAAWPC
     I              A1CWPC                          WACWPC
     I              A1A8PC                          WAA8PC
     I              A1A7PC                          WAA7PC
     I              A1B8PR                          WAB8PR
     I              A1AMPR                          WAAMPR
     I              A1ANPR                          WAANPR
     I              A1AYVA                          WAAYVA
     I              A1AWVA                          WAAWVA
     I              A1AOPR                          WAAOPR
     I              A1AXVA                          WAAXVA
     I              A1APPR                          WAAPPR
     I              A1ASPR                          WAASPR
     I              A1A4VA                          WAA4VA
     I              A1ATPR                          WAATPR
     I              A1A5VA                          WAA5VA
     I              A1CBPR                          WACBPR
     I              A1CCPR                          WACCPR
     I              A1LPNB                          WALPNB
     I              A1CDPR                          WACDPR
     I              A1A7VA                          WAA7VA
     I              A1A2PR                          WAA2PR
     I              A1JWST                          WAJWST
     I              A1CWST                          WACWST
     I              A1D7ST                          WAD7ST
     I              A1D8ST                          WAD8ST
     I              A1DWST                          WADWST
     I              A1D6ST                          WAD6ST
     I              A1GHNB                          WAGHNB
     I              A1BYDT                          WABYDT
     I              A1E0ST                          WAE0ST
     I              A1E1ST                          WAE1ST
     I              A1E2ST                          WAE2ST
     I              A1BSDT                          WABSDT
     I              A1BTDT                          WABTDT
     I              A1BUDT                          WABUDT
     I              A1HGNB                          WAHGNB
     I              A1HHNB                          WAHHNB
     I              A1HINB                          WAHINB
     I              A1A3PR                          WAA3PR
     I              A1A4PR                          WAA4PR
     I              A1A6PR                          WAA6PR
     I              A1J9NB                          WAJ9NB
     I              A1D6PR                          WAD6PR
     I              A1D7PR                          WAD7PR
     I              A1D8PR                          WAD8PR
     I              A1D9PR                          WAD9PR
     I              A1EAPR                          WAEAPR
     I              A1EBPR                          WAEBPR
     I              A1ECPR                          WAECPR
     I              A1EDPR                          WAEDPR
     I              A1EEPR                          WAEEPR
     I              A1EFPR                          WAEFPR
     I              A1EGPR                          WAEGPR
     I              A1EHPR                          WAEHPR
     I              A1KAST                          WAKAST
     I              A1J7ST                          WAJ7ST
     I              A1J9ST                          WAJ9ST
     I              A1OXNB                          WAOXNB
     I              A1LKST                          WALKST
     I              A1LLST                          WALLST
     I              A1J8ST                          WAJ8ST
     I              A1LIST                          WALIST
     I              A1LJST                          WALJST
     I              A1NZTX                          WANZTX
     I              A1HJCD                          WAHJCD
     I              A1R4ST                          WAR4ST
     I              A1R5ST                          WAR5ST
     I              A1R6ST                          WAR6ST
     I              A1R7ST                          WAR7ST
     I              A1THWT                          WATHWT
     I              A1T2WT                          WAT2WT
     I              A1THHD                          WATHHD
     I              A1T2HD                          WAT2HD
     I              A1OBPR                          WAOBPR
     I              A1KOER                          WAKOER
     I              A1OPIR                          WAOPIR
     I              A1OPEM                          WAOPEM
     I              A1IORP                          WAIORP
     I              A1OWEO                          WAOWEO
     I              A1OQET                          WAOQET
     I              A1URST                          WAURST
     I              A1USST                          WAUSST
     I              A1HHPC                          WAHHPC
     I              A1S9PR                          WAS9PR
     I              A1TAPR                          WATAPR
     I              A1TBPR                          WATBPR
     I              A1JFUR                          WAJFUR
     I              A1KRIF                          WAKRIF
     I              A1KORF                          WAKORF
     I              A1KAPR                          WAKAPR
     I              A1KROT                          WAKROT
     I              A1OTJG                          WAOTJG
     I              A1IRJG                          WAIRJG
     I              A1IMJF                          WAIMJF
     I              A1IRGF                          WAIRGF
     I              A1KRJF                          WAKRJF
     I              A1OJRF                          WAOJRF
     I              A1KFOR                          WAKFOR
     I              A1ORJK                          WAORJK
     I              A1OMVJ                          WAOMVJ
     I              A1MVNF                          WAMVNF
     I              A1MCNF                          WAMCNF
     I              A1NCNF                          WANCNF
     I              A1NCHF                          WANCHF
     I              A1IGIR                          WAIGIR
     I              A1KFJR                          WAKFJR
     I              A1EADT                          WAEADT
     I              A1EBDT                          WAEBDT
     I              A1ECDT                          WAECDT
     I              A1EDDT                          WAEDDT
     I              A1EEDT                          WAEEDT
     I              A1U4ST                          WAU4ST
     I              A1U5ST                          WAU5ST
     I              A1U6ST                          WAU6ST
     I              A1U7ST                          WAU7ST
     I              A1U8ST                          WAU8ST
     I              A1U9ST                          WAU9ST
     I              A1VAST                          WAVAST
     I              A1VBST                          WAVBST
     I              A1BDCD                          WABDCD
     I              A1CSCD                          WACSCD
     I              A1ABCD                          WAABCD
     I              A1AECD                          WAAECD
     I              A1ACCD                          WAACCD
     I              A1AGCD                          WAAGCD
     I              A1BECD                          WABECD
     I              A1AAVN                          WAAAVN
     I              A1AADT                          WAAADT
     I              A1AMTM                          WAAMTM
     I              A1AJST                          WAAJST
     I              A1AHVN                          WAAHVN
     I              A1AGVN                          WAAGVN
     I              A1ABVN                          WAABVN
     I              A1ABDT                          WAABDT
     I              A1ABTM                          WAABTM
      *
     I@FDCPG6
      * Export Rate HPE Summary   Retrieval index
      * Renamed input format fields
     I              FDHONB                          WBHONB
     I              FDB0DT                          WBB0DT
     I              FDFXA1                          WBFXA1
     I              FDFYA1                          WBFYA1
     I              FDFZA1                          WBFZA1
     I              FDG0A1                          WBG0A1
     I              FDGLA1                          WBGLA1
     I              FDF0A1                          WBF0A1
     I              FDGKA1                          WBGKA1
     I              FDF1A1                          WBF1A1
     I              FDF2A1                          WBF2A1
     I              FDF3A1                          WBF3A1
     I              FDG2A1                          WBG2A1
     I              FDGNA1                          WBGNA1
     I              FDF4A1                          WBF4A1
     I              FDGPA1                          WBGPA1
     I              FDF5A1                          WBF5A1
     I              FDGQA1                          WBGQA1
     I              FDJSA1                          WBJSA1
     I              FDF7A1                          WBF7A1
     I              FDF8A1                          WBF8A1
     I              FDF9A1                          WBF9A1
     I              FDG1A1                          WBG1A1
     I              FDGMA1                          WBGMA1
     I              FDGAA1                          WBGAA1
     I              FDGRA1                          WBGRA1
     I              FDGBA1                          WBGBA1
     I              FDGCA1                          WBGCA1
     I              FDGDA1                          WBGDA1
     I              FDG3A1                          WBG3A1
     I              FDGOA1                          WBGOA1
     I              FDGEA1                          WBGEA1
     I              FDGSA1                          WBGSA1
     I              FDGFA1                          WBGFA1
     I              FDGTA1                          WBGTA1
     I              FDJTA1                          WBJTA1
     I              FDGHA1                          WBGHA1
     I              FDGUA1                          WBGUA1
     I              FDGIA1                          WBGIA1
     I              FDGWA1                          WBGWA1
     I              FDGJA1                          WBGJA1
     I              FDGVA1                          WBGVA1
     I              FDJUA1                          WBJUA1
     I              FDEVDT                          WBEVDT
     I              FDAAVN                          WBAAVN
     I              FDAADT                          WBAADT
     I              FDAMTM                          WBAMTM
     I              FDAJST                          WBAJST
     I              FDAHVN                          WBAHVN
     I              FDAGVN                          WBAGVN
     I              FDABVN                          WBABVN
     I              FDABDT                          WBABDT
     I              FDABTM                          WBABTM
      *
     I@FDCPG5
      * Export Rate HPE Summary   Update index
      * Renamed input format fields
     I              FDHONB                          WCHONB
     I              FDB0DT                          WCB0DT
     I              FDFXA1                          WCFXA1
     I              FDFYA1                          WCFYA1
     I              FDFZA1                          WCFZA1
     I              FDG0A1                          WCG0A1
     I              FDGLA1                          WCGLA1
     I              FDF0A1                          WCF0A1
     I              FDGKA1                          WCGKA1
     I              FDF1A1                          WCF1A1
     I              FDF2A1                          WCF2A1
     I              FDF3A1                          WCF3A1
     I              FDG2A1                          WCG2A1
     I              FDGNA1                          WCGNA1
     I              FDF4A1                          WCF4A1
     I              FDGPA1                          WCGPA1
     I              FDF5A1                          WCF5A1
     I              FDGQA1                          WCGQA1
     I              FDJSA1                          WCJSA1
     I              FDF7A1                          WCF7A1
     I              FDF8A1                          WCF8A1
     I              FDF9A1                          WCF9A1
     I              FDG1A1                          WCG1A1
     I              FDGMA1                          WCGMA1
     I              FDGAA1                          WCGAA1
     I              FDGRA1                          WCGRA1
     I              FDGBA1                          WCGBA1
     I              FDGCA1                          WCGCA1
     I              FDGDA1                          WCGDA1
     I              FDG3A1                          WCG3A1
     I              FDGOA1                          WCGOA1
     I              FDGEA1                          WCGEA1
     I              FDGSA1                          WCGSA1
     I              FDGFA1                          WCGFA1
     I              FDGTA1                          WCGTA1
     I              FDJTA1                          WCJTA1
     I              FDGHA1                          WCGHA1
     I              FDGUA1                          WCGUA1
     I              FDGIA1                          WCGIA1
     I              FDGWA1                          WCGWA1
     I              FDGJA1                          WCGJA1
     I              FDGVA1                          WCGVA1
     I              FDJUA1                          WCJUA1
     I              FDEVDT                          WCEVDT
     I              FDAAVN                          WCAAVN
     I              FDAADT                          WCAADT
     I              FDAMTM                          WCAMTM
     I              FDAJST                          WCAJST
     I              FDAHVN                          WCAHVN
     I              FDAGVN                          WCAGVN
     I              FDABVN                          WCABVN
     I              FDABDT                          WCABDT
     I              FDABTM                          WCABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
      /EJECT
     IXTCK2       DS
      * Time: hours, minutes, seconds (2)
     I                                        1   60XTTIM2
     I                                        1   20XTHH2
     I                                        3   40XTNN2
     I                                        5   60XTSS2
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
     IQPKFD1    E DSPKFDCPL0
      * UPD : Export Rate HPE Summary   Update index
      * Renamed input format fields
     I              FDHONB                          WCHONB
     I              FDB0DT                          WCB0DT
     I              FDFXA1                          WCFXA1
     I              FDFYA1                          WCFYA1
     I              FDFZA1                          WCFZA1
     I              FDG0A1                          WCG0A1
     I              FDGLA1                          WCGLA1
     I              FDF0A1                          WCF0A1
     I              FDGKA1                          WCGKA1
     I              FDF1A1                          WCF1A1
     I              FDF2A1                          WCF2A1
     I              FDF3A1                          WCF3A1
     I              FDG2A1                          WCG2A1
     I              FDGNA1                          WCGNA1
     I              FDF4A1                          WCF4A1
     I              FDGPA1                          WCGPA1
     I              FDF5A1                          WCF5A1
     I              FDGQA1                          WCGQA1
     I              FDJSA1                          WCJSA1
     I              FDF7A1                          WCF7A1
     I              FDF8A1                          WCF8A1
     I              FDF9A1                          WCF9A1
     I              FDG1A1                          WCG1A1
     I              FDGMA1                          WCGMA1
     I              FDGAA1                          WCGAA1
     I              FDGRA1                          WCGRA1
     I              FDGBA1                          WCGBA1
     I              FDGCA1                          WCGCA1
     I              FDGDA1                          WCGDA1
     I              FDG3A1                          WCG3A1
     I              FDGOA1                          WCGOA1
     I              FDGEA1                          WCGEA1
     I              FDGSA1                          WCGSA1
     I              FDGFA1                          WCGFA1
     I              FDGTA1                          WCGTA1
     I              FDJTA1                          WCJTA1
     I              FDGHA1                          WCGHA1
     I              FDGUA1                          WCGUA1
     I              FDGIA1                          WCGIA1
     I              FDGWA1                          WCGWA1
     I              FDGJA1                          WCGJA1
     I              FDGVA1                          WCGVA1
     I              FDJUA1                          WCJUA1
     I              FDEVDT                          WCEVDT
     I              FDAAVN                          WCAAVN
     I              FDAADT                          WCAADT
     I              FDAMTM                          WCAMTM
     I              FDAJST                          WCAJST
     I              FDAHVN                          WCAHVN
     I              FDAGVN                          WCAGVN
     I              FDABVN                          WCABVN
     I              FDABDT                          WCABDT
     I              FDABTM                          WCABTM
      *
     IYARDCS      DS                            232
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Tattoo Header
      * I :  TH Kill Date
     I                                    P   1   40P1B0DT
      * N :  TH Hot Scl Upload Time
     I                                    P   5   80P1KORF
      * N :  TH Cold Scl Upload Date
     I                                    P   9  120P1EADT
      * N :  TH Cold Scl Upload Time
     I                                    P  13  160P1EBDT
     IP2PARM      DS
      * N :  Time Diff Usr
     I                                    P   1   40P2AWTM
     IP3PARM      DS
      * N :  Wait Time 4.0 USR
     I                                    P   1   30P3BQTM
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1B0DT    PARM           WP0001  70       TH Kill Date
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Exc Kill to Cut Tm OMS XF
      * H16853 ISE 11/05/2020-Recompiled due to change in Buy Order Numbe
      * Rtv Co for User       XF - STR Order Management Sys  * 
     C                     CALL 'PLF8XFR'              90  Rtv Co for User
     C                     PARM *BLANK    W0RTN   7
     C           WUHONB    PARM *ZERO     WQ0001  30       CC Company Numb
     C                     PARM 'HPE'     WQ0002  6        Oms Application
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLF8XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Rtv Kill Date to Cut  Rt - Tattoo Header  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Kill Date to Cut  Rt - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  40       Wait Time 4.0 U
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHMNB    WQSA01           BOH Company Num
     C           *LIKE     DEFN WAB0DT    WQSA02           TH Kill Date
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           BOH Company Num
     C                     KFLD           WQSA02           TH Kill Date
      * Setup key
     C                     Z-ADDWUHONB    WQSA01           BOH Company Num
     C                     Z-ADDP1B0DT    WQSA02           TH Kill Date
      * Establish starting position
     C           KRSSA     SETLL@A1CPL0                    *
     C           KRSSA     READE@A1CPL0                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      *
     C                     Z-ADD*ZERO     WN0002  60       Time Beg USR
     C                     Z-ADD*ZERO     WN0003  60       Time End USR
     C                     Z-ADD*ZERO     WN0004  60       Time Diff Usr
      *
      * Clc Kill to Cut Time  IF
     C                     Z-ADD*ZERO     WN0001           Wait Time 4.0 U
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.TH Hot Scl Upload Time is Entered
      *   |- c2    : PAR.TH Cold Scl Upload Time is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAKORF    IFNE 0                          *IF
     C           WAEBDT    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVE WAEBDT    WN0003           Time End USR
     C                     MOVE WAKORF    WN0002           Time Beg USR
      * CASE: PAR.TH Kill Date LT PAR.TH Cold Scl Upload Date
     C           WAB0DT    IFLT WAEADT                     *IF
      * LCL.Number 1 USR = PAR.TH Cold Scl Upload Date - PAR.TH Kill Date
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C           WAB0DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           WAEADT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     YL0001
     C                     ELSE
     C           XDURR     MULT -1        YL0001
     C                     END
     C           YL0001    MULT 240000    YL0002           Usr Elapsed hou
     C                     ADD  YL0002    WN0003           Time End USR
     C                     ELSE
      * CASE: *OTHERWISE
      * LCL.Number 1 USR = PAR.TH Kill Date - PAR.TH Cold Scl Upload Date
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C           WAEADT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           WAB0DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     YL0001
     C                     ELSE
     C           XDURR     MULT -1        YL0001
     C                     END
     C           YL0001    MULT 240000    YL0002           Usr Elapsed hou
     C                     ADD  YL0002    WN0002           Time Beg USR
     C                     END                             *FI
      * PAR.Time Diff Usr = PAR.Time End USR - PAR.Time Beg USR *HHMMSS
     C                     Z-ADDWN0002    XTTIM2
     C                     Z-ADDWN0003    XTTIM
     C                     EXSR XTCEL
     C           XTHH      MULT 100       WN0004
     C                     ADD  XTNN      WN0004
     C                     MULT 100       WN0004
     C                     ADD  XTSS      WN0004
     C                     MULT XSGN      WN0004
      * LCL.Hours USR = PAR.Time Diff Usr *HOURS
     C                     Z-ADDWN0004    XTTIM
     C                     Z-ADDXTHH      YL0003
      * LCL.Minutes USR = PAR.Time Diff Usr *MINUTES
     C                     Z-ADDWN0004    XTTIM
     C                     Z-ADDXTNN      YL0004
     C           YL0003    MULT 60        YL0005           Wait Time 4.0 U
     C           YL0005    ADD  YL0004    WN0001           Wait Time 4.0 U
     C                     END                             *FI
      * CASE: PAR.Wait Time 4.0 USR is Entered
     C           WN0001    IFNE 0                          *IF
      * CASE: DB1.TH Schedule Kill Shift is Shift 1
     C           WALIST    IFEQ '1'                        *IF
     C                     ADD  1         YL0006           Count USR
     C                     ADD  WN0001    YL0007           Minutes USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         YL0008           Count USR 2
     C                     ADD  WN0001    YL0009           Minutes USR 2
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSA     READE@A1CPL0                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: LCL.Count USR is GT Zero
     C           YL0006    IFGT 0                          *IF
     C           YL0007    DIV  YL0006    YL0010           Shift A Kill to
     C                     END                             *FI
      * CASE: LCL.Count USR 2 is Entered
     C           YL0008    IFNE 0                          *IF
     C           YL0009    DIV  YL0008    YL0011           Shift B Kill to
     C                     END                             *FI
     C           YL0007    ADD  YL0009    YL0012           Movement number
     C                     ADD  YL0008    YL0006           Count USR
      * CASE: LCL.Count USR is GT Zero
     C           YL0006    IFGT 0                          *IF
     C           YL0012    DIV  YL0006    YL0013           Total Kill to C
     C                     END                             *FI
      * Rtv Chg Kill to cut   RT - Export Rate HPE Summary  * 
     C                     EXSR SBRVGN
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Chg Kill to cut   RT - Export Rate HPE Summary  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBHONB           CC Company Numb
     C                     KFLD           WBB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDWAHMNB    WBHONB           CC Company Numb
     C                     Z-ADDWAB0DT    WBB0DT           TH Kill Date
      * Establish starting position
     C           KRSSB     CHAIN@FDCPG6              90    *
      * Data record not found
     C   90                MOVEL'PRK0996' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Exp Rate HPE Sum  CH - Export Rate HPE Summary  * 
     C                     EXSR SCCHRC
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCHRC    BEGSR
      *================================================================
      * Chg Exp Rate HPE Sum  CH - Export Rate HPE Summary  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0005 10        RS User Changed
     C                     Z-ADD*ZERO     WN0006  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0007  60       RS Time Changed
     C                     MOVEL*BLANK    WN0008  1        RS Record Statu
     C                     MOVEL*BLANK    WN0009 10        RS Job
     C                     MOVEL*BLANK    WN0010 10        RS Program
     C                     MOVEL*BLANK    WN0011 10        RS User Added
     C                     Z-ADD*ZERO     WN0012  70       RS Date Added
     C                     Z-ADD*ZERO     WN0013  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @FDCPG5
     C                     Z-ADDWBHONB    WCHONB           CC Company Numb
     C                     Z-ADDWBB0DT    WCB0DT           TH Kill Date
      *
     C           KLCHSC    KLIST
     C                     KFLD           WCHONB           CC Company Numb
     C                     KFLD           WCB0DT           TH Kill Date
     C           KLCHSC    CHAIN@FDCPG5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFDCPL0'MDACP
     C                     MOVEL'@FDCPG5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFD1    YARDCS
      * Move non-key fields to @FDCPG5
     C                     Z-ADDWBFXA1    WCFXA1           Shift A Int Adj
     C                     Z-ADDWBFYA1    WCFYA1           Shift A Int Hot
     C                     Z-ADDWBFZA1    WCFZA1           Shift A Int Hd
     C                     Z-ADDWBG0A1    WCG0A1           Shift A Int Hd
     C                     Z-ADDWBGLA1    WCGLA1           Shift A Int Hd
     C                     Z-ADDWBF0A1    WCF0A1           Shift A Int Hot
     C                     Z-ADDWBGKA1    WCGKA1           Shift A Int Rat
     C                     Z-ADDWBF1A1    WCF1A1           Shift A Ext Adj
     C                     Z-ADDWBF2A1    WCF2A1           Shift A Ext Hot
     C                     Z-ADDWBF3A1    WCF3A1           Shift A Ext Hd
     C                     Z-ADDWBG2A1    WCG2A1           Shift A Ext Hd
     C                     Z-ADDWBGNA1    WCGNA1           Shift A Ext Hd
     C                     Z-ADDWBF4A1    WCF4A1           Shift A Ext Hot
     C                     Z-ADDWBGPA1    WCGPA1           Shift A Ext Rat
     C                     Z-ADDWBF5A1    WCF5A1           Shift A Tot Hot
     C                     Z-ADDWBGQA1    WCGQA1           Shift A Tot Rat
     C                     Z-ADDYL0010    WCJSA1           Shift A Kill to
     C                     Z-ADDWBF7A1    WCF7A1           Shift B Int Adj
     C                     Z-ADDWBF8A1    WCF8A1           Shift B Int Hot
     C                     Z-ADDWBF9A1    WCF9A1           Shift B Int Hd
     C                     Z-ADDWBG1A1    WCG1A1           Shift B Int Hd
     C                     Z-ADDWBGMA1    WCGMA1           Shift B Int Hd
     C                     Z-ADDWBGAA1    WCGAA1           Shift B Int Hot
     C                     Z-ADDWBGRA1    WCGRA1           Shift B Int Rat
     C                     Z-ADDWBGBA1    WCGBA1           Shift B Ext Adj
     C                     Z-ADDWBGCA1    WCGCA1           Shift B Ext Hot
     C                     Z-ADDWBGDA1    WCGDA1           Shift B Ext Hd
     C                     Z-ADDWBG3A1    WCG3A1           Shift B Ext Hd
     C                     Z-ADDWBGOA1    WCGOA1           Shift B Ext Hd
     C                     Z-ADDWBGEA1    WCGEA1           Shift B Ext Hot
     C                     Z-ADDWBGSA1    WCGSA1           Shift B Ext Rat
     C                     Z-ADDWBGFA1    WCGFA1           Shift B Tot Hot
     C                     Z-ADDWBGTA1    WCGTA1           Shift B Tot Rat
     C                     Z-ADDYL0011    WCJTA1           Shift B Kill to
     C                     Z-ADDWBGHA1    WCGHA1           Total Int Hot W
     C                     Z-ADDWBGUA1    WCGUA1           Total Int Rate
     C                     Z-ADDWBGIA1    WCGIA1           Total Ext Hot W
     C                     Z-ADDWBGWA1    WCGWA1           Total Ext Rate
     C                     Z-ADDWBGJA1    WCGJA1           Total Hot Wgt S
     C                     Z-ADDWBGVA1    WCGVA1           Total Rate Adj
     C                     Z-ADDYL0013    WCJUA1           Total Kill to C
     C                     Z-ADDWBEVDT    WCEVDT           Production Date
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFD1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp-SysDtIF
     C                     MOVEL##USR     WCAAVN           RS User Changed
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WCAADT    PARM *ZERO     WQ0003  70       *DATE
     C           WCAMTM    PARM *ZERO     WQ0004  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKFD1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@FDCPG5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFDCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDUDY     BEGSR
      *================================================================
      * Calculate duration, *DAYS
      *================================================================
     C           XDAY1     IFLT 1
     C           XDAY2     ORLT 1
     C                     Z-ADD0         XDURR
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     GOTO XDUDYE
     C                     END
     C           XDAY1     IFGE XDAY2
      * From date2 to date1
     C                     Z-ADDXDAY2     XABEG   60
     C                     Z-ADDXDAY1     XAEND   60
     C                     ELSE
      * From date1 to date2
     C                     Z-ADDXDAY1     XABEG   60
     C                     Z-ADDXDAY2     XAEND   60
     C                     END
     C           XDWSL     IFEQ 0
      * None days of week selected
     C                     Z-ADD0         XDURR
     C                     GOTO XDUDYC
     C                     END
     C           XAEND     SUB  XABEG     XDURR   80
     C           XDWSL     IFEQ 7
      * All days of week selected
     C                     GOTO XDUDYC
     C                     END
      * Some days of week selected
     C                     DIV  7         XDURR
     C                     MVR            XDLSW   10
     C                     MULT XDWSL     XDURR
     C           XDLSW     IFNE 0
      * Determine day of week of the beginning date
     C           XABEG     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
      * Loop: Increment the date by the last week
     C           XDLSW     DOWGT0
      * Increment the day of week
     C                     ADD  1         YY
     C                     SUB  1         XDLSW
      * Put day of week into the range 1-7
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     END
      * Selected day of the last week has been processed
     C           YDOW,YY   IFEQ XDSEL
      * Increment duration
     C                     ADD  1         XDURR
     C                     END
      * End of loop
     C                     END
     C                     END
     C           XDUDYC    TAG
     C           XDURR     IFEQ 0
      * Return Code: Unable to calculate duration
     C                     MOVEL'Y2U0060' W0RTN   7
     C                     ELSE
     C                     MOVEL*BLANK    W0RTN   7
     C                     END
      *================================================================
     CSR         XDUDYE    ENDSR
      /EJECT
     CSR         XTCEL     BEGSR
      *================================================================
      * Calculate elapsed time from TME2 to TME1
      *================================================================
     C           XTTIM     IFGE XTTIM2
     C                     Z-ADD1         XSGN    10
     C                     Z-ADDXTNN      XTNNL   30
     C                     Z-ADDXTSS      XTSSL   30
     C           XTSSL     IFLT XTSS2
     C                     ADD  60        XTSSL
     C                     SUB  1         XTNNL
     C                     END
     C           XTSSL     SUB  XTSS2     XTSS
     C           XTNNL     IFLT XTNN2
     C                     ADD  60        XTNNL
     C                     SUB  1         XTHH
     C                     END
     C           XTNNL     SUB  XTNN2     XTNN
     C                     SUB  XTHH2     XTHH
     C                     ELSE
     C                     Z-ADD-1        XSGN
     C                     Z-ADDXTNN2     XTNNL
     C                     Z-ADDXTSS2     XTSSL
     C           XTSSL     IFLT XTSS
     C                     ADD  60        XTSSL
     C                     SUB  1         XTNNL
     C                     END
     C           XTSSL     SUB  XTSS      XTSS
     C           XTNNL     IFLT XTNN
     C                     ADD  60        XTNNL
     C                     SUB  1         XTHH2
     C                     END
     C           XTNNL     SUB  XTNN      XTNN
     C           XTHH2     SUB  XTHH      XTHH
     C                     END
      *================================================================
     CSR         XTCELE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1KORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     P1EADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     P1EBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     P2AWTM           Time Diff Usr
     C                     Z-ADD*ZERO     P3BQTM           Wait Time 4.0 U
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field CC Company Number
     C                     Z-ADD*ZERO     WUHONB  30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WABNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WABONB           BOL Load Number
     C                     Z-ADD*ZERO     WACVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WAB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WAAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WAACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WAB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WACAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WAAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WAA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WACXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WACWNB           TH Head Receive
     C                     Z-ADD*ZERO     WAFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WAH9NB           TH Held Over
     C                     Z-ADD*ZERO     WAFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WAFENB           TH Head Killed
     C                     Z-ADD*ZERO     WAHENB           TH Head Adds
     C                     Z-ADD*ZERO     WAHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WACYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WALRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WAE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WAA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WAFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WAA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WAF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WAHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WAF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WAF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WAF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WAF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WAAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WAAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WACWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WAA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WAA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WAB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WAAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WAANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WAAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WAAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WAAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WAAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WAAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WAASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WAA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WAATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WAA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WACBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WACCPR           Th Payment Net
     C                     Z-ADD*ZERO     WALPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WACDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WAA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WAA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WAGHNB           TH Commission A
     C                     Z-ADD*ZERO     WABYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WABSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WABTDT           TH Commission P
     C                     Z-ADD*ZERO     WABUDT           TH Actual Check
     C                     Z-ADD*ZERO     WAHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WAHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WAHINB           TH FFLI
     C                     Z-ADD*ZERO     WAA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WAA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WAA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WAJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WAD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WAD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WAD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WAD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WAEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WAEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WAECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WAEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WAEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WAEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WAEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WAEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WAOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WATHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WAT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WATHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WAT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WAOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WAKOER           TH Head Identif
     C                     Z-ADD*ZERO     WAOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WAOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WAIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WAOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WAHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WAS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WATAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WATBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WAJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WAKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WAKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WAKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WAKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WAOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WAIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WAIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WAIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WAKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WAOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WAKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WAORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WAOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WAMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WAMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WANCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WANCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WAIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WAKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WAEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WAEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WAECDT           TH Head LFT
     C                     Z-ADD*ZERO     WAEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WAEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBHONB           CC Company Numb
     C                     Z-ADD*ZERO     WBB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WBFXA1           Shift A Int Adj
     C                     Z-ADD*ZERO     WBFYA1           Shift A Int Hot
     C                     Z-ADD*ZERO     WBFZA1           Shift A Int Hd
     C                     Z-ADD*ZERO     WBG0A1           Shift A Int Hd
     C                     Z-ADD*ZERO     WBGLA1           Shift A Int Hd
     C                     Z-ADD*ZERO     WBF0A1           Shift A Int Hot
     C                     Z-ADD*ZERO     WBGKA1           Shift A Int Rat
     C                     Z-ADD*ZERO     WBF1A1           Shift A Ext Adj
     C                     Z-ADD*ZERO     WBF2A1           Shift A Ext Hot
     C                     Z-ADD*ZERO     WBF3A1           Shift A Ext Hd
     C                     Z-ADD*ZERO     WBG2A1           Shift A Ext Hd
     C                     Z-ADD*ZERO     WBGNA1           Shift A Ext Hd
     C                     Z-ADD*ZERO     WBF4A1           Shift A Ext Hot
     C                     Z-ADD*ZERO     WBGPA1           Shift A Ext Rat
     C                     Z-ADD*ZERO     WBF5A1           Shift A Tot Hot
     C                     Z-ADD*ZERO     WBGQA1           Shift A Tot Rat
     C                     Z-ADD*ZERO     WBJSA1           Shift A Kill to
     C                     Z-ADD*ZERO     WBF7A1           Shift B Int Adj
     C                     Z-ADD*ZERO     WBF8A1           Shift B Int Hot
     C                     Z-ADD*ZERO     WBF9A1           Shift B Int Hd
     C                     Z-ADD*ZERO     WBG1A1           Shift B Int Hd
     C                     Z-ADD*ZERO     WBGMA1           Shift B Int Hd
     C                     Z-ADD*ZERO     WBGAA1           Shift B Int Hot
     C                     Z-ADD*ZERO     WBGRA1           Shift B Int Rat
     C                     Z-ADD*ZERO     WBGBA1           Shift B Ext Adj
     C                     Z-ADD*ZERO     WBGCA1           Shift B Ext Hot
     C                     Z-ADD*ZERO     WBGDA1           Shift B Ext Hd
     C                     Z-ADD*ZERO     WBG3A1           Shift B Ext Hd
     C                     Z-ADD*ZERO     WBGOA1           Shift B Ext Hd
     C                     Z-ADD*ZERO     WBGEA1           Shift B Ext Hot
     C                     Z-ADD*ZERO     WBGSA1           Shift B Ext Rat
     C                     Z-ADD*ZERO     WBGFA1           Shift B Tot Hot
     C                     Z-ADD*ZERO     WBGTA1           Shift B Tot Rat
     C                     Z-ADD*ZERO     WBJTA1           Shift B Kill to
     C                     Z-ADD*ZERO     WBGHA1           Total Int Hot W
     C                     Z-ADD*ZERO     WBGUA1           Total Int Rate
     C                     Z-ADD*ZERO     WBGIA1           Total Ext Hot W
     C                     Z-ADD*ZERO     WBGWA1           Total Ext Rate
     C                     Z-ADD*ZERO     WBGJA1           Total Hot Wgt S
     C                     Z-ADD*ZERO     WBGVA1           Total Rate Adj
     C                     Z-ADD*ZERO     WBJUA1           Total Kill to C
     C                     Z-ADD*ZERO     WBEVDT           Production Date
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
     C                     MOVEL'N'       W0PMT   1
      * Define local work field Number 1 USR
     C                     Z-ADD*ZERO     YL0001  20
      * Define local work field Usr Elapsed hours
     C                     Z-ADD*ZERO     YL0002  60
      * Define local work field Hours USR
     C                     Z-ADD*ZERO     YL0003  50
      * Define local work field Minutes USR
     C                     Z-ADD*ZERO     YL0004  50
      * Define local work field Wait Time 4.0 USR
     C                     Z-ADD*ZERO     YL0005  40
      * Define local work field Count USR
     C                     Z-ADD*ZERO     YL0006  30
      * Define local work field Minutes USR
     C                     Z-ADD*ZERO     YL0007  50
      * Define local work field Count USR 2
     C                     Z-ADD*ZERO     YL0008  30
      * Define local work field Minutes USR 2
     C                     Z-ADD*ZERO     YL0009  50
      * Define local work field Shift A Kill to Cut Avg
     C                     Z-ADD*ZERO     YL0010  50
      * Define local work field Shift B Kill to Cut Avg
     C                     Z-ADD*ZERO     YL0011  50
      * Define local work field Movement number new usr
     C                     Z-ADD*ZERO     YL0012  70
      * Define local work field Total Kill to Cut Avg
     C                     Z-ADD*ZERO     YL0013  50
      *================================================================
     CSR         ZZEXIT    ENDSR
