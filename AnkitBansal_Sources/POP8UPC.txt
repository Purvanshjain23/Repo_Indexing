/*  SYNOPSIS:                                                      */
/*              CL program that updates the product trace with    */
/*              the closest tattoo in the uploaded Cold Scale Tattoo */
/*                                                                  */
/*  SYSTEM:     Order Management System                             */
/*                                                                  */
/*  DATE:       6/24/02                                             */
/*                                                                  */
/*  PARAMETERS:                                                     */
/********************************************************************/
/* RMC 11/26/03 DATA IS UPLOADED TO POB1CPPUPL, SO COPY IT TO POB1CPP */
/*              TO RUN THE MATCH, AND DONT COPY/CLEAR POB1CPP HERE  */
/* RMC 10/27/04 THE POB1CPP UPL WONT BE USED ANY MORE AS OF 11/1/04,  */
/*              SO JUST COPY/CLEAR THE UPLOAD FILE.. DONT PROCESS IT */
/* RMC 02/03/05 THE ABOVE IS INSTALLED NOW.. 2/3/5 AT NOON            */
/********************************************************************/
             PGM        PARM(&RETURN)
             DCL        VAR(&RETURN) TYPE(*CHAR) LEN(7)
             DCL        VAR(&FLIB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&HLIB) TYPE(*CHAR) LEN(10)

 /*         RETREIVE FILE LIBRARY INTO FLIB                          */
             CALL       PGM(CAQXXFR) PARM(&RETURN &FLIB &HLIB)

coldUPL:     CPYF       FROMFILE(&FLIB/POB1CPPUPL) +
                          TOFILE(&FLIB/POB1CPP) MBROPT(*ADD)
     MONMSG     MSGID(CPF5009 CPF5034 CPF2972) EXEC(SNDMSG +
                          MSG('Duplicate key in POB0CPP Cold Scale +
                          Copy') TOUSR(ISRCENT))
     MONMSG     MSGID(CPF2817)



 /*         * read and update the product trace                    */
   /* *********    NOT AS OF 11/1/04     **********************   */
   /*        CALL       PGM(POP7XFR) PARM(' ')                      */

 /*         COPY UPLOAD FILE INTO "AS" (HISTORY) FILE                */

             CLRPFM     FILE(&FLIB/POB1CPPUPL)

 GOTO END   /* NOV. 26 2003 */
             IF         COND(&FLIB *NE '          ') THEN(DO)

coldscl:     CPYF       FROMFILE(&FLIB/POB1CPP) +
                          TOFILE(&FLIB/ASB1CPP) MBROPT(*ADD)
             MONMSG     MSGID(CPF5009 CPF5034 CPF2972) EXEC(SNDMSG +
                          MSG('Duplicate key in ASB0CPP Cold Scale +
                          Copy') TOUSR(ISRCENT))
             CLRPFM     FILE(&FLIB/POB1CPP)
             ENDDO

 END: ENDPGM
