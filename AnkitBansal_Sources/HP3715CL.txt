/***************************************************************** */
/*                                                                 */
/*  PROGRAM NUMBER:  HP3715CL                                      */
/*  PROGRAM NAME:    UPLOAD OF ITEM AND ITEM TYPE MASTER           */
/*  PROGRAMMER:      LEANNE FEDOR                                  */
/*  CREATE DATE:     02/26/04                                      */
/*                                                                 */
/*  FUNCTION:        THIS CL EDITS DATA THAT THE P.C. PEOPLE       */
/*                   HAVE PUT INTO 2 UPLOAD FILES FROM THE MP2     */
/*                   SYSTEM.                                       */
/*                                                                 */
/*******************************************************************/
/*  MODIFIED:                                                      */
/* 08/09/05  BARB GUTIERREZ                                        */
/*           CHANGED EMAIL ADDRESS FROM SEABOARDPORK.COM TO        */
/*           SEABOARDFOODS.COM PER COMPANY NAME CHANGE.            */
/*                                                                 */
/* 09/22/09  LEANNE RAMSEY                                         */
/*           SAMI WILSON AND STEPHEN TROMPETER REQUESTED THAT WE   */
/*           STOP PRINTING HP3717-LISTING OF HPS ITEM/ITEM TYPE    */
/*           FILES. SO, I HAVE COMMENTED OUT THE CALL/EMAIL OF     */
/*           HP3717.                                               */
/*******************************************************************/

             PGM

/* DEFINE THE VARIABLE REQUIRED IN THE COMMAND TO OVERRIDE THE     */
/* PRINT FILE TO A LASER PRINTER                                   */

             DCL        VAR(&CMD) TYPE(*CHAR) LEN(512)

             DCL        VAR(&EMAIL) TYPE(*CHAR) LEN(32)
             DCL        VAR(&ERRFL) TYPE(*CHAR) LEN(1)

             DCL        VAR(&HOLD) TYPE(*CHAR) LEN(4)
             DCL        VAR(&COPYS) TYPE(*DEC) LEN(2)
             DCL        VAR(&OUTQ) TYPE(*CHAR) LEN(10)

             CHGVAR     VAR(&HOLD) VALUE(*YES)
             CHGVAR     VAR(&COPYS) VALUE(1)
             CHGVAR     VAR(&OUTQ) VALUE(*JOB)

             CHGVAR     VAR(&EMAIL) +
                          VALUE(MP2BUDGET@SEABOARDFOODS.COM)

/*------------------------------------------------------------------*/
/* OVVERRIDE THE PRINT FILE                                         */
/*------------------------------------------------------------------*/

             SBDPRTOVR  CMDVAR(&CMD) FILE(QPRINT) OUTQ(&OUTQ) +
                          WIDTH(198) LANDSCAPE(*PRTF) DRAWER(*PRTF) +
                          COPIES(&COPYS) HOLD(&HOLD) SHARE(*YES)
             CALL       PGM(QCMDEXC) PARM(&CMD 512)

/*------------------------------------------------------------------*/
/* ADD LIBRARY TO ALLOW YOU TO SEND LISTINGS BY E-MAIL              */
/*------------------------------------------------------------------*/

             ADDLIBLE   LIB(ESEND)
             MONMSG CPF0000

/*------------------------------------------------------------------*/
/* HARD ALLOCATE THE UPLOAD FILES                                   */
/*------------------------------------------------------------------*/

             ALCOBJ     OBJ((HSP220 *FILE *EXCL))
             ALCOBJ     OBJ((HSP221 *FILE *EXCL))

/*------------------------------------------------------------------*/
/* EDIT FILES UPLOADED FROM THE MP2 SYSTEM                          */
/*------------------------------------------------------------------*/

             CHGVAR     VAR(&ERRFL) VALUE('N')
             CALL       PGM(HP3715) PARM(&ERRFL)

/* ERRORS */
             IF         COND(&ERRFL *EQ 'Y') THEN(DO)
             ESNDMAIL   RECIPIENT(&EMAIL) SUBJECT('Error Listing of +
                          Uploaded Items and Item Types') +
                          ATTLIST((* *PDF *N QPRINT *))
             DLTSPLF    FILE(QPRINT)
             ENDDO

/* NO ERRORS */

             IF         COND(&ERRFL *EQ 'N') THEN(DO)
             CRTDUPOBJL OBJ(HSP3716) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(QTEMP)
             CALL       PGM(HP3716) /* Update */

 /* On 09/22/09, Sami Wilson and Stephen Trompeter requested that we stop */
 /* printing/emailing this listing. SO, I have commented out the call.    */
       /*    CALL       PGM(HP3717)                */
       /*    ESNDMAIL   RECIPIENT(&EMAIL) SUBJECT('Upload had no +
                          errors. Listing of HPS Item/Item Type +
                          files.') ATTLIST((* *PDF *N QPRINT *)) */
       /*    DLTSPLF    FILE(QPRINT) */
             ENDDO

/*------------------------------------------------------------------*/
/* END OF JOB                                                       */
/*------------------------------------------------------------------*/

/* DEALLOCATE THE UPLOAD FILES                                      */

             DLCOBJ     OBJ((HSP220 *FILE *EXCL))
             DLCOBJ     OBJ((HSP221 *FILE *EXCL))

/* DELETE FILE OVERRIDES                                            */

             DLTOVR     FILE(*ALL)

             ENDPGM

