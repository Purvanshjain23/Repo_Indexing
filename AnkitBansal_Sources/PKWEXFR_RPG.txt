     H/TITLE Bld MPR Daily Prch Sm XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISRCENT
     H* Date          : 08/17/21  Time  : 17:07:00
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKE4CPL1IF  E           K        DISK
      * RTV : MPR Estimated Purchases   Retrieval index
      *
     FPKAWCPLGIF  E           K        DISK
      * RSQ : Buy Order Header          Company/ReportingDate
      *
     FPKE3CPL1IF  E           K        DISK
      * RTV : MPR Producer Purch Type   Retrieval index
      *
     FPKAXCPL0IF  E           K        DISK
      * RTV : Buy Order Load            Retrieval index
      *
     FPKAFREL0IF  E           K        DISK
      * RTV : Producer Location         Retrieval index
      *
     FPKDNCPL1IF  E           K        DISK
      * RTV : Tattoo Header EXT         Retrieval index
      *
     FPKA1CPLIIF  E           K        DISK
      * RSQ : Tattoo Header             Co/Bol/Ttt
      *
     FPLATREL1IF  E           K        DISK
      * RTV : Producer Site             Retrieval index
      *
     FPKA1CPL0IF  E           K        DISK
      * RTV : Tattoo Header             Retrieval index
      *
     FPKE9CPL1IF  E           K        DISK
      * RTV : MPR Daily Purchase Dtl    Retrieval index
      *
     FPKA1CPLFIF  E           K        DISK
      * RSQ : Tattoo Header             Co/BOL/Kill/Ttt
      *
     FPKAQCPL0IF  E           K        DISK
      * RTV : Producer Sub-Contract     Retrieval index
      *
     FPKE8CPL1IF  E           K        DISK
      * RTV : MPR Daily Purchase Sum    Retrieval index
      *
     FPKAWCPL0UF  E           K        DISK
      * UPD : Buy Order Header          Update index
      *
     FPKE9CPL0UF  E           K        DISK                      A
      * UPD : MPR Daily Purchase Dtl    Update index
      *
     FPKAXCPL1UF  E           K        DISK
      * UPD : Buy Order Load            Update index
      *
     FPKE8CPL0UF  E           K        DISK                      A
      * UPD : MPR Daily Purchase Sum    Update index
      *
     I@E4CPF7
      * MPR Estimated Purchases   Retrieval index
      * Renamed input format fields
     I              E4HONB                          WAHONB
     I              E4ETDT                          WAETDT
     I              E4C0A1                          WAC0A1
     I              E4C1A1                          WAC1A1
     I              E4AAVN                          WAAAVN
     I              E4AADT                          WAAADT
     I              E4AMTM                          WAAMTM
     I              E4AJST                          WAAJST
     I              E4AHVN                          WAAHVN
     I              E4AGVN                          WAAGVN
     I              E4ABVN                          WAABVN
     I              E4ABDT                          WAABDT
     I              E4ABTM                          WAABTM
      *
     I@AWCPGQ
      * Buy Order Header          Company/ReportingDate
      * Renamed input format fields
     I              AWHMNB                          WBHMNB
     I              AWBNNB                          WBBNNB
     I              AWARDT                          WBARDT
     I              AWASDT                          WBASDT
     I              AWA4ST                          WBA4ST
     I              AWA5ST                          WBA5ST
     I              AWAAPR                          WBAAPR
     I              AWA6ST                          WBA6ST
     I              AWA7ST                          WBA7ST
     I              AWB3ST                          WBB3ST
     I              AWALPR                          WBALPR
     I              AWETCD                          WBETCD
     I              AWEUCD                          WBEUCD
     I              AWJ5TX                          WBJ5TX
     I              AWD5DT                          WBD5DT
     I              AWD6DT                          WBD6DT
     I              AWD7DT                          WBD7DT
     I              AWD8DT                          WBD8DT
     I              AWD9DT                          WBD9DT
     I              AWJOEJ                          WBJOEJ
     I              AWKOFF                          WBKOFF
     I              AWKWPE                          WBKWPE
     I              AWIMBF                          WBIMBF
     I              AWOPTR                          WBOPTR
     I              AWOEJD                          WBOEJD
     I              AWIRMF                          WBIRMF
     I              AWJIRM                          WBJIRM
     I              AWJRKF                          WBJRKF
     I              AWKFIR                          WBKFIR
     I              AWUZST                          WBUZST
     I              AWU0ST                          WBU0ST
     I              AWU1ST                          WBU1ST
     I              AWU2ST                          WBU2ST
     I              AWU3ST                          WBU3ST
     I              AWHXNB                          WBHXNB
     I              AWGANB                          WBGANB
     I              AWGBNB                          WBGBNB
     I              AWABCD                          WBABCD
     I              AWAECD                          WBAECD
     I              AWAKCD                          WBAKCD
     I              AWALCD                          WBALCD
     I              AWAGCD                          WBAGCD
     I              AWAICD                          WBAICD
     I              AWAMCD                          WBAMCD
     I              AWACCD                          WBACCD
     I              AWAAVN                          WBAAVN
     I              AWAADT                          WBAADT
     I              AWAMTM                          WBAMTM
     I              AWAJST                          WBAJST
     I              AWAHVN                          WBAHVN
     I              AWAGVN                          WBAGVN
     I              AWABVN                          WBABVN
     I              AWABDT                          WBABDT
     I              AWABTM                          WBABTM
      *
     I@E3CPF4
      * MPR Producer Purch Type   Retrieval index
      * Renamed input format fields
     I              E3ABCD                          WCABCD
     I              E3C0A1                          WCC0A1
     I              E3AAVN                          WCAAVN
     I              E3AADT                          WCAADT
     I              E3AMTM                          WCAMTM
     I              E3AJST                          WCAJST
     I              E3AHVN                          WCAHVN
     I              E3AGVN                          WCAGVN
     I              E3ABVN                          WCABVN
     I              E3ABDT                          WCABDT
     I              E3ABTM                          WCABTM
      *
     I@AXCPBX
      * Buy Order Load            Retrieval index
      * Renamed input format fields
     I              AXHMNB                          WDHMNB
     I              AXBNNB                          WDBNNB
     I              AXBONB                          WDBONB
     I              AXCQDT                          WDCQDT
     I              AXABTH                          WDABTH
     I              AXACTH                          WDACTH
     I              AXBPNB                          WDBPNB
     I              AXCSNB                          WDCSNB
     I              AXAUDT                          WDAUDT
     I              AXCMST                          WDCMST
     I              AXAGPR                          WDAGPR
     I              AXATVA                          WDATVA
     I              AXI1ST                          WDI1ST
     I              AXDHNB                          WDDHNB
     I              AXDINB                          WDDINB
     I              AXCNST                          WDCNST
     I              AXGINB                          WDGINB
     I              AXBZDT                          WDBZDT
     I              AXLSNB                          WDLSNB
     I              AXF3TX                          WDF3TX
     I              AXO8ST                          WDO8ST
     I              AXO9ST                          WDO9ST
     I              AXPAST                          WDPAST
     I              AXLDSH                          WDLDSH
     I              AXPBST                          WDPBST
     I              AXPCST                          WDPCST
     I              AXPDST                          WDPDST
     I              AXUWST                          WDUWST
     I              AXUXST                          WDUXST
     I              AXUYST                          WDUYST
     I              AXJKRU                          WDJKRU
     I              AXKEOR                          WDKEOR
     I              AXIOEW                          WDIOEW
     I              AXKJIO                          WDKJIO
     I              AXIOJR                          WDIOJR
     I              AXEIRR                          WDEIRR
     I              AXITMF                          WDITMF
     I              AXODJE                          WDODJE
     I              AXRJIF                          WDRJIF
     I              AXOEJF                          WDOEJF
     I              AXD0DT                          WDD0DT
     I              AXD1DT                          WDD1DT
     I              AXD2DT                          WDD2DT
     I              AXD3DT                          WDD3DT
     I              AXD4DT                          WDD4DT
     I              AXBNCD                          WDBNCD
     I              AXABCD                          WDABCD
     I              AXAECD                          WDAECD
     I              AXAAVN                          WDAAVN
     I              AXAADT                          WDAADT
     I              AXAMTM                          WDAMTM
     I              AXAJST                          WDAJST
     I              AXAHVN                          WDAHVN
     I              AXAGVN                          WDAGVN
     I              AXABVN                          WDABVN
     I              AXABDT                          WDABDT
     I              AXABTM                          WDABTM
      *
     I@AWCPAZ
      * Buy Order Header          Update index
      * Renamed input format fields
     I              AWHMNB                          WEHMNB
     I              AWBNNB                          WEBNNB
     I              AWARDT                          WEARDT
     I              AWASDT                          WEASDT
     I              AWA4ST                          WEA4ST
     I              AWA5ST                          WEA5ST
     I              AWAAPR                          WEAAPR
     I              AWA6ST                          WEA6ST
     I              AWA7ST                          WEA7ST
     I              AWB3ST                          WEB3ST
     I              AWALPR                          WEALPR
     I              AWETCD                          WEETCD
     I              AWEUCD                          WEEUCD
     I              AWJ5TX                          WEJ5TX
     I              AWD5DT                          WED5DT
     I              AWD6DT                          WED6DT
     I              AWD7DT                          WED7DT
     I              AWD8DT                          WED8DT
     I              AWD9DT                          WED9DT
     I              AWJOEJ                          WEJOEJ
     I              AWKOFF                          WEKOFF
     I              AWKWPE                          WEKWPE
     I              AWIMBF                          WEIMBF
     I              AWOPTR                          WEOPTR
     I              AWOEJD                          WEOEJD
     I              AWIRMF                          WEIRMF
     I              AWJIRM                          WEJIRM
     I              AWJRKF                          WEJRKF
     I              AWKFIR                          WEKFIR
     I              AWUZST                          WEUZST
     I              AWU0ST                          WEU0ST
     I              AWU1ST                          WEU1ST
     I              AWU2ST                          WEU2ST
     I              AWU3ST                          WEU3ST
     I              AWHXNB                          WEHXNB
     I              AWGANB                          WEGANB
     I              AWGBNB                          WEGBNB
     I              AWABCD                          WEABCD
     I              AWAECD                          WEAECD
     I              AWAKCD                          WEAKCD
     I              AWALCD                          WEALCD
     I              AWAGCD                          WEAGCD
     I              AWAICD                          WEAICD
     I              AWAMCD                          WEAMCD
     I              AWACCD                          WEACCD
     I              AWAAVN                          WEAAVN
     I              AWAADT                          WEAADT
     I              AWAMTM                          WEAMTM
     I              AWAJST                          WEAJST
     I              AWAHVN                          WEAHVN
     I              AWAGVN                          WEAGVN
     I              AWABVN                          WEABVN
     I              AWABDT                          WEABDT
     I              AWABTM                          WEABTM
      *
     I@AFREAR
      * Producer Location         Retrieval index
      * Renamed input format fields
     I              AFABCD                          WFABCD
     I              AFAECD                          WFAECD
     I              AFA8TX                          WFA8TX
     I              AFGLNB                          WFGLNB
     I              AFATST                          WFATST
     I              AFASNB                          WFASNB
     I              AFAUST                          WFAUST
     I              AFQNST                          WFQNST
     I              AFQOST                          WFQOST
     I              AFQPST                          WFQPST
     I              AFQQST                          WFQQST
     I              AFQRST                          WFQRST
     I              AFN0TX                          WFN0TX
     I              AFQSST                          WFQSST
     I              AFQTST                          WFQTST
     I              AFQUST                          WFQUST
     I              AFQVST                          WFQVST
     I              AFR8ST                          WFR8ST
     I              AFR9ST                          WFR9ST
     I              AFSAST                          WFSAST
     I              AFSBST                          WFSBST
     I              AFSDST                          WFSDST
     I              AFSEST                          WFSEST
     I              AFSFST                          WFSFST
     I              AFHWNB                          WFHWNB
     I              AFFUCD                          WFFUCD
     I              AFAAVN                          WFAAVN
     I              AFAADT                          WFAADT
     I              AFAMTM                          WFAMTM
     I              AFAJST                          WFAJST
     I              AFAHVN                          WFAHVN
     I              AFAGVN                          WFAGVN
     I              AFABVN                          WFABVN
     I              AFABDT                          WFABDT
     I              AFABTM                          WFABTM
      *
     I@DNCPUY
      * Tattoo Header EXT         Retrieval index
      * Renamed input format fields
     I              DNHMNB                          WGHMNB
     I              DNBNNB                          WGBNNB
     I              DNBONB                          WGBONB
     I              DNCVNB                          WGCVNB
     I              DNB0DT                          WGB0DT
     I              DNI5PR                          WGI5PR
     I              DNJBPR                          WGJBPR
     I              DNI6PR                          WGI6PR
     I              DNI7PR                          WGI7PR
     I              DNI8PR                          WGI8PR
     I              DNI9PR                          WGI9PR
     I              DNJAPR                          WGJAPR
     I              DNJCPR                          WGJCPR
     I              DNJDPR                          WGJDPR
     I              DNJEPR                          WGJEPR
     I              DNJFPR                          WGJFPR
     I              DNJGPR                          WGJGPR
     I              DNJHPR                          WGJHPR
     I              DNJIPR                          WGJIPR
     I              DNJJPR                          WGJJPR
     I              DNJKPR                          WGJKPR
     I              DNJLPR                          WGJLPR
     I              DNJMPR                          WGJMPR
     I              DNJNPR                          WGJNPR
     I              DNJOPR                          WGJOPR
     I              DNLTBF                          WGLTBF
     I              DNHZPC                          WGHZPC
     I              DNLTHW                          WGLTHW
     I              DNH0PC                          WGH0PC
     I              DNGTBF                          WGGTBF
     I              DNH1PC                          WGH1PC
     I              DNGTHW                          WGGTHW
     I              DNH2PC                          WGH2PC
     I              DNHLBF                          WGHLBF
     I              DNHLLE                          WGHLLE
     I              DNHLHW                          WGHLHW
     I              DNHLLP                          WGHLLP
     I              DNHGBF                          WGHGBF
     I              DNHGLE                          WGHGLE
     I              DNHGHW                          WGHGHW
     I              DNHFLP                          WGHFLP
     I              DNSNA1                          WGSNA1
     I              DNSOA1                          WGSOA1
     I              DNSPA1                          WGSPA1
     I              DNDGSS                          WGDGSS
     I              DNDHSS                          WGDHSS
     I              DNDISS                          WGDISS
     I              DNABCD                          WGABCD
     I              DNNYCD                          WGNYCD
     I              DNOVCD                          WGOVCD
     I              DNAAVN                          WGAAVN
     I              DNAADT                          WGAADT
     I              DNAMTM                          WGAMTM
     I              DNAJST                          WGAJST
     I              DNAHVN                          WGAHVN
     I              DNAGVN                          WGAGVN
     I              DNABVN                          WGABVN
     I              DNABDT                          WGABDT
     I              DNABTM                          WGABTM
      *
     I@A1CPOI
      * Tattoo Header             Co/Bol/Ttt
      * Renamed input format fields
     I              A1HMNB                          WHHMNB
     I              A1BNNB                          WHBNNB
     I              A1BONB                          WHBONB
     I              A1CVNB                          WHCVNB
     I              A1B0DT                          WHB0DT
     I              A1AWDT                          WHAWDT
     I              A1BICD                          WHBICD
     I              A1CPST                          WHCPST
     I              A1ACPR                          WHACPR
     I              A1B9PR                          WHB9PR
     I              A1CAPR                          WHCAPR
     I              A1C4ST                          WHC4ST
     I              A1AIPR                          WHAIPR
     I              A1A6DT                          WHA6DT
     I              A1C2ST                          WHC2ST
     I              A1CXNB                          WHCXNB
     I              A1CWNB                          WHCWNB
     I              A1FCNB                          WHFCNB
     I              A1H9NB                          WHH9NB
     I              A1FDNB                          WHFDNB
     I              A1FENB                          WHFENB
     I              A1HENB                          WHHENB
     I              A1HFNB                          WHHFNB
     I              A1CYNB                          WHCYNB
     I              A1LRNB                          WHLRNB
     I              A1E0NB                          WHE0NB
     I              A1A5PC                          WHA5PC
     I              A1FBNB                          WHFBNB
     I              A1A4PC                          WHA4PC
     I              A1F7NB                          WHF7NB
     I              A1HDNB                          WHHDNB
     I              A1F5NB                          WHF5NB
     I              A1F4NB                          WHF4NB
     I              A1F3NB                          WHF3NB
     I              A1F2NB                          WHF2NB
     I              A1AVPC                          WHAVPC
     I              A1AWPC                          WHAWPC
     I              A1CWPC                          WHCWPC
     I              A1A8PC                          WHA8PC
     I              A1A7PC                          WHA7PC
     I              A1B8PR                          WHB8PR
     I              A1AMPR                          WHAMPR
     I              A1ANPR                          WHANPR
     I              A1AYVA                          WHAYVA
     I              A1AWVA                          WHAWVA
     I              A1AOPR                          WHAOPR
     I              A1AXVA                          WHAXVA
     I              A1APPR                          WHAPPR
     I              A1ASPR                          WHASPR
     I              A1A4VA                          WHA4VA
     I              A1ATPR                          WHATPR
     I              A1A5VA                          WHA5VA
     I              A1CBPR                          WHCBPR
     I              A1CCPR                          WHCCPR
     I              A1LPNB                          WHLPNB
     I              A1CDPR                          WHCDPR
     I              A1A7VA                          WHA7VA
     I              A1A2PR                          WHA2PR
     I              A1JWST                          WHJWST
     I              A1CWST                          WHCWST
     I              A1D7ST                          WHD7ST
     I              A1D8ST                          WHD8ST
     I              A1DWST                          WHDWST
     I              A1D6ST                          WHD6ST
     I              A1GHNB                          WHGHNB
     I              A1BYDT                          WHBYDT
     I              A1E0ST                          WHE0ST
     I              A1E1ST                          WHE1ST
     I              A1E2ST                          WHE2ST
     I              A1BSDT                          WHBSDT
     I              A1BTDT                          WHBTDT
     I              A1BUDT                          WHBUDT
     I              A1HGNB                          WHHGNB
     I              A1HHNB                          WHHHNB
     I              A1HINB                          WHHINB
     I              A1A3PR                          WHA3PR
     I              A1A4PR                          WHA4PR
     I              A1A6PR                          WHA6PR
     I              A1J9NB                          WHJ9NB
     I              A1D6PR                          WHD6PR
     I              A1D7PR                          WHD7PR
     I              A1D8PR                          WHD8PR
     I              A1D9PR                          WHD9PR
     I              A1EAPR                          WHEAPR
     I              A1EBPR                          WHEBPR
     I              A1ECPR                          WHECPR
     I              A1EDPR                          WHEDPR
     I              A1EEPR                          WHEEPR
     I              A1EFPR                          WHEFPR
     I              A1EGPR                          WHEGPR
     I              A1EHPR                          WHEHPR
     I              A1KAST                          WHKAST
     I              A1J7ST                          WHJ7ST
     I              A1J9ST                          WHJ9ST
     I              A1OXNB                          WHOXNB
     I              A1LKST                          WHLKST
     I              A1LLST                          WHLLST
     I              A1J8ST                          WHJ8ST
     I              A1LIST                          WHLIST
     I              A1LJST                          WHLJST
     I              A1NZTX                          WHNZTX
     I              A1HJCD                          WHHJCD
     I              A1R4ST                          WHR4ST
     I              A1R5ST                          WHR5ST
     I              A1R6ST                          WHR6ST
     I              A1R7ST                          WHR7ST
     I              A1THWT                          WHTHWT
     I              A1T2WT                          WHT2WT
     I              A1THHD                          WHTHHD
     I              A1T2HD                          WHT2HD
     I              A1OBPR                          WHOBPR
     I              A1KOER                          WHKOER
     I              A1OPIR                          WHOPIR
     I              A1OPEM                          WHOPEM
     I              A1IORP                          WHIORP
     I              A1OWEO                          WHOWEO
     I              A1OQET                          WHOQET
     I              A1URST                          WHURST
     I              A1USST                          WHUSST
     I              A1HHPC                          WHHHPC
     I              A1S9PR                          WHS9PR
     I              A1TAPR                          WHTAPR
     I              A1TBPR                          WHTBPR
     I              A1JFUR                          WHJFUR
     I              A1KRIF                          WHKRIF
     I              A1KORF                          WHKORF
     I              A1KAPR                          WHKAPR
     I              A1KROT                          WHKROT
     I              A1OTJG                          WHOTJG
     I              A1IRJG                          WHIRJG
     I              A1IMJF                          WHIMJF
     I              A1IRGF                          WHIRGF
     I              A1KRJF                          WHKRJF
     I              A1OJRF                          WHOJRF
     I              A1KFOR                          WHKFOR
     I              A1ORJK                          WHORJK
     I              A1OMVJ                          WHOMVJ
     I              A1MVNF                          WHMVNF
     I              A1MCNF                          WHMCNF
     I              A1NCNF                          WHNCNF
     I              A1NCHF                          WHNCHF
     I              A1IGIR                          WHIGIR
     I              A1KFJR                          WHKFJR
     I              A1EADT                          WHEADT
     I              A1EBDT                          WHEBDT
     I              A1ECDT                          WHECDT
     I              A1EDDT                          WHEDDT
     I              A1EEDT                          WHEEDT
     I              A1U4ST                          WHU4ST
     I              A1U5ST                          WHU5ST
     I              A1U6ST                          WHU6ST
     I              A1U7ST                          WHU7ST
     I              A1U8ST                          WHU8ST
     I              A1U9ST                          WHU9ST
     I              A1VAST                          WHVAST
     I              A1VBST                          WHVBST
     I              A1BDCD                          WHBDCD
     I              A1CSCD                          WHCSCD
     I              A1ABCD                          WHABCD
     I              A1AECD                          WHAECD
     I              A1ACCD                          WHACCD
     I              A1AGCD                          WHAGCD
     I              A1BECD                          WHBECD
     I              A1AAVN                          WHAAVN
     I              A1AADT                          WHAADT
     I              A1AMTM                          WHAMTM
     I              A1AJST                          WHAJST
     I              A1AHVN                          WHAHVN
     I              A1AGVN                          WHAGVN
     I              A1ABVN                          WHABVN
     I              A1ABDT                          WHABDT
     I              A1ABTM                          WHABTM
      *
     I@ATRELM
      * Producer Site             Retrieval index
      * Renamed input format fields
     I              ATABCD                          WIABCD
     I              ATNYCD                          WINYCD
     I              ATTETX                          WITETX
     I              ATTZTX                          WITZTX
     I              ATT0TX                          WIT0TX
     I              ATT1TX                          WIT1TX
     I              ATT2TX                          WIT2TX
     I              ATT3TX                          WIT3TX
     I              ATTWTX                          WITWTX
     I              ATTXTX                          WITXTX
     I              ATMDA1                          WIMDA1
     I              ATMEA1                          WIMEA1
     I              ATTYTX                          WITYTX
     I              ATAXSS                          WIAXSS
     I              ATAYSS                          WIAYSS
     I              ATAZSS                          WIAZSS
     I              ATMFA1                          WIMFA1
     I              ATT4TX                          WIT4TX
     I              ATT5TX                          WIT5TX
     I              ATBGT1                          WIBGT1
     I              ATAAVN                          WIAAVN
     I              ATAADT                          WIAADT
     I              ATAMTM                          WIAMTM
     I              ATAJST                          WIAJST
     I              ATAHVN                          WIAHVN
     I              ATAGVN                          WIAGVN
     I              ATABVN                          WIABVN
     I              ATABDT                          WIABDT
     I              ATABTM                          WIABTM
      *
     I@A1CPC4
      * Tattoo Header             Retrieval index
      * Renamed input format fields
     I              A1HMNB                          WJHMNB
     I              A1BNNB                          WJBNNB
     I              A1BONB                          WJBONB
     I              A1CVNB                          WJCVNB
     I              A1B0DT                          WJB0DT
     I              A1AWDT                          WJAWDT
     I              A1BICD                          WJBICD
     I              A1CPST                          WJCPST
     I              A1ACPR                          WJACPR
     I              A1B9PR                          WJB9PR
     I              A1CAPR                          WJCAPR
     I              A1C4ST                          WJC4ST
     I              A1AIPR                          WJAIPR
     I              A1A6DT                          WJA6DT
     I              A1C2ST                          WJC2ST
     I              A1CXNB                          WJCXNB
     I              A1CWNB                          WJCWNB
     I              A1FCNB                          WJFCNB
     I              A1H9NB                          WJH9NB
     I              A1FDNB                          WJFDNB
     I              A1FENB                          WJFENB
     I              A1HENB                          WJHENB
     I              A1HFNB                          WJHFNB
     I              A1CYNB                          WJCYNB
     I              A1LRNB                          WJLRNB
     I              A1E0NB                          WJE0NB
     I              A1A5PC                          WJA5PC
     I              A1FBNB                          WJFBNB
     I              A1A4PC                          WJA4PC
     I              A1F7NB                          WJF7NB
     I              A1HDNB                          WJHDNB
     I              A1F5NB                          WJF5NB
     I              A1F4NB                          WJF4NB
     I              A1F3NB                          WJF3NB
     I              A1F2NB                          WJF2NB
     I              A1AVPC                          WJAVPC
     I              A1AWPC                          WJAWPC
     I              A1CWPC                          WJCWPC
     I              A1A8PC                          WJA8PC
     I              A1A7PC                          WJA7PC
     I              A1B8PR                          WJB8PR
     I              A1AMPR                          WJAMPR
     I              A1ANPR                          WJANPR
     I              A1AYVA                          WJAYVA
     I              A1AWVA                          WJAWVA
     I              A1AOPR                          WJAOPR
     I              A1AXVA                          WJAXVA
     I              A1APPR                          WJAPPR
     I              A1ASPR                          WJASPR
     I              A1A4VA                          WJA4VA
     I              A1ATPR                          WJATPR
     I              A1A5VA                          WJA5VA
     I              A1CBPR                          WJCBPR
     I              A1CCPR                          WJCCPR
     I              A1LPNB                          WJLPNB
     I              A1CDPR                          WJCDPR
     I              A1A7VA                          WJA7VA
     I              A1A2PR                          WJA2PR
     I              A1JWST                          WJJWST
     I              A1CWST                          WJCWST
     I              A1D7ST                          WJD7ST
     I              A1D8ST                          WJD8ST
     I              A1DWST                          WJDWST
     I              A1D6ST                          WJD6ST
     I              A1GHNB                          WJGHNB
     I              A1BYDT                          WJBYDT
     I              A1E0ST                          WJE0ST
     I              A1E1ST                          WJE1ST
     I              A1E2ST                          WJE2ST
     I              A1BSDT                          WJBSDT
     I              A1BTDT                          WJBTDT
     I              A1BUDT                          WJBUDT
     I              A1HGNB                          WJHGNB
     I              A1HHNB                          WJHHNB
     I              A1HINB                          WJHINB
     I              A1A3PR                          WJA3PR
     I              A1A4PR                          WJA4PR
     I              A1A6PR                          WJA6PR
     I              A1J9NB                          WJJ9NB
     I              A1D6PR                          WJD6PR
     I              A1D7PR                          WJD7PR
     I              A1D8PR                          WJD8PR
     I              A1D9PR                          WJD9PR
     I              A1EAPR                          WJEAPR
     I              A1EBPR                          WJEBPR
     I              A1ECPR                          WJECPR
     I              A1EDPR                          WJEDPR
     I              A1EEPR                          WJEEPR
     I              A1EFPR                          WJEFPR
     I              A1EGPR                          WJEGPR
     I              A1EHPR                          WJEHPR
     I              A1KAST                          WJKAST
     I              A1J7ST                          WJJ7ST
     I              A1J9ST                          WJJ9ST
     I              A1OXNB                          WJOXNB
     I              A1LKST                          WJLKST
     I              A1LLST                          WJLLST
     I              A1J8ST                          WJJ8ST
     I              A1LIST                          WJLIST
     I              A1LJST                          WJLJST
     I              A1NZTX                          WJNZTX
     I              A1HJCD                          WJHJCD
     I              A1R4ST                          WJR4ST
     I              A1R5ST                          WJR5ST
     I              A1R6ST                          WJR6ST
     I              A1R7ST                          WJR7ST
     I              A1THWT                          WJTHWT
     I              A1T2WT                          WJT2WT
     I              A1THHD                          WJTHHD
     I              A1T2HD                          WJT2HD
     I              A1OBPR                          WJOBPR
     I              A1KOER                          WJKOER
     I              A1OPIR                          WJOPIR
     I              A1OPEM                          WJOPEM
     I              A1IORP                          WJIORP
     I              A1OWEO                          WJOWEO
     I              A1OQET                          WJOQET
     I              A1URST                          WJURST
     I              A1USST                          WJUSST
     I              A1HHPC                          WJHHPC
     I              A1S9PR                          WJS9PR
     I              A1TAPR                          WJTAPR
     I              A1TBPR                          WJTBPR
     I              A1JFUR                          WJJFUR
     I              A1KRIF                          WJKRIF
     I              A1KORF                          WJKORF
     I              A1KAPR                          WJKAPR
     I              A1KROT                          WJKROT
     I              A1OTJG                          WJOTJG
     I              A1IRJG                          WJIRJG
     I              A1IMJF                          WJIMJF
     I              A1IRGF                          WJIRGF
     I              A1KRJF                          WJKRJF
     I              A1OJRF                          WJOJRF
     I              A1KFOR                          WJKFOR
     I              A1ORJK                          WJORJK
     I              A1OMVJ                          WJOMVJ
     I              A1MVNF                          WJMVNF
     I              A1MCNF                          WJMCNF
     I              A1NCNF                          WJNCNF
     I              A1NCHF                          WJNCHF
     I              A1IGIR                          WJIGIR
     I              A1KFJR                          WJKFJR
     I              A1EADT                          WJEADT
     I              A1EBDT                          WJEBDT
     I              A1ECDT                          WJECDT
     I              A1EDDT                          WJEDDT
     I              A1EEDT                          WJEEDT
     I              A1U4ST                          WJU4ST
     I              A1U5ST                          WJU5ST
     I              A1U6ST                          WJU6ST
     I              A1U7ST                          WJU7ST
     I              A1U8ST                          WJU8ST
     I              A1U9ST                          WJU9ST
     I              A1VAST                          WJVAST
     I              A1VBST                          WJVBST
     I              A1BDCD                          WJBDCD
     I              A1CSCD                          WJCSCD
     I              A1ABCD                          WJABCD
     I              A1AECD                          WJAECD
     I              A1ACCD                          WJACCD
     I              A1AGCD                          WJAGCD
     I              A1BECD                          WJBECD
     I              A1AAVN                          WJAAVN
     I              A1AADT                          WJAADT
     I              A1AMTM                          WJAMTM
     I              A1AJST                          WJAJST
     I              A1AHVN                          WJAHVN
     I              A1AGVN                          WJAGVN
     I              A1ABVN                          WJABVN
     I              A1ABDT                          WJABDT
     I              A1ABTM                          WJABTM
      *
     I@E9CPGG
      * MPR Daily Purchase Dtl    Retrieval index
      * Renamed input format fields
     I              E9H8CD                          WKH8CD
     I              E9ETDT                          WKETDT
     I              E9C2A1                          WKC2A1
     I              E9IBCD                          WKIBCD
     I              E9EIA1                          WKEIA1
     I              E9EJA1                          WKEJA1
     I              E9EKA1                          WKEKA1
     I              E9ELA1                          WKELA1
     I              E9U0PR                          WKU0PR
     I              E9IDCD                          WKIDCD
     I              E9AAVN                          WKAAVN
     I              E9AADT                          WKAADT
     I              E9AMTM                          WKAMTM
     I              E9AJST                          WKAJST
     I              E9AHVN                          WKAHVN
     I              E9AGVN                          WKAGVN
     I              E9ABVN                          WKABVN
     I              E9ABDT                          WKABDT
     I              E9ABTM                          WKABTM
      *
     I@E9CPGF
      * MPR Daily Purchase Dtl    Update index
      * Renamed input format fields
     I              E9H8CD                          WLH8CD
     I              E9ETDT                          WLETDT
     I              E9C2A1                          WLC2A1
     I              E9IBCD                          WLIBCD
     I              E9EIA1                          WLEIA1
     I              E9EJA1                          WLEJA1
     I              E9EKA1                          WLEKA1
     I              E9ELA1                          WLELA1
     I              E9U0PR                          WLU0PR
     I              E9IDCD                          WLIDCD
     I              E9AAVN                          WLAAVN
     I              E9AADT                          WLAADT
     I              E9AMTM                          WLAMTM
     I              E9AJST                          WLAJST
     I              E9AHVN                          WLAHVN
     I              E9AGVN                          WLAGVN
     I              E9ABVN                          WLABVN
     I              E9ABDT                          WLABDT
     I              E9ABTM                          WLABTM
      *
     I@AXCPBY
      * Buy Order Load            Update index
      * Renamed input format fields
     I              AXHMNB                          WMHMNB
     I              AXBNNB                          WMBNNB
     I              AXBONB                          WMBONB
     I              AXCQDT                          WMCQDT
     I              AXABTH                          WMABTH
     I              AXACTH                          WMACTH
     I              AXBPNB                          WMBPNB
     I              AXCSNB                          WMCSNB
     I              AXAUDT                          WMAUDT
     I              AXCMST                          WMCMST
     I              AXAGPR                          WMAGPR
     I              AXATVA                          WMATVA
     I              AXI1ST                          WMI1ST
     I              AXDHNB                          WMDHNB
     I              AXDINB                          WMDINB
     I              AXCNST                          WMCNST
     I              AXGINB                          WMGINB
     I              AXBZDT                          WMBZDT
     I              AXLSNB                          WMLSNB
     I              AXF3TX                          WMF3TX
     I              AXO8ST                          WMO8ST
     I              AXO9ST                          WMO9ST
     I              AXPAST                          WMPAST
     I              AXLDSH                          WMLDSH
     I              AXPBST                          WMPBST
     I              AXPCST                          WMPCST
     I              AXPDST                          WMPDST
     I              AXUWST                          WMUWST
     I              AXUXST                          WMUXST
     I              AXUYST                          WMUYST
     I              AXJKRU                          WMJKRU
     I              AXKEOR                          WMKEOR
     I              AXIOEW                          WMIOEW
     I              AXKJIO                          WMKJIO
     I              AXIOJR                          WMIOJR
     I              AXEIRR                          WMEIRR
     I              AXITMF                          WMITMF
     I              AXODJE                          WMODJE
     I              AXRJIF                          WMRJIF
     I              AXOEJF                          WMOEJF
     I              AXD0DT                          WMD0DT
     I              AXD1DT                          WMD1DT
     I              AXD2DT                          WMD2DT
     I              AXD3DT                          WMD3DT
     I              AXD4DT                          WMD4DT
     I              AXBNCD                          WMBNCD
     I              AXABCD                          WMABCD
     I              AXAECD                          WMAECD
     I              AXAAVN                          WMAAVN
     I              AXAADT                          WMAADT
     I              AXAMTM                          WMAMTM
     I              AXAJST                          WMAJST
     I              AXAHVN                          WMAHVN
     I              AXAGVN                          WMAGVN
     I              AXABVN                          WMABVN
     I              AXABDT                          WMABDT
     I              AXABTM                          WMABTM
      *
     I@A1CPOC
      * Tattoo Header             Co/BOL/Kill/Ttt
      * Renamed input format fields
     I              A1HMNB                          WOHMNB
     I              A1BNNB                          WOBNNB
     I              A1BONB                          WOBONB
     I              A1CVNB                          WOCVNB
     I              A1B0DT                          WOB0DT
     I              A1AWDT                          WOAWDT
     I              A1BICD                          WOBICD
     I              A1CPST                          WOCPST
     I              A1ACPR                          WOACPR
     I              A1B9PR                          WOB9PR
     I              A1CAPR                          WOCAPR
     I              A1C4ST                          WOC4ST
     I              A1AIPR                          WOAIPR
     I              A1A6DT                          WOA6DT
     I              A1C2ST                          WOC2ST
     I              A1CXNB                          WOCXNB
     I              A1CWNB                          WOCWNB
     I              A1FCNB                          WOFCNB
     I              A1H9NB                          WOH9NB
     I              A1FDNB                          WOFDNB
     I              A1FENB                          WOFENB
     I              A1HENB                          WOHENB
     I              A1HFNB                          WOHFNB
     I              A1CYNB                          WOCYNB
     I              A1LRNB                          WOLRNB
     I              A1E0NB                          WOE0NB
     I              A1A5PC                          WOA5PC
     I              A1FBNB                          WOFBNB
     I              A1A4PC                          WOA4PC
     I              A1F7NB                          WOF7NB
     I              A1HDNB                          WOHDNB
     I              A1F5NB                          WOF5NB
     I              A1F4NB                          WOF4NB
     I              A1F3NB                          WOF3NB
     I              A1F2NB                          WOF2NB
     I              A1AVPC                          WOAVPC
     I              A1AWPC                          WOAWPC
     I              A1CWPC                          WOCWPC
     I              A1A8PC                          WOA8PC
     I              A1A7PC                          WOA7PC
     I              A1B8PR                          WOB8PR
     I              A1AMPR                          WOAMPR
     I              A1ANPR                          WOANPR
     I              A1AYVA                          WOAYVA
     I              A1AWVA                          WOAWVA
     I              A1AOPR                          WOAOPR
     I              A1AXVA                          WOAXVA
     I              A1APPR                          WOAPPR
     I              A1ASPR                          WOASPR
     I              A1A4VA                          WOA4VA
     I              A1ATPR                          WOATPR
     I              A1A5VA                          WOA5VA
     I              A1CBPR                          WOCBPR
     I              A1CCPR                          WOCCPR
     I              A1LPNB                          WOLPNB
     I              A1CDPR                          WOCDPR
     I              A1A7VA                          WOA7VA
     I              A1A2PR                          WOA2PR
     I              A1JWST                          WOJWST
     I              A1CWST                          WOCWST
     I              A1D7ST                          WOD7ST
     I              A1D8ST                          WOD8ST
     I              A1DWST                          WODWST
     I              A1D6ST                          WOD6ST
     I              A1GHNB                          WOGHNB
     I              A1BYDT                          WOBYDT
     I              A1E0ST                          WOE0ST
     I              A1E1ST                          WOE1ST
     I              A1E2ST                          WOE2ST
     I              A1BSDT                          WOBSDT
     I              A1BTDT                          WOBTDT
     I              A1BUDT                          WOBUDT
     I              A1HGNB                          WOHGNB
     I              A1HHNB                          WOHHNB
     I              A1HINB                          WOHINB
     I              A1A3PR                          WOA3PR
     I              A1A4PR                          WOA4PR
     I              A1A6PR                          WOA6PR
     I              A1J9NB                          WOJ9NB
     I              A1D6PR                          WOD6PR
     I              A1D7PR                          WOD7PR
     I              A1D8PR                          WOD8PR
     I              A1D9PR                          WOD9PR
     I              A1EAPR                          WOEAPR
     I              A1EBPR                          WOEBPR
     I              A1ECPR                          WOECPR
     I              A1EDPR                          WOEDPR
     I              A1EEPR                          WOEEPR
     I              A1EFPR                          WOEFPR
     I              A1EGPR                          WOEGPR
     I              A1EHPR                          WOEHPR
     I              A1KAST                          WOKAST
     I              A1J7ST                          WOJ7ST
     I              A1J9ST                          WOJ9ST
     I              A1OXNB                          WOOXNB
     I              A1LKST                          WOLKST
     I              A1LLST                          WOLLST
     I              A1J8ST                          WOJ8ST
     I              A1LIST                          WOLIST
     I              A1LJST                          WOLJST
     I              A1NZTX                          WONZTX
     I              A1HJCD                          WOHJCD
     I              A1R4ST                          WOR4ST
     I              A1R5ST                          WOR5ST
     I              A1R6ST                          WOR6ST
     I              A1R7ST                          WOR7ST
     I              A1THWT                          WOTHWT
     I              A1T2WT                          WOT2WT
     I              A1THHD                          WOTHHD
     I              A1T2HD                          WOT2HD
     I              A1OBPR                          WOOBPR
     I              A1KOER                          WOKOER
     I              A1OPIR                          WOOPIR
     I              A1OPEM                          WOOPEM
     I              A1IORP                          WOIORP
     I              A1OWEO                          WOOWEO
     I              A1OQET                          WOOQET
     I              A1URST                          WOURST
     I              A1USST                          WOUSST
     I              A1HHPC                          WOHHPC
     I              A1S9PR                          WOS9PR
     I              A1TAPR                          WOTAPR
     I              A1TBPR                          WOTBPR
     I              A1JFUR                          WOJFUR
     I              A1KRIF                          WOKRIF
     I              A1KORF                          WOKORF
     I              A1KAPR                          WOKAPR
     I              A1KROT                          WOKROT
     I              A1OTJG                          WOOTJG
     I              A1IRJG                          WOIRJG
     I              A1IMJF                          WOIMJF
     I              A1IRGF                          WOIRGF
     I              A1KRJF                          WOKRJF
     I              A1OJRF                          WOOJRF
     I              A1KFOR                          WOKFOR
     I              A1ORJK                          WOORJK
     I              A1OMVJ                          WOOMVJ
     I              A1MVNF                          WOMVNF
     I              A1MCNF                          WOMCNF
     I              A1NCNF                          WONCNF
     I              A1NCHF                          WONCHF
     I              A1IGIR                          WOIGIR
     I              A1KFJR                          WOKFJR
     I              A1EADT                          WOEADT
     I              A1EBDT                          WOEBDT
     I              A1ECDT                          WOECDT
     I              A1EDDT                          WOEDDT
     I              A1EEDT                          WOEEDT
     I              A1U4ST                          WOU4ST
     I              A1U5ST                          WOU5ST
     I              A1U6ST                          WOU6ST
     I              A1U7ST                          WOU7ST
     I              A1U8ST                          WOU8ST
     I              A1U9ST                          WOU9ST
     I              A1VAST                          WOVAST
     I              A1VBST                          WOVBST
     I              A1BDCD                          WOBDCD
     I              A1CSCD                          WOCSCD
     I              A1ABCD                          WOABCD
     I              A1AECD                          WOAECD
     I              A1ACCD                          WOACCD
     I              A1AGCD                          WOAGCD
     I              A1BECD                          WOBECD
     I              A1AAVN                          WOAAVN
     I              A1AADT                          WOAADT
     I              A1AMTM                          WOAMTM
     I              A1AJST                          WOAJST
     I              A1AHVN                          WOAHVN
     I              A1AGVN                          WOAGVN
     I              A1ABVN                          WOABVN
     I              A1ABDT                          WOABDT
     I              A1ABTM                          WOABTM
      *
     I@AQCPA0
      * Producer Sub-Contract     Retrieval index
      * Renamed input format fields
     I              AQAKCD                          WRAKCD
     I              AQALCD                          WRALCD
     I              AQAHDT                          WRAHDT
     I              AQA2ST                          WRA2ST
     I              AQAZPR                          WRAZPR
     I              AQA0PR                          WRA0PR
     I              AQA9PC                          WRA9PC
     I              AQA7PR                          WRA7PR
     I              AQA8PR                          WRA8PR
     I              AQF3ST                          WRF3ST
     I              AQA9PR                          WRA9PR
     I              AQERCD                          WRERCD
     I              AQESCD                          WRESCD
     I              AQF6PR                          WRF6PR
     I              AQJ3TX                          WRJ3TX
     I              AQABCD                          WRABCD
     I              AQAECD                          WRAECD
     I              AQAGCD                          WRAGCD
     I              AQAICD                          WRAICD
     I              AQAMCD                          WRAMCD
     I              AQAAVN                          WRAAVN
     I              AQAADT                          WRAADT
     I              AQAMTM                          WRAMTM
     I              AQAJST                          WRAJST
     I              AQAHVN                          WRAHVN
     I              AQAGVN                          WRAGVN
     I              AQABVN                          WRABVN
     I              AQABDT                          WRABDT
     I              AQABTM                          WRABTM
      *
     I@E8CPGJ
      * MPR Daily Purchase Sum    Retrieval index
      * Renamed input format fields
     I              E8H8CD                          WSH8CD
     I              E8ETDT                          WSETDT
     I              E8C2A1                          WSC2A1
     I              E8D1A1                          WSD1A1
     I              E8D2A1                          WSD2A1
     I              E8D3A1                          WSD3A1
     I              E8D4A1                          WSD4A1
     I              E8D5A1                          WSD5A1
     I              E8D6A1                          WSD6A1
     I              E8D7A1                          WSD7A1
     I              E8YLA1                          WSYLA1
     I              E8YMA1                          WSYMA1
     I              E8D8A1                          WSD8A1
     I              E8D9A1                          WSD9A1
     I              E8EAA1                          WSEAA1
     I              E8EBA1                          WSEBA1
     I              E8ECA1                          WSECA1
     I              E8EDA1                          WSEDA1
     I              E8EEA1                          WSEEA1
     I              E8EFA1                          WSEFA1
     I              E8EGA1                          WSEGA1
     I              E8YNA1                          WSYNA1
     I              E8YOA1                          WSYOA1
     I              E8AAVN                          WSAAVN
     I              E8AADT                          WSAADT
     I              E8AMTM                          WSAMTM
     I              E8AJST                          WSAJST
     I              E8AHVN                          WSAHVN
     I              E8AGVN                          WSAGVN
     I              E8ABVN                          WSABVN
     I              E8ABDT                          WSABDT
     I              E8ABTM                          WSABTM
      *
     I@E8CPGI
      * MPR Daily Purchase Sum    Update index
      * Renamed input format fields
     I              E8H8CD                          WTH8CD
     I              E8ETDT                          WTETDT
     I              E8C2A1                          WTC2A1
     I              E8D1A1                          WTD1A1
     I              E8D2A1                          WTD2A1
     I              E8D3A1                          WTD3A1
     I              E8D4A1                          WTD4A1
     I              E8D5A1                          WTD5A1
     I              E8D6A1                          WTD6A1
     I              E8D7A1                          WTD7A1
     I              E8YLA1                          WTYLA1
     I              E8YMA1                          WTYMA1
     I              E8D8A1                          WTD8A1
     I              E8D9A1                          WTD9A1
     I              E8EAA1                          WTEAA1
     I              E8EBA1                          WTEBA1
     I              E8ECA1                          WTECA1
     I              E8EDA1                          WTEDA1
     I              E8EEA1                          WTEEA1
     I              E8EFA1                          WTEFA1
     I              E8EGA1                          WTEGA1
     I              E8YNA1                          WTYNA1
     I              E8YOA1                          WTYOA1
     I              E8AAVN                          WTAAVN
     I              E8AADT                          WTAADT
     I              E8AMTM                          WTAMTM
     I              E8AJST                          WTAJST
     I              E8AHVN                          WTAHVN
     I              E8AGVN                          WTAGVN
     I              E8ABVN                          WTABVN
     I              E8ABDT                          WTABDT
     I              E8ABTM                          WTABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPKAW1    E DSPKAWCPL0
      * UPD : Buy Order Header          Update index
      * Renamed input format fields
     I              AWHMNB                          WEHMNB
     I              AWBNNB                          WEBNNB
     I              AWARDT                          WEARDT
     I              AWASDT                          WEASDT
     I              AWA4ST                          WEA4ST
     I              AWA5ST                          WEA5ST
     I              AWAAPR                          WEAAPR
     I              AWA6ST                          WEA6ST
     I              AWA7ST                          WEA7ST
     I              AWB3ST                          WEB3ST
     I              AWALPR                          WEALPR
     I              AWETCD                          WEETCD
     I              AWEUCD                          WEEUCD
     I              AWJ5TX                          WEJ5TX
     I              AWD5DT                          WED5DT
     I              AWD6DT                          WED6DT
     I              AWD7DT                          WED7DT
     I              AWD8DT                          WED8DT
     I              AWD9DT                          WED9DT
     I              AWJOEJ                          WEJOEJ
     I              AWKOFF                          WEKOFF
     I              AWKWPE                          WEKWPE
     I              AWIMBF                          WEIMBF
     I              AWOPTR                          WEOPTR
     I              AWOEJD                          WEOEJD
     I              AWIRMF                          WEIRMF
     I              AWJIRM                          WEJIRM
     I              AWJRKF                          WEJRKF
     I              AWKFIR                          WEKFIR
     I              AWUZST                          WEUZST
     I              AWU0ST                          WEU0ST
     I              AWU1ST                          WEU1ST
     I              AWU2ST                          WEU2ST
     I              AWU3ST                          WEU3ST
     I              AWHXNB                          WEHXNB
     I              AWGANB                          WEGANB
     I              AWGBNB                          WEGBNB
     I              AWABCD                          WEABCD
     I              AWAECD                          WEAECD
     I              AWAKCD                          WEAKCD
     I              AWALCD                          WEALCD
     I              AWAGCD                          WEAGCD
     I              AWAICD                          WEAICD
     I              AWAMCD                          WEAMCD
     I              AWACCD                          WEACCD
     I              AWAAVN                          WEAAVN
     I              AWAADT                          WEAADT
     I              AWAMTM                          WEAMTM
     I              AWAJST                          WEAJST
     I              AWAHVN                          WEAHVN
     I              AWAGVN                          WEAGVN
     I              AWABVN                          WEABVN
     I              AWABDT                          WEABDT
     I              AWABTM                          WEABTM
      *
     IYARDCS      DS                            219
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPKE91    E DSPKE9CPL0
      * UPD : MPR Daily Purchase Dtl    Update index
      * Renamed input format fields
     I              E9H8CD                          WLH8CD
     I              E9ETDT                          WLETDT
     I              E9C2A1                          WLC2A1
     I              E9IBCD                          WLIBCD
     I              E9EIA1                          WLEIA1
     I              E9EJA1                          WLEJA1
     I              E9EKA1                          WLEKA1
     I              E9ELA1                          WLELA1
     I              E9U0PR                          WLU0PR
     I              E9IDCD                          WLIDCD
     I              E9AAVN                          WLAAVN
     I              E9AADT                          WLAADT
     I              E9AMTM                          WLAMTM
     I              E9AJST                          WLAJST
     I              E9AHVN                          WLAHVN
     I              E9AGVN                          WLAGVN
     I              E9ABVN                          WLABVN
     I              E9ABDT                          WLABDT
     I              E9ABTM                          WLABTM
      *
     IYBRDCS      DS                            108
     IQPKAX1    E DSPKAXCPL1
      * UPD : Buy Order Load            Update index
      * Renamed input format fields
     I              AXHMNB                          WMHMNB
     I              AXBNNB                          WMBNNB
     I              AXBONB                          WMBONB
     I              AXCQDT                          WMCQDT
     I              AXABTH                          WMABTH
     I              AXACTH                          WMACTH
     I              AXBPNB                          WMBPNB
     I              AXCSNB                          WMCSNB
     I              AXAUDT                          WMAUDT
     I              AXCMST                          WMCMST
     I              AXAGPR                          WMAGPR
     I              AXATVA                          WMATVA
     I              AXI1ST                          WMI1ST
     I              AXDHNB                          WMDHNB
     I              AXDINB                          WMDINB
     I              AXCNST                          WMCNST
     I              AXGINB                          WMGINB
     I              AXBZDT                          WMBZDT
     I              AXLSNB                          WMLSNB
     I              AXF3TX                          WMF3TX
     I              AXO8ST                          WMO8ST
     I              AXO9ST                          WMO9ST
     I              AXPAST                          WMPAST
     I              AXLDSH                          WMLDSH
     I              AXPBST                          WMPBST
     I              AXPCST                          WMPCST
     I              AXPDST                          WMPDST
     I              AXUWST                          WMUWST
     I              AXUXST                          WMUXST
     I              AXUYST                          WMUYST
     I              AXJKRU                          WMJKRU
     I              AXKEOR                          WMKEOR
     I              AXIOEW                          WMIOEW
     I              AXKJIO                          WMKJIO
     I              AXIOJR                          WMIOJR
     I              AXEIRR                          WMEIRR
     I              AXITMF                          WMITMF
     I              AXODJE                          WMODJE
     I              AXRJIF                          WMRJIF
     I              AXOEJF                          WMOEJF
     I              AXD0DT                          WMD0DT
     I              AXD1DT                          WMD1DT
     I              AXD2DT                          WMD2DT
     I              AXD3DT                          WMD3DT
     I              AXD4DT                          WMD4DT
     I              AXBNCD                          WMBNCD
     I              AXABCD                          WMABCD
     I              AXAECD                          WMAECD
     I              AXAAVN                          WMAAVN
     I              AXAADT                          WMAADT
     I              AXAMTM                          WMAMTM
     I              AXAJST                          WMAJST
     I              AXAHVN                          WMAHVN
     I              AXAGVN                          WMAGVN
     I              AXABVN                          WMABVN
     I              AXABDT                          WMABDT
     I              AXABTM                          WMABTM
      *
     IYCRDCS      DS                            237
     IYDRDCS      DS                            108
     IYERDCS      DS                            237
     IQPKE81    E DSPKE8CPL0
      * UPD : MPR Daily Purchase Sum    Update index
      * Renamed input format fields
     I              E8H8CD                          WTH8CD
     I              E8ETDT                          WTETDT
     I              E8C2A1                          WTC2A1
     I              E8D1A1                          WTD1A1
     I              E8D2A1                          WTD2A1
     I              E8D3A1                          WTD3A1
     I              E8D4A1                          WTD4A1
     I              E8D5A1                          WTD5A1
     I              E8D6A1                          WTD6A1
     I              E8D7A1                          WTD7A1
     I              E8YLA1                          WTYLA1
     I              E8YMA1                          WTYMA1
     I              E8D8A1                          WTD8A1
     I              E8D9A1                          WTD9A1
     I              E8EAA1                          WTEAA1
     I              E8EBA1                          WTEBA1
     I              E8ECA1                          WTECA1
     I              E8EDA1                          WTEDA1
     I              E8EEA1                          WTEEA1
     I              E8EFA1                          WTEFA1
     I              E8EGA1                          WTEGA1
     I              E8YNA1                          WTYNA1
     I              E8YOA1                          WTYOA1
     I              E8AAVN                          WTAAVN
     I              E8AADT                          WTAADT
     I              E8AMTM                          WTAMTM
     I              E8AJST                          WTAJST
     I              E8AHVN                          WTAHVN
     I              E8AGVN                          WTAGVN
     I              E8ABVN                          WTABVN
     I              E8ABDT                          WTABDT
     I              E8ABTM                          WTABTM
      *
     IYFRDCS      DS                            147
     IYGRDCS      DS                            147
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  MPR Reporting Time
     I                                    P   1   10P1C2A1
     IP2PARM      DS
      * I :  Company Number USR
     I                                    P   1   20P2GGNB
     IP3PARM      DS
      * B :  MPR Identification Num
     I                                        1   5 P3H8CD
     IP4PARM      DS
      * B :  MPR Reporting Date
     I                                    P   1   40P4ETDT
     IP5PARM      DS
      * FLD: *Arrays
      * N :  MPR Act Purch Type 1 Hd
     I                                    P   1   40P5EDA1
      * N :  MPR Act Purch Type 2 Hd
     I                                    P   5   80P5EEA1
      * N :  MPR Act Purch Type 3 Hd
     I                                    P   9  120P5EFA1
      * N :  MPR Act Purch Type 4 Hd
     I                                    P  13  160P5EGA1
      * N :  MPR Act Purch Type 5 Hd
     I                                    P  17  200P5D5A1
      * N :  MPR Act Purch Type 6 Hd
     I                                    P  21  240P5D6A1
      * N :  MPR Act Purch Type 7 Hd
     I                                    P  25  280P5D7A1
      * N :  MPR Act Purch Type 8 Hd
     I                                    P  29  320P5D8A1
      * N :  MPR Est Purch Type 1 Hd
     I                                    P  33  360P5D9A1
      * N :  MPR Est Purch Type 2 Hd
     I                                    P  37  400P5EAA1
      * N :  MPR Est Purch Type 3 Hd
     I                                    P  41  440P5EBA1
      * N :  MPR Est Purch Type 4 Hd
     I                                    P  45  480P5ECA1
      * N :  MPR Est Purch Type 5 Hd
     I                                    P  49  520P5D1A1
      * N :  MPR Est Purch Type 6 Hd
     I                                    P  53  560P5D2A1
      * N :  MPR Est Purch Type 7 Hd
     I                                    P  57  600P5D3A1
      * N :  MPR Est Purch Type 8 Hd
     I                                    P  61  640P5D4A1
      * N :  MPR Act Purch Type 10 Hd
     I                                    P  65  680P5YOA1
      * N :  MPR Act Purch Type 11 Hd
     I                                    P  69  720P5YMA1
      * N :  MPR Est Purch Type 10 Hd
     I                                    P  73  760P5YNA1
      * N :  MPR Est Purch Type 11 Hd
     I                                    P  77  800P5YLA1
     IP6PARM      DS
      * O :  MPR Day Sts USR
     I                                        1   1 P6V8ST
     IP7PARM      DS
      * O :  MPR LS119A file created
     I                                        1   1 P7WBST
     IP8PARM      DS
      * B :  MPR LS119B file created
     I                                        1   1 P8V9ST
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1C2A1    PARM           WP0001  10       MPR Reporting T
     C           P2GGNB    PARM           WP0002  30       Company Number
     C           P3H8CD    PARM P3H8CD    WP0003  5        MPR Identificat
     C           P4ETDT    PARM P4ETDT    WP0004  70       MPR Reporting D
     C           P6V8ST    PARM P6V8ST    WP0005  1        MPR Day Sts USR
     C           P7WBST    PARM P7WBST    WP0006  1        MPR LS119A file
     C           P8V9ST    PARM P8V9ST    WP0007  1        MPR LS119B file
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Bld MPR Daily Prch Sm XF
      * Rtv System Date       UP - STR User Source Functions  * 
     C                     CALL 'PKPSUPR'              90  Rtv System Date
     C           P4ETDT    PARM *ZERO     WQ0001  70       *DATE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKPSUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * 03/26/09 PKD/RMC Do not need to check the Kill Day Sts.  Handled
      *                  by the scheduled job on the PC.
      * 11/02/2020 ISE H16853 - CHANGE BUY ORDER NUMBER FIELD LENGTH FROM
     C                     MOVEL'N'       YL0001           Invalid Y/N USR
      * Quit if the Current Date is not a Kill Day
      * CASE: LCL.Invalid Y/N USR is Yes
     C           YL0001    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       P6V8ST           MPR Day Sts USR
     C                     GOTO AAEXIT                     *QUIT
     C                     END                             *FI
     C                     MOVELP1C2A1    YL0002           BOH MPR Reporti
     C                     MOVEL'Y'       P6V8ST           MPR Day Sts USR
      * * Retrieve Plant Establishment Number from the Company Values *
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P2GGNB    WQ0002  30       BOH Company Num
     C                     PARM 'PLTESTNO'WQ0003 10        Company Value C
     C           P3H8CD    PARM *BLANK    WQ0004 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Read BOH for Actual BOL Plan Head Delivered per MPR Purchase Type
      *            IR Company
      *            IR Reporting Date
      *            IR Reporting Time
      *            S  Buy Order Type is not Internal
     C                     MOVELP1C2A1    YL0002           BOH MPR Reporti
      * Read Estimated Purchases for Estimated Head per MPR Purchase Type
      * Rtv MPR Estmtd 1 day  RT - MPR Estimated Purchases  * 
     C                     EXSR SARVGN
      * RMC 11.28.17 add BOH with reporting day=today=kill day to estimat
      * Rtv MPR Dly PrSm-Est  RT - Buy Order Header  * 
     C                     EXSR SBRVGN
      * Create/Change MPR Daily Detail Record      LS119B
      * Rtv MPR DlyPrchDtlCrt RT - Buy Order Header  * 
     C                     EXSR SFRVGN
      * Rcd may not been added if this is a rerun, so if rcds exist, set
      * CASE: LCL.Record Added Usr is No
     C           YL0003    IFEQ 'N'                        *IF
      * Rtv Val to Add        RT - MPR Daily Purchase Dtl  * 
     C                     EXSR TDRVGN
     C                     END                             *FI
      * If no record was added, set flag
      * CASE: LCL.Record Added Usr is No
     C           YL0003    IFEQ 'N'                        *IF
     C                     MOVEL'N'       P8V9ST           MPR LS119B file
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       P8V9ST           MPR LS119B file
      * Rtv Act for Summary   RT - MPR Daily Purchase Dtl  * 
     C                     EXSR TERVGN
     C                     END                             *FI
      * RMC 02/16/07 If afternoon Reportng Time (=2),add morning's actual
      * CASE: PAR.MPR Reporting Time is Afternoon Reporting Time
     C           P1C2A1    IFEQ 2                          *IF
     C                     Z-ADD1         WUC2A1           MPR Reporting T
      * Rtv Act for Summary   RT - MPR Daily Purchase Dtl  * 
     C                     EXSR TFRVGN
     C                     END                             *FI
      * Create/Change MPR Daily Summary Record  LS119A (must go with LS11
      * create blank rcd -- for all plants now. use this sts to control 8
     C                     MOVEL'Y'       YL0016           Status 1
      * Crt file if necessary, dont create blank record. Crt blank for bo
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5ORc6ORc7ORc8ORc9ORc10ORc11ORc12ORc13ORc14OR
      *  - c15ORc16ORc17ORc18ORc19ORc20ORc21ORc22
      *   |- c1    : PAR.MPR Act Purch Type 1 Hd is ne Zero
      *   |- c2    : PAR.MPR Act Purch Type 2 Hd is ne Zero
      *   |- c3    : PAR.MPR Act Purch Type 3 Hd is ne Zero
      *   |- c4    : PAR.MPR Act Purch Type 4 Hd is ne Zero
      *   |- c5    : PAR.MPR Act Purch Type 5 Hd is ne Zero
      *   |- c6    : PAR.MPR Act Purch Type 6 Hd is ne Zero
      *   |- c7    : PAR.MPR Act Purch Type 7 Hd is ne Zero
      *   |- c8    : PAR.MPR Act Purch Type 8 Hd is ne Zero
      *   |- c9    : PAR.MPR Est Purch Type 1 Hd is ne Zero
      *   |- c10   : PAR.MPR Est Purch Type 2 Hd is ne Zero
      *   |- c11   : PAR.MPR Est Purch Type 3 Hd is ne Zero
      *   |- c12   : PAR.MPR Est Purch Type 4 Hd is ne Zero
      *   |- c13   : PAR.MPR Est Purch Type 5 Hd is ne Zero
      *   |- c14   : PAR.MPR Est Purch Type 6 Hd is ne Zero
      *   |- c15   : PAR.MPR Est Purch Type 7 Hd is ne Zero
      *   |- c16   : PAR.MPR Est Purch Type 8 Hd is ne Zero
      *   |- c17   : PAR.MPR LS119B file created is Yes
      *   |- c18   : LCL.Status 1 is Yes
      *   |- c19   : PAR.MPR Act Purch Type 10 Hd is ne Zero
      *   |- c20   : PAR.MPR Act Purch Type 11 Hd is ne Zero
      *   |- c21   : PAR.MPR Est Purch Type 10 Hd is ne Zero
      *   |- c22   : PAR.MPR Est Purch Type 11 Hd is ne Zero
      *   '-
     C           P5EDA1    IFNE 0                          *IF
     C           P5EEA1    ORNE 0                          *OR
     C           P5EFA1    ORNE 0                          *OR
     C           P5EGA1    ORNE 0                          *OR
     C           P5D5A1    ORNE 0                          *OR
     C           P5D6A1    ORNE 0                          *OR
     C           P5D7A1    ORNE 0                          *OR
     C           P5D8A1    ORNE 0                          *OR
     C           P5D9A1    ORNE 0                          *OR
     C           P5EAA1    ORNE 0                          *OR
     C           P5EBA1    ORNE 0                          *OR
     C           P5ECA1    ORNE 0                          *OR
     C           P5D1A1    ORNE 0                          *OR
     C           P5D2A1    ORNE 0                          *OR
     C           P5D3A1    ORNE 0                          *OR
     C           P5D4A1    ORNE 0                          *OR
     C           P8V9ST    OREQ 'Y'                        *OR
     C           YL0016    OREQ 'Y'                        *OR
     C           P5YOA1    ORNE 0                          *OR
     C           P5YMA1    ORNE 0                          *OR
     C           P5YNA1    ORNE 0                          *OR
     C           P5YLA1    ORNE 0                          *OR
     C                     MOVEL'Y'       P7WBST           MPR LS119A file
      * For afternoon run, the Actual also goes in to the Estimated Hd
      * For AM run, the estimated is the estimated              11/03/17
      * RMC 8/19/20 Jerry L wants the Est to be the Actual on the AM run
      * as of NOW 11/3/17   -- changed 8/19/20 AM and afternoon run- both
      * CASE: PAR.MPR Reporting Time is Morning Reporting Time
     C           P1C2A1    IFEQ 1                          *IF
      * Rtv Crt/Chg Daily Sm  RT - MPR Daily Purchase Sum  * 
     C                     EXSR TGRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Crt/Chg Daily Sm  RT - MPR Daily Purchase Sum  * 
     C                     EXSR TJRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       P7WBST           MPR LS119A file
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv MPR Estmtd 1 day  RT - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHONB    WQSA01           CC Company Numb
     C           *LIKE     DEFN WAETDT    WQSA02           MPR Reporting D
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           CC Company Numb
     C                     KFLD           WQSA02           MPR Reporting D
      * Setup key
     C                     Z-ADDP2GGNB    WQSA01           CC Company Numb
     C                     Z-ADDP4ETDT    WQSA02           MPR Reporting D
      * Establish starting position
     C           KRSSA     SETLL@E4CPF7                    *
     C           KRSSA     READE@E4CPF7                  90*
      * Data record not found
     C   90                MOVEL'PRK0969' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWAC0A1    WUEIA1           MPR Purchase Ty
      * CASE: WRK.MPR Purchase Type is Negotiated
     C           WUEIA1    IFEQ 1                          *IF
     C                     Z-ADDWAC1A1    P5D9A1           MPR Est Purch T
     C                     ELSE
      * CASE: WRK.MPR Purchase Type is Oth Mkt Formula
     C           WUEIA1    IFEQ 2                          *IF
     C                     Z-ADDWAC1A1    P5EAA1           MPR Est Purch T
     C                     ELSE
      * CASE: WRK.MPR Purchase Type is Pork Mkt Formula
     C           WUEIA1    IFEQ 3                          *IF
     C                     Z-ADDWAC1A1    P5EBA1           MPR Est Purch T
     C                     ELSE
      * CASE: WRK.MPR Purchase Type is Oth Purchase Arng
     C           WUEIA1    IFEQ 4                          *IF
     C                     Z-ADDWAC1A1    P5ECA1           MPR Est Purch T
     C                     ELSE
      * CASE: WRK.MPR Purchase Type is PckSld Negotiated
     C           WUEIA1    IFEQ 5                          *IF
     C                     Z-ADDWAC1A1    P5D1A1           MPR Est Purch T
     C                     ELSE
      * CASE: WRK.MPR Purchase Type is PckSld Oth Mkt Formula
     C           WUEIA1    IFEQ 6                          *IF
     C                     Z-ADDWAC1A1    P5D2A1           MPR Est Purch T
     C                     ELSE
      * CASE: WRK.MPR Purchase Type is PckSld Pork Mkt Formula
     C           WUEIA1    IFEQ 7                          *IF
     C                     Z-ADDWAC1A1    P5D3A1           MPR Est Purch T
     C                     ELSE
      * CASE: WRK.MPR Purchase Type is PckSld Oth Purchase Arng
     C           WUEIA1    IFEQ 8                          *IF
     C                     Z-ADDWAC1A1    P5D4A1           MPR Est Purch T
     C                     ELSE
      * CASE: WRK.MPR Purchase Type is Other Neg Formula
     C           WUEIA1    IFEQ 10                         *IF
     C                     Z-ADDWAC1A1    P5YNA1           MPR Est Purch T
     C                     ELSE
      * CASE: WRK.MPR Purchase Type is PckSld Neg Formula
     C           WUEIA1    IFEQ 11                         *IF
     C                     Z-ADDWAC1A1    P5YLA1           MPR Est Purch T
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSA     READE@E4CPF7                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv MPR Dly PrSm-Est  RT - Buy Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHMNB    WQSB01           BOH Company Num
     C           *LIKE     DEFN WBD5DT    WQSB02           BOH MPR Reporti
     C           *LIKE     DEFN WBUZST    WQSB03           BOH MPR Reporti
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           BOH Company Num
     C                     KFLD           WQSB02           BOH MPR Reporti
     C                     KFLD           WQSB03           BOH MPR Reporti
      * Setup key
     C                     Z-ADDP2GGNB    WQSB01           BOH Company Num
     C                     Z-ADDP4ETDT    WQSB02           BOH MPR Reporti
     C                     MOVELYL0002    WQSB03           BOH MPR Reporti
      * Establish starting position
     C           KRSSB     SETLL@AWCPGQ                    *
     C           KRSSB     READE@AWCPGQ                  90*
      * Data record not found
     C   90                MOVEL'PRK0049' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * R7805 11/04/16 RMC R7805 Use new BOH Purch Type
      * S11998 11/28/17 RMC Reporting date=today and kill=today -- means
      *   these are not in the estimated head already. so add them here
      * RMC 5/21/19 Above only true for not NEG purch types (not 1,5) SO
      *   add OR to CASE to report them when the BOH was reported
      * RMC 6/03/19 do above it not prev reported - added status 2=BOH MP
      * Use New purch type from BOH if there
      * CASE: DB1.BOH MPR Purchase Type is *ALL values
     C           WBU1ST    IFEQ '01'                       *IF
     C           WBU1ST    OREQ '02'
     C           WBU1ST    OREQ '03'
     C           WBU1ST    OREQ '04'
     C           WBU1ST    OREQ '05'
     C           WBU1ST    OREQ '06'
     C           WBU1ST    OREQ '07'
     C           WBU1ST    OREQ '08'
     C           WBU1ST    OREQ '09'
     C           WBU1ST    OREQ '10'
     C           WBU1ST    OREQ '11'
     C                     MOVE WBU1ST    WUEIA1           MPR Purchase Ty
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV MPR Prdcr Purch TpRT - MPR Producer Purch Type  * 
     C                     EXSR SCRVGN
     C                     Z-ADDWUC0A1    WUEIA1           MPR Purchase Ty
     C                     END                             *FI
      * CASE:
      *  - c1OR(c2ORc3)
      *   |- c1    : DB1.BOH Kill Date EQ PAR.BOH MPR Reporting Date
      *   |- c2    : WRK.MPR Purchase Type is Negotiated
      *   |- c3    : WRK.MPR Purchase Type is PckSld Negotiated
      *   '-
     C           WBASDT    IFEQ P4ETDT                     *IF
     C           WUEIA1    OREQ 1                          *OR
     C           WUEIA1    OREQ 5                          *OR
      * Do if not previously reported
      * CASE: DB1.BOH Status 2 is Not Yes
     C           WBU0ST    IFEQ *BLANK                     *IF
      * Rtv Head Delv Pln MPR RT - Buy Order Load  * 
     C                     EXSR SDRVGN
      * CASE: WRK.MPR Purchase Type is Negotiated
     C           WUEIA1    IFEQ 1                          *IF
     C                     ADD  WUJRNB    P5D9A1           MPR Est Purch T
     C                     ELSE
      * CASE: WRK.MPR Purchase Type is Oth Mkt Formula
     C           WUEIA1    IFEQ 2                          *IF
     C                     ADD  WUJRNB    P5EAA1           MPR Est Purch T
     C                     ELSE
      * CASE: WRK.MPR Purchase Type is Pork Mkt Formula
     C           WUEIA1    IFEQ 3                          *IF
     C                     ADD  WUJRNB    P5EBA1           MPR Est Purch T
     C                     ELSE
      * CASE: WRK.MPR Purchase Type is Oth Purchase Arng
     C           WUEIA1    IFEQ 4                          *IF
     C                     ADD  WUJRNB    P5ECA1           MPR Est Purch T
     C                     ELSE
      * CASE: WRK.MPR Purchase Type is PckSld Negotiated
     C           WUEIA1    IFEQ 5                          *IF
     C                     ADD  WUJRNB    P5D1A1           MPR Est Purch T
     C                     ELSE
      * CASE: WRK.MPR Purchase Type is PckSld Oth Mkt Formula
     C           WUEIA1    IFEQ 6                          *IF
     C                     ADD  WUJRNB    P5D2A1           MPR Est Purch T
     C                     ELSE
      * CASE: WRK.MPR Purchase Type is PckSld Pork Mkt Formula
     C           WUEIA1    IFEQ 7                          *IF
     C                     ADD  WUJRNB    P5D3A1           MPR Est Purch T
     C                     ELSE
      * CASE: WRK.MPR Purchase Type is PckSld Oth Purchase Arng
     C           WUEIA1    IFEQ 8                          *IF
     C                     ADD  WUJRNB    P5D4A1           MPR Est Purch T
     C                     ELSE
      * CASE: WRK.MPR Pur Purchase Type is Other Neg Formula
     C           WUDYA1    IFEQ 10                         *IF
     C                     ADD  WUJRNB    P5YNA1           MPR Est Purch T
     C                     ELSE
      * CASE: WRK.MPR Pur Purchase Type is PckSld Neg Formula
     C           WUDYA1    IFEQ 11                         *IF
     C                     ADD  WUJRNB    P5YLA1           MPR Est Purch T
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Chg BOH MPR Est Sts   CH - Buy Order Header  * 
     C                     EXSR SECHRC
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSB     READE@AWCPGQ                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV MPR Prdcr Purch TpRT - MPR Producer Purch Type  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCABCD    WQSC01           PD Producer Cod
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           PD Producer Cod
      * Setup key
     C                     MOVELWBABCD    WQSC01           PD Producer Cod
      * Establish starting position
     C           KRSSC     SETLL@E3CPF4                    *
     C           KRSSC     READE@E3CPF4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0967' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUC0A1           MPR Purchase Ty
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCC0A1    WUC0A1           MPR Purchase Ty
     C                     GOTO SCEXIT                     *QUIT
     C           KRSSC     READE@E3CPF4                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Head Delv Pln MPR RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUJRNB           Buy Order Head
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDHMNB    WQSD01           BOH Company Num
     C           *LIKE     DEFN WDBNNB    WQSD02           BOH Buy Order N
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           BOH Company Num
     C                     KFLD           WQSD02           BOH Buy Order N
      * Setup key
     C                     Z-ADDWBHMNB    WQSD01           BOH Company Num
     C                     Z-ADDWBBNNB    WQSD02           BOH Buy Order N
      * Establish starting position
     C           KRSSD     SETLL@AXCPBX                    *
     C           KRSSD     READE@AXCPBX                  90*
      * Data record not found
     C   90                MOVEL'PRK0051' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WDBPNB    WUJRNB           Buy Order Head
     C           KRSSD     READE@AXCPBX                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECHRC    BEGSR
      *================================================================
      * Chg BOH MPR Est Sts   CH - Buy Order Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  70       BOH Buy Order D
     C                     Z-ADD*ZERO     WN0002  70       BOH Kill Date
     C                     MOVEL*BLANK    WN0003  1        BOH Payment Typ
     C                     MOVEL*BLANK    WN0004  1        BOH Buy Order T
     C                     Z-ADD*ZERO     WN0005  52       BOH Market Add/
     C                     MOVEL*BLANK    WN0006  1        BOH Status
     C                     MOVEL*BLANK    WN0007  1        BOH Delv Plan P
     C                     MOVEL*BLANK    WN0008  2        BOH Quote Price
     C                     Z-ADD*ZERO     WN0009  52       BOH Quoted Base
     C                     MOVEL*BLANK    WN0010  3        BOH Commodity M
     C                     MOVEL*BLANK    WN0011  7        BOH Commodity P
     C                     MOVEL*BLANK    WN0012  3        BOH Market Date
     C                     Z-ADD*ZERO     WN0013  70       BOH MPR Reporti
     C                     Z-ADD*ZERO     WN0014  70       BOH Hedge Date
     C                     Z-ADD*ZERO     WN0015  70       BOH Unused Date
     C                     Z-ADD*ZERO     WN0016  70       BOH Unused Date
     C                     Z-ADD*ZERO     WN0017  70       BOH Unused Date
     C                     Z-ADD*ZERO     WN0018  70       BOH Hedge Head
     C                     Z-ADD*ZERO     WN0019  70       BOH Hedge Refer
     C                     Z-ADD*ZERO     WN0020  70       BOH Hedge Time
     C                     Z-ADD*ZERO     WN0021  90       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0022  90       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0023  91       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0024  91       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0025 112       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0026 112       BOH Unused Nbr
     C                     Z-ADD*ZERO     WN0027 112       BOH Unused Nbr
     C                     MOVEL*BLANK    WN0028  1        BOH MPR Reporti
     C                     MOVEL*BLANK    WN0029  2        BOH MPR Purchas
     C                     MOVEL*BLANK    WN0030  3        BOH Status 4
     C                     MOVEL*BLANK    WN0031  3        BOH Status 5
     C                     Z-ADD*ZERO     WN0032  30       PPWS Company Nu
     C                     Z-ADD*ZERO     WN0033  40       CW Year
     C                     Z-ADD*ZERO     WN0034  20       CW Week Number
     C                     MOVEL*BLANK    WN0035  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0036  6        PL Location Cod
     C                     MOVEL*BLANK    WN0037  5        PC Contract Cod
     C                     MOVEL*BLANK    WN0038  5        PSC Sub-Contrac
     C                     MOVEL*BLANK    WN0039  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0040  3        PO Option Code
     C                     MOVEL*BLANK    WN0041  3        CMP Program Cod
     C                     MOVEL*BLANK    WN0042  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0043 10        RS User Changed
     C                     Z-ADD*ZERO     WN0044  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0045  60       RS Time Changed
     C                     MOVEL*BLANK    WN0046  1        RS Record Statu
     C                     MOVEL*BLANK    WN0047 10        RS Job
     C                     MOVEL*BLANK    WN0048 10        RS Program
     C                     MOVEL*BLANK    WN0049 10        RS User Added
     C                     Z-ADD*ZERO     WN0050  70       RS Date Added
     C                     Z-ADD*ZERO     WN0051  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @AWCPAZ
     C                     Z-ADDWBHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WEBNNB           BOH Buy Order N
      *
     C           KLCHSE    KLIST
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
     C           KLCHSE    CHAIN@AWCPAZ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKAWCPL0'MDACP
     C                     MOVEL'@AWCPAZ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKAW1    YARDCS
      * Move non-key fields to @AWCPAZ
     C                     MOVEL'Y'       WEU0ST    P      BOH MPR EST RPT
      *
      * Set PGM.*Record Data Changed flag
     C           QPKAW1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WEAAVN           RS User Changed
     C                     Z-ADD##JDT     WEAADT           RS Date Changed
     C                     Z-ADD##JTM     WEAMTM           RS Time Changed
     C                     MOVEL##JOB     WEAHVN           RS Job
     C                     MOVEL##PGM     WEAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKAW1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@AWCPAZ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKAWCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv MPR DlyPrchDtlCrt RT - Buy Order Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0052  5        MPR Identificat
     C                     Z-ADD*ZERO     WN0053  70       MPR Reporting D
     C                     MOVEL*BLANK    WN0054 25        MPR Lot Identif
     C                     Z-ADD*ZERO     WN0055  20       MPR Purchase Ty
     C                     Z-ADD*ZERO     WN0056  71       MPR Live Weight
     C                     Z-ADD*ZERO     WN0057  10       MPR Class Code
     C                     Z-ADD*ZERO     WN0058  60       MPR Head
     C                     Z-ADD*ZERO     WN0059  52       MPR Base Price
     C                     MOVEL*BLANK    WN0060  2        MPR Origin
     C                     MOVEL*BLANK    WN0061  1        MPR Origin from
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * S13526  RMC 8/1/18 add company value for when to use state code f
      *  the site on the 1st mkt tattoo on the load
      * PK0254  Create MPR Daily Purchase Detail File
      * RMC 11/29/06 Changes to report Triumph Open daily buys
      *   Initialize constant fields
     C                     Z-ADD1         WN0057           MPR Class Code
     C                     Z-ADDP4ETDT    WN0053           MPR Reporting D
     C                     Z-ADD*ZERO     WN0056           MPR Live Weight
     C                     Z-ADD*ZERO     WN0059           MPR Base Price
      * * Retrieve Plant Establishment Number from the Company Values *
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P2GGNB    WQ0005  30       BOH Company Num
     C                     PARM 'PLTESTNO'WQ0006 10        Company Value C
     C           WN0052    PARM *BLANK    WQ0007 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * * Use state code on Site? currently 440 only- from Company Values
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P2GGNB    WQ0008  30       BOH Company Num
     C                     PARM 'MPRORGST'WQ0009 10        Company Value C
     C           WN0061    PARM *BLANK    WQ0010 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'N'       YL0003           Record Added Us
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHMNB    WQSF01           BOH Company Num
     C           *LIKE     DEFN WBD5DT    WQSF02           BOH MPR Reporti
     C           *LIKE     DEFN WBUZST    WQSF03           BOH MPR Reporti
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           BOH Company Num
     C                     KFLD           WQSF02           BOH MPR Reporti
     C                     KFLD           WQSF03           BOH MPR Reporti
      * Setup key
     C                     Z-ADDP2GGNB    WQSF01           BOH Company Num
     C                     Z-ADDP4ETDT    WQSF02           BOH MPR Reporti
     C                     MOVELYL0002    WQSF03           BOH MPR Reporti
      * Establish starting position
     C           KRSSF     SETLL@AWCPGQ                    *
     C           KRSSF     READE@AWCPGQ                  90*
      * Data record not found
     C   90                MOVEL'PRK0049' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * R7805 11/04/16 RMC R7805 Use new BOH Purch Type
      * CASE: DB1.BOH MPR Purchase Type is *ALL values
     C           WBU1ST    IFEQ '01'                       *IF
     C           WBU1ST    OREQ '02'
     C           WBU1ST    OREQ '03'
     C           WBU1ST    OREQ '04'
     C           WBU1ST    OREQ '05'
     C           WBU1ST    OREQ '06'
     C           WBU1ST    OREQ '07'
     C           WBU1ST    OREQ '08'
     C           WBU1ST    OREQ '09'
     C           WBU1ST    OREQ '10'
     C           WBU1ST    OREQ '11'
     C                     MOVE WBU1ST    WN0055           MPR Purchase Ty
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV MPR Prdcr Purch TpRT - MPR Producer Purch Type  * 
     C                     EXSR SGRVGN
     C                     Z-ADDWUC0A1    WN0055           MPR Purchase Ty
     C                     END                             *FI
      * Rtv PL State          RT - Producer Location  * 
     C                     EXSR SHRVGN
     C                     Z-ADDWBALPR    WN0059           MPR Base Price
      * Original code before HEDGE  - E3577 RMC 11/6/14
      * CASE: DB1.BOH Buy Order Type is Not Hedge
     C           WBA5ST    IFEQ 'C'                        *IF
     C           WBA5ST    OREQ 'I'
     C           WBA5ST    OREQ 'O'
      * CASE: PAR.MPR Purchase Type is Packer Owned
     C           WN0055    IFEQ 9                          *IF
      * Exclude '9' per jerry   11/29/16
     C                     ELSE
      * CASE: *OTHERWISE
      * 11/30/16 added parms
      * Rtv Crt MPR Dly Dtl   RT - Buy Order Load  * 
     C                     EXSR SIRVGN
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSF     READE@AWCPGQ                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV MPR Prdcr Purch TpRT - MPR Producer Purch Type  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCABCD    WQSG01           PD Producer Cod
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           PD Producer Cod
      * Setup key
     C                     MOVELWBABCD    WQSG01           PD Producer Cod
      * Establish starting position
     C           KRSSG     SETLL@E3CPF4                    *
     C           KRSSG     READE@E3CPF4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0967' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUC0A1           MPR Purchase Ty
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCC0A1    WUC0A1           MPR Purchase Ty
     C                     GOTO SGEXIT                     *QUIT
     C           KRSSG     READE@E3CPF4                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv PL State          RT - Producer Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WFABCD           PD Producer Cod
     C                     KFLD           WFAECD           PL Location Cod
      * Setup key
     C                     MOVELWBABCD    WFABCD           PD Producer Cod
     C                     MOVELWBAECD    WFAECD           PL Location Cod
      * Establish starting position
     C           KRSSH     CHAIN@AFREAR              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0015' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0060           PL State Code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFN0TX    WN0060           PL State Code
     C                     GOTO SHEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Crt MPR Dly Dtl   RT - Buy Order Load  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0062 25        MPR Lot Identif
     C                     Z-ADD*ZERO     WN0063  60       MPR Head
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDHMNB    WQSI01           BOH Company Num
     C           *LIKE     DEFN WDBNNB    WQSI02           BOH Buy Order N
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           BOH Company Num
     C                     KFLD           WQSI02           BOH Buy Order N
      * Setup key
     C                     Z-ADDWBHMNB    WQSI01           BOH Company Num
     C                     Z-ADDWBBNNB    WQSI02           BOH Buy Order N
      * Establish starting position
     C           KRSSI     SETLL@AXCPBX                    *
     C           KRSSI     READE@AXCPBX                  90*
      * Data record not found
     C   90                MOVEL'PRK0051' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RMC S11374 8.1.17 added chk to Reported to USDA, dont report agai
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.RS Record Status is Active
      *   |- c2    : DB1.Reported to USDA is Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WDAJST    IFEQ 'A'                        *IF
     C           WDPBST    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * rmc added the record status check 04/23/07
     C                     MOVEL*BLANK    WUP8TX           Buy Order Numbe
     C                     MOVELWDBNNB    WUP8TX           Buy Order Numbe
     C                     MOVEL*BLANK    WUP9TX           Buy Order Load
     C                     MOVELWDBONB    WUP9TX           Buy Order Load
     C                     Z-ADD0         ZQ      50
     C           WUP8TX    CAT  WUP9TX:ZQ WN0062    P      MPR Lot Identif
      * 11/9/17
      * CASE: DB1.BOL Head Received is GT Zero
     C           WDDHNB    IFGT 0                          *IF
     C                     Z-ADDWDDHNB    WN0063           MPR Head
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWDBPNB    WN0063           MPR Head
     C                     END                             *FI
      * New code as of 11/29/06               RMC per Mike Lynch
      * CASE: PAR.MPR Base Price is Entered
     C           WN0059    IFNE 0                          *IF
      * CASE: PAR.BOH Buy Order Type is Open Market
     C           WBA5ST    IFEQ 'O'                        *IF
      * CASE: PAR.BOH Quote Price Type is Carcass Price
     C           WBB3ST    IFEQ 'CP'                       *IF
     C                     MOVELWN0060    YL0004           MPR Origin
      * Get state from site on first mkt tattoo
      * CASE: PAR.MPR Origin from Site USR is Yes
     C           WN0061    IFEQ 'Y'                        *IF
      * Rtv Site ID f/mkt tt   RT - Tattoo Header EXT  * 
     C                     EXSR SJRVGN
      * CASE: WRK.PS State is Entered
     C           WUT2TX    IFNE *BLANK                     *IF
     C                     MOVELWUT2TX    YL0004           MPR Origin
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv State f/mpr       RT - Tattoo Header  * 
     C                     EXSR SMRVGN
      * CASE: WRK.TH State is Entered
     C           WUNZTX    IFNE *BLANK                     *IF
     C                     MOVELWUNZTX    YL0004           MPR Origin
     C                     END                             *FI
     C                     END                             *FI
      * Rtv Crt/Chg Daily Dtl RT - MPR Daily Purchase Dtl  * 
     C                     EXSR SNRVGN
      * RMC 8.1.17 S11374 added so BOLs dont get reported twice
      * Chg Report to USDA    CH - Buy Order Load  * 
     C                     EXSR SQCHRC
      * CASE: PAR.Record Added Usr is No
     C           YL0003    IFEQ 'N'                        *IF
     C                     MOVEL'Y'       YL0003           Record Added Us
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Add New code as of 11/10/16 RMC per USDA: report what was on LS11
      * CASE: PAR.MPR Base Price is EQ zero
     C           WN0059    IFEQ 0                          *IF
      * RMC 11.27.17  init  to -0-
     C                     Z-ADD*ZERO     WUAMPR           TH CM Base Mkt
      * Rtv Base Prc/Hd f/MPR RT - Tattoo Header  * 
     C                     EXSR SRRVGN
      * RMC 11/14/17 use delv head if recvd not there and kill date is re
      * CASE: DB1.BOL Kill Date LE PAR.MPR Reporting Date
     C           WDCQDT    IFLE WN0053                     *IF
      * CASE: WRK.MPR Pur Head is eq Zero
     C           WUDZA1    IFEQ 0                          *IF
     C                     Z-ADDWDBPNB    WUDZA1           MPR Pur Head
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD0         WUDZA1           MPR Pur Head
     C                     END                             *FI
      * Added 11/30/16 to get price for held over tt
      * CASE: WRK.TH CM Base Mkt Price is Zeros
     C           WUAMPR    IFEQ 0                          *IF
      * Rtv Base Price        RT - Tattoo Header  * 
     C                     EXSR SSRVGN
     C                     END                             *FI
      * CASE:
      *  - c1ANDc2
      *   |- c1    : WRK.MPR Pur Head is ne Zero
      *   |- c2    : WRK.TH CM Base Mkt Price is Not Zeros
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUDZA1    IFNE 0                          *IF
     C           WUAMPR    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RMC 11/21/17 added chk for price too
      * RMC 11.22.16 dont output live wgt since this is Carcass priced
     C                     MOVELWN0060    YL0004           MPR Origin
      * Get state from site on first mkt tattoo
      * CASE: PAR.MPR Origin from Site USR is Yes
     C           WN0061    IFEQ 'Y'                        *IF
      * Rtv Site ID f/mkt tt   RT - Tattoo Header EXT  * 
     C                     EXSR SVRVGN
      * CASE: WRK.PS State is Entered
     C           WUT2TX    IFNE *BLANK                     *IF
     C                     MOVELWUT2TX    YL0004           MPR Origin
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv State f/mpr       RT - Tattoo Header  * 
     C                     EXSR SYRVGN
      * CASE: WRK.TH State is Entered
     C           WUNZTX    IFNE *BLANK                     *IF
     C                     MOVELWUNZTX    YL0004           MPR Origin
     C                     END                             *FI
     C                     END                             *FI
      * Rtv Crt/Chg Daily Dtl RT - MPR Daily Purchase Dtl  * 
     C                     EXSR SZRVGN
      * RMC 8.1.17 S11374 added so BOLs dont get reported twice
      * Chg Report to USDA    CH - Buy Order Load  * 
     C                     EXSR TCCHRC
      * CASE: PAR.Record Added Usr is No
     C           YL0003    IFEQ 'N'                        *IF
     C                     MOVEL'Y'       YL0003           Record Added Us
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSI     READE@AXCPBX                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Site ID f/mkt tt   RT - Tattoo Header EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    WUT2TX           PS State
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGHMNB    WQSJ01           BOH Company Num
     C           *LIKE     DEFN WGBNNB    WQSJ02           BOH Buy Order N
     C           *LIKE     DEFN WGBONB    WQSJ03           BOL Load Number
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           BOH Company Num
     C                     KFLD           WQSJ02           BOH Buy Order N
     C                     KFLD           WQSJ03           BOL Load Number
      * Setup key
     C                     Z-ADDWDHMNB    WQSJ01           BOH Company Num
     C                     Z-ADDWDBNNB    WQSJ02           BOH Buy Order N
     C                     Z-ADDWDBONB    WQSJ03           BOL Load Number
      * Establish starting position
     C           KRSSJ     SETLL@DNCPUY                    *
     C           KRSSJ     READE@DNCPUY                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0637' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUT2TX           PS State
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * get the state for the site on the 1st mkt tattoo
      * CASE: DB1.PS Site ID is Not Blank
     C           WGNYCD    IFNE *BLANK                     *IF
      * Rtv Class Type        RT - Tattoo Header  * 
     C                     EXSR SKRVGN
      * CASE: WRK.TH Hog Class Type is Market
     C           WULLST    IFEQ 'M'                        *IF
      * Rtv Site State WRTN   RT - Producer Site  * 
     C                     EXSR SLRVGN
      * CASE: WRK.PS State is Entered
     C           WUT2TX    IFNE *BLANK                     *IF
     C                     MOVELWUT2TX    WUT2TX           PS State
     C                     GOTO SJEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSJ     READE@DNCPUY                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Class Type        RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHHMNB    WQSK01           BOH Company Num
     C           *LIKE     DEFN WHBNNB    WQSK02           BOH Buy Order N
     C           *LIKE     DEFN WHBONB    WQSK03           BOL Load Number
     C           *LIKE     DEFN WHCVNB    WQSK04           TH Tattoo Numbe
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           BOH Company Num
     C                     KFLD           WQSK02           BOH Buy Order N
     C                     KFLD           WQSK03           BOL Load Number
     C                     KFLD           WQSK04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWGHMNB    WQSK01           BOH Company Num
     C                     Z-ADDWGBNNB    WQSK02           BOH Buy Order N
     C                     Z-ADDWGBONB    WQSK03           BOL Load Number
     C                     Z-ADDWGCVNB    WQSK04           TH Tattoo Numbe
      * Establish starting position
     C           KRSSK     SETLL@A1CPOI                    *
     C           KRSSK     READE@A1CPOI                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WULLST           TH Hog Class Ty
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHLLST    WULLST           TH Hog Class Ty
     C           KRSSK     READE@A1CPOI                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Site State WRTN   RT - Producer Site  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WIABCD           PD Producer Cod
     C                     KFLD           WINYCD           PS Site ID
      * Setup key
     C                     MOVELWGABCD    WIABCD           PD Producer Cod
     C                     MOVELWGNYCD    WINYCD           PS Site ID
      * Establish starting position
     C           KRSSL     CHAIN@ATRELM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1137' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUT2TX           PS State
     C                     MOVEL*BLANK    WURTN            *Return code
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWIT2TX    WUT2TX           PS State
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv State f/mpr       RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJHMNB    WQSM01           BOH Company Num
     C           *LIKE     DEFN WJBNNB    WQSM02           BOH Buy Order N
     C           *LIKE     DEFN WJBONB    WQSM03           BOL Load Number
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           BOH Company Num
     C                     KFLD           WQSM02           BOH Buy Order N
     C                     KFLD           WQSM03           BOL Load Number
      * Setup key
     C                     Z-ADDWDHMNB    WQSM01           BOH Company Num
     C                     Z-ADDWDBNNB    WQSM02           BOH Buy Order N
     C                     Z-ADDWDBONB    WQSM03           BOL Load Number
      * Establish starting position
     C           KRSSM     SETLL@A1CPC4                    *
     C           KRSSM     READE@A1CPC4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUNZTX           TH State
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.TH Hog Class Type is Market
     C           WJLLST    IFEQ 'M'                        *IF
      * PAR = DB1 By name
     C                     MOVELWJNZTX    WUNZTX           TH State
     C                     GOTO SMEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSM     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Crt/Chg Daily Dtl RT - MPR Daily Purchase Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WKH8CD           MPR Identificat
     C                     KFLD           WKETDT           MPR Reporting D
     C                     KFLD           WKC2A1           MPR Reporting T
     C                     KFLD           WKIBCD           MPR Lot Identif
      * Setup key
     C                     MOVELWN0052    WKH8CD           MPR Identificat
     C                     Z-ADDWN0053    WKETDT           MPR Reporting D
     C                     Z-ADDP1C2A1    WKC2A1           MPR Reporting T
     C                     MOVELWN0062    WKIBCD           MPR Lot Identif
      * Establish starting position
     C           KRSSN     CHAIN@E9CPGG              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0979' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Daily Purch Dtl   CR - MPR Daily Purchase Dtl  * 
     C                     EXSR SOCRRC
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Daily Purch Dtl   CH - MPR Daily Purchase Dtl  * 
     C                     EXSR SPCHRC
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCRRC    BEGSR
      *================================================================
      * Crt Daily Purch Dtl   CR - MPR Daily Purchase Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @E9CPGF
     C                     MOVELWN0052    WLH8CD           MPR Identificat
     C                     Z-ADDWN0053    WLETDT           MPR Reporting D
     C                     Z-ADDP1C2A1    WLC2A1           MPR Reporting T
     C                     MOVELWN0062    WLIBCD           MPR Lot Identif
     C                     Z-ADDWN0055    WLEIA1           MPR Purchase Ty
     C                     Z-ADDWN0056    WLEJA1           MPR Live Weight
     C                     Z-ADDWN0057    WLEKA1           MPR Class Code
     C                     Z-ADDWN0063    WLELA1           MPR Head
     C                     Z-ADDWN0059    WLU0PR           MPR Base Price
     C                     MOVELYL0004    WLIDCD           MPR Origin
     C                     MOVEL*BLANK    WLAAVN           RS User Changed
     C                     Z-ADD*ZERO     WLAADT           RS Date Changed
     C                     Z-ADD*ZERO     WLAMTM           RS Time Changed
     C                     MOVELWDAJST    WLAJST           RS Record Statu
     C                     MOVELWDAHVN    WLAHVN           RS Job
     C                     MOVELWDAGVN    WLAGVN           RS Program
     C                     MOVELWDABVN    WLABVN           RS User Added
     C                     Z-ADDWDABDT    WLABDT           RS Date Added
     C                     Z-ADDWDABTM    WLABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       WLAJST           RS Record Statu
     C                     MOVEL##USR     WLABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WLABDT    PARM *ZERO     WQ0011  70       *DATE
     C           WLABTM    PARM *ZERO     WQ0012  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     WLAGVN           RS Program
     C                     MOVEL##JOB     WLAHVN           RS Job
     C           KLCRSO    KLIST
     C                     KFLD           WLH8CD           MPR Identificat
     C                     KFLD           WLETDT           MPR Reporting D
     C                     KFLD           WLC2A1           MPR Reporting T
     C                     KFLD           WLIBCD           MPR Lot Identif
      * Check for duplicate primary key
     C           KLCRSO    SETLL@E9CPGF                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0980' W0RTN   7
      * Send message 'MPR Daily Purchase Dtl EX'
     C                     MOVEL'PRK0980' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C                     WRITE@E9CPGF                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPCHRC    BEGSR
      *================================================================
      * Chg Daily Purch Dtl   CH - MPR Daily Purchase Dtl  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0064 10        RS User Changed
     C                     Z-ADD*ZERO     WN0065  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0066  60       RS Time Changed
     C                     MOVEL*BLANK    WN0067  1        RS Record Statu
     C                     MOVEL*BLANK    WN0068 10        RS Job
     C                     MOVEL*BLANK    WN0069 10        RS Program
     C                     MOVEL*BLANK    WN0070 10        RS User Added
     C                     Z-ADD*ZERO     WN0071  70       RS Date Added
     C                     Z-ADD*ZERO     WN0072  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @E9CPGF
     C                     MOVELWKH8CD    WLH8CD    P      MPR Identificat
     C                     Z-ADDWKETDT    WLETDT           MPR Reporting D
     C                     Z-ADDWKC2A1    WLC2A1           MPR Reporting T
     C                     MOVELWN0062    WLIBCD    P      MPR Lot Identif
      *
     C           KLCHSP    KLIST
     C                     KFLD           WLH8CD           MPR Identificat
     C                     KFLD           WLETDT           MPR Reporting D
     C                     KFLD           WLC2A1           MPR Reporting T
     C                     KFLD           WLIBCD           MPR Lot Identif
     C           KLCHSP    CHAIN@E9CPGF              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKE9CPL0'MDACP
     C                     MOVEL'@E9CPGF' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKE91    YBRDCS
      * Move non-key fields to @E9CPGF
     C                     Z-ADDWN0055    WLEIA1           MPR Purchase Ty
     C                     Z-ADDWN0056    WLEJA1           MPR Live Weight
     C                     Z-ADDWN0057    WLEKA1           MPR Class Code
     C                     Z-ADDWN0063    WLELA1           MPR Head
     C                     Z-ADDWN0059    WLU0PR           MPR Base Price
     C                     MOVELYL0004    WLIDCD    P      MPR Origin
      *
      * Set PGM.*Record Data Changed flag
     C           QPKE91    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp-SysDtIF
     C                     MOVEL##USR     WLAAVN           RS User Changed
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WLAADT    PARM *ZERO     WQ0013  70       *DATE
     C           WLAMTM    PARM *ZERO     WQ0014  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##JOB     WLAHVN           RS Job
     C                     MOVEL##PGM     WLAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKE91    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@E9CPGF                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKE9CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQCHRC    BEGSR
      *================================================================
      * Chg Report to USDA    CH - Buy Order Load  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0073  70       BOL Kill Date
     C                     Z-ADD*ZERO     WN0074  40       BOL Pln Delv St
     C                     Z-ADD*ZERO     WN0075  40       BOL Pln Delv En
     C                     Z-ADD*ZERO     WN0076  50       BOL Pln Head De
     C                     Z-ADD*ZERO     WN0077  71       BOL Shipped Wgt
     C                     Z-ADD*ZERO     WN0078  70       BOL Pln Delv Da
     C                     MOVEL*BLANK    WN0079  2        BOL Freight UOM
     C                     Z-ADD*ZERO     WN0080  72       BOL Freight Uni
     C                     Z-ADD*ZERO     WN0081  72       BOL Freight Amt
     C                     MOVEL*BLANK    WN0082  1        BOL Freight All
     C                     Z-ADD*ZERO     WN0083  70       BOL Head Receiv
     C                     Z-ADD*ZERO     WN0084  71       BOL Live Wgt Re
     C                     MOVEL*BLANK    WN0085  2        BOL Trucker Pay
     C                     Z-ADD*ZERO     WN0086  80       BOL Trucker Che
     C                     Z-ADD*ZERO     WN0087  70       BOL Trucker Che
     C                     Z-ADD*ZERO     WN0088  80       BOL AP Voucher
     C                     MOVEL*BLANK    WN0089 11        BOL Trailer
     C                     MOVEL*BLANK    WN0090  1        BOL Freight Exp
     C                     MOVEL*BLANK    WN0091  1        BOL Scheduled K
     C                     MOVEL*BLANK    WN0092  1        BOL Truck Scale
     C                     Z-ADD*ZERO     WN0093  50       BOL Shipped Hea
     C                     MOVEL*BLANK    WN0094  1        BOL MPR Prior D
     C                     MOVEL*BLANK    WN0095  1        BOL Violated Au
     C                     MOVEL*BLANK    WN0096  2        BOL Status 5
     C                     MOVEL*BLANK    WN0097  2        BOL Status 6
     C                     MOVEL*BLANK    WN0098  3        BOL Status 7
     C                     Z-ADD*ZERO     WN0099  70       BOL HPS Movemen
     C                     Z-ADD*ZERO     WN0100  70       BOL Head LFT
     C                     Z-ADD*ZERO     WN0101  70       BOL Head EUT/KO
     C                     Z-ADD*ZERO     WN0102  70       BOL Auth Gate E
     C                     Z-ADD*ZERO     WN0103  70       BOL Head Receiv
     C                     Z-ADD*ZERO     WN0104 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0105 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0106 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0107 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0108 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0109  70       BOL Auth Gate E
     C                     Z-ADD*ZERO     WN0110  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0111  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0112  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0113  70       BOL Unused Date
     C                     MOVEL*BLANK    WN0114  3        TRK Trucker Cod
     C                     MOVEL*BLANK    WN0115  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0116  6        PL Location Cod
     C                     MOVEL*BLANK    WN0117 10        RS User Changed
     C                     Z-ADD*ZERO     WN0118  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0119  60       RS Time Changed
     C                     MOVEL*BLANK    WN0120  1        RS Record Statu
     C                     MOVEL*BLANK    WN0121 10        RS Job
     C                     MOVEL*BLANK    WN0122 10        RS Program
     C                     MOVEL*BLANK    WN0123 10        RS User Added
     C                     Z-ADD*ZERO     WN0124  70       RS Date Added
     C                     Z-ADD*ZERO     WN0125  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @AXCPBY
     C                     Z-ADDWDHMNB    WMHMNB           BOH Company Num
     C                     Z-ADDWDBNNB    WMBNNB           BOH Buy Order N
     C                     Z-ADDWDBONB    WMBONB           BOL Load Number
      *
     C           KLCHSQ    KLIST
     C                     KFLD           WMHMNB           BOH Company Num
     C                     KFLD           WMBNNB           BOH Buy Order N
     C                     KFLD           WMBONB           BOL Load Number
     C           KLCHSQ    CHAIN@AXCPBY              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKAXCPL1'MDACP
     C                     MOVEL'@AXCPBY' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SQEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKAX1    YCRDCS
      * Move non-key fields to @AXCPBY
     C                     MOVEL'Y'       WMPBST    P      Reported to USD
      *
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WMAAVN           RS User Changed
     C                     Z-ADD##JDT     WMAADT           RS Date Changed
     C                     Z-ADD##JTM     WMAMTM           RS Time Changed
     C                     MOVEL##JOB     WMAHVN           RS Job
     C                     MOVEL##PGM     WMAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@AXCPBY                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKAXCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv Base Prc/Hd f/MPR RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUDZA1           MPR Pur Head
      * Declare restrictor key work fields
     C           *LIKE     DEFN WOHMNB    WQSR01           BOH Company Num
     C           *LIKE     DEFN WOBNNB    WQSR02           BOH Buy Order N
     C           *LIKE     DEFN WOBONB    WQSR03           BOL Load Number
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           BOH Company Num
     C                     KFLD           WQSR02           BOH Buy Order N
     C                     KFLD           WQSR03           BOL Load Number
      * Setup key
     C                     Z-ADDWDHMNB    WQSR01           BOH Company Num
     C                     Z-ADDWDBNNB    WQSR02           BOH Buy Order N
     C                     Z-ADDWDBONB    WQSR03           BOL Load Number
      * Establish starting position
     C           KRSSR     SETLL@A1CPOC                    *
     C           KRSSR     READE@A1CPOC                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WUAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WUDZA1           MPR Pur Head
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.TH CM Base Mkt Price is Not Zeros
     C           WOAMPR    IFNE 0                          *IF
     C                     Z-ADDWOAMPR    WUAMPR           TH CM Base Mkt
     C                     END                             *FI
      * CASE: DB1.TH Hog Class Type is Market
     C           WOLLST    IFEQ 'M'                        *IF
     C                     ADD  WOCWNB    WUDZA1           MPR Pur Head
     C                     Z-ADDWOF7NB    WUF7NB           TH Avg Live Wgt
     C                     END                             *FI
     C           KRSSR     READE@A1CPOC                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv Base Price        RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WOHMNB    WQSS01           BOH Company Num
     C           *LIKE     DEFN WOBNNB    WQSS02           BOH Buy Order N
     C           *LIKE     DEFN WOBONB    WQSS03           BOL Load Number
     C           *LIKE     DEFN WOB0DT    WQSS04           TH Kill Date
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS01           BOH Company Num
     C                     KFLD           WQSS02           BOH Buy Order N
     C                     KFLD           WQSS03           BOL Load Number
     C                     KFLD           WQSS04           TH Kill Date
      * Setup key
     C                     Z-ADDWDHMNB    WQSS01           BOH Company Num
     C                     Z-ADDWDBNNB    WQSS02           BOH Buy Order N
     C                     Z-ADDWDBONB    WQSS03           BOL Load Number
     C                     Z-ADDWDCQDT    WQSS04           TH Kill Date
      * Establish starting position
     C           KRSSS     SETLL@A1CPOC                    *
     C           KRSSS     READE@A1CPOC                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0005           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WUAMPR           TH CM Base Mkt
      * S12837 RMC - get sub-ctr info for price calc. 3/26/18 cpy here fr
     C                     Z-ADD*ZERO     YL0006           PSC Market Perc
     C                     Z-ADD*ZERO     YL0007           PSC Mkt Percent
     C                     Z-ADD*ZERO     YL0008           PSC Break Even
      * Rtv PrSb-Cont Carc/Sm RT - Producer Sub-Contract  * 
     C                     EXSR STRVGN
      * Clc Base Mkt Price    XF - Pricing Option  * 
     C                     CALL 'PKJ7XFR'              90  Clc Base Mkt Pr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WDBNNB    WQ0015  70       BOH Buy Order N
     C                     PARM WDBONB    WQ0016  50       BOL Load Number
     C                     PARM YL0009    WQ0017  50       TH Tattoo Numbe
     C                     PARM WDCQDT    WQ0018  70       TH Purchase Dat
     C                     PARM YL0010    WQ0019  71       TH Live Wgt
     C           WUAMPR    PARM *ZERO     WQ0020  52       TH CM Base Mkt
     C                     PARM WDCQDT    WQ0021  70       TH Kill Date
     C                     PARM WDHMNB    WQ0022  30       BOH Company Num
     C                     PARM YL0011    WQ0023  52       PSC Floor Price
     C                     PARM YL0012    WQ0024  52       PSC Ceiling Pri
     C                     PARM YL0006    WQ0025  30       PSC Market Perc
     C                     PARM YL0007    WQ0026  52       PSC Mkt Percent
     C           YL0013    PARM YL0013    WQ0027  52       Market Price US
     C           YL0014    PARM *BLANK    WQ0028  2        Pricing UOM USR
     C           YL0015    PARM *ZERO     WQ0029  70       Pricing Date US
     C                     PARM WBAICD    WQ0030  3        PO Option Code
     C                     PARM WBAKCD    WQ0031  5        PC Contract Cod
     C                     PARM WBALCD    WQ0032  5        PSC Sub-Contrac
     C                     PARM WBAAPR    WQ0033  52       BOH Market Add/
     C                     PARM WBAMCD    WQ0034  3        CMP Program Cod
     C                     PARM WBB3ST    WQ0035  2        BOH Quote Price
     C                     PARM WBALPR    WQ0036  52       BOH Quoted Base
     C                     PARM WBETCD    WQ0037  3        BOH Commodity M
     C                     PARM WBEUCD    WQ0038  7        BOH Commodity P
     C                     PARM WBJ5TX    WQ0039  3        BOH Market Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKJ7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PAR.TH CM Base Mkt Price EQ PAR.BOH Market Add/Deduct
     C           WUAMPR    IFEQ WBAAPR                     *IF
     C                     Z-ADD*ZERO     WUAMPR           TH CM Base Mkt
     C                     END                             *FI
      * 11/01/17 RMC also check for date being hit with market date metho
      * CASE: PAR.TH Kill Date GT JOB.*Job date
     C           WDCQDT    IFGT ##JDT                      *IF
      * 11/9/17  dont chk market date method. its true for PP1 and  CUR
      * CASE: PAR.BOH Quoted Base Mkt Price is Zeros
     C           WBALPR    IFEQ 0                          *IF
      * 04/12/18 report a quoted base market priced load- dont zero it ou
     C                     Z-ADD*ZERO     WUAMPR           TH CM Base Mkt
     C                     END                             *FI
     C                     END                             *FI
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * S00313 RMC - get sub-ctr info for price calc. it was 000000
     C                     Z-ADD*ZERO     YL0006           PSC Market Perc
     C                     Z-ADD*ZERO     YL0007           PSC Mkt Percent
     C                     Z-ADD*ZERO     YL0008           PSC Break Even
      * Rtv PrSb-Cont Carc/Sm RT - Producer Sub-Contract  * 
     C                     EXSR SURVGN
      * Clc Base Mkt Price    XF - Pricing Option  * 
     C                     CALL 'PKJ7XFR'              90  Clc Base Mkt Pr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WOBNNB    WQ0040  70       BOH Buy Order N
     C                     PARM WOBONB    WQ0041  50       BOL Load Number
     C                     PARM WOCVNB    WQ0042  50       TH Tattoo Numbe
     C                     PARM WOAWDT    WQ0043  70       TH Purchase Dat
     C                     PARM WOCYNB    WQ0044  71       TH Live Wgt
     C           WUAMPR    PARM *ZERO     WQ0045  52       TH CM Base Mkt
     C                     PARM WOB0DT    WQ0046  70       TH Kill Date
     C                     PARM WOHMNB    WQ0047  30       BOH Company Num
     C                     PARM YL0011    WQ0048  52       PSC Floor Price
     C                     PARM YL0012    WQ0049  52       PSC Ceiling Pri
     C                     PARM YL0006    WQ0050  30       PSC Market Perc
     C                     PARM YL0007    WQ0051  52       PSC Mkt Percent
     C           YL0013    PARM YL0013    WQ0052  52       Market Price US
     C           YL0014    PARM *BLANK    WQ0053  2        Pricing UOM USR
     C           YL0015    PARM *ZERO     WQ0054  70       Pricing Date US
     C                     PARM WBAICD    WQ0055  3        PO Option Code
     C                     PARM WBAKCD    WQ0056  5        PC Contract Cod
     C                     PARM WBALCD    WQ0057  5        PSC Sub-Contrac
     C                     PARM WBAAPR    WQ0058  52       BOH Market Add/
     C                     PARM WBAMCD    WQ0059  3        CMP Program Cod
     C                     PARM WBB3ST    WQ0060  2        BOH Quote Price
     C                     PARM WBALPR    WQ0061  52       BOH Quoted Base
     C                     PARM WBETCD    WQ0062  3        BOH Commodity M
     C                     PARM WBEUCD    WQ0063  7        BOH Commodity P
     C                     PARM WBJ5TX    WQ0064  3        BOH Market Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKJ7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * IF PRICE = + - DED, THEN ZERO IT OUT
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.TH CM Base Mkt Price EQ PAR.BOH Market Add/Deduc
      *   |- c2    : PAR.TH CM Base Mkt Price is LT 1.00
      *   '-
     C           WUAMPR    IFEQ WBAAPR                     *IF
     C           WUAMPR    ORLT 1                          *OR
      * RMC 4/25/06 added comp lt 1
     C                     Z-ADD*ZERO     WUAMPR           TH CM Base Mkt
     C                     END                             *FI
      * 11/01/17 RMC also check for date being hit with market date metho
      * CASE: DB1.TH Purchase Date GT JOB.*Job date
     C           WOAWDT    IFGT ##JDT                      *IF
      * CASE: PAR.BOH Quoted Base Mkt Price is Zeros
     C           WBALPR    IFEQ 0                          *IF
      * 04/12/18 report a quoted base market priced load- dont zero it ou
      * 11/9/17  dont chk market date method. its true for PP1 and  CUR
     C                     Z-ADD*ZERO     WUAMPR           TH CM Base Mkt
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWOF7NB    YL0005           TH Avg Live Wgt
     C                     GOTO SSEXIT                     *QUIT
     C           KRSSS     READE@A1CPOC                  90*
     C                     ENDDO
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Rtv PrSb-Cont Carc/Sm RT - Producer Sub-Contract  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WRAKCD           PC Contract Cod
     C                     KFLD           WRALCD           PSC Sub-Contrac
      * Setup key
     C                     MOVELWBAKCD    WRAKCD           PC Contract Cod
     C                     MOVELWBALCD    WRALCD           PSC Sub-Contrac
      * Establish starting position
     C           KRSST     CHAIN@AQCPA0              90    *
      * Data record not found
     C   90                MOVEL'PRK0037' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWRA9PC    YL0006           PSC Market Perc
     C                     Z-ADDWRA7PR    YL0008           PSC Break Even
     C                     Z-ADDWRA9PR    YL0007           PSC Mkt Percent
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Rtv PrSb-Cont Carc/Sm RT - Producer Sub-Contract  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WRAKCD           PC Contract Cod
     C                     KFLD           WRALCD           PSC Sub-Contrac
      * Setup key
     C                     MOVELWBAKCD    WRAKCD           PC Contract Cod
     C                     MOVELWBALCD    WRALCD           PSC Sub-Contrac
      * Establish starting position
     C           KRSSU     CHAIN@AQCPA0              90    *
      * Data record not found
     C   90                MOVEL'PRK0037' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWRA9PC    YL0006           PSC Market Perc
     C                     Z-ADDWRA7PR    YL0008           PSC Break Even
     C                     Z-ADDWRA9PR    YL0007           PSC Mkt Percent
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Rtv Site ID f/mkt tt   RT - Tattoo Header EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    WUT2TX           PS State
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGHMNB    WQSV01           BOH Company Num
     C           *LIKE     DEFN WGBNNB    WQSV02           BOH Buy Order N
     C           *LIKE     DEFN WGBONB    WQSV03           BOL Load Number
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV01           BOH Company Num
     C                     KFLD           WQSV02           BOH Buy Order N
     C                     KFLD           WQSV03           BOL Load Number
      * Setup key
     C                     Z-ADDWDHMNB    WQSV01           BOH Company Num
     C                     Z-ADDWDBNNB    WQSV02           BOH Buy Order N
     C                     Z-ADDWDBONB    WQSV03           BOL Load Number
      * Establish starting position
     C           KRSSV     SETLL@DNCPUY                    *
     C           KRSSV     READE@DNCPUY                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0637' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUT2TX           PS State
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * get the state for the site on the 1st mkt tattoo
      * CASE: DB1.PS Site ID is Not Blank
     C           WGNYCD    IFNE *BLANK                     *IF
      * Rtv Class Type        RT - Tattoo Header  * 
     C                     EXSR SWRVGN
      * CASE: WRK.TH Hog Class Type is Market
     C           WULLST    IFEQ 'M'                        *IF
      * Rtv Site State WRTN   RT - Producer Site  * 
     C                     EXSR SXRVGN
      * CASE: WRK.PS State is Entered
     C           WUT2TX    IFNE *BLANK                     *IF
     C                     MOVELWUT2TX    WUT2TX           PS State
     C                     GOTO SVEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSV     READE@DNCPUY                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Rtv Class Type        RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHHMNB    WQSW01           BOH Company Num
     C           *LIKE     DEFN WHBNNB    WQSW02           BOH Buy Order N
     C           *LIKE     DEFN WHBONB    WQSW03           BOL Load Number
     C           *LIKE     DEFN WHCVNB    WQSW04           TH Tattoo Numbe
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WQSW01           BOH Company Num
     C                     KFLD           WQSW02           BOH Buy Order N
     C                     KFLD           WQSW03           BOL Load Number
     C                     KFLD           WQSW04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWGHMNB    WQSW01           BOH Company Num
     C                     Z-ADDWGBNNB    WQSW02           BOH Buy Order N
     C                     Z-ADDWGBONB    WQSW03           BOL Load Number
     C                     Z-ADDWGCVNB    WQSW04           TH Tattoo Numbe
      * Establish starting position
     C           KRSSW     SETLL@A1CPOI                    *
     C           KRSSW     READE@A1CPOI                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WULLST           TH Hog Class Ty
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHLLST    WULLST           TH Hog Class Ty
     C           KRSSW     READE@A1CPOI                  90*
     C                     ENDDO
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * Rtv Site State WRTN   RT - Producer Site  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WIABCD           PD Producer Cod
     C                     KFLD           WINYCD           PS Site ID
      * Setup key
     C                     MOVELWGABCD    WIABCD           PD Producer Cod
     C                     MOVELWGNYCD    WINYCD           PS Site ID
      * Establish starting position
     C           KRSSX     CHAIN@ATRELM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1137' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUT2TX           PS State
     C                     MOVEL*BLANK    WURTN            *Return code
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWIT2TX    WUT2TX           PS State
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * Rtv State f/mpr       RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJHMNB    WQSY01           BOH Company Num
     C           *LIKE     DEFN WJBNNB    WQSY02           BOH Buy Order N
     C           *LIKE     DEFN WJBONB    WQSY03           BOL Load Number
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WQSY01           BOH Company Num
     C                     KFLD           WQSY02           BOH Buy Order N
     C                     KFLD           WQSY03           BOL Load Number
      * Setup key
     C                     Z-ADDWDHMNB    WQSY01           BOH Company Num
     C                     Z-ADDWDBNNB    WQSY02           BOH Buy Order N
     C                     Z-ADDWDBONB    WQSY03           BOL Load Number
      * Establish starting position
     C           KRSSY     SETLL@A1CPC4                    *
     C           KRSSY     READE@A1CPC4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUNZTX           TH State
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.TH Hog Class Type is Market
     C           WJLLST    IFEQ 'M'                        *IF
      * PAR = DB1 By name
     C                     MOVELWJNZTX    WUNZTX           TH State
     C                     GOTO SYEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSY     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * Rtv Crt/Chg Daily Dtl RT - MPR Daily Purchase Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WKH8CD           MPR Identificat
     C                     KFLD           WKETDT           MPR Reporting D
     C                     KFLD           WKC2A1           MPR Reporting T
     C                     KFLD           WKIBCD           MPR Lot Identif
      * Setup key
     C                     MOVELWN0052    WKH8CD           MPR Identificat
     C                     Z-ADDWN0053    WKETDT           MPR Reporting D
     C                     Z-ADDP1C2A1    WKC2A1           MPR Reporting T
     C                     MOVELWN0062    WKIBCD           MPR Lot Identif
      * Establish starting position
     C           KRSSZ     CHAIN@E9CPGG              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0979' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Daily Purch Dtl   CR - MPR Daily Purchase Dtl  * 
     C                     EXSR TACRRC
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Daily Purch Dtl   CH - MPR Daily Purchase Dtl  * 
     C                     EXSR TBCHRC
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TACRRC    BEGSR
      *================================================================
      * Crt Daily Purch Dtl   CR - MPR Daily Purchase Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @E9CPGF
     C                     MOVELWN0052    WLH8CD           MPR Identificat
     C                     Z-ADDWN0053    WLETDT           MPR Reporting D
     C                     Z-ADDP1C2A1    WLC2A1           MPR Reporting T
     C                     MOVELWN0062    WLIBCD           MPR Lot Identif
     C                     Z-ADDWN0055    WLEIA1           MPR Purchase Ty
     C                     Z-ADD*ZERO     WLEJA1           MPR Live Weight
     C                     Z-ADDWN0057    WLEKA1           MPR Class Code
     C                     Z-ADDWUDZA1    WLELA1           MPR Head
     C                     Z-ADDWUAMPR    WLU0PR           MPR Base Price
     C                     MOVELYL0004    WLIDCD           MPR Origin
     C                     MOVEL*BLANK    WLAAVN           RS User Changed
     C                     Z-ADD*ZERO     WLAADT           RS Date Changed
     C                     Z-ADD*ZERO     WLAMTM           RS Time Changed
     C                     MOVELWDAJST    WLAJST           RS Record Statu
     C                     MOVELWDAHVN    WLAHVN           RS Job
     C                     MOVELWDAGVN    WLAGVN           RS Program
     C                     MOVELWDABVN    WLABVN           RS User Added
     C                     Z-ADDWDABDT    WLABDT           RS Date Added
     C                     Z-ADDWDABTM    WLABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       WLAJST           RS Record Statu
     C                     MOVEL##USR     WLABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WLABDT    PARM *ZERO     WQ0065  70       *DATE
     C           WLABTM    PARM *ZERO     WQ0066  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     WLAGVN           RS Program
     C                     MOVEL##JOB     WLAHVN           RS Job
     C           KLCRTA    KLIST
     C                     KFLD           WLH8CD           MPR Identificat
     C                     KFLD           WLETDT           MPR Reporting D
     C                     KFLD           WLC2A1           MPR Reporting T
     C                     KFLD           WLIBCD           MPR Lot Identif
      * Check for duplicate primary key
     C           KLCRTA    SETLL@E9CPGF                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0980' W0RTN   7
      * Send message 'MPR Daily Purchase Dtl EX'
     C                     MOVEL'PRK0980' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C                     WRITE@E9CPGF                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBCHRC    BEGSR
      *================================================================
      * Chg Daily Purch Dtl   CH - MPR Daily Purchase Dtl  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0126 10        RS User Changed
     C                     Z-ADD*ZERO     WN0127  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0128  60       RS Time Changed
     C                     MOVEL*BLANK    WN0129  1        RS Record Statu
     C                     MOVEL*BLANK    WN0130 10        RS Job
     C                     MOVEL*BLANK    WN0131 10        RS Program
     C                     MOVEL*BLANK    WN0132 10        RS User Added
     C                     Z-ADD*ZERO     WN0133  70       RS Date Added
     C                     Z-ADD*ZERO     WN0134  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @E9CPGF
     C                     MOVELWKH8CD    WLH8CD    P      MPR Identificat
     C                     Z-ADDWKETDT    WLETDT           MPR Reporting D
     C                     Z-ADDWKC2A1    WLC2A1           MPR Reporting T
     C                     MOVELWN0062    WLIBCD    P      MPR Lot Identif
      *
     C           KLCHTB    KLIST
     C                     KFLD           WLH8CD           MPR Identificat
     C                     KFLD           WLETDT           MPR Reporting D
     C                     KFLD           WLC2A1           MPR Reporting T
     C                     KFLD           WLIBCD           MPR Lot Identif
     C           KLCHTB    CHAIN@E9CPGF              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKE9CPL0'MDACP
     C                     MOVEL'@E9CPGF' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TBEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKE91    YDRDCS
      * Move non-key fields to @E9CPGF
     C                     Z-ADDWN0055    WLEIA1           MPR Purchase Ty
     C                     Z-ADD*ZERO     WLEJA1           MPR Live Weight
     C                     Z-ADDWN0057    WLEKA1           MPR Class Code
     C                     Z-ADDWUDZA1    WLELA1           MPR Head
     C                     Z-ADDWUAMPR    WLU0PR           MPR Base Price
     C                     MOVELYL0004    WLIDCD    P      MPR Origin
      *
      * Set PGM.*Record Data Changed flag
     C           QPKE91    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp-SysDtIF
     C                     MOVEL##USR     WLAAVN           RS User Changed
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WLAADT    PARM *ZERO     WQ0067  70       *DATE
     C           WLAMTM    PARM *ZERO     WQ0068  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##JOB     WLAHVN           RS Job
     C                     MOVEL##PGM     WLAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKE91    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@E9CPGF                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKE9CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCCHRC    BEGSR
      *================================================================
      * Chg Report to USDA    CH - Buy Order Load  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0135  70       BOL Kill Date
     C                     Z-ADD*ZERO     WN0136  40       BOL Pln Delv St
     C                     Z-ADD*ZERO     WN0137  40       BOL Pln Delv En
     C                     Z-ADD*ZERO     WN0138  50       BOL Pln Head De
     C                     Z-ADD*ZERO     WN0139  71       BOL Shipped Wgt
     C                     Z-ADD*ZERO     WN0140  70       BOL Pln Delv Da
     C                     MOVEL*BLANK    WN0141  2        BOL Freight UOM
     C                     Z-ADD*ZERO     WN0142  72       BOL Freight Uni
     C                     Z-ADD*ZERO     WN0143  72       BOL Freight Amt
     C                     MOVEL*BLANK    WN0144  1        BOL Freight All
     C                     Z-ADD*ZERO     WN0145  70       BOL Head Receiv
     C                     Z-ADD*ZERO     WN0146  71       BOL Live Wgt Re
     C                     MOVEL*BLANK    WN0147  2        BOL Trucker Pay
     C                     Z-ADD*ZERO     WN0148  80       BOL Trucker Che
     C                     Z-ADD*ZERO     WN0149  70       BOL Trucker Che
     C                     Z-ADD*ZERO     WN0150  80       BOL AP Voucher
     C                     MOVEL*BLANK    WN0151 11        BOL Trailer
     C                     MOVEL*BLANK    WN0152  1        BOL Freight Exp
     C                     MOVEL*BLANK    WN0153  1        BOL Scheduled K
     C                     MOVEL*BLANK    WN0154  1        BOL Truck Scale
     C                     Z-ADD*ZERO     WN0155  50       BOL Shipped Hea
     C                     MOVEL*BLANK    WN0156  1        BOL MPR Prior D
     C                     MOVEL*BLANK    WN0157  1        BOL Violated Au
     C                     MOVEL*BLANK    WN0158  2        BOL Status 5
     C                     MOVEL*BLANK    WN0159  2        BOL Status 6
     C                     MOVEL*BLANK    WN0160  3        BOL Status 7
     C                     Z-ADD*ZERO     WN0161  70       BOL HPS Movemen
     C                     Z-ADD*ZERO     WN0162  70       BOL Head LFT
     C                     Z-ADD*ZERO     WN0163  70       BOL Head EUT/KO
     C                     Z-ADD*ZERO     WN0164  70       BOL Auth Gate E
     C                     Z-ADD*ZERO     WN0165  70       BOL Head Receiv
     C                     Z-ADD*ZERO     WN0166 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0167 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0168 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0169 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0170 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0171  70       BOL Auth Gate E
     C                     Z-ADD*ZERO     WN0172  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0173  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0174  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0175  70       BOL Unused Date
     C                     MOVEL*BLANK    WN0176  3        TRK Trucker Cod
     C                     MOVEL*BLANK    WN0177  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0178  6        PL Location Cod
     C                     MOVEL*BLANK    WN0179 10        RS User Changed
     C                     Z-ADD*ZERO     WN0180  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0181  60       RS Time Changed
     C                     MOVEL*BLANK    WN0182  1        RS Record Statu
     C                     MOVEL*BLANK    WN0183 10        RS Job
     C                     MOVEL*BLANK    WN0184 10        RS Program
     C                     MOVEL*BLANK    WN0185 10        RS User Added
     C                     Z-ADD*ZERO     WN0186  70       RS Date Added
     C                     Z-ADD*ZERO     WN0187  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @AXCPBY
     C                     Z-ADDWDHMNB    WMHMNB           BOH Company Num
     C                     Z-ADDWDBNNB    WMBNNB           BOH Buy Order N
     C                     Z-ADDWDBONB    WMBONB           BOL Load Number
      *
     C           KLCHTC    KLIST
     C                     KFLD           WMHMNB           BOH Company Num
     C                     KFLD           WMBNNB           BOH Buy Order N
     C                     KFLD           WMBONB           BOL Load Number
     C           KLCHTC    CHAIN@AXCPBY              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKAXCPL1'MDACP
     C                     MOVEL'@AXCPBY' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKAX1    YERDCS
      * Move non-key fields to @AXCPBY
     C                     MOVEL'Y'       WMPBST    P      Reported to USD
      *
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WMAAVN           RS User Changed
     C                     Z-ADD##JDT     WMAADT           RS Date Changed
     C                     Z-ADD##JTM     WMAMTM           RS Time Changed
     C                     MOVEL##JOB     WMAHVN           RS Job
     C                     MOVEL##PGM     WMAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@AXCPBY                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKAXCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * Rtv Val to Add        RT - MPR Daily Purchase Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKH8CD    WQTD01           MPR Identificat
     C           *LIKE     DEFN WKETDT    WQTD02           MPR Reporting D
     C           *LIKE     DEFN WKC2A1    WQTD03           MPR Reporting T
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WQTD01           MPR Identificat
     C                     KFLD           WQTD02           MPR Reporting D
     C                     KFLD           WQTD03           MPR Reporting T
      * Setup key
     C                     MOVELP3H8CD    WQTD01           MPR Identificat
     C                     Z-ADDP4ETDT    WQTD02           MPR Reporting D
     C                     Z-ADDP1C2A1    WQTD03           MPR Reporting T
      * Establish starting position
     C           KRSTD     SETLL@E9CPGG                    *
     C           KRSTD     READE@E9CPGG                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0979' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       YL0003           Record Added Us
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       YL0003           Record Added Us
     C           KRSTD     READE@E9CPGG                  90*
     C                     ENDDO
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * Rtv Act for Summary   RT - MPR Daily Purchase Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKH8CD    WQTE01           MPR Identificat
     C           *LIKE     DEFN WKETDT    WQTE02           MPR Reporting D
     C           *LIKE     DEFN WKC2A1    WQTE03           MPR Reporting T
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           WQTE01           MPR Identificat
     C                     KFLD           WQTE02           MPR Reporting D
     C                     KFLD           WQTE03           MPR Reporting T
      * Setup key
     C                     MOVELP3H8CD    WQTE01           MPR Identificat
     C                     Z-ADDP4ETDT    WQTE02           MPR Reporting D
     C                     Z-ADDP1C2A1    WQTE03           MPR Reporting T
      * Establish starting position
     C           KRSTE     SETLL@E9CPGG                    *
     C           KRSTE     READE@E9CPGG                  90*
      * Data record not found
     C   90                MOVEL'PRK0979' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.MPR Purchase Type is Negotiated
     C           WKEIA1    IFEQ 1                          *IF
     C                     ADD  WKELA1    P5EDA1           MPR Act Purch T
     C                     ELSE
      * CASE: DB1.MPR Purchase Type is Oth Mkt Formula
     C           WKEIA1    IFEQ 2                          *IF
     C                     ADD  WKELA1    P5EEA1           MPR Act Purch T
     C                     ELSE
      * CASE: DB1.MPR Purchase Type is Pork Mkt Formula
     C           WKEIA1    IFEQ 3                          *IF
     C                     ADD  WKELA1    P5EFA1           MPR Act Purch T
     C                     ELSE
      * CASE: DB1.MPR Purchase Type is Oth Purchase Arng
     C           WKEIA1    IFEQ 4                          *IF
     C                     ADD  WKELA1    P5EGA1           MPR Act Purch T
     C                     ELSE
      * CASE: DB1.MPR Purchase Type is PckSld Negotiated
     C           WKEIA1    IFEQ 5                          *IF
     C                     ADD  WKELA1    P5D5A1           MPR Act Purch T
     C                     ELSE
      * CASE: DB1.MPR Purchase Type is PckSld Oth Mkt Formula
     C           WKEIA1    IFEQ 6                          *IF
     C                     ADD  WKELA1    P5D6A1           MPR Act Purch T
     C                     ELSE
      * CASE: DB1.MPR Purchase Type is PckSld Pork Mkt Formula
     C           WKEIA1    IFEQ 7                          *IF
     C                     ADD  WKELA1    P5D7A1           MPR Act Purch T
     C                     ELSE
      * CASE: DB1.MPR Purchase Type is PckSld Oth Purchase Arng
     C           WKEIA1    IFEQ 8                          *IF
     C                     ADD  WKELA1    P5D8A1           MPR Act Purch T
     C                     ELSE
      * CASE: DB1.MPR Purchase Type is Packer Owned
     C           WKEIA1    IFEQ 9                          *IF
      * punt
     C                     ELSE
      * CASE: DB1.MPR Purchase Type is Other Neg Formula
     C           WKEIA1    IFEQ 10                         *IF
     C                     ADD  WKELA1    P5YOA1           MPR Act Purch T
     C                     ELSE
      * CASE: DB1.MPR Purchase Type is PckSld Neg Formula
     C           WKEIA1    IFEQ 11                         *IF
     C                     ADD  WKELA1    P5YMA1           MPR Act Purch T
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTE     READE@E9CPGG                  90*
     C                     ENDDO
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * Rtv Act for Summary   RT - MPR Daily Purchase Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKH8CD    WQTF01           MPR Identificat
     C           *LIKE     DEFN WKETDT    WQTF02           MPR Reporting D
     C           *LIKE     DEFN WKC2A1    WQTF03           MPR Reporting T
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           WQTF01           MPR Identificat
     C                     KFLD           WQTF02           MPR Reporting D
     C                     KFLD           WQTF03           MPR Reporting T
      * Setup key
     C                     MOVELP3H8CD    WQTF01           MPR Identificat
     C                     Z-ADDP4ETDT    WQTF02           MPR Reporting D
     C                     Z-ADDWUC2A1    WQTF03           MPR Reporting T
      * Establish starting position
     C           KRSTF     SETLL@E9CPGG                    *
     C           KRSTF     READE@E9CPGG                  90*
      * Data record not found
     C   90                MOVEL'PRK0979' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.MPR Purchase Type is Negotiated
     C           WKEIA1    IFEQ 1                          *IF
     C                     ADD  WKELA1    P5EDA1           MPR Act Purch T
     C                     ELSE
      * CASE: DB1.MPR Purchase Type is Oth Mkt Formula
     C           WKEIA1    IFEQ 2                          *IF
     C                     ADD  WKELA1    P5EEA1           MPR Act Purch T
     C                     ELSE
      * CASE: DB1.MPR Purchase Type is Pork Mkt Formula
     C           WKEIA1    IFEQ 3                          *IF
     C                     ADD  WKELA1    P5EFA1           MPR Act Purch T
     C                     ELSE
      * CASE: DB1.MPR Purchase Type is Oth Purchase Arng
     C           WKEIA1    IFEQ 4                          *IF
     C                     ADD  WKELA1    P5EGA1           MPR Act Purch T
     C                     ELSE
      * CASE: DB1.MPR Purchase Type is PckSld Negotiated
     C           WKEIA1    IFEQ 5                          *IF
     C                     ADD  WKELA1    P5D5A1           MPR Act Purch T
     C                     ELSE
      * CASE: DB1.MPR Purchase Type is PckSld Oth Mkt Formula
     C           WKEIA1    IFEQ 6                          *IF
     C                     ADD  WKELA1    P5D6A1           MPR Act Purch T
     C                     ELSE
      * CASE: DB1.MPR Purchase Type is PckSld Pork Mkt Formula
     C           WKEIA1    IFEQ 7                          *IF
     C                     ADD  WKELA1    P5D7A1           MPR Act Purch T
     C                     ELSE
      * CASE: DB1.MPR Purchase Type is PckSld Oth Purchase Arng
     C           WKEIA1    IFEQ 8                          *IF
     C                     ADD  WKELA1    P5D8A1           MPR Act Purch T
     C                     ELSE
      * CASE: DB1.MPR Purchase Type is Packer Owned
     C           WKEIA1    IFEQ 9                          *IF
      * punt
     C                     ELSE
      * CASE: DB1.MPR Purchase Type is Other Neg Formula
     C           WKEIA1    IFEQ 10                         *IF
     C                     ADD  WKELA1    P5YOA1           MPR Act Purch T
     C                     ELSE
      * CASE: DB1.MPR Purchase Type is PckSld Neg Formula
     C           WKEIA1    IFEQ 11                         *IF
     C                     ADD  WKELA1    P5YMA1           MPR Act Purch T
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTF     READE@E9CPGG                  90*
     C                     ENDDO
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * Rtv Crt/Chg Daily Sm  RT - MPR Daily Purchase Sum  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           WSH8CD           MPR Identificat
     C                     KFLD           WSETDT           MPR Reporting D
     C                     KFLD           WSC2A1           MPR Reporting T
      * Setup key
     C                     MOVELP3H8CD    WSH8CD           MPR Identificat
     C                     Z-ADDP4ETDT    WSETDT           MPR Reporting D
     C                     Z-ADDP1C2A1    WSC2A1           MPR Reporting T
      * Establish starting position
     C           KRSTG     CHAIN@E8CPGJ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0977' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Daily Purch Sum   CR - MPR Daily Purchase Sum  * 
     C                     EXSR THCRRC
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Daily Purch Sum   CH - MPR Daily Purchase Sum  * 
     C                     EXSR TICHRC
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THCRRC    BEGSR
      *================================================================
      * Crt Daily Purch Sum   CR - MPR Daily Purchase Sum  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @E8CPGI
     C                     MOVELP3H8CD    WTH8CD           MPR Identificat
     C                     Z-ADDP4ETDT    WTETDT           MPR Reporting D
     C                     Z-ADDP1C2A1    WTC2A1           MPR Reporting T
     C                     Z-ADDP5D5A1    WTD1A1           MPR Est Purch T
     C                     Z-ADDP5D6A1    WTD2A1           MPR Est Purch T
     C                     Z-ADDP5D7A1    WTD3A1           MPR Est Purch T
     C                     Z-ADDP5D8A1    WTD4A1           MPR Est Purch T
     C                     Z-ADDP5D5A1    WTD5A1           MPR Act Purch T
     C                     Z-ADDP5D6A1    WTD6A1           MPR Act Purch T
     C                     Z-ADDP5D7A1    WTD7A1           MPR Act Purch T
     C                     Z-ADDP5YMA1    WTYLA1           MPR Est Purch T
     C                     Z-ADDP5YMA1    WTYMA1           MPR Act Purch T
     C                     Z-ADDP5D8A1    WTD8A1           MPR Act Purch T
     C                     Z-ADDP5EDA1    WTD9A1           MPR Est Purch T
     C                     Z-ADDP5EEA1    WTEAA1           MPR Est Purch T
     C                     Z-ADDP5EFA1    WTEBA1           MPR Est Purch T
     C                     Z-ADDP5EGA1    WTECA1           MPR Est Purch T
     C                     Z-ADDP5EDA1    WTEDA1           MPR Act Purch T
     C                     Z-ADDP5EEA1    WTEEA1           MPR Act Purch T
     C                     Z-ADDP5EFA1    WTEFA1           MPR Act Purch T
     C                     Z-ADDP5EGA1    WTEGA1           MPR Act Purch T
     C                     Z-ADDP5YOA1    WTYNA1           MPR Est Purch T
     C                     Z-ADDP5YOA1    WTYOA1           MPR Act Purch T
     C                     MOVEL*BLANK    WTAAVN           RS User Changed
     C                     Z-ADD*ZERO     WTAADT           RS Date Changed
     C                     Z-ADD*ZERO     WTAMTM           RS Time Changed
     C                     MOVEL'A'       WTAJST           RS Record Statu
     C                     MOVEL*BLANK    WTAHVN           RS Job
     C                     MOVEL*BLANK    WTAGVN           RS Program
     C                     MOVEL*BLANK    WTABVN           RS User Added
     C                     Z-ADD*ZERO     WTABDT           RS Date Added
     C                     Z-ADD*ZERO     WTABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       WTAJST           RS Record Statu
     C                     MOVEL##USR     WTABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WTABDT    PARM *ZERO     WQ0069  70       *DATE
     C           WTABTM    PARM *ZERO     WQ0070  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     WTAGVN           RS Program
     C                     MOVEL##JOB     WTAHVN           RS Job
     C           KLCRTH    KLIST
     C                     KFLD           WTH8CD           MPR Identificat
     C                     KFLD           WTETDT           MPR Reporting D
     C                     KFLD           WTC2A1           MPR Reporting T
      * Check for duplicate primary key
     C           KLCRTH    SETLL@E8CPGI                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0978' W0RTN   7
      * Send message 'MPR Daily Purchase Sum EX'
     C                     MOVEL'PRK0978' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO THEXIT
     C                     ENDIF
      *
     C                     WRITE@E8CPGI                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TICHRC    BEGSR
      *================================================================
      * Chg Daily Purch Sum   CH - MPR Daily Purchase Sum  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0188 10        RS User Changed
     C                     Z-ADD*ZERO     WN0189  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0190  60       RS Time Changed
     C                     MOVEL*BLANK    WN0191  1        RS Record Statu
     C                     MOVEL*BLANK    WN0192 10        RS Job
     C                     MOVEL*BLANK    WN0193 10        RS Program
     C                     MOVEL*BLANK    WN0194 10        RS User Added
     C                     Z-ADD*ZERO     WN0195  70       RS Date Added
     C                     Z-ADD*ZERO     WN0196  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @E8CPGI
     C                     MOVELWSH8CD    WTH8CD    P      MPR Identificat
     C                     Z-ADDWSETDT    WTETDT           MPR Reporting D
     C                     Z-ADDWSC2A1    WTC2A1           MPR Reporting T
      *
     C           KLCHTI    KLIST
     C                     KFLD           WTH8CD           MPR Identificat
     C                     KFLD           WTETDT           MPR Reporting D
     C                     KFLD           WTC2A1           MPR Reporting T
     C           KLCHTI    CHAIN@E8CPGI              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKE8CPL0'MDACP
     C                     MOVEL'@E8CPGI' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKE81    YFRDCS
      * Move non-key fields to @E8CPGI
     C                     Z-ADDP5D5A1    WTD1A1           MPR Est Purch T
     C                     Z-ADDP5D6A1    WTD2A1           MPR Est Purch T
     C                     Z-ADDP5D7A1    WTD3A1           MPR Est Purch T
     C                     Z-ADDP5D8A1    WTD4A1           MPR Est Purch T
     C                     Z-ADDP5D5A1    WTD5A1           MPR Act Purch T
     C                     Z-ADDP5D6A1    WTD6A1           MPR Act Purch T
     C                     Z-ADDP5D7A1    WTD7A1           MPR Act Purch T
     C                     Z-ADDP5YMA1    WTYLA1           MPR Est Purch T
     C                     Z-ADDP5YMA1    WTYMA1           MPR Act Purch T
     C                     Z-ADDP5D8A1    WTD8A1           MPR Act Purch T
     C                     Z-ADDP5EDA1    WTD9A1           MPR Est Purch T
     C                     Z-ADDP5EEA1    WTEAA1           MPR Est Purch T
     C                     Z-ADDP5EFA1    WTEBA1           MPR Est Purch T
     C                     Z-ADDP5EGA1    WTECA1           MPR Est Purch T
     C                     Z-ADDP5EDA1    WTEDA1           MPR Act Purch T
     C                     Z-ADDP5EEA1    WTEEA1           MPR Act Purch T
     C                     Z-ADDP5EFA1    WTEFA1           MPR Act Purch T
     C                     Z-ADDP5EGA1    WTEGA1           MPR Act Purch T
     C                     Z-ADDP5YOA1    WTYNA1           MPR Est Purch T
     C                     Z-ADDP5YOA1    WTYOA1           MPR Act Purch T
      *
      * Set PGM.*Record Data Changed flag
     C           QPKE81    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp-SysDtIF
     C                     MOVEL##USR     WTAAVN           RS User Changed
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WTAADT    PARM *ZERO     WQ0071  70       *DATE
     C           WTAMTM    PARM *ZERO     WQ0072  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##JOB     WTAHVN           RS Job
     C                     MOVEL##PGM     WTAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKE81    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@E8CPGI                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKE8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * Rtv Crt/Chg Daily Sm  RT - MPR Daily Purchase Sum  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           WSH8CD           MPR Identificat
     C                     KFLD           WSETDT           MPR Reporting D
     C                     KFLD           WSC2A1           MPR Reporting T
      * Setup key
     C                     MOVELP3H8CD    WSH8CD           MPR Identificat
     C                     Z-ADDP4ETDT    WSETDT           MPR Reporting D
     C                     Z-ADDP1C2A1    WSC2A1           MPR Reporting T
      * Establish starting position
     C           KRSTJ     CHAIN@E8CPGJ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0977' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Daily Purch Sum   CR - MPR Daily Purchase Sum  * 
     C                     EXSR TKCRRC
     C                     GOTO TJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Daily Purch Sum   CH - MPR Daily Purchase Sum  * 
     C                     EXSR TLCHRC
     C                     ENDIF
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKCRRC    BEGSR
      *================================================================
      * Crt Daily Purch Sum   CR - MPR Daily Purchase Sum  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @E8CPGI
     C                     MOVELP3H8CD    WTH8CD           MPR Identificat
     C                     Z-ADDP4ETDT    WTETDT           MPR Reporting D
     C                     Z-ADDP1C2A1    WTC2A1           MPR Reporting T
     C                     Z-ADDP5D5A1    WTD1A1           MPR Est Purch T
     C                     Z-ADDP5D6A1    WTD2A1           MPR Est Purch T
     C                     Z-ADDP5D7A1    WTD3A1           MPR Est Purch T
     C                     Z-ADDP5D8A1    WTD4A1           MPR Est Purch T
     C                     Z-ADDP5D5A1    WTD5A1           MPR Act Purch T
     C                     Z-ADDP5D6A1    WTD6A1           MPR Act Purch T
     C                     Z-ADDP5D7A1    WTD7A1           MPR Act Purch T
     C                     Z-ADDP5YMA1    WTYLA1           MPR Est Purch T
     C                     Z-ADDP5YMA1    WTYMA1           MPR Act Purch T
     C                     Z-ADDP5D8A1    WTD8A1           MPR Act Purch T
     C                     Z-ADDP5EDA1    WTD9A1           MPR Est Purch T
     C                     Z-ADDP5EEA1    WTEAA1           MPR Est Purch T
     C                     Z-ADDP5EFA1    WTEBA1           MPR Est Purch T
     C                     Z-ADDP5EGA1    WTECA1           MPR Est Purch T
     C                     Z-ADDP5EDA1    WTEDA1           MPR Act Purch T
     C                     Z-ADDP5EEA1    WTEEA1           MPR Act Purch T
     C                     Z-ADDP5EFA1    WTEFA1           MPR Act Purch T
     C                     Z-ADDP5EGA1    WTEGA1           MPR Act Purch T
     C                     Z-ADDP5YOA1    WTYNA1           MPR Est Purch T
     C                     Z-ADDP5YOA1    WTYOA1           MPR Act Purch T
     C                     MOVEL*BLANK    WTAAVN           RS User Changed
     C                     Z-ADD*ZERO     WTAADT           RS Date Changed
     C                     Z-ADD*ZERO     WTAMTM           RS Time Changed
     C                     MOVEL'A'       WTAJST           RS Record Statu
     C                     MOVEL*BLANK    WTAHVN           RS Job
     C                     MOVEL*BLANK    WTAGVN           RS Program
     C                     MOVEL*BLANK    WTABVN           RS User Added
     C                     Z-ADD*ZERO     WTABDT           RS Date Added
     C                     Z-ADD*ZERO     WTABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       WTAJST           RS Record Statu
     C                     MOVEL##USR     WTABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WTABDT    PARM *ZERO     WQ0073  70       *DATE
     C           WTABTM    PARM *ZERO     WQ0074  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     WTAGVN           RS Program
     C                     MOVEL##JOB     WTAHVN           RS Job
     C           KLCRTK    KLIST
     C                     KFLD           WTH8CD           MPR Identificat
     C                     KFLD           WTETDT           MPR Reporting D
     C                     KFLD           WTC2A1           MPR Reporting T
      * Check for duplicate primary key
     C           KLCRTK    SETLL@E8CPGI                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0978' W0RTN   7
      * Send message 'MPR Daily Purchase Sum EX'
     C                     MOVEL'PRK0978' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TKEXIT
     C                     ENDIF
      *
     C                     WRITE@E8CPGI                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLCHRC    BEGSR
      *================================================================
      * Chg Daily Purch Sum   CH - MPR Daily Purchase Sum  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0197 10        RS User Changed
     C                     Z-ADD*ZERO     WN0198  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0199  60       RS Time Changed
     C                     MOVEL*BLANK    WN0200  1        RS Record Statu
     C                     MOVEL*BLANK    WN0201 10        RS Job
     C                     MOVEL*BLANK    WN0202 10        RS Program
     C                     MOVEL*BLANK    WN0203 10        RS User Added
     C                     Z-ADD*ZERO     WN0204  70       RS Date Added
     C                     Z-ADD*ZERO     WN0205  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YGRDC   1
      *
      * Move key fields to @E8CPGI
     C                     MOVELWSH8CD    WTH8CD    P      MPR Identificat
     C                     Z-ADDWSETDT    WTETDT           MPR Reporting D
     C                     Z-ADDWSC2A1    WTC2A1           MPR Reporting T
      *
     C           KLCHTL    KLIST
     C                     KFLD           WTH8CD           MPR Identificat
     C                     KFLD           WTETDT           MPR Reporting D
     C                     KFLD           WTC2A1           MPR Reporting T
     C           KLCHTL    CHAIN@E8CPGI              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKE8CPL0'MDACP
     C                     MOVEL'@E8CPGI' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKE81    YGRDCS
      * Move non-key fields to @E8CPGI
     C                     Z-ADDP5D5A1    WTD1A1           MPR Est Purch T
     C                     Z-ADDP5D6A1    WTD2A1           MPR Est Purch T
     C                     Z-ADDP5D7A1    WTD3A1           MPR Est Purch T
     C                     Z-ADDP5D8A1    WTD4A1           MPR Est Purch T
     C                     Z-ADDP5D5A1    WTD5A1           MPR Act Purch T
     C                     Z-ADDP5D6A1    WTD6A1           MPR Act Purch T
     C                     Z-ADDP5D7A1    WTD7A1           MPR Act Purch T
     C                     Z-ADDP5YMA1    WTYLA1           MPR Est Purch T
     C                     Z-ADDP5YMA1    WTYMA1           MPR Act Purch T
     C                     Z-ADDP5D8A1    WTD8A1           MPR Act Purch T
     C                     Z-ADDP5EDA1    WTD9A1           MPR Est Purch T
     C                     Z-ADDP5EEA1    WTEAA1           MPR Est Purch T
     C                     Z-ADDP5EFA1    WTEBA1           MPR Est Purch T
     C                     Z-ADDP5EGA1    WTECA1           MPR Est Purch T
     C                     Z-ADDP5EDA1    WTEDA1           MPR Act Purch T
     C                     Z-ADDP5EEA1    WTEEA1           MPR Act Purch T
     C                     Z-ADDP5EFA1    WTEFA1           MPR Act Purch T
     C                     Z-ADDP5EGA1    WTEGA1           MPR Act Purch T
     C                     Z-ADDP5YOA1    WTYNA1           MPR Est Purch T
     C                     Z-ADDP5YOA1    WTYOA1           MPR Act Purch T
      *
      * Set PGM.*Record Data Changed flag
     C           QPKE81    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp-SysDtIF
     C                     MOVEL##USR     WTAAVN           RS User Changed
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WTAADT    PARM *ZERO     WQ0075  70       *DATE
     C           WTAMTM    PARM *ZERO     WQ0076  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##JOB     WTAHVN           RS Job
     C                     MOVEL##PGM     WTAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKE81    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YGRDC     IFEQ 'Y'
     C                     UPDAT@E8CPGI                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKE8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P5EDA1           MPR Act Purch T
     C                     Z-ADD*ZERO     P5EEA1           MPR Act Purch T
     C                     Z-ADD*ZERO     P5EFA1           MPR Act Purch T
     C                     Z-ADD*ZERO     P5EGA1           MPR Act Purch T
     C                     Z-ADD*ZERO     P5D5A1           MPR Act Purch T
     C                     Z-ADD*ZERO     P5D6A1           MPR Act Purch T
     C                     Z-ADD*ZERO     P5D7A1           MPR Act Purch T
     C                     Z-ADD*ZERO     P5D8A1           MPR Act Purch T
     C                     Z-ADD*ZERO     P5D9A1           MPR Est Purch T
     C                     Z-ADD*ZERO     P5EAA1           MPR Est Purch T
     C                     Z-ADD*ZERO     P5EBA1           MPR Est Purch T
     C                     Z-ADD*ZERO     P5ECA1           MPR Est Purch T
     C                     Z-ADD*ZERO     P5D1A1           MPR Est Purch T
     C                     Z-ADD*ZERO     P5D2A1           MPR Est Purch T
     C                     Z-ADD*ZERO     P5D3A1           MPR Est Purch T
     C                     Z-ADD*ZERO     P5D4A1           MPR Est Purch T
     C                     Z-ADD*ZERO     P5YOA1           MPR Act Purch T
     C                     Z-ADD*ZERO     P5YMA1           MPR Act Purch T
     C                     Z-ADD*ZERO     P5YNA1           MPR Est Purch T
     C                     Z-ADD*ZERO     P5YLA1           MPR Est Purch T
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHONB           CC Company Numb
     C                     Z-ADD*ZERO     WAETDT           MPR Reporting D
     C                     Z-ADD*ZERO     WAC0A1           MPR Purchase Ty
     C                     Z-ADD*ZERO     WAC1A1           MPR Estimated H
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Define work field MPR Purchase Type
     C                     Z-ADD*ZERO     WUEIA1  20
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WBBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WBARDT           BOH Buy Order D
     C                     Z-ADD*ZERO     WBASDT           BOH Kill Date
     C                     Z-ADD*ZERO     WBAAPR           BOH Market Add/
     C                     Z-ADD*ZERO     WBALPR           BOH Quoted Base
     C                     Z-ADD*ZERO     WBD5DT           BOH MPR Reporti
     C                     Z-ADD*ZERO     WBD6DT           BOH Hedge Date
     C                     Z-ADD*ZERO     WBD7DT           BOH Unused Date
     C                     Z-ADD*ZERO     WBD8DT           BOH Unused Date
     C                     Z-ADD*ZERO     WBD9DT           BOH Unused Date
     C                     Z-ADD*ZERO     WBJOEJ           BOH Hedge Head
     C                     Z-ADD*ZERO     WBKOFF           BOH Hedge Refer
     C                     Z-ADD*ZERO     WBKWPE           BOH Hedge Time
     C                     Z-ADD*ZERO     WBIMBF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WBOPTR           BOH Unused Nbr
     C                     Z-ADD*ZERO     WBOEJD           BOH Unused Nbr
     C                     Z-ADD*ZERO     WBIRMF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WBJIRM           BOH Unused Nbr
     C                     Z-ADD*ZERO     WBJRKF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WBKFIR           BOH Unused Nbr
     C                     Z-ADD*ZERO     WBHXNB           PPWS Company Nu
     C                     Z-ADD*ZERO     WBGANB           CW Year
     C                     Z-ADD*ZERO     WBGBNB           CW Week Number
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      * Define work field MPR Purchase Type Code
     C                     Z-ADD*ZERO     WUC0A1  20
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCC0A1           MPR Purchase Ty
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      * Define work field Buy Order Head Total  USR
     C                     Z-ADD*ZERO     WUJRNB  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WDBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WDBONB           BOL Load Number
     C                     Z-ADD*ZERO     WDCQDT           BOL Kill Date
     C                     Z-ADD*ZERO     WDABTH           BOL Pln Delv St
     C                     Z-ADD*ZERO     WDACTH           BOL Pln Delv En
     C                     Z-ADD*ZERO     WDBPNB           BOL Pln Head De
     C                     Z-ADD*ZERO     WDCSNB           BOL Shipped Wgt
     C                     Z-ADD*ZERO     WDAUDT           BOL Pln Delv Da
     C                     Z-ADD*ZERO     WDAGPR           BOL Freight Uni
     C                     Z-ADD*ZERO     WDATVA           BOL Freight Amt
     C                     Z-ADD*ZERO     WDDHNB           BOL Head Receiv
     C                     Z-ADD*ZERO     WDDINB           BOL Live Wgt Re
     C                     Z-ADD*ZERO     WDGINB           BOL Trucker Che
     C                     Z-ADD*ZERO     WDBZDT           BOL Trucker Che
     C                     Z-ADD*ZERO     WDLSNB           BOL AP Voucher
     C                     Z-ADD*ZERO     WDLDSH           BOL Shipped Hea
     C                     Z-ADD*ZERO     WDJKRU           BOL HPS Movemen
     C                     Z-ADD*ZERO     WDKEOR           BOL Head LFT
     C                     Z-ADD*ZERO     WDIOEW           BOL Head EUT/KO
     C                     Z-ADD*ZERO     WDKJIO           BOL Auth Gate E
     C                     Z-ADD*ZERO     WDIOJR           BOL Head Receiv
     C                     Z-ADD*ZERO     WDEIRR           BOL Unused Wgt
     C                     Z-ADD*ZERO     WDITMF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WDODJE           BOL Unused Wgt
     C                     Z-ADD*ZERO     WDRJIF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WDOEJF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WDD0DT           BOL Auth Gate E
     C                     Z-ADD*ZERO     WDD1DT           BOL Unused Date
     C                     Z-ADD*ZERO     WDD2DT           BOL Unused Date
     C                     Z-ADD*ZERO     WDD3DT           BOL Unused Date
     C                     Z-ADD*ZERO     WDD4DT           BOL Unused Date
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
      * Define work field MPR Pur Purchase Type
     C                     Z-ADD*ZERO     WUDYA1  20
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFGLNB           Pl VND Address
     C                     Z-ADD*ZERO     WFASNB           PL Miles/Unused
     C                     Z-ADD*ZERO     WFHWNB           PL Primary Comp
     C                     Z-ADD*ZERO     WFAADT           RS Date Changed
     C                     Z-ADD*ZERO     WFAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WFABDT           RS Date Added
     C                     Z-ADD*ZERO     WFABTM           RS Time Added
      * Define work field Buy Order Number Alpha
     C                     MOVEL*BLANK    WUP8TX  7
      * Define work field Buy Order Load Alpha
     C                     MOVEL*BLANK    WUP9TX  5
      * Define work field PS State
     C                     MOVEL*BLANK    WUT2TX  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WGBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WGBONB           BOL Load Number
     C                     Z-ADD*ZERO     WGCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WGB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WGI5PR           TH CA Market Pr
     C                     Z-ADD*ZERO     WGJBPR           TH CA Base Mark
     C                     Z-ADD*ZERO     WGI6PR           TH CA Base Mkt
     C                     Z-ADD*ZERO     WGI7PR           TH CA Sort Disc
     C                     Z-ADD*ZERO     WGI8PR           TH CA Yield Gai
     C                     Z-ADD*ZERO     WGI9PR           TH CA Base Carc
     C                     Z-ADD*ZERO     WGJAPR           TH CA Lean Prem
     C                     Z-ADD*ZERO     WGJCPR           TH CA Carcass G
     C                     Z-ADD*ZERO     WGJDPR           TH CA Bse Mkt L
     C                     Z-ADD*ZERO     WGJEPR           TH CA Bse Mkt C
     C                     Z-ADD*ZERO     WGJFPR           TH CA Srt Dsc L
     C                     Z-ADD*ZERO     WGJGPR           TH CA Srt Dsc C
     C                     Z-ADD*ZERO     WGJHPR           TH CA Yld G/L L
     C                     Z-ADD*ZERO     WGJIPR           TH CA Yld G/L C
     C                     Z-ADD*ZERO     WGJJPR           TH CA Crc Val L
     C                     Z-ADD*ZERO     WGJKPR           TH CA Crc Val C
     C                     Z-ADD*ZERO     WGJLPR           TH CA Lean Prm
     C                     Z-ADD*ZERO     WGJMPR           TH CA Lean Prm
     C                     Z-ADD*ZERO     WGJNPR           TH CA Gross Liv
     C                     Z-ADD*ZERO     WGJOPR           TH CA Gross Car
     C                     Z-ADD*ZERO     WGLTBF           TH Min LT Backf
     C                     Z-ADD*ZERO     WGHZPC           TH Min LT LoinE
     C                     Z-ADD*ZERO     WGLTHW           TH Min LT Hot W
     C                     Z-ADD*ZERO     WGH0PC           TH Min LT Lean
     C                     Z-ADD*ZERO     WGGTBF           TH Max GT Backf
     C                     Z-ADD*ZERO     WGH1PC           TH Max GT LoinE
     C                     Z-ADD*ZERO     WGGTHW           TH Max GT Hot W
     C                     Z-ADD*ZERO     WGH2PC           TH Max GT Lean
     C                     Z-ADD*ZERO     WGHLBF           TH Head LT Back
     C                     Z-ADD*ZERO     WGHLLE           TH Head LT Loin
     C                     Z-ADD*ZERO     WGHLHW           TH Head LT Hot
     C                     Z-ADD*ZERO     WGHLLP           TH Head LT Lean
     C                     Z-ADD*ZERO     WGHGBF           TH Head GT Back
     C                     Z-ADD*ZERO     WGHGLE           TH Head GT Loin
     C                     Z-ADD*ZERO     WGHGHW           TH Head GT Hot
     C                     Z-ADD*ZERO     WGHFLP           TH Head GT Lean
     C                     Z-ADD*ZERO     WGSNA1           TE Unused Numbe
     C                     Z-ADD*ZERO     WGSOA1           TE UnUsed Numbe
     C                     Z-ADD*ZERO     WGSPA1           TE Unused Numbe
     C                     Z-ADD*ZERO     WGAADT           RS Date Changed
     C                     Z-ADD*ZERO     WGAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WGABDT           RS Date Added
     C                     Z-ADD*ZERO     WGABTM           RS Time Added
      * Define work field TH Hog Class Type
     C                     MOVEL*BLANK    WULLST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WHBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WHBONB           BOL Load Number
     C                     Z-ADD*ZERO     WHCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WHB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WHAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WHACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WHB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WHCAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WHAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WHA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WHCXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WHCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WHFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WHH9NB           TH Held Over
     C                     Z-ADD*ZERO     WHFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WHFENB           TH Head Killed
     C                     Z-ADD*ZERO     WHHENB           TH Head Adds
     C                     Z-ADD*ZERO     WHHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WHCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WHLRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WHE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WHA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WHFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WHA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WHF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WHHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WHF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WHF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WHF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WHF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WHAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WHAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WHCWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WHA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WHA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WHB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WHAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WHANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WHAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WHAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WHAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WHAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WHAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WHASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WHA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WHATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WHA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WHCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WHCCPR           Th Payment Net
     C                     Z-ADD*ZERO     WHLPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WHCDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WHA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WHA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WHGHNB           TH Commission A
     C                     Z-ADD*ZERO     WHBYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WHBSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WHBTDT           TH Commission P
     C                     Z-ADD*ZERO     WHBUDT           TH Actual Check
     C                     Z-ADD*ZERO     WHHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WHHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WHHINB           TH FFLI
     C                     Z-ADD*ZERO     WHA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WHA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WHA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WHJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WHD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WHD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WHD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WHD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WHEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WHEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WHECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WHEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WHEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WHEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WHEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WHEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WHOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WHTHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WHT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WHTHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WHT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WHOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WHKOER           TH Head Identif
     C                     Z-ADD*ZERO     WHOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WHOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WHIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WHOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WHHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WHS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WHTAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WHTBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WHJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WHKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WHKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WHKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WHKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WHOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WHIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WHIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WHIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WHKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WHOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WHKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WHORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WHOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WHMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WHMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WHNCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WHNCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WHIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WHKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WHEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WHEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WHECDT           TH Head LFT
     C                     Z-ADD*ZERO     WHEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WHEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WHAADT           RS Date Changed
     C                     Z-ADD*ZERO     WHAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WHABDT           RS Date Added
     C                     Z-ADD*ZERO     WHABTM           RS Time Added
      * Define work field *Return code
     C                     MOVEL*BLANK    WURTN   7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIMDA1           PS User Mileage
     C                     Z-ADD*ZERO     WIMEA1           PS User Mileage
     C                     Z-ADD*ZERO     WIMFA1           PS Trace Sequen
     C                     Z-ADD*ZERO     WIAADT           RS Date Changed
     C                     Z-ADD*ZERO     WIAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WIABDT           RS Date Added
     C                     Z-ADD*ZERO     WIABTM           RS Time Added
      * Define work field TH State
     C                     MOVEL*BLANK    WUNZTX  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKETDT           MPR Reporting D
     C                     Z-ADD*ZERO     WKC2A1           MPR Reporting T
     C                     Z-ADD*ZERO     WKEIA1           MPR Purchase Ty
     C                     Z-ADD*ZERO     WKEJA1           MPR Live Weight
     C                     Z-ADD*ZERO     WKEKA1           MPR Class Code
     C                     Z-ADD*ZERO     WKELA1           MPR Head
     C                     Z-ADD*ZERO     WKU0PR           MPR Base Price
     C                     Z-ADD*ZERO     WKAADT           RS Date Changed
     C                     Z-ADD*ZERO     WKAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WKABDT           RS Date Added
     C                     Z-ADD*ZERO     WKABTM           RS Time Added
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field TH CM Base Mkt Price
     C                     Z-ADD*ZERO     WUAMPR  52
      * Define work field TH Avg Live Wgt
     C                     Z-ADD*ZERO     WUF7NB  51
      * Define work field MPR Pur Head
     C                     Z-ADD*ZERO     WUDZA1  60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WRAHDT           PSC Date
     C                     Z-ADD*ZERO     WRAZPR           PSC Floor Price
     C                     Z-ADD*ZERO     WRA0PR           PSC Ceiling Pri
     C                     Z-ADD*ZERO     WRA9PC           PSC Market Perc
     C                     Z-ADD*ZERO     WRA7PR           PSC Break Even
     C                     Z-ADD*ZERO     WRA8PR           PSC FLoor Price
     C                     Z-ADD*ZERO     WRA9PR           PSC Mkt Percent
     C                     Z-ADD*ZERO     WRF6PR           PSC Mkt + or -
     C                     Z-ADD*ZERO     WRAADT           RS Date Changed
     C                     Z-ADD*ZERO     WRAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WRABDT           RS Date Added
     C                     Z-ADD*ZERO     WRABTM           RS Time Added
      * Define work field MPR Reporting Time
     C                     Z-ADD*ZERO     WUC2A1  10
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WSETDT           MPR Reporting D
     C                     Z-ADD*ZERO     WSC2A1           MPR Reporting T
     C                     Z-ADD*ZERO     WSD1A1           MPR Est Purch T
     C                     Z-ADD*ZERO     WSD2A1           MPR Est Purch T
     C                     Z-ADD*ZERO     WSD3A1           MPR Est Purch T
     C                     Z-ADD*ZERO     WSD4A1           MPR Est Purch T
     C                     Z-ADD*ZERO     WSD5A1           MPR Act Purch T
     C                     Z-ADD*ZERO     WSD6A1           MPR Act Purch T
     C                     Z-ADD*ZERO     WSD7A1           MPR Act Purch T
     C                     Z-ADD*ZERO     WSYLA1           MPR Est Purch T
     C                     Z-ADD*ZERO     WSYMA1           MPR Act Purch T
     C                     Z-ADD*ZERO     WSD8A1           MPR Act Purch T
     C                     Z-ADD*ZERO     WSD9A1           MPR Est Purch T
     C                     Z-ADD*ZERO     WSEAA1           MPR Est Purch T
     C                     Z-ADD*ZERO     WSEBA1           MPR Est Purch T
     C                     Z-ADD*ZERO     WSECA1           MPR Est Purch T
     C                     Z-ADD*ZERO     WSEDA1           MPR Act Purch T
     C                     Z-ADD*ZERO     WSEEA1           MPR Act Purch T
     C                     Z-ADD*ZERO     WSEFA1           MPR Act Purch T
     C                     Z-ADD*ZERO     WSEGA1           MPR Act Purch T
     C                     Z-ADD*ZERO     WSYNA1           MPR Est Purch T
     C                     Z-ADD*ZERO     WSYOA1           MPR Act Purch T
     C                     Z-ADD*ZERO     WSAADT           RS Date Changed
     C                     Z-ADD*ZERO     WSAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WSABDT           RS Date Added
     C                     Z-ADD*ZERO     WSABTM           RS Time Added
     C                     MOVEL'N'       W0PMT   1
      * Define local work field Invalid Y/N USR
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field BOH MPR Reporting Time
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field Record Added Usr
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field MPR Origin
     C                     MOVEL*BLANK    YL0004  2
      * Define local work field TH Avg Live Wgt
     C                     Z-ADD*ZERO     YL0005  51
      * Define local work field PSC Market Percent   NU
     C                     Z-ADD*ZERO     YL0006  30
      * Define local work field PSC Mkt Percent
     C                     Z-ADD*ZERO     YL0007  52
      * Define local work field PSC Break Even Percent
     C                     Z-ADD*ZERO     YL0008  52
      * Define local work field TH Tattoo Number
     C                     Z-ADD*ZERO     YL0009  50
      * Define local work field TH Live Wgt
     C                     Z-ADD*ZERO     YL0010  71
      * Define local work field PSC Floor Price
     C                     Z-ADD*ZERO     YL0011  52
      * Define local work field PSC Ceiling Price
     C                     Z-ADD*ZERO     YL0012  52
      * Define local work field Market Price USR
     C                     Z-ADD*ZERO     YL0013  52
      * Define local work field Pricing UOM USR
     C                     MOVEL*BLANK    YL0014  2
      * Define local work field Pricing Date USR
     C                     Z-ADD*ZERO     YL0015  70
      * Define local work field Status 1
     C                     MOVEL*BLANK    YL0016  1
      *================================================================
     CSR         ZZEXIT    ENDSR
