// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PKMHPVR
// ?Date: 14.08.2025 Time: 02:52:11
// ?------------------------------------------------------------------------------------------------

//?USER: Initialize program

//?Modifications and Comments
DO;

//?H16853 ISE 11/02/20 - Increased the Buy Order Number field
//?                      length from 5 to 7.
ENDDO;

// PAR.PRT Night Queue Run Sts = CND.No
PAR.PRT_Night_Queue_Run_Sts = 'N';

//?USER: Load screen

MOVE *ALL (To: DTL From: PAR);

// DTL.Condition Name USR = Condition name of DTL.Damage Report Type Sts
DTL.Condition_Name_USR = RTVCND(DTL.Damage_Report_Type_Sts);

//?USER: Validate fields

// DTL.Condition Name USR = Condition name of DTL.Damage Report Type Sts
DTL.Condition_Name_USR = RTVCND(DTL.Damage_Report_Type_Sts);

CASE;

// IF DTL.Damage Report Type Sts is by Gross Margin
IF DTL.Damage_Report_Type_Sts = 'G';

// AND DTL.Comparison Code USR EQ WRK.Blank USR
AND DTL.Comparison_Code_USR = WRK.Blank_USR;

// Send error message - 'Comparison Code is required.'
ERROR(PRK0881);
MSGPARM(DTL.Comparison_Code_USR);

ENDIF;

//?USER: User defined action

// Call program Pmt Print Options Size XF.
CALL PROGRAM(Pmt Print Options Size XF) ('PDV8PVR');
PARAMETER('Producer Comparison Rpt');
PARAMETER(PAR.PRT_Printer_Device);
PARAMETER(PAR.PRT_Hold_Output_Sts);
PARAMETER(PAR.PRT_Save_Output_Sts);
PARAMETER(PAR.PRT_Copies);
PARAMETER(PAR.PRT_Night_Queue_Run_Sts);
PARAMETER(PAR.PRT_Night_Queue);
PARAMETER('HPE');
PARAMETER(2);

CASE;

// IF PGM.*Return code is *User QUIT requested
IF PGM.*Return_code = 'Y2U9999';

// IF *OTHERWISE
IF *OTHERWISE;

// WRK.Date Alpha USR = CVTVAR(DTL.PCS From Kill Date)
WRK.Date_Alpha_USR = CVTVAR(DTL.PCS_From_Kill_Date);

// WRK.Date Alpha Usr 2 = CVTVAR(DTL.PCS To Kill Date)
WRK.Date_Alpha_Usr_2 = CVTVAR(DTL.PCS_To_Kill_Date);

// Execute command - 'Prt Contract Damage'
EXECUTE COMMAND(PRK0775);
PARAMETER(DTL.CC_Company_Number);
PARAMETER(DTL.PCS_Code);
PARAMETER(PAR.PCS_Damage_Contract);
PARAMETER(DTL.Damage_Report_Type_Sts);
PARAMETER(PAR.Oms_System_Value_Alpha);
PARAMETER(PAR.PRT_Printer_Device);
PARAMETER(PAR.PRT_Hold_Output_Sts);
PARAMETER(PAR.PRT_Save_Output_Sts);
PARAMETER(PAR.PRT_Copies);
PARAMETER(PAR.PRT_Night_Queue);
PARAMETER(WRK.Date_Alpha_USR);
PARAMETER(WRK.Date_Alpha_Usr_2);
PARAMETER(DTL.Comparison_Code_USR);

ENDIF;

