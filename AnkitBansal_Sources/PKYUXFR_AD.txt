// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PKYUXFR
// ?Date: 14.08.2025 Time: 02:53:20
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?Get the MTech Live Yes or No
DO;

//?E2423 Mtech Live will not use this HPS program
//?Mtech Live Yes or no
// Call program Rtv Company Values    XF.
CALL PROGRAM(Rtv Company Values    XF) ('PDGKXFR');
PARAMETER(PAR.BOH_Company_Number);
PARAMETER('MTECHLIVE');
PARAMETER(WRK.System_Value_Alpha_USR);

// LCL.MTech Live Yes or No = WRK.System Value Alpha    USR
LCL.MTech_Live_Yes_or_No = WRK.System_Value_Alpha_USR;

//?E2423 Mtech Not Live will use the hps program that will get
//?the farm site by reading the movement data in HPS
//?E2423 Changes due to the fact that the Farm Site will be
//?used from the Tattoo Header when live with mtech
//?MTech Not Live - Internal Hogs only
//?The Current process is using a co # '350'  + FARM SITE
//?               from the HPS Movement data
//?MTECH - LIVE - Internal will NOT pad '350' + Farm Site
//?MTECH - LIVE - Internal - SEND in the full size Farm Site
//?               from the Tattoo Header
ENDDO;

EXECUTE FUNCTION(Rtv TH Trace 4 OMS RT) TYPE(RTVOBJ) FILE(PKA1CPP)              AB1242784;
PARAMETER(PAR.BOH_Company_Number);
PARAMETER(PAR.Tattoo_Number_USR);
PARAMETER(PAR.TH_Kill_Date);
PARAMETER(PAR.TH_Sex);
PARAMETER(LCL.SR_Type);
PARAMETER(LCL.TH_HPS_Movement_Ref_#);
PARAMETER(LCL.SR_Source_Code);
PARAMETER(LCL.TH_State);
PARAMETER(LCL.TH_HPS_Farm_Site);
PARAMETER(LCL.PD_Producer_Code);
PARAMETER(LCL.PL_Location_Code);
PARAMETER(LCL.GN_Genetic_Code);
PARAMETER(LCL.PS_Site_ID);
{
 //?USER: Initialize routine

 //?MTech - Pass back the Farm Site
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

 EXECUTE FUNCTION(Rtv Tattoo Hdr ExtInf RT) TYPE(RTVOBJ) FILE(PKDNCPP)           AB1272325;
 PARAMETER(DB1.BOH_Company_Number);
 PARAMETER(DB1.BOH_Buy_Order_Number);
 PARAMETER(DB1.BOL_Load_Number);
 PARAMETER(DB1.TH_Tattoo_Number);
 PARAMETER(DB1.TH_Kill_Date);
 PARAMETER(PAR.PS_Site_ID);
 {
  //?USER: Initialize routine

  // PGM.*Return code = CND.*Normal
  PGM.*Return_code = *BLANK;

  // PAR.PS Site ID = CON.*BLANK
  PAR.PS_Site_ID = *BLANK;

  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  // PGM.*Return code = CND.*Record does not exist
  PGM.*Return_code = 'Y2U0005';

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

  // PGM.*Return code = CND.*Normal
  PGM.*Return_code = *BLANK;

 }

}


// PAR.SR Type = LCL.SR Type
PAR.SR_Type = LCL.SR_Type;

// PAR.SR Source Code = LCL.SR Source Code
PAR.SR_Source_Code = LCL.SR_Source_Code;

// PAR.PD Producer Code = LCL.PD Producer Code
PAR.PD_Producer_Code = LCL.PD_Producer_Code;

// PAR.PL Location Code = LCL.PL Location Code
PAR.PL_Location_Code = LCL.PL_Location_Code;

//?P405A DN 04/23/20-Initialize.
// PAR.Location/Farm Code USR = CND.Not Entered
PAR.Location_Farm_Code_USR = *BLANK;

// PAR.Address number 7A USR = CND.Not Entered
PAR.Address_number_7A_USR = *BLANK;

EXECUTE FUNCTION(Rtv Source Desc       RT) TYPE(RTVOBJ) FILE(PKAAREP)           AB1124642;
PARAMETER(LCL.SR_Source_Code);
PARAMETER(PAR.SR_Description);
{
 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


//?If External -----
CASE;

// IF LCL.SR Type is External
IF LCL.SR_Type = 'E';

//?If Producer site is blank use the orig code for guymon.
CASE;

// IF LCL.PS Site ID is *Blank
IF LCL.PS_Site_ID = *BLANK;

EXECUTE FUNCTION(Rtv Producer Nm,Vndr  RT) TYPE(RTVOBJ) FILE(PKACREP)           AB1242785;
PARAMETER(LCL.PD_Producer_Code);
PARAMETER(PAR.PD_Name);
PARAMETER(LCL.Address_Number);
{
 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


EXECUTE FUNCTION(Rtv Pdctn Loc Vnd Nbr RT) TYPE(RTVOBJ) FILE(PKAFREP)           AB1190122;
PARAMETER(LCL.PD_Producer_Code);
PARAMETER(LCL.PL_Location_Code);
PARAMETER(LCL.PL_Name);
PARAMETER(LCL.Address_Number);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


//?T12136 RMC 12/05/17 - chg address from wrk.address to lcl.address
//?R10690 JJH 06/12/17 - Get Address from Producer Location Address
// Call program Rtv Producer Loc Addr XF.
CALL PROGRAM(Rtv Producer Loc Addr XF) ('PWC6XFR');
PARAMETER(LCL.PD_Producer_Code);
PARAMETER(LCL.PL_Location_Code);
PARAMETER(LCL.Address_Number);
PARAMETER(LCL.Pass_Name);
PARAMETER(WRK.Address_1);
PARAMETER(WRK.Address_2);
PARAMETER(WRK.Address_3);
PARAMETER(LCL.City);
PARAMETER(LCL.State);
PARAMETER(WRK.Zip);
PARAMETER(WRK.Area_Code);
PARAMETER(WRK.Country_Code);
PARAMETER(WRK.Telephone);
PARAMETER(WRK.Fax_Area_Code_#);
PARAMETER(WRK.Fax_Telephone);
PARAMETER(WRK.Fax_Attn_1);
PARAMETER(WRK.Fax_Area_Code_#_2);
PARAMETER(WRK.Fax_Telephone_2);
PARAMETER(WRK.Fax_Attn_2);
PARAMETER(WRK.Vendor_1099);
PARAMETER(WRK.Vendor_Tax_Id);

CASE;

// IF LCL.Address Number is Zero
IF LCL.Address_Number = *ZERO;

EXECUTE FUNCTION(Rtv Producer EXT2     RT) TYPE(RTVOBJ) FILE(PLB4REP)           AB1322079;
PARAMETER(LCL.PD_Producer_Code);
PARAMETER(WRK.M3_Supplier_ID);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


//?P405A DN 04/23/20-Replaced Address number 6A with Address number 7A.
// Execute function *Move-Right.
EXECUTE FUNCTION(*Move-Right) TYPE(EXCUSRSRC) ('PLECUFR');
PARAMETER(WRK.Address_number_7A_USR);
PARAMETER(WRK.M3_Supplier_ID);
{
 C                     MOVE #IAVNA    #OAUNA
}


// LCL.Address Number = CVTVAR(WRK.Address number 7A USR)
LCL.Address_Number = CVTVAR(WRK.Address_number_7A_USR);

ENDIF;

EXECUTE FUNCTION(Rtv Comment type "M"  RT) TYPE(RTVOBJ) FILE(PKAHREP)           AB1242827;
PARAMETER(LCL.PD_Producer_Code);
PARAMETER(LCL.PL_Location_Code);
PARAMETER(PAR.HPS_Cell_Manager_Nm_USR);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

 QUIT;

}


// PAR.PD Name = LCL.Pass Name
PAR.PD_Name = LCL.Pass_Name;

// PAR.Producer City         USR = LCL.City
PAR.Producer_City_USR = LCL.City;

// PAR.OMS State             USR = LCL.State
PAR.OMS_State_USR = LCL.State;

// WRK.PS Trace Sequence # = LCL.Address Number
WRK.PS_Trace_Sequence_# = LCL.Address_Number;

//?P405A DN 04/23/20-Replaced Address number 6A with Address number 7A.
// PAR.Address number 7A USR = WRK.PS Trace Sequence #
PAR.Address_number_7A_USR = WRK.PS_Trace_Sequence_#;

ENDIF;

//?If Producer site is Entered use this code for St Jo.RMC 5/10 tfs027
CASE;

// IF LCL.PS Site ID is Not Blank
IF LCL.PS_Site_ID <> *BLANK;

EXECUTE FUNCTION(Rtv Producer Nm,Vndr  RT) TYPE(RTVOBJ) FILE(PKACREP)           AB1242785;
PARAMETER(LCL.PD_Producer_Code);
PARAMETER(PAR.PD_Name);
PARAMETER(LCL.Address_Number);
{
 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


EXECUTE FUNCTION(Rtv Site Inf f/Trace  RT) TYPE(RTVOBJ) FILE(PLATREP)           AB1273063;
PARAMETER(LCL.PD_Producer_Code);
PARAMETER(LCL.PS_Site_ID);
PARAMETER(LCL.PS_Site_Name);
PARAMETER(LCL.PS_Manager);
PARAMETER(LCL.PS_City);
PARAMETER(LCL.PS_State);
PARAMETER(LCL.PS_Trace_Sequence_#);
{
 //?USER: Initialize routine

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


// PAR.PD Name = LCL.PS Site Name
PAR.PD_Name = LCL.PS_Site_Name;

// PAR.HPS Cell Manager Nm USR = LCL.PS Manager
PAR.HPS_Cell_Manager_Nm_USR = LCL.PS_Manager;

// PAR.Producer City         USR = LCL.PS City
PAR.Producer_City_USR = LCL.PS_City;

// PAR.OMS State             USR = LCL.PS State
PAR.OMS_State_USR = LCL.PS_State;

//?P405A DN 04/23/20-Replaced Address number 6A with Address number 7A.
// PAR.Address number 7A USR = LCL.PS Trace Sequence #
PAR.Address_number_7A_USR = LCL.PS_Trace_Sequence_#;

// PAR.PD Producer Code = LCL.PS Trace Sequence #
PAR.PD_Producer_Code = LCL.PS_Trace_Sequence_#;

ENDIF;

// PAR.GN Genetic Code = LCL.GN Genetic Code
PAR.GN_Genetic_Code = LCL.GN_Genetic_Code;

EXECUTE FUNCTION(Rtv Genetic Record    RT) TYPE(RTVOBJ) FILE(PKAIREP)           AB1107738;
PARAMETER(LCL.GN_Genetic_Code);
PARAMETER(PAR.GN_Description);
{
 //?USER: Processing if Data record not found

 // *MO.VE             1183529*Bu = ilt. in functions
 PAR.GN_Description = *BLANK;

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


ENDIF;

//?If Internal -----
CASE;

// IF LCL.SR Type is Internal
IF LCL.SR_Type = 'I';

//?P405A DN 04/24/20-Blank Out PD Producer Code.
// PAR.PD Producer Code = CND.Blank
PAR.PD_Producer_Code = *BLANK;

CASE;

// IF LCL.MTech Live Yes or No is No MTech not Live
IF LCL.MTech_Live_Yes_or_No = 'N';

// Call program Z1v HPS Trace f/ Mvmt UP.
CALL PROGRAM(Z1v HPS Trace f/ Mvmt UP) ('HP259');
PARAMETER(WRK.Return_Code_USR);
PARAMETER(LCL.TH_HPS_Movement_Ref_#);
PARAMETER(WRK.HPS_Group_Code_Alpha);
PARAMETER(WRK.Farm_Site_USR);
PARAMETER(PAR.PD_Name);
PARAMETER(PAR.OMS_State_USR);
PARAMETER(PAR.HPS_Cell_Manager_Code_USR);
PARAMETER(PAR.HPS_Cell_Manager_Nm_USR);
PARAMETER(PAR.TH_Sex);
PARAMETER(LCL.GN_Genetic_Code);
PARAMETER(LCL.HPS_Farm_County);

//?put the company number in front of the farm #. the farm is actually 3,0
//?P405A DN 04/23/20-Replaced Farm Site 6.0 USR with Farm Site 7.0 USR
//?      and add by '3500000' to support 4 digit Farm #.
// WRK.Farm Site 7.0 USR = WRK.Farm Site USR + CON.3500000
WRK.Farm_Site_7_0_USR = WRK.Farm_Site_USR + 3500000;

//?P405A DN 04/23/20-For Internal Hog, do not set/use PD Producer Code
//?      but use 'Location/Farm Code USR' instead.
// LCL.Location/Farm Code USR = CVTVAR(WRK.Farm Site 7.0 USR)
LCL.Location_Farm_Code_USR = CVTVAR(WRK.Farm_Site_7_0_USR);

// PAR.Location/Farm Code USR = LCL.Location/Farm Code USR
PAR.Location_Farm_Code_USR = LCL.Location_Farm_Code_USR;

// PAR.GN Genetic Code = LCL.GN Genetic Code
PAR.GN_Genetic_Code = LCL.GN_Genetic_Code;

// PAR.GN Description = LCL.GN Genetic Code
PAR.GN_Description = LCL.GN_Genetic_Code;

//?P405A DN 04/23/20-Replaced Address number 6A with Address number 7A.
// PAR.Address number 7A USR = CVTVAR(WRK.Farm Site 7.0 USR)
PAR.Address_number_7A_USR = CVTVAR(WRK.Farm_Site_7_0_USR);

//?*  Note:  Put county in the city when available              7/08/02
// PAR.Producer City         USR = LCL.HPS Farm County
PAR.Producer_City_USR = LCL.HPS_Farm_County;

// IF LCL.MTech Live Yes or No is Yes MTech is Live
IF LCL.MTech_Live_Yes_or_No = 'Y';

//?New program written by Farm site for MTech Live
// Call program Rtv HPS Farm Inf-Mtech UP.
CALL PROGRAM(Rtv HPS Farm Inf-Mtech UP) ('HP293');
PARAMETER(PGM.*Return_code);
PARAMETER(PAR.PD_Name);
PARAMETER(LCL.TH_HPS_Farm_Site);
PARAMETER(WRK.HPS_FS_Comp_Relation_USR);
PARAMETER(WRK.State);
PARAMETER(WRK.HPS_Farm_County);
PARAMETER(PAR.HPS_Cell_Manager_Code_USR);
PARAMETER(PAR.HPS_Cell_Manager_Nm_USR);
PARAMETER(NLL.MTech_Farm_Site_Ref);
PARAMETER(NLL.MTech_Cell_Manager_Ref);

// LCL.GN Genetic Code = CON.*BLANK
LCL.GN_Genetic_Code = *BLANK;

// PAR.OMS State             USR = WRK.State
PAR.OMS_State_USR = WRK.State;

//?Mtech NO longer any genetic from movement number so blank on Genetic
//?Mtech get the farm site from the tattoo header
//?P405A DN 04/24/20-Replaced Farm Site 6.0 USR with Farm Site 7.0 USR.
// WRK.Farm Site 7.0 USR = LCL.TH HPS Farm Site
WRK.Farm_Site_7_0_USR = LCL.TH_HPS_Farm_Site;

//?P405A DN 04/24/20-For Internal Hog, do not set/use PD Producer Code
//?      but use 'Location/Farm Code USR' instead.
// LCL.Location/Farm Code USR = CVTVAR(WRK.Farm Site 7.0 USR)
LCL.Location_Farm_Code_USR = CVTVAR(WRK.Farm_Site_7_0_USR);

// PAR.Location/Farm Code USR = LCL.Location/Farm Code USR
PAR.Location_Farm_Code_USR = LCL.Location_Farm_Code_USR;

// PAR.GN Genetic Code = LCL.GN Genetic Code
PAR.GN_Genetic_Code = LCL.GN_Genetic_Code;

// PAR.GN Description = LCL.GN Genetic Code
PAR.GN_Description = LCL.GN_Genetic_Code;

//?P405A DN 04/23/20-Replaced Address number 6A with Address number 7A.
// PAR.Address number 7A USR = CVTVAR(WRK.Farm Site 7.0 USR)
PAR.Address_number_7A_USR = CVTVAR(WRK.Farm_Site_7_0_USR);

//?*  Note:  Put county in the city when available              7/08/02
// PAR.Producer City         USR = WRK.HPS Farm County
PAR.Producer_City_USR = WRK.HPS_Farm_County;

ENDIF;

ENDIF;

//?Farm name constant text:
//?Date 03/17/2004 Susan Mason - Changes for TFM Release 01
//?                Change logic to test for Source Type of
//?                External or Internal
//?***********************
//?RMC  the par.address # has what needs to be here
//?P405A DN 04/24/20-Replaced Address number 6A with Address number 7A.
// PAR.PD Name = CONCAT(CON.Seaboard Certified Farm #,PAR.Address number 7A USR,CON.1)
PAR.PD_Name = 'Seaboard Certified Farm #' + PAR.Address_number_7A_USR (1);

