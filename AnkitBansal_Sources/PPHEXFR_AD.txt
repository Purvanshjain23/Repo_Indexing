// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PPHEXFR
// ?Date: 14.08.2025 Time: 03:40:39
// ?------------------------------------------------------------------------------------------------

//?Execute user function

MOVE *ALL (To: PAR From: CON);

EXECUTE FUNCTION(RTV Day/Wk/Prd/Yr HPS RT) TYPE(RTVOBJ) FILE(CAAFREP)           AC1618244;
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Post_to_G_L_Date);
PARAMETER(NLL.Julian_Date);
PARAMETER(LCL.Accounting_Year_Code);
PARAMETER(LCL.Accounting_Period_Code);
PARAMETER(NLL.OM_Week);
PARAMETER(NLL.Day_of_Week);
PARAMETER(LCL.Week_Number);
PARAMETER(NLL.HPS_PIC_Date);
PARAMETER(LCL.HPS_Calendar_Year);
PARAMETER(LCL.HPS_Calendar_Week);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 // PGM.*Return code = CND.*Record does not exist
 PGM.*Return_code = 'Y2U0005';

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

 // PGM.*Return code = CND.*Normal
 PGM.*Return_code = *BLANK;

}


CASE;

// IF PAR.Date Type USR is Weekly
IF PAR.Date_Type_USR = 'W';

EXECUTE FUNCTION(RTV Wk Start/End      RT) TYPE(RTVOBJ) FILE(CAAFREP)           AC1598657;
PARAMETER(PAR.Company_Number);
PARAMETER(LCL.Accounting_Year_Code);
PARAMETER(LCL.Week_Number);
PARAMETER(WRK.Date_Mon_USR);
PARAMETER(WRK.Date_Tue_USR);
PARAMETER(WRK.Date_Wed_USR);
PARAMETER(WRK.Date_Thu_USR);
PARAMETER(WRK.Date_Fri_USR);
PARAMETER(LCL.Period_Ending_Date);
PARAMETER(LCL.Period_Beginning_Date);
PARAMETER('Y');
{
 //?USER: Initialize routine

 CASE;

 // IF PAR.First Time Flag is Yes
 IF PAR.First_Time_Flag = 'Y';

 MOVE *ALL (To: PAR From: CON);

 ENDIF;

 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 CASE;

 // IF DB1.Day of Week is Sunday
 IF DB1.Day_of_Week = '1';

 // PAR.Date Sun USR = DB1.Post to G/L Date
 PAR.Date_Sun_USR = DB1.Post_to_G_L_Date;

 // IF DB1.Day of Week is Monday
 IF DB1.Day_of_Week = '2';

 // PAR.Date Mon USR = DB1.Post to G/L Date
 PAR.Date_Mon_USR = DB1.Post_to_G_L_Date;

 // IF DB1.Day of Week is Tuesday
 IF DB1.Day_of_Week = '3';

 // PAR.Date Tue USR = DB1.Post to G/L Date
 PAR.Date_Tue_USR = DB1.Post_to_G_L_Date;

 // IF DB1.Day of Week is Wednesday
 IF DB1.Day_of_Week = '4';

 // PAR.Date Wed USR = DB1.Post to G/L Date
 PAR.Date_Wed_USR = DB1.Post_to_G_L_Date;

 // IF DB1.Day of Week is Thursday
 IF DB1.Day_of_Week = '5';

 // PAR.Date Thu USR = DB1.Post to G/L Date
 PAR.Date_Thu_USR = DB1.Post_to_G_L_Date;

 // IF DB1.Day of Week is Friday
 IF DB1.Day_of_Week = '6';

 // PAR.Date Fri USR = DB1.Post to G/L Date
 PAR.Date_Fri_USR = DB1.Post_to_G_L_Date;

 // IF DB1.Day of Week is Saturday
 IF DB1.Day_of_Week = '7';

 // PAR.Date Sat USR = DB1.Post to G/L Date
 PAR.Date_Sat_USR = DB1.Post_to_G_L_Date;

 ENDIF;

}


//?End of the Year.
CASE;

// IF LCL.Period Ending Date is not entered
IF LCL.Period_Ending_Date = *ZERO;

CASE;

// IF WRK.Date Fri USR is Entered
IF WRK.Date_Fri_USR <> *ZERO;

// LCL.Period Ending Date = WRK.Date Fri USR
LCL.Period_Ending_Date = WRK.Date_Fri_USR;

// IF WRK.Date Thu USR is Entered
IF WRK.Date_Thu_USR <> *ZERO;

// LCL.Period Ending Date = WRK.Date Thu USR
LCL.Period_Ending_Date = WRK.Date_Thu_USR;

// IF WRK.Date Wed USR is Entered
IF WRK.Date_Wed_USR <> *ZERO;

// LCL.Period Ending Date = WRK.Date Wed USR
LCL.Period_Ending_Date = WRK.Date_Wed_USR;

// IF WRK.Date Tue USR is Entered
IF WRK.Date_Tue_USR <> *ZERO;

// LCL.Period Ending Date = WRK.Date Tue USR
LCL.Period_Ending_Date = WRK.Date_Tue_USR;

// IF WRK.Date Mon USR is Entered
IF WRK.Date_Mon_USR <> *ZERO;

// LCL.Period Ending Date = WRK.Date Mon USR
LCL.Period_Ending_Date = WRK.Date_Mon_USR;

// IF WRK.Date Sat USR is Entered
IF WRK.Date_Sat_USR <> *ZERO;

// LCL.Period Ending Date = WRK.Date Sat USR
LCL.Period_Ending_Date = WRK.Date_Sat_USR;

ENDIF;

ENDIF;

// IF PAR.Date Type USR is Period
IF PAR.Date_Type_USR = 'P';

EXECUTE FUNCTION(Rtv Period Start/End  RT) TYPE(RTVOBJ) FILE(CAATREP)           AC1666753;
PARAMETER(PAR.Company_Number);
PARAMETER(LCL.Accounting_Year_Code);
PARAMETER(LCL.Accounting_Period_Code);
PARAMETER(LCL.Period_Beginning_Date);
PARAMETER(LCL.Period_Ending_Date);
{
 //?USER: Initialize routine

 // LCL.First Time Flag = CND.Yes
 LCL.First_Time_Flag = 'Y';

 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 CASE;

 // IF LCL.First Time Flag is Yes
 IF LCL.First_Time_Flag = 'Y';

 // PAR.Period Beginning Date = DB1.Period Beginning Date
 PAR.Period_Beginning_Date = DB1.Period_Beginning_Date;

 // LCL.First Time Flag = CND.NO
 LCL.First_Time_Flag = 'N';

 ENDIF;

 // PAR.Period Ending Date = DB1.Period Ending Date
 PAR.Period_Ending_Date = DB1.Period_Ending_Date;

}


ENDIF;

// PAR.HPS Calendar Year = LCL.HPS Calendar Year
PAR.HPS_Calendar_Year = LCL.HPS_Calendar_Year;

// PAR.HPS Calendar Week = LCL.HPS Calendar Week
PAR.HPS_Calendar_Week = LCL.HPS_Calendar_Week;

// PAR.Period Beginning Date = LCL.Period Beginning Date
PAR.Period_Beginning_Date = LCL.Period_Beginning_Date;

// PAR.Period Ending Date = LCL.Period Ending Date
PAR.Period_Ending_Date = LCL.Period_Ending_Date;

RETURN;

