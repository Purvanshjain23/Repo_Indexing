     H/TITLE Edt Prod Adjustments  DF  Display file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Displays the records from DBF as a subfile
     H* - Loads the SFL from the DBF a page at a time
     H* - The DBF record at which the SFL display starts may be
     H*   controlled by positioning fields on the SFL header
     H* - Any key fields on the SFL header will be used as
     H*   positioning values
     H* - Any non-key fields on the SFL header will be used as
     H*   selection values: a maximum of W0SLM records will be
     H*   read from the DBF before giving up
      *
     H* Generated by AllFusion 2E release 8.1SP2 (1250)
     H* Function type : Display file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISSMASO
     H* Date          : 02/23/10  Time  : 09:10:01
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPORWDFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: Edt Prod Adjustments  DF  Display file
      *
     FPDI9CPL8IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RSQ : PS Production Adjustment  Co/CItm/Whs/Itm/PDte
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FOMBYREL1IF  E           K        DISK
      * RTV : Item Default              Retrieval index
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse                 Active records only
      *
     FPOCECPL1IF  E           K        DISK
      * RTV : PS Production Adj Comment Retrieval index
      *
     FCABZRELGIF  E           K        DISK
      * RTV : Company Item              Active Finished Goods
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FPDJCCPL1IF  E           K        DISK
      * RTV : PS Prod Schedule          Retrieval index
      *
     FPDI8CPL1IF  E           K        DISK
      * RTV : PS Prod Item Schedule     Retrieval index
      *
     FPDI9CPL1IF  E           K        DISK
      * RTV : PS Production Adjustment  Retrieval index
      *
     FPDKNCPL2IF  E           K        DISK
      * RSQ : Order Detail Schedule     Co/PrdDte/Item/Whs
      *
     FPDI9CPL2IF  E           K        DISK
      * RTV : PS Production Adjustment  AdjTyp=PR,FC Qty>0
      *
     FCAABREL1IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       V
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FPDI9CPL0UF  E           K        DISK                      A
      * UPD : PS Production Adjustment  Update index
      *
     FPDI8CPL0UF  E           K        DISK                      A
      * UPD : PS Prod Item Schedule     Update index
      *
     E                    J7          7  1
     E                    K7          7  1
      * RIGHT JUSTIFY INPUT FIELD
      * Days in month for date validation
     E                    @XD    12  12  2 0
     E                    #L7         7  1
     E                    #L3         3  1
     E                    UCT        40  1               CENTER TABLE
      * Screen: Field position and name array
     E                    W0BEG   7 020  5 0A
     E                    W0END   7 020  5 0A
     E                    W0NAM   7 020 10
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WAAIC3
     I              BZHGCD                          WAHGCD
     I              BZAVNA                          WAAVNA
     I              BZAWNA                          WAAWNA
     I              BZL7NA                          WAL7NA
     I              BZL8NA                          WAL8NA
     I              BZL6NA                          WAL6NA
     I              BZMFNA                          WAMFNA
     I              BZADCD                          WAADCD
     I              BZAWPC                          WAAWPC
     I              BZLXST                          WALXST
     I              BZAECD                          WAAECD
     I              BZAXPC                          WAAXPC
     I              BZLYST                          WALYST
     I              BZAFCD                          WAAFCD
     I              BZAICD                          WAAICD
     I              BZAIWG                          WAAIWG
     I              BZHICD                          WAHICD
     I              BZRBCD                          WARBCD
     I              BZFZST                          WAFZST
     I              BZAVST                          WAAVST
     I              BZCZWG                          WACZWG
     I              BZC0WG                          WAC0WG
     I              BZURTN                          WAURTN
     I              BZAJC8                          WAAJC8
     I              BZRINB                          WARINB
     I              BZRHNB                          WARHNB
     I              BZRGNB                          WARGNB
     I              BZLNCD                          WALNCD
     I              BZTFNB                          WATFNB
     I              BZN0CD                          WAN0CD
     I              BZX4ST                          WAX4ST
     I              BZTMVA                          WATMVA
     I              BZTNVA                          WATNVA
     I              BZBLPR                          WABLPR
     I              BZBMPR                          WABMPR
     I              BZLRCD                          WALRCD
     I              BZU9ST                          WAU9ST
     I              BZCMCO                          WACMCO
     I              BZQ1CD                          WAQ1CD
     I              BZQ8CD                          WAQ8CD
     I              BZCHTM                          WACHTM
     I              BZQZCD                          WAQZCD
     I              BZXWST                          WAXWST
     I              BZXXST                          WAXXST
     I              BZVMST                          WAVMST
     I              BZSWGH                          WASWGH
     I              BZPPHE                          WAPPHE
     I              BZR3CD                          WAR3CD
     I              BZSDCD                          WASDCD
     I              BZICN1                          WAICN1
     I              BZSVCD                          WASVCD
     I              BZICN2                          WAICN2
     I              BZSWCD                          WASWCD
     I              BZV2NB                          WAV2NB
     I              BZSXCD                          WASXCD
     I              BZITCN                          WAITCN
     I              BZSYCD                          WASYCD
     I              BZITC5                          WAITC5
     I              BZSZCD                          WASZCD
     I              BZICN6                          WAICN6
     I              BZS0CD                          WAS0CD
     I              BZICN7                          WAICN7
     I              BZS1CD                          WAS1CD
     I              BZICN8                          WAICN8
     I              BZS2CD                          WAS2CD
     I              BZICN9                          WAICN9
     I              BZS3CD                          WAS3CD
     I              BZICN0                          WAICN0
     I              BZS4CD                          WAS4CD
     I              BZSFNB                          WASFNB
     I              BZA3WG                          WAA3WG
     I              BZSJNB                          WASJNB
     I              BZLLCD                          WALLCD
     I              BZLMCD                          WALMCD
     I              BZP3ST                          WAP3ST
     I              BZSKNB                          WASKNB
     I              BZSLNB                          WASLNB
     I              BZSMNB                          WASMNB
     I              BZP4ST                          WAP4ST
     I              BZCFNB                          WACFNB
     I              BZCGNB                          WACGNB
     I              BZILNB                          WAILNB
     I              BZCHNB                          WACHNB
     I              BZCINB                          WACINB
     I              BZCJNB                          WACJNB
     I              BZCMNB                          WACMNB
     I              BZCNNB                          WACNNB
     I              BZCRNB                          WACRNB
     I              BZCSNB                          WACSNB
     I              BZCVNB                          WACVNB
     I              BZCWNB                          WACWNB
     I              BZCXNB                          WACXNB
     I              BZCZNB                          WACZNB
     I              BZC0NB                          WAC0NB
     I              BZN1CD                          WAN1CD
     I              BZB4NB                          WAB4NB
     I              BZB5NB                          WAB5NB
     I              BZX5ST                          WAX5ST
     I              BZX6ST                          WAX6ST
     I              BZX7ST                          WAX7ST
     I              BZPCCT                          WAPCCT
     I              BZBDNB                          WABDNB
     I              BZBJNB                          WABJNB
     I              BZSUST                          WASUST
     I              BZSVST                          WASVST
     I              BZSYST                          WASYST
     I              BZSZST                          WASZST
     I              BZS1ST                          WAS1ST
     I              BZXRCD                          WAXRCD
     I              BZXTCD                          WAXTCD
     I              BZXUCD                          WAXUCD
     I              BZF5WG                          WAF5WG
     I              BZF6WG                          WAF6WG
     I              BZF7WG                          WAF7WG
     I              BZBLNB                          WABLNB
     I              BZBNNB                          WABNNB
     I              BZS2ST                          WAS2ST
     I              BZS4ST                          WAS4ST
     I              BZS5ST                          WAS5ST
     I              BZS6ST                          WAS6ST
     I              BZS8ST                          WAS8ST
     I              BZS9ST                          WAS9ST
     I              BZTCST                          WATCST
     I              BZTDST                          WATDST
     I              BZUVST                          WAUVST
     I              BZUWST                          WAUWST
     I              BZUXST                          WAUXST
     I              BZVSST                          WAVSST
     I              BZAATM                          WAAATM
     I              BZAYNA                          WAAYNA
     I              BZA0NA                          WAA0NA
     I              BZAXDT                          WAAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WBAJCD
     I              ADF8NA                          WBF8NA
     I              ADACNA                          WBACNA
     I              ADADNA                          WBADNA
     I              ADAENA                          WBAENA
     I              ADAJNA                          WBAJNA
     I              ADBTTX                          WBBTTX
     I              ADAOCD                          WBAOCD
     I              ADBGCD                          WBBGCD
     I              ADVHST                          WBVHST
     I              ADMPNA                          WBMPNA
     I              ADWPST                          WBWPST
     I              ADXUST                          WBXUST
     I              ADT0ST                          WBT0ST
     I              ADT1ST                          WBT1ST
     I              ADDBNB                          WBDBNB
     I              ADT2ST                          WBT2ST
     I              ADT3ST                          WBT3ST
     I              ADT4ST                          WBT4ST
     I              ADT6ST                          WBT6ST
     I              ADBWC3                          WBBWC3
     I              ADBTC3                          WBBTC3
     I              ADBUC3                          WBBUC3
     I              ADBVC3                          WBBVC3
     I              ADFCAA                          WBFCAA
     I              ADRQSX                          WBRQSX
     I              ADRRSX                          WBRRSX
     I              ADRSSX                          WBRSSX
     I              ADRTSX                          WBRTSX
     I              ADT7ST                          WBT7ST
     I              ADT8ST                          WBT8ST
     I              ADRNSX                          WBRNSX
     I              ADROSX                          WBROSX
     I              ADRPSX                          WBRPSX
     I              ADUVST                          WBUVST
     I              ADUWST                          WBUWST
     I              ADUXST                          WBUXST
     I              ADVSST                          WBVSST
     I              ADAATM                          WBAATM
     I              ADAYNA                          WBAYNA
     I              ADA0NA                          WBA0NA
     I              ADAXDT                          WBAXDT
      *
     I@I9CPUV
      * PS Production Adjustment  Retrieval index
      * Renamed input format fields
     I              I9AIC3                          WCAIC3
     I              I9ELDT                          WCELDT
     I              I9HGCD                          WCHGCD
     I              I9AJCD                          WCAJCD
     I              I9PSAD                          WCPSAD
     I              I9PSAN                          WCPSAN
     I              I9PIAD                          WCPIAD
     I              I9V6ST                          WCV6ST
     I              I9D8C7                          WCD8C7
     I              I9UVST                          WCUVST
     I              I9UWST                          WCUWST
     I              I9UXST                          WCUXST
     I              I9VSST                          WCVSST
     I              I9AATM                          WCAATM
     I              I9AYNA                          WCAYNA
     I              I9A0NA                          WCA0NA
     I              I9AXDT                          WCAXDT
      *
     I@I9CPUU
      * PS Production Adjustment  Update index
      * Renamed input format fields
     I              I9AIC3                          WDAIC3
     I              I9ELDT                          WDELDT
     I              I9HGCD                          WDHGCD
     I              I9AJCD                          WDAJCD
     I              I9PSAD                          WDPSAD
     I              I9PSAN                          WDPSAN
     I              I9PIAD                          WDPIAD
     I              I9V6ST                          WDV6ST
     I              I9D8C7                          WDD8C7
     I              I9UVST                          WDUVST
     I              I9UWST                          WDUWST
     I              I9UXST                          WDUXST
     I              I9VSST                          WDVSST
     I              I9AATM                          WDAATM
     I              I9AYNA                          WDAYNA
     I              I9A0NA                          WDA0NA
     I              I9AXDT                          WDAXDT
      *
     I@I8CPUR
      * PS Prod Item Schedule     Update index
      * Renamed input format fields
     I              I8AIC3                          WEAIC3
     I              I8V5ST                          WEV5ST
     I              I8ELDT                          WEELDT
     I              I8HGCD                          WEHGCD
     I              I8AJCD                          WEAJCD
     I              I8GPDT                          WEGPDT
     I              I8WTSP                          WEWTSP
     I              I8QTSP                          WEQTSP
     I              I8DJPC                          WEDJPC
     I              I8F8WG                          WEF8WG
     I              I8WTIN                          WEWTIN
     I              I8D5NB                          WED5NB
     I              I8DXWG                          WEDXWG
     I              I8B2NB                          WEB2NB
     I              I8WTCN                          WEWTCN
     I              I8PSCV                          WEPSCV
     I              I8SAWT                          WESAWT
     I              I8B9NB                          WEB9NB
     I              I8D1WG                          WED1WG
     I              I8CBNB                          WECBNB
     I              I8EZWG                          WEEZWG
     I              I8CCNB                          WECCNB
     I              I8E0WG                          WEE0WG
     I              I8D6NB                          WED6NB
     I              I8OAWT                          WEOAWT
     I              I8CDNB                          WECDNB
     I              I8UNW2                          WEUNW2
     I              I8CENB                          WECENB
     I              I8F9WG                          WEF9WG
     I              I8BPNB                          WEBPNB
     I              I8GAWG                          WEGAWG
     I              I8BQNB                          WEBQNB
     I              I8GBWG                          WEGBWG
     I              I8BRNB                          WEBRNB
     I              I8GCWG                          WEGCWG
     I              I8BSNB                          WEBSNB
     I              I8GDWG                          WEGDWG
     I              I8BWNB                          WEBWNB
     I              I8GEWG                          WEGEWG
     I              I8PS6U                          WEPS6U
     I              I8WCST                          WEWCST
     I              I8WPST                          WEWPST
     I              I8B5ST                          WEB5ST
     I              I8TFST                          WETFST
     I              I8TEST                          WETEST
     I              I8THST                          WETHST
     I              I8UDST                          WEUDST
     I              I8UFST                          WEUFST
     I              I8UGST                          WEUGST
     I              I8UHST                          WEUHST
     I              I8B6ST                          WEB6ST
     I              I8B7ST                          WEB7ST
     I              I8DVWG                          WEDVWG
     I              I8D7NB                          WED7NB
     I              I8FCAD                          WEFCAD
     I              I8D9NB                          WED9NB
     I              I8DWWG                          WEDWWG
     I              I8EANB                          WEEANB
     I              I8SHWT                          WESHWT
     I              I8EBNB                          WEEBNB
     I              I8AVWT                          WEAVWT
     I              I8ECNB                          WEECNB
     I              I8WTON                          WEWTON
     I              I8EDNB                          WEEDNB
     I              I8FNWT                          WEFNWT
     I              I8EENB                          WEEENB
     I              I8QTAS                          WEQTAS
     I              I8EFNB                          WEEFNB
     I              I8WAIO                          WEWAIO
     I              I8EGNB                          WEEGNB
     I              I8R3CD                          WER3CD
     I              I8RGNB                          WERGNB
     I              I8RHNB                          WERHNB
     I              I8RINB                          WERINB
     I              I8XRCD                          WEXRCD
     I              I8UVST                          WEUVST
     I              I8UWST                          WEUWST
     I              I8UXST                          WEUXST
     I              I8VSST                          WEVSST
     I              I8AATM                          WEAATM
     I              I8AYNA                          WEAYNA
     I              I8A0NA                          WEA0NA
     I              I8AXDT                          WEAXDT
      *
     I@I9CPCV
      * PS Production Adjustment  AdjTyp=PR,FC Qty>0
      * Renamed input format fields
     I              I9AIC3                          WFAIC3
     I              I9ELDT                          WFELDT
     I              I9HGCD                          WFHGCD
     I              I9AJCD                          WFAJCD
     I              I9PSAD                          WFPSAD
     I              I9PSAN                          WFPSAN
     I              I9PIAD                          WFPIAD
     I              I9V6ST                          WFV6ST
     I              I9D8C7                          WFD8C7
     I              I9UVST                          WFUVST
     I              I9UWST                          WFUWST
     I              I9UXST                          WFUXST
     I              I9VSST                          WFVSST
     I              I9AATM                          WFAATM
     I              I9AYNA                          WFAYNA
     I              I9A0NA                          WFA0NA
     I              I9AXDT                          WFAXDT
      *
     I@ABREAK
      * Company Name and Address  Retrieval index       V
      * Renamed input format fields
     I              ABAIC3                          WGAIC3
     I              ABADTX                          WGADTX
     I              ABACNA                          WGACNA
     I              ABADNA                          WGADNA
     I              ABAENA                          WGAENA
     I              ABAJNA                          WGAJNA
     I              ABBTTX                          WGBTTX
     I              ABBVTX                          WGBVTX
     I              ABBWTX                          WGBWTX
     I              ABA2NA                          WGA2NA
     I              ABABTX                          WGABTX
     I              ABBGCD                          WGBGCD
     I              ABKXCD                          WGKXCD
     I              ABUVST                          WGUVST
     I              ABUWST                          WGUWST
     I              ABUXST                          WGUXST
     I              ABVSST                          WGVSST
     I              ABAATM                          WGAATM
     I              ABAYNA                          WGAYNA
     I              ABA0NA                          WGA0NA
     I              ABAXDT                          WGAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
      * Outward parameters
     IPARC        DS                             10
      * KEY : Item Bill Of Material     Co/CompItem/Item Typ=C
      * I : RST Company Number
     I                                    P   1   20PAAIC3
      * I : RST Component Item Code
     I                                    P   3   60PAC9NB
      * B : MAP Item Code
     I                                    P   7  100PAHGCD
      *
     IQPDI91    E DSPDI9CPL0
      * UPD : PS Production Adjustment  Update index
      * Renamed input format fields
     I              I9AIC3                          WDAIC3
     I              I9ELDT                          WDELDT
     I              I9HGCD                          WDHGCD
     I              I9AJCD                          WDAJCD
     I              I9PSAD                          WDPSAD
     I              I9PSAN                          WDPSAN
     I              I9PIAD                          WDPIAD
     I              I9V6ST                          WDV6ST
     I              I9D8C7                          WDD8C7
     I              I9UVST                          WDUVST
     I              I9UWST                          WDUWST
     I              I9UXST                          WDUXST
     I              I9VSST                          WDVSST
     I              I9AATM                          WDAATM
     I              I9AYNA                          WDAYNA
     I              I9A0NA                          WDA0NA
     I              I9AXDT                          WDAXDT
      *
     IQPDI81    E DSPDI8CPL0
      * UPD : PS Prod Item Schedule     Update index
      * Renamed input format fields
     I              I8AIC3                          WEAIC3
     I              I8V5ST                          WEV5ST
     I              I8ELDT                          WEELDT
     I              I8HGCD                          WEHGCD
     I              I8AJCD                          WEAJCD
     I              I8GPDT                          WEGPDT
     I              I8WTSP                          WEWTSP
     I              I8QTSP                          WEQTSP
     I              I8DJPC                          WEDJPC
     I              I8F8WG                          WEF8WG
     I              I8WTIN                          WEWTIN
     I              I8D5NB                          WED5NB
     I              I8DXWG                          WEDXWG
     I              I8B2NB                          WEB2NB
     I              I8WTCN                          WEWTCN
     I              I8PSCV                          WEPSCV
     I              I8SAWT                          WESAWT
     I              I8B9NB                          WEB9NB
     I              I8D1WG                          WED1WG
     I              I8CBNB                          WECBNB
     I              I8EZWG                          WEEZWG
     I              I8CCNB                          WECCNB
     I              I8E0WG                          WEE0WG
     I              I8D6NB                          WED6NB
     I              I8OAWT                          WEOAWT
     I              I8CDNB                          WECDNB
     I              I8UNW2                          WEUNW2
     I              I8CENB                          WECENB
     I              I8F9WG                          WEF9WG
     I              I8BPNB                          WEBPNB
     I              I8GAWG                          WEGAWG
     I              I8BQNB                          WEBQNB
     I              I8GBWG                          WEGBWG
     I              I8BRNB                          WEBRNB
     I              I8GCWG                          WEGCWG
     I              I8BSNB                          WEBSNB
     I              I8GDWG                          WEGDWG
     I              I8BWNB                          WEBWNB
     I              I8GEWG                          WEGEWG
     I              I8PS6U                          WEPS6U
     I              I8WCST                          WEWCST
     I              I8WPST                          WEWPST
     I              I8B5ST                          WEB5ST
     I              I8TFST                          WETFST
     I              I8TEST                          WETEST
     I              I8THST                          WETHST
     I              I8UDST                          WEUDST
     I              I8UFST                          WEUFST
     I              I8UGST                          WEUGST
     I              I8UHST                          WEUHST
     I              I8B6ST                          WEB6ST
     I              I8B7ST                          WEB7ST
     I              I8DVWG                          WEDVWG
     I              I8D7NB                          WED7NB
     I              I8FCAD                          WEFCAD
     I              I8D9NB                          WED9NB
     I              I8DWWG                          WEDWWG
     I              I8EANB                          WEEANB
     I              I8SHWT                          WESHWT
     I              I8EBNB                          WEEBNB
     I              I8AVWT                          WEAVWT
     I              I8ECNB                          WEECNB
     I              I8WTON                          WEWTON
     I              I8EDNB                          WEEDNB
     I              I8FNWT                          WEFNWT
     I              I8EENB                          WEEENB
     I              I8QTAS                          WEQTAS
     I              I8EFNB                          WEEFNB
     I              I8WAIO                          WEWAIO
     I              I8EGNB                          WEEGNB
     I              I8R3CD                          WER3CD
     I              I8RGNB                          WERGNB
     I              I8RHNB                          WERHNB
     I              I8RINB                          WERINB
     I              I8XRCD                          WEXRCD
     I              I8UVST                          WEUVST
     I              I8UWST                          WEUWST
     I              I8UXST                          WEUXST
     I              I8VSST                          WEVSST
     I              I8AATM                          WEAATM
     I              I8AYNA                          WEAYNA
     I              I8A0NA                          WEA0NA
     I              I8AXDT                          WEAXDT
      *
     IYARDCS      DS                            326
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IYBRDCS      DS                            326
     IYCRDCS      DS                             58
      * Outward parameters
     IPBRC        DS                             20
      * KEY : PS Production Adj Comment Retrieval index
      * I : RST Company Number
     I                                    P   1   20PBAIC3
      * I : RST Production Date
     I                                    P   3   60PBELDT
      * I : RST Item Code
     I                                    P   7  100PBHGCD
      * I : RST Warehouse Code
     I                                       11  13 PBAJCD
      * I : RST PS Adjustment Type
     I                                       14  15 PBPSAD
      * I : RST PS Adjustment Number
     I                                    P  16  180PBPSAN
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS                             17
      * KEY: PS Production Adjustment  Co/CItm/Whs/Itm/PDte
      * I : RST Company Number
     I                                    P   1   20P1AIC3
      * I : RST PS Consumed Item Code
     I                                    P   3   60P1D8C7
      * I : RST Warehouse Code
     I                                        7   9 P1AJCD
     IP2PARM      DS
      * FLD: *Arrays
      * N :  Application Code
     I                                        1   6 P2DNCD
      * N :  Enterprise Code 1
     I                                        7  10 P2DQCD
      * N :  Enterprise Code 2
     I                                       11  22 P2DRCD
      * N :  Salesperson Code
     I                                       23  25 P2BCCD
      * N :  System Date Format
     I                                       26  28 P2B8NA
      * N :  User Profile Name
     I                                       29  38 P2AJVN
      * N :  Allow Multi-Company
     I                                       39  39 P2I6ST
      * N :  Allow Multi Warehouse
     I                                       40  40 P2I8ST
      * N :  Default Printer
     I                                       41  50 P2MPNA
      * N :  First Time Flag
     I                                       51  51 P2TAST
      * N :  Name
     I                                       52  81 P2ADTX
      * N :  System Value Alpha
     I                                       82 121 P2BXTX
      * N :  Access Denied (Y/N)
     I                                      122 122 P2WVST
      * N :  Requested Delivery Date
     I                                    P 123 1260P2EIDT
      * N :  *Initial call
     I                                      127 127 P2ICL
     IP3PARM      DS
      * FLD: PS Production Adjustment
      * I :  Item Code
     I                                    P   1   40P3HGCD
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'CD7 Non numeric data'
      * Message data for 'Item Req'
      * Item Code
     I                                        1   7 ZA0001
      * Message data for 'Item not found'
      * Message data for 'Item Not Conv From Base'
      * Item Code
     I                                        1   7 ZA0002
      * Consumed Item Code
     I                                        8  14 ZA0003
      * Message data for 'Prod Date must be entered'
      * Production Date
     I                                    P   1   40ZA0004
      * Message data for 'Production Date must be'
      * Ham Group Production Date
     I                                    P   1   40ZA0005
      * Message data for 'Date Must Be Prod Date'
      * Production Date
     I                                    P   1   40ZA0006
      * Message data for 'Quantity is required'
      * Message data for 'PS BOM Does not Exist'
      * Item Code
     I                                        1   7 ZA0007
      * Message data for 'PS BOM Does not Exist'
      * Item Code
     I                                        1   7 ZA0008
      * Message data for 'PS BOM Does not Exist'
      * Item Code
     I                                        1   7 ZA0009
      * Message data for 'PS BOM Does not Exist'
      * Item Code
     I                                        1   7 ZA0010
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0011
      * Application Code
     I                                       11  16 ZA0012
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0013
      * Application Code
     I                                       11  16 ZA0014
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C                     PARM           P1PARM           KEY: PS Product
     C           P3HGCD    PARM           WP0001  70       Item Code
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise & load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END                             OD W0RSF
     C                     END                             OD *HIVAL
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise and load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
      * USER: Initialize subfile control
      * CASE: LCL.First Time Flag is Yes
     C           YL0001    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    #CSQTX           Company Name DR
      * Company Name DRV
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SARVGN
     C                     MOVEL*BLANK    #COONA           Item Desc DRV
      * Item Desc DRV
      * Rtv Item Descriptions  RT - OM Item  * 
     C                     EXSR SBRVGN
     C                     MOVEL*BLANK    #CO6NA           Warehouse Desc
      * Warehouse Desc DRV
      * RTV Whse Descrip       RT - Warehouse  * 
     C                     EXSR SCRVGN
     C                     MOVEL'N'       YL0001           First Time Flag
     C                     Z-ADDP3HGCD    #2HGCD           Item Code
     C                     END                             *FI
      * Position DBF file
     C           KPOS      KLIST
     C                     KFLD           I9AIC3           Company Number
     C                     KFLD           I9D8C7           PS Consumed Ite
     C                     KFLD           I9AJCD           Warehouse Code
     C                     KFLD           I9HGCD           Item Code
     C                     KFLD           I9ELDT           Production Date
      * Setup key
     C                     Z-ADD#2AIC3    I9AIC3
     C                     Z-ADD#2D8C7    I9D8C7
     C                     MOVEL#2AJCD    I9AJCD
     C                     Z-ADD#2HGCD    I9HGCD
     C                     Z-ADD#2ELDT    I9ELDT
     C           KPOS      SETLL@I9CPN4
     C           KRST      KLIST
     C                     KFLD           I9AIC3           Company Number
     C                     KFLD           I9D8C7           PS Consumed Ite
     C                     KFLD           I9AJCD           Warehouse Code
      * Setup key
     C                     Z-ADD#2AIC3    I9AIC3
     C                     Z-ADD#2D8C7    I9D8C7
     C                     MOVEL#2AJCD    I9AJCD
     C           KRST      READE@I9CPN4                8782*82=EOF
      * Save previous selector values
     C           *LIKE     DEFN #2PSAN    WZPSAN
     C                     MOVEL#2PSAN    WZPSAN           PS Adjustment N
     C           *LIKE     DEFN #2AIC3    WZAIC3
     C                     MOVEL#2AIC3    WZAIC3           Company Number
     C           *LIKE     DEFN #CSQTX    WZSQTX
     C                     MOVEL#CSQTX    WZSQTX           Company Name DR
     C           *LIKE     DEFN #2D8C7    WZD8C7
     C                     MOVEL#2D8C7    WZD8C7           PS Consumed Ite
     C           *LIKE     DEFN #COONA    WZOONA
     C                     MOVEL#COONA    WZOONA           Item Desc DRV
     C           *LIKE     DEFN #2AJCD    WZAJCD
     C                     MOVEL#2AJCD    WZAJCD           Warehouse Code
     C           *LIKE     DEFN #CO6NA    WZO6NA
     C                     MOVEL#CO6NA    WZO6NA           Warehouse Desc
     C           *LIKE     DEFN #2PSAD    WZPSAD
     C                     MOVEL#2PSAD    WZPSAD           PS Adjustment T
     C           *LIKE     DEFN #2HGCD    WZHGCD
     C                     MOVEL#2HGCD    WZHGCD           Item Code
     C           *LIKE     DEFN #2PIAD    WZPIAD
     C                     MOVEL#2PIAD    WZPIAD           PS Adjustment Q
     C           *LIKE     DEFN #2ELDT    WZELDT
     C                     MOVEL#2ELDT    WZELDT           Production Date
      * Load subfile page
     C                     Z-ADD0         ##RROK  50
     C                     EXSR BBLDSF
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
      * Re-establish fields in read-ahead record
     C   27                DO
     C  N82                READP@I9CPN4                  90*
     C  N82                READ @I9CPN4                  90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVEL*ALL'0'   WKIND0  2
     C                     MOVEAWKIND0    *IN,36
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
      * Reset count of DBF records read
     C                     Z-ADD0         ##RRRD  90
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next SFL page until SFL page full, or
      * Scan limit reached
     C           *IN82     DOWEQ'0'                        DO
     C           ##RROK    ANDLT##SFLN
     C           ##RRRD    ANDLTW0SLM
      * Check selection fields - if fail, read next record
     C           #2PSAN    IFNE *ZERO                      PS Adjustment N
     C           I9PSAN    CABNE#2PSAN    BB020            PS Adjustment N
     C                     END
     C           #2PSAD    IFNE *BLANK                     PS Adjustment T
     C           I9PSAD    CABNE#2PSAD    BB020            PS Adjustment T
     C                     END
     C           #2PIAD    IFNE *ZERO                      PS Adjustment Q
     C           I9PIAD    CABNE#2PIAD    BB020            PS Adjustment Q
     C                     END
     C           #2HGCD    IFEQ *ZERO                      Item Code
     C           #2ELDT    IFNE *ZERO                      Production Date
     C           I9ELDT    CABNE#2ELDT    BB020            Production Date
     C                     END
     C                     END
      * Load SFL fields
     C                     EXSR MBFL#1
     C                     MOVEL'Y'       W0RSL   1
      * Allow for possible *Set Cursor processing
     C                     ADD  1         ##RR
      * USER: Initialize subfile record from DBF record
     C                     Z-ADD#1PIAD    #RN1QT           Qty Prod Adjust
      * Rtv Comment           RT - ps Production Adj Comment  * 
     C                     EXSR SDRVGN
      * CASE: RCD.Production Date LT JOB.*Job date
     C           #1ELDT    IFLT ##JDT                      *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     SUB  1         ##RR
      * DBF record not selected
     C           W0RSL     CABNE'Y'       BB020
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Output to subfile
     C                     ADD  1         ##RR
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
     C                     WRITE#SFLRCD
     C           BB020     TAG
      * Increment scan check count
     C                     ADD  1         ##RRRD
     C           KRST      READE@I9CPN4                  82*82=EOF
     C                     END                             OD 1 - ##SFPG
      *................................................................
     C           BB900     TAG
      *................................................................
      * If no DBF records found, display error message
     C           ##RR      IFEQ *ZERO
     C           *IN82     ANDEQ'1'
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI ##RR = *ZERO
      *
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      * If scan limit reached, display error message
     C           ##RRRD    IFGE W0SLM
      * Send message '*Scan limit reached'
     C                     MOVEL'Y2U0017' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     ELSE
     C                     Z-ADD0         ##RROK
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen
      *================================================================
      * Convert fields to external form
     C  N30N27             EXSR MOCV#2
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Update screen time
     C                     TIME           ##TME
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     SETOF                       8392*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate Select Option
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#COPTI'  IFEQ YPMTFD
      * Select Option
     C                     MOVEL#COPTI    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFOPTI
     C                     SELEC
     C           W0INVL    WHEQ '1'                        1
     C                     Z-ADD1         ZFOPTI
     C           W0INVL    WHEQ '2'                        2
     C                     Z-ADD2         ZFOPTI
     C           W0INVL    WHEQ '3'                        3
     C                     Z-ADD3         ZFOPTI
     C                     ENDSL
     C                     EXFMTZEOPTI
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFOPTI    WHEQ 1
     C                     MOVEL'1'       W0INVL           1
     C           ZFOPTI    WHEQ 2
     C                     MOVEL'2'       W0INVL           2
     C           ZFOPTI    WHEQ 3
     C                     MOVEL'3'       W0INVL           3
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #COPTI
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Item Code and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV2HGCD    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ 'USR0752'                  *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #2HGCD           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #2HGCD           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Production Date
      * External date
     C                     Z-ADDV2ELDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9934  *
     C                     END
     C                     Z-ADDXDINDT    #2ELDT
      * Validate Production Date RGT
      * External date
     C                     Z-ADDVCGWDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9935  *
     C                     END
     C                     Z-ADDXDINDT    #CGWDT
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      *................................................................
     C           YPMTFD    IFNE *BLANKS
     C           YPMRRN    ANDEQ*ZERO
     C                     GOTO DAEXIT
     C                     END
     C           YPMTFD    CABNE*BLANKS   DATAG1
      * Change of position specified
     C           WZHGCD    CASNE#2HGCD    FBRQRL
     C           WZPIAD    CASNE#2PIAD    FBRQRL
     C           WZELDT    CASNE#2ELDT    FBRQRL
     C                     END
     C           DATAG1    TAG
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process subfile control (Pre-confirm)
      * SEL:  Item Code
      * CASE: CTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * CASE: PGM.*Cursor field <IS> CTL.Item Code
     C           W0CFL     IFEQ 'V2HGCD'                   *IF
      * Sel Converted Item    SL - Item Bill Of Material  * 
     C                     CLEARPARC
     C                     Z-ADD#2AIC3    PAAIC3           Company Number
     C                     Z-ADD#2D8C7    PAC9NB           Component Item
     C                     Z-ADD#2HGCD    PAHGCD           Item Code
      *
     C                     CALL 'PORXSRR'              90  Sel Converted I
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Item Bill
      *
     C                     Z-ADDPAHGCD    #2HGCD           Item Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PORXSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * 1=Create
      * CASE: CTL.Select Option is Option 1
     C           #COPTI    IFEQ '1'                        *IF
      * VAL:  Item Code
      * CASE: CTL.Item Code is Not Entered
     C           #2HGCD    IFEQ *ZERO                      *IF
      * Setup message data for message
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2HGCD    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0001           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0001           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Item Req'
     C                     MOVEL'USR2716' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * Val FG Item Exists    RT - Company Item  * 
     C                     EXSR SERVGN
      * CASE: LCL.Record Found USR is Record Not Found
     C           YL0003    IFEQ 'N'                        *IF
      * Setup message data for message
      * Send message 'Item not found'
     C                     MOVEL'USR0374' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv First Consumed Itm XF - Item Bill Of Material  * 
     C                     CALL 'POP1XFR'              90  Rtv First Consu
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0001  30       Company Number
     C                     PARM #2HGCD    WQ0002  70       Item Code
     C           YL0004    PARM *ZERO     WQ0003  70       Component Item
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POP1XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
      * CASE: LCL.Component Item Code NE CTL.PS Consumed Item Code
     C           YL0004    IFNE #2D8C7                     *IF
      * Setup message data for message
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2HGCD    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0002           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0002           CD7 Ext Numeric
     C                     END                             *FI
      * Convert PS Consumed Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2D8C7    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2D8C7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0003           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0003           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Item Not Conv From Base'
     C                     MOVEL'USR3177' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * VAL:  Production Date
      * CASE: CTL.Production Date is not entered
     C           #2ELDT    IFEQ *ZERO                      *IF
      * Setup message data for message
      * Convert Production Date to display format
      * Convert date
     C           1000000   ADD  #2ELDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0004
      * Send message 'Prod Date must be entered'
     C                     MOVEL'USR1916' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9934  *
      *
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: CTL.Production Date LT JOB.*Job date
     C           #2ELDT    IFLT ##JDT                      *IF
      * Setup message data for message
      * Convert Production Date to display format
      * Convert date
     C           1000000   ADD  #2ELDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0005
      * Send message 'Production Date must be'
     C                     MOVEL'USR2879' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9934  *
      *
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Prd Day Sts       RT - Calendar  * 
     C                     EXSR SFRVGN
      * CASE: LCL.Production Day Status is no
     C           YL0005    IFEQ 'N'                        *IF
      * Setup message data for message
      * Convert Production Date to display format
      * Convert date
     C           1000000   ADD  #2ELDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0006
      * Send message 'Date Must Be Prod Date'
     C                     MOVEL'USR3178' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9934  *
      *
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * VAL:  Adjustment Quantity
      * CASE: CTL.PS Adjustment Quantity is EQ Zero
     C           #2PIAD    IFEQ *ZERO                      *IF
      * Setup message data for message
      * Send message 'Quantity is required'
     C                     MOVEL'USR0394' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     MOVEL*BLANK    WN0001  1        Production Type
      *
      * Rtv Production        IF
      * BPS Setup Item Info   IF
      *
     C                     Z-ADD*ZERO     WN0002 155       System Value Nu
      *
      * UPS Rtv Company/Item  IF
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0001           Company Number
     C                     Z-ADD#2HGCD    WL0002           Item Code
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    WUAVNA    P      Description Lin
     C                     MOVELWL0004    WUADCD    P      U/M - Primary
     C                     Z-ADDWL0005    YL0007           Unit Weight
     C                     Z-ADDWL0006    WURINB           Item Structure
     C                     Z-ADDWL0007    WURHNB           Item Structure
     C                     Z-ADDWL0008    WURGNB           Item Structure
     C                     MOVELWL0009    WUN0CD    P      Item Type Code
     C                     MOVELWL0010    WUQ1CD    P      Default Warehou
     C                     Z-ADDWL0011    YL0008           Fresh Chilling
     C                     MOVELWL0012    WUQZCD    P      Base/Conv/Loss
     C                     MOVELWL0013    WUXWST    P      Variety/Rendere
     C                     MOVELWL0014    WUVMST    P      Credit Item Sta
     C                     Z-ADDWL0015    WUSWGH           Std Weight/Head
     C                     Z-ADDWL0016    WUPPHE           Pieces Per Head
     C                     MOVELWL0017    WUR3CD    P      Department Code
     C                     MOVELWL0018    WUSDCD    P      Group for Packa
     C                     MOVELWL0019    WUX5ST    P      Seconds Item
     C                     MOVELWL0020    YL0009    P      Piece Count Ite
     C                     Z-ADDWL0021    YL0010           Pieces Per Bag
     C                     Z-ADDWL0022    YL0011           Bags Per Unit
     C                     MOVELWL0023    WUSUST    P      Export/Domestic
     C                     MOVELWL0024    WUSVST    P      Print On Schedu
     C                     MOVELWL0025    WUSYST    P      Fresh Inv Alloc
     C                     MOVELWL0026    WUSZST    P      Fresh Sched As
     C                     MOVELWL0027    WUS1ST    P      Frozen Inv Allo
     C                     MOVELWL0028    WUXRCD    P      Primal Group Co
      * BPS Rtv Whs Info      RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#2AJCD    WL0029    P      Warehouse Code
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0030    WUWPST    P      Warehouse Type
     C                     MOVELWL0031    WUXUST    P      Trans Contol AS
     C                     MOVELWL0032    WUT0ST    P      Warehouse Locat
     C                     MOVELWL0033    YL0012    P      Warehouse Std C
     C                     Z-ADDWL0034    YL0013           Warehouse Chill
      * BPS Set Up Item Id    IF
      * CASE: PAR.Item Type Code is Raw Materials
     C           WUN0CD    IFEQ 'RM'                       *IF
     C                     MOVEL'RMB'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Seconds Item is Yes
     C           WUX5ST    IFEQ 'Y'                        *IF
     C                     MOVEL'FSC'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Variety/Rendered/Cut is Variety
     C           WUXWST    IFEQ 'V'                        *IF
     C                     MOVEL'FVR'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Rendered
     C           WUXWST    IFEQ 'R'                        *IF
     C                     MOVEL'FRD'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Cut
     C           WUXWST    IFEQ 'C'                        *IF
      * Base/Converted/Fabricated
      * CASE: PAR.Credit Item Status is yes
     C           WUVMST    IFEQ 'Y'                        *IF
      * Setup Base/Converted/Fabricated Credit
      * CASE: PAR.Converted/Base Item is Base
     C           WUQZCD    IFEQ 'B'                        *IF
     C                     MOVEL'FBC'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WUQZCD    IFEQ 'C'                        *IF
     C                     MOVEL'FCC'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WUQZCD    IFEQ 'F'                        *IF
     C                     MOVEL'FFC'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WUQZCD    IFEQ 'L'                        *IF
     C                     MOVEL'FLC'     WUWCST           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup Base/Converted/Fabricated
      * CASE: PAR.Converted/Base Item is Base
     C           WUQZCD    IFEQ 'B'                        *IF
     C                     MOVEL'FGB'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WUQZCD    IFEQ 'C'                        *IF
     C                     MOVEL'FCV'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WUQZCD    IFEQ 'F'                        *IF
     C                     MOVEL'FFB'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WUQZCD    IFEQ 'L'                        *IF
     C                     MOVEL'FLS'     WUWCST           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Determine Production Type
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           #2ELDT    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       WN0001           Production Type
      * Val Sched Existance   RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0035           Company Number
     C                     MOVELWN0001    WL0036    P      Production Type
     C                     Z-ADD#2ELDT    WL0037           Production Date
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0038    WUWXST    P      Record Found US
      * Set to Plan if record not found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'P'       WN0001           Production Type
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Production Date GT JOB.*Job date
     C           #2ELDT    IFGT ##JDT                      *IF
     C                     MOVEL'P'       WN0001           Production Type
     C                     END                             *FI
     C                     END                             *FI
      * Rtv Production        RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0039           Company Number
     C                     MOVELWN0001    WL0040    P      Production Type
     C                     Z-ADD#2ELDT    WL0041           Production Date
     C                     Z-ADD#2HGCD    WL0042           Item Code
     C                     MOVEL#2AJCD    WL0043    P      Warehouse Code
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0044    YL0014           Weight Producti
     C                     Z-ADDWL0045    YL0015           Pieces Producti
     C                     MOVELWL0046    YL0016    P      PS Production W
      * CASE: LCL.Piece Count Item is yes
     C           YL0009    IFEQ 'Y'                        *IF
      * Quantity Available
      * PAR.Quantity Prod Avail USR =
      *    *COMPUTE (x1 / (x2 * x3))
      * x1    : LCL.Pieces Production USR
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : LCL.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : LCL.Bags Per Unit
     C           YL0010    MULT YL0011    W0WJ01           *Synon (15,0) w
     C           YL0015    DIV  W0WJ01    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0006           Quantity Prod A
     C                     ELSE
      * CASE: *OTHERWISE
      * Quantity Available
      * PAR.Quantity Prod Avail USR =
      *    *COMPUTE (x1 / x2)
      * x1    : LCL.Weight Production USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : LCL.Unit Weight
     C           YL0014    DIV  YL0007    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0006           Quantity Prod A
     C                     END                             *FI
     C           YL0006    ADD  #2PIAD    YL0017           Quantity Adjust
      * CASE: LCL.Quantity Adjustment USR is LT Zero
     C           YL0017    IFLT *ZERO                      *IF
      * Send message 'Prod Ajust Invalid'
     C                     MOVEL'USR2571' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'PR'      #2PSAD           PS Adjustment T
     C                     Z-ADD1         #2PSAN           PS Adjustment N
      * Val Adjustment Exist  RT - PS Production Adjustment  * 
     C                     EXSR SKRVGN
      * Create Adjustment
      * CASE: LCL.Record Found USR is Record Found
     C           YL0003    IFEQ 'Y'                        *IF
      * Send message 'PS Production Adjustme EX'
     C                     MOVEL'USR1766' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * Crt Prod. Adjustment  CR - PS Production Adjustment  * 
     C                     EXSR SLCRRC
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     MOVEL*BLANK    #COPTI           Select Option
     C                     Z-ADD*ZERO     #2PIAD           PS Adjustment Q
     C                     END                             *FI
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * Reload subfile requested
     C           W0RSF     CABEQ'Y'       DAEXIT
     C                     END
     C           *IN81     IFEQ '1'
      * Process subfile records
     C                     EXSR DBPRSF
     C                     END
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * If error, quit processing
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
      * Process subfile record
     C                     EXSR DCPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Setof error indicators and SFLNXTCHG
     C                     MOVEAWKIND0    *IN,36
     C                     SETOF                     98    *
     C           YPMTFD    CABNE*BLANKS   DCEXIT
      * USER: Process subfile record (Pre-confirm)
      * CHG:  Adjustment Quantity
      * CASE: RCD.Qty Prod Adjusted 1 USR NE RCD.PS Adjustment Quantity
     C           #RN1QT    IFNE #1PIAD                     *IF
      *
     C                     MOVEL*BLANK    WN0331  1        Production Type
      *
      * Rtv Production        IF
      * BPS Setup Item Info   IF
      *
     C                     Z-ADD*ZERO     WN0332 155       System Value Nu
      *
      * UPS Rtv Company/Item  IF
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0001           Company Number
     C                     Z-ADD#1HGCD    WL0002           Item Code
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    WUAVNA    P      Description Lin
     C                     MOVELWL0004    WUADCD    P      U/M - Primary
     C                     Z-ADDWL0005    YL0007           Unit Weight
     C                     Z-ADDWL0006    WURINB           Item Structure
     C                     Z-ADDWL0007    WURHNB           Item Structure
     C                     Z-ADDWL0008    WURGNB           Item Structure
     C                     MOVELWL0009    WUN0CD    P      Item Type Code
     C                     MOVELWL0010    WUQ1CD    P      Default Warehou
     C                     Z-ADDWL0011    YL0008           Fresh Chilling
     C                     MOVELWL0012    WUQZCD    P      Base/Conv/Loss
     C                     MOVELWL0013    WUXWST    P      Variety/Rendere
     C                     MOVELWL0014    WUVMST    P      Credit Item Sta
     C                     Z-ADDWL0015    WUSWGH           Std Weight/Head
     C                     Z-ADDWL0016    WUPPHE           Pieces Per Head
     C                     MOVELWL0017    WUR3CD    P      Department Code
     C                     MOVELWL0018    WUSDCD    P      Group for Packa
     C                     MOVELWL0019    WUX5ST    P      Seconds Item
     C                     MOVELWL0020    YL0009    P      Piece Count Ite
     C                     Z-ADDWL0021    YL0010           Pieces Per Bag
     C                     Z-ADDWL0022    YL0011           Bags Per Unit
     C                     MOVELWL0023    WUSUST    P      Export/Domestic
     C                     MOVELWL0024    WUSVST    P      Print On Schedu
     C                     MOVELWL0025    WUSYST    P      Fresh Inv Alloc
     C                     MOVELWL0026    WUSZST    P      Fresh Sched As
     C                     MOVELWL0027    WUS1ST    P      Frozen Inv Allo
     C                     MOVELWL0028    WUXRCD    P      Primal Group Co
      * BPS Rtv Whs Info      RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1AJCD    WL0029    P      Warehouse Code
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0030    WUWPST    P      Warehouse Type
     C                     MOVELWL0031    WUXUST    P      Trans Contol AS
     C                     MOVELWL0032    WUT0ST    P      Warehouse Locat
     C                     MOVELWL0033    YL0012    P      Warehouse Std C
     C                     Z-ADDWL0034    YL0013           Warehouse Chill
      * BPS Set Up Item Id    IF
      * CASE: PAR.Item Type Code is Raw Materials
     C           WUN0CD    IFEQ 'RM'                       *IF
     C                     MOVEL'RMB'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Seconds Item is Yes
     C           WUX5ST    IFEQ 'Y'                        *IF
     C                     MOVEL'FSC'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Variety/Rendered/Cut is Variety
     C           WUXWST    IFEQ 'V'                        *IF
     C                     MOVEL'FVR'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Rendered
     C           WUXWST    IFEQ 'R'                        *IF
     C                     MOVEL'FRD'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Cut
     C           WUXWST    IFEQ 'C'                        *IF
      * Base/Converted/Fabricated
      * CASE: PAR.Credit Item Status is yes
     C           WUVMST    IFEQ 'Y'                        *IF
      * Setup Base/Converted/Fabricated Credit
      * CASE: PAR.Converted/Base Item is Base
     C           WUQZCD    IFEQ 'B'                        *IF
     C                     MOVEL'FBC'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WUQZCD    IFEQ 'C'                        *IF
     C                     MOVEL'FCC'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WUQZCD    IFEQ 'F'                        *IF
     C                     MOVEL'FFC'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WUQZCD    IFEQ 'L'                        *IF
     C                     MOVEL'FLC'     WUWCST           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup Base/Converted/Fabricated
      * CASE: PAR.Converted/Base Item is Base
     C           WUQZCD    IFEQ 'B'                        *IF
     C                     MOVEL'FGB'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WUQZCD    IFEQ 'C'                        *IF
     C                     MOVEL'FCV'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WUQZCD    IFEQ 'F'                        *IF
     C                     MOVEL'FFB'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WUQZCD    IFEQ 'L'                        *IF
     C                     MOVEL'FLS'     WUWCST           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Determine Production Type
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           #1ELDT    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       WN0331           Production Type
      * Val Sched Existance   RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0035           Company Number
     C                     MOVELWN0331    WL0036    P      Production Type
     C                     Z-ADD#1ELDT    WL0037           Production Date
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0038    WUWXST    P      Record Found US
      * Set to Plan if record not found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'P'       WN0331           Production Type
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Production Date GT JOB.*Job date
     C           #1ELDT    IFGT ##JDT                      *IF
     C                     MOVEL'P'       WN0331           Production Type
     C                     END                             *FI
     C                     END                             *FI
      * Rtv Production        RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0039           Company Number
     C                     MOVELWN0331    WL0040    P      Production Type
     C                     Z-ADD#1ELDT    WL0041           Production Date
     C                     Z-ADD#1HGCD    WL0042           Item Code
     C                     MOVEL#1AJCD    WL0043    P      Warehouse Code
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0044    YL0014           Weight Producti
     C                     Z-ADDWL0045    YL0015           Pieces Producti
     C                     MOVELWL0046    YL0016    P      PS Production W
      * CASE: LCL.Piece Count Item is yes
     C           YL0009    IFEQ 'Y'                        *IF
      * Quantity Available
      * PAR.Quantity Prod Avail USR =
      *    *COMPUTE (x1 / (x2 * x3))
      * x1    : LCL.Pieces Production USR
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : LCL.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : LCL.Bags Per Unit
     C           YL0010    MULT YL0011    W0WJ01           *Synon (15,0) w
     C           YL0015    DIV  W0WJ01    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0006           Quantity Prod A
     C                     ELSE
      * CASE: *OTHERWISE
      * Quantity Available
      * PAR.Quantity Prod Avail USR =
      *    *COMPUTE (x1 / x2)
      * x1    : LCL.Weight Production USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : LCL.Unit Weight
     C           YL0014    DIV  YL0007    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0006           Quantity Prod A
     C                     END                             *FI
     C           YL0006    ADD  #RN1QT    YL0017           Quantity Adjust
      * CASE: LCL.Quantity Adjustment USR is LT Zero
     C           YL0017    IFLT *ZERO                      *IF
      * Send message 'Prod Ajust Invalid'
     C                     MOVEL'USR2571' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg Prod. Adjustment  CH - PS Production Adjustment  * 
     C                     EXSR SVCHRC
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END                             *FI
      * 4=Delete
      * CASE: RCD.*SFLSEL is *Delete
     C           #1SEL     IFEQ '4'                        *IF
     C           #1SEL     OREQ ' 4'
      * Del Prod Adjustment   DL - PS Production Adjustment  * 
     C                     EXSR SZDLRC
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * CASE: RCD.*SFLSEL is Option 7
     C           #1SEL     IFEQ '7'                        *IF
     C           #1SEL     OREQ ' 7'
      * Edt Adj Comment       EF - ps Production Adj Comment  * 
     C                     CLEARPBRC
     C                     Z-ADD#1AIC3    PBAIC3           Company Number
     C                     Z-ADD#1ELDT    PBELDT           Production Date
     C                     Z-ADD#1HGCD    PBHGCD           Item Code
     C                     MOVEL#1AJCD    PBAJCD    P      Warehouse Code
     C                     MOVEL#1PSAD    PBPSAD    P      PS Adjustment T
     C                     Z-ADD#1PSAN    PBPSAN           PS Adjustment N
      *
     C                     CALL 'POSUEFR'              90  Edt Adj Comment
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: PS Product
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POSUEFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C  N99                Z-ADD##RR      ##SFRC     99    *
      * SFLNXTCHG
     C                     SETON                     84
     C                     ELSE
      * SFLRCD valid
      * SFLNXTCHG
     C                     SETOF                     84
     C                     MOVEL*BLANK    #1SEL
     C                     END                             FI *IN98
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @I9CPN4 fields to subfile
      *================================================================
     C                     MOVEL*BLANK    #1SEL
     C                     Z-ADDI9AIC3    #1AIC3           Company Number
     C                     Z-ADDI9D8C7    #1D8C7           PS Consumed Ite
     C                     MOVELI9AJCD    #1AJCD           Warehouse Code
     C                     Z-ADDI9PSAN    #1PSAN           PS Adjustment N
     C                     Z-ADDI9PIAD    #1PIAD           PS Adjustment Q
     C                     MOVELI9V6ST    #1V6ST           PS Adjustment S
     C                     MOVELI9UVST    #1UVST           EDI Status 1
     C                     MOVELI9UWST    #1UWST           EDI Status 2
     C                     MOVELI9UXST    #1UXST           EDI Status 3
     C                     MOVELI9VSST    #1VSST           Record Status
     C                     Z-ADDI9AATM    #1AATM           Job Time
     C                     MOVELI9AYNA    #1AYNA           User Id
     C                     MOVELI9A0NA    #1A0NA           Job Name
     C                     Z-ADDI9AXDT    #1AXDT           Job Date
     C                     MOVELI9PSAD    #1PSAD           PS Adjustment T
     C                     Z-ADDI9HGCD    #1HGCD           Item Code
      * Clear external version also
     C                     MOVEL*BLANK    V1HGCD
     C                     Z-ADDI9ELDT    #1ELDT           Production Date
      * Clear external version also
     C                     Z-ADD*ZERO     V1ELDT
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     Z-ADD*ZERO     #RN1QT           Qty Prod Adjust
     C                     MOVEL*BLANK    #RP1NA           PS Adj Comment
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     Z-ADD*ZERO     #2PSAN           PS Adjustment N
     C                     Z-ADDP1AIC3    #2AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V2AIC3
     C                     MOVEL*BLANK    #CSQTX           Company Name DR
     C                     Z-ADDP1D8C7    #2D8C7           PS Consumed Ite
      * Clear external version also
     C                     MOVEL*BLANK    V2D8C7
     C                     MOVEL*BLANK    #COONA           Item Desc DRV
     C                     MOVELP1AJCD    #2AJCD           Warehouse Code
     C                     MOVEL*BLANK    #CO6NA           Warehouse Desc
     C                     MOVEL*BLANK    #COPTI           Select Option
     C                     MOVEL*BLANK    #2PSAD           PS Adjustment T
     C                     Z-ADD*ZERO     #2HGCD           Item Code
      * Clear external version also
     C                     MOVEL*BLANK    V2HGCD
     C                     Z-ADD*ZERO     #2PIAD           PS Adjustment Q
     C                     Z-ADD*ZERO     #2ELDT           Production Date
      * Clear external version also
     C                     Z-ADD*ZERO     V2ELDT
     C                     Z-ADD*ZERO     #CGWDT           Production Date
      * Clear external version also
     C                     Z-ADD*ZERO     VCGWDT
     C                     MOVEL*BLANK    #CP1NA           PS Adj Comment
      * Check restriction within
     C                     EXSR VACKRL
      * Check restriction within
     C                     EXSR VBCKRL
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert subfile fields into external form
      *================================================================
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1HGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1HGCD           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Production Date to display format
      * Convert date
     C           1000000   ADD  #1ELDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1ELDT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#2    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #2AIC3    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V2AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert PS Consumed Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2D8C7    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2D8C7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2D8C7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2D8C7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2HGCD    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2HGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2HGCD           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Production Date to display format
      * Convert date
     C           1000000   ADD  #2ELDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2ELDT
      * Convert Production Date RGT to display format
      * Convert date
     C           1000000   ADD  #CGWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCGWDT
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADD#2AIC3    ABAIC3           Company Number
      * Establish starting position
     C           KRSSA     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #CSQTX           Name
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    #CSQTX           Name
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Item Descriptions  RT - OM Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           BYHGCD           Item Code
      * Setup key
     C                     Z-ADD#2D8C7    BYHGCD           Item Code
      * Establish starting position
     C           KRSSB     CHAIN@BYREA1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1160' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #COONA           Description Lin
     C                     MOVEL*BLANK    WUAWNA           Description Lin
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBYAVNA    #COONA           Description Lin
     C                     MOVELBYAWNA    WUAWNA           Description Lin
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Whse Descrip       RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#2AJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSC     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #CO6NA           Warehouse Descr
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELADF8NA    #CO6NA           Warehouse Descr
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Comment           RT - ps Production Adj Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN CEAIC3    WQSD01           Company Number
     C           *LIKE     DEFN CEELDT    WQSD02           Production Date
     C           *LIKE     DEFN CEHGCD    WQSD03           Item Code
     C           *LIKE     DEFN CEAJCD    WQSD04           Warehouse Code
     C           *LIKE     DEFN CEPSAD    WQSD05           PS Adjustment T
     C           *LIKE     DEFN CEPSAN    WQSD06           PS Adjustment N
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Production Date
     C                     KFLD           WQSD03           Item Code
     C                     KFLD           WQSD04           Warehouse Code
     C                     KFLD           WQSD05           PS Adjustment T
     C                     KFLD           WQSD06           PS Adjustment N
      * Setup key
     C                     Z-ADD#1AIC3    WQSD01           Company Number
     C                     Z-ADD#1ELDT    WQSD02           Production Date
     C                     Z-ADD#1HGCD    WQSD03           Item Code
     C                     MOVEL#1AJCD    WQSD04           Warehouse Code
     C                     MOVEL#1PSAD    WQSD05           PS Adjustment T
     C                     Z-ADD#1PSAN    WQSD06           PS Adjustment N
      * Establish starting position
     C           KRSSD     SETLL@CECPOL                    *
     C           KRSSD     READE@CECPOL                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3187' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #RP1NA           PS Adj Comment
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELCEP1NA    #RP1NA           PS Adj Comment
     C                     GOTO SDEXIT                     *QUIT
     C           KRSSD     READE@CECPOL                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Val FG Item Exists    RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADD#2AIC3    BZAIC3           Company Number
     C                     Z-ADD#2HGCD    BZHGCD           Item Code
      * Establish starting position
     C           KRSSE     CHAIN@BZREZY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0002           Description Lin
     C                     MOVEL*BLANK    YL0003           Record Found US
     C                     MOVEL'N'       YL0003           Record Found US
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBZAVNA    YL0002           Description Lin
     C                     MOVEL'Y'       YL0003           Record Found US
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Prd Day Sts       RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADD#2AIC3    AFAIC3           Company Number
     C                     Z-ADD#2ELDT    AFBCDT           Post to G/L Dat
      * Establish starting position
     C           KRSSF     CHAIN@AFREBE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0018' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0005           Production Day
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAFWAST    YL0005           Production Day
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0001    WAAIC3           Company Number
     C                     Z-ADDWL0002    WAHGCD           Item Code
      * Establish starting position
     C           KRSSG     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0003           Description Lin
     C                     MOVEL*BLANK    WL0004           U/M - Primary
     C                     Z-ADD*ZERO     WL0005           Unit Weight
     C                     Z-ADD*ZERO     WL0006           Item Structure
     C                     Z-ADD*ZERO     WL0007           Item Structure
     C                     Z-ADD*ZERO     WL0008           Item Structure
     C                     MOVEL*BLANK    WL0009           Item Type Code
     C                     MOVEL*BLANK    WL0010           Default Warehou
     C                     Z-ADD*ZERO     WL0011           Fresh Chilling
     C                     MOVEL*BLANK    WL0012           Base/Conv/Loss
     C                     MOVEL*BLANK    WL0013           Variety/Rendere
     C                     MOVEL*BLANK    WL0014           Credit Item Sta
     C                     Z-ADD*ZERO     WL0015           Std Weight/Head
     C                     Z-ADD*ZERO     WL0016           Pieces Per Head
     C                     MOVEL*BLANK    WL0017           Department Code
     C                     MOVEL*BLANK    WL0018           Group for Packa
     C                     MOVEL*BLANK    WL0019           Seconds Item
     C                     MOVEL*BLANK    WL0020           Piece Count Ite
     C                     Z-ADD*ZERO     WL0021           Pieces Per Bag
     C                     Z-ADD*ZERO     WL0022           Bags Per Unit
     C                     MOVEL*BLANK    WL0023           Export/Domestic
     C                     MOVEL*BLANK    WL0024           Print On Schedu
     C                     MOVEL*BLANK    WL0025           Fresh Inv Alloc
     C                     MOVEL*BLANK    WL0026           Fresh Sched As
     C                     MOVEL*BLANK    WL0027           Frozen Inv Allo
     C                     MOVEL*BLANK    WL0028           Primal Group Co
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAAVNA    WL0003           Description Lin
     C                     MOVELWAADCD    WL0004           U/M - Primary
     C                     Z-ADDWAAIWG    WL0005           Unit Weight
     C                     Z-ADDWARINB    WL0006           Item Structure
     C                     Z-ADDWARHNB    WL0007           Item Structure
     C                     Z-ADDWARGNB    WL0008           Item Structure
     C                     MOVELWAN0CD    WL0009           Item Type Code
     C                     MOVELWAQ1CD    WL0010           Default Warehou
     C                     Z-ADDWACHTM    WL0011           Fresh Chilling
     C                     MOVELWAQZCD    WL0012           Base/Conv/Loss
     C                     MOVELWAXWST    WL0013           Variety/Rendere
     C                     MOVELWAVMST    WL0014           Credit Item Sta
     C                     Z-ADDWASWGH    WL0015           Std Weight/Head
     C                     Z-ADDWAPPHE    WL0016           Pieces Per Head
     C                     MOVELWAR3CD    WL0017           Department Code
     C                     MOVELWASDCD    WL0018           Group for Packa
     C                     MOVELWAX5ST    WL0019           Seconds Item
     C                     MOVELWAPCCT    WL0020           Piece Count Ite
     C                     Z-ADDWABDNB    WL0021           Pieces Per Bag
     C                     Z-ADDWABJNB    WL0022           Bags Per Unit
     C                     MOVELWASUST    WL0023           Export/Domestic
     C                     MOVELWASVST    WL0024           Print On Schedu
     C                     MOVELWASYST    WL0025           Fresh Inv Alloc
     C                     MOVELWASZST    WL0026           Fresh Sched As
     C                     MOVELWAS1ST    WL0027           Frozen Inv Allo
     C                     MOVELWAXRCD    WL0028           Primal Group Co
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * BPS Rtv Whs Info      RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WBAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0029    WBAJCD           Warehouse Code
      * Establish starting position
     C           KRSSH     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0030           Warehouse Type
     C                     MOVEL*BLANK    WL0031           Trans Contol AS
     C                     MOVEL*BLANK    WL0032           Warehouse Locat
     C                     MOVEL*BLANK    WL0033           Warehouse Std C
     C                     Z-ADD*ZERO     WL0034           Warehouse Chill
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBWPST    WL0030           Warehouse Type
     C                     MOVELWBXUST    WL0031           Trans Contol AS
     C                     MOVELWBT0ST    WL0032           Warehouse Locat
     C                     MOVELWBT1ST    WL0033           Warehouse Std C
     C                     Z-ADDWBDBNB    WL0034           Warehouse Chill
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Val Sched Existance   RT - PS Prod Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           JCAIC3           Company Number
     C                     KFLD           JCV5ST           Production Type
     C                     KFLD           JCELDT           Production Date
      * Setup key
     C                     Z-ADDWL0035    JCAIC3           Company Number
     C                     MOVELWL0036    JCV5ST           Production Type
     C                     Z-ADDWL0037    JCELDT           Production Date
      * Establish starting position
     C           KRSSI     CHAIN@JCCPVC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1795' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WL0038           Record Found US
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y'       WL0038           Record Found US
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Production        RT - PS Prod Item Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           I8AIC3           Company Number
     C                     KFLD           I8V5ST           Production Type
     C                     KFLD           I8ELDT           Production Date
     C                     KFLD           I8HGCD           Item Code
     C                     KFLD           I8AJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWL0039    I8AIC3           Company Number
     C                     MOVELWL0040    I8V5ST           Production Type
     C                     Z-ADDWL0041    I8ELDT           Production Date
     C                     Z-ADDWL0042    I8HGCD           Item Code
     C                     MOVELWL0043    I8AJCD           Warehouse Code
      * Establish starting position
     C           KRSSJ     CHAIN@I8CPUS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0044           Weight Producti
     C                     Z-ADD*ZERO     WL0045           Pieces Producti
     C                     MOVEL*BLANK    WL0046           PS Production W
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Weight Production
      * PAR.Weight Production USR =
      *    *COMPUTE (x1 + x2 - x3 - x4)
      * x1    : DB1.PS Weight Standard
      * +     : PGM.*Synon (15,2) work field
      * x2    : DB1.PS Weight Prod Adj
      * -     : PGM.*Synon (15,2) work field
      * x3    : DB1.PS Weight Converted
      * -     : PGM.*Synon (17,7) work field
      * x4    : DB1.PS Weight Whse Tfr Adj
     C           I8DXWG    ADD  I8D1WG    W0WA02           *Synon (15,2) w
     C           W0WA02    SUB  I8WTCN    W0WA01           *Synon (15,2) w
     C           W0WA01    SUB  I8GAWG    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WL0044           Weight Producti
      * Pieces Production
      * PAR.Pieces Production USR =
      *    *COMPUTE (x1 + x2 - x3 - x4)
      * x1    : DB1.PS Pieces Standard
      * +     : PGM.*Synon (15,0) work field
      * x2    : DB1.PS Pieces Prod Adj
      * -     : PGM.*Synon (15,0) work field
      * x3    : DB1.PS Pieces Converted
      * -     : PGM.*Synon (17,7) work field
      * x4    : DB1.PS Pieces Whse Tfr Adj
     C           I8B2NB    ADD  I8CBNB    W0WJ02           *Synon (15,0) w
     C           W0WJ02    SUB  I8PSCV    W0WJ01           *Synon (15,0) w
     C           W0WJ01    SUB  I8BPNB    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WL0045           Pieces Producti
     C                     MOVELI8B7ST    WL0046           PS Production W
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Val Adjustment Exist  RT - PS Production Adjustment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCELDT           Production Date
     C                     KFLD           WCHGCD           Item Code
     C                     KFLD           WCAJCD           Warehouse Code
     C                     KFLD           WCPSAD           PS Adjustment T
     C                     KFLD           WCPSAN           PS Adjustment N
      * Setup key
     C                     Z-ADD#2AIC3    WCAIC3           Company Number
     C                     Z-ADD#2ELDT    WCELDT           Production Date
     C                     Z-ADD#2HGCD    WCHGCD           Item Code
     C                     MOVEL#2AJCD    WCAJCD           Warehouse Code
     C                     MOVEL#2PSAD    WCPSAD           PS Adjustment T
     C                     Z-ADD#2PSAN    WCPSAN           PS Adjustment N
      * Establish starting position
     C           KRSSK     CHAIN@I9CPUV              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1765' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       YL0003           Record Found US
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y'       YL0003           Record Found US
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCRRC    BEGSR
      *================================================================
      * Crt Prod. Adjustment  CR - PS Production Adjustment  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0003  60       Job Time
     C                     MOVEL*BLANK    WN0004 10        User Id
     C                     MOVEL*BLANK    WN0005 10        Job Name
     C                     Z-ADD*ZERO     WN0006  70       Job Date
     C                     Z-ADD*ZERO     WN0007  61       Quantity Adjust
     C                     Z-ADD*ZERO     WN0008  92       Weight Producti
     C                     Z-ADD*ZERO     WN0009  70       Production Date
     C                     Z-ADD*ZERO     WN0010  70       Pieces Producti
     C                     Z-ADD*ZERO     WN0011 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0012 112       Quantity Schedu
     C                     MOVEL*BLANK    WN0013  1        Production Type
     C                     Z-ADD*ZERO     WN0014  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0015  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0016 112       Unit Weight
     C                     Z-ADD*ZERO     WN0017  52       Fresh Chilling
     C                     MOVEL*BLANK    WN0018  1        Piece Count Ite
     C                     Z-ADD*ZERO     WN0019  70       Pieces Per Bag
     C                     Z-ADD*ZERO     WN0020  70       Bags Per Unit
     C                     MOVEL*BLANK    WN0021  1        Warehouse Std C
     C                     Z-ADD*ZERO     WN0022  52       Warehouse Chill
     C                     Z-ADD*ZERO     WN0023  70       Ship Date USR
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @I9CPUU
     C                     Z-ADD#2AIC3    WDAIC3           Company Number
     C                     Z-ADD#2ELDT    WDELDT           Production Date
     C                     Z-ADD#2HGCD    WDHGCD           Item Code
     C                     MOVEL#2AJCD    WDAJCD           Warehouse Code
     C                     MOVEL#2PSAD    WDPSAD           PS Adjustment T
     C                     Z-ADD#2PSAN    WDPSAN           PS Adjustment N
     C                     Z-ADD#2PIAD    WDPIAD           PS Adjustment Q
     C                     MOVELWUV6ST    WDV6ST           PS Adjustment S
     C                     Z-ADD#2D8C7    WDD8C7           PS Consumed Ite
     C                     MOVELWUUVST    WDUVST           EDI Status 1
     C                     MOVELWUUWST    WDUWST           EDI Status 2
     C                     MOVELWUUXST    WDUXST           EDI Status 3
     C                     MOVELWUVSST    WDVSST           Record Status
      *
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WDAATM' defaulted for 'Job Time'.
      * Field '(DB1) WDAYNA' defaulted for 'User Id'.
      * Field '(DB1) WDA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WDAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##JOB     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
      * CASE: PAR.Status - Y or N is yes
     C           'Y'       IFEQ 'Y'                        *IF
     C                     MOVEL'S'       WDV6ST           PS Adjustment S
     C                     END                             *FI
     C           KLCRSL    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDELDT           Production Date
     C                     KFLD           WDHGCD           Item Code
     C                     KFLD           WDAJCD           Warehouse Code
     C                     KFLD           WDPSAD           PS Adjustment T
     C                     KFLD           WDPSAN           PS Adjustment N
      * Check for duplicate primary key
     C           KLCRSL    SETLL@I9CPUU                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1766' W0RTN   7
      * Send message 'PS Production Adjustme EX'
     C                     MOVEL'USR1766' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C                     WRITE@I9CPUU                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * CASE: PAR.Status - Y or N is yes
     C           'Y'       IFEQ 'Y'                        *IF
      * BPS Setup Item Info   IF
      *
     C                     Z-ADD*ZERO     WN0024 155       System Value Nu
      *
      * UPS Rtv Company/Item  IF
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0001           Company Number
     C                     Z-ADD#2HGCD    WL0002           Item Code
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    WUAVNA    P      Description Lin
     C                     MOVELWL0004    WUADCD    P      U/M - Primary
     C                     Z-ADDWL0005    WN0016           Unit Weight
     C                     Z-ADDWL0006    WURINB           Item Structure
     C                     Z-ADDWL0007    WURHNB           Item Structure
     C                     Z-ADDWL0008    WURGNB           Item Structure
     C                     MOVELWL0009    WUN0CD    P      Item Type Code
     C                     MOVELWL0010    WUQ1CD    P      Default Warehou
     C                     Z-ADDWL0011    WN0017           Fresh Chilling
     C                     MOVELWL0012    WUQZCD    P      Base/Conv/Loss
     C                     MOVELWL0013    WUXWST    P      Variety/Rendere
     C                     MOVELWL0014    WUVMST    P      Credit Item Sta
     C                     Z-ADDWL0015    WUSWGH           Std Weight/Head
     C                     Z-ADDWL0016    WUPPHE           Pieces Per Head
     C                     MOVELWL0017    WUR3CD    P      Department Code
     C                     MOVELWL0018    WUSDCD    P      Group for Packa
     C                     MOVELWL0019    WUX5ST    P      Seconds Item
     C                     MOVELWL0020    WN0018    P      Piece Count Ite
     C                     Z-ADDWL0021    WN0019           Pieces Per Bag
     C                     Z-ADDWL0022    WN0020           Bags Per Unit
     C                     MOVELWL0023    WUSUST    P      Export/Domestic
     C                     MOVELWL0024    WUSVST    P      Print On Schedu
     C                     MOVELWL0025    WUSYST    P      Fresh Inv Alloc
     C                     MOVELWL0026    WUSZST    P      Fresh Sched As
     C                     MOVELWL0027    WUS1ST    P      Frozen Inv Allo
     C                     MOVELWL0028    WUXRCD    P      Primal Group Co
      * BPS Rtv Whs Info      RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#2AJCD    WL0029    P      Warehouse Code
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0030    WUWPST    P      Warehouse Type
     C                     MOVELWL0031    WUXUST    P      Trans Contol AS
     C                     MOVELWL0032    WUT0ST    P      Warehouse Locat
     C                     MOVELWL0033    WN0021    P      Warehouse Std C
     C                     Z-ADDWL0034    WN0022           Warehouse Chill
      * BPS Set Up Item Id    IF
      * CASE: PAR.Item Type Code is Raw Materials
     C           WUN0CD    IFEQ 'RM'                       *IF
     C                     MOVEL'RMB'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Seconds Item is Yes
     C           WUX5ST    IFEQ 'Y'                        *IF
     C                     MOVEL'FSC'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Variety/Rendered/Cut is Variety
     C           WUXWST    IFEQ 'V'                        *IF
     C                     MOVEL'FVR'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Rendered
     C           WUXWST    IFEQ 'R'                        *IF
     C                     MOVEL'FRD'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Cut
     C           WUXWST    IFEQ 'C'                        *IF
      * Base/Converted/Fabricated
      * CASE: PAR.Credit Item Status is yes
     C           WUVMST    IFEQ 'Y'                        *IF
      * Setup Base/Converted/Fabricated Credit
      * CASE: PAR.Converted/Base Item is Base
     C           WUQZCD    IFEQ 'B'                        *IF
     C                     MOVEL'FBC'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WUQZCD    IFEQ 'C'                        *IF
     C                     MOVEL'FCC'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WUQZCD    IFEQ 'F'                        *IF
     C                     MOVEL'FFC'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WUQZCD    IFEQ 'L'                        *IF
     C                     MOVEL'FLC'     WUWCST           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup Base/Converted/Fabricated
      * CASE: PAR.Converted/Base Item is Base
     C           WUQZCD    IFEQ 'B'                        *IF
     C                     MOVEL'FGB'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WUQZCD    IFEQ 'C'                        *IF
     C                     MOVEL'FCV'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WUQZCD    IFEQ 'F'                        *IF
     C                     MOVEL'FFB'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WUQZCD    IFEQ 'L'                        *IF
     C                     MOVEL'FLS'     WUWCST           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Determine Production Type
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           #2ELDT    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       WN0013           Production Type
      * Val Sched Existance   RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0035           Company Number
     C                     MOVELWN0013    WL0036    P      Production Type
     C                     Z-ADD#2ELDT    WL0037           Production Date
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0038    WUWXST    P      Record Found US
      * Set to Plan if record not found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'P'       WN0013           Production Type
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Production Date GT JOB.*Job date
     C           #2ELDT    IFGT ##JDT                      *IF
     C                     MOVEL'P'       WN0013           Production Type
     C                     END                             *FI
     C                     END                             *FI
      * Update Production
      * CASE: PAR.PS Adjustment Type is One Time/Prod
     C           #2PSAD    IFEQ 'PR'                       *IF
     C           #2PSAD    OREQ 'OT'
      * UPD Avail-To-Sell  SCH XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDTRXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0004  30       Company Number
     C                     PARM #2ELDT    WQ0005  70       Production Date
     C                     PARM #2HGCD    WQ0006  70       Item Code
     C                     PARM #2AJCD    WQ0007  3        Warehouse Code
     C                     PARM #2PIAD    WQ0008  50       PS Adjustment Q
     C                     PARM 'SA'      WQ0009  2        ATS Adj Type US
     C                     PARM WN0013    WQ0010  1        Production Type
     C                     PARM #2PSAN    WQ0011  50       PS Adjustment N
     C           WURCAU    PARM *BLANK    WQ0012  3        Return Code ATS
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDTRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993432*
     C                     SETON                     33    *
     C                     END
      * CASE: WRK.Return Code ATS USR is BOM Not Found
     C           WURCAU    IFEQ 'BNF'                      *IF
      * Setup message data for message
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2HGCD    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0007           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0007           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'PS BOM Does not Exist'
     C                     MOVEL'USR2057' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.PS Adjustment Type is Override
     C           #2PSAD    IFEQ 'OV'                       *IF
      * Pieces Vs. Weight
      * CASE: PAR.Piece Count Item is yes
     C           WN0018    IFEQ 'Y'                        *IF
      * Rtv Avg Piece Wgt     RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0047           Company Number
     C                     MOVELWN0013    WL0048    P      Production Type
     C                     Z-ADD#2ELDT    WL0049           Production Date
     C                     Z-ADD#2HGCD    WL0050           Item Code
     C                     MOVEL#2AJCD    WL0051    P      Warehouse Code
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0052    WUF8WG           PS Avg Piece Wg
     C           #2PIAD    MULT WUF8WG    YL0018           PS Weight Stand
      * Pieces
      * LCL.PS Pieces Standard =
      *    *COMPUTE (x1 * x2 * x3)
      * x1    : PAR.PS Adjustment Quantity
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Bags Per Unit
     C           #2PIAD    MULT WN0019    W0WJ01           *Synon (15,0) w
     C           W0WJ01    MULT WN0020    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0019           PS Pieces Stand
     C                     ELSE
      * CASE: *OTHERWISE
     C           #2PIAD    MULT WN0016    YL0018           PS Weight Stand
     C                     Z-ADD*ZERO     YL0019           PS Pieces Stand
     C                     END                             *FI
      * BPS Upd Pcs/Wgt Std   RT - PS Prod Item Schedule  * 
     C                     EXSR SNRVGN
     C                     ELSE
      * CASE: PAR.PS Adjustment Type is Forecast
     C           #2PSAD    IFEQ 'FC'                       *IF
      * RTV Scheduled for Date RT - PD Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0148           Company Number
     C                     Z-ADD#2ELDT    WL0149           OD Production D
     C                     MOVEL#2AJCD    WL0150    P      Warehouse Code
     C                     Z-ADD#2HGCD    WL0151           Item Code
     C                     Z-ADDWN0012    WL0152           OD Qty/Cnsmd Pi
     C                     Z-ADDWUFLWG    WL0153           OD Weight Sched
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0152    WN0012           OD Qty/Cnsmd Pi
     C                     Z-ADDWL0153    WUFLWG           OD Weight Sched
     C           #2PIAD    SUB  WN0012    WUPIAD           PS Adjustment Q
      * Only do adjustment if adjust Qty is GT orders for date
      * CASE: WRK.PS Adjustment Quantity is GT Zero
     C           WUPIAD    IFGT *ZERO                      *IF
      * UPD Avail-To-Sell  SCH XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDTRXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0013  30       Company Number
     C                     PARM #2ELDT    WQ0014  70       Production Date
     C                     PARM #2HGCD    WQ0015  70       Item Code
     C                     PARM #2AJCD    WQ0016  3        Warehouse Code
     C                     PARM WUPIAD    WQ0017  50       PS Adjustment Q
     C                     PARM 'SF'      WQ0018  2        ATS Adj Type US
     C                     PARM WN0013    WQ0019  1        Production Type
     C                     PARM #2PSAN    WQ0020  50       PS Adjustment N
     C           WURCAU    PARM *BLANK    WQ0021  3        Return Code ATS
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDTRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993432*
     C                     END
      * CASE: WRK.Return Code ATS USR is BOM Not Found
     C           WURCAU    IFEQ 'BNF'                      *IF
      * Setup message data for message
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2HGCD    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0008           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0008           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'PS BOM Does not Exist'
     C                     MOVEL'USR2057' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.PS Adjustment Type is Ship Cut
     C           #2PSAD    IFEQ 'SC'                       *IF
      * Pieces Vs. Weight
      * CASE: PAR.Piece Count Item is yes
     C           WN0018    IFEQ 'Y'                        *IF
      * Rtv Avg Piece Wgt     RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0047           Company Number
     C                     MOVELWN0013    WL0048    P      Production Type
     C                     Z-ADD#2ELDT    WL0049           Production Date
     C                     Z-ADD#2HGCD    WL0050           Item Code
     C                     MOVEL#2AJCD    WL0051    P      Warehouse Code
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0052    WUF8WG           PS Avg Piece Wg
     C           #2PIAD    MULT WUF8WG    WN0014           PS Weight Ship
      * Pieces
      * PAR.PS Pieces Ship Cut Adj =
      *    *COMPUTE (x1 * x2 * x3)
      * x1    : PAR.PS Adjustment Quantity
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Bags Per Unit
     C           #2PIAD    MULT WN0019    W0WJ01           *Synon (15,0) w
     C           W0WJ01    MULT WN0020    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0015           PS Pieces Ship
     C                     ELSE
      * CASE: *OTHERWISE
     C           #2PIAD    MULT WN0016    WN0014           PS Weight Ship
     C                     Z-ADD*ZERO     WN0015           PS Pieces Ship
     C                     END                             *FI
      * Upd Ship Cut Adjust   RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0154           Company Number
     C                     MOVELWN0013    WL0155    P      Production Type
     C                     Z-ADD#2ELDT    WL0156           Production Date
     C                     Z-ADD#2HGCD    WL0157           Item Code
     C                     MOVEL#2AJCD    WL0158    P      Warehouse Code
     C                     Z-ADDWN0014    WL0159           PS Weight Ship
     C                     Z-ADDWN0015    WL0160           PS Pieces Ship
     C                     EXSR STRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Avg Piece Wgt     RT - PS Prod Item Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           I8AIC3           Company Number
     C                     KFLD           I8V5ST           Production Type
     C                     KFLD           I8ELDT           Production Date
     C                     KFLD           I8HGCD           Item Code
     C                     KFLD           I8AJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWL0047    I8AIC3           Company Number
     C                     MOVELWL0048    I8V5ST           Production Type
     C                     Z-ADDWL0049    I8ELDT           Production Date
     C                     Z-ADDWL0050    I8HGCD           Item Code
     C                     MOVELWL0051    I8AJCD           Warehouse Code
      * Establish starting position
     C           KRSSM     CHAIN@I8CPUS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0052           PS Avg Piece Wg
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDI8F8WG    WL0052           PS Avg Piece Wg
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * BPS Upd Pcs/Wgt Std   RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0025  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0026  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0027  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0028  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0029  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0030  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0031  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0032  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0033  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0034  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0035  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0036  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0037  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0038  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0039  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0040  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0041  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0042  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0043  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0044  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0045  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0046  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0047  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0048 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0049  70       PS Pieces Whse
     C                     Z-ADD*ZERO     WN0050 112       PS Weight Whse
     C                     Z-ADD*ZERO     WN0051  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0052 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0053  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0054 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0055  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0056 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0057  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0058 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0059  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0060  3        PS Item Id
     C                     MOVEL*BLANK    WN0061  2        Warehouse Type
     C                     MOVEL*BLANK    WN0062  1        PS Lock Status
     C                     MOVEL*BLANK    WN0063  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0064  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0065  1        PS Piece Count
     C                     MOVEL*BLANK    WN0066  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0067  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0068  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0069  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0070  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0071  3        PS Production W
     C                     Z-ADD*ZERO     WN0072  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0073  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0074  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0075  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0076  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0077  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0078  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0079  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0080  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0081  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0082  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0083  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0084  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0085  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0086  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0087  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0088  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0089  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0090  6        Department Code
     C                     Z-ADD*ZERO     WN0091  30       Item Structure
     C                     Z-ADD*ZERO     WN0092  30       Item Structure
     C                     Z-ADD*ZERO     WN0093  30       Item Structure
     C                     MOVEL*BLANK    WN0094  6        Primal Group Co
     C                     MOVEL*BLANK    WN0095  1        EDI Status 1
     C                     MOVEL*BLANK    WN0096  1        EDI Status 2
     C                     MOVEL*BLANK    WN0097  1        EDI Status 3
     C                     MOVEL*BLANK    WN0098  1        Record Status
     C                     Z-ADD*ZERO     WN0099  60       Job Time
     C                     MOVEL*BLANK    WN0100 10        User Id
     C                     MOVEL*BLANK    WN0101 10        Job Name
     C                     Z-ADD*ZERO     WN0102  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           I8AIC3           Company Number
     C                     KFLD           I8V5ST           Production Type
     C                     KFLD           I8ELDT           Production Date
     C                     KFLD           I8HGCD           Item Code
     C                     KFLD           I8AJCD           Warehouse Code
      * Setup key
     C                     Z-ADD#2AIC3    I8AIC3           Company Number
     C                     MOVELWN0013    I8V5ST           Production Type
     C                     Z-ADD#2ELDT    I8ELDT           Production Date
     C                     Z-ADD#2HGCD    I8HGCD           Item Code
     C                     MOVEL#2AJCD    I8AJCD           Warehouse Code
      * Establish starting position
     C           KRSSN     CHAIN@I8CPUS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1763' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADDYL0018    WN0032           PS Weight Stand
     C                     Z-ADDYL0019    WN0033           PS Pieces Stand
      * Average Piece Weight
      * CASE: PAR.PS Pieces Standard is NE Zeros
     C           WN0033    IFNE *ZERO                      *IF
      * FP1054 RMC 5/14/09 chg above CASE to ne 0 , it was gt 0
      * Avg Piece Weight
      * PAR.PS Avg Piece Wgt =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Standard
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Pieces Standard
     C           WN0032    DIV  WN0033    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0029           PS Avg Piece Wg
      * FP1054 RMC 5/14/09 make positive if negative
      * CASE: PAR.PS Avg Piece Wgt is LT Zero
     C           WN0029    IFLT *ZERO                      *IF
     C                     MULT -1        WN0029           PS Avg Piece Wg
     C                     END                             *FI
     C                     END                             *FI
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.PS Weight Standard is NE Zero
      *   |- c2    : PAR.PS Pieces Standard is NE Zeros
      *   '-
     C           WN0032    IFNE *ZERO                      *IF
     C           WN0033    ORNE *ZERO                      *OR
      * FP1054 RMC 5/14/09 chg above CASE to ne 0 , it was gt 0
      * UPS Crt Prod Detail   CR - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0053           Company Number
     C                     MOVELWN0013    WL0054    P      Production Type
     C                     Z-ADD#2ELDT    WL0055           Production Date
     C                     Z-ADD#2HGCD    WL0056           Item Code
     C                     MOVEL#2AJCD    WL0057    P      Warehouse Code
     C                     Z-ADDWN0025    WL0058           PS Available Sh
     C                     Z-ADDWN0026    WL0059           PS Weight Plann
     C                     Z-ADDWN0027    WL0060           PS Pieces Plann
     C                     Z-ADDWN0028    WL0061           PS % of Carcass
     C                     Z-ADDWN0029    WL0062           PS Avg Piece Wg
     C                     Z-ADDWN0030    WL0063           PS Weight Inv O
     C                     Z-ADDWN0031    WL0064           PS Pieces Inv O
     C                     Z-ADDWN0032    WL0065           PS Weight Stand
     C                     Z-ADDWN0033    WL0066           PS Pieces Stand
     C                     Z-ADDWN0034    WL0067           PS Weight Conve
     C                     Z-ADDWN0035    WL0068           PS Pieces Conve
     C                     Z-ADDWN0036    WL0069           PS Weight Shipp
     C                     Z-ADDWN0037    WL0070           PS Pieces Shipp
     C                     Z-ADDWN0038    WL0071           PS Weight Prod
     C                     Z-ADDWN0039    WL0072           PS Pieces Prod
     C                     Z-ADDWN0040    WL0073           PS Weight Inv A
     C                     Z-ADDWN0041    WL0074           PS Pieces Inv A
     C                     Z-ADDWN0042    WL0075           PS Weight Ship
     C                     Z-ADDWN0043    WL0076           PS Pieces Ship
     C                     Z-ADDWN0044    WL0077           PS Weight Prod
     C                     Z-ADDWN0045    WL0078           PS Pieces Prod
     C                     Z-ADDWN0046    WL0079           PS Weight Inv A
     C                     Z-ADDWN0047    WL0080           PS Pieces Inv A
     C                     Z-ADDWN0048    WL0081           PS Unit Weight
     C                     Z-ADDWN0049    WL0082           PS Pieces Whse
     C                     Z-ADDWN0050    WL0083           PS Weight Whse
     C                     Z-ADDWN0051    WL0084           PS Pieces Unuse
     C                     Z-ADDWN0052    WL0085           PS Weight Unuse
     C                     Z-ADDWN0053    WL0086           PS Pieces Unuse
     C                     Z-ADDWN0054    WL0087           PS Weight Unuse
     C                     Z-ADDWN0055    WL0088           PS Pieces Unuse
     C                     Z-ADDWN0056    WL0089           PS Weight Unuse
     C                     Z-ADDWN0057    WL0090           PS Pieces Unuse
     C                     Z-ADDWN0058    WL0091           PS Weight Unuse
     C                     Z-ADDWN0059    WL0092           PS Pieces Unuse
     C                     MOVELWN0060    WL0093    P      PS Item Id
     C                     MOVELWN0061    WL0094    P      Warehouse Type
     C                     MOVELWN0062    WL0095    P      PS Lock Status
     C                     MOVELWN0063    WL0096    P      PS Export/Domes
     C                     MOVELWN0064    WL0097    P      PS Print On Sch
     C                     MOVELWN0065    WL0098    P      PS Piece Count
     C                     MOVELWN0066    WL0099    P      PS Unused Sts 1
     C                     MOVELWN0067    WL0100    P      PS Unused Sts 2
     C                     MOVELWN0068    WL0101    P      PS Unused Sts 3
     C                     MOVELWN0069    WL0102    P      PS Unused Sts 4
     C                     MOVELWN0070    WL0103    P      PS Item Sched N
     C                     MOVELWN0071    WL0104    P      PS Production W
     C                     Z-ADDWN0072    WL0105           PS Weight Order
     C                     Z-ADDWN0073    WL0106           PS Pieces Order
     C                     Z-ADDWN0074    WL0107           PS Weight FC Ad
     C                     Z-ADDWN0075    WL0108           PS Pieces FC Ad
     C                     Z-ADDWN0076    WL0109           PS Weight FX Ad
     C                     Z-ADDWN0077    WL0110           PS Pieces FX Ad
     C                     Z-ADDWN0078    WL0111           PS Weight Sched
     C                     Z-ADDWN0079    WL0112           PS Pieces Sched
     C                     Z-ADDWN0080    WL0113           PS Weight Avail
     C                     Z-ADDWN0081    WL0114           PS Pieces Avail
     C                     Z-ADDWN0082    WL0115           PS Weight Produ
     C                     Z-ADDWN0083    WL0116           PS Pieces Produ
     C                     Z-ADDWN0084    WL0117           PS Weight Fab N
     C                     Z-ADDWN0085    WL0118           PS Pieces Fab N
     C                     Z-ADDWN0086    WL0119           PS Weight Sched
     C                     Z-ADDWN0087    WL0120           PS Pieces Sched
     C                     Z-ADDWN0088    WL0121           PS Weight Sched
     C                     Z-ADDWN0089    WL0122           PS Pieces Sched
     C                     MOVELWN0090    WL0123    P      Department Code
     C                     Z-ADDWN0091    WL0124           Item Structure
     C                     Z-ADDWN0092    WL0125           Item Structure
     C                     Z-ADDWN0093    WL0126           Item Structure
     C                     MOVELWN0094    WL0127    P      Primal Group Co
     C                     MOVELWN0095    WL0128    P      EDI Status 1
     C                     MOVELWN0096    WL0129    P      EDI Status 2
     C                     MOVELWN0097    WL0130    P      EDI Status 3
     C                     MOVELWN0098    WL0131    P      Record Status
     C                     Z-ADDWN0099    WL0132           Job Time
     C                     MOVELWN0100    WL0133    P      User Id
     C                     MOVELWN0101    WL0134    P      Job Name
     C                     Z-ADDWN0102    WL0135           Job Date
     C                     EXSR SOCRRC
     C                     END                             *FI
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           I8DXWG    ADD  YL0018    WN0032           PS Weight Stand
     C           I8B2NB    ADD  YL0019    WN0033           PS Pieces Stand
      * Average Piece Weight
      * CASE: PAR.PS Pieces Standard is NE Zeros
     C           WN0033    IFNE *ZERO                      *IF
      * FP1054 RMC 5/14/09 chg above CASE to ne 0 , it was gt 0
      * Avg Piece Weight
      * PAR.PS Avg Piece Wgt =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Standard
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Pieces Standard
     C           WN0032    DIV  WN0033    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0029           PS Avg Piece Wg
      * FP1054 RMC 5/14/09 make positive if negative
      * CASE: PAR.PS Avg Piece Wgt is LT Zero
     C           WN0029    IFLT *ZERO                      *IF
     C                     MULT -1        WN0029           PS Avg Piece Wg
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 RMC 5/14/09 dont do below case - they may be negative now
      * BPS Chg Pcs/Wgt Std   CH - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDI8AIC3    WL0140           Company Number
     C                     MOVELI8V5ST    WL0141    P      Production Type
     C                     Z-ADDI8ELDT    WL0142           Production Date
     C                     Z-ADDI8HGCD    WL0143           Item Code
     C                     MOVELI8AJCD    WL0144    P      Warehouse Code
     C                     Z-ADDWN0029    WL0145           PS Avg Piece Wg
     C                     Z-ADDWN0032    WL0146           PS Weight Stand
     C                     Z-ADDWN0033    WL0147           PS Pieces Stand
     C                     EXSR SRCHRC
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCRRC    BEGSR
      *================================================================
      * UPS Crt Prod Detail   CR - PS Prod Item Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @I8CPUR
     C                     Z-ADDWL0053    WEAIC3           Company Number
     C                     MOVELWL0054    WEV5ST           Production Type
     C                     Z-ADDWL0055    WEELDT           Production Date
     C                     Z-ADDWL0056    WEHGCD           Item Code
     C                     MOVELWL0057    WEAJCD           Warehouse Code
     C                     Z-ADDWL0058    WEGPDT           PS Available Sh
     C                     Z-ADDWL0059    WEWTSP           PS Weight Plann
     C                     Z-ADDWL0060    WEQTSP           PS Pieces Plann
     C                     Z-ADDWL0061    WEDJPC           PS % of Carcass
     C                     Z-ADDWL0062    WEF8WG           PS Avg Piece Wg
     C                     Z-ADDWL0063    WEWTIN           PS Weight Inv O
     C                     Z-ADDWL0064    WED5NB           PS Pieces Inv O
     C                     Z-ADDWL0065    WEDXWG           PS Weight Stand
     C                     Z-ADDWL0066    WEB2NB           PS Pieces Stand
     C                     Z-ADDWL0067    WEWTCN           PS Weight Conve
     C                     Z-ADDWL0068    WEPSCV           PS Pieces Conve
     C                     Z-ADDWL0069    WESAWT           PS Weight Shipp
     C                     Z-ADDWL0070    WEB9NB           PS Pieces Shipp
     C                     Z-ADDWL0071    WED1WG           PS Weight Prod
     C                     Z-ADDWL0072    WECBNB           PS Pieces Prod
     C                     Z-ADDWL0073    WEEZWG           PS Weight Inv A
     C                     Z-ADDWL0074    WECCNB           PS Pieces Inv A
     C                     Z-ADDWL0075    WEE0WG           PS Weight Ship
     C                     Z-ADDWL0076    WED6NB           PS Pieces Ship
     C                     Z-ADDWL0077    WEOAWT           PS Weight Prod
     C                     Z-ADDWL0078    WECDNB           PS Pieces Prod
     C                     Z-ADDWL0079    WEUNW2           PS Weight Inv A
     C                     Z-ADDWL0080    WECENB           PS Pieces Inv A
     C                     Z-ADDWL0081    WEF9WG           PS Unit Weight
     C                     Z-ADDWL0082    WEBPNB           PS Pieces Whse
     C                     Z-ADDWL0083    WEGAWG           PS Weight Whse
     C                     Z-ADDWL0084    WEBQNB           PS Pieces Unuse
     C                     Z-ADDWL0085    WEGBWG           PS Weight Unuse
     C                     Z-ADDWL0086    WEBRNB           PS Pieces Unuse
     C                     Z-ADDWL0087    WEGCWG           PS Weight Unuse
     C                     Z-ADDWL0088    WEBSNB           PS Pieces Unuse
     C                     Z-ADDWL0089    WEGDWG           PS Weight Unuse
     C                     Z-ADDWL0090    WEBWNB           PS Pieces Unuse
     C                     Z-ADDWL0091    WEGEWG           PS Weight Unuse
     C                     Z-ADDWL0092    WEPS6U           PS Pieces Unuse
     C                     MOVELWL0093    WEWCST           PS Item Id
     C                     MOVELWL0094    WEWPST           Warehouse Type
     C                     MOVELWL0095    WEB5ST           PS Lock Status
     C                     MOVELWL0096    WETFST           PS Export/Domes
     C                     MOVELWL0097    WETEST           PS Print On Sch
     C                     MOVELWL0098    WETHST           PS Piece Count
     C                     MOVELWL0099    WEUDST           PS Unused Sts 1
     C                     MOVELWL0100    WEUFST           PS Unused Sts 2
     C                     MOVELWL0101    WEUGST           PS Unused Sts 3
     C                     MOVELWL0102    WEUHST           PS Unused Sts 4
     C                     MOVELWL0103    WEB6ST           PS Item Sched N
     C                     MOVELWL0104    WEB7ST           PS Production W
     C                     Z-ADDWL0105    WEDVWG           PS Weight Order
     C                     Z-ADDWL0106    WED7NB           PS Pieces Order
     C                     Z-ADDWL0107    WEFCAD           PS Weight FC Ad
     C                     Z-ADDWL0108    WED9NB           PS Pieces FC Ad
     C                     Z-ADDWL0109    WEDWWG           PS Weight FX Ad
     C                     Z-ADDWL0110    WEEANB           PS Pieces FX Ad
     C                     Z-ADDWL0111    WESHWT           PS Weight Sched
     C                     Z-ADDWL0112    WEEBNB           PS Pieces Sched
     C                     Z-ADDWL0113    WEAVWT           PS Weight Avail
     C                     Z-ADDWL0114    WEECNB           PS Pieces Avail
     C                     Z-ADDWL0115    WEWTON           PS Weight Produ
     C                     Z-ADDWL0116    WEEDNB           PS Pieces Produ
     C                     Z-ADDWL0117    WEFNWT           PS Weight Fab N
     C                     Z-ADDWL0118    WEEENB           PS Pieces Fab N
     C                     Z-ADDWL0119    WEQTAS           PS Weight Sched
     C                     Z-ADDWL0120    WEEFNB           PS Pieces Sched
     C                     Z-ADDWL0121    WEWAIO           PS Weight Sched
     C                     Z-ADDWL0122    WEEGNB           PS Pieces Sched
     C                     MOVELWL0123    WER3CD           Department Code
     C                     Z-ADDWL0124    WERGNB           Item Structure
     C                     Z-ADDWL0125    WERHNB           Item Structure
     C                     Z-ADDWL0126    WERINB           Item Structure
     C                     MOVELWL0127    WEXRCD           Primal Group Co
     C                     MOVELWL0128    WEUVST           EDI Status 1
     C                     MOVELWL0129    WEUWST           EDI Status 2
     C                     MOVELWL0130    WEUXST           EDI Status 3
     C                     MOVELWL0131    WEVSST           Record Status
     C                     Z-ADDWL0132    WEAATM           Job Time
     C                     MOVELWL0133    WEAYNA           User Id
     C                     MOVELWL0134    WEA0NA           Job Name
     C                     Z-ADDWL0135    WEAXDT           Job Date
      *
      * USER: Processing before Data update
      * BPS Setup Item Info   IF
      *
     C                     Z-ADD*ZERO     WN0103 155       System Value Nu
      *
      * UPS Rtv Company/Item  IF
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0001           Company Number
     C                     Z-ADDWEHGCD    WL0002           Item Code
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    WUAVNA    P      Description Lin
     C                     MOVELWL0004    WUADCD    P      U/M - Primary
     C                     Z-ADDWL0005    WUAIWG           Unit Weight
     C                     Z-ADDWL0006    WERINB           Item Structure
     C                     Z-ADDWL0007    WERHNB           Item Structure
     C                     Z-ADDWL0008    WERGNB           Item Structure
     C                     MOVELWL0009    WUN0CD    P      Item Type Code
     C                     MOVELWL0010    WUQ1CD    P      Default Warehou
     C                     Z-ADDWL0011    WUCHTM           Fresh Chilling
     C                     MOVELWL0012    WUQZCD    P      Base/Conv/Loss
     C                     MOVELWL0013    WUXWST    P      Variety/Rendere
     C                     MOVELWL0014    WUVMST    P      Credit Item Sta
     C                     Z-ADDWL0015    WUSWGH           Std Weight/Head
     C                     Z-ADDWL0016    WUPPHE           Pieces Per Head
     C                     MOVELWL0017    WER3CD    P      Department Code
     C                     MOVELWL0018    WUSDCD    P      Group for Packa
     C                     MOVELWL0019    WUX5ST    P      Seconds Item
     C                     MOVELWL0020    WETHST    P      Piece Count Ite
     C                     Z-ADDWL0021    WUBDNB           Pieces Per Bag
     C                     Z-ADDWL0022    WUBJNB           Bags Per Unit
     C                     MOVELWL0023    WETFST    P      Export/Domestic
     C                     MOVELWL0024    WETEST    P      Print On Schedu
     C                     MOVELWL0025    WUSYST    P      Fresh Inv Alloc
     C                     MOVELWL0026    WUSZST    P      Fresh Sched As
     C                     MOVELWL0027    WUS1ST    P      Frozen Inv Allo
     C                     MOVELWL0028    WEXRCD    P      Primal Group Co
      * BPS Rtv Whs Info      RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWEAJCD    WL0029    P      Warehouse Code
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0030    WEWPST    P      Warehouse Type
     C                     MOVELWL0031    WUXUST    P      Trans Contol AS
     C                     MOVELWL0032    WUT0ST    P      Warehouse Locat
     C                     MOVELWL0033    WUT1ST    P      Warehouse Std C
     C                     Z-ADDWL0034    WUDBNB           Warehouse Chill
      * BPS Set Up Item Id    IF
      * CASE: PAR.Item Type Code is Raw Materials
     C           WUN0CD    IFEQ 'RM'                       *IF
     C                     MOVEL'RMB'     WEWCST           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Seconds Item is Yes
     C           WUX5ST    IFEQ 'Y'                        *IF
     C                     MOVEL'FSC'     WEWCST           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Variety/Rendered/Cut is Variety
     C           WUXWST    IFEQ 'V'                        *IF
     C                     MOVEL'FVR'     WEWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Rendered
     C           WUXWST    IFEQ 'R'                        *IF
     C                     MOVEL'FRD'     WEWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Cut
     C           WUXWST    IFEQ 'C'                        *IF
      * Base/Converted/Fabricated
      * CASE: PAR.Credit Item Status is yes
     C           WUVMST    IFEQ 'Y'                        *IF
      * Setup Base/Converted/Fabricated Credit
      * CASE: PAR.Converted/Base Item is Base
     C           WUQZCD    IFEQ 'B'                        *IF
     C                     MOVEL'FBC'     WEWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WUQZCD    IFEQ 'C'                        *IF
     C                     MOVEL'FCC'     WEWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WUQZCD    IFEQ 'F'                        *IF
     C                     MOVEL'FFC'     WEWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WUQZCD    IFEQ 'L'                        *IF
     C                     MOVEL'FLC'     WEWCST           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup Base/Converted/Fabricated
      * CASE: PAR.Converted/Base Item is Base
     C           WUQZCD    IFEQ 'B'                        *IF
     C                     MOVEL'FGB'     WEWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WUQZCD    IFEQ 'C'                        *IF
     C                     MOVEL'FCV'     WEWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WUQZCD    IFEQ 'F'                        *IF
     C                     MOVEL'FFB'     WEWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WUQZCD    IFEQ 'L'                        *IF
     C                     MOVEL'FLS'     WEWCST           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Output PS Prod Warehouse
      * Rtv Productin Whs     RT - Warehouse  * 
     C                     EXSR SPRVGN
      * Available Ship Date
      * CASE: WRK.Warehouse Std Chill Time is yes
     C           WUT1ST    IFEQ 'Y'                        *IF
      * UPS Clc Avail Shp Dte RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0136           Company Number
     C                     Z-ADDWL0055    WL0137           Post to G/L Dat
     C                     Z-ADDWUDBNB    WL0138           Fresh Chilling
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0139    WEGPDT           PS Available Sh
     C                     ELSE
      * CASE: *OTHERWISE
      * UPS Clc Avail Shp Dte RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0136           Company Number
     C                     Z-ADDWL0055    WL0137           Post to G/L Dat
     C                     Z-ADDWUCHTM    WL0138           Fresh Chilling
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0139    WEGPDT           PS Available Sh
     C                     END                             *FI
      * Average Piece Weight
      * CASE: PAR.PS Pieces Planned Prod is GT Zero
     C           WL0060    IFGT *ZERO                      *IF
     C           WL0059    DIV  WL0060    WEF8WG           PS Avg Piece Wg
     C                     END                             *FI
      * UPS CRTOBJ Stamp      IF
     C                     MOVEL'A'       WEVSST           Record Status
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##PGM     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
     C                     MOVEL'N'       WEB5ST           PS Lock Status
     C           KLCRSO    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEV5ST           Production Type
     C                     KFLD           WEELDT           Production Date
     C                     KFLD           WEHGCD           Item Code
     C                     KFLD           WEAJCD           Warehouse Code
      * Check for duplicate primary key
     C           KLCRSO    SETLL@I8CPUR                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1764' W0RTN   7
      * Send message 'PS Prod Item Schedule  EX'
     C                     MOVEL'USR1764' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C                     WRITE@I8CPUR                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Productin Whs     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWEAJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSP     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WEB7ST           Production Ware
     C                     Z-ADD*ZERO     YL0020           Accounting Comp
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADAOCD    WEB7ST           Production Ware
     C                     Z-ADDADBTC3    YL0020           Accounting Comp
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * UPS Clc Avail Shp Dte RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFAIC3    WQSQ01           Company Number
      * Define keylist
     C           KPSSQ     KLIST
     C                     KFLD           WQSQ01           Company Number
     C                     KFLD           AFBCDT           Post to G/L Dat
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           Company Number
      * Setup key
     C                     Z-ADDWL0136    WQSQ01           Company Number
     C                     Z-ADDWL0137    AFBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSQ     SETLL@AFREBE                    *
     C           KRSSQ     READE@AFREBE                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: WRK.Count USR EQ PAR.Chilling Time
     C           WUCNTU    IFEQ WL0138                     *IF
     C                     Z-ADDAFBCDT    WL0139           PS Available Sh
     C                     GOTO SQEXIT                     *QUIT
     C                     END                             *FI
      * Skip Saturday
      * CASE: DB1.Day of Week is Saturday
     C           AFA9ST    IFEQ '7'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C           KRSSQ     READE@AFREBE                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRCHRC    BEGSR
      *================================================================
      * BPS Chg Pcs/Wgt Std   CH - PS Prod Item Schedule  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0104  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0105  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0106  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0107  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0108  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0109  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0110  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0111  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0112  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0113  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0114  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0115  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0116  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0117  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0118  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0119  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0120  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0121  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0122  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0123  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0124 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0125  70       PS Pieces Whse
     C                     Z-ADD*ZERO     WN0126 112       PS Weight Whse
     C                     Z-ADD*ZERO     WN0127  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0128 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0129  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0130 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0131  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0132 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0133  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0134 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0135  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0136  3        PS Item Id
     C                     MOVEL*BLANK    WN0137  2        Warehouse Type
     C                     MOVEL*BLANK    WN0138  1        PS Lock Status
     C                     MOVEL*BLANK    WN0139  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0140  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0141  1        PS Piece Count
     C                     MOVEL*BLANK    WN0142  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0143  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0144  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0145  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0146  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0147  3        PS Production W
     C                     Z-ADD*ZERO     WN0148  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0149  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0150  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0151  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0152  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0153  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0154  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0155  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0156  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0157  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0158  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0159  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0160  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0161  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0162  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0163  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0164  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0165  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0166  6        Department Code
     C                     Z-ADD*ZERO     WN0167  30       Item Structure
     C                     Z-ADD*ZERO     WN0168  30       Item Structure
     C                     Z-ADD*ZERO     WN0169  30       Item Structure
     C                     MOVEL*BLANK    WN0170  6        Primal Group Co
     C                     MOVEL*BLANK    WN0171  1        EDI Status 1
     C                     MOVEL*BLANK    WN0172  1        EDI Status 2
     C                     MOVEL*BLANK    WN0173  1        EDI Status 3
     C                     MOVEL*BLANK    WN0174  1        Record Status
     C                     Z-ADD*ZERO     WN0175  60       Job Time
     C                     MOVEL*BLANK    WN0176 10        User Id
     C                     MOVEL*BLANK    WN0177 10        Job Name
     C                     Z-ADD*ZERO     WN0178  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @I8CPUR
     C                     Z-ADDWL0140    WEAIC3           Company Number
     C                     MOVELWL0141    WEV5ST    P      Production Type
     C                     Z-ADDWL0142    WEELDT           Production Date
     C                     Z-ADDWL0143    WEHGCD           Item Code
     C                     MOVELWL0144    WEAJCD    P      Warehouse Code
      *
     C           KLCHSR    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEV5ST           Production Type
     C                     KFLD           WEELDT           Production Date
     C                     KFLD           WEHGCD           Item Code
     C                     KFLD           WEAJCD           Warehouse Code
     C           KLCHSR    CHAIN@I8CPUR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI8CPL0'MDACP
     C                     MOVEL'@I8CPUR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SREXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDI81    YARDCS
      * Move non-key fields to @I8CPUR
     C                     Z-ADDWL0145    WEF8WG           PS Avg Piece Wg
     C                     Z-ADDWL0146    WEDXWG           PS Weight Stand
     C                     Z-ADDWL0147    WEB2NB           PS Pieces Stand
      *
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@I8CPUR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDI8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * RTV Scheduled for Date RT - PD Order Detail Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WL0152           OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WL0153           OD Weight Sched
      * Declare restrictor key work fields
     C           *LIKE     DEFN KNAIC3    WQSS01           Company Number
     C           *LIKE     DEFN KNJGDT    WQSS02           OD Production D
     C           *LIKE     DEFN KNHGCD    WQSS03           Item Code
     C           *LIKE     DEFN KNAJCD    WQSS04           Warehouse Code
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS01           Company Number
     C                     KFLD           WQSS02           OD Production D
     C                     KFLD           WQSS03           Item Code
     C                     KFLD           WQSS04           Warehouse Code
      * Setup key
     C                     Z-ADDWL0148    WQSS01           Company Number
     C                     Z-ADDWL0149    WQSS02           OD Production D
     C                     Z-ADDWL0151    WQSS03           Item Code
     C                     MOVELWL0150    WQSS04           Warehouse Code
      * Establish starting position
     C           KRSSS     SETLL@KNCPHP                    *
     C           KRSSS     READE@KNCPHP                  90*
      * Data record not found
     C   90                MOVEL'USR2238' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  KNIGQT    WL0152           OD Qty/Cnsmd Pi
     C                     ADD  KNFLWG    WL0153           OD Weight Sched
     C           KRSSS     READE@KNCPHP                  90*
     C                     ENDDO
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Upd Ship Cut Adjust   RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0179  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0180  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0181  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0182  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0183  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0184  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0185  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0186  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0187  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0188  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0189  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0190  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0191  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0192  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0193  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0194  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0195  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0196  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0197  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0198  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0199  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0200 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0201  70       PS Pieces Whse
     C                     Z-ADD*ZERO     WN0202 112       PS Weight Whse
     C                     Z-ADD*ZERO     WN0203  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0204 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0205  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0206 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0207  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0208 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0209  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0210 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0211  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0212  3        PS Item Id
     C                     MOVEL*BLANK    WN0213  2        Warehouse Type
     C                     MOVEL*BLANK    WN0214  1        PS Lock Status
     C                     MOVEL*BLANK    WN0215  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0216  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0217  1        PS Piece Count
     C                     MOVEL*BLANK    WN0218  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0219  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0220  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0221  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0222  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0223  3        PS Production W
     C                     Z-ADD*ZERO     WN0224  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0225  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0226  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0227  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0228  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0229  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0230  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0231  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0232  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0233  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0234  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0235  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0236  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0237  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0238  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0239  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0240  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0241  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0242  6        Department Code
     C                     Z-ADD*ZERO     WN0243  30       Item Structure
     C                     Z-ADD*ZERO     WN0244  30       Item Structure
     C                     Z-ADD*ZERO     WN0245  30       Item Structure
     C                     MOVEL*BLANK    WN0246  6        Primal Group Co
     C                     MOVEL*BLANK    WN0247  1        EDI Status 1
     C                     MOVEL*BLANK    WN0248  1        EDI Status 2
     C                     MOVEL*BLANK    WN0249  1        EDI Status 3
     C                     MOVEL*BLANK    WN0250  1        Record Status
     C                     Z-ADD*ZERO     WN0251  60       Job Time
     C                     MOVEL*BLANK    WN0252 10        User Id
     C                     MOVEL*BLANK    WN0253 10        Job Name
     C                     Z-ADD*ZERO     WN0254  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           I8AIC3           Company Number
     C                     KFLD           I8V5ST           Production Type
     C                     KFLD           I8ELDT           Production Date
     C                     KFLD           I8HGCD           Item Code
     C                     KFLD           I8AJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWL0154    I8AIC3           Company Number
     C                     MOVELWL0155    I8V5ST           Production Type
     C                     Z-ADDWL0156    I8ELDT           Production Date
     C                     Z-ADDWL0157    I8HGCD           Item Code
     C                     MOVELWL0158    I8AJCD           Warehouse Code
      * Establish starting position
     C           KRSST     CHAIN@I8CPUS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1763' W0RTN   7
      * USER: Processing if Data record not found
      * UPS Crt Prod Detail   CR - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0154    WL0053           Company Number
     C                     MOVELWL0155    WL0054    P      Production Type
     C                     Z-ADDWL0156    WL0055           Production Date
     C                     Z-ADDWL0157    WL0056           Item Code
     C                     MOVELWL0158    WL0057    P      Warehouse Code
     C                     Z-ADDWN0179    WL0058           PS Available Sh
     C                     Z-ADDWN0180    WL0059           PS Weight Plann
     C                     Z-ADDWN0181    WL0060           PS Pieces Plann
     C                     Z-ADDWN0182    WL0061           PS % of Carcass
     C                     Z-ADDWN0183    WL0062           PS Avg Piece Wg
     C                     Z-ADDWN0184    WL0063           PS Weight Inv O
     C                     Z-ADDWN0185    WL0064           PS Pieces Inv O
     C                     Z-ADDWN0186    WL0065           PS Weight Stand
     C                     Z-ADDWN0187    WL0066           PS Pieces Stand
     C                     Z-ADDWN0188    WL0067           PS Weight Conve
     C                     Z-ADDWN0189    WL0068           PS Pieces Conve
     C                     Z-ADDWN0190    WL0069           PS Weight Shipp
     C                     Z-ADDWN0191    WL0070           PS Pieces Shipp
     C                     Z-ADDWN0192    WL0071           PS Weight Prod
     C                     Z-ADDWN0193    WL0072           PS Pieces Prod
     C                     Z-ADDWN0194    WL0073           PS Weight Inv A
     C                     Z-ADDWN0195    WL0074           PS Pieces Inv A
     C                     Z-ADDWL0159    WL0075           PS Weight Ship
     C                     Z-ADDWL0160    WL0076           PS Pieces Ship
     C                     Z-ADDWN0196    WL0077           PS Weight Prod
     C                     Z-ADDWN0197    WL0078           PS Pieces Prod
     C                     Z-ADDWN0198    WL0079           PS Weight Inv A
     C                     Z-ADDWN0199    WL0080           PS Pieces Inv A
     C                     Z-ADDWN0200    WL0081           PS Unit Weight
     C                     Z-ADDWN0201    WL0082           PS Pieces Whse
     C                     Z-ADDWN0202    WL0083           PS Weight Whse
     C                     Z-ADDWN0203    WL0084           PS Pieces Unuse
     C                     Z-ADDWN0204    WL0085           PS Weight Unuse
     C                     Z-ADDWN0205    WL0086           PS Pieces Unuse
     C                     Z-ADDWN0206    WL0087           PS Weight Unuse
     C                     Z-ADDWN0207    WL0088           PS Pieces Unuse
     C                     Z-ADDWN0208    WL0089           PS Weight Unuse
     C                     Z-ADDWN0209    WL0090           PS Pieces Unuse
     C                     Z-ADDWN0210    WL0091           PS Weight Unuse
     C                     Z-ADDWN0211    WL0092           PS Pieces Unuse
     C                     MOVELWN0212    WL0093    P      PS Item Id
     C                     MOVELWN0213    WL0094    P      Warehouse Type
     C                     MOVELWN0214    WL0095    P      PS Lock Status
     C                     MOVELWN0215    WL0096    P      PS Export/Domes
     C                     MOVELWN0216    WL0097    P      PS Print On Sch
     C                     MOVELWN0217    WL0098    P      PS Piece Count
     C                     MOVELWN0218    WL0099    P      PS Unused Sts 1
     C                     MOVELWN0219    WL0100    P      PS Unused Sts 2
     C                     MOVELWN0220    WL0101    P      PS Unused Sts 3
     C                     MOVELWN0221    WL0102    P      PS Unused Sts 4
     C                     MOVELWN0222    WL0103    P      PS Item Sched N
     C                     MOVELWN0223    WL0104    P      PS Production W
     C                     Z-ADDWN0224    WL0105           PS Weight Order
     C                     Z-ADDWN0225    WL0106           PS Pieces Order
     C                     Z-ADDWN0226    WL0107           PS Weight FC Ad
     C                     Z-ADDWN0227    WL0108           PS Pieces FC Ad
     C                     Z-ADDWN0228    WL0109           PS Weight FX Ad
     C                     Z-ADDWN0229    WL0110           PS Pieces FX Ad
     C                     Z-ADDWN0230    WL0111           PS Weight Sched
     C                     Z-ADDWN0231    WL0112           PS Pieces Sched
     C                     Z-ADDWN0232    WL0113           PS Weight Avail
     C                     Z-ADDWN0233    WL0114           PS Pieces Avail
     C                     Z-ADDWN0234    WL0115           PS Weight Produ
     C                     Z-ADDWN0235    WL0116           PS Pieces Produ
     C                     Z-ADDWN0236    WL0117           PS Weight Fab N
     C                     Z-ADDWN0237    WL0118           PS Pieces Fab N
     C                     Z-ADDWN0238    WL0119           PS Weight Sched
     C                     Z-ADDWN0239    WL0120           PS Pieces Sched
     C                     Z-ADDWN0240    WL0121           PS Weight Sched
     C                     Z-ADDWN0241    WL0122           PS Pieces Sched
     C                     MOVELWN0242    WL0123    P      Department Code
     C                     Z-ADDWN0243    WL0124           Item Structure
     C                     Z-ADDWN0244    WL0125           Item Structure
     C                     Z-ADDWN0245    WL0126           Item Structure
     C                     MOVELWN0246    WL0127    P      Primal Group Co
     C                     MOVELWN0247    WL0128    P      EDI Status 1
     C                     MOVELWN0248    WL0129    P      EDI Status 2
     C                     MOVELWN0249    WL0130    P      EDI Status 3
     C                     MOVELWN0250    WL0131    P      Record Status
     C                     Z-ADDWN0251    WL0132           Job Time
     C                     MOVELWN0252    WL0133    P      User Id
     C                     MOVELWN0253    WL0134    P      Job Name
     C                     Z-ADDWN0254    WL0135           Job Date
     C                     EXSR SOCRRC
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           I8E0WG    ADD  WL0159    WUE0WG           PS Weight Ship
     C           I8D6NB    ADD  WL0160    WUD6NB           PS Pieces Ship
      * Chg Ship Cut Adjust   CH - PS Prod Item Schedule  * 
     C                     EXSR SUCHRC
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUCHRC    BEGSR
      *================================================================
      * Chg Ship Cut Adjust   CH - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0255  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0256  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0257  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0258  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0259  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0260  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0261  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0262  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0263  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0264  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0265  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0266  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0267  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0268  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0269  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0270  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0271  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0272  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0273  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0274  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0275  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0276 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0277  70       PS Pieces Whse
     C                     Z-ADD*ZERO     WN0278 112       PS Weight Whse
     C                     Z-ADD*ZERO     WN0279  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0280 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0281  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0282 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0283  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0284 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0285  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0286 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0287  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0288  3        PS Item Id
     C                     MOVEL*BLANK    WN0289  2        Warehouse Type
     C                     MOVEL*BLANK    WN0290  1        PS Lock Status
     C                     MOVEL*BLANK    WN0291  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0292  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0293  1        PS Piece Count
     C                     MOVEL*BLANK    WN0294  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0295  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0296  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0297  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0298  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0299  3        PS Production W
     C                     Z-ADD*ZERO     WN0300  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0301  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0302  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0303  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0304  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0305  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0306  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0307  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0308  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0309  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0310  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0311  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0312  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0313  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0314  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0315  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0316  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0317  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0318  6        Department Code
     C                     Z-ADD*ZERO     WN0319  30       Item Structure
     C                     Z-ADD*ZERO     WN0320  30       Item Structure
     C                     Z-ADD*ZERO     WN0321  30       Item Structure
     C                     MOVEL*BLANK    WN0322  6        Primal Group Co
     C                     MOVEL*BLANK    WN0323  1        EDI Status 1
     C                     MOVEL*BLANK    WN0324  1        EDI Status 2
     C                     MOVEL*BLANK    WN0325  1        EDI Status 3
     C                     MOVEL*BLANK    WN0326  1        Record Status
     C                     Z-ADD*ZERO     WN0327  60       Job Time
     C                     MOVEL*BLANK    WN0328 10        User Id
     C                     MOVEL*BLANK    WN0329 10        Job Name
     C                     Z-ADD*ZERO     WN0330  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @I8CPUR
     C                     Z-ADDWL0154    WEAIC3           Company Number
     C                     MOVELWL0155    WEV5ST    P      Production Type
     C                     Z-ADDWL0156    WEELDT           Production Date
     C                     Z-ADDWL0157    WEHGCD           Item Code
     C                     MOVELWL0158    WEAJCD    P      Warehouse Code
      *
     C           KLCHSU    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEV5ST           Production Type
     C                     KFLD           WEELDT           Production Date
     C                     KFLD           WEHGCD           Item Code
     C                     KFLD           WEAJCD           Warehouse Code
     C           KLCHSU    CHAIN@I8CPUR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI8CPL0'MDACP
     C                     MOVEL'@I8CPUR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDI81    YBRDCS
      * Move non-key fields to @I8CPUR
     C                     Z-ADDWUE0WG    WEE0WG           PS Weight Ship
     C                     Z-ADDWUD6NB    WED6NB           PS Pieces Ship
      *
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * UPS CHGOBJ Stamp      IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##PGM     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@I8CPUR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDI8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVCHRC    BEGSR
      *================================================================
      * Chg Prod. Adjustment  CH - PS Production Adjustment  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0333  60       Job Time
     C                     MOVEL*BLANK    WN0334 10        User Id
     C                     MOVEL*BLANK    WN0335 10        Job Name
     C                     Z-ADD*ZERO     WN0336  70       Job Date
     C                     Z-ADD*ZERO     WN0337  61       Quantity Adjust
     C                     Z-ADD*ZERO     WN0338 112       Unit Weight
     C                     Z-ADD*ZERO     WN0339  52       Fresh Chilling
     C                     MOVEL*BLANK    WN0340  1        Piece Count Ite
     C                     Z-ADD*ZERO     WN0341  70       Pieces Per Bag
     C                     Z-ADD*ZERO     WN0342  70       Bags Per Unit
     C                     Z-ADD*ZERO     WN0343 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0344 112       Quantity Schedu
     C                     MOVEL*BLANK    WN0345  1        Warehouse Std C
     C                     Z-ADD*ZERO     WN0346  52       Warehouse Chill
     C                     Z-ADD*ZERO     WN0347  70       Ship Date USR
     C                     MOVEL*BLANK    WN0348  1        Production Type
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @I9CPUU
     C                     Z-ADD#1AIC3    WDAIC3           Company Number
     C                     Z-ADD#1ELDT    WDELDT           Production Date
     C                     Z-ADD#1HGCD    WDHGCD           Item Code
     C                     MOVEL#1AJCD    WDAJCD    P      Warehouse Code
     C                     MOVEL'PR'      WDPSAD    P      PS Adjustment T
     C                     Z-ADD#1PSAN    WDPSAN           PS Adjustment N
      *
     C           KLCHSV    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDELDT           Production Date
     C                     KFLD           WDHGCD           Item Code
     C                     KFLD           WDAJCD           Warehouse Code
     C                     KFLD           WDPSAD           PS Adjustment T
     C                     KFLD           WDPSAN           PS Adjustment N
     C           KLCHSV    CHAIN@I9CPUU              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI9CPL0'MDACP
     C                     MOVEL'@I9CPUU' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SVEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDI91    YCRDCS
      * USER: Processing after Data read
     C                     Z-ADDWDPIAD    WN0337           Quantity Adjust
      * Move non-key fields to @I9CPUU
     C                     Z-ADD#RN1QT    WDPIAD           PS Adjustment Q
     C                     MOVEL#1V6ST    WDV6ST    P      PS Adjustment S
     C                     Z-ADD#1D8C7    WDD8C7           PS Consumed Ite
     C                     MOVEL#1UVST    WDUVST    P      EDI Status 1
     C                     MOVEL#1UWST    WDUWST    P      EDI Status 2
     C                     MOVEL#1UXST    WDUXST    P      EDI Status 3
     C                     MOVEL#1VSST    WDVSST    P      Record Status
      *
      * Set PGM.*Record Data Changed flag
     C           QPDI91    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WDAATM' defaulted for 'Job Time'.
      * Field '(DB1) WDAYNA' defaulted for 'User Id'.
      * Field '(DB1) WDA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WDAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##JOB     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
      * CASE: PAR.Status - Y or N is yes
     C           'Y'       IFEQ 'Y'                        *IF
     C                     MOVEL'S'       WDV6ST           PS Adjustment S
     C                     END                             *FI
      * Set PGM.*Record Data Changed flag
     C           QPDI91    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@I9CPUU                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDI9CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
      * USER: Processing after Data update
      * BPS Setup Item Info   IF
      *
     C                     Z-ADD*ZERO     WN0349 155       System Value Nu
      *
      * UPS Rtv Company/Item  IF
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0001           Company Number
     C                     Z-ADD#1HGCD    WL0002           Item Code
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    WUAVNA    P      Description Lin
     C                     MOVELWL0004    WUADCD    P      U/M - Primary
     C                     Z-ADDWL0005    WN0338           Unit Weight
     C                     Z-ADDWL0006    WURINB           Item Structure
     C                     Z-ADDWL0007    WURHNB           Item Structure
     C                     Z-ADDWL0008    WURGNB           Item Structure
     C                     MOVELWL0009    WUN0CD    P      Item Type Code
     C                     MOVELWL0010    WUQ1CD    P      Default Warehou
     C                     Z-ADDWL0011    WN0339           Fresh Chilling
     C                     MOVELWL0012    WUQZCD    P      Base/Conv/Loss
     C                     MOVELWL0013    WUXWST    P      Variety/Rendere
     C                     MOVELWL0014    WUVMST    P      Credit Item Sta
     C                     Z-ADDWL0015    WUSWGH           Std Weight/Head
     C                     Z-ADDWL0016    WUPPHE           Pieces Per Head
     C                     MOVELWL0017    WUR3CD    P      Department Code
     C                     MOVELWL0018    WUSDCD    P      Group for Packa
     C                     MOVELWL0019    WUX5ST    P      Seconds Item
     C                     MOVELWL0020    WN0340    P      Piece Count Ite
     C                     Z-ADDWL0021    WN0341           Pieces Per Bag
     C                     Z-ADDWL0022    WN0342           Bags Per Unit
     C                     MOVELWL0023    WUSUST    P      Export/Domestic
     C                     MOVELWL0024    WUSVST    P      Print On Schedu
     C                     MOVELWL0025    WUSYST    P      Fresh Inv Alloc
     C                     MOVELWL0026    WUSZST    P      Fresh Sched As
     C                     MOVELWL0027    WUS1ST    P      Frozen Inv Allo
     C                     MOVELWL0028    WUXRCD    P      Primal Group Co
      * BPS Rtv Whs Info      RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1AJCD    WL0029    P      Warehouse Code
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0030    WUWPST    P      Warehouse Type
     C                     MOVELWL0031    WUXUST    P      Trans Contol AS
     C                     MOVELWL0032    WUT0ST    P      Warehouse Locat
     C                     MOVELWL0033    WN0345    P      Warehouse Std C
     C                     Z-ADDWL0034    WN0346           Warehouse Chill
      * BPS Set Up Item Id    IF
      * CASE: PAR.Item Type Code is Raw Materials
     C           WUN0CD    IFEQ 'RM'                       *IF
     C                     MOVEL'RMB'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Seconds Item is Yes
     C           WUX5ST    IFEQ 'Y'                        *IF
     C                     MOVEL'FSC'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Variety/Rendered/Cut is Variety
     C           WUXWST    IFEQ 'V'                        *IF
     C                     MOVEL'FVR'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Rendered
     C           WUXWST    IFEQ 'R'                        *IF
     C                     MOVEL'FRD'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Cut
     C           WUXWST    IFEQ 'C'                        *IF
      * Base/Converted/Fabricated
      * CASE: PAR.Credit Item Status is yes
     C           WUVMST    IFEQ 'Y'                        *IF
      * Setup Base/Converted/Fabricated Credit
      * CASE: PAR.Converted/Base Item is Base
     C           WUQZCD    IFEQ 'B'                        *IF
     C                     MOVEL'FBC'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WUQZCD    IFEQ 'C'                        *IF
     C                     MOVEL'FCC'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WUQZCD    IFEQ 'F'                        *IF
     C                     MOVEL'FFC'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WUQZCD    IFEQ 'L'                        *IF
     C                     MOVEL'FLC'     WUWCST           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup Base/Converted/Fabricated
      * CASE: PAR.Converted/Base Item is Base
     C           WUQZCD    IFEQ 'B'                        *IF
     C                     MOVEL'FGB'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WUQZCD    IFEQ 'C'                        *IF
     C                     MOVEL'FCV'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WUQZCD    IFEQ 'F'                        *IF
     C                     MOVEL'FFB'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WUQZCD    IFEQ 'L'                        *IF
     C                     MOVEL'FLS'     WUWCST           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Determine Production Type
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           #1ELDT    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       WN0348           Production Type
      * Val Sched Existance   RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0035           Company Number
     C                     MOVELWN0348    WL0036    P      Production Type
     C                     Z-ADD#1ELDT    WL0037           Production Date
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0038    WUWXST    P      Record Found US
      * Set to Plan if record not found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'P'       WN0348           Production Type
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Production Date GT JOB.*Job date
     C           #1ELDT    IFGT ##JDT                      *IF
     C                     MOVEL'P'       WN0348           Production Type
     C                     END                             *FI
     C                     END                             *FI
      * Update production
      * CASE: PAR.Status - Y or N is yes
     C           'Y'       IFEQ 'Y'                        *IF
      * CASE: PAR.PS Adjustment Type is Ship Cut
     C           'PR'      IFEQ 'SC'                       *IF
     C           #RN1QT    SUB  WN0337    WUPIAD           PS Adjustment Q
      * Adjustment Weight/Pieces
      * CASE: PAR.Piece Count Item is yes
     C           WN0340    IFEQ 'Y'                        *IF
      * Rtv Avg Piece Wgt     RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0047           Company Number
     C                     MOVELWN0348    WL0048    P      Production Type
     C                     Z-ADD#1ELDT    WL0049           Production Date
     C                     Z-ADD#1HGCD    WL0050           Item Code
     C                     MOVEL#1AJCD    WL0051    P      Warehouse Code
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0052    WUF8WG           PS Avg Piece Wg
     C           WUPIAD    MULT WUF8WG    WUE0WG           PS Weight Ship
      * Pieces
      * WRK.PS Pieces Ship Cut Adj =
      *    *COMPUTE (x1 * x2 * x3)
      * x1    : WRK.PS Adjustment Quantity
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Bags Per Unit
     C           WUPIAD    MULT WN0341    W0WJ01           *Synon (15,0) w
     C           W0WJ01    MULT WN0342    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WUD6NB           PS Pieces Ship
     C                     ELSE
      * CASE: *OTHERWISE
     C           WUPIAD    MULT WN0338    WUE0WG           PS Weight Ship
     C                     Z-ADD*ZERO     WUD6NB           PS Pieces Ship
     C                     END                             *FI
      * Upd Ship Cut Adjust   RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0154           Company Number
     C                     MOVELWN0348    WL0155    P      Production Type
     C                     Z-ADD#1ELDT    WL0156           Production Date
     C                     Z-ADD#1HGCD    WL0157           Item Code
     C                     MOVEL#1AJCD    WL0158    P      Warehouse Code
     C                     Z-ADDWUE0WG    WL0159           PS Weight Ship
     C                     Z-ADDWUD6NB    WL0160           PS Pieces Ship
     C                     EXSR STRVGN
     C                     ELSE
      * CASE: PAR.PS Adjustment Type is Forecast
     C           'PR'      IFEQ 'FC'                       *IF
      * UPD Dealloc One FC Adj RT - PS Production Adjustment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0161           Company Number
     C                     Z-ADDWDELDT    WL0162           Production Date
     C                     Z-ADDWDHGCD    WL0163           Item Code
     C                     MOVELWDAJCD    WL0164    P      Warehouse Code
     C                     MOVELWDPSAD    WL0165    P      PS Adjustment T
     C                     Z-ADDWDPSAN    WL0166           PS Adjustment N
     C                     Z-ADDWN0337    WL0167           PS Adjustment Q
     C                     MOVELWN0348    WL0168    P      Production Type
     C                     EXSR SWRVGN
      * UPD Alloc One FC Adj  RT - PS Production Adjustment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0169           Company Number
     C                     Z-ADDWDELDT    WL0170           Production Date
     C                     Z-ADDWDHGCD    WL0171           Item Code
     C                     MOVELWDAJCD    WL0172    P      Warehouse Code
     C                     MOVELWDPSAD    WL0173    P      PS Adjustment T
     C                     Z-ADDWDPSAN    WL0174           PS Adjustment N
     C                     Z-ADD#RN1QT    WL0175           PS Adjustment Q
     C                     MOVELWN0348    WL0176    P      Production Type
     C                     EXSR SXRVGN
     C                     ELSE
      * CASE: PAR.PS Adjustment Type is Override
     C           'PR'      IFEQ 'OV'                       *IF
      * BPS Rpl Pcs/Wgt Std   RT - PS Prod Item Schedule  * 
     C                     EXSR SYRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C           #RN1QT    SUB  WN0337    WUPIAD           PS Adjustment Q
      * UPD Avail-To-Sell  SCH XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDTRXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0040  30       Company Number
     C                     PARM #1ELDT    WQ0041  70       Production Date
     C                     PARM #1HGCD    WQ0042  70       Item Code
     C                     PARM #1AJCD    WQ0043  3        Warehouse Code
     C                     PARM WUPIAD    WQ0044  50       PS Adjustment Q
     C                     PARM 'SA'      WQ0045  2        ATS Adj Type US
     C                     PARM WN0348    WQ0046  1        Production Type
     C                     PARM #1PSAN    WQ0047  50       PS Adjustment N
     C           WURCAU    PARM *BLANK    WQ0048  3        Return Code ATS
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDTRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CASE: WRK.Return Code ATS USR is BOM Not Found
     C           WURCAU    IFEQ 'BNF'                      *IF
      * Setup message data for message
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0009           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0009           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'PS BOM Does not Exist'
     C                     MOVEL'USR2057' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * UPD Dealloc One FC Adj RT - PS Production Adjustment  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0350 112       Unit Weight
     C                     Z-ADD*ZERO     WN0351  52       Fresh Chilling
     C                     MOVEL*BLANK    WN0352  1        Piece Count Ite
     C                     Z-ADD*ZERO     WN0353  70       Pieces Per Bag
     C                     Z-ADD*ZERO     WN0354  70       Bags Per Unit
     C                     MOVEL*BLANK    WN0355  1        Warehouse Std C
     C                     Z-ADD*ZERO     WN0356  52       Warehouse Chill
     C                     Z-ADD*ZERO     WN0357 112       ATS Weight Avai
     C                     Z-ADD*ZERO     WN0358  70       ATS Pieces Avai
     C                     Z-ADD*ZERO     WN0359  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0360  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0361  70       Ship Date USR
     C                     Z-ADD*ZERO     WN0362 112       Quantity Schedu
     C                     MOVEL*BLANK    WN0363  1        Error Status
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFELDT           Production Date
     C                     KFLD           WFHGCD           Item Code
     C                     KFLD           WFAJCD           Warehouse Code
     C                     KFLD           WFPSAD           PS Adjustment T
     C                     KFLD           WFPSAN           PS Adjustment N
      * Setup key
     C                     Z-ADDWL0161    WFAIC3           Company Number
     C                     Z-ADDWL0162    WFELDT           Production Date
     C                     Z-ADDWL0163    WFHGCD           Item Code
     C                     MOVELWL0164    WFAJCD           Warehouse Code
     C                     MOVELWL0165    WFPSAD           PS Adjustment T
     C                     Z-ADDWL0166    WFPSAN           PS Adjustment N
      * Establish starting position
     C           KRSSW     CHAIN@I9CPCV              90    *
      * Data record not found
     C   90                MOVEL'USR1765' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.PS Adjustment Type is Forecast
     C           WFPSAD    IFEQ 'FC'                       *IF
      * RTV Scheduled for Date RT - PD Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWFAIC3    WL0148           Company Number
     C                     Z-ADDWFELDT    WL0149           OD Production D
     C                     MOVELWFAJCD    WL0150    P      Warehouse Code
     C                     Z-ADDWFHGCD    WL0151           Item Code
     C                     Z-ADDWN0362    WL0152           OD Qty/Cnsmd Pi
     C                     Z-ADDWUFLWG    WL0153           OD Weight Sched
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0152    WN0362           OD Qty/Cnsmd Pi
     C                     Z-ADDWL0153    WUFLWG           OD Weight Sched
     C           WL0167    SUB  WN0362    WUPIAD           PS Adjustment Q
      * If adjustment quantity is greater than ordered delete difference
      * CASE: WRK.PS Adjustment Quantity is GE Zero
     C           WUPIAD    IFGE *ZERO                      *IF
     C                     MULT -1        WUPIAD           PS Adjustment Q
      * UPD Avail-To-Sell  SCH XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDTRXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WFAIC3    WQ0022  30       Company Number
     C                     PARM WFELDT    WQ0023  70       Production Date
     C                     PARM WFHGCD    WQ0024  70       Item Code
     C                     PARM WFAJCD    WQ0025  3        Warehouse Code
     C                     PARM WUPIAD    WQ0026  50       PS Adjustment Q
     C                     PARM 'SF'      WQ0027  2        ATS Adj Type US
     C                     PARM WL0168    WQ0028  1        Production Type
     C                     PARM WFPSAN    WQ0029  50       PS Adjustment N
     C           WURCAU    PARM *BLANK    WQ0030  3        Return Code ATS
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDTRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * UPD Alloc One FC Adj  RT - PS Production Adjustment  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0364 112       Unit Weight
     C                     Z-ADD*ZERO     WN0365  52       Fresh Chilling
     C                     MOVEL*BLANK    WN0366  1        Piece Count Ite
     C                     Z-ADD*ZERO     WN0367  70       Pieces Per Bag
     C                     Z-ADD*ZERO     WN0368  70       Bags Per Unit
     C                     Z-ADD*ZERO     WN0369  70       Ship Date USR
     C                     MOVEL*BLANK    WN0370  1        Warehouse Std C
     C                     Z-ADD*ZERO     WN0371  52       Warehouse Chill
     C                     Z-ADD*ZERO     WN0372 112       Quantity Schedu
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFELDT           Production Date
     C                     KFLD           WFHGCD           Item Code
     C                     KFLD           WFAJCD           Warehouse Code
     C                     KFLD           WFPSAD           PS Adjustment T
     C                     KFLD           WFPSAN           PS Adjustment N
      * Setup key
     C                     Z-ADDWL0169    WFAIC3           Company Number
     C                     Z-ADDWL0170    WFELDT           Production Date
     C                     Z-ADDWL0171    WFHGCD           Item Code
     C                     MOVELWL0172    WFAJCD           Warehouse Code
     C                     MOVELWL0173    WFPSAD           PS Adjustment T
     C                     Z-ADDWL0174    WFPSAN           PS Adjustment N
      * Establish starting position
     C           KRSSX     CHAIN@I9CPCV              90    *
      * Data record not found
     C   90                MOVEL'USR1765' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.PS Adjustment Type is Forecast
     C           WFPSAD    IFEQ 'FC'                       *IF
      * RTV Scheduled for Date RT - PD Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWFAIC3    WL0148           Company Number
     C                     Z-ADDWFELDT    WL0149           OD Production D
     C                     MOVELWFAJCD    WL0150    P      Warehouse Code
     C                     Z-ADDWFHGCD    WL0151           Item Code
     C                     Z-ADDWN0372    WL0152           OD Qty/Cnsmd Pi
     C                     Z-ADDWUFLWG    WL0153           OD Weight Sched
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0152    WN0372           OD Qty/Cnsmd Pi
     C                     Z-ADDWL0153    WUFLWG           OD Weight Sched
      * Calc adjust quantity
      * WRK.PS Adjustment Quantity =
      *    *COMPUTE (x1 - x2)
      * x1    : PAR.PS Adjustment Quantity
      * -     : PGM.*Synon (17,7) work field
      * x2    : PAR.Quantity Scheduled SUM
     C           WL0175    SUB  WN0372    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WUPIAD           PS Adjustment Q
      * Only do adjustment if adjust Qty is GE orders for date
      * CASE: WRK.PS Adjustment Quantity is GE Zero
     C           WUPIAD    IFGE *ZERO                      *IF
      * UPD Avail-To-Sell  SCH XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDTRXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WFAIC3    WQ0031  30       Company Number
     C                     PARM WFELDT    WQ0032  70       Production Date
     C                     PARM WFHGCD    WQ0033  70       Item Code
     C                     PARM WFAJCD    WQ0034  3        Warehouse Code
     C                     PARM WUPIAD    WQ0035  50       PS Adjustment Q
     C                     PARM 'SF'      WQ0036  2        ATS Adj Type US
     C                     PARM WL0176    WQ0037  1        Production Type
     C                     PARM WFPSAN    WQ0038  50       PS Adjustment N
     C           WURCAU    PARM *BLANK    WQ0039  3        Return Code ATS
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDTRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * BPS Rpl Pcs/Wgt Std   RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0373  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0374  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0375  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0376  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0377  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0378  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0379  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0380  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0381  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0382  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0383  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0384  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0385  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0386  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0387  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0388  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0389  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0390  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0391  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0392  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0393  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0394  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0395  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0396 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0397  70       PS Pieces Whse
     C                     Z-ADD*ZERO     WN0398 112       PS Weight Whse
     C                     Z-ADD*ZERO     WN0399  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0400 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0401  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0402 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0403  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0404 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0405  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0406 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0407  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0408  3        PS Item Id
     C                     MOVEL*BLANK    WN0409  2        Warehouse Type
     C                     MOVEL*BLANK    WN0410  1        PS Lock Status
     C                     MOVEL*BLANK    WN0411  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0412  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0413  1        PS Piece Count
     C                     MOVEL*BLANK    WN0414  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0415  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0416  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0417  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0418  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0419  3        PS Production W
     C                     Z-ADD*ZERO     WN0420  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0421  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0422  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0423  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0424  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0425  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0426  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0427  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0428  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0429  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0430  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0431  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0432  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0433  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0434  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0435  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0436  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0437  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0438  6        Department Code
     C                     Z-ADD*ZERO     WN0439  30       Item Structure
     C                     Z-ADD*ZERO     WN0440  30       Item Structure
     C                     Z-ADD*ZERO     WN0441  30       Item Structure
     C                     MOVEL*BLANK    WN0442  6        Primal Group Co
     C                     MOVEL*BLANK    WN0443  1        EDI Status 1
     C                     MOVEL*BLANK    WN0444  1        EDI Status 2
     C                     MOVEL*BLANK    WN0445  1        EDI Status 3
     C                     MOVEL*BLANK    WN0446  1        Record Status
     C                     Z-ADD*ZERO     WN0447  60       Job Time
     C                     MOVEL*BLANK    WN0448 10        User Id
     C                     MOVEL*BLANK    WN0449 10        Job Name
     C                     Z-ADD*ZERO     WN0450  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           I8AIC3           Company Number
     C                     KFLD           I8V5ST           Production Type
     C                     KFLD           I8ELDT           Production Date
     C                     KFLD           I8HGCD           Item Code
     C                     KFLD           I8AJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWDAIC3    I8AIC3           Company Number
     C                     MOVELWN0348    I8V5ST           Production Type
     C                     Z-ADDWDELDT    I8ELDT           Production Date
     C                     Z-ADDWDHGCD    I8HGCD           Item Code
     C                     MOVELWDAJCD    I8AJCD           Warehouse Code
      * Establish starting position
     C           KRSSY     CHAIN@I8CPUS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1763' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD*ZERO     WN0380           PS Weight Stand
     C                     Z-ADD*ZERO     WN0381           PS Pieces Stand
      * Average Piece Weight
      * CASE: PAR.PS Pieces Standard is NE Zeros
     C           WN0381    IFNE *ZERO                      *IF
      * FP1054 RMC 5/14/09 chg above CASE to ne 0 , it was gt 0
      * Avg Piece Weight
      * PAR.PS Avg Piece Wgt =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Standard
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Pieces Standard
     C           WN0380    DIV  WN0381    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0377           PS Avg Piece Wg
      * FP1054 RMC 5/14/09 make positive if negative
      * CASE: PAR.PS Avg Piece Wgt is LT Zero
     C           WN0377    IFLT *ZERO                      *IF
     C                     MULT -1        WN0377           PS Avg Piece Wg
     C                     END                             *FI
     C                     END                             *FI
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.PS Weight Standard is NE Zero
      *   |- c2    : PAR.PS Pieces Standard is NE Zeros
      *   '-
     C           WN0380    IFNE *ZERO                      *IF
     C           WN0381    ORNE *ZERO                      *OR
      * FP1054 RMC 5/14/09 chg above CASE to ne 0 , it was gt 0
      * UPS Crt Prod Detail   CR - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0053           Company Number
     C                     MOVELWN0348    WL0054    P      Production Type
     C                     Z-ADDWDELDT    WL0055           Production Date
     C                     Z-ADDWDHGCD    WL0056           Item Code
     C                     MOVELWDAJCD    WL0057    P      Warehouse Code
     C                     Z-ADDWN0373    WL0058           PS Available Sh
     C                     Z-ADDWN0374    WL0059           PS Weight Plann
     C                     Z-ADDWN0375    WL0060           PS Pieces Plann
     C                     Z-ADDWN0376    WL0061           PS % of Carcass
     C                     Z-ADDWN0377    WL0062           PS Avg Piece Wg
     C                     Z-ADDWN0378    WL0063           PS Weight Inv O
     C                     Z-ADDWN0379    WL0064           PS Pieces Inv O
     C                     Z-ADDWN0380    WL0065           PS Weight Stand
     C                     Z-ADDWN0381    WL0066           PS Pieces Stand
     C                     Z-ADDWN0382    WL0067           PS Weight Conve
     C                     Z-ADDWN0383    WL0068           PS Pieces Conve
     C                     Z-ADDWN0384    WL0069           PS Weight Shipp
     C                     Z-ADDWN0385    WL0070           PS Pieces Shipp
     C                     Z-ADDWN0386    WL0071           PS Weight Prod
     C                     Z-ADDWN0387    WL0072           PS Pieces Prod
     C                     Z-ADDWN0388    WL0073           PS Weight Inv A
     C                     Z-ADDWN0389    WL0074           PS Pieces Inv A
     C                     Z-ADDWN0390    WL0075           PS Weight Ship
     C                     Z-ADDWN0391    WL0076           PS Pieces Ship
     C                     Z-ADDWN0392    WL0077           PS Weight Prod
     C                     Z-ADDWN0393    WL0078           PS Pieces Prod
     C                     Z-ADDWN0394    WL0079           PS Weight Inv A
     C                     Z-ADDWN0395    WL0080           PS Pieces Inv A
     C                     Z-ADDWN0396    WL0081           PS Unit Weight
     C                     Z-ADDWN0397    WL0082           PS Pieces Whse
     C                     Z-ADDWN0398    WL0083           PS Weight Whse
     C                     Z-ADDWN0399    WL0084           PS Pieces Unuse
     C                     Z-ADDWN0400    WL0085           PS Weight Unuse
     C                     Z-ADDWN0401    WL0086           PS Pieces Unuse
     C                     Z-ADDWN0402    WL0087           PS Weight Unuse
     C                     Z-ADDWN0403    WL0088           PS Pieces Unuse
     C                     Z-ADDWN0404    WL0089           PS Weight Unuse
     C                     Z-ADDWN0405    WL0090           PS Pieces Unuse
     C                     Z-ADDWN0406    WL0091           PS Weight Unuse
     C                     Z-ADDWN0407    WL0092           PS Pieces Unuse
     C                     MOVELWN0408    WL0093    P      PS Item Id
     C                     MOVELWN0409    WL0094    P      Warehouse Type
     C                     MOVELWN0410    WL0095    P      PS Lock Status
     C                     MOVELWN0411    WL0096    P      PS Export/Domes
     C                     MOVELWN0412    WL0097    P      PS Print On Sch
     C                     MOVELWN0413    WL0098    P      PS Piece Count
     C                     MOVELWN0414    WL0099    P      PS Unused Sts 1
     C                     MOVELWN0415    WL0100    P      PS Unused Sts 2
     C                     MOVELWN0416    WL0101    P      PS Unused Sts 3
     C                     MOVELWN0417    WL0102    P      PS Unused Sts 4
     C                     MOVELWN0418    WL0103    P      PS Item Sched N
     C                     MOVELWN0419    WL0104    P      PS Production W
     C                     Z-ADDWN0420    WL0105           PS Weight Order
     C                     Z-ADDWN0421    WL0106           PS Pieces Order
     C                     Z-ADDWN0422    WL0107           PS Weight FC Ad
     C                     Z-ADDWN0423    WL0108           PS Pieces FC Ad
     C                     Z-ADDWN0424    WL0109           PS Weight FX Ad
     C                     Z-ADDWN0425    WL0110           PS Pieces FX Ad
     C                     Z-ADDWN0426    WL0111           PS Weight Sched
     C                     Z-ADDWN0427    WL0112           PS Pieces Sched
     C                     Z-ADDWN0428    WL0113           PS Weight Avail
     C                     Z-ADDWN0429    WL0114           PS Pieces Avail
     C                     Z-ADDWN0430    WL0115           PS Weight Produ
     C                     Z-ADDWN0431    WL0116           PS Pieces Produ
     C                     Z-ADDWN0432    WL0117           PS Weight Fab N
     C                     Z-ADDWN0433    WL0118           PS Pieces Fab N
     C                     Z-ADDWN0434    WL0119           PS Weight Sched
     C                     Z-ADDWN0435    WL0120           PS Pieces Sched
     C                     Z-ADDWN0436    WL0121           PS Weight Sched
     C                     Z-ADDWN0437    WL0122           PS Pieces Sched
     C                     MOVELWN0438    WL0123    P      Department Code
     C                     Z-ADDWN0439    WL0124           Item Structure
     C                     Z-ADDWN0440    WL0125           Item Structure
     C                     Z-ADDWN0441    WL0126           Item Structure
     C                     MOVELWN0442    WL0127    P      Primal Group Co
     C                     MOVELWN0443    WL0128    P      EDI Status 1
     C                     MOVELWN0444    WL0129    P      EDI Status 2
     C                     MOVELWN0445    WL0130    P      EDI Status 3
     C                     MOVELWN0446    WL0131    P      Record Status
     C                     Z-ADDWN0447    WL0132           Job Time
     C                     MOVELWN0448    WL0133    P      User Id
     C                     MOVELWN0449    WL0134    P      Job Name
     C                     Z-ADDWN0450    WL0135           Job Date
     C                     EXSR SOCRRC
     C                     END                             *FI
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     Z-ADD*ZERO     WN0380           PS Weight Stand
     C                     Z-ADD*ZERO     WN0381           PS Pieces Stand
      * Average Piece Weight
      * CASE: PAR.PS Pieces Standard is NE Zeros
     C           WN0381    IFNE *ZERO                      *IF
      * FP1054 RMC 5/14/09 chg above CASE to ne 0 , it was gt 0
      * Avg Piece Weight
      * PAR.PS Avg Piece Wgt =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Standard
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Pieces Standard
     C           WN0380    DIV  WN0381    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0377           PS Avg Piece Wg
      * FP1054 RMC 5/14/09 make positive if negative
      * CASE: PAR.PS Avg Piece Wgt is LT Zero
     C           WN0377    IFLT *ZERO                      *IF
     C                     MULT -1        WN0377           PS Avg Piece Wg
     C                     END                             *FI
     C                     END                             *FI
      * BPS Chg Pcs/Wgt Std   CH - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDI8AIC3    WL0140           Company Number
     C                     MOVELI8V5ST    WL0141    P      Production Type
     C                     Z-ADDI8ELDT    WL0142           Production Date
     C                     Z-ADDI8HGCD    WL0143           Item Code
     C                     MOVELI8AJCD    WL0144    P      Warehouse Code
     C                     Z-ADDWN0377    WL0145           PS Avg Piece Wg
     C                     Z-ADDWN0380    WL0146           PS Weight Stand
     C                     Z-ADDWN0381    WL0147           PS Pieces Stand
     C                     EXSR SRCHRC
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZDLRC    BEGSR
      *================================================================
      * Del Prod Adjustment   DL - PS Production Adjustment  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0451 112       Unit Weight
     C                     Z-ADD*ZERO     WN0452  52       Fresh Chilling
     C                     MOVEL*BLANK    WN0453  1        Piece Count Ite
     C                     Z-ADD*ZERO     WN0454  70       Pieces Per Bag
     C                     Z-ADD*ZERO     WN0455  70       Bags Per Unit
     C                     MOVEL*BLANK    WN0456  1        Warehouse Std C
     C                     Z-ADD*ZERO     WN0457  52       Warehouse Chill
     C                     Z-ADD*ZERO     WN0458  61       Quantity Adjust
     C                     Z-ADD*ZERO     WN0459 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0460 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0461  70       Ship Date USR
     C                     MOVEL*BLANK    WN0462  1        Production Type
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @I9CPUU
     C                     Z-ADD#1AIC3    WDAIC3           Company Number
     C                     Z-ADD#1ELDT    WDELDT           Production Date
     C                     Z-ADD#1HGCD    WDHGCD           Item Code
     C                     MOVEL#1AJCD    WDAJCD           Warehouse Code
     C                     MOVEL#1PSAD    WDPSAD           PS Adjustment T
     C                     Z-ADD#1PSAN    WDPSAN           PS Adjustment N
      *
     C           KLDLSZ    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDELDT           Production Date
     C                     KFLD           WDHGCD           Item Code
     C                     KFLD           WDAJCD           Warehouse Code
     C                     KFLD           WDPSAD           PS Adjustment T
     C                     KFLD           WDPSAN           PS Adjustment N
     C           KLDLSZ    CHAIN@I9CPUU              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI9CPL0'MDACP
     C                     MOVEL'@I9CPUU' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SZEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@I9CPUU                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * DBF delete successful
      * USER: Processing after Data update
     C                     Z-ADDWDPIAD    WN0458           Quantity Adjust
      * BPS Setup Item Info   IF
      *
     C                     Z-ADD*ZERO     WN0463 155       System Value Nu
      *
      * UPS Rtv Company/Item  IF
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0001           Company Number
     C                     Z-ADD#1HGCD    WL0002           Item Code
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    WUAVNA    P      Description Lin
     C                     MOVELWL0004    WUADCD    P      U/M - Primary
     C                     Z-ADDWL0005    WN0451           Unit Weight
     C                     Z-ADDWL0006    WURINB           Item Structure
     C                     Z-ADDWL0007    WURHNB           Item Structure
     C                     Z-ADDWL0008    WURGNB           Item Structure
     C                     MOVELWL0009    WUN0CD    P      Item Type Code
     C                     MOVELWL0010    WUQ1CD    P      Default Warehou
     C                     Z-ADDWL0011    WN0452           Fresh Chilling
     C                     MOVELWL0012    WUQZCD    P      Base/Conv/Loss
     C                     MOVELWL0013    WUXWST    P      Variety/Rendere
     C                     MOVELWL0014    WUVMST    P      Credit Item Sta
     C                     Z-ADDWL0015    WUSWGH           Std Weight/Head
     C                     Z-ADDWL0016    WUPPHE           Pieces Per Head
     C                     MOVELWL0017    WUR3CD    P      Department Code
     C                     MOVELWL0018    WUSDCD    P      Group for Packa
     C                     MOVELWL0019    WUX5ST    P      Seconds Item
     C                     MOVELWL0020    WN0453    P      Piece Count Ite
     C                     Z-ADDWL0021    WN0454           Pieces Per Bag
     C                     Z-ADDWL0022    WN0455           Bags Per Unit
     C                     MOVELWL0023    WUSUST    P      Export/Domestic
     C                     MOVELWL0024    WUSVST    P      Print On Schedu
     C                     MOVELWL0025    WUSYST    P      Fresh Inv Alloc
     C                     MOVELWL0026    WUSZST    P      Fresh Sched As
     C                     MOVELWL0027    WUS1ST    P      Frozen Inv Allo
     C                     MOVELWL0028    WUXRCD    P      Primal Group Co
      * BPS Rtv Whs Info      RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1AJCD    WL0029    P      Warehouse Code
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0030    WUWPST    P      Warehouse Type
     C                     MOVELWL0031    WUXUST    P      Trans Contol AS
     C                     MOVELWL0032    WUT0ST    P      Warehouse Locat
     C                     MOVELWL0033    WN0456    P      Warehouse Std C
     C                     Z-ADDWL0034    WN0457           Warehouse Chill
      * BPS Set Up Item Id    IF
      * CASE: PAR.Item Type Code is Raw Materials
     C           WUN0CD    IFEQ 'RM'                       *IF
     C                     MOVEL'RMB'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Seconds Item is Yes
     C           WUX5ST    IFEQ 'Y'                        *IF
     C                     MOVEL'FSC'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Variety/Rendered/Cut is Variety
     C           WUXWST    IFEQ 'V'                        *IF
     C                     MOVEL'FVR'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Rendered
     C           WUXWST    IFEQ 'R'                        *IF
     C                     MOVEL'FRD'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Cut
     C           WUXWST    IFEQ 'C'                        *IF
      * Base/Converted/Fabricated
      * CASE: PAR.Credit Item Status is yes
     C           WUVMST    IFEQ 'Y'                        *IF
      * Setup Base/Converted/Fabricated Credit
      * CASE: PAR.Converted/Base Item is Base
     C           WUQZCD    IFEQ 'B'                        *IF
     C                     MOVEL'FBC'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WUQZCD    IFEQ 'C'                        *IF
     C                     MOVEL'FCC'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WUQZCD    IFEQ 'F'                        *IF
     C                     MOVEL'FFC'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WUQZCD    IFEQ 'L'                        *IF
     C                     MOVEL'FLC'     WUWCST           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup Base/Converted/Fabricated
      * CASE: PAR.Converted/Base Item is Base
     C           WUQZCD    IFEQ 'B'                        *IF
     C                     MOVEL'FGB'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WUQZCD    IFEQ 'C'                        *IF
     C                     MOVEL'FCV'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WUQZCD    IFEQ 'F'                        *IF
     C                     MOVEL'FFB'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WUQZCD    IFEQ 'L'                        *IF
     C                     MOVEL'FLS'     WUWCST           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Determine Production Type
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           #1ELDT    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       WN0462           Production Type
      * Val Sched Existance   RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0035           Company Number
     C                     MOVELWN0462    WL0036    P      Production Type
     C                     Z-ADD#1ELDT    WL0037           Production Date
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0038    WUWXST    P      Record Found US
      * Set to Plan if record not found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'P'       WN0462           Production Type
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Production Date GT JOB.*Job date
     C           #1ELDT    IFGT ##JDT                      *IF
     C                     MOVEL'P'       WN0462           Production Type
     C                     END                             *FI
     C                     END                             *FI
      * Update Production
      * CASE: PAR.PS Adjustment Type is Ship Cut
     C           #1PSAD    IFEQ 'SC'                       *IF
     C           *ZERO     SUB  WN0458    WUPIAD           PS Adjustment Q
      * Adjustment Weight/Pieces
      * CASE: PAR.Piece Count Item is yes
     C           WN0453    IFEQ 'Y'                        *IF
      * Rtv Avg Piece Wgt     RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0047           Company Number
     C                     MOVELWN0462    WL0048    P      Production Type
     C                     Z-ADD#1ELDT    WL0049           Production Date
     C                     Z-ADD#1HGCD    WL0050           Item Code
     C                     MOVEL#1AJCD    WL0051    P      Warehouse Code
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0052    WUF8WG           PS Avg Piece Wg
     C           WUPIAD    MULT WUF8WG    WUE0WG           PS Weight Ship
      * Pieces
      * WRK.PS Pieces Ship Cut Adj =
      *    *COMPUTE (x1 * x2 * x3)
      * x1    : WRK.PS Adjustment Quantity
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Bags Per Unit
     C           WUPIAD    MULT WN0454    W0WJ01           *Synon (15,0) w
     C           W0WJ01    MULT WN0455    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WUD6NB           PS Pieces Ship
     C                     ELSE
      * CASE: *OTHERWISE
     C           WUPIAD    MULT WN0451    WUE0WG           PS Weight Ship
     C                     Z-ADD*ZERO     WUD6NB           PS Pieces Ship
     C                     END                             *FI
      * Upd Ship Cut Adjust   RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0154           Company Number
     C                     MOVELWN0462    WL0155    P      Production Type
     C                     Z-ADD#1ELDT    WL0156           Production Date
     C                     Z-ADD#1HGCD    WL0157           Item Code
     C                     MOVEL#1AJCD    WL0158    P      Warehouse Code
     C                     Z-ADDWUE0WG    WL0159           PS Weight Ship
     C                     Z-ADDWUD6NB    WL0160           PS Pieces Ship
     C                     EXSR STRVGN
     C                     ELSE
      * CASE: PAR.PS Adjustment Type is Forecast
     C           #1PSAD    IFEQ 'FC'                       *IF
      * UPD Dealloc One FC Adj RT - PS Production Adjustment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0161           Company Number
     C                     Z-ADDWDELDT    WL0162           Production Date
     C                     Z-ADDWDHGCD    WL0163           Item Code
     C                     MOVELWDAJCD    WL0164    P      Warehouse Code
     C                     MOVELWDPSAD    WL0165    P      PS Adjustment T
     C                     Z-ADDWDPSAN    WL0166           PS Adjustment N
     C                     Z-ADDWN0458    WL0167           PS Adjustment Q
     C                     MOVELWN0462    WL0168    P      Production Type
     C                     EXSR SWRVGN
      * UPD Alloc One FC Adj  RT - PS Production Adjustment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0169           Company Number
     C                     Z-ADDWDELDT    WL0170           Production Date
     C                     Z-ADDWDHGCD    WL0171           Item Code
     C                     MOVELWDAJCD    WL0172    P      Warehouse Code
     C                     MOVELWDPSAD    WL0173    P      PS Adjustment T
     C                     Z-ADDWDPSAN    WL0174           PS Adjustment N
     C                     Z-ADD*ZERO     WL0175           PS Adjustment Q
     C                     MOVELWN0462    WL0176    P      Production Type
     C                     EXSR SXRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C           *ZERO     SUB  WN0458    WUPIAD           PS Adjustment Q
      * UPD Avail-To-Sell  SCH XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDTRXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0049  30       Company Number
     C                     PARM #1ELDT    WQ0050  70       Production Date
     C                     PARM #1HGCD    WQ0051  70       Item Code
     C                     PARM #1AJCD    WQ0052  3        Warehouse Code
     C                     PARM WUPIAD    WQ0053  50       PS Adjustment Q
     C                     PARM 'SA'      WQ0054  2        ATS Adj Type US
     C                     PARM WN0462    WQ0055  1        Production Type
     C                     PARM #1PSAN    WQ0056  50       PS Adjustment N
     C           WURCAU    PARM *BLANK    WQ0057  3        Return Code ATS
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDTRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CASE: WRK.Return Code ATS USR is BOM Not Found
     C           WURCAU    IFEQ 'BNF'                      *IF
      * Setup message data for message
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0010           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0010           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'PS BOM Does not Exist'
     C                     MOVEL'USR2057' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0464    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSTA     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI6ST    P2I6ST           Allow Multi-Com
     C                     MOVELDRMPNA    P2MPNA           Default Printer
     C                     MOVELDRBCCD    P2BCCD           Salesperson Cod
     C                     Z-ADDDRAIC3    YL0023           Company Number
     C                     MOVELDRBUVN    WN0465           User Code Model
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0177    DTAJVN           User Profile Na
     C                     MOVELWL0178    DTDNCD           Application Cod
      * Establish starting position
     C           KRSTB     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0179           Company Number
     C                     MOVELDTAJCD    WL0180           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQTC01           Application Cod
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WQTC01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQTC01           Application Cod
     C                     MOVEL'P/S'     WQTC01           Application Cod
      * Establish starting position
     C           KRSTC     SETLL@DNRESF                    *
     C           KRSTC     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR TDRVGN
     C                     END                             *FI
     C           KRSTC     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQTD01           Application Cod
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WQTD01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQTD01           Application Cod
      * Establish starting position
     C           KRSTD     SETLL@DNRESF                    *
     C           KRSTD     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSTD     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C                     MOVELV2AIC3    WK1X01  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#2AIC3'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(CTL) #2AIC3' defaulted for 'Company Number'.
     C                     CALL 'PDL7SRR'              90  SEL Co - Rtn 0
     C                     PARM *BLANK    W0RTN   7
     C           #2AIC3    PARM #2AIC3    WQ0058  30       Company Number
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDL7SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #2AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VA999
     C                     END
     C                     END
      *................................................................
      *
     C           KLVAWG    KLIST
     C                     KFLD           WGAIC3           Company Number
      * Setup key
     C                     Z-ADD#2AIC3    WGAIC3
     C           KLVAWG    CHAIN@ABREAK              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VAEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VAEXIT
     C                     END
     C           VA999     TAG
      * Restrictor relation not satisfied
      * Send message 'Company Name and Addre NF'
     C                     MOVEL'USR0003' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'USR0003' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C                     MOVEL#2AJCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Warehouse Code
     C           YPMTFD    OREQ '#2AJCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(CTL) #2AJCD' defaulted for 'Warehouse Code'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(CON) *ZERO' defaulted for 'Accounting Company'.
     C                     CALL 'PMCQSRR'              90  SEL AcctCo/Ware
     C                     PARM *BLANK    W0RTN   7
     C           #2AJCD    PARM #2AJCD    WQ0059  3        Warehouse Code
     C                     PARM *ZERO     WQ0060  30       Accounting Comp
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCQSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #2AJCD    IFNE *BLANK                     Warehouse Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VB999
     C                     END
     C                     END
      *................................................................
      *
     C           KLVBWB    KLIST
     C                     KFLD           WBAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#2AJCD    WBAJCD
     C           KLVBWB    CHAIN@ADREAO              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
     C           VB999     TAG
      * Restrictor relation not satisfied
      * Send message 'Warehouse              NF'
     C                     MOVEL'USR0007' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'USR0007' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C           ZINPOS    IFGE 03072
     C           ZINPOS    ANDLE05376
      * Cursor in the subfile record area
      * Reset cursor position to the basic (first) record for lookup
     C           W0CRW     SUB  12        W0CSRR  50
     C           03072     ADD  W0CCL     ZINPOS
      * Calculate rrn of the cursor position
     C                     ADD  ##SFRC    W0CSRR
     C                     ENDIF
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
     C           W0CFL     IFEQ *BLANK
     C                     Z-ADD0         W0CSRR
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD12        ZHSTRW  40
     C                     Z-ADD20        ZHNDRW  40
     C                     Z-ADD1         ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
     C                     END
      *
     C           ZHCSRW    IFEQ 011
     C           ZHCSCL    ANDEQ002
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#COPTI'  YPMTFD           Select Option
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              92    *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P2DNCD           Application Cod
     C                     MOVEL*BLANK    P2DQCD           Enterprise Code
     C                     MOVEL*BLANK    P2DRCD           Enterprise Code
     C                     MOVEL*BLANK    P2BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P2B8NA           System Date For
     C                     MOVEL*BLANK    P2AJVN           User Profile Na
     C                     MOVEL*BLANK    P2I6ST           Allow Multi-Com
     C                     MOVEL*BLANK    P2I8ST           Allow Multi War
     C                     MOVEL*BLANK    P2MPNA           Default Printer
     C                     MOVEL*BLANK    P2TAST           First Time Flag
     C                     MOVEL*BLANK    P2ADTX           Name
     C                     MOVEL*BLANK    P2BXTX           System Value Al
     C                     MOVEL*BLANK    P2WVST           Access Denied (
     C                     Z-ADD*ZERO     P2EIDT           Requested Deliv
     C                     MOVEL*BLANK    P2ICL            *Initial call
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Description Line Two
     C                     MOVEL*BLANK    WUAWNA 30
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Description Line One
     C                     MOVEL*BLANK    WUAVNA 30
      * Define work field U/M - Primary
     C                     MOVEL*BLANK    WUADCD  2
      * Define work field Item Structure Class Code
     C                     Z-ADD*ZERO     WURINB  30
      * Define work field Item Structure Group Code
     C                     Z-ADD*ZERO     WURHNB  30
      * Define work field Item Structure Type Code
     C                     Z-ADD*ZERO     WURGNB  30
      * Define work field Item Type Code
     C                     MOVEL*BLANK    WUN0CD  3
      * Define work field Default Warehouse
     C                     MOVEL*BLANK    WUQ1CD  3
      * Define work field Base/Conv/Loss Item
     C                     MOVEL*BLANK    WUQZCD  2
      * Define work field Variety/Rendered/Cut
     C                     MOVEL*BLANK    WUXWST  1
      * Define work field Credit Item Status
     C                     MOVEL*BLANK    WUVMST  1
      * Define work field Std Weight/Head (Var/Ren)
     C                     Z-ADD*ZERO     WUSWGH 112
      * Define work field Pieces Per Head
     C                     Z-ADD*ZERO     WUPPHE  70
      * Define work field Department Code
     C                     MOVEL*BLANK    WUR3CD  6
      * Define work field Group for Packaging
     C                     MOVEL*BLANK    WUSDCD  1
      * Define work field Seconds Item
     C                     MOVEL*BLANK    WUX5ST  1
      * Define work field Export/Domestic
     C                     MOVEL*BLANK    WUSUST  1
      * Define work field Print On Schedule
     C                     MOVEL*BLANK    WUSVST  1
      * Define work field Fresh Inv Allocation Seq
     C                     MOVEL*BLANK    WUSYST  1
      * Define work field Fresh Sched As Ordered
     C                     MOVEL*BLANK    WUSZST  1
      * Define work field Frozen Inv Allocation Seq
     C                     MOVEL*BLANK    WUS1ST  1
      * Define work field Primal Group Code
     C                     MOVEL*BLANK    WUXRCD  6
      * Define work field Warehouse Type
     C                     MOVEL*BLANK    WUWPST  2
      * Define work field Trans Contol AS400/Plant
     C                     MOVEL*BLANK    WUXUST  1
      * Define work field Warehouse Location
     C                     MOVEL*BLANK    WUT0ST  1
      * Define work field PS Item Id
     C                     MOVEL*BLANK    WUWCST  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WAAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WAAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WAAIWG           Unit Weight
     C                     Z-ADD*ZERO     WACZWG           Minimum Weight
     C                     Z-ADD*ZERO     WAC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WAURTN           Number Cases On
     C                     Z-ADD*ZERO     WAAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WATFNB           Transportation
     C                     Z-ADD*ZERO     WATMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WATNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WABLPR           Market Overage
     C                     Z-ADD*ZERO     WABMPR           Standard Overag
     C                     Z-ADD*ZERO     WACMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WACHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WASWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WAPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WAICN1           Item Category N
     C                     Z-ADD*ZERO     WAICN2           Item Category N
     C                     Z-ADD*ZERO     WAV2NB           Item Category N
     C                     Z-ADD*ZERO     WAITCN           Item Category N
     C                     Z-ADD*ZERO     WAITC5           Item Category N
     C                     Z-ADD*ZERO     WAICN6           Item Category N
     C                     Z-ADD*ZERO     WAICN7           Item Category N
     C                     Z-ADD*ZERO     WAICN8           Item Category N
     C                     Z-ADD*ZERO     WAICN9           Item Category N
     C                     Z-ADD*ZERO     WAICN0           Item Category N
     C                     Z-ADD*ZERO     WASFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WAA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WASJNB           Production Lead
     C                     Z-ADD*ZERO     WASKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WASLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WASMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WACFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WACGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WAILNB           PM % 2nds Facto
     C                     Z-ADD*ZERO     WACHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WACINB           PM Batch Size
     C                     Z-ADD*ZERO     WACJNB           PM Lot Size
     C                     Z-ADD*ZERO     WACMNB           Partial Item Co
     C                     Z-ADD*ZERO     WACNNB           WIP Item Code
     C                     Z-ADD*ZERO     WACRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WACSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WACVNB           FP Std Green We
     C                     Z-ADD*ZERO     WACWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WACXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WACZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WAC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WAB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WAB5NB           PM Line Number
     C                     Z-ADD*ZERO     WABDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WABJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WAF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WAF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WAF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WABLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WABNNB           Production Qty
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WBBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WBBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WBBUC3           WHS Unused Comp
     C                     Z-ADD*ZERO     WBBVC3           WHS Unused Comp
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field Record Found USR
     C                     MOVEL*BLANK    WUWXST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCELDT           Production Date
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCPSAN           PS Adjustment N
     C                     Z-ADD*ZERO     WCPIAD           PS Adjustment Q
     C                     Z-ADD*ZERO     WCD8C7           PS Consumed Ite
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field PS Adjustment Status
     C                     MOVEL*BLANK    WUV6ST  1
      * Define work field EDI Status 1
     C                     MOVEL*BLANK    WUUVST  1
      * Define work field EDI Status 2
     C                     MOVEL*BLANK    WUUWST  1
      * Define work field EDI Status 3
     C                     MOVEL*BLANK    WUUXST  1
      * Define work field Record Status
     C                     MOVEL*BLANK    WUVSST  1
      * Clear all neither parameters
      * Crt Prod. Adjustment  CR - PS Production Adjustment  * 
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field Return Code ATS USR
     C                     MOVEL*BLANK    WURCAU  3
      * Define work field PS Avg Piece Wgt
     C                     Z-ADD*ZERO     WUF8WG  92
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEELDT           Production Date
     C                     Z-ADD*ZERO     WEHGCD           Item Code
     C                     Z-ADD*ZERO     WEGPDT           PS Available Sh
     C                     Z-ADD*ZERO     WEWTSP           PS Weight Plann
     C                     Z-ADD*ZERO     WEQTSP           PS Pieces Plann
     C                     Z-ADD*ZERO     WEDJPC           PS % of Carcass
     C                     Z-ADD*ZERO     WEF8WG           PS Avg Piece Wg
     C                     Z-ADD*ZERO     WEWTIN           PS Weight Inv O
     C                     Z-ADD*ZERO     WED5NB           PS Pieces Inv O
     C                     Z-ADD*ZERO     WEDXWG           PS Weight Stand
     C                     Z-ADD*ZERO     WEB2NB           PS Pieces Stand
     C                     Z-ADD*ZERO     WEWTCN           PS Weight Conve
     C                     Z-ADD*ZERO     WEPSCV           PS Pieces Conve
     C                     Z-ADD*ZERO     WESAWT           PS Weight Shipp
     C                     Z-ADD*ZERO     WEB9NB           PS Pieces Shipp
     C                     Z-ADD*ZERO     WED1WG           PS Weight Prod
     C                     Z-ADD*ZERO     WECBNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WEEZWG           PS Weight Inv A
     C                     Z-ADD*ZERO     WECCNB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WEE0WG           PS Weight Ship
     C                     Z-ADD*ZERO     WED6NB           PS Pieces Ship
     C                     Z-ADD*ZERO     WEOAWT           PS Weight Prod
     C                     Z-ADD*ZERO     WECDNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WEUNW2           PS Weight Inv A
     C                     Z-ADD*ZERO     WECENB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WEF9WG           PS Unit Weight
     C                     Z-ADD*ZERO     WEBPNB           PS Pieces Whse
     C                     Z-ADD*ZERO     WEGAWG           PS Weight Whse
     C                     Z-ADD*ZERO     WEBQNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WEGBWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WEBRNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WEGCWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WEBSNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WEGDWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WEBWNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WEGEWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WEPS6U           PS Pieces Unuse
     C                     Z-ADD*ZERO     WEDVWG           PS Weight Order
     C                     Z-ADD*ZERO     WED7NB           PS Pieces Order
     C                     Z-ADD*ZERO     WEFCAD           PS Weight FC Ad
     C                     Z-ADD*ZERO     WED9NB           PS Pieces FC Ad
     C                     Z-ADD*ZERO     WEDWWG           PS Weight FX Ad
     C                     Z-ADD*ZERO     WEEANB           PS Pieces FX Ad
     C                     Z-ADD*ZERO     WESHWT           PS Weight Sched
     C                     Z-ADD*ZERO     WEEBNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WEAVWT           PS Weight Avail
     C                     Z-ADD*ZERO     WEECNB           PS Pieces Avail
     C                     Z-ADD*ZERO     WEWTON           PS Weight Produ
     C                     Z-ADD*ZERO     WEEDNB           PS Pieces Produ
     C                     Z-ADD*ZERO     WEFNWT           PS Weight Fab N
     C                     Z-ADD*ZERO     WEEENB           PS Pieces Fab N
     C                     Z-ADD*ZERO     WEQTAS           PS Weight Sched
     C                     Z-ADD*ZERO     WEEFNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WEWAIO           PS Weight Sched
     C                     Z-ADD*ZERO     WEEGNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WERGNB           Item Structure
     C                     Z-ADD*ZERO     WERHNB           Item Structure
     C                     Z-ADD*ZERO     WERINB           Item Structure
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Define work field Unit Weight
     C                     Z-ADD*ZERO     WUAIWG 112
      * Define work field Fresh Chilling Time
     C                     Z-ADD*ZERO     WUCHTM  52
      * Define work field Pieces Per Bag
     C                     Z-ADD*ZERO     WUBDNB  70
      * Define work field Bags Per Unit
     C                     Z-ADD*ZERO     WUBJNB  70
      * Define work field Warehouse Std Chill Time
     C                     MOVEL*BLANK    WUT1ST  1
      * Define work field Warehouse Chill Time
     C                     Z-ADD*ZERO     WUDBNB  52
      * Define work field Count USR
     C                     Z-ADD*ZERO     WUCNTU  50
      * Define work field OD Weight Scheduled
     C                     Z-ADD*ZERO     WUFLWG 112
      * Define work field PS Adjustment Quantity
     C                     Z-ADD*ZERO     WUPIAD  50
      * Define work field PS Weight Ship Cut Adj
     C                     Z-ADD*ZERO     WUE0WG  92
      * Define work field PS Pieces Ship Cut Adj
     C                     Z-ADD*ZERO     WUD6NB  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0WA02 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WJ02 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WJ01 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WJ00 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003 30
     C                     MOVEL*BLANK    WL0004  2
     C                     Z-ADD*ZERO     WL0005 112
     C                     Z-ADD*ZERO     WL0006  30
     C                     Z-ADD*ZERO     WL0007  30
     C                     Z-ADD*ZERO     WL0008  30
     C                     MOVEL*BLANK    WL0009  3
     C                     MOVEL*BLANK    WL0010  3
     C                     Z-ADD*ZERO     WL0011  52
     C                     MOVEL*BLANK    WL0012  2
     C                     MOVEL*BLANK    WL0013  1
     C                     MOVEL*BLANK    WL0014  1
     C                     Z-ADD*ZERO     WL0015 112
     C                     Z-ADD*ZERO     WL0016  70
     C                     MOVEL*BLANK    WL0017  6
     C                     MOVEL*BLANK    WL0018  1
     C                     MOVEL*BLANK    WL0019  1
     C                     MOVEL*BLANK    WL0020  1
     C                     Z-ADD*ZERO     WL0021  70
     C                     Z-ADD*ZERO     WL0022  70
     C                     MOVEL*BLANK    WL0023  1
     C                     MOVEL*BLANK    WL0024  1
     C                     MOVEL*BLANK    WL0025  1
     C                     MOVEL*BLANK    WL0026  1
     C                     MOVEL*BLANK    WL0027  1
     C                     MOVEL*BLANK    WL0028  6
      * Define local variables for subroutine SHRVGN.
     C                     MOVEL*BLANK    WL0029  3
     C                     MOVEL*BLANK    WL0030  2
     C                     MOVEL*BLANK    WL0031  1
     C                     MOVEL*BLANK    WL0032  1
     C                     MOVEL*BLANK    WL0033  1
     C                     Z-ADD*ZERO     WL0034  52
      * Define local variables for subroutine SIRVGN.
     C                     Z-ADD*ZERO     WL0035  30
     C                     MOVEL*BLANK    WL0036  1
     C                     Z-ADD*ZERO     WL0037  70
     C                     MOVEL*BLANK    WL0038  1
      * Define local variables for subroutine SJRVGN.
     C                     Z-ADD*ZERO     WL0039  30
     C                     MOVEL*BLANK    WL0040  1
     C                     Z-ADD*ZERO     WL0041  70
     C                     Z-ADD*ZERO     WL0042  70
     C                     MOVEL*BLANK    WL0043  3
     C                     Z-ADD*ZERO     WL0044  92
     C                     Z-ADD*ZERO     WL0045  70
     C                     MOVEL*BLANK    WL0046  3
      * Define local variables for subroutine SMRVGN.
     C                     Z-ADD*ZERO     WL0047  30
     C                     MOVEL*BLANK    WL0048  1
     C                     Z-ADD*ZERO     WL0049  70
     C                     Z-ADD*ZERO     WL0050  70
     C                     MOVEL*BLANK    WL0051  3
     C                     Z-ADD*ZERO     WL0052  92
      * Define local variables for subroutine SOCRRC.
     C                     Z-ADD*ZERO     WL0053  30
     C                     MOVEL*BLANK    WL0054  1
     C                     Z-ADD*ZERO     WL0055  70
     C                     Z-ADD*ZERO     WL0056  70
     C                     MOVEL*BLANK    WL0057  3
     C                     Z-ADD*ZERO     WL0058  70
     C                     Z-ADD*ZERO     WL0059  92
     C                     Z-ADD*ZERO     WL0060  70
     C                     Z-ADD*ZERO     WL0061  72
     C                     Z-ADD*ZERO     WL0062  92
     C                     Z-ADD*ZERO     WL0063  92
     C                     Z-ADD*ZERO     WL0064  70
     C                     Z-ADD*ZERO     WL0065  92
     C                     Z-ADD*ZERO     WL0066  70
     C                     Z-ADD*ZERO     WL0067  92
     C                     Z-ADD*ZERO     WL0068  70
     C                     Z-ADD*ZERO     WL0069  92
     C                     Z-ADD*ZERO     WL0070  70
     C                     Z-ADD*ZERO     WL0071  92
     C                     Z-ADD*ZERO     WL0072  70
     C                     Z-ADD*ZERO     WL0073  92
     C                     Z-ADD*ZERO     WL0074  70
     C                     Z-ADD*ZERO     WL0075  92
     C                     Z-ADD*ZERO     WL0076  70
     C                     Z-ADD*ZERO     WL0077  92
     C                     Z-ADD*ZERO     WL0078  70
     C                     Z-ADD*ZERO     WL0079  92
     C                     Z-ADD*ZERO     WL0080  70
     C                     Z-ADD*ZERO     WL0081 112
     C                     Z-ADD*ZERO     WL0082  70
     C                     Z-ADD*ZERO     WL0083 112
     C                     Z-ADD*ZERO     WL0084  70
     C                     Z-ADD*ZERO     WL0085 112
     C                     Z-ADD*ZERO     WL0086  70
     C                     Z-ADD*ZERO     WL0087 112
     C                     Z-ADD*ZERO     WL0088  70
     C                     Z-ADD*ZERO     WL0089 112
     C                     Z-ADD*ZERO     WL0090  70
     C                     Z-ADD*ZERO     WL0091 112
     C                     Z-ADD*ZERO     WL0092  70
     C                     MOVEL*BLANK    WL0093  3
     C                     MOVEL*BLANK    WL0094  2
     C                     MOVEL*BLANK    WL0095  1
     C                     MOVEL*BLANK    WL0096  1
     C                     MOVEL*BLANK    WL0097  1
     C                     MOVEL*BLANK    WL0098  1
     C                     MOVEL*BLANK    WL0099  1
     C                     MOVEL*BLANK    WL0100  1
     C                     MOVEL*BLANK    WL0101  1
     C                     MOVEL*BLANK    WL0102  1
     C                     MOVEL*BLANK    WL0103  2
     C                     MOVEL*BLANK    WL0104  3
     C                     Z-ADD*ZERO     WL0105  92
     C                     Z-ADD*ZERO     WL0106  70
     C                     Z-ADD*ZERO     WL0107  92
     C                     Z-ADD*ZERO     WL0108  70
     C                     Z-ADD*ZERO     WL0109  92
     C                     Z-ADD*ZERO     WL0110  70
     C                     Z-ADD*ZERO     WL0111  92
     C                     Z-ADD*ZERO     WL0112  70
     C                     Z-ADD*ZERO     WL0113  92
     C                     Z-ADD*ZERO     WL0114  70
     C                     Z-ADD*ZERO     WL0115  92
     C                     Z-ADD*ZERO     WL0116  70
     C                     Z-ADD*ZERO     WL0117  92
     C                     Z-ADD*ZERO     WL0118  70
     C                     Z-ADD*ZERO     WL0119  92
     C                     Z-ADD*ZERO     WL0120  70
     C                     Z-ADD*ZERO     WL0121  92
     C                     Z-ADD*ZERO     WL0122  70
     C                     MOVEL*BLANK    WL0123  6
     C                     Z-ADD*ZERO     WL0124  30
     C                     Z-ADD*ZERO     WL0125  30
     C                     Z-ADD*ZERO     WL0126  30
     C                     MOVEL*BLANK    WL0127  6
     C                     MOVEL*BLANK    WL0128  1
     C                     MOVEL*BLANK    WL0129  1
     C                     MOVEL*BLANK    WL0130  1
     C                     MOVEL*BLANK    WL0131  1
     C                     Z-ADD*ZERO     WL0132  60
     C                     MOVEL*BLANK    WL0133 10
     C                     MOVEL*BLANK    WL0134 10
     C                     Z-ADD*ZERO     WL0135  70
      * Define local variables for subroutine SQRVGN.
     C                     Z-ADD*ZERO     WL0136  30
     C                     Z-ADD*ZERO     WL0137  70
     C                     Z-ADD*ZERO     WL0138  52
     C                     Z-ADD*ZERO     WL0139  70
      * Define local variables for subroutine SRCHRC.
     C                     Z-ADD*ZERO     WL0140  30
     C                     MOVEL*BLANK    WL0141  1
     C                     Z-ADD*ZERO     WL0142  70
     C                     Z-ADD*ZERO     WL0143  70
     C                     MOVEL*BLANK    WL0144  3
     C                     Z-ADD*ZERO     WL0145  92
     C                     Z-ADD*ZERO     WL0146  92
     C                     Z-ADD*ZERO     WL0147  70
      * Define local variables for subroutine SSRVGN.
     C                     Z-ADD*ZERO     WL0148  30
     C                     Z-ADD*ZERO     WL0149  70
     C                     MOVEL*BLANK    WL0150  3
     C                     Z-ADD*ZERO     WL0151  70
     C                     Z-ADD*ZERO     WL0152 112
     C                     Z-ADD*ZERO     WL0153 112
      * Define local variables for subroutine STRVGN.
     C                     Z-ADD*ZERO     WL0154  30
     C                     MOVEL*BLANK    WL0155  1
     C                     Z-ADD*ZERO     WL0156  70
     C                     Z-ADD*ZERO     WL0157  70
     C                     MOVEL*BLANK    WL0158  3
     C                     Z-ADD*ZERO     WL0159  92
     C                     Z-ADD*ZERO     WL0160  70
      * Define local variables for subroutine SWRVGN.
     C                     Z-ADD*ZERO     WL0161  30
     C                     Z-ADD*ZERO     WL0162  70
     C                     Z-ADD*ZERO     WL0163  70
     C                     MOVEL*BLANK    WL0164  3
     C                     MOVEL*BLANK    WL0165  2
     C                     Z-ADD*ZERO     WL0166  50
     C                     Z-ADD*ZERO     WL0167  50
     C                     MOVEL*BLANK    WL0168  1
      * Define local variables for subroutine SXRVGN.
     C                     Z-ADD*ZERO     WL0169  30
     C                     Z-ADD*ZERO     WL0170  70
     C                     Z-ADD*ZERO     WL0171  70
     C                     MOVEL*BLANK    WL0172  3
     C                     MOVEL*BLANK    WL0173  2
     C                     Z-ADD*ZERO     WL0174  50
     C                     Z-ADD*ZERO     WL0175  50
     C                     MOVEL*BLANK    WL0176  1
      * Define local variables for subroutine TBRVGN.
     C                     MOVEL*BLANK    WL0177 10
     C                     MOVEL*BLANK    WL0178  6
     C                     Z-ADD*ZERO     WL0179  30
     C                     MOVEL*BLANK    WL0180  3
      * Define local work field First Time Flag
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Description Line One
     C                     MOVEL*BLANK    YL0002 30
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field Component Item Code
     C                     Z-ADD*ZERO     YL0004  70
      * Define local work field Production Day Status
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field Quantity Prod Avail USR
     C                     Z-ADD*ZERO     YL0006  61
      * Define local work field Unit Weight
     C                     Z-ADD*ZERO     YL0007 112
      * Define local work field Fresh Chilling Time
     C                     Z-ADD*ZERO     YL0008  52
      * Define local work field Piece Count Item
     C                     MOVEL*BLANK    YL0009  1
      * Define local work field Pieces Per Bag
     C                     Z-ADD*ZERO     YL0010  70
      * Define local work field Bags Per Unit
     C                     Z-ADD*ZERO     YL0011  70
      * Define local work field Warehouse Std Chill Time
     C                     MOVEL*BLANK    YL0012  1
      * Define local work field Warehouse Chill Time
     C                     Z-ADD*ZERO     YL0013  52
      * Define local work field Weight Production USR
     C                     Z-ADD*ZERO     YL0014  92
      * Define local work field Pieces Production USR
     C                     Z-ADD*ZERO     YL0015  70
      * Define local work field PS Production Warehouse
     C                     MOVEL*BLANK    YL0016  3
      * Define local work field Quantity Adjustment USR
     C                     Z-ADD*ZERO     YL0017  61
      * Define local work field PS Weight Standard
     C                     Z-ADD*ZERO     YL0018  92
      * Define local work field PS Pieces Standard
     C                     Z-ADD*ZERO     YL0019  70
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0020  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0021  3
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0022  30
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0023  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0024  3
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     Z-ADD09        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      *
     C                     MOVEL*BLANK    WN0464 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0464           User Profile Na
      *
     C                     MOVEL*BLANK    WN0465 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR TARVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0464    ZA0011           User Profile Na
     C                     MOVEL'P/S'     ZA0012           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0465    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0464    WL0177    P      User Profile Na
     C                     MOVEL'P/S'     WL0178    P      Application Cod
     C                     EXSR TBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0179    YL0022           Company Number
     C                     MOVELWL0180    YL0024    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0465    WL0177    P      User Profile Na
     C                     MOVEL'P/S'     WL0178    P      Application Cod
     C                     EXSR TBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0179    YL0022           Company Number
     C                     MOVELWL0180    YL0024    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0024    YL0021           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0464    ZA0013           User Profile Na
     C                     MOVEL'P/S'     ZA0014           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0023    IFNE *ZERO                      *IF
     C                     Z-ADDYL0023    YL0022           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0024    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           YL0021    PARM *BLANK    WQ0061  3        Warehouse Code
     C                     PARM YL0023    WQ0062  30       Shipping Compan
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR TCRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
     C                     MOVEL'Y'       YL0001           First Time Flag
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** W0BEG
01040010480129601304015520156002050
02818028200282402832028390284802857
030740307603080030880309503113
** W0END
01042010770130201333015540158902127
02818028210283002837028460285502893
030740307703086030930310203149
** W0NAM
V2AIC3    #CSQTX    V2D8C7    #COONA    #2AJCD    #CO6NA    **SPT
#COPTI    #2PSAD    V2HGCD    #2PIAD    V2ELDT    VCGWDT    #CP1NA
#1SEL     #1PSAD    V1HGCD    #RN1QT    V1ELDT    #RP1NA
