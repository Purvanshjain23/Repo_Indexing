     H/TITLE WW Picking Orders     DF  Display file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Displays the records from DBF as a subfile
     H* - Loads the SFL from the DBF a page at a time
     H* - The DBF record at which the SFL display starts may be
     H*   controlled by positioning fields on the SFL header
     H* - Any key fields on the SFL header will be used as
     H*   positioning values
     H* - Any non-key fields on the SFL header will be used as
     H*   selection values: a maximum of W0SLM records will be
     H*   read from the DBF before giving up
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Display file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISPJAKH
     H* Date          : 04/12/24  Time  : 09:18:10
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDH5DFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: WW Picking Orders     DF  Display file
      *
     FOPBFCPOBIF  E           K        DISK
     F                                              KINFDS INFDS1
      * RSQ : Order Header TRG          Ld/Ord -Avail for Pick
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FOPEYCPL9IF  E           K        DISK
      * RSQ : Order Events              Co/Order/Event Code
      *
     FPDL8CPL1IF  E           K        DISK
      * RTV : Order Inv Allocation      Retrieval index
      *
     FOPEYCPL7IF  E           K        DISK
      * RSQ : Order Events              Customer/Order/Event Cod
      *
     FOPEYCPL1IF  E           K        DISK
      * RTV : Order Events              Retrieval index       NV
      *
     FOMFLCPL4IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop(Desc)/Order
      *
     FPDL5CPL5IF  E           K        DISK
      * RSQ : Item Lot Location         Co/Itm/Whs/ASD/Lt/Lc
      *
     FPDL8CPL2IF  E           K        DISK
      * RSQ : Order Inv Allocation      Co/Itm/Whs/PDte/Lt/Lc/Lv
      *
     FPDL8CPL3IF  E           K        DISK
      * RSQ : Order Inv Allocation      Co/Ord/Seq/Seq2/ASeq(d)
      *
     FPPBUREL1IF  E           K        DISK
      * RTV : PFS Interface             Retrieval index
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FOPEYCPL4IF  E           K        DISK
      * RSQ : Order Events              Co/Order/Evt#(d)
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPPAQREL1IF  E           K        DISK
      * RTV : Company Document Defaults Retrieval index
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FPDL8CPL0UF  E           K        DISK                      A
      * UPD : Order Inv Allocation      Update index
      *
     FOPEYCPL0UF  E           K        DISK                      A
      * UPD : Order Events              Update index
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     E                    J7          7  1
     E                    K7          7  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    J3          3  1
     E                    K3          3  1
      * RIGHT JUSTIFY INPUT FIELD
      * Days in month for date validation
     E                    @XD    12  12  2 0
     E                    #L7         7  1
     E                    #L3         3  1
     E                    UCT        40  1               CENTER TABLE
      * Screen: Field position and name array
     E                    W0BEG   7 029  5 0A
     E                    W0END   7 029  5 0A
     E                    W0NAM   7 029 10
      * Long constants
     E                    @CN#    1  05  6   @CN    25
     I@L8CPSX
      * Order Inv Allocation      Update index
      * Renamed input format fields
     I              L8AIC3                          WAAIC3
     I              L8C4NB                          WAC4NB
     I              L8DPNB                          WADPNB
     I              L8UENB                          WAUENB
     I              L8ALSW                          WAALSW
     I              L8J6QT                          WAJ6QT
     I              L8G9WG                          WAG9WG
     I              L8J9QT                          WAJ9QT
     I              L8HAWG                          WAHAWG
     I              L8IOSE                          WAIOSE
     I              L8OIMN                          WAOIMN
     I              L8SOAS                          WASOAS
     I              L8ARSX                          WAARSX
     I              L8OTUS                          WAOTUS
     I              L8OTMP                          WAOTMP
     I              L8HGCD                          WAHGCD
     I              L8AJCD                          WAAJCD
     I              L8ELDT                          WAELDT
     I              L8LXNM                          WALXNM
     I              L8YMCD                          WAYMCD
     I              L8YNCD                          WAYNCD
     I              L8UVST                          WAUVST
     I              L8UWST                          WAUWST
     I              L8UXST                          WAUXST
     I              L8VSST                          WAVSST
     I              L8AATM                          WAAATM
     I              L8AYNA                          WAAYNA
     I              L8A0NA                          WAA0NA
     I              L8AXDT                          WAAXDT
      *
     I@EYCPEH
      * Order Events              Customer/Order/Event Cod
      * Renamed input format fields
     I              EYAIC3                          WBAIC3
     I              EYC4NB                          WBC4NB
     I              EYQ2NB                          WBQ2NB
     I              EYJPCD                          WBJPCD
     I              EYAUC3                          WBAUC3
     I              EYQ7NB                          WBQ7NB
     I              EYOMST                          WBOMST
     I              EYD2DT                          WBD2DT
     I              EYONST                          WBONST
     I              EYOOST                          WBOOST
     I              EYOPST                          WBOPST
     I              EYAWC3                          WBAWC3
     I              EYQ8NB                          WBQ8NB
     I              EYQ9NB                          WBQ9NB
     I              EYBKC7                          WBBKC7
     I              EYUVST                          WBUVST
     I              EYUWST                          WBUWST
     I              EYUXST                          WBUXST
     I              EYAATM                          WBAATM
     I              EYAYNA                          WBAYNA
     I              EYA0NA                          WBA0NA
     I              EYAXDT                          WBAXDT
      *
     I@EYCPY3
      * Order Events              Update index
      * Renamed input format fields
     I              EYAIC3                          WCAIC3
     I              EYC4NB                          WCC4NB
     I              EYQ2NB                          WCQ2NB
     I              EYJPCD                          WCJPCD
     I              EYAUC3                          WCAUC3
     I              EYQ7NB                          WCQ7NB
     I              EYOMST                          WCOMST
     I              EYD2DT                          WCD2DT
     I              EYONST                          WCONST
     I              EYOOST                          WCOOST
     I              EYOPST                          WCOPST
     I              EYAWC3                          WCAWC3
     I              EYQ8NB                          WCQ8NB
     I              EYQ9NB                          WCQ9NB
     I              EYBKC7                          WCBKC7
     I              EYUVST                          WCUVST
     I              EYUWST                          WCUWST
     I              EYUXST                          WCUXST
     I              EYAATM                          WCAATM
     I              EYAYNA                          WCAYNA
     I              EYA0NA                          WCA0NA
     I              EYAXDT                          WCAXDT
      *
     I@EYCPY2
      * Order Events              Retrieval index       NV
      * Renamed input format fields
     I              EYAIC3                          WDAIC3
     I              EYC4NB                          WDC4NB
     I              EYQ2NB                          WDQ2NB
     I              EYJPCD                          WDJPCD
     I              EYAUC3                          WDAUC3
     I              EYQ7NB                          WDQ7NB
     I              EYOMST                          WDOMST
     I              EYD2DT                          WDD2DT
     I              EYONST                          WDONST
     I              EYOOST                          WDOOST
     I              EYOPST                          WDOPST
     I              EYAWC3                          WDAWC3
     I              EYQ8NB                          WDQ8NB
     I              EYQ9NB                          WDQ9NB
     I              EYBKC7                          WDBKC7
     I              EYUVST                          WDUVST
     I              EYUWST                          WDUWST
     I              EYUXST                          WDUXST
     I              EYAATM                          WDAATM
     I              EYAYNA                          WDAYNA
     I              EYA0NA                          WDA0NA
     I              EYAXDT                          WDAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WEAIC3
     I              BEC4NB                          WEC4NB
     I              BEJNCD                          WEJNCD
     I              BEANC7                          WEANC7
     I              BEBKC7                          WEBKC7
     I              BEBRTX                          WEBRTX
     I              BEHMNA                          WEHMNA
     I              BEHONA                          WEHONA
     I              BEHPNA                          WEHPNA
     I              BEHNNA                          WEHNNA
     I              BEDBCD                          WEDBCD
     I              BECKTX                          WECKTX
     I              BEB0C7                          WEB0C7
     I              BEAETX                          WEAETX
     I              BEB1NA                          WEB1NA
     I              BEB3NA                          WEB3NA
     I              BEB4NA                          WEB4NA
     I              BEB2NA                          WEB2NA
     I              BEBHCD                          WEBHCD
     I              BEC8TX                          WEC8TX
     I              BEBCNA                          WEBCNA
     I              BEA0DT                          WEA0DT
     I              BEA5DT                          WEA5DT
     I              BEGNDT                          WEGNDT
     I              BEACDT                          WEACDT
     I              BEAQCD                          WEAQCD
     I              BEB6NA                          WEB6NA
     I              BEBYNA                          WEBYNA
     I              BEBZNA                          WEBZNA
     I              BEGTST                          WEGTST
     I              BEGVST                          WEGVST
     I              BEGUST                          WEGUST
     I              BEQFST                          WEQFST
     I              BECQCD                          WECQCD
     I              BEGJST                          WEGJST
     I              BEGWST                          WEGWST
     I              BEGXST                          WEGXST
     I              BEGYST                          WEGYST
     I              BEAODT                          WEAODT
     I              BEAIVN                          WEAIVN
     I              BECXDT                          WECXDT
     I              BEJZVA                          WEJZVA
     I              BEA1WG                          WEA1WG
     I              BEXIST                          WEXIST
     I              BEXJST                          WEXJST
     I              BEXKST                          WEXKST
     I              BEEIDT                          WEEIDT
     I              BEAFTM                          WEAFTM
     I              BEE8CD                          WEE8CD
     I              BEE9CD                          WEE9CD
     I              BERMNB                          WERMNB
     I              BETBNB                          WETBNB
     I              BER1NB                          WER1NB
     I              BEPJST                          WEPJST
     I              BEU0ST                          WEU0ST
     I              BEU1ST                          WEU1ST
     I              BEQ2CD                          WEQ2CD
     I              BEU2ST                          WEU2ST
     I              BEVEST                          WEVEST
     I              BEVFST                          WEVFST
     I              BEVGST                          WEVGST
     I              BERPCD                          WERPCD
     I              BERNNB                          WERNNB
     I              BEVDST                          WEVDST
     I              BEATIN                          WEATIN
     I              BEU4ST                          WEU4ST
     I              BEU5ST                          WEU5ST
     I              BERSRN                          WERSRN
     I              BEMHNA                          WEMHNA
     I              BEMINA                          WEMINA
     I              BEWBST                          WEWBST
     I              BER4CD                          WER4CD
     I              BEBFCD                          WEBFCD
     I              BEQ4CD                          WEQ4CD
     I              BET3NB                          WET3NB
     I              BESICD                          WESICD
     I              BECONB                          WECONB
     I              BECEST                          WECEST
     I              BEAWDT                          WEAWDT
     I              BEJPCD                          WEJPCD
     I              BEXUST                          WEXUST
     I              BEZ1ST                          WEZ1ST
     I              BEVRVA                          WEVRVA
     I              BEOBST                          WEOBST
     I              BEBCST                          WEBCST
     I              BEBDST                          WEBDST
     I              BEB7VL                          WEB7VL
     I              BEGASX                          WEGASX
     I              BEGBSX                          WEGBSX
     I              BEGCSX                          WEGCSX
     I              BEGDSX                          WEGDSX
     I              BEFNSX                          WEFNSX
     I              BEFOSX                          WEFOSX
     I              BEFPSX                          WEFPSX
     I              BEFQSX                          WEFQSX
     I              BEFRSX                          WEFRSX
     I              BEFSSX                          WEFSSX
     I              BEFTSX                          WEFTSX
     I              BEFUSX                          WEFUSX
     I              BEFVSX                          WEFVSX
     I              BEFWSX                          WEFWSX
     I              BEFXSX                          WEFXSX
     I              BEFYSX                          WEFYSX
     I              BENODT                          WENODT
     I              BENPDT                          WENPDT
     I              BENQDT                          WENQDT
     I              BENRDT                          WENRDT
     I              BENSDT                          WENSDT
     I              BEBPTM                          WEBPTM
     I              BEBQTM                          WEBQTM
     I              BEBRTM                          WEBRTM
     I              BEBSTM                          WEBSTM
     I              BEBTTM                          WEBTTM
     I              BEH0NX                          WEH0NX
     I              BEH1NX                          WEH1NX
     I              BEH2NX                          WEH2NX
     I              BEH3NX                          WEH3NX
     I              BEH4NX                          WEH4NX
     I              BEC0C7                          WEC0C7
     I              BEUVST                          WEUVST
     I              BEUWST                          WEUWST
     I              BEUXST                          WEUXST
     I              BEAATM                          WEAATM
     I              BEAYNA                          WEAYNA
     I              BEA0NA                          WEA0NA
     I              BEAXDT                          WEAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WFAIC3
     I              OMC4NB                          WFC4NB
     I              OMDPNB                          WFDPNB
     I              OMUENB                          WFUENB
     I              OMHGCD                          WFHGCD
     I              OMAJCD                          WFAJCD
     I              OMBKC7                          WFBKC7
     I              OMCFC7                          WFCFC7
     I              OMGMST                          WFGMST
     I              OMGNST                          WFGNST
     I              OMMAVA                          WFMAVA
     I              OMKDVA                          WFKDVA
     I              OML8VA                          WFL8VA
     I              OML9VA                          WFL9VA
     I              OMGTST                          WFGTST
     I              OMGVST                          WFGVST
     I              OMGUST                          WFGUST
     I              OMQFST                          WFQFST
     I              OMAYVA                          WFAYVA
     I              OMEXDT                          WFEXDT
     I              OMLQCD                          WFLQCD
     I              OMRDCD                          WFRDCD
     I              OMQ7CD                          WFQ7CD
     I              OMBZPR                          WFBZPR
     I              OML6NB                          WFL6NB
     I              OMU1ST                          WFU1ST
     I              OMGIDT                          WFGIDT
     I              OMCRCD                          WFCRCD
     I              OMAGCD                          WFAGCD
     I              OMRZST                          WFRZST
     I              OMR0ST                          WFR0ST
     I              OMR1ST                          WFR1ST
     I              OMG7NA                          WFG7NA
     I              OMG8NA                          WFG8NA
     I              OMRPCD                          WFRPCD
     I              OMVEST                          WFVEST
     I              OMVGST                          WFVGST
     I              OMAVST                          WFAVST
     I              OMU0ST                          WFU0ST
     I              OMRFCD                          WFRFCD
     I              OMFZST                          WFFZST
     I              OMR1NB                          WFR1NB
     I              OMAVQT                          WFAVQT
     I              OMD0WG                          WFD0WG
     I              OMCCQT                          WFCCQT
     I              OMAUWG                          WFAUWG
     I              OMCBQT                          WFCBQT
     I              OMATWG                          WFATWG
     I              OMAQCS                          WFAQCS
     I              OMAGCS                          WFAGCS
     I              OMAKPR                          WFAKPR
     I              OMALPR                          WFALPR
     I              OMAUPR                          WFAUPR
     I              OMAVWG                          WFAVWG
     I              OMA4WG                          WFA4WG
     I              OMA5DT                          WFA5DT
     I              OMAODT                          WFAODT
     I              OMGNDT                          WFGNDT
     I              OMAMST                          WFAMST
     I              OMANST                          WFANST
     I              OMVAST                          WFVAST
     I              OMRGNB                          WFRGNB
     I              OMRHNB                          WFRHNB
     I              OMRINB                          WFRINB
     I              OMRBCD                          WFRBCD
     I              OMHICD                          WFHICD
     I              OMRNCD                          WFRNCD
     I              OMROCD                          WFROCD
     I              OMCXDT                          WFCXDT
     I              OMAJVN                          WFAJVN
     I              OMKXCD                          WFKXCD
     I              OMJPCD                          WFJPCD
     I              OMCQCD                          WFCQCD
     I              OMR4CD                          WFR4CD
     I              OMZ1ST                          WFZ1ST
     I              OMZ3ST                          WFZ3ST
     I              OMZ4ST                          WFZ4ST
     I              OMDUPR                          WFDUPR
     I              OMB6VL                          WFB6VL
     I              OMA1AA                          WFA1AA
     I              OMFZSX                          WFFZSX
     I              OMF0SX                          WFF0SX
     I              OMF1SX                          WFF1SX
     I              OMF2SX                          WFF2SX
     I              OMF3SX                          WFF3SX
     I              OMF4SX                          WFF4SX
     I              OMF5SX                          WFF5SX
     I              OMF6SX                          WFF6SX
     I              OMF7SX                          WFF7SX
     I              OMNTDT                          WFNTDT
     I              OMNUDT                          WFNUDT
     I              OMNVDT                          WFNVDT
     I              OMNWDT                          WFNWDT
     I              OMNXDT                          WFNXDT
     I              OMBUTM                          WFBUTM
     I              OMBVTM                          WFBVTM
     I              OMBWTM                          WFBWTM
     I              OMBXTM                          WFBXTM
     I              OMBYTM                          WFBYTM
     I              OMH5NX                          WFH5NX
     I              OMH6NX                          WFH6NX
     I              OMH7NX                          WFH7NX
     I              OMH8NX                          WFH8NX
     I              OMH9NX                          WFH9NX
     I              OMDVPR                          WFDVPR
     I              OMDWPR                          WFDWPR
     I              OMDXPR                          WFDXPR
     I              OMDYPR                          WFDYPR
     I              OMDZPR                          WFDZPR
     I              OMGSPR                          WFGSPR
     I              OMGTPR                          WFGTPR
     I              OMGUPR                          WFGUPR
     I              OMHOST                          WFHOST
     I              OMHPST                          WFHPST
     I              OMIOST                          WFIOST
     I              OMPEWG                          WFPEWG
     I              OMRINY                          WFRINY
     I              OMTIDT                          WFTIDT
     I              OMTJDT                          WFTJDT
     I              OMH2ST                          WFH2ST
     I              OMH0ST                          WFH0ST
     I              OMH1ST                          WFH1ST
     I              OMTKDT                          WFTKDT
     I              OMTLDT                          WFTLDT
     I              OMTMDT                          WFTMDT
     I              OMUVST                          WFUVST
     I              OMUWST                          WFUWST
     I              OMUXST                          WFUXST
     I              OMAATM                          WFAATM
     I              OMAYNA                          WFAYNA
     I              OMA0NA                          WFA0NA
     I              OMAXDT                          WFAXDT
      *
     I@L8CPTA
      * Order Inv Allocation      Co/Itm/Whs/PDte/Lt/Lc/Lv
      * Renamed input format fields
     I              L8AIC3                          WGAIC3
     I              L8C4NB                          WGC4NB
     I              L8DPNB                          WGDPNB
     I              L8UENB                          WGUENB
     I              L8ALSW                          WGALSW
     I              L8J6QT                          WGJ6QT
     I              L8G9WG                          WGG9WG
     I              L8J9QT                          WGJ9QT
     I              L8HAWG                          WGHAWG
     I              L8IOSE                          WGIOSE
     I              L8OIMN                          WGOIMN
     I              L8SOAS                          WGSOAS
     I              L8ARSX                          WGARSX
     I              L8OTUS                          WGOTUS
     I              L8OTMP                          WGOTMP
     I              L8HGCD                          WGHGCD
     I              L8AJCD                          WGAJCD
     I              L8ELDT                          WGELDT
     I              L8LXNM                          WGLXNM
     I              L8YMCD                          WGYMCD
     I              L8YNCD                          WGYNCD
     I              L8UVST                          WGUVST
     I              L8UWST                          WGUWST
     I              L8UXST                          WGUXST
     I              L8VSST                          WGVSST
     I              L8AATM                          WGAATM
     I              L8AYNA                          WGAYNA
     I              L8A0NA                          WGA0NA
     I              L8AXDT                          WGAXDT
      *
     I@L8CPTD
      * Order Inv Allocation      Co/Ord/Seq/Seq2/ASeq(d)
      * Renamed input format fields
     I              L8AIC3                          WHAIC3
     I              L8C4NB                          WHC4NB
     I              L8DPNB                          WHDPNB
     I              L8UENB                          WHUENB
     I              L8ALSW                          WHALSW
     I              L8J6QT                          WHJ6QT
     I              L8G9WG                          WHG9WG
     I              L8J9QT                          WHJ9QT
     I              L8HAWG                          WHHAWG
     I              L8IOSE                          WHIOSE
     I              L8OIMN                          WHOIMN
     I              L8SOAS                          WHSOAS
     I              L8ARSX                          WHARSX
     I              L8OTUS                          WHOTUS
     I              L8OTMP                          WHOTMP
     I              L8HGCD                          WHHGCD
     I              L8AJCD                          WHAJCD
     I              L8ELDT                          WHELDT
     I              L8LXNM                          WHLXNM
     I              L8YMCD                          WHYMCD
     I              L8YNCD                          WHYNCD
     I              L8UVST                          WHUVST
     I              L8UWST                          WHUWST
     I              L8UXST                          WHUXST
     I              L8VSST                          WHVSST
     I              L8AATM                          WHAATM
     I              L8AYNA                          WHAYNA
     I              L8A0NA                          WHA0NA
     I              L8AXDT                          WHAXDT
      *
     I@BGWKAE
      * Order Detail              co/
      * Renamed input format fields
     I              OMAIC3                          WIAIC3
     I              OMC4NB                          WIC4NB
     I              OMDPNB                          WIDPNB
     I              OMUENB                          WIUENB
     I              OMHGCD                          WIHGCD
     I              OMAJCD                          WIAJCD
     I              OMBKC7                          WIBKC7
     I              OMCFC7                          WICFC7
     I              OMGMST                          WIGMST
     I              OMGNST                          WIGNST
     I              OMMAVA                          WIMAVA
     I              OMKDVA                          WIKDVA
     I              OML8VA                          WIL8VA
     I              OML9VA                          WIL9VA
     I              OMGTST                          WIGTST
     I              OMGVST                          WIGVST
     I              OMGUST                          WIGUST
     I              OMQFST                          WIQFST
     I              OMAYVA                          WIAYVA
     I              OMEXDT                          WIEXDT
     I              OMLQCD                          WILQCD
     I              OMRDCD                          WIRDCD
     I              OMQ7CD                          WIQ7CD
     I              OMBZPR                          WIBZPR
     I              OML6NB                          WIL6NB
     I              OMU1ST                          WIU1ST
     I              OMGIDT                          WIGIDT
     I              OMCRCD                          WICRCD
     I              OMAGCD                          WIAGCD
     I              OMRZST                          WIRZST
     I              OMR0ST                          WIR0ST
     I              OMR1ST                          WIR1ST
     I              OMG7NA                          WIG7NA
     I              OMG8NA                          WIG8NA
     I              OMRPCD                          WIRPCD
     I              OMVEST                          WIVEST
     I              OMVGST                          WIVGST
     I              OMAVST                          WIAVST
     I              OMU0ST                          WIU0ST
     I              OMRFCD                          WIRFCD
     I              OMFZST                          WIFZST
     I              OMR1NB                          WIR1NB
     I              OMAVQT                          WIAVQT
     I              OMD0WG                          WID0WG
     I              OMCCQT                          WICCQT
     I              OMAUWG                          WIAUWG
     I              OMCBQT                          WICBQT
     I              OMATWG                          WIATWG
     I              OMAQCS                          WIAQCS
     I              OMAGCS                          WIAGCS
     I              OMAKPR                          WIAKPR
     I              OMALPR                          WIALPR
     I              OMAUPR                          WIAUPR
     I              OMAVWG                          WIAVWG
     I              OMA4WG                          WIA4WG
     I              OMA5DT                          WIA5DT
     I              OMAODT                          WIAODT
     I              OMGNDT                          WIGNDT
     I              OMAMST                          WIAMST
     I              OMANST                          WIANST
     I              OMVAST                          WIVAST
     I              OMRGNB                          WIRGNB
     I              OMRHNB                          WIRHNB
     I              OMRINB                          WIRINB
     I              OMRBCD                          WIRBCD
     I              OMHICD                          WIHICD
     I              OMRNCD                          WIRNCD
     I              OMROCD                          WIROCD
     I              OMCXDT                          WICXDT
     I              OMAJVN                          WIAJVN
     I              OMKXCD                          WIKXCD
     I              OMJPCD                          WIJPCD
     I              OMCQCD                          WICQCD
     I              OMR4CD                          WIR4CD
     I              OMZ1ST                          WIZ1ST
     I              OMZ3ST                          WIZ3ST
     I              OMZ4ST                          WIZ4ST
     I              OMDUPR                          WIDUPR
     I              OMB6VL                          WIB6VL
     I              OMA1AA                          WIA1AA
     I              OMFZSX                          WIFZSX
     I              OMF0SX                          WIF0SX
     I              OMF1SX                          WIF1SX
     I              OMF2SX                          WIF2SX
     I              OMF3SX                          WIF3SX
     I              OMF4SX                          WIF4SX
     I              OMF5SX                          WIF5SX
     I              OMF6SX                          WIF6SX
     I              OMF7SX                          WIF7SX
     I              OMNTDT                          WINTDT
     I              OMNUDT                          WINUDT
     I              OMNVDT                          WINVDT
     I              OMNWDT                          WINWDT
     I              OMNXDT                          WINXDT
     I              OMBUTM                          WIBUTM
     I              OMBVTM                          WIBVTM
     I              OMBWTM                          WIBWTM
     I              OMBXTM                          WIBXTM
     I              OMBYTM                          WIBYTM
     I              OMH5NX                          WIH5NX
     I              OMH6NX                          WIH6NX
     I              OMH7NX                          WIH7NX
     I              OMH8NX                          WIH8NX
     I              OMH9NX                          WIH9NX
     I              OMDVPR                          WIDVPR
     I              OMDWPR                          WIDWPR
     I              OMDXPR                          WIDXPR
     I              OMDYPR                          WIDYPR
     I              OMDZPR                          WIDZPR
     I              OMGSPR                          WIGSPR
     I              OMGTPR                          WIGTPR
     I              OMGUPR                          WIGUPR
     I              OMHOST                          WIHOST
     I              OMHPST                          WIHPST
     I              OMIOST                          WIIOST
     I              OMPEWG                          WIPEWG
     I              OMRINY                          WIRINY
     I              OMTIDT                          WITIDT
     I              OMTJDT                          WITJDT
     I              OMH2ST                          WIH2ST
     I              OMH0ST                          WIH0ST
     I              OMH1ST                          WIH1ST
     I              OMTKDT                          WITKDT
     I              OMTLDT                          WITLDT
     I              OMTMDT                          WITMDT
     I              OMUVST                          WIUVST
     I              OMUWST                          WIUWST
     I              OMUXST                          WIUXST
     I              OMAATM                          WIAATM
     I              OMAYNA                          WIAYNA
     I              OMA0NA                          WIA0NA
     I              OMAXDT                          WIAXDT
      *
     I@EYCPUT
      * Order Events              Co/Order/Evt#(d)
      * Renamed input format fields
     I              EYAIC3                          WJAIC3
     I              EYC4NB                          WJC4NB
     I              EYQ2NB                          WJQ2NB
     I              EYJPCD                          WJJPCD
     I              EYAUC3                          WJAUC3
     I              EYQ7NB                          WJQ7NB
     I              EYOMST                          WJOMST
     I              EYD2DT                          WJD2DT
     I              EYONST                          WJONST
     I              EYOOST                          WJOOST
     I              EYOPST                          WJOPST
     I              EYAWC3                          WJAWC3
     I              EYQ8NB                          WJQ8NB
     I              EYQ9NB                          WJQ9NB
     I              EYBKC7                          WJBKC7
     I              EYUVST                          WJUVST
     I              EYUWST                          WJUWST
     I              EYUXST                          WJUXST
     I              EYAATM                          WJAATM
     I              EYAYNA                          WJAYNA
     I              EYA0NA                          WJA0NA
     I              EYAXDT                          WJAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WKAIC3
     I              BEC4NB                          WKC4NB
     I              BEJNCD                          WKJNCD
     I              BEANC7                          WKANC7
     I              BEBKC7                          WKBKC7
     I              BEBRTX                          WKBRTX
     I              BEHMNA                          WKHMNA
     I              BEHONA                          WKHONA
     I              BEHPNA                          WKHPNA
     I              BEHNNA                          WKHNNA
     I              BEDBCD                          WKDBCD
     I              BECKTX                          WKCKTX
     I              BEB0C7                          WKB0C7
     I              BEAETX                          WKAETX
     I              BEB1NA                          WKB1NA
     I              BEB3NA                          WKB3NA
     I              BEB4NA                          WKB4NA
     I              BEB2NA                          WKB2NA
     I              BEBHCD                          WKBHCD
     I              BEC8TX                          WKC8TX
     I              BEBCNA                          WKBCNA
     I              BEA0DT                          WKA0DT
     I              BEA5DT                          WKA5DT
     I              BEGNDT                          WKGNDT
     I              BEACDT                          WKACDT
     I              BEAQCD                          WKAQCD
     I              BEB6NA                          WKB6NA
     I              BEBYNA                          WKBYNA
     I              BEBZNA                          WKBZNA
     I              BEGTST                          WKGTST
     I              BEGVST                          WKGVST
     I              BEGUST                          WKGUST
     I              BEQFST                          WKQFST
     I              BECQCD                          WKCQCD
     I              BEGJST                          WKGJST
     I              BEGWST                          WKGWST
     I              BEGXST                          WKGXST
     I              BEGYST                          WKGYST
     I              BEAODT                          WKAODT
     I              BEAIVN                          WKAIVN
     I              BECXDT                          WKCXDT
     I              BEJZVA                          WKJZVA
     I              BEA1WG                          WKA1WG
     I              BEXIST                          WKXIST
     I              BEXJST                          WKXJST
     I              BEXKST                          WKXKST
     I              BEEIDT                          WKEIDT
     I              BEAFTM                          WKAFTM
     I              BEE8CD                          WKE8CD
     I              BEE9CD                          WKE9CD
     I              BERMNB                          WKRMNB
     I              BETBNB                          WKTBNB
     I              BER1NB                          WKR1NB
     I              BEPJST                          WKPJST
     I              BEU0ST                          WKU0ST
     I              BEU1ST                          WKU1ST
     I              BEQ2CD                          WKQ2CD
     I              BEU2ST                          WKU2ST
     I              BEVEST                          WKVEST
     I              BEVFST                          WKVFST
     I              BEVGST                          WKVGST
     I              BERPCD                          WKRPCD
     I              BERNNB                          WKRNNB
     I              BEVDST                          WKVDST
     I              BEATIN                          WKATIN
     I              BEU4ST                          WKU4ST
     I              BEU5ST                          WKU5ST
     I              BERSRN                          WKRSRN
     I              BEMHNA                          WKMHNA
     I              BEMINA                          WKMINA
     I              BEWBST                          WKWBST
     I              BER4CD                          WKR4CD
     I              BEBFCD                          WKBFCD
     I              BEQ4CD                          WKQ4CD
     I              BET3NB                          WKT3NB
     I              BESICD                          WKSICD
     I              BECONB                          WKCONB
     I              BECEST                          WKCEST
     I              BEAWDT                          WKAWDT
     I              BEJPCD                          WKJPCD
     I              BEXUST                          WKXUST
     I              BEZ1ST                          WKZ1ST
     I              BEVRVA                          WKVRVA
     I              BEOBST                          WKOBST
     I              BEBCST                          WKBCST
     I              BEBDST                          WKBDST
     I              BEB7VL                          WKB7VL
     I              BEGASX                          WKGASX
     I              BEGBSX                          WKGBSX
     I              BEGCSX                          WKGCSX
     I              BEGDSX                          WKGDSX
     I              BEFNSX                          WKFNSX
     I              BEFOSX                          WKFOSX
     I              BEFPSX                          WKFPSX
     I              BEFQSX                          WKFQSX
     I              BEFRSX                          WKFRSX
     I              BEFSSX                          WKFSSX
     I              BEFTSX                          WKFTSX
     I              BEFUSX                          WKFUSX
     I              BEFVSX                          WKFVSX
     I              BEFWSX                          WKFWSX
     I              BEFXSX                          WKFXSX
     I              BEFYSX                          WKFYSX
     I              BENODT                          WKNODT
     I              BENPDT                          WKNPDT
     I              BENQDT                          WKNQDT
     I              BENRDT                          WKNRDT
     I              BENSDT                          WKNSDT
     I              BEBPTM                          WKBPTM
     I              BEBQTM                          WKBQTM
     I              BEBRTM                          WKBRTM
     I              BEBSTM                          WKBSTM
     I              BEBTTM                          WKBTTM
     I              BEH0NX                          WKH0NX
     I              BEH1NX                          WKH1NX
     I              BEH2NX                          WKH2NX
     I              BEH3NX                          WKH3NX
     I              BEH4NX                          WKH4NX
     I              BEC0C7                          WKC0C7
     I              BEUVST                          WKUVST
     I              BEUWST                          WKUWST
     I              BEUXST                          WKUXST
     I              BEAATM                          WKAATM
     I              BEAYNA                          WKAYNA
     I              BEA0NA                          WKA0NA
     I              BEAXDT                          WKAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
     IQPDL81    E DSPDL8CPL0
      * UPD : Order Inv Allocation      Update index
      * Renamed input format fields
     I              L8AIC3                          WAAIC3
     I              L8C4NB                          WAC4NB
     I              L8DPNB                          WADPNB
     I              L8UENB                          WAUENB
     I              L8ALSW                          WAALSW
     I              L8J6QT                          WAJ6QT
     I              L8G9WG                          WAG9WG
     I              L8J9QT                          WAJ9QT
     I              L8HAWG                          WAHAWG
     I              L8IOSE                          WAIOSE
     I              L8OIMN                          WAOIMN
     I              L8SOAS                          WASOAS
     I              L8ARSX                          WAARSX
     I              L8OTUS                          WAOTUS
     I              L8OTMP                          WAOTMP
     I              L8HGCD                          WAHGCD
     I              L8AJCD                          WAAJCD
     I              L8ELDT                          WAELDT
     I              L8LXNM                          WALXNM
     I              L8YMCD                          WAYMCD
     I              L8YNCD                          WAYNCD
     I              L8UVST                          WAUVST
     I              L8UWST                          WAUWST
     I              L8UXST                          WAUXST
     I              L8VSST                          WAVSST
     I              L8AATM                          WAAATM
     I              L8AYNA                          WAAYNA
     I              L8A0NA                          WAA0NA
     I              L8AXDT                          WAAXDT
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQOPEY1    E DSOPEYCPL0
      * UPD : Order Events              Update index
      * Renamed input format fields
     I              EYAIC3                          WCAIC3
     I              EYC4NB                          WCC4NB
     I              EYQ2NB                          WCQ2NB
     I              EYJPCD                          WCJPCD
     I              EYAUC3                          WCAUC3
     I              EYQ7NB                          WCQ7NB
     I              EYOMST                          WCOMST
     I              EYD2DT                          WCD2DT
     I              EYONST                          WCONST
     I              EYOOST                          WCOOST
     I              EYOPST                          WCOPST
     I              EYAWC3                          WCAWC3
     I              EYQ8NB                          WCQ8NB
     I              EYQ9NB                          WCQ9NB
     I              EYBKC7                          WCBKC7
     I              EYUVST                          WCUVST
     I              EYUWST                          WCUWST
     I              EYUXST                          WCUXST
     I              EYAATM                          WCAATM
     I              EYAYNA                          WCAYNA
     I              EYA0NA                          WCA0NA
     I              EYAXDT                          WCAXDT
      *
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WEAIC3
     I              BEC4NB                          WEC4NB
     I              BEJNCD                          WEJNCD
     I              BEANC7                          WEANC7
     I              BEBKC7                          WEBKC7
     I              BEBRTX                          WEBRTX
     I              BEHMNA                          WEHMNA
     I              BEHONA                          WEHONA
     I              BEHPNA                          WEHPNA
     I              BEHNNA                          WEHNNA
     I              BEDBCD                          WEDBCD
     I              BECKTX                          WECKTX
     I              BEB0C7                          WEB0C7
     I              BEAETX                          WEAETX
     I              BEB1NA                          WEB1NA
     I              BEB3NA                          WEB3NA
     I              BEB4NA                          WEB4NA
     I              BEB2NA                          WEB2NA
     I              BEBHCD                          WEBHCD
     I              BEC8TX                          WEC8TX
     I              BEBCNA                          WEBCNA
     I              BEA0DT                          WEA0DT
     I              BEA5DT                          WEA5DT
     I              BEGNDT                          WEGNDT
     I              BEACDT                          WEACDT
     I              BEAQCD                          WEAQCD
     I              BEB6NA                          WEB6NA
     I              BEBYNA                          WEBYNA
     I              BEBZNA                          WEBZNA
     I              BEGTST                          WEGTST
     I              BEGVST                          WEGVST
     I              BEGUST                          WEGUST
     I              BEQFST                          WEQFST
     I              BECQCD                          WECQCD
     I              BEGJST                          WEGJST
     I              BEGWST                          WEGWST
     I              BEGXST                          WEGXST
     I              BEGYST                          WEGYST
     I              BEAODT                          WEAODT
     I              BEAIVN                          WEAIVN
     I              BECXDT                          WECXDT
     I              BEJZVA                          WEJZVA
     I              BEA1WG                          WEA1WG
     I              BEXIST                          WEXIST
     I              BEXJST                          WEXJST
     I              BEXKST                          WEXKST
     I              BEEIDT                          WEEIDT
     I              BEAFTM                          WEAFTM
     I              BEE8CD                          WEE8CD
     I              BEE9CD                          WEE9CD
     I              BERMNB                          WERMNB
     I              BETBNB                          WETBNB
     I              BER1NB                          WER1NB
     I              BEPJST                          WEPJST
     I              BEU0ST                          WEU0ST
     I              BEU1ST                          WEU1ST
     I              BEQ2CD                          WEQ2CD
     I              BEU2ST                          WEU2ST
     I              BEVEST                          WEVEST
     I              BEVFST                          WEVFST
     I              BEVGST                          WEVGST
     I              BERPCD                          WERPCD
     I              BERNNB                          WERNNB
     I              BEVDST                          WEVDST
     I              BEATIN                          WEATIN
     I              BEU4ST                          WEU4ST
     I              BEU5ST                          WEU5ST
     I              BERSRN                          WERSRN
     I              BEMHNA                          WEMHNA
     I              BEMINA                          WEMINA
     I              BEWBST                          WEWBST
     I              BER4CD                          WER4CD
     I              BEBFCD                          WEBFCD
     I              BEQ4CD                          WEQ4CD
     I              BET3NB                          WET3NB
     I              BESICD                          WESICD
     I              BECONB                          WECONB
     I              BECEST                          WECEST
     I              BEAWDT                          WEAWDT
     I              BEJPCD                          WEJPCD
     I              BEXUST                          WEXUST
     I              BEZ1ST                          WEZ1ST
     I              BEVRVA                          WEVRVA
     I              BEOBST                          WEOBST
     I              BEBCST                          WEBCST
     I              BEBDST                          WEBDST
     I              BEB7VL                          WEB7VL
     I              BEGASX                          WEGASX
     I              BEGBSX                          WEGBSX
     I              BEGCSX                          WEGCSX
     I              BEGDSX                          WEGDSX
     I              BEFNSX                          WEFNSX
     I              BEFOSX                          WEFOSX
     I              BEFPSX                          WEFPSX
     I              BEFQSX                          WEFQSX
     I              BEFRSX                          WEFRSX
     I              BEFSSX                          WEFSSX
     I              BEFTSX                          WEFTSX
     I              BEFUSX                          WEFUSX
     I              BEFVSX                          WEFVSX
     I              BEFWSX                          WEFWSX
     I              BEFXSX                          WEFXSX
     I              BEFYSX                          WEFYSX
     I              BENODT                          WENODT
     I              BENPDT                          WENPDT
     I              BENQDT                          WENQDT
     I              BENRDT                          WENRDT
     I              BENSDT                          WENSDT
     I              BEBPTM                          WEBPTM
     I              BEBQTM                          WEBQTM
     I              BEBRTM                          WEBRTM
     I              BEBSTM                          WEBSTM
     I              BEBTTM                          WEBTTM
     I              BEH0NX                          WEH0NX
     I              BEH1NX                          WEH1NX
     I              BEH2NX                          WEH2NX
     I              BEH3NX                          WEH3NX
     I              BEH4NX                          WEH4NX
     I              BEC0C7                          WEC0C7
     I              BEUVST                          WEUVST
     I              BEUWST                          WEUWST
     I              BEUXST                          WEUXST
     I              BEAATM                          WEAATM
     I              BEAYNA                          WEAYNA
     I              BEA0NA                          WEA0NA
     I              BEAXDT                          WEAXDT
      *
     IYARDCS      DS                            779
      * Outward parameters
     IPARC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Order Number
     I                                    P   3   60PAC4NB
      * I :  Order Type_Sales
     I                                        7   8 PAJNCD
      * I :  AR Customer Number
     I                                    P   9  120PAANC7
      * I :  Ship To Customer
     I                                    P  13  160PABKC7
      * I :  Ship To Name
     I                                       17  46 PABRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PAHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PAHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PAHPNA
      * I :  Ship To City
     I                                      137 156 PAHNNA
      * I :  Ship To State Code
     I                                      157 158 PADBCD
      * I :  Ship To Zip_Postal Code
     I                                      159 169 PACKTX
      * I :  Bill to Customer
     I                                    P 170 1730PAB0C7
      * I :  Bill to Name
     I                                      174 203 PAAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PAB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PAB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PAB4NA
      * I :  Bill to City
     I                                      294 313 PAB2NA
      * I :  Bill to State Code
     I                                      314 315 PABHCD
      * I :  Bill to Zip_Postal Code
     I                                      316 326 PAC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PABCNA
      * I :  Order Date
     I                                    P 342 3450PAA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PAA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PAGNDT
      * I :  Cancel Date
     I                                    P 354 3570PAACDT
      * I :  Terms Code
     I                                      358 359 PAAQCD
      * I :  Special Instructions
     I                                      360 399 PAB6NA
      * I :  Special Instructions 2
     I                                      400 439 PABYNA
      * I :  Carrier Code
     I                                      440 442 PABZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PAGTST
      * I :  Comment Print Inv_Cr_Memo
     I                                      444 444 PAGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PAGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PAQFST
      * I :  Reason Code
     I                                      447 449 PACQCD
      * I :  Order in Use
     I                                      450 450 PAGJST
      * I :  Header Status
     I                                      451 451 PAGWST
      * I :  Header Status Last
     I                                      452 452 PAGXST
      * I :  Order Type Print Status
     I                                      453 453 PAGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PAAODT
      * I :  User Original Entry
     I                                      458 467 PAAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PACXDT
      * I :  Order Value Total
     I                                    P 472 4772PAJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PAA1WG
      * I :  Credit Hold
     I                                      484 484 PAXIST
      * I :  Production Hold
     I                                      485 485 PAXJST
      * I :  New Customer Hold
     I                                      486 486 PAXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PAEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PAAFTM
      * I :  Accounts Receiv_Ent 1
     I                                      494 497 PAE8CD
      * I :  Accounts Receiv_Ent 2
     I                                      498 509 PAE9CD
      * I :  Load ID
     I                                    P 510 5130PARMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PATBNB
      * I :  Rated Freight
     I                                    P 517 5222PAR1NB
      * I :  LTL Flag
     I                                      523 523 PAPJST
      * I :  Price Audit
     I                                      524 524 PAU0ST
      * I :  Price Status
     I                                      525 525 PAU1ST
      * I :  Shipping Method
     I                                      526 527 PAQ2CD
      * I :  Export Status
     I                                      528 528 PAU2ST
      * I :  Palletize
     I                                      529 529 PAVEST
      * I :  Shrink Wrap
     I                                      530 530 PAVFST
      * I :  Slip Sheet
     I                                      531 531 PAVGST
      * I :  Age Code
     I                                      532 532 PARPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PARNNB
      * I :  Load Type
     I                                      536 536 PAVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PAATIN
      * I :  Load Plan Order
     I                                      541 541 PAU4ST
      * I :  Print Pick Slip
     I                                      542 542 PAU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PARSRN
      * I :  Special Comment 1
     I                                      547 576 PAMHNA
      * I :  Special Comment 2
     I                                      577 606 PAMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PAWBST
      * I :  Sales Route Code
     I                                      608 610 PAR4CD
      * I :  Manager Level Code
     I                                      611 612 PABFCD
      * I :  VP Level Code
     I                                      613 615 PAQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PAT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PASICD
      * I :  Invoice Number
     I                                    P 623 6260PACONB
      * I :  Invoice Suffix
     I                                      627 628 PACEST
      * I :  Invoice Date
     I                                    P 629 6320PAAWDT
      * I :  Event Code
     I                                      633 634 PAJPCD
      * I :  Trans Contol AS400_Plant
     I                                      635 635 PAXUST
      * I :  Modified Flag
     I                                      636 636 PAZ1ST
      * I :  A_R order Value Total
     I                                    P 637 6422PAVRVA
      * I :  Billing Activity Type
     I                                      643 643 PAOBST
      * I :  Block Order Flag
     I                                      644 644 PABCST
      * I :  Order Certification Flag
     I                                      645 645 PABDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PAB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PAGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PAGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PAGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PAGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PAFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PAFOSX
      * I :  Order Emailed
     I                                      658 658 PAFPSX
      * I :  Export Docs Go w_Driver
     I                                      659 659 PAFQSX
      * I :  Shipping Temp Code C_F
     I                                      660 660 PAFRSX
      * I :  Broker Order Status
     I                                      661 661 PAFSSX
      * I :  Air Freight Order
     I                                      662 662 PAFTSX
      * I :  Order Requires Review
     I                                      663 664 PAFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PAFVSX
      * I :  Export USDA Approved
     I                                      667 668 PAFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PAFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PAFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PANODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PANPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PANQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PANRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PANSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PABPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PABQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PABRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PABSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PABTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PAH0NX
      * I :  Act Non_Ref Frt Amount
     I                                    P 721 7262PAH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PAH2NX
      * I :  OH Total Non_Ref Frt Amt
     I                                    P 733 7382PAH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PAH4NX
      * I :  Claim Number
     I                                    P 745 7480PAC0C7
      * I :  EDI Status 1
     I                                      749 749 PAUVST
      * I :  EDI Status 2
     I                                      750 750 PAUWST
      * I :  EDI Status 3
     I                                      751 751 PAUXST
      * I :  Job Time
     I                                    P 752 7550PAAATM
      * I :  User Id
     I                                      756 765 PAAYNA
      * I :  Job Name
     I                                      766 775 PAA0NA
      * I :  Job Date
     I                                    P 776 7790PAAXDT
      *
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WFAIC3
     I              OMC4NB                          WFC4NB
     I              OMDPNB                          WFDPNB
     I              OMUENB                          WFUENB
     I              OMHGCD                          WFHGCD
     I              OMAJCD                          WFAJCD
     I              OMBKC7                          WFBKC7
     I              OMCFC7                          WFCFC7
     I              OMGMST                          WFGMST
     I              OMGNST                          WFGNST
     I              OMMAVA                          WFMAVA
     I              OMKDVA                          WFKDVA
     I              OML8VA                          WFL8VA
     I              OML9VA                          WFL9VA
     I              OMGTST                          WFGTST
     I              OMGVST                          WFGVST
     I              OMGUST                          WFGUST
     I              OMQFST                          WFQFST
     I              OMAYVA                          WFAYVA
     I              OMEXDT                          WFEXDT
     I              OMLQCD                          WFLQCD
     I              OMRDCD                          WFRDCD
     I              OMQ7CD                          WFQ7CD
     I              OMBZPR                          WFBZPR
     I              OML6NB                          WFL6NB
     I              OMU1ST                          WFU1ST
     I              OMGIDT                          WFGIDT
     I              OMCRCD                          WFCRCD
     I              OMAGCD                          WFAGCD
     I              OMRZST                          WFRZST
     I              OMR0ST                          WFR0ST
     I              OMR1ST                          WFR1ST
     I              OMG7NA                          WFG7NA
     I              OMG8NA                          WFG8NA
     I              OMRPCD                          WFRPCD
     I              OMVEST                          WFVEST
     I              OMVGST                          WFVGST
     I              OMAVST                          WFAVST
     I              OMU0ST                          WFU0ST
     I              OMRFCD                          WFRFCD
     I              OMFZST                          WFFZST
     I              OMR1NB                          WFR1NB
     I              OMAVQT                          WFAVQT
     I              OMD0WG                          WFD0WG
     I              OMCCQT                          WFCCQT
     I              OMAUWG                          WFAUWG
     I              OMCBQT                          WFCBQT
     I              OMATWG                          WFATWG
     I              OMAQCS                          WFAQCS
     I              OMAGCS                          WFAGCS
     I              OMAKPR                          WFAKPR
     I              OMALPR                          WFALPR
     I              OMAUPR                          WFAUPR
     I              OMAVWG                          WFAVWG
     I              OMA4WG                          WFA4WG
     I              OMA5DT                          WFA5DT
     I              OMAODT                          WFAODT
     I              OMGNDT                          WFGNDT
     I              OMAMST                          WFAMST
     I              OMANST                          WFANST
     I              OMVAST                          WFVAST
     I              OMRGNB                          WFRGNB
     I              OMRHNB                          WFRHNB
     I              OMRINB                          WFRINB
     I              OMRBCD                          WFRBCD
     I              OMHICD                          WFHICD
     I              OMRNCD                          WFRNCD
     I              OMROCD                          WFROCD
     I              OMCXDT                          WFCXDT
     I              OMAJVN                          WFAJVN
     I              OMKXCD                          WFKXCD
     I              OMJPCD                          WFJPCD
     I              OMCQCD                          WFCQCD
     I              OMR4CD                          WFR4CD
     I              OMZ1ST                          WFZ1ST
     I              OMZ3ST                          WFZ3ST
     I              OMZ4ST                          WFZ4ST
     I              OMDUPR                          WFDUPR
     I              OMB6VL                          WFB6VL
     I              OMA1AA                          WFA1AA
     I              OMFZSX                          WFFZSX
     I              OMF0SX                          WFF0SX
     I              OMF1SX                          WFF1SX
     I              OMF2SX                          WFF2SX
     I              OMF3SX                          WFF3SX
     I              OMF4SX                          WFF4SX
     I              OMF5SX                          WFF5SX
     I              OMF6SX                          WFF6SX
     I              OMF7SX                          WFF7SX
     I              OMNTDT                          WFNTDT
     I              OMNUDT                          WFNUDT
     I              OMNVDT                          WFNVDT
     I              OMNWDT                          WFNWDT
     I              OMNXDT                          WFNXDT
     I              OMBUTM                          WFBUTM
     I              OMBVTM                          WFBVTM
     I              OMBWTM                          WFBWTM
     I              OMBXTM                          WFBXTM
     I              OMBYTM                          WFBYTM
     I              OMH5NX                          WFH5NX
     I              OMH6NX                          WFH6NX
     I              OMH7NX                          WFH7NX
     I              OMH8NX                          WFH8NX
     I              OMH9NX                          WFH9NX
     I              OMDVPR                          WFDVPR
     I              OMDWPR                          WFDWPR
     I              OMDXPR                          WFDXPR
     I              OMDYPR                          WFDYPR
     I              OMDZPR                          WFDZPR
     I              OMGSPR                          WFGSPR
     I              OMGTPR                          WFGTPR
     I              OMGUPR                          WFGUPR
     I              OMHOST                          WFHOST
     I              OMHPST                          WFHPST
     I              OMIOST                          WFIOST
     I              OMPEWG                          WFPEWG
     I              OMRINY                          WFRINY
     I              OMTIDT                          WFTIDT
     I              OMTJDT                          WFTJDT
     I              OMH2ST                          WFH2ST
     I              OMH0ST                          WFH0ST
     I              OMH1ST                          WFH1ST
     I              OMTKDT                          WFTKDT
     I              OMTLDT                          WFTLDT
     I              OMTMDT                          WFTMDT
     I              OMUVST                          WFUVST
     I              OMUWST                          WFUWST
     I              OMUXST                          WFUXST
     I              OMAATM                          WFAATM
     I              OMAYNA                          WFAYNA
     I              OMA0NA                          WFA0NA
     I              OMAXDT                          WFAXDT
      *
     IYBRDCS      DS                            525
     IYCRDCS      DS                            779
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Header TRG
      * I : RST Load ID
     I                                    P   1   40P1RMNB
      * N :  Event Code
     I                                        5   6 P1JPCD
     IP2PARM      DS
      * FLD: *Arrays
      * I :  Warehouse Code
     I                                        1   3 P2AJCD
      * N :  Application Code
     I                                        4   9 P2DNCD
      * N :  System Date Format
     I                                       10  12 P2B8NA
      * N :  User Profile Name
     I                                       13  22 P2AJVN
      * N :  Allow Multi-Company
     I                                       23  23 P2I6ST
      * N :  Default Printer
     I                                       24  33 P2MPNA
      * N :  First Time Flag
     I                                       34  34 P2TAST
     IP3PARM      DS
      * FLD: Load Header
      * I : MAP Load Status
     I                                        1   1 P3PKST
      * I : MAP Total Load Order Weight
     I                                    P   2   50P3RPNB
      * I : MAP Trailer Id
     I                                        6  25 P3DXTX
      * I : MAP Carrier Code
     I                                       26  28 P3BZNA
      * I : MAP Truck Size
     I                                       29  35 P3RONB
      * I : MAP Load Type
     I                                       36  36 P3VDST
      * N : MAP Schedule Sequence Number
     I                                    P  37  390P3T4NB
      * N : MAP Shipping Method
     I                                       40  41 P3Q2CD
     IP4PARM      DS
      * FLD: *Arrays
      * N :  PRT Description
     I                                        1  25 P4G3TX
      * N :  PRT Printer Device
     I                                       26  35 P4WRST
      * N :  PRT Hold Output Sts
     I                                       36  39 P4WSST
      * N :  PRT Save Output Sts
     I                                       40  43 P4WTST
      * N :  PRT Number of Copies
     I                                       44  450P4DYNB
      * N :  PRT Night Queue Run Sts
     I                                       46  46 P4WUST
      * N :  PRT Night Queue
     I                                       47  56 P4BVVN
      * N :  Hold On Jobq
     I                                       57  60 P4BDSX
      * N :  Job Log Create
     I                                       61  64 P4BESX
      * N :  Hold
     I                                       65  69 P4BCSX
      * N :  Log
     I                                       70  86 P4Y8CD
      * N :  Display Prt Opt Pmt USR
     I                                       87  90 P4XFST
     IP5PARM      DS
      * N :  Pick Print Type USR
     I                                        1   1 P5BKSX
      * Submit job processing data structures.
     I#SRQS       DS                           3000
     I                                        1   1 #SDMY1
     I#SSTR       DS                           3000
     I                                        1   1 #SDMY2
     I#SWRK       DS                           3000
     I                                        1   1 #SDMY3
     I#SMRG       DS                            256
     I                                        1   1 #SDMY4
     I            DS
     I I            'CMD(CALL PGM('           1  13 #SCLL
     I I            'PARM('                  14  18 #SPRM
     I I            ')'                      19  19 #SPRN
     I I            '          '             20  29 #SPRG
      * Submit job command strings.
     I            DS
     I I            'SBMJOB     JOB(CUSTT-    1 256 #S0001
     I              'RFFC) JOBD(*USRPRF) '
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'CD7 Non numeric data'
      * Message data for 'CD3 Non numeric data'
      * Message data for 'CD7 Non numeric data'
      * Message data for 'Unpick Invalid'
      * *SFLSEL
     I                                        1   1 ZA0001
      * Message data for 'Order not picked.'
      * Order Number
     I                                        1   7 ZA0002
      * *SFLSEL
     I                                        8   8 ZA0003
      * Message data for 'Plant Floor Order'
      * *SFLSEL
     I                                        1   1 ZA0004
      * Message data for 'Pick Invalid for Order'
      * *SFLSEL
     I                                        1   1 ZA0005
      * Message data for 'Plant Floor Order'
      * *SFLSEL
     I                                        1   1 ZA0006
      * Message data for 'Order not picked.'
      * Order Number
     I                                        1   7 ZA0007
      * *SFLSEL
     I                                        8   8 ZA0008
      * Message data for 'Plant Floor Order'
      * *SFLSEL
     I                                        1   1 ZA0009
      * Message data for 'SBMJOB Override String'
      * Job
     I                                        1  10 ZA0010
      * Jobq
     I                                       11  20 ZA0011
      * Log
     I                                       21  37 ZA0012
      * Hold
     I                                       38  42 ZA0013
      * Message data for 'Job Submitted'
      * Job
     I                                        1  10 ZA0014
      * Jobq
     I                                       11  20 ZA0015
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0016
      * Application Code
     I                                       11  16 ZA0017
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0018
      * Application Code
     I                                       11  16 ZA0019
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1RMNB    PARM           WP0001  70       Load ID
     C           P2AJCD    PARM           WP0002  3        Warehouse Code
     C           P3PKST    PARM           WP0003  1        Load Status
     C           P3RPNB    PARM           WP0004  70       Total Load Orde
     C           P3DXTX    PARM           WP0005 20        Trailer Id
     C           P3BZNA    PARM           WP0006  3        Carrier Code
     C           P3RONB    PARM           WP0007  7        Truck Size
     C           P3VDST    PARM           WP0008  1        Load Type
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise & load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END                             OD W0RSF
     C                     END                             OD *HIVAL
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise and load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
      * USER: Initialize subfile control
      * CASE: LCL.First Time Flag is Yes
     C           YL0001    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       YL0001           First Time Flag
     C                     END                             *FI
     C                     MOVELP3DXTX    #CS2TX           Trailer ID USR
     C                     MOVELP2AJCD    #CAJCD           Warehouse Code
      * Position DBF file
     C           KPOS      KLIST
     C                     KFLD           BERMNB           Load ID
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADD#2RMNB    BERMNB
     C                     Z-ADD#2C4NB    BEC4NB
     C           KPOS      SETLL@BFCPNJ
     C           KRST      KLIST
     C                     KFLD           BERMNB           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    BERMNB
     C           KRST      READE@BFCPNJ                8782*82=EOF
      * Save previous selector values
     C           *LIKE     DEFN #2JNCD    WZJNCD
     C                     MOVEL#2JNCD    WZJNCD           Order Type_Sale
     C           *LIKE     DEFN #2A5DT    WZA5DT
     C                     MOVEL#2A5DT    WZA5DT           Requested Ship
     C           *LIKE     DEFN #2RMNB    WZRMNB
     C                     MOVEL#2RMNB    WZRMNB           Load ID
     C           *LIKE     DEFN #2Q2CD    WZQ2CD
     C                     MOVEL#2Q2CD    WZQ2CD           Shipping Method
     C           *LIKE     DEFN #2C4NB    WZC4NB
     C                     MOVEL#2C4NB    WZC4NB           Order Number
     C           *LIKE     DEFN #2AIC3    WZAIC3
     C                     MOVEL#2AIC3    WZAIC3           Company Number
     C           *LIKE     DEFN #2U5ST    WZU5ST
     C                     MOVEL#2U5ST    WZU5ST           Print Pick Slip
     C           *LIKE     DEFN #2JPCD    WZJPCD
     C                     MOVEL#2JPCD    WZJPCD           Event Code
     C           *LIKE     DEFN #2AODT    WZAODT
     C                     MOVEL#2AODT    WZAODT           Scheduled Ship
     C           *LIKE     DEFN #2BKC7    WZBKC7
     C                     MOVEL#2BKC7    WZBKC7           Ship To Custome
     C           *LIKE     DEFN #2BRTX    WZBRTX
     C                     MOVEL#2BRTX    WZBRTX           Ship To Name
     C           *LIKE     DEFN #2GWST    WZGWST
     C                     MOVEL#2GWST    WZGWST           Header Status
      * Load subfile page
     C                     Z-ADD0         ##RROK  50
     C                     EXSR BBLDSF
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
      * Re-establish fields in read-ahead record
     C   27                DO
     C  N82                READP@BFCPNJ                  90*
     C  N82                READ @BFCPNJ                  90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVEL*ALL'0'   WKIND0  1
     C                     MOVEAWKIND0    *IN,37
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
      * Reset count of DBF records read
     C                     Z-ADD0         ##RRRD  90
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next SFL page until SFL page full, or
      * Scan limit reached
     C           *IN82     DOWEQ'0'                        DO
     C           ##RROK    ANDLT##SFLN
     C           ##RRRD    ANDLTW0SLM
      * Check selection fields - if fail, read next record
     C           #2JNCD    IFNE *BLANK                     Order Type_Sale
     C           BEJNCD    CABNE#2JNCD    BB020            Order Type_Sale
     C                     END
     C           #2A5DT    IFNE *ZERO                      Requested Ship
     C           BEA5DT    CABNE#2A5DT    BB020            Requested Ship
     C                     END
     C           #2Q2CD    IFNE *BLANK                     Shipping Method
     C           BEQ2CD    CABNE#2Q2CD    BB020            Shipping Method
     C                     END
     C           #2AIC3    IFNE *ZERO                      Company Number
     C           BEAIC3    CABNE#2AIC3    BB020            Company Number
     C                     END
     C           #2U5ST    IFNE *BLANK                     Print Pick Slip
     C           BEU5ST    CABNE#2U5ST    BB020            Print Pick Slip
     C                     END
     C           #2JPCD    IFNE *BLANK                     Event Code
     C           BEJPCD    CABNE#2JPCD    BB020            Event Code
     C                     END
     C           #2AODT    IFNE *ZERO                      Scheduled Ship
     C           BEAODT    CABNE#2AODT    BB020            Scheduled Ship
     C                     END
     C           #2BKC7    IFNE *ZERO                      Ship To Custome
     C           BEBKC7    CABNE#2BKC7    BB020            Ship To Custome
     C                     END
     C           #2BRTX    IFNE *BLANK                     Ship To Name
     C           BEBRTX    CABNE#2BRTX    BB020            Ship To Name
     C                     END
     C           #2GWST    IFNE *BLANK                     Header Status
     C           BEGWST    CABNE#2GWST    BB020            Header Status
     C                     END
      * Load SFL fields
     C                     EXSR MBFL#1
     C                     MOVEL'Y'       W0RSL   1
      * Allow for possible *Set Cursor processing
     C                     ADD  1         ##RR
      * USER: Initialize subfile record from DBF record
     C                     MOVEL'N'       W0RSL            *Record selecte
      * Sel Order by Whs      RT - PD Order Detail  * 
     C                     EXSR SARVGN
      * Rtv Order Pick Sts    RT - OP Order Events  * 
     C                     EXSR SBRVGN
     C                     SUB  1         ##RR
      * DBF record not selected
     C           W0RSL     CABNE'Y'       BB020
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Output to subfile
     C                     ADD  1         ##RR
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
     C                     WRITE#SFLRCD
     C           BB020     TAG
      * Increment scan check count
     C                     ADD  1         ##RRRD
     C           KRST      READE@BFCPNJ                  82*82=EOF
     C                     END                             OD 1 - ##SFPG
      *................................................................
     C           BB900     TAG
      *................................................................
      * If no DBF records found, display error message
     C           ##RR      IFEQ *ZERO
     C           *IN82     ANDEQ'1'
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI ##RR = *ZERO
      *
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      * If scan limit reached, display error message
     C           ##RRRD    IFGE W0SLM
      * Send message '*Scan limit reached'
     C                     MOVEL'Y2U0017' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     ELSE
     C                     Z-ADD0         ##RROK
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen
      *================================================================
      * Convert fields to external form
     C  N30N27             EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Update screen time
     C                     TIME           ##TME
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     SETOF                       8392*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate Order Number and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV2C4NB    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #2C4NB           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #2C4NB           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Company Number and convert to internal.
      * CD3 Ext/Int
     C                     MOVELV2AIC3    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC3  3
     C                     MOVEA*BLANKS   K3
     C                     Z-ADD3         C       30
     C                     Z-ADD3         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUDMCD    J3
     C                     MOVE *BLANKS   W0RTN
     C                     DO   3
     C           J3,C      IFNE ' '
     C                     MOVEAJ3,C      K3,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK3        JUSTC3
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC3    TESTC   1
     C           TESTC     IFGT '?'
     C           TESTC     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC3     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC3    WUDMCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Send message 'CD3 Non numeric data'
     C                     MOVEL'USR0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #2AIC3           CD3 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUDMCD    #2AIC3           CD3 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Scheduled Ship Date
      * External date
     C                     Z-ADDV2AODT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9934  *
     C                     END
     C                     Z-ADDXDINDT    #2AODT
      * Validate Ship To Customer and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV2BKC7    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #2BKC7           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #2BKC7           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Header Status
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#2GWST    W0NSRQ  1        Header Status
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#2GWST'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1160607   Y2LSNO  70
     C           #2GWST    PARM #2GWST    W0EXVL 25        Header Status
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      *................................................................
     C           YPMTFD    IFNE *BLANKS
     C           YPMRRN    ANDEQ*ZERO
     C                     GOTO DAEXIT
     C                     END
     C           YPMTFD    CABNE*BLANKS   DATAG1
      * Change of position specified
     C           WZC4NB    CASNE#2C4NB    FBRQRL
     C           WZAIC3    CASNE#2AIC3    FBRQRL
     C           WZJPCD    CASNE#2JPCD    FBRQRL
     C           WZAODT    CASNE#2AODT    FBRQRL
     C           WZBKC7    CASNE#2BKC7    FBRQRL
     C           WZGWST    CASNE#2GWST    FBRQRL
     C                     END
     C           DATAG1    TAG
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process subfile control (Pre-confirm)
      * F4=Prompt
      * CASE: CTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * Ship to Customer
      * CASE: PGM.*Cursor field <IS> CTL.Ship To Customer
     C           W0CFL     IFEQ 'V2BKC7'                   *IF
      * 033104 SLM ADD SHIPPED TO CUSTOMER POSITION ON CUSTOMER NAME
      * SEL Cust/ShpTo Flag 'Y'SR - Customer  * 
     C                     CALL 'PDYSSRR'              90  SEL Cust/ShpTo
     C                     PARM *BLANK    W0RTN   7
     C           #2BKC7    PARM #2BKC7    WQ0001  70       Ship To Custome
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYSSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9935  *
     C                     END
     C                     END                             *FI
      * Event Code
      * CASE: PGM.*Cursor field <IS> CTL.Event Code
     C           W0CFL     IFEQ '#2JPCD'                   *IF
      * SEL Event Types Active SR - OP Event Types  * 
     C                     CALL 'PDEQSRR'              90  SEL Event Types
     C                     PARM *BLANK    W0RTN   7
     C           #2JPCD    PARM #2JPCD    WQ0002  2        Event Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEQSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9933  *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * Reload subfile requested
     C           W0RSF     CABEQ'Y'       DAEXIT
     C                     END
     C           *IN81     IFEQ '1'
      * Process subfile records
     C                     EXSR DBPRSF
     C                     END
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * USER: Final processing (Pre-confirm)
     C                     MOVEL'*YES'    P4XFST           Display Prt Opt
      * If error, quit processing
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
      * Process subfile record
     C                     EXSR DCPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Setof error indicators and SFLNXTCHG
     C                     MOVEAWKIND0    *IN,37
     C                     SETOF                     98    *
     C           YPMTFD    CABNE*BLANKS   DCEXIT
      * USER: Process subfile record (Pre-confirm)
      * Display Order Detail
      * CASE: RCD.*SFLSEL is Option 5
     C           #1SEL     IFEQ ' 5'                       *IF
     C           #1SEL     OREQ '5'
      * DSP Order vs. Ship Dtl DF - PD Order Detail  * 
     C                     CALL 'PDP7DFR'              90  DSP Order vs. S
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0003  30       Company Number
     C                     PARM #1C4NB    WQ0004  70       Order Number
     C                     PARM #1JNCD    WQ0005  2        Order Type_Sale
     C                     PARM #1BKC7    WQ0006  70       Ship To Custome
     C                     PARM #1BRTX    WQ0007 30        Ship To Name
     C                     PARM #1BCNA    WQ0008 15        Customer Purcha
     C                     PARM #1A0DT    WQ0009  70       Order Date
     C                     PARM #1GNDT    WQ0010  70       Actual Shipped
     C                     PARM #1GWST    WQ0011  1        Header Status
     C           #1XIST    PARM #1XIST    WQ0012  1        Credit Hold
     C           #1XJST    PARM #1XJST    WQ0013  1        Production Hold
     C           #1XKST    PARM #1XKST    WQ0014  1        New Customer Ho
     C                     PARM #1R4CD    WQ0015  3        Sales Route Cod
     C                     PARM P2DNCD    WQ0016  6        Application Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDP7DFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * Display Shipping Instructions
      * CASE: RCD.*SFLSEL is Option 7
     C           #1SEL     IFEQ '7'                        *IF
     C           #1SEL     OREQ ' 7'
      * DSP Shipping Inst.     DF - PD Shipping Instructions  * 
     C                     CALL 'PDNADFR'              90  DSP Shipping In
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0017  30       Company Number
     C                     PARM #1C4NB    WQ0018  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDNADFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * Unpick
      * CASE: RCD.*SFLSEL is Option 11
     C           #1SEL     IFEQ '11'                       *IF
      * Validate Unpick
      * CASE: RCD.Event Code is Shipped Thru 07 History
     C           #1JPCD    IFGE '04'                       *IF
     C           #1JPCD    ANDLE'07'
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0001           *SFLSEL
      * Send message 'Unpick Invalid'
     C                     MOVEL'USR2809' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9837  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     ELSE
      * CASE: RCD.Pick Status USR is Not Picked
     C           #RZMST    IFEQ 'N'                        *IF
      * Setup message data for message
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0002           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0002           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVEL#1SEL     ZA0003           *SFLSEL
      * Send message 'Order not picked.'
     C                     MOVEL'USR1929' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9837  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     ELSE
      * CASE: RCD.Trans Contol AS400/Plant is Plant
     C           #1XUST    IFEQ 'P'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0004           *SFLSEL
      * Send message 'Plant Floor Order'
     C                     MOVEL'USR2329' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9837  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * Del Order Inv Alloc   RT - PD Order Inv Allocation  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0001           Company Number
     C                     Z-ADD#1C4NB    WL0002           Order Number
     C                     EXSR SCRVGN
     C                     MOVEL'03'      P1JPCD           Event Code
      * Dlt Event by Event Cde RT - OP Order Events  * 
     C                     EXSR SERVGN
      * RTV Last Event Code    RT - OP Order Events  * 
     C                     EXSR SGRVGN
      * Chg Order Event        CH - PD Order Header  * 
     C                     EXSR SHCHRC
      * CHG Event Code ALL     RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0003           Company Number
     C                     Z-ADD#1C4NB    WL0004           Order Number
     C                     MOVELP1JPCD    WL0005    P      Event Code
     C                     EXSR SIRVGN
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Allocate Inventory/Print or Reprint Pick Slip
      * CASE:
      *  - c1 OR c2
      *   |- c1    : RCD.*SFLSEL is Option 6
      *   |- c2    : RCD.*SFLSEL is Option 12
      *   '-
     C           #1SEL     IFEQ '6'                        *IF
     C           #1SEL     OREQ ' 6'
     C           #1SEL     OREQ '12'                       *OR
      * Validate Print
      * CASE: RCD.*SFLSEL is Option 6
     C           #1SEL     IFEQ '6'                        *IF
     C           #1SEL     OREQ ' 6'
      * CASE: RCD.Event Code is Shipped Thru 07 History
     C           #1JPCD    IFGE '04'                       *IF
     C           #1JPCD    ANDLE'07'
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0005           *SFLSEL
      * Send message 'Pick Invalid for Order'
     C                     MOVEL'USR2813' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9837  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     ELSE
      * CASE: RCD.Trans Contol AS400/Plant is Plant
     C           #1XUST    IFEQ 'P'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0006           *SFLSEL
      * Send message 'Plant Floor Order'
     C                     MOVEL'USR2329' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9837  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate Reprint
      * CASE: RCD.*SFLSEL is Option 12
     C           #1SEL     IFEQ '12'                       *IF
      * CASE: RCD.Event Code is Entered Thru 02 Load Plan
     C           #1JPCD    IFGE '01'                       *IF
     C           #1JPCD    ANDLE'02'
      * Setup message data for message
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0007           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0007           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVEL#1SEL     ZA0008           *SFLSEL
      * Send message 'Order not picked.'
     C                     MOVEL'USR1929' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9837  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     ELSE
      * CASE: RCD.Trans Contol AS400/Plant is Plant
     C           #1XUST    IFEQ 'P'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0009           *SFLSEL
      * Send message 'Plant Floor Order'
     C                     MOVEL'USR2329' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9837  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Print Option
      * CASE: PAR.Display Prt Opt Pmt USR is *YES
     C           P4XFST    IFEQ '*YES'                     *IF
      * PMT Prt/Sbm Opt    SHR PV - Print Options  * 
     C                     CALL 'PDKMPVR'              90  PMT Prt/Sbm Opt
     C                     PARM *BLANK    W0RTN   7
     C                     PARM @CN,002   WQ0019 25        PRT Description
     C           P4WRST    PARM P4WRST    WQ0020 10        PRT Printer Dev
     C           P4WSST    PARM P4WSST    WQ0021  4        PRT Hold Output
     C           P4WTST    PARM P4WTST    WQ0022  4        PRT Save Output
     C           P4DYNB    PARM P4DYNB    WQ0023  20       PRT Number of C
     C           P4WUST    PARM P4WUST    WQ0024  1        PRT Night Queue
     C           P4BVVN    PARM P4BVVN    WQ0025 10        PRT Night Queue
     C                     PARM 'O/M'     WQ0026  6        Application Cod
     C                     PARM '1'       WQ0027  1        Paper Type USR
     C           P4BDSX    PARM P4BDSX    WQ0028  4        Hold On Jobq
     C           P4BESX    PARM P4BESX    WQ0029  4        Job Log Create
     C           P4BCSX    PARM *BLANK    WQ0030  5        Hold
     C           P4Y8CD    PARM *BLANK    WQ0031 17        Log
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDKMPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    P4XFST           Display Prt Opt
     C                     MOVEL'*NO'     P4XFST           Display Prt Opt
     C                     END                             *FI
      * Allocate Inventory/Print Pick Slip
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ @CN,003                    *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Pick Print Type
      * CASE: RCD.*SFLSEL is Option 6
     C           #1SEL     IFEQ '6'                        *IF
     C           #1SEL     OREQ ' 6'
     C                     MOVEL'P'       P5BKSX           Pick Print Type
     C                     ELSE
      * CASE: RCD.*SFLSEL is Option 12
     C           #1SEL     IFEQ '12'                       *IF
     C                     MOVEL'R'       P5BKSX           Pick Print Type
     C                     END                             *FI
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1U4ST' defaulted for 'Load Plan Order'.
      * Alc Inv/Prt Pick Slip IF
      * DOC
     C                     EXSR UASUBR                     DOC
      * Is this first print?
      * CASE: PAR.Pick Print Type USR is First Print
     C           P5BKSX    IFEQ 'P'                        *IF
      * NOTE
     C                     EXSR UBSUBR                     NOTE
      * Alc Inv/Prt Pick Slip RT - Load Detail  * 
     C                     EXSR SKRVGN
     C                     END                             *FI
      * RTV Co Document Dflts  RT - Company Document Defaults  * PGM and
     C                     EXSR SYRVGN
      * EUP Get Job Type RTVJOBA - /UT User Programs  * 
     C                     CALL 'PMN1UPC'              90  EUP Get Job Typ
     C           YL0009    PARM *BLANK    WQ0032  1        Job Type
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMN1UPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     98    *
     C                     END
     C                     Z-ADDP4DYNB    YL0010           Number of Copie
      * Submit job to batch?
      * CASE: LCL.Job Type is Interactive
     C           YL0009    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL@CN,004   ZA0010           Job
     C                     MOVELP4BVVN    ZA0011           PRT Night Queue
     C                     MOVELP4Y8CD    ZA0012           Log
     C                     MOVELP4BCSX    ZA0013           Hold
      * Retrieve message SBMJOB Override String
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR2684' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           W0SJO     PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * SBMJOB: PRT Pick Slip         UP - Load Header  * 
      *
     C                     MOVEL*BLANK    W0RTN
      * Build call string for processing in batch.
     C                     MOVEL#S0001    #SRQS     P
     C           #SRQS     CAT  #SCLL:1   #SRQS            Call command
     C                     MOVEL'PDKJUPR '#SPRG     P      Load pgm name
     C           #SRQS     CAT  #SPRG:0   #SRQS            Add pgm name
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
      * Build parameters string.
     C           #SRQS     CAT  #SPRM:1   #SRQS            Parameters
      *
     C                     Z-ADD#1RMNB    #SPAK  309       Load ID
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 7         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD#1AIC3    #SPAK  309       Company Number
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD#1C4NB    #SPAK  309       Order Number
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 7         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELP4WRST    #SSTR     P      PRT Printer Dev
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 10        #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELP4WSST    #SSTR     P      PRT Hold Output
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 4         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELP4WTST    #SSTR     P      PRT Save Output
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 4         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELYL0007    #SSTR     P      Program name US
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 10        #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELYL0008    #SSTR     P      Program Name$ U
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 10        #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADDYL0010    #SPAK  309       Number of Copie
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *
     C           W0RTN     IFNE *BLANK
      * Build of submit job string ended in error.
     C                     MOVEL'Y2U0065' W0RTN
     C                     MOVEL'PDKJUPR 'W0CLPG 10 P
      * Send message '*Error occured on SBMJOB'
     C                     MOVEL'Y2U0065' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     ELSE
      *
     C           W0SJO     IFNE *BLANK
      * Merge variable submit job overrides.
     C                     CALL 'Y2MGRQR'              90  *
     C                     PARM #SRQS     #SWRK
     C                     PARM W0SJO     #SMRG
     C  N90                MOVEL#SWRK     #SRQS     P
     C                     MOVE *BLANK    W0SJO
     C                     END
      * Submit request.
     C                     CALL 'Y2CMEXC'              90  *
     C                     PARM           #SRQS
     C                     PARM 3000      #SRQL  155
     C                     PARM           W0JVN  10
     C                     PARM           W0JUN  10
     C                     PARM           W0JNB   6
     C                     END
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDKJUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     98    *
     C                     END
      * Setup message data for message
     C                     MOVEL@CN,004   ZA0014           Job
     C                     MOVELP4BVVN    ZA0015           PRT Night Queue
      * Send message 'Job Submitted'
     C                     MOVEL'USR2685' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: LCL.Job Type is Batch
     C           YL0009    IFEQ '0'                        *IF
      * PRT Pick Slip         UP - Load Header  * 
     C                     CALL 'PDKJUPR'              90  PRT Pick Slip
     C                     PARM #1RMNB    WQ0033  70       Load ID
     C                     PARM #1AIC3    WQ0034  30       Company Number
     C                     PARM #1C4NB    WQ0035  70       Order Number
     C                     PARM P4WRST    WQ0036 10        PRT Printer Dev
     C                     PARM P4WSST    WQ0037  4        PRT Hold Output
     C                     PARM P4WTST    WQ0038  4        PRT Save Output
     C                     PARM YL0007    WQ0039 10        Program name US
     C                     PARM YL0008    WQ0040 10        Program Name$ U
     C                     PARM YL0010    WQ0041 155       Number of Copie
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDKJUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END                             *FI
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C  N99                Z-ADD##RR      ##SFRC     99    *
      * SFLNXTCHG
     C                     SETON                     84
     C                     ELSE
      * SFLRCD valid
      * SFLNXTCHG
     C                     SETOF                     84
     C                     MOVEL*BLANK    #1SEL
     C                     END                             FI *IN98
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         GBDSA2    BEGSR
      *================================================================
      * Set display attributes for Subfile control
      *================================================================
     C                     MOVEL'0'       *IN79
     C           P2I6ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @BFCPNJ fields to subfile
      *================================================================
     C                     MOVEL*BLANK    #1SEL
     C                     MOVELBEJNCD    #1JNCD           Order Type_Sale
     C                     MOVELBEOBST    #1OBST           Billing Activit
     C                     MOVELBEBCST    #1BCST           Block Order Fla
     C                     MOVELBEBDST    #1BDST           Order Certifica
     C                     Z-ADDBEB7VL    #1B7VL           Invoice Order V
     C                     MOVELBEGASX    #1GASX           Process Sts for
     C                     MOVELBEGBSX    #1GBSX           Order Conf Fax
     C                     MOVELBEGCSX    #1GCSX           Manifest Fax St
     C                     MOVELBEGDSX    #1GDSX           Invoice Fax Sts
     C                     MOVELBEFNSX    #1FNSX           Transfer in Sto
     C                     MOVELBEFOSX    #1FOSX           Email Cust On O
     C                     MOVELBEFPSX    #1FPSX           Order Emailed
     C                     MOVELBEFQSX    #1FQSX           Export Docs Go
     C                     MOVELBEFRSX    #1FRSX           Shipping Temp C
     C                     MOVELBEFSSX    #1FSSX           Broker Order St
     C                     MOVELBEFTSX    #1FTSX           Air Freight Ord
     C                     MOVELBEFUSX    #1FUSX           Order Requires
     C                     MOVELBEFVSX    #1FVSX           OH Load Plan Re
     C                     MOVELBEFWSX    #1FWSX           Export USDA App
     C                     MOVELBEFXSX    #1FXSX           HPB Ship to War
     C                     MOVELBEFYSX    #1FYSX           OH TF Exempt Co
     C                     Z-ADDBENODT    #1NODT           OH Appt Confirm
     C                     Z-ADDBENPDT    #1NPDT           JPN Invoice Iss
     C                     Z-ADDBENQDT    #1NQDT           Load Actual Shi
     C                     Z-ADDBENRDT    #1NRDT           Load BOL Comple
     C                     Z-ADDBENSDT    #1NSDT           Load Truck Depa
     C                     Z-ADDBEBPTM    #1BPTM           Maximum Gross W
     C                     Z-ADDBEBQTM    #1BQTM           Time of Origina
     C                     Z-ADDBEBRTM    #1BRTM           OH Appt Confirm
     C                     Z-ADDBEBSTM    #1BSTM           Load BOL Comple
     C                     Z-ADDBEBTTM    #1BTTM           Load Truck Depa
     C                     Z-ADDBEH0NX    #1H0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    #1H1NX           Act Non_Ref Frt
     C                     Z-ADDBEH2NX    #1H2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    #1H3NX           OH Total Non_Re
     C                     Z-ADDBEH4NX    #1H4NX           OH Total Ref Fr
     C                     Z-ADDBEC0C7    #1C0C7           Claim Number
     C                     Z-ADDBEANC7    #1ANC7           AR Customer Num
     C                     MOVELBEHMNA    #1HMNA           Ship To Address
     C                     MOVELBEHONA    #1HONA           Ship To Address
     C                     MOVELBEHPNA    #1HPNA           Ship To Address
     C                     MOVELBEHNNA    #1HNNA           Ship To City
     C                     MOVELBEDBCD    #1DBCD           Ship To State C
     C                     MOVELBECKTX    #1CKTX           Ship To Zip_Pos
     C                     Z-ADDBEB0C7    #1B0C7           Bill to Custome
     C                     Z-ADDBEA5DT    #1A5DT           Requested Ship
     C                     Z-ADDBEGNDT    #1GNDT           Actual Shipped
     C                     MOVELBEGJST    #1GJST           Order in Use
     C                     MOVELBEGXST    #1GXST           Header Status L
     C                     MOVELBEGYST    #1GYST           Order Type Prin
     C                     MOVELBEAETX    #1AETX           Bill to Name
     C                     MOVELBEB1NA    #1B1NA           Bill to Address
     C                     MOVELBEB3NA    #1B3NA           Bill to Address
     C                     MOVELBEB4NA    #1B4NA           Bill to Address
     C                     MOVELBEB2NA    #1B2NA           Bill to City
     C                     MOVELBEBHCD    #1BHCD           Bill to State C
     C                     MOVELBEC8TX    #1C8TX           Bill to Zip_Pos
     C                     MOVELBEBCNA    #1BCNA           Customer Purcha
     C                     Z-ADDBEA0DT    #1A0DT           Order Date
     C                     Z-ADDBEACDT    #1ACDT           Cancel Date
     C                     MOVELBEAQCD    #1AQCD           Terms Code
     C                     MOVELBEBYNA    #1BYNA           Special Instruc
     C                     MOVELBEB6NA    #1B6NA           Special Instruc
     C                     MOVELBEBZNA    #1BZNA           Carrier Code
     C                     Z-ADDBERMNB    #1RMNB           Load ID
     C                     Z-ADDBETBNB    #1TBNB           Absorbed Freigh
     C                     Z-ADDBER1NB    #1R1NB           Rated Freight
     C                     MOVELBEPJST    #1PJST           LTL Flag
     C                     MOVELBEU0ST    #1U0ST           Price Audit
     C                     MOVELBEU1ST    #1U1ST           Price Status
     C                     MOVELBEQ2CD    #1Q2CD           Shipping Method
     C                     MOVELBEU2ST    #1U2ST           Export Status
     C                     MOVELBEVEST    #1VEST           Palletize
     C                     MOVELBEVFST    #1VFST           Shrink Wrap
     C                     MOVELBEVGST    #1VGST           Slip Sheet
     C                     MOVELBERPCD    #1RPCD           Age Code
     C                     Z-ADDBERNNB    #1RNNB           Reefer Temperat
     C                     MOVELBEVDST    #1VDST           Load Type
     C                     Z-ADDBEATIN    #1ATIN           Attach to Invoi
     C                     MOVELBEU4ST    #1U4ST           Load Plan Order
     C                     Z-ADDBERSRN    #1RSRN           Resell Referenc
     C                     MOVELBEMHNA    #1MHNA           Special Comment
     C                     MOVELBEMINA    #1MINA           Special Comment
     C                     MOVELBEWBST    #1WBST           Affect Auto Acc
     C                     MOVELBER4CD    #1R4CD           Sales Route Cod
     C                     MOVELBEBFCD    #1BFCD           Manager Level C
     C                     MOVELBEQ4CD    #1Q4CD           VP Level Code
     C                     Z-ADDBET3NB    #1T3NB           Attach to Order
     C                     MOVELBESICD    #1SICD           Reason for Pric
     C                     Z-ADDBECONB    #1CONB           Invoice Number
     C                     MOVELBECEST    #1CEST           Invoice Suffix
     C                     Z-ADDBEAWDT    #1AWDT           Invoice Date
     C                     MOVELBEXUST    #1XUST           Trans Contol AS
     C                     MOVELBEZ1ST    #1Z1ST           Modified Flag
     C                     Z-ADDBEVRVA    #1VRVA           A_R order Value
     C                     MOVELBEUVST    #1UVST           EDI Status 1
     C                     MOVELBEUWST    #1UWST           EDI Status 2
     C                     MOVELBEUXST    #1UXST           EDI Status 3
     C                     MOVELBEGTST    #1GTST           Comment Print A
     C                     MOVELBEGVST    #1GVST           Comment Print I
     C                     MOVELBEGUST    #1GUST           Comment Print P
     C                     MOVELBECQCD    #1CQCD           Reason Code
     C                     MOVELBEAIVN    #1AIVN           User Original E
     C                     Z-ADDBECXDT    #1CXDT           Date of Origina
     C                     Z-ADDBEJZVA    #1JZVA           Order Value Tot
     C                     Z-ADDBEA1WG    #1A1WG           Order Weight To
     C                     MOVELBEXIST    #1XIST           Credit Hold
     C                     MOVELBEXJST    #1XJST           Production Hold
     C                     MOVELBEXKST    #1XKST           New Customer Ho
     C                     Z-ADDBEEIDT    #1EIDT           Requested Deliv
     C                     Z-ADDBEAFTM    #1AFTM           Requested Deliv
     C                     MOVELBEQFST    #1QFST           Comment Print S
     C                     MOVELBEE8CD    #1E8CD           Accounts Receiv
     C                     MOVELBEE9CD    #1E9CD           Accounts Receiv
     C                     Z-ADDBEAATM    #1AATM           Job Time
     C                     MOVELBEAYNA    #1AYNA           User Id
     C                     MOVELBEA0NA    #1A0NA           Job Name
     C                     Z-ADDBEAXDT    #1AXDT           Job Date
     C                     Z-ADDBEC4NB    #1C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V1C4NB
     C                     Z-ADDBEAIC3    #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
     C                     MOVELBEU5ST    #1U5ST           Print Pick Slip
     C                     MOVELBEJPCD    #1JPCD           Event Code
     C                     Z-ADDBEAODT    #1AODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V1AODT
     C                     Z-ADDBEBKC7    #1BKC7           Ship To Custome
      * Clear external version also
     C                     MOVEL*BLANK    V1BKC7
     C                     MOVELBEBRTX    #1BRTX           Ship To Name
     C                     MOVELBEGWST    #1GWST           Header Status
     C                     Z-ADD*ZERO     #RATNB           Company Number
     C                     Z-ADD*ZERO     #RNNNB           CD7 Int Numeric
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL*BLANK    #RZMST           Pick Status USR
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     MOVELP3DXTX    #PDXTX           Trailer Id
     C                     Z-ADD*ZERO     #CATNB           Company Number
     C                     Z-ADD*ZERO     #CNNNB           CD7 Int Numeric
     C                     MOVEL*BLANK    #2JNCD           Order Type_Sale
     C                     Z-ADD*ZERO     #2A5DT           Requested Ship
     C                     Z-ADDP1RMNB    #2RMNB           Load ID
     C                     MOVELP3Q2CD    #2Q2CD           Shipping Method
     C                     Z-ADDP3RPNB    #PRPNB           Total Load Orde
     C                     MOVEL*BLANK    #CAJCD           Warehouse Code
     C                     MOVELP3PKST    #PPKST           Load Status
     C                     MOVEL*BLANK    #CS2TX           Trailer ID USR
     C                     Z-ADDP3T4NB    #PT4NB           Schedule Sequen
     C                     MOVELP3RONB    #PRONB           Truck Size
     C                     Z-ADD*ZERO     #2C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V2C4NB
     C                     Z-ADD*ZERO     #2AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V2AIC3
     C                     MOVEL*BLANK    #2U5ST           Print Pick Slip
     C                     MOVEL*BLANK    #CZMST           Pick Status USR
     C                     MOVEL*BLANK    #2JPCD           Event Code
     C                     Z-ADD*ZERO     #2AODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V2AODT
     C                     Z-ADD*ZERO     #2BKC7           Ship To Custome
      * Clear external version also
     C                     MOVEL*BLANK    V2BKC7
     C                     MOVEL*BLANK    #2BRTX           Ship To Name
     C                     MOVEL*BLANK    #2GWST           Header Status
      * Check restriction within
     C                     EXSR VACKRL
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert subfile fields into external form
      *================================================================
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #1AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1AODT
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1BKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1BKC7           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#2    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #2AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V2AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #2AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2AODT
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2BKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2BKC7           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Sel Order by Whs      RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WUEASX           Whs Ord Found S
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSA01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSA02           Order Number
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           WQSA02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQSA01           Company Number
     C                     Z-ADD#1C4NB    WQSA02           Order Number
      * Establish starting position
     C           KRSSA     SETLL@BGWKL1                    *
     C           KRSSA     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           OMGMST    IFEQ 'L'                        *IF
     C           OMGMST    OREQ 'A'
     C           OMGMST    OREQ 'C'
     C           OMGMST    OREQ 'R'
     C           OMGMST    OREQ 'E'
     C           OMGMST    OREQ 'H'
     C           OMGMST    OREQ 'I'
      * CASE: PAR.Warehouse Code EQ DB1.Warehouse Code
     C           #CAJCD    IFEQ OMAJCD                     *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     MOVEL'Y'       WUEASX           Whs Ord Found S
     C                     GOTO SAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSA     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Order Pick Sts    RT - OP Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN EYAIC3    WQSB01           Company Number
     C           *LIKE     DEFN EYC4NB    WQSB02           Order Number
     C           *LIKE     DEFN EYJPCD    WQSB03           Event Code
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Order Number
     C                     KFLD           WQSB03           Event Code
      * Setup key
     C                     Z-ADD#1AIC3    WQSB01           Company Number
     C                     Z-ADD#1C4NB    WQSB02           Order Number
     C                     MOVEL'03'      WQSB03           Event Code
      * Establish starting position
     C           KRSSB     SETLL@EYCPZE                    *
     C           KRSSB     READE@EYCPZE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1074' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       #RZMST           Pick Status USR
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       #RZMST           Pick Status USR
     C           KRSSB     READE@EYCPZE                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Del Order Inv Alloc   RT - PD Order Inv Allocation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN L8AIC3    WQSC01           Company Number
     C           *LIKE     DEFN L8C4NB    WQSC02           Order Number
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Order Number
      * Setup key
     C                     Z-ADDWL0001    WQSC01           Company Number
     C                     Z-ADDWL0002    WQSC02           Order Number
      * Establish starting position
     C           KRSSC     SETLL@L8CPSY                    *
     C           KRSSC     READE@L8CPSY                  90*
      * Data record not found
     C   90                MOVEL'USR2640' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del Order Inv Alloc   DL - Order Inv Allocation  * 
     C                     EXSR SDDLRC
     C           KRSSC     READE@L8CPSY                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDDLRC    BEGSR
      *================================================================
      * Del Order Inv Alloc   DL - Order Inv Allocation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @L8CPSX
     C                     Z-ADDL8AIC3    WAAIC3           Company Number
     C                     Z-ADDL8C4NB    WAC4NB           Order Number
     C                     Z-ADDL8DPNB    WADPNB           Order Sequence
     C                     Z-ADDL8UENB    WAUENB           Order Secondary
     C                     Z-ADDL8ALSW    WAALSW           Allocation Seq
      *
     C           KLDLSD    KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
     C                     KFLD           WADPNB           Order Sequence
     C                     KFLD           WAUENB           Order Secondary
     C                     KFLD           WAALSW           Allocation Seq
     C           KLDLSD    CHAIN@L8CPSX              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDL8CPL0'MDACP
     C                     MOVEL'@L8CPSX' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@L8CPSX                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Dlt Event by Event Cde RT - OP Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSE01           Company Number
     C           *LIKE     DEFN WBC4NB    WQSE02           Order Number
     C           *LIKE     DEFN WBJPCD    WQSE03           Event Code
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WQSE02           Order Number
     C                     KFLD           WQSE03           Event Code
      * Setup key
     C                     Z-ADD#1AIC3    WQSE01           Company Number
     C                     Z-ADD#1C4NB    WQSE02           Order Number
     C                     MOVELP1JPCD    WQSE03           Event Code
      * Establish starting position
     C           KRSSE     SETLL@EYCPEH                    *
     C           KRSSE     READE@EYCPEH                  90*
      * Data record not found
     C   90                MOVEL'USR1074' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DLT OP Order Events    DL - Order Events  * 
     C                     EXSR SFDLRC
     C                     GOTO SEEXIT                     *QUIT
     C           KRSSE     READE@EYCPEH                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFDLRC    BEGSR
      *================================================================
      * DLT OP Order Events    DL - Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @EYCPY3
     C                     Z-ADDWBAIC3    WCAIC3           Company Number
     C                     Z-ADDWBC4NB    WCC4NB           Order Number
     C                     Z-ADDWBQ2NB    WCQ2NB           Event Number
      *
     C           KLDLSF    KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
     C                     KFLD           WCQ2NB           Event Number
     C           KLDLSF    CHAIN@EYCPY3              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPEYCPL0'MDACP
     C                     MOVEL'@EYCPY3' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@EYCPY3                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Last Event Code    RT - OP Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSG01           Company Number
     C           *LIKE     DEFN WDC4NB    WQSG02           Order Number
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQSG01           Company Number
     C                     Z-ADD#1C4NB    WQSG02           Order Number
      * Establish starting position
     C           KRSSG     SETLL@EYCPY2                    *
     C           KRSSG     READE@EYCPY2                  90*
      * Data record not found
     C   90                MOVEL'USR1074' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWDQ2NB    WUQ2NB           Event Number
     C                     MOVELWDJPCD    P1JPCD           Event Code
     C           KRSSG     READE@EYCPY2                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCHRC    BEGSR
      *================================================================
      * Chg Order Event        CH - PD Order Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  2        Order Type_Sale
     C                     Z-ADD*ZERO     WN0002  70       AR Customer Num
     C                     Z-ADD*ZERO     WN0003  70       Ship To Custome
     C                     MOVEL*BLANK    WN0004 30        Ship To Name
     C                     MOVEL*BLANK    WN0005 30        Ship To Address
     C                     MOVEL*BLANK    WN0006 30        Ship To Address
     C                     MOVEL*BLANK    WN0007 30        Ship To Address
     C                     MOVEL*BLANK    WN0008 20        Ship To City
     C                     MOVEL*BLANK    WN0009  2        Ship To State C
     C                     MOVEL*BLANK    WN0010 11        Ship To Zip_Pos
     C                     Z-ADD*ZERO     WN0011  70       Bill to Custome
     C                     MOVEL*BLANK    WN0012 30        Bill to Name
     C                     MOVEL*BLANK    WN0013 30        Bill to Address
     C                     MOVEL*BLANK    WN0014 30        Bill to Address
     C                     MOVEL*BLANK    WN0015 30        Bill to Address
     C                     MOVEL*BLANK    WN0016 20        Bill to City
     C                     MOVEL*BLANK    WN0017  2        Bill to State C
     C                     MOVEL*BLANK    WN0018 11        Bill to Zip_Pos
     C                     MOVEL*BLANK    WN0019 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0020  70       Order Date
     C                     Z-ADD*ZERO     WN0021  70       Requested Ship
     C                     Z-ADD*ZERO     WN0022  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0023  70       Cancel Date
     C                     MOVEL*BLANK    WN0024  2        Terms Code
     C                     MOVEL*BLANK    WN0025 40        Special Instruc
     C                     MOVEL*BLANK    WN0026 40        Special Instruc
     C                     MOVEL*BLANK    WN0027  3        Carrier Code
     C                     MOVEL*BLANK    WN0028  1        Comment Print A
     C                     MOVEL*BLANK    WN0029  1        Comment Print I
     C                     MOVEL*BLANK    WN0030  1        Comment Print P
     C                     MOVEL*BLANK    WN0031  1        Comment Print S
     C                     MOVEL*BLANK    WN0032  3        Reason Code
     C                     MOVEL*BLANK    WN0033  1        Order in Use
     C                     MOVEL*BLANK    WN0034  1        Header Status
     C                     MOVEL*BLANK    WN0035  1        Header Status L
     C                     MOVEL*BLANK    WN0036  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0037  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0038 10        User Original E
     C                     Z-ADD*ZERO     WN0039  70       Date of Origina
     C                     Z-ADD*ZERO     WN0040 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0041 112       Order Weight To
     C                     MOVEL*BLANK    WN0042  1        Credit Hold
     C                     MOVEL*BLANK    WN0043  1        Production Hold
     C                     MOVEL*BLANK    WN0044  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0045  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0046  40       Requested Deliv
     C                     MOVEL*BLANK    WN0047  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0048 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0049  70       Load ID
     C                     Z-ADD*ZERO     WN0050  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0051 112       Rated Freight
     C                     MOVEL*BLANK    WN0052  1        LTL Flag
     C                     MOVEL*BLANK    WN0053  1        Price Audit
     C                     MOVEL*BLANK    WN0054  1        Price Status
     C                     MOVEL*BLANK    WN0055  2        Shipping Method
     C                     MOVEL*BLANK    WN0056  1        Export Status
     C                     MOVEL*BLANK    WN0057  1        Palletize
     C                     MOVEL*BLANK    WN0058  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0059  1        Slip Sheet
     C                     MOVEL*BLANK    WN0060  1        Age Code
     C                     Z-ADD*ZERO     WN0061  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0062  1        Load Type
     C                     Z-ADD*ZERO     WN0063  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0064  1        Load Plan Order
     C                     MOVEL*BLANK    WN0065  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0066  70       Resell Referenc
     C                     MOVEL*BLANK    WN0067 30        Special Comment
     C                     MOVEL*BLANK    WN0068 30        Special Comment
     C                     MOVEL*BLANK    WN0069  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0070  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0071  2        Manager Level C
     C                     MOVEL*BLANK    WN0072  3        VP Level Code
     C                     Z-ADD*ZERO     WN0073  70       Attach to Order
     C                     MOVEL*BLANK    WN0074  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0075  70       Invoice Number
     C                     MOVEL*BLANK    WN0076  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0077  70       Invoice Date
     C                     MOVEL*BLANK    WN0078  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0079  1        Modified Flag
     C                     Z-ADD*ZERO     WN0080 112       A_R order Value
     C                     MOVEL*BLANK    WN0081  1        Billing Activit
     C                     MOVEL*BLANK    WN0082  1        Block Order Fla
     C                     MOVEL*BLANK    WN0083  1        Order Certifica
     C                     Z-ADD*ZERO     WN0084 112       Invoice Order V
     C                     MOVEL*BLANK    WN0085  1        Process Sts for
     C                     MOVEL*BLANK    WN0086  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0087  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0088  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0089  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0090  1        Email Cust On O
     C                     MOVEL*BLANK    WN0091  1        Order Emailed
     C                     MOVEL*BLANK    WN0092  1        Export Docs Go
     C                     MOVEL*BLANK    WN0093  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0094  1        Broker Order St
     C                     MOVEL*BLANK    WN0095  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0096  2        Order Requires
     C                     MOVEL*BLANK    WN0097  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0098  2        Export USDA App
     C                     MOVEL*BLANK    WN0099  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0100  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0101  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0102  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0103  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0104  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0105  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0106  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0107  60       Time of Origina
     C                     Z-ADD*ZERO     WN0108  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0109  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0110  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0111 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0112 112       Act Non_Ref Frt
     C                     Z-ADD*ZERO     WN0113 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0114 112       OH Total Non_Re
     C                     Z-ADD*ZERO     WN0115 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0116  70       Claim Number
     C                     MOVEL*BLANK    WN0117  1        EDI Status 1
     C                     MOVEL*BLANK    WN0118  1        EDI Status 2
     C                     MOVEL*BLANK    WN0119  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0120  60       Job Time
     C                     MOVEL*BLANK    WN0121 10        User Id
     C                     MOVEL*BLANK    WN0122 10        Job Name
     C                     Z-ADD*ZERO     WN0123  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADD#1AIC3    WEAIC3           Company Number
     C                     Z-ADD#1C4NB    WEC4NB           Order Number
      *
     C           KLCHSH    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C           KLCHSH    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YARDCS
      * Move non-key fields to @BECPFJ
     C                     MOVELP1JPCD    WEJPCD    P      Event Code
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##PGM     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPARC
     C                     Z-ADDWEAIC3    PAAIC3           Company Number
     C                     Z-ADDWEC4NB    PAC4NB           Order Number
     C                     MOVELWEJNCD    PAJNCD    P      Order Type_Sale
     C                     Z-ADDWEANC7    PAANC7           AR Customer Num
     C                     Z-ADDWEBKC7    PABKC7           Ship To Custome
     C                     MOVELWEBRTX    PABRTX    P      Ship To Name
     C                     MOVELWEHMNA    PAHMNA    P      Ship To Address
     C                     MOVELWEHONA    PAHONA    P      Ship To Address
     C                     MOVELWEHPNA    PAHPNA    P      Ship To Address
     C                     MOVELWEHNNA    PAHNNA    P      Ship To City
     C                     MOVELWEDBCD    PADBCD    P      Ship To State C
     C                     MOVELWECKTX    PACKTX    P      Ship To Zip_Pos
     C                     Z-ADDWEB0C7    PAB0C7           Bill to Custome
     C                     MOVELWEAETX    PAAETX    P      Bill to Name
     C                     MOVELWEB1NA    PAB1NA    P      Bill to Address
     C                     MOVELWEB3NA    PAB3NA    P      Bill to Address
     C                     MOVELWEB4NA    PAB4NA    P      Bill to Address
     C                     MOVELWEB2NA    PAB2NA    P      Bill to City
     C                     MOVELWEBHCD    PABHCD    P      Bill to State C
     C                     MOVELWEC8TX    PAC8TX    P      Bill to Zip_Pos
     C                     MOVELWEBCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDWEA0DT    PAA0DT           Order Date
     C                     Z-ADDWEA5DT    PAA5DT           Requested Ship
     C                     Z-ADDWEGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDWEACDT    PAACDT           Cancel Date
     C                     MOVELWEAQCD    PAAQCD    P      Terms Code
     C                     MOVELWEB6NA    PAB6NA    P      Special Instruc
     C                     MOVELWEBYNA    PABYNA    P      Special Instruc
     C                     MOVELWEBZNA    PABZNA    P      Carrier Code
     C                     MOVELWEGTST    PAGTST    P      Comment Print A
     C                     MOVELWEGVST    PAGVST    P      Comment Print I
     C                     MOVELWEGUST    PAGUST    P      Comment Print P
     C                     MOVELWEQFST    PAQFST    P      Comment Print S
     C                     MOVELWECQCD    PACQCD    P      Reason Code
     C                     MOVELWEGJST    PAGJST    P      Order in Use
     C                     MOVELWEGWST    PAGWST    P      Header Status
     C                     MOVELWEGXST    PAGXST    P      Header Status L
     C                     MOVELWEGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDWEAODT    PAAODT           Scheduled Ship
     C                     MOVELWEAIVN    PAAIVN    P      User Original E
     C                     Z-ADDWECXDT    PACXDT           Date of Origina
     C                     Z-ADDWEJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDWEA1WG    PAA1WG           Order Weight To
     C                     MOVELWEXIST    PAXIST    P      Credit Hold
     C                     MOVELWEXJST    PAXJST    P      Production Hold
     C                     MOVELWEXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDWEEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDWEAFTM    PAAFTM           Requested Deliv
     C                     MOVELWEE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELWEE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDWERMNB    PARMNB           Load ID
     C                     Z-ADDWETBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDWER1NB    PAR1NB           Rated Freight
     C                     MOVELWEPJST    PAPJST    P      LTL Flag
     C                     MOVELWEU0ST    PAU0ST    P      Price Audit
     C                     MOVELWEU1ST    PAU1ST    P      Price Status
     C                     MOVELWEQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELWEU2ST    PAU2ST    P      Export Status
     C                     MOVELWEVEST    PAVEST    P      Palletize
     C                     MOVELWEVFST    PAVFST    P      Shrink Wrap
     C                     MOVELWEVGST    PAVGST    P      Slip Sheet
     C                     MOVELWERPCD    PARPCD    P      Age Code
     C                     Z-ADDWERNNB    PARNNB           Reefer Temperat
     C                     MOVELWEVDST    PAVDST    P      Load Type
     C                     Z-ADDWEATIN    PAATIN           Attach to Invoi
     C                     MOVELWEU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELWEU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDWERSRN    PARSRN           Resell Referenc
     C                     MOVELWEMHNA    PAMHNA    P      Special Comment
     C                     MOVELWEMINA    PAMINA    P      Special Comment
     C                     MOVELWEWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELWER4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELWEBFCD    PABFCD    P      Manager Level C
     C                     MOVELWEQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDWET3NB    PAT3NB           Attach to Order
     C                     MOVELWESICD    PASICD    P      Reason for Pric
     C                     Z-ADDWECONB    PACONB           Invoice Number
     C                     MOVELWECEST    PACEST    P      Invoice Suffix
     C                     Z-ADDWEAWDT    PAAWDT           Invoice Date
     C                     MOVELWEJPCD    PAJPCD    P      Event Code
     C                     MOVELWEXUST    PAXUST    P      Trans Contol AS
     C                     MOVELWEZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDWEVRVA    PAVRVA           A_R order Value
     C                     MOVELWEOBST    PAOBST    P      Billing Activit
     C                     MOVELWEBCST    PABCST    P      Block Order Fla
     C                     MOVELWEBDST    PABDST    P      Order Certifica
     C                     Z-ADDWEB7VL    PAB7VL           Invoice Order V
     C                     MOVELWEGASX    PAGASX    P      Process Sts for
     C                     MOVELWEGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELWEGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELWEGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELWEFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELWEFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELWEFPSX    PAFPSX    P      Order Emailed
     C                     MOVELWEFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELWEFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELWEFSSX    PAFSSX    P      Broker Order St
     C                     MOVELWEFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELWEFUSX    PAFUSX    P      Order Requires
     C                     MOVELWEFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELWEFWSX    PAFWSX    P      Export USDA App
     C                     MOVELWEFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELWEFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDWENODT    PANODT           OH Appt Confirm
     C                     Z-ADDWENPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDWENQDT    PANQDT           Load Actual Shi
     C                     Z-ADDWENRDT    PANRDT           Load BOL Comple
     C                     Z-ADDWENSDT    PANSDT           Load Truck Depa
     C                     Z-ADDWEBPTM    PABPTM           Maximum Gross W
     C                     Z-ADDWEBQTM    PABQTM           Time of Origina
     C                     Z-ADDWEBRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDWEBSTM    PABSTM           Load BOL Comple
     C                     Z-ADDWEBTTM    PABTTM           Load Truck Depa
     C                     Z-ADDWEH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDWEH1NX    PAH1NX           Act Non_Ref Frt
     C                     Z-ADDWEH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDWEH3NX    PAH3NX           OH Total Non_Re
     C                     Z-ADDWEH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDWEC0C7    PAC0C7           Claim Number
     C                     MOVELWEUVST    PAUVST    P      EDI Status 1
     C                     MOVELWEUWST    PAUWST    P      EDI Status 2
     C                     MOVELWEUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDWEAATM    PAAATM           Job Time
     C                     MOVELWEAYNA    PAAYNA    P      User Id
     C                     MOVELWEA0NA    PAA0NA    P      Job Name
     C                     Z-ADDWEAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * CHG Event Code ALL     RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSI01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSI02           Order Number
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Company Number
     C                     KFLD           WQSI02           Order Number
      * Setup key
     C                     Z-ADDWL0003    WQSI01           Company Number
     C                     Z-ADDWL0004    WQSI02           Order Number
      * Establish starting position
     C           KRSSI     SETLL@BGWKL1                    *
     C           KRSSI     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG Event Code         CH - Order Detail  * 
     C                     EXSR SJCHRC
     C           KRSSI     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCHRC    BEGSR
      *================================================================
      * CHG Event Code         CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0124  70       Item Code
     C                     MOVEL*BLANK    WN0125  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0126  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0127  70       Order Group Cod
     C                     MOVEL*BLANK    WN0128  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0129  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0130 112       Billing Detail
     C                     Z-ADD*ZERO     WN0131 112       Billing Detail
     C                     Z-ADD*ZERO     WN0132 112       Billing Detail
     C                     Z-ADD*ZERO     WN0133 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0134  1        Comment Print A
     C                     MOVEL*BLANK    WN0135  1        Comment Print I
     C                     MOVEL*BLANK    WN0136  1        Comment Print P
     C                     MOVEL*BLANK    WN0137  1        Comment Print S
     C                     Z-ADD*ZERO     WN0138 112       Extended Amount
     C                     Z-ADD*ZERO     WN0139  70       Market Pricing
     C                     MOVEL*BLANK    WN0140  3        Commodity Marke
     C                     MOVEL*BLANK    WN0141  3        Date Method Cod
     C                     MOVEL*BLANK    WN0142  3        Price Method Co
     C                     Z-ADD*ZERO     WN0143 114       Price Overage O
     C                     Z-ADD*ZERO     WN0144  70       Contract Number
     C                     MOVEL*BLANK    WN0145  1        Price Status
     C                     Z-ADD*ZERO     WN0146  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0147  2        U_M_Base Price
     C                     MOVEL*BLANK    WN0148  2        U_M_Ordered
     C                     MOVEL*BLANK    WN0149  1        Work Confirm St
     C                     MOVEL*BLANK    WN0150  1        Work Over_Short
     C                     MOVEL*BLANK    WN0151  1        OD Production P
     C                     MOVEL*BLANK    WN0152 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0153 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0154  1        Age Code
     C                     MOVEL*BLANK    WN0155  1        Palletize
     C                     MOVEL*BLANK    WN0156  1        Slip Sheet
     C                     MOVEL*BLANK    WN0157  1        Catch Weight St
     C                     MOVEL*BLANK    WN0158  1        Price Audit
     C                     MOVEL*BLANK    WN0159  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0160  1        Production Date
     C                     Z-ADD*ZERO     WN0161 112       Rated Freight
     C                     Z-ADD*ZERO     WN0162 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0163 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0164 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0165 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0166 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0167 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0168 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0169 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0170 114       Unit Price
     C                     Z-ADD*ZERO     WN0171 114       Unit Price_Cred
     C                     Z-ADD*ZERO     WN0172 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0173 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0174 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0175  70       Requested Ship
     C                     Z-ADD*ZERO     WN0176  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0177  70       Actual Shipped
     C                     MOVEL*BLANK    WN0178  1        Affect Inventor
     C                     MOVEL*BLANK    WN0179  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0180  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0181  30       Item Structure
     C                     Z-ADD*ZERO     WN0182  30       Item Structure
     C                     Z-ADD*ZERO     WN0183  30       Item Structure
     C                     MOVEL*BLANK    WN0184  2        Item Level
     C                     MOVEL*BLANK    WN0185  2        Quality Level
     C                     MOVEL*BLANK    WN0186  2        Pricing Product
     C                     MOVEL*BLANK    WN0187  2        Season Product
     C                     Z-ADD*ZERO     WN0188  70       Date of Origina
     C                     MOVEL*BLANK    WN0189 10        User Profile Na
     C                     MOVEL*BLANK    WN0190  6        Country Code
     C                     MOVEL*BLANK    WN0191  3        Reason Code
     C                     MOVEL*BLANK    WN0192  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0193  1        Modified Flag
     C                     MOVEL*BLANK    WN0194  1        Substituted Fla
     C                     MOVEL*BLANK    WN0195  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0196 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0197 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0198  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0199  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0200  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0201  1        Affect Commissi
     C                     MOVEL*BLANK    WN0202  1        Affect Pricing
     C                     MOVEL*BLANK    WN0203  1        Released by Use
     C                     MOVEL*BLANK    WN0204  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0205  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0206  3        Production Ware
     C                     MOVEL*BLANK    WN0207  3        OD Price Type
     C                     Z-ADD*ZERO     WN0208  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0209  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0210  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0211  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0212  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0213  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0214  60       Price Code
     C                     Z-ADD*ZERO     WN0215  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0216  60       Substitution Li
     C                     Z-ADD*ZERO     WN0217  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0218 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0219 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0220 112       OD Item Target
     C                     Z-ADD*ZERO     WN0221 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0222 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0223 114       Order Gate_Fina
     C                     Z-ADD*ZERO     WN0224 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0225 114       OD Gate_Final P
     C                     Z-ADD*ZERO     WN0226 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0227 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0228 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0229 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0230 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0231  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0232  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0233  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0234 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0235  40       Item Age Days
     C                     Z-ADD*ZERO     WN0236  70       Production Ovr
     C                     Z-ADD*ZERO     WN0237  70       Production Ovr
     C                     MOVEL*BLANK    WN0238  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0239  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0240  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0241  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0242  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0243  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0244  1        EDI Status 1
     C                     MOVEL*BLANK    WN0245  1        EDI Status 2
     C                     MOVEL*BLANK    WN0246  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0247  60       Job Time
     C                     MOVEL*BLANK    WN0248 10        User Id
     C                     MOVEL*BLANK    WN0249 10        Job Name
     C                     Z-ADD*ZERO     WN0250  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDOMAIC3    WFAIC3           Company Number
     C                     Z-ADDOMC4NB    WFC4NB           Order Number
     C                     Z-ADDOMDPNB    WFDPNB           Order Sequence
     C                     Z-ADDOMUENB    WFUENB           Order Secondary
      *
     C           KLCHSJ    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFC4NB           Order Number
     C                     KFLD           WFDPNB           Order Sequence
     C                     KFLD           WFUENB           Order Secondary
     C           KLCHSJ    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YBRDCS
      * Move non-key fields to @BGWKL0
     C                     MOVELWL0005    WFJPCD    P      Event Code
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WFAATM           Job Time
     C                     MOVEL##USR     WFAYNA           User Id
     C                     MOVEL##PGM     WFA0NA           Job Name
     C                     Z-ADD##JDT     WFAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Alc Inv/Prt Pick Slip RT - Load Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0251  1        Record Selected
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQSK02           Load ID
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSK02           Load ID
      * Establish starting position
     C           KRSSK     SETLL@FLCPE8                    *
     C           KRSSK     READE@FLCPE8                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WN0251           Record Selected
      * Select Order
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Order Number is Not equal to zeros
      *   |- c2    : PAR.Order Number NE DB1.Order Number
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1C4NB    IFNE 0                          *IF
     C           #1C4NB    IFNE FLC4NB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       WN0251           Record Selected
     C                     END                             *FI
      * Process Order
      * CASE: PAR.Record Selected       USR is yes
     C           WN0251    IFEQ 'Y'                        *IF
      * Alc Inv/Prt Pick Slip IF
      * Delete existing Order Inv Allocation records.
      * Del Order Inv Alloc   RT - PD Order Inv Allocation  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0001           Company Number
     C                     Z-ADDFLC4NB    WL0002           Order Number
     C                     EXSR SCRVGN
      * Alc Inv/Prt Pick Slip RT - PD Order Detail  * 
     C                     EXSR SLRVGN
      * P00196 RMC 5/09/14  Chk PFS Interface PFSPCK=Y INSTEAD,SO cat2 wi
      *   still allow picking
      * Rtv Active Status     RT - PFS Interface  * 
     C                     EXSR SQRVGN
      * S00930 RMC 9/02/09   Update event to 03 if Whse is not live with
      *  because if it is, Carlisle will create the Picked Event "PO" rcd
      * E8197  DN 12/22/16 - Replaced RTVOBJ with new one to NOT select
      *   Order Detail lines that are cancelled.
      * RTV 1st Whse Not CancelRT - Order Detail  * 
     C                     EXSR SRRVGN
      * Rtv Live w/CT PFS Int RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0004    WL0040    P      Warehouse Code
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0041    YL0005    P      WHS Live with C
     C                     MOVELWL0042    YL0006    P      WHS PFS Interfa
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.WHS Live w/Carlisle is Yes
      *   |- c2    : LCL.PFS Carlisle Active is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0005    IFEQ 'Y'                        *IF
     C           YL0003    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Upd Pick Event        RT - Order Events  * 
     C                     EXSR STRVGN
      * CHG Order Event Code   RT - Order Header TRG  * 
     C                     EXSR SWRVGN
      * CHG Event Code ALL     RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0003           Company Number
     C                     Z-ADDFLC4NB    WL0004           Order Number
     C                     MOVEL'03'      WL0005    P      Event Code
     C                     EXSR SIRVGN
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSK     READE@FLCPE8                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Alc Inv/Prt Pick Slip RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSL01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSL02           Order Number
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Company Number
     C                     KFLD           WQSL02           Order Number
      * Setup key
     C                     Z-ADDFLAIC3    WQSL01           Company Number
     C                     Z-ADDFLC4NB    WQSL02           Order Number
      * Establish starting position
     C           KRSSL     SETLL@BGWKL1                    *
     C           KRSSL     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not Comp/Canc/Conf
     C           OMGMST    IFEQ 'L'                        *IF
     C           OMGMST    OREQ 'A'
     C           OMGMST    OREQ 'E'
     C           OMGMST    OREQ 'H'
      * Alc Inventory         RT - IC Item Lot Location  * 
     C                     EXSR SMRVGN
     C                     END                             *FI
     C           KRSSL     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Alc Inventory         RT - IC Item Lot Location  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0252  50       Quantity Avail
     C                     Z-ADD*ZERO     WN0253  61       Quantity Need U
     C                     Z-ADD*ZERO     WN0254 112       OIA Alloc_Shipp
     C                     Z-ADD*ZERO     WN0255 112       OIA Serial Numb
     C                     MOVEL*BLANK    WN0256  1        OIA Create Sts
     C                     MOVEL*BLANK    WN0257  1        OIA Modified St
     C                     MOVEL*BLANK    WN0258  1        OIA Allocation
     C                     MOVEL*BLANK    WN0259  2        OIA Loc Pick St
     C                     MOVEL*BLANK    WN0260  1        OIA Unused Sts
     C                     MOVEL*BLANK    WN0261  2        OIA Unused Sts
     C                     MOVEL*BLANK    WN0262  1        EDI Status 1
     C                     MOVEL*BLANK    WN0263  1        EDI Status 2
     C                     MOVEL*BLANK    WN0264  1        EDI Status 3
     C                     MOVEL*BLANK    WN0265  1        Record Status
     C                     Z-ADD*ZERO     WN0266  60       Job Time
     C                     MOVEL*BLANK    WN0267 10        User Id
     C                     MOVEL*BLANK    WN0268 10        Job Name
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0252           Quantity Avail
     C                     Z-ADD*ZERO     WN0253           Quantity Need U
     C                     Z-ADD*ZERO     WN0254           OIA Alloc_Shipp
     C                     Z-ADD*ZERO     WN0255           OIA Serial Numb
     C                     MOVEL*BLANK    WN0256           OIA Create Sts
     C                     MOVEL*BLANK    WN0257           OIA Modified St
     C                     MOVEL*BLANK    WN0258           OIA Allocation
     C                     MOVEL*BLANK    WN0259           OIA Loc Pick St
     C                     MOVEL*BLANK    WN0260           OIA Unused Sts
     C                     MOVEL*BLANK    WN0261           OIA Unused Sts
     C                     MOVEL*BLANK    WN0262           EDI Status 1
     C                     MOVEL*BLANK    WN0263           EDI Status 2
     C                     MOVEL*BLANK    WN0264           EDI Status 3
     C                     MOVEL*BLANK    WN0265           Record Status
     C                     Z-ADD*ZERO     WN0266           Job Time
     C                     MOVEL*BLANK    WN0267           User Id
     C                     MOVEL*BLANK    WN0268           Job Name
     C                     Z-ADDOMCCQT    WN0253           Quantity Need U
     C                     MOVEL'A'       WN0256           OIA Create Sts
     C                     MOVEL'N'       WN0257           OIA Modified St
     C                     MOVEL'A'       WN0258           OIA Allocation
     C                     MOVEL*BLANK    WN0259           OIA Loc Pick St
      * Declare restrictor key work fields
     C           *LIKE     DEFN L5AIC3    WQSM01           Company Number
     C           *LIKE     DEFN L5HGCD    WQSM02           Item Code
     C           *LIKE     DEFN L5AJCD    WQSM03           Warehouse Code
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           Item Code
     C                     KFLD           WQSM03           Warehouse Code
      * Setup key
     C                     Z-ADDOMAIC3    WQSM01           Company Number
     C                     Z-ADDOMHGCD    WQSM02           Item Code
     C                     MOVELOMAJCD    WQSM03           Warehouse Code
      * Establish starting position
     C           KRSSM     SETLL@L5CPUQ                    *
     C           KRSSM     READE@L5CPUQ                  90*
      * Data record not found
     C   90                MOVEL'USR2634' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Quantity Need USR is EQ Zero
     C           WN0253    IFEQ 0                          *IF
     C                     GOTO SMEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.ILL Status is Available
     C           L5AMSX    IFEQ 'A'                        *IF
      * Rtv Available Qty     RT - PD Order Inv Allocation  * 
     C                     EXSR SNRVGN
      * Quantity Available > 0
      * CASE: PAR.Quantity Avail USR is GT Zero
     C           WN0252    IFGT 0                          *IF
      * Create Order Inventory Allocation Record.
      * CASE: PAR.Quantity Need USR GE PAR.Quantity Avail USR
     C           WN0253    IFGE WN0252                     *IF
     C                     MOVEL'CO'      WN0259           OIA Loc Pick St
      *
     C                     Z-ADD*ZERO     WN0270  50       Allocation Seq
      *
      * Crt Order Inv Alloc   IF
      * Rtv Next Seq Num      RT - Order Inv Allocation  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDOMAIC3    WL0006           Company Number
     C                     Z-ADDOMC4NB    WL0007           Order Number
     C                     Z-ADDOMDPNB    WL0008           Order Sequence
     C                     Z-ADDOMUENB    WL0009           Order Secondary
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0010    WN0270           Allocation Seq
      * Crt Order Inv Alloc   CR - Order Inv Allocation  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDOMAIC3    WL0011           Company Number
     C                     Z-ADDOMC4NB    WL0012           Order Number
     C                     Z-ADDOMDPNB    WL0013           Order Sequence
     C                     Z-ADDOMUENB    WL0014           Order Secondary
     C                     Z-ADDWN0270    WL0015           Allocation Seq
     C                     Z-ADDWN0252    WL0016           OIA Alloc_Shipp
     C                     Z-ADDWN0254    WL0017           OIA Alloc_Shipp
     C                     Z-ADDL5J3QT    WL0018           OIA Co-Packer L
     C                     Z-ADDWN0255    WL0019           OIA Serial Numb
     C                     MOVELWN0256    WL0020    P      OIA Create Sts
     C                     MOVELWN0257    WL0021    P      OIA Modified St
     C                     MOVELWN0258    WL0022    P      OIA Allocation
     C                     MOVELWN0259    WL0023    P      OIA Loc Pick St
     C                     MOVELWN0260    WL0024    P      OIA Unused Sts
     C                     MOVELWN0261    WL0025    P      OIA Unused Sts
     C                     Z-ADDL5HGCD    WL0026           Item Code
     C                     MOVELL5AJCD    WL0027    P      Warehouse Code
     C                     Z-ADDL5ELDT    WL0028           Production Date
     C                     Z-ADDL5LXNM    WL0029           Lot Number
     C                     MOVELL5YMCD    WL0030    P      Location Code
     C                     Z-ADDL5YNCD    WL0031           Location Level
     C                     MOVELWN0262    WL0032    P      EDI Status 1
     C                     MOVELWN0263    WL0033    P      EDI Status 2
     C                     MOVELWN0264    WL0034    P      EDI Status 3
     C                     MOVELWN0265    WL0035    P      Record Status
     C                     Z-ADDWN0266    WL0036           Job Time
     C                     MOVELWN0267    WL0037    P      User Id
     C                     MOVELWN0268    WL0038    P      Job Name
     C                     Z-ADDOMAXDT    WL0039           Job Date
     C                     EXSR SPCRRC
     C                     SUB  WN0252    WN0253           Quantity Need U
     C                     ELSE
      * CASE: PAR.Quantity Need USR LT PAR.Quantity Avail USR
     C           WN0253    IFLT WN0252                     *IF
     C                     MOVEL*BLANK    WN0259           OIA Loc Pick St
      *
     C                     Z-ADD*ZERO     WN0271  50       Allocation Seq
      *
      * Crt Order Inv Alloc   IF
      * Rtv Next Seq Num      RT - Order Inv Allocation  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDOMAIC3    WL0006           Company Number
     C                     Z-ADDOMC4NB    WL0007           Order Number
     C                     Z-ADDOMDPNB    WL0008           Order Sequence
     C                     Z-ADDOMUENB    WL0009           Order Secondary
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0010    WN0271           Allocation Seq
      * Crt Order Inv Alloc   CR - Order Inv Allocation  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDOMAIC3    WL0011           Company Number
     C                     Z-ADDOMC4NB    WL0012           Order Number
     C                     Z-ADDOMDPNB    WL0013           Order Sequence
     C                     Z-ADDOMUENB    WL0014           Order Secondary
     C                     Z-ADDWN0271    WL0015           Allocation Seq
     C                     Z-ADDWN0253    WL0016           OIA Alloc_Shipp
     C                     Z-ADDWN0254    WL0017           OIA Alloc_Shipp
     C                     Z-ADDL5J3QT    WL0018           OIA Co-Packer L
     C                     Z-ADDWN0255    WL0019           OIA Serial Numb
     C                     MOVELWN0256    WL0020    P      OIA Create Sts
     C                     MOVELWN0257    WL0021    P      OIA Modified St
     C                     MOVELWN0258    WL0022    P      OIA Allocation
     C                     MOVELWN0259    WL0023    P      OIA Loc Pick St
     C                     MOVELWN0260    WL0024    P      OIA Unused Sts
     C                     MOVELWN0261    WL0025    P      OIA Unused Sts
     C                     Z-ADDL5HGCD    WL0026           Item Code
     C                     MOVELL5AJCD    WL0027    P      Warehouse Code
     C                     Z-ADDL5ELDT    WL0028           Production Date
     C                     Z-ADDL5LXNM    WL0029           Lot Number
     C                     MOVELL5YMCD    WL0030    P      Location Code
     C                     Z-ADDL5YNCD    WL0031           Location Level
     C                     MOVELWN0262    WL0032    P      EDI Status 1
     C                     MOVELWN0263    WL0033    P      EDI Status 2
     C                     MOVELWN0264    WL0034    P      EDI Status 3
     C                     MOVELWN0265    WL0035    P      Record Status
     C                     Z-ADDWN0266    WL0036           Job Time
     C                     MOVELWN0267    WL0037    P      User Id
     C                     MOVELWN0268    WL0038    P      Job Name
     C                     Z-ADDOMAXDT    WL0039           Job Date
     C                     EXSR SPCRRC
     C                     Z-ADD*ZERO     WN0253           Quantity Need U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSM     READE@L5CPUQ                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Available Qty     RT - PD Order Inv Allocation  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0269 112       Quantity Schedu
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0269           Quantity Schedu
     C                     Z-ADD*ZERO     WN0252           Quantity Avail
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGAIC3    WQSN01           Company Number
     C           *LIKE     DEFN WGHGCD    WQSN02           Item Code
     C           *LIKE     DEFN WGAJCD    WQSN03           Warehouse Code
     C           *LIKE     DEFN WGELDT    WQSN04           Production Date
     C           *LIKE     DEFN WGLXNM    WQSN05           Lot Number
     C           *LIKE     DEFN WGYMCD    WQSN06           Location Code
     C           *LIKE     DEFN WGYNCD    WQSN07           Location Level
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Company Number
     C                     KFLD           WQSN02           Item Code
     C                     KFLD           WQSN03           Warehouse Code
     C                     KFLD           WQSN04           Production Date
     C                     KFLD           WQSN05           Lot Number
     C                     KFLD           WQSN06           Location Code
     C                     KFLD           WQSN07           Location Level
      * Setup key
     C                     Z-ADDL5AIC3    WQSN01           Company Number
     C                     Z-ADDL5HGCD    WQSN02           Item Code
     C                     MOVELL5AJCD    WQSN03           Warehouse Code
     C                     Z-ADDL5ELDT    WQSN04           Production Date
     C                     Z-ADDL5LXNM    WQSN05           Lot Number
     C                     MOVELL5YMCD    WQSN06           Location Code
     C                     Z-ADDL5YNCD    WQSN07           Location Level
      * Establish starting position
     C           KRSSN     SETLL@L8CPTA                    *
     C           KRSSN     READE@L8CPTA                  90*
      * Data record not found
     C   90                MOVEL'USR2640' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WGJ6QT    WN0269           Quantity Schedu
     C           KRSSN     READE@L8CPTA                  90*
     C                     ENDDO
      * USER: Exit processing
     C           L5J2QT    SUB  WN0269    WN0252           Quantity Avail
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Next Seq Num      RT - Order Inv Allocation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHAIC3    WQSO01           Company Number
     C           *LIKE     DEFN WHC4NB    WQSO02           Order Number
     C           *LIKE     DEFN WHDPNB    WQSO03           Order Sequence
     C           *LIKE     DEFN WHUENB    WQSO04           Order Secondary
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Company Number
     C                     KFLD           WQSO02           Order Number
     C                     KFLD           WQSO03           Order Sequence
     C                     KFLD           WQSO04           Order Secondary
      * Setup key
     C                     Z-ADDWL0006    WQSO01           Company Number
     C                     Z-ADDWL0007    WQSO02           Order Number
     C                     Z-ADDWL0008    WQSO03           Order Sequence
     C                     Z-ADDWL0009    WQSO04           Order Secondary
      * Establish starting position
     C           KRSSO     SETLL@L8CPTD                    *
     C           KRSSO     READE@L8CPTD                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2640' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WL0010           Allocation Seq
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WHALSW    ADD  1         WL0010           Allocation Seq
     C                     GOTO SOEXIT                     *QUIT
     C           KRSSO     READE@L8CPTD                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPCRRC    BEGSR
      *================================================================
      * Crt Order Inv Alloc   CR - Order Inv Allocation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @L8CPSX
     C                     Z-ADDWL0011    WAAIC3           Company Number
     C                     Z-ADDWL0012    WAC4NB           Order Number
     C                     Z-ADDWL0013    WADPNB           Order Sequence
     C                     Z-ADDWL0014    WAUENB           Order Secondary
     C                     Z-ADDWL0015    WAALSW           Allocation Seq
     C                     Z-ADDWL0016    WAJ6QT           OIA Alloc_Shipp
     C                     Z-ADDWL0017    WAG9WG           OIA Alloc_Shipp
     C                     Z-ADDWL0018    WAJ9QT           OIA Co-Packer L
     C                     Z-ADDWL0019    WAHAWG           OIA Serial Numb
     C                     MOVELWL0020    WAIOSE           OIA Create Sts
     C                     MOVELWL0021    WAOIMN           OIA Modified St
     C                     MOVELWL0022    WASOAS           OIA Allocation
     C                     MOVELWL0023    WAARSX           OIA Loc Pick St
     C                     MOVELWL0024    WAOTUS           OIA Unused Sts
     C                     MOVELWL0025    WAOTMP           OIA Unused Sts
     C                     Z-ADDWL0026    WAHGCD           Item Code
     C                     MOVELWL0027    WAAJCD           Warehouse Code
     C                     Z-ADDWL0028    WAELDT           Production Date
     C                     Z-ADDWL0029    WALXNM           Lot Number
     C                     MOVELWL0030    WAYMCD           Location Code
     C                     Z-ADDWL0031    WAYNCD           Location Level
     C                     MOVELWL0032    WAUVST           EDI Status 1
     C                     MOVELWL0033    WAUWST           EDI Status 2
     C                     MOVELWL0034    WAUXST           EDI Status 3
     C                     MOVELWL0035    WAVSST           Record Status
     C                     Z-ADDWL0036    WAAATM           Job Time
     C                     MOVELWL0037    WAAYNA           User Id
     C                     MOVELWL0038    WAA0NA           Job Name
     C                     Z-ADDWL0039    WAAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WAVSST           Record Status
     C                     Z-ADD##JTM     WAAATM           Job Time
     C                     MOVEL##USR     WAAYNA           User Id
     C                     MOVEL##PGM     WAA0NA           Job Name
     C                     Z-ADD##JDT     WAAXDT           Job Date
     C           KLCRSP    KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
     C                     KFLD           WADPNB           Order Sequence
     C                     KFLD           WAUENB           Order Secondary
     C                     KFLD           WAALSW           Allocation Seq
      * Check for duplicate primary key
     C           KLCRSP    SETLL@L8CPSX                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2641' W0RTN   7
      * Send message 'Order Inv Allocation   EX'
     C                     MOVEL'USR2641' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C                     WRITE@L8CPSX                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Rtv Active Status     RT - PFS Interface  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           BUY1NX           PFS Company Num
     C                     KFLD           BUGYAA           PFS Interface C
      * Setup key
     C                     Z-ADDFLAIC3    BUY1NX           PFS Company Num
     C                     MOVEL'PFSPCK'  BUGYAA           PFS Interface C
      * Establish starting position
     C           KRSSQ     CHAIN@BUREBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3541' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0002           PFS AccuSort Ac
     C                     MOVEL*BLANK    YL0003           PFS Carlisle Ac
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBUWSSX    YL0002           PFS AccuSort Ac
     C                     MOVELBUWUSX    YL0003           PFS Carlisle Ac
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV 1st Whse Not CancelRT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    YL0004           Warehouse Code
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIAIC3    WQSR01           Company Number
     C           *LIKE     DEFN WIC4NB    WQSR02           Order Number
      * Define keylist
     C           KPSSR     KLIST
     C                     KFLD           WQSR01           Company Number
     C                     KFLD           WQSR02           Order Number
     C                     KFLD           WIDPNB           Order Sequence
     C                     KFLD           WIUENB           Order Secondary
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           Company Number
     C                     KFLD           WQSR02           Order Number
      * Setup key
     C                     Z-ADDFLAIC3    WQSR01           Company Number
     C                     Z-ADDFLC4NB    WQSR02           Order Number
     C                     Z-ADD*ZERO     WIDPNB           Order Sequence
     C                     Z-ADD*ZERO     WIUENB           Order Secondary
      * Establish starting position
     C           KPSSR     SETLL@BGWKAE                    *
     C           KRSSR     READE@BGWKAE                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVELWIAJCD    YL0004           Warehouse Code
     C                     GOTO SREXIT                     *QUIT
     C           KRSSR     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv Live w/CT PFS Int RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0040    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSS     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0041           WHS Live with C
     C                     MOVEL*BLANK    WL0042           WHS PFS Interfa
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADRRSX    WL0041           WHS Live with C
     C                     MOVELADRSSX    WL0042           WHS PFS Interfa
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Upd Pick Event        RT - Order Events  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0272  50       Event Number
     C                     Z-ADD*ZERO     WN0273  30       Invoice_Memo Co
     C                     Z-ADD*ZERO     WN0274  70       Invoice_Memo Nu
     C                     MOVEL*BLANK    WN0275  2        Invoice_Memo Su
     C                     Z-ADD*ZERO     WN0276  70       Event Date
     C                     MOVEL*BLANK    WN0277  1        Activity Comple
     C                     MOVEL*BLANK    WN0278  1        Activity Hold
     C                     MOVEL*BLANK    WN0279  1        Post Cash Compl
     C                     Z-ADD*ZERO     WN0280  30       Cross Event Ref
     C                     Z-ADD*ZERO     WN0281  70       Cross Event Ref
     C                     Z-ADD*ZERO     WN0282  50       Cross Event Ref
     C                     Z-ADD*ZERO     WN0283  70       Ship To Custome
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN EYAIC3    WQST01           Company Number
     C           *LIKE     DEFN EYC4NB    WQST02           Order Number
     C           *LIKE     DEFN EYJPCD    WQST03           Event Code
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST01           Company Number
     C                     KFLD           WQST02           Order Number
     C                     KFLD           WQST03           Event Code
      * Setup key
     C                     Z-ADDFLAIC3    WQST01           Company Number
     C                     Z-ADDFLC4NB    WQST02           Order Number
     C                     MOVEL'03'      WQST03           Event Code
      * Establish starting position
     C           KRSST     SETLL@EYCPZE                    *
     C           KRSST     READE@EYCPZE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1074' W0RTN   7
      * USER: Processing if Data record not found
      * Rtv Last Event        RT - OP Order Events  * 
     C                     EXSR SURVGN
     C                     ADD  1         WN0272           Event Number
      * CRT OP Order Events    CR - OP Order Events  * 
     C                     EXSR SVCRRC
     C                     GOTO STEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Rtv Last Event        RT - OP Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJAIC3    WQSU01           Company Number
     C           *LIKE     DEFN WJC4NB    WQSU02           Order Number
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WQSU01           Company Number
     C                     KFLD           WQSU02           Order Number
      * Setup key
     C                     Z-ADDFLAIC3    WQSU01           Company Number
     C                     Z-ADDFLC4NB    WQSU02           Order Number
      * Establish starting position
     C           KRSSU     SETLL@EYCPUT                    *
     C           KRSSU     READE@EYCPUT                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1074' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WN0272           Event Number
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWJQ2NB    WN0272           Event Number
     C                     Z-ADDWJAUC3    WN0273           Invoice_Memo Co
     C                     Z-ADDWJQ7NB    WN0274           Invoice_Memo Nu
     C                     MOVELWJOMST    WN0275           Invoice_Memo Su
     C                     Z-ADDWJD2DT    WN0276           Event Date
     C                     MOVELWJONST    WN0277           Activity Comple
     C                     MOVELWJOOST    WN0278           Activity Hold
     C                     MOVELWJOPST    WN0279           Post Cash Compl
     C                     Z-ADDWJAWC3    WN0280           Cross Event Ref
     C                     Z-ADDWJQ8NB    WN0281           Cross Event Ref
     C                     Z-ADDWJQ9NB    WN0282           Cross Event Ref
     C                     Z-ADDWJBKC7    WN0283           Ship To Custome
     C                     GOTO SUEXIT                     *QUIT
     C           KRSSU     READE@EYCPUT                  90*
     C                     ENDDO
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVCRRC    BEGSR
      *================================================================
      * CRT OP Order Events    CR - OP Order Events  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0284  1        EDI Status 1
     C                     MOVEL*BLANK    WN0285  1        EDI Status 2
     C                     MOVEL*BLANK    WN0286  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0287  60       Job Time
     C                     MOVEL*BLANK    WN0288 10        User Id
     C                     MOVEL*BLANK    WN0289 10        Job Name
     C                     Z-ADD*ZERO     WN0290  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @EYCPY3
     C                     Z-ADDFLAIC3    WCAIC3           Company Number
     C                     Z-ADDFLC4NB    WCC4NB           Order Number
     C                     Z-ADDWN0272    WCQ2NB           Event Number
     C                     MOVEL'03'      WCJPCD           Event Code
     C                     Z-ADDWN0273    WCAUC3           Invoice_Memo Co
     C                     Z-ADDWN0274    WCQ7NB           Invoice_Memo Nu
     C                     MOVELWN0275    WCOMST           Invoice_Memo Su
     C                     Z-ADDWN0276    WCD2DT           Event Date
     C                     MOVELWN0277    WCONST           Activity Comple
     C                     MOVELWN0278    WCOOST           Activity Hold
     C                     MOVELWN0279    WCOPST           Post Cash Compl
     C                     Z-ADDWN0280    WCAWC3           Cross Event Ref
     C                     Z-ADDWN0281    WCQ8NB           Cross Event Ref
     C                     Z-ADDWN0282    WCQ9NB           Cross Event Ref
     C                     Z-ADDWN0283    WCBKC7           Ship To Custome
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WCAATM           Job Time
     C                     MOVEL##USR     WCAYNA           User Id
     C                     MOVEL##JOB     WCA0NA           Job Name
     C                     Z-ADD##JDT     WCAXDT           Job Date
     C           KLCRSV    KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
     C                     KFLD           WCQ2NB           Event Number
      * Check for duplicate primary key
     C           KLCRSV    SETLL@EYCPY3                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1075' W0RTN   7
      * Send message 'Order Events           EX'
     C                     MOVEL'USR1075' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C                     WRITE@EYCPY3                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * CHG Order Event Code   RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKC4NB           Order Number
      * Setup key
     C                     Z-ADDFLAIC3    WKAIC3           Company Number
     C                     Z-ADDFLC4NB    WKC4NB           Order Number
      * Establish starting position
     C           KRSSW     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Event Code is Open Orders
     C           WKJPCD    IFLT '04'                       *IF
      * CHG Head Status/Event  CH - Order Header TRG  * 
     C                     EXSR SXCHRC
     C                     GOTO SWEXIT                     *QUIT
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXCHRC    BEGSR
      *================================================================
      * CHG Head Status/Event  CH - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0291  2        Order Type_Sale
     C                     Z-ADD*ZERO     WN0292  70       AR Customer Num
     C                     Z-ADD*ZERO     WN0293  70       Ship To Custome
     C                     MOVEL*BLANK    WN0294 30        Ship To Name
     C                     MOVEL*BLANK    WN0295 30        Ship To Address
     C                     MOVEL*BLANK    WN0296 30        Ship To Address
     C                     MOVEL*BLANK    WN0297 30        Ship To Address
     C                     MOVEL*BLANK    WN0298 20        Ship To City
     C                     MOVEL*BLANK    WN0299  2        Ship To State C
     C                     MOVEL*BLANK    WN0300 11        Ship To Zip_Pos
     C                     Z-ADD*ZERO     WN0301  70       Bill to Custome
     C                     MOVEL*BLANK    WN0302 30        Bill to Name
     C                     MOVEL*BLANK    WN0303 30        Bill to Address
     C                     MOVEL*BLANK    WN0304 30        Bill to Address
     C                     MOVEL*BLANK    WN0305 30        Bill to Address
     C                     MOVEL*BLANK    WN0306 20        Bill to City
     C                     MOVEL*BLANK    WN0307  2        Bill to State C
     C                     MOVEL*BLANK    WN0308 11        Bill to Zip_Pos
     C                     MOVEL*BLANK    WN0309 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0310  70       Order Date
     C                     Z-ADD*ZERO     WN0311  70       Requested Ship
     C                     Z-ADD*ZERO     WN0312  70       Cancel Date
     C                     MOVEL*BLANK    WN0313  2        Terms Code
     C                     MOVEL*BLANK    WN0314 40        Special Instruc
     C                     MOVEL*BLANK    WN0315 40        Special Instruc
     C                     MOVEL*BLANK    WN0316  3        Carrier Code
     C                     MOVEL*BLANK    WN0317  1        Comment Print A
     C                     MOVEL*BLANK    WN0318  1        Comment Print I
     C                     MOVEL*BLANK    WN0319  1        Comment Print P
     C                     MOVEL*BLANK    WN0320  1        Comment Print S
     C                     MOVEL*BLANK    WN0321  3        Reason Code
     C                     MOVEL*BLANK    WN0322  1        Order in Use
     C                     MOVEL*BLANK    WN0323  1        Header Status L
     C                     MOVEL*BLANK    WN0324  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0325  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0326 10        User Original E
     C                     Z-ADD*ZERO     WN0327  70       Date of Origina
     C                     Z-ADD*ZERO     WN0328 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0329 112       Order Weight To
     C                     MOVEL*BLANK    WN0330  1        Credit Hold
     C                     MOVEL*BLANK    WN0331  1        Production Hold
     C                     MOVEL*BLANK    WN0332  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0333  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0334  40       Requested Deliv
     C                     MOVEL*BLANK    WN0335  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0336 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0337  70       Load ID
     C                     Z-ADD*ZERO     WN0338  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0339 112       Rated Freight
     C                     MOVEL*BLANK    WN0340  1        LTL Flag
     C                     MOVEL*BLANK    WN0341  1        Price Audit
     C                     MOVEL*BLANK    WN0342  1        Price Status
     C                     MOVEL*BLANK    WN0343  2        Shipping Method
     C                     MOVEL*BLANK    WN0344  1        Export Status
     C                     MOVEL*BLANK    WN0345  1        Palletize
     C                     MOVEL*BLANK    WN0346  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0347  1        Slip Sheet
     C                     MOVEL*BLANK    WN0348  1        Age Code
     C                     Z-ADD*ZERO     WN0349  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0350  1        Load Type
     C                     Z-ADD*ZERO     WN0351  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0352  1        Load Plan Order
     C                     MOVEL*BLANK    WN0353  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0354  70       Resell Referenc
     C                     MOVEL*BLANK    WN0355 30        Special Comment
     C                     MOVEL*BLANK    WN0356 30        Special Comment
     C                     MOVEL*BLANK    WN0357  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0358  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0359  2        Manager Level C
     C                     MOVEL*BLANK    WN0360  3        VP Level Code
     C                     Z-ADD*ZERO     WN0361  70       Attach to Order
     C                     MOVEL*BLANK    WN0362  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0363  70       Invoice Number
     C                     MOVEL*BLANK    WN0364  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0365  70       Invoice Date
     C                     MOVEL*BLANK    WN0366  1        Trans Contol AS
     C                     Z-ADD*ZERO     WN0367 112       A_R order Value
     C                     MOVEL*BLANK    WN0368  1        Billing Activit
     C                     MOVEL*BLANK    WN0369  1        Block Order Fla
     C                     MOVEL*BLANK    WN0370  1        Order Certifica
     C                     Z-ADD*ZERO     WN0371 112       Invoice Order V
     C                     MOVEL*BLANK    WN0372  1        Process Sts for
     C                     MOVEL*BLANK    WN0373  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0374  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0375  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0376  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0377  1        Email Cust On O
     C                     MOVEL*BLANK    WN0378  1        Order Emailed
     C                     MOVEL*BLANK    WN0379  1        Export Docs Go
     C                     MOVEL*BLANK    WN0380  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0381  1        Broker Order St
     C                     MOVEL*BLANK    WN0382  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0383  2        Order Requires
     C                     MOVEL*BLANK    WN0384  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0385  2        Export USDA App
     C                     MOVEL*BLANK    WN0386  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0387  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0388  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0389  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0390  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0391  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0392  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0393  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0394  60       Time of Origina
     C                     Z-ADD*ZERO     WN0395  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0396  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0397  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0398 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0399 112       Act Non_Ref Frt
     C                     Z-ADD*ZERO     WN0400 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0401 112       OH Total Non_Re
     C                     Z-ADD*ZERO     WN0402 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0403  70       Claim Number
     C                     MOVEL*BLANK    WN0404  1        EDI Status 1
     C                     MOVEL*BLANK    WN0405  1        EDI Status 2
     C                     MOVEL*BLANK    WN0406  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0407  60       Job Time
     C                     MOVEL*BLANK    WN0408 10        User Id
     C                     MOVEL*BLANK    WN0409 10        Job Name
     C                     Z-ADD*ZERO     WN0410  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWKAIC3    WEAIC3           Company Number
     C                     Z-ADDWKC4NB    WEC4NB           Order Number
      *
     C           KLCHSX    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C           KLCHSX    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SXEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YCRDCS
      * Move non-key fields to @BECPFJ
     C                     Z-ADDWKGNDT    WEGNDT           Actual Shipped
     C                     MOVELWKGWST    WEGWST    P      Header Status
     C                     MOVEL'03'      WEJPCD    P      Event Code
     C                     MOVELWKZ1ST    WEZ1ST    P      Modified Flag
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##PGM     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPARC
     C                     Z-ADDWEAIC3    PAAIC3           Company Number
     C                     Z-ADDWEC4NB    PAC4NB           Order Number
     C                     MOVELWEJNCD    PAJNCD    P      Order Type_Sale
     C                     Z-ADDWEANC7    PAANC7           AR Customer Num
     C                     Z-ADDWEBKC7    PABKC7           Ship To Custome
     C                     MOVELWEBRTX    PABRTX    P      Ship To Name
     C                     MOVELWEHMNA    PAHMNA    P      Ship To Address
     C                     MOVELWEHONA    PAHONA    P      Ship To Address
     C                     MOVELWEHPNA    PAHPNA    P      Ship To Address
     C                     MOVELWEHNNA    PAHNNA    P      Ship To City
     C                     MOVELWEDBCD    PADBCD    P      Ship To State C
     C                     MOVELWECKTX    PACKTX    P      Ship To Zip_Pos
     C                     Z-ADDWEB0C7    PAB0C7           Bill to Custome
     C                     MOVELWEAETX    PAAETX    P      Bill to Name
     C                     MOVELWEB1NA    PAB1NA    P      Bill to Address
     C                     MOVELWEB3NA    PAB3NA    P      Bill to Address
     C                     MOVELWEB4NA    PAB4NA    P      Bill to Address
     C                     MOVELWEB2NA    PAB2NA    P      Bill to City
     C                     MOVELWEBHCD    PABHCD    P      Bill to State C
     C                     MOVELWEC8TX    PAC8TX    P      Bill to Zip_Pos
     C                     MOVELWEBCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDWEA0DT    PAA0DT           Order Date
     C                     Z-ADDWEA5DT    PAA5DT           Requested Ship
     C                     Z-ADDWEGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDWEACDT    PAACDT           Cancel Date
     C                     MOVELWEAQCD    PAAQCD    P      Terms Code
     C                     MOVELWEB6NA    PAB6NA    P      Special Instruc
     C                     MOVELWEBYNA    PABYNA    P      Special Instruc
     C                     MOVELWEBZNA    PABZNA    P      Carrier Code
     C                     MOVELWEGTST    PAGTST    P      Comment Print A
     C                     MOVELWEGVST    PAGVST    P      Comment Print I
     C                     MOVELWEGUST    PAGUST    P      Comment Print P
     C                     MOVELWEQFST    PAQFST    P      Comment Print S
     C                     MOVELWECQCD    PACQCD    P      Reason Code
     C                     MOVELWEGJST    PAGJST    P      Order in Use
     C                     MOVELWEGWST    PAGWST    P      Header Status
     C                     MOVELWEGXST    PAGXST    P      Header Status L
     C                     MOVELWEGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDWEAODT    PAAODT           Scheduled Ship
     C                     MOVELWEAIVN    PAAIVN    P      User Original E
     C                     Z-ADDWECXDT    PACXDT           Date of Origina
     C                     Z-ADDWEJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDWEA1WG    PAA1WG           Order Weight To
     C                     MOVELWEXIST    PAXIST    P      Credit Hold
     C                     MOVELWEXJST    PAXJST    P      Production Hold
     C                     MOVELWEXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDWEEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDWEAFTM    PAAFTM           Requested Deliv
     C                     MOVELWEE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELWEE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDWERMNB    PARMNB           Load ID
     C                     Z-ADDWETBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDWER1NB    PAR1NB           Rated Freight
     C                     MOVELWEPJST    PAPJST    P      LTL Flag
     C                     MOVELWEU0ST    PAU0ST    P      Price Audit
     C                     MOVELWEU1ST    PAU1ST    P      Price Status
     C                     MOVELWEQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELWEU2ST    PAU2ST    P      Export Status
     C                     MOVELWEVEST    PAVEST    P      Palletize
     C                     MOVELWEVFST    PAVFST    P      Shrink Wrap
     C                     MOVELWEVGST    PAVGST    P      Slip Sheet
     C                     MOVELWERPCD    PARPCD    P      Age Code
     C                     Z-ADDWERNNB    PARNNB           Reefer Temperat
     C                     MOVELWEVDST    PAVDST    P      Load Type
     C                     Z-ADDWEATIN    PAATIN           Attach to Invoi
     C                     MOVELWEU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELWEU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDWERSRN    PARSRN           Resell Referenc
     C                     MOVELWEMHNA    PAMHNA    P      Special Comment
     C                     MOVELWEMINA    PAMINA    P      Special Comment
     C                     MOVELWEWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELWER4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELWEBFCD    PABFCD    P      Manager Level C
     C                     MOVELWEQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDWET3NB    PAT3NB           Attach to Order
     C                     MOVELWESICD    PASICD    P      Reason for Pric
     C                     Z-ADDWECONB    PACONB           Invoice Number
     C                     MOVELWECEST    PACEST    P      Invoice Suffix
     C                     Z-ADDWEAWDT    PAAWDT           Invoice Date
     C                     MOVELWEJPCD    PAJPCD    P      Event Code
     C                     MOVELWEXUST    PAXUST    P      Trans Contol AS
     C                     MOVELWEZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDWEVRVA    PAVRVA           A_R order Value
     C                     MOVELWEOBST    PAOBST    P      Billing Activit
     C                     MOVELWEBCST    PABCST    P      Block Order Fla
     C                     MOVELWEBDST    PABDST    P      Order Certifica
     C                     Z-ADDWEB7VL    PAB7VL           Invoice Order V
     C                     MOVELWEGASX    PAGASX    P      Process Sts for
     C                     MOVELWEGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELWEGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELWEGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELWEFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELWEFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELWEFPSX    PAFPSX    P      Order Emailed
     C                     MOVELWEFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELWEFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELWEFSSX    PAFSSX    P      Broker Order St
     C                     MOVELWEFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELWEFUSX    PAFUSX    P      Order Requires
     C                     MOVELWEFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELWEFWSX    PAFWSX    P      Export USDA App
     C                     MOVELWEFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELWEFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDWENODT    PANODT           OH Appt Confirm
     C                     Z-ADDWENPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDWENQDT    PANQDT           Load Actual Shi
     C                     Z-ADDWENRDT    PANRDT           Load BOL Comple
     C                     Z-ADDWENSDT    PANSDT           Load Truck Depa
     C                     Z-ADDWEBPTM    PABPTM           Maximum Gross W
     C                     Z-ADDWEBQTM    PABQTM           Time of Origina
     C                     Z-ADDWEBRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDWEBSTM    PABSTM           Load BOL Comple
     C                     Z-ADDWEBTTM    PABTTM           Load Truck Depa
     C                     Z-ADDWEH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDWEH1NX    PAH1NX           Act Non_Ref Frt
     C                     Z-ADDWEH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDWEH3NX    PAH3NX           OH Total Non_Re
     C                     Z-ADDWEH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDWEC0C7    PAC0C7           Claim Number
     C                     MOVELWEUVST    PAUVST    P      EDI Status 1
     C                     MOVELWEUWST    PAUWST    P      EDI Status 2
     C                     MOVELWEUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDWEAATM    PAAATM           Job Time
     C                     MOVELWEAYNA    PAAYNA    P      User Id
     C                     MOVELWEA0NA    PAA0NA    P      Job Name
     C                     Z-ADDWEAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * RTV Co Document Dflts  RT - Company Document Defaults  * PGM and
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * ** Used by HPE in STR Hog Prcr & Eval Sys-HPE System
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           AQAIC3           Company Number
     C                     KFLD           AQESTX           CDD Type
     C                     KFLD           AQFPAA           CDD Department
      * Setup key
     C                     Z-ADD#1AIC3    AQAIC3           Company Number
     C                     MOVEL'PL'      AQESTX           CDD Type
     C                     MOVE *BLANK    AQFPAA           CDD Department
     C                     MOVEL'ACCTG'   AQFPAA           CDD Department
      * Establish starting position
     C           KRSSY     CHAIN@AQREWG              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3410' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0007           CDD Program Nam
     C                     MOVEL*BLANK    YL0008           CDD Printer Fil
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAQDTVN    YL0007           CDD Program Nam
     C                     MOVELAQDUVN    YL0008           CDD Printer Fil
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0411    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSSZ     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI6ST    P2I6ST           Allow Multi-Com
     C                     MOVELDRMPNA    P2MPNA           Default Printer
     C                     MOVELDRBCCD    WUBCCD           Salesperson Cod
     C                     Z-ADDDRAIC3    YL0012           Company Number
     C                     MOVELDRBUVN    WN0412           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - User Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0043    DTAJVN           User Profile Na
     C                     MOVELWL0044    DTDNCD           Application Cod
      * Establish starting position
     C           KRSTA     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0045           Company Number
     C                     MOVELDTAJCD    WL0046           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQTB01           Application Cod
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WQTB01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQTB01           Application Cod
     C                     MOVEL'OMS'     WQTB01           Application Cod
      * Establish starting position
     C           KRSTB     SETLL@DNRESF                    *
     C           KRSTB     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR TCRVGN
     C                     END                             *FI
     C           KRSTB     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQTC01           Application Cod
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WQTC01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQTC01           Application Cod
      * Establish starting position
     C           KRSTC     SETLL@DNRESF                    *
     C           KRSTC     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSTC     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * DOC
      *================================================================
      * 9/18/98 Purva Droge
      *   This subroutine can be used for picking at the Load Level or
      *   at the Order Level.  This routine was originally designed for
      *   picking at the Load Level.  As of 9/15/98, the process have
      *   changed to pick at the Order Level.  If picking the entire Load
      *   the Order Number passed in will be zero.  If picking by the
      *   Order, the Order Number will be passed in and selected for
      *   processing in the allocation routine by Order.
      * 10/01/07 Todd Johnson
      *   This function is currently called from 2 external functions.
      *   One of them is interactive, the other a submitted job. The Job
      *   Type is now checked. The Pick Print is only submitted if this i
      *   an interactive job. That way, the user only gets 1 completion
      *   message for the Pick Slip Print.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * NOTE
      *================================================================
      * The following routine will go through the allocation
      * for Warehouses that are not Lot Tracking.  The amount of I/O
      * for detemining if at least one Warehouse on the Load is
      * Lot Tracking is equal/greater than performing the following routi
      * for the entire Load.
      * .
      * The Orders are marked as picked also in the following routine.
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C           YPMTFD    IFEQ '#2RMNB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(CTL) #2RMNB' defaulted for 'Load ID'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(CTL) #2AIC3' defaulted for 'Company Number'.
     C                     CALL 'OMCPSRR'              90  SEL Load ID
     C                     PARM *BLANK    W0RTN   7
     C           #2RMNB    PARM #2RMNB    WQ0042  70       Load ID
     C           #2AIC3    PARM #2AIC3    WQ0043  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMCPSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9932  *
     C                     END
      *
     C           #2RMNB    IFNE *ZERO                      Load ID
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VA999
     C                     END
     C                     END
      *................................................................
      *
     C           KLVAFJ    KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    FJRMNB
     C           KLVAFJ    CHAIN@FJCPBN              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VAEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VAEXIT
     C                     END
     C           VA999     TAG
      * Restrictor relation not satisfied
      * Send message 'Load Header            NF'
     C                     MOVEL'USR1188' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'USR1188' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C           ZINPOS    IFGE 03584
     C           ZINPOS    ANDLE05632
      * Cursor in the subfile record area
      * Reset cursor position to the basic (first) record for lookup
     C           W0CRW     SUB  14        W0CSRR  50
     C           03584     ADD  W0CCL     ZINPOS
      * Calculate rrn of the cursor position
     C                     ADD  ##SFRC    W0CSRR
     C                     ENDIF
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
     C           W0CFL     IFEQ *BLANK
     C                     Z-ADD0         W0CSRR
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD14        ZHSTRW  40
     C                     Z-ADD21        ZHNDRW  40
     C                     Z-ADD1         ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
     C                     END
      *
     C           ZHCSRW    IFEQ 013
     C           ZHCSCL    ANDEQ076
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#2GWST'  YPMTFD           Header Status
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Reclaim resources of called programs
     C                     CALL 'Y2RCRSC'
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1JPCD           Event Code
      * Clear all neither parameters
     C                     MOVEL*BLANK    P2DNCD           Application Cod
     C                     MOVEL*BLANK    P2B8NA           System Date For
     C                     MOVEL*BLANK    P2AJVN           User Profile Na
     C                     MOVEL*BLANK    P2I6ST           Allow Multi-Com
     C                     MOVEL*BLANK    P2MPNA           Default Printer
     C                     MOVEL*BLANK    P2TAST           First Time Flag
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P3T4NB           Schedule Sequen
     C                     MOVEL*BLANK    P3Q2CD           Shipping Method
      * Clear all neither parameters
     C                     MOVEL*BLANK    P4G3TX           PRT Description
     C                     MOVEL*BLANK    P4WRST           PRT Printer Dev
     C                     MOVEL*BLANK    P4WSST           PRT Hold Output
     C                     MOVEL*BLANK    P4WTST           PRT Save Output
     C                     Z-ADD*ZERO     P4DYNB           PRT Number of C
     C                     MOVEL*BLANK    P4WUST           PRT Night Queue
     C                     MOVEL*BLANK    P4BVVN           PRT Night Queue
     C                     MOVEL*BLANK    P4BDSX           Hold On Jobq
     C                     MOVEL*BLANK    P4BESX           Job Log Create
     C                     MOVEL*BLANK    P4BCSX           Hold
     C                     MOVEL*BLANK    P4Y8CD           Log
     C                     MOVEL*BLANK    P4XFST           Display Prt Opt
      * Clear all neither parameters
     C                     MOVEL*BLANK    P5BKSX           Pick Print Type
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Whs Ord Found STS
     C                     MOVEL*BLANK    WUEASX  1
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
     C                     Z-ADD*ZERO     WAALSW           Allocation Seq
     C                     Z-ADD*ZERO     WAJ6QT           OIA Alloc_Shipp
     C                     Z-ADD*ZERO     WAG9WG           OIA Alloc_Shipp
     C                     Z-ADD*ZERO     WAJ9QT           OIA Co-Packer L
     C                     Z-ADD*ZERO     WAHAWG           OIA Serial Numb
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WAELDT           Production Date
     C                     Z-ADD*ZERO     WALXNM           Lot Number
     C                     Z-ADD*ZERO     WAYNCD           Location Level
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBQ2NB           Event Number
     C                     Z-ADD*ZERO     WBAUC3           Invoice_Memo Co
     C                     Z-ADD*ZERO     WBQ7NB           Invoice_Memo Nu
     C                     Z-ADD*ZERO     WBD2DT           Event Date
     C                     Z-ADD*ZERO     WBAWC3           Cross Event Ref
     C                     Z-ADD*ZERO     WBQ8NB           Cross Event Ref
     C                     Z-ADD*ZERO     WBQ9NB           Cross Event Ref
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field Event Number
     C                     Z-ADD*ZERO     WUQ2NB  50
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEC4NB           Order Number
     C                     Z-ADD*ZERO     WEANC7           AR Customer Num
     C                     Z-ADD*ZERO     WEBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WEB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WEA0DT           Order Date
     C                     Z-ADD*ZERO     WEA5DT           Requested Ship
     C                     Z-ADD*ZERO     WEGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WEACDT           Cancel Date
     C                     Z-ADD*ZERO     WEAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WECXDT           Date of Origina
     C                     Z-ADD*ZERO     WEJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WEA1WG           Order Weight To
     C                     Z-ADD*ZERO     WEEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WEAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WERMNB           Load ID
     C                     Z-ADD*ZERO     WETBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WER1NB           Rated Freight
     C                     Z-ADD*ZERO     WERNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WEATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WERSRN           Resell Referenc
     C                     Z-ADD*ZERO     WET3NB           Attach to Order
     C                     Z-ADD*ZERO     WECONB           Invoice Number
     C                     Z-ADD*ZERO     WEAWDT           Invoice Date
     C                     Z-ADD*ZERO     WEVRVA           A_R order Value
     C                     Z-ADD*ZERO     WEB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WENODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WENPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WENQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WENRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WENSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WEBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WEBQTM           Time of Origina
     C                     Z-ADD*ZERO     WEBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WEBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WEBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WEH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WEH1NX           Act Non_Ref Frt
     C                     Z-ADD*ZERO     WEH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WEH3NX           OH Total Non_Re
     C                     Z-ADD*ZERO     WEH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WEC0C7           Claim Number
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFC4NB           Order Number
     C                     Z-ADD*ZERO     WFDPNB           Order Sequence
     C                     Z-ADD*ZERO     WFUENB           Order Secondary
     C                     Z-ADD*ZERO     WFHGCD           Item Code
     C                     Z-ADD*ZERO     WFBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WFCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WFMAVA           Billing Detail
     C                     Z-ADD*ZERO     WFKDVA           Billing Detail
     C                     Z-ADD*ZERO     WFL8VA           Billing Detail
     C                     Z-ADD*ZERO     WFL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WFAYVA           Extended Amount
     C                     Z-ADD*ZERO     WFEXDT           Market Pricing
     C                     Z-ADD*ZERO     WFBZPR           Price Overage O
     C                     Z-ADD*ZERO     WFL6NB           Contract Number
     C                     Z-ADD*ZERO     WFGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WFR1NB           Rated Freight
     C                     Z-ADD*ZERO     WFAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WFD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WFCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WFAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WFCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WFATWG           Weight Shipped
     C                     Z-ADD*ZERO     WFAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WFAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WFAKPR           Unit Price
     C                     Z-ADD*ZERO     WFALPR           Unit Price_Cred
     C                     Z-ADD*ZERO     WFAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WFAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WFA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WFA5DT           Requested Ship
     C                     Z-ADD*ZERO     WFAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WFGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WFRGNB           Item Structure
     C                     Z-ADD*ZERO     WFRHNB           Item Structure
     C                     Z-ADD*ZERO     WFRINB           Item Structure
     C                     Z-ADD*ZERO     WFCXDT           Date of Origina
     C                     Z-ADD*ZERO     WFDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WFB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WFA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WFNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WFNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WFNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WFNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WFNXDT           OD Firm Date
     C                     Z-ADD*ZERO     WFBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WFBVTM           Price Code
     C                     Z-ADD*ZERO     WFBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WFBXTM           Substitution Li
     C                     Z-ADD*ZERO     WFBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WFH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WFH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WFH7NX           OD Item Target
     C                     Z-ADD*ZERO     WFH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WFH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WFDVPR           Order Gate_Fina
     C                     Z-ADD*ZERO     WFDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WFDXPR           OD Gate_Final P
     C                     Z-ADD*ZERO     WFDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WFDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WFGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WFGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WFGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WFPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WFRINY           Item Age Days
     C                     Z-ADD*ZERO     WFTIDT           Production Ovr
     C                     Z-ADD*ZERO     WFTJDT           Production Ovr
     C                     Z-ADD*ZERO     WFTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WFTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WFTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Clear all neither parameters
      * CRT OP Order Events    CR - OP Order Events  * 
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field Warehouse Code
     C                     MOVEL*BLANK    WUAJCD  3
      * Define work field Salesperson Code
     C                     MOVEL*BLANK    WUBCCD  3
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL@CN,1     @CN,1
     C                     MOVEL'Y'       W0PMT   1
      *
     C                     MOVEL*BLANK    W0SJO 132        *Sbmjob overrid
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
      * Define local variables for subroutine SIRVGN.
     C                     Z-ADD*ZERO     WL0003  30
     C                     Z-ADD*ZERO     WL0004  70
     C                     MOVEL*BLANK    WL0005  2
      * Define local variables for subroutine SORVGN.
     C                     Z-ADD*ZERO     WL0006  30
     C                     Z-ADD*ZERO     WL0007  70
     C                     Z-ADD*ZERO     WL0008  30
     C                     Z-ADD*ZERO     WL0009  30
     C                     Z-ADD*ZERO     WL0010  50
      * Define local variables for subroutine SPCRRC.
     C                     Z-ADD*ZERO     WL0011  30
     C                     Z-ADD*ZERO     WL0012  70
     C                     Z-ADD*ZERO     WL0013  30
     C                     Z-ADD*ZERO     WL0014  30
     C                     Z-ADD*ZERO     WL0015  50
     C                     Z-ADD*ZERO     WL0016  50
     C                     Z-ADD*ZERO     WL0017 112
     C                     Z-ADD*ZERO     WL0018  50
     C                     Z-ADD*ZERO     WL0019 112
     C                     MOVEL*BLANK    WL0020  1
     C                     MOVEL*BLANK    WL0021  1
     C                     MOVEL*BLANK    WL0022  1
     C                     MOVEL*BLANK    WL0023  2
     C                     MOVEL*BLANK    WL0024  1
     C                     MOVEL*BLANK    WL0025  2
     C                     Z-ADD*ZERO     WL0026  70
     C                     MOVEL*BLANK    WL0027  3
     C                     Z-ADD*ZERO     WL0028  70
     C                     Z-ADD*ZERO     WL0029  50
     C                     MOVEL*BLANK    WL0030  4
     C                     Z-ADD*ZERO     WL0031  20
     C                     MOVEL*BLANK    WL0032  1
     C                     MOVEL*BLANK    WL0033  1
     C                     MOVEL*BLANK    WL0034  1
     C                     MOVEL*BLANK    WL0035  1
     C                     Z-ADD*ZERO     WL0036  60
     C                     MOVEL*BLANK    WL0037 10
     C                     MOVEL*BLANK    WL0038 10
     C                     Z-ADD*ZERO     WL0039  70
      * Define local variables for subroutine SSRVGN.
     C                     MOVEL*BLANK    WL0040  3
     C                     MOVEL*BLANK    WL0041  1
     C                     MOVEL*BLANK    WL0042  1
      * Define local variables for subroutine TARVGN.
     C                     MOVEL*BLANK    WL0043 10
     C                     MOVEL*BLANK    WL0044  6
     C                     Z-ADD*ZERO     WL0045  30
     C                     MOVEL*BLANK    WL0046  3
      * Define local work field First Time Flag
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field PFS AccuSort Active
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field PFS Carlisle Active
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0004  3
      * Define local work field WHS Live with Carlisle
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field WHS PFS Interface
     C                     MOVEL*BLANK    YL0006  1
      * Define null work field CDD Name of Overlay
     C                     MOVEL*BLANK    YN0001  8
      * Define local work field CDD Program Name
     C                     MOVEL*BLANK    YL0007 10
      * Define local work field CDD Printer File Name
     C                     MOVEL*BLANK    YL0008 10
      * Define null work field CDD Sender Phone
     C                     MOVEL*BLANK    YN0002 25
      * Define null work field CDD Sender Fax
     C                     MOVEL*BLANK    YN0003 25
      * Define null work field Output Queue
     C                     MOVEL*BLANK    YN0004 10
      * Define null work field Hold File
     C                     MOVEL*BLANK    YN0005  4
      * Define null work field Save File
     C                     MOVEL*BLANK    YN0006  4
      * Define null work field Source Drawer
     C                     Z-ADD*ZERO     YN0007  30
      * Define null work field Printer Device Type
     C                     MOVEL*BLANK    YN0008 10
      * Define null work field Page Length 2
     C                     Z-ADD*ZERO     YN0009  30
      * Define null work field Page Width 2
     C                     Z-ADD*ZERO     YN0010  30
      * Define null work field Page LPI
     C                     Z-ADD*ZERO     YN0011  30
      * Define null work field Page CPI
     C                     Z-ADD*ZERO     YN0012  31
      * Define null work field Page Overflow
     C                     Z-ADD*ZERO     YN0013  30
      * Define null work field Page Rotation
     C                     MOVEL*BLANK    YN0014  5
      * Define null work field CDD Comment 1
     C                     MOVEL*BLANK    YN0015 50
      * Define null work field CDD Comment 2
     C                     MOVEL*BLANK    YN0016 50
      * Define null work field CDD Comment 3
     C                     MOVEL*BLANK    YN0017 50
      * Define null work field CDD Comment 4
     C                     MOVEL*BLANK    YN0018 50
      * Define null work field CDD Comment 5
     C                     MOVEL*BLANK    YN0019 50
      * Define local work field Job Type
     C                     MOVEL*BLANK    YL0009  1
      * Define local work field Number of Copies Pass USR
     C                     Z-ADD*ZERO     YL0010 155
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0011  30
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0012  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0013  3
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     Z-ADD08        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      *
     C                     MOVEL*BLANK    WN0411 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0411           User Profile Na
      *
     C                     MOVEL*BLANK    WN0412 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR SZRVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,005                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0411    ZA0016           User Profile Na
     C                     MOVEL'OMS'     ZA0017           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0412    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0411    WL0043    P      User Profile Na
     C                     MOVEL'OMS'     WL0044    P      Application Cod
     C                     EXSR TARVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0045    YL0011           Company Number
     C                     MOVELWL0046    YL0013    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0412    WL0043    P      User Profile Na
     C                     MOVEL'OMS'     WL0044    P      Application Cod
     C                     EXSR TARVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0045    YL0011           Company Number
     C                     MOVELWL0046    YL0013    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0013    WUAJCD           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0411    ZA0018           User Profile Na
     C                     MOVEL'OMS'     ZA0019           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0012    IFNE 0                          *IF
     C                     Z-ADDYL0012    YL0011           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0013    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           WUAJCD    PARM *BLANK    WQ0044  3        Warehouse Code
     C                     PARM YL0012    WQ0045  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR TBRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
     C                     MOVEL'N'       P4WUST           PRT Night Queue
     C                     MOVEL'*YES'    P4XFST           Display Prt Opt
     C                     MOVEL'Y'       YL0001           First Time Flag
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** W0BEG
01045010690109101301013250134701557
01580020500230603333033410334603350
03353033570336603374034040358603589
03597036020360603609036130362203630
03660
** W0END
01051010700109701303013250135801561
01586021270238303339033430334603350
03354033640337203401034040358703595
03599036020360603610036200362803657
03660
** W0NAM
#2RMNB    #2Q2CD    #PRPNB    #CAJCD    #PPKST    #CS2TX    #PT4NB
#PRONB    **SPT     #2ST1     V2C4NB    V2AIC3    #2U5ST    #CZMST
#2JPCD    V2AODT    V2BKC7    #2BRTX    #2GWST    #1SEL     V1C4NB
V1AIC3    #1U5ST    #RZMST    #1JPCD    V1AODT    V1BKC7    #1BRTX
#1GWST
** @CN
00001 USR0752
00002 Reprint Picks
00003 Y2U9999
00004 PRTPIKSLP
00005 Y2U0005
