     H/TITLE Val Pallet ID 4/856   DN  Execute external functio
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) BNDDIR(YBNDDIR) DBGVIEW(*SOURCE)
     Z* CVTOPT(*DATETIME) ACTGRP(*CALLER) OPTIMIZE(*BASIC)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Execute external function
     H* Object type   : *PGM
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 05/13/24  Time  : 14:50:07
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOPBFCPLG  IF   E           K DISK
      * RSQ : Order Header TRG          Load Id/Order Num
      *
     FOPBGWKLA  IF   E           K DISK
      * RSQ : Order Detail              co/
      *
     FCAADREL1  IF   E           K DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FPNG0REL1  IF   E           K DISK
      * RTV : EDI WHS Interchange       Retrieval index
      *
     FPNGQREL1  IF   E           K DISK
      * RTV : EDI Bill To Interchange   Retrieval index
      *
     FPBB8REL1  IF   E           K DISK
      * RTV : Trade Partner Control     Retrieval index
      *
     FOMFNCPL1  IF   E           K DISK
      * RTV : Manifest Detail           Retrieval index
      *
     FPMAMREL1  IF   E           K DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FOPBGWKL1  IF   E           K DISK
      * RTV : Order Detail              Retrieval index
      *
     FPDKMREL1  IF   E           K DISK
      * RTV : Company Values            Retrieval index
      *
     FPMAMREL0  UF   E           K DISK
      * UPD : Order Header Extension    Update index
      *
      * Long constants
     D @CN#            S              6    DIM(11)CTDATA PERRCD(1)
     D @CN             S             25    DIM(11) ALT(@CN#)
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
     D QPMAM1        E DS                  EXTNAME(PMAMREL0)
      * UPD : Order Header Extension    Update index
      * Renamed input format fields
     D  WKAIC3       E                     EXTFLD(AMAIC3)
     D  WKC4NB       E                     EXTFLD(AMC4NB)
     D  WKRMNB       E                     EXTFLD(AMRMNB)
     D  WKRUNB       E                     EXTFLD(AMRUNB)
     D  WKXACD       E                     EXTFLD(AMXACD)
     D  WKOANA       E                     EXTFLD(AMOANA)
     D  WKHBAA       E                     EXTFLD(AMHBAA)
     D  WKJ0T1       E                     EXTFLD(AMJ0T1)
     D  WKGENY       E                     EXTFLD(AMGENY)
     D  WKJ1T1       E                     EXTFLD(AMJ1T1)
     D  WKHCAA       E                     EXTFLD(AMHCAA)
     D  WKQWDT       E                     EXTFLD(AMQWDT)
     D  WKQXDT       E                     EXTFLD(AMQXDT)
     D  WKQYDT       E                     EXTFLD(AMQYDT)
     D  WKHDAA       E                     EXTFLD(AMHDAA)
     D  WKCCTX       E                     EXTFLD(AMCCTX)
     D  WKJ2T1       E                     EXTFLD(AMJ2T1)
     D  WKRLNA       E                     EXTFLD(AMRLNA)
     D  WKRMNA       E                     EXTFLD(AMRMNA)
     D  WKGINY       E                     EXTFLD(AMGINY)
     D  WKGFNY       E                     EXTFLD(AMGFNY)
     D  WKGGNY       E                     EXTFLD(AMGGNY)
     D  WKGHNY       E                     EXTFLD(AMGHNY)
     D  WKHEVL       E                     EXTFLD(AMHEVL)
     D  WKHFVL       E                     EXTFLD(AMHFVL)
     D  WKHGVL       E                     EXTFLD(AMHGVL)
     D  WKQZDT       E                     EXTFLD(AMQZDT)
     D  WKQ0DT       E                     EXTFLD(AMQ0DT)
     D  WKQ1DT       E                     EXTFLD(AMQ1DT)
     D  WKQ2DT       E                     EXTFLD(AMQ2DT)
     D  WKC2TX       E                     EXTFLD(AMC2TX)
     D  WKC3TX       E                     EXTFLD(AMC3TX)
     D  WKC6TX       E                     EXTFLD(AMC6TX)
     D  WKCHTX       E                     EXTFLD(AMCHTX)
     D  WKCITX       E                     EXTFLD(AMCITX)
     D  WKCLTX       E                     EXTFLD(AMCLTX)
     D  WKB4TX       E                     EXTFLD(AMB4TX)
     D  WKCUTX       E                     EXTFLD(AMCUTX)
     D  WKCVTX       E                     EXTFLD(AMCVTX)
     D  WKB9TX       E                     EXTFLD(AMB9TX)
     D  WKJWSC       E                     EXTFLD(AMJWSC)
     D  WKITNY       E                     EXTFLD(AMITNY)
     D  WKLMT1       E                     EXTFLD(AMLMT1)
     D  WKLWAA       E                     EXTFLD(AMLWAA)
     D  WKFVST       E                     EXTFLD(AMFVST)
     D  WKF0ST       E                     EXTFLD(AMF0ST)
     D  WKF2ST       E                     EXTFLD(AMF2ST)
     D  WKF3ST       E                     EXTFLD(AMF3ST)
     D  WKJUSC       E                     EXTFLD(AMJUSC)
     D  WKJVSC       E                     EXTFLD(AMJVSC)
     D  WKV3T1       E                     EXTFLD(AMV3T1)
     D  WKV4T1       E                     EXTFLD(AMV4T1)
     D  WKV5T1       E                     EXTFLD(AMV5T1)
     D  WKV6T1       E                     EXTFLD(AMV6T1)
     D  WKV7T1       E                     EXTFLD(AMV7T1)
     D  WKV8T1       E                     EXTFLD(AMV8T1)
     D  WKV9T1       E                     EXTFLD(AMV9T1)
     D  WKWAT1       E                     EXTFLD(AMWAT1)
     D  WKWBT1       E                     EXTFLD(AMWBT1)
     D  WKWCT1       E                     EXTFLD(AMWCT1)
     D  WKWDT1       E                     EXTFLD(AMWDT1)
     D  WKQJNY       E                     EXTFLD(AMQJNY)
     D  WKQKNY       E                     EXTFLD(AMQKNY)
     D  WKQLNY       E                     EXTFLD(AMQLNY)
     D  WKP8NY       E                     EXTFLD(AMP8NY)
     D  WKP9NY       E                     EXTFLD(AMP9NY)
     D  WKQANY       E                     EXTFLD(AMQANY)
     D  WKQCNY       E                     EXTFLD(AMQCNY)
     D  WKQDNY       E                     EXTFLD(AMQDNY)
     D  WKQENY       E                     EXTFLD(AMQENY)
     D  WKQFNY       E                     EXTFLD(AMQFNY)
     D  WKQGNY       E                     EXTFLD(AMQGNY)
     D  WKQHNY       E                     EXTFLD(AMQHNY)
     D  WKQINY       E                     EXTFLD(AMQINY)
     D  WKQMNY       E                     EXTFLD(AMQMNY)
     D  WKMYU1       E                     EXTFLD(AMMYU1)
     D  WKJXSC       E                     EXTFLD(AMJXSC)
     D  WKJYSC       E                     EXTFLD(AMJYSC)
     D  WKJZSC       E                     EXTFLD(AMJZSC)
     D  WKJ0SC       E                     EXTFLD(AMJ0SC)
     D  WKMZU1       E                     EXTFLD(AMMZU1)
     D  WKM0U1       E                     EXTFLD(AMM0U1)
     D  WKM1U1       E                     EXTFLD(AMM1U1)
     D  WKM2U1       E                     EXTFLD(AMM2U1)
     D  WKM3U1       E                     EXTFLD(AMM3U1)
     D  WKW5DT       E                     EXTFLD(AMW5DT)
     D  WKW6DT       E                     EXTFLD(AMW6DT)
     D  WKUVST       E                     EXTFLD(AMUVST)
     D  WKUWST       E                     EXTFLD(AMUWST)
     D  WKUXST       E                     EXTFLD(AMUXST)
     D  WKVSST       E                     EXTFLD(AMVSST)
     D  WKAATM       E                     EXTFLD(AMAATM)
     D  WKAYNA       E                     EXTFLD(AMAYNA)
     D  WKA0NA       E                     EXTFLD(AMA0NA)
     D  WKAXDT       E                     EXTFLD(AMAXDT)
      *
     D YARDCS          DS           894
      * Message data for message Y2U0009.
     D MD0009          DS
     D  MDPGM                  1     10
     D  MDACP                 11     20
     D  MDFMT                 21     30
     D  MDACT                 31     34
     D  MDLBL                 35     40
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  WP0001         S              1
     D  WP0002         S              1
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  WQSA02         S                   LIKE(WARMNB)
     D  YL0001         S              1
     D  YL0002         S              6
     D  YN0001         S              6
     D  YN0002         S              3
     D  YL0003         S              3
     D  WL0001         S              3  0
     D  WL0002         S              7  0
     D  WL0003         S              3  0
     D  WL0004         S              3  0
     D  WL0005         S              3
     D  WL0006         S              6
     D  WQSB01         S                   LIKE(WBAIC3)
     D  WQSB02         S                   LIKE(WBC4NB)
     D  YL0004         S              1
     D  YL0005         S              1
     D  YN0003         S              1
     D  WL0007         S              3
     D  WL0008         S              1
     D  WL0009         S              1
     D  WL0010         S              1
     D  Y0CX01         S              1
     D  YL0006         S              1
     D  YL0007         S              3
     D  YL0008         S              1
     D  WL0011         S              7  0
     D  WL0012         S              6
     D  WL0013         S              6
     D  WL0014         S              3
     D  WL0015         S              1
     D  YL0009         S              1
     D  WQ0001         S              3  0
     D  WQ0002         S              7  0
     D  WQ0003         S              6
     D  WQ0004         S              1
     D  W0CLPG         S             10
     D  YL0010         S              3
     D  YL0011         S              1
     D  WQSG01         S                   LIKE(WGAIC3)
     D  WQSG02         S                   LIKE(WGC4NB)
     D  YL0012         S              5
     D  YL0013         S              1
     D  YL0014         S              3
     D  YL0015         S              7
     D  YL0016         S              7
     D  YL0017         S             50
     D  ZQ             S              5  0
     D  YL0018         S            256
     D  YL0019         S              3
     D  WQSI01         S                   LIKE(WIAIC3)
     D  WQSI02         S                   LIKE(WIC4NB)
     D  YL0020         S             50
     D  WQ0005         S             50
     D  WQ0006         S             50
     D  WQ0007         S            256
     D  WN0001         S              7  0
     D  WN0002         S              5  0
     D  WN0003         S              3
     D  WN0004         S             20
     D  WN0005         S             25
     D  WN0006         S             30
     D  WN0007         S             15
     D  WN0008         S             15
     D  WN0009         S             20
     D  WN0010         S              7  0
     D  WN0011         S              7  0
     D  WN0012         S              7  0
     D  WN0013         S              3
     D  WN0014         S              1
     D  WN0015         S             12
     D  WN0016         S             35
     D  WN0017         S             75
     D  WN0018         S             11  0
     D  WN0019         S             11  0
     D  WN0020         S             11  0
     D  WN0021         S             11  0
     D  WN0022         S             11  2
     D  WN0023         S             11  2
     D  WN0024         S             11  2
     D  WN0025         S              7  0
     D  WN0026         S              7  0
     D  WN0027         S              7  0
     D  WN0028         S              7  0
     D  WN0029         S              4
     D  WN0030         S              4
     D  WN0031         S              4
     D  WN0032         S              2
     D  WN0033         S              2
     D  WN0034         S              2
     D  WN0035         S              3
     D  WN0036         S              3
     D  WN0037         S              3
     D  WN0038         S              5
     D  WN0039         S              5  0
     D  WN0040         S             38
     D  WN0041         S              6
     D  WN0042         S              6
     D  WN0043         S              6
     D  WN0044         S              6
     D  WN0045         S              6
     D  WN0046         S              1
     D  WN0047         S             10
     D  WN0048         S             10
     D  WN0049         S             10
     D  WN0050         S             15
     D  WN0051         S             15
     D  WN0052         S             15
     D  WN0053         S             30
     D  WN0054         S             30
     D  WN0055         S             30
     D  WN0056         S             50
     D  WN0057         S             50
     D  WN0058         S              3  0
     D  WN0059         S              3  0
     D  WN0060         S              3  0
     D  WN0061         S              5  2
     D  WN0062         S              5  2
     D  WN0063         S              5  0
     D  WN0064         S              6  0
     D  WN0065         S              6  0
     D  WN0066         S              6  0
     D  WN0067         S              6  0
     D  WN0068         S              9  0
     D  WN0069         S              9  0
     D  WN0070         S              9  0
     D  WN0071         S              9  6
     D  WN0072         S             15
     D  WN0073         S              1
     D  WN0074         S              1
     D  WN0075         S              2
     D  WN0076         S              2
     D  WN0077         S              5
     D  WN0078         S              5
     D  WN0079         S             15
     D  WN0080         S             15
     D  WN0081         S             30
     D  WN0082         S              7  0
     D  WN0083         S              7  0
     D  WN0084         S              1
     D  WN0085         S              1
     D  WN0086         S              1
     D  WN0087         S              1
     D  WN0088         S              6  0
     D  WN0089         S             10
     D  WN0090         S             10
     D  WN0091         S              7  0
     D  YARDC          S              1
     D  ZAPGMQ         S             10
     D  ZAPGRL         S              5
     D  ZAMSID         S              7
     D  ZAMSGF         S             10
     D  ZAMSTP         S              7
     D  YILE           S              1
     D  W0PMT          S              1
      /EJECT
      * Parameter declarations
     D P1PARM          DS             8
      * KEY: Order Header TRG          Load Id/Order Num
      * I :  Load ID
     D  P1RMNB                 1      4P 0
     D P2PARM          DS
      * FLD: *Arrays
      * B :  Set EDI 856 Pallet ID=1 U
     D  P2KESC                 1      1
      * O :  Create EDI ASN 856 V2 USR
     D  P2KGSC                 2      2
     D                 DS
     D  ZAMSDA                 1    132
     I@BFCPRQ
      * Order Header TRG          Load Id/Order Num
      * Renamed input format fields
     I              BEAIC3                      WAAIC3
     I              BEC4NB                      WAC4NB
     I              BEJNCD                      WAJNCD
     I              BEANC7                      WAANC7
     I              BEBKC7                      WABKC7
     I              BEBRTX                      WABRTX
     I              BEHMNA                      WAHMNA
     I              BEHONA                      WAHONA
     I              BEHPNA                      WAHPNA
     I              BEHNNA                      WAHNNA
     I              BEDBCD                      WADBCD
     I              BECKTX                      WACKTX
     I              BEB0C7                      WAB0C7
     I              BEAETX                      WAAETX
     I              BEB1NA                      WAB1NA
     I              BEB3NA                      WAB3NA
     I              BEB4NA                      WAB4NA
     I              BEB2NA                      WAB2NA
     I              BEBHCD                      WABHCD
     I              BEC8TX                      WAC8TX
     I              BEBCNA                      WABCNA
     I              BEA0DT                      WAA0DT
     I              BEA5DT                      WAA5DT
     I              BEGNDT                      WAGNDT
     I              BEACDT                      WAACDT
     I              BEAQCD                      WAAQCD
     I              BEB6NA                      WAB6NA
     I              BEBYNA                      WABYNA
     I              BEBZNA                      WABZNA
     I              BEGTST                      WAGTST
     I              BEGVST                      WAGVST
     I              BEGUST                      WAGUST
     I              BEQFST                      WAQFST
     I              BECQCD                      WACQCD
     I              BEGJST                      WAGJST
     I              BEGWST                      WAGWST
     I              BEGXST                      WAGXST
     I              BEGYST                      WAGYST
     I              BEAODT                      WAAODT
     I              BEAIVN                      WAAIVN
     I              BECXDT                      WACXDT
     I              BEJZVA                      WAJZVA
     I              BEA1WG                      WAA1WG
     I              BEXIST                      WAXIST
     I              BEXJST                      WAXJST
     I              BEXKST                      WAXKST
     I              BEEIDT                      WAEIDT
     I              BEAFTM                      WAAFTM
     I              BEE8CD                      WAE8CD
     I              BEE9CD                      WAE9CD
     I              BERMNB                      WARMNB
     I              BETBNB                      WATBNB
     I              BER1NB                      WAR1NB
     I              BEPJST                      WAPJST
     I              BEU0ST                      WAU0ST
     I              BEU1ST                      WAU1ST
     I              BEQ2CD                      WAQ2CD
     I              BEU2ST                      WAU2ST
     I              BEVEST                      WAVEST
     I              BEVFST                      WAVFST
     I              BEVGST                      WAVGST
     I              BERPCD                      WARPCD
     I              BERNNB                      WARNNB
     I              BEVDST                      WAVDST
     I              BEATIN                      WAATIN
     I              BEU4ST                      WAU4ST
     I              BEU5ST                      WAU5ST
     I              BERSRN                      WARSRN
     I              BEMHNA                      WAMHNA
     I              BEMINA                      WAMINA
     I              BEWBST                      WAWBST
     I              BER4CD                      WAR4CD
     I              BEBFCD                      WABFCD
     I              BEQ4CD                      WAQ4CD
     I              BET3NB                      WAT3NB
     I              BESICD                      WASICD
     I              BECONB                      WACONB
     I              BECEST                      WACEST
     I              BEAWDT                      WAAWDT
     I              BEJPCD                      WAJPCD
     I              BEXUST                      WAXUST
     I              BEZ1ST                      WAZ1ST
     I              BEVRVA                      WAVRVA
     I              BEOBST                      WAOBST
     I              BEBCST                      WABCST
     I              BEBDST                      WABDST
     I              BEB7VL                      WAB7VL
     I              BEGASX                      WAGASX
     I              BEGBSX                      WAGBSX
     I              BEGCSX                      WAGCSX
     I              BEGDSX                      WAGDSX
     I              BEFNSX                      WAFNSX
     I              BEFOSX                      WAFOSX
     I              BEFPSX                      WAFPSX
     I              BEFQSX                      WAFQSX
     I              BEFRSX                      WAFRSX
     I              BEFSSX                      WAFSSX
     I              BEFTSX                      WAFTSX
     I              BEFUSX                      WAFUSX
     I              BEFVSX                      WAFVSX
     I              BEFWSX                      WAFWSX
     I              BEFXSX                      WAFXSX
     I              BEFYSX                      WAFYSX
     I              BENODT                      WANODT
     I              BENPDT                      WANPDT
     I              BENQDT                      WANQDT
     I              BENRDT                      WANRDT
     I              BENSDT                      WANSDT
     I              BEBPTM                      WABPTM
     I              BEBQTM                      WABQTM
     I              BEBRTM                      WABRTM
     I              BEBSTM                      WABSTM
     I              BEBTTM                      WABTTM
     I              BEH0NX                      WAH0NX
     I              BEH1NX                      WAH1NX
     I              BEH2NX                      WAH2NX
     I              BEH3NX                      WAH3NX
     I              BEH4NX                      WAH4NX
     I              BEC0C7                      WAC0C7
     I              BEUVST                      WAUVST
     I              BEUWST                      WAUWST
     I              BEUXST                      WAUXST
     I              BEAATM                      WAAATM
     I              BEAYNA                      WAAYNA
     I              BEA0NA                      WAA0NA
     I              BEAXDT                      WAAXDT
      *
     I@BGWKAE
      * Order Detail              co/
      * Renamed input format fields
     I              OMAIC3                      WBAIC3
     I              OMC4NB                      WBC4NB
     I              OMDPNB                      WBDPNB
     I              OMUENB                      WBUENB
     I              OMHGCD                      WBHGCD
     I              OMAJCD                      WBAJCD
     I              OMBKC7                      WBBKC7
     I              OMCFC7                      WBCFC7
     I              OMGMST                      WBGMST
     I              OMGNST                      WBGNST
     I              OMMAVA                      WBMAVA
     I              OMKDVA                      WBKDVA
     I              OML8VA                      WBL8VA
     I              OML9VA                      WBL9VA
     I              OMGTST                      WBGTST
     I              OMGVST                      WBGVST
     I              OMGUST                      WBGUST
     I              OMQFST                      WBQFST
     I              OMAYVA                      WBAYVA
     I              OMEXDT                      WBEXDT
     I              OMLQCD                      WBLQCD
     I              OMRDCD                      WBRDCD
     I              OMQ7CD                      WBQ7CD
     I              OMBZPR                      WBBZPR
     I              OML6NB                      WBL6NB
     I              OMU1ST                      WBU1ST
     I              OMGIDT                      WBGIDT
     I              OMCRCD                      WBCRCD
     I              OMAGCD                      WBAGCD
     I              OMRZST                      WBRZST
     I              OMR0ST                      WBR0ST
     I              OMR1ST                      WBR1ST
     I              OMG7NA                      WBG7NA
     I              OMG8NA                      WBG8NA
     I              OMRPCD                      WBRPCD
     I              OMVEST                      WBVEST
     I              OMVGST                      WBVGST
     I              OMAVST                      WBAVST
     I              OMU0ST                      WBU0ST
     I              OMRFCD                      WBRFCD
     I              OMFZST                      WBFZST
     I              OMR1NB                      WBR1NB
     I              OMAVQT                      WBAVQT
     I              OMD0WG                      WBD0WG
     I              OMCCQT                      WBCCQT
     I              OMAUWG                      WBAUWG
     I              OMCBQT                      WBCBQT
     I              OMATWG                      WBATWG
     I              OMAQCS                      WBAQCS
     I              OMAGCS                      WBAGCS
     I              OMAKPR                      WBAKPR
     I              OMALPR                      WBALPR
     I              OMAUPR                      WBAUPR
     I              OMAVWG                      WBAVWG
     I              OMA4WG                      WBA4WG
     I              OMA5DT                      WBA5DT
     I              OMAODT                      WBAODT
     I              OMGNDT                      WBGNDT
     I              OMAMST                      WBAMST
     I              OMANST                      WBANST
     I              OMVAST                      WBVAST
     I              OMRGNB                      WBRGNB
     I              OMRHNB                      WBRHNB
     I              OMRINB                      WBRINB
     I              OMRBCD                      WBRBCD
     I              OMHICD                      WBHICD
     I              OMRNCD                      WBRNCD
     I              OMROCD                      WBROCD
     I              OMCXDT                      WBCXDT
     I              OMAJVN                      WBAJVN
     I              OMKXCD                      WBKXCD
     I              OMJPCD                      WBJPCD
     I              OMCQCD                      WBCQCD
     I              OMR4CD                      WBR4CD
     I              OMZ1ST                      WBZ1ST
     I              OMZ3ST                      WBZ3ST
     I              OMZ4ST                      WBZ4ST
     I              OMDUPR                      WBDUPR
     I              OMB6VL                      WBB6VL
     I              OMA1AA                      WBA1AA
     I              OMFZSX                      WBFZSX
     I              OMF0SX                      WBF0SX
     I              OMF1SX                      WBF1SX
     I              OMF2SX                      WBF2SX
     I              OMF3SX                      WBF3SX
     I              OMF4SX                      WBF4SX
     I              OMF5SX                      WBF5SX
     I              OMF6SX                      WBF6SX
     I              OMF7SX                      WBF7SX
     I              OMNTDT                      WBNTDT
     I              OMNUDT                      WBNUDT
     I              OMNVDT                      WBNVDT
     I              OMNWDT                      WBNWDT
     I              OMNXDT                      WBNXDT
     I              OMBUTM                      WBBUTM
     I              OMBVTM                      WBBVTM
     I              OMBWTM                      WBBWTM
     I              OMBXTM                      WBBXTM
     I              OMBYTM                      WBBYTM
     I              OMH5NX                      WBH5NX
     I              OMH6NX                      WBH6NX
     I              OMH7NX                      WBH7NX
     I              OMH8NX                      WBH8NX
     I              OMH9NX                      WBH9NX
     I              OMDVPR                      WBDVPR
     I              OMDWPR                      WBDWPR
     I              OMDXPR                      WBDXPR
     I              OMDYPR                      WBDYPR
     I              OMDZPR                      WBDZPR
     I              OMGSPR                      WBGSPR
     I              OMGTPR                      WBGTPR
     I              OMGUPR                      WBGUPR
     I              OMHOST                      WBHOST
     I              OMHPST                      WBHPST
     I              OMIOST                      WBIOST
     I              OMPEWG                      WBPEWG
     I              OMRINY                      WBRINY
     I              OMTIDT                      WBTIDT
     I              OMTJDT                      WBTJDT
     I              OMH2ST                      WBH2ST
     I              OMH0ST                      WBH0ST
     I              OMH1ST                      WBH1ST
     I              OMTKDT                      WBTKDT
     I              OMTLDT                      WBTLDT
     I              OMTMDT                      WBTMDT
     I              OMUVST                      WBUVST
     I              OMUWST                      WBUWST
     I              OMUXST                      WBUXST
     I              OMAATM                      WBAATM
     I              OMAYNA                      WBAYNA
     I              OMA0NA                      WBA0NA
     I              OMAXDT                      WBAXDT
      *
     I@ADREAO
      * Warehouse Codes           Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                      WCAJCD
     I              ADF8NA                      WCF8NA
     I              ADACNA                      WCACNA
     I              ADADNA                      WCADNA
     I              ADAENA                      WCAENA
     I              ADAJNA                      WCAJNA
     I              ADBTTX                      WCBTTX
     I              ADAOCD                      WCAOCD
     I              ADBGCD                      WCBGCD
     I              ADVHST                      WCVHST
     I              ADMPNA                      WCMPNA
     I              ADWPST                      WCWPST
     I              ADXUST                      WCXUST
     I              ADT0ST                      WCT0ST
     I              ADT1ST                      WCT1ST
     I              ADDBNB                      WCDBNB
     I              ADT2ST                      WCT2ST
     I              ADT3ST                      WCT3ST
     I              ADT4ST                      WCT4ST
     I              ADT6ST                      WCT6ST
     I              ADBWC3                      WCBWC3
     I              ADBTC3                      WCBTC3
     I              ADBUC3                      WCBUC3
     I              ADBVC3                      WCBVC3
     I              ADFCAA                      WCFCAA
     I              ADRQSX                      WCRQSX
     I              ADRRSX                      WCRRSX
     I              ADRSSX                      WCRSSX
     I              ADRTSX                      WCRTSX
     I              ADT7ST                      WCT7ST
     I              ADT8ST                      WCT8ST
     I              ADRNSX                      WCRNSX
     I              ADROSX                      WCROSX
     I              ADRPSX                      WCRPSX
     I              ADUVST                      WCUVST
     I              ADUWST                      WCUWST
     I              ADUXST                      WCUXST
     I              ADVSST                      WCVSST
     I              ADAATM                      WCAATM
     I              ADAYNA                      WCAYNA
     I              ADA0NA                      WCA0NA
     I              ADAXDT                      WCAXDT
      *
     I@G0REJZ
      * EDI WHS Interchange       Retrieval index
      * Renamed input format fields
     I              G0AJCD                      WDAJCD
     I              G0M4AA                      WDM4AA
     I              G0M7AA                      WDM7AA
     I              G0J5NX                      WDJ5NX
     I              G0X2T1                      WDX2T1
     I              G0JBSC                      WDJBSC
     I              G0JCSC                      WDJCSC
     I              G0JDSC                      WDJDSC
     I              G0JESC                      WDJESC
     I              G0QGU1                      WDQGU1
     I              G0F5NZ                      WDF5NZ
     I              G0LSSC                      WDLSSC
     I              G0LTSC                      WDLTSC
     I              G0AHAB                      WDAHAB
     I              G0F6NZ                      WDF6NZ
     I              G0VSST                      WDVSST
     I              G0MJDT                      WDMJDT
     I              G0BETM                      WDBETM
     I              G0CCVN                      WDCCVN
     I              G0CDVN                      WDCDVN
     I              G0MKDT                      WDMKDT
     I              G0BFTM                      WDBFTM
     I              G0CEVN                      WDCEVN
     I              G0CFVN                      WDCFVN
      *
     I@GQREH2
      * EDI Bill To Interchange   Retrieval index
      * Renamed input format fields
     I              GQB0C7                      WEB0C7
     I              GQM4AA                      WEM4AA
     I              GQM7AA                      WEM7AA
     I              GQJ5NX                      WEJ5NX
     I              GQA8U1                      WEA8U1
     I              GQA9U1                      WEA9U1
     I              GQBAU1                      WEBAU1
     I              GQBBU1                      WEBBU1
     I              GQY4NY                      WEY4NY
     I              GQY5NY                      WEY5NY
     I              GQBFU1                      WEBFU1
     I              GQBGU1                      WEBGU1
     I              GQBHU1                      WEBHU1
     I              GQBIU1                      WEBIU1
     I              GQSIAA                      WESIAA
     I              GQSJAA                      WESJAA
     I              GQVSST                      WEVSST
     I              GQMJDT                      WEMJDT
     I              GQBETM                      WEBETM
     I              GQCCVN                      WECCVN
     I              GQCDVN                      WECDVN
     I              GQMKDT                      WEMKDT
     I              GQBFTM                      WEBFTM
     I              GQCEVN                      WECEVN
     I              GQCFVN                      WECFVN
      *
     I@B8REVF
      * Trade Partner Control     Retrieval index
      * Renamed input format fields
     I              B8J5NX                      WFJ5NX
     I              B8CBSC                      WFCBSC
     I              B8CCSC                      WFCCSC
     I              B8CDSC                      WFCDSC
     I              B8CESC                      WFCESC
     I              B8CFSC                      WFCFSC
     I              B8CGSC                      WFCGSC
     I              B8CHSC                      WFCHSC
     I              B8CISC                      WFCISC
     I              B8CJSC                      WFCJSC
     I              B8CKSC                      WFCKSC
     I              B8CLSC                      WFCLSC
     I              B8CMSC                      WFCMSC
     I              B8CNSC                      WFCNSC
     I              B8EHU1                      WFEHU1
     I              B8EIU1                      WFEIU1
     I              B8EJU1                      WFEJU1
     I              B8EKU1                      WFEKU1
     I              B8V1DT                      WFV1DT
     I              B8V2DT                      WFV2DT
     I              B8VSST                      WFVSST
     I              B8MJDT                      WFMJDT
     I              B8BETM                      WFBETM
     I              B8CCVN                      WFCCVN
     I              B8CDVN                      WFCDVN
     I              B8MKDT                      WFMKDT
     I              B8BFTM                      WFBFTM
     I              B8CEVN                      WFCEVN
     I              B8CFVN                      WFCFVN
      *
     I@FNCPCT
      * Manifest Detail           Retrieval index
      * Renamed input format fields
     I              FNAIC3                      WGAIC3
     I              FNC4NB                      WGC4NB
     I              FNDPNB                      WGDPNB
     I              FNUENB                      WGUENB
     I              FNRZNB                      WGRZNB
     I              FNFOQT                      WGFOQT
     I              FNR0NB                      WGR0NB
     I              FNPMST                      WGPMST
     I              FNK7DT                      WGK7DT
     I              FNPFNX                      WGPFNX
     I              FNHGCD                      WGHGCD
     I              FNAJCD                      WGAJCD
     I              FNELDT                      WGELDT
     I              FNN5WG                      WGN5WG
     I              FNRZNA                      WGRZNA
     I              FNH5NY                      WGH5NY
     I              FNH6NY                      WGH6NY
     I              FNH7NY                      WGH7NY
     I              FNGBTX                      WGGBTX
     I              FNN6WG                      WGN6WG
     I              FNN7WG                      WGN7WG
     I              FNGCTX                      WGGCTX
     I              FNGDTX                      WGGDTX
     I              FNRBDT                      WGRBDT
     I              FNITNY                      WGITNY
     I              FNIVNY                      WGIVNY
     I              FNIUNY                      WGIUNY
     I              FNIWNY                      WGIWNY
     I              FNIXNY                      WGIXNY
     I              FNIYNY                      WGIYNY
     I              FNUVST                      WGUVST
     I              FNUWST                      WGUWST
     I              FNUXST                      WGUXST
     I              FNVSST                      WGVSST
     I              FNAATM                      WGAATM
     I              FNAYNA                      WGAYNA
     I              FNA0NA                      WGA0NA
     I              FNAXDT                      WGAXDT
      *
     I@AMREJF
      * Order Header Extension    Retrieval index
      * Renamed input format fields
     I              AMAIC3                      WHAIC3
     I              AMC4NB                      WHC4NB
     I              AMRMNB                      WHRMNB
     I              AMRUNB                      WHRUNB
     I              AMXACD                      WHXACD
     I              AMOANA                      WHOANA
     I              AMHBAA                      WHHBAA
     I              AMJ0T1                      WHJ0T1
     I              AMGENY                      WHGENY
     I              AMJ1T1                      WHJ1T1
     I              AMHCAA                      WHHCAA
     I              AMQWDT                      WHQWDT
     I              AMQXDT                      WHQXDT
     I              AMQYDT                      WHQYDT
     I              AMHDAA                      WHHDAA
     I              AMCCTX                      WHCCTX
     I              AMJ2T1                      WHJ2T1
     I              AMRLNA                      WHRLNA
     I              AMRMNA                      WHRMNA
     I              AMGINY                      WHGINY
     I              AMGFNY                      WHGFNY
     I              AMGGNY                      WHGGNY
     I              AMGHNY                      WHGHNY
     I              AMHEVL                      WHHEVL
     I              AMHFVL                      WHHFVL
     I              AMHGVL                      WHHGVL
     I              AMQZDT                      WHQZDT
     I              AMQ0DT                      WHQ0DT
     I              AMQ1DT                      WHQ1DT
     I              AMQ2DT                      WHQ2DT
     I              AMC2TX                      WHC2TX
     I              AMC3TX                      WHC3TX
     I              AMC6TX                      WHC6TX
     I              AMCHTX                      WHCHTX
     I              AMCITX                      WHCITX
     I              AMCLTX                      WHCLTX
     I              AMB4TX                      WHB4TX
     I              AMCUTX                      WHCUTX
     I              AMCVTX                      WHCVTX
     I              AMB9TX                      WHB9TX
     I              AMJWSC                      WHJWSC
     I              AMITNY                      WHITNY
     I              AMLMT1                      WHLMT1
     I              AMLWAA                      WHLWAA
     I              AMFVST                      WHFVST
     I              AMF0ST                      WHF0ST
     I              AMF2ST                      WHF2ST
     I              AMF3ST                      WHF3ST
     I              AMJUSC                      WHJUSC
     I              AMJVSC                      WHJVSC
     I              AMV3T1                      WHV3T1
     I              AMV4T1                      WHV4T1
     I              AMV5T1                      WHV5T1
     I              AMV6T1                      WHV6T1
     I              AMV7T1                      WHV7T1
     I              AMV8T1                      WHV8T1
     I              AMV9T1                      WHV9T1
     I              AMWAT1                      WHWAT1
     I              AMWBT1                      WHWBT1
     I              AMWCT1                      WHWCT1
     I              AMWDT1                      WHWDT1
     I              AMQJNY                      WHQJNY
     I              AMQKNY                      WHQKNY
     I              AMQLNY                      WHQLNY
     I              AMP8NY                      WHP8NY
     I              AMP9NY                      WHP9NY
     I              AMQANY                      WHQANY
     I              AMQCNY                      WHQCNY
     I              AMQDNY                      WHQDNY
     I              AMQENY                      WHQENY
     I              AMQFNY                      WHQFNY
     I              AMQGNY                      WHQGNY
     I              AMQHNY                      WHQHNY
     I              AMQINY                      WHQINY
     I              AMQMNY                      WHQMNY
     I              AMMYU1                      WHMYU1
     I              AMJXSC                      WHJXSC
     I              AMJYSC                      WHJYSC
     I              AMJZSC                      WHJZSC
     I              AMJ0SC                      WHJ0SC
     I              AMMZU1                      WHMZU1
     I              AMM0U1                      WHM0U1
     I              AMM1U1                      WHM1U1
     I              AMM2U1                      WHM2U1
     I              AMM3U1                      WHM3U1
     I              AMW5DT                      WHW5DT
     I              AMW6DT                      WHW6DT
     I              AMUVST                      WHUVST
     I              AMUWST                      WHUWST
     I              AMUXST                      WHUXST
     I              AMVSST                      WHVSST
     I              AMAATM                      WHAATM
     I              AMAYNA                      WHAYNA
     I              AMA0NA                      WHA0NA
     I              AMAXDT                      WHAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                      WIAIC3
     I              OMC4NB                      WIC4NB
     I              OMDPNB                      WIDPNB
     I              OMUENB                      WIUENB
     I              OMHGCD                      WIHGCD
     I              OMAJCD                      WIAJCD
     I              OMBKC7                      WIBKC7
     I              OMCFC7                      WICFC7
     I              OMGMST                      WIGMST
     I              OMGNST                      WIGNST
     I              OMMAVA                      WIMAVA
     I              OMKDVA                      WIKDVA
     I              OML8VA                      WIL8VA
     I              OML9VA                      WIL9VA
     I              OMGTST                      WIGTST
     I              OMGVST                      WIGVST
     I              OMGUST                      WIGUST
     I              OMQFST                      WIQFST
     I              OMAYVA                      WIAYVA
     I              OMEXDT                      WIEXDT
     I              OMLQCD                      WILQCD
     I              OMRDCD                      WIRDCD
     I              OMQ7CD                      WIQ7CD
     I              OMBZPR                      WIBZPR
     I              OML6NB                      WIL6NB
     I              OMU1ST                      WIU1ST
     I              OMGIDT                      WIGIDT
     I              OMCRCD                      WICRCD
     I              OMAGCD                      WIAGCD
     I              OMRZST                      WIRZST
     I              OMR0ST                      WIR0ST
     I              OMR1ST                      WIR1ST
     I              OMG7NA                      WIG7NA
     I              OMG8NA                      WIG8NA
     I              OMRPCD                      WIRPCD
     I              OMVEST                      WIVEST
     I              OMVGST                      WIVGST
     I              OMAVST                      WIAVST
     I              OMU0ST                      WIU0ST
     I              OMRFCD                      WIRFCD
     I              OMFZST                      WIFZST
     I              OMR1NB                      WIR1NB
     I              OMAVQT                      WIAVQT
     I              OMD0WG                      WID0WG
     I              OMCCQT                      WICCQT
     I              OMAUWG                      WIAUWG
     I              OMCBQT                      WICBQT
     I              OMATWG                      WIATWG
     I              OMAQCS                      WIAQCS
     I              OMAGCS                      WIAGCS
     I              OMAKPR                      WIAKPR
     I              OMALPR                      WIALPR
     I              OMAUPR                      WIAUPR
     I              OMAVWG                      WIAVWG
     I              OMA4WG                      WIA4WG
     I              OMA5DT                      WIA5DT
     I              OMAODT                      WIAODT
     I              OMGNDT                      WIGNDT
     I              OMAMST                      WIAMST
     I              OMANST                      WIANST
     I              OMVAST                      WIVAST
     I              OMRGNB                      WIRGNB
     I              OMRHNB                      WIRHNB
     I              OMRINB                      WIRINB
     I              OMRBCD                      WIRBCD
     I              OMHICD                      WIHICD
     I              OMRNCD                      WIRNCD
     I              OMROCD                      WIROCD
     I              OMCXDT                      WICXDT
     I              OMAJVN                      WIAJVN
     I              OMKXCD                      WIKXCD
     I              OMJPCD                      WIJPCD
     I              OMCQCD                      WICQCD
     I              OMR4CD                      WIR4CD
     I              OMZ1ST                      WIZ1ST
     I              OMZ3ST                      WIZ3ST
     I              OMZ4ST                      WIZ4ST
     I              OMDUPR                      WIDUPR
     I              OMB6VL                      WIB6VL
     I              OMA1AA                      WIA1AA
     I              OMFZSX                      WIFZSX
     I              OMF0SX                      WIF0SX
     I              OMF1SX                      WIF1SX
     I              OMF2SX                      WIF2SX
     I              OMF3SX                      WIF3SX
     I              OMF4SX                      WIF4SX
     I              OMF5SX                      WIF5SX
     I              OMF6SX                      WIF6SX
     I              OMF7SX                      WIF7SX
     I              OMNTDT                      WINTDT
     I              OMNUDT                      WINUDT
     I              OMNVDT                      WINVDT
     I              OMNWDT                      WINWDT
     I              OMNXDT                      WINXDT
     I              OMBUTM                      WIBUTM
     I              OMBVTM                      WIBVTM
     I              OMBWTM                      WIBWTM
     I              OMBXTM                      WIBXTM
     I              OMBYTM                      WIBYTM
     I              OMH5NX                      WIH5NX
     I              OMH6NX                      WIH6NX
     I              OMH7NX                      WIH7NX
     I              OMH8NX                      WIH8NX
     I              OMH9NX                      WIH9NX
     I              OMDVPR                      WIDVPR
     I              OMDWPR                      WIDWPR
     I              OMDXPR                      WIDXPR
     I              OMDYPR                      WIDYPR
     I              OMDZPR                      WIDZPR
     I              OMGSPR                      WIGSPR
     I              OMGTPR                      WIGTPR
     I              OMGUPR                      WIGUPR
     I              OMHOST                      WIHOST
     I              OMHPST                      WIHPST
     I              OMIOST                      WIIOST
     I              OMPEWG                      WIPEWG
     I              OMRINY                      WIRINY
     I              OMTIDT                      WITIDT
     I              OMTJDT                      WITJDT
     I              OMH2ST                      WIH2ST
     I              OMH0ST                      WIH0ST
     I              OMH1ST                      WIH1ST
     I              OMTKDT                      WITKDT
     I              OMTLDT                      WITLDT
     I              OMTMDT                      WITMDT
     I              OMUVST                      WIUVST
     I              OMUWST                      WIUWST
     I              OMUXST                      WIUXST
     I              OMAATM                      WIAATM
     I              OMAYNA                      WIAYNA
     I              OMA0NA                      WIA0NA
     I              OMAXDT                      WIAXDT
      *
     I@KMREHC
      * Company Values            Retrieval index
      * Renamed input format fields
     I              KMAIC3                      WJAIC3
     I              KMV8CD                      WJV8CD
     I              KMAUNA                      WJAUNA
     I              KMI5ST                      WJI5ST
     I              KMBXTX                      WJBXTX
     I              KMM8NB                      WJM8NB
     I              KMUVST                      WJUVST
     I              KMUWST                      WJUWST
     I              KMUXST                      WJUXST
     I              KMVSST                      WJVSST
     I              KMAATM                      WJAATM
     I              KMAYNA                      WJAYNA
     I              KMA0NA                      WJA0NA
     I              KMAXDT                      WJAXDT
      *
     I@AMREJE
      * Order Header Extension    Update index
      * Renamed input format fields
     I              AMAIC3                      WKAIC3
     I              AMC4NB                      WKC4NB
     I              AMRMNB                      WKRMNB
     I              AMRUNB                      WKRUNB
     I              AMXACD                      WKXACD
     I              AMOANA                      WKOANA
     I              AMHBAA                      WKHBAA
     I              AMJ0T1                      WKJ0T1
     I              AMGENY                      WKGENY
     I              AMJ1T1                      WKJ1T1
     I              AMHCAA                      WKHCAA
     I              AMQWDT                      WKQWDT
     I              AMQXDT                      WKQXDT
     I              AMQYDT                      WKQYDT
     I              AMHDAA                      WKHDAA
     I              AMCCTX                      WKCCTX
     I              AMJ2T1                      WKJ2T1
     I              AMRLNA                      WKRLNA
     I              AMRMNA                      WKRMNA
     I              AMGINY                      WKGINY
     I              AMGFNY                      WKGFNY
     I              AMGGNY                      WKGGNY
     I              AMGHNY                      WKGHNY
     I              AMHEVL                      WKHEVL
     I              AMHFVL                      WKHFVL
     I              AMHGVL                      WKHGVL
     I              AMQZDT                      WKQZDT
     I              AMQ0DT                      WKQ0DT
     I              AMQ1DT                      WKQ1DT
     I              AMQ2DT                      WKQ2DT
     I              AMC2TX                      WKC2TX
     I              AMC3TX                      WKC3TX
     I              AMC6TX                      WKC6TX
     I              AMCHTX                      WKCHTX
     I              AMCITX                      WKCITX
     I              AMCLTX                      WKCLTX
     I              AMB4TX                      WKB4TX
     I              AMCUTX                      WKCUTX
     I              AMCVTX                      WKCVTX
     I              AMB9TX                      WKB9TX
     I              AMJWSC                      WKJWSC
     I              AMITNY                      WKITNY
     I              AMLMT1                      WKLMT1
     I              AMLWAA                      WKLWAA
     I              AMFVST                      WKFVST
     I              AMF0ST                      WKF0ST
     I              AMF2ST                      WKF2ST
     I              AMF3ST                      WKF3ST
     I              AMJUSC                      WKJUSC
     I              AMJVSC                      WKJVSC
     I              AMV3T1                      WKV3T1
     I              AMV4T1                      WKV4T1
     I              AMV5T1                      WKV5T1
     I              AMV6T1                      WKV6T1
     I              AMV7T1                      WKV7T1
     I              AMV8T1                      WKV8T1
     I              AMV9T1                      WKV9T1
     I              AMWAT1                      WKWAT1
     I              AMWBT1                      WKWBT1
     I              AMWCT1                      WKWCT1
     I              AMWDT1                      WKWDT1
     I              AMQJNY                      WKQJNY
     I              AMQKNY                      WKQKNY
     I              AMQLNY                      WKQLNY
     I              AMP8NY                      WKP8NY
     I              AMP9NY                      WKP9NY
     I              AMQANY                      WKQANY
     I              AMQCNY                      WKQCNY
     I              AMQDNY                      WKQDNY
     I              AMQENY                      WKQENY
     I              AMQFNY                      WKQFNY
     I              AMQGNY                      WKQGNY
     I              AMQHNY                      WKQHNY
     I              AMQINY                      WKQINY
     I              AMQMNY                      WKQMNY
     I              AMMYU1                      WKMYU1
     I              AMJXSC                      WKJXSC
     I              AMJYSC                      WKJYSC
     I              AMJZSC                      WKJZSC
     I              AMJ0SC                      WKJ0SC
     I              AMMZU1                      WKMZU1
     I              AMM0U1                      WKM0U1
     I              AMM1U1                      WKM1U1
     I              AMM2U1                      WKM2U1
     I              AMM3U1                      WKM3U1
     I              AMW5DT                      WKW5DT
     I              AMW6DT                      WKW6DT
     I              AMUVST                      WKUVST
     I              AMUWST                      WKUWST
     I              AMUXST                      WKUXST
     I              AMVSST                      WKVSST
     I              AMAATM                      WKAATM
     I              AMAYNA                      WKAYNA
     I              AMA0NA                      WKA0NA
     I              AMAXDT                      WKAXDT
      *
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
     C                   PARM                    P1PARM                         KEY: Order Head
     C     P2KESC        PARM      P2KESC        WP0001                         Set EDI 856 Pal
     C                   PARM      P2KGSC        WP0002                         Create EDI ASN
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * Val Pallet ID 4/856   DN
      * W108669 DN 11/08/22-Added 'Create EDI ASN 856 V2 USR' Flag.
      * Val Pallet ID 4/856   RT - Order Header TRG  * 
     C                   EXSR      SARVGN
      *----------------------------------------------------------------
      * Exit program
     C     AAEXIT        TAG
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
      /EJECT
     CSR   SARVGN        BEGSR
      *================================================================
      * Val Pallet ID 4/856   RT - Order Header TRG  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
     C                   MOVEL     'N'           P2KESC                         Set EDI 856 Pal
      * W108669 DN 11/08/22-Do NOT create EDI 856 if TP Checks for Pallet
     C                   MOVEL     'Y'           P2KGSC                         Create EDI ASN
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSA         KLIST
     C                   KFLD                    WQSA02                         Load ID
      * Setup key
     C                   Z-ADD     P1RMNB        WQSA02                         Load ID
      * Establish starting position
     C     KRSSA         SETLL     @BFCPRQ                                      *
     C     KRSSA         READE     @BFCPRQ                                90    *
      * Data record not found
     C   90              MOVEL     'USR0176'     W0RTN
      * USER: Process Data record
      * W108669 DN 11/7/22-Added to get EDI Trading Partner No.
      * Val Cust Setup 4/856 V2DN
      * VALIDATIONS: Is Bill To Customer Setup for EDI 856 ASN V2?
      * CASE: *OTHERWISE
     C                   DOW       NOT *IN90
     C                   MOVEL     'N'           YL0001                         Create EDI ASN
      * DN-4/13/24-Copy/Move this function here to get what type of Whse.
      * Check Internal or External Warehouse Qualifies for 856 ASN.
      * CASE: *OTHERWISE
      * RTV 1st Whse/Country   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WAAIC3        WL0001                         Company Number
     C                   Z-ADD     WAC4NB        WL0002                         Order Number
     C                   Z-ADD     1             WL0003                         Order Sequence
     C                   Z-ADD     1             WL0004                         Order Secondary
     C                   EXSR      SBRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0005        YL0003                         Warehouse Code
     C                   MOVEL(P)  WL0006        YN0001                         Country Code
      * Rtv Liv w/Carl,Locatn RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                   MOVEL(P)  YL0003        WL0007                         Warehouse Code
     C                   EXSR      SCRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0008        YL0004                         Warehouse Locat
     C                   MOVEL(P)  WL0009        YL0005                         WHS Live with C
     C                   MOVEL(P)  WL0010        YN0003                         WHS PFS Interfa
      * Internal Warehouse Must Be Live with Carlisle.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Warehouse Location is Internal (Plant)
      *   |- c2    : LCL.WHS Live w/Carlisle is Yes
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0004 = 'I'
     C                   IF        YL0005 = 'Y'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   MOVEL     'Y'           YL0001                         Create EDI ASN
     C                   MOVEL     YL0003        YN0002                         Warehouse Code
     C                   ELSE
      * CASE: *OTHERWISE
      * DN-4/13/24-Allow External 3PL Warehouses to Receive EDI 856 ASN.
      * CASE: LCL.Warehouse Location is External
      * DN 5/13/24-We will NOT use EDI WHS Interchange table to
      *   whether 3pl external warehouse is allow to create 856 or not.
      *   We will alter table Warehouse Codes (CAADREP) table to add
      *   new field 'Crt 856 ASN for 3PL Whse'. If value is 'Y' then we
      *   will allow to create the 856 ASN.
      * Rtv Allow 856 f/3PL WhsRT - EDI WHS Interchange  * 
     C                   IF        YL0004 = 'E'
     C                   EXSR      SDRVGN
      * OK to Receive 856 ASN?
      * CASE: LCL.OK to Process USR is Yes
     C                   IF        YL0006 = 'Y'
     C                   MOVEL     'Y'           YL0001                         Create EDI ASN
     C                   MOVEL     YL0003        YN0002                         Warehouse Code
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * DN-4/13/24-Comment Out & Move downstream.
      * DN-4/13/24-Remove check of Program Name USR = 'PDN2XFR'.
      * Do Not Check Customer & Warehouse if Coming From PDN2XFR Program.
      * CASE: PAR.Create EDI ASN 856 V2 USR is Yes
      * RTV EDI ASN 856 Info  RT - EDI Bill To Interchange  * 
      * Move input parameters to subroutine local variables.
     C                   IF        YL0001 = 'Y'
     C                   Z-ADD     WAB0C7        WL0011                         Bill to Custome
     C                   MOVEL(P)  'ADVSN'       WL0012                         Interchange Cod
     C                   EXSR      SERVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0013        YL0002                         EDI Trading Par
     C                   MOVEL(P)  WL0014        YL0007                         EDI Detailed AS
     C                   MOVEL(P)  WL0015        YL0008                         Record Status
      * Bill To Customer Must Be Active & Setup for EDI 856.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.EDI Detailed ASN 856 Rqd is Yes
      *   |- c2    : LCL.Record Status is Active
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0007 = 'Y'
     C                   IF        YL0008 = 'A'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   MOVEL     'Y'           YL0001                         Create EDI ASN
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'N'           YL0001                         Create EDI ASN
     C                   END                                                    *FI
      * DN-4/13/24-Commented out & moved to beginning of code.
      * DN-4/13/24-Wrap logic PUTBXFR inside PAR.Create EDI ASN 856 V2 US
      * CASE: PAR.Create EDI ASN 856 V2 USR is Yes
      * Rtv EDI Manual PO Sts XF - EDI Bill To Interchange  * ADVSN
     C                   IF        YL0001 = 'Y'
     C                   CALL      'PUTBXFR'                            90      Rtv EDI Manual
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAAIC3        WQ0001                         Company Number
     C                   PARM      WAC4NB        WQ0002                         Order Number
     C                   PARM      'ADVSN'       WQ0003                         Interchange Cod
     C     YL0009        PARM      *BLANK        WQ0004                         Send EDI Docume
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PUTBXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * If Send EDI Documents = N, set Create EDI ASN 856 V2 USR = N
      * CASE: LCL.Send EDI Document Y/N is No
     C                   IF        YL0009 = 'N'
     C                   MOVEL     'N'           YL0001                         Create EDI ASN
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * CASE: LCL.Create EDI ASN 856 V2 USR is Yes
      * W108669 DN 11/7/22-Get 'Check 856 Error Pallet=0' Flag.
      * RTV Chk 856 Err Pallt=0RT - Trade Partner Control  * 
     C                   IF        YL0001 = 'Y'
     C                   EXSR      SFRVGN
      * W108669 DN 11/7/22-Pass in 'Check 856 Error Pallet=0' Flag & Get
      *   'Send EDI 856 Pallet Err U' Flag.
      * Val Pallet ID 4/856   RT - Manifest Detail  * 
     C                   EXSR      SGRVGN
      * W108669 DN 11/7/22-Commented Out & Moved Below.
      * W108669 DN 11/7/22-Send Hard Error Email Msg if Pallet ID=0.
      * CASE: LCL.Check 856 Error Pallet=0 is Yes
      * Pallet ID=0, Send Error Message via Email.
      * CASE: LCL.Send EDI 856 Pallet Err U is Yes
     C                   IF        YL0010 = 'Y'
     C                   IF        YL0011 = 'Y'
     C                   MOVEL     'N'           P2KGSC                         Create EDI ASN
      * Rtv OHE EDI 856 Info  RT - Order Header Extension  * 
     C                   EXSR      SHRVGN
      * Do NOT Send Error Email if Already Been Sent.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.OHE EDI 856 Action is Snd-Error
      *   |- c2    : LCL.OHE EDI Error Reasons 2 is Invalid Pallet
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0013 = 'E'
     C                   IF        YL0012 = 'PALLT'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   ELSE
      * CASE: *OTHERWISE
      * Format Email Subject & Message and Send Email.
      * CASE: *OTHERWISE
     C                   EVAL      YL0014 = ' '                                 Company Number
     C                   MOVEL     WAAIC3        YL0014                         Company Number
     C                   EVAL      YL0015 = ' '                                 Load ID Alpha U
     C                   MOVEL     P1RMNB        YL0015                         Load ID Alpha U
     C                   EVAL      YL0016 = ' '                                 Order Number Al
     C                   MOVEL     WAC4NB        YL0016                         Order Number Al
     C                   Z-ADD     0             ZQ
     C     @CN(001)      CAT(P)    'rder:':ZQ    YL0017                         Email Subject U
     C                   Z-ADD     1             ZQ
     C     YL0017        CAT(P)    YL0014:ZQ     YL0017                         Email Subject U
     C                   Z-ADD     0             ZQ
     C     YL0017        CAT(P)    '/':ZQ        YL0017                         Email Subject U
     C                   Z-ADD     0             ZQ
     C     YL0017        CAT(P)    YL0015:ZQ     YL0017                         Email Subject U
     C                   Z-ADD     0             ZQ
     C     YL0017        CAT(P)    '/':ZQ        YL0017                         Email Subject U
     C                   Z-ADD     0             ZQ
     C     YL0017        CAT(P)    YL0016:ZQ     YL0017                         Email Subject U
     C                   Z-ADD     1             ZQ
     C     @CN(002)      CAT(P)    @CN(003):ZQ   YL0018                         Email Message U
      * RTV Whse/Non Cancelled RT - Order Detail  * Get Ship From Whse
     C                   EXSR      SIRVGN
     C                   Z-ADD     1             ZQ
     C     YL0018        CAT(P)    @CN(004):ZQ   YL0018                         Email Message U
     C                   Z-ADD     1             ZQ
     C     YL0018        CAT(P)    YL0019:ZQ     YL0018                         Email Message U
      * Added 'Resolution' Context to Email Message.
      * CASE: *OTHERWISE
      * Force New Line.
     C                   Z-ADD     1             ZQ
     C     YL0018        CAT(P)    '&N':ZQ       YL0018                         Email Message U
     C                   Z-ADD     1             ZQ
     C     YL0018        CAT(P)    @CN(005):ZQ   YL0018                         Email Message U
     C                   Z-ADD     1             ZQ
     C     YL0018        CAT(P)    @CN(006):ZQ   YL0018                         Email Message U
     C                   Z-ADD     1             ZQ
     C     YL0018        CAT(P)    @CN(007):ZQ   YL0018                         Email Message U
     C                   Z-ADD     1             ZQ
     C     YL0018        CAT(P)    @CN(008):ZQ   YL0018                         Email Message U
     C                   Z-ADD     1             ZQ
     C     YL0018        CAT(P)    @CN(009):ZQ   YL0018                         Email Message U
     C                   Z-ADD     1             ZQ
     C     YL0018        CAT(P)    @CN(010):ZQ   YL0018                         Email Message U
      * Exc ESNDMAIL Generic  IF
      * Execute ESNDMAIL to Send Email Message.
      * RTV Alpha Value 2     RT - Company Values  * Get Email Address
     C                   EXSR      SJRVGN
      * CASE: LCL.Email Address is Entered
      * Exc ESNDMAIL Generic  CL - /UT User Programs  * Send Email
     C                   IF        YL0020 <> ' '
     C                   CALL      'PUE8UPC'                            90      Exc ESNDMAIL Ge
     C                   PARM      YL0020        WQ0005                         Email Address
     C                   PARM      YL0017        WQ0006                         Email Subject U
     C                   PARM      YL0018        WQ0007                         Email Message U
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PUE8UPC'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
     C                   END                                                    *FI
      * Upd OHE EDI 856 Error  RT - Order Header Extension  * 
     C                   EXSR      SKRVGN
     C                   END                                                    *FI
     C                   GOTO      SAEXIT                                       *QUIT
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
      * At Least One Pallet ID is Entered, Quit.
      * CASE: PAR.Set EDI 856 Pallet ID=1 U is No
     C                   IF        P2KESC = 'N'
     C                   GOTO      SAEXIT                                       *QUIT
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C     KRSSA         READE     @BFCPRQ                                90    *
     C                   ENDDO
      *================================================================
     CSR   SAEXIT        ENDSR
      /EJECT
     CSR   SBRVGN        BEGSR
      *================================================================
      * RTV 1st Whse/Country   RT - Order Detail  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KPSSB         KLIST
     C                   KFLD                    WQSB01                         Company Number
     C                   KFLD                    WQSB02                         Order Number
     C                   KFLD                    WBDPNB                         Order Sequence
     C                   KFLD                    WBUENB                         Order Secondary
      * Define keylist
     C     KRSSB         KLIST
     C                   KFLD                    WQSB01                         Company Number
     C                   KFLD                    WQSB02                         Order Number
      * Setup key
     C                   Z-ADD     WL0001        WQSB01                         Company Number
     C                   Z-ADD     WL0002        WQSB02                         Order Number
     C                   Z-ADD     WL0003        WBDPNB                         Order Sequence
     C                   Z-ADD     WL0004        WBUENB                         Order Secondary
      * Establish starting position
     C     KPSSB         SETLL     @BGWKAE                                      *
     C     KRSSB         READE     @BGWKAE                                90    *
      * Data record not found
     C   90              MOVEL     'USR1309'     W0RTN
      * USER: Process Data record
      * PAR = DB1 By name
     C                   DOW       NOT *IN90
     C                   MOVEL     WBAJCD        WL0005                         Warehouse Code
     C                   MOVEL     WBKXCD        WL0006                         Country Code
     C                   GOTO      SBEXIT                                       *QUIT
     C     KRSSB         READE     @BGWKAE                                90    *
     C                   ENDDO
      *================================================================
     CSR   SBEXIT        ENDSR
      /EJECT
     CSR   SCRVGN        BEGSR
      *================================================================
      * Rtv Liv w/Carl,Locatn RT - Warehouse  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSC         KLIST
     C                   KFLD                    WCAJCD                         Warehouse Code
      * Setup key
     C                   MOVEL     WL0007        WCAJCD                         Warehouse Code
      * Establish starting position
     C     KRSSC         CHAIN     @ADREAO                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR0007'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      WL0008 = ' '                                 Warehouse Locat
     C                   EVAL      WL0009 = ' '                                 WHS Live with C
     C                   EVAL      WL0010 = ' '                                 WHS PFS Interfa
     C                   GOTO      SCEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     WCT0ST        WL0008                         Warehouse Locat
     C                   MOVEL     WCRRSX        WL0009                         WHS Live with C
     C                   MOVEL     WCRSSX        WL0010                         WHS PFS Interfa
     C                   ENDIF
      *================================================================
     CSR   SCEXIT        ENDSR
      /EJECT
     CSR   SDRVGN        BEGSR
      *================================================================
      * Rtv Allow 856 f/3PL WhsRT - EDI WHS Interchange  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
     C                   MOVEL     'N'           YL0006                         OK to Process U
      * Define keylist
     C     KRSSD         KLIST
     C                   KFLD                    WDAJCD                         Warehouse Code
     C                   KFLD                    WDM4AA                         Interchange Cod
      * Setup key
     C                   MOVEL     YL0003        WDAJCD                         Warehouse Code
     C                   EVALR     WDM4AA = ' '                                 Interchange Cod
     C                   MOVEL     'ADVSN'       WDM4AA                         Interchange Cod
      * Establish starting position
     C     KRSSD         CHAIN     @G0REJZ                            90        *
      * Data record not found
     C   90              MOVEL     'USR4409'     W0RTN
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C                   IF        NOT *IN90
     C                   IF        WDVSST = 'A'
     C                   MOVEL     'Y'           YL0006                         OK to Process U
     C                   END                                                    *FI
     C                   ENDIF
      *================================================================
     CSR   SDEXIT        ENDSR
      /EJECT
     CSR   SERVGN        BEGSR
      *================================================================
      * RTV EDI ASN 856 Info  RT - EDI Bill To Interchange  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
      * PAR = CON By name
     C                   EVAL      WL0013 = ' '                                 EDI Trading Par
     C                   EVAL      WL0014 = ' '                                 EDI Detailed AS
     C                   EVAL      WL0015 = ' '                                 Record Status
      * Define keylist
     C     KRSSE         KLIST
     C                   KFLD                    WEB0C7                         Bill to Custome
     C                   KFLD                    WEM4AA                         Interchange Cod
      * Setup key
     C                   Z-ADD     WL0011        WEB0C7                         Bill to Custome
     C                   MOVEL     WL0012        WEM4AA                         Interchange Cod
      * Establish starting position
     C     KRSSE         CHAIN     @GQREH2                            90        *
      * Data record not found
     C   90              MOVEL     'USR4373'     W0RTN
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     WEJ5NX        WL0013                         EDI Trading Par
     C                   MOVEL     WEBIU1        WL0014                         EDI Detailed AS
     C                   MOVEL     WEVSST        WL0015                         Record Status
     C                   ENDIF
      *================================================================
     CSR   SEEXIT        ENDSR
      /EJECT
     CSR   SFRVGN        BEGSR
      *================================================================
      * RTV Chk 856 Err Pallt=0RT - Trade Partner Control  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
      * PAR = CON By name
     C                   EVAL      YL0010 = ' '                                 Check 856 Error
      * Define keylist
     C     KRSSF         KLIST
     C                   KFLD                    WFJ5NX                         EDI Trading Par
      * Setup key
     C                   MOVEL     YL0002        WFJ5NX                         EDI Trading Par
      * Establish starting position
     C     KRSSF         CHAIN     @B8REVF                            90        *
      * Data record not found
     C   90              MOVEL     'USR4842'     W0RTN
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     WFCKSC        YL0010                         Check 856 Error
     C                   ENDIF
      *================================================================
     CSR   SFEXIT        ENDSR
      /EJECT
     CSR   SGRVGN        BEGSR
      *================================================================
      * Val Pallet ID 4/856   RT - Manifest Detail  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
     C                   MOVEL     'N'           P2KESC                         Set EDI 856 Pal
      * W108669 DN 11/7/22-To Send EDI 856 Error Due to Pallet ID=0.
     C                   MOVEL     'N'           YL0011                         Send EDI 856 Pa
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSG         KLIST
     C                   KFLD                    WQSG01                         Company Number
     C                   KFLD                    WQSG02                         Order Number
      * Setup key
     C                   Z-ADD     WAAIC3        WQSG01                         Company Number
     C                   Z-ADD     WAC4NB        WQSG02                         Order Number
      * Establish starting position
     C     KRSSG         SETLL     @FNCPCT                                      *
     C     KRSSG         READE     @FNCPCT                                90    *
      * Data record not found
     C   90              MOVEL     'USR1196'     W0RTN
      * USER: Process Data record
      * CASE: DB1.Case Quantity is GT *ZERO
     C                   DOW       NOT *IN90
      * W108669 DN 11/07/22-Commented Out & Moved Below.
      * W108669 DN 11/07/22-If 'Check 856 Error Pallet=0'=Y
      * CASE: PAR.Check 856 Error Pallet=0 is Yes
     C                   IF        WGFOQT > 0
      * CASE: DB1.Manifest Pallet Number is Not Entered
     C                   IF        YL0010 = 'Y'
     C                   IF        WGH7NY = 0
     C                   MOVEL     'Y'           YL0011                         Send EDI 856 Pa
     C                   MOVEL     'Y'           P2KESC                         Set EDI 856 Pal
     C                   GOTO      SGEXIT                                       *QUIT
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'N'           P2KESC                         Set EDI 856 Pal
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.Manifest Pallet Number is Not Entered
     C                   IF        WGH7NY = 0
     C                   MOVEL     'Y'           P2KESC                         Set EDI 856 Pal
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'N'           P2KESC                         Set EDI 856 Pal
     C                   GOTO      SGEXIT                                       *QUIT
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C     KRSSG         READE     @FNCPCT                                90    *
     C                   ENDDO
      *================================================================
     CSR   SGEXIT        ENDSR
      /EJECT
     CSR   SHRVGN        BEGSR
      *================================================================
      * Rtv OHE EDI 856 Info  RT - Order Header Extension  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
      * PAR = CON By name
     C                   EVAL      YL0012 = ' '                                 OHE EDI Error R
     C                   EVAL      YL0013 = ' '                                 OHE EDI 856 Act
      * Define keylist
     C     KRSSH         KLIST
     C                   KFLD                    WHAIC3                         Company Number
     C                   KFLD                    WHC4NB                         Order Number
      * Setup key
     C                   Z-ADD     WAAIC3        WHAIC3                         Company Number
     C                   Z-ADD     WAC4NB        WHC4NB                         Order Number
      * Establish starting position
     C     KRSSH         CHAIN     @AMREJF                            90        *
      * Data record not found
     C   90              MOVEL     'USR3697'     W0RTN
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     WHJWSC        YL0012                         OHE EDI Error R
     C                   MOVEL     WHJUSC        YL0013                         OHE EDI 856 Act
     C                   ENDIF
      *================================================================
     CSR   SHEXIT        ENDSR
      /EJECT
     CSR   SIRVGN        BEGSR
      *================================================================
      * RTV Whse/Non Cancelled RT - Order Detail  * Get Ship From Whse
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KPSSI         KLIST
     C                   KFLD                    WQSI01                         Company Number
     C                   KFLD                    WQSI02                         Order Number
     C                   KFLD                    WIDPNB                         Order Sequence
     C                   KFLD                    WIUENB                         Order Secondary
      * Define keylist
     C     KRSSI         KLIST
     C                   KFLD                    WQSI01                         Company Number
     C                   KFLD                    WQSI02                         Order Number
      * Setup key
     C                   Z-ADD     WAAIC3        WQSI01                         Company Number
     C                   Z-ADD     WAC4NB        WQSI02                         Order Number
     C                   Z-ADD     1             WIDPNB                         Order Sequence
     C                   Z-ADD     1             WIUENB                         Order Secondary
      * Establish starting position
     C     KPSSI         SETLL     @BGWKL1                                      *
     C     KRSSI         READE     @BGWKL1                                90    *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR1309'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      YL0019 = ' '                                 Warehouse Code
     C                   GOTO      SIEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * C2748:  Changed RTV Warehouse Code RT to exclude Cancelled lines.
      * CASE: DB1.Detail Line Status is Cancelled
     C                   DOW       NOT *IN90
     C                   IF        WIGMST = 'X'
     C                   ELSE
      * CASE: *OTHERWISE
      * PAR = DB1 By name
     C                   MOVEL     WIAJCD        YL0019                         Warehouse Code
     C                   GOTO      SIEXIT                                       *QUIT
     C                   END                                                    *FI
     C     KRSSI         READE     @BGWKL1                                90    *
     C                   ENDDO
      *================================================================
     CSR   SIEXIT        ENDSR
      /EJECT
     CSR   SJRVGN        BEGSR
      *================================================================
      * RTV Alpha Value 2     RT - Company Values  * Get Email Address
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
      * PAR = CON By name
     C                   EVAL      YL0020 = ' '                                 System Value Al
      * Define keylist
     C     KRSSJ         KLIST
     C                   KFLD                    WJAIC3                         Company Number
     C                   KFLD                    WJV8CD                         Company Value C
      * Setup key
     C                   Z-ADD     WAAIC3        WJAIC3                         Company Number
     C                   MOVEL     @CN(011)      WJV8CD                         Company Value C
      * Establish starting position
     C     KRSSJ         CHAIN     @KMREHC                            90        *
      * Data record not found
     C   90              MOVEL     'USR2221'     W0RTN
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     WJBXTX        YL0020                         System Value Al
     C                   ENDIF
      *================================================================
     CSR   SJEXIT        ENDSR
      /EJECT
     CSR   SKRVGN        BEGSR
      *================================================================
      * Upd OHE EDI 856 Error  RT - Order Header Extension  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSK         KLIST
     C                   KFLD                    WHAIC3                         Company Number
     C                   KFLD                    WHC4NB                         Order Number
      * Setup key
     C                   Z-ADD     WAAIC3        WHAIC3                         Company Number
     C                   Z-ADD     WAC4NB        WHC4NB                         Order Number
      * Establish starting position
     C     KRSSK         CHAIN     @AMREJF                            90        *
      * Data record not found
     C   90              MOVEL     'USR3697'     W0RTN
      * USER: Process Data record
      * CHG OHE EDI 856 Error  CH - Order Header Extension  * 
     C                   IF        NOT *IN90
     C                   EXSR      SLCHRC
     C                   ENDIF
      *================================================================
     CSR   SKEXIT        ENDSR
      /EJECT
     CSR   SLCHRC        BEGSR
      *================================================================
      * CHG OHE EDI 856 Error  CH - Order Header Extension  * 
      *================================================================
      *
     C                   Z-ADD     *ZERO         WN0001                         Load ID
     C                   Z-ADD     *ZERO         WN0002                         Stop_Drop Seque
     C                   EVAL      WN0003 = ' '                                 Shipping Line
     C                   EVAL      WN0004 = ' '                                 Port Delv Termi
     C                   EVAL      WN0005 = ' '                                 OHE City
     C                   EVAL      WN0006 = ' '                                 OHE Vessel_Airl
     C                   EVAL      WN0007 = ' '                                 OHE Voyage_Flig
     C                   EVAL      WN0008 = ' '                                 OHE Booking Num
     C                   EVAL      WN0009 = ' '                                 OHE Discharge P
     C                   Z-ADD     *ZERO         WN0010                         OHE Sail_Flight
     C                   Z-ADD     *ZERO         WN0011                         OHE Port Cut Da
     C                   Z-ADD     *ZERO         WN0012                         OHE Arrival Dat
     C                   EVAL      WN0013 = ' '                                 OHE Late Delive
     C                   EVAL      WN0014 = ' '                                 OHE Ship Status
     C                   EVAL      WN0015 = ' '                                 OHE Container N
     C                   EVAL      WN0016 = ' '                                 OHE Comment 1
     C                   EVAL      WN0017 = ' '                                 OHE Comment 2
     C                   Z-ADD     *ZERO         WN0018                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WN0019                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WN0020                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WN0021                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WN0022                         OHE HPB RIN Equ
     C                   Z-ADD     *ZERO         WN0023                         OHE HPB RIN Pri
     C                   Z-ADD     *ZERO         WN0024                         Transload Termi
     C                   Z-ADD     *ZERO         WN0025                         OHE Est Arrv at
     C                   Z-ADD     *ZERO         WN0026                         OHE Backhaul ET
     C                   Z-ADD     *ZERO         WN0027                         OHE Port_Pier P
     C                   Z-ADD     *ZERO         WN0028                         OHE Actual Ship
     C                   EVAL      WN0029 = ' '                                 OHE Carrier SCA
     C                   EVAL      WN0030 = ' '                                 OHE Spot Buy
     C                   EVAL      WN0031 = ' '                                 OHE PO ACK Flag
     C                   EVAL      WN0032 = ' '                                 OHE Override Ty
     C                   EVAL      WN0033 = ' '                                 OHE Backhaul St
     C                   EVAL      WN0034 = ' '                                 OHE Backhaul ET
     C                   EVAL      WN0035 = ' '                                 OHE Load Haul T
     C                   EVAL      WN0036 = ' '                                 OHE Backhaul Ca
     C                   EVAL      WN0037 = ' '                                 OHE Bookings Co
     C                   EVAL      WN0038 = ' '                                 OHE EDI Error R
     C                   Z-ADD     *ZERO         WN0039                         HPB COA Batch N
     C                   EVAL      WN0040 = ' '                                 Delivery P_O  N
     C                   EVAL      WN0041 = ' '                                 OHE Intended fo
     C                   EVAL      WN0042 = ' '                                 OHE EDI 943 Act
     C                   EVAL      WN0043 = ' '                                 OHE EDI 944 Act
     C                   EVAL      WN0044 = ' '                                 OHE EDI 940 Act
     C                   EVAL      WN0045 = ' '                                 OHE EDI 945 Act
     C                   EVAL      WN0046 = ' '                                 OHE EDI 824 Act
     C                   EVAL      WN0047 = ' '                                 OHE Transload S
     C                   EVAL      WN0048 = ' '                                 OHE Abs Rate Ov
     C                   EVAL      WN0049 = ' '                                 OHE Appt Confir
     C                   EVAL      WN0050 = ' '                                 OHE Backhaul Co
     C                   EVAL      WN0051 = ' '                                 OHE Backhaul Ch
     C                   EVAL      WN0052 = ' '                                 OHE Transload C
     C                   EVAL      WN0053 = ' '                                 OHE Pier Pass I
     C                   EVAL      WN0054 = ' '                                 OHE Carrier Nm
     C                   EVAL      WN0055 = ' '                                 OHE Appt Confir
     C                   EVAL      WN0056 = ' '                                 OHE Backhaul Co
     C                   EVAL      WN0057 = ' '                                 Letter of Credi
     C                   Z-ADD     *ZERO         WN0058                         OHE Backhaul Re
     C                   Z-ADD     *ZERO         WN0059                         LD Stop_Drop
     C                   Z-ADD     *ZERO         WN0060                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WN0061                         OHE Pier Pass F
     C                   Z-ADD     *ZERO         WN0062                         OHE Port Check
     C                   Z-ADD     *ZERO         WN0063                         OHE Port Cut Ti
     C                   Z-ADD     *ZERO         WN0064                         OHE Backhaul Tr
     C                   Z-ADD     *ZERO         WN0065                         OHE Load Sched
     C                   Z-ADD     *ZERO         WN0066                         Original Appoin
     C                   Z-ADD     *ZERO         WN0067                         Original Appoin
     C                   Z-ADD     *ZERO         WN0068                         OHE PowerPro Lo
     C                   Z-ADD     *ZERO         WN0069                         OHE PowerPro Lo
     C                   Z-ADD     *ZERO         WN0070                         OHE Unused Nume
     C                   Z-ADD     *ZERO         WN0071                         OHE Orig ABS Fr
     C                   EVAL      WN0072 = ' '                                 OHE Genset Numb
     C                   EVAL      WN0073 = ' '                                 OHE Email BOL_S
     C                   EVAL      WN0074 = ' '                                 OHE EDI Order A
     C                   EVAL      WN0075 = ' '                                 OHE EDI 601 Act
     C                   EVAL      WN0076 = ' '                                 OHE Unused Stat
     C                   EVAL      WN0077 = ' '                                 OHE Unused Text
     C                   EVAL      WN0078 = ' '                                 OHE Unused Text
     C                   EVAL      WN0079 = ' '                                 OHE Customer Ve
     C                   EVAL      WN0080 = ' '                                 OHE EDI 824 AES
     C                   EVAL      WN0081 = ' '                                 OHE Unused Text
     C                   Z-ADD     *ZERO         WN0082                         OHE Unused Date
     C                   Z-ADD     *ZERO         WN0083                         OHE Unused Date
     C                   EVAL      WN0084 = ' '                                 EDI Status 1
     C                   EVAL      WN0085 = ' '                                 EDI Status 2
     C                   EVAL      WN0086 = ' '                                 EDI Status 3
     C                   EVAL      WN0087 = ' '                                 Record Status
     C                   Z-ADD     *ZERO         WN0088                         Job Time
     C                   EVAL      WN0089 = ' '                                 User Id
     C                   EVAL      WN0090 = ' '                                 Job Name
     C                   Z-ADD     *ZERO         WN0091                         Job Date
      *
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YARDC = ' '
      *
      * Move key fields to @AMREJE
     C                   Z-ADD     WHAIC3        WKAIC3                         Company Number
     C                   Z-ADD     WHC4NB        WKC4NB                         Order Number
      *
     C     KLCHSL        KLIST
     C                   KFLD                    WKAIC3                         Company Number
     C                   KFLD                    WKC4NB                         Order Number
     C     KLCHSL        CHAIN     @AMREJE                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'PMAMREL0'    MDACP
     C                   MOVEL     '@AMREJE'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL001.
     C                   MOVEL     'LBL001'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      SLEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      SLEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QPMAM1        YARDCS
      * Move non-key fields to @AMREJE
     C                   MOVEL(P)  'PALLT'       WKJWSC                         OHE EDI Error R
     C                   MOVEL(P)  'E'           WKJUSC                         OHE EDI 856 Act
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QPMAM1 <> YARDCS AND
     C                             YARDC <> 'N'
     C                   MOVE      'Y'           YARDC
     C                   ENDIF
      * USER: Processing before Data update
     C                   Z-ADD     ##JTM         WKAATM                         Job Time
     C                   Z-ADD     ##JDT         WKAXDT                         Job Date
     C                   MOVEL     ##PGM         WKA0NA                         Job Name
     C                   MOVEL     ##USR         WKAYNA                         User Id
      * Set PGM.*Record Data Changed flag
     C                   IF        QPMAM1 <> YARDCS AND
     C                             YARDC <> 'N'
     C                   MOVE      'Y'           YARDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YARDC = 'Y'
     C                   UPDATE    @AMREJE                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    PMAMREL0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   SLEXIT        ENDSR
      /EJECT
     CSR   ZASNMS        BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C                   IF        ZAPGMQ = ' '
     C                   MOVEL     ##PGM         ZAPGMQ
     C                   END
     C                   CALL      'Y2SNMGC'
     C                   PARM                    ZAPGMQ                         Program queue
     C                   PARM                    ZAPGRL                         Rel queue
     C                   PARM                    ZAMSID                         Message ID
     C                   PARM                    ZAMSGF                         Message file
     C                   PARM                    ZAMSDA                         Message data
     C                   PARM                    ZAMSTP                         Message type
     C                   PARM      'Y'           YILE
      * Clear all fields for default mechanism next time
     C                   EVAL      ZAPGMQ = ' '
     C                   EVAL      ZAPGRL = ' '
     C                   EVAL      ZAMSID = ' '
     C                   EVAL      ZAMSGF = ' '
     C                   EVAL      ZAMSDA = ' '
     C                   EVAL      ZAMSTP = ' '
      *================================================================
     CSR   ZAEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      *
      *
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WAAIC3                         Company Number
     C                   Z-ADD     *ZERO         WAC4NB                         Order Number
     C                   Z-ADD     *ZERO         WAANC7                         AR Customer Num
     C                   Z-ADD     *ZERO         WABKC7                         Ship To Custome
     C                   Z-ADD     *ZERO         WAB0C7                         Bill to Custome
     C                   Z-ADD     *ZERO         WAA0DT                         Order Date
     C                   Z-ADD     *ZERO         WAA5DT                         Requested Ship
     C                   Z-ADD     *ZERO         WAGNDT                         Actual Shipped
     C                   Z-ADD     *ZERO         WAACDT                         Cancel Date
     C                   Z-ADD     *ZERO         WAAODT                         Scheduled Ship
     C                   Z-ADD     *ZERO         WACXDT                         Date of Origina
     C                   Z-ADD     *ZERO         WAJZVA                         Order Value Tot
     C                   Z-ADD     *ZERO         WAA1WG                         Order Weight To
     C                   Z-ADD     *ZERO         WAEIDT                         Requested Deliv
     C                   Z-ADD     *ZERO         WAAFTM                         Requested Deliv
     C                   Z-ADD     *ZERO         WARMNB                         Load ID
     C                   Z-ADD     *ZERO         WATBNB                         Absorbed Freigh
     C                   Z-ADD     *ZERO         WAR1NB                         Rated Freight
     C                   Z-ADD     *ZERO         WARNNB                         Reefer Temperat
     C                   Z-ADD     *ZERO         WAATIN                         Attach to Invoi
     C                   Z-ADD     *ZERO         WARSRN                         Resell Referenc
     C                   Z-ADD     *ZERO         WAT3NB                         Attach to Order
     C                   Z-ADD     *ZERO         WACONB                         Invoice Number
     C                   Z-ADD     *ZERO         WAAWDT                         Invoice Date
     C                   Z-ADD     *ZERO         WAVRVA                         A_R order Value
     C                   Z-ADD     *ZERO         WAB7VL                         Invoice Order V
     C                   Z-ADD     *ZERO         WANODT                         OH Appt Confirm
     C                   Z-ADD     *ZERO         WANPDT                         JPN Invoice Iss
     C                   Z-ADD     *ZERO         WANQDT                         Load Actual Shi
     C                   Z-ADD     *ZERO         WANRDT                         Load BOL Comple
     C                   Z-ADD     *ZERO         WANSDT                         Load Truck Depa
     C                   Z-ADD     *ZERO         WABPTM                         Maximum Gross W
     C                   Z-ADD     *ZERO         WABQTM                         Time of Origina
     C                   Z-ADD     *ZERO         WABRTM                         OH Appt Confirm
     C                   Z-ADD     *ZERO         WABSTM                         Load BOL Comple
     C                   Z-ADD     *ZERO         WABTTM                         Load Truck Depa
     C                   Z-ADD     *ZERO         WAH0NX                         Act Frt Referen
     C                   Z-ADD     *ZERO         WAH1NX                         Act Non_Ref Frt
     C                   Z-ADD     *ZERO         WAH2NX                         OH Fuel Surchar
     C                   Z-ADD     *ZERO         WAH3NX                         OH Total Non_Re
     C                   Z-ADD     *ZERO         WAH4NX                         OH Total Ref Fr
     C                   Z-ADD     *ZERO         WAC0C7                         Claim Number
     C                   Z-ADD     *ZERO         WAAATM                         Job Time
     C                   Z-ADD     *ZERO         WAAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WBAIC3                         Company Number
     C                   Z-ADD     *ZERO         WBC4NB                         Order Number
     C                   Z-ADD     *ZERO         WBDPNB                         Order Sequence
     C                   Z-ADD     *ZERO         WBUENB                         Order Secondary
     C                   Z-ADD     *ZERO         WBHGCD                         Item Code
     C                   Z-ADD     *ZERO         WBBKC7                         Ship To Custome
     C                   Z-ADD     *ZERO         WBCFC7                         Order Group Cod
     C                   Z-ADD     *ZERO         WBMAVA                         Billing Detail
     C                   Z-ADD     *ZERO         WBKDVA                         Billing Detail
     C                   Z-ADD     *ZERO         WBL8VA                         Billing Detail
     C                   Z-ADD     *ZERO         WBL9VA                         Quantity to Sub
     C                   Z-ADD     *ZERO         WBAYVA                         Extended Amount
     C                   Z-ADD     *ZERO         WBEXDT                         Market Pricing
     C                   Z-ADD     *ZERO         WBBZPR                         Price Overage O
     C                   Z-ADD     *ZERO         WBL6NB                         Contract Number
     C                   Z-ADD     *ZERO         WBGIDT                         Pricing Date Us
     C                   Z-ADD     *ZERO         WBR1NB                         Rated Freight
     C                   Z-ADD     *ZERO         WBAVQT                         Quantity Ordere
     C                   Z-ADD     *ZERO         WBD0WG                         Weight Ordered
     C                   Z-ADD     *ZERO         WBCCQT                         Quantity Schedu
     C                   Z-ADD     *ZERO         WBAUWG                         Weight Schedule
     C                   Z-ADD     *ZERO         WBCBQT                         Quantity Shippe
     C                   Z-ADD     *ZERO         WBATWG                         Weight Shipped
     C                   Z-ADD     *ZERO         WBAQCS                         Unit Cost Prici
     C                   Z-ADD     *ZERO         WBAGCS                         Unit Cost Per P
     C                   Z-ADD     *ZERO         WBAKPR                         Unit Price
     C                   Z-ADD     *ZERO         WBALPR                         Unit Price_Cred
     C                   Z-ADD     *ZERO         WBAUPR                         Unit Price Orde
     C                   Z-ADD     *ZERO         WBAVWG                         Unit Weight Ord
     C                   Z-ADD     *ZERO         WBA4WG                         Tare Weight Tot
     C                   Z-ADD     *ZERO         WBA5DT                         Requested Ship
     C                   Z-ADD     *ZERO         WBAODT                         Scheduled Ship
     C                   Z-ADD     *ZERO         WBGNDT                         Actual Shipped
     C                   Z-ADD     *ZERO         WBRGNB                         Item Structure
     C                   Z-ADD     *ZERO         WBRHNB                         Item Structure
     C                   Z-ADD     *ZERO         WBRINB                         Item Structure
     C                   Z-ADD     *ZERO         WBCXDT                         Date of Origina
     C                   Z-ADD     *ZERO         WBDUPR                         Invoice Unit Pr
     C                   Z-ADD     *ZERO         WBB6VL                         Invoice Extende
     C                   Z-ADD     *ZERO         WBA1AA                         Ham Group Numbe
     C                   Z-ADD     *ZERO         WBNTDT                         Warehouse Palle
     C                   Z-ADD     *ZERO         WBNUDT                         Consumed Item C
     C                   Z-ADD     *ZERO         WBNVDT                         Deadline Depart
     C                   Z-ADD     *ZERO         WBNWDT                         OD Price Type R
     C                   Z-ADD     *ZERO         WBNXDT                         OD Firm Date
     C                   Z-ADD     *ZERO         WBBUTM                         Deadline Depart
     C                   Z-ADD     *ZERO         WBBVTM                         Price Code
     C                   Z-ADD     *ZERO         WBBWTM                         Maximum Net Wei
     C                   Z-ADD     *ZERO         WBBXTM                         Substitution Li
     C                   Z-ADD     *ZERO         WBBYTM                         Max Qty to sche
     C                   Z-ADD     *ZERO         WBH5NX                         Warehouse Palle
     C                   Z-ADD     *ZERO         WBH6NX                         Warehouse Avg P
     C                   Z-ADD     *ZERO         WBH7NX                         OD Item Target
     C                   Z-ADD     *ZERO         WBH8NX                         OD Estimated Gr
     C                   Z-ADD     *ZERO         WBH9NX                         OD Maximum Unit
     C                   Z-ADD     *ZERO         WBDVPR                         Order Gate_Fina
     C                   Z-ADD     *ZERO         WBDWPR                         OD Ceiling Pric
     C                   Z-ADD     *ZERO         WBDXPR                         OD Gate_Final P
     C                   Z-ADD     *ZERO         WBDYPR                         OD Weighted Avg
     C                   Z-ADD     *ZERO         WBDZPR                         OD Original Ord
     C                   Z-ADD     *ZERO         WBGSPR                         OD Cancel Date
     C                   Z-ADD     *ZERO         WBGTPR                         OD Unused Prc 7
     C                   Z-ADD     *ZERO         WBGUPR                         OD Unused Prc 8
     C                   Z-ADD     *ZERO         WBPEWG                         Weight Amount E
     C                   Z-ADD     *ZERO         WBRINY                         Item Age Days
     C                   Z-ADD     *ZERO         WBTIDT                         Production Ovr
     C                   Z-ADD     *ZERO         WBTJDT                         Production Ovr
     C                   Z-ADD     *ZERO         WBTKDT                         OD Market Begin
     C                   Z-ADD     *ZERO         WBTLDT                         OD Market Endin
     C                   Z-ADD     *ZERO         WBTMDT                         OD Atch to Ord
     C                   Z-ADD     *ZERO         WBAATM                         Job Time
     C                   Z-ADD     *ZERO         WBAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WCDBNB                         Warehouse Chill
     C                   Z-ADD     *ZERO         WCBWC3                         Shipping Compan
     C                   Z-ADD     *ZERO         WCBTC3                         Accounting Comp
     C                   Z-ADD     *ZERO         WCBUC3                         WHS Sched Prod
     C                   Z-ADD     *ZERO         WCBVC3                         WHS Inventory C
     C                   Z-ADD     *ZERO         WCAATM                         Job Time
     C                   Z-ADD     *ZERO         WCAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WDF5NZ                         EDI Company # 9
     C                   Z-ADD     *ZERO         WDF6NZ                         Hold til ship w
     C                   Z-ADD     *ZERO         WDMJDT                         Create Date
     C                   Z-ADD     *ZERO         WDBETM                         Create Time
     C                   Z-ADD     *ZERO         WDMKDT                         Change Date
     C                   Z-ADD     *ZERO         WDBFTM                         Change Time
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WEB0C7                         Bill to Custome
     C                   Z-ADD     *ZERO         WEY4NY                         EDI Alt ST Cust
     C                   Z-ADD     *ZERO         WEY5NY                         EDI unused nbr
     C                   Z-ADD     *ZERO         WEMJDT                         Create Date
     C                   Z-ADD     *ZERO         WEBETM                         Create Time
     C                   Z-ADD     *ZERO         WEMKDT                         Change Date
     C                   Z-ADD     *ZERO         WEBFTM                         Change Time
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WFV1DT                         TPC Unused Date
     C                   Z-ADD     *ZERO         WFV2DT                         TPC Unused date
     C                   Z-ADD     *ZERO         WFMJDT                         Create Date
     C                   Z-ADD     *ZERO         WFBETM                         Create Time
     C                   Z-ADD     *ZERO         WFMKDT                         Change Date
     C                   Z-ADD     *ZERO         WFBFTM                         Change Time
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WGAIC3                         Company Number
     C                   Z-ADD     *ZERO         WGC4NB                         Order Number
     C                   Z-ADD     *ZERO         WGDPNB                         Order Sequence
     C                   Z-ADD     *ZERO         WGUENB                         Order Secondary
     C                   Z-ADD     *ZERO         WGRZNB                         Case Sequence N
     C                   Z-ADD     *ZERO         WGFOQT                         Case Quantity
     C                   Z-ADD     *ZERO         WGR0NB                         Case Weight
     C                   Z-ADD     *ZERO         WGK7DT                         Label Date
     C                   Z-ADD     *ZERO         WGPFNX                         PT Serial Numbe
     C                   Z-ADD     *ZERO         WGHGCD                         Item Code
     C                   Z-ADD     *ZERO         WGELDT                         Production Date
     C                   Z-ADD     *ZERO         WGN5WG                         Manifest Gross
     C                   Z-ADD     *ZERO         WGH5NY                         Manifest Total
     C                   Z-ADD     *ZERO         WGH6NY                         Manifest Co_Par
     C                   Z-ADD     *ZERO         WGH7NY                         Manifest Pallet
     C                   Z-ADD     *ZERO         WGN6WG                         HPB Meter Net G
     C                   Z-ADD     *ZERO         WGN7WG                         Manifest Net We
     C                   Z-ADD     *ZERO         WGRBDT                         Manifest Unused
     C                   Z-ADD     *ZERO         WGITNY                         HPB COA Batch N
     C                   Z-ADD     *ZERO         WGIVNY                         HPB Meter Start
     C                   Z-ADD     *ZERO         WGIUNY                         HPB Meter Endin
     C                   Z-ADD     *ZERO         WGIWNY                         HPB Meter Total
     C                   Z-ADD     *ZERO         WGIXNY                         HPB Meter Net W
     C                   Z-ADD     *ZERO         WGIYNY                         HPB Density Ref
     C                   Z-ADD     *ZERO         WGAATM                         Job Time
     C                   Z-ADD     *ZERO         WGAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WHAIC3                         Company Number
     C                   Z-ADD     *ZERO         WHC4NB                         Order Number
     C                   Z-ADD     *ZERO         WHRMNB                         Load ID
     C                   Z-ADD     *ZERO         WHRUNB                         Stop_Drop Seque
     C                   Z-ADD     *ZERO         WHQWDT                         OHE Sail_Flight
     C                   Z-ADD     *ZERO         WHQXDT                         OHE Port Cut Da
     C                   Z-ADD     *ZERO         WHQYDT                         OHE Arrival Dat
     C                   Z-ADD     *ZERO         WHGINY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WHGFNY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WHGGNY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WHGHNY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WHHEVL                         OHE HPB RIN Equ
     C                   Z-ADD     *ZERO         WHHFVL                         OHE HPB RIN Pri
     C                   Z-ADD     *ZERO         WHHGVL                         Transload Termi
     C                   Z-ADD     *ZERO         WHQZDT                         OHE Est Arrv at
     C                   Z-ADD     *ZERO         WHQ0DT                         OHE Backhaul ET
     C                   Z-ADD     *ZERO         WHQ1DT                         OHE Port_Pier P
     C                   Z-ADD     *ZERO         WHQ2DT                         OHE Actual Ship
     C                   Z-ADD     *ZERO         WHITNY                         HPB COA Batch N
     C                   Z-ADD     *ZERO         WHQJNY                         OHE Backhaul Re
     C                   Z-ADD     *ZERO         WHQKNY                         LD Stop_Drop
     C                   Z-ADD     *ZERO         WHQLNY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WHP8NY                         OHE Pier Pass F
     C                   Z-ADD     *ZERO         WHP9NY                         OHE Port Check
     C                   Z-ADD     *ZERO         WHQANY                         OHE Port Cut Ti
     C                   Z-ADD     *ZERO         WHQCNY                         OHE Backhaul Tr
     C                   Z-ADD     *ZERO         WHQDNY                         OHE Load Sched
     C                   Z-ADD     *ZERO         WHQENY                         Original Appoin
     C                   Z-ADD     *ZERO         WHQFNY                         Original Appoin
     C                   Z-ADD     *ZERO         WHQGNY                         OHE PowerPro Lo
     C                   Z-ADD     *ZERO         WHQHNY                         OHE PowerPro Lo
     C                   Z-ADD     *ZERO         WHQINY                         OHE Unused Nume
     C                   Z-ADD     *ZERO         WHQMNY                         OHE Orig ABS Fr
     C                   Z-ADD     *ZERO         WHW5DT                         OHE Unused Date
     C                   Z-ADD     *ZERO         WHW6DT                         OHE Unused Date
     C                   Z-ADD     *ZERO         WHAATM                         Job Time
     C                   Z-ADD     *ZERO         WHAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WJAIC3                         Company Number
     C                   Z-ADD     *ZERO         WJM8NB                         System Value Nu
     C                   Z-ADD     *ZERO         WJAATM                         Job Time
     C                   Z-ADD     *ZERO         WJAXDT                         Job Date
      * Dummy move for compiler
     C                   MOVE      '0'           @CN#(1)
     C                   MOVEL     @CN(1)        @CN(1)
     C                   MOVEL     'N'           W0PMT
      * Define local variables for subroutine SBRVGN.
     C                   Z-ADD     *ZERO         WL0001
     C                   Z-ADD     *ZERO         WL0002
     C                   Z-ADD     *ZERO         WL0003
     C                   Z-ADD     *ZERO         WL0004
     C                   EVAL      WL0005 = ' '
     C                   EVAL      WL0006 = ' '
      * Define local variables for subroutine SCRVGN.
     C                   EVAL      WL0007 = ' '
     C                   EVAL      WL0008 = ' '
     C                   EVAL      WL0009 = ' '
     C                   EVAL      WL0010 = ' '
      * Define local variables for subroutine SERVGN.
     C                   Z-ADD     *ZERO         WL0011
     C                   EVAL      WL0012 = ' '
     C                   EVAL      WL0013 = ' '
     C                   EVAL      WL0014 = ' '
     C                   EVAL      WL0015 = ' '
      * Define local work field Create EDI ASN 856 V2 USR
     C                   EVAL      YL0001 = ' '
      * Define local work field EDI Trading Partner No
     C                   EVAL      YL0002 = ' '
      * Define null work field Country Code
     C                   EVAL      YN0001 = ' '
      * Define null work field Warehouse Code
     C                   EVAL      YN0002 = ' '
      * Define local work field Warehouse Code
     C                   EVAL      YL0003 = ' '
      * Define local work field Warehouse Location
     C                   EVAL      YL0004 = ' '
      * Define local work field WHS Live with Carlisle
     C                   EVAL      YL0005 = ' '
      * Define null work field WHS PFS Interface
     C                   EVAL      YN0003 = ' '
      * Define local work field OK to Process USR
     C                   EVAL      YL0006 = ' '
      * Define local work field EDI Detailed ASN 856 Rqd
     C                   EVAL      YL0007 = ' '
      * Define local work field Record Status
     C                   EVAL      YL0008 = ' '
      * Define local work field Send EDI Document Y/N
     C                   EVAL      YL0009 = ' '
      * Define local work field Check 856 Error Pallet=0
     C                   EVAL      YL0010 = ' '
      * Define local work field Send EDI 856 Pallet Err U
     C                   EVAL      YL0011 = ' '
      * Define local work field OHE EDI Error Reasons 2
     C                   EVAL      YL0012 = ' '
      * Define local work field OHE EDI 856 Action
     C                   EVAL      YL0013 = ' '
      * Define local work field Company Number Alpha
     C                   EVAL      YL0014 = ' '
      * Define local work field Load ID Alpha USR
     C                   EVAL      YL0015 = ' '
      * Define local work field Order Number Alpha
     C                   EVAL      YL0016 = ' '
      * Define local work field Email Subject USR
     C                   EVAL      YL0017 = ' '
      * Define local work field Email Message USR
     C                   EVAL      YL0018 = ' '
      * Define local work field Ship From Warehouse
     C                   EVAL      YL0019 = ' '
      * Define local work field Email Address
     C                   EVAL      YL0020 = ' '
      *================================================================
     CSR   ZZEXIT        ENDSR
** @CN
00001 EDI 856 Error - Co/Load/O
00002 EDI 856 Error - Pallet #
00003 cannot be 0.
00004 Ship from Warehouse:
00005 Resolution: Unship the
00006 Order, scan all boxes to
00007 a pallet, & reship. The
00008 Customer cannot accept
00009 EDI 856 without pallet
00010 numbers.
00011 EDI856ERR
