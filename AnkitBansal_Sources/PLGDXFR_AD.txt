// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PLGDXFR
// ?Date: 14.08.2025 Time: 02:54:12
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?Modifications and Comments
DO;

//?E14473 JJH 02/14/19 - Set PC Format to *DELIMITED
//?E14473 JJH 02/08/19 - Use PT SQL Format
//?E13790 JJH 10/17/18 - BrickFTP for All Plants
//?- Crt EDI CarcSumDtlEnv RT - Accept parms from PWDUXFR
//?- Pass in PT Summary View + PT Detail View into EDISUMDTTF
//?E11705 JJH 09/20/17 - Post Payment Producer Modifications
//?- Allow seperate Email Distribution lists for 440 3P Producers
//?- 440 Sioux City CARCA60020  N   Carcass Email with 3P-60020     A
//?- edi_carcass_440_3p_60020
//?E10169 JJH 09/05/17 - Post Payment Producer Modifications
//?- Create seperate ESEND Distribution Lists for Testing
//?  - edi_carcass_440_so_tst
//?  - edi_carcass_440_to_tst
//?  - edi_carcass_440_3p_tst
//?  - edi_carcass_960_tst
//?  - edi_carcass_961_tst
//?- Print TEST on each Email used for Testing
//?- Correct the SR Source Code that prints on Emails.
//?E10169 JJH 08/25/17 - Post Payment Producer Modifications
//?- If EDI Trading Partner is 99999, add a leading 0 prior to
//?  calling the EDISUMDTTF.  This is necessary so that the EDISUM
//?  and EDIDTL process will read the correct records in the
//?  EDI Carcass Summary and EDI Carcass Detail files.
//?E10169 JJH 08/14/17 - Post Payment Producer Modifications
//?- Allow FTP Method (FTP, SFTP, or Email) for PrkISTesting to be
//?  determined by the Ext ProducerFTPMethod XF - Producer (PWDUXFR)
//?- Set EDI TradingPart Alpha to 999999 if EDI Trading Partner is
//?  99999; otherwise, add leading 0 to EDI Trading Partner
//?R10169 RC  07/17/17 - Post Producer Modifications
//?- If FTP  Method is Email, send Email if the Producer has at least 1
//?  1 record  with EDI Process Sts = A for the specified Kill Date
//?R10169 RC  07/17/17 - Post Producer Modifications
//?- Change logic to get the correct Trading Partner
//?R10169 JJH 07/10/17 - Post Producer Modifications
//?- If Company is 440, or *USER is PorkISTesting, send emails
//?  in the EDISUMDTTF function.
//?- Pass in Company Number and FTP Method USR to EDISUMDTTF
//?- Pass in Email Address, Text Description Summary, and
//?  Text Description Detail
//?H16853 ISE 11/05/2020 - Recompiled due to change in Buy Order Number
ENDDO;

EXECUTE FUNCTION(Crt EDI CarcSumDtlEnv RT) TYPE(RTVOBJ) FILE(PKACREP)           AB1267106;
PARAMETER(PAR.Company_Number_USR);
PARAMETER(PAR.Date_Alpha_USR);
{
 //?USER: Initialize routine

 //?Modifications and Comments
 DO;

 //?E14473 JJH 02/08/19 - Pass in PT SQL Format to EDISUMDTTF
 //?E11705 JJH 09/20/17 - Post Payment Producer Modifications
 //?- Allow seperate Email Distribution lists for 440 3P Producers
 //?- 440 Sioux City CARCA60020  N   Carcass Email with 3P-60020     A
 //?- edi_carcass_440_3p_60020
 //?R10169 JJH 07/10/17 - Post Producer Modifications
 //?- If *USER is PRKISTESTING, or Company = 440, set FTP Method USR
 //?  = E (Email)
 //?- FTP Method USR is input parm to EDISUMDTTF
 ENDDO;

 // LCL.First Time Flag Usr = CND.Yes
 LCL.First_Time_Flag_Usr = 'Y';

 //?E10169 JJH 08/01/17 - Convert TH Kill Date
 // LCL.TH Kill Date = CVTVAR(PAR.Date Alpha USR)
 LCL.TH_Kill_Date = CVTVAR(PAR.Date_Alpha_USR);

 //?USER: Process Data record

 CASE;

 // IF LCL.First Time Flag Usr is Yes
 IF LCL.First_Time_Flag_Usr = 'Y';

 // LCL.PD EDI Trading Partner # = DB1.PD EDI Trading Partner #
 LCL.PD_EDI_Trading_Partner_# = DB1.PD_EDI_Trading_Partner_#;

 // LCL.SR Source Code = DB1.SR Source Code
 LCL.SR_Source_Code = DB1.SR_Source_Code;

 // LCL.First Time Flag Usr = CND.No
 LCL.First_Time_Flag_Usr = 'N';

 // PGM.*Record selected = CND.*NO
 PGM.*Record_selected = 'N';

 ENDIF;

 //?Test Break on Trading Partner
 CASE;

 // IF DB1.PD EDI Trading Partner # NE LCL.PD EDI Trading Partner #
 IF DB1.PD_EDI_Trading_Partner_# <> LCL.PD_EDI_Trading_Partner_#;

 //?IF RECORD SELECTED, DO PROCESSING
 CASE;

 // IF PGM.*Record selected is *YES
 IF PGM.*Record_selected = 'Y';

 //?Insert program to pass in the trading partner
 // LCL.EDI Trading Partner # = LCL.PD EDI Trading Partner #
 LCL.EDI_Trading_Partner_# = LCL.PD_EDI_Trading_Partner_#;

 // LCL.EDI TradingPart Alpha Usr = LCL.EDI Trading Partner #
 LCL.EDI_TradingPart_Alpha_Usr = LCL.EDI_Trading_Partner_#;

 //?R10169 JJH 07/10/17 - Pass in FTP Method
 // LCL.Month Alpha USR = SUBSTRING(PAR.Date Alpha USR,CON.4,CON.2)
 LCL.Month_Alpha_USR = SUBSTRING(PAR.Date_Alpha_USR:4:2);

 // LCL.Day Alpha USR = SUBSTRING(PAR.Date Alpha USR,CON.6,CON.2)
 LCL.Day_Alpha_USR = SUBSTRING(PAR.Date_Alpha_USR:6:2);

 // LCL.Year 2 USR = SUBSTRING(PAR.Date Alpha USR,CON.2,CON.2)
 LCL.Year_2_USR = SUBSTRING(PAR.Date_Alpha_USR:2:2);

 // LCL.EDI TradingPart Alpha Usr = SUBSTRING(LCL.EDI TradingPart Alpha Usr,CON.2,CON.5)
 LCL.EDI_TradingPart_Alpha_Usr = SUBSTRING(LCL.EDI_TradingPart_Alpha_Usr:2:5);

 // LCL.Text description = CONCAT(LCL.Month Alpha USR,CON./,CON.*ZERO)
 LCL.Text_description = LCL.Month_Alpha_USR + '/' (*ZERO);

 // LCL.Text description = CONCAT(LCL.Text description,LCL.Day Alpha USR,CON.*ZERO)
 LCL.Text_description = LCL.Text_description + LCL.Day_Alpha_USR (*ZERO);

 // LCL.Text description = CONCAT(LCL.Text description,CON./,CON.*ZERO)
 LCL.Text_description = LCL.Text_description + '/' (*ZERO);

 // LCL.Text description = CONCAT(LCL.Text description,LCL.Year 2 USR,CON.*ZERO)
 LCL.Text_description = LCL.Text_description + LCL.Year_2_USR (*ZERO);

 // LCL.Text description = CONCAT(LCL.Text description,LCL.EDI TradingPart Alpha Usr,CON.1)
 LCL.Text_description = LCL.Text_description + LCL.EDI_TradingPart_Alpha_Usr (1);

 //?RMC CHGD PARM TO LCL.PD EDI Trading Partner #    FROM DB1.      7/17/17
 //?E14473 JJH 02/08/19 - Output PT SQL Format
 // Call program Ext ProducerFTPMethod XF.
 CALL PROGRAM(Ext ProducerFTPMethod XF) ('PWDUXFR');
 PARAMETER(PAR.Company_Number_USR);
 PARAMETER(LCL.PD_EDI_Trading_Partner_#);
 PARAMETER(JOB.*USER);
 PARAMETER(LCL.FTP_Method_USR);
 PARAMETER(LCL.PT_Summary_View);
 PARAMETER(LCL.PT_Detail_View);
 PARAMETER(LCL.PT_SQL_Format);

 //?Set PCFMT USR
 CASE;

 // IF LCL.PT SQL Format is TXT
 IF LCL.PT_SQL_Format = 'T';

 // LCL.PCFMT USR = CON.*DELIMITED
 LCL.PCFMT_USR = *DELIMITED;

 //?Set PCFMT USR
 // IF LCL.PT SQL Format is XLS
 IF LCL.PT_SQL_Format = 'X';

 // LCL.PCFMT USR = CON.*XLS
 LCL.PCFMT_USR = *XLS;

 ENDIF;

 //?IF EMAIL....
 CASE;

 // IF LCL.FTP Method USR is Email
 IF LCL.FTP_Method_USR = 'E';

 //?E10169 JJH 08/02/17 - Only send email if Producer has records
 EXECUTE FUNCTION(Rtv Chck Partner# Rcd RT) TYPE(RTVOBJ) FILE(PKD3CPP)           AB1224915;
 PARAMETER(LCL.PD_EDI_Trading_Partner_#);
 PARAMETER(LCL.TH_Kill_Date);
 PARAMETER(LCL.Record_Found_2_USR);
 {
  //?USER: Processing if Data record not found

  // PAR.Record Found USR = CND.Record Not Found
  PAR.Record_Found_USR = 'N';

  //?USER: Process Data record

  // PAR.Record Found USR = CND.Record Found
  PAR.Record_Found_USR = 'Y';

  QUIT;

 }

 CASE;

 // IF LCL.Record Found-2 USR is Record Found
 IF LCL.Record_Found_2_USR = 'Y';

 CASE;

 // IF PAR.Company Number USR is Sioux City
 IF PAR.Company_Number_USR = 440;

 CASE;

 // IF LCL.SR Source Code is Triumph Member (Owner)
 IF LCL.SR_Source_Code = 'TO';

 CASE;

 // IF JOB.*USER is PorkISTesting
 IF JOB.*USER = 'PRKTEST'/'ISPPATE'/'ISSMASO'/'ISRCENT'/'ISPURVAP'/'ISROSEM'/'ISSHARONZ'
 /'ISSZURN'/'ISJHIGH'/'ISJBADE'/'ISJAMESB'/'ISDNGUY'/'ISDANNYN'/'PRKTESTGU'/'PRKTESTST'
 /'PRKTESTTF'/'TPMTEST'/'TFTST961'/'ISSUSANM'/'ISJULIUSH'/'ISBGUTI'/'ISBARBG'/'ISBBARK'
 /'ISNFOY'/'ISNATHANF'/'ISDREDD'/'ISABANS';

 // Call program Rtv Company Values    XF.
 CALL PROGRAM(Rtv Company Values    XF) ('PDGKXFR');
 PARAMETER(PAR.Company_Number_USR);
 PARAMETER('CARCASSTOT');
 PARAMETER(LCL.EMail_Address);

 // IF *OTHERWISE
 IF *OTHERWISE;

 // Call program Rtv Company Values    XF.
 CALL PROGRAM(Rtv Company Values    XF) ('PDGKXFR');
 PARAMETER(PAR.Company_Number_USR);
 PARAMETER('CARCASSTO');
 PARAMETER(LCL.EMail_Address);

 ENDIF;

 // IF LCL.SR Source Code is Seaboard Member (Owner)
 IF LCL.SR_Source_Code = 'SO';

 CASE;

 // IF JOB.*USER is PorkISTesting
 IF JOB.*USER = 'PRKTEST'/'ISPPATE'/'ISSMASO'/'ISRCENT'/'ISPURVAP'/'ISROSEM'/'ISSHARONZ'
 /'ISSZURN'/'ISJHIGH'/'ISJBADE'/'ISJAMESB'/'ISDNGUY'/'ISDANNYN'/'PRKTESTGU'/'PRKTESTST'
 /'PRKTESTTF'/'TPMTEST'/'TFTST961'/'ISSUSANM'/'ISJULIUSH'/'ISBGUTI'/'ISBARBG'/'ISBBARK'
 /'ISNFOY'/'ISNATHANF'/'ISDREDD'/'ISABANS';

 // Call program Rtv Company Values    XF.
 CALL PROGRAM(Rtv Company Values    XF) ('PDGKXFR');
 PARAMETER(PAR.Company_Number_USR);
 PARAMETER('CARCASSSOT');
 PARAMETER(LCL.EMail_Address);

 // IF *OTHERWISE
 IF *OTHERWISE;

 // Call program Rtv Company Values    XF.
 CALL PROGRAM(Rtv Company Values    XF) ('PDGKXFR');
 PARAMETER(PAR.Company_Number_USR);
 PARAMETER('CARCASSSO');
 PARAMETER(LCL.EMail_Address);

 ENDIF;

 // IF *OTHERWISE
 IF *OTHERWISE;

 // LCL.SR Source Code = CND.Third Party NonOwner
 LCL.SR_Source_Code = '3P';

 CASE;

 // IF JOB.*USER is PorkISTesting
 IF JOB.*USER = 'PRKTEST'/'ISPPATE'/'ISSMASO'/'ISRCENT'/'ISPURVAP'/'ISROSEM'/'ISSHARONZ'
 /'ISSZURN'/'ISJHIGH'/'ISJBADE'/'ISJAMESB'/'ISDNGUY'/'ISDANNYN'/'PRKTESTGU'/'PRKTESTST'
 /'PRKTESTTF'/'TPMTEST'/'TFTST961'/'ISSUSANM'/'ISJULIUSH'/'ISBGUTI'/'ISBARBG'/'ISBBARK'
 /'ISNFOY'/'ISNATHANF'/'ISDREDD'/'ISABANS';

 // Call program Rtv Company Values    XF.
 CALL PROGRAM(Rtv Company Values    XF) ('PDGKXFR');
 PARAMETER(PAR.Company_Number_USR);
 PARAMETER('CARCASS3PT');
 PARAMETER(LCL.EMail_Address);

 // IF *OTHERWISE
 IF *OTHERWISE;

 //?E11705 JJH 09/20/17 - Use Company Value CARCAxxxxx xxxxx=EDITP#
 // LCL.EDI TradingPart Alpha-5 = SUBSTRING(LCL.EDI TradingPart Alpha Usr,CON.1,CON.5)
 LCL.EDI_TradingPart_Alpha_5 = SUBSTRING(LCL.EDI_TradingPart_Alpha_Usr:1:5);

 // LCL.Company Value Code    USR = CONCAT(CON.CARCA,LCL.EDI TradingPart Alpha-5,CND.*None)
 LCL.Company_Value_Code_USR = 'CARCA' + LCL.EDI_TradingPart_Alpha_5 (*ZERO);

 // Call program Rtv Company Values    XF.
 CALL PROGRAM(Rtv Company Values    XF) ('PDGKXFR');
 PARAMETER(PAR.Company_Number_USR);
 PARAMETER(LCL.Company_Value_Code_USR);
 PARAMETER(LCL.EMail_Address);

 ENDIF;

 ENDIF;

 CASE;

 // IF JOB.*USER is PorkISTesting
 IF JOB.*USER = 'PRKTEST'/'ISPPATE'/'ISSMASO'/'ISRCENT'/'ISPURVAP'/'ISROSEM'/'ISSHARONZ'
 /'ISSZURN'/'ISJHIGH'/'ISJBADE'/'ISJAMESB'/'ISDNGUY'/'ISDANNYN'/'PRKTESTGU'/'PRKTESTST'
 /'PRKTESTTF'/'TPMTEST'/'TFTST961'/'ISSUSANM'/'ISJULIUSH'/'ISBGUTI'/'ISBARBG'/'ISBBARK'
 /'ISNFOY'/'ISNATHANF'/'ISDREDD'/'ISABANS';

 // LCL.Text Description Summary = CONCAT(CON.TEST Carcass Summary:,LCL.Text description,CON.1)
 LCL.Text_Description_Summary = 'TEST Carcass Summary:' + LCL.Text_description (1);

 // LCL.Text Description Summary = CONCAT(LCL.Text Description Summary,CON.-,CON.1)
 LCL.Text_Description_Summary = LCL.Text_Description_Summary + '-' (1);

 // LCL.Text Description Summary = CONCAT(LCL.Text Description Summary,LCL.SR Source Code,CON.1)
 LCL.Text_Description_Summary = LCL.Text_Description_Summary + LCL.SR_Source_Code (1);

 // LCL.Text Description Detail = CONCAT(CON.TEST Carcass Detail:,LCL.Text description,CON.1)
 LCL.Text_Description_Detail = 'TEST Carcass Detail:' + LCL.Text_description (1);

 // LCL.Text Description Detail = CONCAT(LCL.Text Description Detail,CON.-,CON.1)
 LCL.Text_Description_Detail = LCL.Text_Description_Detail + '-' (1);

 // LCL.Text Description Detail = CONCAT(LCL.Text Description Detail,LCL.SR Source Code,CON.1)
 LCL.Text_Description_Detail = LCL.Text_Description_Detail + LCL.SR_Source_Code (1);

 // IF *OTHERWISE
 IF *OTHERWISE;

 // LCL.Text Description Summary = CONCAT(CON.Carcass Summary:,LCL.Text description,CON.1)
 LCL.Text_Description_Summary = 'Carcass Summary:' + LCL.Text_description (1);

 // LCL.Text Description Summary = CONCAT(LCL.Text Description Summary,CON.-,CON.1)
 LCL.Text_Description_Summary = LCL.Text_Description_Summary + '-' (1);

 // LCL.Text Description Summary = CONCAT(LCL.Text Description Summary,LCL.SR Source Code,CON.1)
 LCL.Text_Description_Summary = LCL.Text_Description_Summary + LCL.SR_Source_Code (1);

 // LCL.Text Description Detail = CONCAT(CON.Carcass Detail:,LCL.Text description,CON.1)
 LCL.Text_Description_Detail = 'Carcass Detail:' + LCL.Text_description (1);

 // LCL.Text Description Detail = CONCAT(LCL.Text Description Detail,CON.-,CON.1)
 LCL.Text_Description_Detail = LCL.Text_Description_Detail + '-' (1);

 // LCL.Text Description Detail = CONCAT(LCL.Text Description Detail,LCL.SR Source Code,CON.1)
 LCL.Text_Description_Detail = LCL.Text_Description_Detail + LCL.SR_Source_Code (1);

 ENDIF;

 // IF PAR.Company Number USR is Triumph Foods Market
 IF PAR.Company_Number_USR = 960;

 CASE;

 // IF JOB.*USER is PorkISTesting
 IF JOB.*USER = 'PRKTEST'/'ISPPATE'/'ISSMASO'/'ISRCENT'/'ISPURVAP'/'ISROSEM'/'ISSHARONZ'
 /'ISSZURN'/'ISJHIGH'/'ISJBADE'/'ISJAMESB'/'ISDNGUY'/'ISDANNYN'/'PRKTESTGU'/'PRKTESTST'
 /'PRKTESTTF'/'TPMTEST'/'TFTST961'/'ISSUSANM'/'ISJULIUSH'/'ISBGUTI'/'ISBARBG'/'ISBBARK'
 /'ISNFOY'/'ISNATHANF'/'ISDREDD'/'ISABANS';

 // Call program Rtv Company Values    XF.
 CALL PROGRAM(Rtv Company Values    XF) ('PDGKXFR');
 PARAMETER(PAR.Company_Number_USR);
 PARAMETER('CARCASST');
 PARAMETER(LCL.EMail_Address);

 // LCL.Text Description Summary = CONCAT(CON.TEST Carcass Summary:,LCL.Text description,CON.1)
 LCL.Text_Description_Summary = 'TEST Carcass Summary:' + LCL.Text_description (1);

 // LCL.Text Description Detail = CONCAT(CON.TEST Carcass Detail:,LCL.Text description,CON.1)
 LCL.Text_Description_Detail = 'TEST Carcass Detail:' + LCL.Text_description (1);

 // IF *OTHERWISE
 IF *OTHERWISE;

 // Call program Rtv Company Values    XF.
 CALL PROGRAM(Rtv Company Values    XF) ('PDGKXFR');
 PARAMETER(PAR.Company_Number_USR);
 PARAMETER('CARCASS');
 PARAMETER(LCL.EMail_Address);

 // LCL.Text Description Summary = CONCAT(CON.Carcass Summary:,LCL.Text description,CON.1)
 LCL.Text_Description_Summary = 'Carcass Summary:' + LCL.Text_description (1);

 // LCL.Text Description Detail = CONCAT(CON.Carcass Detail:,LCL.Text description,CON.1)
 LCL.Text_Description_Detail = 'Carcass Detail:' + LCL.Text_description (1);

 ENDIF;

 // IF PAR.Company Number USR is Triumph Foods-2
 IF PAR.Company_Number_USR = 961;

 CASE;

 // IF JOB.*USER is PorkISTesting
 IF JOB.*USER = 'PRKTEST'/'ISPPATE'/'ISSMASO'/'ISRCENT'/'ISPURVAP'/'ISROSEM'/'ISSHARONZ'
 /'ISSZURN'/'ISJHIGH'/'ISJBADE'/'ISJAMESB'/'ISDNGUY'/'ISDANNYN'/'PRKTESTGU'/'PRKTESTST'
 /'PRKTESTTF'/'TPMTEST'/'TFTST961'/'ISSUSANM'/'ISJULIUSH'/'ISBGUTI'/'ISBARBG'/'ISBBARK'
 /'ISNFOY'/'ISNATHANF'/'ISDREDD'/'ISABANS';

 // Call program Rtv Company Values    XF.
 CALL PROGRAM(Rtv Company Values    XF) ('PDGKXFR');
 PARAMETER(PAR.Company_Number_USR);
 PARAMETER('CARCASST');
 PARAMETER(LCL.EMail_Address);

 // LCL.Text Description Summary = CONCAT(CON.TEST Carcass Summary:,LCL.Text description,CON.1)
 LCL.Text_Description_Summary = 'TEST Carcass Summary:' + LCL.Text_description (1);

 // LCL.Text Description Detail = CONCAT(CON.TEST Carcass Detail:,LCL.Text description,CON.1)
 LCL.Text_Description_Detail = 'TEST Carcass Detail:' + LCL.Text_description (1);

 // IF *OTHERWISE
 IF *OTHERWISE;

 // Call program Rtv Company Values    XF.
 CALL PROGRAM(Rtv Company Values    XF) ('PDGKXFR');
 PARAMETER(PAR.Company_Number_USR);
 PARAMETER('CARCASS');
 PARAMETER(LCL.EMail_Address);

 // LCL.Text Description Summary = CONCAT(CON.Carcass Summary:,LCL.Text description,CON.1)
 LCL.Text_Description_Summary = 'Carcass Summary:' + LCL.Text_description (1);

 // LCL.Text Description Detail = CONCAT(CON.Carcass Detail:,LCL.Text description,CON.1)
 LCL.Text_Description_Detail = 'Carcass Detail:' + LCL.Text_description (1);

 ENDIF;

 ENDIF;

 ENDIF;

 //?IF EMAIL....
 // IF *OTHERWISE
 IF *OTHERWISE;

 // LCL.EMail Address = CON.*BLANK
 LCL.EMail_Address = *BLANK;

 // LCL.Text Description Summary = CON.*BLANK
 LCL.Text_Description_Summary = *BLANK;

 // LCL.Text Description Detail = CON.*BLANK
 LCL.Text_Description_Detail = *BLANK;

 ENDIF;

 // LCL.Company Number Alpha Usr = CVTVAR(PAR.Company Number USR)
 LCL.Company_Number_Alpha_Usr = CVTVAR(PAR.Company_Number_USR);

 //?E10169 JJH 08/25/17 - Add Leading 0 in front of EDI Trading Partner
 // LCL.EDI TradingPart Alpha-5 = SUBSTRING(LCL.EDI TradingPart Alpha Usr,CON.1,CON.5)
 LCL.EDI_TradingPart_Alpha_5 = SUBSTRING(LCL.EDI_TradingPart_Alpha_Usr:1:5);

 // LCL.EDI TradingPart Alpha Usr = CONCAT(CON.0,LCL.EDI TradingPart Alpha-5,CON.*ZERO)
 LCL.EDI_TradingPart_Alpha_Usr = '0' + LCL.EDI_TradingPart_Alpha_5 (*ZERO);

 //?E10169 JJH 08/02/17 - Only send email if Producer has records
 CASE;

 // IF LCL.FTP Method USR is Email
 IF LCL.FTP_Method_USR = 'E';

 CASE;

 // IF LCL.Record Found-2 USR is Record Found
 IF LCL.Record_Found_2_USR = 'Y';

 // Call program EDI Carcass Sum/DtlTF UP.
 CALL PROGRAM(EDI Carcass Sum/DtlTF UP) ('EDISUMDTTF');
 PARAMETER(LCL.Company_Number_Alpha_Usr);
 PARAMETER(PAR.Date_Alpha_USR);
 PARAMETER(LCL.EDI_TradingPart_Alpha_Usr);
 PARAMETER(LCL.FTP_Method_USR);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(LCL.PCFMT_USR);
 PARAMETER(LCL.EMail_Address);
 PARAMETER(LCL.Text_Description_Summary);
 PARAMETER(LCL.Text_Description_Detail);

 ENDIF;

 // IF *OTHERWISE
 IF *OTHERWISE;

 // Call program EDI Carcass Sum/DtlTF UP.
 CALL PROGRAM(EDI Carcass Sum/DtlTF UP) ('EDISUMDTTF');
 PARAMETER(LCL.Company_Number_Alpha_Usr);
 PARAMETER(PAR.Date_Alpha_USR);
 PARAMETER(LCL.EDI_TradingPart_Alpha_Usr);
 PARAMETER(LCL.FTP_Method_USR);
 PARAMETER(LCL.PT_Summary_View);
 PARAMETER(LCL.PT_Detail_View);
 PARAMETER(LCL.PCFMT_USR);
 PARAMETER(LCL.EMail_Address);
 PARAMETER(LCL.Text_Description_Summary);
 PARAMETER(LCL.Text_Description_Detail);

 ENDIF;

 ENDIF;

 //?R10169 JJH 07/10/17 - Add parms for Company Number and FTP Method
 // PGM.*Record selected = CND.*NO
 PGM.*Record_selected = 'N';

 // LCL.PD EDI Trading Partner # = DB1.PD EDI Trading Partner #
 LCL.PD_EDI_Trading_Partner_# = DB1.PD_EDI_Trading_Partner_#;

 // LCL.SR Source Code = DB1.SR Source Code
 LCL.SR_Source_Code = DB1.SR_Source_Code;

 ENDIF;

 //?Are there any producer events for this trading partner
 // LCL.Kill Date Usr = CVTVAR(PAR.Date Alpha USR)
 LCL.Kill_Date_Usr = CVTVAR(PAR.Date_Alpha_USR);

 EXECUTE FUNCTION(Val Event Existance   RT) TYPE(RTVOBJ) FILE(PKD9CPP)           AB1205071;
 PARAMETER(PAR.Company_Number_USR);
 PARAMETER(DB1.PD_Producer_Code);
 PARAMETER('EDI');
 PARAMETER(LCL.Kill_Date_Usr);
 PARAMETER(LCL.Record_Found_USR);
 {
  //?USER: Processing if Data record not found

  // PAR.Record Found USR = CND.Record Not Found
  PAR.Record_Found_USR = 'N';

  //?USER: Process Data record

  // PAR.Record Found USR = CND.Record Found
  PAR.Record_Found_USR = 'Y';

 }

 CASE;

 // IF LCL.Record Found USR is Record Found
 IF LCL.Record_Found_USR = 'Y';

 // PGM.*Record selected = CND.*YES
 PGM.*Record_selected = 'Y';

 ENDIF;

 //?USER: Exit processing

 CASE;

 // IF PGM.*Record selected is *YES
 IF PGM.*Record_selected = 'Y';

 //?Insert program to pass in the trading partner
 // LCL.EDI Trading Partner # = LCL.PD EDI Trading Partner #
 LCL.EDI_Trading_Partner_# = LCL.PD_EDI_Trading_Partner_#;

 // LCL.EDI TradingPart Alpha Usr = LCL.EDI Trading Partner #
 LCL.EDI_TradingPart_Alpha_Usr = LCL.EDI_Trading_Partner_#;

 //?R10169 JJH 07/10/17 - Add parms for Company Number and FTP Method
 // LCL.Month Alpha USR = SUBSTRING(PAR.Date Alpha USR,CON.4,CON.2)
 LCL.Month_Alpha_USR = SUBSTRING(PAR.Date_Alpha_USR:4:2);

 // LCL.Day Alpha USR = SUBSTRING(PAR.Date Alpha USR,CON.6,CON.2)
 LCL.Day_Alpha_USR = SUBSTRING(PAR.Date_Alpha_USR:6:2);

 // LCL.Year 2 USR = SUBSTRING(PAR.Date Alpha USR,CON.2,CON.2)
 LCL.Year_2_USR = SUBSTRING(PAR.Date_Alpha_USR:2:2);

 // LCL.EDI TradingPart Alpha Usr = SUBSTRING(LCL.EDI TradingPart Alpha Usr,CON.2,CON.5)
 LCL.EDI_TradingPart_Alpha_Usr = SUBSTRING(LCL.EDI_TradingPart_Alpha_Usr:2:5);

 // LCL.Text description = CONCAT(LCL.Month Alpha USR,CON./,CON.*ZERO)
 LCL.Text_description = LCL.Month_Alpha_USR + '/' (*ZERO);

 // LCL.Text description = CONCAT(LCL.Text description,LCL.Day Alpha USR,CON.*ZERO)
 LCL.Text_description = LCL.Text_description + LCL.Day_Alpha_USR (*ZERO);

 // LCL.Text description = CONCAT(LCL.Text description,CON./,CON.*ZERO)
 LCL.Text_description = LCL.Text_description + '/' (*ZERO);

 // LCL.Text description = CONCAT(LCL.Text description,LCL.Year 2 USR,CON.*ZERO)
 LCL.Text_description = LCL.Text_description + LCL.Year_2_USR (*ZERO);

 // LCL.Text description = CONCAT(LCL.Text description,LCL.EDI TradingPart Alpha Usr,CON.1)
 LCL.Text_description = LCL.Text_description + LCL.EDI_TradingPart_Alpha_Usr (1);

 //?E13790 JJH 10/17/18 - Output Parameters
 //?E14473 JJH 02/08/19 - Output PT SQL Format
 // Call program Ext ProducerFTPMethod XF.
 CALL PROGRAM(Ext ProducerFTPMethod XF) ('PWDUXFR');
 PARAMETER(PAR.Company_Number_USR);
 PARAMETER(LCL.PD_EDI_Trading_Partner_#);
 PARAMETER(JOB.*USER);
 PARAMETER(LCL.FTP_Method_USR);
 PARAMETER(LCL.PT_Summary_View);
 PARAMETER(LCL.PT_Detail_View);
 PARAMETER(LCL.PT_SQL_Format);

 //?Set PCFMT USR
 CASE;

 // IF LCL.PT SQL Format is TXT
 IF LCL.PT_SQL_Format = 'T';

 // LCL.PCFMT USR = CON.*DELIMITED
 LCL.PCFMT_USR = *DELIMITED;

 //?Set PCFMT USR
 // IF LCL.PT SQL Format is XLS
 IF LCL.PT_SQL_Format = 'X';

 // LCL.PCFMT USR = CON.*XLS
 LCL.PCFMT_USR = *XLS;

 ENDIF;

 CASE;

 // IF LCL.FTP Method USR is Email
 IF LCL.FTP_Method_USR = 'E';

 EXECUTE FUNCTION(Rtv Chck Partner# Rcd RT) TYPE(RTVOBJ) FILE(PKD3CPP)           AB1224915;
 PARAMETER(LCL.PD_EDI_Trading_Partner_#);
 PARAMETER(LCL.TH_Kill_Date);
 PARAMETER(LCL.Record_Found_2_USR);
 {
  //?USER: Processing if Data record not found

  // PAR.Record Found USR = CND.Record Not Found
  PAR.Record_Found_USR = 'N';

  //?USER: Process Data record

  // PAR.Record Found USR = CND.Record Found
  PAR.Record_Found_USR = 'Y';

  QUIT;

 }

 //?E10169 JJH 08/02/17 - Only send email if Producer has records
 CASE;

 // IF LCL.Record Found-2 USR is Record Found
 IF LCL.Record_Found_2_USR = 'Y';

 CASE;

 // IF PAR.Company Number USR is Sioux City
 IF PAR.Company_Number_USR = 440;

 CASE;

 // IF LCL.SR Source Code is Triumph Member (Owner)
 IF LCL.SR_Source_Code = 'TO';

 CASE;

 // IF JOB.*USER is PorkISTesting
 IF JOB.*USER = 'PRKTEST'/'ISPPATE'/'ISSMASO'/'ISRCENT'/'ISPURVAP'/'ISROSEM'/'ISSHARONZ'
 /'ISSZURN'/'ISJHIGH'/'ISJBADE'/'ISJAMESB'/'ISDNGUY'/'ISDANNYN'/'PRKTESTGU'/'PRKTESTST'
 /'PRKTESTTF'/'TPMTEST'/'TFTST961'/'ISSUSANM'/'ISJULIUSH'/'ISBGUTI'/'ISBARBG'/'ISBBARK'
 /'ISNFOY'/'ISNATHANF'/'ISDREDD'/'ISABANS';

 // Call program Rtv Company Values    XF.
 CALL PROGRAM(Rtv Company Values    XF) ('PDGKXFR');
 PARAMETER(PAR.Company_Number_USR);
 PARAMETER('CARCASSTOT');
 PARAMETER(LCL.EMail_Address);

 // IF *OTHERWISE
 IF *OTHERWISE;

 // Call program Rtv Company Values    XF.
 CALL PROGRAM(Rtv Company Values    XF) ('PDGKXFR');
 PARAMETER(PAR.Company_Number_USR);
 PARAMETER('CARCASSTO');
 PARAMETER(LCL.EMail_Address);

 ENDIF;

 // IF LCL.SR Source Code is Seaboard Member (Owner)
 IF LCL.SR_Source_Code = 'SO';

 CASE;

 // IF JOB.*USER is PorkISTesting
 IF JOB.*USER = 'PRKTEST'/'ISPPATE'/'ISSMASO'/'ISRCENT'/'ISPURVAP'/'ISROSEM'/'ISSHARONZ'
 /'ISSZURN'/'ISJHIGH'/'ISJBADE'/'ISJAMESB'/'ISDNGUY'/'ISDANNYN'/'PRKTESTGU'/'PRKTESTST'
 /'PRKTESTTF'/'TPMTEST'/'TFTST961'/'ISSUSANM'/'ISJULIUSH'/'ISBGUTI'/'ISBARBG'/'ISBBARK'
 /'ISNFOY'/'ISNATHANF'/'ISDREDD'/'ISABANS';

 // Call program Rtv Company Values    XF.
 CALL PROGRAM(Rtv Company Values    XF) ('PDGKXFR');
 PARAMETER(PAR.Company_Number_USR);
 PARAMETER('CARCASSSOT');
 PARAMETER(LCL.EMail_Address);

 // IF *OTHERWISE
 IF *OTHERWISE;

 // Call program Rtv Company Values    XF.
 CALL PROGRAM(Rtv Company Values    XF) ('PDGKXFR');
 PARAMETER(PAR.Company_Number_USR);
 PARAMETER('CARCASSSO');
 PARAMETER(LCL.EMail_Address);

 ENDIF;

 // IF *OTHERWISE
 IF *OTHERWISE;

 // LCL.SR Source Code = CND.Third Party NonOwner
 LCL.SR_Source_Code = '3P';

 CASE;

 // IF JOB.*USER is PorkISTesting
 IF JOB.*USER = 'PRKTEST'/'ISPPATE'/'ISSMASO'/'ISRCENT'/'ISPURVAP'/'ISROSEM'/'ISSHARONZ'
 /'ISSZURN'/'ISJHIGH'/'ISJBADE'/'ISJAMESB'/'ISDNGUY'/'ISDANNYN'/'PRKTESTGU'/'PRKTESTST'
 /'PRKTESTTF'/'TPMTEST'/'TFTST961'/'ISSUSANM'/'ISJULIUSH'/'ISBGUTI'/'ISBARBG'/'ISBBARK'
 /'ISNFOY'/'ISNATHANF'/'ISDREDD'/'ISABANS';

 // Call program Rtv Company Values    XF.
 CALL PROGRAM(Rtv Company Values    XF) ('PDGKXFR');
 PARAMETER(PAR.Company_Number_USR);
 PARAMETER('CARCASS3PT');
 PARAMETER(LCL.EMail_Address);

 // IF *OTHERWISE
 IF *OTHERWISE;

 //?E11705 JJH 09/20/17 - Use Company Value CARCAxxxxx xxxxx=EDITP#
 // LCL.EDI TradingPart Alpha-5 = SUBSTRING(LCL.EDI TradingPart Alpha Usr,CON.1,CON.5)
 LCL.EDI_TradingPart_Alpha_5 = SUBSTRING(LCL.EDI_TradingPart_Alpha_Usr:1:5);

 // LCL.Company Value Code    USR = CONCAT(CON.CARCA,LCL.EDI TradingPart Alpha-5,CND.*None)
 LCL.Company_Value_Code_USR = 'CARCA' + LCL.EDI_TradingPart_Alpha_5 (*ZERO);

 // Call program Rtv Company Values    XF.
 CALL PROGRAM(Rtv Company Values    XF) ('PDGKXFR');
 PARAMETER(PAR.Company_Number_USR);
 PARAMETER(LCL.Company_Value_Code_USR);
 PARAMETER(LCL.EMail_Address);

 ENDIF;

 ENDIF;

 CASE;

 // IF JOB.*USER is PorkISTesting
 IF JOB.*USER = 'PRKTEST'/'ISPPATE'/'ISSMASO'/'ISRCENT'/'ISPURVAP'/'ISROSEM'/'ISSHARONZ'
 /'ISSZURN'/'ISJHIGH'/'ISJBADE'/'ISJAMESB'/'ISDNGUY'/'ISDANNYN'/'PRKTESTGU'/'PRKTESTST'
 /'PRKTESTTF'/'TPMTEST'/'TFTST961'/'ISSUSANM'/'ISJULIUSH'/'ISBGUTI'/'ISBARBG'/'ISBBARK'
 /'ISNFOY'/'ISNATHANF'/'ISDREDD'/'ISABANS';

 // LCL.Text Description Summary = CONCAT(CON.TEST Carcass Summary:,LCL.Text description,CON.1)
 LCL.Text_Description_Summary = 'TEST Carcass Summary:' + LCL.Text_description (1);

 // LCL.Text Description Summary = CONCAT(LCL.Text Description Summary,CON.-,CON.1)
 LCL.Text_Description_Summary = LCL.Text_Description_Summary + '-' (1);

 // LCL.Text Description Summary = CONCAT(LCL.Text Description Summary,LCL.SR Source Code,CON.1)
 LCL.Text_Description_Summary = LCL.Text_Description_Summary + LCL.SR_Source_Code (1);

 // LCL.Text Description Detail = CONCAT(CON.TEST Carcass Detail:,LCL.Text description,CON.1)
 LCL.Text_Description_Detail = 'TEST Carcass Detail:' + LCL.Text_description (1);

 // LCL.Text Description Detail = CONCAT(LCL.Text Description Detail,CON.-,CON.1)
 LCL.Text_Description_Detail = LCL.Text_Description_Detail + '-' (1);

 // LCL.Text Description Detail = CONCAT(LCL.Text Description Detail,LCL.SR Source Code,CON.1)
 LCL.Text_Description_Detail = LCL.Text_Description_Detail + LCL.SR_Source_Code (1);

 // IF *OTHERWISE
 IF *OTHERWISE;

 // LCL.Text Description Summary = CONCAT(CON.Carcass Summary:,LCL.Text description,CON.1)
 LCL.Text_Description_Summary = 'Carcass Summary:' + LCL.Text_description (1);

 // LCL.Text Description Summary = CONCAT(LCL.Text Description Summary,CON.-,CON.1)
 LCL.Text_Description_Summary = LCL.Text_Description_Summary + '-' (1);

 // LCL.Text Description Summary = CONCAT(LCL.Text Description Summary,LCL.SR Source Code,CON.1)
 LCL.Text_Description_Summary = LCL.Text_Description_Summary + LCL.SR_Source_Code (1);

 // LCL.Text Description Detail = CONCAT(CON.Carcass Detail:,LCL.Text description,CON.1)
 LCL.Text_Description_Detail = 'Carcass Detail:' + LCL.Text_description (1);

 // LCL.Text Description Detail = CONCAT(LCL.Text Description Detail,CON.-,CON.1)
 LCL.Text_Description_Detail = LCL.Text_Description_Detail + '-' (1);

 // LCL.Text Description Detail = CONCAT(LCL.Text Description Detail,LCL.SR Source Code,CON.1)
 LCL.Text_Description_Detail = LCL.Text_Description_Detail + LCL.SR_Source_Code (1);

 ENDIF;

 // IF PAR.Company Number USR is Triumph Foods Market
 IF PAR.Company_Number_USR = 960;

 CASE;

 // IF JOB.*USER is PorkISTesting
 IF JOB.*USER = 'PRKTEST'/'ISPPATE'/'ISSMASO'/'ISRCENT'/'ISPURVAP'/'ISROSEM'/'ISSHARONZ'
 /'ISSZURN'/'ISJHIGH'/'ISJBADE'/'ISJAMESB'/'ISDNGUY'/'ISDANNYN'/'PRKTESTGU'/'PRKTESTST'
 /'PRKTESTTF'/'TPMTEST'/'TFTST961'/'ISSUSANM'/'ISJULIUSH'/'ISBGUTI'/'ISBARBG'/'ISBBARK'
 /'ISNFOY'/'ISNATHANF'/'ISDREDD'/'ISABANS';

 // Call program Rtv Company Values    XF.
 CALL PROGRAM(Rtv Company Values    XF) ('PDGKXFR');
 PARAMETER(PAR.Company_Number_USR);
 PARAMETER('CARCASS');
 PARAMETER(LCL.EMail_Address);

 // LCL.Text Description Summary = CONCAT(CON.TEST Carcass Summary:,LCL.Text description,CON.1)
 LCL.Text_Description_Summary = 'TEST Carcass Summary:' + LCL.Text_description (1);

 // LCL.Text Description Detail = CONCAT(CON.TEST Carcass Detail:,LCL.Text description,CON.1)
 LCL.Text_Description_Detail = 'TEST Carcass Detail:' + LCL.Text_description (1);

 // IF *OTHERWISE
 IF *OTHERWISE;

 // Call program Rtv Company Values    XF.
 CALL PROGRAM(Rtv Company Values    XF) ('PDGKXFR');
 PARAMETER(PAR.Company_Number_USR);
 PARAMETER('CARCASS');
 PARAMETER(LCL.EMail_Address);

 // LCL.Text Description Summary = CONCAT(CON.Carcass Summary:,LCL.Text description,CON.1)
 LCL.Text_Description_Summary = 'Carcass Summary:' + LCL.Text_description (1);

 // LCL.Text Description Detail = CONCAT(CON.Carcass Detail:,LCL.Text description,CON.1)
 LCL.Text_Description_Detail = 'Carcass Detail:' + LCL.Text_description (1);

 ENDIF;

 // IF PAR.Company Number USR is Triumph Foods-2
 IF PAR.Company_Number_USR = 961;

 CASE;

 // IF JOB.*USER is PorkISTesting
 IF JOB.*USER = 'PRKTEST'/'ISPPATE'/'ISSMASO'/'ISRCENT'/'ISPURVAP'/'ISROSEM'/'ISSHARONZ'
 /'ISSZURN'/'ISJHIGH'/'ISJBADE'/'ISJAMESB'/'ISDNGUY'/'ISDANNYN'/'PRKTESTGU'/'PRKTESTST'
 /'PRKTESTTF'/'TPMTEST'/'TFTST961'/'ISSUSANM'/'ISJULIUSH'/'ISBGUTI'/'ISBARBG'/'ISBBARK'
 /'ISNFOY'/'ISNATHANF'/'ISDREDD'/'ISABANS';

 // Call program Rtv Company Values    XF.
 CALL PROGRAM(Rtv Company Values    XF) ('PDGKXFR');
 PARAMETER(PAR.Company_Number_USR);
 PARAMETER('CARCASS');
 PARAMETER(LCL.EMail_Address);

 // LCL.Text Description Summary = CONCAT(CON.TEST Carcass Summary:,LCL.Text description,CON.1)
 LCL.Text_Description_Summary = 'TEST Carcass Summary:' + LCL.Text_description (1);

 // LCL.Text Description Detail = CONCAT(CON.TEST Carcass Detail:,LCL.Text description,CON.1)
 LCL.Text_Description_Detail = 'TEST Carcass Detail:' + LCL.Text_description (1);

 // IF *OTHERWISE
 IF *OTHERWISE;

 // Call program Rtv Company Values    XF.
 CALL PROGRAM(Rtv Company Values    XF) ('PDGKXFR');
 PARAMETER(PAR.Company_Number_USR);
 PARAMETER('CARCASS');
 PARAMETER(LCL.EMail_Address);

 // LCL.Text Description Summary = CONCAT(CON.Carcass Summary:,LCL.Text description,CON.1)
 LCL.Text_Description_Summary = 'Carcass Summary:' + LCL.Text_description (1);

 // LCL.Text Description Detail = CONCAT(CON.Carcass Detail:,LCL.Text description,CON.1)
 LCL.Text_Description_Detail = 'Carcass Detail:' + LCL.Text_description (1);

 ENDIF;

 ENDIF;

 ENDIF;

 // IF *OTHERWISE
 IF *OTHERWISE;

 // LCL.EMail Address = CON.*BLANK
 LCL.EMail_Address = *BLANK;

 // LCL.Text Description Summary = CON.*BLANK
 LCL.Text_Description_Summary = *BLANK;

 // LCL.Text Description Detail = CON.*BLANK
 LCL.Text_Description_Detail = *BLANK;

 ENDIF;

 // LCL.Company Number Alpha Usr = CVTVAR(PAR.Company Number USR)
 LCL.Company_Number_Alpha_Usr = CVTVAR(PAR.Company_Number_USR);

 //?E10169 JJH 08/25/17 - Add Leading 0 in front of EDI Trading Partner
 // LCL.EDI TradingPart Alpha-5 = SUBSTRING(LCL.EDI TradingPart Alpha Usr,CON.1,CON.5)
 LCL.EDI_TradingPart_Alpha_5 = SUBSTRING(LCL.EDI_TradingPart_Alpha_Usr:1:5);

 // LCL.EDI TradingPart Alpha Usr = CONCAT(CON.0,LCL.EDI TradingPart Alpha-5,CON.*ZERO)
 LCL.EDI_TradingPart_Alpha_Usr = '0' + LCL.EDI_TradingPart_Alpha_5 (*ZERO);

 CASE;

 // IF LCL.FTP Method USR is Email
 IF LCL.FTP_Method_USR = 'E';

 CASE;

 // IF LCL.Record Found-2 USR is Record Found
 IF LCL.Record_Found_2_USR = 'Y';

 // Call program EDI Carcass Sum/DtlTF UP.
 CALL PROGRAM(EDI Carcass Sum/DtlTF UP) ('EDISUMDTTF');
 PARAMETER(LCL.Company_Number_Alpha_Usr);
 PARAMETER(PAR.Date_Alpha_USR);
 PARAMETER(LCL.EDI_TradingPart_Alpha_Usr);
 PARAMETER(LCL.FTP_Method_USR);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(LCL.PCFMT_USR);
 PARAMETER(LCL.EMail_Address);
 PARAMETER(LCL.Text_Description_Summary);
 PARAMETER(LCL.Text_Description_Detail);

 ENDIF;

 // IF *OTHERWISE
 IF *OTHERWISE;

 // Call program EDI Carcass Sum/DtlTF UP.
 CALL PROGRAM(EDI Carcass Sum/DtlTF UP) ('EDISUMDTTF');
 PARAMETER(LCL.Company_Number_Alpha_Usr);
 PARAMETER(PAR.Date_Alpha_USR);
 PARAMETER(LCL.EDI_TradingPart_Alpha_Usr);
 PARAMETER(LCL.FTP_Method_USR);
 PARAMETER(LCL.PT_Summary_View);
 PARAMETER(LCL.PT_Detail_View);
 PARAMETER(LCL.PCFMT_USR);
 PARAMETER(LCL.EMail_Address);
 PARAMETER(LCL.Text_Description_Summary);
 PARAMETER(LCL.Text_Description_Detail);

 ENDIF;

 ENDIF;

}


