// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PWFGXFR
// ?Date: 14.08.2025 Time: 02:56:19
// ?------------------------------------------------------------------------------------------------

//?Execute user function

EXECUTE FUNCTION(Prt3Delivery Schedule RT) TYPE(RTVOBJ) FILE(PKAXCPP)           AB1342348;
PARAMETER(PAR.PDW_Company_Number);
PARAMETER(PAR.PDW_Producer_Code);
PARAMETER(PAR.PDW_BOL_Kill_Date);
PARAMETER(PAR.PDW_Company_Number);
PARAMETER(PAR.PDW_Producer_Code);
PARAMETER(PAR.PDW_Email);
PARAMETER(PAR.PDW_BOL_Kill_Date);
PARAMETER(PAR.PDW_Date_To);
PARAMETER(PAR.PDW_Producer_Loc_Code);
{
 //?USER: Initialize routine

 // LCL.Delivery Schedule Rpt Key = CON.*ZERO
 LCL.Delivery_Schedule_Rpt_Key = 0;

 //?USER: Process Data record

 // PGM.*Record selected = CND.*YES
 PGM.*Record_selected = 'Y';

 CASE;

 // IF DB1.BOL Kill Date GT PAR.PDW Date To
 IF DB1.BOL_Kill_Date > PAR.PDW_Date_To;

 QUIT;

 // IF *OTHERWISE
 IF *OTHERWISE;

 //?T13559 DN 08/22/18-Select by Producer Location if Entered.
 CASE;

 // IF PAR.PDW Producer Loc Code is Entered
 IF PAR.PDW_Producer_Loc_Code <> *BLANK;

 CASE;

 // IF PAR.PDW Producer Loc Code NE DB1.PL Location Code
 IF PAR.PDW_Producer_Loc_Code <> DB1.PL_Location_Code;

 // PGM.*Record selected = CND.*NO
 PGM.*Record_selected = 'N';

 ENDIF;

 ENDIF;

 //?T13559 DN 08/22/18-Record Selected=Y Then Continue to Create Record.
 CASE;

 // IF PGM.*Record selected is *YES
 IF PGM.*Record_selected = 'Y';

 //?T13559 DN 08/22/18-Process existing routine below.
 //?Load values for work file create
 CASE;

 // IF *OTHERWISE
 IF *OTHERWISE;

 EXECUTE FUNCTION(Rtv BO Info           RT) TYPE(RTVOBJ) FILE(PKAWCPP)           AB1100911;
 PARAMETER(DB1.BOH_Company_Number);
 PARAMETER(DB1.BOH_Buy_Order_Number);
 PARAMETER(NLL.BOH_Payment_Type);
 PARAMETER(NLL.PD_Producer_Code);
 PARAMETER(LCL.PL_Location_Code);
 PARAMETER(NLL.GN_Genetic_Code);
 PARAMETER(NLL.PO_Option_Code);
 PARAMETER(NLL.CMP_Program_Code);
 {
  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 EXECUTE FUNCTION(Rtv Buy Order Load Ref RT) TYPE(RTVOBJ) FILE(PWACCPP)          AB1333104;
 PARAMETER(DB1.BOH_Company_Number);
 PARAMETER(DB1.BOH_Buy_Order_Number);
 PARAMETER(DB1.BOL_Load_Number);
 PARAMETER(LCL.BOL_Ref_1);
 PARAMETER(LCL.BOL_Ref_2);
 PARAMETER(LCL.BOL_Ref_Status);
 PARAMETER(NLL.RS_Record_Status);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 EXECUTE FUNCTION(Rtv First BO Comment  RT) TYPE(RTVOBJ) FILE(PKAYCPP)           AB1342491;
 PARAMETER(DB1.BOH_Company_Number);
 PARAMETER(DB1.BOH_Buy_Order_Number);
 PARAMETER(LCL.BOL_Comment);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

  QUIT;

 }

 EXECUTE FUNCTION(Rtv Producer Nm, Srce RT) TYPE(RTVOBJ) FILE(PKACREP)           AB1162488;
 PARAMETER(PAR.PDW_Producer_Code);
 PARAMETER(NLL.PD_Name);
 PARAMETER(LCL.SR_Source_Code);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 EXECUTE FUNCTION(Rtv Source Type       RT) TYPE(RTVOBJ) FILE(PKAAREP)           AB1141829;
 PARAMETER(LCL.SR_Source_Code);
 PARAMETER(LCL.SR_Type);
 {
  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 //?Determine Movement Number based on SR Type
 CASE;

 // IF LCL.SR Type is Internal
 IF LCL.SR_Type = 'I';

 EXECUTE FUNCTION(Rtv Mvmnt,Farm f/BOL  RT) TYPE(RTVOBJ) FILE(PLAECPP)           AB1245116;
 PARAMETER(DB1.BOL_Kill_Date);
 PARAMETER(NLL.DSD_Farm_Site_Code);
 PARAMETER(LCL.PDW_BOL_Movement_Number);
 PARAMETER(DB1.BOH_Company_Number);
 PARAMETER(DB1.BOH_Buy_Order_Number);
 PARAMETER(DB1.BOL_Load_Number);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

  QUIT;

 }

 // LCL.PL Location Code = CVTVAR(WRK.DSD Farm Site Code)
 LCL.PL_Location_Code = CVTVAR(WRK.DSD_Farm_Site_Code);

 //?Determine Movement Number based on SR Type
 // IF LCL.SR Type is External
 IF LCL.SR_Type = 'E';

 //?multiple by 1000 for 8 position
 //?MOVEMENT IS NOW 10,0 FOR LONGER BO AT 7.0 || bol
 // bon * 1000 + bol
 LCL.PDW_BOL_Movement_Number = ( DB1.BOH_Buy_Order_Number * 1000 ) + DB1.BOL_Load_Number;

 ENDIF;

 //?Convert time to alpha
 CASE;

 // IF *OTHERWISE
 IF *OTHERWISE;

 // LCL.@Text 4 = CVTVAR(DB1.BOL Pln Delv Start Time)
 LCL.@Text_4 = CVTVAR(DB1.BOL_Pln_Delv_Start_Time);

 // LCL.Hour Usr Alpha = SUBSTRING(LCL.@Text 4,CON.1,CON.2)
 LCL.Hour_Usr_Alpha = SUBSTRING(LCL.@Text_4:1:2);

 // LCL.MM Alpha USR = SUBSTRING(LCL.@Text 4,CON.3,CON.2)
 LCL.MM_Alpha_USR = SUBSTRING(LCL.@Text_4:3:2);

 // LCL.BOL Pln Delv Time 5A = CONCAT(LCL.Hour Usr Alpha,CON.:,CND.*None)
 LCL.BOL_Pln_Delv_Time_5A = LCL.Hour_Usr_Alpha + ':' (*ZERO);

 // LCL.BOL Pln Delv Time 5A = CONCAT(LCL.BOL Pln Delv Time 5A,LCL.MM Alpha USR,CND.*None)
 LCL.BOL_Pln_Delv_Time_5A = LCL.BOL_Pln_Delv_Time_5A + LCL.MM_Alpha_USR (*ZERO);

 ENDIF;

 //?Convert date to mm/dd/yy
 CASE;

 // IF *OTHERWISE
 IF *OTHERWISE;

 EXECUTE FUNCTION(IF Synon DTE to mm/dd/yy) TYPE(EXCINTFUN)                      AB1342397;
 PARAMETER(DB1.BOL_Kill_Date);
 PARAMETER(LCL.BOL_Kill_Date_8A);
 {
  //?Execute internal function

  // LCL.Date Alpha USR = CVTVAR(PAR.Date In)
  LCL.Date_Alpha_USR = CVTVAR(PAR.Date_In);

  // LCL.Year Alpha Usr = SUBSTRING(LCL.Date Alpha USR,CON.2,CON.2)
  LCL.Year_Alpha_Usr = SUBSTRING(LCL.Date_Alpha_USR:2:2);

  // LCL.Month Alpha USR = SUBSTRING(LCL.Date Alpha USR,CON.4,CON.2)
  LCL.Month_Alpha_USR = SUBSTRING(LCL.Date_Alpha_USR:4:2);

  // LCL.Day Alpha USR = SUBSTRING(LCL.Date Alpha USR,CON.6,CON.2)
  LCL.Day_Alpha_USR = SUBSTRING(LCL.Date_Alpha_USR:6:2);

  // LCL.Date Out MM/DD/YY = CONCAT(LCL.Month Alpha USR,CON./,CND.*None)
  LCL.Date_Out_MM_DD_YY = LCL.Month_Alpha_USR + '/' (*ZERO);

  // LCL.Date Out MM/DD/YY = CONCAT(LCL.Date Out MM/DD/YY,LCL.Day Alpha USR,CND.*None)
  LCL.Date_Out_MM_DD_YY = LCL.Date_Out_MM_DD_YY + LCL.Day_Alpha_USR (*ZERO);

  // LCL.Date Out MM/DD/YY = CONCAT(LCL.Date Out MM/DD/YY,CON./,CND.*None)
  LCL.Date_Out_MM_DD_YY = LCL.Date_Out_MM_DD_YY + '/' (*ZERO);

  // PAR.Date Out MM/DD/YY = CONCAT(LCL.Date Out MM/DD/YY,LCL.Year Alpha Usr,CND.*None)
  PAR.Date_Out_MM_DD_YY = LCL.Date_Out_MM_DD_YY + LCL.Year_Alpha_Usr (*ZERO);

 }

 EXECUTE FUNCTION(IF Synon DTE to mm/dd/yy) TYPE(EXCINTFUN)                      AB1342397;
 PARAMETER(DB1.BOL_Pln_Delv_Date);
 PARAMETER(LCL.BOL_Pln_Delv_Date_8A);
 {
  //?Execute internal function

  // LCL.Date Alpha USR = CVTVAR(PAR.Date In)
  LCL.Date_Alpha_USR = CVTVAR(PAR.Date_In);

  // LCL.Year Alpha Usr = SUBSTRING(LCL.Date Alpha USR,CON.2,CON.2)
  LCL.Year_Alpha_Usr = SUBSTRING(LCL.Date_Alpha_USR:2:2);

  // LCL.Month Alpha USR = SUBSTRING(LCL.Date Alpha USR,CON.4,CON.2)
  LCL.Month_Alpha_USR = SUBSTRING(LCL.Date_Alpha_USR:4:2);

  // LCL.Day Alpha USR = SUBSTRING(LCL.Date Alpha USR,CON.6,CON.2)
  LCL.Day_Alpha_USR = SUBSTRING(LCL.Date_Alpha_USR:6:2);

  // LCL.Date Out MM/DD/YY = CONCAT(LCL.Month Alpha USR,CON./,CND.*None)
  LCL.Date_Out_MM_DD_YY = LCL.Month_Alpha_USR + '/' (*ZERO);

  // LCL.Date Out MM/DD/YY = CONCAT(LCL.Date Out MM/DD/YY,LCL.Day Alpha USR,CND.*None)
  LCL.Date_Out_MM_DD_YY = LCL.Date_Out_MM_DD_YY + LCL.Day_Alpha_USR (*ZERO);

  // LCL.Date Out MM/DD/YY = CONCAT(LCL.Date Out MM/DD/YY,CON./,CND.*None)
  LCL.Date_Out_MM_DD_YY = LCL.Date_Out_MM_DD_YY + '/' (*ZERO);

  // PAR.Date Out MM/DD/YY = CONCAT(LCL.Date Out MM/DD/YY,LCL.Year Alpha Usr,CND.*None)
  PAR.Date_Out_MM_DD_YY = LCL.Date_Out_MM_DD_YY + LCL.Year_Alpha_Usr (*ZERO);

 }

 ENDIF;

 // LCL.Delivery Schedule Rpt Key = LCL.Delivery Schedule Rpt Key + CON.1
 LCL.Delivery_Schedule_Rpt_Key = LCL.Delivery_Schedule_Rpt_Key + 1;

 ENDIF;

 EXECUTE FUNCTION(Crt Delivery SchRptWk CH) TYPE(CRTOBJ) FILE(PWAJCPP)           AB1342184;
 PARAMETER(PAR.PDW_Company_Number);
 PARAMETER(PAR.PDW_Producer_Code);
 PARAMETER(PAR.PDW_Email);
 PARAMETER(PAR.PDW_BOL_Kill_Date);
 PARAMETER(PAR.PDW_Date_To);
 PARAMETER(LCL.Delivery_Schedule_Rpt_Key);
 PARAMETER(LCL.BOL_Kill_Date_8A);
 PARAMETER(LCL.BOL_Pln_Delv_Date_8A);
 PARAMETER(LCL.BOL_Pln_Delv_Time_5A);
 PARAMETER(DB1.BOL_Pln_Head_Delv);
 PARAMETER(LCL.PDW_BOL_Movement_Number);
 PARAMETER(LCL.PL_Location_Code);
 PARAMETER(*BLANK);
 PARAMETER(LCL.BOL_Comment);
 PARAMETER(LCL.BOL_Ref_1);
 PARAMETER(LCL.BOL_Ref_2);
 PARAMETER(LCL.BOL_Ref_Status);
 ENDIF;

 ENDIF;

}


