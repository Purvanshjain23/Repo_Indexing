// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PUFRXFR
// ?Date: 14.08.2025 Time: 03:50:16
// ?------------------------------------------------------------------------------------------------

//?Execute user function

EXECUTE FUNCTION(Crt Rcvd But Not Ship RT) TYPE(RTVOBJ) FILE(PUAOCPP)           AC2144748;
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Order_Number);
PARAMETER(PAR.Item_Code);
PARAMETER(PAR.Ship_From_Warehouse);
PARAMETER(PAR.Ship_To_Warehouse);
PARAMETER(PAR.Scheduled_Ship_Date);
PARAMETER(PAR.Load_ID);
PARAMETER(PAR.BOL_Complete_Date);
PARAMETER(PAR.BOL_Complete_Time);
PARAMETER(PAR.Item_Description_Line_1);
PARAMETER(PAR.Email_Ship_Rcvd_Diff_USR);
{
 //?USER: Initialize routine

 // LCL.Item Description Line 1 = PAR.Item Description Line 1
 LCL.Item_Description_Line_1 = PAR.Item_Description_Line_1;

 //?USER: Process Data record

 // PGM.*Record selected = CND.*YES
 PGM.*Record_selected = 'Y';

 //?Match by Item Code if Requested.
 CASE;

 // IF PAR.Item Code is Entered
 IF PAR.Item_Code <> *ZERO;

 CASE;

 // IF PAR.Item Code NE DB1.Item Code
 IF PAR.Item_Code <> DB1.Item_Code;

 // PGM.*Record selected = CND.*NO
 PGM.*Record_selected = 'N';

 ENDIF;

 //?Match by Item Code if Requested.
 // IF *OTHERWISE
 IF *OTHERWISE;

 //?Get Item Code Description.
 CASE;

 // IF DB1.Item Code NE LCL.Item Code
 IF DB1.Item_Code <> LCL.Item_Code;

 // LCL.Item Code = DB1.Item Code
 LCL.Item_Code = DB1.Item_Code;

 EXECUTE FUNCTION(Rtv Desc Line 1&2      RT) TYPE(RTVOBJ) FILE(CABZREP)          AC2139542;
 PARAMETER(PAR.Company_Number);
 PARAMETER(DB1.Item_Code);
 PARAMETER(LCL.Item_Description_Line_1);
 PARAMETER(NLL.Description_Line_Two);
 {
  //?USER: Initialize routine

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 ENDIF;

 ENDIF;

 //?Create WF Whs Stck Txf Diff if Manifest Detail Not Found.
 CASE;

 // IF PGM.*Record selected is *YES
 IF PGM.*Record_selected = 'Y';

 //?Check By Item or By Pallet Level?
 CASE;

 // IF PAR.Email Ship/Rcvd Diff USR is No
 IF PAR.Email_Ship_Rcvd_Diff_USR = 'N';

 //?Called from PUDCDFR - F22=Email DTL Rcvd/In-Transit EDI.
 EXECUTE FUNCTION(RTV for Existence     RT) TYPE(RTVOBJ) FILE(OMFNCPP)           AC2144751;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Order_Number);
 PARAMETER(DB1.Item_Code);
 PARAMETER(DB1.Manifest_Pallet_Number);
 //?Check By Item or By Pallet Level?
 // IF *OTHERWISE
 IF *OTHERWISE;

 //?Called from PMEZDFR - F20=Email Ship/Rcvd Diff EDI.
 EXECUTE FUNCTION(RTV for Existence 2   RT) TYPE(RTVOBJ) FILE(OMFNCPP)           AC2158790;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Order_Number);
 PARAMETER(DB1.Item_Code);
 ENDIF;

 //?Check Return Code.
 CASE;

 // IF PGM.*Return code is *Normal
 IF PGM.*Return_code = *BLANK;

 //?Check Return Code.
 // IF *OTHERWISE
 IF *OTHERWISE;

 //?If not found, this means Rcvd Qty was more than what was shipped.
 // LCL.Diff/Discrepancy Qty = DB1.Quantity Received
 LCL.Diff_Discrepancy_Qty = DB1.Quantity_Received;

 //?R113315 DN 09/10/18-If keys exist, add it to existing record.
 CASE;

 // IF PAR.Email Ship/Rcvd Diff USR is No
 IF PAR.Email_Ship_Rcvd_Diff_USR = 'N';

 //?Called from PUDCDFR - F22=Email DTL Rcvd/In-Transit EDI.
 //?This will update by Co/Ord/Load/Pallet/Item/Serial.
 EXECUTE FUNCTION(Upd WF Whs StckTxf Dif RT) TYPE(RTVOBJ) FILE(PUA1CPP)          AC2158511;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Order_Number);
 PARAMETER(DB1.Load_ID);
 PARAMETER(DB1.Manifest_Pallet_Number);
 PARAMETER(DB1.Item_Code);
 PARAMETER(DB1.PT_Serial_Number);
 PARAMETER(PAR.Ship_From_Warehouse);
 PARAMETER(PAR.Ship_To_Warehouse);
 PARAMETER(PAR.Scheduled_Ship_Date);
 PARAMETER(PAR.BOL_Complete_Date);
 PARAMETER(PAR.BOL_Complete_Time);
 PARAMETER(DB1.MDER_Receipt_Date);
 PARAMETER(DB1.MDER_Receipt_Time);
 PARAMETER(LCL.Item_Description_Line_1);
 PARAMETER(DB1.MDER_Production_Date);
 PARAMETER(DB1.Quantity_Received);
 PARAMETER(LCL.Diff_Discrepancy_Qty);
 {
  //?USER: Processing if Data record not found

  EXECUTE FUNCTION(CRT WF Whs StckTxf Dif CR) TYPE(CRTOBJ) FILE(PUA1CPP)          AC2144368;
  PARAMETER(PAR.Company_Number);
  PARAMETER(PAR.Order_Number);
  PARAMETER(PAR.Load_ID);
  PARAMETER(PAR.Manifest_Pallet_Number);
  PARAMETER(PAR.Item_Code);
  PARAMETER(PAR.PT_Serial_Number);
  PARAMETER(PAR.Ship_From_Warehouse);
  PARAMETER(PAR.Ship_To_Warehouse);
  PARAMETER(PAR.Scheduled_Ship_Date);
  PARAMETER(PAR.BOL_Complete_Date);
  PARAMETER(PAR.BOL_Complete_Time);
  PARAMETER(PAR.MDER_Receipt_Date);
  PARAMETER(PAR.MDER_Receipt_Time);
  PARAMETER(PAR.Item_Description_Line_1);
  PARAMETER(PAR.Production_Date);
  PARAMETER(*ZERO);
  PARAMETER(*ZERO);
  PARAMETER(*ZERO);
  PARAMETER(PAR.Quantity_Received);
  PARAMETER(*BLANK);
  PARAMETER(*BLANK);
  PARAMETER(PAR.Diff_Discrepancy_Qty);
  PARAMETER(*ZERO);
  PARAMETER(*ZERO);
  PARAMETER(*ZERO);
  PARAMETER(*ZERO);
  PARAMETER(*ZERO);
  //?USER: Process Data record

  //?Update Quantity Received & Diff/Discrepancy Qty.
  // LCL.Quantity Received = DB1.Quantity Received + PAR.Quantity Received
  LCL.Quantity_Received = DB1.Quantity_Received + PAR.Quantity_Received;

  // LCL.Diff/Discrepancy Qty = DB1.Diff/Discrepancy Qty + PAR.Diff/Discrepancy Qty
  LCL.Diff_Discrepancy_Qty = DB1.Diff_Discrepancy_Qty + PAR.Diff_Discrepancy_Qty;

  //?Update the Oldest Production Date.
  CASE;

  // IF PAR.Production Date LT DB1.Production Date
  IF PAR.Production_Date < DB1.Production_Date;

  // LCL.Production Date = PAR.Production Date
  LCL.Production_Date = PAR.Production_Date;

  //?Update the Oldest Production Date.
  // IF *OTHERWISE
  IF *OTHERWISE;

  // LCL.Production Date = DB1.Production Date
  LCL.Production_Date = DB1.Production_Date;

  ENDIF;

  EXECUTE FUNCTION(CHG WF Whs StckTxf Dif CH) TYPE(CHGOBJ) FILE(PUA1CPP)          AC2144369;
  PARAMETER(DB1.Company_Number);
  PARAMETER(DB1.Order_Number);
  PARAMETER(DB1.Load_ID);
  PARAMETER(DB1.Manifest_Pallet_Number);
  PARAMETER(DB1.Item_Code);
  PARAMETER(DB1.PT_Serial_Number);
  PARAMETER(DB1.Ship_From_Warehouse);
  PARAMETER(DB1.Ship_To_Warehouse);
  PARAMETER(DB1.Scheduled_Ship_Date);
  PARAMETER(DB1.BOL_Complete_Date);
  PARAMETER(DB1.BOL_Complete_Time);
  PARAMETER(DB1.MDER_Receipt_Date);
  PARAMETER(DB1.MDER_Receipt_Time);
  PARAMETER(DB1.Item_Description_Line_1);
  PARAMETER(LCL.Production_Date);
  PARAMETER(DB1.Case_Weight);
  PARAMETER(DB1.Manifest_Gross_Weight);
  PARAMETER(DB1.Case_Quantity);
  PARAMETER(LCL.Quantity_Received);
  PARAMETER(DB1.EWSTD_Unused_Sts_1);
  PARAMETER(DB1.EWSTD_Unused_Sts_2);
  PARAMETER(LCL.Diff_Discrepancy_Qty);
  PARAMETER(DB1.In_Transit_Qty);
  PARAMETER(DB1.EWSTD_Unused_Nbr_1);
  PARAMETER(DB1.EWSTD_Unused_Wgt_1);
  PARAMETER(DB1.EWSTD_Unused_Dte_1);
  PARAMETER(DB1.EWSTD_Unused_Dte_2);
 }

 //?R113315 DN 09/10/18-If keys exist, add it to existing record.
 // IF *OTHERWISE
 IF *OTHERWISE;

 //?Called from PMEZDFR - F20=Email Ship/Rcvd Diff EDI.
 //?This will SUM up Qty Ship & Qty Rcvd by Co/Ord/Load/Item.
 EXECUTE FUNCTION(Upd WhsStckTxf Diff 2  RT) TYPE(RTVOBJ) FILE(PUA1CPP)          AC2158774;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Order_Number);
 PARAMETER(DB1.Load_ID);
 PARAMETER(DB1.Item_Code);
 PARAMETER(DB1.Manifest_Pallet_Number);
 PARAMETER(DB1.PT_Serial_Number);
 PARAMETER(PAR.Ship_From_Warehouse);
 PARAMETER(PAR.Ship_To_Warehouse);
 PARAMETER(PAR.Scheduled_Ship_Date);
 PARAMETER(PAR.BOL_Complete_Date);
 PARAMETER(PAR.BOL_Complete_Time);
 PARAMETER(DB1.MDER_Receipt_Date);
 PARAMETER(DB1.MDER_Receipt_Time);
 PARAMETER(LCL.Item_Description_Line_1);
 PARAMETER(DB1.MDER_Production_Date);
 PARAMETER(*ZERO);
 PARAMETER(*ZERO);
 PARAMETER(*ZERO);
 PARAMETER(DB1.Quantity_Received);
 PARAMETER(LCL.Diff_Discrepancy_Qty);
 PARAMETER(*ZERO);
 {
  //?USER: Processing if Data record not found

  EXECUTE FUNCTION(CRT WF Whs StckTxf Dif CR) TYPE(CRTOBJ) FILE(PUA1CPP)          AC2144368;
  PARAMETER(PAR.Company_Number);
  PARAMETER(PAR.Order_Number);
  PARAMETER(PAR.Load_ID);
  PARAMETER(PAR.Manifest_Pallet_Number);
  PARAMETER(PAR.Item_Code);
  PARAMETER(PAR.PT_Serial_Number);
  PARAMETER(PAR.Ship_From_Warehouse);
  PARAMETER(PAR.Ship_To_Warehouse);
  PARAMETER(PAR.Scheduled_Ship_Date);
  PARAMETER(PAR.BOL_Complete_Date);
  PARAMETER(PAR.BOL_Complete_Time);
  PARAMETER(PAR.MDER_Receipt_Date);
  PARAMETER(PAR.MDER_Receipt_Time);
  PARAMETER(PAR.Item_Description_Line_1);
  PARAMETER(PAR.Production_Date);
  PARAMETER(PAR.Case_Weight);
  PARAMETER(PAR.Manifest_Gross_Weight);
  PARAMETER(PAR.Case_Quantity);
  PARAMETER(PAR.Quantity_Received);
  PARAMETER(*BLANK);
  PARAMETER(*BLANK);
  PARAMETER(PAR.Diff_Discrepancy_Qty);
  PARAMETER(PAR.In_Transit_Qty);
  PARAMETER(*ZERO);
  PARAMETER(*ZERO);
  PARAMETER(*ZERO);
  PARAMETER(*ZERO);
  //?USER: Process Data record

  //?Accumulate & Update WF EDI Whs Stk Txfr Diff File.
  // LCL.Case Weight = DB1.Case Weight + PAR.Case Weight
  LCL.Case_Weight = DB1.Case_Weight + PAR.Case_Weight;

  // LCL.Manifest Gross Weight = DB1.Manifest Gross Weight + PAR.Manifest Gross Weight
  LCL.Manifest_Gross_Weight = DB1.Manifest_Gross_Weight + PAR.Manifest_Gross_Weight;

  // LCL.Case Quantity = DB1.Case Quantity + PAR.Case Quantity
  LCL.Case_Quantity = DB1.Case_Quantity + PAR.Case_Quantity;

  // LCL.Quantity Received = DB1.Quantity Received + PAR.Quantity Received
  LCL.Quantity_Received = DB1.Quantity_Received + PAR.Quantity_Received;

  // LCL.Diff/Discrepancy Qty = DB1.Diff/Discrepancy Qty + PAR.Diff/Discrepancy Qty
  LCL.Diff_Discrepancy_Qty = DB1.Diff_Discrepancy_Qty + PAR.Diff_Discrepancy_Qty;

  EXECUTE FUNCTION(CHG WF Whs StckTxf Dif CH) TYPE(CHGOBJ) FILE(PUA1CPP)          AC2144369;
  PARAMETER(DB1.Company_Number);
  PARAMETER(DB1.Order_Number);
  PARAMETER(DB1.Load_ID);
  PARAMETER(DB1.Manifest_Pallet_Number);
  PARAMETER(DB1.Item_Code);
  PARAMETER(DB1.PT_Serial_Number);
  PARAMETER(DB1.Ship_From_Warehouse);
  PARAMETER(DB1.Ship_To_Warehouse);
  PARAMETER(DB1.Scheduled_Ship_Date);
  PARAMETER(DB1.BOL_Complete_Date);
  PARAMETER(DB1.BOL_Complete_Time);
  PARAMETER(DB1.MDER_Receipt_Date);
  PARAMETER(DB1.MDER_Receipt_Time);
  PARAMETER(DB1.Item_Description_Line_1);
  PARAMETER(DB1.Production_Date);
  PARAMETER(LCL.Case_Weight);
  PARAMETER(LCL.Manifest_Gross_Weight);
  PARAMETER(LCL.Case_Quantity);
  PARAMETER(LCL.Quantity_Received);
  PARAMETER(DB1.EWSTD_Unused_Sts_1);
  PARAMETER(DB1.EWSTD_Unused_Sts_2);
  PARAMETER(LCL.Diff_Discrepancy_Qty);
  PARAMETER(DB1.In_Transit_Qty);
  PARAMETER(DB1.EWSTD_Unused_Nbr_1);
  PARAMETER(DB1.EWSTD_Unused_Wgt_1);
  PARAMETER(DB1.EWSTD_Unused_Dte_1);
  PARAMETER(DB1.EWSTD_Unused_Dte_2);
 }

 ENDIF;

 ENDIF;

 ENDIF;

}


