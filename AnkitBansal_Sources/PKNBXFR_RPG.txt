     H/TITLE Utl Clc Internal NPPC XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 11/09/20  Time  : 01:19:20
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKA1CPLXIF  E           K        DISK
      * RSQ : Tattoo Header       Co/Src Typ/Kill Date
      *
     FPKBEREL2IF  E           K        DISK
      * RSQ : Producer Std D/A          Active Std D/A only
      *
     FPKBBREL2IF  E           K        DISK
      * RTV : Deduction/Addition        Active Codes only
      *
     FPKAWCPL1IF  E           K        DISK
      * RTV : Buy Order Header          Retrieval index
      *
     FPKA1CPLFIF  E           K        DISK
      * RSQ : Tattoo Header             Co/BOL/Kill/Ttt
      *
     FPKCDCPL5IF  E           K        DISK
      * RSQ : Tattoo Ded/Add            Co/BOL, reimb hd>0
      *
     FPKA1CPNDIF  E           K        DISK
      * RTV : Tattoo Header             Retrieval Index 2
      *
     FPKAQCPL0IF  E           K        DISK
      * RTV : Producer Sub-Contract     Retrieval index
      *
     FPKECCPL1IF  E           K        DISK
      * RTV : Producer SC Floor Price   Retrieval index
      *
     FPKEECPL0IF  E           K        DISK
      * RTV : Producer Cntrct RsvAct Hd Retrieval index
      *
     FPKCDCPL1IF  E           K        DISK
      * RTV : Tattoo Ded/Add            Retrieval index
      *
     FPKCDCPL0IF  E           K        DISK                      A
      * UPD : Tattoo Ded/Add            Update index
      *
     FPKA1CPL1UF  E           K        DISK
      * UPD : Tattoo Header             Update index
      *
     E                    YDOW        7  1               *Days of week
     I@A1CPQ2
      * Tattoo Header       Co/Src Typ/Kill Date
      * Renamed input format fields
     I              A1HMNB                          WAHMNB
     I              A1BNNB                          WABNNB
     I              A1BONB                          WABONB
     I              A1CVNB                          WACVNB
     I              A1B0DT                          WAB0DT
     I              A1AWDT                          WAAWDT
     I              A1BICD                          WABICD
     I              A1CPST                          WACPST
     I              A1ACPR                          WAACPR
     I              A1B9PR                          WAB9PR
     I              A1CAPR                          WACAPR
     I              A1C4ST                          WAC4ST
     I              A1AIPR                          WAAIPR
     I              A1A6DT                          WAA6DT
     I              A1C2ST                          WAC2ST
     I              A1CXNB                          WACXNB
     I              A1CWNB                          WACWNB
     I              A1FCNB                          WAFCNB
     I              A1H9NB                          WAH9NB
     I              A1FDNB                          WAFDNB
     I              A1FENB                          WAFENB
     I              A1HENB                          WAHENB
     I              A1HFNB                          WAHFNB
     I              A1CYNB                          WACYNB
     I              A1LRNB                          WALRNB
     I              A1E0NB                          WAE0NB
     I              A1A5PC                          WAA5PC
     I              A1FBNB                          WAFBNB
     I              A1A4PC                          WAA4PC
     I              A1F7NB                          WAF7NB
     I              A1HDNB                          WAHDNB
     I              A1F5NB                          WAF5NB
     I              A1F4NB                          WAF4NB
     I              A1F3NB                          WAF3NB
     I              A1F2NB                          WAF2NB
     I              A1AVPC                          WAAVPC
     I              A1AWPC                          WAAWPC
     I              A1CWPC                          WACWPC
     I              A1A8PC                          WAA8PC
     I              A1A7PC                          WAA7PC
     I              A1B8PR                          WAB8PR
     I              A1AMPR                          WAAMPR
     I              A1ANPR                          WAANPR
     I              A1AYVA                          WAAYVA
     I              A1AWVA                          WAAWVA
     I              A1AOPR                          WAAOPR
     I              A1AXVA                          WAAXVA
     I              A1APPR                          WAAPPR
     I              A1ASPR                          WAASPR
     I              A1A4VA                          WAA4VA
     I              A1ATPR                          WAATPR
     I              A1A5VA                          WAA5VA
     I              A1CBPR                          WACBPR
     I              A1CCPR                          WACCPR
     I              A1LPNB                          WALPNB
     I              A1CDPR                          WACDPR
     I              A1A7VA                          WAA7VA
     I              A1A2PR                          WAA2PR
     I              A1JWST                          WAJWST
     I              A1CWST                          WACWST
     I              A1D7ST                          WAD7ST
     I              A1D8ST                          WAD8ST
     I              A1DWST                          WADWST
     I              A1D6ST                          WAD6ST
     I              A1GHNB                          WAGHNB
     I              A1BYDT                          WABYDT
     I              A1E0ST                          WAE0ST
     I              A1E1ST                          WAE1ST
     I              A1E2ST                          WAE2ST
     I              A1BSDT                          WABSDT
     I              A1BTDT                          WABTDT
     I              A1BUDT                          WABUDT
     I              A1HGNB                          WAHGNB
     I              A1HHNB                          WAHHNB
     I              A1HINB                          WAHINB
     I              A1A3PR                          WAA3PR
     I              A1A4PR                          WAA4PR
     I              A1A6PR                          WAA6PR
     I              A1J9NB                          WAJ9NB
     I              A1D6PR                          WAD6PR
     I              A1D7PR                          WAD7PR
     I              A1D8PR                          WAD8PR
     I              A1D9PR                          WAD9PR
     I              A1EAPR                          WAEAPR
     I              A1EBPR                          WAEBPR
     I              A1ECPR                          WAECPR
     I              A1EDPR                          WAEDPR
     I              A1EEPR                          WAEEPR
     I              A1EFPR                          WAEFPR
     I              A1EGPR                          WAEGPR
     I              A1EHPR                          WAEHPR
     I              A1KAST                          WAKAST
     I              A1J7ST                          WAJ7ST
     I              A1J9ST                          WAJ9ST
     I              A1OXNB                          WAOXNB
     I              A1LKST                          WALKST
     I              A1LLST                          WALLST
     I              A1J8ST                          WAJ8ST
     I              A1LIST                          WALIST
     I              A1LJST                          WALJST
     I              A1NZTX                          WANZTX
     I              A1HJCD                          WAHJCD
     I              A1R4ST                          WAR4ST
     I              A1R5ST                          WAR5ST
     I              A1R6ST                          WAR6ST
     I              A1R7ST                          WAR7ST
     I              A1THWT                          WATHWT
     I              A1T2WT                          WAT2WT
     I              A1THHD                          WATHHD
     I              A1T2HD                          WAT2HD
     I              A1OBPR                          WAOBPR
     I              A1KOER                          WAKOER
     I              A1OPIR                          WAOPIR
     I              A1OPEM                          WAOPEM
     I              A1IORP                          WAIORP
     I              A1OWEO                          WAOWEO
     I              A1OQET                          WAOQET
     I              A1URST                          WAURST
     I              A1USST                          WAUSST
     I              A1HHPC                          WAHHPC
     I              A1S9PR                          WAS9PR
     I              A1TAPR                          WATAPR
     I              A1TBPR                          WATBPR
     I              A1JFUR                          WAJFUR
     I              A1KRIF                          WAKRIF
     I              A1KORF                          WAKORF
     I              A1KAPR                          WAKAPR
     I              A1KROT                          WAKROT
     I              A1OTJG                          WAOTJG
     I              A1IRJG                          WAIRJG
     I              A1IMJF                          WAIMJF
     I              A1IRGF                          WAIRGF
     I              A1KRJF                          WAKRJF
     I              A1OJRF                          WAOJRF
     I              A1KFOR                          WAKFOR
     I              A1ORJK                          WAORJK
     I              A1OMVJ                          WAOMVJ
     I              A1MVNF                          WAMVNF
     I              A1MCNF                          WAMCNF
     I              A1NCNF                          WANCNF
     I              A1NCHF                          WANCHF
     I              A1IGIR                          WAIGIR
     I              A1KFJR                          WAKFJR
     I              A1EADT                          WAEADT
     I              A1EBDT                          WAEBDT
     I              A1ECDT                          WAECDT
     I              A1EDDT                          WAEDDT
     I              A1EEDT                          WAEEDT
     I              A1U4ST                          WAU4ST
     I              A1U5ST                          WAU5ST
     I              A1U6ST                          WAU6ST
     I              A1U7ST                          WAU7ST
     I              A1U8ST                          WAU8ST
     I              A1U9ST                          WAU9ST
     I              A1VAST                          WAVAST
     I              A1VBST                          WAVBST
     I              A1BDCD                          WABDCD
     I              A1CSCD                          WACSCD
     I              A1ABCD                          WAABCD
     I              A1AECD                          WAAECD
     I              A1ACCD                          WAACCD
     I              A1AGCD                          WAAGCD
     I              A1BECD                          WABECD
     I              A1AAVN                          WAAAVN
     I              A1AADT                          WAAADT
     I              A1AMTM                          WAAMTM
     I              A1AJST                          WAAJST
     I              A1AHVN                          WAAHVN
     I              A1AGVN                          WAAGVN
     I              A1ABVN                          WAABVN
     I              A1ABDT                          WAABDT
     I              A1ABTM                          WAABTM
      *
     I@BERELS
      * Producer Std D/A          Active Std D/A only
      * Renamed input format fields
     I              BEABCD                          WBABCD
     I              BEZCA1                          WBZCA1
     I              BEBQCD                          WBBQCD
     I              BEEVST                          WBEVST
     I              BEA1VA                          WBA1VA
     I              BEJAST                          WBJAST
     I              BEC0DT                          WBC0DT
     I              BEC1DT                          WBC1DT
     I              BEN2ST                          WBN2ST
     I              BEN3ST                          WBN3ST
     I              BEN4ST                          WBN4ST
     I              BEN5ST                          WBN5ST
     I              BEN6ST                          WBN6ST
     I              BEN7ST                          WBN7ST
     I              BEN8ST                          WBN8ST
     I              BEN9ST                          WBN9ST
     I              BEOAST                          WBOAST
     I              BEOBST                          WBOBST
     I              BEAAVN                          WBAAVN
     I              BEAADT                          WBAADT
     I              BEAMTM                          WBAMTM
     I              BEAJST                          WBAJST
     I              BEAHVN                          WBAHVN
     I              BEAGVN                          WBAGVN
     I              BEABVN                          WBABVN
     I              BEABDT                          WBABDT
     I              BEABTM                          WBABTM
      *
     I@BBRELJ
      * Deduction/Addition        Active Codes only
      * Renamed input format fields
     I              BBBQCD                          WCBQCD
     I              BBBLTX                          WCBLTX
     I              BBB9ST                          WCB9ST
     I              BBCAST                          WCCAST
     I              BBAEPR                          WCAEPR
     I              BBI9ST                          WCI9ST
     I              BBCBST                          WCCBST
     I              BBI2ST                          WCI2ST
     I              BBF7TX                          WCF7TX
     I              BBE2CD                          WCE2CD
     I              BBOTNB                          WCOTNB
     I              BBNSST                          WCNSST
     I              BBNTST                          WCNTST
     I              BBNUST                          WCNUST
     I              BBNVST                          WCNVST
     I              BBNWST                          WCNWST
     I              BBNXST                          WCNXST
     I              BBNYST                          WCNYST
     I              BBNZST                          WCNZST
     I              BBN1ST                          WCN1ST
     I              BBN0ST                          WCN0ST
     I              BBRICD                          WCRICD
     I              BBRJCD                          WCRJCD
     I              BBBAT1                          WCBAT1
     I              BBBBT1                          WCBBT1
     I              BBAAVN                          WCAAVN
     I              BBAADT                          WCAADT
     I              BBAMTM                          WCAMTM
     I              BBAJST                          WCAJST
     I              BBAHVN                          WCAHVN
     I              BBAGVN                          WCAGVN
     I              BBABVN                          WCABVN
     I              BBABDT                          WCABDT
     I              BBABTM                          WCABTM
      *
     I@AWCPBI
      * Buy Order Header          Retrieval index
      * Renamed input format fields
     I              AWHMNB                          WDHMNB
     I              AWBNNB                          WDBNNB
     I              AWARDT                          WDARDT
     I              AWASDT                          WDASDT
     I              AWA4ST                          WDA4ST
     I              AWA5ST                          WDA5ST
     I              AWAAPR                          WDAAPR
     I              AWA6ST                          WDA6ST
     I              AWA7ST                          WDA7ST
     I              AWB3ST                          WDB3ST
     I              AWALPR                          WDALPR
     I              AWETCD                          WDETCD
     I              AWEUCD                          WDEUCD
     I              AWJ5TX                          WDJ5TX
     I              AWD5DT                          WDD5DT
     I              AWD6DT                          WDD6DT
     I              AWD7DT                          WDD7DT
     I              AWD8DT                          WDD8DT
     I              AWD9DT                          WDD9DT
     I              AWJOEJ                          WDJOEJ
     I              AWKOFF                          WDKOFF
     I              AWKWPE                          WDKWPE
     I              AWIMBF                          WDIMBF
     I              AWOPTR                          WDOPTR
     I              AWOEJD                          WDOEJD
     I              AWIRMF                          WDIRMF
     I              AWJIRM                          WDJIRM
     I              AWJRKF                          WDJRKF
     I              AWKFIR                          WDKFIR
     I              AWUZST                          WDUZST
     I              AWU0ST                          WDU0ST
     I              AWU1ST                          WDU1ST
     I              AWU2ST                          WDU2ST
     I              AWU3ST                          WDU3ST
     I              AWHXNB                          WDHXNB
     I              AWGANB                          WDGANB
     I              AWGBNB                          WDGBNB
     I              AWABCD                          WDABCD
     I              AWAECD                          WDAECD
     I              AWAKCD                          WDAKCD
     I              AWALCD                          WDALCD
     I              AWAGCD                          WDAGCD
     I              AWAICD                          WDAICD
     I              AWAMCD                          WDAMCD
     I              AWACCD                          WDACCD
     I              AWAAVN                          WDAAVN
     I              AWAADT                          WDAADT
     I              AWAMTM                          WDAMTM
     I              AWAJST                          WDAJST
     I              AWAHVN                          WDAHVN
     I              AWAGVN                          WDAGVN
     I              AWABVN                          WDABVN
     I              AWABDT                          WDABDT
     I              AWABTM                          WDABTM
      *
     I@CDCPIT
      * Tattoo Ded/Add            Update index
      * Renamed input format fields
     I              CDHMNB                          WEHMNB
     I              CDBNNB                          WEBNNB
     I              CDBONB                          WEBONB
     I              CDCVNB                          WECVNB
     I              CDB0DT                          WEB0DT
     I              CDBQCD                          WEBQCD
     I              CDAZVA                          WEAZVA
     I              CDA0VA                          WEA0VA
     I              CDJBST                          WEJBST
     I              CDEIST                          WEEIST
     I              CDJDST                          WEJDST
     I              CDDPCD                          WEDPCD
     I              CDE3CD                          WEE3CD
     I              CDAQNB                          WEAQNB
     I              CDOCST                          WEOCST
     I              CDPEST                          WEPEST
     I              CDPFST                          WEPFST
     I              CDPGST                          WEPGST
     I              CDPIST                          WEPIST
     I              CDPJST                          WEPJST
     I              CDPKST                          WEPKST
     I              CDPLST                          WEPLST
     I              CDAAVN                          WEAAVN
     I              CDAADT                          WEAADT
     I              CDAMTM                          WEAMTM
     I              CDAJST                          WEAJST
     I              CDAHVN                          WEAHVN
     I              CDAGVN                          WEAGVN
     I              CDABVN                          WEABVN
     I              CDABDT                          WEABDT
     I              CDABTM                          WEABTM
      *
     I@A1CPOC
      * Tattoo Header             Co/BOL/Kill/Ttt
      * Renamed input format fields
     I              A1HMNB                          WFHMNB
     I              A1BNNB                          WFBNNB
     I              A1BONB                          WFBONB
     I              A1CVNB                          WFCVNB
     I              A1B0DT                          WFB0DT
     I              A1AWDT                          WFAWDT
     I              A1BICD                          WFBICD
     I              A1CPST                          WFCPST
     I              A1ACPR                          WFACPR
     I              A1B9PR                          WFB9PR
     I              A1CAPR                          WFCAPR
     I              A1C4ST                          WFC4ST
     I              A1AIPR                          WFAIPR
     I              A1A6DT                          WFA6DT
     I              A1C2ST                          WFC2ST
     I              A1CXNB                          WFCXNB
     I              A1CWNB                          WFCWNB
     I              A1FCNB                          WFFCNB
     I              A1H9NB                          WFH9NB
     I              A1FDNB                          WFFDNB
     I              A1FENB                          WFFENB
     I              A1HENB                          WFHENB
     I              A1HFNB                          WFHFNB
     I              A1CYNB                          WFCYNB
     I              A1LRNB                          WFLRNB
     I              A1E0NB                          WFE0NB
     I              A1A5PC                          WFA5PC
     I              A1FBNB                          WFFBNB
     I              A1A4PC                          WFA4PC
     I              A1F7NB                          WFF7NB
     I              A1HDNB                          WFHDNB
     I              A1F5NB                          WFF5NB
     I              A1F4NB                          WFF4NB
     I              A1F3NB                          WFF3NB
     I              A1F2NB                          WFF2NB
     I              A1AVPC                          WFAVPC
     I              A1AWPC                          WFAWPC
     I              A1CWPC                          WFCWPC
     I              A1A8PC                          WFA8PC
     I              A1A7PC                          WFA7PC
     I              A1B8PR                          WFB8PR
     I              A1AMPR                          WFAMPR
     I              A1ANPR                          WFANPR
     I              A1AYVA                          WFAYVA
     I              A1AWVA                          WFAWVA
     I              A1AOPR                          WFAOPR
     I              A1AXVA                          WFAXVA
     I              A1APPR                          WFAPPR
     I              A1ASPR                          WFASPR
     I              A1A4VA                          WFA4VA
     I              A1ATPR                          WFATPR
     I              A1A5VA                          WFA5VA
     I              A1CBPR                          WFCBPR
     I              A1CCPR                          WFCCPR
     I              A1LPNB                          WFLPNB
     I              A1CDPR                          WFCDPR
     I              A1A7VA                          WFA7VA
     I              A1A2PR                          WFA2PR
     I              A1JWST                          WFJWST
     I              A1CWST                          WFCWST
     I              A1D7ST                          WFD7ST
     I              A1D8ST                          WFD8ST
     I              A1DWST                          WFDWST
     I              A1D6ST                          WFD6ST
     I              A1GHNB                          WFGHNB
     I              A1BYDT                          WFBYDT
     I              A1E0ST                          WFE0ST
     I              A1E1ST                          WFE1ST
     I              A1E2ST                          WFE2ST
     I              A1BSDT                          WFBSDT
     I              A1BTDT                          WFBTDT
     I              A1BUDT                          WFBUDT
     I              A1HGNB                          WFHGNB
     I              A1HHNB                          WFHHNB
     I              A1HINB                          WFHINB
     I              A1A3PR                          WFA3PR
     I              A1A4PR                          WFA4PR
     I              A1A6PR                          WFA6PR
     I              A1J9NB                          WFJ9NB
     I              A1D6PR                          WFD6PR
     I              A1D7PR                          WFD7PR
     I              A1D8PR                          WFD8PR
     I              A1D9PR                          WFD9PR
     I              A1EAPR                          WFEAPR
     I              A1EBPR                          WFEBPR
     I              A1ECPR                          WFECPR
     I              A1EDPR                          WFEDPR
     I              A1EEPR                          WFEEPR
     I              A1EFPR                          WFEFPR
     I              A1EGPR                          WFEGPR
     I              A1EHPR                          WFEHPR
     I              A1KAST                          WFKAST
     I              A1J7ST                          WFJ7ST
     I              A1J9ST                          WFJ9ST
     I              A1OXNB                          WFOXNB
     I              A1LKST                          WFLKST
     I              A1LLST                          WFLLST
     I              A1J8ST                          WFJ8ST
     I              A1LIST                          WFLIST
     I              A1LJST                          WFLJST
     I              A1NZTX                          WFNZTX
     I              A1HJCD                          WFHJCD
     I              A1R4ST                          WFR4ST
     I              A1R5ST                          WFR5ST
     I              A1R6ST                          WFR6ST
     I              A1R7ST                          WFR7ST
     I              A1THWT                          WFTHWT
     I              A1T2WT                          WFT2WT
     I              A1THHD                          WFTHHD
     I              A1T2HD                          WFT2HD
     I              A1OBPR                          WFOBPR
     I              A1KOER                          WFKOER
     I              A1OPIR                          WFOPIR
     I              A1OPEM                          WFOPEM
     I              A1IORP                          WFIORP
     I              A1OWEO                          WFOWEO
     I              A1OQET                          WFOQET
     I              A1URST                          WFURST
     I              A1USST                          WFUSST
     I              A1HHPC                          WFHHPC
     I              A1S9PR                          WFS9PR
     I              A1TAPR                          WFTAPR
     I              A1TBPR                          WFTBPR
     I              A1JFUR                          WFJFUR
     I              A1KRIF                          WFKRIF
     I              A1KORF                          WFKORF
     I              A1KAPR                          WFKAPR
     I              A1KROT                          WFKROT
     I              A1OTJG                          WFOTJG
     I              A1IRJG                          WFIRJG
     I              A1IMJF                          WFIMJF
     I              A1IRGF                          WFIRGF
     I              A1KRJF                          WFKRJF
     I              A1OJRF                          WFOJRF
     I              A1KFOR                          WFKFOR
     I              A1ORJK                          WFORJK
     I              A1OMVJ                          WFOMVJ
     I              A1MVNF                          WFMVNF
     I              A1MCNF                          WFMCNF
     I              A1NCNF                          WFNCNF
     I              A1NCHF                          WFNCHF
     I              A1IGIR                          WFIGIR
     I              A1KFJR                          WFKFJR
     I              A1EADT                          WFEADT
     I              A1EBDT                          WFEBDT
     I              A1ECDT                          WFECDT
     I              A1EDDT                          WFEDDT
     I              A1EEDT                          WFEEDT
     I              A1U4ST                          WFU4ST
     I              A1U5ST                          WFU5ST
     I              A1U6ST                          WFU6ST
     I              A1U7ST                          WFU7ST
     I              A1U8ST                          WFU8ST
     I              A1U9ST                          WFU9ST
     I              A1VAST                          WFVAST
     I              A1VBST                          WFVBST
     I              A1BDCD                          WFBDCD
     I              A1CSCD                          WFCSCD
     I              A1ABCD                          WFABCD
     I              A1AECD                          WFAECD
     I              A1ACCD                          WFACCD
     I              A1AGCD                          WFAGCD
     I              A1BECD                          WFBECD
     I              A1AAVN                          WFAAVN
     I              A1AADT                          WFAADT
     I              A1AMTM                          WFAMTM
     I              A1AJST                          WFAJST
     I              A1AHVN                          WFAHVN
     I              A1AGVN                          WFAGVN
     I              A1ABVN                          WFABVN
     I              A1ABDT                          WFABDT
     I              A1ABTM                          WFABTM
      *
     I@A1CPC5
      * Tattoo Header             Update index
      * Renamed input format fields
     I              A1HMNB                          WGHMNB
     I              A1BNNB                          WGBNNB
     I              A1BONB                          WGBONB
     I              A1CVNB                          WGCVNB
     I              A1B0DT                          WGB0DT
     I              A1AWDT                          WGAWDT
     I              A1BICD                          WGBICD
     I              A1CPST                          WGCPST
     I              A1ACPR                          WGACPR
     I              A1B9PR                          WGB9PR
     I              A1CAPR                          WGCAPR
     I              A1C4ST                          WGC4ST
     I              A1AIPR                          WGAIPR
     I              A1A6DT                          WGA6DT
     I              A1C2ST                          WGC2ST
     I              A1CXNB                          WGCXNB
     I              A1CWNB                          WGCWNB
     I              A1FCNB                          WGFCNB
     I              A1H9NB                          WGH9NB
     I              A1FDNB                          WGFDNB
     I              A1FENB                          WGFENB
     I              A1HENB                          WGHENB
     I              A1HFNB                          WGHFNB
     I              A1CYNB                          WGCYNB
     I              A1LRNB                          WGLRNB
     I              A1E0NB                          WGE0NB
     I              A1A5PC                          WGA5PC
     I              A1FBNB                          WGFBNB
     I              A1A4PC                          WGA4PC
     I              A1F7NB                          WGF7NB
     I              A1HDNB                          WGHDNB
     I              A1F5NB                          WGF5NB
     I              A1F4NB                          WGF4NB
     I              A1F3NB                          WGF3NB
     I              A1F2NB                          WGF2NB
     I              A1AVPC                          WGAVPC
     I              A1AWPC                          WGAWPC
     I              A1CWPC                          WGCWPC
     I              A1A8PC                          WGA8PC
     I              A1A7PC                          WGA7PC
     I              A1B8PR                          WGB8PR
     I              A1AMPR                          WGAMPR
     I              A1ANPR                          WGANPR
     I              A1AYVA                          WGAYVA
     I              A1AWVA                          WGAWVA
     I              A1AOPR                          WGAOPR
     I              A1AXVA                          WGAXVA
     I              A1APPR                          WGAPPR
     I              A1ASPR                          WGASPR
     I              A1A4VA                          WGA4VA
     I              A1ATPR                          WGATPR
     I              A1A5VA                          WGA5VA
     I              A1CBPR                          WGCBPR
     I              A1CCPR                          WGCCPR
     I              A1LPNB                          WGLPNB
     I              A1CDPR                          WGCDPR
     I              A1A7VA                          WGA7VA
     I              A1A2PR                          WGA2PR
     I              A1JWST                          WGJWST
     I              A1CWST                          WGCWST
     I              A1D7ST                          WGD7ST
     I              A1D8ST                          WGD8ST
     I              A1DWST                          WGDWST
     I              A1D6ST                          WGD6ST
     I              A1GHNB                          WGGHNB
     I              A1BYDT                          WGBYDT
     I              A1E0ST                          WGE0ST
     I              A1E1ST                          WGE1ST
     I              A1E2ST                          WGE2ST
     I              A1BSDT                          WGBSDT
     I              A1BTDT                          WGBTDT
     I              A1BUDT                          WGBUDT
     I              A1HGNB                          WGHGNB
     I              A1HHNB                          WGHHNB
     I              A1HINB                          WGHINB
     I              A1A3PR                          WGA3PR
     I              A1A4PR                          WGA4PR
     I              A1A6PR                          WGA6PR
     I              A1J9NB                          WGJ9NB
     I              A1D6PR                          WGD6PR
     I              A1D7PR                          WGD7PR
     I              A1D8PR                          WGD8PR
     I              A1D9PR                          WGD9PR
     I              A1EAPR                          WGEAPR
     I              A1EBPR                          WGEBPR
     I              A1ECPR                          WGECPR
     I              A1EDPR                          WGEDPR
     I              A1EEPR                          WGEEPR
     I              A1EFPR                          WGEFPR
     I              A1EGPR                          WGEGPR
     I              A1EHPR                          WGEHPR
     I              A1KAST                          WGKAST
     I              A1J7ST                          WGJ7ST
     I              A1J9ST                          WGJ9ST
     I              A1OXNB                          WGOXNB
     I              A1LKST                          WGLKST
     I              A1LLST                          WGLLST
     I              A1J8ST                          WGJ8ST
     I              A1LIST                          WGLIST
     I              A1LJST                          WGLJST
     I              A1NZTX                          WGNZTX
     I              A1HJCD                          WGHJCD
     I              A1R4ST                          WGR4ST
     I              A1R5ST                          WGR5ST
     I              A1R6ST                          WGR6ST
     I              A1R7ST                          WGR7ST
     I              A1THWT                          WGTHWT
     I              A1T2WT                          WGT2WT
     I              A1THHD                          WGTHHD
     I              A1T2HD                          WGT2HD
     I              A1OBPR                          WGOBPR
     I              A1KOER                          WGKOER
     I              A1OPIR                          WGOPIR
     I              A1OPEM                          WGOPEM
     I              A1IORP                          WGIORP
     I              A1OWEO                          WGOWEO
     I              A1OQET                          WGOQET
     I              A1URST                          WGURST
     I              A1USST                          WGUSST
     I              A1HHPC                          WGHHPC
     I              A1S9PR                          WGS9PR
     I              A1TAPR                          WGTAPR
     I              A1TBPR                          WGTBPR
     I              A1JFUR                          WGJFUR
     I              A1KRIF                          WGKRIF
     I              A1KORF                          WGKORF
     I              A1KAPR                          WGKAPR
     I              A1KROT                          WGKROT
     I              A1OTJG                          WGOTJG
     I              A1IRJG                          WGIRJG
     I              A1IMJF                          WGIMJF
     I              A1IRGF                          WGIRGF
     I              A1KRJF                          WGKRJF
     I              A1OJRF                          WGOJRF
     I              A1KFOR                          WGKFOR
     I              A1ORJK                          WGORJK
     I              A1OMVJ                          WGOMVJ
     I              A1MVNF                          WGMVNF
     I              A1MCNF                          WGMCNF
     I              A1NCNF                          WGNCNF
     I              A1NCHF                          WGNCHF
     I              A1IGIR                          WGIGIR
     I              A1KFJR                          WGKFJR
     I              A1EADT                          WGEADT
     I              A1EBDT                          WGEBDT
     I              A1ECDT                          WGECDT
     I              A1EDDT                          WGEDDT
     I              A1EEDT                          WGEEDT
     I              A1U4ST                          WGU4ST
     I              A1U5ST                          WGU5ST
     I              A1U6ST                          WGU6ST
     I              A1U7ST                          WGU7ST
     I              A1U8ST                          WGU8ST
     I              A1U9ST                          WGU9ST
     I              A1VAST                          WGVAST
     I              A1VBST                          WGVBST
     I              A1BDCD                          WGBDCD
     I              A1CSCD                          WGCSCD
     I              A1ABCD                          WGABCD
     I              A1AECD                          WGAECD
     I              A1ACCD                          WGACCD
     I              A1AGCD                          WGAGCD
     I              A1BECD                          WGBECD
     I              A1AAVN                          WGAAVN
     I              A1AADT                          WGAADT
     I              A1AMTM                          WGAMTM
     I              A1AJST                          WGAJST
     I              A1AHVN                          WGAHVN
     I              A1AGVN                          WGAGVN
     I              A1ABVN                          WGABVN
     I              A1ABDT                          WGABDT
     I              A1ABTM                          WGABTM
      *
     I@CDCPV4
      * Tattoo Ded/Add            Co/BOL, reimb hd>0
      * Renamed input format fields
     I              CDHMNB                          WHHMNB
     I              CDBNNB                          WHBNNB
     I              CDBONB                          WHBONB
     I              CDCVNB                          WHCVNB
     I              CDB0DT                          WHB0DT
     I              CDBQCD                          WHBQCD
     I              CDAZVA                          WHAZVA
     I              CDA0VA                          WHA0VA
     I              CDJBST                          WHJBST
     I              CDEIST                          WHEIST
     I              CDJDST                          WHJDST
     I              CDDPCD                          WHDPCD
     I              CDE3CD                          WHE3CD
     I              CDAQNB                          WHAQNB
     I              CDOCST                          WHOCST
     I              CDPEST                          WHPEST
     I              CDPFST                          WHPFST
     I              CDPGST                          WHPGST
     I              CDPIST                          WHPIST
     I              CDPJST                          WHPJST
     I              CDPKST                          WHPKST
     I              CDPLST                          WHPLST
     I              CDAAVN                          WHAAVN
     I              CDAADT                          WHAADT
     I              CDAMTM                          WHAMTM
     I              CDAJST                          WHAJST
     I              CDAHVN                          WHAHVN
     I              CDAGVN                          WHAGVN
     I              CDABVN                          WHABVN
     I              CDABDT                          WHABDT
     I              CDABTM                          WHABTM
      *
     I@A1CPC7
      * Tattoo Header             Retrieval Index 2
      * Renamed input format fields
     I              A1HMNB                          WIHMNB
     I              A1BNNB                          WIBNNB
     I              A1BONB                          WIBONB
     I              A1CVNB                          WICVNB
     I              A1B0DT                          WIB0DT
     I              A1AWDT                          WIAWDT
     I              A1BICD                          WIBICD
     I              A1CPST                          WICPST
     I              A1ACPR                          WIACPR
     I              A1B9PR                          WIB9PR
     I              A1CAPR                          WICAPR
     I              A1C4ST                          WIC4ST
     I              A1AIPR                          WIAIPR
     I              A1A6DT                          WIA6DT
     I              A1C2ST                          WIC2ST
     I              A1CXNB                          WICXNB
     I              A1CWNB                          WICWNB
     I              A1FCNB                          WIFCNB
     I              A1H9NB                          WIH9NB
     I              A1FDNB                          WIFDNB
     I              A1FENB                          WIFENB
     I              A1HENB                          WIHENB
     I              A1HFNB                          WIHFNB
     I              A1CYNB                          WICYNB
     I              A1LRNB                          WILRNB
     I              A1E0NB                          WIE0NB
     I              A1A5PC                          WIA5PC
     I              A1FBNB                          WIFBNB
     I              A1A4PC                          WIA4PC
     I              A1F7NB                          WIF7NB
     I              A1HDNB                          WIHDNB
     I              A1F5NB                          WIF5NB
     I              A1F4NB                          WIF4NB
     I              A1F3NB                          WIF3NB
     I              A1F2NB                          WIF2NB
     I              A1AVPC                          WIAVPC
     I              A1AWPC                          WIAWPC
     I              A1CWPC                          WICWPC
     I              A1A8PC                          WIA8PC
     I              A1A7PC                          WIA7PC
     I              A1B8PR                          WIB8PR
     I              A1AMPR                          WIAMPR
     I              A1ANPR                          WIANPR
     I              A1AYVA                          WIAYVA
     I              A1AWVA                          WIAWVA
     I              A1AOPR                          WIAOPR
     I              A1AXVA                          WIAXVA
     I              A1APPR                          WIAPPR
     I              A1ASPR                          WIASPR
     I              A1A4VA                          WIA4VA
     I              A1ATPR                          WIATPR
     I              A1A5VA                          WIA5VA
     I              A1CBPR                          WICBPR
     I              A1CCPR                          WICCPR
     I              A1LPNB                          WILPNB
     I              A1CDPR                          WICDPR
     I              A1A7VA                          WIA7VA
     I              A1A2PR                          WIA2PR
     I              A1JWST                          WIJWST
     I              A1CWST                          WICWST
     I              A1D7ST                          WID7ST
     I              A1D8ST                          WID8ST
     I              A1DWST                          WIDWST
     I              A1D6ST                          WID6ST
     I              A1GHNB                          WIGHNB
     I              A1BYDT                          WIBYDT
     I              A1E0ST                          WIE0ST
     I              A1E1ST                          WIE1ST
     I              A1E2ST                          WIE2ST
     I              A1BSDT                          WIBSDT
     I              A1BTDT                          WIBTDT
     I              A1BUDT                          WIBUDT
     I              A1HGNB                          WIHGNB
     I              A1HHNB                          WIHHNB
     I              A1HINB                          WIHINB
     I              A1A3PR                          WIA3PR
     I              A1A4PR                          WIA4PR
     I              A1A6PR                          WIA6PR
     I              A1J9NB                          WIJ9NB
     I              A1D6PR                          WID6PR
     I              A1D7PR                          WID7PR
     I              A1D8PR                          WID8PR
     I              A1D9PR                          WID9PR
     I              A1EAPR                          WIEAPR
     I              A1EBPR                          WIEBPR
     I              A1ECPR                          WIECPR
     I              A1EDPR                          WIEDPR
     I              A1EEPR                          WIEEPR
     I              A1EFPR                          WIEFPR
     I              A1EGPR                          WIEGPR
     I              A1EHPR                          WIEHPR
     I              A1KAST                          WIKAST
     I              A1J7ST                          WIJ7ST
     I              A1J9ST                          WIJ9ST
     I              A1OXNB                          WIOXNB
     I              A1LKST                          WILKST
     I              A1LLST                          WILLST
     I              A1J8ST                          WIJ8ST
     I              A1LIST                          WILIST
     I              A1LJST                          WILJST
     I              A1NZTX                          WINZTX
     I              A1HJCD                          WIHJCD
     I              A1R4ST                          WIR4ST
     I              A1R5ST                          WIR5ST
     I              A1R6ST                          WIR6ST
     I              A1R7ST                          WIR7ST
     I              A1THWT                          WITHWT
     I              A1T2WT                          WIT2WT
     I              A1THHD                          WITHHD
     I              A1T2HD                          WIT2HD
     I              A1OBPR                          WIOBPR
     I              A1KOER                          WIKOER
     I              A1OPIR                          WIOPIR
     I              A1OPEM                          WIOPEM
     I              A1IORP                          WIIORP
     I              A1OWEO                          WIOWEO
     I              A1OQET                          WIOQET
     I              A1URST                          WIURST
     I              A1USST                          WIUSST
     I              A1HHPC                          WIHHPC
     I              A1S9PR                          WIS9PR
     I              A1TAPR                          WITAPR
     I              A1TBPR                          WITBPR
     I              A1JFUR                          WIJFUR
     I              A1KRIF                          WIKRIF
     I              A1KORF                          WIKORF
     I              A1KAPR                          WIKAPR
     I              A1KROT                          WIKROT
     I              A1OTJG                          WIOTJG
     I              A1IRJG                          WIIRJG
     I              A1IMJF                          WIIMJF
     I              A1IRGF                          WIIRGF
     I              A1KRJF                          WIKRJF
     I              A1OJRF                          WIOJRF
     I              A1KFOR                          WIKFOR
     I              A1ORJK                          WIORJK
     I              A1OMVJ                          WIOMVJ
     I              A1MVNF                          WIMVNF
     I              A1MCNF                          WIMCNF
     I              A1NCNF                          WINCNF
     I              A1NCHF                          WINCHF
     I              A1IGIR                          WIIGIR
     I              A1KFJR                          WIKFJR
     I              A1EADT                          WIEADT
     I              A1EBDT                          WIEBDT
     I              A1ECDT                          WIECDT
     I              A1EDDT                          WIEDDT
     I              A1EEDT                          WIEEDT
     I              A1U4ST                          WIU4ST
     I              A1U5ST                          WIU5ST
     I              A1U6ST                          WIU6ST
     I              A1U7ST                          WIU7ST
     I              A1U8ST                          WIU8ST
     I              A1U9ST                          WIU9ST
     I              A1VAST                          WIVAST
     I              A1VBST                          WIVBST
     I              A1BDCD                          WIBDCD
     I              A1CSCD                          WICSCD
     I              A1ABCD                          WIABCD
     I              A1AECD                          WIAECD
     I              A1ACCD                          WIACCD
     I              A1AGCD                          WIAGCD
     I              A1BECD                          WIBECD
     I              A1AAVN                          WIAAVN
     I              A1AADT                          WIAADT
     I              A1AMTM                          WIAMTM
     I              A1AJST                          WIAJST
     I              A1AHVN                          WIAHVN
     I              A1AGVN                          WIAGVN
     I              A1ABVN                          WIABVN
     I              A1ABDT                          WIABDT
     I              A1ABTM                          WIABTM
      *
     I@AQCPA0
      * Producer Sub-Contract     Retrieval index
      * Renamed input format fields
     I              AQAKCD                          WJAKCD
     I              AQALCD                          WJALCD
     I              AQAHDT                          WJAHDT
     I              AQA2ST                          WJA2ST
     I              AQAZPR                          WJAZPR
     I              AQA0PR                          WJA0PR
     I              AQA9PC                          WJA9PC
     I              AQA7PR                          WJA7PR
     I              AQA8PR                          WJA8PR
     I              AQF3ST                          WJF3ST
     I              AQA9PR                          WJA9PR
     I              AQERCD                          WJERCD
     I              AQESCD                          WJESCD
     I              AQF6PR                          WJF6PR
     I              AQJ3TX                          WJJ3TX
     I              AQABCD                          WJABCD
     I              AQAECD                          WJAECD
     I              AQAGCD                          WJAGCD
     I              AQAICD                          WJAICD
     I              AQAMCD                          WJAMCD
     I              AQAAVN                          WJAAVN
     I              AQAADT                          WJAADT
     I              AQAMTM                          WJAMTM
     I              AQAJST                          WJAJST
     I              AQAHVN                          WJAHVN
     I              AQAGVN                          WJAGVN
     I              AQABVN                          WJABVN
     I              AQABDT                          WJABDT
     I              AQABTM                          WJABTM
      *
     I@ECCPAG
      * Producer SC Floor Price   Retrieval index
      * Renamed input format fields
     I              ECAKCD                          WKAKCD
     I              ECALCD                          WKALCD
     I              ECDJDT                          WKDJDT
     I              ECOCPR                          WKOCPR
     I              ECODPR                          WKODPR
     I              ECOEPR                          WKOEPR
     I              ECOFPR                          WKOFPR
     I              ECOGPR                          WKOGPR
     I              ECOHPR                          WKOHPR
     I              ECOIPR                          WKOIPR
      *
     I@EECPAP
      * Producer Cntrct RsvAct Hd Retrieval index
      * Renamed input format fields
     I              EEAKCD                          WLAKCD
     I              EEEJVA                          WLEJVA
     I              EEDLDT                          WLDLDT
     I              EEAAVN                          WLAAVN
     I              EEAADT                          WLAADT
     I              EEAMTM                          WLAMTM
     I              EEAJST                          WLAJST
     I              EEAHVN                          WLAHVN
     I              EEAGVN                          WLAGVN
     I              EEABVN                          WLABVN
     I              EEABDT                          WLABDT
     I              EEABTM                          WLABTM
      *
     I@CDCPIU
      * Tattoo Ded/Add            Retrieval index
      * Renamed input format fields
     I              CDHMNB                          WMHMNB
     I              CDBNNB                          WMBNNB
     I              CDBONB                          WMBONB
     I              CDCVNB                          WMCVNB
     I              CDB0DT                          WMB0DT
     I              CDBQCD                          WMBQCD
     I              CDAZVA                          WMAZVA
     I              CDA0VA                          WMA0VA
     I              CDJBST                          WMJBST
     I              CDEIST                          WMEIST
     I              CDJDST                          WMJDST
     I              CDDPCD                          WMDPCD
     I              CDE3CD                          WME3CD
     I              CDAQNB                          WMAQNB
     I              CDOCST                          WMOCST
     I              CDPEST                          WMPEST
     I              CDPFST                          WMPFST
     I              CDPGST                          WMPGST
     I              CDPIST                          WMPIST
     I              CDPJST                          WMPJST
     I              CDPKST                          WMPKST
     I              CDPLST                          WMPLST
     I              CDAAVN                          WMAAVN
     I              CDAADT                          WMAADT
     I              CDAMTM                          WMAMTM
     I              CDAJST                          WMAJST
     I              CDAHVN                          WMAHVN
     I              CDAGVN                          WMAGVN
     I              CDABVN                          WMABVN
     I              CDABDT                          WMABDT
     I              CDABTM                          WMABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPKCD1    E DSPKCDCPL0
      * UPD : Tattoo Ded/Add            Update index
      * Renamed input format fields
     I              CDHMNB                          WEHMNB
     I              CDBNNB                          WEBNNB
     I              CDBONB                          WEBONB
     I              CDCVNB                          WECVNB
     I              CDB0DT                          WEB0DT
     I              CDBQCD                          WEBQCD
     I              CDAZVA                          WEAZVA
     I              CDA0VA                          WEA0VA
     I              CDJBST                          WEJBST
     I              CDEIST                          WEEIST
     I              CDJDST                          WEJDST
     I              CDDPCD                          WEDPCD
     I              CDE3CD                          WEE3CD
     I              CDAQNB                          WEAQNB
     I              CDOCST                          WEOCST
     I              CDPEST                          WEPEST
     I              CDPFST                          WEPFST
     I              CDPGST                          WEPGST
     I              CDPIST                          WEPIST
     I              CDPJST                          WEPJST
     I              CDPKST                          WEPKST
     I              CDPLST                          WEPLST
     I              CDAAVN                          WEAAVN
     I              CDAADT                          WEAADT
     I              CDAMTM                          WEAMTM
     I              CDAJST                          WEAJST
     I              CDAHVN                          WEAHVN
     I              CDAGVN                          WEAGVN
     I              CDABVN                          WEABVN
     I              CDABDT                          WEABDT
     I              CDABTM                          WEABTM
      *
     IQPKA11    E DSPKA1CPL1
      * UPD : Tattoo Header             Update index
      * Renamed input format fields
     I              A1HMNB                          WGHMNB
     I              A1BNNB                          WGBNNB
     I              A1BONB                          WGBONB
     I              A1CVNB                          WGCVNB
     I              A1B0DT                          WGB0DT
     I              A1AWDT                          WGAWDT
     I              A1BICD                          WGBICD
     I              A1CPST                          WGCPST
     I              A1ACPR                          WGACPR
     I              A1B9PR                          WGB9PR
     I              A1CAPR                          WGCAPR
     I              A1C4ST                          WGC4ST
     I              A1AIPR                          WGAIPR
     I              A1A6DT                          WGA6DT
     I              A1C2ST                          WGC2ST
     I              A1CXNB                          WGCXNB
     I              A1CWNB                          WGCWNB
     I              A1FCNB                          WGFCNB
     I              A1H9NB                          WGH9NB
     I              A1FDNB                          WGFDNB
     I              A1FENB                          WGFENB
     I              A1HENB                          WGHENB
     I              A1HFNB                          WGHFNB
     I              A1CYNB                          WGCYNB
     I              A1LRNB                          WGLRNB
     I              A1E0NB                          WGE0NB
     I              A1A5PC                          WGA5PC
     I              A1FBNB                          WGFBNB
     I              A1A4PC                          WGA4PC
     I              A1F7NB                          WGF7NB
     I              A1HDNB                          WGHDNB
     I              A1F5NB                          WGF5NB
     I              A1F4NB                          WGF4NB
     I              A1F3NB                          WGF3NB
     I              A1F2NB                          WGF2NB
     I              A1AVPC                          WGAVPC
     I              A1AWPC                          WGAWPC
     I              A1CWPC                          WGCWPC
     I              A1A8PC                          WGA8PC
     I              A1A7PC                          WGA7PC
     I              A1B8PR                          WGB8PR
     I              A1AMPR                          WGAMPR
     I              A1ANPR                          WGANPR
     I              A1AYVA                          WGAYVA
     I              A1AWVA                          WGAWVA
     I              A1AOPR                          WGAOPR
     I              A1AXVA                          WGAXVA
     I              A1APPR                          WGAPPR
     I              A1ASPR                          WGASPR
     I              A1A4VA                          WGA4VA
     I              A1ATPR                          WGATPR
     I              A1A5VA                          WGA5VA
     I              A1CBPR                          WGCBPR
     I              A1CCPR                          WGCCPR
     I              A1LPNB                          WGLPNB
     I              A1CDPR                          WGCDPR
     I              A1A7VA                          WGA7VA
     I              A1A2PR                          WGA2PR
     I              A1JWST                          WGJWST
     I              A1CWST                          WGCWST
     I              A1D7ST                          WGD7ST
     I              A1D8ST                          WGD8ST
     I              A1DWST                          WGDWST
     I              A1D6ST                          WGD6ST
     I              A1GHNB                          WGGHNB
     I              A1BYDT                          WGBYDT
     I              A1E0ST                          WGE0ST
     I              A1E1ST                          WGE1ST
     I              A1E2ST                          WGE2ST
     I              A1BSDT                          WGBSDT
     I              A1BTDT                          WGBTDT
     I              A1BUDT                          WGBUDT
     I              A1HGNB                          WGHGNB
     I              A1HHNB                          WGHHNB
     I              A1HINB                          WGHINB
     I              A1A3PR                          WGA3PR
     I              A1A4PR                          WGA4PR
     I              A1A6PR                          WGA6PR
     I              A1J9NB                          WGJ9NB
     I              A1D6PR                          WGD6PR
     I              A1D7PR                          WGD7PR
     I              A1D8PR                          WGD8PR
     I              A1D9PR                          WGD9PR
     I              A1EAPR                          WGEAPR
     I              A1EBPR                          WGEBPR
     I              A1ECPR                          WGECPR
     I              A1EDPR                          WGEDPR
     I              A1EEPR                          WGEEPR
     I              A1EFPR                          WGEFPR
     I              A1EGPR                          WGEGPR
     I              A1EHPR                          WGEHPR
     I              A1KAST                          WGKAST
     I              A1J7ST                          WGJ7ST
     I              A1J9ST                          WGJ9ST
     I              A1OXNB                          WGOXNB
     I              A1LKST                          WGLKST
     I              A1LLST                          WGLLST
     I              A1J8ST                          WGJ8ST
     I              A1LIST                          WGLIST
     I              A1LJST                          WGLJST
     I              A1NZTX                          WGNZTX
     I              A1HJCD                          WGHJCD
     I              A1R4ST                          WGR4ST
     I              A1R5ST                          WGR5ST
     I              A1R6ST                          WGR6ST
     I              A1R7ST                          WGR7ST
     I              A1THWT                          WGTHWT
     I              A1T2WT                          WGT2WT
     I              A1THHD                          WGTHHD
     I              A1T2HD                          WGT2HD
     I              A1OBPR                          WGOBPR
     I              A1KOER                          WGKOER
     I              A1OPIR                          WGOPIR
     I              A1OPEM                          WGOPEM
     I              A1IORP                          WGIORP
     I              A1OWEO                          WGOWEO
     I              A1OQET                          WGOQET
     I              A1URST                          WGURST
     I              A1USST                          WGUSST
     I              A1HHPC                          WGHHPC
     I              A1S9PR                          WGS9PR
     I              A1TAPR                          WGTAPR
     I              A1TBPR                          WGTBPR
     I              A1JFUR                          WGJFUR
     I              A1KRIF                          WGKRIF
     I              A1KORF                          WGKORF
     I              A1KAPR                          WGKAPR
     I              A1KROT                          WGKROT
     I              A1OTJG                          WGOTJG
     I              A1IRJG                          WGIRJG
     I              A1IMJF                          WGIMJF
     I              A1IRGF                          WGIRGF
     I              A1KRJF                          WGKRJF
     I              A1OJRF                          WGOJRF
     I              A1KFOR                          WGKFOR
     I              A1ORJK                          WGORJK
     I              A1OMVJ                          WGOMVJ
     I              A1MVNF                          WGMVNF
     I              A1MCNF                          WGMCNF
     I              A1NCNF                          WGNCNF
     I              A1NCHF                          WGNCHF
     I              A1IGIR                          WGIGIR
     I              A1KFJR                          WGKFJR
     I              A1EADT                          WGEADT
     I              A1EBDT                          WGEBDT
     I              A1ECDT                          WGECDT
     I              A1EDDT                          WGEDDT
     I              A1EEDT                          WGEEDT
     I              A1U4ST                          WGU4ST
     I              A1U5ST                          WGU5ST
     I              A1U6ST                          WGU6ST
     I              A1U7ST                          WGU7ST
     I              A1U8ST                          WGU8ST
     I              A1U9ST                          WGU9ST
     I              A1VAST                          WGVAST
     I              A1VBST                          WGVBST
     I              A1BDCD                          WGBDCD
     I              A1CSCD                          WGCSCD
     I              A1ABCD                          WGABCD
     I              A1AECD                          WGAECD
     I              A1ACCD                          WGACCD
     I              A1AGCD                          WGAGCD
     I              A1BECD                          WGBECD
     I              A1AAVN                          WGAAVN
     I              A1AADT                          WGAADT
     I              A1AMTM                          WGAMTM
     I              A1AJST                          WGAJST
     I              A1AHVN                          WGAHVN
     I              A1AGVN                          WGAGVN
     I              A1ABVN                          WGABVN
     I              A1ABDT                          WGABDT
     I              A1ABTM                          WGABTM
      *
     IYARDCS      DS                            583
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IYBRDCS      DS                            583
     IYCRDCS      DS                            583
     IYDRDCS      DS                            583
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Tattoo Header
      * I :  BOH Company Number
     I                                    P   1   20P1HMNB
      * N :  TH Source Type
     I                                        3   3 P1KAST
     IP2PARM      DS
      * I :  Date From USR
     I                                    P   1   40P2B3DT
     IP3PARM      DS
      * I :  Date To   USR
     I                                    P   1   40P3B4DT
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HMNB    PARM           WP0001  30       BOH Company Num
     C           P2B3DT    PARM           WP0002  70       Date From USR
     C           P3B4DT    PARM           WP0003  70       Date To   USR
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Utl Clc Internal NPPC XF
      * Modifications and Comments
     C                     EXSR UASUBR                     Modifications a
     C                     MOVEL'I'       P1KAST           TH Source Type
      * Utl Clc Internal NPPC RT - Tattoo Header  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Utl Clc Internal NPPC RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHMNB    WQSA01           BOH Company Num
     C           *LIKE     DEFN WAKAST    WQSA02           TH Source Type
      * Define keylist
     C           KPSSA     KLIST
     C                     KFLD           WQSA01           BOH Company Num
     C                     KFLD           WQSA02           TH Source Type
     C                     KFLD           WAB0DT           TH Kill Date
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           BOH Company Num
     C                     KFLD           WQSA02           TH Source Type
      * Setup key
     C                     Z-ADDP1HMNB    WQSA01           BOH Company Num
     C                     MOVELP1KAST    WQSA02           TH Source Type
     C                     Z-ADDP2B3DT    WAB0DT           TH Kill Date
      * Establish starting position
     C           KPSSA     SETLL@A1CPQ2                    *
     C           KRSSA     READE@A1CPQ2                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.TH Kill Date GT PAR.Date To   USR
     C           WAB0DT    IFGT P3B4DT                     *IF
     C                     GOTO SAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * Calculate NPPC
      * CASE: DB1.TH Hog Class Type is Resale
     C           WALLST    IFEQ 'R'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Set Live Gross and Payment Gross to Zeros and all net's to zero
     C                     EXSR UBSUBR                     Set Live Gross
      * Create d/a
      * MILES = zero
      * Clc a Tattoo Prod D/A RT - Producer Std D/A  * 
     C                     EXSR SBRVGN
      * Accumulate
      * Rtv Tattoo Hdr Totls RT - Tattoo Ded/Add  * 
     C                     EXSR SYRVGN
     C           WACBPR    SUB  WUASPR    WUA4VA           TH Total Net WO
     C           WACBPR    ADD  WUA5VA    WUCCPR           Th Payment Net
     C                     SUB  WUASPR    WUCCPR           Th Payment Net
      * Calculate either live net or carcass net
      * CASE: DB1.TH Payment Sts is Live Payment
     C           WACWST    IFEQ 'ML'                       *IF
     C           WACWST    OREQ 'SL'
     C           WACWST    OREQ 'IL'
     C           WACWST    OREQ 'NL'
      * Calculate net amount for live payment
     C           WAB9PR    ADD  WUA5VA    WUCAPR           TH LIve Net Amt
     C                     SUB  WUASPR    WUCAPR           TH LIve Net Amt
      * Paying live if market hog will have carcass merit totals
      * CASE: DB1.TH Hog Class Type is Market
     C           WALLST    IFEQ 'M'                        *IF
     C           WAAPPR    ADD  WUA5VA    WUATPR           TH Carcass Net
     C                     SUB  WUASPR    WUATPR           TH Carcass Net
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.TH Payment Sts is Carcass Merit Payment
     C           WACWST    IFEQ 'SC'                       *IF
     C           WACWST    OREQ 'IC'
      * Calculate net amount for carcass merit fields
      * and total without adds
     C           WAAPPR    ADD  WUA5VA    WUATPR           TH Carcass Net
     C                     SUB  WUASPR    WUATPR           TH Carcass Net
     C                     END                             *FI
     C                     END                             *FI
      * Chg Tto Ded/Add/Net   CH - Tattoo Header  * 
     C                     EXSR SZCHRC
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSA     READE@A1CPQ2                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Clc a Tattoo Prod D/A RT - Producer Std D/A  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBABCD    WQSB01           PD Producer Cod
     C           *LIKE     DEFN WBZCA1    WQSB02           PSDP Company Nu
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           PD Producer Cod
     C                     KFLD           WQSB02           PSDP Company Nu
      * Setup key
     C                     MOVELWAABCD    WQSB01           PD Producer Cod
     C                     Z-ADDP1HMNB    WQSB02           PSDP Company Nu
      * Establish starting position
     C           KRSSB     SETLL@BERELS                    *
     C           KRSSB     READE@BERELS                  90*
      * Data record not found
     C   90                MOVEL'PRK0087' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Date 03/24/2004 slm - Add logic for TFM Release 01 for all Ded/Ad
      *                       to verify the accept date and the decline d
      *                       before the creations of the D/A
     C                     MOVEL'Y'       WUYUST           Process Flag Us
     C                     Z-ADD*ZERO     WUE9NB           Zero USR
      * CASE: DB1.PSD Accept Date GT WRK.Zero USR
     C           WBC0DT    IFGT WUE9NB                     *IF
      * CASE: PAR.TH Purchase Date LT DB1.PSD Accept Date
     C           WAAWDT    IFLT WBC0DT                     *IF
     C                     MOVEL'N'       WUYUST           Process Flag Us
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DB1.PSD Decline Date GT WRK.Zero USR
     C           WBC1DT    IFGT WUE9NB                     *IF
      * CASE: PAR.TH Purchase Date GT DB1.PSD Decline Date
     C           WAAWDT    IFGT WBC1DT                     *IF
     C                     MOVEL'N'       WUYUST           Process Flag Us
     C                     END                             *FI
     C                     END                             *FI
      * CASE: WRK.Process Flag User is Yes
     C           WUYUST    IFEQ 'Y'                        *IF
      * Clc Prd Ded/Add       Rt - Deduction/Addition  * 
     C                     EXSR SCRVGN
     C                     END                             *FI
     C           KRSSB     READE@BERELS                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Clc Prd Ded/Add       Rt - Deduction/Addition  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  72       Var Net Pay Usr
     C                     Z-ADD*ZERO     WN0002  52       Tot Cost Live C
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCBQCD           DED D/A Code
      * Setup key
     C                     MOVELWBBQCD    WCBQCD           DED D/A Code
      * Establish starting position
     C           KRSSC     CHAIN@BBRELJ              90    *
      * Data record not found
     C   90                MOVEL'PRK0081' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * HPE063 Frt Exp/Accruals
      * 2/26/96  HPE063   Allow the expense for freight to be paid
      *                   by either Seaboard(us) or the producer
      *                   Allow the system to process accruals thru
      *                   the General Ledger.
     C                     MOVEL'N'       WUMXST           Record was sele
      * Valid selection on weither to create the record
      * CASE:
      *  - c1 AND (c2 OR c3)
      *   |- c1    : DB1.DED Plant Deduction is Not Yes
      *   |- c2    : DB1.DED Fix/Var/Sys is Fixed
      *   |- c3    : DB1.DED Fix/Var/Sys is Variable
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCI2ST    IFEQ *BLANK                     *IF
     C           WCI2ST    OREQ 'N'
     C                     MOVEL'0'       Y0CX02  1
     C           WCB9ST    IFEQ 'F'                        *IF
     C           WCB9ST    OREQ 'V'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE:
      *  - (c1 AND c2) OR (c3 AND c4) OR (c5 AND c6)
      *   |- c1    : PAR.TH Hog Class Type is Resale
      *   |- c2    : DB1.DED Include Resale is Yes
      *   |- c3    : PAR.TH Hog Class Type is Market
      *   |- c4    : DB1.DED Include Market is Yes
      *   |- c5    : PAR.TH Hog Class Type is Subject
      *   |- c6    : DB1.DED Include Subject is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WALLST    IFEQ 'R'                        *IF
     C           WCNSST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WALLST    IFEQ 'M'                        *IF
     C           WCNUST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WALLST    IFEQ 'S'                        *IF
     C           WCNTST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUMXST           Record was sele
     C                     END                             *FI
     C                     END                             *FI
      * 41404 slm add PC Contract code and PSC subcontract code
      * Rtv Buy Order Type - Buy Order Header  * 
     C                     EXSR SDRVGN
      * Validate to create tattoo ded/add based on Buy Order Type
      * CASE: WRK.Record was selected usr is *YES
     C           WUMXST    IFEQ 'Y'                        *IF
      * CASE: WRK.BOH Buy Order Type is Contract
     C           WUA5ST    IFEQ 'C'                        *IF
      * CASE: DB1.DED Valid BO Type is Contract List
     C           WCNZST    IFEQ 'C'                        *IF
     C           WCNZST    OREQ '1'
     C           WCNZST    OREQ '2'
     C           WCNZST    OREQ *BLANK
      * Still the value of Yes
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUMXST           Record was sele
     C                     END                             *FI
     C                     ELSE
      * CASE: WRK.BOH Buy Order Type is Internal
     C           WUA5ST    IFEQ 'I'                        *IF
      * CASE: DB1.DED Valid BO Type is Internal List
     C           WCNZST    IFEQ '1'                        *IF
     C           WCNZST    OREQ *BLANK
     C           WCNZST    OREQ 'I'
     C           WCNZST    OREQ '3'
      * Still the value of Yes
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUMXST           Record was sele
     C                     END                             *FI
     C                     ELSE
      * CASE: WRK.BOH Buy Order Type is Open Market
     C           WUA5ST    IFEQ 'O'                        *IF
      * CASE: DB1.DED Valid BO Type is Open List
     C           WCNZST    IFEQ '2'                        *IF
     C           WCNZST    OREQ *BLANK
     C           WCNZST    OREQ 'O'
     C           WCNZST    OREQ '3'
      * Still the value of Yes
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUMXST           Record was sele
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Create the Tattoo Ded/Add
      * CASE: WRK.Record was selected usr is *YES
     C           WUMXST    IFEQ 'Y'                        *IF
     C                     MOVEL'O'       WUPFST           THD Expense Typ
     C                     MOVEL'N'       WUPIST           THD Commission
      * CASE: DB1.DED Commission Deduction is Yes
     C           WCN1ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUPIST           THD Commission
     C                     END                             *FI
     C                     MOVELWBN2ST    WUPEST           THD Expense Pai
      * CASE: DB1.DED Fix/Var/Sys is Fixed
     C           WCB9ST    IFEQ 'F'                        *IF
      * Clc UOM Extension     IF
      * Extension
      * CASE: PAR.Trans UOM USR is Flat
     C           WCCAST    IFEQ 'FL'                       *IF
      * * * * * *   FLAT    * * * * *
      * FLAT
      * CASE: PAR.Trans UOM USR is Flat
     C           WCCAST    IFEQ 'FL'                       *IF
     C           WCAEPR    MULT 1         WUCFPR           Trans Extended
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Head UOM
     C           WCCAST    IFEQ 'DH'                       *IF
     C           WCCAST    OREQ 'RH'
     C           WCCAST    OREQ 'YH'
     C           WCCAST    OREQ 'CH'
     C           WCCAST    OREQ 'KH'
     C           WCCAST    OREQ 'NH'
     C           WCCAST    OREQ 'DY'
     C           WCCAST    OREQ 'RX'
     C           WCCAST    OREQ 'HM'
     C           WCCAST    OREQ 'DE'
      * * * * * *    HEAD   * * * * *
      * HEAD
      * CASE: PAR.Trans UOM USR is Received Head
     C           WCCAST    IFEQ 'RH'                       *IF
     C           WACWNB    MULT WCAEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Received Hd less Yard Dd
     C           WCCAST    IFEQ 'RX'                       *IF
     C           WACWNB    SUB  WAFCNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WCAEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Killed Head
     C           WCCAST    IFEQ 'KH'                       *IF
     C           WAFENB    MULT WCAEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Condemned Head
     C           WCCAST    IFEQ 'CH'                       *IF
     C           WAFDNB    MULT WCAEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Yard Deads Head
     C           WCCAST    IFEQ 'YH'                       *IF
     C           WAFCNB    MULT WCAEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA Head
     C           WCCAST    IFEQ 'DH'                       *IF
     C           WACXNB    MULT WCAEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Net Head
     C           WCCAST    IFEQ 'NH'                       *IF
     C                     Z-ADDWACWNB    WUF6NB           Net Head Usr
     C                     SUB  WAFCNB    WUF6NB           Net Head Usr
     C                     SUB  WAFDNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WCAEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA Head + Yard Dead Head
     C           WCCAST    IFEQ 'DY'                       *IF
     C           WACXNB    ADD  WAFCNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WCAEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA HD + Yard Dead + EUT
     C           WCCAST    IFEQ 'DE'                       *IF
     C           WACXNB    ADD  WAFCNB    WUF6NB           Net Head Usr
     C                     ADD  WAEDDT    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WCAEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Received Head /100 Miles
     C           WCCAST    IFEQ 'HM'                       *IF
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (x1 * x2 * (x3/x4))
      * x1    : PAR.PSM Miles to Company
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Head Killed
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x4    : CON.100
     C           *ZERO     MULT WAFENB    W0WA01           *Synon (15,2) w
     C           WCAEPR    DIV  100       W0WB02    H      *Synon (15,5) w
     C           W0WA01    MULT W0WB02    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Weight UOM
     C           WCCAST    IFEQ 'CW'                       *IF
     C           WCCAST    OREQ 'LW'
     C           WCCAST    OREQ 'NL'
     C           WCCAST    OREQ 'SW'
     C           WCCAST    OREQ 'LX'
     C           WCCAST    OREQ 'SX'
      * * * * * *    WEIGHT   * * * * *
      * WEIGHT
      * CASE: PAR.Trans UOM USR is Live Hundred Weight
     C           WCCAST    IFEQ 'LW'                       *IF
      * Live hundred wgt
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Live Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WACYNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WCAEPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is LW less Yard Dead Wgt
     C           WCCAST    IFEQ 'LX'                       *IF
      *  Calc wgt of yard dead based on Th avg live wgt
     C           WAF7NB    MULT WAFCNB    WUCCNB           Yard dead weigh
      *   Subtract Yard Dead wgt from Live Wgt
     C           WACYNB    SUB  WUCCNB    WUOONB           Live Weight
      * Live hundred wgt less Yd
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Live Weight           USR
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUOONB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WCAEPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Carcass Hundred Weight
     C           WCCAST    IFEQ 'CW'                       *IF
      * Carcass Hundred Wgt
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WAE0NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WCAEPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Net Live Weight
     C           WCCAST    IFEQ 'NL'                       *IF
     C                     Z-ADDWACWNB    WUF6NB           Net Head Usr
     C                     SUB  WAFCNB    WUF6NB           Net Head Usr
     C                     SUB  WAFDNB    WUF6NB           Net Head Usr
      * * Insert avg live weight
     C           WUF6NB    MULT WAF7NB    WUVBNB           Net Live Weight
      * Net Live Weight
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Net Live Weight Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUVBNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WCAEPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Shipped Weight - Doa's
     C           WCCAST    IFEQ 'SW'                       *IF
      *   Calc Avg shipped wgt, then calc wgt of DOA'S
      * This rule was defined on 01/14/97
      * The Calculations for Avg Shipped Weights are
      * Head Received should be the live hogs that walk across the scale
      * Doa's should be the hogs that died either after we collected
      *       or before we weighed them
      * Avg Shipped Weight : Shipped Weight /(Head Received + Doa's)
     C           WACWNB    ADD  WACXNB    WUEXNB           Hd Cnt Org Ship
      * CASE: WRK.Hd Cnt Org Ship Usr is *Zeros
     C           WUEXNB    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WUY9NB           Avg Weight USR
     C                     ELSE
      * CASE: *OTHERWISE
     C           WAHGNB    DIV  WUEXNB    WUY9NB           Avg Weight USR
     C                     END                             *FI
     C           WUY9NB    MULT WACXNB    WUEVNB           Doa's Avg Weigh
      *   Subtract doa's from Shipped Wgt
     C           WAHGNB    SUB  WUEVNB    WUZ4NB           Ship Wgt Tot Us
      * Shipped Weight Total Ext
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Ship Wgt Tot Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUZ4NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WCAEPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is SW - Doa's WT - Yrd Dd WT
     C           WCCAST    IFEQ 'SX'                       *IF
      *   Calc Avg shipped wgt, then calc wgt of DOA'S and Yard Deads
      * This rule was defined on 01/14/97
      * The Calculations for Avg Shipped Weights are
      * Head Received should be the live hogs that walk across the scale
      * Doa's should be the hogs that died either after we collected
      *       or before we weighed them
      * Avg Shipped Weight : Shipped Weight /(Head Received + Doa's)
     C           WACWNB    ADD  WACXNB    WUEXNB           Hd Cnt Org Ship
      * CASE: WRK.Hd Cnt Org Ship Usr is *Zeros
     C           WUEXNB    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WUY9NB           Avg Weight USR
     C                     ELSE
      * CASE: *OTHERWISE
     C           WAHGNB    DIV  WUEXNB    WUY9NB           Avg Weight USR
     C                     END                             *FI
     C           WUY9NB    MULT WAFCNB    WUCCNB           Yard dead weigh
     C           WUY9NB    MULT WACXNB    WUEVNB           Doa's Avg Weigh
      *   Subtract Doa's and Subtract Yard Dead wgt from Shipped Wgt
     C           WAHGNB    SUB  WUEVNB    WUZ4NB           Ship Wgt Tot Us
     C                     SUB  WUCCNB    WUZ4NB           Ship Wgt Tot Us
      * Shipped wgt less Yd
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Ship Wgt Tot Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUZ4NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WCAEPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Value UOM
     C           WCCAST    IFEQ 'GV'                       *IF
     C           WCCAST    OREQ 'BD'
      * * * * * *    VALUE    * * * * *
      * VALUE
      * CASE: PAR.Trans UOM USR is Gross Hundred Value
     C           WCCAST    IFEQ 'GV'                       *IF
      * Gross Hundred Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Payment Gross
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUCBPR    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WCAEPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Carcass Hundred Weight
     C           WCCAST    IFEQ 'CW'                       *IF
      * Carcass Hundred Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WAE0NB    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WCAEPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Base Market Dollars
     C           WCCAST    IFEQ 'BD'                       *IF
      * Clc Base Mkt Dollars  XF - STR Unit of Measure Calc  * 
     C                     CALL 'PKBSE01'              90  Clc Base Mkt Do
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAHMNB    WQ0001  30       BOH Company Num
     C                     PARM WAAWDT    WQ0002  70       TH Purchase Dat
     C                     PARM WACYNB    WQ0003  71       TH Live Wgt
     C                     PARM WCBQCD    WQ0004  5        DED D/A Code
     C           WUCSPR    PARM *ZERO     WQ0005  92       Base Mkt Prc Am
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKBSE01' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Base Mkt Prc Amt Tot USR GE WRK.Zero USR
     C           WUCSPR    IFGE WUE9NB                     *IF
      * Base Market Dollars
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Base Mkt Prc Amt Tot USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUCSPR    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WCAEPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Percent UOM
     C           WCCAST    IFEQ *BLANK                     *IF
      * * * * * *    PERCENT   * * * * *
      * PERCENT
      * CASE: PAR.Trans UOM USR is Percent of Gross Value
     C           WCCAST    IFEQ *BLANK                     *IF
      * Percent of Gross Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.Trans Unit Amt Usr
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.TH Payment Gross
     C           WCAEPR    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WUCBPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: WRK.Trans Extended Amt Usr is Not Zeros
     C           WUCFPR    IFNE 0                          *IF
      * Date 03/24/2004 Slm -- Update the Deferred Payment in place of Bl
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR SECRRC
      * CASE: WRK.THD Commission Deduction is Yes
     C           WUPIST    IFEQ 'Y'                        *IF
      * Rtv/Chg Commission StsRT - Tattoo Header  * 
     C                     EXSR SFRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.DED Fix/Var/Sys is Variable
     C           WCB9ST    IFEQ 'V'                        *IF
      * Create the D/A for Special Proc and Normal Proc
      * CASE: DB1.DED Prdcr Special Proc NE WRK.Blank USR
     C           WCNXST    IFNE WUCRTX                     *IF
      *
     C                     MOVEL*BLANK    WN0158  2        Pricing UOM USR
      *
      * Clc D/A f/Prdcr Spcl  IF
      * Insurance Reimbursement Hd calculation
      * CASE: PAR.DED Prdcr Special Proc is Insurance Reimbursement
     C           WCNXST    IFEQ 'I'                        *IF
      * Retrieve Reimb. hd total for paid tattoos on the BOL
      * Rtv BOL Reimb hd sum  RT - Tattoo Ded/Add  * 
     C                     EXSR SHRVGN
     C                     Z-ADD*ZERO     WUDENB           Re-imbursement
     C                     Z-ADD*ZERO     WULLPR           Re-imbursement
     C                     Z-ADD*ZERO     WUDWNB           Re-imbursement
      * Move the correct head into work field to calc head to be paid ful
      * CASE: PAR.PSD Variable UOM is Head UOM
     C           WBEVST    IFEQ 'DH'                       *IF
     C           WBEVST    OREQ 'RH'
     C           WBEVST    OREQ 'YH'
     C           WBEVST    OREQ 'CH'
     C           WBEVST    OREQ 'KH'
     C           WBEVST    OREQ 'NH'
     C           WBEVST    OREQ 'DY'
     C           WBEVST    OREQ 'RX'
     C           WBEVST    OREQ 'HM'
     C           WBEVST    OREQ 'DE'
      * CASE: PAR.PSD Variable UOM is Condemned Head
     C           WBEVST    IFEQ 'CH'                       *IF
     C                     Z-ADDWAFDNB    WUDENB           Re-imbursement
     C                     ELSE
      * CASE: PAR.PSD Variable UOM is DOA Head
     C           WBEVST    IFEQ 'DH'                       *IF
     C                     Z-ADDWACXNB    WUDENB           Re-imbursement
     C                     ELSE
      * CASE: PAR.PSD Variable UOM is Yard Deads Head
     C           WBEVST    IFEQ 'YH'                       *IF
     C                     Z-ADDWAFCNB    WUDENB           Re-imbursement
     C                     ELSE
      * CASE: PAR.PSD Variable UOM is DOA Head + Yard Dead Head
     C           WBEVST    IFEQ 'DY'                       *IF
     C           WAFCNB    ADD  WACXNB    WUDENB           Re-imbursement
     C                     ELSE
      * CASE: PAR.PSD Variable UOM is DOA HD + Yard Dead + EUT
     C           WBEVST    IFEQ 'DE'                       *IF
     C           WAFCNB    ADD  WACXNB    WUDENB           Re-imbursement
     C                     ADD  WAEDDT    WUDENB           Re-imbursement
     C                     ELSE
      * CASE: PAR.PSD Variable UOM is Killed Head
     C           WBEVST    IFEQ 'KH'                       *IF
     C                     Z-ADDWAFENB    WUDENB           Re-imbursement
     C                     ELSE
      * CASE: PAR.PSD Variable UOM is Net Head
     C           WBEVST    IFEQ 'NH'                       *IF
     C                     Z-ADDWACWNB    WUF6NB           Net Head Usr
     C                     SUB  WAFCNB    WUF6NB           Net Head Usr
     C                     SUB  WAFDNB    WUF6NB           Net Head Usr
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Move the correct Price and Wgt into work fields
      * CASE: PAR.THD Payment Sts is Live anything
     C           WACWST    IFEQ 'ML'                       *IF
     C           WACWST    OREQ 'PL'
     C           WACWST    OREQ 'NL'
     C           WACWST    OREQ 'SL'
     C           WACWST    OREQ 'IL'
     C                     Z-ADDWAACPR    WULLPR           Re-imbursement
      * CASE: PAR.TH Live Purchase UOM is Shipped Weight List
     C           WACPST    IFEQ 'SW'                       *IF
     C           WACPST    OREQ 'SX'
      * This rule was defined on 01/14/97
      * The Calculations for Avg Shipped Weights are
      * Head Received should be the live hogs that walk across the scale
      * Doa's should be the hogs that died either after we collected
      *       or before we weighed them
      * Avg Shipped Weight : Shipped Weight /(Head Received + Doa's)
     C           WACWNB    ADD  WACXNB    WUEXNB           Hd Cnt Org Ship
      * CASE: WRK.Hd Cnt Org Ship Usr is Not Zero
     C           WUEXNB    IFNE 0                          *IF
     C           WAHGNB    DIV  WUEXNB    WUDWNB           Re-imbursement
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWAF7NB    WUDWNB           Re-imbursement
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.THD Payment Sts is Carcass anything
     C           WACWST    IFEQ 'PC'                       *IF
     C           WACWST    OREQ 'NC'
     C           WACWST    OREQ 'SC'
     C           WACWST    OREQ 'IC'
     C                     Z-ADDWAF7NB    WUDWNB           Re-imbursement
      *
     C                     MOVEL*BLANK    WN0159  3        BOH Commodity M
     C                     MOVEL*BLANK    WN0160  7        BOH Commodity P
      *
      * Rtv comm grp/OMS Uom   IF
      * Rtv Comm/Group        RT - Buy Order Header  * 
     C                     EXSR SIRVGN
      * Rtv Commod Group U/M  XF - STR Order Management Sys  * 
     C                     CALL 'PDUVXFR'              90  Rtv Commod Grou
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0160    WQ0006  7        BOH Commodity P
     C           WN0158    PARM *BLANK    WQ0007  2        Pricing UOM USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDUVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PAR.Pricing UOM USR is Carcass Hundred Weight
     C           WN0158    IFEQ 'CW'                       *IF
      * Convert the Meat price to a Live Price
     C           .74       MULT WAAMPR    WULLPR           Re-imbursement
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWAAMPR    WULLPR           Re-imbursement
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Calculate if there are Head and the limit hasnt already been reac
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Re-imbursement hd NEW USR is Greater than 0
      *   |- c2    : WRK.Re-imbursement head totl is Less than upper limi
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUDENB    IFGT 0                          *IF
     C           WUDDNB    IFLT 4                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD*ZERO     WUDFNB           Re-imbursement
     C                     Z-ADD*ZERO     WUDGNB           Re-imbursement
     C                     Z-ADD*ZERO     WUCFPR           Trans Extended
     C                     Z-ADD*ZERO     WUCEPR           Trans Unit Amt
      * Reduce the Tattoos head count as head are accumed either full or
      * DO WHILE: WRK.Re-imbursement hd NEW USR is Greater than 0
     C           WUDENB    DOWGT0                          *DOW
     C                     SUB  1         WUDENB           Re-imbursement
     C                     ADD  1         WUDDNB           Re-imbursement
      * Accum hd to be paid full and head to be paid half value.
      * CASE: WRK.Re-imbursement head totl is Less than/eq full limit 2
     C           WUDDNB    IFLE 4                          *IF
     C                     ADD  1         WUDFNB           Re-imbursement
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.Re-imbursement head totl is Less than/eq half limit 4
     C           WUDDNB    IFLE 0                          *IF
     C                     ADD  1         WUDGNB           Re-imbursement
     C                     ELSE
      * CASE: *OTHERWISE
      * Fall-out because the limit has been reached.
     C                     Z-ADD*ZERO     WUDENB           Re-imbursement
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *ITR
      * CASE: WRK.Re-imbursement full   USR is Greater than 0
     C           WUDFNB    IFGT 0                          *IF
      * Compute: Paid Full value
      * WRK.Trans Extended Amt Usr =
      *    *COMPUTE ((x1 * (x2 / x3)) * x4)
      * x1    : WRK.Re-imbursement Price  USR
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : WRK.Re-imbursement Wgt    USR
      * /     : PGM.*Synon (15,2) work field *
      * x3    : CON.100
      * *     : PGM.*Synon (15,2) work field *
      * x4    : WRK.Re-imbursement full   USR
     C           WUDWNB    DIV  100       W0WA02           *Synon (15,2) w
     C           WULLPR    MULT W0WA02    W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WUDFNB    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     END                             *FI
      * CASE: WRK.Re-imbursement half   USR is Greater than 0
     C           WUDGNB    IFGT 0                          *IF
      * Compute: Paid Half value
      * WRK.Trans Unit Amt Usr =
      *    *COMPUTE (((x1 * (x2 / x3)) / x5) * x4)
      * x1    : WRK.Re-imbursement Price  USR
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : WRK.Re-imbursement Wgt    USR
      * /     : PGM.*Synon (15,2) work field *
      * x3    : CON.100
      * /     : PGM.*Synon (15,2) work field *
      * x5    : CON.2
      * *     : PGM.*Synon (15,2) work field *
      * x4    : WRK.Re-imbursement half   USR
     C           WUDWNB    DIV  100       W0WA03           *Synon (15,2) w
     C           WULLPR    MULT W0WA03    W0WA02    H      *Synon (15,2) w
     C           W0WA02    DIV  2         W0WA01           *Synon (15,2) w
     C           W0WA01    MULT WUDGNB    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCEPR           Trans Unit Amt
      * Add calc'd half value to calc'd full value
     C                     ADD  WUCEPR    WUCFPR           Trans Extended
     C                     END                             *FI
      * Add calc'd half hd & calc'd full hd  to total re-imb hd for new r
     C           WUDFNB    ADD  WUDGNB    WUAQNB           THD Re-imbursem
      * CASE: WRK.Trans Extended Amt Usr NE WRK.Zero USR
     C           WUCFPR    IFNE WUE9NB                     *IF
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR SJCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.DED Prdcr Special Proc is Yard Dead Reimbursement
     C           WCNXST    IFEQ 'Y'                        *IF
      * If the Tattoo is hold over.
      * CASE:
      *  - c2 AND c3
      *   |- c2    : PAR.TH Held Over Record is Yes
      *   |- c3    : PAR.TH Yard Deads is Not Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAE1ST    IFEQ 'Y'                        *IF
     C           WAFCNB    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Held Over KillDts RT - Tattoo Header  * 
     C                     EXSR SKRVGN
      * LCL.Held Over Days USR = PAR.TH Kill Date - LCL.Kill Date Usr *DA
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C           YL0001    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           WAB0DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     YL0002
     C                     ELSE
     C           XDURR     MULT -1        YL0002
     C                     END
      * CASE: LCL.Held Over Days USR is GT 1
     C           YL0002    IFGT 1                          *IF
      * Do not send in miles, this is yard reim.
      * Clc UOM Extension     IF
      * Extension
      * CASE: PAR.Trans UOM USR is Flat
     C           WBEVST    IFEQ 'FL'                       *IF
      * * * * * *   FLAT    * * * * *
      * FLAT
      * CASE: PAR.Trans UOM USR is Flat
     C           WBEVST    IFEQ 'FL'                       *IF
     C           WATAPR    MULT 1         YL0003           Trans Extended
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Head UOM
     C           WBEVST    IFEQ 'DH'                       *IF
     C           WBEVST    OREQ 'RH'
     C           WBEVST    OREQ 'YH'
     C           WBEVST    OREQ 'CH'
     C           WBEVST    OREQ 'KH'
     C           WBEVST    OREQ 'NH'
     C           WBEVST    OREQ 'DY'
     C           WBEVST    OREQ 'RX'
     C           WBEVST    OREQ 'HM'
     C           WBEVST    OREQ 'DE'
      * * * * * *    HEAD   * * * * *
      * HEAD
      * CASE: PAR.Trans UOM USR is Received Head
     C           WBEVST    IFEQ 'RH'                       *IF
     C           WACWNB    MULT WATAPR    YL0003           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Received Hd less Yard Dd
     C           WBEVST    IFEQ 'RX'                       *IF
     C           WACWNB    SUB  WAFCNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WATAPR    YL0003           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Killed Head
     C           WBEVST    IFEQ 'KH'                       *IF
     C           WAFENB    MULT WATAPR    YL0003           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Condemned Head
     C           WBEVST    IFEQ 'CH'                       *IF
     C           WAFDNB    MULT WATAPR    YL0003           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Yard Deads Head
     C           WBEVST    IFEQ 'YH'                       *IF
     C           WAFCNB    MULT WATAPR    YL0003           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA Head
     C           WBEVST    IFEQ 'DH'                       *IF
     C           WACXNB    MULT WATAPR    YL0003           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Net Head
     C           WBEVST    IFEQ 'NH'                       *IF
     C                     Z-ADDWACWNB    WUF6NB           Net Head Usr
     C                     SUB  WAFCNB    WUF6NB           Net Head Usr
     C                     SUB  WAFDNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WATAPR    YL0003           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA Head + Yard Dead Head
     C           WBEVST    IFEQ 'DY'                       *IF
     C           WACXNB    ADD  WAFCNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WATAPR    YL0003           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA HD + Yard Dead + EUT
     C           WBEVST    IFEQ 'DE'                       *IF
     C           WACXNB    ADD  WAFCNB    WUF6NB           Net Head Usr
     C                     ADD  WAEDDT    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WATAPR    YL0003           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Received Head /100 Miles
     C           WBEVST    IFEQ 'HM'                       *IF
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (x1 * x2 * (x3/x4))
      * x1    : PAR.PSM Miles to Company
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Head Killed
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x4    : CON.100
     C           *ZERO     MULT WAFENB    W0WA01           *Synon (15,2) w
     C           WATAPR    DIV  100       W0WB02    H      *Synon (15,5) w
     C           W0WA01    MULT W0WB02    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0003           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Weight UOM
     C           WBEVST    IFEQ 'CW'                       *IF
     C           WBEVST    OREQ 'LW'
     C           WBEVST    OREQ 'NL'
     C           WBEVST    OREQ 'SW'
     C           WBEVST    OREQ 'LX'
     C           WBEVST    OREQ 'SX'
      * * * * * *    WEIGHT   * * * * *
      * WEIGHT
      * CASE: PAR.Trans UOM USR is Live Hundred Weight
     C           WBEVST    IFEQ 'LW'                       *IF
      * Live hundred wgt
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Live Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WACYNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WATAPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0003           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is LW less Yard Dead Wgt
     C           WBEVST    IFEQ 'LX'                       *IF
      *  Calc wgt of yard dead based on Th avg live wgt
     C           WAF7NB    MULT WAFCNB    WUCCNB           Yard dead weigh
      *   Subtract Yard Dead wgt from Live Wgt
     C           WACYNB    SUB  WUCCNB    WUOONB           Live Weight
      * Live hundred wgt less Yd
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Live Weight           USR
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUOONB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WATAPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0003           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Carcass Hundred Weight
     C           WBEVST    IFEQ 'CW'                       *IF
      * Carcass Hundred Wgt
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WAE0NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WATAPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0003           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Net Live Weight
     C           WBEVST    IFEQ 'NL'                       *IF
     C                     Z-ADDWACWNB    WUF6NB           Net Head Usr
     C                     SUB  WAFCNB    WUF6NB           Net Head Usr
     C                     SUB  WAFDNB    WUF6NB           Net Head Usr
      * * Insert avg live weight
     C           WUF6NB    MULT WAF7NB    WUVBNB           Net Live Weight
      * Net Live Weight
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Net Live Weight Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUVBNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WATAPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0003           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Shipped Weight - Doa's
     C           WBEVST    IFEQ 'SW'                       *IF
      *   Calc Avg shipped wgt, then calc wgt of DOA'S
      * This rule was defined on 01/14/97
      * The Calculations for Avg Shipped Weights are
      * Head Received should be the live hogs that walk across the scale
      * Doa's should be the hogs that died either after we collected
      *       or before we weighed them
      * Avg Shipped Weight : Shipped Weight /(Head Received + Doa's)
     C           WACWNB    ADD  WACXNB    WUEXNB           Hd Cnt Org Ship
      * CASE: WRK.Hd Cnt Org Ship Usr is *Zeros
     C           WUEXNB    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WUY9NB           Avg Weight USR
     C                     ELSE
      * CASE: *OTHERWISE
     C           WAHGNB    DIV  WUEXNB    WUY9NB           Avg Weight USR
     C                     END                             *FI
     C           WUY9NB    MULT WACXNB    WUEVNB           Doa's Avg Weigh
      *   Subtract doa's from Shipped Wgt
     C           WAHGNB    SUB  WUEVNB    WUZ4NB           Ship Wgt Tot Us
      * Shipped Weight Total Ext
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Ship Wgt Tot Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUZ4NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WATAPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0003           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is SW - Doa's WT - Yrd Dd WT
     C           WBEVST    IFEQ 'SX'                       *IF
      *   Calc Avg shipped wgt, then calc wgt of DOA'S and Yard Deads
      * This rule was defined on 01/14/97
      * The Calculations for Avg Shipped Weights are
      * Head Received should be the live hogs that walk across the scale
      * Doa's should be the hogs that died either after we collected
      *       or before we weighed them
      * Avg Shipped Weight : Shipped Weight /(Head Received + Doa's)
     C           WACWNB    ADD  WACXNB    WUEXNB           Hd Cnt Org Ship
      * CASE: WRK.Hd Cnt Org Ship Usr is *Zeros
     C           WUEXNB    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WUY9NB           Avg Weight USR
     C                     ELSE
      * CASE: *OTHERWISE
     C           WAHGNB    DIV  WUEXNB    WUY9NB           Avg Weight USR
     C                     END                             *FI
     C           WUY9NB    MULT WAFCNB    WUCCNB           Yard dead weigh
     C           WUY9NB    MULT WACXNB    WUEVNB           Doa's Avg Weigh
      *   Subtract Doa's and Subtract Yard Dead wgt from Shipped Wgt
     C           WAHGNB    SUB  WUEVNB    WUZ4NB           Ship Wgt Tot Us
     C                     SUB  WUCCNB    WUZ4NB           Ship Wgt Tot Us
      * Shipped wgt less Yd
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Ship Wgt Tot Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUZ4NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WATAPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0003           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Value UOM
     C           WBEVST    IFEQ 'GV'                       *IF
     C           WBEVST    OREQ 'BD'
      * * * * * *    VALUE    * * * * *
      * VALUE
      * CASE: PAR.Trans UOM USR is Gross Hundred Value
     C           WBEVST    IFEQ 'GV'                       *IF
      * Gross Hundred Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Payment Gross
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUCBPR    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WATAPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0003           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Carcass Hundred Weight
     C           WBEVST    IFEQ 'CW'                       *IF
      * Carcass Hundred Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WAE0NB    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WATAPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0003           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Base Market Dollars
     C           WBEVST    IFEQ 'BD'                       *IF
      * Clc Base Mkt Dollars  XF - STR Unit of Measure Calc  * 
     C                     CALL 'PKBSE01'              90  Clc Base Mkt Do
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAHMNB    WQ0008  30       BOH Company Num
     C                     PARM WAAWDT    WQ0009  70       TH Purchase Dat
     C                     PARM WACYNB    WQ0010  71       TH Live Wgt
     C                     PARM WCBQCD    WQ0011  5        DED D/A Code
     C           WUCSPR    PARM *ZERO     WQ0012  92       Base Mkt Prc Am
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKBSE01' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Base Mkt Prc Amt Tot USR GE WRK.Zero USR
     C           WUCSPR    IFGE WUE9NB                     *IF
      * Base Market Dollars
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Base Mkt Prc Amt Tot USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUCSPR    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WATAPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0003           Trans Extended
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0003           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Percent UOM
     C           WBEVST    IFEQ *BLANK                     *IF
      * * * * * *    PERCENT   * * * * *
      * PERCENT
      * CASE: PAR.Trans UOM USR is Percent of Gross Value
     C           WBEVST    IFEQ *BLANK                     *IF
      * Percent of Gross Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.Trans Unit Amt Usr
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.TH Payment Gross
     C           WATAPR    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WUCBPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0003           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: LCL.Trans Extended Amt Usr NE WRK.Zero USR
     C           YL0003    IFNE WUE9NB                     *IF
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR SLCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.DED Prdcr Special Proc is Deferred Payment
     C           WCNXST    IFEQ 'D'                        *IF
      * 41404 slm add for deferred payment TFM
      * Retrieve BREAK EVEN % from producer sub contract
      * Rtv PurchPrc Clc BrkEORT - Producer Sub-Contract  * 
     C                     EXSR SMRVGN
     C                     Z-ADD*ZERO     WUU5PR           Deferred Price
      * Deferred Price
      * WRK.Deferred Price Usr =
      *    *COMPUTE (x4 - (x1 * (x2 / x3)))
      * x4    : PAR.TH CM Base Mkt Price
      * -     : PGM.*Synon (15,2) work field
      * x1    : PAR.TH CM Market Price
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : WRK.PSC Break Even Percent
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WUA7PR    DIV  100       W0WB02    H      *Synon (15,5) w
     C           WAB8PR    MULT W0WB02    W0WA01    H      *Synon (15,2) w
     C           WAAMPR    SUB  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WUU5PR           Deferred Price
     C                     Z-ADDWUU5PR    WUCEPR           Trans Unit Amt
      * PLD miles = zero
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) WAEDDT' defaulted for 'TH Head EUT/KOA'.
      * Clc UOM Extension     IF
      * Extension
      * CASE: PAR.Trans UOM USR is Flat
     C           WBEVST    IFEQ 'FL'                       *IF
      * * * * * *   FLAT    * * * * *
      * FLAT
      * CASE: PAR.Trans UOM USR is Flat
     C           WBEVST    IFEQ 'FL'                       *IF
     C           WUCEPR    MULT 1         WUCFPR           Trans Extended
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Head UOM
     C           WBEVST    IFEQ 'DH'                       *IF
     C           WBEVST    OREQ 'RH'
     C           WBEVST    OREQ 'YH'
     C           WBEVST    OREQ 'CH'
     C           WBEVST    OREQ 'KH'
     C           WBEVST    OREQ 'NH'
     C           WBEVST    OREQ 'DY'
     C           WBEVST    OREQ 'RX'
     C           WBEVST    OREQ 'HM'
     C           WBEVST    OREQ 'DE'
      * * * * * *    HEAD   * * * * *
      * HEAD
      * CASE: PAR.Trans UOM USR is Received Head
     C           WBEVST    IFEQ 'RH'                       *IF
     C           WACWNB    MULT WUCEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Received Hd less Yard Dd
     C           WBEVST    IFEQ 'RX'                       *IF
     C           WACWNB    SUB  WAFCNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WUCEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Killed Head
     C           WBEVST    IFEQ 'KH'                       *IF
     C           WAFENB    MULT WUCEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Condemned Head
     C           WBEVST    IFEQ 'CH'                       *IF
     C           WAFDNB    MULT WUCEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Yard Deads Head
     C           WBEVST    IFEQ 'YH'                       *IF
     C           WAFCNB    MULT WUCEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA Head
     C           WBEVST    IFEQ 'DH'                       *IF
     C           WACXNB    MULT WUCEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Net Head
     C           WBEVST    IFEQ 'NH'                       *IF
     C                     Z-ADDWACWNB    WUF6NB           Net Head Usr
     C                     SUB  WAFCNB    WUF6NB           Net Head Usr
     C                     SUB  WAFDNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WUCEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA Head + Yard Dead Head
     C           WBEVST    IFEQ 'DY'                       *IF
     C           WACXNB    ADD  WAFCNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WUCEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA HD + Yard Dead + EUT
     C           WBEVST    IFEQ 'DE'                       *IF
     C           WACXNB    ADD  WAFCNB    WUF6NB           Net Head Usr
     C                     ADD  WAEDDT    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WUCEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Received Head /100 Miles
     C           WBEVST    IFEQ 'HM'                       *IF
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (x1 * x2 * (x3/x4))
      * x1    : PAR.PSM Miles to Company
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Head Killed
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x4    : CON.100
     C           *ZERO     MULT WAFENB    W0WA01           *Synon (15,2) w
     C           WUCEPR    DIV  100       W0WB02    H      *Synon (15,5) w
     C           W0WA01    MULT W0WB02    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Weight UOM
     C           WBEVST    IFEQ 'CW'                       *IF
     C           WBEVST    OREQ 'LW'
     C           WBEVST    OREQ 'NL'
     C           WBEVST    OREQ 'SW'
     C           WBEVST    OREQ 'LX'
     C           WBEVST    OREQ 'SX'
      * * * * * *    WEIGHT   * * * * *
      * WEIGHT
      * CASE: PAR.Trans UOM USR is Live Hundred Weight
     C           WBEVST    IFEQ 'LW'                       *IF
      * Live hundred wgt
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Live Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WACYNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WUCEPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is LW less Yard Dead Wgt
     C           WBEVST    IFEQ 'LX'                       *IF
      *  Calc wgt of yard dead based on Th avg live wgt
     C           WAF7NB    MULT WAFCNB    WUCCNB           Yard dead weigh
      *   Subtract Yard Dead wgt from Live Wgt
     C           WACYNB    SUB  WUCCNB    WUOONB           Live Weight
      * Live hundred wgt less Yd
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Live Weight           USR
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUOONB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WUCEPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Carcass Hundred Weight
     C           WBEVST    IFEQ 'CW'                       *IF
      * Carcass Hundred Wgt
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WAE0NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WUCEPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Net Live Weight
     C           WBEVST    IFEQ 'NL'                       *IF
     C                     Z-ADDWACWNB    WUF6NB           Net Head Usr
     C                     SUB  WAFCNB    WUF6NB           Net Head Usr
     C                     SUB  WAFDNB    WUF6NB           Net Head Usr
      * * Insert avg live weight
     C           WUF6NB    MULT WAF7NB    WUVBNB           Net Live Weight
      * Net Live Weight
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Net Live Weight Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUVBNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WUCEPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Shipped Weight - Doa's
     C           WBEVST    IFEQ 'SW'                       *IF
      *   Calc Avg shipped wgt, then calc wgt of DOA'S
      * This rule was defined on 01/14/97
      * The Calculations for Avg Shipped Weights are
      * Head Received should be the live hogs that walk across the scale
      * Doa's should be the hogs that died either after we collected
      *       or before we weighed them
      * Avg Shipped Weight : Shipped Weight /(Head Received + Doa's)
     C           WACWNB    ADD  WACXNB    WUEXNB           Hd Cnt Org Ship
      * CASE: WRK.Hd Cnt Org Ship Usr is *Zeros
     C           WUEXNB    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WUY9NB           Avg Weight USR
     C                     ELSE
      * CASE: *OTHERWISE
     C           WAHGNB    DIV  WUEXNB    WUY9NB           Avg Weight USR
     C                     END                             *FI
     C           WUY9NB    MULT WACXNB    WUEVNB           Doa's Avg Weigh
      *   Subtract doa's from Shipped Wgt
     C           WAHGNB    SUB  WUEVNB    WUZ4NB           Ship Wgt Tot Us
      * Shipped Weight Total Ext
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Ship Wgt Tot Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUZ4NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WUCEPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is SW - Doa's WT - Yrd Dd WT
     C           WBEVST    IFEQ 'SX'                       *IF
      *   Calc Avg shipped wgt, then calc wgt of DOA'S and Yard Deads
      * This rule was defined on 01/14/97
      * The Calculations for Avg Shipped Weights are
      * Head Received should be the live hogs that walk across the scale
      * Doa's should be the hogs that died either after we collected
      *       or before we weighed them
      * Avg Shipped Weight : Shipped Weight /(Head Received + Doa's)
     C           WACWNB    ADD  WACXNB    WUEXNB           Hd Cnt Org Ship
      * CASE: WRK.Hd Cnt Org Ship Usr is *Zeros
     C           WUEXNB    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WUY9NB           Avg Weight USR
     C                     ELSE
      * CASE: *OTHERWISE
     C           WAHGNB    DIV  WUEXNB    WUY9NB           Avg Weight USR
     C                     END                             *FI
     C           WUY9NB    MULT WAFCNB    WUCCNB           Yard dead weigh
     C           WUY9NB    MULT WACXNB    WUEVNB           Doa's Avg Weigh
      *   Subtract Doa's and Subtract Yard Dead wgt from Shipped Wgt
     C           WAHGNB    SUB  WUEVNB    WUZ4NB           Ship Wgt Tot Us
     C                     SUB  WUCCNB    WUZ4NB           Ship Wgt Tot Us
      * Shipped wgt less Yd
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Ship Wgt Tot Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUZ4NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WUCEPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Value UOM
     C           WBEVST    IFEQ 'GV'                       *IF
     C           WBEVST    OREQ 'BD'
      * * * * * *    VALUE    * * * * *
      * VALUE
      * CASE: PAR.Trans UOM USR is Gross Hundred Value
     C           WBEVST    IFEQ 'GV'                       *IF
      * Gross Hundred Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Payment Gross
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUCBPR    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WUCEPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Carcass Hundred Weight
     C           WBEVST    IFEQ 'CW'                       *IF
      * Carcass Hundred Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WAE0NB    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WUCEPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Base Market Dollars
     C           WBEVST    IFEQ 'BD'                       *IF
      * Clc Base Mkt Dollars  XF - STR Unit of Measure Calc  * 
     C                     CALL 'PKBSE01'              90  Clc Base Mkt Do
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAHMNB    WQ0013  30       BOH Company Num
     C                     PARM WAAWDT    WQ0014  70       TH Purchase Dat
     C                     PARM WACYNB    WQ0015  71       TH Live Wgt
     C                     PARM WCBQCD    WQ0016  5        DED D/A Code
     C           WUCSPR    PARM *ZERO     WQ0017  92       Base Mkt Prc Am
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKBSE01' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Base Mkt Prc Amt Tot USR GE WRK.Zero USR
     C           WUCSPR    IFGE WUE9NB                     *IF
      * Base Market Dollars
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Base Mkt Prc Amt Tot USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUCSPR    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WUCEPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Percent UOM
     C           WBEVST    IFEQ *BLANK                     *IF
      * * * * * *    PERCENT   * * * * *
      * PERCENT
      * CASE: PAR.Trans UOM USR is Percent of Gross Value
     C           WBEVST    IFEQ *BLANK                     *IF
      * Percent of Gross Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.Trans Unit Amt Usr
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.TH Payment Gross
     C           WUCEPR    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WUCBPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: WRK.Trans Extended Amt Usr NE WRK.Zero USR
     C           WUCFPR    IFNE WUE9NB                     *IF
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR SNCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.DED Reserve Account Upd is Yes
     C           WCNWST    IFEQ 'Y'                        *IF
      * CASE: PAR.TH Payment Type is Live
     C           WAJ9ST    IFEQ 'L'                        *IF
     C                     Z-ADDWAACPR    WN0002           Tot Cost Live C
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWAEGPR    WN0002           Tot Cost Live C
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0161  52       PSC FLoor Price
     C                     MOVEL*BLANK    WN0162  1        PSC Sub-Contrac
     C                     Z-ADD*ZERO     WN0163  70       PFP Week Ending
     C                     Z-ADD*ZERO     WN0164  52       PFP Adjusted Fl
     C                     MOVEL*BLANK    WN0165  5        PC Contract Cod
     C                     MOVEL*BLANK    WN0166  5        PSC Sub-Contrac
     C                     MOVEL*BLANK    WN0167  1        Balance Exists
      *
      * Clc Reserve Amount    IF
     C                     Z-ADD*ZERO     WN0001           Var Net Pay Usr
      * Rtv Sub-Contract Type RT - Buy Order Header  * 
     C                     EXSR SORVGN
      * Rtv Prior Sunday      XF - STR Order Management Sys  * 
     C                     CALL 'PDLNXFR'              90  Rtv Prior Sunda
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAHMNB    WQ0018  30       Company Number
     C                     PARM WAAWDT    WQ0019  70       Kill Date Usr
     C           WN0163    PARM *ZERO     WQ0020  70       Date USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDLNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * RTV Floor Price       RT - Producer SC Floor Price  * 
     C                     EXSR SQRVGN
      * Val Reserv Acct Exists RT - Producer Cntrct RsvAct Hd  * 
     C                     EXSR SRRVGN
      * Calculate the unit price
      * CASE: PAR.Balance Exists USR is Yes
     C           WN0167    IFEQ 'Y'                        *IF
     C           WN0164    ADD  WN0161    W0WA             *Synon (15,2) w
      * Determine unit price if there is a reserve account balance
      * CASE: PAR.TH CM Gross Live /CWT GT PGM.*Synon (15,2) work field
     C           WN0002    IFGT W0WA                       *IF
     C                     Z-ADDW0WA      WN0001           Var Net Pay Usr
     C                     ELSE
      * CASE: PAR.TH CM Gross Live /CWT GT PAR.PFP Adjusted Floor Price
     C           WN0002    IFGT WN0164                     *IF
     C                     Z-ADDWN0002    WN0001           Var Net Pay Usr
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWN0164    WN0001           Var Net Pay Usr
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Determine unit price if there is no reserve account balance
      * CASE: PAR.TH CM Gross Live /CWT GT PAR.PFP Adjusted Floor Price
     C           WN0002    IFGT WN0164                     *IF
     C                     Z-ADDWN0002    WN0001           Var Net Pay Usr
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWN0164    WN0001           Var Net Pay Usr
     C                     END                             *FI
     C                     END                             *FI
     C                     SUB  WN0002    WN0001           Var Net Pay Usr
      * Clc UOM Extension     IF
      * Extension
      * CASE: PAR.Trans UOM USR is Flat
     C           WBEVST    IFEQ 'FL'                       *IF
      * * * * * *   FLAT    * * * * *
      * FLAT
      * CASE: PAR.Trans UOM USR is Flat
     C           WBEVST    IFEQ 'FL'                       *IF
     C           WN0001    MULT 1         WUCFPR           Trans Extended
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Head UOM
     C           WBEVST    IFEQ 'DH'                       *IF
     C           WBEVST    OREQ 'RH'
     C           WBEVST    OREQ 'YH'
     C           WBEVST    OREQ 'CH'
     C           WBEVST    OREQ 'KH'
     C           WBEVST    OREQ 'NH'
     C           WBEVST    OREQ 'DY'
     C           WBEVST    OREQ 'RX'
     C           WBEVST    OREQ 'HM'
     C           WBEVST    OREQ 'DE'
      * * * * * *    HEAD   * * * * *
      * HEAD
      * CASE: PAR.Trans UOM USR is Received Head
     C           WBEVST    IFEQ 'RH'                       *IF
     C           WACWNB    MULT WN0001    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Received Hd less Yard Dd
     C           WBEVST    IFEQ 'RX'                       *IF
     C           WACWNB    SUB  WAFCNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WN0001    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Killed Head
     C           WBEVST    IFEQ 'KH'                       *IF
     C           WAFENB    MULT WN0001    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Condemned Head
     C           WBEVST    IFEQ 'CH'                       *IF
     C           WAFDNB    MULT WN0001    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Yard Deads Head
     C           WBEVST    IFEQ 'YH'                       *IF
     C           WAFCNB    MULT WN0001    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA Head
     C           WBEVST    IFEQ 'DH'                       *IF
     C           WACXNB    MULT WN0001    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Net Head
     C           WBEVST    IFEQ 'NH'                       *IF
     C                     Z-ADDWACWNB    WUF6NB           Net Head Usr
     C                     SUB  WAFCNB    WUF6NB           Net Head Usr
     C                     SUB  WAFDNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WN0001    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA Head + Yard Dead Head
     C           WBEVST    IFEQ 'DY'                       *IF
     C           WACXNB    ADD  WAFCNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WN0001    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA HD + Yard Dead + EUT
     C           WBEVST    IFEQ 'DE'                       *IF
     C           WACXNB    ADD  WAFCNB    WUF6NB           Net Head Usr
     C                     ADD  WAEDDT    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WN0001    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Received Head /100 Miles
     C           WBEVST    IFEQ 'HM'                       *IF
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (x1 * x2 * (x3/x4))
      * x1    : PAR.PSM Miles to Company
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Head Killed
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x4    : CON.100
     C           *ZERO     MULT WAFENB    W0WA01           *Synon (15,2) w
     C           WN0001    DIV  100       W0WB02    H      *Synon (15,5) w
     C           W0WA01    MULT W0WB02    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Weight UOM
     C           WBEVST    IFEQ 'CW'                       *IF
     C           WBEVST    OREQ 'LW'
     C           WBEVST    OREQ 'NL'
     C           WBEVST    OREQ 'SW'
     C           WBEVST    OREQ 'LX'
     C           WBEVST    OREQ 'SX'
      * * * * * *    WEIGHT   * * * * *
      * WEIGHT
      * CASE: PAR.Trans UOM USR is Live Hundred Weight
     C           WBEVST    IFEQ 'LW'                       *IF
      * Live hundred wgt
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Live Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WACYNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WN0001    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is LW less Yard Dead Wgt
     C           WBEVST    IFEQ 'LX'                       *IF
      *  Calc wgt of yard dead based on Th avg live wgt
     C           WAF7NB    MULT WAFCNB    WUCCNB           Yard dead weigh
      *   Subtract Yard Dead wgt from Live Wgt
     C           WACYNB    SUB  WUCCNB    WUOONB           Live Weight
      * Live hundred wgt less Yd
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Live Weight           USR
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUOONB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WN0001    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Carcass Hundred Weight
     C           WBEVST    IFEQ 'CW'                       *IF
      * Carcass Hundred Wgt
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WAE0NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WN0001    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Net Live Weight
     C           WBEVST    IFEQ 'NL'                       *IF
     C                     Z-ADDWACWNB    WUF6NB           Net Head Usr
     C                     SUB  WAFCNB    WUF6NB           Net Head Usr
     C                     SUB  WAFDNB    WUF6NB           Net Head Usr
      * * Insert avg live weight
     C           WUF6NB    MULT WAF7NB    WUVBNB           Net Live Weight
      * Net Live Weight
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Net Live Weight Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUVBNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WN0001    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Shipped Weight - Doa's
     C           WBEVST    IFEQ 'SW'                       *IF
      *   Calc Avg shipped wgt, then calc wgt of DOA'S
      * This rule was defined on 01/14/97
      * The Calculations for Avg Shipped Weights are
      * Head Received should be the live hogs that walk across the scale
      * Doa's should be the hogs that died either after we collected
      *       or before we weighed them
      * Avg Shipped Weight : Shipped Weight /(Head Received + Doa's)
     C           WACWNB    ADD  WACXNB    WUEXNB           Hd Cnt Org Ship
      * CASE: WRK.Hd Cnt Org Ship Usr is *Zeros
     C           WUEXNB    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WUY9NB           Avg Weight USR
     C                     ELSE
      * CASE: *OTHERWISE
     C           WAHGNB    DIV  WUEXNB    WUY9NB           Avg Weight USR
     C                     END                             *FI
     C           WUY9NB    MULT WACXNB    WUEVNB           Doa's Avg Weigh
      *   Subtract doa's from Shipped Wgt
     C           WAHGNB    SUB  WUEVNB    WUZ4NB           Ship Wgt Tot Us
      * Shipped Weight Total Ext
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Ship Wgt Tot Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUZ4NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WN0001    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is SW - Doa's WT - Yrd Dd WT
     C           WBEVST    IFEQ 'SX'                       *IF
      *   Calc Avg shipped wgt, then calc wgt of DOA'S and Yard Deads
      * This rule was defined on 01/14/97
      * The Calculations for Avg Shipped Weights are
      * Head Received should be the live hogs that walk across the scale
      * Doa's should be the hogs that died either after we collected
      *       or before we weighed them
      * Avg Shipped Weight : Shipped Weight /(Head Received + Doa's)
     C           WACWNB    ADD  WACXNB    WUEXNB           Hd Cnt Org Ship
      * CASE: WRK.Hd Cnt Org Ship Usr is *Zeros
     C           WUEXNB    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WUY9NB           Avg Weight USR
     C                     ELSE
      * CASE: *OTHERWISE
     C           WAHGNB    DIV  WUEXNB    WUY9NB           Avg Weight USR
     C                     END                             *FI
     C           WUY9NB    MULT WAFCNB    WUCCNB           Yard dead weigh
     C           WUY9NB    MULT WACXNB    WUEVNB           Doa's Avg Weigh
      *   Subtract Doa's and Subtract Yard Dead wgt from Shipped Wgt
     C           WAHGNB    SUB  WUEVNB    WUZ4NB           Ship Wgt Tot Us
     C                     SUB  WUCCNB    WUZ4NB           Ship Wgt Tot Us
      * Shipped wgt less Yd
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Ship Wgt Tot Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUZ4NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WN0001    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Value UOM
     C           WBEVST    IFEQ 'GV'                       *IF
     C           WBEVST    OREQ 'BD'
      * * * * * *    VALUE    * * * * *
      * VALUE
      * CASE: PAR.Trans UOM USR is Gross Hundred Value
     C           WBEVST    IFEQ 'GV'                       *IF
      * Gross Hundred Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Payment Gross
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUCBPR    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WN0001    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Carcass Hundred Weight
     C           WBEVST    IFEQ 'CW'                       *IF
      * Carcass Hundred Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WAE0NB    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WN0001    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Base Market Dollars
     C           WBEVST    IFEQ 'BD'                       *IF
      * Clc Base Mkt Dollars  XF - STR Unit of Measure Calc  * 
     C                     CALL 'PKBSE01'              90  Clc Base Mkt Do
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAHMNB    WQ0021  30       BOH Company Num
     C                     PARM WAAWDT    WQ0022  70       TH Purchase Dat
     C                     PARM WACYNB    WQ0023  71       TH Live Wgt
     C                     PARM WCBQCD    WQ0024  5        DED D/A Code
     C           WUCSPR    PARM *ZERO     WQ0025  92       Base Mkt Prc Am
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKBSE01' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Base Mkt Prc Amt Tot USR GE WRK.Zero USR
     C           WUCSPR    IFGE WUE9NB                     *IF
      * Base Market Dollars
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Base Mkt Prc Amt Tot USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUCSPR    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WN0001    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Percent UOM
     C           WBEVST    IFEQ *BLANK                     *IF
      * * * * * *    PERCENT   * * * * *
      * PERCENT
      * CASE: PAR.Trans UOM USR is Percent of Gross Value
     C           WBEVST    IFEQ *BLANK                     *IF
      * Percent of Gross Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.Trans Unit Amt Usr
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.TH Payment Gross
     C           WN0001    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WUCBPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: WRK.Trans Extended Amt Usr NE WRK.Zero USR
     C           WUCFPR    IFNE WUE9NB                     *IF
      * Date 03/24/2004 Slm -- Update the Deferred Payment in place of Bl
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR SSCRRC
      * CASE: WRK.THD Commission Deduction is Yes
     C           WUPIST    IFEQ 'Y'                        *IF
      * Rtv/Chg Commission StsRT - Tattoo Header  * 
     C                     EXSR STRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Normal processing for the d/a code
      * Clc UOM Extension     IF
      * Extension
      * CASE: PAR.Trans UOM USR is Flat
     C           WBEVST    IFEQ 'FL'                       *IF
      * * * * * *   FLAT    * * * * *
      * FLAT
      * CASE: PAR.Trans UOM USR is Flat
     C           WBEVST    IFEQ 'FL'                       *IF
     C           WBA1VA    MULT 1         WUCFPR           Trans Extended
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Head UOM
     C           WBEVST    IFEQ 'DH'                       *IF
     C           WBEVST    OREQ 'RH'
     C           WBEVST    OREQ 'YH'
     C           WBEVST    OREQ 'CH'
     C           WBEVST    OREQ 'KH'
     C           WBEVST    OREQ 'NH'
     C           WBEVST    OREQ 'DY'
     C           WBEVST    OREQ 'RX'
     C           WBEVST    OREQ 'HM'
     C           WBEVST    OREQ 'DE'
      * * * * * *    HEAD   * * * * *
      * HEAD
      * CASE: PAR.Trans UOM USR is Received Head
     C           WBEVST    IFEQ 'RH'                       *IF
     C           WACWNB    MULT WBA1VA    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Received Hd less Yard Dd
     C           WBEVST    IFEQ 'RX'                       *IF
     C           WACWNB    SUB  WAFCNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WBA1VA    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Killed Head
     C           WBEVST    IFEQ 'KH'                       *IF
     C           WAFENB    MULT WBA1VA    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Condemned Head
     C           WBEVST    IFEQ 'CH'                       *IF
     C           WAFDNB    MULT WBA1VA    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Yard Deads Head
     C           WBEVST    IFEQ 'YH'                       *IF
     C           WAFCNB    MULT WBA1VA    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA Head
     C           WBEVST    IFEQ 'DH'                       *IF
     C           WACXNB    MULT WBA1VA    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Net Head
     C           WBEVST    IFEQ 'NH'                       *IF
     C                     Z-ADDWACWNB    WUF6NB           Net Head Usr
     C                     SUB  WAFCNB    WUF6NB           Net Head Usr
     C                     SUB  WAFDNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WBA1VA    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA Head + Yard Dead Head
     C           WBEVST    IFEQ 'DY'                       *IF
     C           WACXNB    ADD  WAFCNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WBA1VA    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA HD + Yard Dead + EUT
     C           WBEVST    IFEQ 'DE'                       *IF
     C           WACXNB    ADD  WAFCNB    WUF6NB           Net Head Usr
     C                     ADD  WAEDDT    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WBA1VA    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Received Head /100 Miles
     C           WBEVST    IFEQ 'HM'                       *IF
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (x1 * x2 * (x3/x4))
      * x1    : PAR.PSM Miles to Company
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Head Killed
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x4    : CON.100
     C           *ZERO     MULT WAFENB    W0WA01           *Synon (15,2) w
     C           WBA1VA    DIV  100       W0WB02    H      *Synon (15,5) w
     C           W0WA01    MULT W0WB02    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Weight UOM
     C           WBEVST    IFEQ 'CW'                       *IF
     C           WBEVST    OREQ 'LW'
     C           WBEVST    OREQ 'NL'
     C           WBEVST    OREQ 'SW'
     C           WBEVST    OREQ 'LX'
     C           WBEVST    OREQ 'SX'
      * * * * * *    WEIGHT   * * * * *
      * WEIGHT
      * CASE: PAR.Trans UOM USR is Live Hundred Weight
     C           WBEVST    IFEQ 'LW'                       *IF
      * Live hundred wgt
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Live Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WACYNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WBA1VA    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is LW less Yard Dead Wgt
     C           WBEVST    IFEQ 'LX'                       *IF
      *  Calc wgt of yard dead based on Th avg live wgt
     C           WAF7NB    MULT WAFCNB    WUCCNB           Yard dead weigh
      *   Subtract Yard Dead wgt from Live Wgt
     C           WACYNB    SUB  WUCCNB    WUOONB           Live Weight
      * Live hundred wgt less Yd
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Live Weight           USR
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUOONB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WBA1VA    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Carcass Hundred Weight
     C           WBEVST    IFEQ 'CW'                       *IF
      * Carcass Hundred Wgt
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WAE0NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WBA1VA    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Net Live Weight
     C           WBEVST    IFEQ 'NL'                       *IF
     C                     Z-ADDWACWNB    WUF6NB           Net Head Usr
     C                     SUB  WAFCNB    WUF6NB           Net Head Usr
     C                     SUB  WAFDNB    WUF6NB           Net Head Usr
      * * Insert avg live weight
     C           WUF6NB    MULT WAF7NB    WUVBNB           Net Live Weight
      * Net Live Weight
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Net Live Weight Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUVBNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WBA1VA    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Shipped Weight - Doa's
     C           WBEVST    IFEQ 'SW'                       *IF
      *   Calc Avg shipped wgt, then calc wgt of DOA'S
      * This rule was defined on 01/14/97
      * The Calculations for Avg Shipped Weights are
      * Head Received should be the live hogs that walk across the scale
      * Doa's should be the hogs that died either after we collected
      *       or before we weighed them
      * Avg Shipped Weight : Shipped Weight /(Head Received + Doa's)
     C           WACWNB    ADD  WACXNB    WUEXNB           Hd Cnt Org Ship
      * CASE: WRK.Hd Cnt Org Ship Usr is *Zeros
     C           WUEXNB    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WUY9NB           Avg Weight USR
     C                     ELSE
      * CASE: *OTHERWISE
     C           WAHGNB    DIV  WUEXNB    WUY9NB           Avg Weight USR
     C                     END                             *FI
     C           WUY9NB    MULT WACXNB    WUEVNB           Doa's Avg Weigh
      *   Subtract doa's from Shipped Wgt
     C           WAHGNB    SUB  WUEVNB    WUZ4NB           Ship Wgt Tot Us
      * Shipped Weight Total Ext
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Ship Wgt Tot Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUZ4NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WBA1VA    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is SW - Doa's WT - Yrd Dd WT
     C           WBEVST    IFEQ 'SX'                       *IF
      *   Calc Avg shipped wgt, then calc wgt of DOA'S and Yard Deads
      * This rule was defined on 01/14/97
      * The Calculations for Avg Shipped Weights are
      * Head Received should be the live hogs that walk across the scale
      * Doa's should be the hogs that died either after we collected
      *       or before we weighed them
      * Avg Shipped Weight : Shipped Weight /(Head Received + Doa's)
     C           WACWNB    ADD  WACXNB    WUEXNB           Hd Cnt Org Ship
      * CASE: WRK.Hd Cnt Org Ship Usr is *Zeros
     C           WUEXNB    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WUY9NB           Avg Weight USR
     C                     ELSE
      * CASE: *OTHERWISE
     C           WAHGNB    DIV  WUEXNB    WUY9NB           Avg Weight USR
     C                     END                             *FI
     C           WUY9NB    MULT WAFCNB    WUCCNB           Yard dead weigh
     C           WUY9NB    MULT WACXNB    WUEVNB           Doa's Avg Weigh
      *   Subtract Doa's and Subtract Yard Dead wgt from Shipped Wgt
     C           WAHGNB    SUB  WUEVNB    WUZ4NB           Ship Wgt Tot Us
     C                     SUB  WUCCNB    WUZ4NB           Ship Wgt Tot Us
      * Shipped wgt less Yd
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Ship Wgt Tot Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUZ4NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WBA1VA    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Value UOM
     C           WBEVST    IFEQ 'GV'                       *IF
     C           WBEVST    OREQ 'BD'
      * * * * * *    VALUE    * * * * *
      * VALUE
      * CASE: PAR.Trans UOM USR is Gross Hundred Value
     C           WBEVST    IFEQ 'GV'                       *IF
      * Gross Hundred Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Payment Gross
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUCBPR    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WBA1VA    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Carcass Hundred Weight
     C           WBEVST    IFEQ 'CW'                       *IF
      * Carcass Hundred Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WAE0NB    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WBA1VA    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Base Market Dollars
     C           WBEVST    IFEQ 'BD'                       *IF
      * Clc Base Mkt Dollars  XF - STR Unit of Measure Calc  * 
     C                     CALL 'PKBSE01'              90  Clc Base Mkt Do
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAHMNB    WQ0026  30       BOH Company Num
     C                     PARM WAAWDT    WQ0027  70       TH Purchase Dat
     C                     PARM WACYNB    WQ0028  71       TH Live Wgt
     C                     PARM WCBQCD    WQ0029  5        DED D/A Code
     C           WUCSPR    PARM *ZERO     WQ0030  92       Base Mkt Prc Am
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKBSE01' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Base Mkt Prc Amt Tot USR GE WRK.Zero USR
     C           WUCSPR    IFGE WUE9NB                     *IF
      * Base Market Dollars
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Base Mkt Prc Amt Tot USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUCSPR    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WBA1VA    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Percent UOM
     C           WBEVST    IFEQ *BLANK                     *IF
      * * * * * *    PERCENT   * * * * *
      * PERCENT
      * CASE: PAR.Trans UOM USR is Percent of Gross Value
     C           WBEVST    IFEQ *BLANK                     *IF
      * Percent of Gross Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.Trans Unit Amt Usr
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.TH Payment Gross
     C           WBA1VA    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WUCBPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: WRK.Trans Extended Amt Usr NE WRK.Zero USR
     C           WUCFPR    IFNE WUE9NB                     *IF
      * Date 03/24/2004 Slm -- Update the Deferred Payment in place of Bl
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR SVCRRC
      * CASE: WRK.THD Commission Deduction is Yes
     C           WUPIST    IFEQ 'Y'                        *IF
      * Rtv/Chg Commission StsRT - Tattoo Header  * 
     C                     EXSR SWRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Buy Order Type - Buy Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDHMNB           BOH Company Num
     C                     KFLD           WDBNNB           BOH Buy Order N
      * Setup key
     C                     Z-ADDWAHMNB    WDHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WDBNNB           BOH Buy Order N
      * Establish starting position
     C           KRSSD     CHAIN@AWCPBI              90    *
      * Data record not found
     C   90                MOVEL'PRK0049' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDA5ST    WUA5ST           BOH Buy Order T
     C                     MOVELWDAKCD    WUAKCD           PC Contract Cod
     C                     MOVELWDALCD    WUALCD           PSC Sub-Contrac
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECRRC    BEGSR
      *================================================================
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CDCPIT
     C                     Z-ADDWAHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WEBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WEBONB           BOL Load Number
     C                     Z-ADDWACVNB    WECVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WEB0DT           TH Kill Date
     C                     MOVELWCBQCD    WEBQCD           DED D/A Code
     C                     Z-ADDWCAEPR    WEAZVA           THD Unit Amt
     C                     Z-ADDWUCFPR    WEA0VA           THD Ded/Add Amo
     C                     MOVELWCI9ST    WEJBST           THD Unit Amt Si
     C                     MOVELWCCAST    WEEIST           THD UOM
     C                     MOVEL'S'       WEJDST           THD Transaction
     C                     MOVELWCF7TX    WEDPCD           THD GL Code
     C                     MOVELWCE2CD    WEE3CD           THD Contra Gl C
     C                     Z-ADDWUE9NB    WEAQNB           THD Re-imbursem
     C                     MOVELWACWST    WEOCST           THD Payment Sts
     C                     MOVELWUPEST    WEPEST           THD Expense Pai
     C                     MOVELWUPFST    WEPFST           THD Expense Typ
     C                     MOVEL*BLANK    WEPGST           THD Reserve Acc
     C                     MOVELWUPIST    WEPIST           THD Commission
     C                     MOVELWUPJST    WEPJST           THD Deferred Pa
     C                     MOVEL*BLANK    WEPKST           THD Status 4
     C                     MOVEL*BLANK    WEPLST           THD Status 5
     C                     MOVEL*BLANK    WEAAVN           RS User Changed
     C                     Z-ADD*ZERO     WEAADT           RS Date Changed
     C                     Z-ADD*ZERO     WEAMTM           RS Time Changed
     C                     MOVEL'A'       WEAJST           RS Record Statu
     C                     MOVEL##JOB     WEAHVN           RS Job
     C                     MOVEL##PGM     WEAGVN           RS Program
     C                     MOVEL##USR     WEABVN           RS User Added
     C                     Z-ADD##JDT     WEABDT           RS Date Added
     C                     Z-ADD##JTM     WEABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WEAJST           RS Record Statu
     C                     MOVEL##USR     WEABVN           RS User Added
     C                     Z-ADD##JDT     WEABDT           RS Date Added
     C                     Z-ADD##JTM     WEABTM           RS Time Added
     C                     MOVEL##PGM     WEAGVN           RS Program
     C                     MOVEL##JOB     WEAHVN           RS Job
     C           KLCRSE    KLIST
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
     C                     KFLD           WEBONB           BOL Load Number
     C                     KFLD           WECVNB           TH Tattoo Numbe
     C                     KFLD           WEB0DT           TH Kill Date
     C                     KFLD           WEBQCD           DED D/A Code
      * Check for duplicate primary key
     C           KLCRSE    SETLL@CDCPIT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0175' W0RTN   7
      * Send message 'Tattoo Ded/Add         EX'
     C                     MOVEL'PRK0175' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C                     WRITE@CDCPIT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv/Chg Commission StsRT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFHMNB    WQSF01           BOH Company Num
     C           *LIKE     DEFN WFBNNB    WQSF02           BOH Buy Order N
     C           *LIKE     DEFN WFBONB    WQSF03           BOL Load Number
     C           *LIKE     DEFN WFB0DT    WQSF04           TH Kill Date
     C           *LIKE     DEFN WFCVNB    WQSF05           TH Tattoo Numbe
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           BOH Company Num
     C                     KFLD           WQSF02           BOH Buy Order N
     C                     KFLD           WQSF03           BOL Load Number
     C                     KFLD           WQSF04           TH Kill Date
     C                     KFLD           WQSF05           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWAHMNB    WQSF01           BOH Company Num
     C                     Z-ADDWABNNB    WQSF02           BOH Buy Order N
     C                     Z-ADDWABONB    WQSF03           BOL Load Number
     C                     Z-ADDWAB0DT    WQSF04           TH Kill Date
     C                     Z-ADDWACVNB    WQSF05           TH Tattoo Numbe
      * Establish starting position
     C           KRSSF     SETLL@A1CPOC                    *
     C           KRSSF     READE@A1CPOC                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Commission Sts/Dt CH - Tattoo Header  * 
     C                     EXSR SGCHRC
     C           KRSSF     READE@A1CPOC                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCHRC    BEGSR
      *================================================================
      * Chg Commission Sts/Dt CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0003  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0004 10        TH Group Refere
     C                     MOVEL*BLANK    WN0005  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0006  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0007  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0008  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0009  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0010  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0011  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0012  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0013  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0014  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0015  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0016  50       TH Held Over
     C                     Z-ADD*ZERO     WN0017  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0018  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0019  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0020  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0021  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0022  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0023  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0024  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0025  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0026  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0027  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0028  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0029  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0030  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0031  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0032  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0033  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0034  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0035  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0036  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0037  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0038  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0039  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0040  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0041  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0042  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0043  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0044  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0045  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0046  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0047  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0048  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0049  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0050  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0051  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0052  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0053  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0054  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0055  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0056  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0057  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0058  1        TH Header Error
     C                     MOVEL*BLANK    WN0059  1        TH Detail Error
     C                     MOVEL*BLANK    WN0060  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0061  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0062  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0063  1        TH User Error O
     C                     MOVEL*BLANK    WN0064  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0065  1        TH Sex
     C                     Z-ADD*ZERO     WN0066  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0067  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0068  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0069  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0070  31       TH FFLI
     C                     Z-ADD*ZERO     WN0071  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0072  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0073  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0074  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0075  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0076  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0077  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0078  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0079  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0080  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0081  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0082  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0083  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0084  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0085  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0086  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0087  1        TH Source Type
     C                     MOVEL*BLANK    WN0088  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0089  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0090  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0091  3        TH Source Code
     C                     MOVEL*BLANK    WN0092  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0093  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0094  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0095  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0096  3        TH State
     C                     MOVEL*BLANK    WN0097  3        TH Unused Code
     C                     MOVEL*BLANK    WN0098  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0099  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0100  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0101  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0102  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0103  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0104  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0105  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0106  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0107  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0108  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0109  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0110  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0111  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0112  3        TH PHA Average
     C                     MOVEL*BLANK    WN0113  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0114  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0115  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0116  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0117  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0118  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0119  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0120  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0121  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0122  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0123  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0124  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0125  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0126 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0127 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0128 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0129 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0130  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0131  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0132  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0133  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0134  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0135  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0136  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0137  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0138  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0139  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0140  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0141  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0142  70       TH Unused Date
     C                     MOVEL*BLANK    WN0143  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0144  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0145  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0146  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0147  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0148  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0149  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0150  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0151  6        DF Defect Code
     C                     MOVEL*BLANK    WN0152  6        THP Process Cod
     C                     MOVEL*BLANK    WN0153  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0154  6        PL Location Cod
     C                     MOVEL*BLANK    WN0155  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0156  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0157  3        HC Class Code
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWFHMNB    WGHMNB           BOH Company Num
     C                     Z-ADDWFBNNB    WGBNNB           BOH Buy Order N
     C                     Z-ADDWFBONB    WGBONB           BOL Load Number
     C                     Z-ADDWFCVNB    WGCVNB           TH Tattoo Numbe
     C                     Z-ADDWFB0DT    WGB0DT           TH Kill Date
      *
     C           KLCHSG    KLIST
     C                     KFLD           WGHMNB           BOH Company Num
     C                     KFLD           WGBNNB           BOH Buy Order N
     C                     KFLD           WGBONB           BOL Load Number
     C                     KFLD           WGCVNB           TH Tattoo Numbe
     C                     KFLD           WGB0DT           TH Kill Date
     C           KLCHSG    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YARDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADD*ZERO     WGGHNB           TH Commission A
     C                     Z-ADD*ZERO     WGBTDT           TH Commission P
     C                     MOVEL'C'       WGR5ST    P      TH Commission S
     C                     MOVELWFAAVN    WGAAVN    P      RS User Changed
     C                     Z-ADDWFAADT    WGAADT           RS Date Changed
     C                     Z-ADDWFAMTM    WGAMTM           RS Time Changed
     C                     MOVELWFAJST    WGAJST    P      RS Record Statu
     C                     MOVELWFAHVN    WGAHVN    P      RS Job
     C                     MOVELWFAGVN    WGAGVN    P      RS Program
     C                     MOVELWFABVN    WGABVN    P      RS User Added
     C                     Z-ADDWFABDT    WGABDT           RS Date Added
     C                     Z-ADDWFABTM    WGABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv BOL Reimb hd sum  RT - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADDWUE9NB    WUDDNB           Re-imbursement
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHHMNB    WQSH01           BOH Company Num
     C           *LIKE     DEFN WHBNNB    WQSH02           BOH Buy Order N
     C           *LIKE     DEFN WHBONB    WQSH03           BOL Load Number
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           BOH Company Num
     C                     KFLD           WQSH02           BOH Buy Order N
     C                     KFLD           WQSH03           BOL Load Number
      * Setup key
     C                     Z-ADDWAHMNB    WQSH01           BOH Company Num
     C                     Z-ADDWABNNB    WQSH02           BOH Buy Order N
     C                     Z-ADDWABONB    WQSH03           BOL Load Number
      * Establish starting position
     C           KRSSH     SETLL@CDCPV4                    *
     C           KRSSH     READE@CDCPV4                  90*
      * Data record not found
     C   90                MOVEL'PRK0174' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WHAQNB    WUDDNB           Re-imbursement
     C           KRSSH     READE@CDCPV4                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Comm/Group        RT - Buy Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WDHMNB           BOH Company Num
     C                     KFLD           WDBNNB           BOH Buy Order N
      * Setup key
     C                     Z-ADDWAHMNB    WDHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WDBNNB           BOH Buy Order N
      * Establish starting position
     C           KRSSI     CHAIN@AWCPBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0049' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0159           BOH Commodity M
     C                     MOVEL*BLANK    WN0160           BOH Commodity P
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDETCD    WN0159           BOH Commodity M
     C                     MOVELWDEUCD    WN0160           BOH Commodity P
     C                     GOTO SIEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCRRC    BEGSR
      *================================================================
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CDCPIT
     C                     Z-ADDWAHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WEBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WEBONB           BOL Load Number
     C                     Z-ADDWACVNB    WECVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WEB0DT           TH Kill Date
     C                     MOVELWCBQCD    WEBQCD           DED D/A Code
     C                     Z-ADDWULLPR    WEAZVA           THD Unit Amt
     C                     Z-ADDWUCFPR    WEA0VA           THD Ded/Add Amo
     C                     MOVELWBJAST    WEJBST           THD Unit Amt Si
     C                     MOVELWBEVST    WEEIST           THD UOM
     C                     MOVEL'S'       WEJDST           THD Transaction
     C                     MOVELWCF7TX    WEDPCD           THD GL Code
     C                     MOVELWCE2CD    WEE3CD           THD Contra Gl C
     C                     Z-ADDWUAQNB    WEAQNB           THD Re-imbursem
     C                     MOVELWACWST    WEOCST           THD Payment Sts
     C                     MOVELWUPEST    WEPEST           THD Expense Pai
     C                     MOVELWUPFST    WEPFST           THD Expense Typ
     C                     MOVEL*BLANK    WEPGST           THD Reserve Acc
     C                     MOVEL*BLANK    WEPIST           THD Commission
     C                     MOVEL*BLANK    WEPJST           THD Deferred Pa
     C                     MOVEL*BLANK    WEPKST           THD Status 4
     C                     MOVEL*BLANK    WEPLST           THD Status 5
     C                     MOVEL*BLANK    WEAAVN           RS User Changed
     C                     Z-ADD*ZERO     WEAADT           RS Date Changed
     C                     Z-ADD*ZERO     WEAMTM           RS Time Changed
     C                     MOVEL'A'       WEAJST           RS Record Statu
     C                     MOVEL##JOB     WEAHVN           RS Job
     C                     MOVEL##PGM     WEAGVN           RS Program
     C                     MOVEL##USR     WEABVN           RS User Added
     C                     Z-ADD##JDT     WEABDT           RS Date Added
     C                     Z-ADD##JTM     WEABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WEAJST           RS Record Statu
     C                     MOVEL##USR     WEABVN           RS User Added
     C                     Z-ADD##JDT     WEABDT           RS Date Added
     C                     Z-ADD##JTM     WEABTM           RS Time Added
     C                     MOVEL##PGM     WEAGVN           RS Program
     C                     MOVEL##JOB     WEAHVN           RS Job
     C           KLCRSJ    KLIST
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
     C                     KFLD           WEBONB           BOL Load Number
     C                     KFLD           WECVNB           TH Tattoo Numbe
     C                     KFLD           WEB0DT           TH Kill Date
     C                     KFLD           WEBQCD           DED D/A Code
      * Check for duplicate primary key
     C           KLCRSJ    SETLL@CDCPIT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0175' W0RTN   7
      * Send message 'Tattoo Ded/Add         EX'
     C                     MOVEL'PRK0175' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C                     WRITE@CDCPIT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Held Over KillDts RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIHMNB    WQSK01           BOH Company Num
     C           *LIKE     DEFN WIBNNB    WQSK02           BOH Buy Order N
     C           *LIKE     DEFN WIBONB    WQSK03           BOL Load Number
     C           *LIKE     DEFN WICVNB    WQSK04           TH Tattoo Numbe
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           BOH Company Num
     C                     KFLD           WQSK02           BOH Buy Order N
     C                     KFLD           WQSK03           BOL Load Number
     C                     KFLD           WQSK04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWAHMNB    WQSK01           BOH Company Num
     C                     Z-ADDWABNNB    WQSK02           BOH Buy Order N
     C                     Z-ADDWABONB    WQSK03           BOL Load Number
     C                     Z-ADDWACVNB    WQSK04           TH Tattoo Numbe
      * Establish starting position
     C           KRSSK     SETLL@A1CPC7                    *
     C           KRSSK     READE@A1CPC7                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.TH Kill Date NE PAR.Kill Date 1 Usr
     C           WIB0DT    IFNE WAB0DT                     *IF
     C                     Z-ADDWIB0DT    YL0001           Kill Date Usr
     C                     GOTO SKEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSK     READE@A1CPC7                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCRRC    BEGSR
      *================================================================
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CDCPIT
     C                     Z-ADDWAHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WEBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WEBONB           BOL Load Number
     C                     Z-ADDWACVNB    WECVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WEB0DT           TH Kill Date
     C                     MOVELWCBQCD    WEBQCD           DED D/A Code
     C                     Z-ADDWATAPR    WEAZVA           THD Unit Amt
     C                     Z-ADDYL0003    WEA0VA           THD Ded/Add Amo
     C                     MOVELWBJAST    WEJBST           THD Unit Amt Si
     C                     MOVELWBEVST    WEEIST           THD UOM
     C                     MOVEL'S'       WEJDST           THD Transaction
     C                     MOVELWCF7TX    WEDPCD           THD GL Code
     C                     MOVELWCE2CD    WEE3CD           THD Contra Gl C
     C                     Z-ADDWAFCNB    WEAQNB           THD Re-imbursem
     C                     MOVELWACWST    WEOCST           THD Payment Sts
     C                     MOVELWUPEST    WEPEST           THD Expense Pai
     C                     MOVELWUPFST    WEPFST           THD Expense Typ
     C                     MOVEL*BLANK    WEPGST           THD Reserve Acc
     C                     MOVEL*BLANK    WEPIST           THD Commission
     C                     MOVEL*BLANK    WEPJST           THD Deferred Pa
     C                     MOVEL*BLANK    WEPKST           THD Status 4
     C                     MOVEL*BLANK    WEPLST           THD Status 5
     C                     MOVEL*BLANK    WEAAVN           RS User Changed
     C                     Z-ADD*ZERO     WEAADT           RS Date Changed
     C                     Z-ADD*ZERO     WEAMTM           RS Time Changed
     C                     MOVEL'A'       WEAJST           RS Record Statu
     C                     MOVEL##JOB     WEAHVN           RS Job
     C                     MOVEL##PGM     WEAGVN           RS Program
     C                     MOVEL##USR     WEABVN           RS User Added
     C                     Z-ADD##JDT     WEABDT           RS Date Added
     C                     Z-ADD##JTM     WEABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WEAJST           RS Record Statu
     C                     MOVEL##USR     WEABVN           RS User Added
     C                     Z-ADD##JDT     WEABDT           RS Date Added
     C                     Z-ADD##JTM     WEABTM           RS Time Added
     C                     MOVEL##PGM     WEAGVN           RS Program
     C                     MOVEL##JOB     WEAHVN           RS Job
     C           KLCRSL    KLIST
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
     C                     KFLD           WEBONB           BOL Load Number
     C                     KFLD           WECVNB           TH Tattoo Numbe
     C                     KFLD           WEB0DT           TH Kill Date
     C                     KFLD           WEBQCD           DED D/A Code
      * Check for duplicate primary key
     C           KLCRSL    SETLL@CDCPIT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0175' W0RTN   7
      * Send message 'Tattoo Ded/Add         EX'
     C                     MOVEL'PRK0175' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C                     WRITE@CDCPIT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv PurchPrc Clc BrkEORT - Producer Sub-Contract  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WJAKCD           PC Contract Cod
     C                     KFLD           WJALCD           PSC Sub-Contrac
      * Setup key
     C                     MOVELWUAKCD    WJAKCD           PC Contract Cod
     C                     MOVELWUALCD    WJALCD           PSC Sub-Contrac
      * Establish starting position
     C           KRSSM     CHAIN@AQCPA0              90    *
      * Data record not found
     C   90                MOVEL'PRK0037' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWJA7PR    WUA7PR           PSC Break Even
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNCRRC    BEGSR
      *================================================================
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CDCPIT
     C                     Z-ADDWAHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WEBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WEBONB           BOL Load Number
     C                     Z-ADDWACVNB    WECVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WEB0DT           TH Kill Date
     C                     MOVELWCBQCD    WEBQCD           DED D/A Code
     C                     Z-ADDWUCEPR    WEAZVA           THD Unit Amt
     C                     Z-ADDWUCFPR    WEA0VA           THD Ded/Add Amo
     C                     MOVELWBJAST    WEJBST           THD Unit Amt Si
     C                     MOVELWBEVST    WEEIST           THD UOM
     C                     MOVEL'S'       WEJDST           THD Transaction
     C                     MOVELWCF7TX    WEDPCD           THD GL Code
     C                     MOVELWCE2CD    WEE3CD           THD Contra Gl C
     C                     Z-ADD*ZERO     WEAQNB           THD Re-imbursem
     C                     MOVELWACWST    WEOCST           THD Payment Sts
     C                     MOVELWUPEST    WEPEST           THD Expense Pai
     C                     MOVELWUPFST    WEPFST           THD Expense Typ
     C                     MOVEL*BLANK    WEPGST           THD Reserve Acc
     C                     MOVEL*BLANK    WEPIST           THD Commission
     C                     MOVEL'Y'       WEPJST           THD Deferred Pa
     C                     MOVEL*BLANK    WEPKST           THD Status 4
     C                     MOVEL*BLANK    WEPLST           THD Status 5
     C                     MOVEL*BLANK    WEAAVN           RS User Changed
     C                     Z-ADD*ZERO     WEAADT           RS Date Changed
     C                     Z-ADD*ZERO     WEAMTM           RS Time Changed
     C                     MOVEL'A'       WEAJST           RS Record Statu
     C                     MOVEL##JOB     WEAHVN           RS Job
     C                     MOVEL##PGM     WEAGVN           RS Program
     C                     MOVEL##USR     WEABVN           RS User Added
     C                     Z-ADD##JDT     WEABDT           RS Date Added
     C                     Z-ADD##JTM     WEABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WEAJST           RS Record Statu
     C                     MOVEL##USR     WEABVN           RS User Added
     C                     Z-ADD##JDT     WEABDT           RS Date Added
     C                     Z-ADD##JTM     WEABTM           RS Time Added
     C                     MOVEL##PGM     WEAGVN           RS Program
     C                     MOVEL##JOB     WEAHVN           RS Job
     C           KLCRSN    KLIST
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
     C                     KFLD           WEBONB           BOL Load Number
     C                     KFLD           WECVNB           TH Tattoo Numbe
     C                     KFLD           WEB0DT           TH Kill Date
     C                     KFLD           WEBQCD           DED D/A Code
      * Check for duplicate primary key
     C           KLCRSN    SETLL@CDCPIT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0175' W0RTN   7
      * Send message 'Tattoo Ded/Add         EX'
     C                     MOVEL'PRK0175' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C                     WRITE@CDCPIT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Sub-Contract Type RT - Buy Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WDHMNB           BOH Company Num
     C                     KFLD           WDBNNB           BOH Buy Order N
      * Setup key
     C                     Z-ADDWAHMNB    WDHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WDBNNB           BOH Buy Order N
      * Establish starting position
     C           KRSSO     CHAIN@AWCPBI              90    *
      * Data record not found
     C   90                MOVEL'PRK0049' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDAKCD    WN0165           PC Contract Cod
     C                     MOVELWDALCD    WN0166           PSC Sub-Contrac
      * Rtv Sub-Contract Type RT - Producer Sub-Contract  * 
     C                     EXSR SPRVGN
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Sub-Contract Type RT - Producer Sub-Contract  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WJAKCD           PC Contract Cod
     C                     KFLD           WJALCD           PSC Sub-Contrac
      * Setup key
     C                     MOVELWDAKCD    WJAKCD           PC Contract Cod
     C                     MOVELWDALCD    WJALCD           PSC Sub-Contrac
      * Establish starting position
     C           KRSSP     CHAIN@AQCPA0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0037' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0161           PSC FLoor Price
     C                     MOVEL*BLANK    WN0162           PSC Sub-Contrac
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWJA8PR    WN0161           PSC FLoor Price
     C                     MOVELWJF3ST    WN0162           PSC Sub-Contrac
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Floor Price       RT - Producer SC Floor Price  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WKAKCD           PC Contract Cod
     C                     KFLD           WKALCD           PSC Sub-Contrac
     C                     KFLD           WKDJDT           PFP Week Ending
      * Setup key
     C                     MOVELWN0165    WKAKCD           PC Contract Cod
     C                     MOVELWN0166    WKALCD           PSC Sub-Contrac
     C                     Z-ADDWN0163    WKDJDT           PFP Week Ending
      * Establish starting position
     C           KRSSQ     CHAIN@ECCPAG              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0816' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0164           PFP Adjusted Fl
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWKODPR    WN0164           PFP Adjusted Fl
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Val Reserv Acct Exists RT - Producer Cntrct RsvAct Hd  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WN0167           Balance Exists
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WLAKCD           PC Contract Cod
      * Setup key
     C                     MOVELWN0165    WLAKCD           PC Contract Cod
      * Establish starting position
     C           KRSSR     CHAIN@EECPAP              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0820' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.PAH Account Balance GT WRK.Zero USR
     C           WLEJVA    IFGT WUE9NB                     *IF
     C                     MOVEL'Y'       WN0167           Balance Exists
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCRRC    BEGSR
      *================================================================
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CDCPIT
     C                     Z-ADDWAHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WEBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WEBONB           BOL Load Number
     C                     Z-ADDWACVNB    WECVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WEB0DT           TH Kill Date
     C                     MOVELWCBQCD    WEBQCD           DED D/A Code
     C                     Z-ADDWBA1VA    WEAZVA           THD Unit Amt
     C                     Z-ADDWUCFPR    WEA0VA           THD Ded/Add Amo
     C                     MOVELWBJAST    WEJBST           THD Unit Amt Si
     C                     MOVELWBEVST    WEEIST           THD UOM
     C                     MOVEL'S'       WEJDST           THD Transaction
     C                     MOVELWCF7TX    WEDPCD           THD GL Code
     C                     MOVELWCE2CD    WEE3CD           THD Contra Gl C
     C                     Z-ADDWUE9NB    WEAQNB           THD Re-imbursem
     C                     MOVELWACWST    WEOCST           THD Payment Sts
     C                     MOVELWUPEST    WEPEST           THD Expense Pai
     C                     MOVELWUPFST    WEPFST           THD Expense Typ
     C                     MOVELWCNWST    WEPGST           THD Reserve Acc
     C                     MOVELWUPIST    WEPIST           THD Commission
     C                     MOVELWUPJST    WEPJST           THD Deferred Pa
     C                     MOVEL*BLANK    WEPKST           THD Status 4
     C                     MOVEL*BLANK    WEPLST           THD Status 5
     C                     MOVEL*BLANK    WEAAVN           RS User Changed
     C                     Z-ADD*ZERO     WEAADT           RS Date Changed
     C                     Z-ADD*ZERO     WEAMTM           RS Time Changed
     C                     MOVEL'A'       WEAJST           RS Record Statu
     C                     MOVEL##JOB     WEAHVN           RS Job
     C                     MOVEL##PGM     WEAGVN           RS Program
     C                     MOVEL##USR     WEABVN           RS User Added
     C                     Z-ADD##JDT     WEABDT           RS Date Added
     C                     Z-ADD##JTM     WEABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WEAJST           RS Record Statu
     C                     MOVEL##USR     WEABVN           RS User Added
     C                     Z-ADD##JDT     WEABDT           RS Date Added
     C                     Z-ADD##JTM     WEABTM           RS Time Added
     C                     MOVEL##PGM     WEAGVN           RS Program
     C                     MOVEL##JOB     WEAHVN           RS Job
     C           KLCRSS    KLIST
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
     C                     KFLD           WEBONB           BOL Load Number
     C                     KFLD           WECVNB           TH Tattoo Numbe
     C                     KFLD           WEB0DT           TH Kill Date
     C                     KFLD           WEBQCD           DED D/A Code
      * Check for duplicate primary key
     C           KLCRSS    SETLL@CDCPIT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0175' W0RTN   7
      * Send message 'Tattoo Ded/Add         EX'
     C                     MOVEL'PRK0175' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C                     WRITE@CDCPIT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Rtv/Chg Commission StsRT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFHMNB    WQST01           BOH Company Num
     C           *LIKE     DEFN WFBNNB    WQST02           BOH Buy Order N
     C           *LIKE     DEFN WFBONB    WQST03           BOL Load Number
     C           *LIKE     DEFN WFB0DT    WQST04           TH Kill Date
     C           *LIKE     DEFN WFCVNB    WQST05           TH Tattoo Numbe
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST01           BOH Company Num
     C                     KFLD           WQST02           BOH Buy Order N
     C                     KFLD           WQST03           BOL Load Number
     C                     KFLD           WQST04           TH Kill Date
     C                     KFLD           WQST05           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWAHMNB    WQST01           BOH Company Num
     C                     Z-ADDWABNNB    WQST02           BOH Buy Order N
     C                     Z-ADDWABONB    WQST03           BOL Load Number
     C                     Z-ADDWAB0DT    WQST04           TH Kill Date
     C                     Z-ADDWACVNB    WQST05           TH Tattoo Numbe
      * Establish starting position
     C           KRSST     SETLL@A1CPOC                    *
     C           KRSST     READE@A1CPOC                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Commission Sts/Dt CH - Tattoo Header  * 
     C                     EXSR SUCHRC
     C           KRSST     READE@A1CPOC                  90*
     C                     ENDDO
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUCHRC    BEGSR
      *================================================================
      * Chg Commission Sts/Dt CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0168  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0169 10        TH Group Refere
     C                     MOVEL*BLANK    WN0170  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0171  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0172  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0173  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0174  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0175  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0176  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0177  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0178  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0179  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0180  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0181  50       TH Held Over
     C                     Z-ADD*ZERO     WN0182  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0183  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0184  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0185  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0186  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0187  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0188  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0189  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0190  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0191  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0192  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0193  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0194  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0195  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0196  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0197  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0198  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0199  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0200  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0201  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0202  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0203  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0204  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0205  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0206  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0207  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0208  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0209  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0210  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0211  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0212  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0213  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0214  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0215  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0216  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0217  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0218  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0219  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0220  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0221  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0222  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0223  1        TH Header Error
     C                     MOVEL*BLANK    WN0224  1        TH Detail Error
     C                     MOVEL*BLANK    WN0225  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0226  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0227  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0228  1        TH User Error O
     C                     MOVEL*BLANK    WN0229  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0230  1        TH Sex
     C                     Z-ADD*ZERO     WN0231  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0232  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0233  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0234  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0235  31       TH FFLI
     C                     Z-ADD*ZERO     WN0236  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0237  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0238  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0239  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0240  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0241  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0242  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0243  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0244  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0245  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0246  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0247  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0248  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0249  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0250  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0251  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0252  1        TH Source Type
     C                     MOVEL*BLANK    WN0253  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0254  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0255  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0256  3        TH Source Code
     C                     MOVEL*BLANK    WN0257  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0258  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0259  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0260  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0261  3        TH State
     C                     MOVEL*BLANK    WN0262  3        TH Unused Code
     C                     MOVEL*BLANK    WN0263  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0264  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0265  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0266  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0267  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0268  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0269  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0270  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0271  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0272  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0273  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0274  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0275  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0276  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0277  3        TH PHA Average
     C                     MOVEL*BLANK    WN0278  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0279  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0280  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0281  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0282  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0283  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0284  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0285  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0286  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0287  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0288  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0289  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0290  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0291 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0292 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0293 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0294 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0295  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0296  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0297  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0298  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0299  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0300  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0301  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0302  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0303  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0304  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0305  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0306  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0307  70       TH Unused Date
     C                     MOVEL*BLANK    WN0308  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0309  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0310  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0311  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0312  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0313  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0314  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0315  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0316  6        DF Defect Code
     C                     MOVEL*BLANK    WN0317  6        THP Process Cod
     C                     MOVEL*BLANK    WN0318  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0319  6        PL Location Cod
     C                     MOVEL*BLANK    WN0320  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0321  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0322  3        HC Class Code
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWFHMNB    WGHMNB           BOH Company Num
     C                     Z-ADDWFBNNB    WGBNNB           BOH Buy Order N
     C                     Z-ADDWFBONB    WGBONB           BOL Load Number
     C                     Z-ADDWFCVNB    WGCVNB           TH Tattoo Numbe
     C                     Z-ADDWFB0DT    WGB0DT           TH Kill Date
      *
     C           KLCHSU    KLIST
     C                     KFLD           WGHMNB           BOH Company Num
     C                     KFLD           WGBNNB           BOH Buy Order N
     C                     KFLD           WGBONB           BOL Load Number
     C                     KFLD           WGCVNB           TH Tattoo Numbe
     C                     KFLD           WGB0DT           TH Kill Date
     C           KLCHSU    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YBRDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADD*ZERO     WGGHNB           TH Commission A
     C                     Z-ADD*ZERO     WGBTDT           TH Commission P
     C                     MOVEL'C'       WGR5ST    P      TH Commission S
     C                     MOVELWFAAVN    WGAAVN    P      RS User Changed
     C                     Z-ADDWFAADT    WGAADT           RS Date Changed
     C                     Z-ADDWFAMTM    WGAMTM           RS Time Changed
     C                     MOVELWFAJST    WGAJST    P      RS Record Statu
     C                     MOVELWFAHVN    WGAHVN    P      RS Job
     C                     MOVELWFAGVN    WGAGVN    P      RS Program
     C                     MOVELWFABVN    WGABVN    P      RS User Added
     C                     Z-ADDWFABDT    WGABDT           RS Date Added
     C                     Z-ADDWFABTM    WGABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVCRRC    BEGSR
      *================================================================
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CDCPIT
     C                     Z-ADDWAHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WEBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WEBONB           BOL Load Number
     C                     Z-ADDWACVNB    WECVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WEB0DT           TH Kill Date
     C                     MOVELWCBQCD    WEBQCD           DED D/A Code
     C                     Z-ADDWBA1VA    WEAZVA           THD Unit Amt
     C                     Z-ADDWUCFPR    WEA0VA           THD Ded/Add Amo
     C                     MOVELWBJAST    WEJBST           THD Unit Amt Si
     C                     MOVELWBEVST    WEEIST           THD UOM
     C                     MOVEL'S'       WEJDST           THD Transaction
     C                     MOVELWCF7TX    WEDPCD           THD GL Code
     C                     MOVELWCE2CD    WEE3CD           THD Contra Gl C
     C                     Z-ADDWUE9NB    WEAQNB           THD Re-imbursem
     C                     MOVELWACWST    WEOCST           THD Payment Sts
     C                     MOVELWUPEST    WEPEST           THD Expense Pai
     C                     MOVELWUPFST    WEPFST           THD Expense Typ
     C                     MOVEL*BLANK    WEPGST           THD Reserve Acc
     C                     MOVELWUPIST    WEPIST           THD Commission
     C                     MOVELWUPJST    WEPJST           THD Deferred Pa
     C                     MOVEL*BLANK    WEPKST           THD Status 4
     C                     MOVEL*BLANK    WEPLST           THD Status 5
     C                     MOVEL*BLANK    WEAAVN           RS User Changed
     C                     Z-ADD*ZERO     WEAADT           RS Date Changed
     C                     Z-ADD*ZERO     WEAMTM           RS Time Changed
     C                     MOVEL'A'       WEAJST           RS Record Statu
     C                     MOVEL##JOB     WEAHVN           RS Job
     C                     MOVEL##PGM     WEAGVN           RS Program
     C                     MOVEL##USR     WEABVN           RS User Added
     C                     Z-ADD##JDT     WEABDT           RS Date Added
     C                     Z-ADD##JTM     WEABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WEAJST           RS Record Statu
     C                     MOVEL##USR     WEABVN           RS User Added
     C                     Z-ADD##JDT     WEABDT           RS Date Added
     C                     Z-ADD##JTM     WEABTM           RS Time Added
     C                     MOVEL##PGM     WEAGVN           RS Program
     C                     MOVEL##JOB     WEAHVN           RS Job
     C           KLCRSV    KLIST
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
     C                     KFLD           WEBONB           BOL Load Number
     C                     KFLD           WECVNB           TH Tattoo Numbe
     C                     KFLD           WEB0DT           TH Kill Date
     C                     KFLD           WEBQCD           DED D/A Code
      * Check for duplicate primary key
     C           KLCRSV    SETLL@CDCPIT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0175' W0RTN   7
      * Send message 'Tattoo Ded/Add         EX'
     C                     MOVEL'PRK0175' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C                     WRITE@CDCPIT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Rtv/Chg Commission StsRT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFHMNB    WQSW01           BOH Company Num
     C           *LIKE     DEFN WFBNNB    WQSW02           BOH Buy Order N
     C           *LIKE     DEFN WFBONB    WQSW03           BOL Load Number
     C           *LIKE     DEFN WFB0DT    WQSW04           TH Kill Date
     C           *LIKE     DEFN WFCVNB    WQSW05           TH Tattoo Numbe
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WQSW01           BOH Company Num
     C                     KFLD           WQSW02           BOH Buy Order N
     C                     KFLD           WQSW03           BOL Load Number
     C                     KFLD           WQSW04           TH Kill Date
     C                     KFLD           WQSW05           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWAHMNB    WQSW01           BOH Company Num
     C                     Z-ADDWABNNB    WQSW02           BOH Buy Order N
     C                     Z-ADDWABONB    WQSW03           BOL Load Number
     C                     Z-ADDWAB0DT    WQSW04           TH Kill Date
     C                     Z-ADDWACVNB    WQSW05           TH Tattoo Numbe
      * Establish starting position
     C           KRSSW     SETLL@A1CPOC                    *
     C           KRSSW     READE@A1CPOC                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Commission Sts/Dt CH - Tattoo Header  * 
     C                     EXSR SXCHRC
     C           KRSSW     READE@A1CPOC                  90*
     C                     ENDDO
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXCHRC    BEGSR
      *================================================================
      * Chg Commission Sts/Dt CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0323  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0324 10        TH Group Refere
     C                     MOVEL*BLANK    WN0325  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0326  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0327  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0328  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0329  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0330  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0331  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0332  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0333  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0334  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0335  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0336  50       TH Held Over
     C                     Z-ADD*ZERO     WN0337  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0338  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0339  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0340  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0341  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0342  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0343  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0344  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0345  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0346  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0347  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0348  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0349  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0350  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0351  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0352  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0353  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0354  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0355  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0356  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0357  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0358  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0359  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0360  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0361  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0362  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0363  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0364  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0365  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0366  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0367  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0368  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0369  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0370  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0371  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0372  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0373  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0374  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0375  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0376  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0377  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0378  1        TH Header Error
     C                     MOVEL*BLANK    WN0379  1        TH Detail Error
     C                     MOVEL*BLANK    WN0380  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0381  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0382  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0383  1        TH User Error O
     C                     MOVEL*BLANK    WN0384  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0385  1        TH Sex
     C                     Z-ADD*ZERO     WN0386  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0387  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0388  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0389  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0390  31       TH FFLI
     C                     Z-ADD*ZERO     WN0391  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0392  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0393  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0394  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0395  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0396  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0397  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0398  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0399  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0400  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0401  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0402  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0403  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0404  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0405  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0406  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0407  1        TH Source Type
     C                     MOVEL*BLANK    WN0408  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0409  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0410  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0411  3        TH Source Code
     C                     MOVEL*BLANK    WN0412  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0413  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0414  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0415  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0416  3        TH State
     C                     MOVEL*BLANK    WN0417  3        TH Unused Code
     C                     MOVEL*BLANK    WN0418  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0419  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0420  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0421  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0422  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0423  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0424  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0425  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0426  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0427  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0428  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0429  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0430  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0431  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0432  3        TH PHA Average
     C                     MOVEL*BLANK    WN0433  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0434  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0435  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0436  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0437  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0438  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0439  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0440  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0441  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0442  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0443  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0444  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0445  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0446 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0447 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0448 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0449 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0450  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0451  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0452  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0453  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0454  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0455  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0456  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0457  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0458  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0459  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0460  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0461  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0462  70       TH Unused Date
     C                     MOVEL*BLANK    WN0463  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0464  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0465  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0466  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0467  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0468  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0469  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0470  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0471  6        DF Defect Code
     C                     MOVEL*BLANK    WN0472  6        THP Process Cod
     C                     MOVEL*BLANK    WN0473  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0474  6        PL Location Cod
     C                     MOVEL*BLANK    WN0475  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0476  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0477  3        HC Class Code
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWFHMNB    WGHMNB           BOH Company Num
     C                     Z-ADDWFBNNB    WGBNNB           BOH Buy Order N
     C                     Z-ADDWFBONB    WGBONB           BOL Load Number
     C                     Z-ADDWFCVNB    WGCVNB           TH Tattoo Numbe
     C                     Z-ADDWFB0DT    WGB0DT           TH Kill Date
      *
     C           KLCHSX    KLIST
     C                     KFLD           WGHMNB           BOH Company Num
     C                     KFLD           WGBNNB           BOH Buy Order N
     C                     KFLD           WGBONB           BOL Load Number
     C                     KFLD           WGCVNB           TH Tattoo Numbe
     C                     KFLD           WGB0DT           TH Kill Date
     C           KLCHSX    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SXEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YCRDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADD*ZERO     WGGHNB           TH Commission A
     C                     Z-ADD*ZERO     WGBTDT           TH Commission P
     C                     MOVEL'C'       WGR5ST    P      TH Commission S
     C                     MOVELWFAAVN    WGAAVN    P      RS User Changed
     C                     Z-ADDWFAADT    WGAADT           RS Date Changed
     C                     Z-ADDWFAMTM    WGAMTM           RS Time Changed
     C                     MOVELWFAJST    WGAJST    P      RS Record Statu
     C                     MOVELWFAHVN    WGAHVN    P      RS Job
     C                     MOVELWFAGVN    WGAGVN    P      RS Program
     C                     MOVELWFABVN    WGABVN    P      RS User Added
     C                     Z-ADDWFABDT    WGABDT           RS Date Added
     C                     Z-ADDWFABTM    WGABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * Rtv Tattoo Hdr Totls RT - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WUA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WUA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WUMCPR           Freight Tot Ded
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMHMNB    WQSY01           BOH Company Num
     C           *LIKE     DEFN WMBNNB    WQSY02           BOH Buy Order N
     C           *LIKE     DEFN WMBONB    WQSY03           BOL Load Number
     C           *LIKE     DEFN WMCVNB    WQSY04           TH Tattoo Numbe
     C           *LIKE     DEFN WMB0DT    WQSY05           TH Kill Date
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WQSY01           BOH Company Num
     C                     KFLD           WQSY02           BOH Buy Order N
     C                     KFLD           WQSY03           BOL Load Number
     C                     KFLD           WQSY04           TH Tattoo Numbe
     C                     KFLD           WQSY05           TH Kill Date
      * Setup key
     C                     Z-ADDWAHMNB    WQSY01           BOH Company Num
     C                     Z-ADDWABNNB    WQSY02           BOH Buy Order N
     C                     Z-ADDWABONB    WQSY03           BOL Load Number
     C                     Z-ADDWACVNB    WQSY04           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WQSY05           TH Kill Date
      * Establish starting position
     C           KRSSY     SETLL@CDCPIU                    *
     C           KRSSY     READE@CDCPIU                  90*
      * Data record not found
     C   90                MOVEL'PRK0174' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.@Status Include Dead Hd is No, dont include Dead
      *   |- c2    : DB1.THD UOM is Dead Head UOM
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           'Y'       IFEQ 'N'                        *IF
     C           WMEIST    IFEQ 'CH'                       *IF
     C           WMEIST    OREQ 'DH'
     C           WMEIST    OREQ 'DY'
     C           WMEIST    OREQ 'YH'
     C           WMEIST    OREQ 'KH'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.THD Expense Paid by is Producer
     C           WMPEST    IFEQ 'P'                        *IF
      * CASE: DB1.THD Unit Amt Sign is Add
     C           WMJBST    IFEQ '+'                        *IF
     C                     ADD  WMA0VA    WUA5VA           TH Additions Am
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  WMA0VA    WUASPR           TH Deduction Am
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.THD Expense Paid by is Seaboard
     C           WMPEST    IFEQ 'S'                        *IF
      * CASE: DB1.THD Expense Type is Freight
     C           WMPFST    IFEQ 'F'                        *IF
      * CASE: DB1.THD Unit Amt Sign is Add
     C           WMJBST    IFEQ '+'                        *IF
     C                     ADD  WMA0VA    WUMCPR           Freight Tot Ded
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  WMA0VA    WUMCPR           Freight Tot Ded
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.THD Expense Type is Other
     C           WMPFST    IFEQ 'O'                        *IF
      * CASE: DB1.THD Unit Amt Sign is Add
     C           WMJBST    IFEQ '+'                        *IF
     C                     ADD  WMA0VA    WUA7VA           TH Accrual Amou
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  WMA0VA    WUA7VA           TH Accrual Amou
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSY     READE@CDCPIU                  90*
     C                     ENDDO
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZCHRC    BEGSR
      *================================================================
      * Chg Tto Ded/Add/Net   CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0478  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0479 10        TH Group Refere
     C                     MOVEL*BLANK    WN0480  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0481  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0482  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0483  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0484  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0485  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0486  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0487  50       TH Held Over
     C                     Z-ADD*ZERO     WN0488  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0489  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0490  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0491  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0492  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0493  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0494  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0495  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0496  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0497  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0498  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0499  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0500  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0501  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0502  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0503  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0504  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0505  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0506  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0507  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0508  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0509  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0510  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0511  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0512  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0513  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0514  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0515  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0516  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0517  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0518  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0519  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0520  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0521  1        TH Header Error
     C                     MOVEL*BLANK    WN0522  1        TH Detail Error
     C                     MOVEL*BLANK    WN0523  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0524  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0525  80       TH Commission A
     C                     Z-ADD*ZERO     WN0526  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0527  1        TH User Error O
     C                     MOVEL*BLANK    WN0528  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0529  1        TH Sex
     C                     Z-ADD*ZERO     WN0530  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0531  70       TH Commission P
     C                     Z-ADD*ZERO     WN0532  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0533  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0534  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0535  31       TH FFLI
     C                     Z-ADD*ZERO     WN0536  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0537  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0538  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0539  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0540  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0541  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0542  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0543  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0544  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0545  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0546  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0547  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0548  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0549  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0550  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0551  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0552  1        TH Source Type
     C                     MOVEL*BLANK    WN0553  1        TH Scale Ticket
     C                     Z-ADD*ZERO     WN0554  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0555  3        TH Source Code
     C                     MOVEL*BLANK    WN0556  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0557  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0558  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0559  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0560  3        TH State
     C                     MOVEL*BLANK    WN0561  3        TH Unused Code
     C                     MOVEL*BLANK    WN0562  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0563  1        TH Commission S
     C                     MOVEL*BLANK    WN0564  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0565  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0566  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0567  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0568  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0569  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0570  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0571  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0572  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0573  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0574  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0575  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0576  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0577  3        TH PHA Average
     C                     MOVEL*BLANK    WN0578  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0579  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0580  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0581  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0582  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0583  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0584  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0585  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0586  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0587  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0588  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0589  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0590  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0591 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0592 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0593 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0594 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0595  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0596  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0597  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0598  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0599  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0600  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0601  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0602  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0603  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0604  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0605  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0606  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0607  70       TH Unused Date
     C                     MOVEL*BLANK    WN0608  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0609  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0610  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0611  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0612  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0613  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0614  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0615  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0616  6        DF Defect Code
     C                     MOVEL*BLANK    WN0617  6        THP Process Cod
     C                     MOVEL*BLANK    WN0618  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0619  6        PL Location Cod
     C                     MOVEL*BLANK    WN0620  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0621  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0622  3        HC Class Code
     C                     MOVEL*BLANK    WN0623 10        RS User Added
     C                     Z-ADD*ZERO     WN0624  70       RS Date Added
     C                     Z-ADD*ZERO     WN0625  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWAHMNB    WGHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WGBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WGBONB           BOL Load Number
     C                     Z-ADDWACVNB    WGCVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WGB0DT           TH Kill Date
      *
     C           KLCHSZ    KLIST
     C                     KFLD           WGHMNB           BOH Company Num
     C                     KFLD           WGBNNB           BOH Buy Order N
     C                     KFLD           WGBONB           BOL Load Number
     C                     KFLD           WGCVNB           TH Tattoo Numbe
     C                     KFLD           WGB0DT           TH Kill Date
     C           KLCHSZ    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SZEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YDRDCS
      * Move non-key fields to @A1CPC5
     C                     MOVELWACPST    WGCPST    P      TH Live Purchas
     C                     Z-ADDWAACPR    WGACPR           TH Live Purchas
     C                     Z-ADDWAB9PR    WGB9PR           TH Live Gross A
     C                     Z-ADDWUCAPR    WGCAPR           TH LIve Net Amt
     C                     Z-ADDWUASPR    WGASPR           TH Deduction Am
     C                     Z-ADDWUA4VA    WGA4VA           TH Total Net WO
     C                     Z-ADDWUATPR    WGATPR           TH Carcass Net
     C                     Z-ADDWUA5VA    WGA5VA           TH Additions Am
     C                     Z-ADDWACBPR    WGCBPR           TH Payment Gros
     C                     Z-ADDWUCCPR    WGCCPR           Th Payment Net
     C                     Z-ADDWUA7VA    WGA7VA           TH Accrual Amou
     C                     MOVELWAJWST    WGJWST    P      TH Calc Net Sts
     C                     MOVELWAJ9ST    WGJ9ST    P      TH Payment Type
     C                     MOVELWAAAVN    WGAAVN    P      RS User Changed
     C                     Z-ADDWAAADT    WGAADT           RS Date Changed
     C                     Z-ADDWAAMTM    WGAMTM           RS Time Changed
     C                     MOVELWAAJST    WGAJST    P      RS Record Statu
     C                     MOVELWAAHVN    WGAHVN    P      RS Job
     C                     MOVELWAAGVN    WGAGVN    P      RS Program
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WGAAVN           RS User Changed
     C                     Z-ADD##JDT     WGAADT           RS Date Changed
     C                     Z-ADD##JTM     WGAMTM           RS Time Changed
     C                     MOVEL##JOB     WGAHVN           RS Job
     C                     MOVEL##PGM     WGAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * H16853 ISE 11/09/2020 - Recompiled due to change in Buy Order Num
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Set Live Gross and Payment Gross to Zeros and all net's to zero
      *================================================================
     C                     Z-ADD*ZERO     WUB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WUCCPR           Th Payment Net
     C                     Z-ADD*ZERO     WUCAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WUATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WUA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WUA7VA           TH Accrual Amou
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDUDY     BEGSR
      *================================================================
      * Calculate duration, *DAYS
      *================================================================
     C           XDAY1     IFLT 1
     C           XDAY2     ORLT 1
     C                     Z-ADD0         XDURR
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     GOTO XDUDYE
     C                     END
     C           XDAY1     IFGE XDAY2
      * From date2 to date1
     C                     Z-ADDXDAY2     XABEG   60
     C                     Z-ADDXDAY1     XAEND   60
     C                     ELSE
      * From date1 to date2
     C                     Z-ADDXDAY1     XABEG   60
     C                     Z-ADDXDAY2     XAEND   60
     C                     END
     C           XDWSL     IFEQ 0
      * None days of week selected
     C                     Z-ADD0         XDURR
     C                     GOTO XDUDYC
     C                     END
     C           XAEND     SUB  XABEG     XDURR   80
     C           XDWSL     IFEQ 7
      * All days of week selected
     C                     GOTO XDUDYC
     C                     END
      * Some days of week selected
     C                     DIV  7         XDURR
     C                     MVR            XDLSW   10
     C                     MULT XDWSL     XDURR
     C           XDLSW     IFNE 0
      * Determine day of week of the beginning date
     C           XABEG     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
      * Loop: Increment the date by the last week
     C           XDLSW     DOWGT0
      * Increment the day of week
     C                     ADD  1         YY
     C                     SUB  1         XDLSW
      * Put day of week into the range 1-7
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     END
      * Selected day of the last week has been processed
     C           YDOW,YY   IFEQ XDSEL
      * Increment duration
     C                     ADD  1         XDURR
     C                     END
      * End of loop
     C                     END
     C                     END
     C           XDUDYC    TAG
     C           XDURR     IFEQ 0
      * Return Code: Unable to calculate duration
     C                     MOVEL'Y2U0060' W0RTN   7
     C                     ELSE
     C                     MOVEL*BLANK    W0RTN   7
     C                     END
      *================================================================
     CSR         XDUDYE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1KAST           TH Source Type
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WABNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WABONB           BOL Load Number
     C                     Z-ADD*ZERO     WACVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WAB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WAAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WAACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WAB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WACAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WAAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WAA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WACXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WACWNB           TH Head Receive
     C                     Z-ADD*ZERO     WAFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WAH9NB           TH Held Over
     C                     Z-ADD*ZERO     WAFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WAFENB           TH Head Killed
     C                     Z-ADD*ZERO     WAHENB           TH Head Adds
     C                     Z-ADD*ZERO     WAHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WACYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WALRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WAE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WAA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WAFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WAA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WAF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WAHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WAF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WAF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WAF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WAF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WAAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WAAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WACWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WAA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WAA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WAB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WAAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WAANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WAAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WAAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WAAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WAAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WAAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WAASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WAA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WAATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WAA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WACBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WACCPR           Th Payment Net
     C                     Z-ADD*ZERO     WALPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WACDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WAA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WAA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WAGHNB           TH Commission A
     C                     Z-ADD*ZERO     WABYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WABSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WABTDT           TH Commission P
     C                     Z-ADD*ZERO     WABUDT           TH Actual Check
     C                     Z-ADD*ZERO     WAHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WAHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WAHINB           TH FFLI
     C                     Z-ADD*ZERO     WAA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WAA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WAA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WAJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WAD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WAD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WAD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WAD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WAEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WAEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WAECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WAEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WAEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WAEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WAEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WAEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WAOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WATHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WAT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WATHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WAT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WAOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WAKOER           TH Head Identif
     C                     Z-ADD*ZERO     WAOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WAOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WAIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WAOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WAHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WAS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WATAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WATBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WAJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WAKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WAKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WAKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WAKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WAOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WAIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WAIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WAIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WAKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WAOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WAKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WAORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WAOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WAMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WAMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WANCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WANCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WAIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WAKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WAEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WAEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WAECDT           TH Head LFT
     C                     Z-ADD*ZERO     WAEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WAEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Define work field TH Live Gross Amt
     C                     Z-ADD*ZERO     WUB9PR  72
      * Define work field Th Payment Net Amt
     C                     Z-ADD*ZERO     WUCCPR  72
      * Define work field TH LIve Net Amt
     C                     Z-ADD*ZERO     WUCAPR  72
      * Define work field TH Carcass Net Amt
     C                     Z-ADD*ZERO     WUATPR  72
      * Define work field TH Total Net WO Adds
     C                     Z-ADD*ZERO     WUA4VA  72
      * Define work field TH Accrual Amount
     C                     Z-ADD*ZERO     WUA7VA  72
      * Define work field TH Payment Gross
     C                     Z-ADD*ZERO     WUCBPR  72
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBZCA1           PSDP Company Nu
     C                     Z-ADD*ZERO     WBA1VA           PSD Variable Am
     C                     Z-ADD*ZERO     WBC0DT           PSD Accept Date
     C                     Z-ADD*ZERO     WBC1DT           PSD Decline Dat
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      * Define work field Process Flag User
     C                     MOVEL*BLANK    WUYUST  1
      * Define work field Zero USR
     C                     Z-ADD*ZERO     WUE9NB  10
      * Define work field THP Process Code
     C                     MOVEL*BLANK    WUCSCD  6
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAEPR           DED Fixed Unit
     C                     Z-ADD*ZERO     WCOTNB           DED Ranking
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      * Define work field Record was selected usr
     C                     MOVEL*BLANK    WUMXST  1
      * Define work field BOH Buy Order Type
     C                     MOVEL*BLANK    WUA5ST  1
      * Define work field PC Contract Code
     C                     MOVEL*BLANK    WUAKCD  5
      * Define work field PSC Sub-Contract Code
     C                     MOVEL*BLANK    WUALCD  5
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WDBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WDARDT           BOH Buy Order D
     C                     Z-ADD*ZERO     WDASDT           BOH Kill Date
     C                     Z-ADD*ZERO     WDAAPR           BOH Market Add/
     C                     Z-ADD*ZERO     WDALPR           BOH Quoted Base
     C                     Z-ADD*ZERO     WDD5DT           BOH MPR Reporti
     C                     Z-ADD*ZERO     WDD6DT           BOH Hedge Date
     C                     Z-ADD*ZERO     WDD7DT           BOH Unused Date
     C                     Z-ADD*ZERO     WDD8DT           BOH Unused Date
     C                     Z-ADD*ZERO     WDD9DT           BOH Unused Date
     C                     Z-ADD*ZERO     WDJOEJ           BOH Hedge Head
     C                     Z-ADD*ZERO     WDKOFF           BOH Hedge Refer
     C                     Z-ADD*ZERO     WDKWPE           BOH Hedge Time
     C                     Z-ADD*ZERO     WDIMBF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WDOPTR           BOH Unused Nbr
     C                     Z-ADD*ZERO     WDOEJD           BOH Unused Nbr
     C                     Z-ADD*ZERO     WDIRMF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WDJIRM           BOH Unused Nbr
     C                     Z-ADD*ZERO     WDJRKF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WDKFIR           BOH Unused Nbr
     C                     Z-ADD*ZERO     WDHXNB           PPWS Company Nu
     C                     Z-ADD*ZERO     WDGANB           CW Year
     C                     Z-ADD*ZERO     WDGBNB           CW Week Number
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
      * Define work field THD Expense Type
     C                     MOVEL*BLANK    WUPFST  1
      * Define work field THD Commission Deduction
     C                     MOVEL*BLANK    WUPIST  1
      * Define work field THD Expense Paid by
     C                     MOVEL*BLANK    WUPEST  1
      * Define work field Trans Extended Amt Usr
     C                     Z-ADD*ZERO     WUCFPR  72
      * Define work field Net Head Usr
     C                     Z-ADD*ZERO     WUF6NB  50
      * Define work field Yard dead weight      USR
     C                     Z-ADD*ZERO     WUCCNB  71
      * Define work field Live Weight           USR
     C                     Z-ADD*ZERO     WUOONB  71
      * Define work field Net Live Weight Usr
     C                     Z-ADD*ZERO     WUVBNB  71
      * Define work field Hd Cnt Org Ship Usr
     C                     Z-ADD*ZERO     WUEXNB  50
      * Define work field Avg Weight USR
     C                     Z-ADD*ZERO     WUY9NB  51
      * Define work field Doa's Avg Weight Usr
     C                     Z-ADD*ZERO     WUEVNB  71
      * Define work field Ship Wgt Tot Usr
     C                     Z-ADD*ZERO     WUZ4NB  71
      * Define work field Base Mkt Prc Amt Tot USR
     C                     Z-ADD*ZERO     WUCSPR  92
      * Define work field THD Deferred Payment
     C                     MOVEL*BLANK    WUPJST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WEBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WEBONB           BOL Load Number
     C                     Z-ADD*ZERO     WECVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WEB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WEAZVA           THD Unit Amt
     C                     Z-ADD*ZERO     WEA0VA           THD Ded/Add Amo
     C                     Z-ADD*ZERO     WEAQNB           THD Re-imbursem
     C                     Z-ADD*ZERO     WEAADT           RS Date Changed
     C                     Z-ADD*ZERO     WEAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WEABDT           RS Date Added
     C                     Z-ADD*ZERO     WEABTM           RS Time Added
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Blank USR
     C                     MOVEL*BLANK    WUCRTX 80
      * Define work field Re-imbursement head totl
     C                     Z-ADD*ZERO     WUDDNB  50
      * Define work field Re-imbursement hd NEW USR
     C                     Z-ADD*ZERO     WUDENB  50
      * Define work field Re-imbursement Price  USR
     C                     Z-ADD*ZERO     WULLPR  72
      * Define work field Re-imbursement Wgt    USR
     C                     Z-ADD*ZERO     WUDWNB  50
      * Define work field Re-imbursement full   USR
     C                     Z-ADD*ZERO     WUDFNB  50
      * Define work field Re-imbursement half   USR
     C                     Z-ADD*ZERO     WUDGNB  50
      * Define work field Trans Unit Amt Usr
     C                     Z-ADD*ZERO     WUCEPR  72
      * Define work field THD Re-imbursement Head
     C                     Z-ADD*ZERO     WUAQNB  50
      * Define work field PSC Break Even Percent
     C                     Z-ADD*ZERO     WUA7PR  52
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJAHDT           PSC Date
     C                     Z-ADD*ZERO     WJAZPR           PSC Floor Price
     C                     Z-ADD*ZERO     WJA0PR           PSC Ceiling Pri
     C                     Z-ADD*ZERO     WJA9PC           PSC Market Perc
     C                     Z-ADD*ZERO     WJA7PR           PSC Break Even
     C                     Z-ADD*ZERO     WJA8PR           PSC FLoor Price
     C                     Z-ADD*ZERO     WJA9PR           PSC Mkt Percent
     C                     Z-ADD*ZERO     WJF6PR           PSC Mkt + or -
     C                     Z-ADD*ZERO     WJAADT           RS Date Changed
     C                     Z-ADD*ZERO     WJAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WJABDT           RS Date Added
     C                     Z-ADD*ZERO     WJABTM           RS Time Added
      * Define work field Deferred Price Usr
     C                     Z-ADD*ZERO     WUU5PR  52
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKDJDT           PFP Week Ending
     C                     Z-ADD*ZERO     WKOCPR           PFP Base Floor
     C                     Z-ADD*ZERO     WKODPR           PFP Adjusted Fl
     C                     Z-ADD*ZERO     WKOEPR           PFP Week Avg Fl
     C                     Z-ADD*ZERO     WKOFPR           PFP Unused Pric
     C                     Z-ADD*ZERO     WKOGPR           PFP Unused Pric
     C                     Z-ADD*ZERO     WKOHPR           PFP Unused Pric
     C                     Z-ADD*ZERO     WKOIPR           PFP Unused Pric
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLEJVA           PAH Account Bal
     C                     Z-ADD*ZERO     WLDLDT           PAH Activation
     C                     Z-ADD*ZERO     WLAADT           RS Date Changed
     C                     Z-ADD*ZERO     WLAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WLABDT           RS Date Added
     C                     Z-ADD*ZERO     WLABTM           RS Time Added
      * Define work field TH Deduction Amt
     C                     Z-ADD*ZERO     WUASPR  72
      * Define work field TH Additions Amt
     C                     Z-ADD*ZERO     WUA5VA  72
      * Define work field Freight Tot Ded/Add Exp
     C                     Z-ADD*ZERO     WUMCPR  72
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WB02 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WA02 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA03 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA   152       *Synon (15,2) w
     C                     MOVEL'N'       W0PMT   1
      * Define local work field Kill Date Usr
     C                     Z-ADD*ZERO     YL0001  70
      * Define local work field Held Over Days USR
     C                     Z-ADD*ZERO     YL0002  50
      * Define local work field Trans Extended Amt Usr
     C                     Z-ADD*ZERO     YL0003  72
      *================================================================
     CSR         ZZEXIT    ENDSR
