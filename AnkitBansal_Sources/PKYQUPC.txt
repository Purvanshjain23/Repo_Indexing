/********************************************************************/
/*                                                                  */
/*  SYNOPSIS - CL PROGRAM FOR CALCULATING STANDARD DEVIATION        */
/*                                                                  */
/*  SYSTEM    - HOG PROCUREMENT AND EVALUATION                      */
/*  DATE      - 03/17/00                                            */
/*  DEVELOPER - PURVA DROGE                                         */
/*                                                                  */
/********************************************************************/
/* MODIFICATIONS:                                                   */
/********************************************************************/
             PGM        PARM(&CO &TYPE &FDTE &TDTE &MO &WK)

/* PARAMETERS */
             DCL        VAR(&CO) TYPE(*DEC) LEN(3 0)
             DCL        VAR(&TYPE) TYPE(*CHAR) LEN(1)
             DCL        VAR(&FDTE) TYPE(*DEC) LEN(7 0)
             DCL        VAR(&TDTE) TYPE(*DEC) LEN(7 0)
             DCL        VAR(&MO) TYPE(*DEC) LEN(2 0)
             DCL        VAR(&WK) TYPE(*DEC) LEN(2 0)

/* WORK FIELDS */
             DCL        VAR(&COX) TYPE(*CHAR) LEN(3)
             DCL        VAR(&FDTEX) TYPE(*CHAR) LEN(7)
             DCL        VAR(&TDTEX) TYPE(*CHAR) LEN(7)
             DCL        VAR(&MOX) TYPE(*CHAR) LEN(2)
             DCL        VAR(&WKX) TYPE(*CHAR) LEN(2)

             DCL        VAR(&SEL)  TYPE(*CHAR) LEN(1500)

/********************************************************************/
/* INITIALIZE                                                       */
/********************************************************************/
/* CONVERT DATES */
             CHGVAR     VAR(&COX) VALUE(&CO)
             CHGVAR     VAR(&FDTEX) VALUE(&FDTE)
             CHGVAR     VAR(&TDTEX) VALUE(&TDTE)
             CHGVAR     VAR(&MOX) VALUE(&MO)
             CHGVAR     VAR(&WKX) VALUE(&WK)

/********************************************************************/
/* CREATE RECORDS FOR ALL                                           */
/********************************************************************/

             CHGVAR     VAR(&SEL) VALUE('SELECT B1HMNB, "' *CAT +
                          &TYPE *CAT '" LEN(1) NAME(TYPE),' *BCAT +
                          &FDTEX *BCAT 'LEN(7,0) NAME(FDTE),' *BCAT +
                          &TDTEX *BCAT 'LEN(7,0) NAME(TDTE), "*" +
                          NAME(B1K2ST), "*ALL" NAME(B1ABCD), "*ALL" +
                          NAME(B1HVCD), COUNT(*) LEN(7,0) +
                          NAME(KILLED), AVG(B1EWNB) LEN(5,1) +
                          NAME(HTWT), SDEV(B1EWNB) LEN(9,5) +
                          NAME(SHTWT), AVG(B1AUPC) LEN(3,1)  +
                          NAME(LNPCT), SDEV(B1AUPC) LEN(9,5) +
                          NAME(SLNPCT), AVG(B1H6NB) LEN(3,1) +
                          NAME(BKFT), SDEV(B1H6NB) LEN(9,5)  +
                          NAME(SBKFT), AVG(B1BEPC) LEN(3,1) +
                          NAME(LNEY), SDEV(B1BEPC) LEN(9,5) +
                          NAME(SLNEY), +
                          AVG(((((B1EWNB/.76)-245)*.00036)+.75)*100) +
                          LEN(5,2) NAME(YIELD), +
                          SDEV(((((B1EWNB/.76)-245)*.00036)+.75)*100) +
                          LEN(9,5) NAME(SYLD),' *BCAT &MOX *BCAT +
                          'LEN(2,0) NAME(MO),' *BCAT &WKX *BCAT +
                          'LEN(2,0) NAME(WK) FROM PKB1CPP WHERE +
                          B1B0DT>=' *CAT &FDTEX *BCAT 'AND' *BCAT +
                          'B1B0DT<=' *CAT &TDTEX *BCAT 'AND' *BCAT +
                          'B1HMNB=' *CAT &COX *BCAT 'GROUP BY +
                          B1HMNB, B1ABCD, B1HVCD ORDER BY +
                          B1HMNB, B1ABCD, B1HVCD')

             INSERT     INTO(PKEYCPP) FIELDS(*ALL) SQL(&SEL) +
                          SETVAR((&EYALA1 B1HMNB) (&EYV3ST TYPE) +
                          (&EYENDT FDTE) (&EYEODT TDTE) (&EYV1ST +
                          B1K2ST) (&EYH0CD B1ABCD) (&EYH1CD B1HVCD) +
                          (&EYAOA1 KILLED) (&EYAPA1 HTWT) (&EYAQA1 +
                          SHTWT) (&EYH5PC LNPCT) (&EYARA1 SLNPCT) +
                          (&EYAUA1 BKFT) (&EYASA1 SBKFT) (&EYH6PC +
                          LNEY) (&EYATA1 SLNEY) (&EYH7PC YIELD) +
                          (&EYAVA1 SYLD) (&EYAWA1 MO) (&EYANA1 WK))

/********************************************************************/
/* END OF PROGRAM                                                   */
/********************************************************************/
 ENDPGM:
             MONMSG     MSGID(CPF0000)

             ENDPGM
