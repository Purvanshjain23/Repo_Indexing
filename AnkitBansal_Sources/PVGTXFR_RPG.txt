     H/TITLE Prc Create Dtl Receipt2XF Execute external functio
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) BNDDIR(YBNDDIR) DBGVIEW(*SOURCE)
     Z* CVTOPT(*DATETIME) ACTGRP(*CALLER) OPTIMIZE(*BASIC)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Execute external function
     H* Object type   : *PGM
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 08/16/24  Time  : 14:26:13
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPUC6REL1  IF   E           K DISK
      * RTV : OMS Transformation Ctl    Retrieval index
      *
     FCABZREL1  IF   E           K DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAAMREL1  IF   E           K DISK
      * RTV : Unit of Measure           Retrieval index       NV
      *
     FCAB0REL1  IF   E           K DISK
      * RTV : Item Balance              Retrieval index       NV
      *
     FCAB7CPLE  IF   E           K DISK
      * RSQ : Item Transaction Detail   Normal KEY Sequence (D)
      *
     FCAB7CPL1  IF   E           K DISK
      * RTV : Item Transaction Detail   Retrieval index       NV
      *
     FCAB1REL0  IF   E           K DISK
      * RTV : Item Balance Detail       Retrieval index       NV
      *
     FCAADREL1  IF   E           K DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FCAB1REL4  IF   E           K DISK
      * RTV : Item Balance Detail       Active only
      *
     FCAB7CPL0  IF A E           K DISK
      * UPD : Item Transaction Detail   Update index
      *
     FCAB0REL0  UF   E           K DISK
      * UPD : Item Balance              Update index
      *
     FCAB1REL1  UF A E           K DISK
      * UPD : Item Balance Detail       Update index
      *
      * Long constants
     D @CN#            S              6    DIM(01)CTDATA PERRCD(1)
     D @CN             S             25    DIM(01) ALT(@CN#)
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
     D QCAB71        E DS                  EXTNAME(CAB7CPL0)
      * UPD : Item Transaction Detail   Update index
      * Renamed input format fields
     D  WFAIC3       E                     EXTFLD(B7AIC3)
     D  WFHGCD       E                     EXTFLD(B7HGCD)
     D  WFAJCD       E                     EXTFLD(B7AJCD)
     D  WFW9ST       E                     EXTFLD(B7W9ST)
     D  WFBSST       E                     EXTFLD(B7BSST)
     D  WFB4DT       E                     EXTFLD(B7B4DT)
     D  WFC4NY       E                     EXTFLD(B7C4NY)
     D  WFDXNB       E                     EXTFLD(B7DXNB)
     D  WFELDT       E                     EXTFLD(B7ELDT)
     D  WFHVCD       E                     EXTFLD(B7HVCD)
     D  WFF1ST       E                     EXTFLD(B7F1ST)
     D  WFAUNA       E                     EXTFLD(B7AUNA)
     D  WFA5QT       E                     EXTFLD(B7A5QT)
     D  WFAHWG       E                     EXTFLD(B7AHWG)
     D  WFAKCS       E                     EXTFLD(B7AKCS)
     D  WFCGCD       E                     EXTFLD(B7CGCD)
     D  WFAYVA       E                     EXTFLD(B7AYVA)
     D  WFBJNA       E                     EXTFLD(B7BJNA)
     D  WFCKNB       E                     EXTFLD(B7CKNB)
     D  WFBMST       E                     EXTFLD(B7BMST)
     D  WFCQCD       E                     EXTFLD(B7CQCD)
     D  WFDTCD       E                     EXTFLD(B7DTCD)
     D  WFMGNA       E                     EXTFLD(B7MGNA)
     D  WFTRBN       E                     EXTFLD(B7TRBN)
     D  WFTRBS       E                     EXTFLD(B7TRBS)
     D  WFC4NB       E                     EXTFLD(B7C4NB)
     D  WFRINB       E                     EXTFLD(B7RINB)
     D  WFRHNB       E                     EXTFLD(B7RHNB)
     D  WFRGNB       E                     EXTFLD(B7RGNB)
     D  WFM3NA       E                     EXTFLD(B7M3NA)
     D  WFAWTM       E                     EXTFLD(B7AWTM)
     D  WFXLCD       E                     EXTFLD(B7XLCD)
     D  WFK7DT       E                     EXTFLD(B7K7DT)
     D  WFUVST       E                     EXTFLD(B7UVST)
     D  WFUWST       E                     EXTFLD(B7UWST)
     D  WFUXST       E                     EXTFLD(B7UXST)
     D  WFVSST       E                     EXTFLD(B7VSST)
     D  WFAATM       E                     EXTFLD(B7AATM)
     D  WFAYNA       E                     EXTFLD(B7AYNA)
     D  WFA0NA       E                     EXTFLD(B7A0NA)
     D  WFAXDT       E                     EXTFLD(B7AXDT)
      *
     D QCAB01        E DS                  EXTNAME(CAB0REL0)
      * UPD : Item Balance              Update index
      * Renamed input format fields
     D  WHAIC3       E                     EXTFLD(B0AIC3)
     D  WHHGCD       E                     EXTFLD(B0HGCD)
     D  WHAJCD       E                     EXTFLD(B0AJCD)
     D  WHAGCS       E                     EXTFLD(B0AGCS)
     D  WHAECS       E                     EXTFLD(B0AECS)
     D  WHBACS       E                     EXTFLD(B0BACS)
     D  WHBBCS       E                     EXTFLD(B0BBCS)
     D  WHCBPR       E                     EXTFLD(B0CBPR)
     D  WHGUDT       E                     EXTFLD(B0GUDT)
     D  WHXYST       E                     EXTFLD(B0XYST)
     D  WHCTPR       E                     EXTFLD(B0CTPR)
     D  WHG4DT       E                     EXTFLD(B0G4DT)
     D  WHBOWG       E                     EXTFLD(B0BOWG)
     D  WHDDQT       E                     EXTFLD(B0DDQT)
     D  WHDEQT       E                     EXTFLD(B0DEQT)
     D  WHDFQT       E                     EXTFLD(B0DFQT)
     D  WHHDQT       E                     EXTFLD(B0HDQT)
     D  WHHEQT       E                     EXTFLD(B0HEQT)
     D  WHAJQT       E                     EXTFLD(B0AJQT)
     D  WHAQQT       E                     EXTFLD(B0AQQT)
     D  WHAUQT       E                     EXTFLD(B0AUQT)
     D  WHEMQT       E                     EXTFLD(B0EMQT)
     D  WHDOQT       E                     EXTFLD(B0DOQT)
     D  WHATNA       E                     EXTFLD(B0ATNA)
     D  WHAKDT       E                     EXTFLD(B0AKDT)
     D  WHANDT       E                     EXTFLD(B0ANDT)
     D  WHIDVA       E                     EXTFLD(B0IDVA)
     D  WHJVST       E                     EXTFLD(B0JVST)
     D  WHBZPC       E                     EXTFLD(B0BZPC)
     D  WHDGQT       E                     EXTFLD(B0DGQT)
     D  WHDIDT       E                     EXTFLD(B0DIDT)
     D  WHALCD       E                     EXTFLD(B0ALCD)
     D  WHBFDY       E                     EXTFLD(B0BFDY)
     D  WHDJDT       E                     EXTFLD(B0DJDT)
     D  WHBGDY       E                     EXTFLD(B0BGDY)
     D  WHDKDT       E                     EXTFLD(B0DKDT)
     D  WHJ2ST       E                     EXTFLD(B0J2ST)
     D  WHDJQT       E                     EXTFLD(B0DJQT)
     D  WHBNWG       E                     EXTFLD(B0BNWG)
     D  WHDLDT       E                     EXTFLD(B0DLDT)
     D  WHDPQT       E                     EXTFLD(B0DPQT)
     D  WHDQQT       E                     EXTFLD(B0DQQT)
     D  WHDMDT       E                     EXTFLD(B0DMDT)
     D  WHM0ST       E                     EXTFLD(B0M0ST)
     D  WHJ9ST       E                     EXTFLD(B0J9ST)
     D  WHKBST       E                     EXTFLD(B0KBST)
     D  WHAKC8       E                     EXTFLD(B0AKC8)
     D  WHRINB       E                     EXTFLD(B0RINB)
     D  WHRHNB       E                     EXTFLD(B0RHNB)
     D  WHRGNB       E                     EXTFLD(B0RGNB)
     D  WHUVST       E                     EXTFLD(B0UVST)
     D  WHUWST       E                     EXTFLD(B0UWST)
     D  WHUXST       E                     EXTFLD(B0UXST)
     D  WHVSST       E                     EXTFLD(B0VSST)
     D  WHAATM       E                     EXTFLD(B0AATM)
     D  WHAYNA       E                     EXTFLD(B0AYNA)
     D  WHA0NA       E                     EXTFLD(B0A0NA)
     D  WHAXDT       E                     EXTFLD(B0AXDT)
      *
     D YARDCS          DS           245
      * Message data for message Y2U0009.
     D MD0009          DS
     D  MDPGM                  1     10
     D  MDACP                 11     20
     D  MDFMT                 21     30
     D  MDACT                 31     34
     D  MDLBL                 35     40
     D QCAB11        E DS                  EXTNAME(CAB1REL1)
      * UPD : Item Balance Detail       Update index
      * Renamed input format fields
     D  WJAIC3       E                     EXTFLD(B1AIC3)
     D  WJHGCD       E                     EXTFLD(B1HGCD)
     D  WJAJCD       E                     EXTFLD(B1AJCD)
     D  WJELDT       E                     EXTFLD(B1ELDT)
     D  WJABWG       E                     EXTFLD(B1ABWG)
     D  WJAGQT       E                     EXTFLD(B1AGQT)
     D  WJAHQT       E                     EXTFLD(B1AHQT)
     D  WJAIQT       E                     EXTFLD(B1AIQT)
     D  WJCTST       E                     EXTFLD(B1CTST)
     D  WJACWG       E                     EXTFLD(B1ACWG)
     D  WJARQT       E                     EXTFLD(B1ARQT)
     D  WJASQT       E                     EXTFLD(B1ASQT)
     D  WJATQT       E                     EXTFLD(B1ATQT)
     D  WJHDQT       E                     EXTFLD(B1HDQT)
     D  WJHEQT       E                     EXTFLD(B1HEQT)
     D  WJF6ST       E                     EXTFLD(B1F6ST)
     D  WJBMWG       E                     EXTFLD(B1BMWG)
     D  WJDSQT       E                     EXTFLD(B1DSQT)
     D  WJDTQT       E                     EXTFLD(B1DTQT)
     D  WJDUQT       E                     EXTFLD(B1DUQT)
     D  WJDHDT       E                     EXTFLD(B1DHDT)
     D  WJAGCS       E                     EXTFLD(B1AGCS)
     D  WJAECS       E                     EXTFLD(B1AECS)
     D  WJIDVA       E                     EXTFLD(B1IDVA)
     D  WJK7DT       E                     EXTFLD(B1K7DT)
     D  WJRINB       E                     EXTFLD(B1RINB)
     D  WJRHNB       E                     EXTFLD(B1RHNB)
     D  WJRGNB       E                     EXTFLD(B1RGNB)
     D  WJUVST       E                     EXTFLD(B1UVST)
     D  WJUWST       E                     EXTFLD(B1UWST)
     D  WJUXST       E                     EXTFLD(B1UXST)
     D  WJVSST       E                     EXTFLD(B1VSST)
     D  WJAATM       E                     EXTFLD(B1AATM)
     D  WJAYNA       E                     EXTFLD(B1AYNA)
     D  WJA0NA       E                     EXTFLD(B1A0NA)
     D  WJAXDT       E                     EXTFLD(B1AXDT)
      *
     D YBRDCS          DS           163
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  YL0001         S              1
     D  XDTSDL         S             26
     D  YN0001         S             30
     D  YN0002         S             30
     D  YL0002         S              2
     D  YN0003         S              9  4
     D  YN0004         S              1
     D  YN0005         S              2
     D  YN0006         S              9  4
     D  YN0007         S              1
     D  YN0008         S              2
     D  YN0009         S              2
     D  YN0010         S             11  2
     D  YN0011         S              1
     D  YN0012         S              1
     D  YL0003         S              3  0
     D  YL0004         S              3  0
     D  YL0005         S              3  0
     D  YN0013         S              3
     D  YN0014         S              3
     D  YN0015         S              5  2
     D  YL0006         S             30
     D  YL0007         S             11  4
     D  YN0016         S              1
     D  YN0017         S              1
     D  YN0018         S              8  0
     D  YN0019         S              1
     D  YL0008         S             11  2
     D  YL0009         S              5  0
     D  WQSE01         S                   LIKE(WEAIC3)
     D  WQSE02         S                   LIKE(WEHGCD)
     D  WQSE03         S                   LIKE(WEAJCD)
     D  WQSE04         S                   LIKE(WEW9ST)
     D  WQSE05         S                   LIKE(WEBSST)
     D  WQSE06         S                   LIKE(WEB4DT)
     D  WN0001         S              6  0
     D  WN0002         S             10
     D  WN0003         S             10
     D  WN0004         S              7  0
     D  WN0005         S              2  0
     D  WN0006         S             11  2
     D  WN0007         S              5  0
     D  WN0008         S              7  0
     D  WN0009         S              1
     D  ZADFMF         S             10
     D  WQ0001         S              3  0
     D  WQ0002         S              7  0
     D  WQ0003         S              3
     D  WQ0004         S              1
     D  WQ0005         S              2
     D  WQ0006         S              7  0
     D  WQ0007         S              3  0
     D  WQ0008         S              7  0
     D  WQ0009         S              2
     D  WQ0010         S              2
     D  WQ0011         S             30
     D  WQ0012         S             11  2
     D  WQ0013         S             11  2
     D  WQ0014         S             11  4
     D  WQ0015         S              2
     D  WQ0016         S             11  2
     D  WQ0017         S              6
     D  WQ0018         S              8  0
     D  WQ0019         S              1
     D  WQ0020         S              3
     D  WQ0021         S             15
     D  WQ0022         S             10
     D  WQ0023         S              7  0
     D  WQ0024         S              3  0
     D  WQ0025         S              7  0
     D  WQ0026         S              3  0
     D  WQ0027         S              3  0
     D  WQ0028         S              3  0
     D  WQ0029         S             10
     D  WQ0030         S              6  0
     D  WQ0031         S              1
     D  WQ0032         S              7  0
     D  WQ0033         S              1
     D  WQ0034         S              6  0
     D  WQ0035         S              7  0
     D  W0CLPG         S             10
     D  WN0010         S              2
     D  WN0011         S             11  2
     D  WN0012         S              1
     D  WN0013         S             30
     D  WN0014         S              2
     D  WN0015         S              9  4
     D  WN0016         S              1
     D  WN0017         S              2
     D  WN0018         S              9  4
     D  WN0019         S              1
     D  WN0020         S              2
     D  WN0021         S              2
     D  WN0022         S             11  2
     D  WN0023         S              1
     D  WN0024         S              1
     D  WN0025         S              3  0
     D  WN0026         S              3  0
     D  WN0027         S              3  0
     D  WN0028         S             11  2
     D  WN0029         S             11  2
     D  WN0030         S             11  2
     D  WN0031         S             11  2
     D  WN0032         S             11  4
     D  WUAWNA         S             30
     D  WUAICD         S              2
     D  WUCHTM         S              5  2
     D  WL0001         S              3  0
     D  WL0002         S              7  0
     D  WL0003         S             30
     D  WL0004         S             30
     D  WL0005         S              2
     D  WL0006         S              9  4
     D  WL0007         S              1
     D  WL0008         S              2
     D  WL0009         S              9  4
     D  WL0010         S              1
     D  WL0011         S              2
     D  WL0012         S              2
     D  WL0013         S             11  2
     D  WL0014         S              1
     D  WL0015         S              1
     D  WL0016         S              5  2
     D  WUIDVA         S             11  2
     D  WL0017         S              3  0
     D  WL0018         S              7  0
     D  WL0019         S              3
     D  WL0020         S             11  4
     D  WL0021         S             11  2
     D  WL0022         S             11  2
     D  WL0023         S             11  2
     D  WL0024         S             11  2
     D  WL0025         S             11  2
     D  WN0033         S             11  2
     D  WN0034         S             11  2
     D  WN0035         S             11  2
     D  WN0036         S             11  4
     D  WN0037         S             11  4
     D  WN0038         S             11  4
     D  WN0039         S             11  2
     D  WN0040         S             11  2
     D  WN0041         S             11  2
     D  WN0042         S             11  2
     D  WN0043         S             11  4
     D  WN0044         S             11  4
     D  WN0045         S             11  4
     D  WN0046         S             11  2
     D  WN0047         S             11  2
     D  WN0048         S             11  2
     D  YARDC          S              1
     D  WN0049         S             11  2
     D  WN0050         S             11  2
     D  WN0051         S             11  2
     D  WN0052         S             11  2
     D  WN0053         S             11  4
     D  WN0054         S             11  4
     D  WN0055         S             11  2
     D  WN0056         S              1
     D  WUW0NB         S             30  5
     D  WL0026         S              3  0
     D  WL0027         S              7  0
     D  WL0028         S              3
     D  WL0029         S              7  0
     D  WL0030         S             11  2
     D  WL0031         S             11  2
     D  WL0032         S             11  2
     D  WL0033         S             11  2
     D  WL0034         S              1
     D  WL0035         S             11  2
     D  WL0036         S             11  2
     D  WL0037         S             11  2
     D  WL0038         S             11  2
     D  WL0039         S             11  2
     D  WL0040         S             11  2
     D  WL0041         S              1
     D  WL0042         S             11  2
     D  WL0043         S             11  2
     D  WL0044         S             11  2
     D  WL0045         S             11  2
     D  WL0046         S              7  0
     D  WL0047         S             11  4
     D  WL0048         S             11  4
     D  WL0049         S             11  2
     D  WL0050         S              7  0
     D  WL0051         S              3  0
     D  WL0052         S              3  0
     D  WL0053         S              3  0
     D  WL0054         S              1
     D  WL0055         S              1
     D  WL0056         S              1
     D  WL0057         S              1
     D  WN0057         S              6  0
     D  WN0058         S             10
     D  WN0059         S             10
     D  WN0060         S              7  0
     D  WQ0036         S             15  5
     D  WQ0037         S             15  5
     D  WQ0038         S              3  0
     D  WQ0039         S              7  0
     D  WQ0040         S              3
     D  WQ0041         S              7  0
     D  WQ0042         S              7  0
     D  WQ0043         S              2
     D  WQ0044         S             11  2
     D  WQ0045         S             11  4
     D  WQ0046         S              2
     D  WQ0047         S              3  0
     D  WQ0048         S              3  0
     D  WQ0049         S              3  0
     D  WQ0050         S              1
     D  WQ0051         S              7  0
     D  WL0058         S              3
     D  WL0059         S              1
     D  Y0CX01         S              1
     D  WL0060         S              3  0
     D  WL0061         S              7  0
     D  WL0062         S              3
     D  WL0063         S              7  0
     D  WN0061         S              7  0
     D  WN0062         S              1
     D  WN0063         S              1
     D  WN0064         S              1
     D  WN0065         S              1
     D  WN0066         S              6  0
     D  WN0067         S             10
     D  WN0068         S             10
     D  WN0069         S              7  0
     D  YBRDC          S              1
     D  WUNFNN         S              7  0
     D  WL0064         S              3  0
     D  WL0065         S              7  0
     D  WL0066         S              3
     D  WL0067         S             11  2
     D  WL0068         S             11  2
     D  WL0069         S             11  2
     D  WL0070         S             11  2
     D  WL0071         S             11  2
     D  WQSP01         S                   LIKE(WLAIC3)
     D  WQSP02         S                   LIKE(WLHGCD)
     D  WQSP03         S                   LIKE(WLAJCD)
     D  ZAPGMQ         S             10
     D  ZAPGRL         S              5
     D  ZAMSID         S              7
     D  ZAMSGF         S             10
     D  ZAMSTP         S              7
     D  YILE           S              1
     D  W0PMT          S              1
      /EJECT
      * Parameter declarations
     D P1PARM          DS            88
      * RCD: PAR API Inb Manual Adj
      * I :  Company Number
     D  P1AIC3                 1      2P 0
      * I :  Item Code
     D  P1HGCD                 3      6P 0
      * I :  Ship From Warehouse
     D  P1VPCD                 7      9
      * I :  WIM Inventory Trans ID
     D  P1NOSC                10     12
      * I :  WIM Inventory Trans Type
     D  P1NPSC                13     15
      * I :  Transaction Date
     D  P1A9DT                16     19P 0
      * I :  Production Date
     D  P1ELDT                20     23P 0
      * I :  Item Transaction Source
     D  P1F1ST                24     25
      * I :  Transaction Description
     D  P1VQNA                26     55
      * I :  Transaction Reason Code
     D  P1A1AB                56     58
      * I :  Order Number
     D  P1C4NB                59     62P 0
      * I :  Shift Number
     D  P1XLCD                63     63
      * I :  Transaction Weight
     D  P1AHWG                64     69P 2
      * I :  Transaction Quantity
     D  P1A5QT                70     75P 2
      * I :  Update Program Code USR
     D  P1FPAB                76     78
     D                 DS
     D  ZAMSDA                 1    132
     I@C6REMK
      * OMS Transformation Ctl    Retrieval index
      * Renamed input format fields
     I              C6B3AB                      WAB3AB
     I              C6HUNZ                      WAHUNZ
     I              C6OCSC                      WAOCSC
     I              C6UNU1                      WAUNU1
     I              C6VSST                      WAVSST
     I              C6BGTS                      WABGTS
     I              C6RUU1                      WARUU1
     I              C6RVU1                      WARVU1
     I              C6BHTS                      WABHTS
     I              C6RWU1                      WARWU1
     I              C6RXU1                      WARXU1
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                      WBAIC3
     I              BZHGCD                      WBHGCD
     I              BZAVNA                      WBAVNA
     I              BZAWNA                      WBAWNA
     I              BZL7NA                      WBL7NA
     I              BZL8NA                      WBL8NA
     I              BZL6NA                      WBL6NA
     I              BZMFNA                      WBMFNA
     I              BZADCD                      WBADCD
     I              BZAWPC                      WBAWPC
     I              BZLXST                      WBLXST
     I              BZAECD                      WBAECD
     I              BZAXPC                      WBAXPC
     I              BZLYST                      WBLYST
     I              BZAFCD                      WBAFCD
     I              BZAICD                      WBAICD
     I              BZAIWG                      WBAIWG
     I              BZHICD                      WBHICD
     I              BZRBCD                      WBRBCD
     I              BZFZST                      WBFZST
     I              BZAVST                      WBAVST
     I              BZCZWG                      WBCZWG
     I              BZC0WG                      WBC0WG
     I              BZURTN                      WBURTN
     I              BZAJC8                      WBAJC8
     I              BZRINB                      WBRINB
     I              BZRHNB                      WBRHNB
     I              BZRGNB                      WBRGNB
     I              BZLNCD                      WBLNCD
     I              BZTFNB                      WBTFNB
     I              BZN0CD                      WBN0CD
     I              BZX4ST                      WBX4ST
     I              BZTMVA                      WBTMVA
     I              BZTNVA                      WBTNVA
     I              BZBLPR                      WBBLPR
     I              BZBMPR                      WBBMPR
     I              BZLRCD                      WBLRCD
     I              BZU9ST                      WBU9ST
     I              BZCMCO                      WBCMCO
     I              BZQ1CD                      WBQ1CD
     I              BZQ8CD                      WBQ8CD
     I              BZCHTM                      WBCHTM
     I              BZQZCD                      WBQZCD
     I              BZXWST                      WBXWST
     I              BZXXST                      WBXXST
     I              BZVMST                      WBVMST
     I              BZSWGH                      WBSWGH
     I              BZPPHE                      WBPPHE
     I              BZR3CD                      WBR3CD
     I              BZSDCD                      WBSDCD
     I              BZICN1                      WBICN1
     I              BZSVCD                      WBSVCD
     I              BZICN2                      WBICN2
     I              BZSWCD                      WBSWCD
     I              BZV2NB                      WBV2NB
     I              BZSXCD                      WBSXCD
     I              BZITCN                      WBITCN
     I              BZSYCD                      WBSYCD
     I              BZITC5                      WBITC5
     I              BZSZCD                      WBSZCD
     I              BZICN6                      WBICN6
     I              BZS0CD                      WBS0CD
     I              BZICN7                      WBICN7
     I              BZS1CD                      WBS1CD
     I              BZICN8                      WBICN8
     I              BZS2CD                      WBS2CD
     I              BZICN9                      WBICN9
     I              BZS3CD                      WBS3CD
     I              BZICN0                      WBICN0
     I              BZS4CD                      WBS4CD
     I              BZSFNB                      WBSFNB
     I              BZA3WG                      WBA3WG
     I              BZSJNB                      WBSJNB
     I              BZLLCD                      WBLLCD
     I              BZLMCD                      WBLMCD
     I              BZP3ST                      WBP3ST
     I              BZSKNB                      WBSKNB
     I              BZSLNB                      WBSLNB
     I              BZSMNB                      WBSMNB
     I              BZP4ST                      WBP4ST
     I              BZCFNB                      WBCFNB
     I              BZCGNB                      WBCGNB
     I              BZILNB                      WBILNB
     I              BZCHNB                      WBCHNB
     I              BZCINB                      WBCINB
     I              BZCJNB                      WBCJNB
     I              BZCMNB                      WBCMNB
     I              BZCNNB                      WBCNNB
     I              BZCRNB                      WBCRNB
     I              BZCSNB                      WBCSNB
     I              BZCVNB                      WBCVNB
     I              BZCWNB                      WBCWNB
     I              BZCXNB                      WBCXNB
     I              BZCZNB                      WBCZNB
     I              BZC0NB                      WBC0NB
     I              BZN1CD                      WBN1CD
     I              BZB4NB                      WBB4NB
     I              BZB5NB                      WBB5NB
     I              BZX5ST                      WBX5ST
     I              BZX6ST                      WBX6ST
     I              BZX7ST                      WBX7ST
     I              BZPCCT                      WBPCCT
     I              BZBDNB                      WBBDNB
     I              BZBJNB                      WBBJNB
     I              BZSUST                      WBSUST
     I              BZSVST                      WBSVST
     I              BZSYST                      WBSYST
     I              BZSZST                      WBSZST
     I              BZS1ST                      WBS1ST
     I              BZXRCD                      WBXRCD
     I              BZXTCD                      WBXTCD
     I              BZXUCD                      WBXUCD
     I              BZF5WG                      WBF5WG
     I              BZF6WG                      WBF6WG
     I              BZF7WG                      WBF7WG
     I              BZBLNB                      WBBLNB
     I              BZBNNB                      WBBNNB
     I              BZS2ST                      WBS2ST
     I              BZS4ST                      WBS4ST
     I              BZS5ST                      WBS5ST
     I              BZS6ST                      WBS6ST
     I              BZS8ST                      WBS8ST
     I              BZS9ST                      WBS9ST
     I              BZTCST                      WBTCST
     I              BZTDST                      WBTDST
     I              BZUVST                      WBUVST
     I              BZUWST                      WBUWST
     I              BZUXST                      WBUXST
     I              BZVSST                      WBVSST
     I              BZAATM                      WBAATM
     I              BZAYNA                      WBAYNA
     I              BZA0NA                      WBA0NA
     I              BZAXDT                      WBAXDT
      *
     I@AMREB0
      * Unit of Measure           Retrieval index       NV
      * Renamed input format fields
     I              AMHHCD                      WCHHCD
     I              AMAUNA                      WCAUNA
     I              AMUVST                      WCUVST
     I              AMUWST                      WCUWST
     I              AMUXST                      WCUXST
     I              AMVSST                      WCVSST
     I              AMAATM                      WCAATM
     I              AMAYNA                      WCAYNA
     I              AMA0NA                      WCA0NA
     I              AMAXDT                      WCAXDT
      *
     I@B0REJX
      * Item Balance              Retrieval index       NV
      * Renamed input format fields
     I              B0AIC3                      WDAIC3
     I              B0HGCD                      WDHGCD
     I              B0AJCD                      WDAJCD
     I              B0AGCS                      WDAGCS
     I              B0AECS                      WDAECS
     I              B0BACS                      WDBACS
     I              B0BBCS                      WDBBCS
     I              B0CBPR                      WDCBPR
     I              B0GUDT                      WDGUDT
     I              B0XYST                      WDXYST
     I              B0CTPR                      WDCTPR
     I              B0G4DT                      WDG4DT
     I              B0BOWG                      WDBOWG
     I              B0DDQT                      WDDDQT
     I              B0DEQT                      WDDEQT
     I              B0DFQT                      WDDFQT
     I              B0HDQT                      WDHDQT
     I              B0HEQT                      WDHEQT
     I              B0AJQT                      WDAJQT
     I              B0AQQT                      WDAQQT
     I              B0AUQT                      WDAUQT
     I              B0EMQT                      WDEMQT
     I              B0DOQT                      WDDOQT
     I              B0ATNA                      WDATNA
     I              B0AKDT                      WDAKDT
     I              B0ANDT                      WDANDT
     I              B0IDVA                      WDIDVA
     I              B0JVST                      WDJVST
     I              B0BZPC                      WDBZPC
     I              B0DGQT                      WDDGQT
     I              B0DIDT                      WDDIDT
     I              B0ALCD                      WDALCD
     I              B0BFDY                      WDBFDY
     I              B0DJDT                      WDDJDT
     I              B0BGDY                      WDBGDY
     I              B0DKDT                      WDDKDT
     I              B0J2ST                      WDJ2ST
     I              B0DJQT                      WDDJQT
     I              B0BNWG                      WDBNWG
     I              B0DLDT                      WDDLDT
     I              B0DPQT                      WDDPQT
     I              B0DQQT                      WDDQQT
     I              B0DMDT                      WDDMDT
     I              B0M0ST                      WDM0ST
     I              B0J9ST                      WDJ9ST
     I              B0KBST                      WDKBST
     I              B0AKC8                      WDAKC8
     I              B0RINB                      WDRINB
     I              B0RHNB                      WDRHNB
     I              B0RGNB                      WDRGNB
     I              B0UVST                      WDUVST
     I              B0UWST                      WDUWST
     I              B0UXST                      WDUXST
     I              B0VSST                      WDVSST
     I              B0AATM                      WDAATM
     I              B0AYNA                      WDAYNA
     I              B0A0NA                      WDA0NA
     I              B0AXDT                      WDAXDT
      *
     I@B7CPZA
      * Item Transaction Detail   Normal KEY Sequence (D)
      * Renamed input format fields
     I              B7AIC3                      WEAIC3
     I              B7HGCD                      WEHGCD
     I              B7AJCD                      WEAJCD
     I              B7W9ST                      WEW9ST
     I              B7BSST                      WEBSST
     I              B7B4DT                      WEB4DT
     I              B7C4NY                      WEC4NY
     I              B7DXNB                      WEDXNB
     I              B7ELDT                      WEELDT
     I              B7HVCD                      WEHVCD
     I              B7F1ST                      WEF1ST
     I              B7AUNA                      WEAUNA
     I              B7A5QT                      WEA5QT
     I              B7AHWG                      WEAHWG
     I              B7AKCS                      WEAKCS
     I              B7CGCD                      WECGCD
     I              B7AYVA                      WEAYVA
     I              B7BJNA                      WEBJNA
     I              B7CKNB                      WECKNB
     I              B7BMST                      WEBMST
     I              B7CQCD                      WECQCD
     I              B7DTCD                      WEDTCD
     I              B7MGNA                      WEMGNA
     I              B7TRBN                      WETRBN
     I              B7TRBS                      WETRBS
     I              B7C4NB                      WEC4NB
     I              B7RINB                      WERINB
     I              B7RHNB                      WERHNB
     I              B7RGNB                      WERGNB
     I              B7M3NA                      WEM3NA
     I              B7AWTM                      WEAWTM
     I              B7XLCD                      WEXLCD
     I              B7K7DT                      WEK7DT
     I              B7UVST                      WEUVST
     I              B7UWST                      WEUWST
     I              B7UXST                      WEUXST
     I              B7VSST                      WEVSST
     I              B7AATM                      WEAATM
     I              B7AYNA                      WEAYNA
     I              B7A0NA                      WEA0NA
     I              B7AXDT                      WEAXDT
      *
     I@B7CPJZ
      * Item Transaction Detail   Update index
      * Renamed input format fields
     I              B7AIC3                      WFAIC3
     I              B7HGCD                      WFHGCD
     I              B7AJCD                      WFAJCD
     I              B7W9ST                      WFW9ST
     I              B7BSST                      WFBSST
     I              B7B4DT                      WFB4DT
     I              B7C4NY                      WFC4NY
     I              B7DXNB                      WFDXNB
     I              B7ELDT                      WFELDT
     I              B7HVCD                      WFHVCD
     I              B7F1ST                      WFF1ST
     I              B7AUNA                      WFAUNA
     I              B7A5QT                      WFA5QT
     I              B7AHWG                      WFAHWG
     I              B7AKCS                      WFAKCS
     I              B7CGCD                      WFCGCD
     I              B7AYVA                      WFAYVA
     I              B7BJNA                      WFBJNA
     I              B7CKNB                      WFCKNB
     I              B7BMST                      WFBMST
     I              B7CQCD                      WFCQCD
     I              B7DTCD                      WFDTCD
     I              B7MGNA                      WFMGNA
     I              B7TRBN                      WFTRBN
     I              B7TRBS                      WFTRBS
     I              B7C4NB                      WFC4NB
     I              B7RINB                      WFRINB
     I              B7RHNB                      WFRHNB
     I              B7RGNB                      WFRGNB
     I              B7M3NA                      WFM3NA
     I              B7AWTM                      WFAWTM
     I              B7XLCD                      WFXLCD
     I              B7K7DT                      WFK7DT
     I              B7UVST                      WFUVST
     I              B7UWST                      WFUWST
     I              B7UXST                      WFUXST
     I              B7VSST                      WFVSST
     I              B7AATM                      WFAATM
     I              B7AYNA                      WFAYNA
     I              B7A0NA                      WFA0NA
     I              B7AXDT                      WFAXDT
      *
     IRB7CPJ3
      * Item Transaction Detail   Retrieval index       NV
      * Renamed input format fields
     I              B7AIC3                      WGAIC3
     I              B7HGCD                      WGHGCD
     I              B7AJCD                      WGAJCD
     I              B7W9ST                      WGW9ST
     I              B7BSST                      WGBSST
     I              B7B4DT                      WGB4DT
     I              B7C4NY                      WGC4NY
     I              B7DXNB                      WGDXNB
     I              B7ELDT                      WGELDT
     I              B7HVCD                      WGHVCD
     I              B7F1ST                      WGF1ST
     I              B7AUNA                      WGAUNA
     I              B7A5QT                      WGA5QT
     I              B7AHWG                      WGAHWG
     I              B7AKCS                      WGAKCS
     I              B7CGCD                      WGCGCD
     I              B7AYVA                      WGAYVA
     I              B7BJNA                      WGBJNA
     I              B7CKNB                      WGCKNB
     I              B7BMST                      WGBMST
     I              B7CQCD                      WGCQCD
     I              B7DTCD                      WGDTCD
     I              B7MGNA                      WGMGNA
     I              B7TRBN                      WGTRBN
     I              B7TRBS                      WGTRBS
     I              B7C4NB                      WGC4NB
     I              B7RINB                      WGRINB
     I              B7RHNB                      WGRHNB
     I              B7RGNB                      WGRGNB
     I              B7M3NA                      WGM3NA
     I              B7AWTM                      WGAWTM
     I              B7XLCD                      WGXLCD
     I              B7K7DT                      WGK7DT
     I              B7UVST                      WGUVST
     I              B7UWST                      WGUWST
     I              B7UXST                      WGUXST
     I              B7VSST                      WGVSST
     I              B7AATM                      WGAATM
     I              B7AYNA                      WGAYNA
     I              B7A0NA                      WGA0NA
     I              B7AXDT                      WGAXDT
      *
     I@B0REJT
      * Item Balance              Update index
      * Renamed input format fields
     I              B0AIC3                      WHAIC3
     I              B0HGCD                      WHHGCD
     I              B0AJCD                      WHAJCD
     I              B0AGCS                      WHAGCS
     I              B0AECS                      WHAECS
     I              B0BACS                      WHBACS
     I              B0BBCS                      WHBBCS
     I              B0CBPR                      WHCBPR
     I              B0GUDT                      WHGUDT
     I              B0XYST                      WHXYST
     I              B0CTPR                      WHCTPR
     I              B0G4DT                      WHG4DT
     I              B0BOWG                      WHBOWG
     I              B0DDQT                      WHDDQT
     I              B0DEQT                      WHDEQT
     I              B0DFQT                      WHDFQT
     I              B0HDQT                      WHHDQT
     I              B0HEQT                      WHHEQT
     I              B0AJQT                      WHAJQT
     I              B0AQQT                      WHAQQT
     I              B0AUQT                      WHAUQT
     I              B0EMQT                      WHEMQT
     I              B0DOQT                      WHDOQT
     I              B0ATNA                      WHATNA
     I              B0AKDT                      WHAKDT
     I              B0ANDT                      WHANDT
     I              B0IDVA                      WHIDVA
     I              B0JVST                      WHJVST
     I              B0BZPC                      WHBZPC
     I              B0DGQT                      WHDGQT
     I              B0DIDT                      WHDIDT
     I              B0ALCD                      WHALCD
     I              B0BFDY                      WHBFDY
     I              B0DJDT                      WHDJDT
     I              B0BGDY                      WHBGDY
     I              B0DKDT                      WHDKDT
     I              B0J2ST                      WHJ2ST
     I              B0DJQT                      WHDJQT
     I              B0BNWG                      WHBNWG
     I              B0DLDT                      WHDLDT
     I              B0DPQT                      WHDPQT
     I              B0DQQT                      WHDQQT
     I              B0DMDT                      WHDMDT
     I              B0M0ST                      WHM0ST
     I              B0J9ST                      WHJ9ST
     I              B0KBST                      WHKBST
     I              B0AKC8                      WHAKC8
     I              B0RINB                      WHRINB
     I              B0RHNB                      WHRHNB
     I              B0RGNB                      WHRGNB
     I              B0UVST                      WHUVST
     I              B0UWST                      WHUWST
     I              B0UXST                      WHUXST
     I              B0VSST                      WHVSST
     I              B0AATM                      WHAATM
     I              B0AYNA                      WHAYNA
     I              B0A0NA                      WHA0NA
     I              B0AXDT                      WHAXDT
      *
     I@B1REJ0
      * Item Balance Detail       Retrieval index       NV
      * Renamed input format fields
     I              B1AIC3                      WIAIC3
     I              B1HGCD                      WIHGCD
     I              B1AJCD                      WIAJCD
     I              B1ELDT                      WIELDT
     I              B1ABWG                      WIABWG
     I              B1AGQT                      WIAGQT
     I              B1AHQT                      WIAHQT
     I              B1AIQT                      WIAIQT
     I              B1CTST                      WICTST
     I              B1ACWG                      WIACWG
     I              B1ARQT                      WIARQT
     I              B1ASQT                      WIASQT
     I              B1ATQT                      WIATQT
     I              B1HDQT                      WIHDQT
     I              B1HEQT                      WIHEQT
     I              B1F6ST                      WIF6ST
     I              B1BMWG                      WIBMWG
     I              B1DSQT                      WIDSQT
     I              B1DTQT                      WIDTQT
     I              B1DUQT                      WIDUQT
     I              B1DHDT                      WIDHDT
     I              B1AGCS                      WIAGCS
     I              B1AECS                      WIAECS
     I              B1IDVA                      WIIDVA
     I              B1K7DT                      WIK7DT
     I              B1RINB                      WIRINB
     I              B1RHNB                      WIRHNB
     I              B1RGNB                      WIRGNB
     I              B1UVST                      WIUVST
     I              B1UWST                      WIUWST
     I              B1UXST                      WIUXST
     I              B1VSST                      WIVSST
     I              B1AATM                      WIAATM
     I              B1AYNA                      WIAYNA
     I              B1A0NA                      WIA0NA
     I              B1AXDT                      WIAXDT
      *
     I@B1REJ1
      * Item Balance Detail       Update index
      * Renamed input format fields
     I              B1AIC3                      WJAIC3
     I              B1HGCD                      WJHGCD
     I              B1AJCD                      WJAJCD
     I              B1ELDT                      WJELDT
     I              B1ABWG                      WJABWG
     I              B1AGQT                      WJAGQT
     I              B1AHQT                      WJAHQT
     I              B1AIQT                      WJAIQT
     I              B1CTST                      WJCTST
     I              B1ACWG                      WJACWG
     I              B1ARQT                      WJARQT
     I              B1ASQT                      WJASQT
     I              B1ATQT                      WJATQT
     I              B1HDQT                      WJHDQT
     I              B1HEQT                      WJHEQT
     I              B1F6ST                      WJF6ST
     I              B1BMWG                      WJBMWG
     I              B1DSQT                      WJDSQT
     I              B1DTQT                      WJDTQT
     I              B1DUQT                      WJDUQT
     I              B1DHDT                      WJDHDT
     I              B1AGCS                      WJAGCS
     I              B1AECS                      WJAECS
     I              B1IDVA                      WJIDVA
     I              B1K7DT                      WJK7DT
     I              B1RINB                      WJRINB
     I              B1RHNB                      WJRHNB
     I              B1RGNB                      WJRGNB
     I              B1UVST                      WJUVST
     I              B1UWST                      WJUWST
     I              B1UXST                      WJUXST
     I              B1VSST                      WJVSST
     I              B1AATM                      WJAATM
     I              B1AYNA                      WJAYNA
     I              B1A0NA                      WJA0NA
     I              B1AXDT                      WJAXDT
      *
     I@ADREAO
      * Warehouse Codes           Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                      WKAJCD
     I              ADF8NA                      WKF8NA
     I              ADACNA                      WKACNA
     I              ADADNA                      WKADNA
     I              ADAENA                      WKAENA
     I              ADAJNA                      WKAJNA
     I              ADBTTX                      WKBTTX
     I              ADAOCD                      WKAOCD
     I              ADBGCD                      WKBGCD
     I              ADVHST                      WKVHST
     I              ADMPNA                      WKMPNA
     I              ADWPST                      WKWPST
     I              ADXUST                      WKXUST
     I              ADT0ST                      WKT0ST
     I              ADT1ST                      WKT1ST
     I              ADDBNB                      WKDBNB
     I              ADT2ST                      WKT2ST
     I              ADT3ST                      WKT3ST
     I              ADT4ST                      WKT4ST
     I              ADT6ST                      WKT6ST
     I              ADBWC3                      WKBWC3
     I              ADBTC3                      WKBTC3
     I              ADBUC3                      WKBUC3
     I              ADBVC3                      WKBVC3
     I              ADFCAA                      WKFCAA
     I              ADRQSX                      WKRQSX
     I              ADRRSX                      WKRRSX
     I              ADRSSX                      WKRSSX
     I              ADRTSX                      WKRTSX
     I              ADT7ST                      WKT7ST
     I              ADT8ST                      WKT8ST
     I              ADRNSX                      WKRNSX
     I              ADROSX                      WKROSX
     I              ADRPSX                      WKRPSX
     I              ADUVST                      WKUVST
     I              ADUWST                      WKUWST
     I              ADUXST                      WKUXST
     I              ADVSST                      WKVSST
     I              ADAATM                      WKAATM
     I              ADAYNA                      WKAYNA
     I              ADA0NA                      WKA0NA
     I              ADAXDT                      WKAXDT
      *
     ICAB1RL4
      * Item Balance Detail       Active only
      * Renamed input format fields
     I              B1AIC3                      WLAIC3
     I              B1HGCD                      WLHGCD
     I              B1AJCD                      WLAJCD
     I              B1ELDT                      WLELDT
     I              B1ABWG                      WLABWG
     I              B1AGQT                      WLAGQT
     I              B1AHQT                      WLAHQT
     I              B1AIQT                      WLAIQT
     I              B1CTST                      WLCTST
     I              B1ACWG                      WLACWG
     I              B1ARQT                      WLARQT
     I              B1ASQT                      WLASQT
     I              B1ATQT                      WLATQT
     I              B1HDQT                      WLHDQT
     I              B1HEQT                      WLHEQT
     I              B1F6ST                      WLF6ST
     I              B1BMWG                      WLBMWG
     I              B1DSQT                      WLDSQT
     I              B1DTQT                      WLDTQT
     I              B1DUQT                      WLDUQT
     I              B1DHDT                      WLDHDT
     I              B1AGCS                      WLAGCS
     I              B1AECS                      WLAECS
     I              B1IDVA                      WLIDVA
     I              B1K7DT                      WLK7DT
     I              B1RINB                      WLRINB
     I              B1RHNB                      WLRHNB
     I              B1RGNB                      WLRGNB
     I              B1UVST                      WLUVST
     I              B1UWST                      WLUWST
     I              B1UXST                      WLUXST
     I              B1VSST                      WLVSST
     I              B1AATM                      WLAATM
     I              B1AYNA                      WLAYNA
     I              B1A0NA                      WLA0NA
     I              B1AXDT                      WLAXDT
      *
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
     C                   PARM                    P1PARM                         RCD: *Arrays
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * Prc Create Dtl Receipt2XF
      * NOTE: Logic below was clone from ICQLPVR in 'User Defined Action'
      * Rtv Module Release Sts RT - OMS Transformation Ctl  * 
     C                   EXSR      SARVGN
      * Call Legacy Process if Not Live or Parallel.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.Module Release Status is Not Live
      *   |- c2    : LCL.Module Release Status is Parallel
      *   '-
      * Create transaction in IC Transaction Detail file
      * Rtv Base f/Misc Item   RT - Company Item  * 
     C                   IF        YL0001 = 'N' OR
     C                             YL0001 = 'P'
     C                   EXSR      SBRVGN
      * Rtv UOM Description    RT - Unit of Measure  * 
     C                   EXSR      SCRVGN
      * Rtv Status/Default     RT - Item Balance  * 
     C                   EXSR      SDRVGN
     C     YL0007        MULT      P1AHWG        YL0008                         Extended Amount
      * Rtv Next Sequence No.  RT - Item Transaction Detail  * 
     C                   EXSR      SERVGN
      * Crt Itm Trans Dtl f/APICR - Item Transaction Detail  * 
     C                   EXSR      SFCRRC
      * Post transaction to IC Item Balance & IC Item Balance Detail
      * Prc Crt Dtl Recpt f/APIIF
      * Prc Crt Dtl Recpt f/APIRT - Item Transaction Detail  * 
     C                   EXSR      SGRVGN
     C                   END                                                    *FI
      *----------------------------------------------------------------
      * Exit program
     C     AAEXIT        TAG
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
      /EJECT
     CSR   SARVGN        BEGSR
      *================================================================
      * Rtv Module Release Sts RT - OMS Transformation Ctl  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
      * PAR = CON By name
     C                   EVAL      YL0001 = ' '                                 Module Release
      * Define keylist
     C     KRSSA         KLIST
     C                   KFLD                    WAB3AB                         Module ID
     C                   KFLD                    WAHUNZ                         Release Number
      * Setup key
     C                   MOVEL     'WIM'         WAB3AB                         Module ID
     C                   Z-ADD     1             WAHUNZ                         Release Number
      * Establish starting position
     C     KRSSA         CHAIN     @C6REMK                            90        *
      * Data record not found
     C   90              MOVEL     'USR5307'     W0RTN
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C                   IF        NOT *IN90
      * PAR = DB1 By name
     C                   IF        WAVSST = 'A'
     C                   MOVEL     WAOCSC        YL0001                         Module Release
     C                   END                                                    *FI
     C                   ENDIF
      *================================================================
     CSR   SAEXIT        ENDSR
      /EJECT
     CSR   SBRVGN        BEGSR
      *================================================================
      * Rtv Base f/Misc Item   RT - Company Item  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSB         KLIST
     C                   KFLD                    WBAIC3                         Company Number
     C                   KFLD                    WBHGCD                         Item Code
      * Setup key
     C                   Z-ADD     P1AIC3        WBAIC3                         Company Number
     C                   Z-ADD     P1HGCD        WBHGCD                         Item Code
      * Establish starting position
     C     KRSSB         CHAIN     @BZREJU                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR0326'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      YL0002 = ' '                                 UOM Primary
     C                   Z-ADD     *ZERO         YL0003                         Item Structure
     C                   Z-ADD     *ZERO         YL0004                         Item Structure
     C                   Z-ADD     *ZERO         YL0005                         Item Structure
     C                   GOTO      SBEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     WBADCD        YL0002                         UOM Primary
     C                   Z-ADD     WBRINB        YL0003                         Item Structure
     C                   Z-ADD     WBRHNB        YL0004                         Item Structure
     C                   Z-ADD     WBRGNB        YL0005                         Item Structure
     C                   ENDIF
      *================================================================
     CSR   SBEXIT        ENDSR
      /EJECT
     CSR   SCRVGN        BEGSR
      *================================================================
      * Rtv UOM Description    RT - Unit of Measure  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSC         KLIST
     C                   KFLD                    WCHHCD                         UOM Primary Dft
      * Setup key
     C                   MOVEL     YL0002        WCHHCD                         UOM Primary Dft
      * Establish starting position
     C     KRSSC         CHAIN     @AMREB0                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR0033'     W0RTN
      * USER: Processing if Data record not found
     C                   MOVEL     'Y2U0005'     W0RTN                          *Return code
      * PAR = CON By name
     C                   EVAL      YL0006 = ' '                                 Description
     C                   GOTO      SCEXIT
     C                   ENDIF
      *
      * USER: Process Data record
     C                   IF        NOT *IN90
     C                   EVAL      W0RTN = ' '                                  *Return code
      * PAR = DB1 By name
     C                   MOVEL     WCAUNA        YL0006                         Description
     C                   ENDIF
      *================================================================
     CSR   SCEXIT        ENDSR
      /EJECT
     CSR   SDRVGN        BEGSR
      *================================================================
      * Rtv Status/Default     RT - Item Balance  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSD         KLIST
     C                   KFLD                    WDAIC3                         Company Number
     C                   KFLD                    WDHGCD                         Item Code
     C                   KFLD                    WDAJCD                         Warehouse Code
      * Setup key
     C                   Z-ADD     P1AIC3        WDAIC3                         Company Number
     C                   Z-ADD     P1HGCD        WDHGCD                         Item Code
     C                   MOVEL     P1VPCD        WDAJCD                         Warehouse Code
      * Establish starting position
     C     KRSSD         CHAIN     @B0REJX                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR0328'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   Z-ADD     *ZERO         YL0007                         Unit Cost Per P
     C                   GOTO      SDEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   Z-ADD     WDAGCS        YL0007                         Unit Cost Per P
     C                   ENDIF
      *================================================================
     CSR   SDEXIT        ENDSR
      /EJECT
     CSR   SERVGN        BEGSR
      *================================================================
      * Rtv Next Sequence No.  RT - Item Transaction Detail  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSE         KLIST
     C                   KFLD                    WQSE01                         Company Number
     C                   KFLD                    WQSE02                         Item Code
     C                   KFLD                    WQSE03                         Warehouse Code
     C                   KFLD                    WQSE04                         Inventory Trans
     C                   KFLD                    WQSE05                         Inventory Trans
     C                   KFLD                    WQSE06                         Transaction Dat
      * Setup key
     C                   Z-ADD     P1AIC3        WQSE01                         Company Number
     C                   Z-ADD     P1HGCD        WQSE02                         Item Code
     C                   MOVEL     P1VPCD        WQSE03                         Warehouse Code
     C                   MOVEL     P1NOSC        WQSE04                         Inventory Trans
     C                   MOVEL     P1NPSC        WQSE05                         Inventory Trans
     C                   Z-ADD     P1A9DT        WQSE06                         Transaction Dat
      * Establish starting position
     C     KRSSE         SETLL     @B7CPZA                                      *
     C     KRSSE         READE     @B7CPZA                                90    *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR0344'     W0RTN
      * USER: Processing if Data record not found
     C                   Z-ADD     1             YL0009                         ITD Sequence Nu
     C                   GOTO      SEEXIT
     C                   ENDIF
      *
      * USER: Process Data record
     C                   DOW       NOT *IN90
     C     WEC4NY        ADD       1             YL0009                         ITD Sequence Nu
     C                   GOTO      SEEXIT                                       *QUIT
     C     KRSSE         READE     @B7CPZA                                90    *
     C                   ENDDO
      *================================================================
     CSR   SEEXIT        ENDSR
      /EJECT
     CSR   SFCRRC        BEGSR
      *================================================================
      * Crt Itm Trans Dtl f/APICR - Item Transaction Detail  * 
      *================================================================
      *
     C                   Z-ADD     *ZERO         WN0001                         Job Time
     C                   EVAL      WN0002 = ' '                                 User Id
     C                   EVAL      WN0003 = ' '                                 Job Name
     C                   Z-ADD     *ZERO         WN0004                         Job Date
     C                   Z-ADD     *ZERO         WN0005                         Production Hour
     C                   Z-ADD     *ZERO         WN0006                         Production Weig
     C                   Z-ADD     *ZERO         WN0007                         Production Quan
     C                   Z-ADD     *ZERO         WN0008                         Production Piec
     C                   EVAL      WN0009 = ' '                                 Export_Domestic
      *
     C                   EVAL      W0RTN = ' '
      * Move all fields to @B7CPJZ
     C                   Z-ADD     P1AIC3        WFAIC3                         Company Number
     C                   Z-ADD     P1HGCD        WFHGCD                         Item Code
     C                   MOVEL     P1VPCD        WFAJCD                         Warehouse Code
     C                   MOVEL     P1NOSC        WFW9ST                         Inventory Trans
     C                   MOVEL     P1NPSC        WFBSST                         Inventory Trans
     C                   Z-ADD     P1A9DT        WFB4DT                         Transaction Dat
     C                   Z-ADD     YL0009        WFC4NY                         ITD Sequence Nu
     C                   Z-ADD     *ZERO         WFDXNB                         Sequence Number
     C                   Z-ADD     P1ELDT        WFELDT                         Production Date
     C                   MOVEL     YL0002        WFHVCD                         UOM Transaction
     C                   MOVEL     'IC'          WFF1ST                         Item Transactio
     C                   MOVEL     P1VQNA        WFAUNA                         Description
     C                   Z-ADD     P1A5QT        WFA5QT                         Transaction Qua
     C                   Z-ADD     P1AHWG        WFAHWG                         Transaction Wei
     C                   Z-ADD     YL0007        WFAKCS                         USR Transaction
     C                   MOVEL     YL0002        WFCGCD                         UOM Cost
     C                   Z-ADD     YL0008        WFAYVA                         Extended Amount
     C                   EVAL      WFBJNA = ' '                                 Ticket Number
     C                   Z-ADD     *ZERO         WFCKNB                         GL Document Num
     C                   EVAL      WFBMST = ' '                                 GL Update Statu
     C                   MOVEL     P1A1AB        WFCQCD                         Reason Code
     C                   EVAL      WFDTCD = ' '                                 Reference Numbe
     C                   EVAL      WFMGNA = ' '                                 Lot ID
     C                   Z-ADD     *ZERO         WFTRBN                         Transfer Batch
     C                   Z-ADD     *ZERO         WFTRBS                         Transfer Batch
     C                   Z-ADD     P1C4NB        WFC4NB                         Order Number
     C                   Z-ADD     YL0003        WFRINB                         Item Structure
     C                   Z-ADD     YL0004        WFRHNB                         Item Structure
     C                   Z-ADD     YL0005        WFRGNB                         Item Structure
     C                   EVAL      WFM3NA = ' '                                 Employee Badge
     C                   Z-ADD     *ZERO         WFAWTM                         Production Time
     C                   MOVEL     P1XLCD        WFXLCD                         Shift Number
     C                   Z-ADD     P1ELDT        WFK7DT                         Label Date
     C                   EVAL      WFUVST = ' '                                 EDI Status 1
     C                   EVAL      WFUWST = ' '                                 EDI Status 2
     C                   EVAL      WFUXST = ' '                                 EDI Status 3
     C                   MOVEL     'A'           WFVSST                         Record Status
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                   Z-ADD     ##JTM         WFAATM                         Job Time
     C                   MOVEL     ##USR         WFAYNA                         User Id
     C                   MOVEL     ##PGM         WFA0NA                         Job Name
     C                   Z-ADD     ##JDT         WFAXDT                         Job Date
     C     KLCRSF        KLIST
     C                   KFLD                    WFAIC3                         Company Number
     C                   KFLD                    WFHGCD                         Item Code
     C                   KFLD                    WFAJCD                         Warehouse Code
     C                   KFLD                    WFW9ST                         Inventory Trans
     C                   KFLD                    WFBSST                         Inventory Trans
     C                   KFLD                    WFB4DT                         Transaction Dat
     C                   KFLD                    WFC4NY                         ITD Sequence Nu
     C                   KFLD                    WFDXNB                         Sequence Number
      * Check for duplicate primary key
     C     KLCRSF        SETLL     @B7CPJZ                                90    *
     C                   IF        *IN90
     C                   MOVEL     'USR0345'     W0RTN
      * Send message 'Item Transaction Detai EX'
     C                   MOVEL     'USR0345'     ZAMSID
     C                   EXSR      ZASNMS
     C                   GOTO      SFEXIT
     C                   ENDIF
      *
     C                   WRITE     @B7CPJZ                              91      *
      *
      * Write error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      * USER: Processing after Data update
      * Crt Export Rate Dtl   XF - Item Transaction Detail  * 
     C                   CALL      'POO5XFR'                            90      Crt Export Rate
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WFAIC3        WQ0001                         Company Number
     C                   PARM      WFHGCD        WQ0002                         Item Code
     C                   PARM      WFAJCD        WQ0003                         Warehouse Code
     C                   PARM      WFW9ST        WQ0004                         Inventory Trans
     C                   PARM      WFBSST        WQ0005                         Inventory Trans
     C                   PARM      WFB4DT        WQ0006                         Transaction Dat
     C                   PARM      WFDXNB        WQ0007                         Sequence Number
     C                   PARM      WFELDT        WQ0008                         Production Date
     C                   PARM      WFHVCD        WQ0009                         UOM Transaction
     C                   PARM      WFF1ST        WQ0010                         Item Transactio
     C                   PARM      WFAUNA        WQ0011                         Description
     C                   PARM      WFA5QT        WQ0012                         Transaction Qua
     C                   PARM      WFAHWG        WQ0013                         Transaction Wei
     C                   PARM      WFAKCS        WQ0014                         USR Transaction
     C                   PARM      WFCGCD        WQ0015                         UOM Cost
     C                   PARM      WFAYVA        WQ0016                         Extended Amount
     C                   PARM      WFBJNA        WQ0017                         Ticket Number
     C                   PARM      WFCKNB        WQ0018                         GL Document Num
     C                   PARM      WFBMST        WQ0019                         GL Update Statu
     C                   PARM      WFCQCD        WQ0020                         Reason Code
     C                   PARM      WFDTCD        WQ0021                         Reference Numbe
     C                   PARM      WFMGNA        WQ0022                         Lot ID
     C                   PARM      WFTRBN        WQ0023                         Transfer Batch
     C                   PARM      WFTRBS        WQ0024                         Transfer Batch
     C                   PARM      WFC4NB        WQ0025                         Order Number
     C                   PARM      WFRINB        WQ0026                         Item Structure
     C                   PARM      WFRHNB        WQ0027                         Item Structure
     C                   PARM      WFRGNB        WQ0028                         Item Structure
     C                   PARM      WFM3NA        WQ0029                         Employee Badge
     C                   PARM      WFAWTM        WQ0030                         Production Time
     C                   PARM      WFXLCD        WQ0031                         Shift Number
     C                   PARM      WFK7DT        WQ0032                         Label Date
     C                   PARM      WFVSST        WQ0033                         Record Status
     C                   PARM      WFAATM        WQ0034                         Job Time
     C                   PARM      WFAXDT        WQ0035                         Job Date
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'POO5XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   ENDIF
      *================================================================
     CSR   SFEXIT        ENDSR
      /EJECT
     CSR   SGRVGN        BEGSR
      *================================================================
      * Prc Crt Dtl Recpt f/APIRT - Item Transaction Detail  * 
      *================================================================
      *
     C                   EVAL      WN0010 = ' '                                 UOM Cost
     C                   Z-ADD     *ZERO         WN0011                         Extended Amount
     C                   EVAL      WN0012 = ' '                                 GL Update Statu
     C                   EVAL      WN0013 = ' '                                 Description Lin
     C                   EVAL      WN0014 = ' '                                 UOM Primary
     C                   Z-ADD     *ZERO         WN0015                         Conversion Fact
     C                   EVAL      WN0016 = ' '                                 Operation Facto
     C                   EVAL      WN0017 = ' '                                 UOM Second
     C                   Z-ADD     *ZERO         WN0018                         Conversion Fact
     C                   EVAL      WN0019 = ' '                                 Operation Facto
     C                   EVAL      WN0020 = ' '                                 UOM Third
     C                   EVAL      WN0021 = ' '                                 UOM Pricing
     C                   Z-ADD     *ZERO         WN0022                         Unit Weight
     C                   EVAL      WN0023 = ' '                                 Production Date
     C                   EVAL      WN0024 = ' '                                 Catch Weight St
     C                   Z-ADD     *ZERO         WN0025                         Item Structure
     C                   Z-ADD     *ZERO         WN0026                         Item Structure
     C                   Z-ADD     *ZERO         WN0027                         Item Structure
     C                   Z-ADD     *ZERO         WN0028                         Quantity on Han
     C                   Z-ADD     *ZERO         WN0029                         Quantity on Han
     C                   Z-ADD     *ZERO         WN0030                         Quantity on Han
     C                   Z-ADD     *ZERO         WN0031                         Quantity on Han
     C                   Z-ADD     *ZERO         WN0032                         Unit Cost Per P
      *
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSG         KLIST
     C                   KFLD                    WGAIC3                         Company Number
     C                   KFLD                    WGHGCD                         Item Code
     C                   KFLD                    WGAJCD                         Warehouse Code
     C                   KFLD                    WGW9ST                         Inventory Trans
     C                   KFLD                    WGBSST                         Inventory Trans
     C                   KFLD                    WGB4DT                         Transaction Dat
     C                   KFLD                    WGC4NY                         ITD Sequence Nu
     C                   KFLD                    WGDXNB                         Sequence Number
      * Setup key
     C                   Z-ADD     P1AIC3        WGAIC3                         Company Number
     C                   Z-ADD     P1HGCD        WGHGCD                         Item Code
     C                   MOVEL     P1VPCD        WGAJCD                         Warehouse Code
     C                   MOVEL     P1NOSC        WGW9ST                         Inventory Trans
     C                   MOVEL     P1NPSC        WGBSST                         Inventory Trans
     C                   Z-ADD     P1A9DT        WGB4DT                         Transaction Dat
     C                   Z-ADD     YL0009        WGC4NY                         ITD Sequence Nu
     C                   Z-ADD     *ZERO         WGDXNB                         Sequence Number
      * Establish starting position
     C     KRSSG         CHAIN     RB7CPJ3                            90        *
      * Data record not found
     C   90              MOVEL     'USR0344'     W0RTN
      * USER: Process Data record
      * Rtv Base Values        RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                   IF        NOT *IN90
     C                   Z-ADD     WGAIC3        WL0001                         Company Number
     C                   Z-ADD     WGHGCD        WL0002                         Item Code
     C                   EXSR      SHRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0003        WN0013                         Description Lin
     C                   MOVEL(P)  WL0004        WUAWNA                         Description Lin
     C                   MOVEL(P)  WL0005        WN0014                         UOM Primary
     C                   Z-ADD     WL0006        WN0015                         Conversion Fact
     C                   MOVEL(P)  WL0007        WN0016                         Operation Facto
     C                   MOVEL(P)  WL0008        WN0017                         UOM Second
     C                   Z-ADD     WL0009        WN0018                         Conversion Fact
     C                   MOVEL(P)  WL0010        WN0019                         Operation Facto
     C                   MOVEL(P)  WL0011        WN0020                         UOM Third
     C                   MOVEL(P)  WL0012        WUAICD                         UOM Pricing
     C                   Z-ADD     WL0013        WN0022                         Unit Weight
     C                   MOVEL(P)  WL0014        WN0023                         Production Date
     C                   MOVEL(P)  WL0015        WN0024                         Catch Weight St
     C                   Z-ADD     WL0016        WUCHTM                         Fresh Chilling
      * Rtv Quantity/Dollars   RT - Item Balance  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WGAIC3        WL0017                         Company Number
     C                   Z-ADD     WGHGCD        WL0018                         Item Code
     C                   MOVEL(P)  WGAJCD        WL0019                         Warehouse Code
     C                   EXSR      SIRVGN
      * Move subroutine local variables to output parameters.
     C                   Z-ADD     WL0020        WN0032                         Unit Cost Per P
     C                   Z-ADD     WL0021        WN0028                         On Hand Weight
     C                   Z-ADD     WL0022        WN0029                         On Hand UOM1 Su
     C                   Z-ADD     WL0023        WN0030                         On Hand UOM2 Su
     C                   Z-ADD     WL0024        WN0031                         On Hand UOM3 Su
     C                   Z-ADD     WL0025        WUIDVA                         Value of On Han
      * UPD Value/Qty/Wgt f/APICH - Item Balance  * 
     C                   EXSR      SJCHRC
     C                   ENDIF
      *================================================================
     CSR   SGEXIT        ENDSR
      /EJECT
     CSR   SHRVGN        BEGSR
      *================================================================
      * Rtv Base Values        RT - Company Item  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSH         KLIST
     C                   KFLD                    WBAIC3                         Company Number
     C                   KFLD                    WBHGCD                         Item Code
      * Setup key
     C                   Z-ADD     WL0001        WBAIC3                         Company Number
     C                   Z-ADD     WL0002        WBHGCD                         Item Code
      * Establish starting position
     C     KRSSH         CHAIN     @BZREJU                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR0326'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      WL0003 = ' '                                 Description Lin
     C                   EVAL      WL0004 = ' '                                 Description Lin
     C                   EVAL      WL0005 = ' '                                 UOM Primary
     C                   Z-ADD     *ZERO         WL0006                         Conversion Fact
     C                   EVAL      WL0007 = ' '                                 Operation Facto
     C                   EVAL      WL0008 = ' '                                 UOM Second
     C                   Z-ADD     *ZERO         WL0009                         Conversion Fact
     C                   EVAL      WL0010 = ' '                                 Operation Facto
     C                   EVAL      WL0011 = ' '                                 UOM Third
     C                   EVAL      WL0012 = ' '                                 UOM Pricing
     C                   Z-ADD     *ZERO         WL0013                         Unit Weight
     C                   EVAL      WL0014 = ' '                                 Production Date
     C                   EVAL      WL0015 = ' '                                 Catch Weight St
     C                   Z-ADD     *ZERO         WL0016                         Fresh Chilling
     C                   GOTO      SHEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     WBAVNA        WL0003                         Description Lin
     C                   MOVEL     WBAWNA        WL0004                         Description Lin
     C                   MOVEL     WBADCD        WL0005                         UOM Primary
     C                   Z-ADD     WBAWPC        WL0006                         Conversion Fact
     C                   MOVEL     WBLXST        WL0007                         Operation Facto
     C                   MOVEL     WBAECD        WL0008                         UOM Second
     C                   Z-ADD     WBAXPC        WL0009                         Conversion Fact
     C                   MOVEL     WBLYST        WL0010                         Operation Facto
     C                   MOVEL     WBAFCD        WL0011                         UOM Third
     C                   MOVEL     WBAICD        WL0012                         UOM Pricing
     C                   Z-ADD     WBAIWG        WL0013                         Unit Weight
     C                   MOVEL     WBFZST        WL0014                         Production Date
     C                   MOVEL     WBAVST        WL0015                         Catch Weight St
     C                   Z-ADD     WBCHTM        WL0016                         Fresh Chilling
     C                   ENDIF
      *================================================================
     CSR   SHEXIT        ENDSR
      /EJECT
     CSR   SIRVGN        BEGSR
      *================================================================
      * Rtv Quantity/Dollars   RT - Item Balance  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSI         KLIST
     C                   KFLD                    WDAIC3                         Company Number
     C                   KFLD                    WDHGCD                         Item Code
     C                   KFLD                    WDAJCD                         Warehouse Code
      * Setup key
     C                   Z-ADD     WL0017        WDAIC3                         Company Number
     C                   Z-ADD     WL0018        WDHGCD                         Item Code
     C                   MOVEL     WL0019        WDAJCD                         Warehouse Code
      * Establish starting position
     C     KRSSI         CHAIN     @B0REJX                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR0328'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   Z-ADD     *ZERO         WL0020                         Unit Cost Per P
     C                   Z-ADD     *ZERO         WL0021                         On Hand Weight
     C                   Z-ADD     *ZERO         WL0022                         On Hand UOM1 Su
     C                   Z-ADD     *ZERO         WL0023                         On Hand UOM2 Su
     C                   Z-ADD     *ZERO         WL0024                         On Hand UOM3 Su
     C                   Z-ADD     *ZERO         WL0025                         Value of On Han
     C                   GOTO      SIEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   Z-ADD     WDAGCS        WL0020                         Unit Cost Per P
     C                   Z-ADD     WDBOWG        WL0021                         On Hand Weight
     C                   Z-ADD     WDDDQT        WL0022                         On Hand UOM1 Su
     C                   Z-ADD     WDDEQT        WL0023                         On Hand UOM2 Su
     C                   Z-ADD     WDDFQT        WL0024                         On Hand UOM3 Su
     C                   Z-ADD     WDIDVA        WL0025                         Value of On Han
     C                   ENDIF
      *================================================================
     CSR   SIEXIT        ENDSR
      /EJECT
     CSR   SJCHRC        BEGSR
      *================================================================
      * UPD Value/Qty/Wgt f/APICH - Item Balance  * 
      *================================================================
      *
     C                   Z-ADD     *ZERO         WN0033                         Quantity based
     C                   Z-ADD     *ZERO         WN0034                         Quantity based
     C                   Z-ADD     *ZERO         WN0035                         Quantity based
     C                   Z-ADD     *ZERO         WN0036                         Cost based on U
     C                   Z-ADD     *ZERO         WN0037                         Cost based on U
     C                   Z-ADD     *ZERO         WN0038                         Cost based on U
     C                   Z-ADD     *ZERO         WN0039                         Quantity Total
     C                   Z-ADD     *ZERO         WN0040                         Quantity Total
     C                   Z-ADD     *ZERO         WN0041                         Cost Replace Do
     C                   Z-ADD     *ZERO         WN0042                         USR Allocated P
      *
     C                   EVAL      W0RTN = ' '
      * USER: Processing before Data read
      *
     C                   Z-ADD     *ZERO         WN0043                         Cost based on U
     C                   Z-ADD     *ZERO         WN0044                         Cost based on U
     C                   Z-ADD     *ZERO         WN0045                         Cost based on U
      *
      * Clc Convert Cost       IF
      * Initialize parameter values
     C                   Z-ADD     *ZERO         WN0036                         Cost based on U
     C                   Z-ADD     *ZERO         WN0037                         Cost based on U
     C                   Z-ADD     *ZERO         WN0038                         Cost based on U
      * Process based on Unit of Measure entered
      * CASE: PAR.U/M - Primary EQ PAR.U/M - Cost
     C                   IF        WN0014 = WGCGCD
     C                   Z-ADD     WN0032        WN0036                         Cost based on U
      * Process second U/M if entered
      * CASE: PAR.U/M - Second is Entered
      * Convert based on operation code
      * CASE: PAR.Operation Factor 1 is Multiply
     C                   IF        WN0017 <> ' '
      * CASE: PAR.Conversion Factor 1 is Entered
     C                   IF        WN0016 = 'M'
     C                   IF        WN0015 <> 0
     C     WN0032        DIV(H)    WN0015        WN0044                         Cost based on U
     C                   END                                                    *FI
     C                   ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C                   IF        WN0016 = 'D'
     C     WN0032        MULT(H)   WN0015        WN0044                         Cost based on U
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   Z-ADD     WN0044        WN0037                         Cost based on U
     C                   END                                                    *FI
      * Process third U/M if entered
      * CASE: PAR.U/M - Third is Entered
      * CASE: PAR.Operation Factor 2 is Multiply
     C                   IF        WN0020 <> ' '
      * CASE: PAR.Conversion Factor 2 is Entered
     C                   IF        WN0019 = 'M'
     C                   IF        WN0018 <> 0
     C     WN0044        DIV(H)    WN0018        WN0038                         Cost based on U
     C                   END                                                    *FI
     C                   ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C                   IF        WN0019 = 'D'
     C     WN0044        MULT(H)   WN0018        WN0038                         Cost based on U
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   ELSE
      * CASE: PAR.U/M - Second EQ PAR.U/M - Cost
     C                   IF        WN0017 = WGCGCD
     C                   Z-ADD     WN0032        WN0037                         Cost based on U
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C                   IF        WN0016 = 'M'
     C     WN0032        MULT(H)   WN0015        WN0036                         Cost based on U
     C                   ELSE
      * CASE: PAR.Operation Factor 1 is Divide
      * CASE: PAR.Conversion Factor 1 is Entered
     C                   IF        WN0016 = 'D'
     C                   IF        WN0015 <> 0
     C     WN0032        DIV(H)    WN0015        WN0036                         Cost based on U
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Process third U/M if entered
      * CASE: PAR.U/M - Third is Entered
      * CASE: PAR.Operation Factor 2 is Multiply
     C                   IF        WN0020 <> ' '
      * CASE: PAR.Conversion Factor 2 is Entered
     C                   IF        WN0019 = 'M'
     C                   IF        WN0018 <> 0
     C     WN0032        DIV(H)    WN0018        WN0038                         Cost based on U
     C                   END                                                    *FI
     C                   ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C                   IF        WN0019 = 'D'
     C     WN0032        MULT(H)   WN0018        WN0038                         Cost based on U
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   ELSE
      * CASE: PAR.U/M - Third EQ PAR.U/M - Cost
     C                   IF        WN0020 = WGCGCD
     C                   Z-ADD     WN0032        WN0038                         Cost based on U
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C                   IF        WN0019 = 'M'
     C     WN0032        MULT(H)   WN0018        WN0044                         Cost based on U
     C                   ELSE
      * CASE: PAR.Operation Factor 2 is Divide
      * CASE: PAR.Conversion Factor 2 is Entered
     C                   IF        WN0019 = 'D'
     C                   IF        WN0018 <> 0
     C     WN0032        DIV(H)    WN0018        WN0044                         Cost based on U
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   Z-ADD     WN0044        WN0037                         Cost based on U
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C                   IF        WN0016 = 'M'
     C     WN0044        MULT(H)   WN0015        WN0036                         Cost based on U
     C                   ELSE
      * CASE: PAR.Operation Factor 1 is Divide
      * CASE: PAR.Conversion Factor 1 is Entered
     C                   IF        WN0016 = 'D'
     C                   IF        WN0015 <> 0
     C     WN0044        DIV(H)    WN0015        WN0036                         Cost based on U
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      *
     C                   Z-ADD     *ZERO         WN0046                         Quantity based
     C                   Z-ADD     *ZERO         WN0047                         Quantity based
     C                   Z-ADD     *ZERO         WN0048                         Quantity based
      *
      * Clc Convert Quantity   IF
      * Clear output parameters
     C                   Z-ADD     *ZERO         WN0033                         USR Qty based o
     C                   Z-ADD     *ZERO         WN0034                         USR Qty based o
     C                   Z-ADD     *ZERO         WN0035                         USR Qty based o
      * Process based on transaction U/M
      * CASE: PAR.U/M - Primary EQ PAR.U/M - Transaction
     C                   IF        WN0014 = WGHVCD
     C                   Z-ADD     WGA5QT        WN0033                         USR Qty based o
      * Process entered U/M2
      * CASE: PAR.U/M - Second is Entered
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C                   IF        WN0017 <> ' '
     C                   IF        WN0016 = 'M'
     C     WGA5QT        MULT(H)   WN0015        WN0047                         Quantity based
     C                   ELSE
      * CASE: PAR.Operation Factor 1 is Divide
      * CASE: PAR.Conversion Factor 1 is Entered
     C                   IF        WN0016 = 'D'
     C                   IF        WN0015 <> 0
     C     WGA5QT        DIV(H)    WN0015        WN0047                         Quantity based
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   Z-ADD     WN0047        WN0034                         USR Qty based o
     C                   END                                                    *FI
      * Process entered U/M3
      * CASE: PAR.U/M - Third is Entered
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C                   IF        WN0020 <> ' '
     C                   IF        WN0019 = 'M'
     C     WN0047        MULT(H)   WN0018        WN0048                         Quantity based
     C                   ELSE
      * CASE: PAR.Operation Factor 2 is Divide
      * CASE: PAR.Conversion Factor 2 is Entered
     C                   IF        WN0019 = 'D'
     C                   IF        WN0018 <> 0
     C     WN0047        DIV(H)    WN0018        WN0048                         Quantity based
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   Z-ADD     WN0048        WN0035                         USR Qty based o
     C                   END                                                    *FI
     C                   ELSE
      * CASE: PAR.U/M - Second EQ PAR.U/M - Transaction
     C                   IF        WN0017 = WGHVCD
     C                   Z-ADD     WGA5QT        WN0034                         USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
      * CASE: PAR.Conversion Factor 1 is Entered
     C                   IF        WN0016 = 'M'
     C                   IF        WN0015 <> 0
     C     WGA5QT        DIV(H)    WN0015        WN0033                         USR Qty based o
     C                   END                                                    *FI
     C                   ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C                   IF        WN0016 = 'D'
     C     WGA5QT        MULT(H)   WN0015        WN0033                         USR Qty based o
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Process entered U/M3
      * CASE: PAR.U/M - Third is Entered
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C                   IF        WN0020 <> ' '
     C                   IF        WN0019 = 'M'
     C     WGA5QT        MULT(H)   WN0018        WN0048                         Quantity based
     C                   ELSE
      * CASE: PAR.Operation Factor 2 is Divide
      * CASE: PAR.Conversion Factor 2 is Entered
     C                   IF        WN0019 = 'D'
     C                   IF        WN0018 <> 0
     C     WGA5QT        DIV(H)    WN0018        WN0048                         Quantity based
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   Z-ADD     WN0048        WN0035                         USR Qty based o
     C                   END                                                    *FI
     C                   ELSE
      * CASE: PAR.U/M - Third EQ PAR.U/M - Transaction
     C                   IF        WN0020 = WGHVCD
     C                   Z-ADD     WGA5QT        WN0035                         USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
      * CASE: PAR.Conversion Factor 2 is Entered
     C                   IF        WN0019 = 'M'
     C                   IF        WN0018 <> 0
     C     WGA5QT        DIV(H)    WN0018        WN0047                         Quantity based
     C                   END                                                    *FI
     C                   ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C                   IF        WN0019 = 'D'
     C     WGA5QT        MULT(H)   WN0018        WN0047                         Quantity based
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   Z-ADD     WN0047        WN0034                         USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
      * CASE: PAR.Conversion Factor 1 is Entered
     C                   IF        WN0016 = 'M'
     C                   IF        WN0015 <> 0
     C     WN0047        DIV(H)    WN0015        WN0033                         USR Qty based o
     C                   END                                                    *FI
     C                   ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C                   IF        WN0016 = 'D'
     C     WN0047        MULT(H)   WN0015        WN0033                         USR Qty based o
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YARDC = ' '
      *
      * Move key fields to @B0REJT
     C                   Z-ADD     WGAIC3        WHAIC3                         Company Number
     C                   Z-ADD     WGHGCD        WHHGCD                         Item Code
     C                   MOVEL(P)  WGAJCD        WHAJCD                         Warehouse Code
      *
     C     KLCHSJ        KLIST
     C                   KFLD                    WHAIC3                         Company Number
     C                   KFLD                    WHHGCD                         Item Code
     C                   KFLD                    WHAJCD                         Warehouse Code
     C     KLCHSJ        CHAIN     @B0REJT                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'CAB0REL0'    MDACP
     C                   MOVEL     '@B0REJT'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL001.
     C                   MOVEL     'LBL001'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      SJEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      SJEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QCAB01        YARDCS
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QCAB01 <> YARDCS AND
     C                             YARDC <> 'N'
     C                   MOVE      'Y'           YARDC
     C                   ENDIF
      * USER: Processing before Data update
     C                   MOVEL     'Y'           YARDC                          *Record Data Ch
      * (Creates IB if not found or updates if it exists)
      * Update IC Item Balance Detail
      * UPD Value/Qty f/API    RT - Item Balance Detail  * 
     C                   EXSR      SKRVGN
      * Update the quantity/weight on hand in the item balance file
      * RTV Sum Act Qty,Wgt,ValRT - IC Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WHAIC3        WL0064                         Company Number
     C                   Z-ADD     WHHGCD        WL0065                         Item Code
     C                   MOVEL(P)  WHAJCD        WL0066                         Warehouse Code
     C                   Z-ADD     WHBOWG        WL0067                         Quantity on Han
     C                   Z-ADD     WHDDQT        WL0068                         Quantity on Han
     C                   Z-ADD     WUNFNN        WL0069                         Quantity on Han
     C                   Z-ADD     WUNFNN        WL0070                         Quantity on Han
     C                   Z-ADD     WHIDVA        WL0071                         Value of On Han
     C                   EXSR      SPRVGN
      * Move subroutine local variables to output parameters.
     C                   Z-ADD     WL0067        WHBOWG                         Quantity on Han
     C                   Z-ADD     WL0068        WHDDQT                         Quantity on Han
     C                   Z-ADD     WL0069        WUNFNN                         Quantity on Han
     C                   Z-ADD     WL0070        WUNFNN                         Quantity on Han
     C                   Z-ADD     WL0071        WHIDVA                         Value of On Han
     C                   Z-ADD     *ZERO         WHDOQT                         Available Prima
      * Available Primary U/M
     C     WHDDQT        SUB       WHAJQT        WHDOQT                         Available Prima
      * Set Date/Time Stamp.PgmIF
     C                   Z-ADD     ##JTM         WHAATM                         Job Time
     C                   MOVEL     ##USR         WHAYNA                         User Id
     C                   MOVEL     ##PGM         WHA0NA                         Job Name
     C                   Z-ADD     ##JDT         WHAXDT                         Job Date
      * Set PGM.*Record Data Changed flag
     C                   IF        QCAB01 <> YARDCS AND
     C                             YARDC <> 'N'
     C                   MOVE      'Y'           YARDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YARDC = 'Y'
     C                   UPDATE    @B0REJT                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    CAB0REL0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   SJEXIT        ENDSR
      /EJECT
     CSR   SKRVGN        BEGSR
      *================================================================
      * UPD Value/Qty f/API    RT - Item Balance Detail  * 
      *================================================================
      *
     C                   Z-ADD     *ZERO         WN0049                         Quantity on Han
     C                   Z-ADD     *ZERO         WN0050                         Quantity on Han
     C                   Z-ADD     *ZERO         WN0051                         Quantity on Han
     C                   Z-ADD     *ZERO         WN0052                         Quantity on Han
     C                   Z-ADD     *ZERO         WN0053                         Unit Cost Per P
     C                   Z-ADD     *ZERO         WN0054                         Last Cost
     C                   Z-ADD     *ZERO         WN0055                         Value of On Han
     C                   EVAL      WN0056 = ' '                                 Lot Tracking Fl
      *
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSK         KLIST
     C                   KFLD                    WIAIC3                         Company Number
     C                   KFLD                    WIHGCD                         Item Code
     C                   KFLD                    WIAJCD                         Warehouse Code
     C                   KFLD                    WIELDT                         Production Date
      * Setup key
     C                   Z-ADD     WHAIC3        WIAIC3                         Company Number
     C                   Z-ADD     WHHGCD        WIHGCD                         Item Code
     C                   MOVEL     WHAJCD        WIAJCD                         Warehouse Code
     C                   Z-ADD     WGELDT        WIELDT                         Production Date
      * Establish starting position
     C     KRSSK         CHAIN     @B1REJ0                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR0330'     W0RTN
      * USER: Processing if Data record not found
      * CASE: PAR.Quantity based on U/M1 S EQ WRK.ZERO
      * Crt Item Bal Dtl f/API CR - Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                   IF        WN0033 = WUW0NB
     C                   Z-ADD     WHAIC3        WL0026                         Company Number
     C                   Z-ADD     WHHGCD        WL0027                         Item Code
     C                   MOVEL(P)  WHAJCD        WL0028                         Warehouse Code
     C                   Z-ADD     WGELDT        WL0029                         Production Date
     C                   Z-ADD     *ZERO         WL0030                         Physical Count
     C                   Z-ADD     *ZERO         WL0031                         Physical Count
     C                   Z-ADD     *ZERO         WL0032                         Physical Count
     C                   Z-ADD     *ZERO         WL0033                         Physical Count
     C                   EVAL      WL0034 = ' '                                 Physical Count
     C                   Z-ADD     *ZERO         WL0035                         Quantity on Han
     C                   Z-ADD     WN0033        WL0036                         Quantity on Han
     C                   Z-ADD     *ZERO         WL0037                         Quantity on Han
     C                   Z-ADD     *ZERO         WL0038                         Quantity on Han
     C                   Z-ADD     *ZERO         WL0039                         Quantity In Chi
     C                   Z-ADD     *ZERO         WL0040                         Weight In Chill
     C                   MOVEL(P)  'N'           WL0041                         Update Exceptio
     C                   Z-ADD     *ZERO         WL0042                         Physical Start
     C                   Z-ADD     *ZERO         WL0043                         Physical Start
     C                   Z-ADD     *ZERO         WL0044                         Physical Start
     C                   Z-ADD     *ZERO         WL0045                         Physical Start
     C                   Z-ADD     *ZERO         WL0046                         Physical Start
     C                   Z-ADD     *ZERO         WL0047                         Unit Cost Per P
     C                   Z-ADD     *ZERO         WL0048                         Last Cost
     C                   Z-ADD     *ZERO         WL0049                         Value of On Han
     C                   Z-ADD     WGK7DT        WL0050                         Label Date
     C                   Z-ADD     WHRINB        WL0051                         Item Structure
     C                   Z-ADD     WHRHNB        WL0052                         Item Structure
     C                   Z-ADD     WHRGNB        WL0053                         Item Structure
     C                   EVAL      WL0054 = ' '                                 EDI Status 1
     C                   EVAL      WL0055 = ' '                                 EDI Status 2
     C                   EVAL      WL0056 = ' '                                 EDI Status 3
     C                   MOVEL(P)  'A'           WL0057                         Record Status
     C                   EXSR      SLCRRC
     C                   ELSE
      * CASE: *OTHERWISE
      * Crt Item Bal Dtl f/API CR - Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WHAIC3        WL0026                         Company Number
     C                   Z-ADD     WHHGCD        WL0027                         Item Code
     C                   MOVEL(P)  WHAJCD        WL0028                         Warehouse Code
     C                   Z-ADD     WGELDT        WL0029                         Production Date
     C                   Z-ADD     *ZERO         WL0030                         Physical Count
     C                   Z-ADD     *ZERO         WL0031                         Physical Count
     C                   Z-ADD     *ZERO         WL0032                         Physical Count
     C                   Z-ADD     *ZERO         WL0033                         Physical Count
     C                   EVAL      WL0034 = ' '                                 Physical Count
     C                   Z-ADD     WGAHWG        WL0035                         Quantity on Han
     C                   Z-ADD     WN0033        WL0036                         Quantity on Han
     C                   Z-ADD     *ZERO         WL0037                         Quantity on Han
     C                   Z-ADD     *ZERO         WL0038                         Quantity on Han
     C                   Z-ADD     *ZERO         WL0039                         Quantity In Chi
     C                   Z-ADD     *ZERO         WL0040                         Weight In Chill
     C                   MOVEL(P)  'N'           WL0041                         Update Exceptio
     C                   Z-ADD     *ZERO         WL0042                         Physical Start
     C                   Z-ADD     *ZERO         WL0043                         Physical Start
     C                   Z-ADD     *ZERO         WL0044                         Physical Start
     C                   Z-ADD     *ZERO         WL0045                         Physical Start
     C                   Z-ADD     *ZERO         WL0046                         Physical Start
     C                   Z-ADD     *ZERO         WL0047                         Unit Cost Per P
     C                   Z-ADD     *ZERO         WL0048                         Last Cost
     C                   Z-ADD     WGAYVA        WL0049                         Value of On Han
     C                   Z-ADD     WGK7DT        WL0050                         Label Date
     C                   Z-ADD     WHRINB        WL0051                         Item Structure
     C                   Z-ADD     WHRHNB        WL0052                         Item Structure
     C                   Z-ADD     WHRGNB        WL0053                         Item Structure
     C                   EVAL      WL0054 = ' '                                 EDI Status 1
     C                   EVAL      WL0055 = ' '                                 EDI Status 2
     C                   EVAL      WL0056 = ' '                                 EDI Status 3
     C                   MOVEL(P)  'A'           WL0057                         Record Status
     C                   EXSR      SLCRRC
     C                   END                                                    *FI
     C                   GOTO      SKEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * Calculate new On Hand Value
      * CASE: PAR.Inventory Trans. Type is Adjustment Cycle Count
     C                   IF        NOT *IN90
     C                   IF        WGBSST = 'AC'
     C     WIIDVA        ADD       WGAYVA        WN0055                         Value of On Han
     C                   ELSE
      * CASE: PAR.Inventory Trans. Type is Quantity based Avg. Cost
     C                   IF        WGBSST = 'R' OR
     C                             WGBSST = 'RP' OR
     C                             WGBSST = 'S' OR
     C                             WGBSST = 'TW' OR
     C                             WGBSST = 'RW' OR
     C                             WGBSST = 'RR'
     C     WIIDVA        ADD       WGAYVA        WN0055                         Value of On Han
     C                   END                                                    *FI
     C                   END                                                    *FI
     C     WGAHWG        ADD       WIACWG        WN0049                         Quantity on Han
     C     WIARQT        ADD       WN0033        WN0050                         Quantity on Han
      * If quantity goes TO exactly 0, wgt and value to go 0
      * CASE: PAR.Quantity on Hand - U/M1 EQ WRK.ZERO
      * UPD Create Weight Adj. XF - IC Transaction Detail  * 
     C                   IF        WN0050 = WUW0NB
     C                   CALL      'PDMYXFR'                            90      UPD Create Weig
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WIAIC3        WQ0038                         Company Number
     C                   PARM      WIHGCD        WQ0039                         Item Code
     C                   PARM      WIAJCD        WQ0040                         Warehouse Code
     C                   PARM      WGB4DT        WQ0041                         Transaction Dat
     C                   PARM      WIELDT        WQ0042                         Production Date
     C                   PARM      WGHVCD        WQ0043                         UOM Transaction
     C                   PARM      WN0049        WQ0044                         Transaction Wei
     C                   PARM      WN0053        WQ0045                         USR Transaction
     C                   PARM      WGCGCD        WQ0046                         UOM Cost
     C                   PARM      WIRINB        WQ0047                         Item Structure
     C                   PARM      WIRHNB        WQ0048                         Item Structure
     C                   PARM      WIRGNB        WQ0049                         Item Structure
     C                   PARM      P1XLCD        WQ0050                         Shift Number
     C                   PARM      WIK7DT        WQ0051                         Label Date
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDMYXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   Z-ADD     *ZERO         WN0049                         Quantity on Han
     C                   Z-ADD     *ZERO         WN0055                         Value of On Han
     C                   END                                                    *FI
      * Rtv Lot Tracking Flag RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                   MOVEL(P)  WIAJCD        WL0058                         Warehouse Code
     C                   EXSR      SMRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0059        WN0056                         Lot Tracking Fl
      * CASE: Qty = 0 & production date <> 0 & Lot Trk=N
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Quantity on Hand - U/M1 EQ WRK.ZERO
      *   |- c2    : DB1.Production Date NE WRK.ZERO
      *   |- c3    : PAR.Lot Tracking Flag is Not Yes
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        WN0050 = WUW0NB
     C                   IF        WIELDT <> WUW0NB
     C                   IF        WN0056 = ' ' OR
     C                             WN0056 = 'N'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Dlt Item Bal. Detail   DL - IC Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                   IF        Y0CX01 = '1'
     C                   Z-ADD     WIAIC3        WL0060                         Company Number
     C                   Z-ADD     WIHGCD        WL0061                         Item Code
     C                   MOVEL(P)  WIAJCD        WL0062                         Warehouse Code
     C                   Z-ADD     WIELDT        WL0063                         Production Date
     C                   EXSR      SNDLRC
     C                   ELSE
      * CASE: *OTHERWISE
      * Chg Item Bal Dtl f/API CH - Item Balance Detail  * 
     C                   EXSR      SOCHRC
     C                   END                                                    *FI
     C                   ENDIF
      *================================================================
     CSR   SKEXIT        ENDSR
      /EJECT
     CSR   SLCRRC        BEGSR
      *================================================================
      * Crt Item Bal Dtl f/API CR - Item Balance Detail  * 
      *================================================================
      *
     C                   Z-ADD     *ZERO         WN0057                         Job Time
     C                   EVAL      WN0058 = ' '                                 User Id
     C                   EVAL      WN0059 = ' '                                 Job Name
     C                   Z-ADD     *ZERO         WN0060                         Job Date
      *
     C                   EVAL      W0RTN = ' '
      * Move all fields to @B1REJ1
     C                   Z-ADD     WL0026        WJAIC3                         Company Number
     C                   Z-ADD     WL0027        WJHGCD                         Item Code
     C                   MOVEL     WL0028        WJAJCD                         Warehouse Code
     C                   Z-ADD     WL0029        WJELDT                         Production Date
     C                   Z-ADD     WL0030        WJABWG                         Physical Count
     C                   Z-ADD     WL0031        WJAGQT                         Physical Count
     C                   Z-ADD     WL0032        WJAHQT                         Physical Count
     C                   Z-ADD     WL0033        WJAIQT                         Physical Count
     C                   MOVEL     WL0034        WJCTST                         Physical Count
     C                   Z-ADD     WL0035        WJACWG                         Quantity on Han
     C                   Z-ADD     WL0036        WJARQT                         Quantity on Han
     C                   Z-ADD     WL0037        WJASQT                         Quantity on Han
     C                   Z-ADD     WL0038        WJATQT                         Quantity on Han
     C                   Z-ADD     WL0039        WJHDQT                         Quantity In Chi
     C                   Z-ADD     WL0040        WJHEQT                         Weight In Chill
     C                   MOVEL     WL0041        WJF6ST                         Update Exceptio
     C                   Z-ADD     WL0042        WJBMWG                         Physical Start
     C                   Z-ADD     WL0043        WJDSQT                         Physical Start
     C                   Z-ADD     WL0044        WJDTQT                         Physical Start
     C                   Z-ADD     WL0045        WJDUQT                         Physical Start
     C                   Z-ADD     WL0046        WJDHDT                         Physical Start
     C                   Z-ADD     WL0047        WJAGCS                         Unit Cost Per P
     C                   Z-ADD     WL0048        WJAECS                         Last Cost
     C                   Z-ADD     WL0049        WJIDVA                         Value of On Han
     C                   Z-ADD     WL0050        WJK7DT                         Label Date
     C                   Z-ADD     WL0051        WJRINB                         Item Structure
     C                   Z-ADD     WL0052        WJRHNB                         Item Structure
     C                   Z-ADD     WL0053        WJRGNB                         Item Structure
     C                   MOVEL     WL0054        WJUVST                         EDI Status 1
     C                   MOVEL     WL0055        WJUWST                         EDI Status 2
     C                   MOVEL     WL0056        WJUXST                         EDI Status 3
     C                   MOVEL     WL0057        WJVSST                         Record Status
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                   Z-ADD     ##JTM         WJAATM                         Job Time
     C                   MOVEL     ##USR         WJAYNA                         User Id
     C                   MOVEL     ##PGM         WJA0NA                         Job Name
     C                   Z-ADD     ##JDT         WJAXDT                         Job Date
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                   CALL      'PDGFUPC'                            90      RTV System Date
     C     WJAXDT        PARM      *ZERO         WQ0036                         Current System
     C     WJAATM        PARM      *ZERO         WQ0037                         Current System
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDGFUPC'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
     C     KLCRSL        KLIST
     C                   KFLD                    WJAIC3                         Company Number
     C                   KFLD                    WJHGCD                         Item Code
     C                   KFLD                    WJAJCD                         Warehouse Code
     C                   KFLD                    WJELDT                         Production Date
      * Check for duplicate primary key
     C     KLCRSL        SETLL     @B1REJ1                                90    *
     C                   IF        *IN90
     C                   MOVEL     'USR0331'     W0RTN
      * Send message 'Item Balance Detail    EX'
     C                   MOVEL     'USR0331'     ZAMSID
     C                   EXSR      ZASNMS
     C                   GOTO      SLEXIT
     C                   ENDIF
      *
     C                   WRITE     @B1REJ1                              91      *
      *
      * Write error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
     C                   ENDIF
      *================================================================
     CSR   SLEXIT        ENDSR
      /EJECT
     CSR   SMRVGN        BEGSR
      *================================================================
      * Rtv Lot Tracking Flag RT - Warehouse  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSM         KLIST
     C                   KFLD                    WKAJCD                         Warehouse Code
      * Setup key
     C                   MOVEL     WL0058        WKAJCD                         Warehouse Code
      * Establish starting position
     C     KRSSM         CHAIN     @ADREAO                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR0007'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      WL0059 = ' '                                 Lot Tracking Fl
     C                   GOTO      SMEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     WKVHST        WL0059                         Lot Tracking Fl
     C                   ENDIF
      *================================================================
     CSR   SMEXIT        ENDSR
      /EJECT
     CSR   SNDLRC        BEGSR
      *================================================================
      * Dlt Item Bal. Detail   DL - IC Item Balance Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Move key fields to @B1REJ1
     C                   Z-ADD     WL0060        WJAIC3                         Company Number
     C                   Z-ADD     WL0061        WJHGCD                         Item Code
     C                   MOVEL     WL0062        WJAJCD                         Warehouse Code
     C                   Z-ADD     WL0063        WJELDT                         Production Date
      *
     C     KLDLSN        KLIST
     C                   KFLD                    WJAIC3                         Company Number
     C                   KFLD                    WJHGCD                         Item Code
     C                   KFLD                    WJAJCD                         Warehouse Code
     C                   KFLD                    WJELDT                         Production Date
     C     KLDLSN        CHAIN     @B1REJ1                            9091      *
      * Record already deleted
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'CAB1REL1'    MDACP
     C                   MOVEL     '@B1REJ1'     MDFMT
     C                   MOVEL     '*DLT'        MDACT
      * Record not found label: LBL002.
     C                   MOVEL     'LBL002'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      SNEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      SNEXIT
     C                   ENDIF
      *
      *................................................................
     C                   DELETE    @B1REJ1                              91      *
      * Delete error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ENDIF
      *================================================================
     CSR   SNEXIT        ENDSR
      /EJECT
     CSR   SOCHRC        BEGSR
      *================================================================
      * Chg Item Bal Dtl f/API CH - Item Balance Detail  * 
      *================================================================
      *
     C                   Z-ADD     *ZERO         WN0061                         Label Date
     C                   EVAL      WN0062 = ' '                                 EDI Status 1
     C                   EVAL      WN0063 = ' '                                 EDI Status 2
     C                   EVAL      WN0064 = ' '                                 EDI Status 3
     C                   EVAL      WN0065 = ' '                                 Record Status
     C                   Z-ADD     *ZERO         WN0066                         Job Time
     C                   EVAL      WN0067 = ' '                                 User Id
     C                   EVAL      WN0068 = ' '                                 Job Name
     C                   Z-ADD     *ZERO         WN0069                         Job Date
      *
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YBRDC = ' '
      *
      * Move key fields to @B1REJ1
     C                   Z-ADD     WIAIC3        WJAIC3                         Company Number
     C                   Z-ADD     WIHGCD        WJHGCD                         Item Code
     C                   MOVEL(P)  WIAJCD        WJAJCD                         Warehouse Code
     C                   Z-ADD     WIELDT        WJELDT                         Production Date
      *
     C     KLCHSO        KLIST
     C                   KFLD                    WJAIC3                         Company Number
     C                   KFLD                    WJHGCD                         Item Code
     C                   KFLD                    WJAJCD                         Warehouse Code
     C                   KFLD                    WJELDT                         Production Date
     C     KLCHSO        CHAIN     @B1REJ1                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'CAB1REL1'    MDACP
     C                   MOVEL     '@B1REJ1'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL003.
     C                   MOVEL     'LBL003'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      SOEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      SOEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QCAB11        YBRDCS
      * Move non-key fields to @B1REJ1
     C                   Z-ADD     WIABWG        WJABWG                         Physical Count
     C                   Z-ADD     WIAGQT        WJAGQT                         Physical Count
     C                   Z-ADD     WIAHQT        WJAHQT                         Physical Count
     C                   Z-ADD     WIAIQT        WJAIQT                         Physical Count
     C                   MOVEL(P)  WICTST        WJCTST                         Physical Count
     C                   Z-ADD     WN0049        WJACWG                         Quantity on Han
     C                   Z-ADD     WN0050        WJARQT                         Quantity on Han
     C                   Z-ADD     WIASQT        WJASQT                         Quantity on Han
     C                   Z-ADD     WIATQT        WJATQT                         Quantity on Han
     C                   Z-ADD     WIHDQT        WJHDQT                         Quantity In Chi
     C                   Z-ADD     WIHEQT        WJHEQT                         Weight In Chill
     C                   MOVEL(P)  WIF6ST        WJF6ST                         Update Exceptio
     C                   Z-ADD     WIBMWG        WJBMWG                         Physical Start
     C                   Z-ADD     WIDSQT        WJDSQT                         Physical Start
     C                   Z-ADD     WIDTQT        WJDTQT                         Physical Start
     C                   Z-ADD     WIDUQT        WJDUQT                         Physical Start
     C                   Z-ADD     WIDHDT        WJDHDT                         Physical Start
     C                   Z-ADD     WIAGCS        WJAGCS                         Unit Cost Per P
     C                   Z-ADD     WIAECS        WJAECS                         Last Cost
     C                   Z-ADD     WN0055        WJIDVA                         Value of On Han
     C                   Z-ADD     WIRINB        WJRINB                         Item Structure
     C                   Z-ADD     WIRHNB        WJRHNB                         Item Structure
     C                   Z-ADD     WIRGNB        WJRGNB                         Item Structure
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QCAB11 <> YBRDCS AND
     C                             YBRDC <> 'N'
     C                   MOVE      'Y'           YBRDC
     C                   ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                   Z-ADD     ##JTM         WJAATM                         Job Time
     C                   MOVEL     ##USR         WJAYNA                         User Id
     C                   MOVEL     ##PGM         WJA0NA                         Job Name
     C                   Z-ADD     ##JDT         WJAXDT                         Job Date
      * Set PGM.*Record Data Changed flag
     C                   IF        QCAB11 <> YBRDCS AND
     C                             YBRDC <> 'N'
     C                   MOVE      'Y'           YBRDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YBRDC = 'Y'
     C                   UPDATE    @B1REJ1                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    CAB1REL1                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   SOEXIT        ENDSR
      /EJECT
     CSR   SPRVGN        BEGSR
      *================================================================
      * RTV Sum Act Qty,Wgt,ValRT - IC Item Balance Detail  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
     C                   Z-ADD     *ZERO         WL0067                         Quantity on Han
     C                   Z-ADD     *ZERO         WL0068                         Quantity on Han
     C                   Z-ADD     *ZERO         WL0069                         Quantity on Han
     C                   Z-ADD     *ZERO         WL0070                         Quantity on Han
     C                   Z-ADD     *ZERO         WL0071                         Value of On Han
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSP         KLIST
     C                   KFLD                    WQSP01                         Company Number
     C                   KFLD                    WQSP02                         Item Code
     C                   KFLD                    WQSP03                         Warehouse Code
      * Setup key
     C                   Z-ADD     WL0064        WQSP01                         Company Number
     C                   Z-ADD     WL0065        WQSP02                         Item Code
     C                   MOVEL     WL0066        WQSP03                         Warehouse Code
      * Establish starting position
     C     KRSSP         SETLL     CAB1RL4                                      *
     C     KRSSP         READE     CAB1RL4                                90    *
      * Data record not found
     C   90              MOVEL     'USR0330'     W0RTN
      * USER: Process Data record
     C                   DOW       NOT *IN90
     C                   ADD       WLACWG        WL0067                         Quantity on Han
     C                   ADD       WLARQT        WL0068                         Quantity on Han
     C                   ADD       WLASQT        WL0069                         Quantity on Han
     C                   ADD       WLATQT        WL0070                         Quantity on Han
     C                   ADD       WLIDVA        WL0071                         Value of On Han
     C     KRSSP         READE     CAB1RL4                                90    *
     C                   ENDDO
      *================================================================
     CSR   SPEXIT        ENDSR
      /EJECT
     CSR   ZASNMS        BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C                   IF        ZAPGMQ = ' '
     C                   MOVEL     ##PGM         ZAPGMQ
     C                   END
      * If no message file specified, use default
     C                   IF        ZAMSGF = ' '
     C                   MOVEL     ZADFMF        ZAMSGF
     C                   END
     C                   CALL      'Y2SNMGC'
     C                   PARM                    ZAPGMQ                         Program queue
     C                   PARM                    ZAPGRL                         Rel queue
     C                   PARM                    ZAMSID                         Message ID
     C                   PARM                    ZAMSGF                         Message file
     C                   PARM                    ZAMSDA                         Message data
     C                   PARM                    ZAMSTP                         Message type
     C                   PARM      'Y'           YILE
      * Clear all fields for default mechanism next time
     C                   EVAL      ZAPGMQ = ' '
     C                   EVAL      ZAPGRL = ' '
     C                   EVAL      ZAMSID = ' '
     C                   EVAL      ZAMSGF = ' '
     C                   EVAL      ZAMSDA = ' '
     C                   EVAL      ZAMSTP = ' '
      *================================================================
     CSR   ZAEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      *
      *
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WAHUNZ                         Release Number
     C                   MOVE(P)   '0'           XDTSDL
     C                   MOVEL     @CN(001)      XDTSDL
     C                   MOVEL     XDTSDL        WABGTS                         Create Date Tim
     C                   MOVEL     XDTSDL        WABHTS                         Update Date Tim
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WBAIC3                         Company Number
     C                   Z-ADD     *ZERO         WBHGCD                         Item Code
     C                   Z-ADD     *ZERO         WBAWPC                         Conversion Fact
     C                   Z-ADD     *ZERO         WBAXPC                         Conversion Fact
     C                   Z-ADD     *ZERO         WBAIWG                         Unit Weight
     C                   Z-ADD     *ZERO         WBCZWG                         Minimum Weight
     C                   Z-ADD     *ZERO         WBC0WG                         Maximum Weight
     C                   Z-ADD     *ZERO         WBURTN                         Number Cases On
     C                   Z-ADD     *ZERO         WBAJC8                         Vendor Item Def
     C                   Z-ADD     *ZERO         WBRINB                         Item Structure
     C                   Z-ADD     *ZERO         WBRHNB                         Item Structure
     C                   Z-ADD     *ZERO         WBRGNB                         Item Structure
     C                   Z-ADD     *ZERO         WBTFNB                         Transportation
     C                   Z-ADD     *ZERO         WBTMVA                         Maximum Audit V
     C                   Z-ADD     *ZERO         WBTNVA                         Minimum Audit V
     C                   Z-ADD     *ZERO         WBBLPR                         Market Overage
     C                   Z-ADD     *ZERO         WBBMPR                         Standard Overag
     C                   Z-ADD     *ZERO         WBCMCO                         Item Pricing Co
     C                   Z-ADD     *ZERO         WBCHTM                         Fresh Chilling
     C                   Z-ADD     *ZERO         WBSWGH                         Std Weight_Head
     C                   Z-ADD     *ZERO         WBPPHE                         Pieces Per Head
     C                   Z-ADD     *ZERO         WBICN1                         Item Category N
     C                   Z-ADD     *ZERO         WBICN2                         Item Category N
     C                   Z-ADD     *ZERO         WBV2NB                         Item Category N
     C                   Z-ADD     *ZERO         WBITCN                         Item Category N
     C                   Z-ADD     *ZERO         WBITC5                         Item Category N
     C                   Z-ADD     *ZERO         WBICN6                         Item Category N
     C                   Z-ADD     *ZERO         WBICN7                         Item Category N
     C                   Z-ADD     *ZERO         WBICN8                         Item Category N
     C                   Z-ADD     *ZERO         WBICN9                         Item Category N
     C                   Z-ADD     *ZERO         WBICN0                         Item Category N
     C                   Z-ADD     *ZERO         WBSFNB                         Pallet Tare Wei
     C                   Z-ADD     *ZERO         WBA3WG                         Misc Tare Weigh
     C                   Z-ADD     *ZERO         WBSJNB                         Production Lead
     C                   Z-ADD     *ZERO         WBSKNB                         Agrimetrics gro
     C                   Z-ADD     *ZERO         WBSLNB                         Agrimetrics pac
     C                   Z-ADD     *ZERO         WBSMNB                         Agrimetrics gra
     C                   Z-ADD     *ZERO         WBCFNB                         PM Pounds per H
     C                   Z-ADD     *ZERO         WBCGNB                         Item Frt Overag
     C                   Z-ADD     *ZERO         WBILNB                         Packages per ca
     C                   Z-ADD     *ZERO         WBCHNB                         Use_Freeze_Sell
     C                   Z-ADD     *ZERO         WBCINB                         PM Batch Size
     C                   Z-ADD     *ZERO         WBCJNB                         Package Level s
     C                   Z-ADD     *ZERO         WBCMNB                         Partial Item Co
     C                   Z-ADD     *ZERO         WBCNNB                         WIP Item Code
     C                   Z-ADD     *ZERO         WBCRNB                         WIP Reject Code
     C                   Z-ADD     *ZERO         WBCSNB                         Std Costing Uni
     C                   Z-ADD     *ZERO         WBCVNB                         FP Std Green We
     C                   Z-ADD     *ZERO         WBCWNB                         PM Std LBS Man
     C                   Z-ADD     *ZERO         WBCXNB                         PM Raw Meat LBS
     C                   Z-ADD     *ZERO         WBCZNB                         PM Formula LBS
     C                   Z-ADD     *ZERO         WBC0NB                         PM Finished LBS
     C                   Z-ADD     *ZERO         WBB4NB                         PM Raw Material
     C                   Z-ADD     *ZERO         WBB5NB                         PM Line Number
     C                   Z-ADD     *ZERO         WBBDNB                         Pieces Per Bag
     C                   Z-ADD     *ZERO         WBBJNB                         Bags Per Unit
     C                   Z-ADD     *ZERO         WBF5WG                         Item Target Pri
     C                   Z-ADD     *ZERO         WBF6WG                         Minimum Piece W
     C                   Z-ADD     *ZERO         WBF7WG                         Maximum Piece W
     C                   Z-ADD     *ZERO         WBBLNB                         Seaboard Equiva
     C                   Z-ADD     *ZERO         WBBNNB                         Production Qty
     C                   Z-ADD     *ZERO         WBAATM                         Job Time
     C                   Z-ADD     *ZERO         WBAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WCAATM                         Job Time
     C                   Z-ADD     *ZERO         WCAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WDAIC3                         Company Number
     C                   Z-ADD     *ZERO         WDHGCD                         Item Code
     C                   Z-ADD     *ZERO         WDAGCS                         Unit Cost Per P
     C                   Z-ADD     *ZERO         WDAECS                         Last Cost
     C                   Z-ADD     *ZERO         WDBACS                         Cost per Primar
     C                   Z-ADD     *ZERO         WDBBCS                         Cost per Pricin
     C                   Z-ADD     *ZERO         WDCBPR                         Revaluation Cos
     C                   Z-ADD     *ZERO         WDGUDT                         Revaluation Eff
     C                   Z-ADD     *ZERO         WDCTPR                         Last Revaluatio
     C                   Z-ADD     *ZERO         WDG4DT                         Last Revaluatio
     C                   Z-ADD     *ZERO         WDBOWG                         On Hand Weight
     C                   Z-ADD     *ZERO         WDDDQT                         On Hand UOM1 Su
     C                   Z-ADD     *ZERO         WDDEQT                         On Hand UOM2 Su
     C                   Z-ADD     *ZERO         WDDFQT                         On Hand UOM3 Su
     C                   Z-ADD     *ZERO         WDHDQT                         Quantity In Chi
     C                   Z-ADD     *ZERO         WDHEQT                         Weight In Chill
     C                   Z-ADD     *ZERO         WDAJQT                         Quantity Schedu
     C                   Z-ADD     *ZERO         WDAQQT                         Quantity on Sal
     C                   Z-ADD     *ZERO         WDAUQT                         Quantity on Pur
     C                   Z-ADD     *ZERO         WDEMQT                         Quantity on Tra
     C                   Z-ADD     *ZERO         WDDOQT                         Quantity Avail
     C                   Z-ADD     *ZERO         WDAKDT                         Date of Last Or
     C                   Z-ADD     *ZERO         WDANDT                         Date of Last Sh
     C                   Z-ADD     *ZERO         WDIDVA                         Value of On Han
     C                   Z-ADD     *ZERO         WDBZPC                         Safety Allowanc
     C                   Z-ADD     *ZERO         WDDGQT                         Safety Allowanc
     C                   Z-ADD     *ZERO         WDDIDT                         Stock Out Date
     C                   Z-ADD     *ZERO         WDBFDY                         Lead Time Last
     C                   Z-ADD     *ZERO         WDDJDT                         Lead Time Date
     C                   Z-ADD     *ZERO         WDBGDY                         Lead Time Next
     C                   Z-ADD     *ZERO         WDDKDT                         Lead Time Date
     C                   Z-ADD     *ZERO         WDDJQT                         Usage Qty per C
     C                   Z-ADD     *ZERO         WDBNWG                         Usage Weight pe
     C                   Z-ADD     *ZERO         WDDLDT                         Inventory Manag
     C                   Z-ADD     *ZERO         WDDPQT                         Minimum Quantit
     C                   Z-ADD     *ZERO         WDDQQT                         Maximum Quantit
     C                   Z-ADD     *ZERO         WDDMDT                         Last Physical C
     C                   Z-ADD     *ZERO         WDAKC8                         Vendor Item_Whs
     C                   Z-ADD     *ZERO         WDRINB                         Item Structure
     C                   Z-ADD     *ZERO         WDRHNB                         Item Structure
     C                   Z-ADD     *ZERO         WDRGNB                         Item Structure
     C                   Z-ADD     *ZERO         WDAATM                         Job Time
     C                   Z-ADD     *ZERO         WDAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WEAIC3                         Company Number
     C                   Z-ADD     *ZERO         WEHGCD                         Item Code
     C                   Z-ADD     *ZERO         WEB4DT                         Transaction Dat
     C                   Z-ADD     *ZERO         WEC4NY                         ITD Sequence Nu
     C                   Z-ADD     *ZERO         WEDXNB                         Sequence Number
     C                   Z-ADD     *ZERO         WEELDT                         Production Date
     C                   Z-ADD     *ZERO         WEA5QT                         Transaction Qua
     C                   Z-ADD     *ZERO         WEAHWG                         Transaction Wei
     C                   Z-ADD     *ZERO         WEAKCS                         USR Transaction
     C                   Z-ADD     *ZERO         WEAYVA                         Extended Amount
     C                   Z-ADD     *ZERO         WECKNB                         GL Document Num
     C                   Z-ADD     *ZERO         WETRBN                         Transfer Batch
     C                   Z-ADD     *ZERO         WETRBS                         Transfer Batch
     C                   Z-ADD     *ZERO         WEC4NB                         Order Number
     C                   Z-ADD     *ZERO         WERINB                         Item Structure
     C                   Z-ADD     *ZERO         WERHNB                         Item Structure
     C                   Z-ADD     *ZERO         WERGNB                         Item Structure
     C                   Z-ADD     *ZERO         WEAWTM                         Production Time
     C                   Z-ADD     *ZERO         WEK7DT                         Label Date
     C                   Z-ADD     *ZERO         WEAATM                         Job Time
     C                   Z-ADD     *ZERO         WEAXDT                         Job Date
      * Clear all neither parameters
      * Crt Itm Trans Dtl f/APICR - Item Transaction Detail  * 
     C                   Z-ADD     *ZERO         WFAATM                         Job Time
     C                   Z-ADD     *ZERO         WFAXDT                         Job Date
      * Obtain default message file
     C     *DTAARA       DEFINE    CAMGFLA       ZADFMF
     C                   IN        ZADFMF
      * Define work field Description Line Two
     C                   EVAL      WUAWNA = ' '
      * Define work field UOM Pricing
     C                   EVAL      WUAICD = ' '
      * Define work field Fresh Chilling Time
     C                   Z-ADD     *ZERO         WUCHTM
      * Define work field Value of On Hand Inventor
     C                   Z-ADD     *ZERO         WUIDVA
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WIAIC3                         Company Number
     C                   Z-ADD     *ZERO         WIHGCD                         Item Code
     C                   Z-ADD     *ZERO         WIELDT                         Production Date
     C                   Z-ADD     *ZERO         WIABWG                         Physical Count
     C                   Z-ADD     *ZERO         WIAGQT                         Physical Count
     C                   Z-ADD     *ZERO         WIAHQT                         Physical Count
     C                   Z-ADD     *ZERO         WIAIQT                         Physical Count
     C                   Z-ADD     *ZERO         WIACWG                         Quantity on Han
     C                   Z-ADD     *ZERO         WIARQT                         Quantity on Han
     C                   Z-ADD     *ZERO         WIASQT                         Quantity on Han
     C                   Z-ADD     *ZERO         WIATQT                         Quantity on Han
     C                   Z-ADD     *ZERO         WIHDQT                         Quantity In Chi
     C                   Z-ADD     *ZERO         WIHEQT                         Weight In Chill
     C                   Z-ADD     *ZERO         WIBMWG                         Physical Start
     C                   Z-ADD     *ZERO         WIDSQT                         Physical Start
     C                   Z-ADD     *ZERO         WIDTQT                         Physical Start
     C                   Z-ADD     *ZERO         WIDUQT                         Physical Start
     C                   Z-ADD     *ZERO         WIDHDT                         Physical Start
     C                   Z-ADD     *ZERO         WIAGCS                         Unit Cost Per P
     C                   Z-ADD     *ZERO         WIAECS                         Last Cost
     C                   Z-ADD     *ZERO         WIIDVA                         Value of On Han
     C                   Z-ADD     *ZERO         WIK7DT                         Label Date
     C                   Z-ADD     *ZERO         WIRINB                         Item Structure
     C                   Z-ADD     *ZERO         WIRHNB                         Item Structure
     C                   Z-ADD     *ZERO         WIRGNB                         Item Structure
     C                   Z-ADD     *ZERO         WIAATM                         Job Time
     C                   Z-ADD     *ZERO         WIAXDT                         Job Date
      * Define work field ZERO
     C                   Z-ADD     *ZERO         WUW0NB
      * Clear all neither parameters
      * Crt Item Bal Dtl f/API CR - Item Balance Detail  * 
     C                   Z-ADD     *ZERO         WJAATM                         Job Time
     C                   Z-ADD     *ZERO         WJAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WKDBNB                         Warehouse Chill
     C                   Z-ADD     *ZERO         WKBWC3                         Shipping Compan
     C                   Z-ADD     *ZERO         WKBTC3                         Accounting Comp
     C                   Z-ADD     *ZERO         WKBUC3                         WHS Sched Prod
     C                   Z-ADD     *ZERO         WKBVC3                         WHS Inventory C
     C                   Z-ADD     *ZERO         WKAATM                         Job Time
     C                   Z-ADD     *ZERO         WKAXDT                         Job Date
      * Define work field Numeric Field Not Needed
     C                   Z-ADD     *ZERO         WUNFNN
      * Dummy move for compiler
     C                   MOVE      '0'           @CN#(1)
     C                   MOVEL     @CN(1)        @CN(1)
     C                   MOVEL     'N'           W0PMT
      * Define local variables for subroutine SHRVGN.
     C                   Z-ADD     *ZERO         WL0001
     C                   Z-ADD     *ZERO         WL0002
     C                   EVAL      WL0003 = ' '
     C                   EVAL      WL0004 = ' '
     C                   EVAL      WL0005 = ' '
     C                   Z-ADD     *ZERO         WL0006
     C                   EVAL      WL0007 = ' '
     C                   EVAL      WL0008 = ' '
     C                   Z-ADD     *ZERO         WL0009
     C                   EVAL      WL0010 = ' '
     C                   EVAL      WL0011 = ' '
     C                   EVAL      WL0012 = ' '
     C                   Z-ADD     *ZERO         WL0013
     C                   EVAL      WL0014 = ' '
     C                   EVAL      WL0015 = ' '
     C                   Z-ADD     *ZERO         WL0016
      * Define local variables for subroutine SIRVGN.
     C                   Z-ADD     *ZERO         WL0017
     C                   Z-ADD     *ZERO         WL0018
     C                   EVAL      WL0019 = ' '
     C                   Z-ADD     *ZERO         WL0020
     C                   Z-ADD     *ZERO         WL0021
     C                   Z-ADD     *ZERO         WL0022
     C                   Z-ADD     *ZERO         WL0023
     C                   Z-ADD     *ZERO         WL0024
     C                   Z-ADD     *ZERO         WL0025
      * Define local variables for subroutine SLCRRC.
     C                   Z-ADD     *ZERO         WL0026
     C                   Z-ADD     *ZERO         WL0027
     C                   EVAL      WL0028 = ' '
     C                   Z-ADD     *ZERO         WL0029
     C                   Z-ADD     *ZERO         WL0030
     C                   Z-ADD     *ZERO         WL0031
     C                   Z-ADD     *ZERO         WL0032
     C                   Z-ADD     *ZERO         WL0033
     C                   EVAL      WL0034 = ' '
     C                   Z-ADD     *ZERO         WL0035
     C                   Z-ADD     *ZERO         WL0036
     C                   Z-ADD     *ZERO         WL0037
     C                   Z-ADD     *ZERO         WL0038
     C                   Z-ADD     *ZERO         WL0039
     C                   Z-ADD     *ZERO         WL0040
     C                   EVAL      WL0041 = ' '
     C                   Z-ADD     *ZERO         WL0042
     C                   Z-ADD     *ZERO         WL0043
     C                   Z-ADD     *ZERO         WL0044
     C                   Z-ADD     *ZERO         WL0045
     C                   Z-ADD     *ZERO         WL0046
     C                   Z-ADD     *ZERO         WL0047
     C                   Z-ADD     *ZERO         WL0048
     C                   Z-ADD     *ZERO         WL0049
     C                   Z-ADD     *ZERO         WL0050
     C                   Z-ADD     *ZERO         WL0051
     C                   Z-ADD     *ZERO         WL0052
     C                   Z-ADD     *ZERO         WL0053
     C                   EVAL      WL0054 = ' '
     C                   EVAL      WL0055 = ' '
     C                   EVAL      WL0056 = ' '
     C                   EVAL      WL0057 = ' '
      * Define local variables for subroutine SMRVGN.
     C                   EVAL      WL0058 = ' '
     C                   EVAL      WL0059 = ' '
      * Define local variables for subroutine SNDLRC.
     C                   Z-ADD     *ZERO         WL0060
     C                   Z-ADD     *ZERO         WL0061
     C                   EVAL      WL0062 = ' '
     C                   Z-ADD     *ZERO         WL0063
      * Define local variables for subroutine SPRVGN.
     C                   Z-ADD     *ZERO         WL0064
     C                   Z-ADD     *ZERO         WL0065
     C                   EVAL      WL0066 = ' '
     C                   Z-ADD     *ZERO         WL0067
     C                   Z-ADD     *ZERO         WL0068
     C                   Z-ADD     *ZERO         WL0069
     C                   Z-ADD     *ZERO         WL0070
     C                   Z-ADD     *ZERO         WL0071
      * Define local work field Module Release Status
     C                   EVAL      YL0001 = ' '
      * Define null work field Description Line One
     C                   EVAL      YN0001 = ' '
      * Define null work field Description Line Two
     C                   EVAL      YN0002 = ' '
      * Define local work field UOM Primary
     C                   EVAL      YL0002 = ' '
      * Define null work field Conversion Factor 1
     C                   Z-ADD     *ZERO         YN0003
      * Define null work field Operation Factor 1
     C                   EVAL      YN0004 = ' '
      * Define null work field UOM Second
     C                   EVAL      YN0005 = ' '
      * Define null work field Conversion Factor 2
     C                   Z-ADD     *ZERO         YN0006
      * Define null work field Operation Factor 2
     C                   EVAL      YN0007 = ' '
      * Define null work field UOM Third
     C                   EVAL      YN0008 = ' '
      * Define null work field UOM Pricing
     C                   EVAL      YN0009 = ' '
      * Define null work field Unit Weight
     C                   Z-ADD     *ZERO         YN0010
      * Define null work field Production Date Control
     C                   EVAL      YN0011 = ' '
      * Define null work field Catch Weight Status
     C                   EVAL      YN0012 = ' '
      * Define local work field Item Structure Class Code
     C                   Z-ADD     *ZERO         YL0003
      * Define local work field Item Structure Group Code
     C                   Z-ADD     *ZERO         YL0004
      * Define local work field Item Structure Type Code
     C                   Z-ADD     *ZERO         YL0005
      * Define null work field Default Warehouse
     C                   EVAL      YN0013 = ' '
      * Define null work field Price Method Default
     C                   EVAL      YN0014 = ' '
      * Define null work field Fresh Chilling Time
     C                   Z-ADD     *ZERO         YN0015
      * Define local work field Description
     C                   EVAL      YL0006 = ' '
      * Define local work field USR Transaction_Unit Cost
     C                   Z-ADD     *ZERO         YL0007
      * Define null work field Cost Update Pending
     C                   EVAL      YN0016 = ' '
      * Define null work field Post GL Status
     C                   EVAL      YN0017 = ' '
      * Define null work field Vendor Item_Whse Default
     C                   Z-ADD     *ZERO         YN0018
      * Define null work field Record Status
     C                   EVAL      YN0019 = ' '
      * Define local work field Extended Amount
     C                   Z-ADD     *ZERO         YL0008
      * Define local work field ITD Sequence Number
     C                   Z-ADD     *ZERO         YL0009
      *================================================================
     CSR   ZZEXIT        ENDSR
** @CN
00001 0001-01-01-00.00.00.00000
