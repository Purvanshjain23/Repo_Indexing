// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PNL1XFR
// ?Date: 14.08.2025 Time: 03:45:35
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?***** Change Log and Comments
DO;

//?** 10/02/2009 RMC E00494 Pre ODBS Build processes
ENDDO;

EXECUTE FUNCTION(Upd Reallocate Sts    RT) TYPE(RTVOBJ) FILE(PDKNCPP)           AC1649428;
PARAMETER(360);
{
 //?USER: Initialize routine

 // LCL.Order Number = CON.*ZERO
 LCL.Order_Number = *ZERO;

 //?USER: Process Data record

 CASE;

 // IF LCL.Order Number NE DB1.Order Number
 IF LCL.Order_Number <> DB1.Order_Number;

 // LCL.Order Number = DB1.Order Number
 LCL.Order_Number = DB1.Order_Number;

 EXECUTE FUNCTION(RTV Header Status      RT) TYPE(RTVOBJ) FILE(OPBFCPP)          AC1231329;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Order_Number);
 PARAMETER(LCL.Header_Status);
 {
  //?USER: Processing if Data record not found

  // PGM.*Return code = CND.*Record does not exist
  PGM.*Return_code = 'Y2U0005';

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 ENDIF;

 CASE;

 // IF LCL.Header Status is Avail/Alloc/Enter/Hold
 IF LCL.Header_Status = 'L'/'A'/'E'/'H';

 EXECUTE FUNCTION(Chg Reallocate Sts    CH) TYPE(CHGOBJ) FILE(PDKNCPP)           AC1649430;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Order_Number);
 PARAMETER(DB1.Order_Sequence_Number);
 PARAMETER(DB1.Order_Secondary_Line_Seq);
 PARAMETER(DB1.OD_Production_Date);
 PARAMETER('Y');
 {
  //?USER: Processing before Data update

  EXECUTE FUNCTION(Set Record Stamp CHGOB IF) TYPE(EXCINTFUN)                     AC1283156;
  PARAMETER(DB1.Job_Time);
  PARAMETER(DB1.User_Id);
  PARAMETER(DB1.Job_Name);
  PARAMETER(DB1.Job_Date);
  {
   //?Execute internal function

   // PAR.Job Time = JOB.*Job time
   PAR.Job_Time = JOB.*Job_time;

   // PAR.User Id = JOB.*USER
   PAR.User_Id = JOB.*USER;

   // PAR.Job Name = JOB.*PROGRAM
   PAR.Job_Name = JOB.*PROGRAM;

   // PAR.Job Date = JOB.*Job date
   PAR.Job_Date = JOB.*Job_date;

  }

 }

 // IF *OTHERWISE
 IF *OTHERWISE;

 EXECUTE FUNCTION(DLT Ord Detail Sched   DL) TYPE(DLTOBJ) FILE(PDKNCPP)          AC1385631;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Order_Number);
 PARAMETER(DB1.Order_Sequence_Number);
 PARAMETER(DB1.Order_Secondary_Line_Seq);
 PARAMETER(DB1.OD_Production_Date);
 EXECUTE FUNCTION(Del OrdDtl Sch-ConsDT RT) TYPE(RTVOBJ) FILE(POB6CPP)           AC1924937;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Order_Number);
 PARAMETER(DB1.Order_Sequence_Number);
 PARAMETER(DB1.Order_Secondary_Line_Seq);
 PARAMETER(DB1.OD_Production_Date);
 {
  //?USER: Process Data record

  EXECUTE FUNCTION(Del OrdDtl Sch-Consmd DL) TYPE(DLTOBJ) FILE(POB6CPP)           AC1647985;
  PARAMETER(DB1.Company_Number);
  PARAMETER(DB1.Order_Number);
  PARAMETER(DB1.Order_Sequence_Number);
  PARAMETER(DB1.Order_Secondary_Line_Seq);
  PARAMETER(DB1.OD_Production_Date);
  PARAMETER(DB1.ODS_Sequence_Number);
 }

 EXECUTE FUNCTION(Del Ord Dtl Sch-Inv   RT) TYPE(RTVOBJ) FILE(POB5CPP)           AC1647181;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Order_Number);
 PARAMETER(DB1.Order_Sequence_Number);
 PARAMETER(DB1.Order_Secondary_Line_Seq);
 {
  //?USER: Process Data record

  EXECUTE FUNCTION(Del Ord Dtl Sch-Inv   DL) TYPE(DLTOBJ) FILE(POB5CPP)           AC1647003;
  PARAMETER(DB1.Company_Number);
  PARAMETER(DB1.Order_Number);
  PARAMETER(DB1.Order_Sequence_Number);
  PARAMETER(DB1.Order_Secondary_Line_Seq);
  PARAMETER(DB1.OD_Production_Date);
 }

 ENDIF;

}


EXECUTE FUNCTION(Upd Reallocate Sts    RT) TYPE(RTVOBJ) FILE(PDKNCPP)           AC1649428;
PARAMETER(960);
{
 //?USER: Initialize routine

 // LCL.Order Number = CON.*ZERO
 LCL.Order_Number = *ZERO;

 //?USER: Process Data record

 CASE;

 // IF LCL.Order Number NE DB1.Order Number
 IF LCL.Order_Number <> DB1.Order_Number;

 // LCL.Order Number = DB1.Order Number
 LCL.Order_Number = DB1.Order_Number;

 EXECUTE FUNCTION(RTV Header Status      RT) TYPE(RTVOBJ) FILE(OPBFCPP)          AC1231329;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Order_Number);
 PARAMETER(LCL.Header_Status);
 {
  //?USER: Processing if Data record not found

  // PGM.*Return code = CND.*Record does not exist
  PGM.*Return_code = 'Y2U0005';

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 ENDIF;

 CASE;

 // IF LCL.Header Status is Avail/Alloc/Enter/Hold
 IF LCL.Header_Status = 'L'/'A'/'E'/'H';

 EXECUTE FUNCTION(Chg Reallocate Sts    CH) TYPE(CHGOBJ) FILE(PDKNCPP)           AC1649430;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Order_Number);
 PARAMETER(DB1.Order_Sequence_Number);
 PARAMETER(DB1.Order_Secondary_Line_Seq);
 PARAMETER(DB1.OD_Production_Date);
 PARAMETER('Y');
 {
  //?USER: Processing before Data update

  EXECUTE FUNCTION(Set Record Stamp CHGOB IF) TYPE(EXCINTFUN)                     AC1283156;
  PARAMETER(DB1.Job_Time);
  PARAMETER(DB1.User_Id);
  PARAMETER(DB1.Job_Name);
  PARAMETER(DB1.Job_Date);
  {
   //?Execute internal function

   // PAR.Job Time = JOB.*Job time
   PAR.Job_Time = JOB.*Job_time;

   // PAR.User Id = JOB.*USER
   PAR.User_Id = JOB.*USER;

   // PAR.Job Name = JOB.*PROGRAM
   PAR.Job_Name = JOB.*PROGRAM;

   // PAR.Job Date = JOB.*Job date
   PAR.Job_Date = JOB.*Job_date;

  }

 }

 // IF *OTHERWISE
 IF *OTHERWISE;

 EXECUTE FUNCTION(DLT Ord Detail Sched   DL) TYPE(DLTOBJ) FILE(PDKNCPP)          AC1385631;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Order_Number);
 PARAMETER(DB1.Order_Sequence_Number);
 PARAMETER(DB1.Order_Secondary_Line_Seq);
 PARAMETER(DB1.OD_Production_Date);
 EXECUTE FUNCTION(Del OrdDtl Sch-ConsDT RT) TYPE(RTVOBJ) FILE(POB6CPP)           AC1924937;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Order_Number);
 PARAMETER(DB1.Order_Sequence_Number);
 PARAMETER(DB1.Order_Secondary_Line_Seq);
 PARAMETER(DB1.OD_Production_Date);
 {
  //?USER: Process Data record

  EXECUTE FUNCTION(Del OrdDtl Sch-Consmd DL) TYPE(DLTOBJ) FILE(POB6CPP)           AC1647985;
  PARAMETER(DB1.Company_Number);
  PARAMETER(DB1.Order_Number);
  PARAMETER(DB1.Order_Sequence_Number);
  PARAMETER(DB1.Order_Secondary_Line_Seq);
  PARAMETER(DB1.OD_Production_Date);
  PARAMETER(DB1.ODS_Sequence_Number);
 }

 EXECUTE FUNCTION(Del Ord Dtl Sch-Inv   RT) TYPE(RTVOBJ) FILE(POB5CPP)           AC1647181;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Order_Number);
 PARAMETER(DB1.Order_Sequence_Number);
 PARAMETER(DB1.Order_Secondary_Line_Seq);
 {
  //?USER: Process Data record

  EXECUTE FUNCTION(Del Ord Dtl Sch-Inv   DL) TYPE(DLTOBJ) FILE(POB5CPP)           AC1647003;
  PARAMETER(DB1.Company_Number);
  PARAMETER(DB1.Order_Number);
  PARAMETER(DB1.Order_Sequence_Number);
  PARAMETER(DB1.Order_Secondary_Line_Seq);
  PARAMETER(DB1.OD_Production_Date);
 }

 ENDIF;

}


//?Delete Order Detail Schedule for orders older than 3 days ago
//?  They wont be reallocated in the following routines
//?  To Remove the detail record, set report typ = "D"
// PAR.Scheduled Ship Date USR = JOB.*Job date + CON.-3 *DAYS
PAR.Scheduled_Ship_Date_USR = DATEINCR(JOB.*Job_date '-3' 'DY' 1111111 'NONE' 'N' 1);

// Call program PrtRmv OrddtlSch-NAllcPF.
CALL PROGRAM(PrtRmv OrddtlSch-NAllcPF) ('PMFPPFR');
PARAMETER(360);
PARAMETER(PAR.Scheduled_Ship_Date_USR);
PARAMETER('D');

// Call program PrtRmv OrddtlSch-NAllcPF.
CALL PROGRAM(PrtRmv OrddtlSch-NAllcPF) ('PMFPPFR');
PARAMETER(960);
PARAMETER(PAR.Scheduled_Ship_Date_USR);
PARAMETER('D');

