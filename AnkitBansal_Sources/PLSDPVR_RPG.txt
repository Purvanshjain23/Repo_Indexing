     H/TITLE PmtClc Crc Mrt Activ Crc  Prompt & validate record
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Prompts fields, allowing user changes
     H* - Validates fields
     H* - If valid, performs an action
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Prompt & validate record
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISJBADE
     H* Date          : 04/19/21  Time  : 16:34:36
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPLSDPVR#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: PmtClc Crc Mrt Activ Crc  Prompt & validate record
      *
     FPKB1CPLHIF  E           K        DISK
      * RTV : Carcass Detail            Active Carcasses Only
      *
     FPKARREL0IF  E           K        DISK
      * RTV : Carcass Merit Program     Retrieval index
      *
     FPLBPCPL2IF  E           K        DISK
      * RSQ : Carcass Merit Prog MktGrp CMP/Mkt/Group/PurchDteDe
      *
     FPKBYREL2IF  E           K        DISK
      * RSQ : Carcass Merit Matrix Row  Cmp/MinCrc(d)
      *
     FPKBZREL2IF  E           K        DISK
      * RSQ : Carcass Merit Matrix Col  Cmp/Row/Lean%
      *
     FPKBZREL3IF  E           K        DISK
      * RSQ : Carcass Merit Matrix Col  Cmp/Row/Lean%(a)
      *
     FPKBYREL1IF  E           K        DISK
      * RTV : Carcass Merit Matrix Row  Retrieval index
      *
     FPKBZREL6IF  E           K        DISK
      * RSQ : Carcass Merit Matrix Col  Cmp/RoW/Bckft(d)
      *
     FPKBZREL5IF  E           K        DISK
      * RSQ : Carcass Merit Matrix Col  Cmp/Row/Bckft(a)
      *
     FPKA1CPL0IF  E           K        DISK
      * RTV : Tattoo Header             Retrieval index
      *
     FPKACREL1IF  E           K        DISK
      * RTV : Producer                  Retrieval index
      *
     FPKAAREL0IF  E           K        DISK
      * RTV : Source                    Retrieval index
      *
     FPKB1CPL0UF  E           K        DISK
      * UPD : Carcass Detail            Update index
      *
     FPKB1CPLDIF  E           K        DISK                      A
      * UPD : Carcass Detail            Update index Purge
      *
      * Days in month for date validation
     E                    @XD    12  12  2 0
     I@B1CPEF
      * Carcass Detail            Active Carcasses Only
      * Renamed input format fields
     I              B1HMNB                          WAHMNB
     I              B1BNNB                          WABNNB
     I              B1BONB                          WABONB
     I              B1CVNB                          WACVNB
     I              B1B0DT                          WAB0DT
     I              B1LGNB                          WALGNB
     I              B1EUNB                          WAEUNB
     I              B1LHNB                          WALHNB
     I              B1INST                          WAINST
     I              B1BEPR                          WABEPR
     I              B1ASPC                          WAASPC
     I              B1EWNB                          WAEWNB
     I              B1B4PR                          WAB4PR
     I              B1EYNB                          WAEYNB
     I              B1B1PR                          WAB1PR
     I              B1AVPR                          WAAVPR
     I              B1AUPC                          WAAUPC
     I              B1AWPR                          WAAWPR
     I              B1AXPR                          WAAXPR
     I              B1EZNB                          WAEZNB
     I              B1AYPR                          WAAYPR
     I              B1BBDT                          WABBDT
     I              B1AKTM                          WAAKTM
     I              B1IQST                          WAIQST
     I              B1EFST                          WAEFST
     I              B1H6NB                          WAH6NB
     I              B1BEPC                          WABEPC
     I              B1GCST                          WAGCST
     I              B1GDST                          WAGDST
     I              B1GEST                          WAGEST
     I              B1BHPC                          WABHPC
     I              B1IOST                          WAIOST
     I              B1IPST                          WAIPST
     I              B1LTNB                          WALTNB
     I              B1JNST                          WAJNST
     I              B1X4NB                          WAX4NB
     I              B1FNPC                          WAFNPC
     I              B1FOPC                          WAFOPC
     I              B1FPPC                          WAFPPC
     I              B1K2ST                          WAK2ST
     I              B1K3ST                          WAK3ST
     I              B1JWPR                          WAJWPR
     I              B1F5PC                          WAF5PC
     I              B1JXPR                          WAJXPR
     I              B1JYPR                          WAJYPR
     I              B1JZPR                          WAJZPR
     I              B1J0PR                          WAJ0PR
     I              B1J1PR                          WAJ1PR
     I              B1J2PR                          WAJ2PR
     I              B1J3PR                          WAJ3PR
     I              B1J4PR                          WAJ4PR
     I              B1UTST                          WAUTST
     I              B1HVCD                          WAHVCD
     I              B1DKJR                          WADKJR
     I              B1ITJF                          WAITJF
     I              B1IJGR                          WAIJGR
     I              B1ORJE                          WAORJE
     I              B1OTJR                          WAOTJR
     I              B1PEIR                          WAPEIR
     I              B1IEUF                          WAIEUF
     I              B1ORUE                          WAORUE
     I              B1IUTR                          WAIUTR
     I              B1IJRR                          WAIJRR
     I              B1VCST                          WAVCST
     I              B1VDST                          WAVDST
     I              B1VEST                          WAVEST
     I              B1VFST                          WAVFST
     I              B1VGST                          WAVGST
     I              B1ABCD                          WAABCD
     I              B1AACD                          WAAACD
     I              B1AAVN                          WAAAVN
     I              B1AADT                          WAAADT
     I              B1AMTM                          WAAMTM
     I              B1AJST                          WAAJST
     I              B1AHVN                          WAAHVN
     I              B1AGVN                          WAAGVN
     I              B1ABVN                          WAABVN
     I              B1ABDT                          WAABDT
     I              B1ABTM                          WAABTM
      *
     I@ARREBF
      * Carcass Merit Program     Retrieval index
      * Renamed input format fields
     I              ARAMCD                          WBAMCD
     I              ARA3TX                          WBA3TX
     I              ARDLST                          WBDLST
     I              ARDMST                          WBDMST
     I              ARDOST                          WBDOST
     I              ARDQST                          WBDQST
     I              ARAZPC                          WBAZPC
     I              ARA0PC                          WBA0PC
     I              ARDTST                          WBDTST
     I              ARF5ST                          WBF5ST
     I              ARI1PR                          WBI1PR
     I              ARVEPR                          WBVEPR
     I              ARVFPR                          WBVFPR
     I              ARVHPR                          WBVHPR
     I              ARVIPR                          WBVIPR
     I              ARVJPR                          WBVJPR
     I              ARZ2ST                          WBZ2ST
     I              ARZ3ST                          WBZ3ST
     I              ARZ4ST                          WBZ4ST
     I              ARAAVN                          WBAAVN
     I              ARAADT                          WBAADT
     I              ARAMTM                          WBAMTM
     I              ARAJST                          WBAJST
     I              ARAHVN                          WBAHVN
     I              ARAGVN                          WBAGVN
     I              ARABVN                          WBABVN
     I              ARABDT                          WBABDT
     I              ARABTM                          WBABTM
      *
     I@BPCPSK
      * Carcass Merit Prog MktGrp CMP/Mkt/Group/PurchDteDe
      * Renamed input format fields
     I              BPAMCD                          WCAMCD
     I              BPGYDT                          WCGYDT
     I              BPPXCD                          WCPXCD
     I              BPPYCD                          WCPYCD
     I              BPAAVN                          WCAAVN
     I              BPAADT                          WCAADT
     I              BPAMTM                          WCAMTM
     I              BPAJST                          WCAJST
     I              BPAHVN                          WCAHVN
     I              BPAGVN                          WCAGVN
     I              BPABVN                          WCABVN
     I              BPABDT                          WCABDT
     I              BPABTM                          WCABTM
      *
     I@BYREJ9
      * Carcass Merit Matrix Row  Cmp/MinCrc(d)
      * Renamed input format fields
     I              BYAMCD                          WDAMCD
     I              BYE8NB                          WDE8NB
     I              BYEGNB                          WDEGNB
     I              BYEHNB                          WDEHNB
     I              BYEINB                          WDEINB
     I              BYEJNB                          WDEJNB
     I              BYEKNB                          WDEKNB
     I              BYAQPC                          WDAQPC
     I              BYEMNB                          WDEMNB
     I              BYE2NB                          WDE2NB
     I              BYLJA1                          WDLJA1
     I              BYAAVN                          WDAAVN
     I              BYAADT                          WDAADT
     I              BYAMTM                          WDAMTM
     I              BYAJST                          WDAJST
     I              BYAHVN                          WDAHVN
     I              BYAGVN                          WDAGVN
     I              BYABVN                          WDABVN
     I              BYABDT                          WDABDT
     I              BYABTM                          WDABTM
      *
     I@BZREKA
      * Carcass Merit Matrix Col  Cmp/Row/Lean%
      * Renamed input format fields
     I              BZAMCD                          WEAMCD
     I              BZE8NB                          WEE8NB
     I              BZE4NB                          WEE4NB
     I              BZA1PC                          WEA1PC
     I              BZE7NB                          WEE7NB
     I              BZCHCD                          WECHCD
     I              BZERNB                          WEERNB
     I              BZAAVN                          WEAAVN
     I              BZAADT                          WEAADT
     I              BZAMTM                          WEAMTM
     I              BZAJST                          WEAJST
     I              BZAHVN                          WEAHVN
     I              BZAGVN                          WEAGVN
     I              BZABVN                          WEABVN
     I              BZABDT                          WEABDT
     I              BZABTM                          WEABTM
      *
     I@BZREPO
      * Carcass Merit Matrix Col  Cmp/Row/Lean%(a)
      * Renamed input format fields
     I              BZAMCD                          WFAMCD
     I              BZE8NB                          WFE8NB
     I              BZE4NB                          WFE4NB
     I              BZA1PC                          WFA1PC
     I              BZE7NB                          WFE7NB
     I              BZCHCD                          WFCHCD
     I              BZERNB                          WFERNB
     I              BZAAVN                          WFAAVN
     I              BZAADT                          WFAADT
     I              BZAMTM                          WFAMTM
     I              BZAJST                          WFAJST
     I              BZAHVN                          WFAHVN
     I              BZAGVN                          WFAGVN
     I              BZABVN                          WFABVN
     I              BZABDT                          WFABDT
     I              BZABTM                          WFABTM
      *
     I@BYREGF
      * Carcass Merit Matrix Row  Retrieval index
      * Renamed input format fields
     I              BYAMCD                          WGAMCD
     I              BYE8NB                          WGE8NB
     I              BYEGNB                          WGEGNB
     I              BYEHNB                          WGEHNB
     I              BYEINB                          WGEINB
     I              BYEJNB                          WGEJNB
     I              BYEKNB                          WGEKNB
     I              BYAQPC                          WGAQPC
     I              BYEMNB                          WGEMNB
     I              BYE2NB                          WGE2NB
     I              BYLJA1                          WGLJA1
     I              BYAAVN                          WGAAVN
     I              BYAADT                          WGAADT
     I              BYAMTM                          WGAMTM
     I              BYAJST                          WGAJST
     I              BYAHVN                          WGAHVN
     I              BYAGVN                          WGAGVN
     I              BYABVN                          WGABVN
     I              BYABDT                          WGABDT
     I              BYABTM                          WGABTM
      *
     I@BZRETM
      * Carcass Merit Matrix Col  Cmp/RoW/Bckft(d)
      * Renamed input format fields
     I              BZAMCD                          WHAMCD
     I              BZE8NB                          WHE8NB
     I              BZE4NB                          WHE4NB
     I              BZA1PC                          WHA1PC
     I              BZE7NB                          WHE7NB
     I              BZCHCD                          WHCHCD
     I              BZERNB                          WHERNB
     I              BZAAVN                          WHAAVN
     I              BZAADT                          WHAADT
     I              BZAMTM                          WHAMTM
     I              BZAJST                          WHAJST
     I              BZAHVN                          WHAHVN
     I              BZAGVN                          WHAGVN
     I              BZABVN                          WHABVN
     I              BZABDT                          WHABDT
     I              BZABTM                          WHABTM
      *
     I@BZRETL
      * Carcass Merit Matrix Col  Cmp/Row/Bckft(a)
      * Renamed input format fields
     I              BZAMCD                          WIAMCD
     I              BZE8NB                          WIE8NB
     I              BZE4NB                          WIE4NB
     I              BZA1PC                          WIA1PC
     I              BZE7NB                          WIE7NB
     I              BZCHCD                          WICHCD
     I              BZERNB                          WIERNB
     I              BZAAVN                          WIAAVN
     I              BZAADT                          WIAADT
     I              BZAMTM                          WIAMTM
     I              BZAJST                          WIAJST
     I              BZAHVN                          WIAHVN
     I              BZAGVN                          WIAGVN
     I              BZABVN                          WIABVN
     I              BZABDT                          WIABDT
     I              BZABTM                          WIABTM
      *
     I@B1CPG6
      * Carcass Detail            Update index
      * Renamed input format fields
     I              B1HMNB                          WJHMNB
     I              B1BNNB                          WJBNNB
     I              B1BONB                          WJBONB
     I              B1CVNB                          WJCVNB
     I              B1B0DT                          WJB0DT
     I              B1LGNB                          WJLGNB
     I              B1EUNB                          WJEUNB
     I              B1LHNB                          WJLHNB
     I              B1INST                          WJINST
     I              B1BEPR                          WJBEPR
     I              B1ASPC                          WJASPC
     I              B1EWNB                          WJEWNB
     I              B1B4PR                          WJB4PR
     I              B1EYNB                          WJEYNB
     I              B1B1PR                          WJB1PR
     I              B1AVPR                          WJAVPR
     I              B1AUPC                          WJAUPC
     I              B1AWPR                          WJAWPR
     I              B1AXPR                          WJAXPR
     I              B1EZNB                          WJEZNB
     I              B1AYPR                          WJAYPR
     I              B1BBDT                          WJBBDT
     I              B1AKTM                          WJAKTM
     I              B1IQST                          WJIQST
     I              B1EFST                          WJEFST
     I              B1H6NB                          WJH6NB
     I              B1BEPC                          WJBEPC
     I              B1GCST                          WJGCST
     I              B1GDST                          WJGDST
     I              B1GEST                          WJGEST
     I              B1BHPC                          WJBHPC
     I              B1IOST                          WJIOST
     I              B1IPST                          WJIPST
     I              B1LTNB                          WJLTNB
     I              B1JNST                          WJJNST
     I              B1X4NB                          WJX4NB
     I              B1FNPC                          WJFNPC
     I              B1FOPC                          WJFOPC
     I              B1FPPC                          WJFPPC
     I              B1K2ST                          WJK2ST
     I              B1K3ST                          WJK3ST
     I              B1JWPR                          WJJWPR
     I              B1F5PC                          WJF5PC
     I              B1JXPR                          WJJXPR
     I              B1JYPR                          WJJYPR
     I              B1JZPR                          WJJZPR
     I              B1J0PR                          WJJ0PR
     I              B1J1PR                          WJJ1PR
     I              B1J2PR                          WJJ2PR
     I              B1J3PR                          WJJ3PR
     I              B1J4PR                          WJJ4PR
     I              B1UTST                          WJUTST
     I              B1HVCD                          WJHVCD
     I              B1DKJR                          WJDKJR
     I              B1ITJF                          WJITJF
     I              B1IJGR                          WJIJGR
     I              B1ORJE                          WJORJE
     I              B1OTJR                          WJOTJR
     I              B1PEIR                          WJPEIR
     I              B1IEUF                          WJIEUF
     I              B1ORUE                          WJORUE
     I              B1IUTR                          WJIUTR
     I              B1IJRR                          WJIJRR
     I              B1VCST                          WJVCST
     I              B1VDST                          WJVDST
     I              B1VEST                          WJVEST
     I              B1VFST                          WJVFST
     I              B1VGST                          WJVGST
     I              B1ABCD                          WJABCD
     I              B1AACD                          WJAACD
     I              B1AAVN                          WJAAVN
     I              B1AADT                          WJAADT
     I              B1AMTM                          WJAMTM
     I              B1AJST                          WJAJST
     I              B1AHVN                          WJAHVN
     I              B1AGVN                          WJAGVN
     I              B1ABVN                          WJABVN
     I              B1ABDT                          WJABDT
     I              B1ABTM                          WJABTM
      *
     I@B1CPVI
      * Carcass Detail            Update index Purge
      * Renamed input format fields
     I              B1HMNB                          WKHMNB
     I              B1BNNB                          WKBNNB
     I              B1BONB                          WKBONB
     I              B1CVNB                          WKCVNB
     I              B1B0DT                          WKB0DT
     I              B1LGNB                          WKLGNB
     I              B1EUNB                          WKEUNB
     I              B1LHNB                          WKLHNB
     I              B1INST                          WKINST
     I              B1BEPR                          WKBEPR
     I              B1ASPC                          WKASPC
     I              B1EWNB                          WKEWNB
     I              B1B4PR                          WKB4PR
     I              B1EYNB                          WKEYNB
     I              B1B1PR                          WKB1PR
     I              B1AVPR                          WKAVPR
     I              B1AUPC                          WKAUPC
     I              B1AWPR                          WKAWPR
     I              B1AXPR                          WKAXPR
     I              B1EZNB                          WKEZNB
     I              B1AYPR                          WKAYPR
     I              B1BBDT                          WKBBDT
     I              B1AKTM                          WKAKTM
     I              B1IQST                          WKIQST
     I              B1EFST                          WKEFST
     I              B1H6NB                          WKH6NB
     I              B1BEPC                          WKBEPC
     I              B1GCST                          WKGCST
     I              B1GDST                          WKGDST
     I              B1GEST                          WKGEST
     I              B1BHPC                          WKBHPC
     I              B1IOST                          WKIOST
     I              B1IPST                          WKIPST
     I              B1LTNB                          WKLTNB
     I              B1JNST                          WKJNST
     I              B1X4NB                          WKX4NB
     I              B1FNPC                          WKFNPC
     I              B1FOPC                          WKFOPC
     I              B1FPPC                          WKFPPC
     I              B1K2ST                          WKK2ST
     I              B1K3ST                          WKK3ST
     I              B1JWPR                          WKJWPR
     I              B1F5PC                          WKF5PC
     I              B1JXPR                          WKJXPR
     I              B1JYPR                          WKJYPR
     I              B1JZPR                          WKJZPR
     I              B1J0PR                          WKJ0PR
     I              B1J1PR                          WKJ1PR
     I              B1J2PR                          WKJ2PR
     I              B1J3PR                          WKJ3PR
     I              B1J4PR                          WKJ4PR
     I              B1UTST                          WKUTST
     I              B1HVCD                          WKHVCD
     I              B1DKJR                          WKDKJR
     I              B1ITJF                          WKITJF
     I              B1IJGR                          WKIJGR
     I              B1ORJE                          WKORJE
     I              B1OTJR                          WKOTJR
     I              B1PEIR                          WKPEIR
     I              B1IEUF                          WKIEUF
     I              B1ORUE                          WKORUE
     I              B1IUTR                          WKIUTR
     I              B1IJRR                          WKIJRR
     I              B1VCST                          WKVCST
     I              B1VDST                          WKVDST
     I              B1VEST                          WKVEST
     I              B1VFST                          WKVFST
     I              B1VGST                          WKVGST
     I              B1ABCD                          WKABCD
     I              B1AACD                          WKAACD
     I              B1AAVN                          WKAAVN
     I              B1AADT                          WKAADT
     I              B1AMTM                          WKAMTM
     I              B1AJST                          WKAJST
     I              B1AHVN                          WKAHVN
     I              B1AGVN                          WKAGVN
     I              B1ABVN                          WKABVN
     I              B1ABDT                          WKABDT
     I              B1ABTM                          WKABTM
      *
     I@A1CPC4
      * Tattoo Header             Retrieval index
      * Renamed input format fields
     I              A1HMNB                          WLHMNB
     I              A1BNNB                          WLBNNB
     I              A1BONB                          WLBONB
     I              A1CVNB                          WLCVNB
     I              A1B0DT                          WLB0DT
     I              A1AWDT                          WLAWDT
     I              A1BICD                          WLBICD
     I              A1CPST                          WLCPST
     I              A1ACPR                          WLACPR
     I              A1B9PR                          WLB9PR
     I              A1CAPR                          WLCAPR
     I              A1C4ST                          WLC4ST
     I              A1AIPR                          WLAIPR
     I              A1A6DT                          WLA6DT
     I              A1C2ST                          WLC2ST
     I              A1CXNB                          WLCXNB
     I              A1CWNB                          WLCWNB
     I              A1FCNB                          WLFCNB
     I              A1H9NB                          WLH9NB
     I              A1FDNB                          WLFDNB
     I              A1FENB                          WLFENB
     I              A1HENB                          WLHENB
     I              A1HFNB                          WLHFNB
     I              A1CYNB                          WLCYNB
     I              A1LRNB                          WLLRNB
     I              A1E0NB                          WLE0NB
     I              A1A5PC                          WLA5PC
     I              A1FBNB                          WLFBNB
     I              A1A4PC                          WLA4PC
     I              A1F7NB                          WLF7NB
     I              A1HDNB                          WLHDNB
     I              A1F5NB                          WLF5NB
     I              A1F4NB                          WLF4NB
     I              A1F3NB                          WLF3NB
     I              A1F2NB                          WLF2NB
     I              A1AVPC                          WLAVPC
     I              A1AWPC                          WLAWPC
     I              A1CWPC                          WLCWPC
     I              A1A8PC                          WLA8PC
     I              A1A7PC                          WLA7PC
     I              A1B8PR                          WLB8PR
     I              A1AMPR                          WLAMPR
     I              A1ANPR                          WLANPR
     I              A1AYVA                          WLAYVA
     I              A1AWVA                          WLAWVA
     I              A1AOPR                          WLAOPR
     I              A1AXVA                          WLAXVA
     I              A1APPR                          WLAPPR
     I              A1ASPR                          WLASPR
     I              A1A4VA                          WLA4VA
     I              A1ATPR                          WLATPR
     I              A1A5VA                          WLA5VA
     I              A1CBPR                          WLCBPR
     I              A1CCPR                          WLCCPR
     I              A1LPNB                          WLLPNB
     I              A1CDPR                          WLCDPR
     I              A1A7VA                          WLA7VA
     I              A1A2PR                          WLA2PR
     I              A1JWST                          WLJWST
     I              A1CWST                          WLCWST
     I              A1D7ST                          WLD7ST
     I              A1D8ST                          WLD8ST
     I              A1DWST                          WLDWST
     I              A1D6ST                          WLD6ST
     I              A1GHNB                          WLGHNB
     I              A1BYDT                          WLBYDT
     I              A1E0ST                          WLE0ST
     I              A1E1ST                          WLE1ST
     I              A1E2ST                          WLE2ST
     I              A1BSDT                          WLBSDT
     I              A1BTDT                          WLBTDT
     I              A1BUDT                          WLBUDT
     I              A1HGNB                          WLHGNB
     I              A1HHNB                          WLHHNB
     I              A1HINB                          WLHINB
     I              A1A3PR                          WLA3PR
     I              A1A4PR                          WLA4PR
     I              A1A6PR                          WLA6PR
     I              A1J9NB                          WLJ9NB
     I              A1D6PR                          WLD6PR
     I              A1D7PR                          WLD7PR
     I              A1D8PR                          WLD8PR
     I              A1D9PR                          WLD9PR
     I              A1EAPR                          WLEAPR
     I              A1EBPR                          WLEBPR
     I              A1ECPR                          WLECPR
     I              A1EDPR                          WLEDPR
     I              A1EEPR                          WLEEPR
     I              A1EFPR                          WLEFPR
     I              A1EGPR                          WLEGPR
     I              A1EHPR                          WLEHPR
     I              A1KAST                          WLKAST
     I              A1J7ST                          WLJ7ST
     I              A1J9ST                          WLJ9ST
     I              A1OXNB                          WLOXNB
     I              A1LKST                          WLLKST
     I              A1LLST                          WLLLST
     I              A1J8ST                          WLJ8ST
     I              A1LIST                          WLLIST
     I              A1LJST                          WLLJST
     I              A1NZTX                          WLNZTX
     I              A1HJCD                          WLHJCD
     I              A1R4ST                          WLR4ST
     I              A1R5ST                          WLR5ST
     I              A1R6ST                          WLR6ST
     I              A1R7ST                          WLR7ST
     I              A1THWT                          WLTHWT
     I              A1T2WT                          WLT2WT
     I              A1THHD                          WLTHHD
     I              A1T2HD                          WLT2HD
     I              A1OBPR                          WLOBPR
     I              A1KOER                          WLKOER
     I              A1OPIR                          WLOPIR
     I              A1OPEM                          WLOPEM
     I              A1IORP                          WLIORP
     I              A1OWEO                          WLOWEO
     I              A1OQET                          WLOQET
     I              A1URST                          WLURST
     I              A1USST                          WLUSST
     I              A1HHPC                          WLHHPC
     I              A1S9PR                          WLS9PR
     I              A1TAPR                          WLTAPR
     I              A1TBPR                          WLTBPR
     I              A1JFUR                          WLJFUR
     I              A1KRIF                          WLKRIF
     I              A1KORF                          WLKORF
     I              A1KAPR                          WLKAPR
     I              A1KROT                          WLKROT
     I              A1OTJG                          WLOTJG
     I              A1IRJG                          WLIRJG
     I              A1IMJF                          WLIMJF
     I              A1IRGF                          WLIRGF
     I              A1KRJF                          WLKRJF
     I              A1OJRF                          WLOJRF
     I              A1KFOR                          WLKFOR
     I              A1ORJK                          WLORJK
     I              A1OMVJ                          WLOMVJ
     I              A1MVNF                          WLMVNF
     I              A1MCNF                          WLMCNF
     I              A1NCNF                          WLNCNF
     I              A1NCHF                          WLNCHF
     I              A1IGIR                          WLIGIR
     I              A1KFJR                          WLKFJR
     I              A1EADT                          WLEADT
     I              A1EBDT                          WLEBDT
     I              A1ECDT                          WLECDT
     I              A1EDDT                          WLEDDT
     I              A1EEDT                          WLEEDT
     I              A1U4ST                          WLU4ST
     I              A1U5ST                          WLU5ST
     I              A1U6ST                          WLU6ST
     I              A1U7ST                          WLU7ST
     I              A1U8ST                          WLU8ST
     I              A1U9ST                          WLU9ST
     I              A1VAST                          WLVAST
     I              A1VBST                          WLVBST
     I              A1BDCD                          WLBDCD
     I              A1CSCD                          WLCSCD
     I              A1ABCD                          WLABCD
     I              A1AECD                          WLAECD
     I              A1ACCD                          WLACCD
     I              A1AGCD                          WLAGCD
     I              A1BECD                          WLBECD
     I              A1AAVN                          WLAAVN
     I              A1AADT                          WLAADT
     I              A1AMTM                          WLAMTM
     I              A1AJST                          WLAJST
     I              A1AHVN                          WLAHVN
     I              A1AGVN                          WLAGVN
     I              A1ABVN                          WLABVN
     I              A1ABDT                          WLABDT
     I              A1ABTM                          WLABTM
      *
     I@ACREAI
      * Producer                  Retrieval index
      * Renamed input format fields
     I              ACABCD                          WMABCD
     I              ACAGTX                          WMAGTX
     I              ACALNB                          WMALNB
     I              ACAATH                          WMAATH
     I              ACAMNB                          WMAMNB
     I              ACIWST                          WMIWST
     I              ACAPST                          WMAPST
     I              ACGCNB                          WMGCNB
     I              ACGJNB                          WMGJNB
     I              ACC2TX                          WMC2TX
     I              ACAACD                          WMAACD
     I              ACACCD                          WMACCD
     I              ACADCD                          WMADCD
     I              ACAAVN                          WMAAVN
     I              ACAADT                          WMAADT
     I              ACAMTM                          WMAMTM
     I              ACAJST                          WMAJST
     I              ACAHVN                          WMAHVN
     I              ACAGVN                          WMAGVN
     I              ACABVN                          WMABVN
     I              ACABDT                          WMABDT
     I              ACABTM                          WMABTM
      *
     I@AAREAC
      * Source                    Retrieval index
      * Renamed input format fields
     I              AAAACD                          WOAACD
     I              AAAFTX                          WOAFTX
     I              AAIXST                          WOIXST
     I              AACYSS                          WOCYSS
     I              AACZSS                          WOCZSS
     I              AAC0SS                          WOC0SS
     I              AAC1SS                          WOC1SS
     I              AAAAVN                          WOAAVN
     I              AAAADT                          WOAADT
     I              AAAMTM                          WOAMTM
     I              AAAJST                          WOAJST
     I              AAAHVN                          WOAHVN
     I              AAAGVN                          WOAGVN
     I              AAABVN                          WOABVN
     I              AAABDT                          WOABDT
     I              AAABTM                          WOABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IQPKB11    E DSPKB1CPL0
      * UPD : Carcass Detail            Update index
      * Renamed input format fields
     I              B1HMNB                          WJHMNB
     I              B1BNNB                          WJBNNB
     I              B1BONB                          WJBONB
     I              B1CVNB                          WJCVNB
     I              B1B0DT                          WJB0DT
     I              B1LGNB                          WJLGNB
     I              B1EUNB                          WJEUNB
     I              B1LHNB                          WJLHNB
     I              B1INST                          WJINST
     I              B1BEPR                          WJBEPR
     I              B1ASPC                          WJASPC
     I              B1EWNB                          WJEWNB
     I              B1B4PR                          WJB4PR
     I              B1EYNB                          WJEYNB
     I              B1B1PR                          WJB1PR
     I              B1AVPR                          WJAVPR
     I              B1AUPC                          WJAUPC
     I              B1AWPR                          WJAWPR
     I              B1AXPR                          WJAXPR
     I              B1EZNB                          WJEZNB
     I              B1AYPR                          WJAYPR
     I              B1BBDT                          WJBBDT
     I              B1AKTM                          WJAKTM
     I              B1IQST                          WJIQST
     I              B1EFST                          WJEFST
     I              B1H6NB                          WJH6NB
     I              B1BEPC                          WJBEPC
     I              B1GCST                          WJGCST
     I              B1GDST                          WJGDST
     I              B1GEST                          WJGEST
     I              B1BHPC                          WJBHPC
     I              B1IOST                          WJIOST
     I              B1IPST                          WJIPST
     I              B1LTNB                          WJLTNB
     I              B1JNST                          WJJNST
     I              B1X4NB                          WJX4NB
     I              B1FNPC                          WJFNPC
     I              B1FOPC                          WJFOPC
     I              B1FPPC                          WJFPPC
     I              B1K2ST                          WJK2ST
     I              B1K3ST                          WJK3ST
     I              B1JWPR                          WJJWPR
     I              B1F5PC                          WJF5PC
     I              B1JXPR                          WJJXPR
     I              B1JYPR                          WJJYPR
     I              B1JZPR                          WJJZPR
     I              B1J0PR                          WJJ0PR
     I              B1J1PR                          WJJ1PR
     I              B1J2PR                          WJJ2PR
     I              B1J3PR                          WJJ3PR
     I              B1J4PR                          WJJ4PR
     I              B1UTST                          WJUTST
     I              B1HVCD                          WJHVCD
     I              B1DKJR                          WJDKJR
     I              B1ITJF                          WJITJF
     I              B1IJGR                          WJIJGR
     I              B1ORJE                          WJORJE
     I              B1OTJR                          WJOTJR
     I              B1PEIR                          WJPEIR
     I              B1IEUF                          WJIEUF
     I              B1ORUE                          WJORUE
     I              B1IUTR                          WJIUTR
     I              B1IJRR                          WJIJRR
     I              B1VCST                          WJVCST
     I              B1VDST                          WJVDST
     I              B1VEST                          WJVEST
     I              B1VFST                          WJVFST
     I              B1VGST                          WJVGST
     I              B1ABCD                          WJABCD
     I              B1AACD                          WJAACD
     I              B1AAVN                          WJAAVN
     I              B1AADT                          WJAADT
     I              B1AMTM                          WJAMTM
     I              B1AJST                          WJAJST
     I              B1AHVN                          WJAHVN
     I              B1AGVN                          WJAGVN
     I              B1ABVN                          WJABVN
     I              B1ABDT                          WJABDT
     I              B1ABTM                          WJABTM
      *
     IYARDCS      DS                            267
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPKB12    E DSPKB1CPLD
      * UPD : Carcass Detail            Update index Purge
      * Renamed input format fields
     I              B1HMNB                          WKHMNB
     I              B1BNNB                          WKBNNB
     I              B1BONB                          WKBONB
     I              B1CVNB                          WKCVNB
     I              B1B0DT                          WKB0DT
     I              B1LGNB                          WKLGNB
     I              B1EUNB                          WKEUNB
     I              B1LHNB                          WKLHNB
     I              B1INST                          WKINST
     I              B1BEPR                          WKBEPR
     I              B1ASPC                          WKASPC
     I              B1EWNB                          WKEWNB
     I              B1B4PR                          WKB4PR
     I              B1EYNB                          WKEYNB
     I              B1B1PR                          WKB1PR
     I              B1AVPR                          WKAVPR
     I              B1AUPC                          WKAUPC
     I              B1AWPR                          WKAWPR
     I              B1AXPR                          WKAXPR
     I              B1EZNB                          WKEZNB
     I              B1AYPR                          WKAYPR
     I              B1BBDT                          WKBBDT
     I              B1AKTM                          WKAKTM
     I              B1IQST                          WKIQST
     I              B1EFST                          WKEFST
     I              B1H6NB                          WKH6NB
     I              B1BEPC                          WKBEPC
     I              B1GCST                          WKGCST
     I              B1GDST                          WKGDST
     I              B1GEST                          WKGEST
     I              B1BHPC                          WKBHPC
     I              B1IOST                          WKIOST
     I              B1IPST                          WKIPST
     I              B1LTNB                          WKLTNB
     I              B1JNST                          WKJNST
     I              B1X4NB                          WKX4NB
     I              B1FNPC                          WKFNPC
     I              B1FOPC                          WKFOPC
     I              B1FPPC                          WKFPPC
     I              B1K2ST                          WKK2ST
     I              B1K3ST                          WKK3ST
     I              B1JWPR                          WKJWPR
     I              B1F5PC                          WKF5PC
     I              B1JXPR                          WKJXPR
     I              B1JYPR                          WKJYPR
     I              B1JZPR                          WKJZPR
     I              B1J0PR                          WKJ0PR
     I              B1J1PR                          WKJ1PR
     I              B1J2PR                          WKJ2PR
     I              B1J3PR                          WKJ3PR
     I              B1J4PR                          WKJ4PR
     I              B1UTST                          WKUTST
     I              B1HVCD                          WKHVCD
     I              B1DKJR                          WKDKJR
     I              B1ITJF                          WKITJF
     I              B1IJGR                          WKIJGR
     I              B1ORJE                          WKORJE
     I              B1OTJR                          WKOTJR
     I              B1PEIR                          WKPEIR
     I              B1IEUF                          WKIEUF
     I              B1ORUE                          WKORUE
     I              B1IUTR                          WKIUTR
     I              B1IJRR                          WKIJRR
     I              B1VCST                          WKVCST
     I              B1VDST                          WKVDST
     I              B1VEST                          WKVEST
     I              B1VFST                          WKVFST
     I              B1VGST                          WKVGST
     I              B1ABCD                          WKABCD
     I              B1AACD                          WKAACD
     I              B1AAVN                          WKAAVN
     I              B1AADT                          WKAADT
     I              B1AMTM                          WKAMTM
     I              B1AJST                          WKAJST
     I              B1AHVN                          WKAHVN
     I              B1AGVN                          WKAGVN
     I              B1ABVN                          WKABVN
     I              B1ABDT                          WKABDT
     I              B1ABTM                          WKABTM
      *
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Conduct screen conversation
     C                     DO   *HIVAL
      * Start new transaction
     C                     MOVEL'Y'       W0TRN   1
      * Process current transaction
     C           W0TRN     DOWEQ'Y'
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   30                CAS            MALDSC
      * Process screen input
     C                     CAS            DAPRSC
     C                     END
      *
     C                     END
      *
     C                     END
      *****************************************************************
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Enable PUTOVR
     C                     SETON                     86
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPRSC    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate screen input
     C                     EXSR DBVLSC
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPMCF
      * Quit if not confirmed
     C           *IN99     CABEQ'1'       DAEXIT
      * USER: User defined action
      * E2521 03/27/13  slm mpr cutout or hog cutout. hard code remove in
      * Clc Crc Mrt Activ Crc RT - Carcass Detail  * 
     C                     EXSR SARVGN
      * Exit program
     C                     EXSR ZXEXPG
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBVLSC    BEGSR
      *================================================================
      * Validate screen input
      *================================================================
      * Validate TH Kill Date
      * External date
     C                     Z-ADDV1B0DT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9935  *
     C                     END
     C                     Z-ADDXDINDT    #1B0DT
      * Bypass ref file checks if error already detected
     C   99                GOTO DBEXIT
      * Check reference to Tattoo Header
     C                     EXSR VACKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     993132*
     C                     SETON                     333435*
     C                     END
      * Check reference to Producer
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Source
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * BOH Company Number required
     C           #1HMNB    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * BOH Buy Order Number required
     C           #1BNNB    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9932  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * BOL Load Number required
     C           #1BONB    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9933  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * TH Tattoo Number required
     C           #1CVNB    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9934  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * TH Kill Date required
     C           #1B0DT    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9935  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DHPMCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Update screen time
     C                     TIME           ##TME
      * Enable PUTOVR
     C                     SETON                         86*
      * Refresh screen
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#RCDDTL1
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'PKVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         MALDSC    BEGSR
      *================================================================
      * Load screen from passed parameters
      *================================================================
     C                     Z-ADD*ZERO     #1LGNB           CD Scale Sequen
     C                     Z-ADD*ZERO     #1EUNB           CD Carcass Numb
     C                     Z-ADD*ZERO     #1LHNB           CD Carcass Numb
     C                     MOVEL*BLANK    #1INST           CD Record Add/D
     C                     Z-ADD*ZERO     #1BEPR           CD Sort Loss
     C                     Z-ADD*ZERO     #1ASPC           CD STD Yield
     C                     Z-ADD*ZERO     #1EWNB           CD Carcass/Hot
     C                     Z-ADD*ZERO     #1B4PR           CD Base Carcass
     C                     Z-ADD*ZERO     #1EYNB           CD Crc Value Pe
     C                     Z-ADD*ZERO     #1B1PR           CD Base Carc Va
     C                     Z-ADD*ZERO     #1AVPR           CD Crc Value $
     C                     Z-ADD*ZERO     #1AUPC           CD Lean Percent
     C                     Z-ADD*ZERO     #1AWPR           CD Lean Premium
     C                     Z-ADD*ZERO     #1AXPR           CD Lean Premium
     C                     Z-ADD*ZERO     #1EZNB           CD Gross Value
     C                     Z-ADD*ZERO     #1AYPR           CD Gross Value
     C                     Z-ADD*ZERO     #1BBDT           CD Kill Date
     C                     Z-ADD*ZERO     #1AKTM           CD Kill Time
     C                     MOVEL*BLANK    #1IQST           CD Shift
     C                     MOVEL*BLANK    #1EFST           CD Carcass Acti
     C                     Z-ADD*ZERO     #1H6NB           CD Backfat Thic
     C                     Z-ADD*ZERO     #1BEPC           CD Loin-Eye Dep
     C                     Z-ADD*ZERO     #1GCST           CD Light Reflec
     C                     MOVEL*BLANK    #1GDST           CD Trim Area
     C                     MOVEL*BLANK    #1GEST           CD Carcass Sex
     C                     Z-ADD*ZERO     #1BHPC           CD FFLI
     C                     MOVEL*BLANK    #1IOST           CD Record Creat
     C                     MOVEL*BLANK    #1IPST           CD Record Creat
     C                     Z-ADD*ZERO     #1LTNB           CD LOT
     C                     MOVEL*BLANK    #1JNST           CD User Error O
     C                     Z-ADD*ZERO     #1X4NB           CD Backfat Thic
     C                     Z-ADD*ZERO     #1FNPC           CD Loin-Eye Dep
     C                     Z-ADD*ZERO     #1FOPC           CD Light Reflec
     C                     Z-ADD*ZERO     #1FPPC           CD Lean Percent
     C                     MOVEL*BLANK    #1K2ST           CD Source Type
     C                     MOVEL*BLANK    #1K3ST           CD Payment Type
     C                     Z-ADD*ZERO     #1JWPR           CD CA Sort Loss
     C                     Z-ADD*ZERO     #1F5PC           CD CA Std Yield
     C                     Z-ADD*ZERO     #1JXPR           CD CA Base Carc
     C                     Z-ADD*ZERO     #1JYPR           CD CA Crc Value
     C                     Z-ADD*ZERO     #1JZPR           CD CA Base Carc
     C                     Z-ADD*ZERO     #1J0PR           CD CA Crc Value
     C                     Z-ADD*ZERO     #1J1PR           CD CA Lean Prem
     C                     Z-ADD*ZERO     #1J2PR           CD CA Lean Prem
     C                     Z-ADD*ZERO     #1J3PR           CD CA Gross Val
     C                     Z-ADD*ZERO     #1J4PR           CD CA Gross Val
     C                     MOVEL*BLANK    #1UTST           CD Adjust/Add T
     C                     MOVEL*BLANK    #1HVCD           CD Producer Loc
     C                     Z-ADD*ZERO     #1DKJR           CD Loin Eye Inc
     C                     Z-ADD*ZERO     #1ITJF           CD Backfat Inch
     C                     Z-ADD*ZERO     #1IJGR           CD Meat Value F
     C                     Z-ADD*ZERO     #1ORJE           CD Lean Prem/Di
     C                     Z-ADD*ZERO     #1OTJR           CD Fixed Cost F
     C                     Z-ADD*ZERO     #1PEIR           CD MPR Sort Los
     C                     Z-ADD*ZERO     #1IEUF           CD Meat Value F
     C                     Z-ADD*ZERO     #1ORUE           CD Fixed Cost F
     C                     Z-ADD*ZERO     #1IUTR           CD Gross Before
     C                     Z-ADD*ZERO     #1IJRR           CD Gross Before
     C                     MOVEL*BLANK    #1VCST           CD Broken Back
     C                     MOVEL*BLANK    #1VDST           CD Adjust/Add S
     C                     MOVEL*BLANK    #1VEST           CD Unused Sts 3
     C                     MOVEL*BLANK    #1VFST           CD Unused Sts 4
     C                     MOVEL*BLANK    #1VGST           CD Unused Sts 5
     C                     MOVEL*BLANK    #1ABCD           PD Producer Cod
     C                     MOVEL*BLANK    #1AACD           SR Source Code
     C                     MOVEL*BLANK    #1AAVN           RS User Changed
     C                     Z-ADD*ZERO     #1AADT           RS Date Changed
     C                     Z-ADD*ZERO     #1AMTM           RS Time Changed
     C                     MOVEL*BLANK    #1AJST           RS Record Statu
     C                     MOVEL*BLANK    #1AHVN           RS Job
     C                     MOVEL*BLANK    #1AGVN           RS Program
     C                     MOVEL*BLANK    #1ABVN           RS User Added
     C                     Z-ADD*ZERO     #1ABDT           RS Date Added
     C                     Z-ADD*ZERO     #1ABTM           RS Time Added
     C                     Z-ADD*ZERO     #1HMNB           BOH Company Num
     C                     Z-ADD*ZERO     #1BNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     #1BONB           BOL Load Number
     C                     Z-ADD*ZERO     #1CVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     #1B0DT           TH Kill Date
      * Clear external version also
     C                     Z-ADD*ZERO     V1B0DT
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert TH Kill Date to display format
      * Convert date
     C           1000000   ADD  #1B0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1B0DT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Clc Crc Mrt Activ Crc RT - Carcass Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  72       CD Sort Loss
     C                     Z-ADD*ZERO     WN0002  52       CD STD Yield
     C                     Z-ADD*ZERO     WN0003  72       CD Base Carcass
     C                     Z-ADD*ZERO     WN0004  52       CD Crc Value Pe
     C                     Z-ADD*ZERO     WN0005  72       CD Base Carc Va
     C                     Z-ADD*ZERO     WN0006  72       CD Crc Value $
     C                     Z-ADD*ZERO     WN0007  31       CD Lean Percent
     C                     Z-ADD*ZERO     WN0008  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0009  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0010  52       CD Gross Value
     C                     Z-ADD*ZERO     WN0011  72       CD Gross Value
     C                     Z-ADD*ZERO     WN0012  31       CD Backfat Thic
     C                     Z-ADD*ZERO     WN0013  72       CD CA Sort Loss
     C                     Z-ADD*ZERO     WN0014  52       CD CA Std Yield
     C                     Z-ADD*ZERO     WN0015  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0016  52       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0017  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0018  72       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0019  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0020  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0021  52       CD CA Gross Val
     C                     Z-ADD*ZERO     WN0022  72       CD CA Gross Val
     C                     Z-ADD*ZERO     WN0023  52       CD Meat Value F
     C                     Z-ADD*ZERO     WN0024  52       CD Lean Prem/Di
     C                     Z-ADD*ZERO     WN0025  52       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0026  72       CD MPR Sort Los
     C                     Z-ADD*ZERO     WN0027  72       CD Meat Value F
     C                     Z-ADD*ZERO     WN0028  72       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0029  72       CD Gross Before
     C                     Z-ADD*ZERO     WN0030  72       CD Gross Before
     C                     MOVEL*BLANK    WN0031  1        CMP Grading Typ
     C                     MOVEL*BLANK    WN0032  1        CMP Sort Basis
     C                     MOVEL*BLANK    WN0033  1        CMP Sts
     C                     MOVEL*BLANK    WN0034  2        CMP Carc Wgt Ty
     C                     Z-ADD*ZERO     WN0035  31       CMP Std Lean Pe
     C                     Z-ADD*ZERO     WN0036  31       CMP Lean Factor
     C                     MOVEL*BLANK    WN0037  1        CMP Optimal Row
     C                     MOVEL*BLANK    WN0038  1        CMP Type
     C                     Z-ADD*ZERO     WN0039  52       CMP % of Carcas
     C                     Z-ADD*ZERO     WN0040  52       CMP Fixed Cost
     C                     Z-ADD*ZERO     WN0041  52       CMP Grade Type
     C                     Z-ADD*ZERO     WN0042  30       CMMR Row Number
     C                     Z-ADD*ZERO     WN0043  52       CMMR Std Dressi
     C                     Z-ADD*ZERO     WN0044  52       CMMR Sort Disco
     C                     Z-ADD*ZERO     WN0045  52       CMMR Unused Fie
     C                     Z-ADD*ZERO     WN0046  52       CMMR Midpoint
     C                     Z-ADD*ZERO     WN0047  31       CMMC Lean Perce
     C                     Z-ADD*ZERO     WN0048  53       CMMC Premium Va
     C                     Z-ADD*ZERO     WN0049  52       PurchPrc + Sort
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 10/11/17 Calc MPR Sort Loss -- change on otherwise stmt
      * 5/23/03  Calc MPR Sort Loss in Carcass Analysis Detail section
      * Initialize Total Fields
     C                     EXSR UASUBR                     Initialize Tota
      * 10/23/2007 CMP Grade Type Adj to store the adj for backfat
      * Rtv CMP Payment Info3 RT - Carcass Merit Program  * 
     C                     EXSR SBRVGN
      * comments
     C                     EXSR UBSUBR                     comments
     C                     Z-ADDYL0001    YL0038           CMP Effect Purc
      * Rtv Carcass Merit Prog RT - Carcass Merit Prog MktGrp  * 
     C                     EXSR SCRVGN
      * CASE: PAR.CMP Grading Type is Meat Value
     C           WN0031    IFEQ 'M'                        *IF
      * RTV Market Price      XF - STR Order Management Sys  * 
     C                     CALL 'PDMWXFR'              90  RTV Market Pric
     C                     PARM WURTN     WQ0001  7        *Return code
     C                     PARM YL0039    WQ0002  3        PSC Commodity M
     C                     PARM YL0040    WQ0003  7        PSC Commodity P
     C                     PARM YL0001    WQ0004  70       TH Purchase Dat
     C                     PARM *ZERO     WQ0005  70       Date To   USR
     C           YL0041    PARM *ZERO     WQ0006 114       OMS Market Pric
     C           YL0042    PARM *ZERO     WQ0007  70       Pricing Date US
     C                     PARM #1HMNB    WQ0008  30       BOH Company Num
     C                     PARM 'CUR'     WQ0009  3        BOH Market Date
     C                     PARM 'H'       WQ0010  1        System Used
     C           WUIPTX    PARM *BLANK    WQ0011  5        OMS Error Retur
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMWXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
     C                     END
      * FIXED COST
      * if LCL.OMS Market Price Amt Usr is zero, then send a message
      * to some distribution list Market Price not available for Fixed Co
      * Calculation.
      * Market Prc Hog/Cutout USR
      * LCL.Market Prc Hog/Cutout USR =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : LCL.OMS Market Price Amt Usr
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.CMP % of Carcass Cutout
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WN0039    DIV  100       W0WB01    H      *Synon (15,5) w
     C           YL0041    MULT W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0043           Market Prc Hog/
     C                     END                             *FI
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHMNB    WQSA01           BOH Company Num
     C           *LIKE     DEFN WABNNB    WQSA02           BOH Buy Order N
     C           *LIKE     DEFN WABONB    WQSA03           BOL Load Number
     C           *LIKE     DEFN WACVNB    WQSA04           TH Tattoo Numbe
     C           *LIKE     DEFN WAB0DT    WQSA05           TH Kill Date
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           BOH Company Num
     C                     KFLD           WQSA02           BOH Buy Order N
     C                     KFLD           WQSA03           BOL Load Number
     C                     KFLD           WQSA04           TH Tattoo Numbe
     C                     KFLD           WQSA05           TH Kill Date
      * Setup key
     C                     Z-ADD#1HMNB    WQSA01           BOH Company Num
     C                     Z-ADD#1BNNB    WQSA02           BOH Buy Order N
     C                     Z-ADD#1BONB    WQSA03           BOL Load Number
     C                     Z-ADD#1CVNB    WQSA04           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    WQSA05           TH Kill Date
      * Establish starting position
     C           KRSSA     SETLL@B1CPEF                    *
     C           KRSSA     READE@B1CPEF                  90*
      * Data record not found
     C   90                MOVEL'PRK0138' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: Excluded Records
      *  - (c1 AND c2 AND c3) OR (c4 AND c5 AND c6)
      *   |- c1    : PAR.Competitors Processing is Yes
      *   |- c2    : PAR.CM Processing Type Usr is Payment
      *   |- c3    : DB1.CD Record Add/Del Sts is Delete
      *   |- c4    : PAR.Competitors Processing is No
      *   |- c5    : PAR.CM Processing Type Usr is Analysis
      *   |- c6    : DB1.CD Record Add/Del Sts is Delete
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0017    IFEQ 'Y'                        *IF
     C           YL0016    IFEQ 'P'                        *IF
     C           WAINST    IFEQ 'D'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           YL0017    IFEQ 'N'                        *IF
     C           YL0016    IFEQ 'A'                        *IF
     C           WAINST    IFEQ 'D'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.CD Adjust/Add Type is Not Add w/Average Value
      *   |- c2    : PAR.Competitors Processing is Yes
      *   '-
     C           WAUTST    IFEQ 'HST'                      *IF
     C           WAUTST    OREQ 'AVG'
     C           WAUTST    OREQ '2WK'
     C           WAUTST    OREQ '4WK'
     C           WAUTST    OREQ 'LN%'
     C           WAUTST    OREQ *BLANK
     C           WAUTST    OREQ 'LOT'
     C           YL0017    OREQ 'Y'                        *OR
      * move db1 ca fields to par ca fields
     C                     EXSR UCSUBR                     move db1 ca fie
      * move db1 CD fields to par CD fields
     C                     EXSR UDSUBR                     move db1 CD fie
      * Use competitors Averages or regular carcass analysis
      * CASE: PAR.Average Pay Sts Usr is Yes
     C           YL0035    IFEQ 'Y'                        *IF
      * Move Averages to Cd fields before extension or totals are accum
     C                     EXSR UESUBR                     Move Averages t
     C                     ELSE
      * CASE: *OTHERWISE
      * Carcass Analysis Detail
     C                     EXSR UFSUBR                     Carcass Analysi
     C                     END                             *FI
      * Totals
     C                     EXSR UMSUBR                     Totals
      * Move cd fields to ca fields, and or zero out cd fields
      * CASE: PAR.Competitors Processing is Yes
     C           YL0017    IFEQ 'Y'                        *IF
      * zero out cd ca fields
     C                     EXSR UNSUBR                     zero out cd ca
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.CD Payment Type is Live
     C           #1K3ST    IFEQ 'L'                        *IF
      * move cd fields to cd ca fields
     C                     EXSR UOSUBR                     move cd fields
      * zero out cd fields
     C                     EXSR UPSUBR                     zero out cd fie
     C                     ELSE
      * CASE: PAR.CD Payment Type is Carcass Merit
     C           #1K3ST    IFEQ 'C'                        *IF
      * CASE: PAR.CD Source Type is External
     C           #1K2ST    IFEQ 'E'                        *IF
      * zero out cd ca fields
     C                     EXSR UQSUBR                     zero out cd ca
      * Leave payment information in the CD fields
     C                     ELSE
      * CASE: PAR.CD Source Type is Internal
     C           #1K2ST    IFEQ 'I'                        *IF
      * CASE: PAR.CM Processing Type Usr is Analysis
     C           YL0016    IFEQ 'A'                        *IF
      * move cd fields to cd ca fields
     C                     EXSR URSUBR                     move cd fields
      * zero out cd fields
     C                     EXSR USSUBR                     zero out cd fie
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Update Production Library
      * CASE: PAR.Competitors Processing is No
     C           YL0017    IFEQ 'N'                        *IF
      * Chg Carcass Detail 2  CH - Carcass Detail  * 
     C                     EXSR SOCHRC
     C                     END                             *FI
      * Create a record in QTEMP
      * CASE: PAR.Print Comp Sum/Dtl STS is Yes
     C           YL0036    IFEQ 'Y'                        *IF
      * Crt Carcass Dtl QTEMP CR - Carcass Detail  * 
     C                     EXSR SPCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSA     READE@B1CPEF                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv CMP Payment Info3 RT - Carcass Merit Program  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAMCD           CMP Program Cod
      * Setup key
     C                     MOVELYL0005    WBAMCD           CMP Program Cod
      * Establish starting position
     C           KRSSB     CHAIN@ARREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0039' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUC6TX           CMP Description
     C                     MOVEL*BLANK    WN0031           CMP Grading Typ
     C                     MOVEL*BLANK    WN0032           CMP Sort Basis
     C                     MOVEL*BLANK    WN0034           CMP Carc Wgt Ty
     C                     Z-ADD*ZERO     WN0035           CMP Std Lean Pe
     C                     Z-ADD*ZERO     WN0036           CMP Lean Factor
     C                     MOVEL*BLANK    WN0037           CMP Optimal Row
     C                     MOVEL*BLANK    WN0038           CMP Type
     C                     Z-ADD*ZERO     WUI1PR           CMP Market Add/
     C                     Z-ADD*ZERO     WN0039           CMP % of Carcas
     C                     Z-ADD*ZERO     WN0040           CMP Fixed Cost
     C                     Z-ADD*ZERO     WN0041           CMP Grade Type
     C                     MOVEL*BLANK    WUZ2ST           CMP CLC Premium
     C                     MOVEL*BLANK    WUAJST           RS Record Statu
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBA3TX    WUC6TX           CMP Description
     C                     MOVELWBDLST    WN0031           CMP Grading Typ
     C                     MOVELWBDMST    WN0032           CMP Sort Basis
     C                     MOVELWBDQST    WN0034           CMP Carc Wgt Ty
     C                     Z-ADDWBAZPC    WN0035           CMP Std Lean Pe
     C                     Z-ADDWBA0PC    WN0036           CMP Lean Factor
     C                     MOVELWBDTST    WN0037           CMP Optimal Row
     C                     MOVELWBF5ST    WN0038           CMP Type
     C                     Z-ADDWBI1PR    WUI1PR           CMP Market Add/
     C                     Z-ADDWBVEPR    WN0039           CMP % of Carcas
     C                     Z-ADDWBVFPR    WN0040           CMP Fixed Cost
     C                     Z-ADDWBVHPR    WN0041           CMP Grade Type
     C                     MOVELWBZ2ST    WUZ2ST           CMP CLC Premium
     C                     MOVELWBAJST    WUAJST           RS Record Statu
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Carcass Merit Prog RT - Carcass Merit Prog MktGrp  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAMCD    WQSC01           CMP Program Cod
      * Define keylist
     C           KPSSC     KLIST
     C                     KFLD           WQSC01           CMP Program Cod
     C                     KFLD           WCGYDT           CMP Effect Purc
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           CMP Program Cod
      * Setup key
     C                     MOVELYL0005    WQSC01           CMP Program Cod
     C                     Z-ADDYL0038    WCGYDT           CMP Effect Purc
      * Establish starting position
     C           KPSSC     SETLL@BPCPSK                    *
     C           KRSSC     READE@BPCPSK                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1291' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0038           CMP Effect Purc
     C                     MOVEL*BLANK    YL0039           CMP Commodity M
     C                     MOVEL*BLANK    YL0040           CMP Commodity G
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.CMP Effect Kill Date GE DB1.CMP Effect Kill Date
     C           YL0038    IFGE WCGYDT                     *IF
      * PAR = DB1 By name
     C                     Z-ADDWCGYDT    YL0038           CMP Effect Purc
     C                     MOVELWCPXCD    YL0039           CMP Commodity M
     C                     MOVELWCPYCD    YL0040           CMP Commodity G
     C                     GOTO SCEXIT                     *QUIT
     C                     ELSE
      * CASE: PAR.CMP Effect Kill Date LT DB1.CMP Effect Kill Date
     C           YL0038    IFLT WCGYDT                     *IF
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSC     READE@BPCPSK                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv StdYl/SrtDsc/MdPt RT - Carcass Merit Matrix Row  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAMCD    WQSD01           CMP Program Cod
      * Define keylist
     C           KPSSD     KLIST
     C                     KFLD           WQSD01           CMP Program Cod
     C                     KFLD           WDEGNB           CMMR Carc Wgt M
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           CMP Program Cod
      * Setup key
     C                     MOVELYL0005    WQSD01           CMP Program Cod
     C                     Z-ADDWAEWNB    WDEGNB           CMMR Carc Wgt M
      * Establish starting position
     C           KPSSD     SETLL@BYREJ9                    *
     C           KRSSD     READE@BYREJ9                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0132' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0042           CMMR Row Number
     C                     Z-ADD*ZERO     WN0043           CMMR Std Dressi
     C                     Z-ADD*ZERO     WN0046           CMMR Midpoint
     C                     Z-ADD*ZERO     WN0001           CD Sort Loss
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWDE8NB    WN0042           CMMR Row Number
     C                     Z-ADDWDAQPC    WN0043           CMMR Std Dressi
     C                     Z-ADDWDLJA1    WN0046           CMMR Midpoint
     C                     Z-ADDWDEMNB    WN0001           CD Sort Loss
     C                     GOTO SDEXIT                     *QUIT
     C           KRSSD     READE@BYREJ9                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Lean Premium %    RT - Carcass Merit Matrix Col  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAMCD    WQSE01           CMP Program Cod
     C           *LIKE     DEFN WEE8NB    WQSE02           CMMR Row Number
      * Define keylist
     C           KPSSE     KLIST
     C                     KFLD           WQSE01           CMP Program Cod
     C                     KFLD           WQSE02           CMMR Row Number
     C                     KFLD           WEA1PC           CMMC Lean Perce
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           CMP Program Cod
     C                     KFLD           WQSE02           CMMR Row Number
      * Setup key
     C                     MOVELYL0005    WQSE01           CMP Program Cod
     C                     Z-ADDWN0042    WQSE02           CMMR Row Number
     C                     Z-ADDWAAUPC    WEA1PC           CMMC Lean Perce
      * Establish starting position
     C           KPSSE     SETLL@BZREKA                    *
     C           KRSSE     READE@BZREKA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0134' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0048           CMMC Premium Va
     C                     MOVEL*BLANK    WUF6ST           Record Found CM
     C                     MOVEL'N'       WUF6ST           Record Found CM
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUF6ST           Record Found CM
      * PAR = DB1 By name
     C                     Z-ADDWEERNB    WN0048           CMMC Premium Va
     C                     GOTO SEEXIT                     *QUIT
     C           KRSSE     READE@BZREKA                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Lean Premium % Frc RT - Carcass Merit Matrix Col  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAMCD    WQSF01           CMP Program Cod
     C           *LIKE     DEFN WFE8NB    WQSF02           CMMR Row Number
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           CMP Program Cod
     C                     KFLD           WQSF02           CMMR Row Number
      * Setup key
     C                     MOVELYL0005    WQSF01           CMP Program Cod
     C                     Z-ADDWN0042    WQSF02           CMMR Row Number
      * Establish starting position
     C           KRSSF     SETLL@BZREPO                    *
     C           KRSSF     READE@BZREPO                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0134' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WUF6ST           Record Found CM
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUF6ST           Record Found CM
      * PAR = DB1 By name
     C                     Z-ADDWFERNB    WN0048           CMMC Premium Va
     C                     GOTO SFEXIT                     *QUIT
     C           KRSSF     READE@BZREPO                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Optimal Midpoint  RT - Carcass Merit Matrix Row  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WGAMCD           CMP Program Cod
     C                     KFLD           WGE8NB           CMMR Row Number
      * Setup key
     C                     MOVELYL0005    WGAMCD           CMP Program Cod
     C                     Z-ADDYL0045    WGE8NB           CMMR Row Number
      * Establish starting position
     C           KRSSG     CHAIN@BYREGF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0132' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0046           CMMR Midpoint
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWGLJA1    YL0046           CMMR Midpoint
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Lean Premium %    RT - Carcass Merit Matrix Col  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAMCD    WQSH01           CMP Program Cod
     C           *LIKE     DEFN WEE8NB    WQSH02           CMMR Row Number
      * Define keylist
     C           KPSSH     KLIST
     C                     KFLD           WQSH01           CMP Program Cod
     C                     KFLD           WQSH02           CMMR Row Number
     C                     KFLD           WEA1PC           CMMC Lean Perce
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           CMP Program Cod
     C                     KFLD           WQSH02           CMMR Row Number
      * Setup key
     C                     MOVELYL0005    WQSH01           CMP Program Cod
     C                     Z-ADDWN0042    WQSH02           CMMR Row Number
     C                     Z-ADDWN0047    WEA1PC           CMMC Lean Perce
      * Establish starting position
     C           KPSSH     SETLL@BZREKA                    *
     C           KRSSH     READE@BZREKA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0134' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0048           CMMC Premium Va
     C                     MOVEL*BLANK    WUF6ST           Record Found CM
     C                     MOVEL'N'       WUF6ST           Record Found CM
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUF6ST           Record Found CM
      * PAR = DB1 By name
     C                     Z-ADDWEERNB    WN0048           CMMC Premium Va
     C                     GOTO SHEXIT                     *QUIT
     C           KRSSH     READE@BZREKA                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Lean Premium % Frc RT - Carcass Merit Matrix Col  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAMCD    WQSI01           CMP Program Cod
     C           *LIKE     DEFN WFE8NB    WQSI02           CMMR Row Number
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           CMP Program Cod
     C                     KFLD           WQSI02           CMMR Row Number
      * Setup key
     C                     MOVELYL0005    WQSI01           CMP Program Cod
     C                     Z-ADDWN0042    WQSI02           CMMR Row Number
      * Establish starting position
     C           KRSSI     SETLL@BZREPO                    *
     C           KRSSI     READE@BZREPO                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0134' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WUF6ST           Record Found CM
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUF6ST           Record Found CM
      * PAR = DB1 By name
     C                     Z-ADDWFERNB    WN0048           CMMC Premium Va
     C                     GOTO SIEXIT                     *QUIT
     C           KRSSI     READE@BZREPO                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv BckF Premium       RT - Carcass Merit Matrix Col  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHAMCD    WQSJ01           CMP Program Cod
     C           *LIKE     DEFN WHE8NB    WQSJ02           CMMR Row Number
      * Define keylist
     C           KPSSJ     KLIST
     C                     KFLD           WQSJ01           CMP Program Cod
     C                     KFLD           WQSJ02           CMMR Row Number
     C                     KFLD           WHE7NB           CMMC Backfat In
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           CMP Program Cod
     C                     KFLD           WQSJ02           CMMR Row Number
      * Setup key
     C                     MOVELYL0005    WQSJ01           CMP Program Cod
     C                     Z-ADDWN0042    WQSJ02           CMMR Row Number
     C                     Z-ADDWUVENB    WHE7NB           CMMC Backfat In
      * Establish starting position
     C           KPSSJ     SETLL@BZRETM                    *
     C           KRSSJ     READE@BZRETM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0134' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0048           CMMC Premium Va
     C                     MOVEL*BLANK    WUF6ST           Record Found CM
     C                     MOVEL'N'       WUF6ST           Record Found CM
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUF6ST           Record Found CM
      * PAR = DB1 By name
     C                     Z-ADDWHERNB    WN0048           CMMC Premium Va
     C                     GOTO SJEXIT                     *QUIT
     C           KRSSJ     READE@BZRETM                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv BckF Premium % Frc RT - Carcass Merit Matrix Col  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIAMCD    WQSK01           CMP Program Cod
     C           *LIKE     DEFN WIE8NB    WQSK02           CMMR Row Number
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           CMP Program Cod
     C                     KFLD           WQSK02           CMMR Row Number
      * Setup key
     C                     MOVELYL0005    WQSK01           CMP Program Cod
     C                     Z-ADDWN0042    WQSK02           CMMR Row Number
      * Establish starting position
     C           KRSSK     SETLL@BZRETL                    *
     C           KRSSK     READE@BZRETL                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0134' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WUF6ST           Record Found CM
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUF6ST           Record Found CM
      * PAR = DB1 By name
     C                     Z-ADDWIERNB    WN0048           CMMC Premium Va
     C                     GOTO SKEXIT                     *QUIT
     C           KRSSK     READE@BZRETL                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Lean Premium %    RT - Carcass Merit Matrix Col  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAMCD    WQSL01           CMP Program Cod
     C           *LIKE     DEFN WEE8NB    WQSL02           CMMR Row Number
      * Define keylist
     C           KPSSL     KLIST
     C                     KFLD           WQSL01           CMP Program Cod
     C                     KFLD           WQSL02           CMMR Row Number
     C                     KFLD           WEA1PC           CMMC Lean Perce
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           CMP Program Cod
     C                     KFLD           WQSL02           CMMR Row Number
      * Setup key
     C                     MOVELYL0005    WQSL01           CMP Program Cod
     C                     Z-ADDYL0045    WQSL02           CMMR Row Number
     C                     Z-ADDWAAUPC    WEA1PC           CMMC Lean Perce
      * Establish starting position
     C           KPSSL     SETLL@BZREKA                    *
     C           KRSSL     READE@BZREKA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0134' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0048           CMMC Premium Va
     C                     MOVEL*BLANK    WUF6ST           Record Found CM
     C                     MOVEL'N'       WUF6ST           Record Found CM
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUF6ST           Record Found CM
      * PAR = DB1 By name
     C                     Z-ADDWEERNB    YL0048           CMMC Premium Va
     C                     GOTO SLEXIT                     *QUIT
     C           KRSSL     READE@BZREKA                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv StdYld/SortDisc   RT - Carcass Merit Matrix Row  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAMCD    WQSM01           CMP Program Cod
      * Define keylist
     C           KPSSM     KLIST
     C                     KFLD           WQSM01           CMP Program Cod
     C                     KFLD           WDEGNB           CMMR Carc Wgt M
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           CMP Program Cod
      * Setup key
     C                     MOVELYL0005    WQSM01           CMP Program Cod
     C                     Z-ADDWAEWNB    WDEGNB           CMMR Carc Wgt M
      * Establish starting position
     C           KPSSM     SETLL@BYREJ9                    *
     C           KRSSM     READE@BYREJ9                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0132' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0045           CMMR Row Number
     C                     Z-ADD*ZERO     YL0049           CMMR Std Dressi
     C                     Z-ADD*ZERO     YL0050           CD Sort Loss
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWDE8NB    YL0045           CMMR Row Number
     C                     Z-ADDWDAQPC    YL0049           CMMR Std Dressi
     C                     Z-ADDWDEMNB    YL0050           CD Sort Loss
     C                     GOTO SMEXIT                     *QUIT
     C           KRSSM     READE@BYREJ9                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Lean Premium %    RT - Carcass Merit Matrix Col  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAMCD    WQSN01           CMP Program Cod
     C           *LIKE     DEFN WEE8NB    WQSN02           CMMR Row Number
      * Define keylist
     C           KPSSN     KLIST
     C                     KFLD           WQSN01           CMP Program Cod
     C                     KFLD           WQSN02           CMMR Row Number
     C                     KFLD           WEA1PC           CMMC Lean Perce
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           CMP Program Cod
     C                     KFLD           WQSN02           CMMR Row Number
      * Setup key
     C                     MOVELYL0005    WQSN01           CMP Program Cod
     C                     Z-ADDYL0045    WQSN02           CMMR Row Number
     C                     Z-ADDWAAUPC    WEA1PC           CMMC Lean Perce
      * Establish starting position
     C           KPSSN     SETLL@BZREKA                    *
     C           KRSSN     READE@BZREKA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0134' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0051           CMMC Premium Va
     C                     MOVEL*BLANK    WUF6ST           Record Found CM
     C                     MOVEL'N'       WUF6ST           Record Found CM
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUF6ST           Record Found CM
      * PAR = DB1 By name
     C                     Z-ADDWEERNB    YL0051           CMMC Premium Va
     C                     GOTO SNEXIT                     *QUIT
     C           KRSSN     READE@BZREKA                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCHRC    BEGSR
      *================================================================
      * Chg Carcass Detail 2  CH - Carcass Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0050  51       CD Carcass/Hot
     C                     Z-ADD*ZERO     WN0051  31       CD Lean Percent
     C                     Z-ADD*ZERO     WN0052  60       CD Kill Time
     C                     MOVEL*BLANK    WN0053  1        CD Carcass Acti
     C                     Z-ADD*ZERO     WN0054  31       CD Backfat Thic
     C                     Z-ADD*ZERO     WN0055  31       CD Loin-Eye Dep
     C                     Z-ADD*ZERO     WN0056  31       CD Light Reflec
     C                     MOVEL*BLANK    WN0057  1        CD Trim Area
     C                     MOVEL*BLANK    WN0058  1        CD Carcass Sex
     C                     Z-ADD*ZERO     WN0059  31       CD Backfat Thic
     C                     Z-ADD*ZERO     WN0060  31       CD Loin-Eye Dep
     C                     Z-ADD*ZERO     WN0061  31       CD Light Reflec
     C                     Z-ADD*ZERO     WN0062  31       CD Lean Percent
     C                     MOVEL*BLANK    WN0063  3        CD Adjust/Add T
     C                     MOVEL*BLANK    WN0064  6        CD Producer Loc
     C                     Z-ADD*ZERO     WN0065  52       CD Loin Eye Inc
     C                     Z-ADD*ZERO     WN0066  52       CD Backfat Inch
     C                     MOVEL*BLANK    WN0067  1        CD Broken Back
     C                     MOVEL*BLANK    WN0068  2        CD Adjust/Add S
     C                     MOVEL*BLANK    WN0069  3        CD Unused Sts 3
     C                     MOVEL*BLANK    WN0070  3        CD Unused Sts 4
     C                     MOVEL*BLANK    WN0071  6        CD Unused Sts 5
     C                     MOVEL*BLANK    WN0072 10        RS User Changed
     C                     Z-ADD*ZERO     WN0073  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0074  60       RS Time Changed
     C                     MOVEL*BLANK    WN0075  1        RS Record Statu
     C                     MOVEL*BLANK    WN0076 10        RS Job
     C                     MOVEL*BLANK    WN0077 10        RS Program
     C                     MOVEL*BLANK    WN0078 10        RS User Added
     C                     Z-ADD*ZERO     WN0079  70       RS Date Added
     C                     Z-ADD*ZERO     WN0080  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @B1CPG6
     C                     Z-ADDWAHMNB    WJHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WJBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WJBONB           BOL Load Number
     C                     Z-ADDWACVNB    WJCVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WJB0DT           TH Kill Date
     C                     Z-ADDWALGNB    WJLGNB           CD Scale Sequen
     C                     Z-ADDWAEUNB    WJEUNB           CD Carcass Numb
     C                     Z-ADDWALHNB    WJLHNB           CD Carcass Numb
      *
     C           KLCHSO    KLIST
     C                     KFLD           WJHMNB           BOH Company Num
     C                     KFLD           WJBNNB           BOH Buy Order N
     C                     KFLD           WJBONB           BOL Load Number
     C                     KFLD           WJCVNB           TH Tattoo Numbe
     C                     KFLD           WJB0DT           TH Kill Date
     C                     KFLD           WJLGNB           CD Scale Sequen
     C                     KFLD           WJEUNB           CD Carcass Numb
     C                     KFLD           WJLHNB           CD Carcass Numb
     C           KLCHSO    CHAIN@B1CPG6              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKB1CPL0'MDACP
     C                     MOVEL'@B1CPG6' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKB11    YARDCS
      * Move non-key fields to @B1CPG6
     C                     MOVELWAINST    WJINST    P      CD Record Add/D
     C                     Z-ADDWN0001    WJBEPR           CD Sort Loss
     C                     Z-ADDWN0002    WJASPC           CD STD Yield
     C                     Z-ADDWN0003    WJB4PR           CD Base Carcass
     C                     Z-ADDWN0004    WJEYNB           CD Crc Value Pe
     C                     Z-ADDWN0005    WJB1PR           CD Base Carc Va
     C                     Z-ADDWN0006    WJAVPR           CD Crc Value $
     C                     Z-ADDWN0008    WJAWPR           CD Lean Premium
     C                     Z-ADDWN0009    WJAXPR           CD Lean Premium
     C                     Z-ADDWN0010    WJEZNB           CD Gross Value
     C                     Z-ADDWN0011    WJAYPR           CD Gross Value
     C                     Z-ADDWABBDT    WJBBDT           CD Kill Date
     C                     MOVELWAIQST    WJIQST    P      CD Shift
     C                     Z-ADDWABHPC    WJBHPC           CD FFLI
     C                     MOVELWAIOST    WJIOST    P      CD Record Creat
     C                     MOVELWAIPST    WJIPST    P      CD Record Creat
     C                     Z-ADDWALTNB    WJLTNB           CD LOT
     C                     MOVELWAJNST    WJJNST    P      CD User Error O
     C                     MOVEL#1K2ST    WJK2ST    P      CD Source Type
     C                     MOVEL#1K3ST    WJK3ST    P      CD Payment Type
     C                     Z-ADDWN0013    WJJWPR           CD CA Sort Loss
     C                     Z-ADDWN0014    WJF5PC           CD CA Std Yield
     C                     Z-ADDWN0015    WJJXPR           CD CA Base Carc
     C                     Z-ADDWN0016    WJJYPR           CD CA Crc Value
     C                     Z-ADDWN0017    WJJZPR           CD CA Base Carc
     C                     Z-ADDWN0018    WJJ0PR           CD CA Crc Value
     C                     Z-ADDWN0019    WJJ1PR           CD CA Lean Prem
     C                     Z-ADDWN0020    WJJ2PR           CD CA Lean Prem
     C                     Z-ADDWN0021    WJJ3PR           CD CA Gross Val
     C                     Z-ADDWN0022    WJJ4PR           CD CA Gross Val
     C                     Z-ADDWN0023    WJIJGR           CD Meat Value F
     C                     Z-ADDWN0024    WJORJE           CD Lean Prem/Di
     C                     Z-ADDWN0025    WJOTJR           CD Fixed Cost F
     C                     Z-ADDWN0026    WJPEIR           CD MPR Sort Los
     C                     Z-ADDWN0027    WJIEUF           CD Meat Value F
     C                     Z-ADDWN0028    WJORUE           CD Fixed Cost F
     C                     Z-ADDWN0029    WJIUTR           CD Gross Before
     C                     Z-ADDWN0030    WJIJRR           CD Gross Before
     C                     MOVELWAABCD    WJABCD    P      PD Producer Cod
     C                     MOVELWAAACD    WJAACD    P      SR Source Code
      *
      * Set PGM.*Record Data Changed flag
     C           QPKB11    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WJAAVN           RS User Changed
     C                     Z-ADD##JDT     WJAADT           RS Date Changed
     C                     Z-ADD##JTM     WJAMTM           RS Time Changed
     C                     MOVEL##JOB     WJAHVN           RS Job
     C                     MOVEL##PGM     WJAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKB11    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@B1CPG6                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKB1CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPCRRC    BEGSR
      *================================================================
      * Crt Carcass Dtl QTEMP CR - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1CPVI
     C                     Z-ADDWAHMNB    WKHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WKBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WKBONB           BOL Load Number
     C                     Z-ADDWACVNB    WKCVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WKB0DT           TH Kill Date
     C                     Z-ADDWALGNB    WKLGNB           CD Scale Sequen
     C                     Z-ADDWAEUNB    WKEUNB           CD Carcass Numb
     C                     Z-ADDWALHNB    WKLHNB           CD Carcass Numb
     C                     MOVELWAINST    WKINST           CD Record Add/D
     C                     Z-ADDWN0001    WKBEPR           CD Sort Loss
     C                     Z-ADDWN0002    WKASPC           CD STD Yield
     C                     Z-ADDWAEWNB    WKEWNB           CD Carcass/Hot
     C                     Z-ADDWN0003    WKB4PR           CD Base Carcass
     C                     Z-ADDWN0004    WKEYNB           CD Crc Value Pe
     C                     Z-ADDWN0005    WKB1PR           CD Base Carc Va
     C                     Z-ADDWN0006    WKAVPR           CD Crc Value $
     C                     Z-ADDWAAUPC    WKAUPC           CD Lean Percent
     C                     Z-ADDWN0008    WKAWPR           CD Lean Premium
     C                     Z-ADDWN0009    WKAXPR           CD Lean Premium
     C                     Z-ADDWN0010    WKEZNB           CD Gross Value
     C                     Z-ADDWN0011    WKAYPR           CD Gross Value
     C                     Z-ADDWABBDT    WKBBDT           CD Kill Date
     C                     Z-ADDWAAKTM    WKAKTM           CD Kill Time
     C                     MOVELWAIQST    WKIQST           CD Shift
     C                     MOVELWAEFST    WKEFST           CD Carcass Acti
     C                     Z-ADDWAH6NB    WKH6NB           CD Backfat Thic
     C                     Z-ADDWABEPC    WKBEPC           CD Loin-Eye Dep
     C                     Z-ADDWAGCST    WKGCST           CD Light Reflec
     C                     MOVELWAGDST    WKGDST           CD Trim Area
     C                     MOVELWAGEST    WKGEST           CD Carcass Sex
     C                     Z-ADDWABHPC    WKBHPC           CD FFLI
     C                     MOVELWAIOST    WKIOST           CD Record Creat
     C                     MOVELWAIPST    WKIPST           CD Record Creat
     C                     Z-ADDWALTNB    WKLTNB           CD LOT
     C                     MOVELWAJNST    WKJNST           CD User Error O
     C                     Z-ADDWAX4NB    WKX4NB           CD Backfat Thic
     C                     Z-ADDWAFNPC    WKFNPC           CD Loin-Eye Dep
     C                     Z-ADDWAFOPC    WKFOPC           CD Light Reflec
     C                     Z-ADDWAFPPC    WKFPPC           CD Lean Percent
     C                     MOVEL#1K2ST    WKK2ST           CD Source Type
     C                     MOVELWAK3ST    WKK3ST           CD Payment Type
     C                     Z-ADDWN0013    WKJWPR           CD CA Sort Loss
     C                     Z-ADDWN0014    WKF5PC           CD CA Std Yield
     C                     Z-ADDWN0015    WKJXPR           CD CA Base Carc
     C                     Z-ADDWN0016    WKJYPR           CD CA Crc Value
     C                     Z-ADDWN0017    WKJZPR           CD CA Base Carc
     C                     Z-ADDWN0018    WKJ0PR           CD CA Crc Value
     C                     Z-ADDWN0019    WKJ1PR           CD CA Lean Prem
     C                     Z-ADDWN0020    WKJ2PR           CD CA Lean Prem
     C                     Z-ADDWN0021    WKJ3PR           CD CA Gross Val
     C                     Z-ADDWN0022    WKJ4PR           CD CA Gross Val
     C                     MOVELWAUTST    WKUTST           CD Adjust/Add T
     C                     MOVELWAHVCD    WKHVCD           CD Producer Loc
     C                     Z-ADDWADKJR    WKDKJR           CD Loin Eye Inc
     C                     Z-ADDWAITJF    WKITJF           CD Backfat Inch
     C                     Z-ADDWAIJGR    WKIJGR           CD Meat Value F
     C                     Z-ADDWAORJE    WKORJE           CD Lean Prem/Di
     C                     Z-ADDWAOTJR    WKOTJR           CD Fixed Cost F
     C                     Z-ADDWAPEIR    WKPEIR           CD MPR Sort Los
     C                     Z-ADDWAIEUF    WKIEUF           CD Meat Value F
     C                     Z-ADDWAORUE    WKORUE           CD Fixed Cost F
     C                     Z-ADDWAIUTR    WKIUTR           CD Gross Before
     C                     Z-ADDWAIJRR    WKIJRR           CD Gross Before
     C                     MOVELWAVCST    WKVCST           CD Broken Back
     C                     MOVELWAVDST    WKVDST           CD Adjust/Add S
     C                     MOVELWAVEST    WKVEST           CD Unused Sts 3
     C                     MOVELWAVFST    WKVFST           CD Unused Sts 4
     C                     MOVELWAVGST    WKVGST           CD Unused Sts 5
     C                     MOVELWAABCD    WKABCD           PD Producer Cod
     C                     MOVELWAAACD    WKAACD           SR Source Code
     C                     MOVELWAAAVN    WKAAVN           RS User Changed
     C                     Z-ADDWAAADT    WKAADT           RS Date Changed
     C                     Z-ADDWAAMTM    WKAMTM           RS Time Changed
     C                     MOVELWAAJST    WKAJST           RS Record Statu
     C                     MOVELWAAHVN    WKAHVN           RS Job
     C                     MOVELWAAGVN    WKAGVN           RS Program
     C                     MOVELWAABVN    WKABVN           RS User Added
     C                     Z-ADDWAABDT    WKABDT           RS Date Added
     C                     Z-ADDWAABTM    WKABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WKAJST           RS Record Statu
     C                     MOVEL##USR     WKABVN           RS User Added
     C                     Z-ADD##JDT     WKABDT           RS Date Added
     C                     Z-ADD##JTM     WKABTM           RS Time Added
     C                     MOVEL##PGM     WKAGVN           RS Program
     C                     MOVEL##JOB     WKAHVN           RS Job
     C           KLCRSP    KLIST
     C                     KFLD           WKHMNB           BOH Company Num
     C                     KFLD           WKBNNB           BOH Buy Order N
     C                     KFLD           WKBONB           BOL Load Number
     C                     KFLD           WKCVNB           TH Tattoo Numbe
     C                     KFLD           WKB0DT           TH Kill Date
     C                     KFLD           WKLGNB           CD Scale Sequen
     C                     KFLD           WKEUNB           CD Carcass Numb
     C                     KFLD           WKLHNB           CD Carcass Numb
      * Check for duplicate primary key
     C           KLCRSP    SETLL@B1CPVI                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0139' W0RTN   7
      * Send message 'Carcass Detail         EX'
     C                     MOVEL'PRK0139' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C                     WRITE@B1CPVI                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Initialize Total Fields
      *================================================================
     C                     Z-ADD*ZERO     YL0007           Head Total USR
     C                     Z-ADD*ZERO     YL0008           Sort Loss Tot U
     C                     Z-ADD*ZERO     YL0009           Std Yield % Tot
     C                     Z-ADD*ZERO     YL0010           Weight Tot USR
     C                     Z-ADD*ZERO     YL0015           Base Carc Val T
     C                     Z-ADD*ZERO     YL0011           Adj Base Carc V
     C                     Z-ADD*ZERO     YL0012           Lean Percent To
     C                     Z-ADD*ZERO     YL0013           Lean Add/Ded Va
     C                     Z-ADD*ZERO     YL0014           Total Carc Val
     C                     Z-ADD*ZERO     YL0037           TH MPR Sort Los
     C                     Z-ADD*ZERO     YL0022           Gross Before So
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * comments
      *================================================================
      * 12/15/06 PKD If Grading Type is Meat Value, then retrieve the
      *              USDA Pork Cutout Price for the Meav Value Factor.
      * 11/12/13 slm chnges per TF
      *              pull the mrk and the group from the Cmp mkt/grp
      *              need this for Triumph Foods  - Meat Value
      *              created nw file to hold this data
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * move db1 ca fields to par ca fields
      *================================================================
     C                     Z-ADDWAJWPR    WN0013           CD CA Sort Loss
     C                     Z-ADDWAF5PC    WN0014           CD CA Std Yield
     C                     Z-ADDWAJXPR    WN0015           CD CA Base Carc
     C                     Z-ADDWAJYPR    WN0016           CD CA Crc Value
     C                     Z-ADDWAJZPR    WN0017           CD CA Base Carc
     C                     Z-ADDWAJ0PR    WN0018           CD CA Crc Value
     C                     Z-ADDWAJ1PR    WN0019           CD CA Lean Prem
     C                     Z-ADDWAJ2PR    WN0020           CD CA Lean Prem
     C                     Z-ADDWAJ3PR    WN0021           CD CA Gross Val
     C                     Z-ADDWAJ4PR    WN0022           CD CA Gross Val
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * move db1 CD fields to par CD fields
      *================================================================
     C                     Z-ADDWABEPR    WN0001           CD Sort Loss
     C                     Z-ADDWN0043    WN0002           CD STD Yield
     C                     Z-ADDWAB4PR    WN0003           CD Base Carcass
     C                     Z-ADDWAEYNB    WN0004           CD Crc Value Pe
     C                     Z-ADDWAB1PR    WN0005           CD Base Carc Va
     C                     Z-ADDWAAVPR    WN0006           CD Crc Value $
     C                     Z-ADDWAAWPR    WN0008           CD Lean Premium
     C                     Z-ADDWAAXPR    WN0009           CD Lean Premium
     C                     Z-ADDWAEZNB    WN0010           CD Gross Value
     C                     Z-ADDWAAYPR    WN0011           CD Gross Value
     C                     Z-ADDWAIUTR    WN0029           CD Gross Before
     C                     Z-ADDWAIJRR    WN0030           CD Gross Before
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Move Averages to Cd fields before extension or totals are accum
      *================================================================
     C                     Z-ADDWUKWPR    WN0001           CD Sort Loss
     C                     Z-ADDWUF9PC    WN0002           CD STD Yield
     C                     Z-ADDWUKRPR    WN0003           CD Base Carcass
     C                     Z-ADDWUKUPR    WN0004           CD Crc Value Pe
     C                     Z-ADDWUKSPR    WN0008           CD Lean Premium
     C                     Z-ADDWUKXPR    WN0010           CD Gross Value
      * RE EXTENDED
      * CD Base Carc Value
      * PAR.CD Base Carc Value =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Base Carcass CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WAEWNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0003    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0005           CD Base Carc Va
      * CD Crc Value $ Per Hd
      * PAR.CD Crc Value $ Per Hd =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Crc Value Per CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WAEWNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0004    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0006           CD Crc Value $
      * CD LEAN PREM $ Per Hd
      * PAR.CD Lean Premium $ Per Hd =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Lean Premium CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WAEWNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0008    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0009           CD Lean Premium
     C           WN0006    ADD  WN0009    WN0011           CD Gross Value
     C           WN0004    ADD  WN0008    WN0010           CD Gross Value
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Carcass Analysis Detail
      *================================================================
      * Rtv StdYl/SrtDsc/MdPt RT - Carcass Merit Matrix Row  * 
     C                     EXSR SDRVGN
      * Commented out 12/16/98 PKD.
      * CD Base Carcass CWT  12/16/98 PKD
      * CASE: PAR.Pricing UOM USR is Live Hundred Weight
     C           YL0004    IFEQ 'LW'                       *IF
      * CASE: PAR.CMMR Std Dressing Yield% is ne 0
     C           WN0043    IFNE 0                          *IF
      * CD Base Carcass CWT
      * PAR.CD Base Carcass CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Base Mkt Price
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.CMMR Std Dressing Yield%
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WN0043    DIV  100       W0WD01    H      *Synon (17,7) w
     C           YL0002    DIV  W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0003           CD Base Carcass
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0003           CD Base Carcass
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Pricing UOM USR is Carcass Hundred Weight
     C           YL0004    IFEQ 'CW'                       *IF
     C                     Z-ADDYL0002    WN0003           CD Base Carcass
     C                     END                             *FI
     C                     END                             *FI
      * CD Base Carc Value
      * PAR.CD Base Carc Value =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Base Carcass CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WAEWNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0003    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0005           CD Base Carc Va
      * Commented out 12/16/98 PKD.
      * CASE: WRK.CMP CLC Premium First is Sort First
     C           WUZ2ST    IFEQ *BLANK                     *IF
      * CAS: Calc CD Crc Value Per CWT w/ Quote Type.   08/03/95 PKP
      * CASE: PAR.CMP Sort Basis is Live
     C           WN0032    IFEQ 'L'                        *IF
      * CASE: PAR.Pricing UOM USR is Live Hundred Weight
     C           YL0004    IFEQ 'LW'                       *IF
      * CD Crc Value Per CWT
      * PAR.CD Crc Value Per CWT =
      *    *COMPUTE ((x1 + x2) / (x3 / x4))
      * x1    : PAR.TH CM Base Mkt Price
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Sort Loss
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.CMMR Std Dressing Yield%
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x4    : CON.100
     C           YL0002    ADD  WN0001    W0WA01           *Synon (15,2) w
     C           WN0043    DIV  100       W0WD02    H      *Synon (17,7) w
     C           W0WA01    DIV  W0WD02    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0004           CD Crc Value Pe
     C                     ELSE
      * CASE: PAR.Pricing UOM USR is Carcass Hundred Weight
     C           YL0004    IFEQ 'CW'                       *IF
      * CD Crc Value Per CWT
      * PAR.CD Crc Value Per CWT =
      *    *COMPUTE (x1 + (x2 / (x3 / x4)))
      * x1    : PAR.CD Base Carcass CWT
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Sort Loss
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : PAR.CMMR Std Dressing Yield%
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x4    : CON.100
     C           WN0043    DIV  100       W0WD02    H      *Synon (17,7) w
     C           WN0001    DIV  W0WD02    W0WB01    H      *Synon (15,5) w
     C           WN0003    ADD  W0WB01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0004           CD Crc Value Pe
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.CMP Sort Basis is Meat
     C           WN0032    IFEQ 'M'                        *IF
      * CASE: PAR.Pricing UOM USR is Live Hundred Weight
     C           YL0004    IFEQ 'LW'                       *IF
      * CD Crc Value Per CWT NEW
      * PAR.CD Crc Value Per CWT =
      *    *COMPUTE ((x1 + (x2 * (x3 / x4))) / (x5 / x6))
      * x1    : PAR.TH CM Base Mkt Price
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Sort Loss
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.CMMR Std Dressing Yield%
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x4    : CON.100
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x5    : PAR.CMMR Std Dressing Yield%
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x6    : CON.100
     C           WN0043    DIV  100       W0WB03    H      *Synon (15,5) w
     C           WN0001    MULT W0WB03    W0WA02    H      *Synon (15,2) w
     C           YL0002    ADD  W0WA02    W0WA01           *Synon (15,2) w
     C           WN0043    DIV  100       W0WB04    H      *Synon (15,5) w
     C           W0WA01    DIV  W0WB04    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0004           CD Crc Value Pe
     C                     ELSE
      * CASE: PAR.Pricing UOM USR is Carcass Hundred Weight
     C           YL0004    IFEQ 'CW'                       *IF
      * CD Crc Value Per CWT
      * PAR.CD Crc Value Per CWT =
      *    *COMPUTE (x1 + x2)
      * x1    : PAR.CD Base Carcass CWT
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Sort Loss
     C           WN0003    ADD  WN0001    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0004           CD Crc Value Pe
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.CMP Sort Basis is % of Base Price
     C           WN0032    IFEQ 'P'                        *IF
      * 06/20/05 PKD HPE011 Add calculation for Sort Loss based on
      *              percent of base.
      * CD Crc Value Per CWT
      * LCL.*Synon (15,5) work field =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Base Carcass CWT
      * *     : PGM.*Synon (15,5) work field *Rounded
      * x2    : PAR.CD Sort Loss
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WN0001    DIV  100       W0WB01    H      *Synon (15,5) w
     C           WN0003    MULT W0WB01    W0WB00    H      *Synon (15,5) w
     C                     Z-ADDW0WB00    YL0044           *Synon (15,5) w
     C           YL0044    MULT 1         WN0004    H      CD Crc Value Pe
     C                     ELSE
      * CASE: PAR.CMP Sort Basis is None
     C           WN0032    IFEQ *BLANK                     *IF
     C                     Z-ADDWN0003    WN0004           CD Crc Value Pe
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * A = TH CM Base Market Price or CD Base Carcass CWT
     C                     Z-ADDWN0003    WN0004           CD Crc Value Pe
     C                     END                             *FI
      * CD Crc Value $ Per Hd
      * PAR.CD Crc Value $ Per Hd =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Crc Value Per CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WAEWNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0004    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0006           CD Crc Value $
      * 10/23/2007 CMP Grade Type Adj will be used on the Back Fat
      * Grade/Premium
      * CASE: PAR.CMP Grading Type is Ln%N/SrtDscF/FltCrc/MtVal
     C           WN0031    IFEQ 'C'                        *IF
     C           WN0031    OREQ 'D'
     C           WN0031    OREQ 'L'
     C           WN0031    OREQ 'S'
     C           WN0031    OREQ 'M'
      * 06/20/05 PKD HPE011 Added Meat Value to Conditoin
      * LEAN PERCENT NPPC or SORT DISCOUNT FACTOR or FLAT CARCASS WEIGHT
     C                     EXSR UGSUBR                     LEAN PERCENT NP
     C                     ELSE
      * CASE: PAR.CMP Grading Type is Lean Percent FOM
     C           WN0031    IFEQ 'P'                        *IF
      * LEAN PERCENT  FAT O METER
     C                     EXSR UJSUBR                     LEAN PERCENT  F
     C                     ELSE
      * CASE: PAR.CMP Grading Type is Backfat
     C           WN0031    IFEQ 'B'                        *IF
      * Backfat
     C                     EXSR UKSUBR                     Backfat
     C                     ELSE
      * CASE: PAR.CMP Grading Type is Lean Factor
     C           WN0031    IFEQ 'F'                        *IF
      * Lean Factor
     C                     EXSR ULSUBR                     Lean Factor
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Sort after premium.  re-calc gross
      * CASE: WRK.CMP CLC Premium First is Premium First
     C           WUZ2ST    IFEQ 'P'                        *IF
     C                     Z-ADDWN0010    WN0029           CD Gross Before
     C                     Z-ADDWN0011    WN0030           CD Gross Before
      * CASE: PAR.CD Sort Loss is 100%
     C           WN0001    IFEQ 100                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * New Gross after Sort
      * Gross After Sort
      * LCL.*Synon (15,5) work field =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Gross Before Sort CWT
      * *     : PGM.*Synon (15,5) work field *Rounded
      * x2    : PAR.CD Sort Loss
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WN0001    DIV  100       W0WB01    H      *Synon (15,5) w
     C           WN0029    MULT W0WB01    W0WB00    H      *Synon (15,5) w
     C                     Z-ADDW0WB00    YL0044           *Synon (15,5) w
     C           YL0044    MULT 1         WN0010    H      CD Gross Value
      * Total Gross Carcass Value
      * PAR.CD Gross Value $ Per HD =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Gross Value Per CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WAEWNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0010    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0011           CD Gross Value
     C                     END                             *FI
      * New Carcas Value
      * CD Crc Value Per CWT
      * PAR.CD Crc Value Per CWT =
      *    *COMPUTE (x1 + (x2 - x3))
      * x1    : PAR.CD Base Carcass CWT
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Gross Value Per CWT
      * -     : PGM.*Synon (15,2) work field
      * x3    : PAR.CD Gross Before Sort CWT
     C           WN0010    SUB  WN0029    W0WA01           *Synon (15,2) w
     C           WN0003    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0004           CD Crc Value Pe
      * CD Crc Value $ Per Hd
      * PAR.CD Crc Value $ Per Hd =
      *    *COMPUTE (x1 + (x2 - x3))
      * x1    : PAR.CD Base Carc Value
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Gross Value $ Per HD
      * -     : PGM.*Synon (15,2) work field
      * x3    : PAR.CD Gross Before Sort /HD
     C           WN0011    SUB  WN0030    W0WA01           *Synon (15,2) w
     C           WN0005    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0006           CD Crc Value $
     C                     END                             *FI
     C                     Z-ADDWN0043    WN0002           CD STD Yield
      * Calc MPR Sort Loss            5/23/03    -- Change 10/11/17 S1186
      * Calc MPR Sort Loss   5/23/03   - chg 01/15/07 for "M" cmp grading
      * CASE: PAR.CMP Optimal Row Nbr f/srt NE WRK.Blank Usr 1 fld Usr
     C           WN0037    IFNE WUIXTX                     *IF
     C                     MOVE WN0037    YL0047           Num NU USR
     C                     Z-ADDYL0047    YL0045           CMMR Row Number
      * Rtv Lean Premium %    RT - Carcass Merit Matrix Col  * 
     C                     EXSR SLRVGN
      * Rtv StdYld/SortDisc   RT - Carcass Merit Matrix Row  * 
     C                     EXSR SMRVGN
      * Rtv Lean Premium %    RT - Carcass Merit Matrix Col  * 
     C                     EXSR SNRVGN
     C           YL0051    SUB  YL0048    YL0052           Sort Total %
      * CASE: PAR.CMP Grading Type is Lean Percent NPPC $Prem
     C           WN0031    IFEQ 'D'                        *IF
      * If grading type is D , the lean premium values are dollars $
      * Comp: CD Mpr Sort Loss-D
      * PAR.CD MPR Sort Loss =
      *    *COMPUTE ((x1 - x2) *(x3/x4))
      * x1    : LCL.CMMC Premium Value
      * -     : PGM.*Synon (17,7) work field
      * x2    : LCL.Optimal Lean Percent USR
      * *     : PGM.*Synon (17,7) work field *
      * x3    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *
      * x4    : CON.100
     C           YL0051    SUB  YL0048    W0WD01           *Synon (17,7) w
     C           WAEWNB    DIV  100       W0WD02           *Synon (17,7) w
     C           W0WD01    MULT W0WD02    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0026           CD MPR Sort Los
     C                     ELSE
      * CASE: PAR.CMP Grading Type is Meat Value
     C           WN0031    IFEQ 'M'                        *IF
      * If grading type is M , take diff cac value $hd - base value   01/
     C           WN0006    SUB  WN0005    WN0026           CD MPR Sort Los
     C                     ELSE
      * CASE: *OTHERWISE
      * Original Calc done for all grading types         06/28/04
      * Comp: CD Mpr Sort Loss
      * PAR.CD MPR Sort Loss =
      *    *COMPUTE ((x1 * x4)* (x2/x3))
      * x1    : LCL.Sort Total %
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.CD Base Carcass CWT
      * *     : PGM.*Synon (17,7) work field *
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           YL0052    MULT WN0003    W0WD01           *Synon (17,7) w
     C           WAEWNB    DIV  100       W0WD02           *Synon (17,7) w
     C           W0WD01    MULT W0WD02    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0026           CD MPR Sort Los
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  WN0026    YL0037           TH MPR Sort Los
      * (note--sort loss s/be negative.)
     C                     ELSE
      * CASE: *OTHERWISE
      * Comp: CD Mpr Sort Loss
      * PAR.CD MPR Sort Loss =
      *    *COMPUTE ((x1 - x2))
      * x1    : PAR.CD Crc Value $ Per Hd
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Base Carc Value
     C           WN0006    SUB  WN0005    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0026           CD MPR Sort Los
     C                     ADD  WN0026    YL0037           TH MPR Sort Los
     C                     END                             *FI
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * LEAN PERCENT NPPC or SORT DISCOUNT FACTOR or FLAT CARCASS WEIGHT
      *================================================================
      * 031606 slm added the meat value for TF Changes on Prd Avgs
      * CASE: Added Crc @ Historical Avg Hot wgt & avg Ln%
      *  - c1 AND c2 AND c3 AND c4
      *   |- c1    : DB1.CD Adjust/Add Type is Producer Historical Avg
      *   |- c2    : PAR.Competitors Processing is No
      *   |- c3    : PAR.CM Processing Type Usr is Payment
      *   |- c4    : PAR.CMP Grading Type is Not Meat Value
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAUTST    IFEQ 'HST'                      *IF
     C           WAUTST    OREQ '2WK'
     C           WAUTST    OREQ '4WK'
     C           WAUTST    OREQ 'LOT'
     C           YL0017    IFEQ 'N'                        *IF
     C           YL0016    IFEQ 'P'                        *IF
     C           WN0031    IFEQ 'B'                        *IF
     C           WN0031    OREQ 'C'
     C           WN0031    OREQ 'G'
     C           WN0031    OREQ 'F'
     C           WN0031    OREQ 'P'
     C           WN0031    OREQ 'D'
     C           WN0031    OREQ 'L'
     C           WN0031    OREQ 'S'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ** PAID WITH HISTORY **
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.CMP Grading Type is Lean Percent NPPC
      *   |- c2    : PAR.CMP Grading Type is Meat Value
      *   '-
     C           WN0031    IFEQ 'D'                        *IF
     C           WN0031    OREQ 'L'
     C           WN0031    OREQ 'M'                        *OR
      * 06/20/05 PKD HPE011 Added Meat Value to the condition.
     C                     Z-ADDYL0018    WN0008           CD Lean Premium
      * Lean Premium Value
      * PAR.CD Lean Premium $ Per Hd =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Lean Premium CWT
      * *     : PGM.*Synon (15,2) work field *
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (15,5) work field *
      * x3    : CON.100
     C           WAEWNB    DIV  100       W0WB01           *Synon (15,5) w
     C           WN0008    MULT W0WB01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0009           CD Lean Premium
     C           WN0004    ADD  WN0008    WN0010           CD Gross Value
     C           WN0006    ADD  WN0009    WN0011           CD Gross Value
     C                     ELSE
      * CASE: PAR.CMP Grading Type is Flat Carcass Weight
     C           WN0031    IFEQ 'C'                        *IF
     C                     Z-ADD*ZERO     WN0008           CD Lean Premium
     C                     Z-ADD*ZERO     WN0009           CD Lean Premium
     C           WN0004    ADD  WN0008    WN0010           CD Gross Value
      * Total Carcass Value
      * PAR.CD Gross Value $ Per HD =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Gross Value Per CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WAEWNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0010    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0011           CD Gross Value
     C                     ELSE
      * CASE: PAR.CMP Grading Type is Sort Discount Factor
     C           WN0031    IFEQ 'S'                        *IF
      * **** Pay by Factory.  ****
     C           YL0019    DIV  100       WN0048    H      CMMC Premium Va
      * Total Carcss Per CWT MULT
      * PAR.CD Gross Value Per CWT =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.CD Crc Value Per CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.CMMC Premium Value
     C           WN0004    MULT WN0048    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0010           CD Gross Value
      * Total Carcass Value
      * PAR.CD Gross Value $ Per HD =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Gross Value Per CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WAEWNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0010    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0011           CD Gross Value
      * Lean Premium Per CWT
      * PAR.CD Lean Premium CWT =
      *    *COMPUTE (x1 - x2)
      * x1    : PAR.CD Gross Value Per CWT
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Crc Value Per CWT
     C           WN0010    SUB  WN0004    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0008           CD Lean Premium
      * Lean Premium Value
      * PAR.CD Lean Premium $ Per Hd =
      *    *COMPUTE (x1 - x2)
      * x1    : PAR.CD Gross Value $ Per HD
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Crc Value $ Per Hd
     C           WN0011    SUB  WN0006    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0009           CD Lean Premium
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: Paid with Average Value of Lot
      *  - c1 AND c2 AND c3
      *   |- c1    : DB1.CD Adjust/Add Type is Add w/Average Value
      *   |- c2    : PAR.Competitors Processing is No
      *   |- c3    : PAR.CM Processing Type Usr is Payment
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAUTST    IFEQ 'ADD'                      *IF
     C           YL0017    IFEQ 'N'                        *IF
     C           YL0016    IFEQ 'P'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ** ADDED AT AVERAGE VALUE OF THE LOT **
     C                     Z-ADD*ZERO     WN0008           CD Lean Premium
     C                     Z-ADD*ZERO     WN0009           CD Lean Premium
     C                     Z-ADD*ZERO     WN0010           CD Gross Value
     C                     Z-ADD*ZERO     WN0011           CD Gross Value
     C                     ELSE
      * CASE: *OTHERWISE
      * ** CALCULATE LEAN PREMIUM **
      * Rtv Lean Premium %    RT - Carcass Merit Matrix Col  * 
     C                     EXSR SERVGN
      * Rtv Lean% Premium if not found in table, then use lowest
      * CASE: WRK.Record Found CMMC USR is No
     C           WUF6ST    IFEQ 'N'                        *IF
      * Rtv Lean Premium % Frc RT - Carcass Merit Matrix Col  * 
     C                     EXSR SFRVGN
     C                     END                             *FI
      * Lean Percent NPPC $Prem OR Meat Value *OTHERWISE
      * CASE: PAR.CMP Grading Type is Lean Percent NPPC $Prem
     C           WN0031    IFEQ 'D'                        *IF
     C                     Z-ADDWN0048    WN0008           CD Lean Premium
      * CD Lean Premium $ Per Hd
      * PAR.CD Lean Premium $ Per Hd =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Lean Premium CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WAEWNB    DIV  100       W0WB01    H      *Synon (15,5) w
     C           WN0008    MULT W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0009           CD Lean Premium
      * Total Carcass Value
      * PAR.CD Gross Value $ Per HD =
      *    *COMPUTE (x1 + x2)
      * x1    : PAR.CD Crc Value $ Per Hd
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Lean Premium $ Per Hd
     C           WN0006    ADD  WN0009    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0011           CD Gross Value
      * Total Carcass Per CWT
      * PAR.CD Gross Value Per CWT =
      *    *COMPUTE (x1 + x2)
      * x1    : PAR.CD Crc Value Per CWT
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.CD Lean Premium CWT
     C           WN0004    ADD  WN0008    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0010           CD Gross Value
     C                     ELSE
      * CASE: PAR.CMP Grading Type is Meat Value
     C           WN0031    IFEQ 'M'                        *IF
      * Meat Value Calculation
     C                     EXSR UHSUBR                     Meat Value Calc
     C                     ELSE
      * CASE: *OTHERWISE
      * Total Carcss Per CWT MULT
      * PAR.CD Gross Value Per CWT =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.CD Crc Value Per CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.CMMC Premium Value
     C           WN0004    MULT WN0048    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0010           CD Gross Value
      * Total Carcass Value
      * PAR.CD Gross Value $ Per HD =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Gross Value Per CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WAEWNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0010    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0011           CD Gross Value
      * Lean Premium Per CWT
      * PAR.CD Lean Premium CWT =
      *    *COMPUTE (x1 - x2)
      * x1    : PAR.CD Gross Value Per CWT
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Crc Value Per CWT
     C           WN0010    SUB  WN0004    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0008           CD Lean Premium
      * Lean Premium Value
      * PAR.CD Lean Premium $ Per Hd =
      *    *COMPUTE (x1 - x2)
      * x1    : PAR.CD Gross Value $ Per HD
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Crc Value $ Per Hd
     C           WN0011    SUB  WN0006    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0009           CD Lean Premium
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * Meat Value Calculation
      *================================================================
      * 06/20/05 PKD HPE011 Added Meat Value calculation
      * DOC:  Lean Premium Percent
     C                     EXSR UISUBR                     DOC:  Lean Prem
     C                     Z-ADD*ZERO     YL0045           CMMR Row Number
     C                     MOVE WN0037    YL0045           CMMR Row Number
      * Rtv Optimal Midpoint  RT - Carcass Merit Matrix Row  * 
     C                     EXSR SGRVGN
      * 08/23/05 PKD Checking Midpoint to make sure they are entered.
     C                     Z-ADDWN0048    WN0024           CD Lean Prem/Di
      * CD Lean Premium $ Per Hd
      * PAR.CD Lean Premium $ Per Hd =
      *    *COMPUTE ((x1 * (x4/x5)) * (x2 / x3))
      * x1    : PAR.CD Base Carcass CWT
      * *     : PGM.*Synon (15,5) work field *Rounded
      * x4    : PAR.CD Lean Prem/Disc Factor
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x5    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WN0024    DIV  100       W0WB02    H      *Synon (15,5) w
     C           WN0003    MULT W0WB02    W0WB01    H      *Synon (15,5) w
     C           WAEWNB    DIV  100       W0WB03    H      *Synon (15,5) w
     C           W0WB01    MULT W0WB03    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0009           CD Lean Premium
      * CD Lean Premuim CWT
      * PAR.CD Lean Premium CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.CD Lean Premium $ Per Hd
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WAEWNB    DIV  100       W0WB01    H      *Synon (15,5) w
     C           WN0009    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0008           CD Lean Premium
      * 12/15/06 PKD Below calculation uses the Base Price.
      * 12/15/06 PKD Use USDA Pork Cutout instead of the Base Price.
      *              USDA Pork Cutout = LCL.Market Prc Hog/Cutout USR
      *              pull the mrk and goup from the cmp market/group see
      * CD Fixed Cost Factor %
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.CMMR Midpoint is Entered
      *   |- c2    : PAR.CMMR Midpoint is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0046    IFGT 0                          *IF
     C           WN0046    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * FIXED COST
      * CD Fixed Cost Factor %
      * PAR.CD Fixed Cost Factor % =
      *    *COMPUTE ((((x3/x4-x3/x5)/x6)*x9))
      * x3    : PAR.CMP Fixed Cost Per Head
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x4    : LCL.CMMR Midpoint
      * -     : PGM.*Synon (15,5) work field
      * x3    : PAR.CMP Fixed Cost Per Head
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x5    : PAR.CMMR Midpoint
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x6    : LCL.Market Prc Hog/Cutout USR
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x9    : CON.100
     C           WN0040    DIV  YL0046    W0WB03    H      *Synon (15,5) w
     C           WN0040    DIV  WN0046    W0WB04    H      *Synon (15,5) w
     C           W0WB03    SUB  W0WB04    W0WB02           *Synon (15,5) w
     C           W0WB02    DIV  YL0043    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0025           CD Fixed Cost F
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0025           CD Fixed Cost F
     C                     END                             *FI
      * CD Fixed Cost Factor Amt
      * PAR.CD Fixed Cost Factor Amt =
      *    *COMPUTE (x1 * ((x2/x3) * (x5/x6)))
      * x1    : PAR.CD Base Carcass CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.CD Fixed Cost Factor %
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
      * *     : PGM.*Synon (15,5) work field *Rounded
      * x5    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x6    : CON.100
     C           WN0025    DIV  100       W0WB02    H      *Synon (15,5) w
     C           WAEWNB    DIV  100       W0WB03    H      *Synon (15,5) w
     C           W0WB02    MULT W0WB03    W0WB01    H      *Synon (15,5) w
     C           WN0003    MULT W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0028           CD Fixed Cost F
      * CD Meat Value Factor %
      * PAR.CD Meat Value Factor % =
      *    *COMPUTE (x1 + x2 + x3)
      * x1    : PAR.CD Sort Loss
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Fixed Cost Factor %
      * +     : PGM.*Synon (15,2) work field
      * x3    : PAR.CD Lean Prem/Disc Factor
     C           WN0001    ADD  WN0025    W0WA01           *Synon (15,2) w
     C           W0WA01    ADD  WN0024    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0023           CD Meat Value F
      * CD Meat Value Factor Amt
      * PAR.CD Meat Value Factor Amt =
      *    *COMPUTE ((x1 * ((x2/x7) - x4) * (x5 / x6)) * x8)
      * x1    : PAR.CD Base Carcass CWT
      * *     : PGM.*Synon (15,5) work field *Rounded
      * x2    : PAR.CD Meat Value Factor %
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x7    : CON.100
      * -     : PGM.*Synon (15,5) work field
      * x4    : CON.1
      * *     : PGM.*Synon (15,5) work field *Rounded
      * x5    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x6    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x8    : CON.1
     C           WN0023    DIV  100       W0WB04    H      *Synon (15,5) w
     C           W0WB04    SUB  1         W0WB03           *Synon (15,5) w
     C           WN0003    MULT W0WB03    W0WB02    H      *Synon (15,5) w
     C           WAEWNB    DIV  100       W0WB05    H      *Synon (15,5) w
     C           W0WB02    MULT W0WB05    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 1         W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0027           CD Meat Value F
      * CD Gross Value $ Per HD
      * PAR.CD Gross Value $ Per HD =
      *    *COMPUTE ((x1 * (x2 / x3)) * (x4 / x5))
      * x1    : PAR.CD Base Carcass CWT
      * *     : PGM.*Synon (15,5) work field *Rounded
      * x2    : PAR.CD Meat Value Factor %
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x4    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x5    : CON.100
     C           WN0023    DIV  100       W0WB02    H      *Synon (15,5) w
     C           WN0003    MULT W0WB02    W0WB01    H      *Synon (15,5) w
     C           WAEWNB    DIV  100       W0WB03    H      *Synon (15,5) w
     C           W0WB01    MULT W0WB03    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0011           CD Gross Value
      * CD Gross Value Per CWT
      * PAR.CD Gross Value Per CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.CD Gross Value $ Per HD
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WAEWNB    DIV  100       W0WB01    H      *Synon (15,5) w
     C           WN0011    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0010           CD Gross Value
      * ****************
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * DOC:  Lean Premium Percent
      *================================================================
      * Lean Prem% = ((A * (B/100)) + (((C/D) - (C/E)) / F) + (G/100))
      * WHERE:
      * A = Starting Point (100)
      * B = Sort Loss Percent
      * C = Fixed Cost Per Head
      * D = Optimal Weight Range Midpoint
      * E = Weight Range Midpoint
      * F = Base Market Price
      * G = Lean Premium & Discount Percent
      * 12/15/06 PKD Current:  F=Base Market Price
      *                  New:  F=USDA Pork Cutout
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         UJSUBR    BEGSR
      *================================================================
      * LEAN PERCENT  FAT O METER
      *================================================================
      * ---------------------------------------------------------------
      * Added 6/11/99 by Purva for C0007557.
      * Add Lean Factor/Lean % +/- to Lean Percent MM
      * CASE: PAR.CMP Lean Factor is Greater than 0
     C           WN0036    IFGT 0                          *IF
     C           WAFPPC    ADD  WN0036    WN0047           CMMC Lean Perce
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWAFPPC    WN0047           CMMC Lean Perce
     C                     END                             *FI
      * ---------------------------------------------------------------
     C                     Z-ADD*ZERO     WN0048           CMMC Premium Va
      * Rtv Lean Premium %    RT - Carcass Merit Matrix Col  * 
     C                     EXSR SHRVGN
      * Rtv Lean% Premium if not found in table, then use lowest
      * CASE: WRK.Record Found CMMC USR is No
     C           WUF6ST    IFEQ 'N'                        *IF
      * Rtv Lean Premium % Frc RT - Carcass Merit Matrix Col  * 
     C                     EXSR SIRVGN
     C                     END                             *FI
      * Add the meat premium
      * Total Carcass Per CWT add
      * PAR.CD Gross Value Per CWT =
      *    *COMPUTE (x1 + x2)
      * x1    : PAR.CD Crc Value Per CWT
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.CMMC Premium Value
     C           WN0004    ADD  WN0048    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0010           CD Gross Value
      * Total Carcass Value
      * PAR.CD Gross Value $ Per HD =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Gross Value Per CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WAEWNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0010    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0011           CD Gross Value
      * Lean Premium Per CWT
      * PAR.CD Lean Premium CWT =
      *    *COMPUTE (x1 - x2)
      * x1    : PAR.CD Gross Value Per CWT
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Crc Value Per CWT
     C           WN0010    SUB  WN0004    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0008           CD Lean Premium
      * Lean Premium Value
      * PAR.CD Lean Premium $ Per Hd =
      *    *COMPUTE (x1 - x2)
      * x1    : PAR.CD Gross Value $ Per HD
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Crc Value $ Per Hd
     C           WN0011    SUB  WN0006    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0009           CD Lean Premium
      *================================================================
     CSR         UJEXIT    ENDSR
      /EJECT
     CSR         UKSUBR    BEGSR
      *================================================================
      * Backfat
      *================================================================
      * 10/23/2007 * out the hard code CMP Grade Type Adj
      *              and replace with value form the CMP Grade Backfat
     C           WAH6NB    ADD  WN0041    WUVENB           Backfat USR
      * Rtv BckF Premium       RT - Carcass Merit Matrix Col  * 
     C                     EXSR SJRVGN
      * Rtv Bckf Premium if not found in table, then use lowest
      * CASE: WRK.Record Found CMMC USR is No
     C           WUF6ST    IFEQ 'N'                        *IF
      * Rtv BckF Premium % Frc RT - Carcass Merit Matrix Col  * 
     C                     EXSR SKRVGN
     C                     END                             *FI
      * *---------------------------------------------------------------*
      * * 05/15/02 PKD Commented out.  The Backfat calculation needs
      *                to work similar to Lean Percent.
      * Lean Premium Value
      * Lean Premium Per Cwt
      * Gross Value Per cwt
      * Gross Value $
      * *---------------------------------------------------------------*
      * Total Carcss Per CWT MULT
      * PAR.CD Gross Value Per CWT =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.CD Crc Value Per CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.CMMC Premium Value
     C           WN0004    MULT WN0048    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0010           CD Gross Value
      * Total Carcass Value
      * PAR.CD Gross Value $ Per HD =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Gross Value Per CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WAEWNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0010    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0011           CD Gross Value
      * Lean Premium Per CWT
      * PAR.CD Lean Premium CWT =
      *    *COMPUTE (x1 - x2)
      * x1    : PAR.CD Gross Value Per CWT
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Crc Value Per CWT
     C           WN0010    SUB  WN0004    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0008           CD Lean Premium
      * Lean Premium Value
      * PAR.CD Lean Premium $ Per Hd =
      *    *COMPUTE (x1 - x2)
      * x1    : PAR.CD Gross Value $ Per HD
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Crc Value $ Per Hd
     C           WN0011    SUB  WN0006    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0009           CD Lean Premium
      *================================================================
     CSR         UKEXIT    ENDSR
      /EJECT
     CSR         ULSUBR    BEGSR
      *================================================================
      * Lean Factor
      *================================================================
      * Diff actual/Std Lean%
      * PAR.CMMC Premium Value =
      *    *COMPUTE ((x1 - x2) / x3)
      * x1    : DB1.CD Lean Percent
      * -     : PGM.*Synon (17,7) work field
      * x2    : PAR.CMP Std Lean Percent
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WAAUPC    SUB  WN0035    W0WD01           *Synon (17,7) w
     C           W0WD01    DIV  100       W0WB00    H      *Synon (15,5) w
     C                     Z-ADDW0WB00    WN0048           CMMC Premium Va
      * multiple by lean factor
      * PAR.CMMC Premium Value =
      *    *COMPUTE ((x1 * x2) / x3)
      * x1    : PAR.CMMC Premium Value
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x2    : PAR.CMP Lean Factor
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WN0048    MULT WN0036    W0WD01           *Synon (17,7) w
     C           W0WD01    DIV  100       W0WB00    H      *Synon (15,5) w
     C                     Z-ADDW0WB00    WN0048           CMMC Premium Va
      * Lean Premium Per Cwt
     C           WN0048    MULT YL0002    WN0008    H      CD Lean Premium
      * Lean Premium Value
      * Lean Premium Value
      * PAR.CD Lean Premium $ Per Hd =
      *    *COMPUTE ((x1 * (x2 / x3)))
      * x1    : PAR.CD Lean Premium CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WAEWNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0008    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0009           CD Lean Premium
      * Gross Value Per cwt
      * Total Carcass Per CWT
      * PAR.CD Gross Value Per CWT =
      *    *COMPUTE (x1 + x2)
      * x1    : PAR.CD Crc Value Per CWT
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Lean Premium CWT
     C           WN0004    ADD  WN0008    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0010           CD Gross Value
      * Gross Value $
      * Total Carcass Value
      * PAR.CD Gross Value $ Per HD =
      *    *COMPUTE (x1 + x2)
      * x1    : PAR.CD Crc Value $ Per Hd
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Lean Premium $ Per Hd
     C           WN0006    ADD  WN0009    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0011           CD Gross Value
      *================================================================
     CSR         ULEXIT    ENDSR
      /EJECT
     CSR         UMSUBR    BEGSR
      *================================================================
      * Totals
      *================================================================
     C                     ADD  1         YL0007           Head Total USR
     C                     ADD  WN0001    YL0008           Sort Loss Tot U
     C                     ADD  WN0002    YL0009           Std Yield % Tot
     C                     ADD  WAEWNB    YL0010           Weight Tot USR
     C                     ADD  WN0005    YL0015           Base Carc Val T
     C                     ADD  WN0006    YL0011           Adj Base Carc V
     C                     ADD  WAAUPC    YL0012           Lean Percent To
     C                     ADD  WN0009    YL0013           Lean Add/Ded Va
     C                     ADD  WN0011    YL0014           Total Carc Val
     C                     ADD  WN0027    YL0020           TH Meat Value F
     C                     ADD  WN0028    YL0021           TH Fixed Cost A
     C                     ADD  WN0030    YL0022           Gross Before So
      *================================================================
     CSR         UMEXIT    ENDSR
      /EJECT
     CSR         UNSUBR    BEGSR
      *================================================================
      * zero out cd ca fields
      *================================================================
     C                     Z-ADD*ZERO     WN0013           CD CA Sort Loss
     C                     Z-ADD*ZERO     WN0014           CD CA Std Yield
     C                     Z-ADD*ZERO     WN0015           CD CA Base Carc
     C                     Z-ADD*ZERO     WN0016           CD CA Crc Value
     C                     Z-ADD*ZERO     WN0017           CD CA Base Carc
     C                     Z-ADD*ZERO     WN0018           CD CA Crc Value
     C                     Z-ADD*ZERO     WN0019           CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0020           CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0021           CD CA Gross Val
     C                     Z-ADD*ZERO     WN0022           CD CA Gross Val
      *================================================================
     CSR         UNEXIT    ENDSR
      /EJECT
     CSR         UOSUBR    BEGSR
      *================================================================
      * move cd fields to cd ca fields
      *================================================================
     C                     Z-ADDWN0001    WN0013           CD CA Sort Loss
     C                     Z-ADDWN0002    WN0014           CD CA Std Yield
     C                     Z-ADDWN0003    WN0015           CD CA Base Carc
     C                     Z-ADDWN0004    WN0016           CD CA Crc Value
     C                     Z-ADDWN0005    WN0017           CD CA Base Carc
     C                     Z-ADDWN0006    WN0018           CD CA Crc Value
     C                     Z-ADDWN0008    WN0019           CD CA Lean Prem
     C                     Z-ADDWN0009    WN0020           CD CA Lean Prem
     C                     Z-ADDWN0010    WN0021           CD CA Gross Val
     C                     Z-ADDWN0011    WN0022           CD CA Gross Val
      *================================================================
     CSR         UOEXIT    ENDSR
      /EJECT
     CSR         UPSUBR    BEGSR
      *================================================================
      * zero out cd fields
      *================================================================
     C                     Z-ADD*ZERO     WN0001           CD Sort Loss
     C                     Z-ADD*ZERO     WN0002           CD STD Yield
     C                     Z-ADD*ZERO     WN0003           CD Base Carcass
     C                     Z-ADD*ZERO     WN0004           CD Crc Value Pe
     C                     Z-ADD*ZERO     WN0005           CD Base Carc Va
     C                     Z-ADD*ZERO     WN0006           CD Crc Value $
     C                     Z-ADD*ZERO     WN0008           CD Lean Premium
     C                     Z-ADD*ZERO     WN0009           CD Lean Premium
     C                     Z-ADD*ZERO     WN0010           CD Gross Value
     C                     Z-ADD*ZERO     WN0011           CD Gross Value
      *================================================================
     CSR         UPEXIT    ENDSR
      /EJECT
     CSR         UQSUBR    BEGSR
      *================================================================
      * zero out cd ca fields
      *================================================================
     C                     Z-ADD*ZERO     WN0013           CD CA Sort Loss
     C                     Z-ADD*ZERO     WN0014           CD CA Std Yield
     C                     Z-ADD*ZERO     WN0015           CD CA Base Carc
     C                     Z-ADD*ZERO     WN0016           CD CA Crc Value
     C                     Z-ADD*ZERO     WN0017           CD CA Base Carc
     C                     Z-ADD*ZERO     WN0018           CD CA Crc Value
     C                     Z-ADD*ZERO     WN0019           CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0020           CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0021           CD CA Gross Val
     C                     Z-ADD*ZERO     WN0022           CD CA Gross Val
      *================================================================
     CSR         UQEXIT    ENDSR
      /EJECT
     CSR         URSUBR    BEGSR
      *================================================================
      * move cd fields to cd ca fields
      *================================================================
     C                     Z-ADDWN0001    WN0013           CD CA Sort Loss
     C                     Z-ADDWN0002    WN0014           CD CA Std Yield
     C                     Z-ADDWN0003    WN0015           CD CA Base Carc
     C                     Z-ADDWN0004    WN0016           CD CA Crc Value
     C                     Z-ADDWN0005    WN0017           CD CA Base Carc
     C                     Z-ADDWN0006    WN0018           CD CA Crc Value
     C                     Z-ADDWN0008    WN0019           CD CA Lean Prem
     C                     Z-ADDWN0009    WN0020           CD CA Lean Prem
     C                     Z-ADDWN0010    WN0021           CD CA Gross Val
     C                     Z-ADDWN0011    WN0022           CD CA Gross Val
      *================================================================
     CSR         UREXIT    ENDSR
      /EJECT
     CSR         USSUBR    BEGSR
      *================================================================
      * zero out cd fields
      *================================================================
     C                     Z-ADD*ZERO     WN0001           CD Sort Loss
     C                     Z-ADD*ZERO     WN0002           CD STD Yield
     C                     Z-ADD*ZERO     WN0003           CD Base Carcass
     C                     Z-ADD*ZERO     WN0004           CD Crc Value Pe
     C                     Z-ADD*ZERO     WN0005           CD Base Carc Va
     C                     Z-ADD*ZERO     WN0006           CD Crc Value $
     C                     Z-ADD*ZERO     WN0008           CD Lean Premium
     C                     Z-ADD*ZERO     WN0009           CD Lean Premium
     C                     Z-ADD*ZERO     WN0010           CD Gross Value
     C                     Z-ADD*ZERO     WN0011           CD Gross Value
      *================================================================
     CSR         USEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Check reference to Tattoo Header
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1HMNB    IFEQ *ZERO                      BOH Company Num
     C           #1BNNB    ANDEQ*ZERO                      BOH Buy Order N
     C           #1BONB    ANDEQ*ZERO                      BOL Load Number
     C           #1CVNB    ANDEQ*ZERO                      TH Tattoo Numbe
     C           #1B0DT    ANDEQ*ZERO                      TH Kill Date
     C                     GOTO VAEXIT
     C                     END
      *
     C           KLVAWL    KLIST
     C                     KFLD           WLHMNB           BOH Company Num
     C                     KFLD           WLBNNB           BOH Buy Order N
     C                     KFLD           WLBONB           BOL Load Number
     C                     KFLD           WLCVNB           TH Tattoo Numbe
     C                     KFLD           WLB0DT           TH Kill Date
      * Setup key
     C                     Z-ADD#1HMNB    WLHMNB
     C                     Z-ADD#1BNNB    WLBNNB
     C                     Z-ADD#1BONB    WLBONB
     C                     Z-ADD#1CVNB    WLCVNB
     C                     Z-ADD#1B0DT    WLB0DT
     C           KLVAWL    CHAIN@A1CPC4              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VAEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VAEXIT
     C                     END
      * Send message 'Tattoo Header          NF'
     C                     MOVEL'PRK0061' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0061' W0RTN
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Producer
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1ABCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        PD Producer Cod
     C           YPMTFD    OREQ '#1ABCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1ABCD' defaulted for 'PD Producer Code'.
     C                     CALL 'PKA1SRR'              90  Sel Producer
     C                     PARM *BLANK    W0RTN   7
     C           #1ABCD    PARM #1ABCD    WQ0012  6        PD Producer Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKA1SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1ABCD    IFNE *BLANK                     PD Producer Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VBEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1ABCD    IFEQ *BLANK                     PD Producer Cod
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBWM    KLIST
     C                     KFLD           WMABCD           PD Producer Cod
      * Setup key
     C                     MOVEL#1ABCD    WMABCD
     C           KLVBWM    CHAIN@ACREAI              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Producer               NF'
     C                     MOVEL'PRK0009' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0009' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Source
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1AACD    WK1X01  1
     C           WK1X01    IFEQ '?'                        SR Source Code
     C           YPMTFD    OREQ '#1AACD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AACD' defaulted for 'SR Source Code'.
     C                     CALL 'PKDRSRR'              90  Sel Source
     C                     PARM *BLANK    W0RTN   7
     C           #1AACD    PARM #1AACD    WQ0013  3        SR Source Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKDRSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AACD    IFNE *BLANK                     SR Source Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AACD    IFEQ *BLANK                     SR Source Code
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCWO    KLIST
     C                     KFLD           WOAACD           SR Source Code
      * Setup key
     C                     MOVEL#1AACD    WOAACD
     C           KLVCWO    CHAIN@AAREAC              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Source                 NF'
     C                     MOVEL'PRK0005' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0005' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WABNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WABONB           BOL Load Number
     C                     Z-ADD*ZERO     WACVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WAB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WALGNB           CD Scale Sequen
     C                     Z-ADD*ZERO     WAEUNB           CD Carcass Numb
     C                     Z-ADD*ZERO     WALHNB           CD Carcass Numb
     C                     Z-ADD*ZERO     WABEPR           CD Sort Loss
     C                     Z-ADD*ZERO     WAASPC           CD STD Yield
     C                     Z-ADD*ZERO     WAEWNB           CD Carcass/Hot
     C                     Z-ADD*ZERO     WAB4PR           CD Base Carcass
     C                     Z-ADD*ZERO     WAEYNB           CD Crc Value Pe
     C                     Z-ADD*ZERO     WAB1PR           CD Base Carc Va
     C                     Z-ADD*ZERO     WAAVPR           CD Crc Value $
     C                     Z-ADD*ZERO     WAAUPC           CD Lean Percent
     C                     Z-ADD*ZERO     WAAWPR           CD Lean Premium
     C                     Z-ADD*ZERO     WAAXPR           CD Lean Premium
     C                     Z-ADD*ZERO     WAEZNB           CD Gross Value
     C                     Z-ADD*ZERO     WAAYPR           CD Gross Value
     C                     Z-ADD*ZERO     WABBDT           CD Kill Date
     C                     Z-ADD*ZERO     WAAKTM           CD Kill Time
     C                     Z-ADD*ZERO     WAH6NB           CD Backfat Thic
     C                     Z-ADD*ZERO     WABEPC           CD Loin-Eye Dep
     C                     Z-ADD*ZERO     WAGCST           CD Light Reflec
     C                     Z-ADD*ZERO     WABHPC           CD FFLI
     C                     Z-ADD*ZERO     WALTNB           CD LOT
     C                     Z-ADD*ZERO     WAX4NB           CD Backfat Thic
     C                     Z-ADD*ZERO     WAFNPC           CD Loin-Eye Dep
     C                     Z-ADD*ZERO     WAFOPC           CD Light Reflec
     C                     Z-ADD*ZERO     WAFPPC           CD Lean Percent
     C                     Z-ADD*ZERO     WAJWPR           CD CA Sort Loss
     C                     Z-ADD*ZERO     WAF5PC           CD CA Std Yield
     C                     Z-ADD*ZERO     WAJXPR           CD CA Base Carc
     C                     Z-ADD*ZERO     WAJYPR           CD CA Crc Value
     C                     Z-ADD*ZERO     WAJZPR           CD CA Base Carc
     C                     Z-ADD*ZERO     WAJ0PR           CD CA Crc Value
     C                     Z-ADD*ZERO     WAJ1PR           CD CA Lean Prem
     C                     Z-ADD*ZERO     WAJ2PR           CD CA Lean Prem
     C                     Z-ADD*ZERO     WAJ3PR           CD CA Gross Val
     C                     Z-ADD*ZERO     WAJ4PR           CD CA Gross Val
     C                     Z-ADD*ZERO     WADKJR           CD Loin Eye Inc
     C                     Z-ADD*ZERO     WAITJF           CD Backfat Inch
     C                     Z-ADD*ZERO     WAIJGR           CD Meat Value F
     C                     Z-ADD*ZERO     WAORJE           CD Lean Prem/Di
     C                     Z-ADD*ZERO     WAOTJR           CD Fixed Cost F
     C                     Z-ADD*ZERO     WAPEIR           CD MPR Sort Los
     C                     Z-ADD*ZERO     WAIEUF           CD Meat Value F
     C                     Z-ADD*ZERO     WAORUE           CD Fixed Cost F
     C                     Z-ADD*ZERO     WAIUTR           CD Gross Before
     C                     Z-ADD*ZERO     WAIJRR           CD Gross Before
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Define work field #Txt USR
     C                     MOVEL*BLANK    WUC6TX 80
      * Define work field CMP Market Add/Deduct
     C                     Z-ADD*ZERO     WUI1PR  52
      * Define work field CMP CLC Premium First
     C                     MOVEL*BLANK    WUZ2ST  1
      * Define work field RS Record Status
     C                     MOVEL*BLANK    WUAJST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAZPC           CMP Std Lean Pe
     C                     Z-ADD*ZERO     WBA0PC           CMP Lean Factor
     C                     Z-ADD*ZERO     WBI1PR           CMP Market Add/
     C                     Z-ADD*ZERO     WBVEPR           CMP % of Carcas
     C                     Z-ADD*ZERO     WBVFPR           CMP Fixed Cost
     C                     Z-ADD*ZERO     WBVHPR           CMP Grade Type
     C                     Z-ADD*ZERO     WBVIPR           CMP Unused Pric
     C                     Z-ADD*ZERO     WBVJPR           CMP Unused Pric
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCGYDT           CMP Effect Purc
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      * Define work field *Return code
     C                     MOVEL*BLANK    WURTN   7
      * Define work field OMS Error Return Usr
     C                     MOVEL*BLANK    WUIPTX  5
      * Define work field Cmp Sort Dsc Carc
     C                     Z-ADD*ZERO     WUKWPR  62
      * Define work field Cmp Std Yield
     C                     Z-ADD*ZERO     WUF9PC  52
      * Define work field Cmp Base Carc
     C                     Z-ADD*ZERO     WUKRPR  62
      * Define work field Cmp Carc Val Carc
     C                     Z-ADD*ZERO     WUKUPR  52
      * Define work field Cmp Lean Premium Carc
     C                     Z-ADD*ZERO     WUKSPR  62
      * Define work field Cmp Gross Carc
     C                     Z-ADD*ZERO     WUKXPR  62
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDE8NB           CMMR Row Number
     C                     Z-ADD*ZERO     WDEGNB           CMMR Carc Wgt M
     C                     Z-ADD*ZERO     WDEHNB           CMMR Carc Wgt M
     C                     Z-ADD*ZERO     WDEINB           CMMR Carc Wgt M
     C                     Z-ADD*ZERO     WDEJNB           CMMR Live Wgt M
     C                     Z-ADD*ZERO     WDEKNB           CMMR Live Wgt M
     C                     Z-ADD*ZERO     WDAQPC           CMMR Std Dressi
     C                     Z-ADD*ZERO     WDEMNB           CMMR Sort Disco
     C                     Z-ADD*ZERO     WDE2NB           CMMR Unused Fie
     C                     Z-ADD*ZERO     WDLJA1           CMMR Midpoint
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
      * Define work field Record Found CMMC USR
     C                     MOVEL*BLANK    WUF6ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEE8NB           CMMR Row Number
     C                     Z-ADD*ZERO     WEE4NB           CMMC Column Num
     C                     Z-ADD*ZERO     WEA1PC           CMMC Lean Perce
     C                     Z-ADD*ZERO     WEE7NB           CMMC Backfat In
     C                     Z-ADD*ZERO     WEERNB           CMMC Premium Va
     C                     Z-ADD*ZERO     WEAADT           RS Date Changed
     C                     Z-ADD*ZERO     WEAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WEABDT           RS Date Added
     C                     Z-ADD*ZERO     WEABTM           RS Time Added
      * Define work field Backfat USR
     C                     Z-ADD*ZERO     WUVENB  31
      * Define work field Blank Usr 1 fld Usr
     C                     MOVEL*BLANK    WUIXTX  1
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WLBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WLBONB           BOL Load Number
     C                     Z-ADD*ZERO     WLCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WLB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WLAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WLACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WLB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WLCAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WLAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WLA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WLCXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WLCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WLFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WLH9NB           TH Held Over
     C                     Z-ADD*ZERO     WLFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WLFENB           TH Head Killed
     C                     Z-ADD*ZERO     WLHENB           TH Head Adds
     C                     Z-ADD*ZERO     WLHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WLCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WLLRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WLE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WLA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WLFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WLA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WLF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WLHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WLF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WLF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WLF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WLF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WLAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WLAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WLCWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WLA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WLA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WLB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WLAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WLANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WLAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WLAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WLAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WLAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WLAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WLASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WLA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WLATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WLA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WLCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WLCCPR           Th Payment Net
     C                     Z-ADD*ZERO     WLLPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WLCDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WLA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WLA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WLGHNB           TH Commission A
     C                     Z-ADD*ZERO     WLBYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WLBSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WLBTDT           TH Commission P
     C                     Z-ADD*ZERO     WLBUDT           TH Actual Check
     C                     Z-ADD*ZERO     WLHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WLHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WLHINB           TH FFLI
     C                     Z-ADD*ZERO     WLA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WLA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WLA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WLJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WLD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WLD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WLD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WLD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WLEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WLEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WLECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WLEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WLEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WLEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WLEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WLEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WLOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WLTHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WLT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WLTHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WLT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WLOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WLKOER           TH Head Identif
     C                     Z-ADD*ZERO     WLOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WLOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WLIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WLOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WLHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WLS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WLTAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WLTBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WLJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WLKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WLKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WLKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WLKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WLOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WLIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WLIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WLIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WLKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WLOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WLKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WLORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WLOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WLMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WLMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WLNCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WLNCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WLIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WLKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WLEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WLEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WLECDT           TH Head LFT
     C                     Z-ADD*ZERO     WLEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WLEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WLAADT           RS Date Changed
     C                     Z-ADD*ZERO     WLAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WLABDT           RS Date Added
     C                     Z-ADD*ZERO     WLABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMALNB           PD Production C
     C                     Z-ADD*ZERO     WMAATH           PD Std Delv Tim
     C                     Z-ADD*ZERO     WMAMNB           PD Std Truck Si
     C                     Z-ADD*ZERO     WMGCNB           PD VND Address
     C                     Z-ADD*ZERO     WMGJNB           PD EDI Trading
     C                     Z-ADD*ZERO     WMAADT           RS Date Changed
     C                     Z-ADD*ZERO     WMAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WMABDT           RS Date Added
     C                     Z-ADD*ZERO     WMABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WB01 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WB03 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WA02 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WB04 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB00 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WB02 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB05 155       *Synon (15,5) w
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      * Define local work field TH Purchase Date
     C                     Z-ADD*ZERO     YL0001  70
      * Define local work field TH CM Base Mkt Price
     C                     Z-ADD*ZERO     YL0002  52
      * Define local work field Payment Process Type USR
     C                     MOVEL*BLANK    YL0003  3
      * Define local work field Pricing UOM USR
     C                     MOVEL*BLANK    YL0004  2
      * Define local work field CMP Program Code
     C                     MOVEL*BLANK    YL0005  3
      * Define local work field BOH Quote Price Type
     C                     MOVEL*BLANK    YL0006  2
      * Define local work field Head Total USR
     C                     Z-ADD*ZERO     YL0007  70
      * Define local work field Sort Loss Tot USR
     C                     Z-ADD*ZERO     YL0008  72
      * Define local work field Std Yield % Tot USR
     C                     Z-ADD*ZERO     YL0009  72
      * Define local work field Weight Tot USR
     C                     Z-ADD*ZERO     YL0010  71
      * Define local work field Adj Base Carc Val Tot USR
     C                     Z-ADD*ZERO     YL0011  72
      * Define local work field Lean Percent Tot USR
     C                     Z-ADD*ZERO     YL0012  72
      * Define local work field Lean Add/Ded Val Tot USR
     C                     Z-ADD*ZERO     YL0013  72
      * Define local work field Total Carc Val Tot USR
     C                     Z-ADD*ZERO     YL0014  72
      * Define local work field Base Carc Val Tot USR
     C                     Z-ADD*ZERO     YL0015  72
      * Define local work field CM Processing Type Usr
     C                     MOVEL*BLANK    YL0016  1
      * Define local work field Competitors Processing
     C                     MOVEL*BLANK    YL0017  1
      * Define local work field TH PHA Lean Prm /Crc CWT
     C                     Z-ADD*ZERO     YL0018  52
      * Define local work field TH PHA Sort Disc Fctr %
     C                     Z-ADD*ZERO     YL0019  52
      * Define local work field TH Meat Value Factor Amt
     C                     Z-ADD*ZERO     YL0020 112
      * Define local work field TH Fixed Cost Amount
     C                     Z-ADD*ZERO     YL0021  72
      * Define local work field Gross Before Sort /HD Usr
     C                     Z-ADD*ZERO     YL0022  72
      * Define local work field Cmp Base Carc
     C                     Z-ADD*ZERO     YL0023  62
      * Define local work field Cmp Lean Premium Carc
     C                     Z-ADD*ZERO     YL0024  62
      * Define local work field Cmp Yield Gain/Loss Carc
     C                     Z-ADD*ZERO     YL0025  62
      * Define local work field Cmp Carc Val Carc
     C                     Z-ADD*ZERO     YL0026  52
      * Define local work field Cmp Sort Dsc Carc
     C                     Z-ADD*ZERO     YL0027  62
      * Define local work field Cmp Std Yield
     C                     Z-ADD*ZERO     YL0028  52
      * Define local work field Cmp Base Mkt Price
     C                     Z-ADD*ZERO     YL0029  52
      * Define local work field Cmp Base Live
     C                     Z-ADD*ZERO     YL0030  62
      * Define local work field Cmp Lean Premium Live
     C                     Z-ADD*ZERO     YL0031  62
      * Define local work field Cmp Yield Gain/Loss Live
     C                     Z-ADD*ZERO     YL0032  62
      * Define local work field Cmp Carc Val Live
     C                     Z-ADD*ZERO     YL0033  52
      * Define local work field Cmp Sort Dsc Live
     C                     Z-ADD*ZERO     YL0034  62
      * Define local work field Average Pay Sts Usr
     C                     MOVEL*BLANK    YL0035  1
      * Define local work field Print Comp Sum/Dtl STS
     C                     MOVEL*BLANK    YL0036  1
      * Define local work field TH MPR Sort Loss
     C                     Z-ADD*ZERO     YL0037  92
      * Define local work field CMP Effect Purchase Date
     C                     Z-ADD*ZERO     YL0038  70
      * Define local work field CMP Commodity Market
     C                     MOVEL*BLANK    YL0039  3
      * Define local work field CMP Commodity Group
     C                     MOVEL*BLANK    YL0040  7
      * Define local work field OMS Market Price Amt Usr
     C                     Z-ADD*ZERO     YL0041 114
      * Define local work field Pricing Date USR
     C                     Z-ADD*ZERO     YL0042  70
      * Define local work field Market Prc Hog/Cutout USR
     C                     Z-ADD*ZERO     YL0043  52
      * Define local work field *Synon (15,5) work field
     C                     Z-ADD*ZERO     YL0044 155
      * Define local work field CMMR Row Number
     C                     Z-ADD*ZERO     YL0045  30
      * Define local work field CMMR Midpoint
     C                     Z-ADD*ZERO     YL0046  52
      * Define local work field Num NU USR
     C                     Z-ADD*ZERO     YL0047  10
      * Define local work field Optimal Lean Percent USR
     C                     Z-ADD*ZERO     YL0048  53
      * Define local work field CMMR Std Dressing Yield%
     C                     Z-ADD*ZERO     YL0049  52
      * Define local work field CD Sort Loss
     C                     Z-ADD*ZERO     YL0050  72
      * Define local work field CMMC Premium Value
     C                     Z-ADD*ZERO     YL0051  53
      * Define local work field Sort Total %
     C                     Z-ADD*ZERO     YL0052  74
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * Modifications
      * 11/04/2020 ISE H16853 - Recompiled due to change in Buy Order Num
      * Load screen
     C                     EXSR MALDSC
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
