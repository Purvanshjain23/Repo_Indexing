     H/TITLE UPS Sch Conv Depts    PF  Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     W* Warning: This program does not set on the LR indicator
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by  : COOL:2E  Version: 62050
     H* Function type : Print file
      *
     H* Company       : OMS Development Model         lopment-
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 01/12/01  Time  : 17:09:09
     H* Copyright     : OMS Development Model         lopment-
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FPDI5REL2IF  E           K        DISK
      * RTV : PS Production Department  Converting Depts Only
      *
     FPDI7CPL2IF  E           K        DISK
      * RSQ : PS Production Capability  Co/Dept/EftDte(d)
      *
     FPDI8CPLFIF  E           K        DISK
      * RSQ : PS Prod Item Schedule     Co/Typ/Dt/Dpt/Itm/Whs FC
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company/Item              Retrieval index       NV
      *
     FPDIOREL5IF  E           K        DISK
      * RTV : Item Bill Of Material     Type = Consumed/Produced
      *
     FPDIOREL6IF  E           K        DISK
      * RSQ : Item Bill Of Material     Co/Itm/Typ/CPty/CItm Mt
      *
     FPDIOREL9IF  E           K        DISK
      * RSQ : Item Bill Of Material     Co/Itm/Typ/CmpItm  Meat2
      *
     FPDI8CPL1IF  E           K        DISK
      * RTV : PS Prod Item Schedule     Retrieval index
      *
     FPDI8CPLHIF  E           K        DISK
      * RSQ : PS Prod Item Schedule     Co/Typ/Dt/Dpt/Itm/Whs FG
      *
     FPDI6CPL4IF  E           K        DISK
      * RSQ : PS Std Prod Mix Dist      Co/Dpt/Dte(d)/Pty/Itm
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FPDI8CPL0UF  E           K        DISK
      * UPD : PS Prod Item Schedule     Update index
      *
     FPDA9PFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: UPS Sch Conv Depts    PF  Print file
      *
     E                    UCT        40  1               CENTER TABLE
     E                    #L3         3  1
     E                    #L7         7  1
     I@I8CPUR
      * PS Prod Item Schedule     Update index
      * Renamed input format fields
     I              I8AIC3                          WAAIC3
     I              I8V5ST                          WAV5ST
     I              I8ELDT                          WAELDT
     I              I8HGCD                          WAHGCD
     I              I8AJCD                          WAAJCD
     I              I8GPDT                          WAGPDT
     I              I8WTSP                          WAWTSP
     I              I8QTSP                          WAQTSP
     I              I8DJPC                          WADJPC
     I              I8F8WG                          WAF8WG
     I              I8WTIN                          WAWTIN
     I              I8D5NB                          WAD5NB
     I              I8DXWG                          WADXWG
     I              I8B2NB                          WAB2NB
     I              I8WTCN                          WAWTCN
     I              I8PSCV                          WAPSCV
     I              I8SAWT                          WASAWT
     I              I8B9NB                          WAB9NB
     I              I8D1WG                          WAD1WG
     I              I8CBNB                          WACBNB
     I              I8EZWG                          WAEZWG
     I              I8CCNB                          WACCNB
     I              I8E0WG                          WAE0WG
     I              I8D6NB                          WAD6NB
     I              I8OAWT                          WAOAWT
     I              I8CDNB                          WACDNB
     I              I8UNW2                          WAUNW2
     I              I8CENB                          WACENB
     I              I8F9WG                          WAF9WG
     I              I8BPNB                          WABPNB
     I              I8GAWG                          WAGAWG
     I              I8BQNB                          WABQNB
     I              I8GBWG                          WAGBWG
     I              I8BRNB                          WABRNB
     I              I8GCWG                          WAGCWG
     I              I8BSNB                          WABSNB
     I              I8GDWG                          WAGDWG
     I              I8BWNB                          WABWNB
     I              I8GEWG                          WAGEWG
     I              I8PS6U                          WAPS6U
     I              I8WCST                          WAWCST
     I              I8WPST                          WAWPST
     I              I8B5ST                          WAB5ST
     I              I8TFST                          WATFST
     I              I8TEST                          WATEST
     I              I8THST                          WATHST
     I              I8UDST                          WAUDST
     I              I8UFST                          WAUFST
     I              I8UGST                          WAUGST
     I              I8UHST                          WAUHST
     I              I8B6ST                          WAB6ST
     I              I8B7ST                          WAB7ST
     I              I8DVWG                          WADVWG
     I              I8D7NB                          WAD7NB
     I              I8FCAD                          WAFCAD
     I              I8D9NB                          WAD9NB
     I              I8DWWG                          WADWWG
     I              I8EANB                          WAEANB
     I              I8SHWT                          WASHWT
     I              I8EBNB                          WAEBNB
     I              I8AVWT                          WAAVWT
     I              I8ECNB                          WAECNB
     I              I8WTON                          WAWTON
     I              I8EDNB                          WAEDNB
     I              I8FNWT                          WAFNWT
     I              I8EENB                          WAEENB
     I              I8QTAS                          WAQTAS
     I              I8EFNB                          WAEFNB
     I              I8WAIO                          WAWAIO
     I              I8EGNB                          WAEGNB
     I              I8R3CD                          WAR3CD
     I              I8RGNB                          WARGNB
     I              I8RHNB                          WARHNB
     I              I8RINB                          WARINB
     I              I8XRCD                          WAXRCD
     I              I8UVST                          WAUVST
     I              I8UWST                          WAUWST
     I              I8UXST                          WAUXST
     I              I8VSST                          WAVSST
     I              I8AATM                          WAAATM
     I              I8AYNA                          WAAYNA
     I              I8A0NA                          WAA0NA
     I              I8AXDT                          WAAXDT
      *
     I@IOREGB
      * Item Bill Of Material     Co/Itm/Typ/CPty/CItm Mt
      * Renamed input format fields
     I              IOAIC3                          WBAIC3
     I              IOHGCD                          WBHGCD
     I              IOC9NB                          WBC9NB
     I              IOV2ST                          WBV2ST
     I              IOBOPR                          WBBOPR
     I              IOBPPR                          WBBPPR
     I              IOHGQT                          WBHGQT
     I              IOHHCD                          WBHHCD
     I              IOYAST                          WBYAST
     I              IOCNSM                          WBCNSM
     I              IOBMY1                          WBBMY1
     I              IOBMY2                          WBBMY2
     I              IOIXQT                          WBIXQT
     I              IOIYQT                          WBIYQT
     I              IORSST                          WBRSST
     I              IORTST                          WBRTST
     I              IOUVST                          WBUVST
     I              IOUWST                          WBUWST
     I              IOUXST                          WBUXST
     I              IOVSST                          WBVSST
     I              IOAATM                          WBAATM
     I              IOAYNA                          WBAYNA
     I              IOA0NA                          WBA0NA
     I              IOAXDT                          WBAXDT
      *
     I@IORENS
      * Item Bill Of Material     Co/Itm/Typ/CmpItm  Meat2
      * Renamed input format fields
     I              IOAIC3                          WCAIC3
     I              IOHGCD                          WCHGCD
     I              IOC9NB                          WCC9NB
     I              IOV2ST                          WCV2ST
     I              IOBOPR                          WCBOPR
     I              IOBPPR                          WCBPPR
     I              IOHGQT                          WCHGQT
     I              IOHHCD                          WCHHCD
     I              IOYAST                          WCYAST
     I              IOCNSM                          WCCNSM
     I              IOBMY1                          WCBMY1
     I              IOBMY2                          WCBMY2
     I              IOIXQT                          WCIXQT
     I              IOIYQT                          WCIYQT
     I              IORSST                          WCRSST
     I              IORTST                          WCRTST
     I              IOUVST                          WCUVST
     I              IOUWST                          WCUWST
     I              IOUXST                          WCUXST
     I              IOVSST                          WCVSST
     I              IOAATM                          WCAATM
     I              IOAYNA                          WCAYNA
     I              IOA0NA                          WCA0NA
     I              IOAXDT                          WCAXDT
      *
     I@I8CPUS
      * PS Prod Item Schedule     Retrieval index
      * Renamed input format fields
     I              I8AIC3                          WDAIC3
     I              I8V5ST                          WDV5ST
     I              I8ELDT                          WDELDT
     I              I8HGCD                          WDHGCD
     I              I8AJCD                          WDAJCD
     I              I8GPDT                          WDGPDT
     I              I8WTSP                          WDWTSP
     I              I8QTSP                          WDQTSP
     I              I8DJPC                          WDDJPC
     I              I8F8WG                          WDF8WG
     I              I8WTIN                          WDWTIN
     I              I8D5NB                          WDD5NB
     I              I8DXWG                          WDDXWG
     I              I8B2NB                          WDB2NB
     I              I8WTCN                          WDWTCN
     I              I8PSCV                          WDPSCV
     I              I8SAWT                          WDSAWT
     I              I8B9NB                          WDB9NB
     I              I8D1WG                          WDD1WG
     I              I8CBNB                          WDCBNB
     I              I8EZWG                          WDEZWG
     I              I8CCNB                          WDCCNB
     I              I8E0WG                          WDE0WG
     I              I8D6NB                          WDD6NB
     I              I8OAWT                          WDOAWT
     I              I8CDNB                          WDCDNB
     I              I8UNW2                          WDUNW2
     I              I8CENB                          WDCENB
     I              I8F9WG                          WDF9WG
     I              I8BPNB                          WDBPNB
     I              I8GAWG                          WDGAWG
     I              I8BQNB                          WDBQNB
     I              I8GBWG                          WDGBWG
     I              I8BRNB                          WDBRNB
     I              I8GCWG                          WDGCWG
     I              I8BSNB                          WDBSNB
     I              I8GDWG                          WDGDWG
     I              I8BWNB                          WDBWNB
     I              I8GEWG                          WDGEWG
     I              I8PS6U                          WDPS6U
     I              I8WCST                          WDWCST
     I              I8WPST                          WDWPST
     I              I8B5ST                          WDB5ST
     I              I8TFST                          WDTFST
     I              I8TEST                          WDTEST
     I              I8THST                          WDTHST
     I              I8UDST                          WDUDST
     I              I8UFST                          WDUFST
     I              I8UGST                          WDUGST
     I              I8UHST                          WDUHST
     I              I8B6ST                          WDB6ST
     I              I8B7ST                          WDB7ST
     I              I8DVWG                          WDDVWG
     I              I8D7NB                          WDD7NB
     I              I8FCAD                          WDFCAD
     I              I8D9NB                          WDD9NB
     I              I8DWWG                          WDDWWG
     I              I8EANB                          WDEANB
     I              I8SHWT                          WDSHWT
     I              I8EBNB                          WDEBNB
     I              I8AVWT                          WDAVWT
     I              I8ECNB                          WDECNB
     I              I8WTON                          WDWTON
     I              I8EDNB                          WDEDNB
     I              I8FNWT                          WDFNWT
     I              I8EENB                          WDEENB
     I              I8QTAS                          WDQTAS
     I              I8EFNB                          WDEFNB
     I              I8WAIO                          WDWAIO
     I              I8EGNB                          WDEGNB
     I              I8R3CD                          WDR3CD
     I              I8RGNB                          WDRGNB
     I              I8RHNB                          WDRHNB
     I              I8RINB                          WDRINB
     I              I8XRCD                          WDXRCD
     I              I8UVST                          WDUVST
     I              I8UWST                          WDUWST
     I              I8UXST                          WDUXST
     I              I8VSST                          WDVSST
     I              I8AATM                          WDAATM
     I              I8AYNA                          WDAYNA
     I              I8A0NA                          WDA0NA
     I              I8AXDT                          WDAXDT
      *
     I@I8CPF1
      * PS Prod Item Schedule     Co/Typ/Dt/Dpt/Itm/Whs FG
      * Renamed input format fields
     I              I8AIC3                          WEAIC3
     I              I8V5ST                          WEV5ST
     I              I8ELDT                          WEELDT
     I              I8HGCD                          WEHGCD
     I              I8AJCD                          WEAJCD
     I              I8GPDT                          WEGPDT
     I              I8WTSP                          WEWTSP
     I              I8QTSP                          WEQTSP
     I              I8DJPC                          WEDJPC
     I              I8F8WG                          WEF8WG
     I              I8WTIN                          WEWTIN
     I              I8D5NB                          WED5NB
     I              I8DXWG                          WEDXWG
     I              I8B2NB                          WEB2NB
     I              I8WTCN                          WEWTCN
     I              I8PSCV                          WEPSCV
     I              I8SAWT                          WESAWT
     I              I8B9NB                          WEB9NB
     I              I8D1WG                          WED1WG
     I              I8CBNB                          WECBNB
     I              I8EZWG                          WEEZWG
     I              I8CCNB                          WECCNB
     I              I8E0WG                          WEE0WG
     I              I8D6NB                          WED6NB
     I              I8OAWT                          WEOAWT
     I              I8CDNB                          WECDNB
     I              I8UNW2                          WEUNW2
     I              I8CENB                          WECENB
     I              I8F9WG                          WEF9WG
     I              I8BPNB                          WEBPNB
     I              I8GAWG                          WEGAWG
     I              I8BQNB                          WEBQNB
     I              I8GBWG                          WEGBWG
     I              I8BRNB                          WEBRNB
     I              I8GCWG                          WEGCWG
     I              I8BSNB                          WEBSNB
     I              I8GDWG                          WEGDWG
     I              I8BWNB                          WEBWNB
     I              I8GEWG                          WEGEWG
     I              I8PS6U                          WEPS6U
     I              I8WCST                          WEWCST
     I              I8WPST                          WEWPST
     I              I8B5ST                          WEB5ST
     I              I8TFST                          WETFST
     I              I8TEST                          WETEST
     I              I8THST                          WETHST
     I              I8UDST                          WEUDST
     I              I8UFST                          WEUFST
     I              I8UGST                          WEUGST
     I              I8UHST                          WEUHST
     I              I8B6ST                          WEB6ST
     I              I8B7ST                          WEB7ST
     I              I8DVWG                          WEDVWG
     I              I8D7NB                          WED7NB
     I              I8FCAD                          WEFCAD
     I              I8D9NB                          WED9NB
     I              I8DWWG                          WEDWWG
     I              I8EANB                          WEEANB
     I              I8SHWT                          WESHWT
     I              I8EBNB                          WEEBNB
     I              I8AVWT                          WEAVWT
     I              I8ECNB                          WEECNB
     I              I8WTON                          WEWTON
     I              I8EDNB                          WEEDNB
     I              I8FNWT                          WEFNWT
     I              I8EENB                          WEEENB
     I              I8QTAS                          WEQTAS
     I              I8EFNB                          WEEFNB
     I              I8WAIO                          WEWAIO
     I              I8EGNB                          WEEGNB
     I              I8R3CD                          WER3CD
     I              I8RGNB                          WERGNB
     I              I8RHNB                          WERHNB
     I              I8RINB                          WERINB
     I              I8XRCD                          WEXRCD
     I              I8UVST                          WEUVST
     I              I8UWST                          WEUWST
     I              I8UXST                          WEUXST
     I              I8VSST                          WEVSST
     I              I8AATM                          WEAATM
     I              I8AYNA                          WEAYNA
     I              I8A0NA                          WEA0NA
     I              I8AXDT                          WEAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
     IQPDI81    E DSPDI8CPL0
      * UPD : PS Prod Item Schedule     Update index
      * Renamed input format fields
     I              I8AIC3                          WAAIC3
     I              I8V5ST                          WAV5ST
     I              I8ELDT                          WAELDT
     I              I8HGCD                          WAHGCD
     I              I8AJCD                          WAAJCD
     I              I8GPDT                          WAGPDT
     I              I8WTSP                          WAWTSP
     I              I8QTSP                          WAQTSP
     I              I8DJPC                          WADJPC
     I              I8F8WG                          WAF8WG
     I              I8WTIN                          WAWTIN
     I              I8D5NB                          WAD5NB
     I              I8DXWG                          WADXWG
     I              I8B2NB                          WAB2NB
     I              I8WTCN                          WAWTCN
     I              I8PSCV                          WAPSCV
     I              I8SAWT                          WASAWT
     I              I8B9NB                          WAB9NB
     I              I8D1WG                          WAD1WG
     I              I8CBNB                          WACBNB
     I              I8EZWG                          WAEZWG
     I              I8CCNB                          WACCNB
     I              I8E0WG                          WAE0WG
     I              I8D6NB                          WAD6NB
     I              I8OAWT                          WAOAWT
     I              I8CDNB                          WACDNB
     I              I8UNW2                          WAUNW2
     I              I8CENB                          WACENB
     I              I8F9WG                          WAF9WG
     I              I8BPNB                          WABPNB
     I              I8GAWG                          WAGAWG
     I              I8BQNB                          WABQNB
     I              I8GBWG                          WAGBWG
     I              I8BRNB                          WABRNB
     I              I8GCWG                          WAGCWG
     I              I8BSNB                          WABSNB
     I              I8GDWG                          WAGDWG
     I              I8BWNB                          WABWNB
     I              I8GEWG                          WAGEWG
     I              I8PS6U                          WAPS6U
     I              I8WCST                          WAWCST
     I              I8WPST                          WAWPST
     I              I8B5ST                          WAB5ST
     I              I8TFST                          WATFST
     I              I8TEST                          WATEST
     I              I8THST                          WATHST
     I              I8UDST                          WAUDST
     I              I8UFST                          WAUFST
     I              I8UGST                          WAUGST
     I              I8UHST                          WAUHST
     I              I8B6ST                          WAB6ST
     I              I8B7ST                          WAB7ST
     I              I8DVWG                          WADVWG
     I              I8D7NB                          WAD7NB
     I              I8FCAD                          WAFCAD
     I              I8D9NB                          WAD9NB
     I              I8DWWG                          WADWWG
     I              I8EANB                          WAEANB
     I              I8SHWT                          WASHWT
     I              I8EBNB                          WAEBNB
     I              I8AVWT                          WAAVWT
     I              I8ECNB                          WAECNB
     I              I8WTON                          WAWTON
     I              I8EDNB                          WAEDNB
     I              I8FNWT                          WAFNWT
     I              I8EENB                          WAEENB
     I              I8QTAS                          WAQTAS
     I              I8EFNB                          WAEFNB
     I              I8WAIO                          WAWAIO
     I              I8EGNB                          WAEGNB
     I              I8R3CD                          WAR3CD
     I              I8RGNB                          WARGNB
     I              I8RHNB                          WARHNB
     I              I8RINB                          WARINB
     I              I8XRCD                          WAXRCD
     I              I8UVST                          WAUVST
     I              I8UWST                          WAUWST
     I              I8UXST                          WAUXST
     I              I8VSST                          WAVSST
     I              I8AATM                          WAAATM
     I              I8AYNA                          WAAYNA
     I              I8A0NA                          WAA0NA
     I              I8AXDT                          WAAXDT
      *
     IYARDCS      DS                            326
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: PS Production Department
      * I : RST Company Number
     I                                    P   1   20P1AIC3
     IP2PARM      DS
      * FLD: PS Prod Item Schedule
      * I :  Production Type
     I                                        1   1 P2V5ST
      * I :  Production Date
     I                                    P   2   50P2ELDT
     IP3PARM      DS
      * N :  Weight Total 13.2     USR
     I                                    P   1   72P3ETWG
     IP4PARM      DS
      * FLD: PS Production Capability
      * N :  Weight Per Day
     I                                    P   1   40P4DRWG
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'PS BOM Not Found'
      * Message data for 'PS BOM Not Found'
      * Message data for 'PS No 1st Level Prod'
      * Message data for 'PS RM not Available'
      * Message data for 'PS Need > Available'
      * Message data for 'PS No 1st Level Prod'
      * Message data for 'PS RM not Available'
      * Message data for 'PS Need > Available'
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P2V5ST    PARM           WP0002  1        Production Type
     C           P2ELDT    PARM           WP0003  70       Production Date
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * UPS Sch Conv Depts    PF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE#CENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * UPS Sch Conv Depts    PF: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN I5AIC3    WQKA01           Company Number
      * Define keylist
     C           KRSA      KLIST
     C                     KFLD           WQKA01           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WQKA01           Company Number
      * Establish starting position
     C           KRSA      SETLL@I5RECR                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        Company Number
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDI5AIC3    $CAIC3           Company Number
     C                     MOVELI5R3CD    $CR3CD           Department Code
     C                     MOVELI5MYNA    $CMYNA           Department Desc
     C                     Z-ADD*ZERO     $CDRWG           Weight Per Day
     C                     MOVELI5DPT1    $CDPT1           Department Type
     C                     MOVELI5UVST    $CUVST           EDI Status 1
     C                     MOVELI5UWST    $CUWST           EDI Status 2
     C                     MOVELI5UXST    $CUXST           EDI Status 3
     C                     MOVELI5VSST    $CVSST           Record Status
     C                     Z-ADDI5AATM    $CAATM           Job Time
     C                     MOVELI5AYNA    $CAYNA           User Id
     C                     MOVELI5A0NA    $CA0NA           Job Name
     C                     Z-ADDI5AXDT    $CAXDT           Job Date
      * USER: Process before print of detail format
      * PAR = CON By name
     C                     Z-ADD*ZERO     P3ETWG           Weight Total 13
     C                     Z-ADD*ZERO     P4DRWG           Weight Per Day
      * Rtv Dept Capability   RT - PS Production Capability  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDI5AIC3    WL0001           Company Number
     C                     MOVELI5R3CD    WL0002    P      Department Code
     C                     Z-ADDP2ELDT    WL0003           Effective Produ
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0004    P4DRWG           Weight Per Day
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : UPS BOM FG Conv       PO
     C                     EXSR UASUBR                     Embedded PRTOBJ
      * Embedded PRTOBJ : UPS BOM FG Base Cnv   PO
     C                     EXSR UFSUBR                     Embedded PRTOBJ
      * Embedded PRTOBJ : UPS Conv Dept Std     PO
     C                     EXSR UHSUBR                     Embedded PRTOBJ
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN I5AIC3    WZA001           Company Number
     C                     Z-ADDI5AIC3    WZA001
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C           KRSA      READE@I5RECR                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        Company Number
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        Company Number
     C                     ELSE
      * Next record - Detect level breaks
     C           I5AIC3    IFNE WZA001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         B0MAIN    BEGSR
      *================================================================
      * UPS BOM FG Conv       PO: Mainline
      *================================================================
      * UPS BOM FG Conv       PO: Initialise
     C                     EXSR ZBINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN I8AIC3    WQKB01           Company Number
     C           *LIKE     DEFN I8V5ST    WQKB02           Production Type
     C           *LIKE     DEFN I8ELDT    WQKB03           Production Date
     C           *LIKE     DEFN I8R3CD    WQKB04           Department Code
      * Define keylist
     C           KRSB      KLIST
     C                     KFLD           WQKB01           Company Number
     C                     KFLD           WQKB02           Production Type
     C                     KFLD           WQKB03           Production Date
     C                     KFLD           WQKB04           Department Code
      * Setup key
     C                     Z-ADD$CAIC3    WQKB01           Company Number
     C                     MOVELP2V5ST    WQKB02           Production Type
     C                     Z-ADDP2ELDT    WQKB03           Production Date
     C                     MOVEL$CR3CD    WQKB04           Department Code
      * Establish starting position
     C           KRSB      SETLL@I8CPF2                    *
      * Read first record with user selection
     C                     EXSR B3READ
     C           W0EOFB    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0BL1P  1        First page
     C                     MOVEL'Y'       W0BL00  1        Company Number
     C                     MOVEL'Y'       W0BL01  1        Production Type
     C                     MOVEL'Y'       W0BL02  1        Production Date
     C                     MOVEL'Y'       W0BL03  1        Department Code
     C                     MOVEL'Y'       W0BL04  1        Item Code
     C                     MOVEL'Y'       W0BL05  1        Warehouse Code
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      * Print report body
     C           W0EOFB    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR B1PHDR
      * Print report detail line
     C                     EXSR B2PDTL
      * Read next record with user selection
     C                     EXSR B3READ
      * Print totals
     C                     EXSR B4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         B0EXIT    ENDSR
      /EJECT
     CSR         B1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0BL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP1P  1
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADDI8AIC3    $RAIC3           Company Number
     C                     Z-ADD*ZERO     $RE5WG           Weight 9.2 SUM
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP00  1
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP01  1
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP02  1
     C                     END
      *
     C           W0BL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP03  1
     C                     END
      *
     C           W0BL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP04  1
     C                     END
      *
     C           W0BL05    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP05  1
     C                     END
      *
      *================================================================
     CSR         B1EXIT    ENDSR
      /EJECT
     CSR         B2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDI8AIC3    $EAIC3           Company Number
     C                     MOVELI8V5ST    $EV5ST           Production Type
     C                     Z-ADDI8ELDT    $EELDT           Production Date
     C                     Z-ADDI8HGCD    $EHGCD           Item Code
     C                     MOVEL*BLANK    $EGENA           Item Descriptio
     C                     MOVELI8AJCD    $EAJCD           Warehouse Code
     C                     Z-ADDI8QTSP    $EQTSP           PS Pieces Plann
     C                     Z-ADDI8WTSP    $EWTSP           PS Weight Plann
     C                     Z-ADDI8DJPC    $EDJPC           PS % of Carcass
     C                     Z-ADDI8F8WG    $EF8WG           PS Avg Piece Wg
     C                     Z-ADDI8DVWG    $EDVWG           PS Weight Order
     C                     Z-ADDI8D7NB    $ED7NB           PS Pieces Order
     C                     Z-ADDI8FCAD    $EFCAD           PS Weight FC Ad
     C                     Z-ADDI8D9NB    $ED9NB           PS Pieces FC Ad
     C                     Z-ADDI8DWWG    $EDWWG           PS Weight FX Ad
     C                     Z-ADDI8EANB    $EEANB           PS Pieces FX Ad
     C                     Z-ADDI8WTIN    $EWTIN           PS Weight Inv O
     C                     Z-ADDI8D5NB    $ED5NB           PS Pieces Inv O
     C                     Z-ADDI8SHWT    $ESHWT           PS Weight Sched
     C                     Z-ADDI8EBNB    $EEBNB           PS Pieces Sched
     C                     Z-ADDI8AVWT    $EAVWT           PS Weight Avail
     C                     Z-ADDI8ECNB    $EECNB           PS Pieces Avail
     C                     Z-ADDI8WTON    $EWTON           PS Weight Produ
     C                     Z-ADDI8EDNB    $EEDNB           PS Pieces Produ
     C                     Z-ADD*ZERO     $EBPPR           Production Yiel
     C                     Z-ADD*ZERO     $EORND           Weight Order Ne
     C                     MOVEL*BLANK    $ENQNA           Comment 60 USR
     C                     Z-ADDI8DXWG    $EDXWG           PS Weight Stand
     C                     Z-ADDI8B2NB    $EB2NB           PS Pieces Stand
     C                     Z-ADDI8FNWT    $EFNWT           PS Weight Fab N
     C                     Z-ADDI8EENB    $EEENB           PS Pieces Fab N
     C                     Z-ADDI8WTCN    $EWTCN           PS Weight Conve
     C                     Z-ADDI8PSCV    $EPSCV           PS Pieces Conve
     C                     Z-ADDI8QTAS    $EQTAS           PS Weight Sched
     C                     Z-ADDI8EFNB    $EEFNB           PS Pieces Sched
     C                     Z-ADDI8GPDT    $EGPDT           PS Available Sh
     C                     Z-ADDI8OAWT    $EOAWT           PS Weight Prod
     C                     Z-ADDI8CDNB    $ECDNB           PS Pieces Prod
     C                     Z-ADDI8SAWT    $ESAWT           PS Weight Shipp
     C                     Z-ADDI8B9NB    $EB9NB           PS Pieces Shipp
     C                     Z-ADDI8D1WG    $ED1WG           PS Weight Prod
     C                     Z-ADDI8CBNB    $ECBNB           PS Pieces Prod
     C                     Z-ADDI8EZWG    $EEZWG           PS Weight Inv A
     C                     Z-ADDI8CCNB    $ECCNB           PS Pieces Inv A
     C                     Z-ADDI8WAIO    $EWAIO           PS Weight Sched
     C                     Z-ADDI8EGNB    $EEGNB           PS Pieces Sched
     C                     Z-ADDI8UNW2    $EUNW2           PS Weight Inv A
     C                     Z-ADDI8CENB    $ECENB           PS Pieces Inv A
     C                     Z-ADDI8F9WG    $EF9WG           PS Unit Weight
     C                     Z-ADDI8BPNB    $EBPNB           PS Pieces Unuse
     C                     Z-ADDI8GAWG    $EGAWG           PS Weight Unuse
     C                     Z-ADDI8BQNB    $EBQNB           PS Pieces Unuse
     C                     Z-ADDI8GBWG    $EGBWG           PS Weight Unuse
     C                     Z-ADDI8BRNB    $EBRNB           PS Pieces Unuse
     C                     Z-ADDI8GCWG    $EGCWG           PS Weight Unuse
     C                     Z-ADDI8BSNB    $EBSNB           PS Pieces Unuse
     C                     Z-ADDI8GDWG    $EGDWG           PS Weight Unuse
     C                     Z-ADDI8BWNB    $EBWNB           PS Pieces Unuse
     C                     Z-ADDI8GEWG    $EGEWG           PS Weight Unuse
     C                     Z-ADDI8PS6U    $EPS6U           PS Pieces Unuse
     C                     Z-ADDI8E0WG    $EE0WG           PS Weight Ship
     C                     Z-ADDI8D6NB    $ED6NB           PS Pieces Ship
     C                     MOVELI8WCST    $EWCST           PS Item Id
     C                     MOVELI8WPST    $EWPST           Warehouse Type
     C                     MOVELI8B5ST    $EB5ST           PS Lock Status
     C                     MOVELI8TFST    $ETFST           PS Export/Domes
     C                     MOVELI8TEST    $ETEST           PS Print On Sch
     C                     MOVELI8THST    $ETHST           PS Piece Count
     C                     MOVELI8UDST    $EUDST           PS Unused Sts 1
     C                     MOVELI8UFST    $EUFST           PS Unused Sts 2
     C                     MOVELI8UGST    $EUGST           PS Unused Sts 3
     C                     MOVELI8UHST    $EUHST           PS Unused Sts 4
     C                     MOVELI8B6ST    $EB6ST           PS Item Sched N
     C                     MOVELI8B7ST    $EB7ST           PS Unused Sts 6
     C                     MOVELI8R3CD    $ER3CD           Department Code
     C                     Z-ADDI8RGNB    $ERGNB           Item Structure
     C                     Z-ADDI8RHNB    $ERHNB           Item Structure
     C                     Z-ADDI8RINB    $ERINB           Item Structure
     C                     MOVELI8XRCD    $EXRCD           Primal Group Co
     C                     MOVELI8UVST    $EUVST           EDI Status 1
     C                     MOVELI8UWST    $EUWST           EDI Status 2
     C                     MOVELI8UXST    $EUXST           EDI Status 3
     C                     MOVELI8VSST    $EVSST           Record Status
     C                     Z-ADDI8AATM    $EAATM           Job Time
     C                     MOVELI8AYNA    $EAYNA           User Id
     C                     MOVELI8A0NA    $EA0NA           Job Name
     C                     Z-ADDI8AXDT    $EAXDT           Job Date
      * USER: Process before print of detail format
     C                     Z-ADD*ZERO     WN0001           Weight Consumed
      * Rtv Descriptions      RT - Company/Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$EAIC3    WL0005           Company Number
     C                     Z-ADD$EHGCD    WL0006           Item Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    $EGENA    P      Description Lin
     C                     MOVELWL0008    WUAWNA    P      Description Lin
     C                     MOVELWL0009    WUADCD    P      U/M - Primary
     C                     MOVELWL0010    WUAECD    P      U/M - Second
     C                     MOVELWL0011    WUAFCD    P      U/M - Third
      * Rtv Item Prod Yield   RT - PD Item Bill Of Material  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$EAIC3    WL0012           Company Number
     C                     Z-ADD$EHGCD    WL0013           Item Code
     C                     Z-ADD$EHGCD    WL0014           Component Item
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0015    $EBPPR           Production Yiel
     C                     MOVELWL0016    WUWXST    P      Record Found US
      * CASE:
      *  - c1 OR c2
      *   |- c1    : WRK.Record Found USR is Record Not Found
      *   |- c2    : CUR.Production Yield is LE Zero
      *   '-
     C           WUWXST    IFEQ 'N'                        *IF
     C           $EBPPR    ORLE *ZERO                      *OR
      * Setup message data for message
      * Retrieve message PS BOM Not Found
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR2011' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C           $ENQNA    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
     C                     ELSE
      * CASE: *OTHERWISE
      * Weight Order Needs USR
      * CUR.Weight Order Needs USR =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.PS Weight Production Need
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.Production Yield
      * /     : PGM.*Synon (15,5) work field *
      * x3    : CON.100
     C           $EBPPR    DIV  100       W0WB01           *Synon (15,5) w
     C           $EWTON    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $EORND           Weight Order Ne
     C           P4DRWG    SUB  WN0003    WN0002           Weight Left for
      * CASE: PAR.Weight Left for Std USR GT CUR.Weight Order Needs USR
     C           WN0002    IFGT $EORND                     *IF
     C                     ADD  $EORND    WN0003           Weight 9.2 USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWN0002    $EORND           Weight Order Ne
     C                     ADD  $EORND    WN0003           Weight 9.2 USR
     C                     MOVEL*BLANK    $EB6ST           PS Item Sched N
     C                     MOVEL'E'       $EB6ST           PS Item Sched N
      * Chg Item Sch Need Sts CH - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$EAIC3    WL0017           Company Number
     C                     MOVEL$EV5ST    WL0018    P      Production Type
     C                     Z-ADD$EELDT    WL0019           Production Date
     C                     Z-ADD$EHGCD    WL0020           Item Code
     C                     MOVEL$EAJCD    WL0021    P      Warehouse Code
     C                     MOVEL$EB6ST    WL0022    P      PS Item Sched N
     C                     EXSR SFCHRC
     C                     END                             *FI
     C                     END                             *FI
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : UPS BOM FG Conv Items PO
     C                     EXSR UBSUBR                     Embedded PRTOBJ
      * Embedded PRTOBJ : UPS BOM Conv/Fab Dept PO
     C                     EXSR UDSUBR                     Embedded PRTOBJ
      * USER: Process after print of detail format
     C                     ADD  WN0001    $RE5WG           Weight 9.2 SUM
      *
      *================================================================
     CSR         B2EXIT    ENDSR
      /EJECT
     CSR         B3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN I8AIC3    WZB001           Company Number
     C                     Z-ADDI8AIC3    WZB001
     C           *LIKE     DEFN I8V5ST    WZB002           Production Type
     C                     MOVELI8V5ST    WZB002
     C           *LIKE     DEFN I8ELDT    WZB003           Production Date
     C                     Z-ADDI8ELDT    WZB003
     C           *LIKE     DEFN I8R3CD    WZB004           Department Code
     C                     MOVELI8R3CD    WZB004
     C           *LIKE     DEFN I8HGCD    WZB005           Item Code
     C                     Z-ADDI8HGCD    WZB005
     C           *LIKE     DEFN I8AJCD    WZB006           Warehouse Code
     C                     MOVELI8AJCD    WZB006
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFB    OREQ '1'
     C           KRSB      READE@I8CPF2                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFB  1
      * Quit if no record read
     C           W0EOFB    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0BL00  1        Company Number
     C                     MOVEL*BLANK    W0BL01  1        Production Type
     C                     MOVEL*BLANK    W0BL02  1        Production Date
     C                     MOVEL*BLANK    W0BL03  1        Department Code
     C                     MOVEL*BLANK    W0BL04  1        Item Code
     C                     MOVEL*BLANK    W0BL05  1        Warehouse Code
     C           W0EOFB    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0BL00  1        Company Number
     C                     MOVEL'Y'       W0BL01  1        Production Type
     C                     MOVEL'Y'       W0BL02  1        Production Date
     C                     MOVEL'Y'       W0BL03  1        Department Code
     C                     MOVEL'Y'       W0BL04  1        Item Code
     C                     MOVEL'Y'       W0BL05  1        Warehouse Code
     C                     ELSE
      * Next record - Detect level breaks
     C           I8AIC3    IFNE WZB001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL00
     C                     END
     C           I8V5ST    IFNE WZB002                     Production Type
     C           W0BL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL01
     C                     END
     C           I8ELDT    IFNE WZB003                     Production Date
     C           W0BL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL02
     C                     END
     C           I8R3CD    IFNE WZB004                     Department Code
     C           W0BL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL03
     C                     END
     C           I8HGCD    IFNE WZB005                     Item Code
     C           W0BL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL04
     C                     END
     C           I8AJCD    IFNE WZB006                     Warehouse Code
     C           W0BL04    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL05
     C                     END
     C                     END
      *================================================================
     CSR         B3EXIT    ENDSR
      /EJECT
     CSR         B4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0BL05    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP05
     C                     END
      *
     C           W0BL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP04
     C                     END
      *
     C           W0BL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP03
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP02
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP01
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$RKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP00
      * USER: Process after print of Company Number format
     C                     Z-ADD$RE5WG    P3ETWG           Weight Total 13
     C                     END
      *
     C           W0EOFB    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         B4EXIT    ENDSR
      /EJECT
     CSR         C0MAIN    BEGSR
      *================================================================
      * UPS BOM Conv/Fab Dept PO: Mainline
      *================================================================
      * UPS BOM Conv/Fab Dept PO: Initialise
     C                     EXSR ZCINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQKC01           Company Number
     C           *LIKE     DEFN WBHGCD    WQKC02           Item Code
      * Define keylist
     C           KRSC      KLIST
     C                     KFLD           WQKC01           Company Number
     C                     KFLD           WQKC02           Item Code
      * Setup key
     C                     Z-ADD$EAIC3    WQKC01           Company Number
     C                     Z-ADD$EHGCD    WQKC02           Item Code
      * Establish starting position
     C           KRSC      SETLL@IOREGB                    *
      * Read first record with user selection
     C                     EXSR C3READ
     C           W0EOFC    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0CL1P  1        First page
     C                     MOVEL'Y'       W0CL00  1        Company Number
     C                     MOVEL'Y'       W0CL01  1        Item Code
     C                     MOVEL'Y'       W0CL02  1        BOM Type
     C                     MOVEL'Y'       W0CL03  1        Consume Priorit
     C                     MOVEL'Y'       W0CL04  1        Component Item
      * Set column headings flag
     C                     MOVE 'Y'       W0CCDT
      * Print report body
     C           W0EOFC    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR C1PHDR
      * Print report detail line
     C                     EXSR C2PDTL
      * Read next record with user selection
     C                     EXSR C3READ
      * Print totals
     C                     EXSR C4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         C0EXIT    ENDSR
      /EJECT
     CSR         C1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0CL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP1P  1
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP00  1
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP01  1
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP02  1
     C                     END
      *
     C           W0CL03    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDWBAIC3    $FAIC3           Company Number
     C                     Z-ADDWBHGCD    $FHGCD           Item Code
     C                     MOVELWBV2ST    $FV2ST           BOM Type
     C                     Z-ADDWBCNSM    $FCNSM           Consume Priorit
      * Load related totals format
     C                     Z-ADDWBAIC3    $JAIC3           Company Number
     C                     Z-ADDWBHGCD    $JHGCD           Item Code
     C                     MOVELWBV2ST    $JV2ST           BOM Type
     C                     Z-ADDWBCNSM    $JCNSM           Consume Priorit
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP03  1
     C                     END
      *
     C           W0CL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP04  1
     C                     END
      *
      *================================================================
     CSR         C1EXIT    ENDSR
      /EJECT
     CSR         C2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDWBAIC3    $GAIC3           Company Number
     C                     Z-ADDWBHGCD    $GHGCD           Item Code
     C                     MOVELWBV2ST    $GV2ST           BOM Type
     C                     MOVEL*BLANK    $GGUTX           Condition Name
     C                     Z-ADDWBC9NB    $GC9NB           Component Item
     C                     MOVEL*BLANK    $GGENA           Item Descriptio
     C                     MOVEL*BLANK    $GR3CD           Department Code
     C                     Z-ADDWBBPPR    $GBPPR           Production Yiel
     C                     Z-ADD*ZERO     $GORND           Weight Order Ne
     C                     Z-ADD*ZERO     $GD6PC           Production Yiel
     C                     Z-ADD*ZERO     $GWTUP           Weight UPS USR
     C                     Z-ADD*ZERO     $GE7WG           Weight Availabl
     C                     Z-ADD*ZERO     $GWTUS           Weight 9.2 USR
     C                     Z-ADDWBBOPR    $GBOPR           Sales Yield
     C                     Z-ADDWBHGQT    $GHGQT           Packaging Quant
     C                     MOVELWBHHCD    $GHHCD           U/M - Primary D
     C                     MOVELWBYAST    $GYAST           Average if WPA
     C                     Z-ADDWBCNSM    $GCNSM           Consume Priorit
     C                     Z-ADDWBBMY1    $GBMY1           Consume Priorit
     C                     Z-ADDWBBMY2    $GBMY2           BOM Unused % 2
     C                     Z-ADDWBIXQT    $GIXQT           BOM Unused Qty
     C                     Z-ADDWBIYQT    $GIYQT           BOM Unused Qty
     C                     MOVELWBRSST    $GRSST           BOM Unused Sts
     C                     MOVELWBRTST    $GRTST           BOM Unused Sts
     C                     MOVELWBUVST    $GUVST           EDI Status 1
     C                     MOVELWBUWST    $GUWST           EDI Status 2
     C                     MOVELWBUXST    $GUXST           EDI Status 3
     C                     MOVELWBVSST    $GVSST           Record Status
     C                     Z-ADDWBAATM    $GAATM           Job Time
     C                     MOVELWBAYNA    $GAYNA           User Id
     C                     MOVELWBA0NA    $GA0NA           Job Name
     C                     Z-ADDWBAXDT    $GAXDT           Job Date
      * USER: Process before print of detail format
      * CUR = PAR By name
     C                     Z-ADD$EAIC3    $GAIC3           Company Number
     C                     Z-ADD$EHGCD    $GHGCD           Item Code
     C                     Z-ADD$EORND    $GORND           Weight Order Ne
     C                     Z-ADDWN0086    $GWTUS           Weight 9.2 USR
      * Consumed Weight Availability.
      * CASE: DB1.BOM Type is Consumed - Meat
     C           WBV2ST    IFEQ 'C'                        *IF
      * RE-Process
      * CASE: PAR.BOM Process USR is Re-Process
     C           'F'       IFEQ 'R'                        *IF
      * CASE: WRK.Weight Scheduled LT PAR.Weight Order Needs USR
     C           WUAUWG    IFLT $EORND                     *IF
     C                     Z-ADDWUE6WG    $GORND           Weight Order Ne
     C                     Z-ADD100       $GBPPR           Production Yiel
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD$EORND    $GORND           Weight Order Ne
     C                     END                             *FI
      * CASE: CUR.Production Yield is Greater than zero
     C           $GBPPR    IFGT *ZERO                      *IF
      * Weight Order Needs USR
      * CUR.Weight Order Needs USR =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : CUR.Weight Order Needs USR
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.Production Yield
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           $GBPPR    DIV  100       W0WD01    H      *Synon (17,7) w
     C           $GORND    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $GORND           Weight Order Ne
      * Rtv Item Prod Yield   RT - PD Item Bill Of Material  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$GAIC3    WL0012           Company Number
     C                     Z-ADD$GC9NB    WL0013           Item Code
     C                     Z-ADD$GC9NB    WL0014           Component Item
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0015    $GD6PC           Production Yiel
     C                     MOVELWL0016    WUWXST    P      Record Found US
      * Consumed Availabilty
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Record Found USR is Record Found
      *   |- c2    : CUR.Production Yield USR is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUWXST    IFEQ 'Y'                        *IF
     C           $GD6PC    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Starting Weight
      * CUR.Weight UPS USR =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.Weight Order Needs USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.Production Yield USR
      * /     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           $GD6PC    DIV  100       W0WD01           *Synon (17,7) w
     C           $GORND    DIV  W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $GWTUP           Weight UPS USR
      * UPS Rtv RM Avail      XF - PS Production Detail  * 
     C                     CALL 'PDCMXFR'              90  UPS Rtv RM Avai
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $GAIC3    WQ0001  30       Company Number
     C                     PARM $EV5ST    WQ0002  1        Production Type
     C                     PARM $EELDT    WQ0003  70       Production Date
     C                     PARM $GC9NB    WQ0004  70       Item Code
     C           $GE7WG    PARM $GE7WG    WQ0005  92       Weight Availabl
     C           WURFPD    PARM *BLANK    WQ0006  1        Record Found -P
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: CUR.Weight Order Needs USR LT CUR.Weight Available USR
     C           $GORND    IFLT $GE7WG                     *IF
     C                     Z-ADD$GORND    $GWTUS           Weight 9.2 USR
     C                     ADD  $GORND    WN0086           Weight 9.2 USR
     C                     ADD  $GORND    WUE1WG           Weight Allocate
     C                     Z-ADD$GORND    WUAUWG           Weight Schedule
     C                     ADD  $GORND    WN0001           Weight Consumed
     C                     SUB  $GORND    WUE6WG           Weight Total Ne
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD$GE7WG    $GWTUS           Weight 9.2 USR
     C                     ADD  $GE7WG    WN0086           Weight 9.2 USR
     C                     ADD  $GE7WG    WUE1WG           Weight Allocate
     C                     Z-ADD$GE7WG    WUAUWG           Weight Schedule
     C                     ADD  $GE7WG    WN0001           Weight Consumed
     C                     SUB  $GE7WG    WUE6WG           Weight Total Ne
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     $GORND           Weight Order Ne
     C                     END                             *FI
      * CUR.Condition Name USR = Condition name of DB1.BOM Type
     C                     CALL 'CARVCNR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1260923   Y2LSNO  70       List number
     C                     PARM WBV2ST    W0INVL 25        BOM Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $GGUTX    PARM           W0CNNM 25        Condition Name
      *
      * UPS Setup Item Info   XF - PS Prod Item Schedule  * 
     C                     CALL 'PDCLXFR'              90  UPS Setup Item
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $GAIC3    WQ0007  30       Company Number
     C                     PARM $GC9NB    WQ0008  70       Item Code
     C           $GGENA    PARM *BLANK    WQ0009 30        Description Lin
     C           WUADCD    PARM WUADCD    WQ0010  2        U/M - Primary
     C           WUAIWG    PARM WUAIWG    WQ0011 112       Unit Weight
     C           WURINB    PARM WURINB    WQ0012  30       Item Structure
     C           WURHNB    PARM WURHNB    WQ0013  30       Item Structure
     C           WURGNB    PARM WURGNB    WQ0014  30       Item Structure
     C           WN0081    PARM WN0081    WQ0015  3        Item Type Code
     C           WN0082    PARM WN0082    WQ0016  3        Default Warehou
     C           WUCHTM    PARM WUCHTM    WQ0017  52       Fresh Chilling
     C           WN0083    PARM WN0083    WQ0018  2        Base/Conv/Loss
     C           WN0084    PARM WN0084    WQ0019  1        Variety/Rendere
     C           WN0085    PARM WN0085    WQ0020  1        Credit Item Sta
     C           WUSWGH    PARM WUSWGH    WQ0021 112       Std Weight/Head
     C           WUPPHE    PARM WUPPHE    WQ0022  70       Pieces Per Head
     C           $GR3CD    PARM $GR3CD    WQ0023  6        Department Code
     C           WUSDCD    PARM WUSDCD    WQ0024  1        Group for Packa
     C           WUX5ST    PARM WUX5ST    WQ0025  1        Seconds Item
     C                     PARM $EAJCD    WQ0026  3        Warehouse Code
     C           WUWPST    PARM *BLANK    WQ0027  2        Warehouse Type
     C           WUWCST    PARM *BLANK    WQ0028  3        PS Item Id
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Allocate Weight for Consumed Items.
      * CASE: DB1.BOM Type is Consumed - Meat
     C           WBV2ST    IFEQ 'C'                        *IF
      * Allocate Weight
      * CASE: CUR.Weight 9.2 USR GT WRK.Weight Scheduled
     C           $GWTUS    IFGT WUAUWG                     *IF
     C                     Z-ADDWUAUWG    $GWTUS           Weight 9.2 USR
     C                     Z-ADD*ZERO     WUAUWG           Weight Schedule
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  $GWTUS    WUAUWG           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * Allocate Weight for Produced Items.
      * CASE: DB1.BOM Type is Produced - Meat
     C           WBV2ST    IFEQ 'P'                        *IF
     C           $GBPPR    DIV  100       WUD4PC           Percent 7.4 USR
     C           WN0086    MULT WUD4PC    $GWTUS    H      Weight 9.2 USR
      * Allocate Weight
      * CASE: CUR.Weight 9.2 USR GT WRK.Weight Allocated USR
     C           $GWTUS    IFGT WUE1WG                     *IF
     C                     Z-ADDWUE1WG    $GWTUS           Weight 9.2 USR
     C                     Z-ADD*ZERO     WUE1WG           Weight Allocate
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  $GWTUS    WUE1WG           Weight Allocate
     C                     END                             *FI
     C                     END                             *FI
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : UPS BOM Consume RM    PO
     C                     EXSR UCSUBR                     Embedded PRTOBJ
      * USER: Process after print of detail format
      * CASE: PAR.Item Code EQ CUR.Component Item Code
     C           $EHGCD    IFEQ $GC9NB                     *IF
     C                     MOVEL$EAJCD    WN0082           Default Warehou
     C                     END                             *FI
      * UPS BOM Cnv/Fab Upd   XF - PS Prod Item Schedule  * 
     C                     CALL 'PDN5XFR'              90  UPS BOM Cnv/Fab
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0082    WQ0062  3        Warehouse Code
     C                     PARM $EAIC3    WQ0063  30       Company Number
     C                     PARM $EHGCD    WQ0064  70       Item Code
     C                     PARM $EELDT    WQ0065  70       Production Date
     C                     PARM $EV5ST    WQ0066  1        Production Type
     C                     PARM $GC9NB    WQ0067  70       Component Item
     C                     PARM 'N'       WQ0068  1        PS Process Cont
     C                     PARM WBV2ST    WQ0069  1        BOM Type
     C                     PARM $GWTUS    WQ0070  92       Weight 9.2 USR
     C                     PARM WN0081    WQ0071  3        Item Type Code
     C                     PARM $CDPT1    WQ0072  1        Department Type
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDN5XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *
      *================================================================
     CSR         C2EXIT    ENDSR
      /EJECT
     CSR         C3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN WBAIC3    WZC001           Company Number
     C                     Z-ADDWBAIC3    WZC001
     C           *LIKE     DEFN WBHGCD    WZC002           Item Code
     C                     Z-ADDWBHGCD    WZC002
     C           *LIKE     DEFN WBV2ST    WZC003           BOM Type
     C                     MOVELWBV2ST    WZC003
     C           *LIKE     DEFN WBCNSM    WZC004           Consume Priorit
     C                     Z-ADDWBCNSM    WZC004
     C           *LIKE     DEFN WBC9NB    WZC005           Component Item
     C                     Z-ADDWBC9NB    WZC005
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFC    OREQ '1'
     C           KRSC      READE@IOREGB                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFC  1
      * Quit if no record read
     C           W0EOFC    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0CL00  1        Company Number
     C                     MOVEL*BLANK    W0CL01  1        Item Code
     C                     MOVEL*BLANK    W0CL02  1        BOM Type
     C                     MOVEL*BLANK    W0CL03  1        Consume Priorit
     C                     MOVEL*BLANK    W0CL04  1        Component Item
     C           W0EOFC    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0CL00  1        Company Number
     C                     MOVEL'Y'       W0CL01  1        Item Code
     C                     MOVEL'Y'       W0CL02  1        BOM Type
     C                     MOVEL'Y'       W0CL03  1        Consume Priorit
     C                     MOVEL'Y'       W0CL04  1        Component Item
     C                     ELSE
      * Next record - Detect level breaks
     C           WBAIC3    IFNE WZC001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL00
     C                     END
     C           WBHGCD    IFNE WZC002                     Item Code
     C           W0CL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL01
     C                     END
     C           WBV2ST    IFNE WZC003                     BOM Type
     C           W0CL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL02
     C                     END
     C           WBCNSM    IFNE WZC004                     Consume Priorit
     C           W0CL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL03
     C                     END
     C           WBC9NB    IFNE WZC005                     Component Item
     C           W0CL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL04
     C                     END
     C                     END
      *================================================================
     CSR         C3EXIT    ENDSR
      /EJECT
     CSR         C4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0CL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP04
     C                     END
      *
     C           W0CL03    IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$JKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP03
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP02
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP01
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP00
     C                     END
      *
     C           W0EOFC    IFEQ '1'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$KFINTTL
     C                     END
      *
      *================================================================
     CSR         C4EXIT    ENDSR
      /EJECT
     CSR         D0MAIN    BEGSR
      *================================================================
      * UPS BOM Cnsm RM Fab   PO: Mainline
      *================================================================
      * UPS BOM Cnsm RM Fab   PO: Initialise
     C                     EXSR ZDINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQKD01           Company Number
     C           *LIKE     DEFN WCHGCD    WQKD02           Item Code
      * Define keylist
     C           KRSD      KLIST
     C                     KFLD           WQKD01           Company Number
     C                     KFLD           WQKD02           Item Code
      * Setup key
     C                     Z-ADD$GAIC3    WQKD01           Company Number
     C                     Z-ADD$GC9NB    WQKD02           Item Code
      * Establish starting position
     C           KRSD      SETLL@IORENS                    *
      * Read first record with user selection
     C                     EXSR D3READ
     C           W0EOFD    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0DL1P  1        First page
     C                     MOVEL'Y'       W0DL00  1        Company Number
     C                     MOVEL'Y'       W0DL01  1        Item Code
     C                     MOVEL'Y'       W0DL02  1        BOM Type
     C                     MOVEL'Y'       W0DL03  1        Component Item
      * Set column headings flag
     C                     MOVE 'Y'       W0DCDT
      * Print report body
     C           W0EOFD    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR D1PHDR
      * Print report detail line
     C                     EXSR D2PDTL
      * Read next record with user selection
     C                     EXSR D3READ
      * Print totals
     C                     EXSR D4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         D0EXIT    ENDSR
      /EJECT
     CSR         D1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0DL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP1P  1
     C                     END
      *
     C           W0DL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP00  1
     C                     END
      *
     C           W0DL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP01  1
     C                     END
      *
     C           W0DL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP02  1
     C                     END
      *
     C           W0DL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP03  1
     C                     END
      *
      *================================================================
     CSR         D1EXIT    ENDSR
      /EJECT
     CSR         D2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDWCAIC3    $HAIC3           Company Number
     C                     Z-ADDWCHGCD    $HHGCD           Item Code
     C                     MOVELWCV2ST    $HV2ST           BOM Type
     C                     MOVEL*BLANK    $HGUTX           Condition Name
     C                     Z-ADDWCC9NB    $HC9NB           Component Item
     C                     MOVEL*BLANK    $HGENA           Item Descriptio
     C                     MOVEL*BLANK    $HR3CD           Department Code
     C                     Z-ADDWCBPPR    $HBPPR           Production Yiel
     C                     Z-ADD*ZERO     $HORND           Weight Order Ne
     C                     Z-ADD*ZERO     $HAVWT           PS Weight Avail
     C                     Z-ADD*ZERO     $HWTUS           Weight 9.2 USR
     C                     Z-ADDWCBOPR    $HBOPR           Sales Yield
     C                     Z-ADDWCHGQT    $HHGQT           Packaging Quant
     C                     MOVELWCHHCD    $HHHCD           U/M - Primary D
     C                     MOVELWCYAST    $HYAST           Average if WPA
     C                     Z-ADDWCCNSM    $HCNSM           Consume Priorit
     C                     Z-ADDWCBMY1    $HBMY1           Consume Priorit
     C                     Z-ADDWCBMY2    $HBMY2           BOM Unused % 2
     C                     Z-ADDWCIXQT    $HIXQT           BOM Unused Qty
     C                     Z-ADDWCIYQT    $HIYQT           BOM Unused Qty
     C                     MOVELWCRSST    $HRSST           BOM Unused Sts
     C                     MOVELWCRTST    $HRTST           BOM Unused Sts
     C                     MOVELWCUVST    $HUVST           EDI Status 1
     C                     MOVELWCUWST    $HUWST           EDI Status 2
     C                     MOVELWCUXST    $HUXST           EDI Status 3
     C                     MOVELWCVSST    $HVSST           Record Status
     C                     Z-ADDWCAATM    $HAATM           Job Time
     C                     MOVELWCAYNA    $HAYNA           User Id
     C                     MOVELWCA0NA    $HA0NA           Job Name
     C                     Z-ADDWCAXDT    $HAXDT           Job Date
      * USER: Process before print of detail format
      * CUR.Condition Name USR = Condition name of DB1.BOM Type
     C                     CALL 'CARVCNR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1260923   Y2LSNO  70       List number
     C                     PARM WCV2ST    W0INVL 25        BOM Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $HGUTX    PARM           W0CNNM 25        Condition Name
      *
      * UPS Setup Item Info   XF - PS Production Detail  * 
     C                     CALL 'PDCLXFR'              90  UPS Setup Item
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $HAIC3    WQ0029  30       Company Number
     C                     PARM $HC9NB    WQ0030  70       Item Code
     C           $HGENA    PARM *BLANK    WQ0031 30        Description Lin
     C           WUADCD    PARM WUADCD    WQ0032  2        U/M - Primary
     C           WUAIWG    PARM WUAIWG    WQ0033 112       Unit Weight
     C           WURINB    PARM WURINB    WQ0034  30       Item Structure
     C           WURHNB    PARM WURHNB    WQ0035  30       Item Structure
     C           WURGNB    PARM WURGNB    WQ0036  30       Item Structure
     C           WUN0CD    PARM WUN0CD    WQ0037  3        Item Type Code
     C           WN0087    PARM WN0087    WQ0038  3        Default Warehou
     C           WUCHTM    PARM WUCHTM    WQ0039  52       Fresh Chilling
     C           WN0088    PARM WN0088    WQ0040  2        Base/Conv/Loss
     C           WN0089    PARM WN0089    WQ0041  1        Variety/Rendere
     C           WN0090    PARM WN0090    WQ0042  1        Credit Item Sta
     C           WUSWGH    PARM WUSWGH    WQ0043 112       Std Weight/Head
     C           WUPPHE    PARM WUPPHE    WQ0044  70       Pieces Per Head
     C           $HR3CD    PARM $HR3CD    WQ0045  6        Department Code
     C           WUSDCD    PARM WUSDCD    WQ0046  1        Group for Packa
     C           WUX5ST    PARM WUX5ST    WQ0047  1        Seconds Item
     C                     PARM $EAJCD    WQ0048  3        Warehouse Code
     C           WUWPST    PARM *BLANK    WQ0049  2        Warehouse Type
     C           WUWCST    PARM *BLANK    WQ0050  3        PS Item Id
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C           $HBPPR    DIV  100       WUD4PC           Percent 7.4 USR
      * CASE: DB1.BOM Type is Consumed - Meat
     C           WCV2ST    IFEQ 'C'                        *IF
     C           $GWTUS    MULT WUD4PC    $HORND    H      Weight Order Ne
     C                     ELSE
      * CASE: DB1.BOM Type is Produced - Meat
     C           WCV2ST    IFEQ 'P'                        *IF
     C           WN0091    MULT WUD4PC    $HWTUS    H      Weight 9.2 USR
     C                     END                             *FI
     C                     END                             *FI
      * Allocate Weight for Consumed Items.
      * CASE: DB1.BOM Type is Consumed - Meat
     C           WCV2ST    IFEQ 'C'                        *IF
      * Rtv with Initializing of the Weight Available
      * UPS Rtv Raw Mtrl Avl  RT - PS Production Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$HAIC3    WL0023           Company Number
     C                     MOVEL$EV5ST    WL0024    P      Production Type
     C                     Z-ADD$EELDT    WL0025           Production Date
     C                     Z-ADD$HC9NB    WL0026           Item Code
     C                     Z-ADD$HAVWT    WL0027           PS Weight Avail
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0027    $HAVWT           PS Weight Avail
      * Raw Material Consumption
      * CASE: CUR.Weight Order Needs USR GT CUR.PS Weight Avail Prod
     C           $HORND    IFGT $HAVWT                     *IF
     C                     Z-ADD$HAVWT    $HWTUS           Weight 9.2 USR
     C                     ADD  $HAVWT    WN0091           Weight Consumed
     C                     ELSE
      * CASE: CUR.Weight Order Needs USR LE CUR.PS Weight Avail Prod
     C           $HORND    IFLE $HAVWT                     *IF
     C                     Z-ADD$HORND    $HWTUS           Weight 9.2 USR
     C                     ADD  $HORND    WN0091           Weight Consumed
     C                     END                             *FI
     C                     END                             *FI
      * Allocate Weight
      * CASE: CUR.Weight 9.2 USR GT WRK.Weight Scheduled
     C           $HWTUS    IFGT WUAUWG                     *IF
     C                     Z-ADDWUAUWG    $HWTUS           Weight 9.2 USR
     C                     Z-ADD*ZERO     WUAUWG           Weight Schedule
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  $HWTUS    WUAUWG           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * USER: Process after print of detail format
      * UPS BOM Consm RM Upd  XF - PS Production Detail  * 
     C                     CALL 'PDN6XFR'              90  UPS BOM Consm R
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $EAJCD    WQ0051  3        Warehouse Code
     C                     PARM $GAIC3    WQ0052  30       Company Number
     C                     PARM $GC9NB    WQ0053  70       Item Code
     C                     PARM $EELDT    WQ0054  70       Production Date
     C                     PARM $EV5ST    WQ0055  1        Production Type
     C                     PARM $HC9NB    WQ0056  70       Component Item
     C                     PARM 'R'       WQ0057  1        PS Process Cont
     C                     PARM WCV2ST    WQ0058  1        BOM Type
     C                     PARM $HWTUS    WQ0059  92       Weight 9.2 USR
     C                     PARM $CDPT1    WQ0060  1        Department Type
     C                     PARM WN0087    WQ0061  3        Default Warehou
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDN6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *
      *================================================================
     CSR         D2EXIT    ENDSR
      /EJECT
     CSR         D3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN WCAIC3    WZD001           Company Number
     C                     Z-ADDWCAIC3    WZD001
     C           *LIKE     DEFN WCHGCD    WZD002           Item Code
     C                     Z-ADDWCHGCD    WZD002
     C           *LIKE     DEFN WCV2ST    WZD003           BOM Type
     C                     MOVELWCV2ST    WZD003
     C           *LIKE     DEFN WCC9NB    WZD004           Component Item
     C                     Z-ADDWCC9NB    WZD004
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFD    OREQ '1'
     C           KRSD      READE@IORENS                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFD  1
      * Quit if no record read
     C           W0EOFD    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0DL00  1        Company Number
     C                     MOVEL*BLANK    W0DL01  1        Item Code
     C                     MOVEL*BLANK    W0DL02  1        BOM Type
     C                     MOVEL*BLANK    W0DL03  1        Component Item
     C           W0EOFD    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0DL00  1        Company Number
     C                     MOVEL'Y'       W0DL01  1        Item Code
     C                     MOVEL'Y'       W0DL02  1        BOM Type
     C                     MOVEL'Y'       W0DL03  1        Component Item
     C                     ELSE
      * Next record - Detect level breaks
     C           WCAIC3    IFNE WZD001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL00
     C                     END
     C           WCHGCD    IFNE WZD002                     Item Code
     C           W0DL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL01
     C                     END
     C           WCV2ST    IFNE WZD003                     BOM Type
     C           W0DL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL02
     C                     END
     C           WCC9NB    IFNE WZD004                     Component Item
     C           W0DL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL03
     C                     END
     C                     END
      *================================================================
     CSR         D3EXIT    ENDSR
      /EJECT
     CSR         D4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0DL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP03
     C                     END
      *
     C           W0DL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP02
     C                     END
      *
     C           W0DL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP01
     C                     END
      *
     C           W0DL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP00
     C                     END
      *
     C           W0EOFD    IFEQ '1'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$IFINTTL
     C                     END
      *
      *================================================================
     CSR         D4EXIT    ENDSR
      /EJECT
     CSR         E0MAIN    BEGSR
      *================================================================
      * UPS BOM Conv/Fab Dept PO: Mainline
      *================================================================
      * UPS BOM Conv/Fab Dept PO: Initialise
     C                     EXSR ZEINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQKE01           Company Number
     C           *LIKE     DEFN WBHGCD    WQKE02           Item Code
      * Define keylist
     C           KRSE      KLIST
     C                     KFLD           WQKE01           Company Number
     C                     KFLD           WQKE02           Item Code
      * Setup key
     C                     Z-ADD$RAIC3    WQKE01           Company Number
     C                     Z-ADD$EHGCD    WQKE02           Item Code
      * Establish starting position
     C           KRSE      SETLL@IOREGB                    *
      * Read first record with user selection
     C                     EXSR E3READ
     C           W0EOFE    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0EL1P  1        First page
     C                     MOVEL'Y'       W0EL00  1        Company Number
     C                     MOVEL'Y'       W0EL01  1        Item Code
     C                     MOVEL'Y'       W0EL02  1        BOM Type
     C                     MOVEL'Y'       W0EL03  1        Consume Priorit
     C                     MOVEL'Y'       W0EL04  1        Component Item
      * Set column headings flag
     C                     MOVE 'Y'       W0ECDT
      * Print report body
     C           W0EOFE    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR E1PHDR
      * Print report detail line
     C                     EXSR E2PDTL
      * Read next record with user selection
     C                     EXSR E3READ
      * Print totals
     C                     EXSR E4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         E0EXIT    ENDSR
      /EJECT
     CSR         E1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0EL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP1P  1
     C                     END
      *
     C           W0EL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP00  1
     C                     END
      *
     C           W0EL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP01  1
     C                     END
      *
     C           W0EL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP02  1
     C                     END
      *
     C           W0EL03    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDWBAIC3    $LAIC3           Company Number
     C                     Z-ADDWBHGCD    $LHGCD           Item Code
     C                     MOVELWBV2ST    $LV2ST           BOM Type
     C                     Z-ADDWBCNSM    $LCNSM           Consume Priorit
      * Load related totals format
     C                     Z-ADDWBAIC3    $PAIC3           Company Number
     C                     Z-ADDWBHGCD    $PHGCD           Item Code
     C                     MOVELWBV2ST    $PV2ST           BOM Type
     C                     Z-ADDWBCNSM    $PCNSM           Consume Priorit
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP03  1
     C                     END
      *
     C           W0EL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP04  1
     C                     END
      *
      *================================================================
     CSR         E1EXIT    ENDSR
      /EJECT
     CSR         E2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDWBAIC3    $MAIC3           Company Number
     C                     Z-ADDWBHGCD    $MHGCD           Item Code
     C                     MOVELWBV2ST    $MV2ST           BOM Type
     C                     MOVEL*BLANK    $MGUTX           Condition Name
     C                     Z-ADDWBC9NB    $MC9NB           Component Item
     C                     MOVEL*BLANK    $MGENA           Item Descriptio
     C                     MOVEL*BLANK    $MR3CD           Department Code
     C                     Z-ADDWBBPPR    $MBPPR           Production Yiel
     C                     Z-ADD*ZERO     $MORND           Weight Order Ne
     C                     Z-ADD*ZERO     $MD6PC           Production Yiel
     C                     Z-ADD*ZERO     $MWTUP           Weight UPS USR
     C                     Z-ADD*ZERO     $ME7WG           Weight Availabl
     C                     Z-ADD*ZERO     $MWTUS           Weight 9.2 USR
     C                     Z-ADDWBBOPR    $MBOPR           Sales Yield
     C                     Z-ADDWBHGQT    $MHGQT           Packaging Quant
     C                     MOVELWBHHCD    $MHHCD           U/M - Primary D
     C                     MOVELWBYAST    $MYAST           Average if WPA
     C                     Z-ADDWBCNSM    $MCNSM           Consume Priorit
     C                     Z-ADDWBBMY1    $MBMY1           Consume Priorit
     C                     Z-ADDWBBMY2    $MBMY2           BOM Unused % 2
     C                     Z-ADDWBIXQT    $MIXQT           BOM Unused Qty
     C                     Z-ADDWBIYQT    $MIYQT           BOM Unused Qty
     C                     MOVELWBRSST    $MRSST           BOM Unused Sts
     C                     MOVELWBRTST    $MRTST           BOM Unused Sts
     C                     MOVELWBUVST    $MUVST           EDI Status 1
     C                     MOVELWBUWST    $MUWST           EDI Status 2
     C                     MOVELWBUXST    $MUXST           EDI Status 3
     C                     MOVELWBVSST    $MVSST           Record Status
     C                     Z-ADDWBAATM    $MAATM           Job Time
     C                     MOVELWBAYNA    $MAYNA           User Id
     C                     MOVELWBA0NA    $MA0NA           Job Name
     C                     Z-ADDWBAXDT    $MAXDT           Job Date
      * USER: Process before print of detail format
      * CUR = PAR By name
     C                     Z-ADD$RAIC3    $MAIC3           Company Number
     C                     Z-ADD$EHGCD    $MHGCD           Item Code
     C                     Z-ADDWUORND    $MORND           Weight Order Ne
     C                     Z-ADDWN0097    $MWTUS           Weight 9.2 USR
      * Consumed Weight Availability.
      * CASE: DB1.BOM Type is Consumed - Meat
     C           WBV2ST    IFEQ 'C'                        *IF
      * RE-Process
      * CASE: PAR.BOM Process USR is Re-Process
     C           'R'       IFEQ 'R'                        *IF
      * CASE: WRK.Weight Scheduled LT PAR.Weight Order Needs USR
     C           WUAUWG    IFLT WUORND                     *IF
     C                     Z-ADDWUE6WG    $MORND           Weight Order Ne
     C                     Z-ADD100       $MBPPR           Production Yiel
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWUORND    $MORND           Weight Order Ne
     C                     END                             *FI
      * CASE: CUR.Production Yield is Greater than zero
     C           $MBPPR    IFGT *ZERO                      *IF
      * Weight Order Needs USR
      * CUR.Weight Order Needs USR =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : CUR.Weight Order Needs USR
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.Production Yield
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           $MBPPR    DIV  100       W0WD01    H      *Synon (17,7) w
     C           $MORND    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $MORND           Weight Order Ne
      * Rtv Item Prod Yield   RT - PD Item Bill Of Material  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$MAIC3    WL0012           Company Number
     C                     Z-ADD$MC9NB    WL0013           Item Code
     C                     Z-ADD$MC9NB    WL0014           Component Item
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0015    $MD6PC           Production Yiel
     C                     MOVELWL0016    WUWXST    P      Record Found US
      * Consumed Availabilty
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Record Found USR is Record Found
      *   |- c2    : CUR.Production Yield USR is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUWXST    IFEQ 'Y'                        *IF
     C           $MD6PC    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Starting Weight
      * CUR.Weight UPS USR =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.Weight Order Needs USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.Production Yield USR
      * /     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           $MD6PC    DIV  100       W0WD01           *Synon (17,7) w
     C           $MORND    DIV  W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $MWTUP           Weight UPS USR
      * UPS Rtv RM Avail      XF - PS Production Detail  * 
     C                     CALL 'PDCMXFR'              90  UPS Rtv RM Avai
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $MAIC3    WQ0073  30       Company Number
     C                     PARM $EV5ST    WQ0074  1        Production Type
     C                     PARM $EELDT    WQ0075  70       Production Date
     C                     PARM $MC9NB    WQ0076  70       Item Code
     C           $ME7WG    PARM $ME7WG    WQ0077  92       Weight Availabl
     C           WURFPD    PARM *BLANK    WQ0078  1        Record Found -P
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: CUR.Weight Order Needs USR LT CUR.Weight Available USR
     C           $MORND    IFLT $ME7WG                     *IF
     C                     Z-ADD$MORND    $MWTUS           Weight 9.2 USR
     C                     ADD  $MORND    WN0097           Weight 9.2 USR
     C                     ADD  $MORND    WUE1WG           Weight Allocate
     C                     Z-ADD$MORND    WUAUWG           Weight Schedule
     C                     ADD  $MORND    WN0001           Weight Consumed
     C                     SUB  $MORND    WUE6WG           Weight Total Ne
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD$ME7WG    $MWTUS           Weight 9.2 USR
     C                     ADD  $ME7WG    WN0097           Weight 9.2 USR
     C                     ADD  $ME7WG    WUE1WG           Weight Allocate
     C                     Z-ADD$ME7WG    WUAUWG           Weight Schedule
     C                     ADD  $ME7WG    WN0001           Weight Consumed
     C                     SUB  $ME7WG    WUE6WG           Weight Total Ne
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     $MORND           Weight Order Ne
     C                     END                             *FI
      * CUR.Condition Name USR = Condition name of DB1.BOM Type
     C                     CALL 'CARVCNR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1260923   Y2LSNO  70       List number
     C                     PARM WBV2ST    W0INVL 25        BOM Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $MGUTX    PARM           W0CNNM 25        Condition Name
      *
      * UPS Setup Item Info   XF - PS Prod Item Schedule  * 
     C                     CALL 'PDCLXFR'              90  UPS Setup Item
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $MAIC3    WQ0079  30       Company Number
     C                     PARM $MC9NB    WQ0080  70       Item Code
     C           $MGENA    PARM *BLANK    WQ0081 30        Description Lin
     C           WUADCD    PARM WUADCD    WQ0082  2        U/M - Primary
     C           WUAIWG    PARM WUAIWG    WQ0083 112       Unit Weight
     C           WURINB    PARM WURINB    WQ0084  30       Item Structure
     C           WURHNB    PARM WURHNB    WQ0085  30       Item Structure
     C           WURGNB    PARM WURGNB    WQ0086  30       Item Structure
     C           WN0092    PARM WN0092    WQ0087  3        Item Type Code
     C           WN0093    PARM WN0093    WQ0088  3        Default Warehou
     C           WUCHTM    PARM WUCHTM    WQ0089  52       Fresh Chilling
     C           WN0094    PARM WN0094    WQ0090  2        Base/Conv/Loss
     C           WN0095    PARM WN0095    WQ0091  1        Variety/Rendere
     C           WN0096    PARM WN0096    WQ0092  1        Credit Item Sta
     C           WUSWGH    PARM WUSWGH    WQ0093 112       Std Weight/Head
     C           WUPPHE    PARM WUPPHE    WQ0094  70       Pieces Per Head
     C           $MR3CD    PARM $MR3CD    WQ0095  6        Department Code
     C           WUSDCD    PARM WUSDCD    WQ0096  1        Group for Packa
     C           WUX5ST    PARM WUX5ST    WQ0097  1        Seconds Item
     C                     PARM $EAJCD    WQ0098  3        Warehouse Code
     C           WUWPST    PARM *BLANK    WQ0099  2        Warehouse Type
     C           WUWCST    PARM *BLANK    WQ0100  3        PS Item Id
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Allocate Weight for Consumed Items.
      * CASE: DB1.BOM Type is Consumed - Meat
     C           WBV2ST    IFEQ 'C'                        *IF
      * Allocate Weight
      * CASE: CUR.Weight 9.2 USR GT WRK.Weight Scheduled
     C           $MWTUS    IFGT WUAUWG                     *IF
     C                     Z-ADDWUAUWG    $MWTUS           Weight 9.2 USR
     C                     Z-ADD*ZERO     WUAUWG           Weight Schedule
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  $MWTUS    WUAUWG           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * Allocate Weight for Produced Items.
      * CASE: DB1.BOM Type is Produced - Meat
     C           WBV2ST    IFEQ 'P'                        *IF
     C           $MBPPR    DIV  100       WUD4PC           Percent 7.4 USR
     C           WN0097    MULT WUD4PC    $MWTUS    H      Weight 9.2 USR
      * Allocate Weight
      * CASE: CUR.Weight 9.2 USR GT WRK.Weight Allocated USR
     C           $MWTUS    IFGT WUE1WG                     *IF
     C                     Z-ADDWUE1WG    $MWTUS           Weight 9.2 USR
     C                     Z-ADD*ZERO     WUE1WG           Weight Allocate
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  $MWTUS    WUE1WG           Weight Allocate
     C                     END                             *FI
     C                     END                             *FI
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : UPS BOM Consume RM    PO
     C                     EXSR UESUBR                     Embedded PRTOBJ
      * USER: Process after print of detail format
      * CASE: PAR.Item Code EQ CUR.Component Item Code
     C           $EHGCD    IFEQ $MC9NB                     *IF
     C                     MOVEL$EAJCD    WN0093           Default Warehou
     C                     END                             *FI
      * UPS BOM Cnv/Fab Upd   XF - PS Prod Item Schedule  * 
     C                     CALL 'PDN5XFR'              90  UPS BOM Cnv/Fab
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0093    WQ0134  3        Warehouse Code
     C                     PARM $RAIC3    WQ0135  30       Company Number
     C                     PARM $EHGCD    WQ0136  70       Item Code
     C                     PARM $EELDT    WQ0137  70       Production Date
     C                     PARM $EV5ST    WQ0138  1        Production Type
     C                     PARM $MC9NB    WQ0139  70       Component Item
     C                     PARM 'N'       WQ0140  1        PS Process Cont
     C                     PARM WBV2ST    WQ0141  1        BOM Type
     C                     PARM $MWTUS    WQ0142  92       Weight 9.2 USR
     C                     PARM WN0092    WQ0143  3        Item Type Code
     C                     PARM $CDPT1    WQ0144  1        Department Type
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDN5XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *
      *================================================================
     CSR         E2EXIT    ENDSR
      /EJECT
     CSR         E3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN WBAIC3    WZE001           Company Number
     C                     Z-ADDWBAIC3    WZE001
     C           *LIKE     DEFN WBHGCD    WZE002           Item Code
     C                     Z-ADDWBHGCD    WZE002
     C           *LIKE     DEFN WBV2ST    WZE003           BOM Type
     C                     MOVELWBV2ST    WZE003
     C           *LIKE     DEFN WBCNSM    WZE004           Consume Priorit
     C                     Z-ADDWBCNSM    WZE004
     C           *LIKE     DEFN WBC9NB    WZE005           Component Item
     C                     Z-ADDWBC9NB    WZE005
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFE    OREQ '1'
     C           KRSE      READE@IOREGB                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFE  1
      * Quit if no record read
     C           W0EOFE    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0EL00  1        Company Number
     C                     MOVEL*BLANK    W0EL01  1        Item Code
     C                     MOVEL*BLANK    W0EL02  1        BOM Type
     C                     MOVEL*BLANK    W0EL03  1        Consume Priorit
     C                     MOVEL*BLANK    W0EL04  1        Component Item
     C           W0EOFE    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0EL00  1        Company Number
     C                     MOVEL'Y'       W0EL01  1        Item Code
     C                     MOVEL'Y'       W0EL02  1        BOM Type
     C                     MOVEL'Y'       W0EL03  1        Consume Priorit
     C                     MOVEL'Y'       W0EL04  1        Component Item
     C                     ELSE
      * Next record - Detect level breaks
     C           WBAIC3    IFNE WZE001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0EL00
     C                     END
     C           WBHGCD    IFNE WZE002                     Item Code
     C           W0EL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0EL01
     C                     END
     C           WBV2ST    IFNE WZE003                     BOM Type
     C           W0EL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0EL02
     C                     END
     C           WBCNSM    IFNE WZE004                     Consume Priorit
     C           W0EL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0EL03
     C                     END
     C           WBC9NB    IFNE WZE005                     Component Item
     C           W0EL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0EL04
     C                     END
     C                     END
      *================================================================
     CSR         E3EXIT    ENDSR
      /EJECT
     CSR         E4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0EL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0EP04
     C                     END
      *
     C           W0EL03    IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$PKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0EP03
     C                     END
      *
     C           W0EL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0EP02
     C                     END
      *
     C           W0EL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0EP01
     C                     END
      *
     C           W0EL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0EP00
     C                     END
      *
     C           W0EOFE    IFEQ '1'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$QFINTTL
     C                     END
      *
      *================================================================
     CSR         E4EXIT    ENDSR
      /EJECT
     CSR         F0MAIN    BEGSR
      *================================================================
      * UPS BOM Cnsm RM Fab   PO: Mainline
      *================================================================
      * UPS BOM Cnsm RM Fab   PO: Initialise
     C                     EXSR ZFINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQKF01           Company Number
     C           *LIKE     DEFN WCHGCD    WQKF02           Item Code
      * Define keylist
     C           KRSF      KLIST
     C                     KFLD           WQKF01           Company Number
     C                     KFLD           WQKF02           Item Code
      * Setup key
     C                     Z-ADD$MAIC3    WQKF01           Company Number
     C                     Z-ADD$MC9NB    WQKF02           Item Code
      * Establish starting position
     C           KRSF      SETLL@IORENS                    *
      * Read first record with user selection
     C                     EXSR F3READ
     C           W0EOFF    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0FL1P  1        First page
     C                     MOVEL'Y'       W0FL00  1        Company Number
     C                     MOVEL'Y'       W0FL01  1        Item Code
     C                     MOVEL'Y'       W0FL02  1        BOM Type
     C                     MOVEL'Y'       W0FL03  1        Component Item
      * Set column headings flag
     C                     MOVE 'Y'       W0FCDT
      * Print report body
     C           W0EOFF    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR F1PHDR
      * Print report detail line
     C                     EXSR F2PDTL
      * Read next record with user selection
     C                     EXSR F3READ
      * Print totals
     C                     EXSR F4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         F0EXIT    ENDSR
      /EJECT
     CSR         F1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0FL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FP1P  1
     C                     END
      *
     C           W0FL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FP00  1
     C                     END
      *
     C           W0FL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FP01  1
     C                     END
      *
     C           W0FL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FP02  1
     C                     END
      *
     C           W0FL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FP03  1
     C                     END
      *
      *================================================================
     CSR         F1EXIT    ENDSR
      /EJECT
     CSR         F2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDWCAIC3    $NAIC3           Company Number
     C                     Z-ADDWCHGCD    $NHGCD           Item Code
     C                     MOVELWCV2ST    $NV2ST           BOM Type
     C                     MOVEL*BLANK    $NGUTX           Condition Name
     C                     Z-ADDWCC9NB    $NC9NB           Component Item
     C                     MOVEL*BLANK    $NGENA           Item Descriptio
     C                     MOVEL*BLANK    $NR3CD           Department Code
     C                     Z-ADDWCBPPR    $NBPPR           Production Yiel
     C                     Z-ADD*ZERO     $NORND           Weight Order Ne
     C                     Z-ADD*ZERO     $NAVWT           PS Weight Avail
     C                     Z-ADD*ZERO     $NWTUS           Weight 9.2 USR
     C                     Z-ADDWCBOPR    $NBOPR           Sales Yield
     C                     Z-ADDWCHGQT    $NHGQT           Packaging Quant
     C                     MOVELWCHHCD    $NHHCD           U/M - Primary D
     C                     MOVELWCYAST    $NYAST           Average if WPA
     C                     Z-ADDWCCNSM    $NCNSM           Consume Priorit
     C                     Z-ADDWCBMY1    $NBMY1           Consume Priorit
     C                     Z-ADDWCBMY2    $NBMY2           BOM Unused % 2
     C                     Z-ADDWCIXQT    $NIXQT           BOM Unused Qty
     C                     Z-ADDWCIYQT    $NIYQT           BOM Unused Qty
     C                     MOVELWCRSST    $NRSST           BOM Unused Sts
     C                     MOVELWCRTST    $NRTST           BOM Unused Sts
     C                     MOVELWCUVST    $NUVST           EDI Status 1
     C                     MOVELWCUWST    $NUWST           EDI Status 2
     C                     MOVELWCUXST    $NUXST           EDI Status 3
     C                     MOVELWCVSST    $NVSST           Record Status
     C                     Z-ADDWCAATM    $NAATM           Job Time
     C                     MOVELWCAYNA    $NAYNA           User Id
     C                     MOVELWCA0NA    $NA0NA           Job Name
     C                     Z-ADDWCAXDT    $NAXDT           Job Date
      * USER: Process before print of detail format
      * CUR.Condition Name USR = Condition name of DB1.BOM Type
     C                     CALL 'CARVCNR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1260923   Y2LSNO  70       List number
     C                     PARM WCV2ST    W0INVL 25        BOM Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $NGUTX    PARM           W0CNNM 25        Condition Name
      *
      * UPS Setup Item Info   XF - PS Production Detail  * 
     C                     CALL 'PDCLXFR'              90  UPS Setup Item
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $NAIC3    WQ0101  30       Company Number
     C                     PARM $NC9NB    WQ0102  70       Item Code
     C           $NGENA    PARM *BLANK    WQ0103 30        Description Lin
     C           WUADCD    PARM WUADCD    WQ0104  2        U/M - Primary
     C           WUAIWG    PARM WUAIWG    WQ0105 112       Unit Weight
     C           WURINB    PARM WURINB    WQ0106  30       Item Structure
     C           WURHNB    PARM WURHNB    WQ0107  30       Item Structure
     C           WURGNB    PARM WURGNB    WQ0108  30       Item Structure
     C           WUN0CD    PARM WUN0CD    WQ0109  3        Item Type Code
     C           WN0098    PARM WN0098    WQ0110  3        Default Warehou
     C           WUCHTM    PARM WUCHTM    WQ0111  52       Fresh Chilling
     C           WN0099    PARM WN0099    WQ0112  2        Base/Conv/Loss
     C           WN0100    PARM WN0100    WQ0113  1        Variety/Rendere
     C           WN0101    PARM WN0101    WQ0114  1        Credit Item Sta
     C           WUSWGH    PARM WUSWGH    WQ0115 112       Std Weight/Head
     C           WUPPHE    PARM WUPPHE    WQ0116  70       Pieces Per Head
     C           $NR3CD    PARM $NR3CD    WQ0117  6        Department Code
     C           WUSDCD    PARM WUSDCD    WQ0118  1        Group for Packa
     C           WUX5ST    PARM WUX5ST    WQ0119  1        Seconds Item
     C                     PARM $EAJCD    WQ0120  3        Warehouse Code
     C           WUWPST    PARM *BLANK    WQ0121  2        Warehouse Type
     C           WUWCST    PARM *BLANK    WQ0122  3        PS Item Id
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C           $NBPPR    DIV  100       WUD4PC           Percent 7.4 USR
      * CASE: DB1.BOM Type is Consumed - Meat
     C           WCV2ST    IFEQ 'C'                        *IF
     C           $MWTUS    MULT WUD4PC    $NORND    H      Weight Order Ne
     C                     ELSE
      * CASE: DB1.BOM Type is Produced - Meat
     C           WCV2ST    IFEQ 'P'                        *IF
     C           WN0102    MULT WUD4PC    $NWTUS    H      Weight 9.2 USR
     C                     END                             *FI
     C                     END                             *FI
      * Allocate Weight for Consumed Items.
      * CASE: DB1.BOM Type is Consumed - Meat
     C           WCV2ST    IFEQ 'C'                        *IF
      * Rtv with Initializing of the Weight Available
      * UPS Rtv Raw Mtrl Avl  RT - PS Production Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$NAIC3    WL0023           Company Number
     C                     MOVEL$EV5ST    WL0024    P      Production Type
     C                     Z-ADD$EELDT    WL0025           Production Date
     C                     Z-ADD$NC9NB    WL0026           Item Code
     C                     Z-ADD$NAVWT    WL0027           PS Weight Avail
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0027    $NAVWT           PS Weight Avail
      * Raw Material Consumption
      * CASE: CUR.Weight Order Needs USR GT CUR.PS Weight Avail Prod
     C           $NORND    IFGT $NAVWT                     *IF
     C                     Z-ADD$NAVWT    $NWTUS           Weight 9.2 USR
     C                     ADD  $NAVWT    WN0102           Weight Consumed
     C                     ELSE
      * CASE: CUR.Weight Order Needs USR LE CUR.PS Weight Avail Prod
     C           $NORND    IFLE $NAVWT                     *IF
     C                     Z-ADD$NORND    $NWTUS           Weight 9.2 USR
     C                     ADD  $NORND    WN0102           Weight Consumed
     C                     END                             *FI
     C                     END                             *FI
      * Allocate Weight
      * CASE: CUR.Weight 9.2 USR GT WRK.Weight Scheduled
     C           $NWTUS    IFGT WUAUWG                     *IF
     C                     Z-ADDWUAUWG    $NWTUS           Weight 9.2 USR
     C                     Z-ADD*ZERO     WUAUWG           Weight Schedule
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  $NWTUS    WUAUWG           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * USER: Process after print of detail format
      * UPS BOM Consm RM Upd  XF - PS Production Detail  * 
     C                     CALL 'PDN6XFR'              90  UPS BOM Consm R
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $EAJCD    WQ0123  3        Warehouse Code
     C                     PARM $MAIC3    WQ0124  30       Company Number
     C                     PARM $MC9NB    WQ0125  70       Item Code
     C                     PARM $EELDT    WQ0126  70       Production Date
     C                     PARM $EV5ST    WQ0127  1        Production Type
     C                     PARM $NC9NB    WQ0128  70       Component Item
     C                     PARM 'R'       WQ0129  1        PS Process Cont
     C                     PARM WCV2ST    WQ0130  1        BOM Type
     C                     PARM $NWTUS    WQ0131  92       Weight 9.2 USR
     C                     PARM $CDPT1    WQ0132  1        Department Type
     C                     PARM WN0098    WQ0133  3        Default Warehou
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDN6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *
      *================================================================
     CSR         F2EXIT    ENDSR
      /EJECT
     CSR         F3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN WCAIC3    WZF001           Company Number
     C                     Z-ADDWCAIC3    WZF001
     C           *LIKE     DEFN WCHGCD    WZF002           Item Code
     C                     Z-ADDWCHGCD    WZF002
     C           *LIKE     DEFN WCV2ST    WZF003           BOM Type
     C                     MOVELWCV2ST    WZF003
     C           *LIKE     DEFN WCC9NB    WZF004           Component Item
     C                     Z-ADDWCC9NB    WZF004
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFF    OREQ '1'
     C           KRSF      READE@IORENS                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFF  1
      * Quit if no record read
     C           W0EOFF    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0FL00  1        Company Number
     C                     MOVEL*BLANK    W0FL01  1        Item Code
     C                     MOVEL*BLANK    W0FL02  1        BOM Type
     C                     MOVEL*BLANK    W0FL03  1        Component Item
     C           W0EOFF    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0FL00  1        Company Number
     C                     MOVEL'Y'       W0FL01  1        Item Code
     C                     MOVEL'Y'       W0FL02  1        BOM Type
     C                     MOVEL'Y'       W0FL03  1        Component Item
     C                     ELSE
      * Next record - Detect level breaks
     C           WCAIC3    IFNE WZF001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0FL00
     C                     END
     C           WCHGCD    IFNE WZF002                     Item Code
     C           W0FL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0FL01
     C                     END
     C           WCV2ST    IFNE WZF003                     BOM Type
     C           W0FL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0FL02
     C                     END
     C           WCC9NB    IFNE WZF004                     Component Item
     C           W0FL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0FL03
     C                     END
     C                     END
      *================================================================
     CSR         F3EXIT    ENDSR
      /EJECT
     CSR         F4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0FL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0FP03
     C                     END
      *
     C           W0FL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0FP02
     C                     END
      *
     C           W0FL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0FP01
     C                     END
      *
     C           W0FL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0FP00
     C                     END
      *
     C           W0EOFF    IFEQ '1'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$OFINTTL
     C                     END
      *
      *================================================================
     CSR         F4EXIT    ENDSR
      /EJECT
     CSR         G0MAIN    BEGSR
      *================================================================
      * UPS BOM FG Base Cnv   PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIC3    WQKG01           Company Number
     C           *LIKE     DEFN WEV5ST    WQKG02           Production Type
     C           *LIKE     DEFN WEELDT    WQKG03           Production Date
     C           *LIKE     DEFN WER3CD    WQKG04           Department Code
      * Define keylist
     C           KRSG      KLIST
     C                     KFLD           WQKG01           Company Number
     C                     KFLD           WQKG02           Production Type
     C                     KFLD           WQKG03           Production Date
     C                     KFLD           WQKG04           Department Code
      * Setup key
     C                     Z-ADD$CAIC3    WQKG01           Company Number
     C                     MOVELP2V5ST    WQKG02           Production Type
     C                     Z-ADDP2ELDT    WQKG03           Production Date
     C                     MOVEL$CR3CD    WQKG04           Department Code
      * Establish starting position
     C           KRSG      SETLL@I8CPF1                    *
      * Read first record with user selection
     C                     EXSR G3READ
     C           W0EOFG    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0GL1P  1        First page
     C                     MOVEL'Y'       W0GL00  1        Company Number
     C                     MOVEL'Y'       W0GL01  1        Production Type
     C                     MOVEL'Y'       W0GL02  1        Production Date
     C                     MOVEL'Y'       W0GL03  1        Department Code
     C                     MOVEL'Y'       W0GL04  1        Item Code
     C                     MOVEL'Y'       W0GL05  1        Warehouse Code
      * Set column headings flag
     C                     MOVE 'Y'       W0GCDT
      * Print report body
     C           W0EOFG    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR G1PHDR
      * Print report detail line
     C                     EXSR G2PDTL
      * Read next record with user selection
     C                     EXSR G3READ
      * Print totals
     C                     EXSR G4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         G0EXIT    ENDSR
      /EJECT
     CSR         G1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0GL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0GP1P  1
     C                     END
      *
     C           W0GL00    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADDWEAIC3    $WAIC3           Company Number
     C                     Z-ADD*ZERO     $WE5WG           Weight 9.2 SUM
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0GP00  1
     C                     END
      *
     C           W0GL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0GP01  1
     C                     END
      *
     C           W0GL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0GP02  1
     C                     END
      *
     C           W0GL03    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDWEAIC3    $SAIC3           Company Number
     C                     MOVELWEV5ST    $SV5ST           Production Type
     C                     Z-ADDWEELDT    $SELDT           Production Date
     C                     MOVELWER3CD    $SR3CD           Department Code
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0GP03  1
     C                     END
      *
     C           W0GL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0GP04  1
     C                     END
      *
     C           W0GL05    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0GP05  1
     C                     END
      *
      *================================================================
     CSR         G1EXIT    ENDSR
      /EJECT
     CSR         G2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDWEAIC3    $TAIC3           Company Number
     C                     MOVELWEV5ST    $TV5ST           Production Type
     C                     Z-ADDWEELDT    $TELDT           Production Date
     C                     Z-ADDWEHGCD    $THGCD           Item Code
     C                     MOVEL*BLANK    $TGENA           Item Descriptio
     C                     MOVELWEAJCD    $TAJCD           Warehouse Code
     C                     Z-ADDWEWTON    $TWTON           PS Weight Produ
     C                     Z-ADDWEEDNB    $TEDNB           PS Pieces Produ
     C                     Z-ADD*ZERO     $TE6WG           Weight Total Ne
     C                     Z-ADDWEQTSP    $TQTSP           PS Pieces Plann
     C                     Z-ADDWEWTSP    $TWTSP           PS Weight Plann
     C                     Z-ADDWEDJPC    $TDJPC           PS % of Carcass
     C                     Z-ADDWEF8WG    $TF8WG           PS Avg Piece Wg
     C                     Z-ADDWEDVWG    $TDVWG           PS Weight Order
     C                     Z-ADDWED7NB    $TD7NB           PS Pieces Order
     C                     Z-ADDWEFCAD    $TFCAD           PS Weight FC Ad
     C                     Z-ADDWED9NB    $TD9NB           PS Pieces FC Ad
     C                     Z-ADDWEDWWG    $TDWWG           PS Weight FX Ad
     C                     Z-ADDWEEANB    $TEANB           PS Pieces FX Ad
     C                     Z-ADDWEWTIN    $TWTIN           PS Weight Inv O
     C                     Z-ADDWED5NB    $TD5NB           PS Pieces Inv O
     C                     Z-ADDWESHWT    $TSHWT           PS Weight Sched
     C                     Z-ADDWEEBNB    $TEBNB           PS Pieces Sched
     C                     Z-ADDWEAVWT    $TAVWT           PS Weight Avail
     C                     Z-ADDWEECNB    $TECNB           PS Pieces Avail
     C                     Z-ADD*ZERO     $TBPPR           Production Yiel
     C                     Z-ADD*ZERO     $TORND           Weight Order Ne
     C                     MOVEL*BLANK    $TNQNA           Comment 60 USR
     C                     Z-ADDWEDXWG    $TDXWG           PS Weight Stand
     C                     Z-ADDWEB2NB    $TB2NB           PS Pieces Stand
     C                     Z-ADD*ZERO     $TE7WG           Weight Availabl
     C                     Z-ADDWEWTCN    $TWTCN           PS Weight Conve
     C                     Z-ADDWEPSCV    $TPSCV           PS Pieces Conve
     C                     Z-ADDWEFNWT    $TFNWT           PS Weight Fab N
     C                     Z-ADDWEEENB    $TEENB           PS Pieces Fab N
     C                     Z-ADDWEQTAS    $TQTAS           PS Weight Sched
     C                     Z-ADDWEEFNB    $TEFNB           PS Pieces Sched
     C                     Z-ADDWEGPDT    $TGPDT           PS Available Sh
     C                     Z-ADDWEOAWT    $TOAWT           PS Weight Prod
     C                     Z-ADDWECDNB    $TCDNB           PS Pieces Prod
     C                     Z-ADDWESAWT    $TSAWT           PS Weight Shipp
     C                     Z-ADDWEB9NB    $TB9NB           PS Pieces Shipp
     C                     Z-ADDWED1WG    $TD1WG           PS Weight Prod
     C                     Z-ADDWECBNB    $TCBNB           PS Pieces Prod
     C                     Z-ADDWEEZWG    $TEZWG           PS Weight Inv A
     C                     Z-ADDWECCNB    $TCCNB           PS Pieces Inv A
     C                     Z-ADDWEWAIO    $TWAIO           PS Weight Sched
     C                     Z-ADDWEEGNB    $TEGNB           PS Pieces Sched
     C                     Z-ADDWEUNW2    $TUNW2           PS Weight Inv A
     C                     Z-ADDWECENB    $TCENB           PS Pieces Inv A
     C                     Z-ADDWEF9WG    $TF9WG           PS Unit Weight
     C                     Z-ADDWEBPNB    $TBPNB           PS Pieces Unuse
     C                     Z-ADDWEGAWG    $TGAWG           PS Weight Unuse
     C                     Z-ADDWEBQNB    $TBQNB           PS Pieces Unuse
     C                     Z-ADDWEGBWG    $TGBWG           PS Weight Unuse
     C                     Z-ADDWEBRNB    $TBRNB           PS Pieces Unuse
     C                     Z-ADDWEGCWG    $TGCWG           PS Weight Unuse
     C                     Z-ADDWEBSNB    $TBSNB           PS Pieces Unuse
     C                     Z-ADDWEGDWG    $TGDWG           PS Weight Unuse
     C                     Z-ADDWEBWNB    $TBWNB           PS Pieces Unuse
     C                     Z-ADDWEGEWG    $TGEWG           PS Weight Unuse
     C                     Z-ADDWEPS6U    $TPS6U           PS Pieces Unuse
     C                     Z-ADDWEE0WG    $TE0WG           PS Weight Ship
     C                     Z-ADDWED6NB    $TD6NB           PS Pieces Ship
     C                     MOVELWEWCST    $TWCST           PS Item Id
     C                     MOVELWEWPST    $TWPST           Warehouse Type
     C                     MOVELWEB5ST    $TB5ST           PS Lock Status
     C                     MOVELWETFST    $TTFST           PS Export/Domes
     C                     MOVELWETEST    $TTEST           PS Print On Sch
     C                     MOVELWETHST    $TTHST           PS Piece Count
     C                     MOVELWEUDST    $TUDST           PS Unused Sts 1
     C                     MOVELWEUFST    $TUFST           PS Unused Sts 2
     C                     MOVELWEUGST    $TUGST           PS Unused Sts 3
     C                     MOVELWEUHST    $TUHST           PS Unused Sts 4
     C                     MOVELWEB6ST    $TB6ST           PS Item Sched N
     C                     MOVELWEB7ST    $TB7ST           PS Unused Sts 6
     C                     MOVELWER3CD    $TR3CD           Department Code
     C                     Z-ADDWERGNB    $TRGNB           Item Structure
     C                     Z-ADDWERHNB    $TRHNB           Item Structure
     C                     Z-ADDWERINB    $TRINB           Item Structure
     C                     MOVELWEXRCD    $TXRCD           Primal Group Co
     C                     MOVELWEUVST    $TUVST           EDI Status 1
     C                     MOVELWEUWST    $TUWST           EDI Status 2
     C                     MOVELWEUXST    $TUXST           EDI Status 3
     C                     MOVELWEVSST    $TVSST           Record Status
     C                     Z-ADDWEAATM    $TAATM           Job Time
     C                     MOVELWEAYNA    $TAYNA           User Id
     C                     MOVELWEA0NA    $TA0NA           Job Name
     C                     Z-ADDWEAXDT    $TAXDT           Job Date
      * USER: Process before print of detail format
      * Rtv Descriptions      RT - Company/Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$TAIC3    WL0005           Company Number
     C                     Z-ADD$THGCD    WL0006           Item Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    $TGENA    P      Description Lin
     C                     MOVELWL0008    WUAWNA    P      Description Lin
     C                     MOVELWL0009    WUADCD    P      U/M - Primary
     C                     MOVELWL0010    WUAECD    P      U/M - Second
     C                     MOVELWL0011    WUAFCD    P      U/M - Third
      * Rtv Item Prod Yield   RT - PD Item Bill Of Material  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$TAIC3    WL0012           Company Number
     C                     Z-ADD$THGCD    WL0013           Item Code
     C                     Z-ADD$THGCD    WL0014           Component Item
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0015    $TBPPR           Production Yiel
     C                     MOVELWL0016    WUWXST    P      Record Found US
      * Weight Order Need USR & Weight Available USR
      * CASE:
      *  - c1 OR c2
      *   |- c1    : WRK.Record Found USR is Record Not Found
      *   |- c2    : CUR.Production Yield is LE Zero
      *   '-
     C           WUWXST    IFEQ 'N'                        *IF
     C           $TBPPR    ORLE *ZERO                      *OR
      * Setup message data for message
      * Retrieve message PS BOM Not Found
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR2011' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C           $TNQNA    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
     C                     ELSE
      * CASE: *OTHERWISE
      * Weight Order Needs USR
      * CUR.Weight Order Needs USR =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : CUR.PS Weight Production Need
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.Production Yield
      * /     : PGM.*Synon (15,5) work field *
      * x3    : CON.100
     C           $TBPPR    DIV  100       W0WB01           *Synon (15,5) w
     C           $TWTON    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $TORND           Weight Order Ne
     C           P4DRWG    SUB  WN0103    WN0104           Weight Left for
      * UPS Rtv RM Avail      XF - PS Prod Item Schedule  * 
     C                     CALL 'PDCMXFR'              90  UPS Rtv RM Avai
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $TAIC3    WQ0145  30       Company Number
     C                     PARM $TV5ST    WQ0146  1        Production Type
     C                     PARM $TELDT    WQ0147  70       Production Date
     C                     PARM $THGCD    WQ0148  70       Item Code
     C           $TE7WG    PARM $TE7WG    WQ0149  92       Weight Availabl
     C           WURFPD    PARM *BLANK    WQ0150  1        Record Found -P
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Record Found -PS PD USR is Record Not Found
     C           WURFPD    IFEQ 'N'                        *IF
      * Setup message data for message
      * Retrieve message PS No 1st Level Prod
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR2176' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C           $TNQNA    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: CUR.Weight Available USR is LE Zero
     C           $TE7WG    IFLE *ZERO                      *IF
      * Setup message data for message
      * Retrieve message PS RM not Available
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR2177' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C           $TNQNA    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
     C                     ELSE
      * CASE: CUR.Weight Available USR LT CUR.Weight Order Needs USR
     C           $TE7WG    IFLT $TORND                     *IF
      * Setup message data for message
      * Retrieve message PS Need > Available
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR2178' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C           $TNQNA    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Calculate WRK.Weight 9.2 USR
      * CASE: PAR.Weight Left for Std USR GT CUR.Weight Order Needs USR
     C           WN0104    IFGT $TORND                     *IF
      * CASE: CUR.Weight Available USR GT CUR.Weight Order Needs USR
     C           $TE7WG    IFGT $TORND                     *IF
     C                     Z-ADD$TORND    WUWTUS           Weight 9.2 USR
     C                     ADD  $TORND    WN0103           Weight 9.2 USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD$TE7WG    WUWTUS           Weight 9.2 USR
     C                     ADD  $TE7WG    WN0103           Weight 9.2 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: CUR.Weight Available USR GT PAR.Weight Left for Std USR
     C           $TE7WG    IFGT WN0104                     *IF
     C                     Z-ADDWN0104    WUWTUS           Weight 9.2 USR
     C                     ADD  WN0104    WN0103           Weight 9.2 USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD$TE7WG    WUWTUS           Weight 9.2 USR
     C                     ADD  $TE7WG    WN0103           Weight 9.2 USR
     C                     END                             *FI
     C                     MOVEL*BLANK    $TB6ST           PS Item Sched N
     C                     MOVEL'E'       $TB6ST           PS Item Sched N
      * Chg Item Sch Need Sts CH - PS Production Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$TAIC3    WL0017           Company Number
     C                     MOVEL$TV5ST    WL0018    P      Production Type
     C                     Z-ADD$TELDT    WL0019           Production Date
     C                     Z-ADD$THGCD    WL0020           Item Code
     C                     MOVEL$TAJCD    WL0021    P      Warehouse Code
     C                     MOVEL$TB6ST    WL0022    P      PS Item Sched N
     C                     EXSR SFCHRC
     C                     END                             *FI
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0GPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : UPS BOM Cnsm RM Cnv   PO
     C                     EXSR UGSUBR                     Embedded PRTOBJ
      * USER: Process after print of detail format
      * CASE: WRK.Weight 9.2 USR is GT Zero
     C           WUWTUS    IFGT *ZERO                      *IF
     C                     ADD  WUWTUS    $WE5WG           Weight 9.2 SUM
     C                     END                             *FI
      *
      *================================================================
     CSR         G2EXIT    ENDSR
      /EJECT
     CSR         G3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN WEAIC3    WZG001           Company Number
     C                     Z-ADDWEAIC3    WZG001
     C           *LIKE     DEFN WEV5ST    WZG002           Production Type
     C                     MOVELWEV5ST    WZG002
     C           *LIKE     DEFN WEELDT    WZG003           Production Date
     C                     Z-ADDWEELDT    WZG003
     C           *LIKE     DEFN WER3CD    WZG004           Department Code
     C                     MOVELWER3CD    WZG004
     C           *LIKE     DEFN WEHGCD    WZG005           Item Code
     C                     Z-ADDWEHGCD    WZG005
     C           *LIKE     DEFN WEAJCD    WZG006           Warehouse Code
     C                     MOVELWEAJCD    WZG006
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFG    OREQ '1'
     C           KRSG      READE@I8CPF1                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFG  1
      * Quit if no record read
     C           W0EOFG    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0GL00  1        Company Number
     C                     MOVEL*BLANK    W0GL01  1        Production Type
     C                     MOVEL*BLANK    W0GL02  1        Production Date
     C                     MOVEL*BLANK    W0GL03  1        Department Code
     C                     MOVEL*BLANK    W0GL04  1        Item Code
     C                     MOVEL*BLANK    W0GL05  1        Warehouse Code
     C           W0EOFG    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0GL00  1        Company Number
     C                     MOVEL'Y'       W0GL01  1        Production Type
     C                     MOVEL'Y'       W0GL02  1        Production Date
     C                     MOVEL'Y'       W0GL03  1        Department Code
     C                     MOVEL'Y'       W0GL04  1        Item Code
     C                     MOVEL'Y'       W0GL05  1        Warehouse Code
     C                     ELSE
      * Next record - Detect level breaks
     C           WEAIC3    IFNE WZG001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0GL00
     C                     END
     C           WEV5ST    IFNE WZG002                     Production Type
     C           W0GL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0GL01
     C                     END
     C           WEELDT    IFNE WZG003                     Production Date
     C           W0GL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0GL02
     C                     END
     C           WER3CD    IFNE WZG004                     Department Code
     C           W0GL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0GL03
     C                     END
     C           WEHGCD    IFNE WZG005                     Item Code
     C           W0GL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0GL04
     C                     END
     C           WEAJCD    IFNE WZG006                     Warehouse Code
     C           W0GL04    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0GL05
     C                     END
     C                     END
      *================================================================
     CSR         G3EXIT    ENDSR
      /EJECT
     CSR         G4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0GL05    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0GP05
     C                     END
      *
     C           W0GL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0GP04
     C                     END
      *
     C           W0GL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0GP03
     C                     END
      *
     C           W0GL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0GP02
     C                     END
      *
     C           W0GL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0GP01
     C                     END
      *
     C           W0GL00    IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$WKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0GP00
      * USER: Process after print of Company Number format
     C                     ADD  $WE5WG    P3ETWG           Weight Total 13
     C                     END
      *
     C           W0EOFG    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         G4EXIT    ENDSR
      /EJECT
     CSR         H0MAIN    BEGSR
      *================================================================
      * UPS BOM Cnsm RM Cnv   PO: Mainline
      *================================================================
      * UPS BOM Cnsm RM Cnv   PO: Initialise
     C                     EXSR ZHINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQKH01           Company Number
     C           *LIKE     DEFN WCHGCD    WQKH02           Item Code
      * Define keylist
     C           KRSH      KLIST
     C                     KFLD           WQKH01           Company Number
     C                     KFLD           WQKH02           Item Code
      * Setup key
     C                     Z-ADD$TAIC3    WQKH01           Company Number
     C                     Z-ADD$THGCD    WQKH02           Item Code
      * Establish starting position
     C           KRSH      SETLL@IORENS                    *
      * Read first record with user selection
     C                     EXSR H3READ
     C           W0EOFH    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0HL1P  1        First page
     C                     MOVEL'Y'       W0HL00  1        Company Number
     C                     MOVEL'Y'       W0HL01  1        Item Code
     C                     MOVEL'Y'       W0HL02  1        BOM Type
     C                     MOVEL'Y'       W0HL03  1        Component Item
      * Set column headings flag
     C                     MOVE 'Y'       W0HCDT
      * Print report body
     C           W0EOFH    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR H1PHDR
      * Print report detail line
     C                     EXSR H2PDTL
      * Read next record with user selection
     C                     EXSR H3READ
      * Print totals
     C                     EXSR H4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         H0EXIT    ENDSR
      /EJECT
     CSR         H1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0HL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0HP1P  1
     C                     END
      *
     C           W0HL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0HP00  1
     C                     END
      *
     C           W0HL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0HP01  1
     C                     END
      *
     C           W0HL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0HP02  1
     C                     END
      *
     C           W0HL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0HP03  1
     C                     END
      *
      *================================================================
     CSR         H1EXIT    ENDSR
      /EJECT
     CSR         H2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDWCAIC3    $UAIC3           Company Number
     C                     Z-ADDWCHGCD    $UHGCD           Item Code
     C                     MOVELWCV2ST    $UV2ST           BOM Type
     C                     MOVEL*BLANK    $UGUTX           Condition Name
     C                     Z-ADDWCC9NB    $UC9NB           Component Item
     C                     MOVEL*BLANK    $UGENA           Item Descriptio
     C                     MOVEL*BLANK    $UR3CD           Department Code
     C                     Z-ADDWCBPPR    $UBPPR           Production Yiel
     C                     Z-ADD*ZERO     $UORND           Weight Order Ne
     C                     Z-ADD*ZERO     $UAVWT           PS Weight Avail
     C                     Z-ADD*ZERO     $UWTUS           Weight 9.2 USR
     C                     Z-ADDWCBOPR    $UBOPR           Sales Yield
     C                     Z-ADDWCHGQT    $UHGQT           Packaging Quant
     C                     MOVELWCHHCD    $UHHCD           U/M - Primary D
     C                     MOVELWCYAST    $UYAST           Average if WPA
     C                     Z-ADDWCCNSM    $UCNSM           Consume Priorit
     C                     Z-ADDWCBMY1    $UBMY1           Consume Priorit
     C                     Z-ADDWCBMY2    $UBMY2           BOM Unused % 2
     C                     Z-ADDWCIXQT    $UIXQT           BOM Unused Qty
     C                     Z-ADDWCIYQT    $UIYQT           BOM Unused Qty
     C                     MOVELWCRSST    $URSST           BOM Unused Sts
     C                     MOVELWCRTST    $URTST           BOM Unused Sts
     C                     MOVELWCUVST    $UUVST           EDI Status 1
     C                     MOVELWCUWST    $UUWST           EDI Status 2
     C                     MOVELWCUXST    $UUXST           EDI Status 3
     C                     MOVELWCVSST    $UVSST           Record Status
     C                     Z-ADDWCAATM    $UAATM           Job Time
     C                     MOVELWCAYNA    $UAYNA           User Id
     C                     MOVELWCA0NA    $UA0NA           Job Name
     C                     Z-ADDWCAXDT    $UAXDT           Job Date
      * USER: Process before print of detail format
      * CUR.Condition Name USR = Condition name of DB1.BOM Type
     C                     CALL 'CARVCNR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1260923   Y2LSNO  70       List number
     C                     PARM WCV2ST    W0INVL 25        BOM Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $UGUTX    PARM           W0CNNM 25        Condition Name
      *
      * UPS Setup Item Info   XF - PS Production Detail  * 
     C                     CALL 'PDCLXFR'              90  UPS Setup Item
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $UAIC3    WQ0151  30       Company Number
     C                     PARM $UC9NB    WQ0152  70       Item Code
     C           $UGENA    PARM *BLANK    WQ0153 30        Description Lin
     C           WUADCD    PARM WUADCD    WQ0154  2        U/M - Primary
     C           WUAIWG    PARM WUAIWG    WQ0155 112       Unit Weight
     C           WURINB    PARM WURINB    WQ0156  30       Item Structure
     C           WURHNB    PARM WURHNB    WQ0157  30       Item Structure
     C           WURGNB    PARM WURGNB    WQ0158  30       Item Structure
     C           WUN0CD    PARM WUN0CD    WQ0159  3        Item Type Code
     C           WN0105    PARM WN0105    WQ0160  3        Default Warehou
     C           WUCHTM    PARM WUCHTM    WQ0161  52       Fresh Chilling
     C           WN0106    PARM WN0106    WQ0162  2        Base/Conv/Loss
     C           WN0107    PARM WN0107    WQ0163  1        Variety/Rendere
     C           WN0108    PARM WN0108    WQ0164  1        Credit Item Sta
     C           WUSWGH    PARM WUSWGH    WQ0165 112       Std Weight/Head
     C           WUPPHE    PARM WUPPHE    WQ0166  70       Pieces Per Head
     C           $UR3CD    PARM $UR3CD    WQ0167  6        Department Code
     C           WUSDCD    PARM WUSDCD    WQ0168  1        Group for Packa
     C           WUX5ST    PARM WUX5ST    WQ0169  1        Seconds Item
     C                     PARM $TAJCD    WQ0170  3        Warehouse Code
     C           WUWPST    PARM *BLANK    WQ0171  2        Warehouse Type
     C           WUWCST    PARM *BLANK    WQ0172  3        PS Item Id
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C           $UBPPR    DIV  100       WUD4PC           Percent 7.4 USR
      * CASE: DB1.BOM Type is Consumed - Meat
     C           WCV2ST    IFEQ 'C'                        *IF
     C           WUWTUS    MULT WUD4PC    $UORND    H      Weight Order Ne
     C                     ELSE
      * CASE: DB1.BOM Type is Produced - Meat
     C           WCV2ST    IFEQ 'P'                        *IF
     C           WN0109    MULT WUD4PC    $UWTUS    H      Weight 9.2 USR
     C                     END                             *FI
     C                     END                             *FI
      * Allocate Weight for Consumed Items.
      * CASE: DB1.BOM Type is Consumed - Meat
     C           WCV2ST    IFEQ 'C'                        *IF
      * Rtv with Initializing of the Weight Available
      * UPS Rtv Raw Mtrl Avl  RT - PS Production Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$UAIC3    WL0023           Company Number
     C                     MOVEL$TV5ST    WL0024    P      Production Type
     C                     Z-ADD$TELDT    WL0025           Production Date
     C                     Z-ADD$UC9NB    WL0026           Item Code
     C                     Z-ADD$UAVWT    WL0027           PS Weight Avail
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0027    $UAVWT           PS Weight Avail
      * Raw Material Consumption
      * CASE: CUR.Weight Order Needs USR GT CUR.PS Weight Avail Prod
     C           $UORND    IFGT $UAVWT                     *IF
     C                     Z-ADD$UAVWT    $UWTUS           Weight 9.2 USR
     C                     ADD  $UAVWT    WN0109           Weight Consumed
     C                     MOVEL*BLANK    WUB6ST           PS Item Sched N
     C                     MOVEL'E'       WUB6ST           PS Item Sched N
      * Chg Item Sch Need Sts CH - PS Production Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$TAIC3    WL0017           Company Number
     C                     MOVEL$TV5ST    WL0018    P      Production Type
     C                     Z-ADD$TELDT    WL0019           Production Date
     C                     Z-ADD$THGCD    WL0020           Item Code
     C                     MOVEL$TAJCD    WL0021    P      Warehouse Code
     C                     MOVELWUB6ST    WL0022    P      PS Item Sched N
     C                     EXSR SFCHRC
     C                     ELSE
      * CASE: CUR.Weight Order Needs USR LE CUR.PS Weight Avail Prod
     C           $UORND    IFLE $UAVWT                     *IF
     C                     Z-ADD$UORND    $UWTUS           Weight 9.2 USR
     C                     ADD  $UORND    WN0109           Weight Consumed
     C                     END                             *FI
     C                     END                             *FI
      * Allocate Weight
      * CASE: CUR.Weight 9.2 USR GT WRK.Weight Scheduled
     C           $UWTUS    IFGT WUAUWG                     *IF
     C                     Z-ADDWUAUWG    $UWTUS           Weight 9.2 USR
     C                     Z-ADD*ZERO     WUAUWG           Weight Schedule
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  $UWTUS    WUAUWG           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0HPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * USER: Process after print of detail format
      * UPS BOM Consm RM Upd  XF - PS Production Detail  * 
     C                     CALL 'PDN6XFR'              90  UPS BOM Consm R
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $TAJCD    WQ0173  3        Warehouse Code
     C                     PARM $TAIC3    WQ0174  30       Company Number
     C                     PARM $THGCD    WQ0175  70       Item Code
     C                     PARM $TELDT    WQ0176  70       Production Date
     C                     PARM $TV5ST    WQ0177  1        Production Type
     C                     PARM $UC9NB    WQ0178  70       Component Item
     C                     PARM 'N'       WQ0179  1        PS Process Cont
     C                     PARM WCV2ST    WQ0180  1        BOM Type
     C                     PARM $UWTUS    WQ0181  92       Weight 9.2 USR
     C                     PARM $CDPT1    WQ0182  1        Department Type
     C                     PARM WN0105    WQ0183  3        Default Warehou
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDN6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *
      *================================================================
     CSR         H2EXIT    ENDSR
      /EJECT
     CSR         H3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN WCAIC3    WZH001           Company Number
     C                     Z-ADDWCAIC3    WZH001
     C           *LIKE     DEFN WCHGCD    WZH002           Item Code
     C                     Z-ADDWCHGCD    WZH002
     C           *LIKE     DEFN WCV2ST    WZH003           BOM Type
     C                     MOVELWCV2ST    WZH003
     C           *LIKE     DEFN WCC9NB    WZH004           Component Item
     C                     Z-ADDWCC9NB    WZH004
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFH    OREQ '1'
     C           KRSH      READE@IORENS                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFH  1
      * Quit if no record read
     C           W0EOFH    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0HL00  1        Company Number
     C                     MOVEL*BLANK    W0HL01  1        Item Code
     C                     MOVEL*BLANK    W0HL02  1        BOM Type
     C                     MOVEL*BLANK    W0HL03  1        Component Item
     C           W0EOFH    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0HL00  1        Company Number
     C                     MOVEL'Y'       W0HL01  1        Item Code
     C                     MOVEL'Y'       W0HL02  1        BOM Type
     C                     MOVEL'Y'       W0HL03  1        Component Item
     C                     ELSE
      * Next record - Detect level breaks
     C           WCAIC3    IFNE WZH001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0HL00
     C                     END
     C           WCHGCD    IFNE WZH002                     Item Code
     C           W0HL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0HL01
     C                     END
     C           WCV2ST    IFNE WZH003                     BOM Type
     C           W0HL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0HL02
     C                     END
     C           WCC9NB    IFNE WZH004                     Component Item
     C           W0HL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0HL03
     C                     END
     C                     END
      *================================================================
     CSR         H3EXIT    ENDSR
      /EJECT
     CSR         H4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0HL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0HP03
     C                     END
      *
     C           W0HL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0HP02
     C                     END
      *
     C           W0HL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0HP01
     C                     END
      *
     C           W0HL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0HP00
     C                     END
      *
     C           W0EOFH    IFEQ '1'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$VFINTTL
     C                     END
      *
      *================================================================
     CSR         H4EXIT    ENDSR
      /EJECT
     CSR         I0MAIN    BEGSR
      *================================================================
      * UPS Conv Dept Std     PO: Mainline
      *================================================================
      * UPS Conv Dept Std     PO: Initialise
     C                     EXSR ZIINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN I6AIC3    WQKI01           Company Number
     C           *LIKE     DEFN I6R3CD    WQKI02           Department Code
      * Define keylist
     C           KPSI      KLIST
     C                     KFLD           WQKI01           Company Number
     C                     KFLD           WQKI02           Department Code
     C                     KFLD           I6GJDT           Effective Produ
      * Define keylist
     C           KRSI      KLIST
     C                     KFLD           WQKI01           Company Number
     C                     KFLD           WQKI02           Department Code
      * Setup key
     C                     Z-ADD$CAIC3    WQKI01           Company Number
     C                     MOVEL$CR3CD    WQKI02           Department Code
     C                     Z-ADDP2ELDT    I6GJDT           Effective Produ
      * Establish starting position
     C           KPSI      SETLL@I6CPJ8                    *
      * Read first record with user selection
     C                     EXSR I3READ
     C           W0EOFI    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0IL1P  1        First page
     C                     MOVEL'Y'       W0IL00  1        Company Number
     C                     MOVEL'Y'       W0IL01  1        Department Code
     C                     MOVEL'Y'       W0IL02  1        Effective Produ
     C                     MOVEL'Y'       W0IL03  1        Mix Priority
     C                     MOVEL'Y'       W0IL04  1        Item Code
      * Set column headings flag
     C                     MOVE 'Y'       W0ICDT
      * Print report body
     C           W0EOFI    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR I1PHDR
      * Print report detail line
     C                     EXSR I2PDTL
      * Read next record with user selection
     C                     EXSR I3READ
      * Print totals
     C                     EXSR I4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         I0EXIT    ENDSR
      /EJECT
     CSR         I1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0IL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0IP1P  1
     C                     END
      *
     C           W0IL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0IP00  1
     C                     END
      *
     C           W0IL01    IFEQ 'Y'
      * Load key header format
     C                     Z-ADD*ZERO     $XETWG           Weight Total 13
     C                     Z-ADD*ZERO     $XDRWG           Weight Per Day
     C                     Z-ADDI6AIC3    $XAIC3           Company Number
     C                     MOVELI6R3CD    $XR3CD           Department Code
     C                     Z-ADD*ZERO     $XWLSD           Weight Left for
      * Load related totals format
     C                     Z-ADDI6AIC3    #BAIC3           Company Number
     C                     MOVELI6R3CD    #BR3CD           Department Code
      * USER: Process before print of Department Code format
     C                     Z-ADDP3ETWG    $XETWG           Weight Total 13
      * Rtv Dept Capability   RT - PS Production Capability  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$XAIC3    WL0001           Company Number
     C                     MOVEL$XR3CD    WL0002    P      Department Code
     C                     Z-ADDP2ELDT    WL0003           Effective Produ
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0004    $XDRWG           Weight Per Day
     C           $XDRWG    SUB  $XETWG    $XWLSD           Weight Left for
     C                     Z-ADD$XWLSD    WN0128           Weight Left for
     C                     Z-ADD$XWLSD    WUWLSD           Weight Left for
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0IP01  1
     C                     END
      *
     C           W0IL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0IP02  1
     C                     END
      *
     C           W0IL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0IP03  1
     C                     END
      *
     C           W0IL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0IP04  1
     C                     END
      *
      *================================================================
     CSR         I1EXIT    ENDSR
      /EJECT
     CSR         I2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDI6AIC3    $YAIC3           Company Number
     C                     MOVELI6R3CD    $YR3CD           Department Code
     C                     Z-ADDI6GJDT    $YGJDT           Effective Produ
     C                     Z-ADDI6MXPR    $YMXPR           Mix Priority
     C                     Z-ADDI6HGCD    $YHGCD           Item Code
     C                     MOVEL*BLANK    $YGENA           Item Descriptio
     C                     Z-ADDI6DHPC    $YDHPC           Mix Percent
     C                     Z-ADD*ZERO     $YDXWG           PS Weight Stand
     C                     Z-ADD*ZERO     $YORND           Weight Order Ne
     C                     MOVEL*BLANK    $YNQNA           Comment 60 USR
     C                     Z-ADD*ZERO     $YE7WG           Weight Availabl
     C                     Z-ADD*ZERO     $YWLSD           Weight Left for
     C                     Z-ADDI6BMWE    $YBMWE           Select Range Mi
     C                     Z-ADDI6BMXW    $YBMXW           Select Range Ma
     C                     MOVELI6T9ST    $YT9ST           SM Unused Sts 1
     C                     MOVELI6UAST    $YUAST           SM Unused Sts 2
     C                     MOVELI6UBST    $YUBST           SM Unused Sts 3
     C                     Z-ADDI6DENB    $YDENB           Pieces Override
     C                     Z-ADDI6DFNB    $YDFNB           SM Unused Nbr 2
     C                     Z-ADDI6DHNB    $YDHNB           Weight Override
     C                     MOVELI6XRCD    $YXRCD           Primal Group Co
     C                     MOVEL*BLANK    $YQ1CD           Default Warehou
     C                     MOVELI6UVST    $YUVST           EDI Status 1
     C                     MOVELI6UWST    $YUWST           EDI Status 2
     C                     MOVELI6UXST    $YUXST           EDI Status 3
     C                     MOVELI6VSST    $YVSST           Record Status
     C                     Z-ADDI6AATM    $YAATM           Job Time
     C                     MOVELI6AYNA    $YAYNA           User Id
     C                     MOVELI6A0NA    $YA0NA           Job Name
     C                     Z-ADDI6AXDT    $YAXDT           Job Date
      * USER: Process before print of detail format
      * BPS Setup Item Info   IF
      *
     C                     Z-ADD*ZERO     WN0130 155       System Value Nu
      *
      * UPS Rtv Company/Item  IF
      * Rtv Prd Sch Info   PS RT - Company/Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#BAIC3    WL0028           Company Number
     C                     Z-ADD$YHGCD    WL0029           Item Code
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0030    $YGENA    P      Description Lin
     C                     MOVELWL0031    WN0113    P      U/M - Primary
     C                     Z-ADDWL0032    WN0114           Unit Weight
     C                     Z-ADDWL0033    WN0115           Item Structure
     C                     Z-ADDWL0034    WN0116           Item Structure
     C                     Z-ADDWL0035    WN0117           Item Structure
     C                     MOVELWL0036    WN0118    P      Item Type Code
     C                     MOVELWL0037    $YQ1CD    P      Default Warehou
     C                     Z-ADDWL0038    WN0120           Fresh Chilling
     C                     MOVELWL0039    WN0121    P      Base/Conv/Loss
     C                     MOVELWL0040    WN0122    P      Variety/Rendere
     C                     MOVELWL0041    WN0123    P      Credit Item Sta
     C                     Z-ADDWL0042    WN0124           Std Weight/Head
     C                     Z-ADDWL0043    WN0125           Pieces Per Head
     C                     MOVELWL0044    $YR3CD    P      Department Code
     C                     MOVELWL0045    WN0126    P      Group for Packa
     C                     MOVELWL0046    WN0127    P      Seconds Item
     C                     MOVELWL0047    WUPCCT    P      Piece Count Ite
     C                     Z-ADDWL0048    WUBDNB           Pieces Per Bag
     C                     Z-ADDWL0049    WUBJNB           Bags Per Unit
     C                     MOVELWL0050    WUSUST    P      Export/Domestic
     C                     MOVELWL0051    WUSVST    P      Print On Schedu
     C                     MOVELWL0052    WUSYST    P      Fresh Inv Alloc
     C                     MOVELWL0053    WUSZST    P      Fresh Sched As
     C                     MOVELWL0054    WUS1ST    P      Frozen Sched As
     C                     MOVELWL0055    $YXRCD    P      Primal Group Co
      * BPS Rtv Whs Info      RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL$YQ1CD    WL0056    P      Warehouse Code
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0057    WN0111    P      Warehouse Type
     C                     MOVELWL0058    WUXUST    P      Trans Contol AS
     C                     MOVELWL0059    WUT0ST    P      Warehouse Locat
     C                     MOVELWL0060    WUT1ST    P      Warehouse Std C
     C                     Z-ADDWL0061    WUDBNB           Warehouse Chill
      * BPS Set Up Item Id    IF
      * CASE: PAR.Item Type Code is Raw Materials
     C           WN0118    IFEQ 'RM'                       *IF
     C                     MOVEL'RMB'     WN0110           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Seconds Item is Yes
     C           WN0127    IFEQ 'Y'                        *IF
     C                     MOVEL'FSC'     WN0110           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Variety/Rendered/Cut is Variety
     C           WN0122    IFEQ 'V'                        *IF
     C                     MOVEL'FVR'     WN0110           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Rendered
     C           WN0122    IFEQ 'R'                        *IF
     C                     MOVEL'FRD'     WN0110           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Cut
     C           WN0122    IFEQ 'C'                        *IF
      * Base/Converted/Fabricated
      * CASE: PAR.Credit Item Status is yes
     C           WN0123    IFEQ 'Y'                        *IF
      * Setup Base/Converted/Fabricated Credit
      * CASE: PAR.Converted/Base Item is Base
     C           WN0121    IFEQ 'B'                        *IF
     C                     MOVEL'FBC'     WN0110           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WN0121    IFEQ 'C'                        *IF
     C                     MOVEL'FCC'     WN0110           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WN0121    IFEQ 'F'                        *IF
     C                     MOVEL'FFC'     WN0110           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WN0121    IFEQ 'L'                        *IF
     C                     MOVEL'FLC'     WN0110           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup Base/Converted/Fabricated
      * CASE: PAR.Converted/Base Item is Base
     C           WN0121    IFEQ 'B'                        *IF
     C                     MOVEL'FGB'     WN0110           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WN0121    IFEQ 'C'                        *IF
     C                     MOVEL'FCV'     WN0110           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WN0121    IFEQ 'F'                        *IF
     C                     MOVEL'FFB'     WN0110           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WN0121    IFEQ 'L'                        *IF
     C                     MOVEL'FLS'     WN0110           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           I6DHPC    DIV  100       WUD4PC           Percent 7.4 USR
     C           WN0128    MULT WUD4PC    $YDXWG    H      PS Weight Stand
      * Allocate Weight Left for Standard.
      * CASE: CUR.PS Weight Standard GT WRK.Weight Left for Std USR
     C           $YDXWG    IFGT WUWLSD                     *IF
     C                     Z-ADDWUWLSD    $YDXWG           PS Weight Stand
     C                     Z-ADD*ZERO     WUWLSD           Weight Left for
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  $YDXWG    WUWLSD           Weight Left for
     C                     END                             *FI
     C                     Z-ADDWUWLSD    $YWLSD           Weight Left for
      * Determine Weight Available
     C                     EXSR UISUBR                     Determine Weigh
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0IPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : UPS BOM Consume RM    PO
     C                     EXSR UJSUBR                     Embedded PRTOBJ
      *
      *================================================================
     CSR         I2EXIT    ENDSR
      /EJECT
     CSR         I3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN I6AIC3    WZI001           Company Number
     C                     Z-ADDI6AIC3    WZI001
     C           *LIKE     DEFN I6R3CD    WZI002           Department Code
     C                     MOVELI6R3CD    WZI002
     C           *LIKE     DEFN I6GJDT    WZI003           Effective Produ
     C                     Z-ADDI6GJDT    WZI003
     C           *LIKE     DEFN I6MXPR    WZI004           Mix Priority
     C                     Z-ADDI6MXPR    WZI004
     C           *LIKE     DEFN I6HGCD    WZI005           Item Code
     C                     Z-ADDI6HGCD    WZI005
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFI    OREQ '1'
     C           KRSI      READE@I6CPJ8                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFI  1
      * Quit if no record read
     C           W0EOFI    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * First Time Processing
      * CASE: WRK.First Time Flag is Yes
     C           WUTAST    IFEQ 'Y'                        *IF
     C                     Z-ADDWN0128    WUWLSD           Weight Left for
     C                     Z-ADDI6GJDT    WUGJDT           Effective Produ
     C                     MOVEL'N'       WUTAST           First Time Flag
     C                     END                             *FI
      * CASE: DB1.Effective Production Date NE WRK.Effective Production D
     C           I6GJDT    IFNE WUGJDT                     *IF
      * End of File 'B' - /UT User Source  * 
     C                     MOVEL'1'       W0EOFB           END OF FILE 'B'
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0IL00  1        Company Number
     C                     MOVEL*BLANK    W0IL01  1        Department Code
     C                     MOVEL*BLANK    W0IL02  1        Effective Produ
     C                     MOVEL*BLANK    W0IL03  1        Mix Priority
     C                     MOVEL*BLANK    W0IL04  1        Item Code
     C           W0EOFI    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0IL00  1        Company Number
     C                     MOVEL'Y'       W0IL01  1        Department Code
     C                     MOVEL'Y'       W0IL02  1        Effective Produ
     C                     MOVEL'Y'       W0IL03  1        Mix Priority
     C                     MOVEL'Y'       W0IL04  1        Item Code
     C                     ELSE
      * Next record - Detect level breaks
     C           I6AIC3    IFNE WZI001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0IL00
     C                     END
     C           I6R3CD    IFNE WZI002                     Department Code
     C           W0IL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0IL01
     C                     END
     C           I6GJDT    IFNE WZI003                     Effective Produ
     C           W0IL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0IL02
     C                     END
     C           I6MXPR    IFNE WZI004                     Mix Priority
     C           W0IL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0IL03
     C                     END
     C           I6HGCD    IFNE WZI005                     Item Code
     C           W0IL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0IL04
     C                     END
     C                     END
      *================================================================
     CSR         I3EXIT    ENDSR
      /EJECT
     CSR         I4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0IL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0IP04
     C                     END
      *
     C           W0IL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0IP03
     C                     END
      *
     C           W0IL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0IP02
     C                     END
      *
     C           W0IL01    IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 1
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE#BKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0IP01
     C                     END
      *
     C           W0IL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0IP00
     C                     END
      *
     C           W0EOFI    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         I4EXIT    ENDSR
      /EJECT
     CSR         J0MAIN    BEGSR
      *================================================================
      * UPS BOM Cnsm RM Fab   PO: Mainline
      *================================================================
      * UPS BOM Cnsm RM Fab   PO: Initialise
     C                     EXSR ZJINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQKJ01           Company Number
     C           *LIKE     DEFN WCHGCD    WQKJ02           Item Code
      * Define keylist
     C           KRSJ      KLIST
     C                     KFLD           WQKJ01           Company Number
     C                     KFLD           WQKJ02           Item Code
      * Setup key
     C                     Z-ADD$YAIC3    WQKJ01           Company Number
     C                     Z-ADD$YHGCD    WQKJ02           Item Code
      * Establish starting position
     C           KRSJ      SETLL@IORENS                    *
      * Read first record with user selection
     C                     EXSR J3READ
     C           W0EOFJ    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0JL1P  1        First page
     C                     MOVEL'Y'       W0JL00  1        Company Number
     C                     MOVEL'Y'       W0JL01  1        Item Code
     C                     MOVEL'Y'       W0JL02  1        BOM Type
     C                     MOVEL'Y'       W0JL03  1        Component Item
      * Set column headings flag
     C                     MOVE 'Y'       W0JCDT
      * Print report body
     C           W0EOFJ    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR J1PHDR
      * Print report detail line
     C                     EXSR J2PDTL
      * Read next record with user selection
     C                     EXSR J3READ
      * Print totals
     C                     EXSR J4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         J0EXIT    ENDSR
      /EJECT
     CSR         J1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0JL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0JP1P  1
     C                     END
      *
     C           W0JL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0JP00  1
     C                     END
      *
     C           W0JL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0JP01  1
     C                     END
      *
     C           W0JL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0JP02  1
     C                     END
      *
     C           W0JL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0JP03  1
     C                     END
      *
      *================================================================
     CSR         J1EXIT    ENDSR
      /EJECT
     CSR         J2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDWCAIC3    $ZAIC3           Company Number
     C                     Z-ADDWCHGCD    $ZHGCD           Item Code
     C                     MOVELWCV2ST    $ZV2ST           BOM Type
     C                     MOVEL*BLANK    $ZGUTX           Condition Name
     C                     Z-ADDWCC9NB    $ZC9NB           Component Item
     C                     MOVEL*BLANK    $ZGENA           Item Descriptio
     C                     MOVEL*BLANK    $ZR3CD           Department Code
     C                     Z-ADDWCBPPR    $ZBPPR           Production Yiel
     C                     Z-ADD*ZERO     $ZORND           Weight Order Ne
     C                     Z-ADD*ZERO     $ZAVWT           PS Weight Avail
     C                     Z-ADD*ZERO     $ZWTUS           Weight 9.2 USR
     C                     Z-ADDWCBOPR    $ZBOPR           Sales Yield
     C                     Z-ADDWCHGQT    $ZHGQT           Packaging Quant
     C                     MOVELWCHHCD    $ZHHCD           U/M - Primary D
     C                     MOVELWCYAST    $ZYAST           Average if WPA
     C                     Z-ADDWCCNSM    $ZCNSM           Consume Priorit
     C                     Z-ADDWCBMY1    $ZBMY1           Consume Priorit
     C                     Z-ADDWCBMY2    $ZBMY2           BOM Unused % 2
     C                     Z-ADDWCIXQT    $ZIXQT           BOM Unused Qty
     C                     Z-ADDWCIYQT    $ZIYQT           BOM Unused Qty
     C                     MOVELWCRSST    $ZRSST           BOM Unused Sts
     C                     MOVELWCRTST    $ZRTST           BOM Unused Sts
     C                     MOVELWCUVST    $ZUVST           EDI Status 1
     C                     MOVELWCUWST    $ZUWST           EDI Status 2
     C                     MOVELWCUXST    $ZUXST           EDI Status 3
     C                     MOVELWCVSST    $ZVSST           Record Status
     C                     Z-ADDWCAATM    $ZAATM           Job Time
     C                     MOVELWCAYNA    $ZAYNA           User Id
     C                     MOVELWCA0NA    $ZA0NA           Job Name
     C                     Z-ADDWCAXDT    $ZAXDT           Job Date
      * USER: Process before print of detail format
      * CUR.Condition Name USR = Condition name of DB1.BOM Type
     C                     CALL 'CARVCNR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1260923   Y2LSNO  70       List number
     C                     PARM WCV2ST    W0INVL 25        BOM Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $ZGUTX    PARM           W0CNNM 25        Condition Name
      *
      * UPS Setup Item Info   XF - PS Production Detail  * 
     C                     CALL 'PDCLXFR'              90  UPS Setup Item
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $ZAIC3    WQ0190  30       Company Number
     C                     PARM $ZC9NB    WQ0191  70       Item Code
     C           $ZGENA    PARM *BLANK    WQ0192 30        Description Lin
     C           WUADCD    PARM WUADCD    WQ0193  2        U/M - Primary
     C           WUAIWG    PARM WUAIWG    WQ0194 112       Unit Weight
     C           WURINB    PARM WURINB    WQ0195  30       Item Structure
     C           WURHNB    PARM WURHNB    WQ0196  30       Item Structure
     C           WURGNB    PARM WURGNB    WQ0197  30       Item Structure
     C           WUN0CD    PARM WUN0CD    WQ0198  3        Item Type Code
     C           WN0131    PARM WN0131    WQ0199  3        Default Warehou
     C           WUCHTM    PARM WUCHTM    WQ0200  52       Fresh Chilling
     C           WN0132    PARM WN0132    WQ0201  2        Base/Conv/Loss
     C           WN0133    PARM WN0133    WQ0202  1        Variety/Rendere
     C           WN0134    PARM WN0134    WQ0203  1        Credit Item Sta
     C           WUSWGH    PARM WUSWGH    WQ0204 112       Std Weight/Head
     C           WUPPHE    PARM WUPPHE    WQ0205  70       Pieces Per Head
     C           $ZR3CD    PARM $ZR3CD    WQ0206  6        Department Code
     C           WUSDCD    PARM WUSDCD    WQ0207  1        Group for Packa
     C           WUX5ST    PARM WUX5ST    WQ0208  1        Seconds Item
     C                     PARM $YQ1CD    WQ0209  3        Warehouse Code
     C           WUWPST    PARM *BLANK    WQ0210  2        Warehouse Type
     C           WUWCST    PARM *BLANK    WQ0211  3        PS Item Id
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C           $ZBPPR    DIV  100       WUD4PC           Percent 7.4 USR
      * CASE: DB1.BOM Type is Consumed - Meat
     C           WCV2ST    IFEQ 'C'                        *IF
     C           WUWTUS    MULT WUD4PC    $ZORND    H      Weight Order Ne
     C                     ELSE
      * CASE: DB1.BOM Type is Produced - Meat
     C           WCV2ST    IFEQ 'P'                        *IF
     C           WN0135    MULT WUD4PC    $ZWTUS    H      Weight 9.2 USR
     C                     END                             *FI
     C                     END                             *FI
      * Allocate Weight for Consumed Items.
      * CASE: DB1.BOM Type is Consumed - Meat
     C           WCV2ST    IFEQ 'C'                        *IF
      * Rtv with Initializing of the Weight Available
      * UPS Rtv Raw Mtrl Avl  RT - PS Production Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$ZAIC3    WL0023           Company Number
     C                     MOVELP2V5ST    WL0024    P      Production Type
     C                     Z-ADDP2ELDT    WL0025           Production Date
     C                     Z-ADD$ZC9NB    WL0026           Item Code
     C                     Z-ADD$ZAVWT    WL0027           PS Weight Avail
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0027    $ZAVWT           PS Weight Avail
      * Raw Material Consumption
      * CASE: CUR.Weight Order Needs USR GT CUR.PS Weight Avail Prod
     C           $ZORND    IFGT $ZAVWT                     *IF
     C                     Z-ADD$ZAVWT    $ZWTUS           Weight 9.2 USR
     C                     ADD  $ZAVWT    WN0135           Weight Consumed
     C                     ELSE
      * CASE: CUR.Weight Order Needs USR LE CUR.PS Weight Avail Prod
     C           $ZORND    IFLE $ZAVWT                     *IF
     C                     Z-ADD$ZORND    $ZWTUS           Weight 9.2 USR
     C                     ADD  $ZORND    WN0135           Weight Consumed
     C                     END                             *FI
     C                     END                             *FI
      * Allocate Weight
      * CASE: CUR.Weight 9.2 USR GT WRK.Weight Scheduled
     C           $ZWTUS    IFGT WUAUWG                     *IF
     C                     Z-ADDWUAUWG    $ZWTUS           Weight 9.2 USR
     C                     Z-ADD*ZERO     WUAUWG           Weight Schedule
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  $ZWTUS    WUAUWG           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0JPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * USER: Process after print of detail format
      * UPS BOM Consm RM Upd  XF - PS Production Detail  * 
     C                     CALL 'PDN6XFR'              90  UPS BOM Consm R
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $YQ1CD    WQ0212  3        Warehouse Code
     C                     PARM $YAIC3    WQ0213  30       Company Number
     C                     PARM $YHGCD    WQ0214  70       Item Code
     C                     PARM P2ELDT    WQ0215  70       Production Date
     C                     PARM P2V5ST    WQ0216  1        Production Type
     C                     PARM $ZC9NB    WQ0217  70       Component Item
     C                     PARM 'S'       WQ0218  1        PS Process Cont
     C                     PARM WCV2ST    WQ0219  1        BOM Type
     C                     PARM $ZWTUS    WQ0220  92       Weight 9.2 USR
     C                     PARM $CDPT1    WQ0221  1        Department Type
     C                     PARM WN0131    WQ0222  3        Default Warehou
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDN6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *
      *================================================================
     CSR         J2EXIT    ENDSR
      /EJECT
     CSR         J3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN WCAIC3    WZJ001           Company Number
     C                     Z-ADDWCAIC3    WZJ001
     C           *LIKE     DEFN WCHGCD    WZJ002           Item Code
     C                     Z-ADDWCHGCD    WZJ002
     C           *LIKE     DEFN WCV2ST    WZJ003           BOM Type
     C                     MOVELWCV2ST    WZJ003
     C           *LIKE     DEFN WCC9NB    WZJ004           Component Item
     C                     Z-ADDWCC9NB    WZJ004
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFJ    OREQ '1'
     C           KRSJ      READE@IORENS                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFJ  1
      * Quit if no record read
     C           W0EOFJ    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0JL00  1        Company Number
     C                     MOVEL*BLANK    W0JL01  1        Item Code
     C                     MOVEL*BLANK    W0JL02  1        BOM Type
     C                     MOVEL*BLANK    W0JL03  1        Component Item
     C           W0EOFJ    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0JL00  1        Company Number
     C                     MOVEL'Y'       W0JL01  1        Item Code
     C                     MOVEL'Y'       W0JL02  1        BOM Type
     C                     MOVEL'Y'       W0JL03  1        Component Item
     C                     ELSE
      * Next record - Detect level breaks
     C           WCAIC3    IFNE WZJ001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0JL00
     C                     END
     C           WCHGCD    IFNE WZJ002                     Item Code
     C           W0JL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0JL01
     C                     END
     C           WCV2ST    IFNE WZJ003                     BOM Type
     C           W0JL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0JL02
     C                     END
     C           WCC9NB    IFNE WZJ004                     Component Item
     C           W0JL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0JL03
     C                     END
     C                     END
      *================================================================
     CSR         J3EXIT    ENDSR
      /EJECT
     CSR         J4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0JL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0JP03
     C                     END
      *
     C           W0JL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0JP02
     C                     END
      *
     C           W0JL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0JP01
     C                     END
      *
     C           W0JL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0JP00
     C                     END
      *
     C           W0EOFJ    IFEQ '1'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE#AFINTTL
     C                     END
      *
      *================================================================
     CSR         J4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of UPS Sch Conv Depts    PF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of UPS Sch Conv Depts    PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print Company Number of UPS Sch Conv Depts    PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP00
     C                     END                             FI
      * Print Detail line. of UPS Sch Conv Depts    PF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
      * Print column headings if required
     C           W0ACDT    IFEQ 'Y'
     C                     WRITE$CCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ACDT
     C                     END                             FI
      * Print format
     C                     WRITE$CDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Print First Page Format of UPS BOM FG Conv       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP1P    ANDEQ'P'
      * Print format
     C                     WRITE$D1STPAG
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0BP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0BL1P
     C                     END                             FI
      * Print Company Number of UPS BOM FG Conv       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP00
     C                     END                             FI
      * Print Production Type of UPS BOM FG Conv       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP01
     C                     END                             FI
      * Print Production Date of UPS BOM FG Conv       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP02
     C                     END                             FI
      * Print Department Code of UPS BOM FG Conv       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP03
     C                     END                             FI
      * Print Item Code of UPS BOM FG Conv       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP04
     C                     END                             FI
      * Print Warehouse Code of UPS BOM FG Conv       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP05    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP05    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP05
     C                     END                             FI
      * Print Detail line. of UPS BOM FG Conv       PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0BCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BPDT    ANDEQ'P'
      * Convert fields to external form
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $EHGCD    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$EHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VEHGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VEHGCD           CD7 Ext Numeric
     C                     END                             *FI
      * Print column headings if required
     C           W0BCDT    IFEQ 'Y'
     C                     WRITE$ECOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0BCDT
     C                     END                             FI
      * Print format
     C                     WRITE$EDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0BPDT
     C                     END                             FI
      * Print First Page Format of UPS BOM Conv/Fab Dept PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0CL1P
     C                     END                             FI
      * Print Company Number of UPS BOM Conv/Fab Dept PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP00
     C                     END                             FI
      * Print Item Code of UPS BOM Conv/Fab Dept PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP01
     C                     END                             FI
      * Print BOM Type of UPS BOM Conv/Fab Dept PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP02
     C                     END                             FI
      * Print Consume Priority of UPS BOM Conv/Fab Dept PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP03    ANDEQ'P'
      * Print format
     C                     WRITE$FKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0CCDT
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0CP03
     C                     END                             FI
      * Print Component Item Code of UPS BOM Conv/Fab Dept PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP04
     C                     END                             FI
      * Print Detail line. of UPS BOM Conv/Fab Dept PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0CCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CPDT    ANDEQ'P'
      * Convert fields to external form
      * Convert Component Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $GC9NB    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$GC9NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VGC9NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VGC9NB           CD7 Ext Numeric
     C                     END                             *FI
      * Print column headings if required
     C           W0CCDT    IFEQ 'Y'
     C                     WRITE$GCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0CCDT
     C                     END                             FI
      * Print format
     C                     WRITE$GDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0CPDT
     C                     END                             FI
      * Print First Page Format of UPS BOM Cnsm RM Fab   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0DL1P
     C                     END                             FI
      * Print Company Number of UPS BOM Cnsm RM Fab   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP00
     C                     END                             FI
      * Print Item Code of UPS BOM Cnsm RM Fab   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP01
     C                     END                             FI
      * Print BOM Type of UPS BOM Cnsm RM Fab   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP02
     C                     END                             FI
      * Print Component Item Code of UPS BOM Cnsm RM Fab   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP03
     C                     END                             FI
      * Print Detail line. of UPS BOM Cnsm RM Fab   PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0DCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DPDT    ANDEQ'P'
      * Convert fields to external form
      * Convert Component Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $HC9NB    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$HC9NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VHC9NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VHC9NB           CD7 Ext Numeric
     C                     END                             *FI
      * Print column headings if required
     C           W0DCDT    IFEQ 'Y'
     C                     WRITE$HCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0DCDT
     C                     END                             FI
      * Print format
     C                     WRITE$HDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0DPDT
     C                     END                             FI
      * Print First Page Format of UPS BOM Conv/Fab Dept PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0EL1P
     C                     END                             FI
      * Print Company Number of UPS BOM Conv/Fab Dept PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP00
     C                     END                             FI
      * Print Item Code of UPS BOM Conv/Fab Dept PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP01
     C                     END                             FI
      * Print BOM Type of UPS BOM Conv/Fab Dept PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP02
     C                     END                             FI
      * Print Consume Priority of UPS BOM Conv/Fab Dept PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP03    ANDEQ'P'
      * Print format
     C                     WRITE$LKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ECDT
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0EP03
     C                     END                             FI
      * Print Component Item Code of UPS BOM Conv/Fab Dept PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP04
     C                     END                             FI
      * Print Detail line. of UPS BOM Conv/Fab Dept PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ECDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EPDT    ANDEQ'P'
      * Convert fields to external form
      * Convert Component Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $MC9NB    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$MC9NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VMC9NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VMC9NB           CD7 Ext Numeric
     C                     END                             *FI
      * Print column headings if required
     C           W0ECDT    IFEQ 'Y'
     C                     WRITE$MCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ECDT
     C                     END                             FI
      * Print format
     C                     WRITE$MDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0EPDT
     C                     END                             FI
      * Print First Page Format of UPS BOM Cnsm RM Fab   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0FP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0FL1P
     C                     END                             FI
      * Print Company Number of UPS BOM Cnsm RM Fab   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0FP00
     C                     END                             FI
      * Print Item Code of UPS BOM Cnsm RM Fab   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0FP01
     C                     END                             FI
      * Print BOM Type of UPS BOM Cnsm RM Fab   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0FP02
     C                     END                             FI
      * Print Component Item Code of UPS BOM Cnsm RM Fab   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0FP03
     C                     END                             FI
      * Print Detail line. of UPS BOM Cnsm RM Fab   PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0FCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FPDT    ANDEQ'P'
      * Convert fields to external form
      * Convert Component Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $NC9NB    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$NC9NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VNC9NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VNC9NB           CD7 Ext Numeric
     C                     END                             *FI
      * Print column headings if required
     C           W0FCDT    IFEQ 'Y'
     C                     WRITE$NCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0FCDT
     C                     END                             FI
      * Print format
     C                     WRITE$NDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0FPDT
     C                     END                             FI
      * Print First Page Format of UPS BOM FG Base Cnv   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0GP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0GP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0GP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0GL1P
     C                     END                             FI
      * Print Company Number of UPS BOM FG Base Cnv   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0GP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0GP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0GP00
     C                     END                             FI
      * Print Production Type of UPS BOM FG Base Cnv   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0GP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0GP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0GP01
     C                     END                             FI
      * Print Production Date of UPS BOM FG Base Cnv   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0GP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0GP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0GP02
     C                     END                             FI
      * Print Department Code of UPS BOM FG Base Cnv   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0GP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0GP03    ANDEQ'P'
      * Print format
     C                     WRITE$SKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0GCDT
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0GP03
     C                     END                             FI
      * Print Item Code of UPS BOM FG Base Cnv   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0GP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0GP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0GP04
     C                     END                             FI
      * Print Warehouse Code of UPS BOM FG Base Cnv   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0GP05    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0GP05    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0GP05
     C                     END                             FI
      * Print Detail line. of UPS BOM FG Base Cnv   PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0GCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0GPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0GPDT    ANDEQ'P'
      * Convert fields to external form
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $THGCD    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$THGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VTHGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VTHGCD           CD7 Ext Numeric
     C                     END                             *FI
      * Print column headings if required
     C           W0GCDT    IFEQ 'Y'
     C                     WRITE$TCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0GCDT
     C                     END                             FI
      * Print format
     C                     WRITE$TDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0GPDT
     C                     END                             FI
      * Print First Page Format of UPS BOM Cnsm RM Cnv   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0HP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0HP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0HP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0HL1P
     C                     END                             FI
      * Print Company Number of UPS BOM Cnsm RM Cnv   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0HP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0HP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0HP00
     C                     END                             FI
      * Print Item Code of UPS BOM Cnsm RM Cnv   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0HP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0HP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0HP01
     C                     END                             FI
      * Print BOM Type of UPS BOM Cnsm RM Cnv   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0HP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0HP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0HP02
     C                     END                             FI
      * Print Component Item Code of UPS BOM Cnsm RM Cnv   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0HP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0HP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0HP03
     C                     END                             FI
      * Print Detail line. of UPS BOM Cnsm RM Cnv   PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0HCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0HPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0HPDT    ANDEQ'P'
      * Convert fields to external form
      * Convert Component Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $UC9NB    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$UC9NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VUC9NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VUC9NB           CD7 Ext Numeric
     C                     END                             *FI
      * Print column headings if required
     C           W0HCDT    IFEQ 'Y'
     C                     WRITE$UCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0HCDT
     C                     END                             FI
      * Print format
     C                     WRITE$UDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0HPDT
     C                     END                             FI
      * Print First Page Format of UPS Conv Dept Std     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0IP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0IP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0IP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0IL1P
     C                     END                             FI
      * Print Company Number of UPS Conv Dept Std     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0IP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0IP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0IP00
     C                     END                             FI
      * Print Department Code of UPS Conv Dept Std     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0IP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0IP01    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Department Code format
      * CASE: CUR.Weight Left for Std USR is LT Zero
     C           $XWLSD    IFLT *ZERO                      *IF
     C                     MOVEL'Y'       WUQKST           Display Flag
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
     C                     MOVEL'0'       *IN79
     C           WUQKST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print format
     C                     WRITE$XKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ICDT
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0IP01
     C                     END                             FI
      * Print Effective Production Date of UPS Conv Dept Std     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0IP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0IP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0IP02
     C                     END                             FI
      * Print Mix Priority of UPS Conv Dept Std     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0IP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0IP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0IP03
     C                     END                             FI
      * Print Item Code of UPS Conv Dept Std     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0IP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0IP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0IP04
     C                     END                             FI
      * Print Detail line. of UPS Conv Dept Std     PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ICDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0IPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0IPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * CASE: PAR.Weight Left for Std USR is LE Zero
     C           WN0128    IFLE *ZERO                      *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $YHGCD    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$YHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VYHGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VYHGCD           CD7 Ext Numeric
     C                     END                             *FI
      * Print column headings if required
     C           W0ICDT    IFEQ 'Y'
     C                     WRITE$YCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ICDT
     C                     END                             FI
      * Print format
     C                     WRITE$YDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0IPDT
     C                     END                             FI
      * Print First Page Format of UPS BOM Cnsm RM Fab   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0JP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0JP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0JP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0JL1P
     C                     END                             FI
      * Print Company Number of UPS BOM Cnsm RM Fab   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0JP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0JP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0JP00
     C                     END                             FI
      * Print Item Code of UPS BOM Cnsm RM Fab   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0JP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0JP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0JP01
     C                     END                             FI
      * Print BOM Type of UPS BOM Cnsm RM Fab   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0JP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0JP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0JP02
     C                     END                             FI
      * Print Component Item Code of UPS BOM Cnsm RM Fab   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0JP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0JP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0JP03
     C                     END                             FI
      * Print Detail line. of UPS BOM Cnsm RM Fab   PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0JCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0JPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0JPDT    ANDEQ'P'
      * Convert fields to external form
      * Convert Component Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $ZC9NB    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$ZC9NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VZC9NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VZC9NB           CD7 Ext Numeric
     C                     END                             *FI
      * Print column headings if required
     C           W0JCDT    IFEQ 'Y'
     C                     WRITE$ZCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0JCDT
     C                     END                             FI
      * Print format
     C                     WRITE$ZDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0JPDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
     C                     MOVEL*BLANK    W0SKP   1
      * Cascade skip to new page requests upwards
     C           W0APDT    IFEQ 'Y'
     C                     MOVEL'Y'       W0SKP
     C                     END
      * Request new page if required
     C           W0SKP     IFEQ 'Y'                        IF
     C                     MOVE 'Y'       W0NEWP
     C                     END                             FI
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C                     Z-ADD@$CLN     W0FSUM  30
     C                     Z-ADD*ZERO     W0DTLN  30
     C                     Z-ADD*ZERO     W0COLN  30
      * * First Page Format of UPS Sch Conv Depts    PF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of UPS Sch Conv Depts    PF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of UPS Sch Conv Depts    PF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD2         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of UPS BOM FG Conv       PO
     C           W0BP1P    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * Company Number of UPS BOM FG Conv       PO
     C           W0BP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Production Type of UPS BOM FG Conv       PO
     C           W0BP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Production Date of UPS BOM FG Conv       PO
     C           W0BP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Department Code of UPS BOM FG Conv       PO
     C           W0BP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Item Code of UPS BOM FG Conv       PO
     C           W0BP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Warehouse Code of UPS BOM FG Conv       PO
     C           W0BP05    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of UPS BOM FG Conv       PO
     C           W0BPDT    IFEQ 'Y'
     C                     Z-ADD2         W0DTLN
     C           W0BCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of UPS BOM Conv/Fab Dept PO
     C           W0CP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of UPS BOM Conv/Fab Dept PO
     C           W0CP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Item Code of UPS BOM Conv/Fab Dept PO
     C           W0CP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOM Type of UPS BOM Conv/Fab Dept PO
     C           W0CP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Consume Priority of UPS BOM Conv/Fab Dept PO
     C           W0CP03    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * Component Item Code of UPS BOM Conv/Fab Dept PO
     C           W0CP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of UPS BOM Conv/Fab Dept PO
     C           W0CPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0CCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of UPS BOM Cnsm RM Fab   PO
     C           W0DP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of UPS BOM Cnsm RM Fab   PO
     C           W0DP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Item Code of UPS BOM Cnsm RM Fab   PO
     C           W0DP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOM Type of UPS BOM Cnsm RM Fab   PO
     C           W0DP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Component Item Code of UPS BOM Cnsm RM Fab   PO
     C           W0DP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of UPS BOM Cnsm RM Fab   PO
     C           W0DPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0DCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of UPS BOM Conv/Fab Dept PO
     C           W0EP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of UPS BOM Conv/Fab Dept PO
     C           W0EP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Item Code of UPS BOM Conv/Fab Dept PO
     C           W0EP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOM Type of UPS BOM Conv/Fab Dept PO
     C           W0EP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Consume Priority of UPS BOM Conv/Fab Dept PO
     C           W0EP03    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * Component Item Code of UPS BOM Conv/Fab Dept PO
     C           W0EP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of UPS BOM Conv/Fab Dept PO
     C           W0EPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0ECDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of UPS BOM Cnsm RM Fab   PO
     C           W0FP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of UPS BOM Cnsm RM Fab   PO
     C           W0FP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Item Code of UPS BOM Cnsm RM Fab   PO
     C           W0FP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOM Type of UPS BOM Cnsm RM Fab   PO
     C           W0FP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Component Item Code of UPS BOM Cnsm RM Fab   PO
     C           W0FP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of UPS BOM Cnsm RM Fab   PO
     C           W0FPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0FCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of UPS BOM FG Base Cnv   PO
     C           W0GP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of UPS BOM FG Base Cnv   PO
     C           W0GP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Production Type of UPS BOM FG Base Cnv   PO
     C           W0GP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Production Date of UPS BOM FG Base Cnv   PO
     C           W0GP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Department Code of UPS BOM FG Base Cnv   PO
     C           W0GP03    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * Item Code of UPS BOM FG Base Cnv   PO
     C           W0GP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Warehouse Code of UPS BOM FG Base Cnv   PO
     C           W0GP05    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of UPS BOM FG Base Cnv   PO
     C           W0GPDT    IFEQ 'Y'
     C                     Z-ADD3         W0DTLN
     C           W0GCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of UPS BOM Cnsm RM Cnv   PO
     C           W0HP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of UPS BOM Cnsm RM Cnv   PO
     C           W0HP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Item Code of UPS BOM Cnsm RM Cnv   PO
     C           W0HP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOM Type of UPS BOM Cnsm RM Cnv   PO
     C           W0HP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Component Item Code of UPS BOM Cnsm RM Cnv   PO
     C           W0HP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of UPS BOM Cnsm RM Cnv   PO
     C           W0HPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0HCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of UPS Conv Dept Std     PO
     C           W0IP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of UPS Conv Dept Std     PO
     C           W0IP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Department Code of UPS Conv Dept Std     PO
     C           W0IP01    IFEQ 'Y'
     C                     ADD  6         W0FSUM
     C                     END                             FI
      *
      * * Effective Production Date of UPS Conv Dept Std     PO
     C           W0IP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Mix Priority of UPS Conv Dept Std     PO
     C           W0IP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Item Code of UPS Conv Dept Std     PO
     C           W0IP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of UPS Conv Dept Std     PO
     C           W0IPDT    IFEQ 'Y'
     C                     Z-ADD3         W0DTLN
     C           W0ICDT    IFEQ 'Y'
     C                     Z-ADD3         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of UPS BOM Cnsm RM Fab   PO
     C           W0JP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of UPS BOM Cnsm RM Fab   PO
     C           W0JP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Item Code of UPS BOM Cnsm RM Fab   PO
     C           W0JP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOM Type of UPS BOM Cnsm RM Fab   PO
     C           W0JP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Component Item Code of UPS BOM Cnsm RM Fab   PO
     C           W0JP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of UPS BOM Cnsm RM Fab   PO
     C           W0JPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0JCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
      * USER: Process top of page
      * TOP = PAR By name
     C                     Z-ADDP1AIC3    $BAIC3           Company Number
     C                     MOVELP2V5ST    $BV5ST           Production Type
     C                     Z-ADDP2ELDT    $BELDT           Production Date
      * TOP.Condition Desc. 1  USR = Condition name of TOP.Production Typ
     C                     CALL 'CARVCNR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1261823   Y2LSNO  70       List number
     C                     PARM $BV5ST    W0INVL 25        Production Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $BHLTX    PARM           W0CNNM 25        Condition Desc.
      *
      * Convert fields to external form
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $BAIC3    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$BAIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VBAIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VBAIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Production Date to display format
      * Convert date
     C           1000000   ADD  $BELDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBELDT
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSA01           Application Cod
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSA01           Application Cod
     C                     MOVEL'P/S'     WQSA01           Application Cod
      * Establish starting position
     C           KRSSA     SETLL@DNRESF                    *
     C           KRSSA     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
     C           KRSSA     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSB01           Application Cod
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSB01           Application Cod
      * Establish starting position
     C           KRSSB     SETLL@DNRESF                    *
     C           KRSSB     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSB     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Dept Capability   RT - PS Production Capability  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN I7AIC3    WQSC01           Company Number
     C           *LIKE     DEFN I7R3CD    WQSC02           Department Code
      * Define keylist
     C           KPSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Department Code
     C                     KFLD           I7GJDT           Effective Produ
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Department Code
      * Setup key
     C                     Z-ADDWL0001    WQSC01           Company Number
     C                     MOVELWL0002    WQSC02           Department Code
     C                     Z-ADDWL0003    I7GJDT           Effective Produ
      * Establish starting position
     C           KPSSC     SETLL@I7CPBK                    *
     C           KRSSC     READE@I7CPBK                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1761' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0004           Weight Per Day
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDI7DRWG    WL0004           Weight Per Day
     C                     GOTO SCEXIT                     *QUIT
     C           KRSSC     READE@I7CPBK                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Descriptions      RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0005    BZAIC3           Company Number
     C                     Z-ADDWL0006    BZHGCD           Item Code
      * Establish starting position
     C           KRSSD     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBZAVNA    WL0007           Description Lin
     C                     MOVELBZAWNA    WL0008           Description Lin
     C                     MOVELBZADCD    WL0009           U/M - Primary
     C                     MOVELBZAECD    WL0010           U/M - Second
     C                     MOVELBZAFCD    WL0011           U/M - Third
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Item Prod Yield   RT - PD Item Bill Of Material  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           IOAIC3           Company Number
     C                     KFLD           IOHGCD           Item Code
     C                     KFLD           IOC9NB           Component Item
      * Setup key
     C                     Z-ADDWL0012    IOAIC3           Company Number
     C                     Z-ADDWL0013    IOHGCD           Item Code
     C                     Z-ADDWL0014    IOC9NB           Component Item
      * Establish starting position
     C           KRSSE     CHAIN@IOREBP              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1679' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0015           Production Yiel
     C                     MOVEL*BLANK    WL0016           Record Found US
     C                     MOVEL'N'       WL0016           Record Found US
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDIOBPPR    WL0015           Production Yiel
     C                     MOVEL'Y'       WL0016           Record Found US
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCHRC    BEGSR
      *================================================================
      * Chg Item Sch Need Sts CH - PS Prod Item Schedule  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0004  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0005  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0006  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0007  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0008  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0009  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0010  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0011  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0012  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0013  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0014  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0015  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0016  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0017  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0018  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0019  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0020  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0021  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0022  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0023  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0024  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0025  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0026  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0027 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0028  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0029 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0030  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0031 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0032  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0033 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0034  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0035 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0036  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0037 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0038  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0039  3        PS Item Id
     C                     MOVEL*BLANK    WN0040  2        Warehouse Type
     C                     MOVEL*BLANK    WN0041  1        PS Lock Status
     C                     MOVEL*BLANK    WN0042  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0043  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0044  1        PS Piece Count
     C                     MOVEL*BLANK    WN0045  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0046  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0047  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0048  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0049  3        PS Unused Sts 6
     C                     Z-ADD*ZERO     WN0050  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0051  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0052  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0053  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0054  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0055  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0056  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0057  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0058  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0059  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0060  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0061  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0062  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0063  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0064  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0065  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0066  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0067  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0068  6        Department Code
     C                     Z-ADD*ZERO     WN0069  30       Item Structure
     C                     Z-ADD*ZERO     WN0070  30       Item Structure
     C                     Z-ADD*ZERO     WN0071  30       Item Structure
     C                     MOVEL*BLANK    WN0072  6        Primal Group Co
     C                     MOVEL*BLANK    WN0073  1        EDI Status 1
     C                     MOVEL*BLANK    WN0074  1        EDI Status 2
     C                     MOVEL*BLANK    WN0075  1        EDI Status 3
     C                     MOVEL*BLANK    WN0076  1        Record Status
     C                     Z-ADD*ZERO     WN0077  60       Job Time
     C                     MOVEL*BLANK    WN0078 10        User Id
     C                     MOVEL*BLANK    WN0079 10        Job Name
     C                     Z-ADD*ZERO     WN0080  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @I8CPUR
     C                     Z-ADDWL0017    WAAIC3           Company Number
     C                     MOVELWL0018    WAV5ST           Production Type
     C                     Z-ADDWL0019    WAELDT           Production Date
     C                     Z-ADDWL0020    WAHGCD           Item Code
     C                     MOVELWL0021    WAAJCD           Warehouse Code
      *
     C           KLCHSF    KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAV5ST           Production Type
     C                     KFLD           WAELDT           Production Date
     C                     KFLD           WAHGCD           Item Code
     C                     KFLD           WAAJCD           Warehouse Code
     C           KLCHSF    CHAIN@I8CPUR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI8CPL0'MDACP
     C                     MOVEL'@I8CPUR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDI81    YARDCS
      * Move non-key fields to @I8CPUR
     C                     MOVELWL0022    WAB6ST           PS Item Sched N
      *
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@I8CPUR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDI8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * UPS Rtv Raw Mtrl Avl  RT - PS Production Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WL0027           PS Weight Avail
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSG01           Company Number
     C           *LIKE     DEFN WDV5ST    WQSG02           Production Type
     C           *LIKE     DEFN WDELDT    WQSG03           Production Date
     C           *LIKE     DEFN WDHGCD    WQSG04           Item Code
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Production Type
     C                     KFLD           WQSG03           Production Date
     C                     KFLD           WQSG04           Item Code
      * Setup key
     C                     Z-ADDWL0023    WQSG01           Company Number
     C                     MOVELWL0024    WQSG02           Production Type
     C                     Z-ADDWL0025    WQSG03           Production Date
     C                     Z-ADDWL0026    WQSG04           Item Code
      * Establish starting position
     C           KRSSG     SETLL@I8CPUS                    *
     C           KRSSG     READE@I8CPUS                  90*
      * Data record not found
     C   90                MOVEL'USR1763' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Weight Avail Prod
      * PAR.PS Weight Avail Prod =
      *    *COMPUTE (x4 + (x1 - x2 - x3))
      * x4    : PAR.PS Weight Avail Prod
      * +     : PGM.*Synon (17,7) work field
      * x1    : DB1.PS Weight Planned Prod
      * -     : PGM.*Synon (17,7) work field
      * x2    : DB1.PS Weight Converted
      * -     : PGM.*Synon (17,7) work field
      * x3    : DB1.PS Weight Fab Needs
     C           WDWTSP    SUB  WDWTCN    W0WD02           *Synon (17,7) w
     C           W0WD02    SUB  WDFNWT    W0WD01           *Synon (17,7) w
     C           WL0027    ADD  W0WD01    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WL0027           PS Weight Avail
     C           KRSSG     READE@I8CPUS                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Prd Sch Info   PS RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0028    BZAIC3           Company Number
     C                     Z-ADDWL0029    BZHGCD           Item Code
      * Establish starting position
     C           KRSSH     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0030           Description Lin
     C                     MOVEL*BLANK    WL0031           U/M - Primary
     C                     Z-ADD*ZERO     WL0032           Unit Weight
     C                     Z-ADD*ZERO     WL0033           Item Structure
     C                     Z-ADD*ZERO     WL0034           Item Structure
     C                     Z-ADD*ZERO     WL0035           Item Structure
     C                     MOVEL*BLANK    WL0036           Item Type Code
     C                     MOVEL*BLANK    WL0037           Default Warehou
     C                     Z-ADD*ZERO     WL0038           Fresh Chilling
     C                     MOVEL*BLANK    WL0039           Base/Conv/Loss
     C                     MOVEL*BLANK    WL0040           Variety/Rendere
     C                     MOVEL*BLANK    WL0041           Credit Item Sta
     C                     Z-ADD*ZERO     WL0042           Std Weight/Head
     C                     Z-ADD*ZERO     WL0043           Pieces Per Head
     C                     MOVEL*BLANK    WL0044           Department Code
     C                     MOVEL*BLANK    WL0045           Group for Packa
     C                     MOVEL*BLANK    WL0046           Seconds Item
     C                     MOVEL*BLANK    WL0047           Piece Count Ite
     C                     Z-ADD*ZERO     WL0048           Pieces Per Bag
     C                     Z-ADD*ZERO     WL0049           Bags Per Unit
     C                     MOVEL*BLANK    WL0050           Export/Domestic
     C                     MOVEL*BLANK    WL0051           Print On Schedu
     C                     MOVEL*BLANK    WL0052           Fresh Inv Alloc
     C                     MOVEL*BLANK    WL0053           Fresh Sched As
     C                     MOVEL*BLANK    WL0054           Frozen Sched As
     C                     MOVEL*BLANK    WL0055           Primal Group Co
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBZAVNA    WL0030           Description Lin
     C                     MOVELBZADCD    WL0031           U/M - Primary
     C                     Z-ADDBZAIWG    WL0032           Unit Weight
     C                     Z-ADDBZRINB    WL0033           Item Structure
     C                     Z-ADDBZRHNB    WL0034           Item Structure
     C                     Z-ADDBZRGNB    WL0035           Item Structure
     C                     MOVELBZN0CD    WL0036           Item Type Code
     C                     MOVELBZQ1CD    WL0037           Default Warehou
     C                     Z-ADDBZCHTM    WL0038           Fresh Chilling
     C                     MOVELBZQZCD    WL0039           Base/Conv/Loss
     C                     MOVELBZXWST    WL0040           Variety/Rendere
     C                     MOVELBZVMST    WL0041           Credit Item Sta
     C                     Z-ADDBZSWGH    WL0042           Std Weight/Head
     C                     Z-ADDBZPPHE    WL0043           Pieces Per Head
     C                     MOVELBZR3CD    WL0044           Department Code
     C                     MOVELBZSDCD    WL0045           Group for Packa
     C                     MOVELBZX5ST    WL0046           Seconds Item
     C                     MOVELBZPCCT    WL0047           Piece Count Ite
     C                     Z-ADDBZBDNB    WL0048           Pieces Per Bag
     C                     Z-ADDBZBJNB    WL0049           Bags Per Unit
     C                     MOVELBZSUST    WL0050           Export/Domestic
     C                     MOVELBZSVST    WL0051           Print On Schedu
     C                     MOVELBZSYST    WL0052           Fresh Inv Alloc
     C                     MOVELBZSZST    WL0053           Fresh Sched As
     C                     MOVELBZS1ST    WL0054           Frozen Sched As
     C                     MOVELBZXRCD    WL0055           Primal Group Co
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * BPS Rtv Whs Info      RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0056    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSI     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0057           Warehouse Type
     C                     MOVEL*BLANK    WL0058           Trans Contol AS
     C                     MOVEL*BLANK    WL0059           Warehouse Locat
     C                     MOVEL*BLANK    WL0060           Warehouse Std C
     C                     Z-ADD*ZERO     WL0061           Warehouse Chill
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADWPST    WL0057           Warehouse Type
     C                     MOVELADXUST    WL0058           Trans Contol AS
     C                     MOVELADT0ST    WL0059           Warehouse Locat
     C                     MOVELADT1ST    WL0060           Warehouse Std C
     C                     Z-ADDADDBNB    WL0061           Warehouse Chill
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : UPS BOM FG Conv       PO
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001 112       Weight Consumed
     C                     Z-ADD*ZERO     WN0002  92       Weight Left for
     C                     Z-ADD*ZERO     WN0003  92       Weight 9.2 USR
      *
      * UPS BOM FG Conv       PO: Mainline
     C                     EXSR B0MAIN
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : UPS BOM FG Conv Items PO
      *================================================================
      * CASE: CUR.Weight Order Needs USR is Not Entered
     C           $EORND    IFEQ *ZERO                      *IF
     C                     GOTO UBEXIT                     *QUIT
     C                     END                             *FI
      *
     C                     MOVEL*BLANK    WN0081  3        Item Type Code
     C                     MOVEL*BLANK    WN0082  3        Default Warehou
     C                     MOVEL*BLANK    WN0083  2        Base/Conv/Loss
     C                     MOVEL*BLANK    WN0084  1        Variety/Rendere
     C                     MOVEL*BLANK    WN0085  1        Credit Item Sta
     C                     Z-ADD*ZERO     WN0086  92       Weight 9.2 USR
      *
      * UPS BOM Conv/Fab Dept PO: Mainline
     C                     EXSR C0MAIN
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : UPS BOM Consume RM    PO
      *================================================================
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.BOM Type is Produced - Meat
      *   |- c2    : CUR.Weight 9.2 USR is Not Entered
      *   '-
     C           WBV2ST    IFEQ 'P'                        *IF
     C           $GWTUS    OREQ *ZERO                      *OR
     C                     GOTO UCEXIT                     *QUIT
     C                     END                             *FI
      *
     C                     MOVEL*BLANK    WN0087  3        Default Warehou
     C                     MOVEL*BLANK    WN0088  2        Base/Conv/Loss
     C                     MOVEL*BLANK    WN0089  1        Variety/Rendere
     C                     MOVEL*BLANK    WN0090  1        Credit Item Sta
     C                     Z-ADD*ZERO     WN0091 112       Weight Consumed
      *
      * UPS BOM Cnsm RM Fab   PO: Mainline
     C                     EXSR D0MAIN
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : UPS BOM Conv/Fab Dept PO
      *================================================================
      * CASE: CUR.Weight Order Needs USR is Not Entered
     C           $EORND    IFEQ *ZERO                      *IF
     C                     GOTO UDEXIT                     *QUIT
     C                     END                             *FI
      * CASE: CUR.Weight Order Needs USR LE PAR.Weight Consumed USR
     C           $EORND    IFLE WN0001                     *IF
     C                     GOTO UDEXIT                     *QUIT
     C                     END                             *FI
     C           $EORND    SUB  WN0001    WUORND           Weight Order Ne
      *
     C                     MOVEL*BLANK    WN0092  3        Item Type Code
     C                     MOVEL*BLANK    WN0093  3        Default Warehou
     C                     MOVEL*BLANK    WN0094  2        Base/Conv/Loss
     C                     MOVEL*BLANK    WN0095  1        Variety/Rendere
     C                     MOVEL*BLANK    WN0096  1        Credit Item Sta
     C                     Z-ADD*ZERO     WN0097  92       Weight 9.2 USR
      *
      * UPS BOM Conv/Fab Dept PO: Mainline
     C                     EXSR E0MAIN
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : UPS BOM Consume RM    PO
      *================================================================
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.BOM Type is Produced - Meat
      *   |- c2    : CUR.Weight 9.2 USR is Not Entered
      *   '-
     C           WBV2ST    IFEQ 'P'                        *IF
     C           $MWTUS    OREQ *ZERO                      *OR
     C                     GOTO UEEXIT                     *QUIT
     C                     END                             *FI
      *
     C                     MOVEL*BLANK    WN0098  3        Default Warehou
     C                     MOVEL*BLANK    WN0099  2        Base/Conv/Loss
     C                     MOVEL*BLANK    WN0100  1        Variety/Rendere
     C                     MOVEL*BLANK    WN0101  1        Credit Item Sta
     C                     Z-ADD*ZERO     WN0102 112       Weight Consumed
      *
      * UPS BOM Cnsm RM Fab   PO: Mainline
     C                     EXSR F0MAIN
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : UPS BOM FG Base Cnv   PO
      *================================================================
      * CASE: PAR.Weight Total 13.2     USR GE PAR.Weight Per Day
     C           P3ETWG    IFGE P4DRWG                     *IF
     C                     GOTO UFEXIT                     *QUIT
     C                     END                             *FI
     C                     SUB  P3ETWG    P4DRWG           Weight Per Day
      *
     C                     Z-ADD*ZERO     WN0103  92       Weight 9.2 USR
     C                     Z-ADD*ZERO     WN0104  92       Weight Left for
      *
      * UPS BOM FG Base Cnv   PO: Mainline
     C                     EXSR G0MAIN
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : UPS BOM Cnsm RM Cnv   PO
      *================================================================
      * CASE: WRK.Weight 9.2 USR is LE Zero
     C           WUWTUS    IFLE *ZERO                      *IF
     C                     GOTO UGEXIT                     *QUIT
     C                     END                             *FI
      *
     C                     MOVEL*BLANK    WN0105  3        Default Warehou
     C                     MOVEL*BLANK    WN0106  2        Base/Conv/Loss
     C                     MOVEL*BLANK    WN0107  1        Variety/Rendere
     C                     MOVEL*BLANK    WN0108  1        Credit Item Sta
     C                     Z-ADD*ZERO     WN0109 112       Weight Consumed
      *
      * UPS BOM Cnsm RM Cnv   PO: Mainline
     C                     EXSR H0MAIN
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : UPS Conv Dept Std     PO
      *================================================================
      *
     C                     MOVEL*BLANK    WN0110  3        PS Item Id
     C                     MOVEL*BLANK    WN0111  2        Warehouse Type
     C                     MOVEL*BLANK    WN0112 30        Description Lin
     C                     MOVEL*BLANK    WN0113  2        U/M - Primary
     C                     Z-ADD*ZERO     WN0114 112       Unit Weight
     C                     Z-ADD*ZERO     WN0115  30       Item Structure
     C                     Z-ADD*ZERO     WN0116  30       Item Structure
     C                     Z-ADD*ZERO     WN0117  30       Item Structure
     C                     MOVEL*BLANK    WN0118  3        Item Type Code
     C                     MOVEL*BLANK    WN0119  3        Default Warehou
     C                     Z-ADD*ZERO     WN0120  52       Fresh Chilling
     C                     MOVEL*BLANK    WN0121  2        Base/Conv/Loss
     C                     MOVEL*BLANK    WN0122  1        Variety/Rendere
     C                     MOVEL*BLANK    WN0123  1        Credit Item Sta
     C                     Z-ADD*ZERO     WN0124 112       Std Weight/Head
     C                     Z-ADD*ZERO     WN0125  70       Pieces Per Head
     C                     MOVEL*BLANK    WN0126  1        Group for Packa
     C                     MOVEL*BLANK    WN0127  1        Seconds Item
     C                     Z-ADD*ZERO     WN0128  92       Weight Left for
     C                     Z-ADD*ZERO     WN0129 112       Weight Consumed
      *
      * UPS Conv Dept Std     PO: Mainline
     C                     EXSR I0MAIN
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * Determine Weight Available
      *================================================================
     C                     Z-ADD$YDXWG    $YORND           Weight Order Ne
      * UPS Rtv RM Avail      XF - PS Production Detail  * 
     C                     CALL 'PDCMXFR'              90  UPS Rtv RM Avai
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $YAIC3    WQ0184  30       Company Number
     C                     PARM P2V5ST    WQ0185  1        Production Type
     C                     PARM P2ELDT    WQ0186  70       Production Date
     C                     PARM $YHGCD    WQ0187  70       Item Code
     C           $YE7WG    PARM $YE7WG    WQ0188  92       Weight Availabl
     C           WURFPD    PARM *BLANK    WQ0189  1        Record Found -P
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Availability Comments
      * CASE: WRK.Record Found -PS PD USR is Record Not Found
     C           WURFPD    IFEQ 'N'                        *IF
      * Setup message data for message
      * Retrieve message PS No 1st Level Prod
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR2176' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C           $YNQNA    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: CUR.Weight Available USR is LE Zero
     C           $YE7WG    IFLE *ZERO                      *IF
      * Setup message data for message
      * Retrieve message PS RM not Available
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR2177' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C           $YNQNA    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
     C                     ELSE
      * CASE: CUR.Weight Available USR LT CUR.Weight Order Needs USR
     C           $YE7WG    IFLT $YORND                     *IF
      * Setup message data for message
      * Retrieve message PS Need > Available
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR2178' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C           $YNQNA    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: CUR.Weight Available USR GT CUR.Weight Order Needs USR
     C           $YE7WG    IFGT $YORND                     *IF
     C                     Z-ADD$YORND    WUWTUS           Weight 9.2 USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD$YE7WG    WUWTUS           Weight 9.2 USR
     C                     END                             *FI
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         UJSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : UPS BOM Consume RM    PO
      *================================================================
      * CASE: WRK.Weight 9.2 USR is LE Zero
     C           WUWTUS    IFLE *ZERO                      *IF
     C                     GOTO UJEXIT                     *QUIT
     C                     END                             *FI
      *
     C                     MOVEL*BLANK    WN0131  3        Default Warehou
     C                     MOVEL*BLANK    WN0132  2        Base/Conv/Loss
     C                     MOVEL*BLANK    WN0133  1        Variety/Rendere
     C                     MOVEL*BLANK    WN0134  1        Credit Item Sta
     C                     Z-ADD*ZERO     WN0135 112       Weight Consumed
      *
      * UPS BOM Cnsm RM Fab   PO: Mainline
     C                     EXSR J0MAIN
      *================================================================
     CSR         UJEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZBINIT    BEGSR
      *================================================================
      * UPS BOM FG Conv       PO: Initialise
      *================================================================
      * USER: Initialize program
      * PAR = CON By name
     C                     Z-ADD*ZERO     P3ETWG           Weight Total 13
     C                     Z-ADD*ZERO     WN0001           Weight Consumed
     C                     Z-ADD*ZERO     WN0002           Weight Left for
     C                     Z-ADD*ZERO     WN0003           Weight 9.2 USR
      *================================================================
     CSR         ZBEXIT    ENDSR
      /EJECT
     CSR         ZCINIT    BEGSR
      *================================================================
      * UPS BOM Conv/Fab Dept PO: Initialise
      *================================================================
      * USER: Initialize program
      * CASE: PAR.BOM Process USR is Re-Process
     C           'F'       IFEQ 'R'                        *IF
     C                     Z-ADD$EORND    WUE6WG           Weight Total Ne
     C                     END                             *FI
      *================================================================
     CSR         ZCEXIT    ENDSR
      /EJECT
     CSR         ZDINIT    BEGSR
      *================================================================
      * UPS BOM Cnsm RM Fab   PO: Initialise
      *================================================================
      * USER: Initialize program
     C                     Z-ADD$GWTUS    WUAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WN0091           Weight Consumed
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZEINIT    BEGSR
      *================================================================
      * UPS BOM Conv/Fab Dept PO: Initialise
      *================================================================
      * USER: Initialize program
      * CASE: PAR.BOM Process USR is Re-Process
     C           'R'       IFEQ 'R'                        *IF
     C                     Z-ADDWUORND    WUE6WG           Weight Total Ne
     C                     END                             *FI
      *================================================================
     CSR         ZEEXIT    ENDSR
      /EJECT
     CSR         ZFINIT    BEGSR
      *================================================================
      * UPS BOM Cnsm RM Fab   PO: Initialise
      *================================================================
      * USER: Initialize program
     C                     Z-ADD$MWTUS    WUAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WN0102           Weight Consumed
      *================================================================
     CSR         ZFEXIT    ENDSR
      /EJECT
     CSR         ZHINIT    BEGSR
      *================================================================
      * UPS BOM Cnsm RM Cnv   PO: Initialise
      *================================================================
      * USER: Initialize program
     C                     Z-ADDWUWTUS    WUAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WN0109           Weight Consumed
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZIINIT    BEGSR
      *================================================================
      * UPS Conv Dept Std     PO: Initialise
      *================================================================
      * USER: Initialize program
     C                     MOVEL'Y'       WUTAST           First Time Flag
     C                     Z-ADD*ZERO     WUWLSD           Weight Left for
     C                     MOVEL'N'       WUQKST           Display Flag
      *================================================================
     CSR         ZIEXIT    ENDSR
      /EJECT
     CSR         ZJINIT    BEGSR
      *================================================================
      * UPS BOM Cnsm RM Fab   PO: Initialise
      *================================================================
      * USER: Initialize program
     C                     Z-ADDWUWTUS    WUAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WN0135           Weight Consumed
      *================================================================
     CSR         ZJEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P3ETWG           Weight Total 13
     C                     Z-ADD*ZERO     P4DRWG           Weight Per Day
      *
      * Initialise indicators for re-entry
     C                     MOVE '0'       *IN
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    I5AIC3           Company Number
     C                     MOVEL*LOVAL    I5R3CD           Department Code
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    I8AIC3           Company Number
     C                     MOVEL*LOVAL    I8V5ST           Production Type
     C                     MOVEL*LOVAL    I8ELDT           Production Date
     C                     MOVEL*LOVAL    I8R3CD           Department Code
     C                     MOVEL*LOVAL    I8HGCD           Item Code
     C                     MOVEL*LOVAL    I8AJCD           Warehouse Code
      * Define work field Description Line Two
     C                     MOVEL*BLANK    WUAWNA 30
      * Define work field U/M - Primary
     C                     MOVEL*BLANK    WUADCD  2
      * Define work field U/M - Second
     C                     MOVEL*BLANK    WUAECD  2
      * Define work field U/M - Third
     C                     MOVEL*BLANK    WUAFCD  2
      * Define work field Record Found USR
     C                     MOVEL*BLANK    WUWXST  1
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAELDT           Production Date
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WAGPDT           PS Available Sh
     C                     Z-ADD*ZERO     WAWTSP           PS Weight Plann
     C                     Z-ADD*ZERO     WAQTSP           PS Pieces Plann
     C                     Z-ADD*ZERO     WADJPC           PS % of Carcass
     C                     Z-ADD*ZERO     WAF8WG           PS Avg Piece Wg
     C                     Z-ADD*ZERO     WAWTIN           PS Weight Inv O
     C                     Z-ADD*ZERO     WAD5NB           PS Pieces Inv O
     C                     Z-ADD*ZERO     WADXWG           PS Weight Stand
     C                     Z-ADD*ZERO     WAB2NB           PS Pieces Stand
     C                     Z-ADD*ZERO     WAWTCN           PS Weight Conve
     C                     Z-ADD*ZERO     WAPSCV           PS Pieces Conve
     C                     Z-ADD*ZERO     WASAWT           PS Weight Shipp
     C                     Z-ADD*ZERO     WAB9NB           PS Pieces Shipp
     C                     Z-ADD*ZERO     WAD1WG           PS Weight Prod
     C                     Z-ADD*ZERO     WACBNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WAEZWG           PS Weight Inv A
     C                     Z-ADD*ZERO     WACCNB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WAE0WG           PS Weight Ship
     C                     Z-ADD*ZERO     WAD6NB           PS Pieces Ship
     C                     Z-ADD*ZERO     WAOAWT           PS Weight Prod
     C                     Z-ADD*ZERO     WACDNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WAUNW2           PS Weight Inv A
     C                     Z-ADD*ZERO     WACENB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WAF9WG           PS Unit Weight
     C                     Z-ADD*ZERO     WABPNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WAGAWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WABQNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WAGBWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WABRNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WAGCWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WABSNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WAGDWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WABWNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WAGEWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WAPS6U           PS Pieces Unuse
     C                     Z-ADD*ZERO     WADVWG           PS Weight Order
     C                     Z-ADD*ZERO     WAD7NB           PS Pieces Order
     C                     Z-ADD*ZERO     WAFCAD           PS Weight FC Ad
     C                     Z-ADD*ZERO     WAD9NB           PS Pieces FC Ad
     C                     Z-ADD*ZERO     WADWWG           PS Weight FX Ad
     C                     Z-ADD*ZERO     WAEANB           PS Pieces FX Ad
     C                     Z-ADD*ZERO     WASHWT           PS Weight Sched
     C                     Z-ADD*ZERO     WAEBNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WAAVWT           PS Weight Avail
     C                     Z-ADD*ZERO     WAECNB           PS Pieces Avail
     C                     Z-ADD*ZERO     WAWTON           PS Weight Produ
     C                     Z-ADD*ZERO     WAEDNB           PS Pieces Produ
     C                     Z-ADD*ZERO     WAFNWT           PS Weight Fab N
     C                     Z-ADD*ZERO     WAEENB           PS Pieces Fab N
     C                     Z-ADD*ZERO     WAQTAS           PS Weight Sched
     C                     Z-ADD*ZERO     WAEFNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WAWAIO           PS Weight Sched
     C                     Z-ADD*ZERO     WAEGNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBC9NB           Component Item
     C                     Z-ADD*ZERO     WBBOPR           Sales Yield
     C                     Z-ADD*ZERO     WBBPPR           Production Yiel
     C                     Z-ADD*ZERO     WBHGQT           Packaging Quant
     C                     Z-ADD*ZERO     WBCNSM           Consume Priorit
     C                     Z-ADD*ZERO     WBBMY1           Consume Priorit
     C                     Z-ADD*ZERO     WBBMY2           BOM Unused % 2
     C                     Z-ADD*ZERO     WBIXQT           BOM Unused Qty
     C                     Z-ADD*ZERO     WBIYQT           BOM Unused Qty
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field Weight Total Need USR
     C                     Z-ADD*ZERO     WUE6WG  92
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    WBAIC3           Company Number
     C                     MOVEL*LOVAL    WBHGCD           Item Code
     C                     MOVEL*LOVAL    WBV2ST           BOM Type
     C                     MOVEL*LOVAL    WBCNSM           Consume Priorit
     C                     MOVEL*LOVAL    WBC9NB           Component Item
      * Define work field Weight Scheduled
     C                     Z-ADD*ZERO     WUAUWG 112
      * Define work field Record Found -PS PD USR
     C                     MOVEL*BLANK    WURFPD  1
      * Define work field Weight Allocated USR
     C                     Z-ADD*ZERO     WUE1WG  92
      * Define work field Unit Weight
     C                     Z-ADD*ZERO     WUAIWG 112
      * Define work field Item Structure Class Code
     C                     Z-ADD*ZERO     WURINB  30
      * Define work field Item Structure Group Code
     C                     Z-ADD*ZERO     WURHNB  30
      * Define work field Item Structure Type Code
     C                     Z-ADD*ZERO     WURGNB  30
      * Define work field Fresh Chilling Time
     C                     Z-ADD*ZERO     WUCHTM  52
      * Define work field Std Weight/Head (Var/Ren)
     C                     Z-ADD*ZERO     WUSWGH 112
      * Define work field Pieces Per Head
     C                     Z-ADD*ZERO     WUPPHE  70
      * Define work field Group for Packaging
     C                     MOVEL*BLANK    WUSDCD  1
      * Define work field Seconds Item
     C                     MOVEL*BLANK    WUX5ST  1
      * Define work field Warehouse Type
     C                     MOVEL*BLANK    WUWPST  2
      * Define work field PS Item Id
     C                     MOVEL*BLANK    WUWCST  3
      * Define work field Percent 7.4 USR
     C                     Z-ADD*ZERO     WUD4PC  74
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    WCAIC3           Company Number
     C                     MOVEL*LOVAL    WCHGCD           Item Code
     C                     MOVEL*LOVAL    WCV2ST           BOM Type
     C                     MOVEL*LOVAL    WCC9NB           Component Item
      * Define work field Item Type Code
     C                     MOVEL*BLANK    WUN0CD  3
      * Define work field Weight Order Needs USR
     C                     Z-ADD*ZERO     WUORND  92
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    WBAIC3           Company Number
     C                     MOVEL*LOVAL    WBHGCD           Item Code
     C                     MOVEL*LOVAL    WBV2ST           BOM Type
     C                     MOVEL*LOVAL    WBCNSM           Consume Priorit
     C                     MOVEL*LOVAL    WBC9NB           Component Item
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    WCAIC3           Company Number
     C                     MOVEL*LOVAL    WCHGCD           Item Code
     C                     MOVEL*LOVAL    WCV2ST           BOM Type
     C                     MOVEL*LOVAL    WCC9NB           Component Item
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    WEAIC3           Company Number
     C                     MOVEL*LOVAL    WEV5ST           Production Type
     C                     MOVEL*LOVAL    WEELDT           Production Date
     C                     MOVEL*LOVAL    WER3CD           Department Code
     C                     MOVEL*LOVAL    WEHGCD           Item Code
     C                     MOVEL*LOVAL    WEAJCD           Warehouse Code
      * Define work field Weight 9.2 USR
     C                     Z-ADD*ZERO     WUWTUS  92
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    WCAIC3           Company Number
     C                     MOVEL*LOVAL    WCHGCD           Item Code
     C                     MOVEL*LOVAL    WCV2ST           BOM Type
     C                     MOVEL*LOVAL    WCC9NB           Component Item
      * Define work field PS Item Sched Need Sts
     C                     MOVEL*BLANK    WUB6ST  2
      * Define work field First Time Flag
     C                     MOVEL*BLANK    WUTAST  1
      * Define work field Weight Left for Std USR
     C                     Z-ADD*ZERO     WUWLSD  92
      * Define work field Display Flag
     C                     MOVEL*BLANK    WUQKST  1
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    I6AIC3           Company Number
     C                     MOVEL*LOVAL    I6R3CD           Department Code
     C                     MOVEL*HIVAL    I6GJDT           Effective Produ
     C                     MOVEL*LOVAL    I6MXPR           Mix Priority
     C                     MOVEL*LOVAL    I6HGCD           Item Code
      * Define work field Piece Count Item
     C                     MOVEL*BLANK    WUPCCT  1
      * Define work field Pieces Per Bag
     C                     Z-ADD*ZERO     WUBDNB  70
      * Define work field Bags Per Unit
     C                     Z-ADD*ZERO     WUBJNB  70
      * Define work field Export/Domestic
     C                     MOVEL*BLANK    WUSUST  1
      * Define work field Print On Schedule
     C                     MOVEL*BLANK    WUSVST  1
      * Define work field Fresh Inv Allocation Seq
     C                     MOVEL*BLANK    WUSYST  1
      * Define work field Fresh Sched As Ordered
     C                     MOVEL*BLANK    WUSZST  1
      * Define work field Frozen Sched As Ordered
     C                     MOVEL*BLANK    WUS1ST  1
      * Define work field Trans Contol AS400/Plant
     C                     MOVEL*BLANK    WUXUST  1
      * Define work field Warehouse Location
     C                     MOVEL*BLANK    WUT0ST  1
      * Define work field Warehouse Std Chill Time
     C                     MOVEL*BLANK    WUT1ST  1
      * Define work field Warehouse Chill Time
     C                     Z-ADD*ZERO     WUDBNB  52
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    WCAIC3           Company Number
     C                     MOVEL*LOVAL    WCHGCD           Item Code
     C                     MOVEL*LOVAL    WCV2ST           BOM Type
     C                     MOVEL*LOVAL    WCC9NB           Component Item
      * Define work field Effective Production Date
     C                     Z-ADD*ZERO     WUGJDT  70
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WB01 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     MOVEL*BLANK    WL0002  6
     C                     Z-ADD*ZERO     WL0003  70
     C                     Z-ADD*ZERO     WL0004  70
      * Define local variables for subroutine SDRVGN.
     C                     Z-ADD*ZERO     WL0005  30
     C                     Z-ADD*ZERO     WL0006  70
     C                     MOVEL*BLANK    WL0007 30
     C                     MOVEL*BLANK    WL0008 30
     C                     MOVEL*BLANK    WL0009  2
     C                     MOVEL*BLANK    WL0010  2
     C                     MOVEL*BLANK    WL0011  2
      * Define local variables for subroutine SERVGN.
     C                     Z-ADD*ZERO     WL0012  30
     C                     Z-ADD*ZERO     WL0013  70
     C                     Z-ADD*ZERO     WL0014  70
     C                     Z-ADD*ZERO     WL0015  52
     C                     MOVEL*BLANK    WL0016  1
      * Define local variables for subroutine SFCHRC.
     C                     Z-ADD*ZERO     WL0017  30
     C                     MOVEL*BLANK    WL0018  1
     C                     Z-ADD*ZERO     WL0019  70
     C                     Z-ADD*ZERO     WL0020  70
     C                     MOVEL*BLANK    WL0021  3
     C                     MOVEL*BLANK    WL0022  2
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0023  30
     C                     MOVEL*BLANK    WL0024  1
     C                     Z-ADD*ZERO     WL0025  70
     C                     Z-ADD*ZERO     WL0026  70
     C                     Z-ADD*ZERO     WL0027  92
      * Define local variables for subroutine SHRVGN.
     C                     Z-ADD*ZERO     WL0028  30
     C                     Z-ADD*ZERO     WL0029  70
     C                     MOVEL*BLANK    WL0030 30
     C                     MOVEL*BLANK    WL0031  2
     C                     Z-ADD*ZERO     WL0032 112
     C                     Z-ADD*ZERO     WL0033  30
     C                     Z-ADD*ZERO     WL0034  30
     C                     Z-ADD*ZERO     WL0035  30
     C                     MOVEL*BLANK    WL0036  3
     C                     MOVEL*BLANK    WL0037  3
     C                     Z-ADD*ZERO     WL0038  52
     C                     MOVEL*BLANK    WL0039  2
     C                     MOVEL*BLANK    WL0040  1
     C                     MOVEL*BLANK    WL0041  1
     C                     Z-ADD*ZERO     WL0042 112
     C                     Z-ADD*ZERO     WL0043  70
     C                     MOVEL*BLANK    WL0044  6
     C                     MOVEL*BLANK    WL0045  1
     C                     MOVEL*BLANK    WL0046  1
     C                     MOVEL*BLANK    WL0047  1
     C                     Z-ADD*ZERO     WL0048  70
     C                     Z-ADD*ZERO     WL0049  70
     C                     MOVEL*BLANK    WL0050  1
     C                     MOVEL*BLANK    WL0051  1
     C                     MOVEL*BLANK    WL0052  1
     C                     MOVEL*BLANK    WL0053  1
     C                     MOVEL*BLANK    WL0054  1
     C                     MOVEL*BLANK    WL0055  6
      * Define local variables for subroutine SIRVGN.
     C                     MOVEL*BLANK    WL0056  3
     C                     MOVEL*BLANK    WL0057  2
     C                     MOVEL*BLANK    WL0058  1
     C                     MOVEL*BLANK    WL0059  1
     C                     MOVEL*BLANK    WL0060  1
     C                     Z-ADD*ZERO     WL0061  52
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * VAL Rtv & Ctr Prt Hdg  IF
      * SET Setup Prt Headings IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SARVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * Center Txt String 40 - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * Move Appl Desc to Prt co - /UT User Source  * 
     C                     MOVE WUDE40    $ACMP
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
