/********************************************************************/
/*                                                                  */
/*  SYNOPSIS -  BUILD STATEMENT TO CREATE THE SEQUEL VIEWS          */
/*              THAT WILL CREATE THE REQUESTED SPREADSHEETS AND     */
/*              EMAIL THEM TO THE PASSED IN EMAIL ADDRESS.          */
/*                                                                  */
/*  COMPANY   - SEABOARD CORP                                       */
/*  SYSTEM    - HPE                                                 */
/*  DATE      - 08/04/2008                                          */
/*                                                                  */
/*  NOTE      - THIS PROGRAM DOES NOT PRINT A REPORT, IT            */
/*              EXECUTES ONE OF FOUR SEQUEL VIEWS THAT CREATE       */
/*              EXCEL SPREADSHEETS THAT ARE THEN EMAILED            */
/*                                                                  */
/********************************************************************/
/*  MODIFICATIONS:                                                  */
/*                                                                  */
/********************************************************************/
/*  PARAMETERS RECEIVED:                                            */
/*                                                                  */
/*   &COMPN      - COMPANY NUMBER                                   */
/*   &FROMDTA    - FROM DATE                                        */
/*   &THRUDTA    - TO DATE                                          */
/*   &TYPE       - REPORT TYPE                                      */
/*   &PROD       - PRODUCER        (BLANK = ALL)                    */
/*   &LOCAT      - LOCATION        (BLANK = ALL)                    */
/*   &EMAIL      - EMAIL ADDRESS                                    */
/********************************************************************/
 PLMLUPC:    PGM        PARM(&COMPN &FROMDTA &THRUDTA &TYPE &PROD +
                          &LOCAT &EMAIL)

             DCL        &COMPN      *DEC
             DCL        &COMP       *DEC     LEN(3 0)
             DCL        &COMPA      *CHAR    3
             DCL        &FROMDTA    *CHAR    7
             DCL        &FROMDT     *DEC     LEN(7 0)
             DCL        &THRUDTA    *CHAR    7
             DCL        &TODT       *DEC     LEN(7 0)
             DCL        &TYPE       *CHAR    1  /* REPORT TYPE       */
             DCL        &PROD       *CHAR    6  /* PRODUCER          */
             DCL        &LOCAT      *CHAR    6  /* LOCATION          */
             DCL        &EMAIL      *CHAR    50 /*  EMAIL ADDRESS    */
             DCL        &TEXT       *CHAR    80 /*  EMAIL TEXT       */

/********************************************************************/
/* FORMAT NUMERIC TO ALPHA FOR QUERY                                */
/********************************************************************/
             CHGVAR     VAR(&COMP) VALUE(&COMPN)
             CHGVAR     VAR(&COMPA) VALUE(&COMP)
             CHGVAR     VAR(&FROMDT) VALUE(&FROMDTA)
             CHGVAR     VAR(&TODT) VALUE(&THRUDTA)

/********************  EXECUTE SQL AND EMAIL *************************/
/* REPORT TYPE 1 - ALL FIELDS WERE PASSED IN                         */

             IF         COND(&TYPE *EQ '1') THEN(DO)
             CHGVAR     VAR(&TEXT) VALUE('Buy Order and Load +
                          Download for' *BCAT &FROMDTA *BCAT +
                          'through' *BCAT &THRUDTA *BCAT 'for' +
                          *BCAT &PROD *BCAT 'and' *BCAT &LOCAT)

             EXECUTE    VIEW(          PKAWCPP) PCFMT(*XLS) +
                          RECIPIENT(&EMAIL) EMLMSG(&TEXT) +
                          SETVAR((&COMP &COMPA) (&PROD &PROD) +
                          (&LOCAT &LOCAT) (&FROMDT &FROMDTA) +
                          (&TODT &THRUDTA))
             GOTO       CMDLBL(END)
             ENDDO

/********************  EMAIL REPORT TYPE 2  **************************/
/* REPORT TYPE 2 - COMPANY, FROM & TO DATES, PRODUCER                */

             IF         COND(&TYPE *EQ '2') THEN(DO)
             CHGVAR     VAR(&TEXT) VALUE('Buy Order and Load +
                          Download for' *BCAT &FROMDTA *BCAT +
                          'through' *BCAT &THRUDTA *BCAT 'for' +
                          *BCAT &PROD)

             EXECUTE    VIEW(          PKAWCPP2) PCFMT(*XLS) +
                          RECIPIENT(&EMAIL) EMLMSG(&TEXT) +
                          SETVAR((&COMP &COMPA) (&FROMDT &FROMDTA) +
                          (&TODT &THRUDTA) (&PROD &PROD))
             GOTO       CMDLBL(END)
             ENDDO

/********************  EMAIL REPORT TYPE 3  **************************/
/* REPORT TYPE 3 - COMPANY, FROM & TO DATES, LOCATION                */

             IF         COND(&TYPE *EQ '3') THEN(DO)
             CHGVAR     VAR(&TEXT) VALUE('Buy Order and Load +
                          Download for' *BCAT &FROMDTA *BCAT +
                          'through' *BCAT &THRUDTA *BCAT 'for' +
                          *BCAT &LOCAT)

             EXECUTE    VIEW(          PKAWCPP3) PCFMT(*XLS) +
                          RECIPIENT(&EMAIL) EMLMSG(&TEXT) +
                          SETVAR((&COMP &COMPA) (&FROMDT &FROMDTA) +
                          (&TODT &THRUDTA) (&LOCAT &LOCAT))
             GOTO       CMDLBL(END)
             ENDDO

/********************  EMAIL REPORT TYPE 4  **************************/
/* REPORT TYPE 4 - COMPANY, FROM & TO DATES                          */

             IF         COND(&TYPE *EQ '4') THEN(DO)
             CHGVAR     VAR(&TEXT) VALUE('Buy Order and Load +
                          Download for' *BCAT &FROMDTA *BCAT +
                          'through' *BCAT &THRUDTA)

             EXECUTE    VIEW(          PKAWCPP4) PCFMT(*XLS) +
                          RECIPIENT(&EMAIL) EMLMSG(&TEXT) +
                          SETVAR((&COMP &COMPA) (&FROMDT &FROMDTA) +
                          (&TODT &THRUDTA))
             GOTO       CMDLBL(END)
             ENDDO

 END:        ENDPGM
