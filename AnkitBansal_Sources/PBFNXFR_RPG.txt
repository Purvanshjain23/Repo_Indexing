     H/TITLE RTV Multi TPM CustomersXF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISPJAKH
     H* Date          : 04/12/24  Time  : 07:21:27
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCABBRELMIF  E           K        DISK
      * RSQ : Customer Master           TPM Loc Code/Customer
      *
     I@BBREOM
      * Customer Master           TPM Loc Code/Customer
      * Renamed input format fields
     I              BBBKC7                          WABKC7
     I              BBAYTX                          WAAYTX
     I              BBACNA                          WAACNA
     I              BBADNA                          WAADNA
     I              BBAENA                          WAAENA
     I              BBAJNA                          WAAJNA
     I              BBBGCD                          WABGCD
     I              BBG5CD                          WAG5CD
     I              BBBTTX                          WABTTX
     I              BBBVTX                          WABVTX
     I              BBBWTX                          WABWTX
     I              BBABTX                          WAABTX
     I              BBA2NA                          WAA2NA
     I              BBCBST                          WACBST
     I              BBB0NA                          WAB0NA
     I              BBP3NB                          WAP3NB
     I              BBAXNA                          WAAXNA
     I              BBI6DT                          WAI6DT
     I              BBAYDT                          WAAYDT
     I              BBANC7                          WAANC7
     I              BBBTC7                          WABTC7
     I              BBK6ST                          WAK6ST
     I              BBUZST                          WAUZST
     I              BBKXCD                          WAKXCD
     I              BBLTCD                          WALTCD
     I              BBQNST                          WAQNST
     I              BBS2NB                          WAS2NB
     I              BBVHVA                          WAVHVA
     I              BBI7DT                          WAI7DT
     I              BBRJST                          WARJST
     I              BBRKST                          WARKST
     I              BBQWST                          WAQWST
     I              BBQXST                          WAQXST
     I              BBQYST                          WAQYST
     I              BBUNCS                          WAUNCS
     I              BBUVST                          WAUVST
     I              BBUWST                          WAUWST
     I              BBUXST                          WAUXST
     I              BBVSST                          WAVSST
     I              BBAATM                          WAAATM
     I              BBAYNA                          WAAYNA
     I              BBA0NA                          WAA0NA
     I              BBAXDT                          WAAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * I : RST TPM Location Code
     I                                        1  10 P1PYAA
      * I : RST TPM Facility Type
     I                                       11  34 P1PXAA
      * B :  Customer Number USR 1
     I                                    P  35  380P1V5NY
      * B :  Customer Number USR 2
     I                                    P  39  420P1V6NY
      * B :  Customer Number USR 3
     I                                    P  43  460P1V7NY
      * B :  Customer Number USR 4
     I                                    P  47  500P1V8NY
      * B :  Customer Number USR 5
     I                                    P  51  540P1V9NY
      * B :  Customer Number USR 6
     I                                    P  55  580P1WANY
      * B :  Customer Number USR 7
     I                                    P  59  620P1WBNY
      * B :  Customer Number USR 8
     I                                    P  63  660P1WCNY
      * B :  Customer Number USR 9
     I                                    P  67  700P1WDNY
      * B :  Customer Number USR 10
     I                                    P  71  740P1WENY
      * B :  Customer Number USR 11
     I                                    P  75  780P1WFNY
      * B :  Customer Number USR 12
     I                                    P  79  820P1WGNY
      * B :  Customer Number USR 13
     I                                    P  83  860P1WHNY
      * B :  Customer Number USR 14
     I                                    P  87  900P1WINY
      * B :  Customer Number USR 15
     I                                    P  91  940P1WJNY
      * B :  Customer Number USR 16
     I                                    P  95  980P1WKNY
      * B :  Customer Number USR 17
     I                                    P  99 1020P1WLNY
      * B :  Customer Number USR 18
     I                                    P 103 1060P1WMNY
      * B :  Customer Number USR 19
     I                                    P 107 1100P1WNNY
      * B :  Customer Number USR 20
     I                                    P 111 1140P1WONY
      * B :  Customer Number USR 21
     I                                    P 115 1180P1WPNY
      * B :  Customer Number USR 22
     I                                    P 119 1220P1WQNY
      * B :  Customer Number USR 23
     I                                    P 123 1260P1WRNY
      * B :  Customer Number USR 24
     I                                    P 127 1300P1WSNY
      * B :  Customer Number USR 25
     I                                    P 131 1340P1WTNY
      * B :  Customer Number USR 26
     I                                    P 135 1380P1WUNY
      * B :  Customer Number USR 27
     I                                    P 139 1420P1WVNY
      * I :  Customer Number       NBR
     I                                    P 143 1460P1AJNB
     IP2PARM      DS
      * B :  Record Selected       USR
     I                                        1   1 P2ZZST
     IP3PARM      DS
      * B :  Count USR
     I                                    P   1   30P3CNTU
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1PYAA    PARM           WP0001 10        TPM Location Co
     C           P1PXAA    PARM           WP0002 24        TPM Facility Ty
     C           P1V5NY    PARM P1V5NY    WP0003  70       Customer Number
     C           P1V6NY    PARM P1V6NY    WP0004  70       Customer Number
     C           P1V7NY    PARM P1V7NY    WP0005  70       Customer Number
     C           P1V8NY    PARM P1V8NY    WP0006  70       Customer Number
     C           P1V9NY    PARM P1V9NY    WP0007  70       Customer Number
     C           P1WANY    PARM P1WANY    WP0008  70       Customer Number
     C           P1WBNY    PARM P1WBNY    WP0009  70       Customer Number
     C           P1WCNY    PARM P1WCNY    WP0010  70       Customer Number
     C           P1WDNY    PARM P1WDNY    WP0011  70       Customer Number
     C           P1WENY    PARM P1WENY    WP0012  70       Customer Number
     C           P1WFNY    PARM P1WFNY    WP0013  70       Customer Number
     C           P1WGNY    PARM P1WGNY    WP0014  70       Customer Number
     C           P1WHNY    PARM P1WHNY    WP0015  70       Customer Number
     C           P1WINY    PARM P1WINY    WP0016  70       Customer Number
     C           P1WJNY    PARM P1WJNY    WP0017  70       Customer Number
     C           P1WKNY    PARM P1WKNY    WP0018  70       Customer Number
     C           P1WLNY    PARM P1WLNY    WP0019  70       Customer Number
     C           P1WMNY    PARM P1WMNY    WP0020  70       Customer Number
     C           P1WNNY    PARM P1WNNY    WP0021  70       Customer Number
     C           P1WONY    PARM P1WONY    WP0022  70       Customer Number
     C           P1WPNY    PARM P1WPNY    WP0023  70       Customer Number
     C           P1WQNY    PARM P1WQNY    WP0024  70       Customer Number
     C           P1WRNY    PARM P1WRNY    WP0025  70       Customer Number
     C           P1WSNY    PARM P1WSNY    WP0026  70       Customer Number
     C           P1WTNY    PARM P1WTNY    WP0027  70       Customer Number
     C           P1WUNY    PARM P1WUNY    WP0028  70       Customer Number
     C           P1WVNY    PARM P1WVNY    WP0029  70       Customer Number
     C           P1AJNB    PARM           WP0030  70       Customer Number
     C           P2ZZST    PARM P2ZZST    WP0031  1        Record Selected
     C           P3CNTU    PARM P3CNTU    WP0032  50       Count USR
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * RTV Multi TPM CustomersXF
      * Modification Log
     C                     EXSR UASUBR                     Modification Lo
      * RTV Multi TPM CustomersIF
      * CASE: PAR.TPM Location Code NE WRK.Blank for 12          USR
     C           P1PYAA    IFNE WUS3TX                     *IF
     C                     MOVEL'N'       P2ZZST           Record Selected
     C                     MOVEL*BLANK    WUABTX           Alpha Search
     C                     MOVELP1PYAA    WUABTX           Alpha Search
      * RTV Multi TPM CustomersRT - Customer  * 
     C                     EXSR SARVGN
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Multi TPM CustomersRT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       P2ZZST           Record Selected
     C                     Z-ADD*ZERO     P3CNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAABTX    WQSA01           Alpha Search
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Alpha Search
      * Setup key
     C                     MOVELWUABTX    WQSA01           Alpha Search
      * Establish starting position
     C           KRSSA     SETLL@BBREOM                    *
     C           KRSSA     READE@BBREOM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     MOVEL'N'       P2ZZST           Record Selected
     C                     Z-ADDP1AJNB    P1V5NY           Customer Number
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Pass back all customers except matching, to prevent duplicates
      * Put Ship To from the screen into the 1st position
      * CASE: PAR.Ship To Customer is not equal to zero
     C           P1AJNB    IFNE 0                          *IF
     C                     Z-ADDP1AJNB    P1V5NY           Customer Number
     C                     MOVEL'Y'       P2ZZST           Record Selected
     C                     END                             *FI
      * Populate assigned customer numbers
      * CASE: PAR.Customer Number USR 1 is equal 0
     C           P1V5NY    IFEQ 0                          *IF
     C                     Z-ADDWABKC7    P1V5NY           Customer Number
     C                     Z-ADD1         P3CNTU           Count USR
     C                     MOVEL'Y'       P2ZZST           Record Selected
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Customer Number USR 2 is equal 0
      *   |- c2    : DB1.Ship To Customer NE PAR.Ship To Customer
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1V6NY    IFEQ 0                          *IF
     C           WABKC7    IFNE P1AJNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWABKC7    P1V6NY           Customer Number
     C                     Z-ADD2         P3CNTU           Count USR
     C                     MOVEL'Y'       P2ZZST           Record Selected
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Customer Number USR 3 is equal 0
      *   |- c2    : DB1.Ship To Customer NE PAR.Ship To Customer
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1V7NY    IFEQ 0                          *IF
     C           WABKC7    IFNE P1AJNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWABKC7    P1V7NY           Customer Number
     C                     Z-ADD3         P3CNTU           Count USR
     C                     MOVEL'Y'       P2ZZST           Record Selected
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Customer Number USR 4 is equal 0
      *   |- c2    : DB1.Ship To Customer NE PAR.Ship To Customer
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1V8NY    IFEQ 0                          *IF
     C           WABKC7    IFNE P1AJNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWABKC7    P1V8NY           Customer Number
     C                     Z-ADD4         P3CNTU           Count USR
     C                     MOVEL'Y'       P2ZZST           Record Selected
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Customer Number USR 5 is equal 0
      *   |- c2    : DB1.Ship To Customer NE PAR.Ship To Customer
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1V9NY    IFEQ 0                          *IF
     C           WABKC7    IFNE P1AJNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWABKC7    P1V9NY           Customer Number
     C                     Z-ADD5         P3CNTU           Count USR
     C                     MOVEL'Y'       P2ZZST           Record Selected
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Customer Number USR 6 is equal 0
      *   |- c2    : DB1.Ship To Customer NE PAR.Ship To Customer
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1WANY    IFEQ 0                          *IF
     C           WABKC7    IFNE P1AJNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWABKC7    P1WANY           Customer Number
     C                     Z-ADD6         P3CNTU           Count USR
     C                     MOVEL'Y'       P2ZZST           Record Selected
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Customer Number USR 7 is equal 0
      *   |- c2    : DB1.Ship To Customer NE PAR.Ship To Customer
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1WBNY    IFEQ 0                          *IF
     C           WABKC7    IFNE P1AJNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWABKC7    P1WBNY           Customer Number
     C                     Z-ADD7         P3CNTU           Count USR
     C                     MOVEL'Y'       P2ZZST           Record Selected
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Customer Number USR 8 is equal 0
      *   |- c2    : DB1.Ship To Customer NE PAR.Ship To Customer
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1WCNY    IFEQ 0                          *IF
     C           WABKC7    IFNE P1AJNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWABKC7    P1WCNY           Customer Number
     C                     Z-ADD8         P3CNTU           Count USR
     C                     MOVEL'Y'       P2ZZST           Record Selected
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Customer Number USR 9 is equal 0
      *   |- c2    : DB1.Ship To Customer NE PAR.Ship To Customer
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1WDNY    IFEQ 0                          *IF
     C           WABKC7    IFNE P1AJNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWABKC7    P1WDNY           Customer Number
     C                     Z-ADD9         P3CNTU           Count USR
     C                     MOVEL'Y'       P2ZZST           Record Selected
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Customer Number USR 10 is equal 0
      *   |- c2    : DB1.Ship To Customer NE PAR.Ship To Customer
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1WENY    IFEQ 0                          *IF
     C           WABKC7    IFNE P1AJNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWABKC7    P1WENY           Customer Number
     C                     Z-ADD10        P3CNTU           Count USR
     C                     MOVEL'Y'       P2ZZST           Record Selected
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Customer Number USR 11 is equal 0
      *   |- c2    : DB1.Ship To Customer NE PAR.Ship To Customer
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1WFNY    IFEQ 0                          *IF
     C           WABKC7    IFNE P1AJNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWABKC7    P1WFNY           Customer Number
     C                     Z-ADD11        P3CNTU           Count USR
     C                     MOVEL'Y'       P2ZZST           Record Selected
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Customer Number USR 12 is equal 0
      *   |- c2    : DB1.Ship To Customer NE PAR.Ship To Customer
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1WGNY    IFEQ 0                          *IF
     C           WABKC7    IFNE P1AJNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWABKC7    P1WGNY           Customer Number
     C                     Z-ADD12        P3CNTU           Count USR
     C                     MOVEL'Y'       P2ZZST           Record Selected
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Customer Number USR 13 is equal 0
      *   |- c2    : DB1.Ship To Customer NE PAR.Ship To Customer
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1WHNY    IFEQ 0                          *IF
     C           WABKC7    IFNE P1AJNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWABKC7    P1WHNY           Customer Number
     C                     Z-ADD13        P3CNTU           Count USR
     C                     MOVEL'Y'       P2ZZST           Record Selected
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Customer Number USR 14 is equal 0
      *   |- c2    : DB1.Ship To Customer NE PAR.Ship To Customer
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1WINY    IFEQ 0                          *IF
     C           WABKC7    IFNE P1AJNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWABKC7    P1WINY           Customer Number
     C                     Z-ADD14        P3CNTU           Count USR
     C                     MOVEL'Y'       P2ZZST           Record Selected
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Customer Number USR 15 is equal 0
      *   |- c2    : DB1.Ship To Customer NE PAR.Ship To Customer
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1WJNY    IFEQ 0                          *IF
     C           WABKC7    IFNE P1AJNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWABKC7    P1WJNY           Customer Number
     C                     Z-ADD15        P3CNTU           Count USR
     C                     MOVEL'Y'       P2ZZST           Record Selected
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Customer Number USR 16 is equal 0
      *   |- c2    : DB1.Ship To Customer NE PAR.Ship To Customer
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1WKNY    IFEQ 0                          *IF
     C           WABKC7    IFNE P1AJNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWABKC7    P1WKNY           Customer Number
     C                     Z-ADD16        P3CNTU           Count USR
     C                     MOVEL'Y'       P2ZZST           Record Selected
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Customer Number USR 17 is equal 0
      *   |- c2    : DB1.Ship To Customer NE PAR.Ship To Customer
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1WLNY    IFEQ 0                          *IF
     C           WABKC7    IFNE P1AJNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWABKC7    P1WLNY           Customer Number
     C                     Z-ADD17        P3CNTU           Count USR
     C                     MOVEL'Y'       P2ZZST           Record Selected
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Customer Number USR 18 is equal 0
      *   |- c2    : DB1.Ship To Customer NE PAR.Ship To Customer
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1WMNY    IFEQ 0                          *IF
     C           WABKC7    IFNE P1AJNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWABKC7    P1WMNY           Customer Number
     C                     Z-ADD18        P3CNTU           Count USR
     C                     MOVEL'Y'       P2ZZST           Record Selected
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Customer Number USR 19 is equal 0
      *   |- c2    : DB1.Ship To Customer NE PAR.Ship To Customer
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1WNNY    IFEQ 0                          *IF
     C           WABKC7    IFNE P1AJNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWABKC7    P1WNNY           Customer Number
     C                     Z-ADD19        P3CNTU           Count USR
     C                     MOVEL'Y'       P2ZZST           Record Selected
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Customer Number USR 20 is equal 0
      *   |- c2    : DB1.Ship To Customer NE PAR.Ship To Customer
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1WONY    IFEQ 0                          *IF
     C           WABKC7    IFNE P1AJNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWABKC7    P1WONY           Customer Number
     C                     Z-ADD20        P3CNTU           Count USR
     C                     MOVEL'Y'       P2ZZST           Record Selected
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Customer Number USR 21 is equal 0
      *   |- c2    : DB1.Ship To Customer NE PAR.Ship To Customer
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1WPNY    IFEQ 0                          *IF
     C           WABKC7    IFNE P1AJNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWABKC7    P1WPNY           Customer Number
     C                     Z-ADD21        P3CNTU           Count USR
     C                     MOVEL'Y'       P2ZZST           Record Selected
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Customer Number USR 22 is equal 0
      *   |- c2    : DB1.Ship To Customer NE PAR.Ship To Customer
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1WQNY    IFEQ 0                          *IF
     C           WABKC7    IFNE P1AJNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWABKC7    P1WQNY           Customer Number
     C                     Z-ADD22        P3CNTU           Count USR
     C                     MOVEL'Y'       P2ZZST           Record Selected
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Customer Number USR 23 is equal 0
      *   |- c2    : DB1.Ship To Customer NE PAR.Ship To Customer
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1WRNY    IFEQ 0                          *IF
     C           WABKC7    IFNE P1AJNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWABKC7    P1WRNY           Customer Number
     C                     Z-ADD23        P3CNTU           Count USR
     C                     MOVEL'Y'       P2ZZST           Record Selected
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Customer Number USR 24 is equal 0
      *   |- c2    : DB1.Ship To Customer NE PAR.Ship To Customer
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1WSNY    IFEQ 0                          *IF
     C           WABKC7    IFNE P1AJNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWABKC7    P1WSNY           Customer Number
     C                     Z-ADD24        P3CNTU           Count USR
     C                     MOVEL'Y'       P2ZZST           Record Selected
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Customer Number USR 25 is equal 0
      *   |- c2    : DB1.Ship To Customer NE PAR.Ship To Customer
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1WTNY    IFEQ 0                          *IF
     C           WABKC7    IFNE P1AJNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWABKC7    P1WTNY           Customer Number
     C                     Z-ADD25        P3CNTU           Count USR
     C                     MOVEL'Y'       P2ZZST           Record Selected
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Customer Number USR 26 is equal 0
      *   |- c2    : DB1.Ship To Customer NE PAR.Ship To Customer
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1WUNY    IFEQ 0                          *IF
     C           WABKC7    IFNE P1AJNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWABKC7    P1WUNY           Customer Number
     C                     Z-ADD26        P3CNTU           Count USR
     C                     MOVEL'Y'       P2ZZST           Record Selected
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Customer Number USR 27 is equal 0
      *   |- c2    : DB1.Ship To Customer NE PAR.Ship To Customer
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1WVNY    IFEQ 0                          *IF
     C           WABKC7    IFNE P1AJNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWABKC7    P1WVNY           Customer Number
     C                     Z-ADD27        P3CNTU           Count USR
     C                     MOVEL'Y'       P2ZZST           Record Selected
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSA     READE@BBREOM                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modification Log
      *================================================================
      * PIO 03/28/24 CHANGED FILENAME FROM CABBRELI TO CABBRELM
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Blank for 12          USR
     C                     MOVEL*BLANK    WUS3TX 12
      * Define work field Alpha Search
     C                     MOVEL*BLANK    WUABTX 25
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAP3NB           D_B Number
     C                     Z-ADD*ZERO     WAI6DT           Date of D_B Rat
     C                     Z-ADD*ZERO     WAAYDT           Credit Line Exp
     C                     Z-ADD*ZERO     WAANC7           AR Customer Num
     C                     Z-ADD*ZERO     WABTC7           Parent Customer
     C                     Z-ADD*ZERO     WAS2NB           Parent Credit L
     C                     Z-ADD*ZERO     WAVHVA           AR Credit Limit
     C                     Z-ADD*ZERO     WAI7DT           Order Entry Hol
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
