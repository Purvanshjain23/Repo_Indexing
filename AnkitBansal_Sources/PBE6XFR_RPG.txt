     H/TITLE Crt PS Prod Item Sch SXF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISJHIGH
     H* Date          : 03/03/15  Time  : 09:42:03
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCABZREMGIF  E           K        DISK
      * RSQ : Company Item              PrmSch/Co/Item
      *
     FPDJIREL0IF  E           K        DISK
      * RTV : Item Category             Retrieval index
      *
     FPOBHREL0IF  E           K        DISK
      * RTV : Item Category Type        Retrieval index
      *
     FPDI5REL1IF  E           K        DISK
      * RTV : PS Production Department  Retrieval index
      *
     FPDIOREL1IF  E           K        DISK
      * RTV : Item Bill Of Material     Retrieval index
      *
     FCABZRELMIF  E           K        DISK
      * RTV : Company Item              ItmTyp=PS & PkgTyp=B
      *
     FPOAZCPL4IF  E           K        DISK
      * RSQ : Packaging BOM             Co/Item/Sel Bag Types
      *
     FPOARREL1IF  E           K        DISK
      * RTV : Packaging Item            Retrieval index
      *
     FPBAHCPL2IF  E           K        DISK
      * RSQ : PS Prod Item Sch Sum Rpt  Run#/Primal/Item Co
      *
     FPBAHCPL0IF  E           K        DISK                      A
      * UPD : PS Prod Item Sch Sum Rpt  Update index
      *
     I@BZRENZ
      * Company Item              PrmSch/Co/Item
      * Renamed input format fields
     I              BZAIC3                          WAAIC3
     I              BZHGCD                          WAHGCD
     I              BZAVNA                          WAAVNA
     I              BZAWNA                          WAAWNA
     I              BZL7NA                          WAL7NA
     I              BZL8NA                          WAL8NA
     I              BZL6NA                          WAL6NA
     I              BZMFNA                          WAMFNA
     I              BZADCD                          WAADCD
     I              BZAWPC                          WAAWPC
     I              BZLXST                          WALXST
     I              BZAECD                          WAAECD
     I              BZAXPC                          WAAXPC
     I              BZLYST                          WALYST
     I              BZAFCD                          WAAFCD
     I              BZAICD                          WAAICD
     I              BZAIWG                          WAAIWG
     I              BZHICD                          WAHICD
     I              BZRBCD                          WARBCD
     I              BZFZST                          WAFZST
     I              BZAVST                          WAAVST
     I              BZCZWG                          WACZWG
     I              BZC0WG                          WAC0WG
     I              BZURTN                          WAURTN
     I              BZAJC8                          WAAJC8
     I              BZRINB                          WARINB
     I              BZRHNB                          WARHNB
     I              BZRGNB                          WARGNB
     I              BZLNCD                          WALNCD
     I              BZTFNB                          WATFNB
     I              BZN0CD                          WAN0CD
     I              BZX4ST                          WAX4ST
     I              BZTMVA                          WATMVA
     I              BZTNVA                          WATNVA
     I              BZBLPR                          WABLPR
     I              BZBMPR                          WABMPR
     I              BZLRCD                          WALRCD
     I              BZU9ST                          WAU9ST
     I              BZCMCO                          WACMCO
     I              BZQ1CD                          WAQ1CD
     I              BZQ8CD                          WAQ8CD
     I              BZCHTM                          WACHTM
     I              BZQZCD                          WAQZCD
     I              BZXWST                          WAXWST
     I              BZXXST                          WAXXST
     I              BZVMST                          WAVMST
     I              BZSWGH                          WASWGH
     I              BZPPHE                          WAPPHE
     I              BZR3CD                          WAR3CD
     I              BZSDCD                          WASDCD
     I              BZICN1                          WAICN1
     I              BZSVCD                          WASVCD
     I              BZICN2                          WAICN2
     I              BZSWCD                          WASWCD
     I              BZV2NB                          WAV2NB
     I              BZSXCD                          WASXCD
     I              BZITCN                          WAITCN
     I              BZSYCD                          WASYCD
     I              BZITC5                          WAITC5
     I              BZSZCD                          WASZCD
     I              BZICN6                          WAICN6
     I              BZS0CD                          WAS0CD
     I              BZICN7                          WAICN7
     I              BZS1CD                          WAS1CD
     I              BZICN8                          WAICN8
     I              BZS2CD                          WAS2CD
     I              BZICN9                          WAICN9
     I              BZS3CD                          WAS3CD
     I              BZICN0                          WAICN0
     I              BZS4CD                          WAS4CD
     I              BZSFNB                          WASFNB
     I              BZA3WG                          WAA3WG
     I              BZSJNB                          WASJNB
     I              BZLLCD                          WALLCD
     I              BZLMCD                          WALMCD
     I              BZP3ST                          WAP3ST
     I              BZSKNB                          WASKNB
     I              BZSLNB                          WASLNB
     I              BZSMNB                          WASMNB
     I              BZP4ST                          WAP4ST
     I              BZCFNB                          WACFNB
     I              BZCGNB                          WACGNB
     I              BZILNB                          WAILNB
     I              BZCHNB                          WACHNB
     I              BZCINB                          WACINB
     I              BZCJNB                          WACJNB
     I              BZCMNB                          WACMNB
     I              BZCNNB                          WACNNB
     I              BZCRNB                          WACRNB
     I              BZCSNB                          WACSNB
     I              BZCVNB                          WACVNB
     I              BZCWNB                          WACWNB
     I              BZCXNB                          WACXNB
     I              BZCZNB                          WACZNB
     I              BZC0NB                          WAC0NB
     I              BZN1CD                          WAN1CD
     I              BZB4NB                          WAB4NB
     I              BZB5NB                          WAB5NB
     I              BZX5ST                          WAX5ST
     I              BZX6ST                          WAX6ST
     I              BZX7ST                          WAX7ST
     I              BZPCCT                          WAPCCT
     I              BZBDNB                          WABDNB
     I              BZBJNB                          WABJNB
     I              BZSUST                          WASUST
     I              BZSVST                          WASVST
     I              BZSYST                          WASYST
     I              BZSZST                          WASZST
     I              BZS1ST                          WAS1ST
     I              BZXRCD                          WAXRCD
     I              BZXTCD                          WAXTCD
     I              BZXUCD                          WAXUCD
     I              BZF5WG                          WAF5WG
     I              BZF6WG                          WAF6WG
     I              BZF7WG                          WAF7WG
     I              BZBLNB                          WABLNB
     I              BZBNNB                          WABNNB
     I              BZS2ST                          WAS2ST
     I              BZS4ST                          WAS4ST
     I              BZS5ST                          WAS5ST
     I              BZS6ST                          WAS6ST
     I              BZS8ST                          WAS8ST
     I              BZS9ST                          WAS9ST
     I              BZTCST                          WATCST
     I              BZTDST                          WATDST
     I              BZUVST                          WAUVST
     I              BZUWST                          WAUWST
     I              BZUXST                          WAUXST
     I              BZVSST                          WAVSST
     I              BZAATM                          WAAATM
     I              BZAYNA                          WAAYNA
     I              BZA0NA                          WAA0NA
     I              BZAXDT                          WAAXDT
      *
     I@JIREXX
      * Item Category             Retrieval index
      * Renamed input format fields
     I              JIAIC3                          WBAIC3
     I              JIUSNB                          WBUSNB
     I              JISLCD                          WBSLCD
     I              JIAUNA                          WBAUNA
     I              JIOHNX                          WBOHNX
     I              JICNAA                          WBCNAA
     I              JIUVST                          WBUVST
     I              JIUWST                          WBUWST
     I              JIUXST                          WBUXST
     I              JIVSST                          WBVSST
     I              JIAATM                          WBAATM
     I              JIAYNA                          WBAYNA
     I              JIA0NA                          WBA0NA
     I              JIAXDT                          WBAXDT
      *
     I@BHREKT
      * Item Category Type        Retrieval index
      * Renamed input format fields
     I              BHOHNX                          WCOHNX
     I              BHCNAA                          WCCNAA
     I              BHPPNA                          WCPPNA
     I              BHUVST                          WCUVST
     I              BHUWST                          WCUWST
     I              BHUXST                          WCUXST
     I              BHVSST                          WCVSST
     I              BHAATM                          WCAATM
     I              BHAYNA                          WCAYNA
     I              BHA0NA                          WCA0NA
     I              BHAXDT                          WCAXDT
      *
     I@I5REUJ
      * PS Production Department  Retrieval index
      * Renamed input format fields
     I              I5AIC3                          WDAIC3
     I              I5R3CD                          WDR3CD
     I              I5MYNA                          WDMYNA
     I              I5DPT1                          WDDPT1
     I              I5UVST                          WDUVST
     I              I5UWST                          WDUWST
     I              I5UXST                          WDUXST
     I              I5VSST                          WDVSST
     I              I5AATM                          WDAATM
     I              I5AYNA                          WDAYNA
     I              I5A0NA                          WDA0NA
     I              I5AXDT                          WDAXDT
      *
     I@IORETI
      * Item Bill Of Material     Retrieval index
      * Renamed input format fields
     I              IOAIC3                          WEAIC3
     I              IOHGCD                          WEHGCD
     I              IOC9NB                          WEC9NB
     I              IOV2ST                          WEV2ST
     I              IOBOPR                          WEBOPR
     I              IOBPPR                          WEBPPR
     I              IOHGQT                          WEHGQT
     I              IOHHCD                          WEHHCD
     I              IOYAST                          WEYAST
     I              IOCNSM                          WECNSM
     I              IOBMY1                          WEBMY1
     I              IOBMY2                          WEBMY2
     I              IOIXQT                          WEIXQT
     I              IOIYQT                          WEIYQT
     I              IORSST                          WERSST
     I              IORTST                          WERTST
     I              IOUVST                          WEUVST
     I              IOUWST                          WEUWST
     I              IOUXST                          WEUXST
     I              IOVSST                          WEVSST
     I              IOAATM                          WEAATM
     I              IOAYNA                          WEAYNA
     I              IOA0NA                          WEA0NA
     I              IOAXDT                          WEAXDT
      *
     I@BZREG0
      * Company Item              ItmTyp=PS & PkgTyp=B
      * Renamed input format fields
     I              BZAIC3                          WFAIC3
     I              BZHGCD                          WFHGCD
     I              BZAVNA                          WFAVNA
     I              BZAWNA                          WFAWNA
     I              BZL7NA                          WFL7NA
     I              BZL8NA                          WFL8NA
     I              BZL6NA                          WFL6NA
     I              BZMFNA                          WFMFNA
     I              BZADCD                          WFADCD
     I              BZAWPC                          WFAWPC
     I              BZLXST                          WFLXST
     I              BZAECD                          WFAECD
     I              BZAXPC                          WFAXPC
     I              BZLYST                          WFLYST
     I              BZAFCD                          WFAFCD
     I              BZAICD                          WFAICD
     I              BZAIWG                          WFAIWG
     I              BZHICD                          WFHICD
     I              BZRBCD                          WFRBCD
     I              BZFZST                          WFFZST
     I              BZAVST                          WFAVST
     I              BZCZWG                          WFCZWG
     I              BZC0WG                          WFC0WG
     I              BZURTN                          WFURTN
     I              BZAJC8                          WFAJC8
     I              BZRINB                          WFRINB
     I              BZRHNB                          WFRHNB
     I              BZRGNB                          WFRGNB
     I              BZLNCD                          WFLNCD
     I              BZTFNB                          WFTFNB
     I              BZN0CD                          WFN0CD
     I              BZX4ST                          WFX4ST
     I              BZTMVA                          WFTMVA
     I              BZTNVA                          WFTNVA
     I              BZBLPR                          WFBLPR
     I              BZBMPR                          WFBMPR
     I              BZLRCD                          WFLRCD
     I              BZU9ST                          WFU9ST
     I              BZCMCO                          WFCMCO
     I              BZQ1CD                          WFQ1CD
     I              BZQ8CD                          WFQ8CD
     I              BZCHTM                          WFCHTM
     I              BZQZCD                          WFQZCD
     I              BZXWST                          WFXWST
     I              BZXXST                          WFXXST
     I              BZVMST                          WFVMST
     I              BZSWGH                          WFSWGH
     I              BZPPHE                          WFPPHE
     I              BZR3CD                          WFR3CD
     I              BZSDCD                          WFSDCD
     I              BZICN1                          WFICN1
     I              BZSVCD                          WFSVCD
     I              BZICN2                          WFICN2
     I              BZSWCD                          WFSWCD
     I              BZV2NB                          WFV2NB
     I              BZSXCD                          WFSXCD
     I              BZITCN                          WFITCN
     I              BZSYCD                          WFSYCD
     I              BZITC5                          WFITC5
     I              BZSZCD                          WFSZCD
     I              BZICN6                          WFICN6
     I              BZS0CD                          WFS0CD
     I              BZICN7                          WFICN7
     I              BZS1CD                          WFS1CD
     I              BZICN8                          WFICN8
     I              BZS2CD                          WFS2CD
     I              BZICN9                          WFICN9
     I              BZS3CD                          WFS3CD
     I              BZICN0                          WFICN0
     I              BZS4CD                          WFS4CD
     I              BZSFNB                          WFSFNB
     I              BZA3WG                          WFA3WG
     I              BZSJNB                          WFSJNB
     I              BZLLCD                          WFLLCD
     I              BZLMCD                          WFLMCD
     I              BZP3ST                          WFP3ST
     I              BZSKNB                          WFSKNB
     I              BZSLNB                          WFSLNB
     I              BZSMNB                          WFSMNB
     I              BZP4ST                          WFP4ST
     I              BZCFNB                          WFCFNB
     I              BZCGNB                          WFCGNB
     I              BZILNB                          WFILNB
     I              BZCHNB                          WFCHNB
     I              BZCINB                          WFCINB
     I              BZCJNB                          WFCJNB
     I              BZCMNB                          WFCMNB
     I              BZCNNB                          WFCNNB
     I              BZCRNB                          WFCRNB
     I              BZCSNB                          WFCSNB
     I              BZCVNB                          WFCVNB
     I              BZCWNB                          WFCWNB
     I              BZCXNB                          WFCXNB
     I              BZCZNB                          WFCZNB
     I              BZC0NB                          WFC0NB
     I              BZN1CD                          WFN1CD
     I              BZB4NB                          WFB4NB
     I              BZB5NB                          WFB5NB
     I              BZX5ST                          WFX5ST
     I              BZX6ST                          WFX6ST
     I              BZX7ST                          WFX7ST
     I              BZPCCT                          WFPCCT
     I              BZBDNB                          WFBDNB
     I              BZBJNB                          WFBJNB
     I              BZSUST                          WFSUST
     I              BZSVST                          WFSVST
     I              BZSYST                          WFSYST
     I              BZSZST                          WFSZST
     I              BZS1ST                          WFS1ST
     I              BZXRCD                          WFXRCD
     I              BZXTCD                          WFXTCD
     I              BZXUCD                          WFXUCD
     I              BZF5WG                          WFF5WG
     I              BZF6WG                          WFF6WG
     I              BZF7WG                          WFF7WG
     I              BZBLNB                          WFBLNB
     I              BZBNNB                          WFBNNB
     I              BZS2ST                          WFS2ST
     I              BZS4ST                          WFS4ST
     I              BZS5ST                          WFS5ST
     I              BZS6ST                          WFS6ST
     I              BZS8ST                          WFS8ST
     I              BZS9ST                          WFS9ST
     I              BZTCST                          WFTCST
     I              BZTDST                          WFTDST
     I              BZUVST                          WFUVST
     I              BZUWST                          WFUWST
     I              BZUXST                          WFUXST
     I              BZVSST                          WFVSST
     I              BZAATM                          WFAATM
     I              BZAYNA                          WFAYNA
     I              BZA0NA                          WFA0NA
     I              BZAXDT                          WFAXDT
      *
     I@AZCPPC
      * Packaging BOM             Co/Item/Sel Bag Types
      * Renamed input format fields
     I              AZAIC3                          WGAIC3
     I              AZHGCD                          WGHGCD
     I              AZBRAA                          WGBRAA
     I              AZM1QT                          WGM1QT
     I              AZI5SX                          WGI5SX
     I              AZD8AA                          WGD8AA
     I              AZM3SX                          WGM3SX
     I              AZM7SX                          WGM7SX
     I              AZM8SX                          WGM8SX
     I              AZVSST                          WGVSST
     I              AZMJDT                          WGMJDT
     I              AZBETM                          WGBETM
     I              AZCCVN                          WGCCVN
     I              AZCDVN                          WGCDVN
     I              AZMKDT                          WGMKDT
     I              AZBFTM                          WGBFTM
     I              AZCEVN                          WGCEVN
     I              AZCFVN                          WGCFVN
      *
     I@ARREGL
      * Packaging Item            Retrieval index
      * Renamed input format fields
     I              ARAIC3                          WHAIC3
     I              ARBRAA                          WHBRAA
     I              ARXITX                          WHXITX
     I              ARNONX                          WHNONX
     I              AREAAA                          WHEAAA
     I              ARI5SX                          WHI5SX
     I              ARHGCD                          WHHGCD
     I              ARBICS                          WHBICS
     I              ARIIWG                          WHIIWG
     I              ARD8AA                          WHD8AA
     I              ARM3SX                          WHM3SX
     I              ARM1SX                          WHM1SX
     I              ARNGSX                          WHNGSX
     I              ARM2SX                          WHM2SX
     I              ARNHSX                          WHNHSX
     I              ARNISX                          WHNISX
     I              ARNJSX                          WHNJSX
     I              ARNKSX                          WHNKSX
     I              ARNLSX                          WHNLSX
     I              ARNMSX                          WHNMSX
     I              ARNNSX                          WHNNSX
     I              AREBAA                          WHEBAA
     I              ARVSST                          WHVSST
     I              ARMJDT                          WHMJDT
     I              ARBETM                          WHBETM
     I              ARCCVN                          WHCCVN
     I              ARCDVN                          WHCDVN
     I              ARMKDT                          WHMKDT
     I              ARBFTM                          WHBFTM
     I              ARCEVN                          WHCEVN
     I              ARCFVN                          WHCFVN
      *
     I@AHCPOD
      * PS Prod Item Sch Sum Rpt  Run#/Primal/Item Co
      * Renamed input format fields
     I              AHFOC7                          WIFOC7
     I              AHPOAA                          WIPOAA
     I              AHU8NY                          WIU8NY
     I              AHETVN                          WIETVN
     I              AHUKDT                          WIUKDT
     I              AHDVTM                          WIDVTM
     I              AHCZC3                          WICZC3
     I              AHUJDT                          WIUJDT
     I              AHO5AA                          WIO5AA
     I              AHO6AA                          WIO6AA
     I              AHT5NA                          WIT5NA
     I              AHFMC7                          WIFMC7
     I              AHFJC7                          WIFJC7
     I              AHT6NA                          WIT6NA
     I              AHQNQT                          WIQNQT
     I              AHN4ST                          WIN4ST
     I              AHVMNY                          WIVMNY
     I              AHVONY                          WIVONY
     I              AHVNNY                          WIVNNY
     I              AHO8AA                          WIO8AA
     I              AHO7AA                          WIO7AA
     I              AHT7NA                          WIT7NA
     I              AHYQT1                          WIYQT1
     I              AHT8NA                          WIT8NA
     I              AHYPT1                          WIYPT1
     I              AHPPAA                          WIPPAA
     I              AHY3T1                          WIY3T1
     I              AHFQC7                          WIFQC7
     I              AHPVAA                          WIPVAA
     I              AHVZNY                          WIVZNY
     I              AHPBST                          WIPBST
     I              AHR8AA                          WIR8AA
     I              AHR9AA                          WIR9AA
     I              AHSAAA                          WISAAA
     I              AHSBAA                          WISBAA
     I              AHVSST                          WIVSST
     I              AHMJDT                          WIMJDT
     I              AHBETM                          WIBETM
     I              AHCCVN                          WICCVN
     I              AHCDVN                          WICDVN
     I              AHMKDT                          WIMKDT
     I              AHBFTM                          WIBFTM
     I              AHCEVN                          WICEVN
     I              AHCFVN                          WICFVN
      *
     I@AHCPM2
      * PS Prod Item Sch Sum Rpt  Update index
      * Renamed input format fields
     I              AHFOC7                          WJFOC7
     I              AHPOAA                          WJPOAA
     I              AHU8NY                          WJU8NY
     I              AHETVN                          WJETVN
     I              AHUKDT                          WJUKDT
     I              AHDVTM                          WJDVTM
     I              AHCZC3                          WJCZC3
     I              AHUJDT                          WJUJDT
     I              AHO5AA                          WJO5AA
     I              AHO6AA                          WJO6AA
     I              AHT5NA                          WJT5NA
     I              AHFMC7                          WJFMC7
     I              AHFJC7                          WJFJC7
     I              AHT6NA                          WJT6NA
     I              AHQNQT                          WJQNQT
     I              AHN4ST                          WJN4ST
     I              AHVMNY                          WJVMNY
     I              AHVONY                          WJVONY
     I              AHVNNY                          WJVNNY
     I              AHO8AA                          WJO8AA
     I              AHO7AA                          WJO7AA
     I              AHT7NA                          WJT7NA
     I              AHYQT1                          WJYQT1
     I              AHT8NA                          WJT8NA
     I              AHYPT1                          WJYPT1
     I              AHPPAA                          WJPPAA
     I              AHY3T1                          WJY3T1
     I              AHFQC7                          WJFQC7
     I              AHPVAA                          WJPVAA
     I              AHVZNY                          WJVZNY
     I              AHPBST                          WJPBST
     I              AHR8AA                          WJR8AA
     I              AHR9AA                          WJR9AA
     I              AHSAAA                          WJSAAA
     I              AHSBAA                          WJSBAA
     I              AHVSST                          WJVSST
     I              AHMJDT                          WJMJDT
     I              AHBETM                          WJBETM
     I              AHCCVN                          WJCCVN
     I              AHCDVN                          WJCDVN
     I              AHMKDT                          WJMKDT
     I              AHBFTM                          WJBFTM
     I              AHCEVN                          WJCEVN
     I              AHCFVN                          WJCFVN
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * Outward parameters
     IPARC        DS                             13
      * KEY : Order Detail              Co/Item/Whse/ReqShpDt
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Item Code
     I                                    P   3   60PAHGCD
      * I :  Warehouse Code
     I                                        7   9 PAAJCD
      * I :  Requested Ship Date
     I                                    P  10  130PAA5DT
      *
     IQPBAH1    E DSPBAHCPL0
      * UPD : PS Prod Item Sch Sum Rpt  Update index
      * Renamed input format fields
     I              AHFOC7                          WJFOC7
     I              AHPOAA                          WJPOAA
     I              AHU8NY                          WJU8NY
     I              AHETVN                          WJETVN
     I              AHUKDT                          WJUKDT
     I              AHDVTM                          WJDVTM
     I              AHCZC3                          WJCZC3
     I              AHUJDT                          WJUJDT
     I              AHO5AA                          WJO5AA
     I              AHO6AA                          WJO6AA
     I              AHT5NA                          WJT5NA
     I              AHFMC7                          WJFMC7
     I              AHFJC7                          WJFJC7
     I              AHT6NA                          WJT6NA
     I              AHQNQT                          WJQNQT
     I              AHN4ST                          WJN4ST
     I              AHVMNY                          WJVMNY
     I              AHVONY                          WJVONY
     I              AHVNNY                          WJVNNY
     I              AHO8AA                          WJO8AA
     I              AHO7AA                          WJO7AA
     I              AHT7NA                          WJT7NA
     I              AHYQT1                          WJYQT1
     I              AHT8NA                          WJT8NA
     I              AHYPT1                          WJYPT1
     I              AHPPAA                          WJPPAA
     I              AHY3T1                          WJY3T1
     I              AHFQC7                          WJFQC7
     I              AHPVAA                          WJPVAA
     I              AHVZNY                          WJVZNY
     I              AHPBST                          WJPBST
     I              AHR8AA                          WJR8AA
     I              AHR9AA                          WJR9AA
     I              AHSAAA                          WJSAAA
     I              AHSBAA                          WJSBAA
     I              AHVSST                          WJVSST
     I              AHMJDT                          WJMJDT
     I              AHBETM                          WJBETM
     I              AHCCVN                          WJCCVN
     I              AHCDVN                          WJCDVN
     I              AHMKDT                          WJMKDT
     I              AHBFTM                          WJBFTM
     I              AHCEVN                          WJCEVN
     I              AHCFVN                          WJCFVN
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Company Item
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Item Category Number 6
     I                                    P   3   40P1ICN6
      * I :  Item Primal Sched Report
     I                                        5   7 P1S0CD
     IP2PARM      DS
      * FLD: PS Prod Item Sch Sum Rpt
      * I :  PSP Prod Run Sequence
     I                                    P   1   40P2FOC7
      * I :  PSP Primal Group Rpt
     I                                        5   7 P2POAA
      * B :  PSP Report Sequence
     I                                    P   8  100P2U8NY
      * I :  PSP Report ID
     I                                       11  20 P2ETVN
      * I :  PSP Report Date
     I                                    P  21  240P2UKDT
      * I :  PSP Report Time
     I                                    P  25  280P2DVTM
      * I :  PSP Company Number
     I                                    P  29  300P2CZC3
      * I :  PSP Production Date
     I                                    P  31  340P2UJDT
      * I :  PSP Production Warehouse
     I                                       35  37 P2O5AA
     IP3PARM      DS
      * FLD: *Arrays
      * I : MAP Date 0 RGF
     I                                    P   1   40P3VHDT
      * I : MAP Date 1 RGF
     I                                    P   5   80P3RWDT
      * I : MAP Date 2 RGF
     I                                    P   9  120P3RYDT
      * I : MAP Date 3 RGF
     I                                    P  13  160P3R0DT
      * I : MAP Date 3 RGT
     I                                    P  17  200P3R1DT
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1ICN6    PARM           WP0002  20       Item Category N
     C           P1S0CD    PARM           WP0003  3        Item Primal Sch
     C           P2FOC7    PARM           WP0004  70       PSP Prod Run Se
     C           P2POAA    PARM           WP0005  3        PSP Primal Grou
     C           P2U8NY    PARM P2U8NY    WP0006  50       PSP Report Sequ
     C           P2ETVN    PARM           WP0007 10        PSP Report ID
     C           P2UKDT    PARM           WP0008  70       PSP Report Date
     C           P2DVTM    PARM           WP0009  60       PSP Report Time
     C           P2CZC3    PARM           WP0010  30       PSP Company Num
     C           P2UJDT    PARM           WP0011  70       PSP Production
     C           P2O5AA    PARM           WP0012  3        PSP Production
     C           P3VHDT    PARM           WP0013  70       Date 0 RGF
     C           P3RWDT    PARM           WP0014  70       Date 1 RGF
     C           P3RYDT    PARM           WP0015  70       Date 2 RGF
     C           P3R0DT    PARM           WP0016  70       Date 3 RGF
     C           P3R1DT    PARM           WP0017  70       Date 3 RGT
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Crt PS Prod Item Sch SXF
      * Modifications and Comments
     C                     EXSR UASUBR                     Modifications a
      * Crt PS ProdItemSchSum0 RT - Company Item  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Crt PS ProdItemSchSum0 RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Modifications and Comments
     C                     EXSR UBSUBR                     Modifications a
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAICN6    WQSA01           Item Category N
     C           *LIKE     DEFN WAS0CD    WQSA02           Item Primal Sch
     C           *LIKE     DEFN WAAIC3    WQSA03           Company Number
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Item Category N
     C                     KFLD           WQSA02           Item Primal Sch
     C                     KFLD           WQSA03           Company Number
      * Setup key
     C                     Z-ADDP1ICN6    WQSA01           Item Category N
     C                     MOVELP1S0CD    WQSA02           Item Primal Sch
     C                     Z-ADDP1AIC3    WQSA03           Company Number
      * Establish starting position
     C           KRSSA     SETLL@BZRENZ                    *
     C           KRSSA     READE@BZRENZ                  90*
      * Data record not found
     C   90                MOVEL'USR0326' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       YL0001           Record Selected
      * Sel information for item, Boxes and combo's and finish goods
     C                     EXSR UCSUBR                     Sel information
     C                     Z-ADD0         YL0002           PSP Qty Product
     C                     Z-ADD0         YL0003           PSP Total Piece
     C                     Z-ADD0         YL0004           PSP Day 0
     C                     Z-ADD0         YL0005           PSP Day 1
     C                     Z-ADD0         YL0006           PSP Day 2
     C                     Z-ADD0         YL0007           PSP Week Ending
      * CASE: LCL.Record Selected       USR is yes
     C           YL0001    IFEQ 'Y'                        *IF
      * slm 09/11/13
      * get the carlisle interface if = F - Get future days
      * Rtv PrimSchGrp Desc   RT - Item Category  * 
     C                     EXSR SBRVGN
      * Rtv Prod Dept Name    RT - PS Production Department  * 
     C                     EXSR SDRVGN
     C                     MOVELWAAVNA    WUT6NA           PSO Item Descri
      * RTV BOX ID FOR ITEM    RT - Item Bill Of Material  * 
     C                     EXSR SERVGN
      * RTV Itm Bag Code      RT - Packaging BOM  * 
     C                     EXSR SGRVGN
      * RTV Packaging Item    RT - Packaging Item  * 
     C                     EXSR SHRVGN
      * Place this in the PSP consumed item
      * Rtv First Consumed Itm XF - Item Bill Of Material  * 
     C                     CALL 'POP1XFR'              90  Rtv First Consu
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0001  30       Company Number
     C                     PARM WAHGCD    WQ0002  70       Item Code
     C           YL0014    PARM *ZERO     WQ0003  70       Component Item
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POP1XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * If a item is not found in the SUMMARY file then we
      * need to create a record with zero totals
      * The following routine will Create record if not found
      * slm 09/11/13
     C                     Z-ADD0         YL0004           PSP Day 0
     C                     Z-ADD0         YL0005           PSP Day 1
     C                     Z-ADD0         YL0006           PSP Day 2
     C                     Z-ADD0         YL0007           PSP Week Ending
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.U/M - Primary is EQ Boxes
      *   |- c2    : LCL.Carlisle Interface Usr is Intr/Future Qty(Carlis
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAADCD    IFEQ 'BX'                       *IF
     C           YL0009    IFEQ 'F'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * slm 09/11/13
      * Only on Boxes go get day 0, day 1, 2 Wk summary if
      * this primal report is interface to Carlisle = 'F' FOR
      * future days
      * E3796 JJH 03/02/15 - Changed I Parm from Scheduled Ship Date to
      *  Requested Ship Date
      * Rtv Day0,Day1...Etc   XF - Order Detail  * 
     C                     CLEARPARC
     C                     Z-ADDWAAIC3    PAAIC3           Company Number
     C                     Z-ADDWAHGCD    PAHGCD           Item Code
     C                     MOVELP2O5AA    PAAJCD    P      Warehouse Code
     C                     Z-ADDP3VHDT    PAA5DT           Requested Ship
      *
     C                     CALL 'PBJ0XFR'              90  Rtv Day0,Day1..
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Order Deta
     C                     PARM P3VHDT    WQ0004  70       Date 0 RGF
     C                     PARM P3RWDT    WQ0005  70       Date 1 RGF
     C                     PARM P3RYDT    WQ0006  70       Date 2 RGF
     C                     PARM P3R0DT    WQ0007  70       Date 3 RGF
     C                     PARM P3R1DT    WQ0008  70       Date 3 RGT
     C           YL0004    PARM YL0004    WQ0009  70       PSP Day 0
     C           YL0005    PARM YL0005    WQ0010  70       PSP Day 1
     C           YL0006    PARM YL0006    WQ0011  70       PSP Day 2
     C           YL0007    PARM YL0007    WQ0012  70       PSP Week Ending
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBJ0XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * slm 11/12/13
      * PSP DAY 0
      * CASE: LCL.PSP Day 0 is LT Zero
     C           YL0004    IFLT 0                          *IF
     C                     Z-ADD0         YL0004           PSP Day 0
     C                     END                             *FI
      * PSP DAY 1
      * CASE: LCL.PSP Day 1 is LT Zero
     C           YL0005    IFLT 0                          *IF
     C                     Z-ADD0         YL0005           PSP Day 1
     C                     END                             *FI
      * PSP DAY 2
      * CASE: LCL.PSP Day 2 is LT Zero
     C           YL0006    IFLT 0                          *IF
     C                     Z-ADD0         YL0006           PSP Day 2
     C                     END                             *FI
      * Weekend total zero out if negative
      * CASE: LCL.PSP Week Ending Summary is LT Zero
     C           YL0007    IFLT 0                          *IF
     C                     Z-ADD0         YL0007           PSP Week Ending
     C                     END                             *FI
      * Rtv Ps Prod Item Sch SRT - PS Prod Item Sch Sum Rpt  * 
     C                     EXSR SIRVGN
     C                     END                             *FI
     C           KRSSA     READE@BZRENZ                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv PrimSchGrp Desc   RT - Item Category  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBUSNB           Item Category N
     C                     KFLD           WBSLCD           Item Category C
      * Setup key
     C                     Z-ADDWAAIC3    WBAIC3           Company Number
     C                     Z-ADD06        WBUSNB           Item Category N
     C                     MOVELWAS0CD    WBSLCD           Item Category C
      * Establish starting position
     C           KRSSB     CHAIN@JIREXX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1854' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0008           Description
     C                     MOVEL*BLANK    YL0009           EDI Status 3
     C                     MOVEL*BLANK    YL0010           Item Category T
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBAUNA    YL0008           Description
     C                     MOVELWBUXST    YL0009           EDI Status 3
      * Rtv Description       RT - Item Category Type  * 
     C                     EXSR SCRVGN
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Description       RT - Item Category Type  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCOHNX           Item Category T
     C                     KFLD           WCCNAA           Item Category T
      * Setup key
     C                     Z-ADDWBOHNX    WCOHNX           Item Category T
     C                     MOVELWBCNAA    WCCNAA           Item Category T
      * Establish starting position
     C           KRSSC     CHAIN@BHREKT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3079' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0010           Item Category T
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCPPNA    YL0010           Item Category T
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Prod Dept Name    RT - PS Production Department  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDR3CD           Department Code
      * Setup key
     C                     Z-ADDWAAIC3    WDAIC3           Company Number
     C                     MOVELWAR3CD    WDR3CD           Department Code
      * Establish starting position
     C           KRSSD     CHAIN@I5REUJ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1757' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0011           Department Desc
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDMYNA    YL0011           Department Desc
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV BOX ID FOR ITEM    RT - Item Bill Of Material  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  1        Package Type Co
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUBOXI           Box iD
     C                     MOVEL*BLANK    WN0001           Package Type Co
     C                     MOVEL*BLANK    WUNYNA           Box Description
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIC3    WQSE01           Company Number
     C           *LIKE     DEFN WEHGCD    WQSE02           Item Code
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WQSE02           Item Code
      * Setup key
     C                     Z-ADDWAAIC3    WQSE01           Company Number
     C                     Z-ADDWAHGCD    WQSE02           Item Code
      * Establish starting position
     C           KRSSE     SETLL@IORETI                    *
     C           KRSSE     READE@IORETI                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1679' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUBOXI           Box iD
     C                     MOVEL*BLANK    WN0001           Package Type Co
     C                     MOVEL*BLANK    WUNYNA           Box Description
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADD0         WUAIWG           Unit Weight
      * RTV Item Type & PckCD  RT - Company/Item  * 
     C                     EXSR SFRVGN
      * CASE: PAR.Package Type Code is Box
     C           WN0001    IFEQ 'B'                        *IF
     C                     MOVELWUAVNA    WUNYNA           Box Description
     C                     Z-ADDWUAIWG    YN0001           Unit Weight
     C           WEC9NB    MULT 1         WUBOXI           Box iD
     C                     GOTO SEEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSE     READE@IORETI                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Item Type & PckCD  RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFHGCD           Item Code
      * Setup key
     C                     Z-ADDWEAIC3    WFAIC3           Company Number
     C                     Z-ADDWEC9NB    WFHGCD           Item Code
      * Establish starting position
     C           KRSSF     CHAIN@BZREG0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAVNA           Description Lin
     C                     Z-ADD*ZERO     WUAIWG           Unit Weight
     C                     MOVEL*BLANK    WUN0CD           Item Type Code
     C                     MOVEL*BLANK    WN0001           Package Type Co
     C                     Z-ADD*ZERO     WUSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WUA3WG           Misc Tare Weigh
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFAVNA    WUAVNA           Description Lin
     C                     Z-ADDWFAIWG    WUAIWG           Unit Weight
     C                     MOVELWFN0CD    WUN0CD           Item Type Code
     C                     MOVELWFX4ST    WN0001           Package Type Co
     C                     Z-ADDWFSFNB    WUSFNB           Pallet Tare Wei
     C                     Z-ADDWFA3WG    WUA3WG           Misc Tare Weigh
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Itm Bag Code      RT - Packaging BOM  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGAIC3    WQSG01           Company Number
     C           *LIKE     DEFN WGHGCD    WQSG02           Item Code
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Item Code
      * Setup key
     C                     Z-ADDWAAIC3    WQSG01           Company Number
     C                     Z-ADDWAHGCD    WQSG02           Item Code
      * Establish starting position
     C           KRSSG     SETLL@AZCPPC                    *
     C           KRSSG     READE@AZCPPC                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0012           Packaging Item
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGBRAA    YL0012           Packaging Item
     C                     GOTO SGEXIT                     *QUIT
     C           KRSSG     READE@AZCPPC                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Packaging Item    RT - Packaging Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHBRAA           Packaging Item
      * Setup key
     C                     Z-ADDWAAIC3    WHAIC3           Company Number
     C                     MOVELYL0012    WHBRAA           Packaging Item
      * Establish starting position
     C           KRSSH     CHAIN@ARREGL              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2982' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0013           Pckg Item Descr
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHXITX    YL0013           Pckg Item Descr
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Ps Prod Item Sch SRT - PS Prod Item Sch Sum Rpt  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIFOC7    WQSI01           PSP Prod Run Se
     C           *LIKE     DEFN WIPOAA    WQSI02           PSP Primal Grou
     C           *LIKE     DEFN WIFJC7    WQSI03           PSP Item Code
     C           *LIKE     DEFN WICZC3    WQSI04           PSP Company Num
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           PSP Prod Run Se
     C                     KFLD           WQSI02           PSP Primal Grou
     C                     KFLD           WQSI03           PSP Item Code
     C                     KFLD           WQSI04           PSP Company Num
      * Setup key
     C                     Z-ADDP2FOC7    WQSI01           PSP Prod Run Se
     C                     MOVELWAS0CD    WQSI02           PSP Primal Grou
     C                     Z-ADDWAHGCD    WQSI03           PSP Item Code
     C                     Z-ADDWAAIC3    WQSI04           PSP Company Num
      * Establish starting position
     C           KRSSI     SETLL@AHCPOD                    *
     C           KRSSI     READE@AHCPOD                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4490' W0RTN   7
      * USER: Processing if Data record not found
      * Since a record was not found then create a zero record
     C                     ADD  1         P2U8NY           PSP Report Sequ
      * Crt PS Prod Item Sch SCR - PS Prod Item Sch Sum Rpt  * 
     C                     EXSR SJCRRC
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Need to decide if we want to do anything here or not
     C                     GOTO SIEXIT                     *QUIT
     C           KRSSI     READE@AHCPOD                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCRRC    BEGSR
      *================================================================
      * Crt PS Prod Item Sch SCR - PS Prod Item Sch Sum Rpt  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0002  1        Record Status
     C                     Z-ADD*ZERO     WN0003  70       Create Date
     C                     Z-ADD*ZERO     WN0004  60       Create Time
     C                     MOVEL*BLANK    WN0005 10        Create User
     C                     MOVEL*BLANK    WN0006 10        Create Program
     C                     Z-ADD*ZERO     WN0007  70       Change Date
     C                     Z-ADD*ZERO     WN0008  60       Change Time
     C                     MOVEL*BLANK    WN0009 10        Change User
     C                     MOVEL*BLANK    WN0010 10        Change Program
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AHCPM2
     C                     Z-ADDP2FOC7    WJFOC7           PSP Prod Run Se
     C                     MOVELWAS0CD    WJPOAA           PSP Primal Grou
     C                     Z-ADDP2U8NY    WJU8NY           PSP Report Sequ
     C                     MOVELP2ETVN    WJETVN           PSP Report ID
     C                     Z-ADDP2UKDT    WJUKDT           PSP Report Date
     C                     Z-ADDP2DVTM    WJDVTM           PSP Report Time
     C                     Z-ADDWAAIC3    WJCZC3           PSP Company Num
     C                     Z-ADDP2UJDT    WJUJDT           PSP Production
     C                     MOVELP2O5AA    WJO5AA           PSP Production
     C                     MOVELWAR3CD    WJO6AA           PSP Department
     C                     MOVELYL0011    WJT5NA           PSP Department
     C                     Z-ADDYL0014    WJFMC7           PSP Consumed It
     C                     Z-ADDWAHGCD    WJFJC7           PSP Item Code
     C                     MOVELWAAVNA    WJT6NA           PSO Item Descri
     C                     Z-ADDYL0002    WJQNQT           PSP Qty Product
     C                     MOVELWAPCCT    WJN4ST           PSP Piece Count
     C                     Z-ADDWABDNB    WJVMNY           PSP Pieces Per
     C                     Z-ADDWABJNB    WJVONY           PSP Bags Per Un
     C                     Z-ADDYL0003    WJVNNY           PSP Total Piece
     C                     MOVELYL0012    WJO8AA           PSP Packaging I
     C                     MOVELWAADCD    WJO7AA           PSP U/M Primary
     C                     MOVELYL0015    WJT7NA           PSP BOX Desript
     C                     MOVELYL0013    WJYQT1           PSP Packaging I
     C                     MOVELYL0016    WJT8NA           PSP Comment Lin
     C                     MOVELYL0017    WJYPT1           PSP Text
     C                     MOVELWAXRCD    WJPPAA           PSP Primal Grou
     C                     MOVEL'R'       WJY3T1           PSP Sent Outsid
     C                     Z-ADDWACNNB    WJFQC7           PSP WIP Item Co
     C                     MOVELYL0018    WJPVAA           PSP Shift/Prior
     C                     Z-ADDYL0019    WJVZNY           PSP Pieces Sche
     C                     MOVELWAS8ST    WJPBST           PSP Label Type
     C                     Z-ADDYL0004    WJR8AA           PSP Day 0
     C                     Z-ADDYL0005    WJR9AA           PSP Day 1
     C                     Z-ADDYL0006    WJSAAA           PSP Day 2
     C                     Z-ADDYL0007    WJSBAA           PSP Week Ending
      *
      * USER: Processing before Data update
      * Set Crt Date/Time      IF
      * *** Set RECORD STATUS field. ***
     C                     MOVEL'A'       WJVSST           Record Status
      * *** Set CREATE fields. ***
     C                     Z-ADD##JDT     WJMJDT           Create Date
     C                     Z-ADD##JTM     WJBETM           Create Time
     C                     MOVEL##USR     WJCCVN           Create User
     C                     MOVEL##PGM     WJCDVN           Create Program
      * *** Set CHANGE fields. ***
     C                     Z-ADD0         WJMKDT           Change Date
     C                     Z-ADD0         WJBFTM           Change Time
     C                     MOVEL*BLANK    WJCEVN           Change User
     C                     MOVEL*BLANK    WJCFVN           Change Program
     C           KLCRSJ    KLIST
     C                     KFLD           WJFOC7           PSP Prod Run Se
     C                     KFLD           WJPOAA           PSP Primal Grou
     C                     KFLD           WJU8NY           PSP Report Sequ
      * Check for duplicate primary key
     C           KLCRSJ    SETLL@AHCPM2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR4491' W0RTN   7
      * Send message 'PS Prod Item Sch Sum R EX'
     C                     MOVEL'USR4491' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C                     WRITE@AHCPM2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * E3796 JJH 03/02/15 - Recompiled this program becuase internal
      *  changes were made in: Crt PS ProdItemSchSum0 RT - Company Item.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * E3796 JJH 03/02/15 - Changed I Parm from Scheduled Ship Date to
      *  Requested Ship Date on Rtv Day0,Day1...Etc   XF - Order Detail.
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Sel information for item, Boxes and combo's and finish goods
      *================================================================
      * Verify if active
      * CASE: DB1.Record Status is Active
     C           WAVSST    IFEQ 'A'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0001           Record Selected
     C                     END                             *FI
      * Select only if Print on Schedule = N ,
      * CASE: DB1.Print On Schedule is no
     C           WASVST    IFEQ 'N'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0001           Record Selected
     C                     END                             *FI
      * Select only Finish Goods
      * CASE: DB1.Item Type Code is Finished Good
     C           WAN0CD    IFEQ 'FG'                       *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0001           Record Selected
     C                     END                             *FI
      * Also boxes or combo's
      * CASE:
      *  - c1OR c2
      *   |- c1    : DB1.U/M - Primary is EQ Boxes
      *   |- c2    : DB1.U/M - Primary is Combos
      *   '-
     C           WAADCD    IFEQ 'BX'                       *IF
     C           WAADCD    OREQ 'CB'                       *OR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0001           Record Selected
     C                     END                             *FI
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WAAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WAAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WAAIWG           Unit Weight
     C                     Z-ADD*ZERO     WACZWG           Minimum Weight
     C                     Z-ADD*ZERO     WAC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WAURTN           Number Cases On
     C                     Z-ADD*ZERO     WAAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WATFNB           Transportation
     C                     Z-ADD*ZERO     WATMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WATNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WABLPR           Market Overage
     C                     Z-ADD*ZERO     WABMPR           Standard Overag
     C                     Z-ADD*ZERO     WACMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WACHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WASWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WAPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WAICN1           Item Category N
     C                     Z-ADD*ZERO     WAICN2           Item Category N
     C                     Z-ADD*ZERO     WAV2NB           Item Category N
     C                     Z-ADD*ZERO     WAITCN           Item Category N
     C                     Z-ADD*ZERO     WAITC5           Item Category N
     C                     Z-ADD*ZERO     WAICN6           Item Category N
     C                     Z-ADD*ZERO     WAICN7           Item Category N
     C                     Z-ADD*ZERO     WAICN8           Item Category N
     C                     Z-ADD*ZERO     WAICN9           Item Category N
     C                     Z-ADD*ZERO     WAICN0           Item Category N
     C                     Z-ADD*ZERO     WASFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WAA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WASJNB           Production Lead
     C                     Z-ADD*ZERO     WASKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WASLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WASMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WACFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WACGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WAILNB           Packages per ca
     C                     Z-ADD*ZERO     WACHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WACINB           PM Batch Size
     C                     Z-ADD*ZERO     WACJNB           Package Level s
     C                     Z-ADD*ZERO     WACMNB           Partial Item Co
     C                     Z-ADD*ZERO     WACNNB           WIP Item Code
     C                     Z-ADD*ZERO     WACRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WACSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WACVNB           FP Std Green We
     C                     Z-ADD*ZERO     WACWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WACXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WACZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WAC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WAB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WAB5NB           PM Line Number
     C                     Z-ADD*ZERO     WABDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WABJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WAF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WAF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WAF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WABLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WABNNB           Production Qty
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBUSNB           Item Category N
     C                     Z-ADD*ZERO     WBOHNX           Item Category T
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCOHNX           Item Category T
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field PSO Item Description
     C                     MOVEL*BLANK    WUT6NA 30
      * Define work field Box iD
     C                     Z-ADD*ZERO     WUBOXI  70
      * Define work field Box Description
     C                     MOVEL*BLANK    WUNYNA 30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEHGCD           Item Code
     C                     Z-ADD*ZERO     WEC9NB           Component Item
     C                     Z-ADD*ZERO     WEBOPR           Sales Yield
     C                     Z-ADD*ZERO     WEBPPR           Production Yiel
     C                     Z-ADD*ZERO     WEHGQT           Packaging Quant
     C                     Z-ADD*ZERO     WECNSM           Consume Priorit
     C                     Z-ADD*ZERO     WEBMY1           Consume Priorit
     C                     Z-ADD*ZERO     WEBMY2           BOM Pumped Perc
     C                     Z-ADD*ZERO     WEIXQT           BOM Meat Cost C
     C                     Z-ADD*ZERO     WEIYQT           BOM Off Line Yi
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Define work field Unit Weight
     C                     Z-ADD*ZERO     WUAIWG 112
      * Define work field Description Line One
     C                     MOVEL*BLANK    WUAVNA 30
      * Define work field Item Type Code
     C                     MOVEL*BLANK    WUN0CD  3
      * Define work field Pallet Tare Weight
     C                     Z-ADD*ZERO     WUSFNB  52
      * Define work field Misc Tare Weight
     C                     Z-ADD*ZERO     WUA3WG  52
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGHGCD           Item Code
     C                     Z-ADD*ZERO     WGM1QT           Packaging Item
     C                     Z-ADD*ZERO     WGMJDT           Create Date
     C                     Z-ADD*ZERO     WGBETM           Create Time
     C                     Z-ADD*ZERO     WGMKDT           Change Date
     C                     Z-ADD*ZERO     WGBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHNONX           Pckg List Seque
     C                     Z-ADD*ZERO     WHHGCD           Item Code
     C                     Z-ADD*ZERO     WHBICS           Pckg Unit Cost
     C                     Z-ADD*ZERO     WHIIWG           Pckg Tare Weigh
     C                     Z-ADD*ZERO     WHMJDT           Create Date
     C                     Z-ADD*ZERO     WHBETM           Create Time
     C                     Z-ADD*ZERO     WHMKDT           Change Date
     C                     Z-ADD*ZERO     WHBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIFOC7           PSP Prod Run Se
     C                     Z-ADD*ZERO     WIU8NY           PSP Report Sequ
     C                     Z-ADD*ZERO     WIUKDT           PSP Report Date
     C                     Z-ADD*ZERO     WIDVTM           PSP Report Time
     C                     Z-ADD*ZERO     WICZC3           PSP Company Num
     C                     Z-ADD*ZERO     WIUJDT           PSP Production
     C                     Z-ADD*ZERO     WIFMC7           PSP Consumed It
     C                     Z-ADD*ZERO     WIFJC7           PSP Item Code
     C                     Z-ADD*ZERO     WIQNQT           PSP Qty Product
     C                     Z-ADD*ZERO     WIVMNY           PSP Pieces Per
     C                     Z-ADD*ZERO     WIVONY           PSP Bags Per Un
     C                     Z-ADD*ZERO     WIVNNY           PSP Total Piece
     C                     Z-ADD*ZERO     WIFQC7           PSP WIP Item Co
     C                     Z-ADD*ZERO     WIVZNY           PSP Pieces Sche
     C                     Z-ADD*ZERO     WIR8AA           PSP Day 0
     C                     Z-ADD*ZERO     WIR9AA           PSP Day 1
     C                     Z-ADD*ZERO     WISAAA           PSP Day 2
     C                     Z-ADD*ZERO     WISBAA           PSP Week Ending
     C                     Z-ADD*ZERO     WIMJDT           Create Date
     C                     Z-ADD*ZERO     WIBETM           Create Time
     C                     Z-ADD*ZERO     WIMKDT           Change Date
     C                     Z-ADD*ZERO     WIBFTM           Change Time
      * Clear all neither parameters
      * Crt PS Prod Item Sch SCR - PS Prod Item Sch Sum Rpt  * 
     C                     Z-ADD*ZERO     WJMJDT           Create Date
     C                     Z-ADD*ZERO     WJBETM           Create Time
     C                     Z-ADD*ZERO     WJMKDT           Change Date
     C                     Z-ADD*ZERO     WJBFTM           Change Time
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
     C                     MOVEL'N'       W0PMT   1
      * Define local work field Record Selected       USR
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field PSP Qty Production Total
     C                     Z-ADD*ZERO     YL0002  61
      * Define local work field PSP Total Pieces
     C                     Z-ADD*ZERO     YL0003  70
      * Define local work field PSP Day 0
     C                     Z-ADD*ZERO     YL0004  70
      * Define local work field PSP Day 1
     C                     Z-ADD*ZERO     YL0005  70
      * Define local work field PSP Day 2
     C                     Z-ADD*ZERO     YL0006  70
      * Define local work field PSP Week Ending Summary
     C                     Z-ADD*ZERO     YL0007  70
      * Define local work field Text 20               USR
     C                     MOVEL*BLANK    YL0008 20
      * Define local work field Carlisle Interface Usr
     C                     MOVEL*BLANK    YL0009  1
      * Define local work field Text 2 USR
     C                     MOVEL*BLANK    YL0010 25
      * Define local work field Department Description
     C                     MOVEL*BLANK    YL0011 30
      * Define null work field Unit Weight
     C                     Z-ADD*ZERO     YN0001 112
      * Define local work field Packaging Item Code
     C                     MOVEL*BLANK    YL0012 25
      * Define local work field Pckg Item Description
     C                     MOVEL*BLANK    YL0013 50
      * Define local work field Consumed Item Code
     C                     Z-ADD*ZERO     YL0014  70
      * Define local work field Box Description
     C                     MOVEL*BLANK    YL0015 30
      * Define local work field PSP Comment Line 1
     C                     MOVEL*BLANK    YL0016 30
      * Define local work field PSP Text
     C                     MOVEL*BLANK    YL0017 40
      * Define local work field PSP Shift/Priority Code
     C                     MOVEL*BLANK    YL0018  3
      * Define local work field PSP Pieces Schedule
     C                     Z-ADD*ZERO     YL0019  50
      *================================================================
     CSR         ZZEXIT    ENDSR
