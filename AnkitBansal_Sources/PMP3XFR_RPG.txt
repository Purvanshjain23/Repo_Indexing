     H/TITLE Crt JRSALES YTD Sales XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by  : 2E  Version:  1181
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model         lopment-
     H* System        : OMS Development Model
     H* User name     : ISPPATE
     H* Date          : 12/10/07  Time  : 13:41:57
     H* Copyright     : OMS Development Model         lopment-
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCABZREM1IF  E           K        DISK
      * RSQ : Company Item              Co/GLSub/Class/Item FG
      *
     FOMHSTPM9IF  E           K        DISK
      * RSQ : Sales History             Co/ShpItm/ShpDte
      *
     FOPEXREL2IF  E           K        DISK
      * RTV : Order Types               Active order Types
      *
     FJRSALEL3IF  E           K        DISK
      * RTV : JRD Sales History File AS Retrieval Index FIFO
      *
     FJRSALEL2UF  E           K        DISK                      A
      * UPD : JRD Sales History File AS update index 2
      *
     I@BZREPH
      * Company Item              Co/GLSub/Class/Item FG
      * Renamed input format fields
     I              BZAIC3                          WAAIC3
     I              BZHGCD                          WAHGCD
     I              BZAVNA                          WAAVNA
     I              BZAWNA                          WAAWNA
     I              BZL7NA                          WAL7NA
     I              BZL8NA                          WAL8NA
     I              BZL6NA                          WAL6NA
     I              BZMFNA                          WAMFNA
     I              BZADCD                          WAADCD
     I              BZAWPC                          WAAWPC
     I              BZLXST                          WALXST
     I              BZAECD                          WAAECD
     I              BZAXPC                          WAAXPC
     I              BZLYST                          WALYST
     I              BZAFCD                          WAAFCD
     I              BZAICD                          WAAICD
     I              BZAIWG                          WAAIWG
     I              BZHICD                          WAHICD
     I              BZRBCD                          WARBCD
     I              BZFZST                          WAFZST
     I              BZAVST                          WAAVST
     I              BZCZWG                          WACZWG
     I              BZC0WG                          WAC0WG
     I              BZURTN                          WAURTN
     I              BZAJC8                          WAAJC8
     I              BZRINB                          WARINB
     I              BZRHNB                          WARHNB
     I              BZRGNB                          WARGNB
     I              BZLNCD                          WALNCD
     I              BZTFNB                          WATFNB
     I              BZN0CD                          WAN0CD
     I              BZX4ST                          WAX4ST
     I              BZTMVA                          WATMVA
     I              BZTNVA                          WATNVA
     I              BZBLPR                          WABLPR
     I              BZBMPR                          WABMPR
     I              BZLRCD                          WALRCD
     I              BZU9ST                          WAU9ST
     I              BZCMCO                          WACMCO
     I              BZQ1CD                          WAQ1CD
     I              BZQ8CD                          WAQ8CD
     I              BZCHTM                          WACHTM
     I              BZQZCD                          WAQZCD
     I              BZXWST                          WAXWST
     I              BZXXST                          WAXXST
     I              BZVMST                          WAVMST
     I              BZSWGH                          WASWGH
     I              BZPPHE                          WAPPHE
     I              BZR3CD                          WAR3CD
     I              BZSDCD                          WASDCD
     I              BZICN1                          WAICN1
     I              BZSVCD                          WASVCD
     I              BZICN2                          WAICN2
     I              BZSWCD                          WASWCD
     I              BZV2NB                          WAV2NB
     I              BZSXCD                          WASXCD
     I              BZITCN                          WAITCN
     I              BZSYCD                          WASYCD
     I              BZITC5                          WAITC5
     I              BZSZCD                          WASZCD
     I              BZICN6                          WAICN6
     I              BZS0CD                          WAS0CD
     I              BZICN7                          WAICN7
     I              BZS1CD                          WAS1CD
     I              BZICN8                          WAICN8
     I              BZS2CD                          WAS2CD
     I              BZICN9                          WAICN9
     I              BZS3CD                          WAS3CD
     I              BZICN0                          WAICN0
     I              BZS4CD                          WAS4CD
     I              BZSFNB                          WASFNB
     I              BZA3WG                          WAA3WG
     I              BZSJNB                          WASJNB
     I              BZLLCD                          WALLCD
     I              BZLMCD                          WALMCD
     I              BZP3ST                          WAP3ST
     I              BZSKNB                          WASKNB
     I              BZSLNB                          WASLNB
     I              BZSMNB                          WASMNB
     I              BZP4ST                          WAP4ST
     I              BZCFNB                          WACFNB
     I              BZCGNB                          WACGNB
     I              BZILNB                          WAILNB
     I              BZCHNB                          WACHNB
     I              BZCINB                          WACINB
     I              BZCJNB                          WACJNB
     I              BZCMNB                          WACMNB
     I              BZCNNB                          WACNNB
     I              BZCRNB                          WACRNB
     I              BZCSNB                          WACSNB
     I              BZCVNB                          WACVNB
     I              BZCWNB                          WACWNB
     I              BZCXNB                          WACXNB
     I              BZCZNB                          WACZNB
     I              BZC0NB                          WAC0NB
     I              BZN1CD                          WAN1CD
     I              BZB4NB                          WAB4NB
     I              BZB5NB                          WAB5NB
     I              BZX5ST                          WAX5ST
     I              BZX6ST                          WAX6ST
     I              BZX7ST                          WAX7ST
     I              BZPCCT                          WAPCCT
     I              BZBDNB                          WABDNB
     I              BZBJNB                          WABJNB
     I              BZSUST                          WASUST
     I              BZSVST                          WASVST
     I              BZSYST                          WASYST
     I              BZSZST                          WASZST
     I              BZS1ST                          WAS1ST
     I              BZXRCD                          WAXRCD
     I              BZXTCD                          WAXTCD
     I              BZXUCD                          WAXUCD
     I              BZF5WG                          WAF5WG
     I              BZF6WG                          WAF6WG
     I              BZF7WG                          WAF7WG
     I              BZBLNB                          WABLNB
     I              BZBNNB                          WABNNB
     I              BZS2ST                          WAS2ST
     I              BZS4ST                          WAS4ST
     I              BZS5ST                          WAS5ST
     I              BZS6ST                          WAS6ST
     I              BZS8ST                          WAS8ST
     I              BZS9ST                          WAS9ST
     I              BZTCST                          WATCST
     I              BZTDST                          WATDST
     I              BZUVST                          WAUVST
     I              BZUWST                          WAUWST
     I              BZUXST                          WAUXST
     I              BZVSST                          WAVSST
     I              BZAATM                          WAAATM
     I              BZAYNA                          WAAYNA
     I              BZA0NA                          WAA0NA
     I              BZAXDT                          WAAXDT
      *
     I@HSTPC9
      * Sales History             Co/ShpItm/ShpDte
      * Renamed input format fields
     I              F4AIC3                          WBAIC3
     I              F4C4NB                          WBC4NB
     I              F4DPNB                          WBDPNB
     I              F4UENB                          WBUENB
     I              F4MONA                          WBMONA
     I              F4RJCD                          WBRJCD
     I              F4RKCD                          WBRKCD
     I              F4GPTX                          WBGPTX
     I              F4ABTX                          WBABTX
     I              F4KXCD                          WBKXCD
     I              F4BOCD                          WBBOCD
     I              F4BTC7                          WBBTC7
     I              F4ANC7                          WBANC7
     I              F4AQTX                          WBAQTX
     I              F4BKC7                          WBBKC7
     I              F4BRTX                          WBBRTX
     I              F4HNNA                          WBHNNA
     I              F4DBCD                          WBDBCD
     I              F4CKTX                          WBCKTX
     I              F4BCNA                          WBBCNA
     I              F4A0DT                          WBA0DT
     I              F4ACDT                          WBACDT
     I              F4R4CD                          WBR4CD
     I              F4R5CD                          WBR5CD
     I              F4BFCD                          WBBFCD
     I              F4Q4CD                          WBQ4CD
     I              F4AQCD                          WBAQCD
     I              F4TBNB                          WBTBNB
     I              F4BZNA                          WBBZNA
     I              F4RLCD                          WBRLCD
     I              F4JNCD                          WBJNCD
     I              F4Q2CD                          WBQ2CD
     I              F4U2ST                          WBU2ST
     I              F4ATIN                          WBATIN
     I              F4T3NB                          WBT3NB
     I              F4RSRN                          WBRSRN
     I              F4ORIT                          WBORIT
     I              F4AJCD                          WBAJCD
     I              F4AVQT                          WBAVQT
     I              F4D0WG                          WBD0WG
     I              F4CCQT                          WBCCQT
     I              F4AUWG                          WBAUWG
     I              F4AGCD                          WBAGCD
     I              F4AKPR                          WBAKPR
     I              F4AUPR                          WBAUPR
     I              F4CRCD                          WBCRCD
     I              F4A5DT                          WBA5DT
     I              F4AWDT                          WBAWDT
     I              F4HDDT                          WBHDDT
     I              F4AGCS                          WBAGCS
     I              F4AQCS                          WBAQCS
     I              F4AVWG                          WBAVWG
     I              F4AYVA                          WBAYVA
     I              F4AMST                          WBAMST
     I              F4ANST                          WBANST
     I              F4VAST                          WBVAST
     I              F4L6NB                          WBL6NB
     I              F4UMCD                          WBUMCD
     I              F4HCDT                          WBHCDT
     I              F4ESNB                          WBESNB
     I              F4ETNB                          WBETNB
     I              F4BZNB                          WBBZNB
     I              F4EXQT                          WBEXQT
     I              F4BYWG                          WBBYWG
     I              F4S5NB                          WBS5NB
     I              F4MAVA                          WBMAVA
     I              F4KDVA                          WBKDVA
     I              F4USVA                          WBUSVA
     I              F4UTVA                          WBUTVA
     I              F4A4WG                          WBA4WG
     I              F4CKNB                          WBCKNB
     I              F4BMST                          WBBMST
     I              F4R8NB                          WBR8NB
     I              F4RMCD                          WBRMCD
     I              F4BZPR                          WBBZPR
     I              F4RDCD                          WBRDCD
     I              F4Q7CD                          WBQ7CD
     I              F4EXDT                          WBEXDT
     I              F4LQCD                          WBLQCD
     I              F4HICD                          WBHICD
     I              F4RBCD                          WBRBCD
     I              F4RGNB                          WBRGNB
     I              F4RHNB                          WBRHNB
     I              F4RINB                          WBRINB
     I              F4R1NB                          WBR1NB
     I              F4CONB                          WBCONB
     I              F4CEST                          WBCEST
     I              F4GNDT                          WBGNDT
     I              F4RMNB                          WBRMNB
     I              F4AODT                          WBAODT
     I              F4LLCD                          WBLLCD
     I              F4LMCD                          WBLMCD
     I              F4SKNB                          WBSKNB
     I              F4SLNB                          WBSLNB
     I              F4SMNB                          WBSMNB
     I              F4G7NA                          WBG7NA
     I              F4ONVA                          WBONVA
     I              F4N0CD                          WBN0CD
     I              F4B4NB                          WBB4NB
     I              F4B5NB                          WBB5NB
     I              F4N1CD                          WBN1CD
     I              F4GIDT                          WBGIDT
     I              F4Z1ST                          WBZ1ST
     I              F4ULVA                          WBULVA
     I              F4UNVA                          WBUNVA
     I              F4UOVA                          WBUOVA
     I              F4UPVA                          WBUPVA
     I              F4UQVA                          WBUQVA
     I              F4SDCD                          WBSDCD
     I              F4QZCD                          WBQZCD
     I              F4XWST                          WBXWST
     I              F4T9CD                          WBT9CD
     I              F4UBCD                          WBUBCD
     I              F4CFC7                          WBCFC7
     I              F4X1CD                          WBX1CD
     I              F4GASX                          WBGASX
     I              F4DUPR                          WBDUPR
     I              F4B6VL                          WBB6VL
     I              F4IANX                          WBIANX
     I              F4IBNX                          WBIBNX
     I              F4RPCD                          WBRPCD
     I              F4NYDT                          WBNYDT
     I              F4BZTM                          WBBZTM
     I              F4Z4NB                          WBZ4NB
     I              F4XACD                          WBXACD
     I              F4OANA                          WBOANA
     I              F4OKTX                          WBOKTX
     I              F4K4TX                          WBK4TX
     I              F4NBBO                          WBNBBO
     I              F4OCFR                          WBOCFR
     I              F4C0C7                          WBC0C7
     I              F4A1AA                          WBA1AA
     I              F4VEST                          WBVEST
     I              F4A5PR                          WBA5PR
     I              F4CDPR                          WBCDPR
     I              F4D0PR                          WBD0PR
     I              F4D0VL                          WBD0VL
     I              F4IRSX                          WBIRSX
     I              F4CEVL                          WBCEVL
     I              F4ISSX                          WBISSX
     I              F4ITSX                          WBITSX
     I              F4IUSX                          WBIUSX
     I              F4OHDT                          WBOHDT
     I              F4D9PR                          WBD9PR
     I              F4CFVL                          WBCFVL
     I              F4UVST                          WBUVST
     I              F4UWST                          WBUWST
     I              F4UXST                          WBUXST
     I              F4AATM                          WBAATM
     I              F4AYNA                          WBAYNA
     I              F4A0NA                          WBA0NA
     I              F4AXDT                          WBAXDT
      *
     I@EXRETY
      * Order Types               Active order Types
      * Renamed input format fields
     I              EXJNCD                          WCJNCD
     I              EXJVNA                          WCJVNA
     I              EXOAST                          WCOAST
     I              EXOBST                          WCOBST
     I              EXOEST                          WCOEST
     I              EXOFST                          WCOFST
     I              EXVBST                          WCVBST
     I              EXPYST                          WCPYST
     I              EXX8ST                          WCX8ST
     I              EXISTX                          WCISTX
     I              EXUVST                          WCUVST
     I              EXUWST                          WCUWST
     I              EXUXST                          WCUXST
     I              EXVSST                          WCVSST
     I              EXAATM                          WCAATM
     I              EXAYNA                          WCAYNA
     I              EXA0NA                          WCA0NA
     I              EXAXDT                          WCAXDT
      *
     I@SALEPQ
      * JRD Sales History File AS Retrieval Index FIFO
      * Renamed input format fields
     I              DAIMAA                          WDIMAA
     I              DAINAA                          WDINAA
     I              DAH7VL                          WDH7VL
     I              DAH8VL                          WDH8VL
     I              DAH9VL                          WDH9VL
     I              DAIAVL                          WDIAVL
     I              DAIBVL                          WDIBVL
     I              DAICVL                          WDICVL
     I              DAIDVL                          WDIDVL
     I              DAIEVL                          WDIEVL
     I              DAIFVL                          WDIFVL
     I              DAIGVL                          WDIGVL
     I              DAIHVL                          WDIHVL
     I              DAIIVL                          WDIIVL
     I              DAIJVL                          WDIJVL
     I              DAIKVL                          WDIKVL
     I              DAILVL                          WDILVL
     I              DAIMVL                          WDIMVL
     I              DAIMAX                          WDIMAX
      *
     I@SALEPP
      * JRD Sales History File AS update index 2
      * Renamed input format fields
     I              DAIMAA                          WEIMAA
     I              DAINAA                          WEINAA
     I              DAH7VL                          WEH7VL
     I              DAH8VL                          WEH8VL
     I              DAH9VL                          WEH9VL
     I              DAIAVL                          WEIAVL
     I              DAIBVL                          WEIBVL
     I              DAICVL                          WEICVL
     I              DAIDVL                          WEIDVL
     I              DAIEVL                          WEIEVL
     I              DAIFVL                          WEIFVL
     I              DAIGVL                          WEIGVL
     I              DAIHVL                          WEIHVL
     I              DAIIVL                          WEIIVL
     I              DAIJVL                          WEIJVL
     I              DAIKVL                          WEIKVL
     I              DAILVL                          WEILVL
     I              DAIMVL                          WEIMVL
     I              DAIMAX                          WEIMAX
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * Outward parameters
     IPARC        DS                              6
      * KEY : Calendar Summary          Co/EndDte(D)
      * I :  Company Number
     I                                    P   1   20PAAIC3
      *
     IQJRSA1    E DSJRSALEL2
      * UPD : JRD Sales History File AS update index 2
      * Renamed input format fields
     I              DAIMAA                          WEIMAA
     I              DAINAA                          WEINAA
     I              DAH7VL                          WEH7VL
     I              DAH8VL                          WEH8VL
     I              DAH9VL                          WEH9VL
     I              DAIAVL                          WEIAVL
     I              DAIBVL                          WEIBVL
     I              DAICVL                          WEICVL
     I              DAIDVL                          WEIDVL
     I              DAIEVL                          WEIEVL
     I              DAIFVL                          WEIFVL
     I              DAIGVL                          WEIGVL
     I              DAIHVL                          WEIHVL
     I              DAIIVL                          WEIIVL
     I              DAIJVL                          WEIJVL
     I              DAIKVL                          WEIKVL
     I              DAILVL                          WEILVL
     I              DAIMVL                          WEIMVL
     I              DAIMAX                          WEIMAX
      *
     IYARDCS      DS                            104
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IYBRDCS      DS                            104
     IYCRDCS      DS                            104
     IYDRDCS      DS                            104
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  Company Number
     I                                    P   1   20P1AIC3
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Crt JRSALES YTD Sales XF
      * *** WEEKLY ***
      * Rtv Period Beg/End Dt XF - Calendar Summary  * 
     C                     CLEARPARC
     C                     Z-ADDP1AIC3    PAAIC3           Company Number
      *
     C                     CALL 'PMI2XFR'              90  Rtv Period Beg/
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Calendar S
     C                     PARM 'W'       WQ0001  1        Period Type USR
     C           YL0001    PARM *ZERO     WQ0002  70       Period Beginnin
     C           YL0002    PARM *ZERO     WQ0003  70       Period Ending D
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMI2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Crt JRSALES YTD Sales RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0001           Company Number
     C                     Z-ADDYL0001    WL0002           Date From
     C                     Z-ADDYL0002    WL0003           Date To
     C                     MOVEL'W'       WL0004    P      Period Type USR
     C                     EXSR SARVGN
      * *** MONTHLY ***
      * Rtv Period Beg/End Dt XF - Calendar Summary  * 
     C                     CLEARPARC
     C                     Z-ADDP1AIC3    PAAIC3           Company Number
      *
     C                     CALL 'PMI2XFR'              90  Rtv Period Beg/
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Calendar S
     C                     PARM 'M'       WQ0004  1        Period Type USR
     C           YL0001    PARM *ZERO     WQ0005  70       Period Beginnin
     C           YL0002    PARM *ZERO     WQ0006  70       Period Ending D
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMI2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Crt JRSALES YTD Sales RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0001           Company Number
     C                     Z-ADDYL0001    WL0002           Date From
     C                     Z-ADDYL0002    WL0003           Date To
     C                     MOVEL'M'       WL0004    P      Period Type USR
     C                     EXSR SARVGN
      * *** QUARTER ***
      * Rtv Period Beg/End Dt XF - Calendar Summary  * 
     C                     CLEARPARC
     C                     Z-ADDP1AIC3    PAAIC3           Company Number
      *
     C                     CALL 'PMI2XFR'              90  Rtv Period Beg/
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Calendar S
     C                     PARM 'Q'       WQ0007  1        Period Type USR
     C           YL0001    PARM *ZERO     WQ0008  70       Period Beginnin
     C           YL0002    PARM *ZERO     WQ0009  70       Period Ending D
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMI2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Crt JRSALES YTD Sales RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0001           Company Number
     C                     Z-ADDYL0001    WL0002           Date From
     C                     Z-ADDYL0002    WL0003           Date To
     C                     MOVEL'Q'       WL0004    P      Period Type USR
     C                     EXSR SARVGN
      * *** YTD     ***
      * Rtv Period Beg/End Dt XF - Calendar Summary  * 
     C                     CLEARPARC
     C                     Z-ADDP1AIC3    PAAIC3           Company Number
      *
     C                     CALL 'PMI2XFR'              90  Rtv Period Beg/
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Calendar S
     C                     PARM 'Y'       WQ0010  1        Period Type USR
     C           YL0001    PARM *ZERO     WQ0011  70       Period Beginnin
     C           YL0002    PARM *ZERO     WQ0012  70       Period Ending D
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMI2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Crt JRSALES YTD Sales RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0001           Company Number
     C                     Z-ADDYL0001    WL0002           Date From
     C                     Z-ADDYL0002    WL0003           Date To
     C                     MOVEL'Y'       WL0004    P      Period Type USR
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Crt JRSALES YTD Sales RT - Company Item  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  5        PRODUCT CODE
     C                     MOVEL*BLANK    WN0002  2        TERRITORY
     C                     Z-ADD*ZERO     WN0003 112       WEEKLY SALES
     C                     Z-ADD*ZERO     WN0004 111       WEEKLY UNITS
     C                     Z-ADD*ZERO     WN0005 112       WEEKLY DISCOUNT
     C                     Z-ADD*ZERO     WN0006 112       WEEKLY CREDITS
     C                     Z-ADD*ZERO     WN0007 112       MONTHLY SALES
     C                     Z-ADD*ZERO     WN0008 111       MONTHLY UNITS
     C                     Z-ADD*ZERO     WN0009 112       MONTHLY DISCOUN
     C                     Z-ADD*ZERO     WN0010 112       MONTHLY CREDITS
     C                     Z-ADD*ZERO     WN0011 112       QUARTER SALES
     C                     Z-ADD*ZERO     WN0012 111       QUARTER UNITS
     C                     Z-ADD*ZERO     WN0013 112       QUARTER DISCOUN
     C                     Z-ADD*ZERO     WN0014 112       QUARTER CREDITS
     C                     Z-ADD*ZERO     WN0015 112       Y-T-D SALES
     C                     Z-ADD*ZERO     WN0016 111       Y-T-D UNITS
     C                     Z-ADD*ZERO     WN0017 112       Y-T-D  DISCOUNT
     C                     Z-ADD*ZERO     WN0018 112       Y-T-D CREDITS
     C                     MOVEL*BLANK    WN0019  1        DELETE (D)
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
      * Setup key
     C                     Z-ADDWL0001    WQSA01           Company Number
      * Establish starting position
     C           KRSSA     SETLL@BZREPH                    *
     C           KRSSA     READE@BZREPH                  90*
      * Data record not found
     C   90                MOVEL'USR0326' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0001           PRODUCT CODE
     C                     MOVEL*BLANK    WN0002           TERRITORY
     C                     Z-ADD*ZERO     WN0003           WEEKLY SALES
     C                     Z-ADD*ZERO     WN0004           WEEKLY UNITS
     C                     Z-ADD*ZERO     WN0005           WEEKLY DISCOUNT
     C                     Z-ADD*ZERO     WN0006           WEEKLY CREDITS
     C                     Z-ADD*ZERO     WN0007           MONTHLY SALES
     C                     Z-ADD*ZERO     WN0008           MONTHLY UNITS
     C                     Z-ADD*ZERO     WN0009           MONTHLY DISCOUN
     C                     Z-ADD*ZERO     WN0010           MONTHLY CREDITS
     C                     Z-ADD*ZERO     WN0011           QUARTER SALES
     C                     Z-ADD*ZERO     WN0012           QUARTER UNITS
     C                     Z-ADD*ZERO     WN0013           QUARTER DISCOUN
     C                     Z-ADD*ZERO     WN0014           QUARTER CREDITS
     C                     Z-ADD*ZERO     WN0015           Y-T-D SALES
     C                     Z-ADD*ZERO     WN0016           Y-T-D UNITS
     C                     Z-ADD*ZERO     WN0017           Y-T-D  DISCOUNT
     C                     Z-ADD*ZERO     WN0018           Y-T-D CREDITS
     C                     MOVEL*BLANK    WN0019           DELETE (D)
     C                     Z-ADDWAHGCD    YL0003           Item Code 5.0
     C                     MOVEL*BLANK    WN0001           PRODUCT CODE
     C                     MOVELYL0003    WN0001           PRODUCT CODE
     C                     MOVEL'99'      WN0002           TERRITORY
      * CASE: DB1.Item Structure Type Code is EQ 900
     C           WARGNB    IFEQ 900                        *IF
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Item Code NE DB1.Seaboard Equivalent Item
      *   |- c2    : DB1.Seaboard Equivalent Item is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAHGCD    IFNE WABLNB                     *IF
     C           WABLNB    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'98'      WN0002           TERRITORY
     C                     Z-ADDWABLNB    YL0003           Item Code 5.0
     C                     MOVEL*BLANK    WN0001           PRODUCT CODE
     C                     MOVELYL0003    WN0001           PRODUCT CODE
     C                     END                             *FI
     C                     END                             *FI
      * Rtv Sales Summary     RT - Sales History  * 
     C                     EXSR SBRVGN
      * UPD: Week
      * CASE: PAR.Period Type USR is Week
     C           WL0004    IFEQ 'W'                        *IF
     C                     Z-ADDYL0005    WN0003           WEEKLY SALES
     C                     Z-ADDYL0004    WN0004           WEEKLY UNITS
      * Upd JRSALES WK  Sales RT - JRD Sales History File AS  * 
     C                     EXSR SDRVGN
     C                     END                             *FI
      * UPD: Month
      * CASE: PAR.Period Type USR is Month
     C           WL0004    IFEQ 'M'                        *IF
     C                     Z-ADDYL0005    WN0007           MONTHLY SALES
     C                     Z-ADDYL0004    WN0008           MONTHLY UNITS
      * Upd JRSALES MO  Sales RT - JRD Sales History File AS  * 
     C                     EXSR SGRVGN
     C                     END                             *FI
      * UPD: Quarter
      * CASE: PAR.Period Type USR is Quarter
     C           WL0004    IFEQ 'Q'                        *IF
     C                     Z-ADDYL0005    WN0011           QUARTER SALES
     C                     Z-ADDYL0004    WN0012           QUARTER UNITS
      * Upd JRSALES QT  Sales RT - JRD Sales History File AS  * 
     C                     EXSR SIRVGN
     C                     END                             *FI
      * UPD: YTD
      * CASE: PAR.Period Type USR is Year
     C           WL0004    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0005    WN0015           Y-T-D SALES
     C                     Z-ADDYL0004    WN0016           Y-T-D UNITS
      * Upd JRSALES YTD Sales RT - JRD Sales History File AS  * 
     C                     EXSR SKRVGN
     C                     END                             *FI
     C           KRSSA     READE@BZREPH                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Sales Summary     RT - Sales History  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0004           Weight Billed
     C                     Z-ADD*ZERO     YL0005           Billing Detail
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSB01           Company Number
     C           *LIKE     DEFN WBS5NB    WQSB02           Shipped Item Co
      * Define keylist
     C           KPSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Shipped Item Co
     C                     KFLD           WBGNDT           Actual Shipped
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Shipped Item Co
      * Setup key
     C                     Z-ADDWAAIC3    WQSB01           Company Number
     C                     Z-ADDWAHGCD    WQSB02           Shipped Item Co
     C                     Z-ADDWL0002    WBGNDT           Actual Shipped
      * Establish starting position
     C           KPSSB     SETLL@HSTPC9                    *
     C           KRSSB     READE@HSTPC9                  90*
      * Data record not found
     C   90                MOVEL'USR1241' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Actual Shipped Date GT PAR.Date To               USR
     C           WBGNDT    IFGT WL0003                     *IF
     C                     GOTO SBEXIT                     *QUIT
     C                     END                             *FI
      * RTV Billing Type       RT - Order Types  * 
     C                     EXSR SCRVGN
      * CASE: DB1.Affect Sales Doll Status is yes
     C           WBANST    IFEQ 'Y'                        *IF
     C                     ADD  WBKDVA    YL0005           Billing Detail
     C                     END                             *FI
      * CASE: DB1.Affect Sales Pnds Status is yes
     C           WBVAST    IFEQ 'Y'                        *IF
      * CASE: LCL.Billing Activity Type is Credit Memo
     C           YL0006    IFEQ '2'                        *IF
     C                     SUB  WBBYWG    YL0004           Weight Billed
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  WBBYWG    YL0004           Weight Billed
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSB     READE@HSTPC9                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Billing Type       RT - Order Types  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCJNCD           Order Type - Sa
      * Setup key
     C                     MOVELWBJNCD    WCJNCD           Order Type - Sa
      * Establish starting position
     C           KRSSC     CHAIN@EXRETY              90    *
      * Data record not found
     C   90                MOVEL'USR1063' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCOBST    YL0006           Billing Activit
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Upd JRSALES WK  Sales RT - JRD Sales History File AS  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0020 112       WEEKLY DISCOUNT
     C                     Z-ADD*ZERO     WN0021 112       WEEKLY CREDITS
     C                     Z-ADD*ZERO     WN0022 112       MONTHLY SALES
     C                     Z-ADD*ZERO     WN0023 111       MONTHLY UNITS
     C                     Z-ADD*ZERO     WN0024 112       MONTHLY DISCOUN
     C                     Z-ADD*ZERO     WN0025 112       MONTHLY CREDITS
     C                     Z-ADD*ZERO     WN0026 112       QUARTER SALES
     C                     Z-ADD*ZERO     WN0027 111       QUARTER UNITS
     C                     Z-ADD*ZERO     WN0028 112       QUARTER DISCOUN
     C                     Z-ADD*ZERO     WN0029 112       QUARTER CREDITS
     C                     Z-ADD*ZERO     WN0030 112       Y-T-D SALES
     C                     Z-ADD*ZERO     WN0031 111       Y-T-D UNITS
     C                     Z-ADD*ZERO     WN0032 112       Y-T-D  DISCOUNT
     C                     Z-ADD*ZERO     WN0033 112       Y-T-D CREDITS
     C                     MOVEL*BLANK    WN0034  1        DELETE (D)
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDIMAA    WQSD01           PRODUCT CODE
     C           *LIKE     DEFN WDINAA    WQSD02           TERRITORY
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           PRODUCT CODE
     C                     KFLD           WQSD02           TERRITORY
      * Setup key
     C                     MOVELWN0001    WQSD01           PRODUCT CODE
     C                     MOVELWN0002    WQSD02           TERRITORY
      * Establish starting position
     C           KRSSD     SETLL@SALEPQ                    *
     C           KRSSD     READE@SALEPQ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3847' W0RTN   7
      * USER: Processing if Data record not found
      * Crt JRSALES Sales     CR - JRD Sales History File AS  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0001    WL0005    P      PRODUCT CODE
     C                     MOVELWN0002    WL0006    P      TERRITORY
     C                     Z-ADDWN0003    WL0007           WEEKLY SALES
     C                     Z-ADDWN0004    WL0008           WEEKLY UNITS
     C                     Z-ADDWN0020    WL0009           WEEKLY DISCOUNT
     C                     Z-ADDWN0021    WL0010           WEEKLY CREDITS
     C                     Z-ADDWN0022    WL0011           MONTHLY SALES
     C                     Z-ADDWN0023    WL0012           MONTHLY UNITS
     C                     Z-ADDWN0024    WL0013           MONTHLY DISCOUN
     C                     Z-ADDWN0025    WL0014           MONTHLY CREDITS
     C                     Z-ADDWN0026    WL0015           QUARTER SALES
     C                     Z-ADDWN0027    WL0016           QUARTER UNITS
     C                     Z-ADDWN0028    WL0017           QUARTER DISCOUN
     C                     Z-ADDWN0029    WL0018           QUARTER CREDITS
     C                     Z-ADDWN0030    WL0019           Y-T-D SALES
     C                     Z-ADDWN0031    WL0020           Y-T-D UNITS
     C                     Z-ADDWN0032    WL0021           Y-T-D  DISCOUNT
     C                     Z-ADDWN0033    WL0022           Y-T-D CREDITS
     C                     MOVELWN0034    WL0023    P      DELETE (D)
     C                     EXSR SECRRC
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg JRSALES WK  Sales CH - JRD Sales History File AS  * 
     C                     EXSR SFCHRC
     C           KRSSD     READE@SALEPQ                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECRRC    BEGSR
      *================================================================
      * Crt JRSALES Sales     CR - JRD Sales History File AS  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @SALEPP
     C                     MOVELWL0005    WEIMAA           PRODUCT CODE
     C                     MOVELWL0006    WEINAA           TERRITORY
     C                     Z-ADDWL0007    WEH7VL           WEEKLY SALES
     C                     Z-ADDWL0008    WEH8VL           WEEKLY UNITS
     C                     Z-ADDWL0009    WEH9VL           WEEKLY DISCOUNT
     C                     Z-ADDWL0010    WEIAVL           WEEKLY CREDITS
     C                     Z-ADDWL0011    WEIBVL           MONTHLY SALES
     C                     Z-ADDWL0012    WEICVL           MONTHLY UNITS
     C                     Z-ADDWL0013    WEIDVL           MONTHLY DISCOUN
     C                     Z-ADDWL0014    WEIEVL           MONTHLY CREDITS
     C                     Z-ADDWL0015    WEIFVL           QUARTER SALES
     C                     Z-ADDWL0016    WEIGVL           QUARTER UNITS
     C                     Z-ADDWL0017    WEIHVL           QUARTER DISCOUN
     C                     Z-ADDWL0018    WEIIVL           QUARTER CREDITS
     C                     Z-ADDWL0019    WEIJVL           Y-T-D SALES
     C                     Z-ADDWL0020    WEIKVL           Y-T-D UNITS
     C                     Z-ADDWL0021    WEILVL           Y-T-D  DISCOUNT
     C                     Z-ADDWL0022    WEIMVL           Y-T-D CREDITS
     C                     MOVELWL0023    WEIMAX           DELETE (D)
      *
     C           KLCRSE    KLIST
     C                     KFLD           WEIMAA           PRODUCT CODE
     C                     KFLD           WEINAA           TERRITORY
      * Check for duplicate primary key
     C           KLCRSE    SETLL@SALEPP                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3848' W0RTN   7
      * Send message 'JRD Sales History File EX'
     C                     MOVEL'USR3848' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C                     WRITE@SALEPP                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCHRC    BEGSR
      *================================================================
      * Chg JRSALES WK  Sales CH - JRD Sales History File AS  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0035 112       WEEKLY DISCOUNT
     C                     Z-ADD*ZERO     WN0036 112       WEEKLY CREDITS
     C                     Z-ADD*ZERO     WN0037 112       MONTHLY SALES
     C                     Z-ADD*ZERO     WN0038 111       MONTHLY UNITS
     C                     Z-ADD*ZERO     WN0039 112       MONTHLY DISCOUN
     C                     Z-ADD*ZERO     WN0040 112       MONTHLY CREDITS
     C                     Z-ADD*ZERO     WN0041 112       QUARTER SALES
     C                     Z-ADD*ZERO     WN0042 111       QUARTER UNITS
     C                     Z-ADD*ZERO     WN0043 112       QUARTER DISCOUN
     C                     Z-ADD*ZERO     WN0044 112       QUARTER CREDITS
     C                     Z-ADD*ZERO     WN0045 112       Y-T-D SALES
     C                     Z-ADD*ZERO     WN0046 111       Y-T-D UNITS
     C                     Z-ADD*ZERO     WN0047 112       Y-T-D  DISCOUNT
     C                     Z-ADD*ZERO     WN0048 112       Y-T-D CREDITS
     C                     MOVEL*BLANK    WN0049  1        DELETE (D)
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @SALEPP
     C                     MOVELWDIMAA    WEIMAA    P      PRODUCT CODE
     C                     MOVELWDINAA    WEINAA    P      TERRITORY
      *
     C           KLCHSF    KLIST
     C                     KFLD           WEIMAA           PRODUCT CODE
     C                     KFLD           WEINAA           TERRITORY
     C           KLCHSF    CHAIN@SALEPP              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'JRSALEL2'MDACP
     C                     MOVEL'@SALEPP' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QJRSA1    YARDCS
      * Move non-key fields to @SALEPP
     C                     Z-ADDWN0003    WEH7VL           WEEKLY SALES
     C                     Z-ADDWN0004    WEH8VL           WEEKLY UNITS
      *
      * Set PGM.*Record Data Changed flag
     C           QJRSA1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@SALEPP                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKJRSALEL2               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Upd JRSALES MO  Sales RT - JRD Sales History File AS  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0050 112       WEEKLY SALES
     C                     Z-ADD*ZERO     WN0051 111       WEEKLY UNITS
     C                     Z-ADD*ZERO     WN0052 112       WEEKLY DISCOUNT
     C                     Z-ADD*ZERO     WN0053 112       WEEKLY CREDITS
     C                     Z-ADD*ZERO     WN0054 112       MONTHLY DISCOUN
     C                     Z-ADD*ZERO     WN0055 112       MONTHLY CREDITS
     C                     Z-ADD*ZERO     WN0056 112       QUARTER SALES
     C                     Z-ADD*ZERO     WN0057 111       QUARTER UNITS
     C                     Z-ADD*ZERO     WN0058 112       QUARTER DISCOUN
     C                     Z-ADD*ZERO     WN0059 112       QUARTER CREDITS
     C                     Z-ADD*ZERO     WN0060 112       Y-T-D SALES
     C                     Z-ADD*ZERO     WN0061 111       Y-T-D UNITS
     C                     Z-ADD*ZERO     WN0062 112       Y-T-D  DISCOUNT
     C                     Z-ADD*ZERO     WN0063 112       Y-T-D CREDITS
     C                     MOVEL*BLANK    WN0064  1        DELETE (D)
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDIMAA    WQSG01           PRODUCT CODE
     C           *LIKE     DEFN WDINAA    WQSG02           TERRITORY
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           PRODUCT CODE
     C                     KFLD           WQSG02           TERRITORY
      * Setup key
     C                     MOVELWN0001    WQSG01           PRODUCT CODE
     C                     MOVELWN0002    WQSG02           TERRITORY
      * Establish starting position
     C           KRSSG     SETLL@SALEPQ                    *
     C           KRSSG     READE@SALEPQ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3847' W0RTN   7
      * USER: Processing if Data record not found
      * Crt JRSALES Sales     CR - JRD Sales History File AS  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0001    WL0005    P      PRODUCT CODE
     C                     MOVELWN0002    WL0006    P      TERRITORY
     C                     Z-ADDWN0050    WL0007           WEEKLY SALES
     C                     Z-ADDWN0051    WL0008           WEEKLY UNITS
     C                     Z-ADDWN0052    WL0009           WEEKLY DISCOUNT
     C                     Z-ADDWN0053    WL0010           WEEKLY CREDITS
     C                     Z-ADDWN0007    WL0011           MONTHLY SALES
     C                     Z-ADDWN0008    WL0012           MONTHLY UNITS
     C                     Z-ADDWN0054    WL0013           MONTHLY DISCOUN
     C                     Z-ADDWN0055    WL0014           MONTHLY CREDITS
     C                     Z-ADDWN0056    WL0015           QUARTER SALES
     C                     Z-ADDWN0057    WL0016           QUARTER UNITS
     C                     Z-ADDWN0058    WL0017           QUARTER DISCOUN
     C                     Z-ADDWN0059    WL0018           QUARTER CREDITS
     C                     Z-ADDWN0060    WL0019           Y-T-D SALES
     C                     Z-ADDWN0061    WL0020           Y-T-D UNITS
     C                     Z-ADDWN0062    WL0021           Y-T-D  DISCOUNT
     C                     Z-ADDWN0063    WL0022           Y-T-D CREDITS
     C                     MOVELWN0064    WL0023    P      DELETE (D)
     C                     EXSR SECRRC
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg JRSALES MO  Sales CH - JRD Sales History File AS  * 
     C                     EXSR SHCHRC
     C           KRSSG     READE@SALEPQ                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCHRC    BEGSR
      *================================================================
      * Chg JRSALES MO  Sales CH - JRD Sales History File AS  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0065 112       WEEKLY SALES
     C                     Z-ADD*ZERO     WN0066 111       WEEKLY UNITS
     C                     Z-ADD*ZERO     WN0067 112       WEEKLY DISCOUNT
     C                     Z-ADD*ZERO     WN0068 112       WEEKLY CREDITS
     C                     Z-ADD*ZERO     WN0069 112       MONTHLY DISCOUN
     C                     Z-ADD*ZERO     WN0070 112       MONTHLY CREDITS
     C                     Z-ADD*ZERO     WN0071 112       QUARTER SALES
     C                     Z-ADD*ZERO     WN0072 111       QUARTER UNITS
     C                     Z-ADD*ZERO     WN0073 112       QUARTER DISCOUN
     C                     Z-ADD*ZERO     WN0074 112       QUARTER CREDITS
     C                     Z-ADD*ZERO     WN0075 112       Y-T-D SALES
     C                     Z-ADD*ZERO     WN0076 111       Y-T-D UNITS
     C                     Z-ADD*ZERO     WN0077 112       Y-T-D  DISCOUNT
     C                     Z-ADD*ZERO     WN0078 112       Y-T-D CREDITS
     C                     MOVEL*BLANK    WN0079  1        DELETE (D)
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @SALEPP
     C                     MOVELWDIMAA    WEIMAA    P      PRODUCT CODE
     C                     MOVELWDINAA    WEINAA    P      TERRITORY
      *
     C           KLCHSH    KLIST
     C                     KFLD           WEIMAA           PRODUCT CODE
     C                     KFLD           WEINAA           TERRITORY
     C           KLCHSH    CHAIN@SALEPP              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'JRSALEL2'MDACP
     C                     MOVEL'@SALEPP' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QJRSA1    YBRDCS
      * Move non-key fields to @SALEPP
     C                     Z-ADDWN0007    WEIBVL           MONTHLY SALES
     C                     Z-ADDWN0008    WEICVL           MONTHLY UNITS
      *
      * Set PGM.*Record Data Changed flag
     C           QJRSA1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@SALEPP                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKJRSALEL2               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Upd JRSALES QT  Sales RT - JRD Sales History File AS  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0080 112       WEEKLY SALES
     C                     Z-ADD*ZERO     WN0081 111       WEEKLY UNITS
     C                     Z-ADD*ZERO     WN0082 112       WEEKLY DISCOUNT
     C                     Z-ADD*ZERO     WN0083 112       WEEKLY CREDITS
     C                     Z-ADD*ZERO     WN0084 112       MONTHLY SALES
     C                     Z-ADD*ZERO     WN0085 111       MONTHLY UNITS
     C                     Z-ADD*ZERO     WN0086 112       MONTHLY DISCOUN
     C                     Z-ADD*ZERO     WN0087 112       MONTHLY CREDITS
     C                     Z-ADD*ZERO     WN0088 112       QUARTER DISCOUN
     C                     Z-ADD*ZERO     WN0089 112       QUARTER CREDITS
     C                     Z-ADD*ZERO     WN0090 112       Y-T-D SALES
     C                     Z-ADD*ZERO     WN0091 111       Y-T-D UNITS
     C                     Z-ADD*ZERO     WN0092 112       Y-T-D  DISCOUNT
     C                     Z-ADD*ZERO     WN0093 112       Y-T-D CREDITS
     C                     MOVEL*BLANK    WN0094  1        DELETE (D)
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDIMAA    WQSI01           PRODUCT CODE
     C           *LIKE     DEFN WDINAA    WQSI02           TERRITORY
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           PRODUCT CODE
     C                     KFLD           WQSI02           TERRITORY
      * Setup key
     C                     MOVELWN0001    WQSI01           PRODUCT CODE
     C                     MOVELWN0002    WQSI02           TERRITORY
      * Establish starting position
     C           KRSSI     SETLL@SALEPQ                    *
     C           KRSSI     READE@SALEPQ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3847' W0RTN   7
      * USER: Processing if Data record not found
      * Crt JRSALES Sales     CR - JRD Sales History File AS  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0001    WL0005    P      PRODUCT CODE
     C                     MOVELWN0002    WL0006    P      TERRITORY
     C                     Z-ADDWN0080    WL0007           WEEKLY SALES
     C                     Z-ADDWN0081    WL0008           WEEKLY UNITS
     C                     Z-ADDWN0082    WL0009           WEEKLY DISCOUNT
     C                     Z-ADDWN0083    WL0010           WEEKLY CREDITS
     C                     Z-ADDWN0084    WL0011           MONTHLY SALES
     C                     Z-ADDWN0085    WL0012           MONTHLY UNITS
     C                     Z-ADDWN0086    WL0013           MONTHLY DISCOUN
     C                     Z-ADDWN0087    WL0014           MONTHLY CREDITS
     C                     Z-ADDWN0011    WL0015           QUARTER SALES
     C                     Z-ADDWN0012    WL0016           QUARTER UNITS
     C                     Z-ADDWN0088    WL0017           QUARTER DISCOUN
     C                     Z-ADDWN0089    WL0018           QUARTER CREDITS
     C                     Z-ADDWN0090    WL0019           Y-T-D SALES
     C                     Z-ADDWN0091    WL0020           Y-T-D UNITS
     C                     Z-ADDWN0092    WL0021           Y-T-D  DISCOUNT
     C                     Z-ADDWN0093    WL0022           Y-T-D CREDITS
     C                     MOVELWN0094    WL0023    P      DELETE (D)
     C                     EXSR SECRRC
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg JRSALES QT  Sales CH - JRD Sales History File AS  * 
     C                     EXSR SJCHRC
     C           KRSSI     READE@SALEPQ                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCHRC    BEGSR
      *================================================================
      * Chg JRSALES QT  Sales CH - JRD Sales History File AS  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0095 112       WEEKLY SALES
     C                     Z-ADD*ZERO     WN0096 111       WEEKLY UNITS
     C                     Z-ADD*ZERO     WN0097 112       WEEKLY DISCOUNT
     C                     Z-ADD*ZERO     WN0098 112       WEEKLY CREDITS
     C                     Z-ADD*ZERO     WN0099 112       MONTHLY SALES
     C                     Z-ADD*ZERO     WN0100 111       MONTHLY UNITS
     C                     Z-ADD*ZERO     WN0101 112       MONTHLY DISCOUN
     C                     Z-ADD*ZERO     WN0102 112       MONTHLY CREDITS
     C                     Z-ADD*ZERO     WN0103 112       QUARTER DISCOUN
     C                     Z-ADD*ZERO     WN0104 112       QUARTER CREDITS
     C                     Z-ADD*ZERO     WN0105 112       Y-T-D SALES
     C                     Z-ADD*ZERO     WN0106 111       Y-T-D UNITS
     C                     Z-ADD*ZERO     WN0107 112       Y-T-D  DISCOUNT
     C                     Z-ADD*ZERO     WN0108 112       Y-T-D CREDITS
     C                     MOVEL*BLANK    WN0109  1        DELETE (D)
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @SALEPP
     C                     MOVELWDIMAA    WEIMAA    P      PRODUCT CODE
     C                     MOVELWDINAA    WEINAA    P      TERRITORY
      *
     C           KLCHSJ    KLIST
     C                     KFLD           WEIMAA           PRODUCT CODE
     C                     KFLD           WEINAA           TERRITORY
     C           KLCHSJ    CHAIN@SALEPP              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'JRSALEL2'MDACP
     C                     MOVEL'@SALEPP' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QJRSA1    YCRDCS
      * Move non-key fields to @SALEPP
     C                     Z-ADDWN0011    WEIFVL           QUARTER SALES
     C                     Z-ADDWN0012    WEIGVL           QUARTER UNITS
      *
      * Set PGM.*Record Data Changed flag
     C           QJRSA1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@SALEPP                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKJRSALEL2               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Upd JRSALES YTD Sales RT - JRD Sales History File AS  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0110 112       WEEKLY SALES
     C                     Z-ADD*ZERO     WN0111 111       WEEKLY UNITS
     C                     Z-ADD*ZERO     WN0112 112       WEEKLY DISCOUNT
     C                     Z-ADD*ZERO     WN0113 112       WEEKLY CREDITS
     C                     Z-ADD*ZERO     WN0114 112       MONTHLY SALES
     C                     Z-ADD*ZERO     WN0115 111       MONTHLY UNITS
     C                     Z-ADD*ZERO     WN0116 112       MONTHLY DISCOUN
     C                     Z-ADD*ZERO     WN0117 112       MONTHLY CREDITS
     C                     Z-ADD*ZERO     WN0118 112       QUARTER SALES
     C                     Z-ADD*ZERO     WN0119 111       QUARTER UNITS
     C                     Z-ADD*ZERO     WN0120 112       QUARTER DISCOUN
     C                     Z-ADD*ZERO     WN0121 112       QUARTER CREDITS
     C                     Z-ADD*ZERO     WN0122 112       Y-T-D  DISCOUNT
     C                     Z-ADD*ZERO     WN0123 112       Y-T-D CREDITS
     C                     MOVEL*BLANK    WN0124  1        DELETE (D)
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDIMAA    WQSK01           PRODUCT CODE
     C           *LIKE     DEFN WDINAA    WQSK02           TERRITORY
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           PRODUCT CODE
     C                     KFLD           WQSK02           TERRITORY
      * Setup key
     C                     MOVELWN0001    WQSK01           PRODUCT CODE
     C                     MOVELWN0002    WQSK02           TERRITORY
      * Establish starting position
     C           KRSSK     SETLL@SALEPQ                    *
     C           KRSSK     READE@SALEPQ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3847' W0RTN   7
      * USER: Processing if Data record not found
      * Crt JRSALES Sales     CR - JRD Sales History File AS  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0001    WL0005    P      PRODUCT CODE
     C                     MOVELWN0002    WL0006    P      TERRITORY
     C                     Z-ADDWN0110    WL0007           WEEKLY SALES
     C                     Z-ADDWN0111    WL0008           WEEKLY UNITS
     C                     Z-ADDWN0112    WL0009           WEEKLY DISCOUNT
     C                     Z-ADDWN0113    WL0010           WEEKLY CREDITS
     C                     Z-ADDWN0114    WL0011           MONTHLY SALES
     C                     Z-ADDWN0115    WL0012           MONTHLY UNITS
     C                     Z-ADDWN0116    WL0013           MONTHLY DISCOUN
     C                     Z-ADDWN0117    WL0014           MONTHLY CREDITS
     C                     Z-ADDWN0118    WL0015           QUARTER SALES
     C                     Z-ADDWN0119    WL0016           QUARTER UNITS
     C                     Z-ADDWN0120    WL0017           QUARTER DISCOUN
     C                     Z-ADDWN0121    WL0018           QUARTER CREDITS
     C                     Z-ADDWN0015    WL0019           Y-T-D SALES
     C                     Z-ADDWN0016    WL0020           Y-T-D UNITS
     C                     Z-ADDWN0122    WL0021           Y-T-D  DISCOUNT
     C                     Z-ADDWN0123    WL0022           Y-T-D CREDITS
     C                     MOVELWN0124    WL0023    P      DELETE (D)
     C                     EXSR SECRRC
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg JRSALES YTD Sales CH - JRD Sales History File AS  * 
     C                     EXSR SLCHRC
     C           KRSSK     READE@SALEPQ                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCHRC    BEGSR
      *================================================================
      * Chg JRSALES YTD Sales CH - JRD Sales History File AS  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0125 112       WEEKLY SALES
     C                     Z-ADD*ZERO     WN0126 111       WEEKLY UNITS
     C                     Z-ADD*ZERO     WN0127 112       WEEKLY DISCOUNT
     C                     Z-ADD*ZERO     WN0128 112       WEEKLY CREDITS
     C                     Z-ADD*ZERO     WN0129 112       MONTHLY SALES
     C                     Z-ADD*ZERO     WN0130 111       MONTHLY UNITS
     C                     Z-ADD*ZERO     WN0131 112       MONTHLY DISCOUN
     C                     Z-ADD*ZERO     WN0132 112       MONTHLY CREDITS
     C                     Z-ADD*ZERO     WN0133 112       QUARTER SALES
     C                     Z-ADD*ZERO     WN0134 111       QUARTER UNITS
     C                     Z-ADD*ZERO     WN0135 112       QUARTER DISCOUN
     C                     Z-ADD*ZERO     WN0136 112       QUARTER CREDITS
     C                     Z-ADD*ZERO     WN0137 112       Y-T-D  DISCOUNT
     C                     Z-ADD*ZERO     WN0138 112       Y-T-D CREDITS
     C                     MOVEL*BLANK    WN0139  1        DELETE (D)
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @SALEPP
     C                     MOVELWDIMAA    WEIMAA    P      PRODUCT CODE
     C                     MOVELWDINAA    WEINAA    P      TERRITORY
      *
     C           KLCHSL    KLIST
     C                     KFLD           WEIMAA           PRODUCT CODE
     C                     KFLD           WEINAA           TERRITORY
     C           KLCHSL    CHAIN@SALEPP              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'JRSALEL2'MDACP
     C                     MOVEL'@SALEPP' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QJRSA1    YDRDCS
      * Move non-key fields to @SALEPP
     C                     Z-ADDWN0015    WEIJVL           Y-T-D SALES
     C                     Z-ADDWN0016    WEIKVL           Y-T-D UNITS
      *
      * Set PGM.*Record Data Changed flag
     C           QJRSA1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@SALEPP                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKJRSALEL2               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WAAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WAAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WAAIWG           Unit Weight
     C                     Z-ADD*ZERO     WACZWG           Minimum Weight
     C                     Z-ADD*ZERO     WAC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WAURTN           Number Cases On
     C                     Z-ADD*ZERO     WAAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WATFNB           Transportation
     C                     Z-ADD*ZERO     WATMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WATNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WABLPR           Market Overage
     C                     Z-ADD*ZERO     WABMPR           Standard Overag
     C                     Z-ADD*ZERO     WACMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WACHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WASWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WAPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WAICN1           Item Category N
     C                     Z-ADD*ZERO     WAICN2           Item Category N
     C                     Z-ADD*ZERO     WAV2NB           Item Category N
     C                     Z-ADD*ZERO     WAITCN           Item Category N
     C                     Z-ADD*ZERO     WAITC5           Item Category N
     C                     Z-ADD*ZERO     WAICN6           Item Category N
     C                     Z-ADD*ZERO     WAICN7           Item Category N
     C                     Z-ADD*ZERO     WAICN8           Item Category N
     C                     Z-ADD*ZERO     WAICN9           Item Category N
     C                     Z-ADD*ZERO     WAICN0           Item Category N
     C                     Z-ADD*ZERO     WASFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WAA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WASJNB           CI Unused Numbe
     C                     Z-ADD*ZERO     WASKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WASLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WASMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WACFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WACGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WAILNB           PM % 2nds Facto
     C                     Z-ADD*ZERO     WACHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WACINB           PM Batch Size
     C                     Z-ADD*ZERO     WACJNB           PM Lot Size
     C                     Z-ADD*ZERO     WACMNB           Partial Item Co
     C                     Z-ADD*ZERO     WACNNB           WIP Item Code
     C                     Z-ADD*ZERO     WACRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WACSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WACVNB           FP Std Green We
     C                     Z-ADD*ZERO     WACWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WACXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WACZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WAC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WAB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WAB5NB           PM Line Number
     C                     Z-ADD*ZERO     WABDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WABJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WAF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WAF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WAF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WABLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WABNNB           Production Qty
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBDPNB           Order Sequence
     C                     Z-ADD*ZERO     WBUENB           Order Secondary
     C                     Z-ADD*ZERO     WBBTC7           Parent Customer
     C                     Z-ADD*ZERO     WBANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBA0DT           Order Date
     C                     Z-ADD*ZERO     WBACDT           Cancel Date
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WBT3NB           Attach to Order
     C                     Z-ADD*ZERO     WBRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WBORIT           Original Item
     C                     Z-ADD*ZERO     WBAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WBD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WBCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WBAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WBAKPR           Unit Price
     C                     Z-ADD*ZERO     WBAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBAWDT           Invoice Date
     C                     Z-ADD*ZERO     WBHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WBAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WBAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WBAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WBAYVA           Extended Amount
     C                     Z-ADD*ZERO     WBL6NB           Contract Number
     C                     Z-ADD*ZERO     WBHCDT           LD Arrival Date
     C                     Z-ADD*ZERO     WBESNB           Accounting Year
     C                     Z-ADD*ZERO     WBETNB           Accounting Peri
     C                     Z-ADD*ZERO     WBBZNB           OM Week
     C                     Z-ADD*ZERO     WBEXQT           Quantity Billed
     C                     Z-ADD*ZERO     WBBYWG           Weight Billed
     C                     Z-ADD*ZERO     WBS5NB           Shipped Item Co
     C                     Z-ADD*ZERO     WBMAVA           Billing Detail
     C                     Z-ADD*ZERO     WBKDVA           Billing Detail
     C                     Z-ADD*ZERO     WBUSVA           FOB Gross Amoun
     C                     Z-ADD*ZERO     WBUTVA           Standard Overag
     C                     Z-ADD*ZERO     WBA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WBCKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WBR8NB           Shipping Compan
     C                     Z-ADD*ZERO     WBBZPR           Price Overage O
     C                     Z-ADD*ZERO     WBEXDT           Market Pricing
     C                     Z-ADD*ZERO     WBRGNB           Item Structure
     C                     Z-ADD*ZERO     WBRHNB           Item Structure
     C                     Z-ADD*ZERO     WBRINB           Item Structure
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBCONB           Invoice Number
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WBSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WBSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WBONVA           Actual Freight
     C                     Z-ADD*ZERO     WBB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WBB5NB           PM Line Number
     C                     Z-ADD*ZERO     WBGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WBULVA           Absorbed Freigh
     C                     Z-ADD*ZERO     WBUNVA           Ledgrd Trd Fund
     C                     Z-ADD*ZERO     WBUOVA           Commission Amou
     C                     Z-ADD*ZERO     WBUPVA           Financials Amou
     C                     Z-ADD*ZERO     WBUQVA           Financials Amou
     C                     Z-ADD*ZERO     WBCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WBDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WBB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WBIANX           Req Shipping Te
     C                     Z-ADD*ZERO     WBIBNX           Actual Shipping
     C                     Z-ADD*ZERO     WBNYDT           Req Delivery Da
     C                     Z-ADD*ZERO     WBBZTM           Req Delivery Ti
     C                     Z-ADD*ZERO     WBZ4NB           MPC Number
     C                     Z-ADD*ZERO     WBOCFR           Ocean Freight
     C                     Z-ADD*ZERO     WBC0C7           Claim Number
     C                     Z-ADD*ZERO     WBA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WBA5PR           Commodity Marke
     C                     Z-ADD*ZERO     WBCDPR           Market Value
     C                     Z-ADD*ZERO     WBD0PR           Default Cmdty M
     C                     Z-ADD*ZERO     WBD0VL           Raw Material Co
     C                     Z-ADD*ZERO     WBCEVL           Sales Expense T
     C                     Z-ADD*ZERO     WBOHDT           LD Sail Date
     C                     Z-ADD*ZERO     WBD9PR           NonLedgrd TrdFn
     C                     Z-ADD*ZERO     WBCFVL           HST Item Target
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDH7VL           WEEKLY SALES
     C                     Z-ADD*ZERO     WDH8VL           WEEKLY UNITS
     C                     Z-ADD*ZERO     WDH9VL           WEEKLY DISCOUNT
     C                     Z-ADD*ZERO     WDIAVL           WEEKLY CREDITS
     C                     Z-ADD*ZERO     WDIBVL           MONTHLY SALES
     C                     Z-ADD*ZERO     WDICVL           MONTHLY UNITS
     C                     Z-ADD*ZERO     WDIDVL           MONTHLY DISCOUN
     C                     Z-ADD*ZERO     WDIEVL           MONTHLY CREDITS
     C                     Z-ADD*ZERO     WDIFVL           QUARTER SALES
     C                     Z-ADD*ZERO     WDIGVL           QUARTER UNITS
     C                     Z-ADD*ZERO     WDIHVL           QUARTER DISCOUN
     C                     Z-ADD*ZERO     WDIIVL           QUARTER CREDITS
     C                     Z-ADD*ZERO     WDIJVL           Y-T-D SALES
     C                     Z-ADD*ZERO     WDIKVL           Y-T-D UNITS
     C                     Z-ADD*ZERO     WDILVL           Y-T-D  DISCOUNT
     C                     Z-ADD*ZERO     WDIMVL           Y-T-D CREDITS
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SARVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     Z-ADD*ZERO     WL0003  70
     C                     MOVEL*BLANK    WL0004  1
      * Define local variables for subroutine SECRRC.
     C                     MOVEL*BLANK    WL0005  5
     C                     MOVEL*BLANK    WL0006  2
     C                     Z-ADD*ZERO     WL0007 112
     C                     Z-ADD*ZERO     WL0008 111
     C                     Z-ADD*ZERO     WL0009 112
     C                     Z-ADD*ZERO     WL0010 112
     C                     Z-ADD*ZERO     WL0011 112
     C                     Z-ADD*ZERO     WL0012 111
     C                     Z-ADD*ZERO     WL0013 112
     C                     Z-ADD*ZERO     WL0014 112
     C                     Z-ADD*ZERO     WL0015 112
     C                     Z-ADD*ZERO     WL0016 111
     C                     Z-ADD*ZERO     WL0017 112
     C                     Z-ADD*ZERO     WL0018 112
     C                     Z-ADD*ZERO     WL0019 112
     C                     Z-ADD*ZERO     WL0020 111
     C                     Z-ADD*ZERO     WL0021 112
     C                     Z-ADD*ZERO     WL0022 112
     C                     MOVEL*BLANK    WL0023  1
      * Define local work field Date From             USR
     C                     Z-ADD*ZERO     YL0001  70
      * Define local work field Date To               USR
     C                     Z-ADD*ZERO     YL0002  70
      * Define local work field Item Code 5.0
     C                     Z-ADD*ZERO     YL0003  50
      * Define local work field Weight Billed
     C                     Z-ADD*ZERO     YL0004 112
      * Define local work field Billing Detail Cost Dol.
     C                     Z-ADD*ZERO     YL0005 112
      * Define local work field Billing Activity Type
     C                     MOVEL*BLANK    YL0006  1
      *================================================================
     CSR         ZZEXIT    ENDSR
