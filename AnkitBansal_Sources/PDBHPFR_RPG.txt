     H/TITLE BPS Capture Inv OnHnd PF  Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Print file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 02/17/23  Time  : 08:26:22
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FCAB0RELJIF  E           K        DISK
      * RTV : Item Balance              Acitve records only
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FCAAFREL6IF  E           K        DISK
      * RSQ : Calendar                  RSQ Co/Date Descending
      *
     FCAAFREL3IF  E           K        DISK
      * RSQ : Calendar                  Co/Date               NV
      *
     FCAB1REL4IF  E           K        DISK
      * RTV : Item Balance Detail       Active only
      *
     FOPBGWKLFIF  E           K        DISK
      * RSQ : Order Detail              Co/Itm/Whs/SSD(d)/Od Omt
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FCAB1REL0IF  E           K        DISK
      * RTV : Item Balance Detail       Retrieval index       NV
      *
     FPDI8CPL1IF  E           K        DISK
      * RTV : PS Prod Item Schedule     Retrieval index
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse Codes           Active records only
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FPOCWCPL0IF  E           K        DISK                      A
      * UPD : PS Prod Item Inventory    Update index
      *
     FPDI8CPL0UF  E           K        DISK                      A
      * UPD : PS Prod Item Schedule     Update index
      *
     FPDBHPFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: BPS Capture Inv OnHnd PF  Print file
      *
     E                    UCT        40  1               CENTER TABLE
     E                    #L3         3  1
     E                    #L7         7  1
     I@AFREYY
      * Calendar                  Co/Date               NV
      * Renamed input format fields
     I              AFAIC3                          WAAIC3
     I              AFBCDT                          WABCDT
     I              AFCQNB                          WACQNB
     I              AFESNB                          WAESNB
     I              AFETNB                          WAETNB
     I              AFBZNB                          WABZNB
     I              AFA9ST                          WAA9ST
     I              AFEINB                          WAEINB
     I              AFC5ST                          WAC5ST
     I              AFAQNB                          WAAQNB
     I              AFCMST                          WACMST
     I              AFV9ST                          WAV9ST
     I              AFWAST                          WAWAST
     I              AFX2ST                          WAX2ST
     I              AFOJDT                          WAOJDT
     I              AFNQNX                          WANQNX
     I              AFNRNX                          WANRNX
     I              AFI9SX                          WAI9SX
     I              AFJASX                          WAJASX
     I              AFOKDT                          WAOKDT
     I              AFOLDT                          WAOLDT
     I              AFUVST                          WAUVST
     I              AFUWST                          WAUWST
     I              AFUXST                          WAUXST
     I              AFAATM                          WAAATM
     I              AFAYNA                          WAAYNA
     I              AFA0NA                          WAA0NA
     I              AFAXDT                          WAAXDT
      *
     I@B1REJ0
      * Item Balance Detail       Retrieval index       NV
      * Renamed input format fields
     I              B1AIC3                          WBAIC3
     I              B1HGCD                          WBHGCD
     I              B1AJCD                          WBAJCD
     I              B1ELDT                          WBELDT
     I              B1ABWG                          WBABWG
     I              B1AGQT                          WBAGQT
     I              B1AHQT                          WBAHQT
     I              B1AIQT                          WBAIQT
     I              B1CTST                          WBCTST
     I              B1ACWG                          WBACWG
     I              B1ARQT                          WBARQT
     I              B1ASQT                          WBASQT
     I              B1ATQT                          WBATQT
     I              B1HDQT                          WBHDQT
     I              B1HEQT                          WBHEQT
     I              B1F6ST                          WBF6ST
     I              B1BMWG                          WBBMWG
     I              B1DSQT                          WBDSQT
     I              B1DTQT                          WBDTQT
     I              B1DUQT                          WBDUQT
     I              B1DHDT                          WBDHDT
     I              B1AGCS                          WBAGCS
     I              B1AECS                          WBAECS
     I              B1IDVA                          WBIDVA
     I              B1K7DT                          WBK7DT
     I              B1RINB                          WBRINB
     I              B1RHNB                          WBRHNB
     I              B1RGNB                          WBRGNB
     I              B1UVST                          WBUVST
     I              B1UWST                          WBUWST
     I              B1UXST                          WBUXST
     I              B1VSST                          WBVSST
     I              B1AATM                          WBAATM
     I              B1AYNA                          WBAYNA
     I              B1A0NA                          WBA0NA
     I              B1AXDT                          WBAXDT
      *
     I@ADRET1
      * Warehouse Codes           Active records only
      * Renamed input format fields
     I              ADAJCD                          WCAJCD
     I              ADF8NA                          WCF8NA
     I              ADACNA                          WCACNA
     I              ADADNA                          WCADNA
     I              ADAENA                          WCAENA
     I              ADAJNA                          WCAJNA
     I              ADBTTX                          WCBTTX
     I              ADAOCD                          WCAOCD
     I              ADBGCD                          WCBGCD
     I              ADVHST                          WCVHST
     I              ADMPNA                          WCMPNA
     I              ADWPST                          WCWPST
     I              ADXUST                          WCXUST
     I              ADT0ST                          WCT0ST
     I              ADT1ST                          WCT1ST
     I              ADDBNB                          WCDBNB
     I              ADT2ST                          WCT2ST
     I              ADT3ST                          WCT3ST
     I              ADT4ST                          WCT4ST
     I              ADT6ST                          WCT6ST
     I              ADBWC3                          WCBWC3
     I              ADBTC3                          WCBTC3
     I              ADBUC3                          WCBUC3
     I              ADBVC3                          WCBVC3
     I              ADFCAA                          WCFCAA
     I              ADRQSX                          WCRQSX
     I              ADRRSX                          WCRRSX
     I              ADRSSX                          WCRSSX
     I              ADRTSX                          WCRTSX
     I              ADT7ST                          WCT7ST
     I              ADT8ST                          WCT8ST
     I              ADRNSX                          WCRNSX
     I              ADROSX                          WCROSX
     I              ADRPSX                          WCRPSX
     I              ADUVST                          WCUVST
     I              ADUWST                          WCUWST
     I              ADUXST                          WCUXST
     I              ADVSST                          WCVSST
     I              ADAATM                          WCAATM
     I              ADAYNA                          WCAYNA
     I              ADA0NA                          WCA0NA
     I              ADAXDT                          WCAXDT
      *
     I@I8CPUR
      * PS Prod Item Schedule     Update index
      * Renamed input format fields
     I              I8AIC3                          WDAIC3
     I              I8V5ST                          WDV5ST
     I              I8ELDT                          WDELDT
     I              I8HGCD                          WDHGCD
     I              I8AJCD                          WDAJCD
     I              I8GPDT                          WDGPDT
     I              I8WTSP                          WDWTSP
     I              I8QTSP                          WDQTSP
     I              I8DJPC                          WDDJPC
     I              I8F8WG                          WDF8WG
     I              I8WTIN                          WDWTIN
     I              I8D5NB                          WDD5NB
     I              I8DXWG                          WDDXWG
     I              I8B2NB                          WDB2NB
     I              I8WTCN                          WDWTCN
     I              I8PSCV                          WDPSCV
     I              I8SAWT                          WDSAWT
     I              I8B9NB                          WDB9NB
     I              I8D1WG                          WDD1WG
     I              I8CBNB                          WDCBNB
     I              I8EZWG                          WDEZWG
     I              I8CCNB                          WDCCNB
     I              I8E0WG                          WDE0WG
     I              I8D6NB                          WDD6NB
     I              I8OAWT                          WDOAWT
     I              I8CDNB                          WDCDNB
     I              I8UNW2                          WDUNW2
     I              I8CENB                          WDCENB
     I              I8F9WG                          WDF9WG
     I              I8BPNB                          WDBPNB
     I              I8GAWG                          WDGAWG
     I              I8BQNB                          WDBQNB
     I              I8GBWG                          WDGBWG
     I              I8BRNB                          WDBRNB
     I              I8GCWG                          WDGCWG
     I              I8BSNB                          WDBSNB
     I              I8GDWG                          WDGDWG
     I              I8BWNB                          WDBWNB
     I              I8GEWG                          WDGEWG
     I              I8PS6U                          WDPS6U
     I              I8WCST                          WDWCST
     I              I8WPST                          WDWPST
     I              I8B5ST                          WDB5ST
     I              I8TFST                          WDTFST
     I              I8TEST                          WDTEST
     I              I8THST                          WDTHST
     I              I8UDST                          WDUDST
     I              I8UFST                          WDUFST
     I              I8UGST                          WDUGST
     I              I8UHST                          WDUHST
     I              I8B6ST                          WDB6ST
     I              I8B7ST                          WDB7ST
     I              I8DVWG                          WDDVWG
     I              I8D7NB                          WDD7NB
     I              I8FCAD                          WDFCAD
     I              I8D9NB                          WDD9NB
     I              I8DWWG                          WDDWWG
     I              I8EANB                          WDEANB
     I              I8SHWT                          WDSHWT
     I              I8EBNB                          WDEBNB
     I              I8AVWT                          WDAVWT
     I              I8ECNB                          WDECNB
     I              I8WTON                          WDWTON
     I              I8EDNB                          WDEDNB
     I              I8FNWT                          WDFNWT
     I              I8EENB                          WDEENB
     I              I8QTAS                          WDQTAS
     I              I8EFNB                          WDEFNB
     I              I8WAIO                          WDWAIO
     I              I8EGNB                          WDEGNB
     I              I8R3CD                          WDR3CD
     I              I8RGNB                          WDRGNB
     I              I8RHNB                          WDRHNB
     I              I8RINB                          WDRINB
     I              I8XRCD                          WDXRCD
     I              I8UVST                          WDUVST
     I              I8UWST                          WDUWST
     I              I8UXST                          WDUXST
     I              I8VSST                          WDVSST
     I              I8AATM                          WDAATM
     I              I8AYNA                          WDAYNA
     I              I8A0NA                          WDA0NA
     I              I8AXDT                          WDAXDT
      *
     I@AFREBE
      * Calendar                  Retrieval index       NV
      * Renamed input format fields
     I              AFAIC3                          WEAIC3
     I              AFBCDT                          WEBCDT
     I              AFCQNB                          WECQNB
     I              AFESNB                          WEESNB
     I              AFETNB                          WEETNB
     I              AFBZNB                          WEBZNB
     I              AFA9ST                          WEA9ST
     I              AFEINB                          WEEINB
     I              AFC5ST                          WEC5ST
     I              AFAQNB                          WEAQNB
     I              AFCMST                          WECMST
     I              AFV9ST                          WEV9ST
     I              AFWAST                          WEWAST
     I              AFX2ST                          WEX2ST
     I              AFOJDT                          WEOJDT
     I              AFNQNX                          WENQNX
     I              AFNRNX                          WENRNX
     I              AFI9SX                          WEI9SX
     I              AFJASX                          WEJASX
     I              AFOKDT                          WEOKDT
     I              AFOLDT                          WEOLDT
     I              AFUVST                          WEUVST
     I              AFUWST                          WEUWST
     I              AFUXST                          WEUXST
     I              AFAATM                          WEAATM
     I              AFAYNA                          WEAYNA
     I              AFA0NA                          WEA0NA
     I              AFAXDT                          WEAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
     IQPOCW1    E DSPOCWCPL0
      * UPD : PS Prod Item Inventory    Update index
      *
     IQPDI81    E DSPDI8CPL0
      * UPD : PS Prod Item Schedule     Update index
      * Renamed input format fields
     I              I8AIC3                          WDAIC3
     I              I8V5ST                          WDV5ST
     I              I8ELDT                          WDELDT
     I              I8HGCD                          WDHGCD
     I              I8AJCD                          WDAJCD
     I              I8GPDT                          WDGPDT
     I              I8WTSP                          WDWTSP
     I              I8QTSP                          WDQTSP
     I              I8DJPC                          WDDJPC
     I              I8F8WG                          WDF8WG
     I              I8WTIN                          WDWTIN
     I              I8D5NB                          WDD5NB
     I              I8DXWG                          WDDXWG
     I              I8B2NB                          WDB2NB
     I              I8WTCN                          WDWTCN
     I              I8PSCV                          WDPSCV
     I              I8SAWT                          WDSAWT
     I              I8B9NB                          WDB9NB
     I              I8D1WG                          WDD1WG
     I              I8CBNB                          WDCBNB
     I              I8EZWG                          WDEZWG
     I              I8CCNB                          WDCCNB
     I              I8E0WG                          WDE0WG
     I              I8D6NB                          WDD6NB
     I              I8OAWT                          WDOAWT
     I              I8CDNB                          WDCDNB
     I              I8UNW2                          WDUNW2
     I              I8CENB                          WDCENB
     I              I8F9WG                          WDF9WG
     I              I8BPNB                          WDBPNB
     I              I8GAWG                          WDGAWG
     I              I8BQNB                          WDBQNB
     I              I8GBWG                          WDGBWG
     I              I8BRNB                          WDBRNB
     I              I8GCWG                          WDGCWG
     I              I8BSNB                          WDBSNB
     I              I8GDWG                          WDGDWG
     I              I8BWNB                          WDBWNB
     I              I8GEWG                          WDGEWG
     I              I8PS6U                          WDPS6U
     I              I8WCST                          WDWCST
     I              I8WPST                          WDWPST
     I              I8B5ST                          WDB5ST
     I              I8TFST                          WDTFST
     I              I8TEST                          WDTEST
     I              I8THST                          WDTHST
     I              I8UDST                          WDUDST
     I              I8UFST                          WDUFST
     I              I8UGST                          WDUGST
     I              I8UHST                          WDUHST
     I              I8B6ST                          WDB6ST
     I              I8B7ST                          WDB7ST
     I              I8DVWG                          WDDVWG
     I              I8D7NB                          WDD7NB
     I              I8FCAD                          WDFCAD
     I              I8D9NB                          WDD9NB
     I              I8DWWG                          WDDWWG
     I              I8EANB                          WDEANB
     I              I8SHWT                          WDSHWT
     I              I8EBNB                          WDEBNB
     I              I8AVWT                          WDAVWT
     I              I8ECNB                          WDECNB
     I              I8WTON                          WDWTON
     I              I8EDNB                          WDEDNB
     I              I8FNWT                          WDFNWT
     I              I8EENB                          WDEENB
     I              I8QTAS                          WDQTAS
     I              I8EFNB                          WDEFNB
     I              I8WAIO                          WDWAIO
     I              I8EGNB                          WDEGNB
     I              I8R3CD                          WDR3CD
     I              I8RGNB                          WDRGNB
     I              I8RHNB                          WDRHNB
     I              I8RINB                          WDRINB
     I              I8XRCD                          WDXRCD
     I              I8UVST                          WDUVST
     I              I8UWST                          WDUWST
     I              I8UXST                          WDUXST
     I              I8VSST                          WDVSST
     I              I8AATM                          WDAATM
     I              I8AYNA                          WDAYNA
     I              I8A0NA                          WDA0NA
     I              I8AXDT                          WDAXDT
      *
     IYARDCS      DS                            326
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Item Balance
      * I : RST Company Number
     I                                    P   1   20P1AIC3
      * I :  Warehouse Code
     I                                        3   5 P1AJCD
     IP2PARM      DS
      * I : MAP Production Date RGF
     I                                    P   1   40P2GVDT
     IP3PARM      DS
      * N :  PS Weight Sched Shipment
     I                                    P   1   52P3SHWT
     IP4PARM      DS
      * N :  PS Weight Available Prod
     I                                    P   1   52P4AVWT
     IP5PARM      DS
      * FLD: Company Item
      * N :  Unit Weight
     I                                    P   1   62P5AIWG
      * N :  Fresh Chilling Time
     I                                    P   7   92P5CHTM
      * N :  Base_Conv_Loss Item
     I                                       10  11 P5QZCD
      * N :  Credit Item Status
     I                                       12  12 P5VMST
      * N :  Piece Count Item
     I                                       13  13 P5PCCT
      * N :  Pieces Per Bag
     I                                    P  14  170P5BDNB
      * N :  Bags Per Unit
     I                                    P  18  210P5BJNB
     IP6PARM      DS
      * N :  USR Quantity Accumulated
     I                                    P   1   40P6FVQT
     IP7PARM      DS
      * N :  Date From             USR
     I                                    P   1   40P7JEDT
     IP8PARM      DS
      * FLD: Warehouse Codes
      * N :  Warehouse Std Chill Time
     I                                        1   1 P8T1ST
      * N :  Warehouse Chill Time
     I                                    P   2   42P8DBNB
     IP9PARM      DS
      * N :  Chilling Time USR
     I                                    P   1   32P9CHMT
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1AJCD    PARM           WP0002  3        Warehouse Code
     C           P2GVDT    PARM           WP0003  70       Production Date
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * BPS Capture Inv OnHnd PF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$FENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * BPS Capture Inv OnHnd PF: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN B0AIC3    WQKA01           Company Number
      * Define keylist
     C           KRSA      KLIST
     C                     KFLD           WQKA01           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WQKA01           Company Number
      * Establish starting position
     C           KRSA      SETLL@B0REYY                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        Company Number
     C                     MOVEL'Y'       W0AL01  1        Item Code
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDB0AIC3    $BAIC3           Company Number
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP01  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDB0AIC3    $CAIC3           Company Number
     C                     Z-ADDB0HGCD    $CHGCD           Item Code
     C                     MOVELB0AJCD    $CAJCD           Warehouse Code
     C                     Z-ADDB0AGCS    $CAGCS           Unit Cost Per P
     C                     Z-ADDB0AECS    $CAECS           Last Cost
     C                     Z-ADDB0BACS    $CBACS           Cost per Primar
     C                     Z-ADDB0BBCS    $CBBCS           Cost per Pricin
     C                     Z-ADDB0CBPR    $CCBPR           Revaluation Cos
     C                     MOVELB0XYST    $CXYST           Revaluation Cos
     C                     Z-ADDB0CTPR    $CCTPR           Last Revaluatio
     C                     Z-ADDB0G4DT    $CG4DT           Last Revaluatio
     C                     Z-ADDB0BOWG    $CBOWG           On Hand Weight
     C                     Z-ADDB0HDQT    $CHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     $CSHWT           PS Weight Sched
     C                     Z-ADDB0GUDT    $CGUDT           Revaluation Eff
     C                     Z-ADDB0DDQT    $CDDQT           On Hand UOM1 Su
     C                     Z-ADDB0DEQT    $CDEQT           On Hand UOM2 Su
     C                     Z-ADDB0DFQT    $CDFQT           On Hand UOM3 Su
     C                     Z-ADDB0HEQT    $CHEQT           Weight In Chill
     C                     Z-ADDB0AJQT    $CAJQT           Quantity Schedu
     C                     Z-ADDB0AQQT    $CAQQT           Quantity on Sal
     C                     Z-ADDB0AUQT    $CAUQT           Quantity on Pur
     C                     Z-ADDB0EMQT    $CEMQT           Quantity on Tra
     C                     Z-ADDB0DOQT    $CDOQT           Quantity Avail
     C                     MOVELB0ATNA    $CATNA           Cycle Count Cod
     C                     Z-ADDB0AKDT    $CAKDT           Date of Last Or
     C                     Z-ADDB0ANDT    $CANDT           Date of Last Sh
     C                     Z-ADDB0IDVA    $CIDVA           Value of On Han
     C                     MOVELB0JVST    $CJVST           Inventory Plann
     C                     Z-ADDB0BZPC    $CBZPC           Safety Allowanc
     C                     Z-ADDB0DGQT    $CDGQT           Safety Allowanc
     C                     Z-ADDB0DIDT    $CDIDT           Stock Out Date
     C                     MOVELB0ALCD    $CALCD           Buyer Code
     C                     Z-ADDB0BFDY    $CBFDY           Lead Time Last
     C                     Z-ADDB0DJDT    $CDJDT           Lead Time Date
     C                     Z-ADDB0BGDY    $CBGDY           Lead Time Next
     C                     Z-ADDB0DKDT    $CDKDT           Lead Time Date
     C                     MOVELB0J2ST    $CJ2ST           Lead Time Excep
     C                     Z-ADDB0DJQT    $CDJQT           Usage Qty per C
     C                     Z-ADDB0BNWG    $CBNWG           Usage Weight pe
     C                     Z-ADDB0DLDT    $CDLDT           Inventory Manag
     C                     Z-ADDB0DPQT    $CDPQT           Minimum Quantit
     C                     Z-ADDB0DQQT    $CDQQT           Maximum Quantit
     C                     Z-ADDB0DMDT    $CDMDT           Last Physical C
     C                     MOVELB0M0ST    $CM0ST           Requisition Mod
     C                     MOVELB0J9ST    $CJ9ST           Cost Update Pen
     C                     MOVELB0KBST    $CKBST           Post GL Status
     C                     Z-ADDB0AKC8    $CAKC8           Vendor Item_Whs
     C                     Z-ADDB0RINB    $CRINB           Item Structure
     C                     Z-ADDB0RHNB    $CRHNB           Item Structure
     C                     Z-ADDB0RGNB    $CRGNB           Item Structure
     C                     MOVELB0UVST    $CUVST           EDI Status 1
     C                     MOVELB0UWST    $CUWST           EDI Status 2
     C                     MOVELB0UXST    $CUXST           EDI Status 3
     C                     MOVELB0VSST    $CVSST           Record Status
     C                     Z-ADDB0AATM    $CAATM           Job Time
     C                     MOVELB0AYNA    $CAYNA           User Id
     C                     MOVELB0A0NA    $CA0NA           Job Name
     C                     Z-ADDB0AXDT    $CAXDT           Job Date
      * USER: Process before print of detail format
      *
     C                     Z-ADD*ZERO     WN0001 155       System Value Nu
      *
      * UPS Rtv Company/Item  IF
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$CAIC3    WL0001           Company Number
     C                     Z-ADD$CHGCD    WL0002           Item Code
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    WUAVNA    P      Description Lin
     C                     MOVELWL0004    WUADCD    P      UOM Primary
     C                     Z-ADDWL0005    P5AIWG           Unit Weight
     C                     Z-ADDWL0006    WURINB           Item Structure
     C                     Z-ADDWL0007    WURHNB           Item Structure
     C                     Z-ADDWL0008    WURGNB           Item Structure
     C                     MOVELWL0009    WUN0CD    P      Item Type Code
     C                     MOVELWL0010    WUQ1CD    P      Default Warehou
     C                     Z-ADDWL0011    P5CHTM           Fresh Chilling
     C                     MOVELWL0012    WUQZCD    P      Base_Conv_Loss
     C                     MOVELWL0013    WUXWST    P      Variety_Rendere
     C                     MOVELWL0014    WUVMST    P      Credit Item Sta
     C                     Z-ADDWL0015    WUSWGH           Std Weight_Head
     C                     Z-ADDWL0016    WUPPHE           Pieces Per Head
     C                     MOVELWL0017    WUR3CD    P      Department Code
     C                     MOVELWL0018    WUSDCD    P      Group for Packa
     C                     MOVELWL0019    WUX5ST    P      Seconds Item
     C                     MOVELWL0020    P5PCCT    P      Piece Count Ite
     C                     Z-ADDWL0021    P5BDNB           Pieces Per Bag
     C                     Z-ADDWL0022    P5BJNB           Bags Per Unit
     C                     MOVELWL0023    WUSUST    P      Export_Domestic
     C                     MOVELWL0024    WUSVST    P      Print On Schedu
     C                     MOVELWL0025    WUSYST    P      Fresh Inv Alloc
     C                     MOVELWL0026    WUSZST    P      Fresh Sched As
     C                     MOVELWL0027    WUS1ST    P      Frozen Inv Allo
     C                     MOVELWL0028    WUXRCD    P      Primal Group Co
      * BPS Rtv Whs Info      RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL$CAJCD    WL0029    P      Warehouse Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0030    WUWPST    P      Warehouse Type
     C                     MOVELWL0031    WUXUST    P      Trans Contol AS
     C                     MOVELWL0032    WUT0ST    P      Warehouse Locat
     C                     MOVELWL0033    P8T1ST    P      Warehouse Std C
     C                     Z-ADDWL0034    P8DBNB           Warehouse Chill
      * CASE: PAR.Warehouse Std Chill Time is yes
     C           P8T1ST    IFEQ 'Y'                        *IF
     C                     Z-ADDP8DBNB    P9CHMT           Chilling Time U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP5CHTM    P9CHMT           Chilling Time U
     C                     END                             *FI
      * Weight On-Hand/Pieces
      * CASE: CUR.On Hand U/M1 Summary is Greater than zero
     C           $CDDQT    IFGT *ZERO                      *IF
      * Calculate On-Hand Quantity
      * CASE: PAR.Chilling Time USR is GT Zero
     C           P9CHMT    IFGT *ZERO                      *IF
      * Chilling Time
      * WRK.Chilling Time USR =
      *    *COMPUTE ((x1 - x3) * x2)
      * x1    : PAR.Chilling Time USR
      * -     : PGM.*Synon (15,0) work field
      * x3    : CON.1
      * *     : PGM.*Synon (15,0) work field *
      * x2    : CON.-1
     C           P9CHMT    SUB  1         W0WJ01           *Synon (15,0) w
     C           W0WJ01    MULT -1        W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WUCHMT           Chilling Time U
      * CLC Inc/Dec Date       IF
      * CASE: PAR.*Duration (factor) is LT Zero
     C           WUCHMT    IFLT 0                          *IF
     C           WUCHMT    MULT -1        WUDUF            *Duration (fact
      * Clc Date (descending) RT - Calendar  * 
     C                     EXSR SERVGN
     C                     ELSE
      * CASE: PAR.*Duration (factor) is GT Zero
     C           WUCHMT    IFGT 0                          *IF
      * Clc Date (ascending)  RT - Calendar  * 
     C                     EXSR SFRVGN
     C                     ELSE
      * CASE: PAR.*Duration (factor) is EQ Zero
     C           WUCHMT    IFEQ 0                          *IF
     C                     Z-ADDP2GVDT    P7JEDT           *Date1 (ending)
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CUR PS Quantity On-Hand = Quantity in Chill
      * UPS Clc Unavail Inv   RT - Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$CAIC3    WL0035           Company Number
     C                     Z-ADD$CHGCD    WL0036           Item Code
     C                     MOVEL$CAJCD    WL0037    P      Warehouse Code
     C                     Z-ADDP7JEDT    WL0038           Production Date
     C                     Z-ADD$CHDQT    WL0039           Quantity In Chi
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0039    $CHDQT           Quantity In Chi
     C           B0DDQT    SUB  $CHDQT    WUDDQT           On Hand UOM1 Su
     C                     ELSE
      * CASE: *OTHERWISE
      * UPS Clc Unavail Inv   RT - Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$CAIC3    WL0035           Company Number
     C                     Z-ADD$CHGCD    WL0036           Item Code
     C                     MOVEL$CAJCD    WL0037    P      Warehouse Code
     C                     Z-ADDP2GVDT    WL0038           Production Date
     C                     Z-ADD$CHDQT    WL0039           Quantity In Chi
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0039    $CHDQT           Quantity In Chi
     C           B0DDQT    SUB  $CHDQT    WUDDQT           On Hand UOM1 Su
     C                     END                             *FI
      * CASE: WRK.On Hand U/M1 Summary is Greater than zero
     C           WUDDQT    IFGT *ZERO                      *IF
      * Piece On-Hand
      * CASE: Piece Count = Y
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5PCCT    IFEQ 'Y'                        *IF
     C           P5BDNB    IFGT *ZERO                      *IF
     C           P5BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Pieces Inv On-Hand
      * WRK.PS Pieces Inv On-Hand =
      *    *COMPUTE (x1 * x2 * x3)
      * x1    : WRK.On Hand UOM1 Summary
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Bags Per Unit
     C           WUDDQT    MULT P5BDNB    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P5BJNB    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WUD5NB           PS Pieces Inv O
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUD5NB           PS Pieces Inv O
     C                     END                             *FI
     C           WUDDQT    MULT P5AIWG    $CBOWG    H      On Hand Weight
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUD5NB           PS Pieces Inv O
     C                     Z-ADD*ZERO     $CBOWG           On Hand Weight
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUD5NB           PS Pieces Inv O
     C                     Z-ADD*ZERO     $CBOWG           On Hand Weight
     C                     END                             *FI
      * UPS Rtv Sched Shpmnts RT - Order Detail  * 
     C                     EXSR SHRVGN
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : BPS Capture Inv OnHnd PO
     C                     EXSR UASUBR                     Embedded PRTOBJ
      * USER: Process after print of detail format
      * CASE: PGM.*Print format is Print format
     C           W0PFM     IFEQ 'Y'                        *IF
      * Update Inventory On-Hand
      * Pieces
      * CASE: LCL.Quantity Available    SUM is GT Zero
     C           YL0005    IFGT *ZERO                      *IF
      * Piece On-Hand
      * CASE: Piece Count = Y
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5PCCT    IFEQ 'Y'                        *IF
     C           P5BDNB    IFGT *ZERO                      *IF
     C           P5BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Pieces Inv On-Hand
      * WRK.PS Pieces Inv On-Hand =
      *    *COMPUTE (x1 * x2 * x3)
      * x1    : LCL.Quantity Available    SUM
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Bags Per Unit
     C           YL0005    MULT P5BDNB    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P5BJNB    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WUD5NB           PS Pieces Inv O
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUD5NB           PS Pieces Inv O
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUD5NB           PS Pieces Inv O
     C                     END                             *FI
      * BPS Upd Inv On Hand   RT - PS Prod Item Schedule  * 
     C                     EXSR SLRVGN
     C                     END                             *FI
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN B0AIC3    WZA001           Company Number
     C                     Z-ADDB0AIC3    WZA001
     C           *LIKE     DEFN B0HGCD    WZA002           Item Code
     C                     Z-ADDB0HGCD    WZA002
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C           KRSA      READE@B0REYY                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Warehouse Code is Not Blanks
      *   |- c2    : DB1.Warehouse Code NE PAR.Warehouse Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1AJCD    IFNE *BLANK                     *IF
     C           B0AJCD    IFNE P1AJCD                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        Company Number
     C                     MOVEL*BLANK    W0AL01  1        Item Code
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        Company Number
     C                     MOVEL'Y'       W0AL01  1        Item Code
     C                     ELSE
      * Next record - Detect level breaks
     C           B0AIC3    IFNE WZA001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C           B0HGCD    IFNE WZA002                     Item Code
     C           W0AL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL01
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP01
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         B0MAIN    BEGSR
      *================================================================
      * BPS Capture Inv OnHnd PO: Mainline
      *================================================================
      * BPS Capture Inv OnHnd PO: Initialise
     C                     EXSR ZBINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQKB01           Company Number
     C           *LIKE     DEFN WBHGCD    WQKB02           Item Code
     C           *LIKE     DEFN WBAJCD    WQKB03           Warehouse Code
      * Define keylist
     C           KRSB      KLIST
     C                     KFLD           WQKB01           Company Number
     C                     KFLD           WQKB02           Item Code
     C                     KFLD           WQKB03           Warehouse Code
      * Setup key
     C                     Z-ADD$CAIC3    WQKB01           Company Number
     C                     Z-ADD$CHGCD    WQKB02           Item Code
     C                     MOVEL$CAJCD    WQKB03           Warehouse Code
      * Establish starting position
     C           KRSB      SETLL@B1REJ0                    *
      * Read first record with user selection
     C                     EXSR B3READ
     C           W0EOFB    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0BL1P  1        First page
     C                     MOVEL'Y'       W0BL00  1        Company Number
     C                     MOVEL'Y'       W0BL01  1        Item Code
     C                     MOVEL'Y'       W0BL02  1        Warehouse Code
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      * Print report body
     C           W0EOFB    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR B1PHDR
      * Print report detail line
     C                     EXSR B2PDTL
      * Read next record with user selection
     C                     EXSR B3READ
      * Print totals
     C                     EXSR B4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         B0EXIT    ENDSR
      /EJECT
     CSR         B1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0BL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP1P  1
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP00  1
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADDWBAIC3    $EAIC3           Company Number
     C                     Z-ADDWBHGCD    $EHGCD           Item Code
     C                     Z-ADD*ZERO     $EIXWG           Weight 1 SUM
     C                     Z-ADD*ZERO     $EK5QT           Quantity Availa
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP01  1
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP02  1
     C                     END
      *
      *================================================================
     CSR         B1EXIT    ENDSR
      /EJECT
     CSR         B2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDWBAIC3    $DAIC3           Company Number
     C                     Z-ADDWBHGCD    $DHGCD           Item Code
     C                     MOVELWBAJCD    $DAJCD           Warehouse Code
     C                     Z-ADDWBELDT    $DELDT           Production Date
     C                     Z-ADDWBABWG    $DABWG           Physical Count
     C                     Z-ADDWBAGQT    $DAGQT           Physical Count
     C                     Z-ADDWBAHQT    $DAHQT           Physical Count
     C                     Z-ADDWBAIQT    $DAIQT           Physical Count
     C                     MOVELWBCTST    $DCTST           Physical Count
     C                     Z-ADDWBACWG    $DACWG           Quantity on Han
     C                     Z-ADDWBARQT    $DARQT           Quantity on Han
     C                     Z-ADDWBASQT    $DASQT           Quantity on Han
     C                     Z-ADDWBATQT    $DATQT           Quantity on Han
     C                     Z-ADDWBHDQT    $DHDQT           Quantity In Chi
     C                     Z-ADDWBHEQT    $DHEQT           Weight In Chill
     C                     MOVELWBF6ST    $DF6ST           Update Exceptio
     C                     Z-ADDWBBMWG    $DBMWG           Physical Start
     C                     Z-ADDWBDSQT    $DDSQT           Physical Start
     C                     Z-ADDWBDTQT    $DDTQT           Physical Start
     C                     Z-ADDWBDUQT    $DDUQT           Physical Start
     C                     Z-ADDWBDHDT    $DDHDT           Physical Start
     C                     Z-ADDWBAGCS    $DAGCS           Unit Cost Per P
     C                     Z-ADDWBAECS    $DAECS           Last Cost
     C                     Z-ADDWBIDVA    $DIDVA           Value of On Han
     C                     Z-ADDWBK7DT    $DK7DT           Label Date
     C                     Z-ADDWBRINB    $DRINB           Item Structure
     C                     Z-ADDWBRHNB    $DRHNB           Item Structure
     C                     Z-ADDWBRGNB    $DRGNB           Item Structure
     C                     MOVELWBUVST    $DUVST           EDI Status 1
     C                     MOVELWBUWST    $DUWST           EDI Status 2
     C                     MOVELWBUXST    $DUXST           EDI Status 3
     C                     MOVELWBVSST    $DVSST           Record Status
     C                     Z-ADDWBAATM    $DAATM           Job Time
     C                     MOVELWBAYNA    $DAYNA           User Id
     C                     MOVELWBA0NA    $DA0NA           Job Name
     C                     Z-ADDWBAXDT    $DAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * USER: Process after print of detail format
     C                     ADD  $DARQT    $EK5QT           Quantity Availa
     C                     ADD  $DACWG    $EIXWG           Weight 1 SUM
      *
      *================================================================
     CSR         B2EXIT    ENDSR
      /EJECT
     CSR         B3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN WBAIC3    WZB001           Company Number
     C                     Z-ADDWBAIC3    WZB001
     C           *LIKE     DEFN WBHGCD    WZB002           Item Code
     C                     Z-ADDWBHGCD    WZB002
     C           *LIKE     DEFN WBAJCD    WZB003           Warehouse Code
     C                     MOVELWBAJCD    WZB003
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFB    OREQ '1'
     C           KRSB      READE@B1REJ0                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFB  1
      * Quit if no record read
     C           W0EOFB    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * E2299 Do for prod whs only --> exclude stuff made today or later,
      * it was doing it for all warehouses
      * CASE: PAR.Production Warehouse Code EQ DB1.Warehouse Code
     C           YL0001    IFEQ WBAJCD                     *IF
      * CASE: DB1.Production Date GE JOB.*Job date
     C           WBELDT    IFGE ##JDT                      *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0BL00  1        Company Number
     C                     MOVEL*BLANK    W0BL01  1        Item Code
     C                     MOVEL*BLANK    W0BL02  1        Warehouse Code
     C           W0EOFB    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0BL00  1        Company Number
     C                     MOVEL'Y'       W0BL01  1        Item Code
     C                     MOVEL'Y'       W0BL02  1        Warehouse Code
     C                     ELSE
      * Next record - Detect level breaks
     C           WBAIC3    IFNE WZB001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL00
     C                     END
     C           WBHGCD    IFNE WZB002                     Item Code
     C           W0BL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL01
     C                     END
     C           WBAJCD    IFNE WZB003                     Warehouse Code
     C           W0BL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL02
     C                     END
     C                     END
      *================================================================
     CSR         B3EXIT    ENDSR
      /EJECT
     CSR         B4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0BL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP02
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Item Code format
     C                     Z-ADD$EIXWG    YL0004           Weight 1 SUM
     C                     Z-ADD$EK5QT    YL0005           Quantity Availa
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Convert fields to external form
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $EHGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$EHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VEHGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VEHGCD           CD7 Ext Numeric
     C                     END                             *FI
      * Print format
     C                     WRITE$EKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP01
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP00
     C                     END
      *
     C           W0EOFB    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         B4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of BPS Capture Inv OnHnd PF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of BPS Capture Inv OnHnd PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print Company Number of BPS Capture Inv OnHnd PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Convert fields to external form
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $BAIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$BAIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VBAIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VBAIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Print format
     C                     WRITE$BKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP00
     C                     END                             FI
      * Print Item Code of BPS Capture Inv OnHnd PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP01
     C                     END                             FI
      * Print Detail line. of BPS Capture Inv OnHnd PF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * Do not print format if both On-Hand and Sched Ship = Zero.
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : CUR.On Hand Weight Summary is Equal to zero
      *   |- c2    : CUR.PS Weight Sched Shipment is Not Entered
      *   |- c3    : CUR.Quantity In Chill is Equal to zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $CBOWG    IFEQ *ZERO                      *IF
     C           $CSHWT    IFEQ *ZERO                      *IF
     C           $CHDQT    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
      * Rtv Whs Type/LtTrk/Prd RT - Warehouse  * 
     C                     EXSR SJRVGN
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $CHGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$CHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VCHGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VCHGCD           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Revaluation Eff Date to display format
      * Convert date
     C           1000000   ADD  $CGUDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCGUDT
      * Print column headings if required
     C           W0ACDT    IFEQ 'Y'
     C                     WRITE$CCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ACDT
     C                     END                             FI
      * Print format
     C                     WRITE$CDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Print First Page Format of BPS Capture Inv OnHnd PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0BL1P
     C                     END                             FI
      * Print Company Number of BPS Capture Inv OnHnd PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP00
     C                     END                             FI
      * Print Item Code of BPS Capture Inv OnHnd PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP01
     C                     END                             FI
      * Print Warehouse Code of BPS Capture Inv OnHnd PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP02
     C                     END                             FI
      * Print Detail line. of BPS Capture Inv OnHnd PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0BCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * RMC added prod date > 0 check
      * CASE: DB1.Production Date is entered
     C           WBELDT    IFNE *ZERO                      *IF
      * 07/06/09 PKD Change to calculate the Weight based on current
      *              Unit Weight.  When the Quantity is calculated based
      *              on Unit Weight, the quantity in PDI8CPP does not
      *              match POCWCPP.
      * Quantity On Hand-Weight
      * CUR.Quantity on Hand - Weight =
      *    *COMPUTE (x1 * x2)
      * x1    : CUR.Quantity on Hand UOM1
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Unit Weight
     C           $DARQT    MULT P5AIWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    $DACWG           Quantity on Han
      * CASE: CUR.Quantity on Hand - U/M1 is Greater than zero
     C           $DARQT    IFGT *ZERO                      *IF
      * Crt Item Inventory    CR - PS Prod Item Inventory  * 
     C                     EXSR SKCRRC
     C                     END                             *FI
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Production Date to display format
      * Convert date
     C           1000000   ADD  $DELDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDELDT
      * Print column headings if required
     C           W0BCDT    IFEQ 'Y'
     C                     WRITE$DCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0BCDT
     C                     END                             FI
      * Print format
     C                     WRITE$DDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0BPDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of BPS Capture Inv OnHnd PF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of BPS Capture Inv OnHnd PF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * Item Code of BPS Capture Inv OnHnd PF
     C           W0AP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of BPS Capture Inv OnHnd PF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD3         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of BPS Capture Inv OnHnd PO
     C           W0BP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of BPS Capture Inv OnHnd PO
     C           W0BP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Item Code of BPS Capture Inv OnHnd PO
     C           W0BP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Warehouse Code of BPS Capture Inv OnHnd PO
     C           W0BP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of BPS Capture Inv OnHnd PO
     C           W0BPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0BCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSA01           Application Cod
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSA01           Application Cod
     C                     MOVEL'P/S'     WQSA01           Application Cod
      * Establish starting position
     C           KRSSA     SETLL@DNRESF                    *
     C           KRSSA     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
     C           KRSSA     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSB01           Application Cod
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSB01           Application Cod
      * Establish starting position
     C           KRSSB     SETLL@DNRESF                    *
     C           KRSSB     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSB     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0001    BZAIC3           Company Number
     C                     Z-ADDWL0002    BZHGCD           Item Code
      * Establish starting position
     C           KRSSC     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0003           Description Lin
     C                     MOVEL*BLANK    WL0004           UOM Primary
     C                     Z-ADD*ZERO     WL0005           Unit Weight
     C                     Z-ADD*ZERO     WL0006           Item Structure
     C                     Z-ADD*ZERO     WL0007           Item Structure
     C                     Z-ADD*ZERO     WL0008           Item Structure
     C                     MOVEL*BLANK    WL0009           Item Type Code
     C                     MOVEL*BLANK    WL0010           Default Warehou
     C                     Z-ADD*ZERO     WL0011           Fresh Chilling
     C                     MOVEL*BLANK    WL0012           Base_Conv_Loss
     C                     MOVEL*BLANK    WL0013           Variety_Rendere
     C                     MOVEL*BLANK    WL0014           Credit Item Sta
     C                     Z-ADD*ZERO     WL0015           Std Weight_Head
     C                     Z-ADD*ZERO     WL0016           Pieces Per Head
     C                     MOVEL*BLANK    WL0017           Department Code
     C                     MOVEL*BLANK    WL0018           Group for Packa
     C                     MOVEL*BLANK    WL0019           Seconds Item
     C                     MOVEL*BLANK    WL0020           Piece Count Ite
     C                     Z-ADD*ZERO     WL0021           Pieces Per Bag
     C                     Z-ADD*ZERO     WL0022           Bags Per Unit
     C                     MOVEL*BLANK    WL0023           Export_Domestic
     C                     MOVEL*BLANK    WL0024           Print On Schedu
     C                     MOVEL*BLANK    WL0025           Fresh Inv Alloc
     C                     MOVEL*BLANK    WL0026           Fresh Sched As
     C                     MOVEL*BLANK    WL0027           Frozen Inv Allo
     C                     MOVEL*BLANK    WL0028           Primal Group Co
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBZAVNA    WL0003           Description Lin
     C                     MOVELBZADCD    WL0004           UOM Primary
     C                     Z-ADDBZAIWG    WL0005           Unit Weight
     C                     Z-ADDBZRINB    WL0006           Item Structure
     C                     Z-ADDBZRHNB    WL0007           Item Structure
     C                     Z-ADDBZRGNB    WL0008           Item Structure
     C                     MOVELBZN0CD    WL0009           Item Type Code
     C                     MOVELBZQ1CD    WL0010           Default Warehou
     C                     Z-ADDBZCHTM    WL0011           Fresh Chilling
     C                     MOVELBZQZCD    WL0012           Base_Conv_Loss
     C                     MOVELBZXWST    WL0013           Variety_Rendere
     C                     MOVELBZVMST    WL0014           Credit Item Sta
     C                     Z-ADDBZSWGH    WL0015           Std Weight_Head
     C                     Z-ADDBZPPHE    WL0016           Pieces Per Head
     C                     MOVELBZR3CD    WL0017           Department Code
     C                     MOVELBZSDCD    WL0018           Group for Packa
     C                     MOVELBZX5ST    WL0019           Seconds Item
     C                     MOVELBZPCCT    WL0020           Piece Count Ite
     C                     Z-ADDBZBDNB    WL0021           Pieces Per Bag
     C                     Z-ADDBZBJNB    WL0022           Bags Per Unit
     C                     MOVELBZSUST    WL0023           Export_Domestic
     C                     MOVELBZSVST    WL0024           Print On Schedu
     C                     MOVELBZSYST    WL0025           Fresh Inv Alloc
     C                     MOVELBZSZST    WL0026           Fresh Sched As
     C                     MOVELBZS1ST    WL0027           Frozen Inv Allo
     C                     MOVELBZXRCD    WL0028           Primal Group Co
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * BPS Rtv Whs Info      RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0029    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSD     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0030           Warehouse Type
     C                     MOVEL*BLANK    WL0031           Trans Contol AS
     C                     MOVEL*BLANK    WL0032           Warehouse Locat
     C                     MOVEL*BLANK    WL0033           Warehouse Std C
     C                     Z-ADD*ZERO     WL0034           Warehouse Chill
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADWPST    WL0030           Warehouse Type
     C                     MOVELADXUST    WL0031           Trans Contol AS
     C                     MOVELADT0ST    WL0032           Warehouse Locat
     C                     MOVELADT1ST    WL0033           Warehouse Std C
     C                     Z-ADDADDBNB    WL0034           Warehouse Chill
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Clc Date (descending) RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFAIC3    WQSE01           Company Number
      * Define keylist
     C           KPSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           AFBCDT           Post to G/L Dat
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Company Number
      * Setup key
     C                     Z-ADD$CAIC3    WQSE01           Company Number
     C                     Z-ADDP2GVDT    AFBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSE     SETLL@AFREPU                    *
     C           KRSSE     READE@AFREPU                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Post to G/L Date EQ DB1.Post to G/L Date
     C           P2GVDT    IFEQ AFBCDT                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
      * CASE: WRK.Count USR EQ PAR.*Duration (factor)
     C           WUCNTU    IFEQ WUDUF                      *IF
     C                     Z-ADDAFBCDT    P7JEDT           *Date1 (ending)
     C                     GOTO SEEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSE     READE@AFREPU                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Clc Date (ascending)  RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSF01           Company Number
      * Define keylist
     C           KPSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WABCDT           Post to G/L Dat
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
      * Setup key
     C                     Z-ADD$CAIC3    WQSF01           Company Number
     C                     Z-ADDP2GVDT    WABCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSF     SETLL@AFREYY                    *
     C           KRSSF     READE@AFREYY                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Post to G/L Date EQ DB1.Post to G/L Date
     C           P2GVDT    IFEQ WABCDT                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
      * CASE: WRK.Count USR EQ PAR.*Duration (factor)
     C           WUCNTU    IFEQ WUCHMT                     *IF
     C                     Z-ADDWABCDT    P7JEDT           *Date1 (ending)
     C                     GOTO SFEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSF     READE@AFREYY                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * UPS Clc Unavail Inv   RT - Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WL0039           Quantity In Chi
      * Declare restrictor key work fields
     C           *LIKE     DEFN B1AIC3    WQSG01           Company Number
     C           *LIKE     DEFN B1HGCD    WQSG02           Item Code
     C           *LIKE     DEFN B1AJCD    WQSG03           Warehouse Code
      * Define keylist
     C           KPSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Item Code
     C                     KFLD           WQSG03           Warehouse Code
     C                     KFLD           B1ELDT           Production Date
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Item Code
     C                     KFLD           WQSG03           Warehouse Code
      * Setup key
     C                     Z-ADDWL0035    WQSG01           Company Number
     C                     Z-ADDWL0036    WQSG02           Item Code
     C                     MOVELWL0037    WQSG03           Warehouse Code
     C                     Z-ADDWL0038    B1ELDT           Production Date
      * Establish starting position
     C           KPSSG     SETLLCAB1RL4                    *
     C           KRSSG     READECAB1RL4                  90*
      * Data record not found
     C   90                MOVEL'USR0330' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  B1ARQT    WL0039           Quantity In Chi
     C           KRSSG     READECAB1RL4                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * UPS Rtv Sched Shpmnts RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     $CSHWT           PS Weight Sched
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSH01           Company Number
     C           *LIKE     DEFN OMHGCD    WQSH02           Item Code
     C           *LIKE     DEFN OMAJCD    WQSH03           Warehouse Code
      * Define keylist
     C           KPSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WQSH02           Item Code
     C                     KFLD           WQSH03           Warehouse Code
     C                     KFLD           OMAODT           Scheduled Ship
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WQSH02           Item Code
     C                     KFLD           WQSH03           Warehouse Code
      * Setup key
     C                     Z-ADD$CAIC3    WQSH01           Company Number
     C                     Z-ADD$CHGCD    WQSH02           Item Code
     C                     MOVEL$CAJCD    WQSH03           Warehouse Code
     C                     Z-ADDP2GVDT    OMAODT           Scheduled Ship
      * Establish starting position
     C           KPSSH     SETLL@BGWKKG                    *
     C           KRSSH     READE@BGWKKG                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Hdr Sts,BillActTy RT - Order Header TRG  * 
     C                     EXSR SIRVGN
      * CASE:
      *  - c1ANDc2
      *   |- c1    : WRK.Header Status is Not Comp/Canc/Conf
      *   |- c2    : WRK.Billing Activity Type is Invoice or Transfer
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUGWST    IFEQ 'L'                        *IF
     C           WUGWST    OREQ 'A'
     C           WUGWST    OREQ 'E'
     C           WUGWST    OREQ 'H'
     C           WUOBST    IFEQ '1'                        *IF
     C           WUOBST    OREQ '4'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  OMAUWG    $CSHWT           PS Weight Sched
     C                     END                             *FI
     C           KRSSH     READE@BGWKKG                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Hdr Sts,BillActTy RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADDOMAIC3    BEAIC3           Company Number
     C                     Z-ADDOMC4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSSI     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBEGWST    WUGWST           Header Status
     C                     MOVELBEOBST    WUOBST           Billing Activit
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Whs Type/LtTrk/Prd RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVEL$CAJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSJ     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0001           Production Ware
     C                     MOVEL*BLANK    YL0002           Lot Tracking Fl
     C                     MOVEL*BLANK    YL0003           Warehouse Type
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADAOCD    YL0001           Production Ware
     C                     MOVELADVHST    YL0002           Lot Tracking Fl
     C                     MOVELADWPST    YL0003           Warehouse Type
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCRRC    BEGSR
      *================================================================
      * Crt Item Inventory    CR - PS Prod Item Inventory  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CWCPQV
     C                     Z-ADD$DAIC3    CWAIC3           Company Number
     C                     Z-ADD$DHGCD    CWHGCD           Item Code
     C                     MOVEL$DAJCD    CWAJCD           Warehouse Code
     C                     Z-ADD$DELDT    CWELDT           Production Date
     C                     Z-ADD$DACWG    CWACWG           Quantity on Han
     C                     Z-ADD$DARQT    CWARQT           Quantity on Han
     C                     Z-ADD$DK7DT    CWK7DT           Label Date
     C                     MOVEL$DUVST    CWUVST           EDI Status 1
     C                     MOVEL$DUWST    CWUWST           EDI Status 2
     C                     MOVEL$DUXST    CWUXST           EDI Status 3
     C                     MOVEL$DVSST    CWVSST           Record Status
     C                     Z-ADD$DAATM    CWAATM           Job Time
     C                     MOVEL$DAYNA    CWAYNA           User Id
     C                     MOVEL$DA0NA    CWA0NA           Job Name
     C                     Z-ADD$DAXDT    CWAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       CWVSST           Record Status
     C                     Z-ADD##JTM     CWAATM           Job Time
     C                     MOVEL##USR     CWAYNA           User Id
     C                     MOVEL##PGM     CWA0NA           Job Name
     C                     Z-ADD##JDT     CWAXDT           Job Date
     C           KLCRSK    KLIST
     C                     KFLD           CWAIC3           Company Number
     C                     KFLD           CWHGCD           Item Code
     C                     KFLD           CWAJCD           Warehouse Code
     C                     KFLD           CWELDT           Production Date
      * Check for duplicate primary key
     C           KLCRSK    SETLL@CWCPQV                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3239' W0RTN   7
      * Send message 'PS Prod Item Inventory EX'
     C                     MOVEL'USR3239' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C                     WRITE@CWCPQV                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * BPS Upd Inv On Hand   RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0002  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0003  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0004  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0005  72       PS Pct of Carca
     C                     Z-ADD*ZERO     WN0006  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0007  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0008  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0009  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0010  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0011  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0012  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0013  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0014  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0015  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0016  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0017  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0018  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0019  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0020  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0021  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0022  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0023 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0024  70       PS Pieces Whs T
     C                     Z-ADD*ZERO     WN0025 112       PS Weight Whs T
     C                     Z-ADD*ZERO     WN0026  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0027 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0028  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0029 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0030  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0031 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0032  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0033 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0034  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0035  3        PS Item Id
     C                     MOVEL*BLANK    WN0036  2        Warehouse Type
     C                     MOVEL*BLANK    WN0037  1        PS Lock Status
     C                     MOVEL*BLANK    WN0038  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0039  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0040  1        PS Piece Count
     C                     MOVEL*BLANK    WN0041  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0042  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0043  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0044  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0045  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0046  3        PS Production W
     C                     Z-ADD*ZERO     WN0047  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0048  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0049  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0050  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0051  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0052  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0053  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0054  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0055  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0056  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0057  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0058  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0059  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0060  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0061  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0062  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0063  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0064  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0065  6        Department Code
     C                     Z-ADD*ZERO     WN0066  30       Item Structure
     C                     Z-ADD*ZERO     WN0067  30       Item Structure
     C                     Z-ADD*ZERO     WN0068  30       Item Structure
     C                     MOVEL*BLANK    WN0069  6        Primal Group Co
     C                     MOVEL*BLANK    WN0070  1        EDI Status 1
     C                     MOVEL*BLANK    WN0071  1        EDI Status 2
     C                     MOVEL*BLANK    WN0072  1        EDI Status 3
     C                     MOVEL*BLANK    WN0073  1        Record Status
     C                     Z-ADD*ZERO     WN0074  60       Job Time
     C                     MOVEL*BLANK    WN0075 10        User Id
     C                     MOVEL*BLANK    WN0076 10        Job Name
     C                     Z-ADD*ZERO     WN0077  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           I8AIC3           Company Number
     C                     KFLD           I8V5ST           Production Type
     C                     KFLD           I8ELDT           Production Date
     C                     KFLD           I8HGCD           Item Code
     C                     KFLD           I8AJCD           Warehouse Code
      * Setup key
     C                     Z-ADD$CAIC3    I8AIC3           Company Number
     C                     MOVEL'S'       I8V5ST           Production Type
     C                     Z-ADDP2GVDT    I8ELDT           Production Date
     C                     Z-ADD$CHGCD    I8HGCD           Item Code
     C                     MOVEL$CAJCD    I8AJCD           Warehouse Code
      * Establish starting position
     C           KRSSL     CHAIN@I8CPUS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1763' W0RTN   7
      * USER: Processing if Data record not found
      * Rtv Productin Whs     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL$CAJCD    WL0040    P      Warehouse Code
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0041    WN0046    P      Production Ware
     C                     Z-ADDWL0042    YN0001           Accounting Comp
      * UPS Crt Prod Detail   CR - PS Prod Item Schedule  * 
     C                     EXSR SNCRRC
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * BPS Chg Inv On Hand   CH - PS Prod Item Schedule  * 
     C                     EXSR SPCHRC
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Productin Whs     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WCAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0040    WCAJCD           Warehouse Code
      * Establish starting position
     C           KRSSM     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0041           Production Ware
     C                     Z-ADD*ZERO     WL0042           Accounting Comp
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCAOCD    WL0041           Production Ware
     C                     Z-ADDWCBTC3    WL0042           Accounting Comp
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNCRRC    BEGSR
      *================================================================
      * UPS Crt Prod Detail   CR - PS Prod Item Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @I8CPUR
     C                     Z-ADD$CAIC3    WDAIC3           Company Number
     C                     MOVEL'S'       WDV5ST           Production Type
     C                     Z-ADDP2GVDT    WDELDT           Production Date
     C                     Z-ADD$CHGCD    WDHGCD           Item Code
     C                     MOVEL$CAJCD    WDAJCD           Warehouse Code
     C                     Z-ADDWN0002    WDGPDT           PS Available Sh
     C                     Z-ADDWN0003    WDWTSP           PS Weight Plann
     C                     Z-ADDWN0004    WDQTSP           PS Pieces Plann
     C                     Z-ADDWN0005    WDDJPC           PS Pct of Carca
     C                     Z-ADDWN0006    WDF8WG           PS Avg Piece Wg
     C                     Z-ADDYL0004    WDWTIN           PS Weight Inv O
     C                     Z-ADDWUD5NB    WDD5NB           PS Pieces Inv O
     C                     Z-ADDWN0007    WDDXWG           PS Weight Stand
     C                     Z-ADDWN0008    WDB2NB           PS Pieces Stand
     C                     Z-ADDWN0009    WDWTCN           PS Weight Conve
     C                     Z-ADDWN0010    WDPSCV           PS Pieces Conve
     C                     Z-ADDWN0011    WDSAWT           PS Weight Shipp
     C                     Z-ADDWN0012    WDB9NB           PS Pieces Shipp
     C                     Z-ADDWN0013    WDD1WG           PS Weight Prod
     C                     Z-ADDWN0014    WDCBNB           PS Pieces Prod
     C                     Z-ADDWN0015    WDEZWG           PS Weight Inv A
     C                     Z-ADDWN0016    WDCCNB           PS Pieces Inv A
     C                     Z-ADDWN0017    WDE0WG           PS Weight Ship
     C                     Z-ADDWN0018    WDD6NB           PS Pieces Ship
     C                     Z-ADDWN0019    WDOAWT           PS Weight Prod
     C                     Z-ADDWN0020    WDCDNB           PS Pieces Prod
     C                     Z-ADDWN0021    WDUNW2           PS Weight Inv A
     C                     Z-ADDWN0022    WDCENB           PS Pieces Inv A
     C                     Z-ADDWN0023    WDF9WG           PS Unit Weight
     C                     Z-ADDWN0024    WDBPNB           PS Pieces Whs T
     C                     Z-ADDWN0025    WDGAWG           PS Weight Whs T
     C                     Z-ADDWN0026    WDBQNB           PS Pieces Unuse
     C                     Z-ADDWN0027    WDGBWG           PS Weight Unuse
     C                     Z-ADDWN0028    WDBRNB           PS Pieces Unuse
     C                     Z-ADDWN0029    WDGCWG           PS Weight Unuse
     C                     Z-ADDWN0030    WDBSNB           PS Pieces Unuse
     C                     Z-ADDWN0031    WDGDWG           PS Weight Unuse
     C                     Z-ADDWN0032    WDBWNB           PS Pieces Unuse
     C                     Z-ADDWN0033    WDGEWG           PS Weight Unuse
     C                     Z-ADDWN0034    WDPS6U           PS Pieces Unuse
     C                     MOVELWN0035    WDWCST           PS Item Id
     C                     MOVELWN0036    WDWPST           Warehouse Type
     C                     MOVELWN0037    WDB5ST           PS Lock Status
     C                     MOVELWN0038    WDTFST           PS Export/Domes
     C                     MOVELWN0039    WDTEST           PS Print On Sch
     C                     MOVELWN0040    WDTHST           PS Piece Count
     C                     MOVELWN0041    WDUDST           PS Unused Sts 1
     C                     MOVELWN0042    WDUFST           PS Unused Sts 2
     C                     MOVELWN0043    WDUGST           PS Unused Sts 3
     C                     MOVELWN0044    WDUHST           PS Unused Sts 4
     C                     MOVELWN0045    WDB6ST           PS Item Sched N
     C                     MOVELWN0046    WDB7ST           PS Production W
     C                     Z-ADDWN0047    WDDVWG           PS Weight Order
     C                     Z-ADDWN0048    WDD7NB           PS Pieces Order
     C                     Z-ADDWN0049    WDFCAD           PS Weight FC Ad
     C                     Z-ADDWN0050    WDD9NB           PS Pieces FC Ad
     C                     Z-ADDWN0051    WDDWWG           PS Weight FX Ad
     C                     Z-ADDWN0052    WDEANB           PS Pieces FX Ad
     C                     Z-ADDWN0053    WDSHWT           PS Weight Sched
     C                     Z-ADDWN0054    WDEBNB           PS Pieces Sched
     C                     Z-ADDWN0055    WDAVWT           PS Weight Avail
     C                     Z-ADDWN0056    WDECNB           PS Pieces Avail
     C                     Z-ADDWN0057    WDWTON           PS Weight Produ
     C                     Z-ADDWN0058    WDEDNB           PS Pieces Produ
     C                     Z-ADDWN0059    WDFNWT           PS Weight Fab N
     C                     Z-ADDWN0060    WDEENB           PS Pieces Fab N
     C                     Z-ADDWN0061    WDQTAS           PS Weight Sched
     C                     Z-ADDWN0062    WDEFNB           PS Pieces Sched
     C                     Z-ADDWN0063    WDWAIO           PS Weight Sched
     C                     Z-ADDWN0064    WDEGNB           PS Pieces Sched
     C                     MOVELWN0065    WDR3CD           Department Code
     C                     Z-ADDWN0066    WDRGNB           Item Structure
     C                     Z-ADDWN0067    WDRHNB           Item Structure
     C                     Z-ADDWN0068    WDRINB           Item Structure
     C                     MOVELWN0069    WDXRCD           Primal Group Co
     C                     MOVELWN0070    WDUVST           EDI Status 1
     C                     MOVELWN0071    WDUWST           EDI Status 2
     C                     MOVELWN0072    WDUXST           EDI Status 3
     C                     MOVELWN0073    WDVSST           Record Status
     C                     Z-ADDWN0074    WDAATM           Job Time
     C                     MOVELWN0075    WDAYNA           User Id
     C                     MOVELWN0076    WDA0NA           Job Name
     C                     Z-ADDWN0077    WDAXDT           Job Date
      *
      * USER: Processing before Data update
      * BPS Setup Item Info   IF
      *
     C                     Z-ADD*ZERO     WN0078 155       System Value Nu
      *
      * UPS Rtv Company/Item  IF
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0001           Company Number
     C                     Z-ADDWDHGCD    WL0002           Item Code
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    WUAVNA    P      Description Lin
     C                     MOVELWL0004    WUADCD    P      UOM Primary
     C                     Z-ADDWL0005    WUAIWG           Unit Weight
     C                     Z-ADDWL0006    WDRINB           Item Structure
     C                     Z-ADDWL0007    WDRHNB           Item Structure
     C                     Z-ADDWL0008    WDRGNB           Item Structure
     C                     MOVELWL0009    WUN0CD    P      Item Type Code
     C                     MOVELWL0010    WUQ1CD    P      Default Warehou
     C                     Z-ADDWL0011    WUCHTM           Fresh Chilling
     C                     MOVELWL0012    WUQZCD    P      Base_Conv_Loss
     C                     MOVELWL0013    WUXWST    P      Variety_Rendere
     C                     MOVELWL0014    WUVMST    P      Credit Item Sta
     C                     Z-ADDWL0015    WUSWGH           Std Weight_Head
     C                     Z-ADDWL0016    WUPPHE           Pieces Per Head
     C                     MOVELWL0017    WDR3CD    P      Department Code
     C                     MOVELWL0018    WUSDCD    P      Group for Packa
     C                     MOVELWL0019    WUX5ST    P      Seconds Item
     C                     MOVELWL0020    WDTHST    P      Piece Count Ite
     C                     Z-ADDWL0021    WUBDNB           Pieces Per Bag
     C                     Z-ADDWL0022    WUBJNB           Bags Per Unit
     C                     MOVELWL0023    WDTFST    P      Export_Domestic
     C                     MOVELWL0024    WDTEST    P      Print On Schedu
     C                     MOVELWL0025    WUSYST    P      Fresh Inv Alloc
     C                     MOVELWL0026    WUSZST    P      Fresh Sched As
     C                     MOVELWL0027    WUS1ST    P      Frozen Inv Allo
     C                     MOVELWL0028    WDXRCD    P      Primal Group Co
      * BPS Rtv Whs Info      RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWDAJCD    WL0029    P      Warehouse Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0030    WDWPST    P      Warehouse Type
     C                     MOVELWL0031    WUXUST    P      Trans Contol AS
     C                     MOVELWL0032    WUT0ST    P      Warehouse Locat
     C                     MOVELWL0033    WUT1ST    P      Warehouse Std C
     C                     Z-ADDWL0034    WUDBNB           Warehouse Chill
      * BPS Set Up Item Id    IF
      * CASE: PAR.Item Type Code is Raw Materials
     C           WUN0CD    IFEQ 'RM'                       *IF
     C                     MOVEL'RMB'     WDWCST           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Seconds Item is Yes
     C           WUX5ST    IFEQ 'Y'                        *IF
     C                     MOVEL'FSC'     WDWCST           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Variety/Rendered/Cut is Variety
     C           WUXWST    IFEQ 'V'                        *IF
     C                     MOVEL'FVR'     WDWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Rendered
     C           WUXWST    IFEQ 'R'                        *IF
     C                     MOVEL'FRD'     WDWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Cut
     C           WUXWST    IFEQ 'C'                        *IF
      * Base/Converted/Fabricated
      * CASE: PAR.Credit Item Status is yes
     C           WUVMST    IFEQ 'Y'                        *IF
      * Setup Base/Converted/Fabricated Credit
      * CASE: PAR.Converted/Base Item is Base
     C           WUQZCD    IFEQ 'B'                        *IF
     C                     MOVEL'FBC'     WDWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WUQZCD    IFEQ 'C'                        *IF
     C                     MOVEL'FCC'     WDWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WUQZCD    IFEQ 'F'                        *IF
     C                     MOVEL'FFC'     WDWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WUQZCD    IFEQ 'L'                        *IF
     C                     MOVEL'FLC'     WDWCST           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup Base/Converted/Fabricated
      * CASE: PAR.Converted/Base Item is Base
     C           WUQZCD    IFEQ 'B'                        *IF
     C                     MOVEL'FGB'     WDWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WUQZCD    IFEQ 'C'                        *IF
     C                     MOVEL'FCV'     WDWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WUQZCD    IFEQ 'F'                        *IF
     C                     MOVEL'FFB'     WDWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WUQZCD    IFEQ 'L'                        *IF
     C                     MOVEL'FLS'     WDWCST           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Output PS Prod Warehouse
      * Rtv Productin Whs     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWDAJCD    WL0040    P      Warehouse Code
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0041    WDB7ST    P      Production Ware
     C                     Z-ADDWL0042    YL0006           Accounting Comp
      * Available Ship Date
      * CASE: WRK.Warehouse Std Chill Time is yes
     C           WUT1ST    IFEQ 'Y'                        *IF
      * UPS Clc Avail Shp Dte RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0043           Company Number
     C                     Z-ADDP2GVDT    WL0044           Post to G/L Dat
     C                     Z-ADDWUDBNB    WL0045           Fresh Chilling
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0046    WDGPDT           PS Available Sh
     C                     ELSE
      * CASE: *OTHERWISE
      * UPS Clc Avail Shp Dte RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0043           Company Number
     C                     Z-ADDP2GVDT    WL0044           Post to G/L Dat
     C                     Z-ADDWUCHTM    WL0045           Fresh Chilling
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0046    WDGPDT           PS Available Sh
     C                     END                             *FI
      * Average Piece Weight
      * CASE: PAR.PS Pieces Planned Prod is GT Zero
     C           WN0004    IFGT 0                          *IF
     C           WN0003    DIV  WN0004    WDF8WG           PS Avg Piece Wg
     C                     END                             *FI
      * UPS CRTOBJ Stamp      IF
     C                     MOVEL'A'       WDVSST           Record Status
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##PGM     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
     C                     MOVEL'N'       WDB5ST           PS Lock Status
     C           KLCRSN    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDV5ST           Production Type
     C                     KFLD           WDELDT           Production Date
     C                     KFLD           WDHGCD           Item Code
     C                     KFLD           WDAJCD           Warehouse Code
      * Check for duplicate primary key
     C           KLCRSN    SETLL@I8CPUR                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1764' W0RTN   7
      * Send message 'PS Prod Item Schedule  EX'
     C                     MOVEL'USR1764' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C                     WRITE@I8CPUR                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * UPS Clc Avail Shp Dte RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIC3    WQSO01           Company Number
      * Define keylist
     C           KPSSO     KLIST
     C                     KFLD           WQSO01           Company Number
     C                     KFLD           WEBCDT           Post to G/L Dat
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Company Number
      * Setup key
     C                     Z-ADDWL0043    WQSO01           Company Number
     C                     Z-ADDWL0044    WEBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSO     SETLL@AFREBE                    *
     C           KRSSO     READE@AFREBE                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: WRK.Count USR EQ PAR.Chilling Time
     C           WUCNTU    IFEQ WL0045                     *IF
     C                     Z-ADDWEBCDT    WL0046           PS Available Sh
     C                     GOTO SOEXIT                     *QUIT
     C                     END                             *FI
      * Skip Saturday
      * CASE: DB1.Day of Week is Saturday
     C           WEA9ST    IFEQ '7'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C           KRSSO     READE@AFREBE                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPCHRC    BEGSR
      *================================================================
      * BPS Chg Inv On Hand   CH - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0079  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0080  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0081  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0082  72       PS Pct of Carca
     C                     Z-ADD*ZERO     WN0083  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0084  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0085  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0086  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0087  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0088  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0089  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0090  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0091  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0092  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0093  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0094  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0095  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0096  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0097  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0098  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0099  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0100 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0101  70       PS Pieces Whs T
     C                     Z-ADD*ZERO     WN0102 112       PS Weight Whs T
     C                     Z-ADD*ZERO     WN0103  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0104 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0105  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0106 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0107  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0108 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0109  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0110 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0111  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0112  3        PS Item Id
     C                     MOVEL*BLANK    WN0113  2        Warehouse Type
     C                     MOVEL*BLANK    WN0114  1        PS Lock Status
     C                     MOVEL*BLANK    WN0115  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0116  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0117  1        PS Piece Count
     C                     MOVEL*BLANK    WN0118  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0119  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0120  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0121  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0122  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0123  3        PS Production W
     C                     Z-ADD*ZERO     WN0124  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0125  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0126  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0127  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0128  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0129  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0130  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0131  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0132  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0133  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0134  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0135  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0136  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0137  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0138  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0139  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0140  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0141  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0142  6        Department Code
     C                     Z-ADD*ZERO     WN0143  30       Item Structure
     C                     Z-ADD*ZERO     WN0144  30       Item Structure
     C                     Z-ADD*ZERO     WN0145  30       Item Structure
     C                     MOVEL*BLANK    WN0146  6        Primal Group Co
     C                     MOVEL*BLANK    WN0147  1        EDI Status 1
     C                     MOVEL*BLANK    WN0148  1        EDI Status 2
     C                     MOVEL*BLANK    WN0149  1        EDI Status 3
     C                     MOVEL*BLANK    WN0150  1        Record Status
     C                     Z-ADD*ZERO     WN0151  60       Job Time
     C                     MOVEL*BLANK    WN0152 10        User Id
     C                     MOVEL*BLANK    WN0153 10        Job Name
     C                     Z-ADD*ZERO     WN0154  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @I8CPUR
     C                     Z-ADDI8AIC3    WDAIC3           Company Number
     C                     MOVELI8V5ST    WDV5ST    P      Production Type
     C                     Z-ADDI8ELDT    WDELDT           Production Date
     C                     Z-ADDI8HGCD    WDHGCD           Item Code
     C                     MOVELI8AJCD    WDAJCD    P      Warehouse Code
      *
     C           KLCHSP    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDV5ST           Production Type
     C                     KFLD           WDELDT           Production Date
     C                     KFLD           WDHGCD           Item Code
     C                     KFLD           WDAJCD           Warehouse Code
     C           KLCHSP    CHAIN@I8CPUR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI8CPL0'MDACP
     C                     MOVEL'@I8CPUR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDI81    YARDCS
      * Move non-key fields to @I8CPUR
     C                     Z-ADDYL0004    WDWTIN           PS Weight Inv O
     C                     Z-ADDWUD5NB    WDD5NB           PS Pieces Inv O
      *
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##PGM     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
     C                     MOVEL##PGM     WDA0NA           Job Name
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@I8CPUR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDI8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : BPS Capture Inv OnHnd PO
      *================================================================
      * CASE: PGM.*Print format is Do not print format
     C           W0PFM     IFEQ 'N'                        *IF
     C                     GOTO UAEXIT                     *QUIT
     C                     END                             *FI
      * BPS Capture Inv OnHnd PO: Mainline
     C                     EXSR B0MAIN
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZBINIT    BEGSR
      *================================================================
      * BPS Capture Inv OnHnd PO: Initialise
      *================================================================
      * USER: Initialize program
      * RMC 2/17/23 quit using item loc loc for Lot Tracking whses
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0004           Weight 1 SUM
     C                     Z-ADD*ZERO     YL0005           Quantity Availa
      *================================================================
     CSR         ZBEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P3SHWT           PS Weight Sched
     C                     Z-ADD*ZERO     P4AVWT           PS Weight Avail
     C                     Z-ADD*ZERO     P5AIWG           Unit Weight
     C                     Z-ADD*ZERO     P5CHTM           Fresh Chilling
     C                     MOVEL*BLANK    P5QZCD           Base_Conv_Loss
     C                     MOVEL*BLANK    P5VMST           Credit Item Sta
     C                     MOVEL*BLANK    P5PCCT           Piece Count Ite
     C                     Z-ADD*ZERO     P5BDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     P5BJNB           Bags Per Unit
     C                     Z-ADD*ZERO     P6FVQT           USR Quantity Ac
     C                     Z-ADD*ZERO     P7JEDT           Date From
     C                     MOVEL*BLANK    P8T1ST           Warehouse Std C
     C                     Z-ADD*ZERO     P8DBNB           Warehouse Chill
     C                     Z-ADD*ZERO     P9CHMT           Chilling Time U
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    B0AIC3           Company Number
     C                     MOVEL*LOVAL    B0HGCD           Item Code
     C                     MOVEL*LOVAL    B0AJCD           Warehouse Code
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field Description Line One
     C                     MOVEL*BLANK    WUAVNA 30
      * Define work field UOM Primary
     C                     MOVEL*BLANK    WUADCD  2
      * Define work field Item Structure Class Code
     C                     Z-ADD*ZERO     WURINB  30
      * Define work field Item Structure Group Code
     C                     Z-ADD*ZERO     WURHNB  30
      * Define work field Item Structure Type Code
     C                     Z-ADD*ZERO     WURGNB  30
      * Define work field Item Type Code
     C                     MOVEL*BLANK    WUN0CD  3
      * Define work field Default Warehouse
     C                     MOVEL*BLANK    WUQ1CD  3
      * Define work field Base_Conv_Loss Item
     C                     MOVEL*BLANK    WUQZCD  2
      * Define work field Variety_Rendered_Cut
     C                     MOVEL*BLANK    WUXWST  1
      * Define work field Credit Item Status
     C                     MOVEL*BLANK    WUVMST  1
      * Define work field Std Weight_Head_Var_Ren
     C                     Z-ADD*ZERO     WUSWGH 112
      * Define work field Pieces Per Head
     C                     Z-ADD*ZERO     WUPPHE  70
      * Define work field Department Code
     C                     MOVEL*BLANK    WUR3CD  6
      * Define work field Group for Packaging
     C                     MOVEL*BLANK    WUSDCD  1
      * Define work field Seconds Item
     C                     MOVEL*BLANK    WUX5ST  1
      * Define work field Export_Domestic
     C                     MOVEL*BLANK    WUSUST  1
      * Define work field Print On Schedule
     C                     MOVEL*BLANK    WUSVST  1
      * Define work field Fresh Inv Allocation Seq
     C                     MOVEL*BLANK    WUSYST  1
      * Define work field Fresh Sched As Ordered
     C                     MOVEL*BLANK    WUSZST  1
      * Define work field Frozen Inv Allocation Seq
     C                     MOVEL*BLANK    WUS1ST  1
      * Define work field Primal Group Code
     C                     MOVEL*BLANK    WUXRCD  6
      * Define work field Warehouse Type
     C                     MOVEL*BLANK    WUWPST  2
      * Define work field Trans Contol AS400_Plant
     C                     MOVEL*BLANK    WUXUST  1
      * Define work field Warehouse Location
     C                     MOVEL*BLANK    WUT0ST  1
      * Define work field Chilling Time USR
     C                     Z-ADD*ZERO     WUCHMT  52
      * Define work field *Duration (factor)
     C                     Z-ADD*ZERO     WUDUF   80
      * Define work field Count USR
     C                     Z-ADD*ZERO     WUCNTU  50
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WABCDT           Post to G/L Dat
     C                     Z-ADD*ZERO     WACQNB           Julian Date
     C                     Z-ADD*ZERO     WAESNB           Accounting Year
     C                     Z-ADD*ZERO     WAETNB           Accounting Peri
     C                     Z-ADD*ZERO     WABZNB           OM Week
     C                     Z-ADD*ZERO     WAEINB           Week Number
     C                     Z-ADD*ZERO     WAAQNB           Billing Cycle
     C                     Z-ADD*ZERO     WAOJDT           HPS PIC Date
     C                     Z-ADD*ZERO     WANQNX           HPS Calendar Ye
     C                     Z-ADD*ZERO     WANRNX           HPS Calendar We
     C                     Z-ADD*ZERO     WAOKDT           Calendar Unused
     C                     Z-ADD*ZERO     WAOLDT           Calendar Unused
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field On Hand UOM1 Summary
     C                     Z-ADD*ZERO     WUDDQT 112
      * Define work field PS Pieces Inv On-Hand
     C                     Z-ADD*ZERO     WUD5NB  70
      * Define work field Header Status
     C                     MOVEL*BLANK    WUGWST  1
      * Define work field Billing Activity Type
     C                     MOVEL*BLANK    WUOBST  1
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBELDT           Production Date
     C                     Z-ADD*ZERO     WBABWG           Physical Count
     C                     Z-ADD*ZERO     WBAGQT           Physical Count
     C                     Z-ADD*ZERO     WBAHQT           Physical Count
     C                     Z-ADD*ZERO     WBAIQT           Physical Count
     C                     Z-ADD*ZERO     WBACWG           Quantity on Han
     C                     Z-ADD*ZERO     WBARQT           Quantity on Han
     C                     Z-ADD*ZERO     WBASQT           Quantity on Han
     C                     Z-ADD*ZERO     WBATQT           Quantity on Han
     C                     Z-ADD*ZERO     WBHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WBHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WBBMWG           Physical Start
     C                     Z-ADD*ZERO     WBDSQT           Physical Start
     C                     Z-ADD*ZERO     WBDTQT           Physical Start
     C                     Z-ADD*ZERO     WBDUQT           Physical Start
     C                     Z-ADD*ZERO     WBDHDT           Physical Start
     C                     Z-ADD*ZERO     WBAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WBAECS           Last Cost
     C                     Z-ADD*ZERO     WBIDVA           Value of On Han
     C                     Z-ADD*ZERO     WBK7DT           Label Date
     C                     Z-ADD*ZERO     WBRINB           Item Structure
     C                     Z-ADD*ZERO     WBRHNB           Item Structure
     C                     Z-ADD*ZERO     WBRGNB           Item Structure
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    WBAIC3           Company Number
     C                     MOVEL*LOVAL    WBHGCD           Item Code
     C                     MOVEL*LOVAL    WBAJCD           Warehouse Code
     C                     MOVEL*LOVAL    WBELDT           Production Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WCBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WCBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WCBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WCBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDELDT           Production Date
     C                     Z-ADD*ZERO     WDHGCD           Item Code
     C                     Z-ADD*ZERO     WDGPDT           PS Available Sh
     C                     Z-ADD*ZERO     WDWTSP           PS Weight Plann
     C                     Z-ADD*ZERO     WDQTSP           PS Pieces Plann
     C                     Z-ADD*ZERO     WDDJPC           PS Pct of Carca
     C                     Z-ADD*ZERO     WDF8WG           PS Avg Piece Wg
     C                     Z-ADD*ZERO     WDWTIN           PS Weight Inv O
     C                     Z-ADD*ZERO     WDD5NB           PS Pieces Inv O
     C                     Z-ADD*ZERO     WDDXWG           PS Weight Stand
     C                     Z-ADD*ZERO     WDB2NB           PS Pieces Stand
     C                     Z-ADD*ZERO     WDWTCN           PS Weight Conve
     C                     Z-ADD*ZERO     WDPSCV           PS Pieces Conve
     C                     Z-ADD*ZERO     WDSAWT           PS Weight Shipp
     C                     Z-ADD*ZERO     WDB9NB           PS Pieces Shipp
     C                     Z-ADD*ZERO     WDD1WG           PS Weight Prod
     C                     Z-ADD*ZERO     WDCBNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WDEZWG           PS Weight Inv A
     C                     Z-ADD*ZERO     WDCCNB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WDE0WG           PS Weight Ship
     C                     Z-ADD*ZERO     WDD6NB           PS Pieces Ship
     C                     Z-ADD*ZERO     WDOAWT           PS Weight Prod
     C                     Z-ADD*ZERO     WDCDNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WDUNW2           PS Weight Inv A
     C                     Z-ADD*ZERO     WDCENB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WDF9WG           PS Unit Weight
     C                     Z-ADD*ZERO     WDBPNB           PS Pieces Whs T
     C                     Z-ADD*ZERO     WDGAWG           PS Weight Whs T
     C                     Z-ADD*ZERO     WDBQNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WDGBWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WDBRNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WDGCWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WDBSNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WDGDWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WDBWNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WDGEWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WDPS6U           PS Pieces Unuse
     C                     Z-ADD*ZERO     WDDVWG           PS Weight Order
     C                     Z-ADD*ZERO     WDD7NB           PS Pieces Order
     C                     Z-ADD*ZERO     WDFCAD           PS Weight FC Ad
     C                     Z-ADD*ZERO     WDD9NB           PS Pieces FC Ad
     C                     Z-ADD*ZERO     WDDWWG           PS Weight FX Ad
     C                     Z-ADD*ZERO     WDEANB           PS Pieces FX Ad
     C                     Z-ADD*ZERO     WDSHWT           PS Weight Sched
     C                     Z-ADD*ZERO     WDEBNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WDAVWT           PS Weight Avail
     C                     Z-ADD*ZERO     WDECNB           PS Pieces Avail
     C                     Z-ADD*ZERO     WDWTON           PS Weight Produ
     C                     Z-ADD*ZERO     WDEDNB           PS Pieces Produ
     C                     Z-ADD*ZERO     WDFNWT           PS Weight Fab N
     C                     Z-ADD*ZERO     WDEENB           PS Pieces Fab N
     C                     Z-ADD*ZERO     WDQTAS           PS Weight Sched
     C                     Z-ADD*ZERO     WDEFNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WDWAIO           PS Weight Sched
     C                     Z-ADD*ZERO     WDEGNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WDRGNB           Item Structure
     C                     Z-ADD*ZERO     WDRHNB           Item Structure
     C                     Z-ADD*ZERO     WDRINB           Item Structure
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field Unit Weight
     C                     Z-ADD*ZERO     WUAIWG 112
      * Define work field Fresh Chilling Time
     C                     Z-ADD*ZERO     WUCHTM  52
      * Define work field Pieces Per Bag
     C                     Z-ADD*ZERO     WUBDNB  70
      * Define work field Bags Per Unit
     C                     Z-ADD*ZERO     WUBJNB  70
      * Define work field Warehouse Std Chill Time
     C                     MOVEL*BLANK    WUT1ST  1
      * Define work field Warehouse Chill Time
     C                     Z-ADD*ZERO     WUDBNB  52
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WJ01 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WJ00 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003 30
     C                     MOVEL*BLANK    WL0004  2
     C                     Z-ADD*ZERO     WL0005 112
     C                     Z-ADD*ZERO     WL0006  30
     C                     Z-ADD*ZERO     WL0007  30
     C                     Z-ADD*ZERO     WL0008  30
     C                     MOVEL*BLANK    WL0009  3
     C                     MOVEL*BLANK    WL0010  3
     C                     Z-ADD*ZERO     WL0011  52
     C                     MOVEL*BLANK    WL0012  2
     C                     MOVEL*BLANK    WL0013  1
     C                     MOVEL*BLANK    WL0014  1
     C                     Z-ADD*ZERO     WL0015 112
     C                     Z-ADD*ZERO     WL0016  70
     C                     MOVEL*BLANK    WL0017  6
     C                     MOVEL*BLANK    WL0018  1
     C                     MOVEL*BLANK    WL0019  1
     C                     MOVEL*BLANK    WL0020  1
     C                     Z-ADD*ZERO     WL0021  70
     C                     Z-ADD*ZERO     WL0022  70
     C                     MOVEL*BLANK    WL0023  1
     C                     MOVEL*BLANK    WL0024  1
     C                     MOVEL*BLANK    WL0025  1
     C                     MOVEL*BLANK    WL0026  1
     C                     MOVEL*BLANK    WL0027  1
     C                     MOVEL*BLANK    WL0028  6
      * Define local variables for subroutine SDRVGN.
     C                     MOVEL*BLANK    WL0029  3
     C                     MOVEL*BLANK    WL0030  2
     C                     MOVEL*BLANK    WL0031  1
     C                     MOVEL*BLANK    WL0032  1
     C                     MOVEL*BLANK    WL0033  1
     C                     Z-ADD*ZERO     WL0034  52
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0035  30
     C                     Z-ADD*ZERO     WL0036  70
     C                     MOVEL*BLANK    WL0037  3
     C                     Z-ADD*ZERO     WL0038  70
     C                     Z-ADD*ZERO     WL0039 112
      * Define local variables for subroutine SMRVGN.
     C                     MOVEL*BLANK    WL0040  3
     C                     MOVEL*BLANK    WL0041  3
     C                     Z-ADD*ZERO     WL0042  30
      * Define local variables for subroutine SORVGN.
     C                     Z-ADD*ZERO     WL0043  30
     C                     Z-ADD*ZERO     WL0044  70
     C                     Z-ADD*ZERO     WL0045  52
     C                     Z-ADD*ZERO     WL0046  70
      * Define local work field Production Warehouse Code
     C                     MOVEL*BLANK    YL0001  3
      * Define local work field Lot Tracking Flag
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field Warehouse Type
     C                     MOVEL*BLANK    YL0003  2
      * Define local work field Weight 1 SUM
     C                     Z-ADD*ZERO     YL0004 112
      * Define local work field Quantity Available    SUM
     C                     Z-ADD*ZERO     YL0005 112
      * Define null work field Accounting Company
     C                     Z-ADD*ZERO     YN0001  30
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0006  30
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * W121823 02/17/23 RMC quit using item loc loc for Lot Tracking
      *    (freezer whses). it isnt accurate
      * DDsDDL 01/16/12 RMC in prtobj, added prod date>0 check
      * E2299  10/19/12 RMC in prtobj, exclude stuff made >=today if prod
      * E2046  4/11/12 RMC Exclude Q3 Held FZ prod from avail inventory
      * FP1054 7/20/09 Allow run for 1 warehouse for a recovery process
      *   if inventory doesnt get captured in the a.m. schedule build
      * VAL Rtv & Ctr Prt Hdg  IF
      * SET Setup Prt Headings IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SARVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * Center Txt String 40 - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc to PrtCo US - /UT User Source  * 
     C                     MOVE WUDE40    $ACMP
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
