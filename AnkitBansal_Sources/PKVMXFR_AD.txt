// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PKVMXFR
// ?Date: 14.08.2025 Time: 02:53:04
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?***** Change Log and Comments
DO;

//?** C001078 LJB 11/2/10  Don't replace chg date with purge date
//?** 01/23/2009 LJB FP1009 Write to Purge Library instead of QTEMP
//?** The Purge Array is passed in because this program will be
//?** called by a generic purge processing CL and it requires
//?** these parms.
//?** 08/29/2007 LJB FP1009
//?** Pass in the purge date, don't calculate it here. It is now
//?** stored in the Purge Group file. Remove processing by Company.
//?** We will now purge by library.
//?** H16853 ISE 11/05/2020-Recompiled due to change in Buy Order Number
ENDDO;

EXECUTE FUNCTION(Prg Producer EDI Info RT) TYPE(RTVOBJ) FILE(PKD3CPP)           AB1233828;
PARAMETER(PAR.Purge_Date_USR);
{
 //?USER: Process Data record

 //?** Write to purge file in purge library then delete       FP1009
 EXECUTE FUNCTION(CRT EDI Carc Summ PurgeCR) TYPE(CRTOBJ) FILE(PKD3CPP)          AB1294368;
 PARAMETER(DB1.BOH_Company_Number);
 PARAMETER(DB1.BOH_Buy_Order_Number);
 PARAMETER(DB1.BOL_Load_Number);
 PARAMETER(DB1.TH_Tattoo_Number);
 PARAMETER(DB1.TH_Kill_Date);
 PARAMETER(DB1.BOH_Buy_Order_Date);
 PARAMETER(DB1.TH_Purchase_Date);
 PARAMETER(DB1.TH_Shipped_Weight);
 PARAMETER(DB1.TH_HPS_Movement_Ref_#);
 PARAMETER(DB1.TH_Group_Reference);
 PARAMETER(DB1.HB_Buyer_Code);
 PARAMETER(DB1.TH_Payment_Type);
 PARAMETER(DB1.HC_Class_Code);
 PARAMETER(DB1.Commission_Producer_Payee);
 PARAMETER(DB1.PD_Producer_Code);
 PARAMETER(DB1.PL_Location_Code);
 PARAMETER(DB1.EDI_Load_Type);
 PARAMETER(DB1.PS_Site_ID);
 PARAMETER(DB1.PSM_Miles_to_Company);
 PARAMETER(DB1.TH_Head_LFT);
 PARAMETER(DB1.TH_Head_EUT_KOA);
 PARAMETER(DB1.TH_Dead_On_Arrival);
 PARAMETER(DB1.TH_Head_Received);
 PARAMETER(DB1.TH_Yard_Deads);
 PARAMETER(DB1.TH_Head_Condemned);
 PARAMETER(DB1.TH_Head_Killed);
 PARAMETER(DB1.TH_Head_Adds);
 PARAMETER(DB1.TH_Live_Wgt);
 PARAMETER(DB1.TH_Hot_Wgt);
 PARAMETER(DB1.TH_Adj_Live_Wgt);
 PARAMETER(DB1.TH_Avg_Live_Wgt);
 PARAMETER(DB1.TH_Avg_Hot_Wgt);
 PARAMETER(DB1.TH_Avg_Lean_Percent);
 PARAMETER(DB1.TH_Avg_Backfat);
 PARAMETER(DB1.TH_Avg_Loin_Eye_Depth);
 PARAMETER(DB1.TH_Actual_Yield);
 PARAMETER(DB1.TH_Adj_Actual_Yield);
 PARAMETER(DB1.USDA_Pork_Cutout_Price);
 PARAMETER(DB1.Carcass_Base_Price);
 PARAMETER(DB1.Break_Even_Price);
 PARAMETER(DB1.Break_Even_Price);
 PARAMETER(DB1.Avg_Meat_Value_Factor);
 PARAMETER(DB1.TH_Meat_Value_Factor_Amt);
 PARAMETER(DB1.MeatVal_Factr_Amt_Crc_CWT);
 PARAMETER(DB1.TH_Fixed_Cost_Amount);
 PARAMETER(DB1.Fixed_Cost_Fctr_Crc_CWT);
 PARAMETER(DB1.TH_CM_Base_Mkt_Price);
 PARAMETER(DB1.TH_CM_Base_Mkt_Price_Amt);
 PARAMETER(DB1.TH_CM_Bse_Mkt_Live_CWT);
 PARAMETER(DB1.TH_CM_Bse_Mkt_Carc_CWT);
 PARAMETER(DB1.TH_CM_Sort_Discount_Amt);
 PARAMETER(DB1.TH_CM_Srt_Dsc_Live_CWT);
 PARAMETER(DB1.TH_CM_Srt_Dsc_Carc_CWT);
 PARAMETER(DB1.TH_CM_Yield_Gain_Loss_Amt);
 PARAMETER(DB1.TH_CM_Yld_G_L_Live_CWT);
 PARAMETER(DB1.TH_CM_Yld_G_L_Carc_CWT);
 PARAMETER(DB1.TH_CM_Base_Carcass_Value);
 PARAMETER(DB1.TH_CM_Crc_Val_Live_CWT);
 PARAMETER(DB1.TH_CM_Crc_Val_Carc_CWT);
 PARAMETER(DB1.TH_CM_LN_AddOn_Deduct_Amt);
 PARAMETER(DB1.TH_CM_Lean_Prem_Live_CWT);
 PARAMETER(DB1.TH_CM_Lean_Prem_Carc_CWT);
 PARAMETER(DB1.TH_Payment_Gross);
 PARAMETER(DB1.TH_CM_Gross_Live_CWT);
 PARAMETER(DB1.TH_CM_Gross_Carc_CWT);
 PARAMETER(DB1.Th_Payment_Net_Amt);
 PARAMETER(DB1.Deduction_Code_1);
 PARAMETER(DB1.Deduction_Unit_Amt_1);
 PARAMETER(DB1.Deduction_UOM_1);
 PARAMETER(DB1.Deduction_Desc_1);
 PARAMETER(DB1.Deduction_Amt_1);
 PARAMETER(DB1.Deduction_Code_2);
 PARAMETER(DB1.Deduction_Unit_Amt_2);
 PARAMETER(DB1.Deduction_UOM_2);
 PARAMETER(DB1.Deduction_Desc_2);
 PARAMETER(DB1.Deduction_Amt_2);
 PARAMETER(DB1.Deduction_Code_3);
 PARAMETER(DB1.Deduction_Unit_Amt_3);
 PARAMETER(DB1.Deduction_UOM_3);
 PARAMETER(DB1.Deduction_Desc_3);
 PARAMETER(DB1.Deduction_Amt_3);
 PARAMETER(DB1.Deduction_Code_4);
 PARAMETER(DB1.Deduction_Unit_Amt_4);
 PARAMETER(DB1.Deduction_UOM_4);
 PARAMETER(DB1.Deduction_Desc_4);
 PARAMETER(DB1.Deduction_Amt_4);
 PARAMETER(DB1.Deduction_Code_5);
 PARAMETER(DB1.Deduction_Unit_Amt_5);
 PARAMETER(DB1.Deduction_UOM_5);
 PARAMETER(DB1.Deduction_Desc_5);
 PARAMETER(DB1.Deduction_Amt_5);
 PARAMETER(DB1.Deduction_Code_6);
 PARAMETER(DB1.Deduction_Unit_Amt_6);
 PARAMETER(DB1.Deduction_UOM_6);
 PARAMETER(DB1.Deduction_Desc_6);
 PARAMETER(DB1.Deduction_Amt_6);
 PARAMETER(DB1.Addition_Code_1);
 PARAMETER(DB1.Addition_Unit_Amt_1);
 PARAMETER(DB1.Addition_UOM_1);
 PARAMETER(DB1.Addition_Desc_1);
 PARAMETER(DB1.Addition_Amt_1);
 PARAMETER(DB1.Addition_Code_2);
 PARAMETER(DB1.Addition_Unit_Amt_2);
 PARAMETER(DB1.Addition_UOM_2);
 PARAMETER(DB1.Addition_Desc_2);
 PARAMETER(DB1.Addition_Amt_2);
 PARAMETER(DB1.Condemned_Reason_1);
 PARAMETER(DB1.Condemned_Reason_Head_1);
 PARAMETER(DB1.Condemned_Reason_2);
 PARAMETER(DB1.Condemned_Reason_Head_2);
 PARAMETER(DB1.Condemned_Reason_3);
 PARAMETER(DB1.Condemned_Reason_Head_3);
 PARAMETER(DB1.Condemned_Reason_4);
 PARAMETER(DB1.Condemned_Reason_Head_4);
 PARAMETER(DB1.Condemned_Reason_5);
 PARAMETER(DB1.Condemned_Reason_Head_5);
 PARAMETER(DB1.Defect_Reason_1);
 PARAMETER(DB1.Defect_Head_1);
 PARAMETER(DB1.Defect_Reason_2);
 PARAMETER(DB1.Defect_Head_2);
 PARAMETER(DB1.Defect_Reason_3);
 PARAMETER(DB1.Defect_Head_3);
 PARAMETER(DB1.Defect_Reason_4);
 PARAMETER(DB1.Defect_Head_4);
 PARAMETER(DB1.Defect_Reason_5);
 PARAMETER(DB1.Defect_Head_5);
 PARAMETER(DB1.TH_Min_LT_Backfat_Inch);
 PARAMETER(DB1.TH_Min_LT_LoinEye_Inch);
 PARAMETER(DB1.TH_Min_LT_Hot_Wt_lb);
 PARAMETER(DB1.TH_Min_LT_Lean_Pct);
 PARAMETER(DB1.TH_Max_GT_Backfat_Inch);
 PARAMETER(DB1.TH_Max_GT_LoinEye_Inch);
 PARAMETER(DB1.TH_Max_GT_Hot_Wt_lb);
 PARAMETER(DB1.TH_Max_GT_Lean_Pct);
 PARAMETER(DB1.TH_Head_LT_Backfat_In_Min);
 PARAMETER(DB1.TH_Head_LT_LoinEye_In_Min);
 PARAMETER(DB1.TH_Head_LT_Hot_Wt_lb_Min);
 PARAMETER(DB1.TH_Head_LT_Lean_Pct_Min);
 PARAMETER(DB1.TH_Head_GT_Backfat_In_Max);
 PARAMETER(DB1.TH_Head_GT_LoinEye_In_Max);
 PARAMETER(DB1.TH_Head_GT_Hot_Wt_lb_Max);
 PARAMETER(DB1.TH_Head_GT_Lean_Pct_Max);
 PARAMETER(DB1.TH_Head_Excluded);
 PARAMETER(DB1.TH_Excluded_Gross_Value);
 PARAMETER(DB1.TH_Head_Adjusted_LN);
 PARAMETER(DB1.TH_PHA_Head_Adds);
 PARAMETER(DB1.TH_PHA_Yield_Percent);
 PARAMETER(DB1.TH_PHA_Lean_Prm_Crc_CWT);
 PARAMETER(DB1.TH_Head_Add_Reason);
 PARAMETER(DB1.DTS_Hog_Group_Code_1);
 PARAMETER(DB1.DTS_Building_1);
 PARAMETER(DB1.DTS_Room_1);
 PARAMETER(DB1.DTS_Delivered_Head_1);
 PARAMETER(DB1.DTS_Hog_Group_Code_2);
 PARAMETER(DB1.DTS_Building_2);
 PARAMETER(DB1.DTS_Room_2);
 PARAMETER(DB1.DTS_Delivered_Head_2);
 PARAMETER(DB1.DTS_Hog_Group_Code_3);
 PARAMETER(DB1.DTS_Building_3);
 PARAMETER(DB1.DTS_Room_3);
 PARAMETER(DB1.DTS_Delivered_Head_3);
 PARAMETER(DB1.DTS_Hog_Group_Code_4);
 PARAMETER(DB1.DTS_Building_4);
 PARAMETER(DB1.DTS_Room_4);
 PARAMETER(DB1.DTS_Delivered_Head_4);
 PARAMETER(DB1.TH_Avg_Loin_Eye_2_dec);
 PARAMETER(DB1.TH_Avg_Backfat_2_Dec);
 PARAMETER(DB1.EDI_Trading_Partner_#);
 PARAMETER(DB1.EDI_Process_Status);
 //?** Create EDI Carcass Detail recs in Purge Library, then delete
 EXECUTE FUNCTION(RTV EDI Carc Dtl Purge RT) TYPE(RTVOBJ) FILE(PKD4CPP)          AB1294371;
 PARAMETER(DB1.BOH_Company_Number);
 PARAMETER(DB1.BOH_Buy_Order_Number);
 PARAMETER(DB1.BOL_Load_Number);
 PARAMETER(DB1.TH_Tattoo_Number);
 PARAMETER(DB1.TH_Kill_Date);
 {
  //?USER: Process Data record

  EXECUTE FUNCTION(CRT EDI Carc Detail   RT) TYPE(RTVOBJ) FILE(PKD4CPP)           AB1294394;
  PARAMETER(DB1.BOH_Company_Number);
  PARAMETER(DB1.BOH_Buy_Order_Number);
  PARAMETER(DB1.BOL_Load_Number);
  PARAMETER(DB1.TH_Tattoo_Number);
  PARAMETER(DB1.TH_Kill_Date);
  {
   //?USER: Process Data record

   EXECUTE FUNCTION(CRT EDI Carc Dtl Purge CR) TYPE(CRTOBJ) FILE(PKD4CPP)          AB1294369;
   PARAMETER(DB1.BOH_Company_Number);
   PARAMETER(DB1.BOH_Buy_Order_Number);
   PARAMETER(DB1.BOL_Load_Number);
   PARAMETER(DB1.TH_Tattoo_Number);
   PARAMETER(DB1.TH_Kill_Date);
   PARAMETER(DB1.CD_Carcass_Number);
   PARAMETER(DB1.CD_Record_Add_Del_Sts);
   PARAMETER(DB1.CD_STD_Yield);
   PARAMETER(DB1.CD_Carcass_Hot_Weight);
   PARAMETER(DB1.CD_Lean_Percent);
   PARAMETER(DB1.Sort_Factor);
   PARAMETER(DB1.CD_Lean_Prem_Disc_Factor);
   PARAMETER(DB1.CD_Meat_Value_Factor);
   PARAMETER(DB1.CD_Meat_Value_Factor_Amt);
   PARAMETER(DB1.MeatVal_Factr_Amt_Crc_CWT);
   PARAMETER(DB1.CD_Fixed_Cost_Factor);
   PARAMETER(DB1.CD_Fixed_Cost_Factor_Amt);
   PARAMETER(DB1.Fixed_Cost_Fctr_Crc_CWT);
   PARAMETER(DB1.CD_Sort_Discount_CWT);
   PARAMETER(DB1.CD_Sort_Discount_$_Head);
   PARAMETER(DB1.CD_Crc_Value_Per_CWT);
   PARAMETER(DB1.CD_Crc_Value_$_Per_Hd);
   PARAMETER(DB1.CD_Lean_Premium_CWT);
   PARAMETER(DB1.CD_Lean_Premium_$_Per_Hd);
   PARAMETER(DB1.CD_Gross_Value_Per_CWT);
   PARAMETER(DB1.CD_Gross_Value_$_Per_HD);
   PARAMETER(DB1.CD_Trim_Area);
   PARAMETER(DB1.Backfat_Depth);
   PARAMETER(DB1.Loin_eye_Depth);
   PARAMETER(DB1.CD_Adjust_Add_Type);
   PARAMETER(DB1.EDI_Trading_Partner_#);
   PARAMETER(DB1.EDI_Process_Status);
  }

  EXECUTE FUNCTION(Del EDI Carc Detail   RT) TYPE(RTVOBJ) FILE(PKD4CPP)           AB1200937;
  PARAMETER(DB1.BOH_Company_Number);
  PARAMETER(DB1.BOH_Buy_Order_Number);
  PARAMETER(DB1.BOL_Load_Number);
  PARAMETER(DB1.TH_Tattoo_Number);
  PARAMETER(DB1.TH_Kill_Date);
  {
   //?USER: Process Data record

   EXECUTE FUNCTION(Del EDI Carc Detail   DO) TYPE(DLTOBJ) FILE(PKD4CPP)           AB1200934;
   PARAMETER(DB1.BOH_Company_Number);
   PARAMETER(DB1.BOH_Buy_Order_Number);
   PARAMETER(DB1.BOL_Load_Number);
   PARAMETER(DB1.TH_Tattoo_Number);
   PARAMETER(DB1.TH_Kill_Date);
   PARAMETER(DB1.CD_Carcass_Number);
  }

 }

 //?Delete EDI Carcass Summary
 EXECUTE FUNCTION(Del EDI Carc Summ     DO) TYPE(DLTOBJ) FILE(PKD3CPP)           AB1200905;
 PARAMETER(DB1.BOH_Company_Number);
 PARAMETER(DB1.BOH_Buy_Order_Number);
 PARAMETER(DB1.BOL_Load_Number);
 PARAMETER(DB1.TH_Tattoo_Number);
 PARAMETER(DB1.TH_Kill_Date);
}


EXECUTE FUNCTION(Prg Producer Event    RT) TYPE(RTVOBJ) FILE(PKD9CPP)           AB1233830;
PARAMETER('EDI');
PARAMETER(PAR.Purge_Date_USR);
{
 //?USER: Process Data record

 //?** C001078 LJB 11/2/10  Don't replace chg date with purge date
 //?** Create records to be purged in Purge Library then delete  FP1009
 EXECUTE FUNCTION(CRT Prodcr Event Purge CR) TYPE(CRTOBJ) FILE(PKD9CPP)          AB1294378;
 PARAMETER(DB1.CC_Company_Number);
 PARAMETER(DB1.PD_Producer_Code);
 PARAMETER(DB1.EV_Event_Code);
 PARAMETER(DB1.PE_Kill_Date);
 PARAMETER(DB1.PE_Unused_Status_1);
 PARAMETER(DB1.PE_Unused_Status_2);
 PARAMETER(DB1.RS_User_Changed);
 PARAMETER(DB1.RS_Date_Changed);
 PARAMETER(DB1.RS_Time_Changed);
 PARAMETER(DB1.RS_Record_Status);
 PARAMETER(DB1.RS_Job);
 PARAMETER(DB1.RS_Program);
 PARAMETER(DB1.RS_User_Added);
 PARAMETER(DB1.RS_Date_Added);
 PARAMETER(DB1.RS_Time_Added);
 {
  //?USER: Processing before Data update

  //?** C001078 LJB 11/2/10  Don't replace chg date with purge date
 }

 EXECUTE FUNCTION(Del Producer Event    DL) TYPE(DLTOBJ) FILE(PKD9CPP)           AB1205070;
 PARAMETER(DB1.CC_Company_Number);
 PARAMETER(DB1.PD_Producer_Code);
 PARAMETER(DB1.EV_Event_Code);
 PARAMETER(DB1.PE_Kill_Date);
}


