/********************************************************************/
/*                                                                  */
/*  PBK9UPC   - DOWNLOAD JGATE PRICE INVOICE DETAIL TO EXCEL        */
/*  SYNOPSIS  - SUBMITTED FROM PBK8UPC                              */
/*              EXECUTES SQL TO CREATE 5 DIFFERENT VERSIONS OF      */
/*              A SPREADSHEET                                       */
/*                                                                  */
/*  SYSTEM    - ORDER MANAGEMENT SYSTEM                             */
/*  DATE      - 12/10/2013                                          */
/*            - LARA BUSER                                          */
/*                                                                  */
/*  PARAMETERS:                                                     */
/*   &RETURN    - RETURN CODE                                       */
/*   &COMPN     - COMPANY NUMBER  15.5                              */
/*   &CUSTN     - CUSTOMER NUMBER 15.5                              */
/*   &ORDERN    - ORDER NUMBER    15.5                              */
/*   &LOADN     - LOAD ID         15.5                              */
/*   &FROMDTN   - FROM DATE       15.5                              */
/*   &THRUDTN   - THRU DATE       15.5                              */
/*   &EMAILADDR - EMAIL ADDRESS                                     */
/*   &PO#FULL   - FULL PURCHASE ORDER NUMBER                        */
/*   &PO#PART   - PARTIAL PURCHASE ORDER NUMBER                     */
/*   &AMOUNTN   - NEW GATE PRICE  15.5                              */
/*   &ISSUEDTN  - ISSUE DATE      15.5                              */
/*                                                                  */
/********************************************************************/
/* MODIFICATIONS:                                                   */
/*------------------------------------------------------------------*/
/*                                                                  */
/********************************************************************/
 PBK9UPC:    PGM        PARM(&RETURN &COMPN &CUSTN &ISSUEDTN +
                          &FROMDTN &THRDTN &ORDERN &LOADN &AMOUNTN +
                          &PO#FULL &PO#PART &POEND &DTYPE &EMAILADDR)
/* PARMS                                                             */
             DCL        VAR(&RETURN) TYPE(*CHAR) LEN(7)
             DCL        VAR(&CUSTN) TYPE(*DEC)
             DCL        VAR(&CUST) TYPE(*DEC) LEN(7 0)
             DCL        VAR(&CUSTA) TYPE(*CHAR) LEN(7)
             DCL        VAR(&COMPN) TYPE(*DEC)
             DCL        VAR(&COMP) TYPE(*DEC) LEN(3 0)
             DCL        VAR(&COMPA) TYPE(*CHAR) LEN(3)
             DCL        VAR(&ORDERN) TYPE(*DEC)
             DCL        VAR(&ORDER) TYPE(*DEC) LEN(7 0)
             DCL        VAR(&ORDERA) TYPE(*CHAR) LEN(7)
             DCL        VAR(&LOADN ) TYPE(*DEC)
             DCL        VAR(&LOAD) TYPE(*DEC) LEN(7 0)
             DCL        VAR(&LOADA) TYPE(*CHAR) LEN(7)
             DCL        VAR(&FROMDTN) TYPE(*DEC)
             DCL        VAR(&FROMDT) TYPE(*DEC) LEN(7 0)
             DCL        VAR(&FROMDTA) TYPE(*CHAR) LEN(7)
             DCL        VAR(&THRDTN) TYPE(*DEC)
             DCL        VAR(&THRDT) TYPE(*DEC) LEN(7 0)
             DCL        VAR(&THRDTA) TYPE(*CHAR) LEN(7)
             DCL        VAR(&PO#FULL) TYPE(*CHAR) LEN(15)
             DCL        VAR(&PO#PART) TYPE(*CHAR) LEN(15)
             DCL        VAR(&POSTART) TYPE(*CHAR) LEN(15)
             DCL        VAR(&POEND) TYPE(*CHAR) LEN(15)
             DCL        VAR(&EMAILADDR) TYPE(*CHAR) LEN(50)
             DCL        VAR(&DTYPE) TYPE(*CHAR) LEN(1)
             DCL        VAR(&ISSUEDTN) TYPE(*DEC)
             DCL        VAR(&ISSUEDT) TYPE(*DEC) LEN(7 0)
             DCL        VAR(&ISSUEDTA) TYPE(*CHAR) LEN(7)
             DCL        VAR(&AMOUNTN) TYPE(*DEC)
             DCL        VAR(&AMOUNT) TYPE(*DEC) LEN(11 4)
             DCL        VAR(&AMOUNTA) TYPE(*CHAR) LEN(11)

             MONMSG     MSGID(CPF0000)

/***** RMVLIBLE PRKDEVQRY +
ADDLIBLE PRKDEVQRY *******/
/********************************************************************/
/* CHANGE VARIABLES FOR PASSING TO THE SQLS                         */
/*------------------------------------------------------------------*/
             CHGVAR     VAR(&COMP) VALUE(&COMPN)
             CHGVAR     VAR(&COMPA) VALUE(&COMP)
             CHGVAR     VAR(&CUST) VALUE(&CUSTN)
             CHGVAR     VAR(&CUSTA) VALUE(&CUST)
             CHGVAR     VAR(&ORDER) VALUE(&ORDERN)
             CHGVAR     VAR(&ORDERA) VALUE(&ORDER)
             CHGVAR     VAR(&LOAD) VALUE(&LOADN)
             CHGVAR     VAR(&LOADA) VALUE(&LOAD)
             CHGVAR     VAR(&FROMDT) VALUE(&FROMDTN)
             CHGVAR     VAR(&FROMDTA) VALUE(&FROMDT)
             CHGVAR     VAR(&THRDT) VALUE(&THRDTN)
             CHGVAR     VAR(&THRDTA) VALUE(&THRDT)
             CHGVAR     VAR(&ISSUEDT) VALUE(&ISSUEDTN)
             CHGVAR     VAR(&ISSUEDTA) VALUE(&ISSUEDT)
             CHGVAR     VAR(&AMOUNT) VALUE(&AMOUNTN)
             CHGVAR     VAR(&AMOUNTA) VALUE(&AMOUNT)

             IF         COND(&PO#PART *NE '          ') THEN(CHGVAR +
                          VAR(&POSTART) VALUE(&PO#PART))

/********************************************************************/
/* EMAIL TO RECIPIENT, BASED ON REPORT TYPE                         */
/********************************************************************/
             IF         COND(&DTYPE *EQ 'O') THEN(DO)
             EXECUTE    VIEW(OPBF_GATEO) PCFMT(*XLS) +
                          RECIPIENT(&EMAILADDR) EMLMSG('Download +
                          for Order ' *CAT &ORDERA) +
                          SETVAR((&NEWGATEPRC &AMOUNTA) (&ISSUEDT +
                          &ISSUEDTA) (&ORDER &ORDERA))
             GOTO       CMDLBL(END)
             ENDDO

             IF         COND(&DTYPE *EQ 'L') THEN(DO)
             EXECUTE    VIEW(OPBF_GATEL) PCFMT(*XLS) +
                          RECIPIENT(&EMAILADDR) EMLMSG('Download +
                          for Load ' *CAT &LOADA) +
                          SETVAR((&NEWGATEPRC &AMOUNTA) (&ISSUEDT +
                          &ISSUEDTA) (&LOAD &LOADA))
             GOTO       CMDLBL(END)
             ENDDO

             IF         COND(&DTYPE *EQ 'P') THEN(DO)
             EXECUTE    VIEW(OPBFGATEP2) PCFMT(*XLS) +
                          RECIPIENT(&EMAILADDR) EMLMSG('Download +
                          for PO beginning with ' *CAT &PO#PART) +
                          SETVAR((&NEWGATEPRC &AMOUNTA) (&ISSUEDT +
                          &ISSUEDTA) (&POSTART &POSTART) (&POEND +
                          &POEND))
             GOTO       CMDLBL(END)
             ENDDO

             IF         COND(&DTYPE *EQ 'F') THEN(DO)
             EXECUTE    VIEW(OPBF_GATEP) PCFMT(*XLS) +
                          RECIPIENT(&EMAILADDR) EMLMSG('Download +
                          for PO# ' *CAT &PO#FULL) +
                          SETVAR((&NEWGATEPRC &AMOUNTA) (&ISSUEDT +
                          &ISSUEDTA) (&PO#FULL &PO#FULL))
             GOTO       CMDLBL(END)
             ENDDO

             IF         COND(&DTYPE *EQ 'D') THEN(DO)
             EXECUTE    VIEW(OPBF_GATED) PCFMT(*XLS) +
                          RECIPIENT(&EMAILADDR) EMLMSG('Download +
                          for Company ' *CAT &COMPA *TCAT ', +
                          Customer ' *CAT &CUSTA *TCAT ', and +
                          date(s) ' *CAT &FROMDTA *CAT ', ' *CAT +
                          &THRDTA) SETVAR((&NEWGATEPRC &AMOUNTA) +
                          (&ISSUEDT &ISSUEDTA) (&FROMDT &FROMDTA) +
                          (&THRDT &THRDTA) (&CUST &CUSTA) (&COMP +
                          &COMPA))
             GOTO       CMDLBL(END)
             ENDDO

 END:        ENDPGM
