// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PKHCPVR
// ?Date: 14.08.2025 Time: 02:51:41
// ?------------------------------------------------------------------------------------------------

//?USER: Initialize program

//?Modifications and Comments
DO;

//?H16853 ISE 11/02/20 - Increased the Buy Order Number field
//?  length from 5 to 7.
ENDDO;

//?12/24/96   SLM     User was report of Doa after scale tickets
//?                   were done.  The tattoo was sent to kill and they
//?                   missed reporting doas.  So if the user had the
EXECUTE FUNCTION(Val Appl/User Only    IF) TYPE(EXCINTFUN)                      AB1191075;
PARAMETER(PAR.Oms_Warehouse_Code);
PARAMETER(WRK.CC_Company_Number);
PARAMETER('HPE');
PARAMETER(PAR.Oms_SalesPerson_Code);
PARAMETER(PAR.Oms_Allow_Multi_Company);
PARAMETER(PAR.Oms_Default_Printer);
PARAMETER(PAR.Oms_Name);
PARAMETER(PAR.Oms_System_Value_Alpha);
PARAMETER(PAR.Oms_Access_Denied_Y_N);
{
 //?Execute internal function

 // Call program Val Application/User  XF.
 CALL PROGRAM(Val Application/User  XF) ('PDGXXFR');
 PARAMETER(PAR.Oms_Warehouse_Code);
 PARAMETER(PAR.CC_Company_Number);
 PARAMETER(PAR.Oms_Application_Code);
 PARAMETER(PAR.Oms_SalesPerson_Code);
 PARAMETER(PAR.Oms_Allow_Multi_Company);
 PARAMETER(PAR.Oms_Default_Printer);
 PARAMETER(PAR.Oms_Name);
 PARAMETER(PAR.Oms_System_Value_Alpha);
 PARAMETER(PAR.Oms_Access_Denied_Y_N);

 CASE;

 // IF PAR.Oms Access Denied (Y/N) is Yes
 IF PAR.Oms_Access_Denied_Y_N = 'Y';

 // Send error message - 'Access Denied for User'
 ERROR(PRK0298);

 ENDIF;

}


CASE;

// IF PAR.Oms Access Denied (Y/N) is Yes
IF PAR.Oms_Access_Denied_Y_N = 'Y';

RETURN;

ENDIF;

//?USER: Load screen

// DTL.Print Scale Tkt       USR = CND.No
DTL.Print_Scale_Tkt_USR = 'N';

//?USER: User defined action

EXECUTE FUNCTION(Rtv Scl Tkt Val Edt   RT) TYPE(RTVOBJ) FILE(PKB3CPP)           AB1157790;
PARAMETER(PAR.BOH_Company_Number);
PARAMETER(PAR.BOH_Buy_Order_Number);
PARAMETER(PAR.BOL_Load_Number);
PARAMETER(PAR.TH_Tattoo_Number);
PARAMETER(PAR.TH_Kill_Date);
PARAMETER(WRK.@Record_Found);
PARAMETER(WRK.Found_Act_Scl_Rec_Sts_Usr);
{
 //?USER: Processing if Data record not found

 // PAR.@Record Found = CND.Record Not Found
 PAR.@Record_Found = 'N';

 //?USER: Process Data record

 // PAR.@Record Found = CND.Record Found
 PAR.@Record_Found = 'Y';

 CASE;

 // IF DB1.RS Record Status is Active
 IF DB1.RS_Record_Status = 'A';

 // PAR.Found Act Scl Rec Sts Usr = CND.Yes
 PAR.Found_Act_Scl_Rec_Sts_Usr = 'Y';

 ENDIF;

}


CASE;

// IF WRK.@Record Found is Record Not Found
IF WRK.@Record_Found = 'N';

// Send error message - 'No Scale Wghtmnts Exsts for this tattoo, print scale ticket not  allowed, o
ERROR(PRK0656);
MSGPARM(PAR.TH_Tattoo_Number);

// IF *OTHERWISE
IF *OTHERWISE;

// Call program Prt Scale Tkt - All AFKUP.
CALL PROGRAM(Prt Scale Tkt - All AFKUP) ('PKHDXFR');
PARAMETER(PAR.BOH_Company_Number);
PARAMETER(PAR.BOH_Buy_Order_Number);
PARAMETER(PAR.BOL_Load_Number);
PARAMETER(PAR.TH_Tattoo_Number);
PARAMETER(PAR.TH_Kill_Date);
PARAMETER(DTL.Print_Scale_Tkt_USR);

ENDIF;

