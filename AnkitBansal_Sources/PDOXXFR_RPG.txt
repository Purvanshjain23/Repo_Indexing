     H/TITLE UPD From Formula Dtl   XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by AllFusion 2E release 8.1SP2 (1250)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISSMASO
     H* Date          : 02/22/10  Time  : 17:11:05
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDJKCPL1IF  E           K        DISK
      * RTV : Order Dtl Formula Dtl     Retrieval index
      *
     FPDIMCPL0UF  E           K        DISK
      * UPD : Order Detail Pricing      Update index
      *
     I@JKCPYF
      * Order Dtl Formula Dtl     Retrieval index
      * Renamed input format fields
     I              JKAIC3                          WAAIC3
     I              JKC4NB                          WAC4NB
     I              JKDPNB                          WADPNB
     I              JKUENB                          WAUENB
     I              JKQ9CD                          WAQ9CD
     I              JKHGCD                          WAHGCD
     I              JKZXNB                          WAZXNB
     I              JKBOPR                          WABOPR
     I              JKCDPR                          WACDPR
     I              JKCEPR                          WACEPR
     I              JKU6ST                          WAU6ST
     I              JKUVST                          WAUVST
     I              JKUWST                          WAUWST
     I              JKUXST                          WAUXST
     I              JKAATM                          WAAATM
     I              JKAYNA                          WAAYNA
     I              JKA0NA                          WAA0NA
     I              JKAXDT                          WAAXDT
      *
     I@IMCPSD
      * Order Detail Pricing      Update index
      * Renamed input format fields
     I              IMAIC3                          WBAIC3
     I              IMC4NB                          WBC4NB
     I              IMDPNB                          WBDPNB
     I              IMUENB                          WBUENB
     I              IMQ9CD                          WBQ9CD
     I              IMPDSQ                          WBPDSQ
     I              IMBNPR                          WBBNPR
     I              IMU6ST                          WBU6ST
     I              IMUVST                          WBUVST
     I              IMUWST                          WBUWST
     I              IMUXST                          WBUXST
     I              IMAATM                          WBAATM
     I              IMAYNA                          WBAYNA
     I              IMA0NA                          WBA0NA
     I              IMAXDT                          WBAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * Outward parameters
     IPARC        DS                             22
      * KEY : Order Dtl Formula Dtl     Rtv Index for Work File
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Order Number
     I                                    P   3   60PAC4NB
      * I :  Order Sequence Number
     I                                    P   7   80PADPNB
      * I :  Order Secondary Line Seq
     I                                    P   9  100PAUENB
      *
     IQPDIM1    E DSPDIMCPL0
      * UPD : Order Detail Pricing      Update index
      * Renamed input format fields
     I              IMAIC3                          WBAIC3
     I              IMC4NB                          WBC4NB
     I              IMDPNB                          WBDPNB
     I              IMUENB                          WBUENB
     I              IMQ9CD                          WBQ9CD
     I              IMPDSQ                          WBPDSQ
     I              IMBNPR                          WBBNPR
     I              IMU6ST                          WBU6ST
     I              IMUVST                          WBUVST
     I              IMUWST                          WBUWST
     I              IMUXST                          WBUXST
     I              IMAATM                          WBAATM
     I              IMAYNA                          WBAYNA
     I              IMA0NA                          WBA0NA
     I              IMAXDT                          WBAXDT
      *
     IYARDCS      DS                             56
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Detail Pricing
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Order Number
     I                                    P   3   60P1C4NB
      * I :  Order Sequence Number
     I                                    P   7   80P1DPNB
      * I :  Order Secondary Line Seq
     I                                    P   9  100P1UENB
     IP2PARM      DS
      * I :  Event Called From
     I                                        1   2 P2SJCD
     IP3PARM      DS
      * FLD: *Arrays
      * O : MAP USR Total Consumed Items
     I                                    P   1   62P3TSVA
      * O : MAP USR Muscle Yield Amt
     I                                    P   7  122P3TZVA
      * O : MAP Total Credit Dollars
     I                                    P  13  182P3Y0NB
      * N :  Starting Product Price
     I                                    P  19  244P3CGPR
      * N :  Credit Value
     I                                    P  25  304P3CEPR
      * N :  Muscle Yield Price
     I                                    P  31  364P3CHPR
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
     C           P1DPNB    PARM           WP0003  30       Order Sequence
     C           P1UENB    PARM           WP0004  30       Order Secondary
     C           P2SJCD    PARM           WP0005  2        Event Called Fr
     C           P3TSVA    PARM P3TSVA    WP0006 112       USR Total Consu
     C           P3TZVA    PARM P3TZVA    WP0007 112       USR Muscle Yiel
     C           P3Y0NB    PARM P3Y0NB    WP0008 112       Total Credit Do
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * UPD From Formula Dtl   XF
      * CASE: PAR.Event Called From is Pre-Update Invoice
     C           P2SJCD    IFEQ '**'                       *IF
      * UPD WK Tots - Form Chg XF - PD Ship Dtl Formula Dtl  * 
     C                     CLEARPARC
     C                     Z-ADDP1AIC3    PAAIC3           Company Number
     C                     Z-ADDP1C4NB    PAC4NB           Order Number
     C                     Z-ADDP1DPNB    PADPNB           Order Sequence
     C                     Z-ADDP1UENB    PAUENB           Order Secondary
      *
     C                     CALL 'PDQJXFR'              90  UPD WK Tots - F
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Order Dtl
     C           WUTSVA    PARM WUTSVA    WQ0001 112       USR Total Consu
     C           WUTZVA    PARM WUTZVA    WQ0002 112       USR Muscle Yiel
     C           WUY0NB    PARM WUY0NB    WQ0003 112       Total Credit Do
     C           P3CGPR    PARM P3CGPR    WQ0004 114       Starting Produc
     C           P3CEPR    PARM P3CEPR    WQ0005 114       Credit Value
     C           P3CHPR    PARM P3CHPR    WQ0006 114       Muscle Yield Pr
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQJXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: PAR.Event Called From is Invoice Update
     C           P2SJCD    IFEQ '02'                       *IF
      * UPD Tots - Form Chg    RT - PD Ship Dtl Formula Dtl  * 
     C                     EXSR SARVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWUTSVA    P3TSVA           USR Total Consu
     C                     Z-ADDWUTZVA    P3TZVA           USR Muscle Yiel
     C                     Z-ADDWUY0NB    P3Y0NB           Total Credit Do
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * UPD Tots - Form Chg    RT - PD Ship Dtl Formula Dtl  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  1        BOM Type
     C                     MOVEL*BLANK    WN0002  1        USR BOM Type
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVELWUV2ST    WN0001           BOM Type
     C                     MOVELWUV2ST    WN0002           USR BOM Type
     C                     Z-ADD*ZERO     WUTSVA           USR Total Consu
     C                     Z-ADD*ZERO     WUTZVA           USR Muscle Yiel
     C                     Z-ADD*ZERO     WUY0NB           Total Credit Do
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
     C           *LIKE     DEFN WAC4NB    WQSA02           Order Number
     C           *LIKE     DEFN WADPNB    WQSA03           Order Sequence
     C           *LIKE     DEFN WAUENB    WQSA04           Order Secondary
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           WQSA02           Order Number
     C                     KFLD           WQSA03           Order Sequence
     C                     KFLD           WQSA04           Order Secondary
      * Setup key
     C                     Z-ADDP1AIC3    WQSA01           Company Number
     C                     Z-ADDP1C4NB    WQSA02           Order Number
     C                     Z-ADDP1DPNB    WQSA03           Order Sequence
     C                     Z-ADDP1UENB    WQSA04           Order Secondary
      * Establish starting position
     C           KRSSA     SETLL@JKCPYF                    *
     C           KRSSA     READE@JKCPYF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1870' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUTSVA           USR Total Consu
     C                     Z-ADD*ZERO     WUTZVA           USR Muscle Yiel
     C                     Z-ADD*ZERO     WUY0NB           Total Credit Do
     C                     Z-ADD*ZERO     P3CGPR           Starting Produc
     C                     Z-ADD*ZERO     P3CEPR           Credit Value
     C                     Z-ADD*ZERO     P3CHPR           Muscle Yield Pr
     C                     MOVEL*BLANK    WN0001           BOM Type
     C                     MOVEL*BLANK    WN0002           USR BOM Type
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Price Method Componant is STRITM
     C           WAQ9CD    IFEQ 'STRITM'                   *IF
     C                     MOVEL'C'       WN0001           BOM Type
     C                     ADD  WACDPR    P3CGPR           Starting Produc
     C                     ELSE
      * CASE: DB1.Price Method Componant is TCRDVY
     C           WAQ9CD    IFEQ 'TCRDVY'                   *IF
     C                     MOVEL'P'       WN0002           USR BOM Type
     C                     ADD  WACEPR    P3CEPR           Credit Value
     C                     ADD  WABOPR    P3CHPR           Muscle Yield Pr
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSA     READE@JKCPYF                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: PAR.BOM Type is Consumed - Meat
     C           WN0001    IFEQ 'C'                        *IF
      * CHG Detail From Frm    CH - PD Ship Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0001           Company Number
     C                     Z-ADDP1C4NB    WL0002           Order Number
     C                     Z-ADDP1DPNB    WL0003           Order Sequence
     C                     Z-ADDP1UENB    WL0004           Order Secondary
     C                     MOVEL'STRITM'  WL0005    P      Price Method Co
     C                     Z-ADDP3CGPR    WL0006           Componant Price
     C                     EXSR SBCHRC
     C           P3CGPR    MULT 1         WUTSVA    H      USR Total Consu
     C                     END                             *FI
      * CASE: PAR.USR BOM Type is Produced - Meat
     C           WN0002    IFEQ 'P'                        *IF
      * CHG Detail From Frm    CH - PD Ship Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0001           Company Number
     C                     Z-ADDP1C4NB    WL0002           Order Number
     C                     Z-ADDP1DPNB    WL0003           Order Sequence
     C                     Z-ADDP1UENB    WL0004           Order Secondary
     C                     MOVEL'TLCRDV'  WL0005    P      Price Method Co
     C                     Z-ADDP3CEPR    WL0006           Componant Price
     C                     EXSR SBCHRC
      * CHG Detail From Frm    CH - PD Ship Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0001           Company Number
     C                     Z-ADDP1C4NB    WL0002           Order Number
     C                     Z-ADDP1DPNB    WL0003           Order Sequence
     C                     Z-ADDP1UENB    WL0004           Order Secondary
     C                     MOVEL'TLCRDY'  WL0005    P      Price Method Co
     C                     Z-ADDP3CHPR    WL0006           Componant Price
     C                     EXSR SBCHRC
     C                     MULT -1        P3CEPR           Credit Value
     C           100       SUB  P3CHPR    P3CHPR           Muscle Yield Pr
      * CHG Detail From Frm    CH - PD Ship Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0001           Company Number
     C                     Z-ADDP1C4NB    WL0002           Order Number
     C                     Z-ADDP1DPNB    WL0003           Order Sequence
     C                     Z-ADDP1UENB    WL0004           Order Secondary
     C                     MOVEL'SUBCRD'  WL0005    P      Price Method Co
     C                     Z-ADDP3CEPR    WL0006           Componant Price
     C                     EXSR SBCHRC
      * CHG Detail From Frm    CH - PD Ship Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0001           Company Number
     C                     Z-ADDP1C4NB    WL0002           Order Number
     C                     Z-ADDP1DPNB    WL0003           Order Sequence
     C                     Z-ADDP1UENB    WL0004           Order Secondary
     C                     MOVEL'MSCYLD'  WL0005    P      Price Method Co
     C                     Z-ADDP3CHPR    WL0006           Componant Price
     C                     EXSR SBCHRC
     C           P3CHPR    MULT 1         WUTZVA    H      USR Muscle Yiel
     C           P3CEPR    MULT 1         WUY0NB    H      Total Credit Do
     C                     END                             *FI
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCHRC    BEGSR
      *================================================================
      * CHG Detail From Frm    CH - PD Ship Detail Pricing  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0003  30       Price Detail Se
     C                     MOVEL*BLANK    WN0004  1        PD Status
     C                     MOVEL*BLANK    WN0005  1        EDI Status 1
     C                     MOVEL*BLANK    WN0006  1        EDI Status 2
     C                     MOVEL*BLANK    WN0007  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0008  60       Job Time
     C                     MOVEL*BLANK    WN0009 10        User Id
     C                     MOVEL*BLANK    WN0010 10        Job Name
     C                     Z-ADD*ZERO     WN0011  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @IMCPSD
     C                     Z-ADDWL0001    WBAIC3           Company Number
     C                     Z-ADDWL0002    WBC4NB           Order Number
     C                     Z-ADDWL0003    WBDPNB           Order Sequence
     C                     Z-ADDWL0004    WBUENB           Order Secondary
     C                     MOVELWL0005    WBQ9CD    P      Price Method Co
      *
     C           KLCHSB    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
     C                     KFLD           WBDPNB           Order Sequence
     C                     KFLD           WBUENB           Order Secondary
     C                     KFLD           WBQ9CD           Price Method Co
     C           KLCHSB    CHAIN@IMCPSD              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDIMCPL0'MDACP
     C                     MOVEL'@IMCPSD' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDIM1    YARDCS
      * Move non-key fields to @IMCPSD
     C                     Z-ADDWL0006    WBBNPR           Componant Price
      *
      * Set PGM.*Record Data Changed flag
     C           QPDIM1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WBAATM           Job Time
     C                     MOVEL##USR     WBAYNA           User Id
     C                     MOVEL##JOB     WBA0NA           Job Name
     C                     Z-ADD##JDT     WBAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDIM1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@IMCPSD                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDIMCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P3CGPR           Starting Produc
     C                     Z-ADD*ZERO     P3CEPR           Credit Value
     C                     Z-ADD*ZERO     P3CHPR           Muscle Yield Pr
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field USR Total Consumed Items
     C                     Z-ADD*ZERO     WUTSVA 112
      * Define work field USR Muscle Yield Amt
     C                     Z-ADD*ZERO     WUTZVA 112
      * Define work field Total Credit Dollars
     C                     Z-ADD*ZERO     WUY0NB 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WAZXNB           Pricing Sequenc
     C                     Z-ADD*ZERO     WABOPR           Sales Yield
     C                     Z-ADD*ZERO     WACDPR           Market Value
     C                     Z-ADD*ZERO     WACEPR           Credit Value
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field BOM Type
     C                     MOVEL*BLANK    WUV2ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBDPNB           Order Sequence
     C                     Z-ADD*ZERO     WBUENB           Order Secondary
     C                     Z-ADD*ZERO     WBPDSQ           Price Detail Se
     C                     Z-ADD*ZERO     WBBNPR           Componant Price
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SBCHRC.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     Z-ADD*ZERO     WL0003  30
     C                     Z-ADD*ZERO     WL0004  30
     C                     MOVEL*BLANK    WL0005  6
     C                     Z-ADD*ZERO     WL0006 114
      *================================================================
     CSR         ZZEXIT    ENDSR
