     H/TITLE Edt Sched Ship Date    E1 Edit record(1 screen)
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Maintain DBF file records, one at a time
     H* - Existing records may be updated or deleted
     H* - Key changes are not allowed
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Edit record(1 screen)
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 04/07/21  Time  : 10:46:50
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPDLQE1R#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: Edt Sched Ship Date    E1 Edit record(1 screen)
      *
     FOPBFCPL1IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse                 Active records only
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FCAAMREL1IF  E           K        DISK
      * RTV : Unit of Measure           Retrieval index       NV
      *
     FCAABREL4IF  E           K        DISK
      * RTV : Company Name and Address  Active records
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FCAEOREL3IF  E           K        DISK
      * RSQ : Company Customer          Customer/Company
      *
     FOMFNCPL1IF  E           K        DISK
      * RTV : Manifest Detail           Retrieval index
      *
     FOPEXREL2IF  E           K        DISK
      * RTV : Order Types               Active order Types
      *
     FCABBRELAIF  E           K        DISK
      * RTV : Customer                  Active Only
      *
     FCAACREL2IF  E           K        DISK
      * RTV : State                     Active only
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FCAAOREL2IF  E           K        DISK
      * RTV : Terms                     Retrieve Active Records
      *
     FOMFFREL3IF  E           K        DISK
      * RTV : Carrier                   Active records
      *
     FOPCXREL2IF  E           K        DISK
      * RTV : OP Reason Codes           Active Records Only
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADSREL1IF  E           K        DISK
      * RTV : Enterprise Master         Retrieval index       NV
      *
     FPDJEREL2IF  E           K        DISK
      * RTV : Sales Route               Active Records
      *
     FCAALREL3IF  E           K        DISK
      * RTV : Manager Level             Active Only
      *
     FPDIFREL2IF  E           K        DISK
      * RTV : VP Level                  Active Only
      *
     FPDJHREL1IF  E           K        DISK
      * RTV : Internal Reason           Retrieval index
      *
     FOPEZREL1IF  E           K        DISK
      * RTV : Event Types               Retrieval index       NV
      *
     FPDMKCPL1IF  E           K        DISK
      * RTV : A/R Claim                 Retrieval index
      *
     FOMFNCPL3IF  E           K        DISK
      * RSQ : Manifest Detail           Co/Ord/Seq/SecSq/Cs(d)
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCAADREL9IF  E           K        DISK
      * RSQ : Warehouse                 ShipCo/Warehouse
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     FOMFNCPL0UF  E           K        DISK
      * UPD : Manifest Detail           Update index
      *
     E                    J3          3  1
     E                    K3          3  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    J7          7  1
     E                    K7          7  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    #L7         7  1
      * Days in month for date validation
     E                    @XD    12  12  2 0
     E                    #L3         3  1
      * KEY Screen: Field position and name array
     E                    W0BEG   2 002  5 0A
     E                    W0END   2 002  5 0A
     E                    W0NAM   2 002 10
      * DETAIL Screen: Field position and name array
     E                    W1BEG   7 013  5 0A
     E                    W1END   7 013  5 0A
     E                    W1NAM   7 013 10
      * Long constants
     E                    @CN#    1  03  6   @CN    25
      * Set wdw location allowed?
     E                    YSL         2  1
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WAAJCD
     I              ADF8NA                          WAF8NA
     I              ADACNA                          WAACNA
     I              ADADNA                          WAADNA
     I              ADAENA                          WAAENA
     I              ADAJNA                          WAAJNA
     I              ADBTTX                          WABTTX
     I              ADAOCD                          WAAOCD
     I              ADBGCD                          WABGCD
     I              ADVHST                          WAVHST
     I              ADMPNA                          WAMPNA
     I              ADWPST                          WAWPST
     I              ADXUST                          WAXUST
     I              ADT0ST                          WAT0ST
     I              ADT1ST                          WAT1ST
     I              ADDBNB                          WADBNB
     I              ADT2ST                          WAT2ST
     I              ADT3ST                          WAT3ST
     I              ADT4ST                          WAT4ST
     I              ADT6ST                          WAT6ST
     I              ADBWC3                          WABWC3
     I              ADBTC3                          WABTC3
     I              ADBUC3                          WABUC3
     I              ADBVC3                          WABVC3
     I              ADFCAA                          WAFCAA
     I              ADRQSX                          WARQSX
     I              ADRRSX                          WARRSX
     I              ADRSSX                          WARSSX
     I              ADRTSX                          WARTSX
     I              ADT7ST                          WAT7ST
     I              ADT8ST                          WAT8ST
     I              ADRNSX                          WARNSX
     I              ADROSX                          WAROSX
     I              ADRPSX                          WARPSX
     I              ADUVST                          WAUVST
     I              ADUWST                          WAUWST
     I              ADUXST                          WAUXST
     I              ADVSST                          WAVSST
     I              ADAATM                          WAAATM
     I              ADAYNA                          WAAYNA
     I              ADA0NA                          WAA0NA
     I              ADAXDT                          WAAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WBAIC3
     I              OMC4NB                          WBC4NB
     I              OMDPNB                          WBDPNB
     I              OMUENB                          WBUENB
     I              OMHGCD                          WBHGCD
     I              OMAJCD                          WBAJCD
     I              OMBKC7                          WBBKC7
     I              OMCFC7                          WBCFC7
     I              OMGMST                          WBGMST
     I              OMGNST                          WBGNST
     I              OMMAVA                          WBMAVA
     I              OMKDVA                          WBKDVA
     I              OML8VA                          WBL8VA
     I              OML9VA                          WBL9VA
     I              OMGTST                          WBGTST
     I              OMGVST                          WBGVST
     I              OMGUST                          WBGUST
     I              OMQFST                          WBQFST
     I              OMAYVA                          WBAYVA
     I              OMEXDT                          WBEXDT
     I              OMLQCD                          WBLQCD
     I              OMRDCD                          WBRDCD
     I              OMQ7CD                          WBQ7CD
     I              OMBZPR                          WBBZPR
     I              OML6NB                          WBL6NB
     I              OMU1ST                          WBU1ST
     I              OMGIDT                          WBGIDT
     I              OMCRCD                          WBCRCD
     I              OMAGCD                          WBAGCD
     I              OMRZST                          WBRZST
     I              OMR0ST                          WBR0ST
     I              OMR1ST                          WBR1ST
     I              OMG7NA                          WBG7NA
     I              OMG8NA                          WBG8NA
     I              OMRPCD                          WBRPCD
     I              OMVEST                          WBVEST
     I              OMVGST                          WBVGST
     I              OMAVST                          WBAVST
     I              OMU0ST                          WBU0ST
     I              OMRFCD                          WBRFCD
     I              OMFZST                          WBFZST
     I              OMR1NB                          WBR1NB
     I              OMAVQT                          WBAVQT
     I              OMD0WG                          WBD0WG
     I              OMCCQT                          WBCCQT
     I              OMAUWG                          WBAUWG
     I              OMCBQT                          WBCBQT
     I              OMATWG                          WBATWG
     I              OMAQCS                          WBAQCS
     I              OMAGCS                          WBAGCS
     I              OMAKPR                          WBAKPR
     I              OMALPR                          WBALPR
     I              OMAUPR                          WBAUPR
     I              OMAVWG                          WBAVWG
     I              OMA4WG                          WBA4WG
     I              OMA5DT                          WBA5DT
     I              OMAODT                          WBAODT
     I              OMGNDT                          WBGNDT
     I              OMAMST                          WBAMST
     I              OMANST                          WBANST
     I              OMVAST                          WBVAST
     I              OMRGNB                          WBRGNB
     I              OMRHNB                          WBRHNB
     I              OMRINB                          WBRINB
     I              OMRBCD                          WBRBCD
     I              OMHICD                          WBHICD
     I              OMRNCD                          WBRNCD
     I              OMROCD                          WBROCD
     I              OMCXDT                          WBCXDT
     I              OMAJVN                          WBAJVN
     I              OMKXCD                          WBKXCD
     I              OMJPCD                          WBJPCD
     I              OMCQCD                          WBCQCD
     I              OMR4CD                          WBR4CD
     I              OMZ1ST                          WBZ1ST
     I              OMZ3ST                          WBZ3ST
     I              OMZ4ST                          WBZ4ST
     I              OMDUPR                          WBDUPR
     I              OMB6VL                          WBB6VL
     I              OMA1AA                          WBA1AA
     I              OMFZSX                          WBFZSX
     I              OMF0SX                          WBF0SX
     I              OMF1SX                          WBF1SX
     I              OMF2SX                          WBF2SX
     I              OMF3SX                          WBF3SX
     I              OMF4SX                          WBF4SX
     I              OMF5SX                          WBF5SX
     I              OMF6SX                          WBF6SX
     I              OMF7SX                          WBF7SX
     I              OMNTDT                          WBNTDT
     I              OMNUDT                          WBNUDT
     I              OMNVDT                          WBNVDT
     I              OMNWDT                          WBNWDT
     I              OMNXDT                          WBNXDT
     I              OMBUTM                          WBBUTM
     I              OMBVTM                          WBBVTM
     I              OMBWTM                          WBBWTM
     I              OMBXTM                          WBBXTM
     I              OMBYTM                          WBBYTM
     I              OMH5NX                          WBH5NX
     I              OMH6NX                          WBH6NX
     I              OMH7NX                          WBH7NX
     I              OMH8NX                          WBH8NX
     I              OMH9NX                          WBH9NX
     I              OMDVPR                          WBDVPR
     I              OMDWPR                          WBDWPR
     I              OMDXPR                          WBDXPR
     I              OMDYPR                          WBDYPR
     I              OMDZPR                          WBDZPR
     I              OMGSPR                          WBGSPR
     I              OMGTPR                          WBGTPR
     I              OMGUPR                          WBGUPR
     I              OMHOST                          WBHOST
     I              OMHPST                          WBHPST
     I              OMIOST                          WBIOST
     I              OMPEWG                          WBPEWG
     I              OMRINY                          WBRINY
     I              OMTIDT                          WBTIDT
     I              OMTJDT                          WBTJDT
     I              OMH2ST                          WBH2ST
     I              OMH0ST                          WBH0ST
     I              OMH1ST                          WBH1ST
     I              OMTKDT                          WBTKDT
     I              OMTLDT                          WBTLDT
     I              OMTMDT                          WBTMDT
     I              OMUVST                          WBUVST
     I              OMUWST                          WBUWST
     I              OMUXST                          WBUXST
     I              OMAATM                          WBAATM
     I              OMAYNA                          WBAYNA
     I              OMA0NA                          WBA0NA
     I              OMAXDT                          WBAXDT
      *
     I@FNCPUW
      * Manifest Detail           Co/Ord/Seq/SecSq/Cs(d)
      * Renamed input format fields
     I              FNAIC3                          WCAIC3
     I              FNC4NB                          WCC4NB
     I              FNDPNB                          WCDPNB
     I              FNUENB                          WCUENB
     I              FNRZNB                          WCRZNB
     I              FNFOQT                          WCFOQT
     I              FNR0NB                          WCR0NB
     I              FNPMST                          WCPMST
     I              FNK7DT                          WCK7DT
     I              FNPFNX                          WCPFNX
     I              FNHGCD                          WCHGCD
     I              FNAJCD                          WCAJCD
     I              FNELDT                          WCELDT
     I              FNN5WG                          WCN5WG
     I              FNRZNA                          WCRZNA
     I              FNH5NY                          WCH5NY
     I              FNH6NY                          WCH6NY
     I              FNH7NY                          WCH7NY
     I              FNGBTX                          WCGBTX
     I              FNN6WG                          WCN6WG
     I              FNN7WG                          WCN7WG
     I              FNGCTX                          WCGCTX
     I              FNGDTX                          WCGDTX
     I              FNRBDT                          WCRBDT
     I              FNITNY                          WCITNY
     I              FNIVNY                          WCIVNY
     I              FNIUNY                          WCIUNY
     I              FNIWNY                          WCIWNY
     I              FNIXNY                          WCIXNY
     I              FNIYNY                          WCIYNY
     I              FNUVST                          WCUVST
     I              FNUWST                          WCUWST
     I              FNUXST                          WCUXST
     I              FNVSST                          WCVSST
     I              FNAATM                          WCAATM
     I              FNAYNA                          WCAYNA
     I              FNA0NA                          WCA0NA
     I              FNAXDT                          WCAXDT
      *
     I@FNCPCS
      * Manifest Detail           Update index
      * Renamed input format fields
     I              FNAIC3                          WDAIC3
     I              FNC4NB                          WDC4NB
     I              FNDPNB                          WDDPNB
     I              FNUENB                          WDUENB
     I              FNRZNB                          WDRZNB
     I              FNFOQT                          WDFOQT
     I              FNR0NB                          WDR0NB
     I              FNPMST                          WDPMST
     I              FNK7DT                          WDK7DT
     I              FNPFNX                          WDPFNX
     I              FNHGCD                          WDHGCD
     I              FNAJCD                          WDAJCD
     I              FNELDT                          WDELDT
     I              FNN5WG                          WDN5WG
     I              FNRZNA                          WDRZNA
     I              FNH5NY                          WDH5NY
     I              FNH6NY                          WDH6NY
     I              FNH7NY                          WDH7NY
     I              FNGBTX                          WDGBTX
     I              FNN6WG                          WDN6WG
     I              FNN7WG                          WDN7WG
     I              FNGCTX                          WDGCTX
     I              FNGDTX                          WDGDTX
     I              FNRBDT                          WDRBDT
     I              FNITNY                          WDITNY
     I              FNIVNY                          WDIVNY
     I              FNIUNY                          WDIUNY
     I              FNIWNY                          WDIWNY
     I              FNIXNY                          WDIXNY
     I              FNIYNY                          WDIYNY
     I              FNUVST                          WDUVST
     I              FNUWST                          WDUWST
     I              FNUXST                          WDUXST
     I              FNVSST                          WDVSST
     I              FNAATM                          WDAATM
     I              FNAYNA                          WDAYNA
     I              FNA0NA                          WDA0NA
     I              FNAXDT                          WDAXDT
      *
     I@ADREWA
      * Warehouse                 ShipCo/Warehouse
      * Renamed input format fields
     I              ADAJCD                          WEAJCD
     I              ADF8NA                          WEF8NA
     I              ADACNA                          WEACNA
     I              ADADNA                          WEADNA
     I              ADAENA                          WEAENA
     I              ADAJNA                          WEAJNA
     I              ADBTTX                          WEBTTX
     I              ADAOCD                          WEAOCD
     I              ADBGCD                          WEBGCD
     I              ADVHST                          WEVHST
     I              ADMPNA                          WEMPNA
     I              ADWPST                          WEWPST
     I              ADXUST                          WEXUST
     I              ADT0ST                          WET0ST
     I              ADT1ST                          WET1ST
     I              ADDBNB                          WEDBNB
     I              ADT2ST                          WET2ST
     I              ADT3ST                          WET3ST
     I              ADT4ST                          WET4ST
     I              ADT6ST                          WET6ST
     I              ADBWC3                          WEBWC3
     I              ADBTC3                          WEBTC3
     I              ADBUC3                          WEBUC3
     I              ADBVC3                          WEBVC3
     I              ADFCAA                          WEFCAA
     I              ADRQSX                          WERQSX
     I              ADRRSX                          WERRSX
     I              ADRSSX                          WERSSX
     I              ADRTSX                          WERTSX
     I              ADT7ST                          WET7ST
     I              ADT8ST                          WET8ST
     I              ADRNSX                          WERNSX
     I              ADROSX                          WEROSX
     I              ADRPSX                          WERPSX
     I              ADUVST                          WEUVST
     I              ADUWST                          WEUWST
     I              ADUXST                          WEUXST
     I              ADVSST                          WEVSST
     I              ADAATM                          WEAATM
     I              ADAYNA                          WEAYNA
     I              ADA0NA                          WEA0NA
     I              ADAXDT                          WEAXDT
      *
     I@ABREG3
      * Company Name and Address  Retrieval index       NV
      * Renamed input format fields
     I              ABAIC3                          WFAIC3
     I              ABADTX                          WFADTX
     I              ABACNA                          WFACNA
     I              ABADNA                          WFADNA
     I              ABAENA                          WFAENA
     I              ABAJNA                          WFAJNA
     I              ABBTTX                          WFBTTX
     I              ABBVTX                          WFBVTX
     I              ABBWTX                          WFBWTX
     I              ABA2NA                          WFA2NA
     I              ABABTX                          WFABTX
     I              ABBGCD                          WFBGCD
     I              ABKXCD                          WFKXCD
     I              ABUVST                          WFUVST
     I              ABUWST                          WFUWST
     I              ABUXST                          WFUXST
     I              ABVSST                          WFVSST
     I              ABAATM                          WFAATM
     I              ABAYNA                          WFAYNA
     I              ABA0NA                          WFA0NA
     I              ABAXDT                          WFAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     I@1DBRC    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Current/previous master file format fields for change control
      *
     I#1DBRC      DS                            779
      * Stored master file format fields
     I                                        1   1 #1DB1
      *
     IYARDCS      DS                            779
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      * Outward parameters
     IPARC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Order Number
     I                                    P   3   60PAC4NB
      * I :  Order Type - Sales
     I                                        7   8 PAJNCD
      * I :  A/R Customer Number
     I                                    P   9  120PAANC7
      * I :  Ship To Customer
     I                                    P  13  160PABKC7
      * I :  Ship To Name
     I                                       17  46 PABRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PAHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PAHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PAHPNA
      * I :  Ship To City
     I                                      137 156 PAHNNA
      * I :  Ship To State Code
     I                                      157 158 PADBCD
      * I :  Ship To Zip/Postal Code
     I                                      159 169 PACKTX
      * I :  Bill to Customer
     I                                    P 170 1730PAB0C7
      * I :  Bill to Name
     I                                      174 203 PAAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PAB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PAB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PAB4NA
      * I :  Bill to City
     I                                      294 313 PAB2NA
      * I :  Bill to State Code
     I                                      314 315 PABHCD
      * I :  Bill to Zip/Postal Code
     I                                      316 326 PAC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PABCNA
      * I :  Order Date
     I                                    P 342 3450PAA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PAA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PAGNDT
      * I :  Cancel Date
     I                                    P 354 3570PAACDT
      * I :  Terms Code
     I                                      358 359 PAAQCD
      * I :  Special Instructions
     I                                      360 399 PAB6NA
      * I :  Special Instructions 2
     I                                      400 439 PABYNA
      * I :  Carrier Code
     I                                      440 442 PABZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PAGTST
      * I :  Comment Print Inv/Cr.Memo
     I                                      444 444 PAGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PAGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PAQFST
      * I :  Reason Code
     I                                      447 449 PACQCD
      * I :  Order in Use
     I                                      450 450 PAGJST
      * I :  Header Status
     I                                      451 451 PAGWST
      * I :  Header Status Last
     I                                      452 452 PAGXST
      * I :  Order Type Print Status
     I                                      453 453 PAGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PAAODT
      * I :  User Original Entry
     I                                      458 467 PAAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PACXDT
      * I :  Order Value Total
     I                                    P 472 4772PAJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PAA1WG
      * I :  Credit Hold
     I                                      484 484 PAXIST
      * I :  Production Hold
     I                                      485 485 PAXJST
      * I :  New Customer Hold
     I                                      486 486 PAXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PAEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PAAFTM
      * I :  Accounts Receiv. Ent 1
     I                                      494 497 PAE8CD
      * I :  Accounts Receiv. Ent 2
     I                                      498 509 PAE9CD
      * I :  Load ID
     I                                    P 510 5130PARMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PATBNB
      * I :  Rated Freight
     I                                    P 517 5222PAR1NB
      * I :  LTL Flag
     I                                      523 523 PAPJST
      * I :  Price Audit
     I                                      524 524 PAU0ST
      * I :  Price Status
     I                                      525 525 PAU1ST
      * I :  Shipping Method
     I                                      526 527 PAQ2CD
      * I :  Export Status
     I                                      528 528 PAU2ST
      * I :  Palletize
     I                                      529 529 PAVEST
      * I :  Shrink Wrap
     I                                      530 530 PAVFST
      * I :  Slip Sheet
     I                                      531 531 PAVGST
      * I :  Age Code
     I                                      532 532 PARPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PARNNB
      * I :  Load Type
     I                                      536 536 PAVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PAATIN
      * I :  Load Plan Order
     I                                      541 541 PAU4ST
      * I :  Print Pick Slip
     I                                      542 542 PAU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PARSRN
      * I :  Special Comment 1
     I                                      547 576 PAMHNA
      * I :  Special Comment 2
     I                                      577 606 PAMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PAWBST
      * I :  Sales Route Code
     I                                      608 610 PAR4CD
      * I :  Manager Level Code
     I                                      611 612 PABFCD
      * I :  VP Level Code
     I                                      613 615 PAQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PAT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PASICD
      * I :  Invoice Number
     I                                    P 623 6260PACONB
      * I :  Invoice Suffix
     I                                      627 628 PACEST
      * I :  Invoice Date
     I                                    P 629 6320PAAWDT
      * I :  Event Code
     I                                      633 634 PAJPCD
      * I :  Trans Contol AS400/Plant
     I                                      635 635 PAXUST
      * I :  Modified Flag
     I                                      636 636 PAZ1ST
      * I :  A/R order Value Total
     I                                    P 637 6422PAVRVA
      * I :  Billing Activity Type
     I                                      643 643 PAOBST
      * I :  Block Order Flag
     I                                      644 644 PABCST
      * I :  Order Certification Flag
     I                                      645 645 PABDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PAB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PAGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PAGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PAGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PAGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PAFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PAFOSX
      * I :  Order Emailed
     I                                      658 658 PAFPSX
      * I :  Export Docs Go w/Driver
     I                                      659 659 PAFQSX
      * I :  Shipping Temp Code C/F
     I                                      660 660 PAFRSX
      * I :  Broker Order Status
     I                                      661 661 PAFSSX
      * I :  Air Freight Order
     I                                      662 662 PAFTSX
      * I :  Order Requires Review
     I                                      663 664 PAFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PAFVSX
      * I :  Export USDA Approved
     I                                      667 668 PAFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PAFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PAFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PANODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PANPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PANQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PANRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PANSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PABPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PABQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PABRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PABSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PABTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PAH0NX
      * I :  Act Non-Ref Frt Amount
     I                                    P 721 7262PAH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PAH2NX
      * I :  OH Total Non-Ref Frt Amt
     I                                    P 733 7382PAH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PAH4NX
      * I :  Claim Number
     I                                    P 745 7480PAC0C7
      * I :  EDI Status 1
     I                                      749 749 PAUVST
      * I :  EDI Status 2
     I                                      750 750 PAUWST
      * I :  EDI Status 3
     I                                      751 751 PAUXST
      * I :  Job Time
     I                                    P 752 7550PAAATM
      * I :  User Id
     I                                      756 765 PAAYNA
      * I :  Job Name
     I                                      766 775 PAA0NA
      * I :  Job Date
     I                                    P 776 7790PAAXDT
      *
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WBAIC3
     I              OMC4NB                          WBC4NB
     I              OMDPNB                          WBDPNB
     I              OMUENB                          WBUENB
     I              OMHGCD                          WBHGCD
     I              OMAJCD                          WBAJCD
     I              OMBKC7                          WBBKC7
     I              OMCFC7                          WBCFC7
     I              OMGMST                          WBGMST
     I              OMGNST                          WBGNST
     I              OMMAVA                          WBMAVA
     I              OMKDVA                          WBKDVA
     I              OML8VA                          WBL8VA
     I              OML9VA                          WBL9VA
     I              OMGTST                          WBGTST
     I              OMGVST                          WBGVST
     I              OMGUST                          WBGUST
     I              OMQFST                          WBQFST
     I              OMAYVA                          WBAYVA
     I              OMEXDT                          WBEXDT
     I              OMLQCD                          WBLQCD
     I              OMRDCD                          WBRDCD
     I              OMQ7CD                          WBQ7CD
     I              OMBZPR                          WBBZPR
     I              OML6NB                          WBL6NB
     I              OMU1ST                          WBU1ST
     I              OMGIDT                          WBGIDT
     I              OMCRCD                          WBCRCD
     I              OMAGCD                          WBAGCD
     I              OMRZST                          WBRZST
     I              OMR0ST                          WBR0ST
     I              OMR1ST                          WBR1ST
     I              OMG7NA                          WBG7NA
     I              OMG8NA                          WBG8NA
     I              OMRPCD                          WBRPCD
     I              OMVEST                          WBVEST
     I              OMVGST                          WBVGST
     I              OMAVST                          WBAVST
     I              OMU0ST                          WBU0ST
     I              OMRFCD                          WBRFCD
     I              OMFZST                          WBFZST
     I              OMR1NB                          WBR1NB
     I              OMAVQT                          WBAVQT
     I              OMD0WG                          WBD0WG
     I              OMCCQT                          WBCCQT
     I              OMAUWG                          WBAUWG
     I              OMCBQT                          WBCBQT
     I              OMATWG                          WBATWG
     I              OMAQCS                          WBAQCS
     I              OMAGCS                          WBAGCS
     I              OMAKPR                          WBAKPR
     I              OMALPR                          WBALPR
     I              OMAUPR                          WBAUPR
     I              OMAVWG                          WBAVWG
     I              OMA4WG                          WBA4WG
     I              OMA5DT                          WBA5DT
     I              OMAODT                          WBAODT
     I              OMGNDT                          WBGNDT
     I              OMAMST                          WBAMST
     I              OMANST                          WBANST
     I              OMVAST                          WBVAST
     I              OMRGNB                          WBRGNB
     I              OMRHNB                          WBRHNB
     I              OMRINB                          WBRINB
     I              OMRBCD                          WBRBCD
     I              OMHICD                          WBHICD
     I              OMRNCD                          WBRNCD
     I              OMROCD                          WBROCD
     I              OMCXDT                          WBCXDT
     I              OMAJVN                          WBAJVN
     I              OMKXCD                          WBKXCD
     I              OMJPCD                          WBJPCD
     I              OMCQCD                          WBCQCD
     I              OMR4CD                          WBR4CD
     I              OMZ1ST                          WBZ1ST
     I              OMZ3ST                          WBZ3ST
     I              OMZ4ST                          WBZ4ST
     I              OMDUPR                          WBDUPR
     I              OMB6VL                          WBB6VL
     I              OMA1AA                          WBA1AA
     I              OMFZSX                          WBFZSX
     I              OMF0SX                          WBF0SX
     I              OMF1SX                          WBF1SX
     I              OMF2SX                          WBF2SX
     I              OMF3SX                          WBF3SX
     I              OMF4SX                          WBF4SX
     I              OMF5SX                          WBF5SX
     I              OMF6SX                          WBF6SX
     I              OMF7SX                          WBF7SX
     I              OMNTDT                          WBNTDT
     I              OMNUDT                          WBNUDT
     I              OMNVDT                          WBNVDT
     I              OMNWDT                          WBNWDT
     I              OMNXDT                          WBNXDT
     I              OMBUTM                          WBBUTM
     I              OMBVTM                          WBBVTM
     I              OMBWTM                          WBBWTM
     I              OMBXTM                          WBBXTM
     I              OMBYTM                          WBBYTM
     I              OMH5NX                          WBH5NX
     I              OMH6NX                          WBH6NX
     I              OMH7NX                          WBH7NX
     I              OMH8NX                          WBH8NX
     I              OMH9NX                          WBH9NX
     I              OMDVPR                          WBDVPR
     I              OMDWPR                          WBDWPR
     I              OMDXPR                          WBDXPR
     I              OMDYPR                          WBDYPR
     I              OMDZPR                          WBDZPR
     I              OMGSPR                          WBGSPR
     I              OMGTPR                          WBGTPR
     I              OMGUPR                          WBGUPR
     I              OMHOST                          WBHOST
     I              OMHPST                          WBHPST
     I              OMIOST                          WBIOST
     I              OMPEWG                          WBPEWG
     I              OMRINY                          WBRINY
     I              OMTIDT                          WBTIDT
     I              OMTJDT                          WBTJDT
     I              OMH2ST                          WBH2ST
     I              OMH0ST                          WBH0ST
     I              OMH1ST                          WBH1ST
     I              OMTKDT                          WBTKDT
     I              OMTLDT                          WBTLDT
     I              OMTMDT                          WBTMDT
     I              OMUVST                          WBUVST
     I              OMUWST                          WBUWST
     I              OMUXST                          WBUXST
     I              OMAATM                          WBAATM
     I              OMAYNA                          WBAYNA
     I              OMA0NA                          WBA0NA
     I              OMAXDT                          WBAXDT
      *
     IYBRDCS      DS                            525
     IQOMFN1    E DSOMFNCPL0
      * UPD : Manifest Detail           Update index
      * Renamed input format fields
     I              FNAIC3                          WDAIC3
     I              FNC4NB                          WDC4NB
     I              FNDPNB                          WDDPNB
     I              FNUENB                          WDUENB
     I              FNRZNB                          WDRZNB
     I              FNFOQT                          WDFOQT
     I              FNR0NB                          WDR0NB
     I              FNPMST                          WDPMST
     I              FNK7DT                          WDK7DT
     I              FNPFNX                          WDPFNX
     I              FNHGCD                          WDHGCD
     I              FNAJCD                          WDAJCD
     I              FNELDT                          WDELDT
     I              FNN5WG                          WDN5WG
     I              FNRZNA                          WDRZNA
     I              FNH5NY                          WDH5NY
     I              FNH6NY                          WDH6NY
     I              FNH7NY                          WDH7NY
     I              FNGBTX                          WDGBTX
     I              FNN6WG                          WDN6WG
     I              FNN7WG                          WDN7WG
     I              FNGCTX                          WDGCTX
     I              FNGDTX                          WDGDTX
     I              FNRBDT                          WDRBDT
     I              FNITNY                          WDITNY
     I              FNIVNY                          WDIVNY
     I              FNIUNY                          WDIUNY
     I              FNIWNY                          WDIWNY
     I              FNIXNY                          WDIXNY
     I              FNIYNY                          WDIYNY
     I              FNUVST                          WDUVST
     I              FNUWST                          WDUWST
     I              FNUXST                          WDUXST
     I              FNVSST                          WDVSST
     I              FNAATM                          WDAATM
     I              FNAYNA                          WDAYNA
     I              FNA0NA                          WDA0NA
     I              FNAXDT                          WDAXDT
      *
     IYCRDCS      DS                            159
     IYDRDCS      DS                            779
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Header TRG
      * I : RST Company Number
     I                                    P   1   20P1AIC3
      * I : RST Order Number
     I                                    P   3   60P1C4NB
     IP2PARM      DS
      * N :  Error Status
     I                                        1   1 P2ECST
     IP3PARM      DS
      * FLD: *Arrays
      * N :  Warehouse Code
     I                                        1   3 P3AJCD
      * N :  Application Code
     I                                        4   9 P3DNCD
      * N :  Salesperson Code
     I                                       10  12 P3BCCD
      * N :  User Profile Name
     I                                       13  22 P3AJVN
      * N :  Allow Multi-Company
     I                                       23  23 P3I6ST
      * N :  Default Printer
     I                                       24  33 P3MPNA
      * N :  First Time Flag
     I                                       34  34 P3TAST
      * I :  Access Limited Sts USR
     I                                       35  35 P3HHST
     IP4PARM      DS
      * N :  STATUS
     I                                        1   1 P4ATUS
     IP5PARM      DS
      * N :  Company Organization
     I                                        1   1 P5YJSX
     IP6PARM      DS
      * N :  Warehouse Location
     I                                        1   1 P6T0ST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'CD3 Non numeric data'
      * Message data for 'CD7 Non numeric data'
      * Message data for 'Order in use detail'
      * *SFLSEL
     I                                        1   1 ZA0001
      * Order Number
     I                                        2   8 ZA0002
      * Message data for 'Order has been Cancelled'
      * *SFLSEL
     I                                        1   1 ZA0003
      * Message data for 'Load Locked Opt Invalid'
      * *SFLSEL
     I                                        1   1 ZA0004
      * Message data for 'Load Locked Opt Invalid'
      * *SFLSEL
     I                                        1   1 ZA0005
      * Message data for 'Order On Load Opt Invald'
      * Order Number
     I                                        1   7 ZA0006
      * Message data for 'Order On Load Opt Invald'
      * Order Number
     I                                        1   7 ZA0007
      * Message data for 'Shipping Company Changed'
      * Warehouse Code
     I                                        1   3 ZA0008
      * Shipping Company
     I                                        4   6 ZA0009
      * Message data for 'Warehouse Code Required'
      * Warehouse Code
     I                                        1   3 ZA0010
      * Message data for 'Access Denied: Warehouse'
      * User Profile Name
     I                                        1  10 ZA0011
      * Warehouse Code
     I                                       11  13 ZA0012
      * Message data for 'Warehouse              NF'
      * Warehouse Code
     I                                        1   3 ZA0013
      * Message data for 'Date => Job Date'
      * @Date - ATR
     I                                    P   1   40ZA0014
      * Job Date
     I                                    P   5   80ZA0015
      * Message data for 'Delivery Date < Ship Date'
      * Requested Delivery Date
     I                                    P   1   40ZA0016
      * Message data for 'Date => Job Date'
      * @Date - ATR
     I                                    P   1   40ZA0017
      * Job Date
     I                                    P   5   80ZA0018
      * Message data for 'Delivery Date < Ship Date'
      * Requested Delivery Date
     I                                    P   1   40ZA0019
      * Message data for 'Time Field GT 24 Hours'
      * Requested Delivery Time
     I                                    P   1   30ZA0020
      * Message data for 'Time field minutes GT 59'
      * Requested Delivery Time
     I                                    P   1   30ZA0021
      * Message data for 'Req Ship Date < Job Date'
      * Requested Ship Date
     I                                    P   1   40ZA0022
      * Message data for 'Req Shp Dte GT Sch Shp DT'
      * Requested Ship Date
     I                                    P   1   40ZA0023
      * Scheduled Ship Date
     I                                    P   5   80ZA0024
      * Message data for 'Requested Ship Date can n'
      * Must Ship Date        USR
     I                                    P   1   40ZA0025
      * Message data for 'Invalid Dt Chg-DDD/T err2'
      * Scheduled Delivery Time
     I                                    P   1   40ZA0026
      * Message data for 'Invalid Deadln Dt/Tm'
      * Requested Delivery Date
     I                                    P   1   40ZA0027
      * Message data for 'Market cust req f/whs loc'
      * Warehouse Code
     I                                        1   3 ZA0028
      * Message data for 'Market cust/whse not val'
      * Warehouse Code
     I                                        1   3 ZA0029
      * Message data for 'Warehouse loc cant change'
      * Warehouse Code
     I                                        1   3 ZA0030
      * Company Number
     I                                        4   6 ZA0031
      * Message data for 'Warehouse must be ext'
      * Warehouse Code
     I                                        1   3 ZA0032
      * Message data for 'To Warehouse must be diff'
      * Warehouse Code
     I                                        1   3 ZA0033
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
     C           P3HHST    PARM           WP0003  1        Access Limited
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Check passed parameters
     C                     EXSR FACKPM
      * Perform once if all passed, else repeat
     C           W0RPT     DOUEQ'N'
      * Display and process key screen
     C                     EXSR BADSKY
     C                     END
      * Terminate program
     C                     EXSR ZXEXPG
      *****************************************************************
      /EJECT
     CSR         BADSKY    BEGSR
      *================================================================
      * Display and process key screen
      *================================================================
      * Bypass first display of key screen is possible
     C                     MOVEL'Y'       W0BYP   1
      * Initialize key screen
     C                     EXSR MDIZ#K
      * Signal start of transaction
     C                     MOVEL'Y'       W0TRN   1
     C           W0TRN     DOWEQ'Y'
     C           W0TRN     OREQ 'K'
      * Ensure transaction continues (if reset)
     C                     MOVEL'Y'       W0TRN   1
      * Conduct screen conversation
     C           W0TRN     DOWEQ'Y'
      * Convert internal to external form
     C                     EXSR MNCV#K
      * Is bypass key screen still viable?
     C           W0BYP     IFEQ 'Y'
     C           #1AIC3    IFEQ *ZERO                      Company Number
     C           #1C4NB    OREQ *ZERO                      Order Number
      * One or more key fields is blank
     C           *IN30     OREQ '1'
      * HOME: Reset screen fields
     C                     MOVEL'N'       W0BYP
     C                     END
     C                     END
      * Bypass key screen
     C           W0BYP     IFEQ 'N'
      * Display key screen
     C                     EXSR BBEXFM
     C                     END
      * Cancel key screen bypass
     C                     MOVEL'N'       W0BYP
      * Process response to key screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   30                CAS            BDHMKY
      * Reposition window
     C   26                CAS            ZRRPWD
      * Process key screen input
     C                     CAS            BEPRKY
     C                     END
     C           W0TRN     DOWEQ'R'
     C                     MOVEL'Y'       W0TRN
     C                     EXSR BEPRKY
     C                     END
      *
     C                     END
     C                     END
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBEXFM    BEGSR
      *================================================================
      * Display key screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSAK
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
     C                     Z-ADD1         YWPNNO  10       Panel number
     C                     MOVEL'R'       YWLCTP  1        Locate action t
     C                     EXSR ZSSTLC                     Set window loca
     C                     Z-ADD1         W0WASM  10
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDKEY
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1
      * Reset global error indicator
     C                     SETOF                         99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         BDHMKY    BEGSR
      *================================================================
      * Process HOME key
      *================================================================
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         BDEXIT    ENDSR
      /EJECT
     CSR         BEPRKY    BEGSR
      *================================================================
      * Process key screen input
      *================================================================
      * Initialise detail screen
     C                     EXSR MAIZ#1
      * Validate key fields
     C                     EXSR BFVLKY
     C           *IN99     CABEQ'1'       BEEXIT
     C           YPMTFD    CABNE*BLANKS   BEEXIT
      * Check for existing record
     C           KRTV      KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    BEAIC3
     C                     Z-ADD#1C4NB    BEC4NB
     C           KRTV      CHAIN@BECPFK              9091  *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     SETON                     993132*
     C                     GOTO BEEXIT
     C                     END                             FI 91
      *
      * If record does not exist, error
     C           *IN90     IFEQ '1'
     C                     SETON                     993132*
      * Send message 'Order Header TRG       NF'
     C                     MOVEL'USR0176' ZAMSID
     C                     EXSR ZASNMS
     C                     ELSE
     C                     EXSR MBFL#1
      * USER: Initialize detail screen (existing record)
      * CHG Order in Use       CH - Order Header TRG  * 
     C                     EXSR SACHRC
      * S17054 DN 04/07/21-Count Cases as Boxes. Replaced function with
      *   'RTV UM/Whs Code-Add CS RT'.
      * RTV UM/Whs Code-Add CS RT - Order Detail  * 
     C                     EXSR SBRVGN
      * RTV Whse Descrip       RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DAJCD    WL0004    P      Warehouse Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    #DF8NA    P      Warehouse Descr
      * RTV Warehouse Location RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DAJCD    WL0006    P      Warehouse Code
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    P6T0ST    P      Warehouse Locat
      * E5557 JJH 04/08/16 - Retrieve current Wareshouse Shipping Company
      * Rtv Warehouse SHP     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DAJCD    WL0008    P      Warehouse Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0009    YN0001    P      Trans Contol AS
     C                     MOVELWL0010    YN0002    P      Warehouse Locat
     C                     Z-ADDWL0011    YL0004           Shipping Compan
     C                     Z-ADDWL0012    YN0003           Accounting Comp
     C                     MOVELWL0013    YN0004    P      WHS Live w/Carl
     C                     MOVEL#DAJCD    #DCPCD           USR Warehouse C
     C                     Z-ADD#1AODT    #DHODT           Scheduled Ship
     C                     Z-ADD#1EIDT    #DK3DT           USR Requested D
      * E5557 JJH 04/08/16 Save initial Requested Delivery Time
     C                     Z-ADD#1AFTM    YL0005           Requested Deliv
     C                     Z-ADD#1AFTM    #DTMPK           Sched Delivery
      * E3796 JJH 03/02/15 - Save Requested Ship Date
     C                     Z-ADD#1A5DT    #DGYDT           Requested Ship
      * CASE: DTL.U/M - Ordered is Mixed
     C           #DAGCD    IFEQ 'MX'                       *IF
     C                     MOVEL*BLANK    #DHLTX           Condition Desc.
     C                     MOVEL'Mixed'   #DHLTX           Condition Desc.
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv UOM Description    RT - Unit of Measure  * 
     C                     EXSR SGRVGN
     C                     END                             *FI
     C                     Z-ADD#1C4NB    WUC4NB           Order Number
     C                     Z-ADD#1AIC3    WUAIC3           Company Number
      * ** Save Ship To City and State for DDD/T testing      W288
     C                     MOVELBEHNNA    WUAJNA           City
     C                     MOVELBEDBCD    WUBGCD           State Code
      * CLC Deadln Depart Dt  XF - Order Header TRG  * 
     C                     CALL 'POSCXFR'              90  CLC Deadln Depa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0001  30       Company Number
     C                     PARM #1C4NB    WQ0002  70       Order Number
     C                     PARM WUAJNA    WQ0003 20        City
     C                     PARM WUBGCD    WQ0004  2        State Code
     C                     PARM #1EIDT    WQ0005  70       Requested Deliv
     C                     PARM #1AFTM    WQ0006  40       Requested Deliv
     C           #DKZDT    PARM *ZERO     WQ0007  70       Deadline Depart
     C           #DAXTM    PARM *ZERO     WQ0008  60       Deadline Depart
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POSCXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993234*
     C                     END
     C                     MOVELBEFVSX    #1FVSX           OH Load Plan Re
      * ** Default DDD/T for exports w/no state code          W288
      * CASE: DTL.Deadline Departure Date is not entered
     C           #DKZDT    IFEQ *ZERO                      *IF
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.State Code is International Accounts
      *   |- c2    : DTL.Export Status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUBGCD    IFEQ '.'                        *IF
     C           #1U2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD#1AODT    #DKZDT           Deadline Depart
     C                     Z-ADD80000     #DAXTM           Deadline Depart
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DTL.Deadline Departure Date is not entered
     C           #DKZDT    IFEQ *ZERO                      *IF
     C                     Z-ADD#1AODT    #DKZDT           Deadline Depart
     C                     END                             *FI
      * CASE: DTL.Deadline Departure Time is Not Entered
     C           #DAXTM    IFEQ *ZERO                      *IF
     C                     Z-ADD80000     #DAXTM           Deadline Depart
     C                     END                             *FI
     C                     END
      *
      *..................................................
     C   99                GOTO BEEXIT
      *
     C           YPMTFD    IFEQ *BLANK
      * No error: Display and process details
     C                     EXSR CADSDA
     C                     END
      *
      *================================================================
     CSR         BEEXIT    ENDSR
      /EJECT
     CSR         BFVLKY    BEGSR
      *================================================================
      * Validate key fields
      *================================================================
      * Validate Company Number and convert to internal.
      * CD3 Ext/Int
     C                     MOVELV1AIC3    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC3  3
     C                     MOVEA*BLANKS   K3
     C                     Z-ADD3         C       30
     C                     Z-ADD3         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUDMCD    J3
     C                     MOVE *BLANKS   W0RTN
     C                     DO   3
     C           J3,C      IFNE ' '
     C                     MOVEAJ3,C      K3,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK3        JUSTC3
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC3    TESTC   1
     C           TESTC     IFGT '?'
     C           TESTC     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC3     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC3    WUDMCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Send message 'CD3 Non numeric data'
     C                     MOVEL'USR0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #1AIC3           CD3 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUDMCD    #1AIC3           CD3 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Order Number and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV1C4NB    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #1C4NB           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #1C4NB           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
     C           YPMTFD    IFNE *BLANK
      * Select existing record
     C                     EXSR VACKRL
     C                     END
      * Check relations
      * Check reference to Company Name and Address
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9931  *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate key screen
      * New 5/30/02
      * RTV Order in Use       RT - Order Header TRG  * 
     C                     EXSR SHRVGN
      * RTV Co. Dflt Int All,O XF - Company Defaults Internal  * 
     C                     CALL 'PMRMXFR'              90  RTV Co. Dflt In
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0012  30       Company Number
     C           WUG0TX    PARM *BLANK    WQ0013  2        Shipping Method
     C           WUG0TX    PARM *BLANK    WQ0014  1        Load Type Dft
     C           WUG0TX    PARM *BLANK    WQ0015  1        LTL Flag Dft
     C           WUG0TX    PARM *BLANK    WQ0016  1        Export Status D
     C           WUG0TX    PARM *BLANK    WQ0017  1        Shrink Wrap Dft
     C           WUNFNN    PARM *ZERO     WQ0018  40       Departure Time
     C           WUG0TX    PARM *BLANK    WQ0019  6        Export Code Dft
     C           WUHSST    PARM *BLANK    WQ0020  1        Allow Mult Whse
     C           WUG0TX    PARM *BLANK    WQ0021  1        Allow Multi Exp
     C           WUG0TX    PARM *BLANK    WQ0022  1        Slip Sheet Dft
     C           WUG0TX    PARM *BLANK    WQ0023  1        Palletize Dft
     C           P5YJSX    PARM *BLANK    WQ0024  1        Company Organiz
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMRMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * Validate Option
      * CASE: LCL.Order in Use is yes
     C           YL0006    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVELWUSEL     ZA0001           *SFLSEL
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0002           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0002           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order in use detail'
     C                     MOVEL'USR0664' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     MOVEL'Y'       P2ECST           Error Status
     C                     ELSE
      * CASE: LCL.Header Status is Cancelled
     C           YL0007    IFEQ 'X'                        *IF
      * Setup message data for message
     C                     MOVELWUSEL     ZA0003           *SFLSEL
      * Send message 'Order has been Cancelled'
     C                     MOVEL'USR2341' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'Y'       P2ECST           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * Validate Load Status - won't be tested if Live w/TPM  E004119
      * CASE: LCL.Load ID is NE Blank
     C           YL0008    IFNE *ZERO                      *IF
      * RTV Load Status        RT - Load Header  * 
     C                     EXSR SIRVGN
      * lock/unlck
      * CASE: LCL.Load Status is Locked thru Invoiced
     C           YL0009    IFEQ 'I'                        *IF
     C           YL0009    OREQ 'L'
     C           YL0009    OREQ 'S'
      * CASE: PAR.Company Organization is Not HPB
     C           P5YJSX    IFEQ 'D'                        *IF
     C           P5YJSX    OREQ 'S'
      * Setup message data for message
     C                     MOVELWUSEL     ZA0004           *SFLSEL
      * Send message 'Load Locked Opt Invalid'
     C                     MOVEL'USR2308' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'Y'       P2ECST           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * If HPB allow change to locked load     9/05/08
      * CASE: LCL.Load Status is Lock
     C           YL0009    IFEQ 'L'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVELWUSEL     ZA0005           *SFLSEL
      * Send message 'Load Locked Opt Invalid'
     C                     MOVEL'USR2308' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'Y'       P2ECST           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.Load Status is Unlock
     C           YL0009    IFEQ 'U'                        *IF
      * RMC S00787 dont allow on load atall 5/1/09
      * Setup message data for message
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0006           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0006           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order On Load Opt Invald'
     C                     MOVEL'USR2331' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0007           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0007           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order On Load Opt Invald'
     C                     MOVEL'USR2331' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * Company Number required
     C           #1AIC3    IFEQ *ZERO                      IF
     C           *IN79     ANDEQ'0'
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Order Number required
     C           #1C4NB    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9932  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         BFEXIT    ENDSR
      /EJECT
     CSR         CADSDA    BEGSR
      *================================================================
      * Display and process detail screen
      *================================================================
      * Conduct detail screen conversation
      * - repeat until screen control flag is reset:
     C           W0TRN     DOWEQ'Y'
      * Convert internal to external form
     C                     EXSR MOCV#D
      * Display detail screen
     C                     EXSR CBEXFM
      * Process response to detail screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * Redisplay previous screen
     C   12                CAS            CCDSPV
      * HOME: Reset screen fields
     C   30                CAS            CCDSPV
      * Reposition window
     C   26                CAS            ZRRPWD
      * Process detail screen input
     C                     CAS            CFPRSC
     C                     END
     C           W0TRN     IFEQ 'R'
     C           W0PMD     IFEQ 'ADD'
     C                     EXSR MAIZ#1
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         CBEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
     C                     Z-ADD2         YWPNNO  10       Panel number
     C                     MOVEL'R'       YWLCTP  1        Locate action t
     C                     EXSR ZSSTLC                     Set window loca
     C                     Z-ADD2         W0WASM  10
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y1SET
     C                     END
     C                     WRITE#MSGCTL1
     C                     WRITE#CMDTXT2
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1
      * Reset global error indicator
     C                     SETOF                         99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CBEXIT    ENDSR
      /EJECT
     CSR         CCDSPV    BEGSR
      *================================================================
      * Redisplay previous screen
      *================================================================
     C   30                MOVEL'R'       W0TRN
     C   12                MOVEL'K'       W0TRN
      *================================================================
     CSR         CCEXIT    ENDSR
      /EJECT
     CSR         CFPRSC    BEGSR
      *================================================================
      * Validate record
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate details
     C                     EXSR DCVLDL
      * QUIT if error:
     C   99                GOTO CFEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       CFEXIT
      * Prompt for confirmation
     C                     EXSR EAPMCF
      * Quit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO CFEXIT
     C                     END
      * No error: update record
     C                     EXSR EBPR##
      *================================================================
     CSR         CFEXIT    ENDSR
      /EJECT
     CSR         DCVLDL    BEGSR
      *================================================================
      * Validate details
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Validate Scheduled Ship Date
      * External date
     C                     Z-ADDV1AODT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     Z-ADDXDINDT    #1AODT
      * Validate Requested Delivery Date
      * External date
     C                     Z-ADDV1EIDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
     C                     Z-ADDXDINDT    #1EIDT
      * Validate Requested Ship Date
      * External date
     C                     Z-ADDV1A5DT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9933  *
     C                     END
     C                     Z-ADDXDINDT    #1A5DT
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate detail screen fields
      * E5557 JJH 04/08/16 - Select Record by Warehouse Shipping Company
      * SEL: Warehouse Code by Shipping Company
      * CASE: CTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * CASE: PGM.*Cursor field <IS> DTL.Warehouse Code
     C           W0CFL     IFEQ '#DAJCD'                   *IF
      * Sel Warehouse Shp Com IF
      * CASE: PAR.Application WHS Restrict is yes
     C           YL0010    IFEQ 'Y'                        *IF
      * Sel User Appl Whs     SR - User Application Whs  * 
     C                     CALL 'PNMMSRR'              90  Sel User Appl W
     C                     PARM *BLANK    W0RTN   7
     C                     PARM ##USR     WQ0025 10        User Profile Na
     C                     PARM 'O/P'     WQ0026  6        Application Cod
     C           #DAJCD    PARM #DAJCD    WQ0027  3        Warehouse Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNMMSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9935  *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * SEL Warehouse Shp Com SR - Warehouse  * 
     C                     CALL 'PBWXSRR'              90  SEL Warehouse S
     C                     PARM *BLANK    W0RTN   7
     C           #DAJCD    PARM #DAJCD    WQ0028  3        Warehouse Code
     C                     PARM YL0004    WQ0029  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBWXSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9935  *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * E5557 JJH 04/08/16 - Whse change must be same Shipping Company
      * SNDERRMSG if changed Warehouse not in same Shipping Company
      * CASE: DTL.Warehouse Code NE DTL.USR Warehouse Code
     C           #DAJCD    IFNE #DCPCD                     *IF
      * Rtv Warehouse SHP     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DAJCD    WL0008    P      Warehouse Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0009    YN0001    P      Trans Contol AS
     C                     MOVELWL0010    YN0002    P      Warehouse Locat
     C                     Z-ADDWL0011    YL0011           Shipping Compan
     C                     Z-ADDWL0012    YN0003           Accounting Comp
     C                     MOVELWL0013    YN0004    P      WHS Live w/Carl
      * CASE: LCL.Shipping Company NE LCL.Shipping Company USR
     C           YL0011    IFNE YL0004                     *IF
      * Setup message data for message
     C                     MOVEL#DAJCD    ZA0008           Warehouse Code
      * Convert Shipping Company USR to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           YL0004    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVELYL0004    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0009           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0009           CD3 Ext Numeric
     C                     END                             *FI
      * Send message 'Shipping Company Changed'
     C                     MOVEL'USR4919' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Val Warehouse         IF
      * VAL: Warehouse Code
      * CASE: PAR.Application WHS Restrict is yes
     C           YL0010    IFEQ 'Y'                        *IF
      * CASE: PAR.Warehouse Code is Blanks
     C           #DAJCD    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DAJCD    ZA0010           Warehouse Code
      * Send message 'Warehouse Code Required'
     C                     MOVEL'USR2015' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * Val App Whs Itm Acs   XF - User Profile Control  * 
     C                     CALL 'PNMOXFR'              90  Val App Whs Itm
     C                     PARM *BLANK    W0RTN   7
     C                     PARM ##USR     WQ0030 10        User Profile Na
     C                     PARM 'O/P'     WQ0031  6        Application Cod
     C                     PARM #DAJCD    WQ0032  3        Warehouse Code
     C                     PARM *ZERO     WQ0033  70       Item Code
     C           YL0012    PARM *BLANK    WQ0034  1        WHS/Item Access
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNMOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9935  *
     C                     END
      * CASE: LCL.WHS/Item Access Sts USR is Access Denied
     C           YL0012    IFEQ 'D'                        *IF
      * Setup message data for message
     C                     MOVEL##USR     ZA0011           *USER
     C                     MOVEL#DAJCD    ZA0012           Warehouse Code
      * Send message 'Access Denied: Warehouse'
     C                     MOVEL'USR2776' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Warehouse Code is Not Blanks
     C           #DAJCD    IFNE *BLANK                     *IF
      * Val Warehouse Exists   RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DAJCD    WL0014    P      Warehouse Code
     C                     EXSR SJRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,002                    *IF
      * Setup message data for message
     C                     MOVEL#DAJCD    ZA0013           Warehouse Code
      * Send message 'Warehouse              NF'
     C                     MOVEL'USR0007' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Edit Scheduled Ship Date
      * CASE: DTL.Scheduled Ship Date LT JOB.*Job date
     C           #1AODT    IFLT ##JDT                      *IF
      * Setup message data for message
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #1AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0014
      * Convert *Job date to display format
      * Convert date
     C           1000000   ADD  ##JDT     XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0015
      * Send message 'Date => Job Date'
     C                     MOVEL'USR2018' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.Scheduled Ship Date GT DTL.Requested Delivery Da
      *   |- c2    : DTL.Requested Delivery Date is entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1AODT    IFGT #1EIDT                     *IF
     C           #1EIDT    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  #1EIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0016
      * Send message 'Delivery Date < Ship Date'
     C                     MOVEL'USR2063' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Edit Requested Delivery Date cannot be before sched ship date
      * CASE: DTL.Requested Delivery Date LT JOB.*Job date
     C           #1EIDT    IFLT ##JDT                      *IF
      * Setup message data for message
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  #1EIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0017
      * Convert *Job date to display format
      * Convert date
     C           1000000   ADD  ##JDT     XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0018
      * Send message 'Date => Job Date'
     C                     MOVEL'USR2018' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.Requested Delivery Date LT DTL.Scheduled Ship Da
      *   |- c2    : DTL.Requested Delivery Date is entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1EIDT    IFLT #1AODT                     *IF
     C           #1EIDT    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  #1EIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0019
      * Send message 'Delivery Date < Ship Date'
     C                     MOVEL'USR2063' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * 01/18/18 DN T12340-Req Delivery Time cannot exceed 2400 or 59 for
      * CASE: DTL.Requested Delivery Time is Entered
     C           #1AFTM    IFNE 0                          *IF
      * CASE: DTL.Requested Delivery Time is GT 24 Hour Day
     C           #1AFTM    IFGT 2400                       *IF
      * Setup message data for message
     C                     Z-ADD#1AFTM    ZA0020           Requested Deliv
      * Send message 'Time Field GT 24 Hours'
     C                     MOVEL'USR1712' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9934  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C           #1AFTM    DIV  100       YRWF00           *Modulo work fi
     C                     MVR            YL0013           USR Remainder
      * CASE: LCL.USR Remainder is GT 59 Minutes
     C           YL0013    IFGT 59                         *IF
      * Setup message data for message
     C                     Z-ADD#1AFTM    ZA0021           Requested Deliv
      * Send message 'Time field minutes GT 59'
     C                     MOVEL'USR2175' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9934  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Edit Requested Ship Date
      * CASE: DTL.Requested Ship Date LT JOB.*Job date
     C           #1A5DT    IFLT ##JDT                      *IF
      * Setup message data for message
      * Convert Requested Ship Date to display format
      * Convert date
     C           1000000   ADD  #1A5DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0022
      * Send message 'Req Ship Date < Job Date'
     C                     MOVEL'USR4797' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     ELSE
      * CASE: DTL.Requested Ship Date GT DTL.Scheduled Ship Date
     C           #1A5DT    IFGT #1AODT                     *IF
      * Setup message data for message
      * Convert Requested Ship Date to display format
      * Convert date
     C           1000000   ADD  #1A5DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0023
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #1AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0024
      * Send message 'Req Shp Dte GT Sch Shp DT'
     C                     MOVEL'USR4781' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993331*
      *
     C                     END                             *FI
     C                     END                             *FI
      * RTV Whse Descrip       RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DAJCD    WL0004    P      Warehouse Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    #DF8NA    P      Warehouse Descr
      * ** error if no mileage record                        FP1251
      * Ensure that dates are in correct sequence
      * CASE: DTL.Shipping Method is Buyers Truck
     C           #1Q2CD    IFEQ 'CR'                       *IF
     C           #1Q2CD    OREQ 'CT'
      *        don't edit dates for buyers truck orders/loads
     C                     ELSE
      * CASE: DTL.Scheduled Ship Date LT JOB.*Job date
     C           #1AODT    IFLT ##JDT                      *IF
      * this is already an error
     C                     ELSE
      * CASE: Either SSD or whs or RDD has changed
      *  - c1 OR c2 OR c3
      *   |- c1    : DTL.Scheduled Ship Date USR NE DTL.Scheduled Ship Da
      *   |- c2    : DTL.USR Warehouse Code NE DTL.Warehouse Code
      *   |- c3    : DTL.USR Requested Deliver Dte NE DTL.Requested Deliv
      *   '-
     C           #DHODT    IFNE #1AODT                     *IF
     C           #DCPCD    ORNE #DAJCD                     *OR
     C           #DK3DT    ORNE #1EIDT                     *OR
      * CLC Must Ship Date     XF - Order Header TRG  * 
     C                     CALL 'PDJBXFR'              90  CLC Must Ship D
     C                     PARM *BLANK    W0RTN   7
     C           WUB7SX    PARM *BLANK    WQ0035  3        Must Ship Error
     C                     PARM #1C4NB    WQ0036  70       Order Number
     C                     PARM #1A5DT    WQ0037  70       Requested Ship
     C                     PARM #1HNNA    WQ0038 20        Ship To City
     C                     PARM #1DBCD    WQ0039  2        Ship To State C
     C                     PARM #1AIC3    WQ0040  30       Company Number
     C                     PARM #1RMNB    WQ0041  70       Load ID
     C                     PARM #1AFTM    WQ0042  40       Requested Deliv
     C                     PARM #1AODT    WQ0043  70       Scheduled Ship
     C                     PARM #1EIDT    WQ0044  70       Requested Deliv
     C           #DAJCD    PARM #DAJCD    WQ0045  3        Warehouse Code
     C           WULYDT    PARM WULYDT    WQ0046  70       Must Ship Date
     C           WUA5TM    PARM WUA5TM    WQ0047  60       Must Ship Time
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDJBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993334*
     C                     SETON                     313235*
     C                     END
      * Process date order error for must ship
      * CASE:
      *  - (c1 OR c2 OR c3)
      *   |- c1    : WRK.Must Ship Error is No Error
      *   |- c2    : WRK.Must Ship Error is Miles to Next=Zeros
      *   |- c3    : WRK.Must Ship Error is Req Ship should =Must Shp
      *   '-
     C           WUB7SX    IFEQ *BLANK                     *IF
     C           WUB7SX    OREQ 'MTN'                      *OR
     C           WUB7SX    OREQ 'RSD'                      *OR
      * RMC rmv 'AND live with tpm=Not Live'  chk  9/29/16
     C                     ELSE
      * CASE: *OTHERWISE
      * PMT Must Ship Dt Accpt IF - PD Order Header  * 
     C                     EXSR SKINFN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CLC Deadln Depart Dt  XF - Order Header TRG  * 
     C                     CALL 'POSCXFR'              90  CLC Deadln Depa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0056  30       Company Number
     C                     PARM #1C4NB    WQ0057  70       Order Number
     C                     PARM WUAJNA    WQ0058 20        City
     C                     PARM WUBGCD    WQ0059  2        State Code
     C                     PARM #1EIDT    WQ0060  70       Requested Deliv
     C                     PARM #1AFTM    WQ0061  40       Requested Deliv
     C           #DKZDT    PARM *ZERO     WQ0062  70       Deadline Depart
     C           #DAXTM    PARM *ZERO     WQ0063  60       Deadline Depart
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POSCXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993234*
     C                     END
      * ** If export and no state, put new SSD into DDD       W288
      * CASE: DTL.Export Status is yes
     C           #1U2ST    IFEQ 'Y'                        *IF
      * CASE: DTL.Ship To State Code is International Accounts
     C           #1DBCD    IFEQ '.'                        *IF
     C                     Z-ADD#1AODT    #DKZDT           Deadline Depart
     C                     Z-ADD80000     #DAXTM           Deadline Depart
     C                     MOVEL*BLANK    WUB7SX           Must Ship Error
     C                     END                             *FI
     C                     END                             *FI
      * Deadline Departure Date/Time and Shipping Restrictions  W288
     C                     EXSR UASUBR                     Deadline Depart
      * HPB Only - check whse vs. customer type, and vs. orig whse locati
      * CASE: PAR.Company Organization is High Plains Biodiesel
     C           P5YJSX    IFEQ 'H'                        *IF
      * Rtv Customer Type     RT - Company Customer  * 
     C                     EXSR SLRVGN
      * Rtv Acct&Ship Co      RT - Warehouse  * 
     C                     EXSR SMRVGN
      * Rtv HPB fields        RT - Warehouse  * 
     C                     EXSR SNRVGN
      * HPB Only - P00579 if ship co <> acctng co, then ship to whse is r
      * CASE: WRK.Shipping Company NE WRK.Accounting Company
     C           WUBWC3    IFNE WUBTC3                     *IF
      * Prevent shipping from hp1/hp2 directly to musket/outside
      * CASE: WRK.Type Code is Marketing
     C           WUBOCD    IFEQ 'MK'                       *IF
      * hpb biodiesel cust will be a MK type
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DAJCD    ZA0028           Warehouse Code
      * Send message 'Market cust req f/whs loc'
     C                     MOVEL'USR4246' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.Type Code is Marketing
     C           WUBOCD    IFEQ 'MK'                       *IF
      * CASE: DTL.Order Type - Sales is Not a Transfer Order
     C           #1JNCD    IFNE 'TR'                       *IF
      * Setup message data for message
     C                     MOVEL#DAJCD    ZA0029           Warehouse Code
      * Send message 'Market cust/whse not val'
     C                     MOVEL'USR4247' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD*ZERO     YL0017           Count USR
      * RTV Count for BOL     RT - Manifest Detail  * 
     C                     EXSR SORVGN
      * If location is changing, or both are External, dont allow
      * CASE:
      *  - c1ORc2
      *   |- c1    : LCL.Warehouse Location NE PAR.Warehouse Location
      *   |- c2    : LCL.Warehouse Location is External
      *   '-
     C           YL0015    IFNE P6T0ST                     *IF
     C           YL0015    OREQ 'E'                        *OR
      * If manifest dtl exists, dont allow chg
      * CASE: LCL.Count USR is GE 1
     C           YL0017    IFGE 1                          *IF
      * Setup message data for message
     C                     MOVEL#DAJCD    ZA0030           Warehouse Code
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0031           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0031           CD3 Ext Numeric
     C                     END                             *FI
      * Send message 'Warehouse loc cant change'
     C                     MOVEL'USR4538' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * HPB Transfer order tests
      * CASE: DTL.Order Type - Sales is Transfer Order
     C           #1JNCD    IFEQ 'TR'                       *IF
      * CASE: LCL.Warehouse Location is Internal (Plant)
     C           YL0015    IFEQ 'I'                        *IF
      * Setup message data for message
     C                     MOVEL#DAJCD    ZA0032           Warehouse Code
      * Send message 'Warehouse must be ext'
     C                     MOVEL'USR4207' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
      *
     C                     END                             *FI
      * CASE: DTL.Warehouse Code EQ DTL.HPB Ship to Warehouse
     C           #DAJCD    IFEQ #1FXSX                     *IF
      * Setup message data for message
     C                     MOVEL#DAJCD    ZA0033           Warehouse Code
      * Send message 'To Warehouse must be diff'
     C                     MOVEL'USR3654' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * SBD Only - check Ship Date & Requested Delivery in Order Detail
      * CASE: PAR.Company Organization is Seaboard
     C           P5YJSX    IFEQ 'S'                        *IF
     C                     MOVEL'N'       WUTXST           Error Status  3
      * CASE: DTL.Load ID is GT Zero
     C           #1RMNB    IFGT *ZERO                      *IF
      * Val ShpDt Allc By LD  XF - Order Header TRG  * 
     C                     CALL 'PNS0XFR'              90  Val ShpDt Allc
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0069  70       Load ID
     C                     PARM #DHODT    WQ0070  70       Scheduled Ship
     C                     PARM ##PGM     WQ0071 10        Program name US
     C           WUTXST    PARM WUTXST    WQ0072  1        Error Status  3
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNS0XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * CASE: WRK.Error Status  3 is Yes
     C           WUTXST    IFEQ 'Y'                        *IF
      * Send message 'Age Days/OvrDate Invalid'
     C                     MOVEL'USR4355' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * Check relations
      * Check reference to Order Types
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Customer
     C                     EXSR VDCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Customer
     C                     EXSR VECKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to State
     C                     EXSR VFCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Customer
     C                     EXSR VGCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to State
     C                     EXSR VHCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Calendar
     C                     EXSR VICKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Calendar
     C                     EXSR VJCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9933  *
     C                     END
      * Check reference to Calendar
     C                     EXSR VKCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Calendar
     C                     EXSR VLCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Terms
     C                     EXSR VMCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Carrier
     C                     EXSR VNCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to OP Reason Codes
     C                     EXSR VOCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Calendar
     C                     EXSR VPCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9931  *
     C                     END
      * Check reference to User Profile Control
     C                     EXSR VQCKRL
      * Check reference to Calendar
     C                     EXSR VRCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9932  *
     C                     END
      * Check reference to Enterprise Master
     C                     EXSR VSCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Load Header
     C                     EXSR VTCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Sales Route
     C                     EXSR VUCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Manager Level
     C                     EXSR VVCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to VP Level
     C                     EXSR VWCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Order Header TRG
     C                     EXSR VXCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Internal Reason
     C                     EXSR VYCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Calendar
     C                     EXSR VZCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Event Types
     C                     EXSR WACKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to A/R Claim
     C                     EXSR WBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Scheduled Ship Date required
     C           #1AODT    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Requested Delivery Date required
     C           #1EIDT    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9932  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Requested Ship Date required
     C           #1A5DT    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9933  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Requested Delivery Time required
     C           #1AFTM    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9934  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Warehouse Code required
     C           #DAJCD    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9935  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         EAPMCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert internal to external form
     C                     EXSR MOCV#D
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Update screen time
     C                     TIME           ##TME
      * Refresh screen
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     EXSR ZVCFPM
     C                     WRITE#MSGCTL1
     C                     WRITE#CMDTXT2
     C                     WRITE#RCDDTL1
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO EAEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLWR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPR##    BEGSR
      *================================================================
      * Process record:
      *================================================================
      * Process update request
     C           W0PMD     CASNE'ADD'     EECHRQ
     C                     END
     C           W0RTN     IFEQ *BLANK
      * USER: Process command keys
      *    So... the log file needs to be written
      * *
      * RMC E00223 09/05/08 HPB - chg manifest dtl whse if there
      * CASE: PAR.Company Organization is High Plains Biodiesel
     C           P5YJSX    IFEQ 'H'                        *IF
      * CASE: DTL.Warehouse Code NE DTL.USR Warehouse Code
     C           #DAJCD    IFNE #DCPCD                     *IF
      * order detail may have an R sts already, so read ALL details
      * Upd WHS/Alc by Ord 2 RT - Order Detail  * 
     C                     EXSR SPRVGN
      * RTV Chg Whse          RT - Manifest Detail  * 
     C                     EXSR SSRVGN
     C                     END                             *FI
     C                     END                             *FI
      * *
     C                     Z-ADD#1AODT    #DHODT           Scheduled Ship
     C                     MOVEL#DAJCD    #DCPCD           USR Warehouse C
      * *
      * ** Log the change to the Requested Delivery Date, as well  E00127
      * *
     C                     Z-ADD#1EIDT    #DK3DT           USR Requested D
      * Restart program for next record
     C                     MOVEL'N'       W0TRN
     C                     END
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         EECHRQ    BEGSR
      *================================================================
      * Process update request
      *================================================================
      * USER: Change DBF record
      * Upd ShpDtRqDte&Whs/Alc XF - Order Header TRG  * 
     C                     CALL 'PDZMXFR'              90  Upd ShpDtRqDte&
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0146  70       Load ID
     C                     PARM #1AIC3    WQ0147  30       Company Number
     C                     PARM #1AODT    WQ0148  70       Scheduled Ship
     C                     PARM #DAJCD    WQ0149  3        Ship From Wareh
     C                     PARM #1C4NB    WQ0150  70       Order Number
     C                     PARM #1HNNA    WQ0151 20        Ship To City
     C                     PARM #1DBCD    WQ0152  2        Ship To State C
     C                     PARM #1A5DT    WQ0153  70       Requested Ship
     C                     PARM #1EIDT    WQ0154  70       Requested Deliv
     C                     PARM #1AFTM    WQ0155  40       Requested Deliv
     C                     PARM #1FVSX    WQ0156  2        OH Load Plan Re
     C                     PARM #DHODT    WQ0157  70       Scheduled Ship
     C                     PARM #DCPCD    WQ0158  3        USR Warehouse C
     C                     PARM #DK3DT    WQ0159  70       USR Requested D
     C                     PARM YL0005    WQ0160  40       Requested Deliv
     C                     PARM #DTMPK    WQ0161  40       Sched Delivery
     C                     PARM #DGYDT    WQ0162  70       Requested Ship
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDZMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993135*
     C                     SETON                     333234*
     C                     END
     C           W0RTN     IFNE *BLANK
      * Data update error
      * Reset screen fields if changed record
     C           W0RTN     CASEQ'Y2U0007' MBFL#1
     C                     END
     C                     ELSE
     C           YCRDC     IFEQ 'Y'
      * Send message '*Record changed'
     C                     MOVEL'Y2U0012' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *================================================================
     CSR         EEEXIT    ENDSR
      /EJECT
     CSR         FACKPM    BEGSR
      *================================================================
      * Check passed parameters
      *================================================================
      * Is full key present?
     C           P1AIC3    IFEQ *ZERO                      Company Number
     C           P1C4NB    OREQ *ZERO                      Order Number
      * Not every key field passed - loop program
     C                     MOVEL'Y'       W0RPT   1
     C                     ELSE
      * Full key passed, so single shot program
     C                     MOVEL'N'       W0RPT
     C                     END
      *================================================================
     CSR         FAEXIT    ENDSR
      /EJECT
     CSR         GADSAK    BEGSR
      *================================================================
      * Set key screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
     C                     MOVEL'0'       *IN79
     C           P3I6ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSAD    BEGSR
      *================================================================
      * Set detail screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      * Protect key fields on detail screen
     C                     SETON                     88    *
     C                     MOVEL'0'       *IN79
     C           YL0021    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C           W0RPT     IFEQ 'N'
      * Disable key screen - not applicable
     C                     SETOF                     87    *
     C                     ELSE
      * Enable key screen
     C                     SETON                     87    *
     C                     END
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise record - except for key fields and "neither" paramete
      *================================================================
     C                     MOVEL*BLANK    #1FVSX           OH Load Plan Re
     C                     MOVEL*BLANK    #DN8TX           Text-17
     C                     MOVEL*BLANK    #1JNCD           Order Type - Sa
     C                     Z-ADD*ZERO     #1ANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     #1BKC7           Ship To Custome
     C                     MOVEL*BLANK    #1BRTX           Ship To Name
     C                     MOVEL*BLANK    #1HMNA           Ship To Address
     C                     MOVEL*BLANK    #1HONA           Ship To Address
     C                     MOVEL*BLANK    #1HPNA           Ship To Address
     C                     MOVEL*BLANK    #1HNNA           Ship To City
     C                     MOVEL*BLANK    #1DBCD           Ship To State C
     C                     MOVEL*BLANK    #1CKTX           Ship To Zip/Pos
     C                     Z-ADD*ZERO     #1B0C7           Bill to Custome
     C                     MOVEL*BLANK    #1AETX           Bill to Name
     C                     MOVEL*BLANK    #1B1NA           Bill to Address
     C                     MOVEL*BLANK    #1B3NA           Bill to Address
     C                     MOVEL*BLANK    #1B4NA           Bill to Address
     C                     MOVEL*BLANK    #1B2NA           Bill to City
     C                     MOVEL*BLANK    #1BHCD           Bill to State C
     C                     MOVEL*BLANK    #1C8TX           Bill to Zip/Pos
     C                     MOVEL*BLANK    #1BCNA           Customer Purcha
     C                     Z-ADD*ZERO     #1A0DT           Order Date
     C                     Z-ADD*ZERO     #1GNDT           Actual Shipped
     C                     Z-ADD*ZERO     #1ACDT           Cancel Date
     C                     MOVEL*BLANK    #1AQCD           Terms Code
     C                     MOVEL*BLANK    #1B6NA           Special Instruc
     C                     MOVEL*BLANK    #1BYNA           Special Instruc
     C                     MOVEL*BLANK    #1BZNA           Carrier Code
     C                     MOVEL*BLANK    #1GTST           Comment Print A
     C                     MOVEL*BLANK    #1GVST           Comment Print I
     C                     MOVEL*BLANK    #1GUST           Comment Print P
     C                     MOVEL*BLANK    #1QFST           Comment Print S
     C                     MOVEL*BLANK    #1CQCD           Reason Code
     C                     MOVEL*BLANK    #1GJST           Order in Use
     C                     MOVEL*BLANK    #1GWST           Header Status
     C                     MOVEL*BLANK    #1GXST           Header Status L
     C                     MOVEL*BLANK    #1GYST           Order Type Prin
     C                     Z-ADD*ZERO     #DK3DT           USR Requested D
     C                     Z-ADD*ZERO     #DHODT           Scheduled Ship
     C                     MOVEL*BLANK    #DCPCD           USR Warehouse C
     C                     Z-ADD*ZERO     #DGYDT           Requested Ship
     C                     Z-ADD*ZERO     #DTMPK           Sched Delivery
     C                     MOVEL*BLANK    #1AIVN           User Original E
     C                     Z-ADD*ZERO     #1CXDT           Date of Origina
     C                     Z-ADD*ZERO     #1JZVA           Order Value Tot
     C                     Z-ADD*ZERO     #1A1WG           Order Weight To
     C                     MOVEL*BLANK    #1XIST           Credit Hold
     C                     MOVEL*BLANK    #1XJST           Production Hold
     C                     MOVEL*BLANK    #1XKST           New Customer Ho
     C                     MOVEL*BLANK    #1E8CD           Accounts Receiv
     C                     MOVEL*BLANK    #1E9CD           Accounts Receiv
     C                     Z-ADD*ZERO     #1RMNB           Load ID
     C                     Z-ADD*ZERO     #1TBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     #1R1NB           Rated Freight
     C                     MOVEL*BLANK    #1PJST           LTL Flag
     C                     MOVEL*BLANK    #1U0ST           Price Audit
     C                     MOVEL*BLANK    #1U1ST           Price Status
     C                     MOVEL*BLANK    #1Q2CD           Shipping Method
     C                     MOVEL*BLANK    #1VEST           Palletize
     C                     MOVEL*BLANK    #1VFST           Shrink Wrap
     C                     MOVEL*BLANK    #1VGST           Slip Sheet
     C                     MOVEL*BLANK    #1RPCD           Age Code
     C                     Z-ADD*ZERO     #1RNNB           Reefer Temperat
     C                     MOVEL*BLANK    #1VDST           Load Type
     C                     Z-ADD*ZERO     #1ATIN           Attach to Invoi
     C                     MOVEL*BLANK    #1U4ST           Load Plan Order
     C                     MOVEL*BLANK    #1U5ST           Print Pick Slip
     C                     Z-ADD*ZERO     #1RSRN           Resell Referenc
     C                     MOVEL*BLANK    #1MHNA           Special Comment
     C                     MOVEL*BLANK    #1MINA           Special Comment
     C                     MOVEL*BLANK    #1WBST           Affect Auto Acc
     C                     MOVEL*BLANK    #1R4CD           Sales Route Cod
     C                     MOVEL*BLANK    #1BFCD           Manager Level C
     C                     MOVEL*BLANK    #1Q4CD           VP Level Code
     C                     Z-ADD*ZERO     #1T3NB           Attach to Order
     C                     MOVEL*BLANK    #1SICD           Reason for Pric
     C                     Z-ADD*ZERO     #1CONB           Invoice Number
     C                     MOVEL*BLANK    #1CEST           Invoice Suffix
     C                     Z-ADD*ZERO     #1AWDT           Invoice Date
     C                     MOVEL*BLANK    #1JPCD           Event Code
     C                     MOVEL*BLANK    #1XUST           Trans Contol AS
     C                     MOVEL*BLANK    #1Z1ST           Modified Flag
     C                     Z-ADD*ZERO     #1VRVA           A/R order Value
     C                     MOVEL*BLANK    #1OBST           Billing Activit
     C                     MOVEL*BLANK    #1BCST           Block Order Fla
     C                     MOVEL*BLANK    #1BDST           Order Certifica
     C                     Z-ADD*ZERO     #1B7VL           Invoice Order V
     C                     MOVEL*BLANK    #1GASX           Process Sts for
     C                     MOVEL*BLANK    #1GBSX           Order Conf Fax
     C                     MOVEL*BLANK    #1GCSX           Manifest Fax St
     C                     MOVEL*BLANK    #1GDSX           Invoice Fax Sts
     C                     MOVEL*BLANK    #1FNSX           Transfer in Sto
     C                     MOVEL*BLANK    #1FOSX           Email Cust On O
     C                     MOVEL*BLANK    #1FPSX           Order Emailed
     C                     MOVEL*BLANK    #1FQSX           Export Docs Go
     C                     MOVEL*BLANK    #1FRSX           Shipping Temp C
     C                     MOVEL*BLANK    #1FSSX           Broker Order St
     C                     MOVEL*BLANK    #1FTSX           Air Freight Ord
     C                     MOVEL*BLANK    #1FUSX           Order Requires
     C                     MOVEL*BLANK    #1FWSX           Export USDA App
     C                     MOVEL*BLANK    #1FXSX           HPB Ship to War
     C                     MOVEL*BLANK    #1FYSX           OH TF Exempt Co
     C                     Z-ADD*ZERO     #1NODT           OH Appt Confirm
     C                     Z-ADD*ZERO     #1NPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     #1NQDT           Load Actual Shi
     C                     Z-ADD*ZERO     #1NRDT           Load BOL Comple
     C                     Z-ADD*ZERO     #1NSDT           Load Truck Depa
     C                     Z-ADD*ZERO     #1BPTM           Maximum Gross W
     C                     Z-ADD*ZERO     #1BQTM           Time of Origina
     C                     Z-ADD*ZERO     #1BRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     #1BSTM           Load BOL Comple
     C                     Z-ADD*ZERO     #1BTTM           Load Truck Depa
     C                     Z-ADD*ZERO     #1H0NX           Act Frt Referen
     C                     Z-ADD*ZERO     #1H1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     #1H2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     #1H3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     #1H4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     #1C0C7           Claim Number
     C                     MOVEL*BLANK    #1UVST           EDI Status 1
     C                     MOVEL*BLANK    #1UWST           EDI Status 2
     C                     MOVEL*BLANK    #1UXST           EDI Status 3
     C                     Z-ADD*ZERO     #1AATM           Job Time
     C                     MOVEL*BLANK    #1AYNA           User Id
     C                     MOVEL*BLANK    #1A0NA           Job Name
     C                     Z-ADD*ZERO     #1AXDT           Job Date
     C                     MOVEL*BLANK    #1U2ST           Export Status
     C                     MOVEL*BLANK    #DAGCD           U/M - Ordered
     C                     MOVEL*BLANK    #DHLTX           Condition Desc.
     C                     Z-ADD*ZERO     #DKZDT           Deadline Depart
      * Clear external version also
     C                     Z-ADD*ZERO     VDKZDT
     C                     Z-ADD*ZERO     #DAXTM           Deadline Depart
     C                     Z-ADD*ZERO     #1AODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V1AODT
     C                     Z-ADD*ZERO     #1EIDT           Requested Deliv
      * Clear external version also
     C                     Z-ADD*ZERO     V1EIDT
     C                     Z-ADD*ZERO     #1A5DT           Requested Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V1A5DT
     C                     Z-ADD*ZERO     #1AFTM           Requested Deliv
     C                     MOVEL*BLANK    #DAJCD           Warehouse Code
     C                     MOVEL*BLANK    #DF8NA           Warehouse Descr
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @BECPFK fields to screen
      *================================================================
     C                     MOVELBEFVSX    #1FVSX           OH Load Plan Re
     C                     MOVELBEJNCD    #1JNCD           Order Type - Sa
     C                     Z-ADDBEANC7    #1ANC7           A/R Customer Nu
     C                     Z-ADDBEBKC7    #1BKC7           Ship To Custome
     C                     MOVELBEBRTX    #1BRTX           Ship To Name
     C                     MOVELBEHMNA    #1HMNA           Ship To Address
     C                     MOVELBEHONA    #1HONA           Ship To Address
     C                     MOVELBEHPNA    #1HPNA           Ship To Address
     C                     MOVELBEHNNA    #1HNNA           Ship To City
     C                     MOVELBEDBCD    #1DBCD           Ship To State C
     C                     MOVELBECKTX    #1CKTX           Ship To Zip/Pos
     C                     Z-ADDBEB0C7    #1B0C7           Bill to Custome
     C                     MOVELBEAETX    #1AETX           Bill to Name
     C                     MOVELBEB1NA    #1B1NA           Bill to Address
     C                     MOVELBEB3NA    #1B3NA           Bill to Address
     C                     MOVELBEB4NA    #1B4NA           Bill to Address
     C                     MOVELBEB2NA    #1B2NA           Bill to City
     C                     MOVELBEBHCD    #1BHCD           Bill to State C
     C                     MOVELBEC8TX    #1C8TX           Bill to Zip/Pos
     C                     MOVELBEBCNA    #1BCNA           Customer Purcha
     C                     Z-ADDBEA0DT    #1A0DT           Order Date
     C                     Z-ADDBEGNDT    #1GNDT           Actual Shipped
     C                     Z-ADDBEACDT    #1ACDT           Cancel Date
     C                     MOVELBEAQCD    #1AQCD           Terms Code
     C                     MOVELBEB6NA    #1B6NA           Special Instruc
     C                     MOVELBEBYNA    #1BYNA           Special Instruc
     C                     MOVELBEBZNA    #1BZNA           Carrier Code
     C                     MOVELBEGTST    #1GTST           Comment Print A
     C                     MOVELBEGVST    #1GVST           Comment Print I
     C                     MOVELBEGUST    #1GUST           Comment Print P
     C                     MOVELBEQFST    #1QFST           Comment Print S
     C                     MOVELBECQCD    #1CQCD           Reason Code
     C                     MOVELBEGJST    #1GJST           Order in Use
     C                     MOVELBEGWST    #1GWST           Header Status
     C                     MOVELBEGXST    #1GXST           Header Status L
     C                     MOVELBEGYST    #1GYST           Order Type Prin
     C                     MOVELBEAIVN    #1AIVN           User Original E
     C                     Z-ADDBECXDT    #1CXDT           Date of Origina
     C                     Z-ADDBEJZVA    #1JZVA           Order Value Tot
     C                     Z-ADDBEA1WG    #1A1WG           Order Weight To
     C                     MOVELBEXIST    #1XIST           Credit Hold
     C                     MOVELBEXJST    #1XJST           Production Hold
     C                     MOVELBEXKST    #1XKST           New Customer Ho
     C                     MOVELBEE8CD    #1E8CD           Accounts Receiv
     C                     MOVELBEE9CD    #1E9CD           Accounts Receiv
     C                     Z-ADDBERMNB    #1RMNB           Load ID
     C                     Z-ADDBETBNB    #1TBNB           Absorbed Freigh
     C                     Z-ADDBER1NB    #1R1NB           Rated Freight
     C                     MOVELBEPJST    #1PJST           LTL Flag
     C                     MOVELBEU0ST    #1U0ST           Price Audit
     C                     MOVELBEU1ST    #1U1ST           Price Status
     C                     MOVELBEQ2CD    #1Q2CD           Shipping Method
     C                     MOVELBEVEST    #1VEST           Palletize
     C                     MOVELBEVFST    #1VFST           Shrink Wrap
     C                     MOVELBEVGST    #1VGST           Slip Sheet
     C                     MOVELBERPCD    #1RPCD           Age Code
     C                     Z-ADDBERNNB    #1RNNB           Reefer Temperat
     C                     MOVELBEVDST    #1VDST           Load Type
     C                     Z-ADDBEATIN    #1ATIN           Attach to Invoi
     C                     MOVELBEU4ST    #1U4ST           Load Plan Order
     C                     MOVELBEU5ST    #1U5ST           Print Pick Slip
     C                     Z-ADDBERSRN    #1RSRN           Resell Referenc
     C                     MOVELBEMHNA    #1MHNA           Special Comment
     C                     MOVELBEMINA    #1MINA           Special Comment
     C                     MOVELBEWBST    #1WBST           Affect Auto Acc
     C                     MOVELBER4CD    #1R4CD           Sales Route Cod
     C                     MOVELBEBFCD    #1BFCD           Manager Level C
     C                     MOVELBEQ4CD    #1Q4CD           VP Level Code
     C                     Z-ADDBET3NB    #1T3NB           Attach to Order
     C                     MOVELBESICD    #1SICD           Reason for Pric
     C                     Z-ADDBECONB    #1CONB           Invoice Number
     C                     MOVELBECEST    #1CEST           Invoice Suffix
     C                     Z-ADDBEAWDT    #1AWDT           Invoice Date
     C                     MOVELBEJPCD    #1JPCD           Event Code
     C                     MOVELBEXUST    #1XUST           Trans Contol AS
     C                     MOVELBEZ1ST    #1Z1ST           Modified Flag
     C                     Z-ADDBEVRVA    #1VRVA           A/R order Value
     C                     MOVELBEOBST    #1OBST           Billing Activit
     C                     MOVELBEBCST    #1BCST           Block Order Fla
     C                     MOVELBEBDST    #1BDST           Order Certifica
     C                     Z-ADDBEB7VL    #1B7VL           Invoice Order V
     C                     MOVELBEGASX    #1GASX           Process Sts for
     C                     MOVELBEGBSX    #1GBSX           Order Conf Fax
     C                     MOVELBEGCSX    #1GCSX           Manifest Fax St
     C                     MOVELBEGDSX    #1GDSX           Invoice Fax Sts
     C                     MOVELBEFNSX    #1FNSX           Transfer in Sto
     C                     MOVELBEFOSX    #1FOSX           Email Cust On O
     C                     MOVELBEFPSX    #1FPSX           Order Emailed
     C                     MOVELBEFQSX    #1FQSX           Export Docs Go
     C                     MOVELBEFRSX    #1FRSX           Shipping Temp C
     C                     MOVELBEFSSX    #1FSSX           Broker Order St
     C                     MOVELBEFTSX    #1FTSX           Air Freight Ord
     C                     MOVELBEFUSX    #1FUSX           Order Requires
     C                     MOVELBEFWSX    #1FWSX           Export USDA App
     C                     MOVELBEFXSX    #1FXSX           HPB Ship to War
     C                     MOVELBEFYSX    #1FYSX           OH TF Exempt Co
     C                     Z-ADDBENODT    #1NODT           OH Appt Confirm
     C                     Z-ADDBENPDT    #1NPDT           JPN Invoice Iss
     C                     Z-ADDBENQDT    #1NQDT           Load Actual Shi
     C                     Z-ADDBENRDT    #1NRDT           Load BOL Comple
     C                     Z-ADDBENSDT    #1NSDT           Load Truck Depa
     C                     Z-ADDBEBPTM    #1BPTM           Maximum Gross W
     C                     Z-ADDBEBQTM    #1BQTM           Time of Origina
     C                     Z-ADDBEBRTM    #1BRTM           OH Appt Confirm
     C                     Z-ADDBEBSTM    #1BSTM           Load BOL Comple
     C                     Z-ADDBEBTTM    #1BTTM           Load Truck Depa
     C                     Z-ADDBEH0NX    #1H0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    #1H1NX           Act Non-Ref Frt
     C                     Z-ADDBEH2NX    #1H2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    #1H3NX           OH Total Non-Re
     C                     Z-ADDBEH4NX    #1H4NX           OH Total Ref Fr
     C                     Z-ADDBEC0C7    #1C0C7           Claim Number
     C                     MOVELBEUVST    #1UVST           EDI Status 1
     C                     MOVELBEUWST    #1UWST           EDI Status 2
     C                     MOVELBEUXST    #1UXST           EDI Status 3
     C                     Z-ADDBEAATM    #1AATM           Job Time
     C                     MOVELBEAYNA    #1AYNA           User Id
     C                     MOVELBEA0NA    #1A0NA           Job Name
     C                     Z-ADDBEAXDT    #1AXDT           Job Date
     C                     Z-ADDBEAIC3    #1AIC3           Company Number
     C                     Z-ADDBEC4NB    #1C4NB           Order Number
     C                     MOVELBEU2ST    #1U2ST           Export Status
     C                     Z-ADDBEAODT    #1AODT           Scheduled Ship
     C                     Z-ADDBEEIDT    #1EIDT           Requested Deliv
     C                     Z-ADDBEA5DT    #1A5DT           Requested Ship
     C                     Z-ADDBEAFTM    #1AFTM           Requested Deliv
      * Hold existing record image
     C                     MOVEL@1DBRC    #1DBRC
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MDIZ#K    BEGSR
      *================================================================
      * Initialize key screen
      *================================================================
     C                     Z-ADDP1AIC3    #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
     C                     Z-ADDP1C4NB    #1C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V1C4NB
      * Check reference to Company Name and Address
     C                     EXSR WCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9931  *
     C                     END
      * USER: Initialize key screen
      * CASE: PAR.Company Number is Equal to zero
     C           P1AIC3    IFEQ *ZERO                      *IF
     C                     Z-ADDYL0022    #1AIC3           Company Number
     C                     END                             *FI
      * *Set Cursor: KEY.Order Number  (*Override=*NO)
     C                     Z-ADD005       W0ROW0
     C                     Z-ADD021       W0COL0
     C                     MOVEL'0'       W0OVR0           *NO
      *================================================================
     CSR         MDEXIT    ENDSR
      /EJECT
     CSR         MNCV#K    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1C4NB           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#D    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Deadline Departure Date to display format
      * Convert date
     C           1000000   ADD  #DKZDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDKZDT
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #1AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1AODT
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  #1EIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1EIDT
      * Convert Requested Ship Date to display format
      * Convert date
     C           1000000   ADD  #1A5DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1A5DT
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SACHRC    BEGSR
      *================================================================
      * CHG Order in Use       CH - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0002  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0003  70       Ship To Custome
     C                     MOVEL*BLANK    WN0004 30        Ship To Name
     C                     MOVEL*BLANK    WN0005 30        Ship To Address
     C                     MOVEL*BLANK    WN0006 30        Ship To Address
     C                     MOVEL*BLANK    WN0007 30        Ship To Address
     C                     MOVEL*BLANK    WN0008 20        Ship To City
     C                     MOVEL*BLANK    WN0009  2        Ship To State C
     C                     MOVEL*BLANK    WN0010 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0011  70       Bill to Custome
     C                     MOVEL*BLANK    WN0012 30        Bill to Name
     C                     MOVEL*BLANK    WN0013 30        Bill to Address
     C                     MOVEL*BLANK    WN0014 30        Bill to Address
     C                     MOVEL*BLANK    WN0015 30        Bill to Address
     C                     MOVEL*BLANK    WN0016 20        Bill to City
     C                     MOVEL*BLANK    WN0017  2        Bill to State C
     C                     MOVEL*BLANK    WN0018 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0019 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0020  70       Order Date
     C                     Z-ADD*ZERO     WN0021  70       Requested Ship
     C                     Z-ADD*ZERO     WN0022  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0023  70       Cancel Date
     C                     MOVEL*BLANK    WN0024  2        Terms Code
     C                     MOVEL*BLANK    WN0025 40        Special Instruc
     C                     MOVEL*BLANK    WN0026 40        Special Instruc
     C                     MOVEL*BLANK    WN0027  3        Carrier Code
     C                     MOVEL*BLANK    WN0028  1        Comment Print A
     C                     MOVEL*BLANK    WN0029  1        Comment Print I
     C                     MOVEL*BLANK    WN0030  1        Comment Print P
     C                     MOVEL*BLANK    WN0031  1        Comment Print S
     C                     MOVEL*BLANK    WN0032  3        Reason Code
     C                     MOVEL*BLANK    WN0033  1        Header Status
     C                     MOVEL*BLANK    WN0034  1        Header Status L
     C                     MOVEL*BLANK    WN0035  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0036  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0037 10        User Original E
     C                     Z-ADD*ZERO     WN0038  70       Date of Origina
     C                     Z-ADD*ZERO     WN0039 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0040 112       Order Weight To
     C                     MOVEL*BLANK    WN0041  1        Credit Hold
     C                     MOVEL*BLANK    WN0042  1        Production Hold
     C                     MOVEL*BLANK    WN0043  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0044  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0045  40       Requested Deliv
     C                     MOVEL*BLANK    WN0046  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0047 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0048  70       Load ID
     C                     Z-ADD*ZERO     WN0049  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0050 112       Rated Freight
     C                     MOVEL*BLANK    WN0051  1        LTL Flag
     C                     MOVEL*BLANK    WN0052  1        Price Audit
     C                     MOVEL*BLANK    WN0053  1        Price Status
     C                     MOVEL*BLANK    WN0054  2        Shipping Method
     C                     MOVEL*BLANK    WN0055  1        Export Status
     C                     MOVEL*BLANK    WN0056  1        Palletize
     C                     MOVEL*BLANK    WN0057  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0058  1        Slip Sheet
     C                     MOVEL*BLANK    WN0059  1        Age Code
     C                     Z-ADD*ZERO     WN0060  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0061  1        Load Type
     C                     Z-ADD*ZERO     WN0062  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0063  1        Load Plan Order
     C                     MOVEL*BLANK    WN0064  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0065  70       Resell Referenc
     C                     MOVEL*BLANK    WN0066 30        Special Comment
     C                     MOVEL*BLANK    WN0067 30        Special Comment
     C                     MOVEL*BLANK    WN0068  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0069  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0070  2        Manager Level C
     C                     MOVEL*BLANK    WN0071  3        VP Level Code
     C                     Z-ADD*ZERO     WN0072  70       Attach to Order
     C                     MOVEL*BLANK    WN0073  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0074  70       Invoice Number
     C                     MOVEL*BLANK    WN0075  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0076  70       Invoice Date
     C                     MOVEL*BLANK    WN0077  2        Event Code
     C                     MOVEL*BLANK    WN0078  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0079  1        Modified Flag
     C                     Z-ADD*ZERO     WN0080 112       A/R order Value
     C                     MOVEL*BLANK    WN0081  1        Billing Activit
     C                     MOVEL*BLANK    WN0082  1        Block Order Fla
     C                     MOVEL*BLANK    WN0083  1        Order Certifica
     C                     Z-ADD*ZERO     WN0084 112       Invoice Order V
     C                     MOVEL*BLANK    WN0085  1        Process Sts for
     C                     MOVEL*BLANK    WN0086  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0087  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0088  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0089  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0090  1        Email Cust On O
     C                     MOVEL*BLANK    WN0091  1        Order Emailed
     C                     MOVEL*BLANK    WN0092  1        Export Docs Go
     C                     MOVEL*BLANK    WN0093  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0094  1        Broker Order St
     C                     MOVEL*BLANK    WN0095  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0096  2        Order Requires
     C                     MOVEL*BLANK    WN0097  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0098  2        Export USDA App
     C                     MOVEL*BLANK    WN0099  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0100  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0101  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0102  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0103  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0104  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0105  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0106  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0107  60       Time of Origina
     C                     Z-ADD*ZERO     WN0108  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0109  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0110  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0111 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0112 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0113 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0114 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0115 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0116  70       Claim Number
     C                     MOVEL*BLANK    WN0117  1        EDI Status 1
     C                     MOVEL*BLANK    WN0118  1        EDI Status 2
     C                     MOVEL*BLANK    WN0119  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0120  60       Job Time
     C                     MOVEL*BLANK    WN0121 10        User Id
     C                     MOVEL*BLANK    WN0122 10        Job Name
     C                     Z-ADD*ZERO     WN0123  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADD#1AIC3    BEAIC3           Company Number
     C                     Z-ADD#1C4NB    BEC4NB           Order Number
      *
     C           KLCHSA    KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
     C           KLCHSA    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SAEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE @1DBRC    YARDCS
      * Move non-key fields to @BECPFJ
     C                     MOVEL'Y'       BEGJST    P      Order in Use
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     BEAATM           Job Time
     C                     MOVEL##USR     BEAYNA           User Id
     C                     MOVEL##PGM     BEA0NA           Job Name
     C                     Z-ADD##JDT     BEAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPARC
     C                     Z-ADDBEAIC3    PAAIC3           Company Number
     C                     Z-ADDBEC4NB    PAC4NB           Order Number
     C                     MOVELBEJNCD    PAJNCD    P      Order Type - Sa
     C                     Z-ADDBEANC7    PAANC7           A/R Customer Nu
     C                     Z-ADDBEBKC7    PABKC7           Ship To Custome
     C                     MOVELBEBRTX    PABRTX    P      Ship To Name
     C                     MOVELBEHMNA    PAHMNA    P      Ship To Address
     C                     MOVELBEHONA    PAHONA    P      Ship To Address
     C                     MOVELBEHPNA    PAHPNA    P      Ship To Address
     C                     MOVELBEHNNA    PAHNNA    P      Ship To City
     C                     MOVELBEDBCD    PADBCD    P      Ship To State C
     C                     MOVELBECKTX    PACKTX    P      Ship To Zip/Pos
     C                     Z-ADDBEB0C7    PAB0C7           Bill to Custome
     C                     MOVELBEAETX    PAAETX    P      Bill to Name
     C                     MOVELBEB1NA    PAB1NA    P      Bill to Address
     C                     MOVELBEB3NA    PAB3NA    P      Bill to Address
     C                     MOVELBEB4NA    PAB4NA    P      Bill to Address
     C                     MOVELBEB2NA    PAB2NA    P      Bill to City
     C                     MOVELBEBHCD    PABHCD    P      Bill to State C
     C                     MOVELBEC8TX    PAC8TX    P      Bill to Zip/Pos
     C                     MOVELBEBCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDBEA0DT    PAA0DT           Order Date
     C                     Z-ADDBEA5DT    PAA5DT           Requested Ship
     C                     Z-ADDBEGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDBEACDT    PAACDT           Cancel Date
     C                     MOVELBEAQCD    PAAQCD    P      Terms Code
     C                     MOVELBEB6NA    PAB6NA    P      Special Instruc
     C                     MOVELBEBYNA    PABYNA    P      Special Instruc
     C                     MOVELBEBZNA    PABZNA    P      Carrier Code
     C                     MOVELBEGTST    PAGTST    P      Comment Print A
     C                     MOVELBEGVST    PAGVST    P      Comment Print I
     C                     MOVELBEGUST    PAGUST    P      Comment Print P
     C                     MOVELBEQFST    PAQFST    P      Comment Print S
     C                     MOVELBECQCD    PACQCD    P      Reason Code
     C                     MOVELBEGJST    PAGJST    P      Order in Use
     C                     MOVELBEGWST    PAGWST    P      Header Status
     C                     MOVELBEGXST    PAGXST    P      Header Status L
     C                     MOVELBEGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDBEAODT    PAAODT           Scheduled Ship
     C                     MOVELBEAIVN    PAAIVN    P      User Original E
     C                     Z-ADDBECXDT    PACXDT           Date of Origina
     C                     Z-ADDBEJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDBEA1WG    PAA1WG           Order Weight To
     C                     MOVELBEXIST    PAXIST    P      Credit Hold
     C                     MOVELBEXJST    PAXJST    P      Production Hold
     C                     MOVELBEXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDBEEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDBEAFTM    PAAFTM           Requested Deliv
     C                     MOVELBEE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELBEE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDBERMNB    PARMNB           Load ID
     C                     Z-ADDBETBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDBER1NB    PAR1NB           Rated Freight
     C                     MOVELBEPJST    PAPJST    P      LTL Flag
     C                     MOVELBEU0ST    PAU0ST    P      Price Audit
     C                     MOVELBEU1ST    PAU1ST    P      Price Status
     C                     MOVELBEQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELBEU2ST    PAU2ST    P      Export Status
     C                     MOVELBEVEST    PAVEST    P      Palletize
     C                     MOVELBEVFST    PAVFST    P      Shrink Wrap
     C                     MOVELBEVGST    PAVGST    P      Slip Sheet
     C                     MOVELBERPCD    PARPCD    P      Age Code
     C                     Z-ADDBERNNB    PARNNB           Reefer Temperat
     C                     MOVELBEVDST    PAVDST    P      Load Type
     C                     Z-ADDBEATIN    PAATIN           Attach to Invoi
     C                     MOVELBEU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELBEU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDBERSRN    PARSRN           Resell Referenc
     C                     MOVELBEMHNA    PAMHNA    P      Special Comment
     C                     MOVELBEMINA    PAMINA    P      Special Comment
     C                     MOVELBEWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELBER4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELBEBFCD    PABFCD    P      Manager Level C
     C                     MOVELBEQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDBET3NB    PAT3NB           Attach to Order
     C                     MOVELBESICD    PASICD    P      Reason for Pric
     C                     Z-ADDBECONB    PACONB           Invoice Number
     C                     MOVELBECEST    PACEST    P      Invoice Suffix
     C                     Z-ADDBEAWDT    PAAWDT           Invoice Date
     C                     MOVELBEJPCD    PAJPCD    P      Event Code
     C                     MOVELBEXUST    PAXUST    P      Trans Contol AS
     C                     MOVELBEZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDBEVRVA    PAVRVA           A/R order Value
     C                     MOVELBEOBST    PAOBST    P      Billing Activit
     C                     MOVELBEBCST    PABCST    P      Block Order Fla
     C                     MOVELBEBDST    PABDST    P      Order Certifica
     C                     Z-ADDBEB7VL    PAB7VL           Invoice Order V
     C                     MOVELBEGASX    PAGASX    P      Process Sts for
     C                     MOVELBEGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELBEGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELBEGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELBEFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELBEFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELBEFPSX    PAFPSX    P      Order Emailed
     C                     MOVELBEFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELBEFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELBEFSSX    PAFSSX    P      Broker Order St
     C                     MOVELBEFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELBEFUSX    PAFUSX    P      Order Requires
     C                     MOVELBEFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELBEFWSX    PAFWSX    P      Export USDA App
     C                     MOVELBEFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELBEFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDBENODT    PANODT           OH Appt Confirm
     C                     Z-ADDBENPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDBENQDT    PANQDT           Load Actual Shi
     C                     Z-ADDBENRDT    PANRDT           Load BOL Comple
     C                     Z-ADDBENSDT    PANSDT           Load Truck Depa
     C                     Z-ADDBEBPTM    PABPTM           Maximum Gross W
     C                     Z-ADDBEBQTM    PABQTM           Time of Origina
     C                     Z-ADDBEBRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDBEBSTM    PABSTM           Load BOL Comple
     C                     Z-ADDBEBTTM    PABTTM           Load Truck Depa
     C                     Z-ADDBEH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    PAH1NX           Act Non-Ref Frt
     C                     Z-ADDBEH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    PAH3NX           OH Total Non-Re
     C                     Z-ADDBEH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDBEC0C7    PAC0C7           Claim Number
     C                     MOVELBEUVST    PAUVST    P      EDI Status 1
     C                     MOVELBEUWST    PAUWST    P      EDI Status 2
     C                     MOVELBEUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDBEAATM    PAAATM           Job Time
     C                     MOVELBEAYNA    PAAYNA    P      User Id
     C                     MOVELBEA0NA    PAA0NA    P      Job Name
     C                     Z-ADDBEAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV UM/Whs Code-Add CS RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WUTAST           First Time Flag
     C                     Z-ADD*ZERO     YL0001           Boxes Total Qua
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSB01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSB02           Order Number
      * Define keylist
     C           KPSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Order Number
      * Setup key
     C                     Z-ADDBEAIC3    WQSB01           Company Number
     C                     Z-ADDBEC4NB    WQSB02           Order Number
     C                     Z-ADD*ZERO     OMDPNB           Order Sequence
     C                     Z-ADD*ZERO     OMUENB           Order Secondary
      * Establish starting position
     C           KPSSB     SETLL@BGWKL1                    *
     C           KRSSB     READE@BGWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #DAJCD           Warehouse Code
     C                     MOVEL*BLANK    #DAGCD           USR Unit of Mea
     C                     GOTO SBEXIT                     *QUIT
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PF3280 -- add "Cases" to the case-stmt
     C                     MOVELOMAJCD    #DAJCD           Warehouse Code
      * CASE:
      *  - c1ORc2ORc3ORc4
      *   |- c1    : DB1.U/M - Ordered is Combos
      *   |- c2    : DB1.U/M - Ordered is EQ Boxes
      *   |- c3    : DB1.U/M - Ordered is Mixed
      *   |- c4    : DB1.U/M - Ordered is Cases
      *   '-
     C           OMAGCD    IFEQ 'CB'                       *IF
     C           OMAGCD    OREQ 'BX'                       *OR
     C           OMAGCD    OREQ 'MX'                       *OR
     C           OMAGCD    OREQ 'CS'                       *OR
      * CASE: DB1.Detail Line Status is Cancelled
     C           OMGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * S17054 DN 04/06/21-Beyond this point, changed all 'U/M - Ordered'
      *   to reference LCL Context instead of DB1.
      * S17054 DN 04/06/21-Count Type 'Cases' (CS) as 'Boxes' (BX).
      * CASE: *OTHERWISE
     C                     MOVELOMAGCD    YL0002           U/M - Ordered
      * CASE: LCL.U/M - Ordered is Cases
     C           YL0002    IFEQ 'CS'                       *IF
     C                     MOVEL'BX'      YL0002           U/M - Ordered
     C                     END                             *FI
      * Sum for later check
      * CASE: LCL.U/M - Ordered is EQ Boxes
     C           YL0002    IFEQ 'BX'                       *IF
     C                     ADD  OMAVQT    YL0001           Boxes Total Qua
     C                     END                             *FI
      * CASE: PAR.USR Unit of Measure is *Blank
     C           #DAGCD    IFEQ *BLANK                     *IF
     C                     MOVELYL0002    #DAGCD           USR Unit of Mea
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.U/M - Ordered EQ PAR.USR Unit of Measure
     C           YL0002    IFEQ #DAGCD                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'MX'      WUAGCD           U/M - Ordered
     C                     MOVELWUAGCD    #DAGCD           USR Unit of Mea
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSB     READE@BGWKL1                  90*
     C                     ENDDO
      * USER: Exit processing
      * E2709 RMC 9/12/13  Classify as BX/CB - never MX
      * CASE: PAR.USR Unit of Measure is Mixed
     C           #DAGCD    IFEQ 'MX'                       *IF
      * RTV Numeric Value      RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDOMAIC3    WL0001           Company Number
     C                     MOVEL'BOXLOAD' WL0002    P      Company Value C
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    YL0003           System Value Nu
      * CASE: LCL.Boxes Total Quantity LT LCL.Box Load Min Box Qty USR
     C           YL0001    IFLT YL0003                     *IF
     C                     MOVEL'CB'      #DAGCD           USR Unit of Mea
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'BX'      #DAGCD           USR Unit of Mea
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Numeric Value      RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           KMAIC3           Company Number
     C                     KFLD           KMV8CD           Company Value C
      * Setup key
     C                     Z-ADDWL0001    KMAIC3           Company Number
     C                     MOVELWL0002    KMV8CD           Company Value C
      * Establish starting position
     C           KRSSC     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDKMM8NB    WL0003           System Value Nu
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Whse Descrip       RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0004    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSD     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0005           Warehouse Descr
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELADF8NA    WL0005           Warehouse Descr
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Warehouse Location RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WAAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0006    WAAJCD           Warehouse Code
      * Establish starting position
     C           KRSSE     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0007           Warehouse Locat
     C                     GOTO SEEXIT                     *QUIT
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAT0ST    WL0007           Warehouse Locat
     C                     GOTO SEEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Warehouse SHP     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WAAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0008    WAAJCD           Warehouse Code
      * Establish starting position
     C           KRSSF     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0009           Trans Contol AS
     C                     MOVEL*BLANK    WL0010           Warehouse Locat
     C                     Z-ADD*ZERO     WL0011           Shipping Compan
     C                     Z-ADD*ZERO     WL0012           Accounting Comp
     C                     MOVEL*BLANK    WL0013           WHS Live w/Carl
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAXUST    WL0009           Trans Contol AS
     C                     MOVELWAT0ST    WL0010           Warehouse Locat
     C                     Z-ADDWABWC3    WL0011           Shipping Compan
     C                     Z-ADDWABTC3    WL0012           Accounting Comp
     C                     MOVELWARRSX    WL0013           WHS Live w/Carl
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv UOM Description    RT - Unit of Measure  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           AMHHCD           U/M - Primary D
      * Setup key
     C                     MOVEL#DAGCD    AMHHCD           U/M - Primary D
      * Establish starting position
     C           KRSSG     CHAIN@AMREB0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0033' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #DHLTX           Description
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELAMAUNA    #DHLTX           Description
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Order in Use       RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    BEAIC3           Company Number
     C                     Z-ADD#1C4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSSH     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBEGJST    YL0006           Order in Use
     C                     MOVELBEGWST    YL0007           Header Status
     C                     Z-ADDBERMNB    YL0008           Load ID
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Load Status        RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDYL0008    FJRMNB           Load ID
      * Establish starting position
     C           KRSSI     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0009           Load Status
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELFJPKST    YL0009           Load Status
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Val Warehouse Exists   RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WAAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0014    WAAJCD           Warehouse Code
      * Establish starting position
     C           KRSSJ     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKINFN    BEGSR
      *================================================================
      * PMT Must Ship Dt Accpt IF - PD Order Header  * 
      *================================================================
      * PMT Must Ship Dt Accpt IF
      * PMT Must Ship Dt Accpt PV - Order Header TRG  * 
     C                     CALL 'PDJFPVR'              90  PMT Must Ship D
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1EIDT    WQ0048  70       Requested Deliv
     C                     PARM WULYDT    WQ0049  70       Must Ship Date
     C                     PARM #1A5DT    WQ0050  70       Requested Ship
     C           P4ATUS    PARM P4ATUS    WQ0051  1        STATUS
     C                     PARM WUA5TM    WQ0052  60       Must Ship Time
     C                     PARM #1AFTM    WQ0053  40       Requested Deliv
     C                     PARM WUB7SX    WQ0054  3        Must Ship Error
     C                     PARM #1C4NB    WQ0055  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDJFPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993233*
     C                     SETON                     34    *
     C                     END
      * CASE: PAR.STATUS is No
     C           P4ATUS    IFEQ 'N'                        *IF
      * Setup message data for message
      * Convert Must Ship Date        USR to display format
      * Convert date
     C           1000000   ADD  WULYDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0025
      * Send message 'Requested Ship Date can n'
     C                     MOVEL'USR2662' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Customer Type     RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN EOBKC7    WQSL01           Ship To Custome
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Ship To Custome
      * Setup key
     C                     Z-ADD#1BKC7    WQSL01           Ship To Custome
      * Establish starting position
     C           KRSSL     SETLL@EOREU0                    *
     C           KRSSL     READE@EOREU0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUBOCD           Type Code
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELEOBOCD    WUBOCD           Type Code
     C                     GOTO SLEXIT                     *QUIT
     C           KRSSL     READE@EOREU0                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Acct&Ship Co      RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WAAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#DAJCD    WAAJCD           Warehouse Code
      * Establish starting position
     C           KRSSM     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WUBTC3           Accounting Comp
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWABWC3    WUBWC3           Shipping Compan
     C                     Z-ADDWABTC3    WUBTC3           Accounting Comp
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv HPB fields        RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WAAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#DAJCD    WAAJCD           Warehouse Code
      * Establish starting position
     C           KRSSN     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0014           Production Ware
     C                     MOVEL*BLANK    YL0015           Warehouse Locat
     C                     MOVEL*BLANK    YL0016           WHS Req Meter R
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAAOCD    YL0014           Production Ware
     C                     MOVELWAT0ST    YL0015           Warehouse Locat
     C                     MOVELWARTSX    YL0016           WHS Req Meter R
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Count for BOL     RT - Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FNAIC3    WQSO01           Company Number
     C           *LIKE     DEFN FNC4NB    WQSO02           Order Number
      * Define keylist
     C           KPSSO     KLIST
     C                     KFLD           WQSO01           Company Number
     C                     KFLD           WQSO02           Order Number
     C                     KFLD           FNDPNB           Order Sequence
     C                     KFLD           FNUENB           Order Secondary
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Company Number
     C                     KFLD           WQSO02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQSO01           Company Number
     C                     Z-ADD#1C4NB    WQSO02           Order Number
     C                     Z-ADD*ZERO     FNDPNB           Order Sequence
     C                     Z-ADD*ZERO     FNUENB           Order Secondary
      * Establish starting position
     C           KPSSO     SETLL@FNCPCT                    *
     C           KRSSO     READE@FNCPCT                  90*
      * Data record not found
     C   90                MOVEL'USR1196' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         YL0017           Count USR
     C           KRSSO     READE@FNCPCT                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Upd WHS/Alc by Ord 2 RT - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0124 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0125 112       Weight Schedule
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * ***** PA PROCESS - USE REQUESTED SHIP DATE FOR Ship Date USR ****
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSP01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSP02           Order Number
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           Company Number
     C                     KFLD           WQSP02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQSP01           Company Number
     C                     Z-ADD#1C4NB    WQSP02           Order Number
      * Establish starting position
     C           KRSSP     SETLL@BGWKL1                    *
     C           KRSSP     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDOMCCQT    WN0124           Quantity Schedu
     C                     Z-ADDOMAUWG    WN0125           Weight Schedule
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM OMAIC3    WQ0098  30       Company Number
     C                     PARM OMC4NB    WQ0099  70       Order Number
     C                     PARM OMDPNB    WQ0100  30       Order Sequence
     C                     PARM OMUENB    WQ0101  30       Order Secondary
     C                     PARM OMHGCD    WQ0102  70       Item Code
     C                     PARM OMAJCD    WQ0103  3        Warehouse Code
     C                     PARM OMA5DT    WQ0104  70       Ship Date USR
     C                     PARM *ZERO     WQ0105 112       Quantity Ordere
     C                     PARM *ZERO     WQ0106 112       Weight Ordered
     C           WN0124    PARM WN0124    WQ0107 112       Quantity Schedu
     C           WN0125    PARM WN0125    WQ0108 112       Weight Schedule
     C                     PARM 'OD'      WQ0109  2        ATS Adj Type US
     C                     PARM @CN,003   WQ0110 10        PSAA Program Na
     C                     PARM OMRINY    WQ0111  40       Item Age Days
     C                     PARM OMTIDT    WQ0112  70       Production Ovr
     C                     PARM OMTJDT    WQ0113  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADD*ZERO     WN0124           Quantity Schedu
     C                     Z-ADD*ZERO     WN0125           Weight Schedule
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM OMAIC3    WQ0114  30       Company Number
     C                     PARM OMC4NB    WQ0115  70       Order Number
     C                     PARM OMDPNB    WQ0116  30       Order Sequence
     C                     PARM OMUENB    WQ0117  30       Order Secondary
     C                     PARM OMHGCD    WQ0118  70       Item Code
     C                     PARM #DAJCD    WQ0119  3        Warehouse Code
     C                     PARM OMA5DT    WQ0120  70       Ship Date USR
     C                     PARM OMCCQT    WQ0121 112       Quantity Ordere
     C                     PARM OMAUWG    WQ0122 112       Weight Ordered
     C           WN0124    PARM WN0124    WQ0123 112       Quantity Schedu
     C           WN0125    PARM WN0125    WQ0124 112       Weight Schedule
     C                     PARM 'OA'      WQ0125  2        ATS Adj Type US
     C                     PARM @CN,003   WQ0126 10        PSAA Program Na
     C                     PARM OMRINY    WQ0127  40       Item Age Days
     C                     PARM OMTIDT    WQ0128  70       Production Ovr
     C                     PARM OMTJDT    WQ0129  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9935  *
     C                     END
      * Schedule As Ordered.
      * CASE: PAR.Quantity Scheduled NE DB1.Quantity Scheduled
     C           WN0124    IFNE OMCCQT                     *IF
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM OMAIC3    WQ0130  30       Company Number
     C                     PARM OMC4NB    WQ0131  70       Order Number
     C                     PARM OMDPNB    WQ0132  30       Order Sequence
     C                     PARM OMUENB    WQ0133  30       Order Secondary
     C                     PARM OMHGCD    WQ0134  70       Item Code
     C                     PARM #DAJCD    WQ0135  3        Warehouse Code
     C                     PARM OMA5DT    WQ0136  70       Ship Date USR
     C                     PARM OMCCQT    WQ0137 112       Quantity Ordere
     C                     PARM OMAUWG    WQ0138 112       Weight Ordered
     C           WN0124    PARM WN0124    WQ0139 112       Quantity Schedu
     C           WN0125    PARM WN0125    WQ0140 112       Weight Schedule
     C                     PARM 'AO'      WQ0141  2        ATS Adj Type US
     C                     PARM @CN,003   WQ0142 10        PSAA Program Na
     C                     PARM OMRINY    WQ0143  40       Item Age Days
     C                     PARM OMTIDT    WQ0144  70       Production Ovr
     C                     PARM OMTJDT    WQ0145  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9935  *
     C                     END
     C                     END                             *FI
      * FP1054 upd prod warehouse
      * Rtv Productin Whs     RT - Warehouse  * 
     C                     EXSR SQRVGN
      * Chg Warehouse         CH - Order Detail  * 
     C                     EXSR SRCHRC
     C           KRSSP     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Rtv Productin Whs     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#DAJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSQ     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0020           Production Ware
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADAOCD    YL0020           Production Ware
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRCHRC    BEGSR
      *================================================================
      * Chg Warehouse         CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0126  70       Item Code
     C                     Z-ADD*ZERO     WN0127  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0128  70       Order Group Cod
     C                     MOVEL*BLANK    WN0129  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0130  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0131 112       Billing Detail
     C                     Z-ADD*ZERO     WN0132 112       Billing Detail
     C                     Z-ADD*ZERO     WN0133 112       Billing Detail
     C                     Z-ADD*ZERO     WN0134 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0135  1        Comment Print A
     C                     MOVEL*BLANK    WN0136  1        Comment Print I
     C                     MOVEL*BLANK    WN0137  1        Comment Print P
     C                     MOVEL*BLANK    WN0138  1        Comment Print S
     C                     Z-ADD*ZERO     WN0139 112       Extended Amount
     C                     Z-ADD*ZERO     WN0140  70       Market Pricing
     C                     MOVEL*BLANK    WN0141  3        Commodity Marke
     C                     MOVEL*BLANK    WN0142  3        Date Method Cod
     C                     MOVEL*BLANK    WN0143  3        Price Method Co
     C                     Z-ADD*ZERO     WN0144 114       Price Overage O
     C                     Z-ADD*ZERO     WN0145  70       Contract Number
     C                     MOVEL*BLANK    WN0146  1        Price Status
     C                     Z-ADD*ZERO     WN0147  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0148  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0149  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0150  1        Work Confirm St
     C                     MOVEL*BLANK    WN0151  1        Work Over/Short
     C                     MOVEL*BLANK    WN0152  1        OD Production P
     C                     MOVEL*BLANK    WN0153 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0154 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0155  1        Age Code
     C                     MOVEL*BLANK    WN0156  1        Palletize
     C                     MOVEL*BLANK    WN0157  1        Slip Sheet
     C                     MOVEL*BLANK    WN0158  1        Catch Weight St
     C                     MOVEL*BLANK    WN0159  1        Price Audit
     C                     MOVEL*BLANK    WN0160  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0161  1        Production Date
     C                     Z-ADD*ZERO     WN0162 112       Rated Freight
     C                     Z-ADD*ZERO     WN0163 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0164 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0165 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0166 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0167 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0168 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0169 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0170 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0171 114       Unit Price
     C                     Z-ADD*ZERO     WN0172 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0173 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0174 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0175 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0176  70       Requested Ship
     C                     Z-ADD*ZERO     WN0177  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0178  70       Actual Shipped
     C                     MOVEL*BLANK    WN0179  1        Affect Inventor
     C                     MOVEL*BLANK    WN0180  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0181  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0182  30       Item Structure
     C                     Z-ADD*ZERO     WN0183  30       Item Structure
     C                     Z-ADD*ZERO     WN0184  30       Item Structure
     C                     MOVEL*BLANK    WN0185  2        Item Level
     C                     MOVEL*BLANK    WN0186  2        Quality Level
     C                     MOVEL*BLANK    WN0187  2        Pricing Product
     C                     MOVEL*BLANK    WN0188  2        Season Product
     C                     Z-ADD*ZERO     WN0189  70       Date of Origina
     C                     MOVEL*BLANK    WN0190 10        User Profile Na
     C                     MOVEL*BLANK    WN0191  6        Country Code
     C                     MOVEL*BLANK    WN0192  2        Event Code
     C                     MOVEL*BLANK    WN0193  3        Reason Code
     C                     MOVEL*BLANK    WN0194  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0195  1        Modified Flag
     C                     MOVEL*BLANK    WN0196  1        Substituted Fla
     C                     MOVEL*BLANK    WN0197  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0198 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0199 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0200  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0201  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0202  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0203  1        Affect Commissi
     C                     MOVEL*BLANK    WN0204  1        Affect Pricing
     C                     MOVEL*BLANK    WN0205  1        Released by Use
     C                     MOVEL*BLANK    WN0206  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0207  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0208  3        OD Price Type
     C                     Z-ADD*ZERO     WN0209  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0210  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0211  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0212  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0213  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0214  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0215  60       Price Code
     C                     Z-ADD*ZERO     WN0216  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0217  60       Substitution Li
     C                     Z-ADD*ZERO     WN0218  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0219 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0220 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0221 112       OD Item Target
     C                     Z-ADD*ZERO     WN0222 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0223 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0224 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN0225 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0226 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0227 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0228 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0229 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0230 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0231 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0232  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0233  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0234  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0235 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0236  40       Item Age Days
     C                     Z-ADD*ZERO     WN0237  70       Production Ovr
     C                     Z-ADD*ZERO     WN0238  70       Production Ovr
     C                     MOVEL*BLANK    WN0239  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0240  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0241  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0242  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0243  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0244  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0245  1        EDI Status 1
     C                     MOVEL*BLANK    WN0246  1        EDI Status 2
     C                     MOVEL*BLANK    WN0247  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0248  60       Job Time
     C                     MOVEL*BLANK    WN0249 10        User Id
     C                     MOVEL*BLANK    WN0250 10        Job Name
     C                     Z-ADD*ZERO     WN0251  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDOMAIC3    WBAIC3           Company Number
     C                     Z-ADDOMC4NB    WBC4NB           Order Number
     C                     Z-ADDOMDPNB    WBDPNB           Order Sequence
     C                     Z-ADDOMUENB    WBUENB           Order Secondary
      *
     C           KLCHSR    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
     C                     KFLD           WBDPNB           Order Sequence
     C                     KFLD           WBUENB           Order Secondary
     C           KLCHSR    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SREXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YBRDCS
      * Move non-key fields to @BGWKL0
     C                     MOVEL#DAJCD    WBAJCD    P      Warehouse Code
     C                     MOVELYL0020    WBF6SX    P      Production Ware
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WBAATM           Job Time
     C                     MOVEL##USR     WBAYNA           User Id
     C                     MOVEL##JOB     WBA0NA           Job Name
     C                     Z-ADD##JDT     WBAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * RTV Chg Whse          RT - Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSS01           Company Number
     C           *LIKE     DEFN WCC4NB    WQSS02           Order Number
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS01           Company Number
     C                     KFLD           WQSS02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQSS01           Company Number
     C                     Z-ADD#1C4NB    WQSS02           Order Number
      * Establish starting position
     C           KRSSS     SETLL@FNCPUW                    *
     C           KRSSS     READE@FNCPUW                  90*
      * Data record not found
     C   90                MOVEL'USR1196' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG OM Manifest Detail CH - Manifest Detail  * 
     C                     EXSR STCHRC
     C           KRSSS     READE@FNCPUW                  90*
     C                     ENDDO
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STCHRC    BEGSR
      *================================================================
      * CHG OM Manifest Detail CH - Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @FNCPCS
     C                     Z-ADDWCAIC3    WDAIC3           Company Number
     C                     Z-ADDWCC4NB    WDC4NB           Order Number
     C                     Z-ADDWCDPNB    WDDPNB           Order Sequence
     C                     Z-ADDWCUENB    WDUENB           Order Secondary
     C                     Z-ADDWCRZNB    WDRZNB           Case Sequence N
      *
     C           KLCHST    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
     C                     KFLD           WDDPNB           Order Sequence
     C                     KFLD           WDUENB           Order Secondary
     C                     KFLD           WDRZNB           Case Sequence N
     C           KLCHST    CHAIN@FNCPCS              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFNCPL0'MDACP
     C                     MOVEL'@FNCPCS' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO STEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFN1    YCRDCS
      * Move non-key fields to @FNCPCS
     C                     Z-ADDWCFOQT    WDFOQT           Case Quantity
     C                     Z-ADDWCR0NB    WDR0NB           Case Weight
     C                     MOVELWCPMST    WDPMST    P      Inventory Updat
     C                     Z-ADDWCK7DT    WDK7DT           Label Date
     C                     Z-ADDWCPFNX    WDPFNX           PT Serial Numbe
     C                     Z-ADDWCHGCD    WDHGCD           Item Code
     C                     MOVEL#DAJCD    WDAJCD    P      Warehouse Code
     C                     Z-ADDWCELDT    WDELDT           Production Date
     C                     Z-ADDWCN5WG    WDN5WG           Manifest Gross
     C                     MOVELWCRZNA    WDRZNA    P      Manifest Lot ID
     C                     Z-ADDWCH5NY    WDH5NY           Manifest Total
     C                     Z-ADDWCH6NY    WDH6NY           Manifest Co-Par
     C                     Z-ADDWCH7NY    WDH7NY           Manifest Pallet
     C                     MOVELWCGBTX    WDGBTX    P      Manifest Shift
     C                     Z-ADDWCN6WG    WDN6WG           HPB Meter Net G
     C                     Z-ADDWCN7WG    WDN7WG           Manifest Net We
     C                     MOVELWCGCTX    WDGCTX    P      Manifest Unused
     C                     MOVELWCGDTX    WDGDTX    P      Manifest Unused
     C                     Z-ADDWCRBDT    WDRBDT           Manifest Unused
     C                     Z-ADDWCITNY    WDITNY           HPB COA Batch N
     C                     Z-ADDWCIVNY    WDIVNY           HPB Meter Start
     C                     Z-ADDWCIUNY    WDIUNY           HPB Meter Endin
     C                     Z-ADDWCIWNY    WDIWNY           HPB Meter Total
     C                     Z-ADDWCIXNY    WDIXNY           HPB Meter Net W
     C                     Z-ADDWCIYNY    WDIYNY           HPB Density Ref
     C                     MOVELWCUVST    WDUVST    P      EDI Status 1
     C                     MOVELWCUWST    WDUWST    P      EDI Status 2
     C                     MOVELWCUXST    WDUXST    P      EDI Status 3
     C                     MOVELWCVSST    WDVSST    P      Record Status
     C                     Z-ADDWCAATM    WDAATM           Job Time
     C                     MOVELWCAYNA    WDAYNA    P      User Id
     C                     MOVELWCA0NA    WDA0NA    P      Job Name
     C                     Z-ADDWCAXDT    WDAXDT           Job Date
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFN1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WDAATM' defaulted for 'Job Time'.
      * Field '(DB1) WDAYNA' defaulted for 'User Id'.
      * Field '(DB1) WDA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WDAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##JOB     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFN1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@FNCPCS                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFNCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
      * USER: Processing after Data update
     C                     MOVEL'Y'       WUR4ST           USR Update Flag
     C                     MOVEL'Y'       WURINS           COA RIN Modifie
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUCHRC    BEGSR
      *================================================================
      * CHG Order in Use       CH - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0252  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0253  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0254  70       Ship To Custome
     C                     MOVEL*BLANK    WN0255 30        Ship To Name
     C                     MOVEL*BLANK    WN0256 30        Ship To Address
     C                     MOVEL*BLANK    WN0257 30        Ship To Address
     C                     MOVEL*BLANK    WN0258 30        Ship To Address
     C                     MOVEL*BLANK    WN0259 20        Ship To City
     C                     MOVEL*BLANK    WN0260  2        Ship To State C
     C                     MOVEL*BLANK    WN0261 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0262  70       Bill to Custome
     C                     MOVEL*BLANK    WN0263 30        Bill to Name
     C                     MOVEL*BLANK    WN0264 30        Bill to Address
     C                     MOVEL*BLANK    WN0265 30        Bill to Address
     C                     MOVEL*BLANK    WN0266 30        Bill to Address
     C                     MOVEL*BLANK    WN0267 20        Bill to City
     C                     MOVEL*BLANK    WN0268  2        Bill to State C
     C                     MOVEL*BLANK    WN0269 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0270 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0271  70       Order Date
     C                     Z-ADD*ZERO     WN0272  70       Requested Ship
     C                     Z-ADD*ZERO     WN0273  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0274  70       Cancel Date
     C                     MOVEL*BLANK    WN0275  2        Terms Code
     C                     MOVEL*BLANK    WN0276 40        Special Instruc
     C                     MOVEL*BLANK    WN0277 40        Special Instruc
     C                     MOVEL*BLANK    WN0278  3        Carrier Code
     C                     MOVEL*BLANK    WN0279  1        Comment Print A
     C                     MOVEL*BLANK    WN0280  1        Comment Print I
     C                     MOVEL*BLANK    WN0281  1        Comment Print P
     C                     MOVEL*BLANK    WN0282  1        Comment Print S
     C                     MOVEL*BLANK    WN0283  3        Reason Code
     C                     MOVEL*BLANK    WN0284  1        Header Status
     C                     MOVEL*BLANK    WN0285  1        Header Status L
     C                     MOVEL*BLANK    WN0286  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0287  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0288 10        User Original E
     C                     Z-ADD*ZERO     WN0289  70       Date of Origina
     C                     Z-ADD*ZERO     WN0290 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0291 112       Order Weight To
     C                     MOVEL*BLANK    WN0292  1        Credit Hold
     C                     MOVEL*BLANK    WN0293  1        Production Hold
     C                     MOVEL*BLANK    WN0294  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0295  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0296  40       Requested Deliv
     C                     MOVEL*BLANK    WN0297  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0298 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0299  70       Load ID
     C                     Z-ADD*ZERO     WN0300  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0301 112       Rated Freight
     C                     MOVEL*BLANK    WN0302  1        LTL Flag
     C                     MOVEL*BLANK    WN0303  1        Price Audit
     C                     MOVEL*BLANK    WN0304  1        Price Status
     C                     MOVEL*BLANK    WN0305  2        Shipping Method
     C                     MOVEL*BLANK    WN0306  1        Export Status
     C                     MOVEL*BLANK    WN0307  1        Palletize
     C                     MOVEL*BLANK    WN0308  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0309  1        Slip Sheet
     C                     MOVEL*BLANK    WN0310  1        Age Code
     C                     Z-ADD*ZERO     WN0311  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0312  1        Load Type
     C                     Z-ADD*ZERO     WN0313  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0314  1        Load Plan Order
     C                     MOVEL*BLANK    WN0315  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0316  70       Resell Referenc
     C                     MOVEL*BLANK    WN0317 30        Special Comment
     C                     MOVEL*BLANK    WN0318 30        Special Comment
     C                     MOVEL*BLANK    WN0319  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0320  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0321  2        Manager Level C
     C                     MOVEL*BLANK    WN0322  3        VP Level Code
     C                     Z-ADD*ZERO     WN0323  70       Attach to Order
     C                     MOVEL*BLANK    WN0324  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0325  70       Invoice Number
     C                     MOVEL*BLANK    WN0326  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0327  70       Invoice Date
     C                     MOVEL*BLANK    WN0328  2        Event Code
     C                     MOVEL*BLANK    WN0329  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0330  1        Modified Flag
     C                     Z-ADD*ZERO     WN0331 112       A/R order Value
     C                     MOVEL*BLANK    WN0332  1        Billing Activit
     C                     MOVEL*BLANK    WN0333  1        Block Order Fla
     C                     MOVEL*BLANK    WN0334  1        Order Certifica
     C                     Z-ADD*ZERO     WN0335 112       Invoice Order V
     C                     MOVEL*BLANK    WN0336  1        Process Sts for
     C                     MOVEL*BLANK    WN0337  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0338  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0339  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0340  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0341  1        Email Cust On O
     C                     MOVEL*BLANK    WN0342  1        Order Emailed
     C                     MOVEL*BLANK    WN0343  1        Export Docs Go
     C                     MOVEL*BLANK    WN0344  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0345  1        Broker Order St
     C                     MOVEL*BLANK    WN0346  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0347  2        Order Requires
     C                     MOVEL*BLANK    WN0348  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0349  2        Export USDA App
     C                     MOVEL*BLANK    WN0350  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0351  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0352  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0353  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0354  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0355  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0356  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0357  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0358  60       Time of Origina
     C                     Z-ADD*ZERO     WN0359  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0360  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0361  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0362 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0363 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0364 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0365 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0366 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0367  70       Claim Number
     C                     MOVEL*BLANK    WN0368  1        EDI Status 1
     C                     MOVEL*BLANK    WN0369  1        EDI Status 2
     C                     MOVEL*BLANK    WN0370  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0371  60       Job Time
     C                     MOVEL*BLANK    WN0372 10        User Id
     C                     MOVEL*BLANK    WN0373 10        Job Name
     C                     Z-ADD*ZERO     WN0374  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWUAIC3    BEAIC3           Company Number
     C                     Z-ADDWUC4NB    BEC4NB           Order Number
      *
     C           KLCHSU    KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
     C           KLCHSU    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE @1DBRC    YDRDCS
      * Move non-key fields to @BECPFJ
     C                     MOVEL'N'       BEGJST    P      Order in Use
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     BEAATM           Job Time
     C                     MOVEL##USR     BEAYNA           User Id
     C                     MOVEL##PGM     BEA0NA           Job Name
     C                     Z-ADD##JDT     BEAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPARC
     C                     Z-ADDBEAIC3    PAAIC3           Company Number
     C                     Z-ADDBEC4NB    PAC4NB           Order Number
     C                     MOVELBEJNCD    PAJNCD    P      Order Type - Sa
     C                     Z-ADDBEANC7    PAANC7           A/R Customer Nu
     C                     Z-ADDBEBKC7    PABKC7           Ship To Custome
     C                     MOVELBEBRTX    PABRTX    P      Ship To Name
     C                     MOVELBEHMNA    PAHMNA    P      Ship To Address
     C                     MOVELBEHONA    PAHONA    P      Ship To Address
     C                     MOVELBEHPNA    PAHPNA    P      Ship To Address
     C                     MOVELBEHNNA    PAHNNA    P      Ship To City
     C                     MOVELBEDBCD    PADBCD    P      Ship To State C
     C                     MOVELBECKTX    PACKTX    P      Ship To Zip/Pos
     C                     Z-ADDBEB0C7    PAB0C7           Bill to Custome
     C                     MOVELBEAETX    PAAETX    P      Bill to Name
     C                     MOVELBEB1NA    PAB1NA    P      Bill to Address
     C                     MOVELBEB3NA    PAB3NA    P      Bill to Address
     C                     MOVELBEB4NA    PAB4NA    P      Bill to Address
     C                     MOVELBEB2NA    PAB2NA    P      Bill to City
     C                     MOVELBEBHCD    PABHCD    P      Bill to State C
     C                     MOVELBEC8TX    PAC8TX    P      Bill to Zip/Pos
     C                     MOVELBEBCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDBEA0DT    PAA0DT           Order Date
     C                     Z-ADDBEA5DT    PAA5DT           Requested Ship
     C                     Z-ADDBEGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDBEACDT    PAACDT           Cancel Date
     C                     MOVELBEAQCD    PAAQCD    P      Terms Code
     C                     MOVELBEB6NA    PAB6NA    P      Special Instruc
     C                     MOVELBEBYNA    PABYNA    P      Special Instruc
     C                     MOVELBEBZNA    PABZNA    P      Carrier Code
     C                     MOVELBEGTST    PAGTST    P      Comment Print A
     C                     MOVELBEGVST    PAGVST    P      Comment Print I
     C                     MOVELBEGUST    PAGUST    P      Comment Print P
     C                     MOVELBEQFST    PAQFST    P      Comment Print S
     C                     MOVELBECQCD    PACQCD    P      Reason Code
     C                     MOVELBEGJST    PAGJST    P      Order in Use
     C                     MOVELBEGWST    PAGWST    P      Header Status
     C                     MOVELBEGXST    PAGXST    P      Header Status L
     C                     MOVELBEGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDBEAODT    PAAODT           Scheduled Ship
     C                     MOVELBEAIVN    PAAIVN    P      User Original E
     C                     Z-ADDBECXDT    PACXDT           Date of Origina
     C                     Z-ADDBEJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDBEA1WG    PAA1WG           Order Weight To
     C                     MOVELBEXIST    PAXIST    P      Credit Hold
     C                     MOVELBEXJST    PAXJST    P      Production Hold
     C                     MOVELBEXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDBEEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDBEAFTM    PAAFTM           Requested Deliv
     C                     MOVELBEE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELBEE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDBERMNB    PARMNB           Load ID
     C                     Z-ADDBETBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDBER1NB    PAR1NB           Rated Freight
     C                     MOVELBEPJST    PAPJST    P      LTL Flag
     C                     MOVELBEU0ST    PAU0ST    P      Price Audit
     C                     MOVELBEU1ST    PAU1ST    P      Price Status
     C                     MOVELBEQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELBEU2ST    PAU2ST    P      Export Status
     C                     MOVELBEVEST    PAVEST    P      Palletize
     C                     MOVELBEVFST    PAVFST    P      Shrink Wrap
     C                     MOVELBEVGST    PAVGST    P      Slip Sheet
     C                     MOVELBERPCD    PARPCD    P      Age Code
     C                     Z-ADDBERNNB    PARNNB           Reefer Temperat
     C                     MOVELBEVDST    PAVDST    P      Load Type
     C                     Z-ADDBEATIN    PAATIN           Attach to Invoi
     C                     MOVELBEU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELBEU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDBERSRN    PARSRN           Resell Referenc
     C                     MOVELBEMHNA    PAMHNA    P      Special Comment
     C                     MOVELBEMINA    PAMINA    P      Special Comment
     C                     MOVELBEWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELBER4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELBEBFCD    PABFCD    P      Manager Level C
     C                     MOVELBEQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDBET3NB    PAT3NB           Attach to Order
     C                     MOVELBESICD    PASICD    P      Reason for Pric
     C                     Z-ADDBECONB    PACONB           Invoice Number
     C                     MOVELBECEST    PACEST    P      Invoice Suffix
     C                     Z-ADDBEAWDT    PAAWDT           Invoice Date
     C                     MOVELBEJPCD    PAJPCD    P      Event Code
     C                     MOVELBEXUST    PAXUST    P      Trans Contol AS
     C                     MOVELBEZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDBEVRVA    PAVRVA           A/R order Value
     C                     MOVELBEOBST    PAOBST    P      Billing Activit
     C                     MOVELBEBCST    PABCST    P      Block Order Fla
     C                     MOVELBEBDST    PABDST    P      Order Certifica
     C                     Z-ADDBEB7VL    PAB7VL           Invoice Order V
     C                     MOVELBEGASX    PAGASX    P      Process Sts for
     C                     MOVELBEGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELBEGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELBEGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELBEFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELBEFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELBEFPSX    PAFPSX    P      Order Emailed
     C                     MOVELBEFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELBEFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELBEFSSX    PAFSSX    P      Broker Order St
     C                     MOVELBEFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELBEFUSX    PAFUSX    P      Order Requires
     C                     MOVELBEFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELBEFWSX    PAFWSX    P      Export USDA App
     C                     MOVELBEFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELBEFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDBENODT    PANODT           OH Appt Confirm
     C                     Z-ADDBENPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDBENQDT    PANQDT           Load Actual Shi
     C                     Z-ADDBENRDT    PANRDT           Load BOL Comple
     C                     Z-ADDBENSDT    PANSDT           Load Truck Depa
     C                     Z-ADDBEBPTM    PABPTM           Maximum Gross W
     C                     Z-ADDBEBQTM    PABQTM           Time of Origina
     C                     Z-ADDBEBRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDBEBSTM    PABSTM           Load BOL Comple
     C                     Z-ADDBEBTTM    PABTTM           Load Truck Depa
     C                     Z-ADDBEH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    PAH1NX           Act Non-Ref Frt
     C                     Z-ADDBEH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    PAH3NX           OH Total Non-Re
     C                     Z-ADDBEH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDBEC0C7    PAC0C7           Claim Number
     C                     MOVELBEUVST    PAUVST    P      EDI Status 1
     C                     MOVELBEUWST    PAUWST    P      EDI Status 2
     C                     MOVELBEUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDBEAATM    PAAATM           Job Time
     C                     MOVELBEAYNA    PAAYNA    P      User Id
     C                     MOVELBEA0NA    PAA0NA    P      Job Name
     C                     Z-ADDBEAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0375    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSSV     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI6ST    P3I6ST           Allow Multi-Com
     C                     MOVELDRMPNA    P3MPNA           Default Printer
     C                     MOVELDRBCCD    P3BCCD           Salesperson Cod
     C                     Z-ADDDRAIC3    YL0026           Company Number
     C                     MOVELDRBUVN    WN0376           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0015    DTAJVN           User Profile Na
     C                     MOVELWL0016    DTDNCD           Application Cod
      * Establish starting position
     C           KRSSW     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0017           Company Number
     C                     MOVELDTAJCD    WL0018           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * RTV Prod Whse for Co  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEBWC3    WQSX01           Shipping Compan
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WQSX01           Shipping Compan
      * Setup key
     C                     Z-ADDYL0028    WQSX01           Shipping Compan
      * Establish starting position
     C           KRSSX     SETLL@ADREWA                    *
     C           KRSSX     READE@ADREWA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    P3AJCD           Warehouse Code
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C           WEVSST    IFEQ 'A'                        *IF
      * CASE: DB1.Production Warehouse Code is Warehouse Code not Blank
     C           WEAOCD    IFNE *BLANK                     *IF
     C                     MOVELWEAOCD    P3AJCD           Warehouse Code
     C                     GOTO SXEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSX     READE@ADREWA                  90*
     C                     ENDDO
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WFAIC3           Company Number
      * Setup key
     C                     Z-ADDWUAIC3    WFAIC3           Company Number
      * Establish starting position
     C           KRSSY     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0023           Name
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFADTX    YL0023           Name
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * RTV Appl Whs Restrict  RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVEL##USR     DRAJVN           User Profile Na
      * Establish starting position
     C           KRSSZ     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0010           Application WHS
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI7ST    YL0010           Application WHS
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Deadline Departure Date/Time and Shipping Restrictions  W288
      *================================================================
      * ** Test DDD/T if Access Limited is Yes             W288
      * CASE: PAR.Access Limited Sts USR is yes
     C           P3HHST    IFEQ 'Y'                        *IF
      * Seaboard only
      * CASE: PAR.Company Organization is Seaboard
     C           P5YJSX    IFEQ 'S'                        *IF
      * RMC 9/12/17 comment this error
      * ** Retrieve the hours that Shipping is restricted from loading
      * ** (this is maintained by scheduling)
      * RTV Dock Unavail Range XF - Warehouse Control  * W288
     C                     CALL 'PNNIXFR'              90  RTV Dock Unavai
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #DAJCD    WQ0064  3        Warehouse Code
     C           WUDPTM    PARM *ZERO     WQ0065  60       Dock Unavail St
     C           WUDQTM    PARM *ZERO     WQ0066  60       Dock Unavail En
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNNIXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9935  *
     C                     END
      * ** DDT cannot be during Shipping Restricted Hours     W288
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,002                    *IF
      *       skip - not an error if no record
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Dock Unavail Start Time is Zeros
      *   |- c2    : WRK.Dock Unavail End Time is Zeros
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUDPTM    IFEQ *ZERO                      *IF
     C           WUDQTM    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      *       skip - not an error if times are zeros
     C                     ELSE
      * CASE: *OTHERWISE
      * ** If SSD = DDD then enforce the Restricted Time Range   W288
      * CASE: DTL.Deadline Departure Date EQ DTL.Scheduled Ship Date
     C           #DKZDT    IFEQ #1AODT                     *IF
      * ** Error if DDT falls within Shipping Restricted hours   W288
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.Deadline Departure Time GE WRK.Dock Unavail Star
      *   |- c2    : DTL.Deadline Departure Time LE WRK.Dock Unavail End
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DAXTM    IFGE WUDPTM                     *IF
     C           #DAXTM    IFLE WUDQTM                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     Z-ADD#1AFTM    ZA0026           Requested Deliv
      * Send message 'Invalid Dt Chg-DDD/T err2'
     C                     MOVEL'USR4223' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9934  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ** DDD/T cannot be in the past. Truck will not have time to load
      * ** and leave.
      * RTV System Date/Time   UP - /UT User Programs  * W288
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           WUSDTE    PARM *ZERO     WQ0067 155       Current System
     C           WUZHNB    PARM *ZERO     WQ0068 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * ** Error if DDD = Today & DDT is LT now - 1st order   W288
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.Deadline Departure Date EQ WRK.Current System Da
      *   |- c2    : DTL.Deadline Departure Time LE WRK.Current System Ti
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DKZDT    IFEQ WUSDTE                     *IF
     C           #DAXTM    IFLE WUZHNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #1AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0027
      * Send message 'Invalid Deadln Dt/Tm'
     C                     MOVEL'USR4233' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Select existing record
      *================================================================
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C                     MOVELV1C4NB    WK1X02  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     C           WK1X02    OREQ '?'                        Order Number
     C           YPMTFD    OREQ '#1C4NB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1AIC3' defaulted for 'Company Number'.
      * Field '(KEY) #1C4NB' defaulted for 'Order Number'.
     C                     CALL 'PDPCSRR'              90  SEL Order
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0009  30       Company Number
     C           #1C4NB    PARM #1C4NB    WQ0010  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPCSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     993132*
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1C4NB    IFNE *ZERO                      Order Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Company Name and Address
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1AIC3' defaulted for 'Company Number'.
     C                     CALL 'CAAJSRR'              90  SEL Company by
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0011  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAAJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9931  *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VBEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AIC3    IFEQ *ZERO                      Company Number
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBAB    KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADD#1AIC3    ABAIC3
     C           KLVBAB    CHAIN@ABREUA              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Company Name and Addre NF'
     C                     MOVEL'USR0003' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0003' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Order Types
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1JNCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Order Type - Sa
     C           YPMTFD    OREQ '#1JNCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1JNCD' defaulted for 'Order Type - Sales'.
     C                     CALL 'PDZ2SRR'              90  SEL OP Order Ty
     C                     PARM *BLANK    W0RTN   7
     C           #1JNCD    PARM #1JNCD    WQ0073  2        Order Type - Sa
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDZ2SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1JNCD    IFNE *BLANK                     Order Type - Sa
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1JNCD    IFEQ *BLANK                     Order Type - Sa
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCEX    KLIST
     C                     KFLD           EXJNCD           Order Type - Sa
      * Setup key
     C                     MOVEL#1JNCD    EXJNCD
     C           KLVCEX    CHAIN@EXRETY              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Order Types            NF'
     C                     MOVEL'USR1063' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1063' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check reference to Customer
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1ANC7'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1ANC7' defaulted for 'A/R Customer Number'.
     C                     CALL 'PDCJSRR'              90  SEL Customer by
     C                     PARM *BLANK    W0RTN   7
     C           #1ANC7    PARM #1ANC7    WQ0074  70       Ship To Custome
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1ANC7    IFNE *ZERO                      Ship To Custome
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VDEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1ANC7    IFEQ *ZERO                      Ship To Custome
     C                     GOTO VDEXIT
     C                     END
      *
     C           KLVDBB    KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1ANC7    BBBKC7
     C           KLVDBB    CHAIN@BBREWG              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VDEXIT
     C                     END
      * Send message 'Customer               NF'
     C                     MOVEL'USR0170' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0170' W0RTN
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         VECKRL    BEGSR
      *================================================================
      * Check reference to Customer
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1BKC7'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1BKC7' defaulted for 'Ship To Customer'.
     C                     CALL 'PDCJSRR'              90  SEL Customer by
     C                     PARM *BLANK    W0RTN   7
     C           #1BKC7    PARM #1BKC7    WQ0075  70       Ship To Custome
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1BKC7    IFNE *ZERO                      Ship To Custome
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VEEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1BKC7    IFEQ *ZERO                      Ship To Custome
     C                     GOTO VEEXIT
     C                     END
      *
     C           KLVEBB    KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1BKC7    BBBKC7
     C           KLVEBB    CHAIN@BBREWG              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VEEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VEEXIT
     C                     END
      * Send message 'Customer               NF'
     C                     MOVEL'USR0170' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0170' W0RTN
      *================================================================
     CSR         VEEXIT    ENDSR
      /EJECT
     CSR         VFCKRL    BEGSR
      *================================================================
      * Check reference to State
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DBCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        State Code
     C           YPMTFD    OREQ '#1DBCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1DBCD' defaulted for 'Ship To State Code'.
     C                     CALL 'CAAHSRR'              90  SEL State
     C                     PARM *BLANK    W0RTN   7
     C           #1DBCD    PARM #1DBCD    WQ0076  2        State Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAAHSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1DBCD    IFNE *BLANK                     State Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VFEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DBCD    IFEQ *BLANK                     State Code
     C                     GOTO VFEXIT
     C                     END
      *
     C           KLVFAC    KLIST
     C                     KFLD           ACBGCD           State Code
      * Setup key
     C                     MOVEL#1DBCD    ACBGCD
     C           KLVFAC    CHAIN@ACRET7              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VFEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VFEXIT
     C                     END
      * Send message 'State                  NF'
     C                     MOVEL'USR0005' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0005' W0RTN
      *================================================================
     CSR         VFEXIT    ENDSR
      /EJECT
     CSR         VGCKRL    BEGSR
      *================================================================
      * Check reference to Customer
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1B0C7'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1B0C7' defaulted for 'Bill to Customer'.
     C                     CALL 'PDCJSRR'              90  SEL Customer by
     C                     PARM *BLANK    W0RTN   7
     C           #1B0C7    PARM #1B0C7    WQ0077  70       Ship To Custome
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1B0C7    IFNE *ZERO                      Ship To Custome
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VGEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1B0C7    IFEQ *ZERO                      Ship To Custome
     C                     GOTO VGEXIT
     C                     END
      *
     C           KLVGBB    KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1B0C7    BBBKC7
     C           KLVGBB    CHAIN@BBREWG              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VGEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VGEXIT
     C                     END
      * Send message 'Customer               NF'
     C                     MOVEL'USR0170' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0170' W0RTN
      *================================================================
     CSR         VGEXIT    ENDSR
      /EJECT
     CSR         VHCKRL    BEGSR
      *================================================================
      * Check reference to State
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1BHCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        State Code
     C           YPMTFD    OREQ '#1BHCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1BHCD' defaulted for 'Bill to State Code'.
     C                     CALL 'CAAHSRR'              90  SEL State
     C                     PARM *BLANK    W0RTN   7
     C           #1BHCD    PARM #1BHCD    WQ0078  2        State Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAAHSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1BHCD    IFNE *BLANK                     State Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VHEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1BHCD    IFEQ *BLANK                     State Code
     C                     GOTO VHEXIT
     C                     END
      *
     C           KLVHAC    KLIST
     C                     KFLD           ACBGCD           State Code
      * Setup key
     C                     MOVEL#1BHCD    ACBGCD
     C           KLVHAC    CHAIN@ACRET7              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VHEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VHEXIT
     C                     END
      * Send message 'State                  NF'
     C                     MOVEL'USR0005' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0005' W0RTN
      *================================================================
     CSR         VHEXIT    ENDSR
      /EJECT
     CSR         VICKRL    BEGSR
      *================================================================
      * Check reference to Calendar
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1A0DT    IFEQ *ZERO                      Post to G/L Dat
     C                     GOTO VIEXIT
     C                     END
      *
     C           KLVIAF    KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADD#1AIC3    AFAIC3
     C                     Z-ADD#1A0DT    AFBCDT
     C           KLVIAF    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VIEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VIEXIT
     C                     END
      * Send message 'Calendar not found'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VIEXIT    ENDSR
      /EJECT
     CSR         VJCKRL    BEGSR
      *================================================================
      * Check reference to Calendar
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1A5DT    IFEQ *ZERO                      Post to G/L Dat
     C                     GOTO VJEXIT
     C                     END
      *
     C           KLVJAF    KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADD#1AIC3    AFAIC3
     C                     Z-ADD#1A5DT    AFBCDT
     C           KLVJAF    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VJEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VJEXIT
     C                     END
      * Send message 'Calendar not found'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VJEXIT    ENDSR
      /EJECT
     CSR         VKCKRL    BEGSR
      *================================================================
      * Check reference to Calendar
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1GNDT    IFEQ *ZERO                      Post to G/L Dat
     C                     GOTO VKEXIT
     C                     END
      *
     C           KLVKAF    KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADD#1AIC3    AFAIC3
     C                     Z-ADD#1GNDT    AFBCDT
     C           KLVKAF    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VKEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VKEXIT
     C                     END
      * Send message 'Calendar not found'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VKEXIT    ENDSR
      /EJECT
     CSR         VLCKRL    BEGSR
      *================================================================
      * Check reference to Calendar
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1ACDT    IFEQ *ZERO                      Post to G/L Dat
     C                     GOTO VLEXIT
     C                     END
      *
     C           KLVLAF    KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADD#1AIC3    AFAIC3
     C                     Z-ADD#1ACDT    AFBCDT
     C           KLVLAF    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VLEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VLEXIT
     C                     END
      * Send message 'Calendar not found'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VLEXIT    ENDSR
      /EJECT
     CSR         VMCKRL    BEGSR
      *================================================================
      * Check reference to Terms
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1AQCD    WK1X02  1
     C           WK1X02    IFEQ '?'                        Terms Code
     C           YPMTFD    OREQ '#1AQCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1AQCD' defaulted for 'Terms Code'.
     C                     CALL 'PDDMSRR'              90  SEL Active Term
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0079  30       Company Number
     C           #1AQCD    PARM #1AQCD    WQ0080  2        Terms Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDDMSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AQCD    IFNE *BLANK                     Terms Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VMEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AQCD    IFEQ *BLANK                     Terms Code
     C                     GOTO VMEXIT
     C                     END
      *
     C           KLVMAO    KLIST
     C                     KFLD           AOAIC3           Company Number
     C                     KFLD           AOAQCD           Terms Code
      * Setup key
     C                     Z-ADD#1AIC3    AOAIC3
     C                     MOVEL#1AQCD    AOAQCD
     C           KLVMAO    CHAIN@AOREU1              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VMEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VMEXIT
     C                     END
      * Send message 'Terms                  NF'
     C                     MOVEL'USR0037' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0037' W0RTN
      *================================================================
     CSR         VMEXIT    ENDSR
      /EJECT
     CSR         VNCKRL    BEGSR
      *================================================================
      * Check reference to Carrier
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1BZNA    WK1X01  1
     C           WK1X01    IFEQ '?'                        Carrier Code
     C           YPMTFD    OREQ '#1BZNA'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1BZNA' defaulted for 'Carrier Code'.
     C                     CALL 'OMY6SRR'              90  SEL Active Carr
     C                     PARM *BLANK    W0RTN   7
     C           #1BZNA    PARM #1BZNA    WQ0081  3        Carrier Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMY6SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1BZNA    IFNE *BLANK                     Carrier Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VNEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1BZNA    IFEQ *BLANK                     Carrier Code
     C                     GOTO VNEXIT
     C                     END
      *
     C           KLVNFF    KLIST
     C                     KFLD           FFBZNA           Carrier Code
      * Setup key
     C                     MOVEL#1BZNA    FFBZNA
     C           KLVNFF    CHAIN@FFREUG              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VNEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VNEXIT
     C                     END
      * Send message 'Carrier                NF'
     C                     MOVEL'USR1180' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1180' W0RTN
      *================================================================
     CSR         VNEXIT    ENDSR
      /EJECT
     CSR         VOCKRL    BEGSR
      *================================================================
      * Check reference to OP Reason Codes
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1CQCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Reason Code
     C           YPMTFD    OREQ '#1CQCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1CQCD' defaulted for 'Reason Code'.
     C                     CALL 'OPTNSRR'              90  SEL Order Reaso
     C                     PARM *BLANK    W0RTN   7
     C           #1CQCD    PARM #1CQCD    WQ0082  3        Reason Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OPTNSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1CQCD    IFNE *BLANK                     Reason Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VOEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1CQCD    IFEQ *BLANK                     Reason Code
     C                     GOTO VOEXIT
     C                     END
      *
     C           KLVOCX    KLIST
     C                     KFLD           CXCQCD           Reason Code
      * Setup key
     C                     MOVEL#1CQCD    CXCQCD
     C           KLVOCX    CHAIN@CXRET4              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VOEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VOEXIT
     C                     END
      * Send message 'OP Reason Codes        NF'
     C                     MOVEL'USR0504' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0504' W0RTN
      *================================================================
     CSR         VOEXIT    ENDSR
      /EJECT
     CSR         VPCKRL    BEGSR
      *================================================================
      * Check reference to Calendar
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1AODT    IFEQ *ZERO                      Post to G/L Dat
     C                     GOTO VPEXIT
     C                     END
      *
     C           KLVPAF    KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADD#1AIC3    AFAIC3
     C                     Z-ADD#1AODT    AFBCDT
     C           KLVPAF    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VPEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VPEXIT
     C                     END
      * Send message 'Calendar not found'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VPEXIT    ENDSR
      /EJECT
     CSR         VQCKRL    BEGSR
      *================================================================
      * Check reference to User Profile Control
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1AIVN    WK1X01  1
     C           WK1X01    IFEQ '?'                        User Profile Na
     C           YPMTFD    OREQ '#1AIVN'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIVN' defaulted for 'User Original Entry'.
     C                     CALL 'CAXPSRR'              90  SEL User Profil
     C                     PARM *BLANK    W0RTN   7
     C           #1AIVN    PARM #1AIVN    WQ0083 10        User Profile Na
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAXPSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AIVN    IFNE *BLANK                     User Profile Na
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VQEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AIVN    IFEQ *BLANK                     User Profile Na
     C                     GOTO VQEXIT
     C                     END
      *
     C           KLVQDR    KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVEL#1AIVN    DRAJVN
     C           KLVQDR    CHAIN@DRRETH              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VQEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VQEXIT
     C                     END
      *================================================================
     CSR         VQEXIT    ENDSR
      /EJECT
     CSR         VRCKRL    BEGSR
      *================================================================
      * Check reference to Calendar
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1EIDT    IFEQ *ZERO                      Post to G/L Dat
     C                     GOTO VREXIT
     C                     END
      *
     C           KLVRAF    KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADD#1AIC3    AFAIC3
     C                     Z-ADD#1EIDT    AFBCDT
     C           KLVRAF    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VREXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VREXIT
     C                     END
      * Send message 'Calendar not found'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VREXIT    ENDSR
      /EJECT
     CSR         VSCKRL    BEGSR
      *================================================================
      * Check reference to Enterprise Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1E8CD    WK1X02  1
     C                     MOVEL#1E9CD    WK1X03  1
     C           WK1X02    IFEQ '?'                        Enterprise Code
     C           YPMTFD    OREQ '#1E8CD'
     C           WK1X03    OREQ '?'                        Enterprise Code
     C           YPMTFD    OREQ '#1E9CD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1E8CD' defaulted for 'Accounts Receiv. Ent 1'.
      * Field '(DTL) #1E9CD' defaulted for 'Accounts Receiv. Ent 2'.
     C                     CALL 'CAXTSRR'              90  SEL Enterprise
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0084  30       Company Number
     C           #1E8CD    PARM #1E8CD    WQ0085  4        Enterprise Code
     C           #1E9CD    PARM #1E9CD    WQ0086 12        Enterprise Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAXTSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1E8CD    IFNE *BLANK                     Enterprise Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1E9CD    IFNE *BLANK                     Enterprise Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X03    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VSEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1E8CD    IFEQ *BLANK                     Enterprise Code
     C           #1E9CD    ANDEQ*BLANK                     Enterprise Code
     C                     GOTO VSEXIT
     C                     END
      *
     C           KLVSDS    KLIST
     C                     KFLD           DSAIC3           Company Number
     C                     KFLD           DSDQCD           Enterprise Code
     C                     KFLD           DSDRCD           Enterprise Code
      * Setup key
     C                     Z-ADD#1AIC3    DSAIC3
     C                     MOVEL#1E8CD    DSDQCD
     C                     MOVEL#1E9CD    DSDRCD
     C           KLVSDS    CHAIN@DSRETN              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VSEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VSEXIT
     C                     END
      * Send message 'Enterprise Master      NF'
     C                     MOVEL'USR0765' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0765' W0RTN
      *================================================================
     CSR         VSEXIT    ENDSR
      /EJECT
     CSR         VTCKRL    BEGSR
      *================================================================
      * Check reference to Load Header
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1RMNB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1RMNB' defaulted for 'Load ID'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
     C                     CALL 'OMCPSRR'              90  SEL Load ID
     C                     PARM *BLANK    W0RTN   7
     C           #1RMNB    PARM #1RMNB    WQ0087  70       Load ID
     C           #1AIC3    PARM #1AIC3    WQ0088  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMCPSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1RMNB    IFNE *ZERO                      Load ID
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VTEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1RMNB    IFEQ *ZERO                      Load ID
     C                     GOTO VTEXIT
     C                     END
      *
     C           KLVTFJ    KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    FJRMNB
     C           KLVTFJ    CHAIN@FJCPBN              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VTEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VTEXIT
     C                     END
      * Send message 'Load Header            NF'
     C                     MOVEL'USR1188' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1188' W0RTN
      *================================================================
     CSR         VTEXIT    ENDSR
      /EJECT
     CSR         VUCKRL    BEGSR
      *================================================================
      * Check reference to Sales Route
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1R4CD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Sales Route Cod
     C           YPMTFD    OREQ '#1R4CD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1R4CD' defaulted for 'Sales Route Code'.
     C                     CALL 'PDFWSRR'              90  SEL PD Sales Ro
     C                     PARM *BLANK    W0RTN   7
     C           #1R4CD    PARM #1R4CD    WQ0089  3        Sales Route Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDFWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1R4CD    IFNE *BLANK                     Sales Route Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VUEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1R4CD    IFEQ *BLANK                     Sales Route Cod
     C                     GOTO VUEXIT
     C                     END
      *
     C           KLVUJE    KLIST
     C                     KFLD           JER4CD           Sales Route Cod
      * Setup key
     C                     MOVEL#1R4CD    JER4CD
     C           KLVUJE    CHAIN@JEREWS              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VUEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VUEXIT
     C                     END
      * Send message 'Sales Route            NF'
     C                     MOVEL'USR1800' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1800' W0RTN
      *================================================================
     CSR         VUEXIT    ENDSR
      /EJECT
     CSR         VVCKRL    BEGSR
      *================================================================
      * Check reference to Manager Level
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1BFCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Manager Level C
     C           YPMTFD    OREQ '#1BFCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1BFCD' defaulted for 'Manager Level Code'.
     C                     CALL 'CABRSRR'              90  SEL Manager Lev
     C                     PARM *BLANK    W0RTN   7
     C           #1BFCD    PARM #1BFCD    WQ0090  2        Manager Level C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CABRSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1BFCD    IFNE *BLANK                     Manager Level C
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VVEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1BFCD    IFEQ *BLANK                     Manager Level C
     C                     GOTO VVEXIT
     C                     END
      *
     C           KLVVAL    KLIST
     C                     KFLD           ALBFCD           Manager Level C
      * Setup key
     C                     MOVEL#1BFCD    ALBFCD
     C           KLVVAL    CHAIN@ALREVE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VVEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VVEXIT
     C                     END
      * Send message 'Manager Level          NF'
     C                     MOVEL'USR0030' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0030' W0RTN
      *================================================================
     CSR         VVEXIT    ENDSR
      /EJECT
     CSR         VWCKRL    BEGSR
      *================================================================
      * Check reference to VP Level
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1Q4CD    WK1X01  1
     C           WK1X01    IFEQ '?'                        VP Level Code
     C           YPMTFD    OREQ '#1Q4CD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1Q4CD' defaulted for 'VP Level Code'.
     C                     CALL 'PDE0SRR'              90  SEL VP Level Ac
     C                     PARM *BLANK    W0RTN   7
     C           #1Q4CD    PARM #1Q4CD    WQ0091  3        VP Level Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDE0SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1Q4CD    IFNE *BLANK                     VP Level Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VWEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1Q4CD    IFEQ *BLANK                     VP Level Code
     C                     GOTO VWEXIT
     C                     END
      *
     C           KLVWIF    KLIST
     C                     KFLD           IFQ4CD           VP Level Code
      * Setup key
     C                     MOVEL#1Q4CD    IFQ4CD
     C           KLVWIF    CHAIN@IFREWB              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VWEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VWEXIT
     C                     END
      * Send message 'VP Level               NF'
     C                     MOVEL'USR1661' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1661' W0RTN
      *================================================================
     CSR         VWEXIT    ENDSR
      /EJECT
     CSR         VXCKRL    BEGSR
      *================================================================
      * Check reference to Order Header TRG
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1T3NB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1T3NB' defaulted for 'Attach to Order Number'.
     C                     CALL 'PDPCSRR'              90  SEL Order
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0092  30       Company Number
     C           #1T3NB    PARM #1T3NB    WQ0093  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPCSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1T3NB    IFNE *ZERO                      Order Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VXEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1T3NB    IFEQ *ZERO                      Order Number
     C                     GOTO VXEXIT
     C                     END
      *
     C           KLVXBE    KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    BEAIC3
     C                     Z-ADD#1T3NB    BEC4NB
     C           KLVXBE    CHAIN@BECPFK              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VXEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VXEXIT
     C                     END
      * Send message 'Order Header TRG       NF'
     C                     MOVEL'USR0176' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0176' W0RTN
      *================================================================
     CSR         VXEXIT    ENDSR
      /EJECT
     CSR         VYCKRL    BEGSR
      *================================================================
      * Check reference to Internal Reason
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1SICD    IFEQ *BLANK                     Internal Reason
     C                     GOTO VYEXIT
     C                     END
      *
     C           KLVYJH    KLIST
     C                     KFLD           JHSGCD           Internal Reason
      * Setup key
     C                     MOVEL#1SICD    JHSGCD
     C           KLVYJH    CHAIN@JHREXO              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VYEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VYEXIT
     C                     END
      * Send message 'Internal Reason        NF'
     C                     MOVEL'USR1835' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1835' W0RTN
      *================================================================
     CSR         VYEXIT    ENDSR
      /EJECT
     CSR         VZCKRL    BEGSR
      *================================================================
      * Check reference to Calendar
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1AWDT    IFEQ *ZERO                      Post to G/L Dat
     C                     GOTO VZEXIT
     C                     END
      *
     C           KLVZAF    KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADD#1AIC3    AFAIC3
     C                     Z-ADD#1AWDT    AFBCDT
     C           KLVZAF    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VZEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VZEXIT
     C                     END
      * Send message 'Calendar not found'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VZEXIT    ENDSR
      /EJECT
     CSR         WACKRL    BEGSR
      *================================================================
      * Check reference to Event Types
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1JPCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Event Code
     C           YPMTFD    OREQ '#1JPCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1JPCD' defaulted for 'Event Code'.
     C                     CALL 'PDEQSRR'              90  SEL Event Types
     C                     PARM *BLANK    W0RTN   7
     C           #1JPCD    PARM #1JPCD    WQ0094  2        Event Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEQSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1JPCD    IFNE *BLANK                     Event Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO WAEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1JPCD    IFEQ *BLANK                     Event Code
     C                     GOTO WAEXIT
     C                     END
      *
     C           KLWAEZ    KLIST
     C                     KFLD           EZJPCD           Event Code
      * Setup key
     C                     MOVEL#1JPCD    EZJPCD
     C           KLWAEZ    CHAIN@EZREYT              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO WAEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO WAEXIT
     C                     END
      * Send message 'Event Types            NF'
     C                     MOVEL'USR1076' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1076' W0RTN
      *================================================================
     CSR         WAEXIT    ENDSR
      /EJECT
     CSR         WBCKRL    BEGSR
      *================================================================
      * Check reference to A/R Claim
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1C0C7'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1C0C7' defaulted for 'Claim Number'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(LCL) YL0018' defaulted for 'Claim Company Number'.
      * Field '(LCL) YL0019' defaulted for 'Claim Ship to Customer'.
     C                     CALL 'PMCSSRR'              90  Sel A/R Claim
     C                     PARM *BLANK    W0RTN   7
     C           #1C0C7    PARM #1C0C7    WQ0095  70       Claim Number
     C           YL0018    PARM YL0018    WQ0096  30       Claim Company N
     C           YL0019    PARM YL0019    WQ0097  70       Claim Ship to C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCSSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1C0C7    IFNE *ZERO                      Claim Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO WBEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1C0C7    IFEQ *ZERO                      Claim Number
     C                     GOTO WBEXIT
     C                     END
      *
     C           KLWBMK    KLIST
     C                     KFLD           MKC0C7           Claim Number
      * Setup key
     C                     Z-ADD#1C0C7    MKC0C7
     C           KLWBMK    CHAIN@MKCPWB              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO WBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO WBEXIT
     C                     END
      * Send message 'A/R Claim              NF'
     C                     MOVEL'USR2729' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR2729' W0RTN
      *================================================================
     CSR         WBEXIT    ENDSR
      /EJECT
     CSR         WCCKRL    BEGSR
      *================================================================
      * Check reference to Company Name and Address
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1AIC3' defaulted for 'Company Number'.
     C                     CALL 'CAAJSRR'              90  SEL Company by
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0163  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAAJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9931  *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO WCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AIC3    IFEQ *ZERO                      Company Number
     C                     GOTO WCEXIT
     C                     END
      *
     C           KLWCAB    KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADD#1AIC3    ABAIC3
     C           KLWCAB    CHAIN@ABREUA              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO WCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO WCEXIT
     C                     END
      * Send message 'Company Name and Addre NF'
     C                     MOVEL'USR0003' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0003' W0RTN
      *================================================================
     CSR         WCEXIT    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         YKDDW1    BEGSR
      *================================================================
      * Calculate window location for drop down lists on screen 1
      *================================================================
      *================================================================
     CSR         YKEXT1    ENDSR
      /EJECT
     CSR         YKDDW2    BEGSR
      *================================================================
      * Calculate window location for drop down lists on screen 2
      *================================================================
      *================================================================
     CSR         YKEXT2    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
     C           *IN25     IFEQ '0'
      * Bypass when help done
     C                     SETOF                     94    *
     C           W0OVR0    IFEQ '1'
     C           W0OVR0    OREQ '0'
     C           *IN99     ANDEQ'0'
      * If override or no error
     C                     SETON                     94    *
     C                     Z-ADDW0ROW0    ZZCSRW
     C                     Z-ADDW0COL0    ZZCSCL
     C                     END
     C                     END
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y1SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y1EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C           @#DFMT    IFEQ '#RCDKEY'
      * KEY Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ##WSR     MULT 256       ZWORK   50
     C                     ADD  ##WSC     ZWORK
     C                     SUB  ZWORK     ZINPOS
     C                     SUB  1         ZINPOS
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
     C                     ENDIF
     C           @#DFMT    IFEQ '#RCDDTL1'
      * DETAIL Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ##WSR1    MULT 256       ZWORK   50
     C                     ADD  ##WSC1    ZWORK
     C                     SUB  ZWORK     ZINPOS
     C                     SUB  1         ZINPOS
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW1END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW1BEG,F
     C                     MOVELW1NAM,F   W0CFL
     C                     ENDIF
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
     C                     SETOF                     94    *
     C                     Z-ADD0         W0ROW0  30
     C                     Z-ADD0         W0COL0  30
     C                     MOVE '2'       W0OVR0  1
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C           @#WWRC    DIV  256       ZZCSRW  30       Row
     C                     MVR            ZZCSCL  30       Column
      *
      *
      * Calculate window offset
     C           004       ADD  ##WSR     YWPORW  30
     C           021       ADD  ##WSC     YWPOC1  30
     C                     ADD  1         YWPOC1
     C           023       ADD  ##WSC     YWPOC2  30
     C                     ADD  1         YWPOC2
     C           ZHCSRW    IFEQ YWPORW
     C           ZHCSCL    ANDGEYWPOC1
     C           ZHCSCL    ANDLEYWPOC2
     C           @#DFMT    ANDEQ'#RCDKEY'
     C           *IN79     ANDEQ'0'
     C                     MOVEL'#1AIC3'  YPMTFD           Company Number
     C                     END
      *
      *
      * Calculate window offset
     C           005       ADD  ##WSR     YWPORW  30
     C           021       ADD  ##WSC     YWPOC1  30
     C                     ADD  1         YWPOC1
     C           027       ADD  ##WSC     YWPOC2  30
     C                     ADD  1         YWPOC2
     C           ZHCSRW    IFEQ YWPORW
     C           ZHCSCL    ANDGEYWPOC1
     C           ZHCSCL    ANDLEYWPOC2
     C           @#DFMT    ANDEQ'#RCDKEY'
     C                     MOVEL'#1C4NB'  YPMTFD           Order Number
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C           @#WWRC    DIV  256       ZZCSRW  30       Row
     C                     MVR            ZZCSCL  30       Column
      *
     C           YWPNNO    IFEQ 1                          Check panel num
     C           ZHCSRW    SUB  ##WSR     YWPORW  30
     C           ZHCSCL    SUB  ##WSC     YWPOC1  30
     C                     SUB  1         YWPOC1
     C                     ELSE
     C           YWPNNO    IFEQ 2                          Check panel num
     C           ZHCSRW    SUB  ##WSR1    YWPORW  30
     C           ZHCSCL    SUB  ##WSC1    YWPOC1  30
     C                     SUB  1         YWPOC1
     C                     END
     C                     END
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM YWPORW    YYRW    50       Row
     C                     PARM YWPOC1    YYCL    50       Column
     C                     PARM 1         YYLGCT  50       # of grps
     C                     PARM W0GRP     YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZRRPWD    BEGSR
      *================================================================
      * *Reposition window
      *================================================================
     C                     Z-ADDYWPNNO    W       10
     C                     MOVEL'Y'       YSL,W            Set wdw locatio
     C                     MOVEL'R'       YWLCTP  1        Locate action t
     C                     EXSR ZSSTLC                     Set window loca
      *
      * Redisplay previous panel
     C           YWPNNO    IFEQ W0WASM
     C                     WRITEASSUME
     C                     ELSE
     C                     SELEC
     C           YWPNNO    WHEQ 2
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#RCDKEY
     C                     ENDSL
     C                     END
     C           YWPNNO    IFEQ 1
     C                     MOVEL'K'       W0TRN   1
     C                     ELSE
     C                     MOVEL'R'       W0TRN   1
     C                     END
      *================================================================
     CSR         ZREXIT    ENDSR
      /EJECT
     CSR         ZSSTLC    BEGSR
      *================================================================
      * Set window location
      *================================================================
     C           YWPNNO    IFEQ 1                          Check panel num
     C           YSL,1     ANDEQ'Y'                        Set wdw locatio
     C                     MOVEL'*CALC'   YWWDCR           Window referenc
     C                     Z-ADD-3        YWWDRW           Window start ro
     C                     Z-ADD-3        YWWDCL           Window start co
     C                     Z-ADD062       YWWDWD           Window width
     C                     Z-ADD014       YWWDDP           Window depth
     C                     MOVEL'N'       YSL,1            Set wdw locatio
      *
     C                     EXSR ZURTLC                     Retrieve window
     C                     EXSR ZTWDFD                     Move window fie
     C                     ELSE
     C           YWPNNO    IFEQ 2                          Check panel num
     C           YSL,2     ANDEQ'Y'                        Set wdw locatio
     C                     MOVEL'*CALC'   YWWDCR           Window referenc
     C                     Z-ADD-3        YWWDRW           Window start ro
     C                     Z-ADD-3        YWWDCL           Window start co
     C                     Z-ADD067       YWWDWD           Window width
     C                     Z-ADD015       YWWDDP           Window depth
     C                     MOVEL'N'       YSL,2            Set wdw locatio
      *
     C                     EXSR ZURTLC                     Retrieve window
     C                     EXSR ZTWDFD                     Move window fie
     C                     END
     C                     END
      *================================================================
     CSR         ZSEXIT    ENDSR
      /EJECT
     CSR         ZTWDFD    BEGSR
      *================================================================
      * Move window fields by panel
      *================================================================
     C           YWPNNO    IFEQ 1                          Check panel num
     C                     Z-ADDYWWDRW    ##WSR            Window start ro
     C                     Z-ADDYWWDCL    ##WSC            Window start co
     C                     EXSR YKDDW1
     C                     ELSE
     C           YWPNNO    IFEQ 2                          Check panel num
     C                     Z-ADDYWWDRW    ##WSR1           Window start ro
     C                     Z-ADDYWWDCL    ##WSC1           Window start co
     C                     EXSR YKDDW2
     C                     END
     C                     END
      *================================================================
     CSR         ZTEXIT    ENDSR
      /EJECT
     CSR         ZURTLC    BEGSR
      *================================================================
      * Retrieve window location
      *================================================================
      *
      * Set up parameters to API
      *
      * Return code
     C                     MOVEL*BLANKS   W0RTN
      * Retrieval Function
     C                     MOVEL*BLANKS   YWRTFN
     C                     MOVEL'*WDWLOC' YWRTFN
      *
     C                     SETOF                       90  *
      *
     C                     CALL 'YWRTLCI'              90  *
     C                     PARM           YWRTFN 10        Retrieval Funct
     C                     PARM           YWWDWD  30       Window width
     C                     PARM           YWWDDP  30       Window depth
     C                     PARM           YWWDCR  5        Window referenc
     C                     PARM           YWWDRW  30       *Window start r
     C                     PARM           YWWDCL  30       *Window start c
     C                     PARM           W0RTN            Return code
      * If error on call to API - default window location to top left cor
     C           *IN90     IFEQ '1'
     C           W0RTN     ORNE *BLANKS
     C                     Z-ADD2         YWWDRW           *Window start r
     C                     Z-ADD2         YWWDCL           *Window start c
     C                     END
      *
      *================================================================
     CSR         ZUEXIT    ENDSR
      /EJECT
     CSR         ZVCFPM    BEGSR
      *================================================================
      * Set Confirm Prompt window location
      *================================================================
      *
     C           YWPNNO    IFEQ 1                          Check panel num
     C           ##WSR     ADD  014       YWWDRW
     C           ##WSC     ADD  062       YWWDCL
     C                     ELSE
     C           YWPNNO    IFEQ 2                          Check panel num
     C           ##WSR1    ADD  015       YWWDRW
     C           ##WSC1    ADD  067       YWWDCL
     C                     END
     C                     END
      *
     C                     ADD  1         YWWDCL
     C                     SUB  1         YWWDRW           Window start ro
     C                     SUB  21        YWWDCL           Window start co
     C                     Z-ADD18        YWWDWD           Window width
     C                     Z-ADD2         YWWDDP           Window depth
     C                     MOVEL'*TL  '   YWWDCR           Window referenc
     C                     MOVEL*BLANKS   YWRTFN
     C                     MOVEL'*WDWLOC' YWRTFN           Retrieval Funct
     C                     EXSR ZURTLC                     Retrieve window
     C                     Z-ADDYWWDRW    ##WSRC           *Window start r
     C                     Z-ADDYWWDCL    ##WSCC           *Window start c
      *
      *================================================================
     CSR         ZVEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel and exit from key screen
      *================================================================
      * USER: Exit program processing
      * CASE: DTL.*CMD key is *Exit
     C           *IN03     IFEQ '1'                        *IF
      * CHG Order in Use       CH - Order Header TRG  * 
     C                     EXSR SUCHRC
     C                     END                             *FI
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P2ECST           Error Status
     C                     MOVEL*BLANK    P3AJCD           Warehouse Code
     C                     MOVEL*BLANK    P3DNCD           Application Cod
     C                     MOVEL*BLANK    P3BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P3AJVN           User Profile Na
     C                     MOVEL*BLANK    P3I6ST           Allow Multi-Com
     C                     MOVEL*BLANK    P3MPNA           Default Printer
     C                     MOVEL*BLANK    P3TAST           First Time Flag
     C                     MOVEL*BLANK    P4ATUS           STATUS
     C                     MOVEL*BLANK    P5YJSX           Company Organiz
     C                     MOVEL*BLANK    P6T0ST           Warehouse Locat
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialise Allow Set Window Location flags
     C                     MOVEA*ALL'Y'   YSL
      * Set display size
     C                     SETOF                         93*
     C           @#SCRW    COMP 27                       93*
      * Initialise window location variables.
     C                     Z-ADD*ZEROS    ##WSR
     C                     Z-ADD*ZEROS    ##WSC
     C                     Z-ADD*ZEROS    ##WSR1
     C                     Z-ADD*ZEROS    ##WSC1
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field First Time Flag
     C                     MOVEL*BLANK    WUTAST  1
      * Define work field U/M - Ordered
     C                     MOVEL*BLANK    WUAGCD  2
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WADBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WABWC3           Shipping Compan
     C                     Z-ADD*ZERO     WABTC3           Accounting Comp
     C                     Z-ADD*ZERO     WABUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WABVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Order Number
     C                     Z-ADD*ZERO     WUC4NB  70
      * Define work field Company Number
     C                     Z-ADD*ZERO     WUAIC3  30
      * Define work field City
     C                     MOVEL*BLANK    WUAJNA 20
      * Define work field State Code
     C                     MOVEL*BLANK    WUBGCD  2
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Define work field Allow Mult Whse to Order
     C                     MOVEL*BLANK    WUHSST  1
      * Define work field *SFLSEL
     C                     MOVEL*BLANK    WUSEL   1
      * Define work field Must Ship Error
     C                     MOVEL*BLANK    WUB7SX  3
      * Define work field Must Ship Date        USR
     C                     Z-ADD*ZERO     WULYDT  70
      * Define work field Must Ship Time        USR
     C                     Z-ADD*ZERO     WUA5TM  60
      * Define work field Dock Unavail Start Time
     C                     Z-ADD*ZERO     WUDPTM  60
      * Define work field Dock Unavail End Time
     C                     Z-ADD*ZERO     WUDQTM  60
      * Define work field Current System Date
     C                     Z-ADD*ZERO     WUSDTE 155
      * Define work field Current System Time
     C                     Z-ADD*ZERO     WUZHNB 155
      * Define work field Type Code
     C                     MOVEL*BLANK    WUBOCD  2
      * Define work field Shipping Company
     C                     Z-ADD*ZERO     WUBWC3  30
      * Define work field Accounting Company
     C                     Z-ADD*ZERO     WUBTC3  30
      * Define work field Error Status  3
     C                     MOVEL*BLANK    WUTXST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBDPNB           Order Sequence
     C                     Z-ADD*ZERO     WBUENB           Order Secondary
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WBMAVA           Billing Detail
     C                     Z-ADD*ZERO     WBKDVA           Billing Detail
     C                     Z-ADD*ZERO     WBL8VA           Billing Detail
     C                     Z-ADD*ZERO     WBL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WBAYVA           Extended Amount
     C                     Z-ADD*ZERO     WBEXDT           Market Pricing
     C                     Z-ADD*ZERO     WBBZPR           Price Overage O
     C                     Z-ADD*ZERO     WBL6NB           Contract Number
     C                     Z-ADD*ZERO     WBGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WBD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WBCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WBAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WBCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WBATWG           Weight Shipped
     C                     Z-ADD*ZERO     WBAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WBAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WBAKPR           Unit Price
     C                     Z-ADD*ZERO     WBALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WBAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WBAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WBA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBRGNB           Item Structure
     C                     Z-ADD*ZERO     WBRHNB           Item Structure
     C                     Z-ADD*ZERO     WBRINB           Item Structure
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WBB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WBA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WBNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WBNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WBNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WBNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WBNXDT           OD Firm Date
     C                     Z-ADD*ZERO     WBBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WBBVTM           Price Code
     C                     Z-ADD*ZERO     WBBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WBBXTM           Substitution Li
     C                     Z-ADD*ZERO     WBBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WBH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WBH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WBH7NX           OD Item Target
     C                     Z-ADD*ZERO     WBH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WBH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WBDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WBDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WBDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WBDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WBDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WBGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WBGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WBGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WBPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WBRINY           Item Age Days
     C                     Z-ADD*ZERO     WBTIDT           Production Ovr
     C                     Z-ADD*ZERO     WBTJDT           Production Ovr
     C                     Z-ADD*ZERO     WBTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WBTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WBTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCDPNB           Order Sequence
     C                     Z-ADD*ZERO     WCUENB           Order Secondary
     C                     Z-ADD*ZERO     WCRZNB           Case Sequence N
     C                     Z-ADD*ZERO     WCFOQT           Case Quantity
     C                     Z-ADD*ZERO     WCR0NB           Case Weight
     C                     Z-ADD*ZERO     WCK7DT           Label Date
     C                     Z-ADD*ZERO     WCPFNX           PT Serial Numbe
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCELDT           Production Date
     C                     Z-ADD*ZERO     WCN5WG           Manifest Gross
     C                     Z-ADD*ZERO     WCH5NY           Manifest Total
     C                     Z-ADD*ZERO     WCH6NY           Manifest Co-Par
     C                     Z-ADD*ZERO     WCH7NY           Manifest Pallet
     C                     Z-ADD*ZERO     WCN6WG           HPB Meter Net G
     C                     Z-ADD*ZERO     WCN7WG           Manifest Net We
     C                     Z-ADD*ZERO     WCRBDT           Manifest Unused
     C                     Z-ADD*ZERO     WCITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WCIVNY           HPB Meter Start
     C                     Z-ADD*ZERO     WCIUNY           HPB Meter Endin
     C                     Z-ADD*ZERO     WCIWNY           HPB Meter Total
     C                     Z-ADD*ZERO     WCIXNY           HPB Meter Net W
     C                     Z-ADD*ZERO     WCIYNY           HPB Density Ref
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field USR Update Flag
     C                     MOVEL*BLANK    WUR4ST  1
      * Define work field COA RIN Modified Sts
     C                     MOVEL*BLANK    WURINS  1
      * Define work field Access Denied (Y/N)
     C                     MOVEL*BLANK    WUWVST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize *SET CURSOR data
     C                     MOVE 'Y'       YSETCS  1
     C                     EXSR Y9CLR
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    YRWF00  40       Requested Deliv
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     MOVEL*BLANK    WL0002 10
     C                     Z-ADD*ZERO     WL0003 155
      * Define local variables for subroutine SDRVGN.
     C                     MOVEL*BLANK    WL0004  3
     C                     MOVEL*BLANK    WL0005 30
      * Define local variables for subroutine SERVGN.
     C                     MOVEL*BLANK    WL0006  3
     C                     MOVEL*BLANK    WL0007  1
      * Define local variables for subroutine SFRVGN.
     C                     MOVEL*BLANK    WL0008  3
     C                     MOVEL*BLANK    WL0009  1
     C                     MOVEL*BLANK    WL0010  1
     C                     Z-ADD*ZERO     WL0011  30
     C                     Z-ADD*ZERO     WL0012  30
     C                     MOVEL*BLANK    WL0013  1
      * Define local variables for subroutine SJRVGN.
     C                     MOVEL*BLANK    WL0014  3
      * Define local variables for subroutine SWRVGN.
     C                     MOVEL*BLANK    WL0015 10
     C                     MOVEL*BLANK    WL0016  6
     C                     Z-ADD*ZERO     WL0017  30
     C                     MOVEL*BLANK    WL0018  3
      * Define local work field Boxes Total Quantity
     C                     Z-ADD*ZERO     YL0001 112
      * Define local work field U/M - Ordered
     C                     MOVEL*BLANK    YL0002  2
      * Define local work field Box Load Min Box Qty USR
     C                     Z-ADD*ZERO     YL0003  50
      * Define null work field Trans Contol AS400/Plant
     C                     MOVEL*BLANK    YN0001  1
      * Define null work field Warehouse Location
     C                     MOVEL*BLANK    YN0002  1
      * Define local work field Shipping Company USR
     C                     Z-ADD*ZERO     YL0004  30
      * Define null work field Accounting Company
     C                     Z-ADD*ZERO     YN0003  30
      * Define null work field WHS Live w/Carlisle
     C                     MOVEL*BLANK    YN0004  1
      * Define local work field Requested Delivery TimeUS
     C                     Z-ADD*ZERO     YL0005  40
      * Define local work field Order in Use
     C                     MOVEL*BLANK    YL0006  1
      * Define local work field Header Status
     C                     MOVEL*BLANK    YL0007  1
      * Define local work field Load ID
     C                     Z-ADD*ZERO     YL0008  70
      * Define local work field Load Status
     C                     MOVEL*BLANK    YL0009  1
      * Define local work field Application WHS Restrict
     C                     MOVEL*BLANK    YL0010  1
      * Define local work field Shipping Company
     C                     Z-ADD*ZERO     YL0011  30
      * Define local work field WHS/Item Access Sts USR
     C                     MOVEL*BLANK    YL0012  1
      * Define local work field USR Remainder
     C                     Z-ADD*ZERO     YL0013  40
      * Define local work field Production Warehouse Code
     C                     MOVEL*BLANK    YL0014  3
      * Define local work field Warehouse Location
     C                     MOVEL*BLANK    YL0015  1
      * Define local work field WHS Req Meter Reading Shp
     C                     MOVEL*BLANK    YL0016  1
      * Define local work field Count USR
     C                     Z-ADD*ZERO     YL0017  50
      * Define local work field Claim Company Number
     C                     Z-ADD*ZERO     YL0018  30
      * Define local work field Claim Ship to Customer
     C                     Z-ADD*ZERO     YL0019  70
      * Define local work field Production Warehouse
     C                     MOVEL*BLANK    YL0020  3
      * Define null work field Accounting Company
     C                     Z-ADD*ZERO     YN0005  30
      * Define local work field Live with TPM
     C                     MOVEL*BLANK    YL0021  1
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0022  30
      * Define local work field Name
     C                     MOVEL*BLANK    YL0023 30
      * Define local work field System Value Alpha
     C                     MOVEL*BLANK    YL0024 40
      * Define local work field Access Denied (Y/N)
     C                     MOVEL*BLANK    YL0025  1
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0026  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0027  3
      * Define local work field Shipping Company
     C                     Z-ADD*ZERO     YL0028  30
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * Set to *CHANGE mode
     C                     MOVEL'CHG'     W0PMD   3
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * CASE: PAR.Company Number is Equal to zero
     C           P1AIC3    IFEQ *ZERO                      *IF
      *
     C                     MOVEL*BLANK    WN0375 10        User Profile Na
      *
      * VAL Set Int.Acc No Hdg IF
     C                     MOVEL##USR     WN0375           User Profile Na
      *
     C                     MOVEL*BLANK    WN0376 10        User Code Model
      *
      * VAL User/Appl No Exit  IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR SVRVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,002                    *IF
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0376    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0375    WL0015    P      User Profile Na
     C                     MOVEL'P/S'     WL0016    P      Application Cod
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0017    WUAIC3           Company Number
     C                     MOVELWL0018    YL0027    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0376    WL0015    P      User Profile Na
     C                     MOVEL'P/S'     WL0016    P      Application Cod
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0017    WUAIC3           Company Number
     C                     MOVELWL0018    YL0027    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0027    P3AJCD           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: LCL.Company Number is greater than zero
     C           YL0026    IFGT 0                          *IF
     C                     Z-ADDYL0026    WUAIC3           Company Number
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0027    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  RT - Warehouse  * 
     C                     EXSR SXRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWUAIC3    YL0022           Company Number
     C                     MOVELWUWVST    YL0025           Access Denied (
      * If access denied is no, rtv co. name
      * CASE: WRK.Access Denied (Y/N) is no
     C           WUWVST    IFEQ 'N'                        *IF
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SYRVGN
     C                     END                             *FI
     C                     END                             *FI
      * RTV Appl Whs Restrict  RT - User Profile Control  * 
     C                     EXSR SZRVGN
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** KEY Screen: Field position and name array
0104501301
** W0END
0104701307
** W0NAM
V1AIC3    V1C4NB
** W1BEG
01042010610129801317013200157301583
020740210402330023600284202849
** W1END
01044010670129801318013310158001590
020810211102337023630284402878
** W1NAM
V1AIC3    V1C4NB    #1U2ST    #DAGCD    #DHLTX    VDKZDT    #DAXTM
V1AODT    V1EIDT    V1A5DT    #1AFTM    #DAJCD    #DF8NA
** @CN
00001 USR0752
00002 Y2U0005
00003 CHGWHS
