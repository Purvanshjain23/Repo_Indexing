// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PDD5EFR
// ?Date: 14.08.2025 Time: 03:34:17
// ?------------------------------------------------------------------------------------------------

//?USER: Initialize program

// WRK.Sales Type Code = CON.REG
WRK.Sales_Type_Code = 'REG';

// LCL.Sales Type Code Usr = CON.RTV
LCL.Sales_Type_Code_Usr = 'RTV';

//?USER: Validate subfile record fields

//?Must by a sales person type of REG  / RTV
CASE;

// IF RCD.Regional Salesperson Code is entered
IF RCD.Regional_Salesperson_Code <> *BLANK;

EXECUTE FUNCTION(RTV Salesperson Type   RT) TYPE(RTVOBJ) FILE(CAAPREP)          AC1205126;
PARAMETER(RCD.Regional_Salesperson_Code);
PARAMETER(LCL.Sales_Type_Code);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


CASE;

// IF LCL.Sales Type Code EQ WRK.Sales Type Code
IF LCL.Sales_Type_Code = WRK.Sales_Type_Code;

// OR LCL.Sales Type Code EQ LCL.Sales Type Code Usr
OR LCL.Sales_Type_Code = LCL.Sales_Type_Code_Usr;

// IF *OTHERWISE
IF *OTHERWISE;

// Send error message - 'Sales Type Must Be REG for this sales person.'
ERROR(USR3413);
MSGPARM(RCD.Regional_Salesperson_Code);

ENDIF;

ENDIF;

//?USER: Create DBF record

EXECUTE FUNCTION(Create Territory) TYPE(CRTOBJ) FILE(PDLVREP)                   AC1488869;
PARAMETER(RCD.Territory_Code);
PARAMETER(RCD.Territory_Description);
PARAMETER(*MISSING);
PARAMETER(*MISSING);
PARAMETER(*MISSING);
PARAMETER(*MISSING);
PARAMETER(*MISSING);
PARAMETER(RCD.EDI_Status_1);
PARAMETER(RCD.EDI_Status_2);
PARAMETER(RCD.EDI_Status_3);
PARAMETER(RCD.Record_Status);
PARAMETER(RCD.Job_Time);
PARAMETER(RCD.User_Id);
PARAMETER(RCD.Job_Name);
PARAMETER(RCD.Job_Date);
{
 //?USER: Processing before Data update

 EXECUTE FUNCTION(Set Date/Time Stamp   IF) TYPE(EXCINTFUN)                      AC1142219;
 PARAMETER(DB1.Job_Time);
 PARAMETER(DB1.User_Id);
 PARAMETER(DB1.Job_Name);
 PARAMETER(DB1.Job_Date);
 {
  //?Execute internal function

  // PAR.Job Time = JOB.*Job time
  PAR.Job_Time = JOB.*Job_time;

  // PAR.User Id = JOB.*USER
  PAR.User_Id = JOB.*USER;

  // PAR.Job Name = JOB.*JOB
  PAR.Job_Name = JOB.*JOB;

  // PAR.Job Date = JOB.*Job date
  PAR.Job_Date = JOB.*Job_date;

 }

}


//?USER: Delete DBF record

EXECUTE FUNCTION(Delete Territory) TYPE(DLTOBJ) FILE(PDLVREP)                   AC1488871;

//?USER: Change DBF record

EXECUTE FUNCTION(Change Territory) TYPE(CHGOBJ) FILE(PDLVREP)                   AC1488870;
{
 //?USER: Processing before Data update

 EXECUTE FUNCTION(Set Date/Time Stamp   IF) TYPE(EXCINTFUN)                      AC1142219;
 PARAMETER(DB1.Job_Time);
 PARAMETER(DB1.User_Id);
 PARAMETER(DB1.Job_Name);
 PARAMETER(DB1.Job_Date);
 {
  //?Execute internal function

  // PAR.Job Time = JOB.*Job time
  PAR.Job_Time = JOB.*Job_time;

  // PAR.User Id = JOB.*USER
  PAR.User_Id = JOB.*USER;

  // PAR.Job Name = JOB.*JOB
  PAR.Job_Name = JOB.*JOB;

  // PAR.Job Date = JOB.*Job date
  PAR.Job_Date = JOB.*Job_date;

 }

}


