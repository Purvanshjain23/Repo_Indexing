// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PKDXE1R
// ?Date: 14.08.2025 Time: 02:49:09
// ?------------------------------------------------------------------------------------------------

//?USER: Initialize program

//?Modification Log
DO;

//?E14180 JBB 12/03/2018 - HPS Automation
//?- Add HPS Automation flag to screen for output only
//?- Per Susan, we will show the HPS Automation flag only at this
//?  time.  I/T will continue to maintain this field in the file
//?  Producer EXT (PKAECPP).
//?R10690 JJH 06/06/17 - Producer Address
//?- Change Screen Size to 132
//?- Hide PD VND Address Number
//?- Hide Alt Prod Payee Vnd AddUsr
//?- Display M3 Supplier Address
//?- Display/Edit Producer Address
//?- Stop displaying the JDE Vendor Address
//?- Use Crt Producer/Prd Addr IF
//?- Use Chg Producer/Prd Addr IF
//?- Remove F15=M3 Supplier Nbr Search
//?- Remove F14=JDE Vendor Nbr Search
//?E19387 JJH 05/05/17 - Modify Chg Producer/Vend     IF - Producer
//?- Add logic that will update M3 data if the M3VEND = P (Paralell)
//?HPESLM  01/31/17 Remove the 1099 and taxid from the screen
//?  -these two fields are flagged as H
//?T8163 DN  12/30/16 - M3 Supplier file change.
//?  -Get M3 Division# to allow user to only select M3 Supplier
//?   record within the same Division.
//?  -Display M3 Payee field on screen.
//?E004069 RMC 9/26/16 - When M3 Ready, put back on screen:
//?  F15=M3 Supplier Srch
//?E00277 - Allow default edi number also allow all user to edit the edi
//?  number if company values state to allow.
ENDDO;

// Execute function Mov ApplN to Company  US.
EXECUTE FUNCTION(Mov ApplN to Company  US) TYPE(EXCUSRSRC) ('PKMFUFR');
PARAMETER(PAR.Oms_System_Value_Alpha);
{
 C***   MOVE USER SOURCE                      ***
 C                     MOVEL#IEVTX    ##CMP
}


EXECUTE FUNCTION(Val Application/User  IF) TYPE(EXCINTFUN)                      AB1129080;
PARAMETER(LCL.Oms_Warehouse_Code);
PARAMETER(LCL.BOH_Company_Number);
PARAMETER('HPE');
PARAMETER(LCL.Oms_SalesPerson_Code);
PARAMETER(LCL.Oms_Allow_Multi_Company);
PARAMETER(LCL.Oms_Default_Printer);
PARAMETER(LCL.Oms_Name);
PARAMETER(LCL.Oms_System_Value_Alpha);
PARAMETER(LCL.Oms_Access_Denied_Y_N);
{
 //?Execute internal function

 // Call program Val Application/User  XF.
 CALL PROGRAM(Val Application/User  XF) ('PDGXXFR');
 PARAMETER(PAR.Oms_Warehouse_Code);
 PARAMETER(PAR.CC_Company_Number);
 PARAMETER(PAR.Oms_Application_Code);
 PARAMETER(PAR.Oms_SalesPerson_Code);
 PARAMETER(PAR.Oms_Allow_Multi_Company);
 PARAMETER(PAR.Oms_Default_Printer);
 PARAMETER(PAR.Oms_Name);
 PARAMETER(PAR.Oms_System_Value_Alpha);
 PARAMETER(PAR.Oms_Access_Denied_Y_N);

 CASE;

 // IF PAR.Oms Access Denied (Y/N) is Yes
 IF PAR.Oms_Access_Denied_Y_N = 'Y';

 // Send error message - 'Access Denied for User'
 ERROR(PRK0298);

 // IF *OTHERWISE
 IF *OTHERWISE;

 // Execute function Mov ApplN to Company  US.
 EXECUTE FUNCTION(Mov ApplN to Company  US) TYPE(EXCUSRSRC) ('PKMFUFR');
 PARAMETER(PAR.Oms_System_Value_Alpha);
 {
  C***   MOVE USER SOURCE                      ***
  C                     MOVEL#IEVTX    ##CMP
 }

 ENDIF;

}


// Call program Rtv Company Values    XF.
CALL PROGRAM(Rtv Company Values    XF) ('PDGKXFR');
PARAMETER(LCL.BOH_Company_Number);
PARAMETER('EDIUSER');
PARAMETER(LCL.User_Class_f_usrprf_USR);

CASE;

// IF LCL.User Class f/usrprf   USR is *USER
IF LCL.User_Class_f_usrprf_USR = *USER;

// LCL.EDI Allow Changes = CND.Yes
LCL.EDI_Allow_Changes = 'Y';

// IF *OTHERWISE
IF *OTHERWISE;

// LCL.EDI Allow Changes = CND.No
LCL.EDI_Allow_Changes = 'N';

ENDIF;

// Call program Rtv Company Value Nbr XF.
CALL PROGRAM(Rtv Company Value Nbr XF) ('PDHGXFR');
PARAMETER(LCL.BOH_Company_Number);
PARAMETER('HPEEDIDEFU');
PARAMETER(LCL.System_Value_Numeric_USR);

CASE;

// IF LCL.System Value Numeric  USR is EDI Default number
IF LCL.System_Value_Numeric_USR > 1;

// PAR.PD EDI Trading Partner # = LCL.System Value Numeric  USR
PAR.PD_EDI_Trading_Partner_# = LCL.System_Value_Numeric_USR;

// IF *OTHERWISE
IF *OTHERWISE;

// PAR.PD EDI Trading Partner # = CVTVAR(CON.*BLANK)
PAR.PD_EDI_Trading_Partner_# = CVTVAR(*BLANK);

ENDIF;

//?E3580 CGL 11/11/14 - M3 Vendor interfaces changes
// Call program Rtv Company Values    XF.
CALL PROGRAM(Rtv Company Values    XF) ('PDGKXFR');
PARAMETER(LCL.BOH_Company_Number);
PARAMETER('M3VEND');
PARAMETER(PAR.Live_with_M3_USR);

//?T8163 DN  01/16/17 - Get M3 Division #.
// Call program Rtv Company Values    XF.
CALL PROGRAM(Rtv Company Values    XF) ('PDGKXFR');
PARAMETER(LCL.BOH_Company_Number);
PARAMETER('M3HPEDIV');
PARAMETER(PAR.M3_Supplier_Division);

//?USER: Initialize key screen

// PGM.*Program mode = CND.*ADD
PGM.*Program_mode = 'ADD';

//?R10690 JJH 06/07/17 - No longer required, as all fields are Input
//?USER: Initialize detail screen (new record)

// DTL.PD Freight Exp Paid By = CND.Producer
DTL.PD_Freight_Exp_Paid_By = 'P';

// DTL.RS Record Status = CND.Active
DTL.RS_Record_Status = 'A';

// DTL.Vendor 1099 = CND.No
DTL.Vendor_1099 = 'N';

// DTL.Frt Exp Pay By Desc Usr = Condition name of DTL.PD Freight Exp Paid By
DTL.Frt_Exp_Pay_By_Desc_Usr = RTVCND(DTL.PD_Freight_Exp_Paid_By);

// DTL.PD EDI Trading Partner # = PAR.PD EDI Trading Partner #
DTL.PD_EDI_Trading_Partner_# = PAR.PD_EDI_Trading_Partner_#;

//?R10690 JJH 06/07/17 - Set M3 Supplier ID = Blank
// DTL.M3 Supplier ID = CON.*BLANK
DTL.M3_Supplier_ID = *BLANK;

//?USER: Initialize detail screen (existing record)

//?E3580 CGL 11/11/14 - M3 Vendor interfaces changes
//?R10690 JJH 06/06/17 - Hide Code that is no longer valid
//?R10690 JJH 06/06/17 - Display Producer Address
// Call program Rtv Producer Address  XF.
CALL PROGRAM(Rtv Producer Address  XF) ('PWCZXFR');
PARAMETER(DB1.PD_Producer_Code);
PARAMETER(NLL.Address_Number);
PARAMETER(NLL.Pass_Name);
PARAMETER(DTL.Producer_Address_1_USR);
PARAMETER(DTL.Producer_Address_2_USR);
PARAMETER(DTL.Producer_Address_3_USR);
PARAMETER(DTL.Producer_City_USR);
PARAMETER(DTL.Producer_State_USR);
PARAMETER(DTL.Producer_Zip_10_USR);
PARAMETER(DTL.Producer_Area_Code_USR);
PARAMETER(DTL.Producer_Phone_Number_USR);
PARAMETER(DTL.Producer_Fax_Area_Cd_USR);
PARAMETER(DTL.Producer_Fax_Phone_#_USR);
PARAMETER(NLL.Fax_Attn_1);
PARAMETER(DTL.Fax_Area_Code_#);
PARAMETER(DTL.Fax_Telephone);
PARAMETER(NLL.Fax_Attn_2);
PARAMETER(NLL.Vendor_1099);
PARAMETER(NLL.Vendor_Tax_Id);
PARAMETER(DTL.Country_Code_Usr);

//?Fax Attn 1
CASE;

// IF DTL.Producer Fax Area Cd  USR is Not Blank
IF DTL.Producer_Fax_Area_Cd_USR <> *BLANK;

// OR DTL.Producer Fax Phone #  USR is Not Blank
OR DTL.Producer_Fax_Phone_#_USR <> *BLANK;

EXECUTE FUNCTION(Rtv Fax Detail        RT) TYPE(RTVOBJ) FILE(PKEAREP)           AB1206181;
PARAMETER('HPE');
PARAMETER(DTL.Producer_Fax_Area_Cd_USR);
PARAMETER(DTL.Producer_Fax_Phone_#_USR);
PARAMETER(DTL.Fax_Attn_1);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


ENDIF;

//?Fax Attn 2
CASE;

// IF DTL.Fax Area Code # is Not Blank
IF DTL.Fax_Area_Code_# <> *BLANK;

// OR DTL.Fax Telephone is Not Blank
OR DTL.Fax_Telephone <> *BLANK;

EXECUTE FUNCTION(Rtv Fax Detail        RT) TYPE(RTVOBJ) FILE(PKEAREP)           AB1206181;
PARAMETER('HPE');
PARAMETER(DTL.Fax_Area_Code_#);
PARAMETER(DTL.Fax_Telephone);
PARAMETER(DTL.Fax_Attn_2);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


ENDIF;

//?R10690 JJH 06/06/17 - Display M3 Suppier Address
EXECUTE FUNCTION(Rtv Get M3 Supplier   IF) TYPE(EXCINTFUN)                      AB1322091;
PARAMETER(DB1.PD_Producer_Code);
PARAMETER(DTL.M3_Supplier_ID);
PARAMETER(DTL.M3_Supplier_Name);
PARAMETER(DTL.M3_Address_Line_1);
PARAMETER(DTL.M3_Address_Line_2);
PARAMETER(DTL.M3_Address_Line_3);
PARAMETER(DTL.M3_City);
PARAMETER(DTL.M3_State);
PARAMETER(DTL.M3_Postal_Code);
PARAMETER(DTL.M3_Telephone_No_1);
PARAMETER(DTL.M3_Telephone_No_2);
PARAMETER(DTL.M3_Fax_Telephone);
PARAMETER(NLL.M3_Supplier_Tax_ID);
PARAMETER(DTL.M3_Country_Code);
{
 //?Execute internal function

 EXECUTE FUNCTION(Rtv Producer EXT2     RT) TYPE(RTVOBJ) FILE(PLB4REP)           AB1322079;
 PARAMETER(PAR.PD_Producer_Code);
 PARAMETER(PAR.M3_Supplier_ID);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 EXECUTE FUNCTION(Rtv M# Supplier       RT) TYPE(RTVOBJ) FILE(PLB2REP)           AB1322067;
 PARAMETER(PAR.M3_Supplier_ID);
 PARAMETER(PAR.M3_Supplier_Name);
 PARAMETER(PAR.M3_Address_Line_1);
 PARAMETER(PAR.M3_Address_Line_2);
 PARAMETER(PAR.M3_Address_Line_3);
 PARAMETER(PAR.M3_City);
 PARAMETER(PAR.M3_State);
 PARAMETER(PAR.M3_Postal_Code);
 PARAMETER(PAR.M3_Telephone_No_1);
 PARAMETER(PAR.M3_Telephone_No_2);
 PARAMETER(PAR.M3_Fax_Telephone);
 PARAMETER(PAR.M3_Supplier_Tax_ID);
 PARAMETER(PAR.M3_Country_Code);
 {
  //?USER: Initialize routine

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

}


//?R10690 JJH 06/06/17 - Initialization for Existing Producer fields
// PGM.*Program mode = CND.*CHANGE
PGM.*Program_mode = 'CHG';

// DTL.Record Status Desc Usr = Condition name of DB1.RS Record Status
DTL.Record_Status_Desc_Usr = RTVCND(DB1.RS_Record_Status);

// Call program Rtv Alt Prd Py Nm&Vn# XF.
CALL PROGRAM(Rtv Alt Prd Py Nm&Vn# XF) ('PLO7XFR');
PARAMETER(DTL.PD_Producer_Code);
PARAMETER(DTL.Alt_Producer_Payee);
PARAMETER(DTL.Alt_Prod_Payee_Vnd_AddUsr);
PARAMETER(DTL.M3_Supplier_ID_Alt_Payee);

//?Validate PD EDI Trading Partner #
CASE;

// IF DB1.PD EDI Trading Partner # is Not zero
IF DB1.PD_EDI_Trading_Partner_# <> *ZERO;

EXECUTE FUNCTION(RTV Val Edi#          RT) TYPE(RTVOBJ) FILE(PKACREP)           AB1277092;
PARAMETER(DB1.PD_EDI_Trading_Partner_#);
{
 //?USER: Processing if Data record not found

 // PGM.*Return code = CND.*Record does not exist
 PGM.*Return_code = 'Y2U0005';

 //?USER: Process Data record

 // PGM.*Return code = CND.*Normal
 PGM.*Return_code = *BLANK;

 QUIT;

}


ENDIF;

EXECUTE FUNCTION(Rtv Source Desc       RT) TYPE(RTVOBJ) FILE(PKAAREP)           AB1124642;
PARAMETER(DB1.SR_Source_Code);
PARAMETER(DTL.SR_Description);
{
 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


EXECUTE FUNCTION(Rtv Hog Buyer Name    RT) TYPE(RTVOBJ) FILE(PKADREP)           AB1124643;
PARAMETER(DB1.HB_Buyer_Code);
PARAMETER(DTL.Name_USR);
{
 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


EXECUTE FUNCTION(Rtv Producer Name     RT) TYPE(RTVOBJ) FILE(PKACREP)           AB1101542;
PARAMETER(DB1.Commission_Producer_Payee);
PARAMETER(DTL.Name_Producer_USR);
{
 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


// DTL.Frt Exp Pay By Desc Usr = Condition name of DTL.PD Freight Exp Paid By
DTL.Frt_Exp_Pay_By_Desc_Usr = RTVCND(DTL.PD_Freight_Exp_Paid_By);

EXECUTE FUNCTION(RTV MPR Prdcr Purch TpRT) TYPE(RTVOBJ) FILE(PKE3CPP)           AB1235599;
PARAMETER(DTL.PD_Producer_Code);
PARAMETER(DTL.MPR_Purchase_Type_Code);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

 QUIT;

}


// DTL.Vendor 1099 = CND.No
DTL.Vendor_1099 = 'N';

EXECUTE FUNCTION(Rtv MPR Purch Desc    RT) TYPE(RTVOBJ) FILE(PKE2REP)           AB1235607;
PARAMETER(DTL.MPR_Purchase_Type_Code);
PARAMETER(DTL.MPR_Purchase_Type_Desc);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

 QUIT;

}


//?12/03/2018 JBB E14180 - Retrieve HPS Automation flag
EXECUTE FUNCTION(Rtv HPS Automation    RT) TYPE(RTVOBJ) FILE(PLAOREP)           AB1342216;
PARAMETER(DTL.PD_Producer_Code);
PARAMETER(DTL.HPS_Automation_Y_N_Usr);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


//?Populate HPS Automation description
CASE;

// IF DTL.HPS Automation Y/N Usr is N
IF DTL.HPS_Automation_Y_N_Usr = 'N';

// DTL.Yes/No Text USR 3A = CON.No
DTL.Yes_No_Text_USR_3A = 'No';

//?Populate HPS Automation description
// IF DTL.HPS Automation Y/N Usr is Y
IF DTL.HPS_Automation_Y_N_Usr = 'Y';

// DTL.Yes/No Text USR 3A = CON.Yes
DTL.Yes_No_Text_USR_3A = 'Yes';

//?Populate HPS Automation description
// IF *OTHERWISE
IF *OTHERWISE;

// DTL.Yes/No Text USR 3A = CON.*BLANK
DTL.Yes_No_Text_USR_3A = *BLANK;

ENDIF;

//?USER: Validate detail screen fields

//?R10690 JJH 06/07/17 - Options no longer required
//?F4=Prompt   MPR Purchase Type Code
CASE;

// IF DTL.*CMD key is *Prompt
IF DTL.*CMD_key = '04';

CASE;

// IF PGM.*Cursor field <IS> DTL.MPR Purchase Type Code
IF PGM.*Cursor_field = DTL.MPR_Purchase_Type_Code;

// LCL.MPR Purchase Type Code = CON.*ZERO
LCL.MPR_Purchase_Type_Code = *ZERO;

// Call program Sel MPR Purchase Type SR.
CALL PROGRAM(Sel MPR Purchase Type SR) ('PKV8SRR');
PARAMETER(LCL.MPR_Purchase_Type_Code);

CASE;

// IF LCL.MPR Purchase Type Code NE DTL.MPR Purchase Type Code
IF LCL.MPR_Purchase_Type_Code <> DTL.MPR_Purchase_Type_Code;

// AND LCL.MPR Purchase Type Code is Entered
AND LCL.MPR_Purchase_Type_Code > 0;

// DTL.MPR Purchase Type Code = LCL.MPR Purchase Type Code
DTL.MPR_Purchase_Type_Code = LCL.MPR_Purchase_Type_Code;

ENDIF;

ENDIF;

ENDIF;

// DTL.Record Status Desc Usr = Condition name of DTL.RS Record Status
DTL.Record_Status_Desc_Usr = RTVCND(DTL.RS_Record_Status);

EXECUTE FUNCTION(Rtv Source Desc       RT) TYPE(RTVOBJ) FILE(PKAAREP)           AB1124642;
PARAMETER(DTL.SR_Source_Code);
PARAMETER(DTL.SR_Description);
{
 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


EXECUTE FUNCTION(Rtv Hog Buyer Name    RT) TYPE(RTVOBJ) FILE(PKADREP)           AB1124643;
PARAMETER(DTL.HB_Buyer_Code);
PARAMETER(DTL.Name_USR);
{
 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


EXECUTE FUNCTION(Rtv Producer Name     RT) TYPE(RTVOBJ) FILE(PKACREP)           AB1101542;
PARAMETER(DTL.Commission_Producer_Payee);
PARAMETER(DTL.Name_Producer_USR);
{
 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


// Call program Rtv Alt Prd Py Nm&Vn# XF.
CALL PROGRAM(Rtv Alt Prd Py Nm&Vn# XF) ('PLO7XFR');
PARAMETER(DTL.PD_Producer_Code);
PARAMETER(DTL.Alt_Producer_Payee);
PARAMETER(DTL.Alt_Prod_Payee_Vnd_AddUsr);
PARAMETER(DTL.M3_Supplier_ID_Alt_Payee);

//?R10690 JJH 06/07/17 - Validation of JDE Vendor no longer required
//?Validate MPR Purchase Type Code
CASE;

// IF DTL.MPR Purchase Type Code NE WRK.Zero USR
IF DTL.MPR_Purchase_Type_Code <> WRK.Zero_USR;

// PGM.*Return code = CND.*Normal
PGM.*Return_code = *BLANK;

EXECUTE FUNCTION(Val MPR Purchase Type RT) TYPE(RTVOBJ) FILE(PKE2REP)           AB1235592;
PARAMETER(DTL.MPR_Purchase_Type_Code);
{
 //?USER: Processing if Data record not found

 // PGM.*Return code = CND.*Record does not exist
 PGM.*Return_code = 'Y2U0005';

 //?USER: Process Data record

 // PGM.*Return code = CND.*Normal
 PGM.*Return_code = *BLANK;

 QUIT;

}


CASE;

// IF PGM.*Return code is *Normal
IF PGM.*Return_code = *BLANK;

// IF *OTHERWISE
IF *OTHERWISE;

// Send error message - 'MPR Purchase Type not found.'
ERROR(PRK0965);
MSGPARM(DTL.MPR_Purchase_Type_Code);

// PGM.*Return code = CND.*Normal
PGM.*Return_code = *BLANK;

ENDIF;

ENDIF;

//?Validate PD EDI Trading Partner #
CASE;

// IF LCL.EDI Allow Changes is Yes
IF LCL.EDI_Allow_Changes = 'Y';

// PGM.*Return code = CND.*Normal
PGM.*Return_code = *BLANK;

CASE;

// IF DTL.PD EDI Trading Partner # is Not zero
IF DTL.PD_EDI_Trading_Partner_# <> *ZERO;

EXECUTE FUNCTION(RTV Val Edi#          RT) TYPE(RTVOBJ) FILE(PKACREP)           AB1277092;
PARAMETER(DTL.PD_EDI_Trading_Partner_#);
{
 //?USER: Processing if Data record not found

 // PGM.*Return code = CND.*Record does not exist
 PGM.*Return_code = 'Y2U0005';

 //?USER: Process Data record

 // PGM.*Return code = CND.*Normal
 PGM.*Return_code = *BLANK;

 QUIT;

}


CASE;

// IF PGM.*Return code is *Normal
IF PGM.*Return_code = *BLANK;

// IF *OTHERWISE
IF *OTHERWISE;

//?This number must exists on at least one producer for a user to change
//?or enter this number.
// Send error message - 'EDI# does not exists, the EDI# you are trying to enter has not been used in
ERROR(PRK1164);
MSGPARM(DTL.PD_EDI_Trading_Partner_#);

ENDIF;

ENDIF;

ENDIF;

//?CALC: Detail screen function fields

//?R10690 JJH 06/07/17 - No longer required, Adderss is now Input
//?USER: Validate detail screen relations

//?R10690 JJH 06/07/17 - No longer required.
//?USER: Create DBF record

EXECUTE FUNCTION(Crt Producer/Prd Addr IF) TYPE(EXCINTFUN) FILE(PKACREP)        AB1336043;
PARAMETER(DTL.PD_Producer_Code);
PARAMETER(DTL.PD_Name);
PARAMETER(DTL.PD_Production_Capacity);
PARAMETER(DTL.PD_Std_Delv_Time);
PARAMETER(DTL.PD_Std_Truck_Size);
PARAMETER(DTL.PD_Freight_Exp_Paid_By);
PARAMETER(DTL.PD_Fax_Status);
PARAMETER(DTL.PD_VND_Address_Number);
PARAMETER(DTL.PD_EDI_Trading_Partner_#);
PARAMETER(DTL.PD_VND_Category);
PARAMETER(DTL.SR_Source_Code);
PARAMETER(DTL.HB_Buyer_Code);
PARAMETER(DTL.Commission_Producer_Payee);
PARAMETER(DTL.M3_Supplier_ID);
PARAMETER(DTL.PD_Name);
PARAMETER(DTL.Producer_Address_1_USR);
PARAMETER(DTL.Producer_Address_2_USR);
PARAMETER(DTL.Producer_Address_3_USR);
PARAMETER(DTL.Producer_City_USR);
PARAMETER(DTL.Producer_State_USR);
PARAMETER(DTL.Producer_Zip_10_USR);
PARAMETER(DTL.Producer_Area_Code_USR);
PARAMETER(DTL.Producer_Phone_Number_USR);
PARAMETER(DTL.Producer_Fax_Area_Cd_USR);
PARAMETER(DTL.Producer_Fax_Phone_#_USR);
PARAMETER(DTL.Fax_Attn_1);
PARAMETER(DTL.Fax_Area_Code_#);
PARAMETER(DTL.Fax_Telephone);
PARAMETER(DTL.Fax_Attn_2);
PARAMETER(DTL.Vendor_1099);
PARAMETER(*BLANK);
PARAMETER(DTL.Country_Code_Usr);
PARAMETER(DTL.MPR_Purchase_Type_Code);
{
 //?Execute internal function

 EXECUTE FUNCTION(Crt Producer          CT) TYPE(CRTOBJ) FILE(PKACREP)           AB1101531;
 PARAMETER(PAR.PD_Producer_Code);
 PARAMETER(PAR.PD_Name);
 PARAMETER(PAR.PD_Production_Capacity);
 PARAMETER(PAR.PD_Std_Delv_Time);
 PARAMETER(PAR.PD_Std_Truck_Size);
 PARAMETER(PAR.PD_Freight_Exp_Paid_By);
 PARAMETER(PAR.PD_Fax_Status);
 PARAMETER(*ZERO);
 PARAMETER(PAR.PD_EDI_Trading_Partner_#);
 PARAMETER(PAR.PD_VND_Category);
 PARAMETER(PAR.SR_Source_Code);
 PARAMETER(PAR.HB_Buyer_Code);
 PARAMETER(PAR.Commission_Producer_Payee);
 PARAMETER(*BLANK);
 PARAMETER(*ZERO);
 PARAMETER(*ZERO);
 PARAMETER('A');
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*ZERO);
 PARAMETER(*ZERO);
 {
  //?USER: Processing before Data update

  EXECUTE FUNCTION(Rtv Add Stamp         IF) TYPE(EXCINTFUN)                      AB1100935;
  PARAMETER(DB1.RS_Record_Status);
  PARAMETER(DB1.RS_Job);
  PARAMETER(DB1.RS_Program);
  PARAMETER(DB1.RS_User_Added);
  PARAMETER(DB1.RS_Date_Added);
  PARAMETER(DB1.RS_Time_Added);
  {
   //?Execute internal function

   // PAR.RS Record Status = CND.Active
   PAR.RS_Record_Status = 'A';

   // PAR.RS User Added = JOB.*USER
   PAR.RS_User_Added = JOB.*USER;

   // PAR.RS Date Added = JOB.*Job date
   PAR.RS_Date_Added = JOB.*Job_date;

   // PAR.RS Time Added = JOB.*Job time
   PAR.RS_Time_Added = JOB.*Job_time;

   // PAR.RS Program = JOB.*PROGRAM
   PAR.RS_Program = JOB.*PROGRAM;

   // PAR.RS Job = JOB.*JOB
   PAR.RS_Job = JOB.*JOB;

  }

 }

 EXECUTE FUNCTION(Crt Producer EXT2     CT) TYPE(CRTOBJ) FILE(PLB4REP)           AB1322068;
 PARAMETER(PAR.PD_Producer_Code);
 PARAMETER(PAR.M3_Supplier_ID);
 {
  //?USER: Processing before Data update

  EXECUTE FUNCTION(Rtv Add Stamp         IF) TYPE(EXCINTFUN)                      AB1100935;
  PARAMETER(DB1.RS_Record_Status);
  PARAMETER(DB1.RS_Job);
  PARAMETER(DB1.RS_Program);
  PARAMETER(DB1.RS_User_Added);
  PARAMETER(DB1.RS_Date_Added);
  PARAMETER(DB1.RS_Time_Added);
  {
   //?Execute internal function

   // PAR.RS Record Status = CND.Active
   PAR.RS_Record_Status = 'A';

   // PAR.RS User Added = JOB.*USER
   PAR.RS_User_Added = JOB.*USER;

   // PAR.RS Date Added = JOB.*Job date
   PAR.RS_Date_Added = JOB.*Job_date;

   // PAR.RS Time Added = JOB.*Job time
   PAR.RS_Time_Added = JOB.*Job_time;

   // PAR.RS Program = JOB.*PROGRAM
   PAR.RS_Program = JOB.*PROGRAM;

   // PAR.RS Job = JOB.*JOB
   PAR.RS_Job = JOB.*JOB;

  }

 }

 EXECUTE FUNCTION(Crt Producer Address  CR) TYPE(CRTOBJ) FILE(PWAGREP)           AB1335160;
 PARAMETER(PAR.PD_Producer_Code);
 PARAMETER(*ZERO);
 PARAMETER(PAR.Pass_Name);
 PARAMETER(PAR.Address_1);
 PARAMETER(PAR.Address_2);
 PARAMETER(PAR.Address_3);
 PARAMETER(PAR.City);
 PARAMETER(PAR.State);
 PARAMETER(PAR.Zip);
 PARAMETER(PAR.Area_Code);
 PARAMETER(PAR.Telephone);
 PARAMETER(PAR.Fax_Area_Code_#);
 PARAMETER(PAR.Fax_Telephone);
 PARAMETER(PAR.Fax_Attn_1);
 PARAMETER(PAR.Fax_Area_Code_#_2);
 PARAMETER(PAR.Fax_Telephone_2);
 PARAMETER(PAR.Fax_Attn_2);
 PARAMETER(PAR.Vendor_1099);
 PARAMETER(PAR.Vendor_Tax_Id);
 PARAMETER(PAR.Country_Code);
 {
  //?USER: Processing before Data update

  EXECUTE FUNCTION(Rtv Add Stamp-Sys Dt  IF) TYPE(EXCINTFUN)                      AB1237005;
  PARAMETER(DB1.RS_Record_Status);
  PARAMETER(DB1.RS_Job);
  PARAMETER(DB1.RS_Program);
  PARAMETER(DB1.RS_User_Added);
  PARAMETER(DB1.RS_Date_Added);
  PARAMETER(DB1.RS_Time_Added);
  {
   //?Execute internal function

   // PAR.RS Record Status = CND.Active
   PAR.RS_Record_Status = 'A';

   // PAR.RS User Added = JOB.*USER
   PAR.RS_User_Added = JOB.*USER;

   // Call program Rtv System Date & Tim UP.
   CALL PROGRAM(Rtv System Date & Tim UP) ('PKWDUPC');
   PARAMETER(PAR.RS_Date_Added);
   PARAMETER(PAR.RS_Time_Added);

   // PAR.RS Program = JOB.*PROGRAM
   PAR.RS_Program = JOB.*PROGRAM;

   // PAR.RS Job = JOB.*JOB
   PAR.RS_Job = JOB.*JOB;

  }

 }

 //?Fax Attn 1
 CASE;

 // IF PAR.Fax Area Code # is Not Blank
 IF PAR.Fax_Area_Code_# <> *BLANK;

 // OR PAR.Fax Telephone is Not Blank
 OR PAR.Fax_Telephone <> *BLANK;

 EXECUTE FUNCTION(Upd Fax Detail        RT) TYPE(RTVOBJ) FILE(PKEAREP)           AB1206264;
 PARAMETER('HPE');
 PARAMETER(PAR.Fax_Area_Code_#);
 PARAMETER(PAR.Fax_Telephone);
 PARAMETER(PAR.Fax_Attn_1);
 {
  //?USER: Processing if Data record not found

  EXECUTE FUNCTION(Create Fax Detail) TYPE(CRTOBJ) FILE(PKEAREP)                  AB1206170;
  PARAMETER(PAR.FD_Application_Code);
  PARAMETER(PAR.FD_Fax_Area_Code);
  PARAMETER(PAR.FD_Fax_Number);
  PARAMETER(PAR.FD_Fax_Attention);
  PARAMETER(PAR.RS_User_Changed);
  PARAMETER(PAR.RS_Date_Changed);
  PARAMETER(PAR.RS_Time_Changed);
  PARAMETER(PAR.RS_Record_Status);
  PARAMETER(PAR.RS_Job);
  PARAMETER(PAR.RS_Program);
  PARAMETER(PAR.RS_User_Added);
  PARAMETER(PAR.RS_Date_Added);
  PARAMETER(PAR.RS_Time_Added);
  {
   //?USER: Processing before Data update

   EXECUTE FUNCTION(Rtv Add Stamp         IF) TYPE(EXCINTFUN)                      AB1100935;
   PARAMETER(DB1.RS_Record_Status);
   PARAMETER(DB1.RS_Job);
   PARAMETER(DB1.RS_Program);
   PARAMETER(DB1.RS_User_Added);
   PARAMETER(DB1.RS_Date_Added);
   PARAMETER(DB1.RS_Time_Added);
   {
    //?Execute internal function

    // PAR.RS Record Status = CND.Active
    PAR.RS_Record_Status = 'A';

    // PAR.RS User Added = JOB.*USER
    PAR.RS_User_Added = JOB.*USER;

    // PAR.RS Date Added = JOB.*Job date
    PAR.RS_Date_Added = JOB.*Job_date;

    // PAR.RS Time Added = JOB.*Job time
    PAR.RS_Time_Added = JOB.*Job_time;

    // PAR.RS Program = JOB.*PROGRAM
    PAR.RS_Program = JOB.*PROGRAM;

    // PAR.RS Job = JOB.*JOB
    PAR.RS_Job = JOB.*JOB;

   }

  }

  //?USER: Process Data record

  EXECUTE FUNCTION(Change Fax Detail) TYPE(CHGOBJ) FILE(PKEAREP)                  AB1206171;
  PARAMETER(DB1.FD_Application_Code);
  PARAMETER(DB1.FD_Fax_Area_Code);
  PARAMETER(DB1.FD_Fax_Number);
  PARAMETER(PAR.FD_Fax_Attention);
  {
   //?USER: Processing before Data update

   EXECUTE FUNCTION(Rtv Change Stamp      IF) TYPE(EXCINTFUN)                      AB1100934;
   PARAMETER(DB1.RS_User_Changed);
   PARAMETER(DB1.RS_Date_Changed);
   PARAMETER(DB1.RS_Time_Changed);
   PARAMETER(DB1.RS_Job);
   PARAMETER(DB1.RS_Program);
   {
    //?Execute internal function

    // PAR.RS User Changed = JOB.*USER
    PAR.RS_User_Changed = JOB.*USER;

    // PAR.RS Date Changed = JOB.*Job date
    PAR.RS_Date_Changed = JOB.*Job_date;

    // PAR.RS Time Changed = JOB.*Job time
    PAR.RS_Time_Changed = JOB.*Job_time;

    // PAR.RS Job = JOB.*JOB
    PAR.RS_Job = JOB.*JOB;

    // PAR.RS Program = JOB.*PROGRAM
    PAR.RS_Program = JOB.*PROGRAM;

   }

  }

 }

 ENDIF;

 //?Fax Attn 2
 CASE;

 // IF PAR.Fax Area Code # 2 is Not Blank
 IF PAR.Fax_Area_Code_#_2 <> *BLANK;

 // OR PAR.Fax Telephone 2 is Not Blank
 OR PAR.Fax_Telephone_2 <> *BLANK;

 EXECUTE FUNCTION(Upd Fax Detail        RT) TYPE(RTVOBJ) FILE(PKEAREP)           AB1206264;
 PARAMETER('HPE');
 PARAMETER(PAR.Fax_Area_Code_#_2);
 PARAMETER(PAR.Fax_Telephone_2);
 PARAMETER(PAR.Fax_Attn_2);
 {
  //?USER: Processing if Data record not found

  EXECUTE FUNCTION(Create Fax Detail) TYPE(CRTOBJ) FILE(PKEAREP)                  AB1206170;
  PARAMETER(PAR.FD_Application_Code);
  PARAMETER(PAR.FD_Fax_Area_Code);
  PARAMETER(PAR.FD_Fax_Number);
  PARAMETER(PAR.FD_Fax_Attention);
  PARAMETER(PAR.RS_User_Changed);
  PARAMETER(PAR.RS_Date_Changed);
  PARAMETER(PAR.RS_Time_Changed);
  PARAMETER(PAR.RS_Record_Status);
  PARAMETER(PAR.RS_Job);
  PARAMETER(PAR.RS_Program);
  PARAMETER(PAR.RS_User_Added);
  PARAMETER(PAR.RS_Date_Added);
  PARAMETER(PAR.RS_Time_Added);
  {
   //?USER: Processing before Data update

   EXECUTE FUNCTION(Rtv Add Stamp         IF) TYPE(EXCINTFUN)                      AB1100935;
   PARAMETER(DB1.RS_Record_Status);
   PARAMETER(DB1.RS_Job);
   PARAMETER(DB1.RS_Program);
   PARAMETER(DB1.RS_User_Added);
   PARAMETER(DB1.RS_Date_Added);
   PARAMETER(DB1.RS_Time_Added);
   {
    //?Execute internal function

    // PAR.RS Record Status = CND.Active
    PAR.RS_Record_Status = 'A';

    // PAR.RS User Added = JOB.*USER
    PAR.RS_User_Added = JOB.*USER;

    // PAR.RS Date Added = JOB.*Job date
    PAR.RS_Date_Added = JOB.*Job_date;

    // PAR.RS Time Added = JOB.*Job time
    PAR.RS_Time_Added = JOB.*Job_time;

    // PAR.RS Program = JOB.*PROGRAM
    PAR.RS_Program = JOB.*PROGRAM;

    // PAR.RS Job = JOB.*JOB
    PAR.RS_Job = JOB.*JOB;

   }

  }

  //?USER: Process Data record

  EXECUTE FUNCTION(Change Fax Detail) TYPE(CHGOBJ) FILE(PKEAREP)                  AB1206171;
  PARAMETER(DB1.FD_Application_Code);
  PARAMETER(DB1.FD_Fax_Area_Code);
  PARAMETER(DB1.FD_Fax_Number);
  PARAMETER(PAR.FD_Fax_Attention);
  {
   //?USER: Processing before Data update

   EXECUTE FUNCTION(Rtv Change Stamp      IF) TYPE(EXCINTFUN)                      AB1100934;
   PARAMETER(DB1.RS_User_Changed);
   PARAMETER(DB1.RS_Date_Changed);
   PARAMETER(DB1.RS_Time_Changed);
   PARAMETER(DB1.RS_Job);
   PARAMETER(DB1.RS_Program);
   {
    //?Execute internal function

    // PAR.RS User Changed = JOB.*USER
    PAR.RS_User_Changed = JOB.*USER;

    // PAR.RS Date Changed = JOB.*Job date
    PAR.RS_Date_Changed = JOB.*Job_date;

    // PAR.RS Time Changed = JOB.*Job time
    PAR.RS_Time_Changed = JOB.*Job_time;

    // PAR.RS Job = JOB.*JOB
    PAR.RS_Job = JOB.*JOB;

    // PAR.RS Program = JOB.*PROGRAM
    PAR.RS_Program = JOB.*PROGRAM;

   }

  }

 }

 ENDIF;

 //?MPR Producer Purchase Type
 CASE;

 // IF PAR.MPR Purchase Type Code is Entered
 IF PAR.MPR_Purchase_Type_Code > 0;

 EXECUTE FUNCTION(Rtv/Crt/Chg MPR PrPur RT) TYPE(RTVOBJ) FILE(PKE3CPP)           AB1235598;
 PARAMETER(PAR.PD_Producer_Code);
 PARAMETER(PAR.MPR_Purchase_Type_Code);
 PARAMETER(PAR.RS_User_Changed);
 PARAMETER(PAR.RS_Date_Changed);
 PARAMETER(PAR.RS_Time_Changed);
 PARAMETER(PAR.RS_Record_Status);
 PARAMETER(PAR.RS_Job);
 PARAMETER(PAR.RS_Program);
 PARAMETER(PAR.RS_User_Added);
 PARAMETER(PAR.RS_Date_Added);
 PARAMETER(PAR.RS_Time_Added);
 {
  //?USER: Processing if Data record not found

  EXECUTE FUNCTION(Crt MPR Prdcr Purch   CR) TYPE(CRTOBJ) FILE(PKE3CPP)           AB1235460;
  PARAMETER(PAR.PD_Producer_Code);
  PARAMETER(PAR.MPR_Purchase_Type_Code);
  PARAMETER(*BLANK);
  PARAMETER(*ZERO);
  PARAMETER(*ZERO);
  PARAMETER('A');
  PARAMETER(PAR.RS_Job);
  PARAMETER(PAR.RS_Program);
  PARAMETER(PAR.RS_User_Added);
  PARAMETER(PAR.RS_Date_Added);
  PARAMETER(PAR.RS_Time_Added);
  {
   //?USER: Processing before Data update

   EXECUTE FUNCTION(Rtv Add Stamp         IF) TYPE(EXCINTFUN)                      AB1100935;
   PARAMETER(DB1.RS_Record_Status);
   PARAMETER(DB1.RS_Job);
   PARAMETER(DB1.RS_Program);
   PARAMETER(DB1.RS_User_Added);
   PARAMETER(DB1.RS_Date_Added);
   PARAMETER(DB1.RS_Time_Added);
   {
    //?Execute internal function

    // PAR.RS Record Status = CND.Active
    PAR.RS_Record_Status = 'A';

    // PAR.RS User Added = JOB.*USER
    PAR.RS_User_Added = JOB.*USER;

    // PAR.RS Date Added = JOB.*Job date
    PAR.RS_Date_Added = JOB.*Job_date;

    // PAR.RS Time Added = JOB.*Job time
    PAR.RS_Time_Added = JOB.*Job_time;

    // PAR.RS Program = JOB.*PROGRAM
    PAR.RS_Program = JOB.*PROGRAM;

    // PAR.RS Job = JOB.*JOB
    PAR.RS_Job = JOB.*JOB;

   }

  }

  //?USER: Process Data record

  CASE;

  // IF PAR.MPR Purchase Type Code NE DB1.MPR Purchase Type Code
  IF PAR.MPR_Purchase_Type_Code <> DB1.MPR_Purchase_Type_Code;

  EXECUTE FUNCTION(Del MPR Prdcr Purch   DL) TYPE(DLTOBJ) FILE(PKE3CPP)           AB1235462;
  PARAMETER(DB1.PD_Producer_Code);
  PARAMETER(DB1.MPR_Purchase_Type_Code);
  EXECUTE FUNCTION(Crt MPR Prdcr Purch   CR) TYPE(CRTOBJ) FILE(PKE3CPP)           AB1235460;
  PARAMETER(PAR.PD_Producer_Code);
  PARAMETER(PAR.MPR_Purchase_Type_Code);
  PARAMETER(PAR.RS_User_Changed);
  PARAMETER(PAR.RS_Date_Changed);
  PARAMETER(PAR.RS_Time_Changed);
  PARAMETER('A');
  PARAMETER(PAR.RS_Job);
  PARAMETER(DB1.RS_Program);
  PARAMETER(DB1.RS_User_Added);
  PARAMETER(DB1.RS_Date_Added);
  PARAMETER(DB1.RS_Time_Added);
  {
   //?USER: Processing before Data update

   EXECUTE FUNCTION(Rtv Add Stamp         IF) TYPE(EXCINTFUN)                      AB1100935;
   PARAMETER(DB1.RS_Record_Status);
   PARAMETER(DB1.RS_Job);
   PARAMETER(DB1.RS_Program);
   PARAMETER(DB1.RS_User_Added);
   PARAMETER(DB1.RS_Date_Added);
   PARAMETER(DB1.RS_Time_Added);
   {
    //?Execute internal function

    // PAR.RS Record Status = CND.Active
    PAR.RS_Record_Status = 'A';

    // PAR.RS User Added = JOB.*USER
    PAR.RS_User_Added = JOB.*USER;

    // PAR.RS Date Added = JOB.*Job date
    PAR.RS_Date_Added = JOB.*Job_date;

    // PAR.RS Time Added = JOB.*Job time
    PAR.RS_Time_Added = JOB.*Job_time;

    // PAR.RS Program = JOB.*PROGRAM
    PAR.RS_Program = JOB.*PROGRAM;

    // PAR.RS Job = JOB.*JOB
    PAR.RS_Job = JOB.*JOB;

   }

  }

  ENDIF;

 }

 ENDIF;

}


//?USER: Change DBF record

EXECUTE FUNCTION(Chg Producer/Prd Addr IF) TYPE(EXCINTFUN) FILE(PKACREP)        AB1336164;
PARAMETER(DTL.PD_Producer_Code);
PARAMETER(DTL.PD_Name);
PARAMETER(DTL.PD_Production_Capacity);
PARAMETER(DTL.PD_Std_Delv_Time);
PARAMETER(DTL.PD_Std_Truck_Size);
PARAMETER(DTL.PD_Freight_Exp_Paid_By);
PARAMETER(DTL.PD_Fax_Status);
PARAMETER(DTL.PD_VND_Address_Number);
PARAMETER(DTL.PD_EDI_Trading_Partner_#);
PARAMETER(DTL.PD_VND_Category);
PARAMETER(DTL.SR_Source_Code);
PARAMETER(DTL.HB_Buyer_Code);
PARAMETER(DTL.Commission_Producer_Payee);
PARAMETER(DTL.RS_Record_Status);
PARAMETER(DTL.PD_VND_Address_Number);
PARAMETER(DTL.PD_Name);
PARAMETER(DTL.Producer_Address_1_USR);
PARAMETER(DTL.Producer_Address_2_USR);
PARAMETER(DTL.Producer_Address_3_USR);
PARAMETER(DTL.Producer_City_USR);
PARAMETER(DTL.Producer_State_USR);
PARAMETER(DTL.Producer_Zip_10_USR);
PARAMETER(DTL.Producer_Area_Code_USR);
PARAMETER(DTL.Producer_Phone_Number_USR);
PARAMETER(DTL.Producer_Fax_Area_Cd_USR);
PARAMETER(DTL.Producer_Fax_Phone_#_USR);
PARAMETER(DTL.Fax_Attn_1);
PARAMETER(DTL.Fax_Area_Code_#);
PARAMETER(DTL.Fax_Telephone);
PARAMETER(DTL.Fax_Attn_2);
PARAMETER(DTL.Vendor_1099);
PARAMETER(DTL.Vendor_Tax_Id);
PARAMETER(DTL.Country_Code_Usr);
PARAMETER(DTL.M3_Supplier_ID);
PARAMETER(DTL.MPR_Purchase_Type_Code);
{
 //?Execute internal function

 EXECUTE FUNCTION(Chg Producer          CH) TYPE(CHGOBJ) FILE(PKACREP)           AB1101532;
 PARAMETER(PAR.PD_Producer_Code);
 PARAMETER(PAR.Pass_Name);
 PARAMETER(PAR.PD_Production_Capacity);
 PARAMETER(PAR.PD_Std_Delv_Time);
 PARAMETER(PAR.PD_Std_Truck_Size);
 PARAMETER(PAR.PD_Freight_Exp_Paid_By);
 PARAMETER(PAR.PD_Fax_Status);
 PARAMETER(PAR.PD_VND_Address_Number);
 PARAMETER(PAR.PD_EDI_Trading_Partner_#);
 PARAMETER(PAR.PD_VND_Category);
 PARAMETER(PAR.SR_Source_Code);
 PARAMETER(PAR.HB_Buyer_Code);
 PARAMETER(PAR.Commission_Producer_Payee);
 PARAMETER(*BLANK);
 PARAMETER(*ZERO);
 PARAMETER(*ZERO);
 PARAMETER(PAR.RS_Record_Status);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*ZERO);
 PARAMETER(*ZERO);
 {
  //?USER: Processing before Data update

  EXECUTE FUNCTION(Rtv Change Stamp      IF) TYPE(EXCINTFUN)                      AB1100934;
  PARAMETER(DB1.RS_User_Changed);
  PARAMETER(DB1.RS_Date_Changed);
  PARAMETER(DB1.RS_Time_Changed);
  PARAMETER(DB1.RS_Job);
  PARAMETER(DB1.RS_Program);
  {
   //?Execute internal function

   // PAR.RS User Changed = JOB.*USER
   PAR.RS_User_Changed = JOB.*USER;

   // PAR.RS Date Changed = JOB.*Job date
   PAR.RS_Date_Changed = JOB.*Job_date;

   // PAR.RS Time Changed = JOB.*Job time
   PAR.RS_Time_Changed = JOB.*Job_time;

   // PAR.RS Job = JOB.*JOB
   PAR.RS_Job = JOB.*JOB;

   // PAR.RS Program = JOB.*PROGRAM
   PAR.RS_Program = JOB.*PROGRAM;

  }

 }

 EXECUTE FUNCTION(Chg Producer Address  CH) TYPE(CHGOBJ) FILE(PWAGREP)           AB1335161;
 PARAMETER(PAR.PD_Producer_Code);
 PARAMETER(PAR.Address_Number);
 PARAMETER(PAR.Pass_Name);
 PARAMETER(PAR.Address_1);
 PARAMETER(PAR.Address_2);
 PARAMETER(PAR.Address_3);
 PARAMETER(PAR.City);
 PARAMETER(PAR.State);
 PARAMETER(PAR.Zip);
 PARAMETER(PAR.Area_Code);
 PARAMETER(PAR.Telephone);
 PARAMETER(PAR.Fax_Area_Code_#);
 PARAMETER(PAR.Fax_Telephone);
 PARAMETER(PAR.Fax_Attn_1);
 PARAMETER(PAR.Fax_Area_Code_#_2);
 PARAMETER(PAR.Fax_Telephone_2);
 PARAMETER(PAR.Fax_Attn_2);
 PARAMETER(PAR.Vendor_1099);
 PARAMETER(PAR.Vendor_Tax_Id);
 PARAMETER(PAR.Country_Code);
 PARAMETER(PAR.RS_Record_Status);
 {
  //?USER: Processing before Data update

  EXECUTE FUNCTION(Rtv Change Stamp      IF) TYPE(EXCINTFUN)                      AB1100934;
  PARAMETER(DB1.RS_User_Changed);
  PARAMETER(DB1.RS_Date_Changed);
  PARAMETER(DB1.RS_Time_Changed);
  PARAMETER(DB1.RS_Job);
  PARAMETER(DB1.RS_Program);
  {
   //?Execute internal function

   // PAR.RS User Changed = JOB.*USER
   PAR.RS_User_Changed = JOB.*USER;

   // PAR.RS Date Changed = JOB.*Job date
   PAR.RS_Date_Changed = JOB.*Job_date;

   // PAR.RS Time Changed = JOB.*Job time
   PAR.RS_Time_Changed = JOB.*Job_time;

   // PAR.RS Job = JOB.*JOB
   PAR.RS_Job = JOB.*JOB;

   // PAR.RS Program = JOB.*PROGRAM
   PAR.RS_Program = JOB.*PROGRAM;

  }

 }

 EXECUTE FUNCTION(Chg Producer EXT2     CH) TYPE(CHGOBJ) FILE(PLB4REP)           AB1322069;
 PARAMETER(PAR.PD_Producer_Code);
 PARAMETER(PAR.M3_Supplier_ID);
 {
  //?USER: Processing if Data record not found

  EXECUTE FUNCTION(Crt Producer EXT2     CT) TYPE(CRTOBJ) FILE(PLB4REP)           AB1322068;
  PARAMETER(PAR.PD_Producer_Code);
  PARAMETER(PAR.M3_Supplier_ID);
  {
   //?USER: Processing before Data update

   EXECUTE FUNCTION(Rtv Add Stamp         IF) TYPE(EXCINTFUN)                      AB1100935;
   PARAMETER(DB1.RS_Record_Status);
   PARAMETER(DB1.RS_Job);
   PARAMETER(DB1.RS_Program);
   PARAMETER(DB1.RS_User_Added);
   PARAMETER(DB1.RS_Date_Added);
   PARAMETER(DB1.RS_Time_Added);
   {
    //?Execute internal function

    // PAR.RS Record Status = CND.Active
    PAR.RS_Record_Status = 'A';

    // PAR.RS User Added = JOB.*USER
    PAR.RS_User_Added = JOB.*USER;

    // PAR.RS Date Added = JOB.*Job date
    PAR.RS_Date_Added = JOB.*Job_date;

    // PAR.RS Time Added = JOB.*Job time
    PAR.RS_Time_Added = JOB.*Job_time;

    // PAR.RS Program = JOB.*PROGRAM
    PAR.RS_Program = JOB.*PROGRAM;

    // PAR.RS Job = JOB.*JOB
    PAR.RS_Job = JOB.*JOB;

   }

  }

  //?USER: Processing before Data update

  EXECUTE FUNCTION(Rtv Change Stamp      IF) TYPE(EXCINTFUN)                      AB1100934;
  PARAMETER(DB1.RS_User_Changed);
  PARAMETER(DB1.RS_Date_Changed);
  PARAMETER(DB1.RS_Time_Changed);
  PARAMETER(DB1.RS_Job);
  PARAMETER(DB1.RS_Program);
  {
   //?Execute internal function

   // PAR.RS User Changed = JOB.*USER
   PAR.RS_User_Changed = JOB.*USER;

   // PAR.RS Date Changed = JOB.*Job date
   PAR.RS_Date_Changed = JOB.*Job_date;

   // PAR.RS Time Changed = JOB.*Job time
   PAR.RS_Time_Changed = JOB.*Job_time;

   // PAR.RS Job = JOB.*JOB
   PAR.RS_Job = JOB.*JOB;

   // PAR.RS Program = JOB.*PROGRAM
   PAR.RS_Program = JOB.*PROGRAM;

  }

 }

 //?Fax Attn 1
 CASE;

 // IF PAR.Fax Area Code # is Not Blank
 IF PAR.Fax_Area_Code_# <> *BLANK;

 // OR PAR.Fax Telephone is Not Blank
 OR PAR.Fax_Telephone <> *BLANK;

 EXECUTE FUNCTION(Upd Fax Detail        RT) TYPE(RTVOBJ) FILE(PKEAREP)           AB1206264;
 PARAMETER('HPE');
 PARAMETER(PAR.Fax_Area_Code_#);
 PARAMETER(PAR.Fax_Telephone);
 PARAMETER(PAR.Fax_Attn_1);
 {
  //?USER: Processing if Data record not found

  EXECUTE FUNCTION(Create Fax Detail) TYPE(CRTOBJ) FILE(PKEAREP)                  AB1206170;
  PARAMETER(PAR.FD_Application_Code);
  PARAMETER(PAR.FD_Fax_Area_Code);
  PARAMETER(PAR.FD_Fax_Number);
  PARAMETER(PAR.FD_Fax_Attention);
  PARAMETER(PAR.RS_User_Changed);
  PARAMETER(PAR.RS_Date_Changed);
  PARAMETER(PAR.RS_Time_Changed);
  PARAMETER(PAR.RS_Record_Status);
  PARAMETER(PAR.RS_Job);
  PARAMETER(PAR.RS_Program);
  PARAMETER(PAR.RS_User_Added);
  PARAMETER(PAR.RS_Date_Added);
  PARAMETER(PAR.RS_Time_Added);
  {
   //?USER: Processing before Data update

   EXECUTE FUNCTION(Rtv Add Stamp         IF) TYPE(EXCINTFUN)                      AB1100935;
   PARAMETER(DB1.RS_Record_Status);
   PARAMETER(DB1.RS_Job);
   PARAMETER(DB1.RS_Program);
   PARAMETER(DB1.RS_User_Added);
   PARAMETER(DB1.RS_Date_Added);
   PARAMETER(DB1.RS_Time_Added);
   {
    //?Execute internal function

    // PAR.RS Record Status = CND.Active
    PAR.RS_Record_Status = 'A';

    // PAR.RS User Added = JOB.*USER
    PAR.RS_User_Added = JOB.*USER;

    // PAR.RS Date Added = JOB.*Job date
    PAR.RS_Date_Added = JOB.*Job_date;

    // PAR.RS Time Added = JOB.*Job time
    PAR.RS_Time_Added = JOB.*Job_time;

    // PAR.RS Program = JOB.*PROGRAM
    PAR.RS_Program = JOB.*PROGRAM;

    // PAR.RS Job = JOB.*JOB
    PAR.RS_Job = JOB.*JOB;

   }

  }

  //?USER: Process Data record

  EXECUTE FUNCTION(Change Fax Detail) TYPE(CHGOBJ) FILE(PKEAREP)                  AB1206171;
  PARAMETER(DB1.FD_Application_Code);
  PARAMETER(DB1.FD_Fax_Area_Code);
  PARAMETER(DB1.FD_Fax_Number);
  PARAMETER(PAR.FD_Fax_Attention);
  {
   //?USER: Processing before Data update

   EXECUTE FUNCTION(Rtv Change Stamp      IF) TYPE(EXCINTFUN)                      AB1100934;
   PARAMETER(DB1.RS_User_Changed);
   PARAMETER(DB1.RS_Date_Changed);
   PARAMETER(DB1.RS_Time_Changed);
   PARAMETER(DB1.RS_Job);
   PARAMETER(DB1.RS_Program);
   {
    //?Execute internal function

    // PAR.RS User Changed = JOB.*USER
    PAR.RS_User_Changed = JOB.*USER;

    // PAR.RS Date Changed = JOB.*Job date
    PAR.RS_Date_Changed = JOB.*Job_date;

    // PAR.RS Time Changed = JOB.*Job time
    PAR.RS_Time_Changed = JOB.*Job_time;

    // PAR.RS Job = JOB.*JOB
    PAR.RS_Job = JOB.*JOB;

    // PAR.RS Program = JOB.*PROGRAM
    PAR.RS_Program = JOB.*PROGRAM;

   }

  }

 }

 ENDIF;

 //?Fax Attn 2
 CASE;

 // IF PAR.Fax Area Code # 2 is Not Blank
 IF PAR.Fax_Area_Code_#_2 <> *BLANK;

 // OR PAR.Fax Telephone 2 is Not Blank
 OR PAR.Fax_Telephone_2 <> *BLANK;

 EXECUTE FUNCTION(Upd Fax Detail        RT) TYPE(RTVOBJ) FILE(PKEAREP)           AB1206264;
 PARAMETER('HPE');
 PARAMETER(PAR.Fax_Area_Code_#_2);
 PARAMETER(PAR.Fax_Telephone_2);
 PARAMETER(PAR.Fax_Attn_2);
 {
  //?USER: Processing if Data record not found

  EXECUTE FUNCTION(Create Fax Detail) TYPE(CRTOBJ) FILE(PKEAREP)                  AB1206170;
  PARAMETER(PAR.FD_Application_Code);
  PARAMETER(PAR.FD_Fax_Area_Code);
  PARAMETER(PAR.FD_Fax_Number);
  PARAMETER(PAR.FD_Fax_Attention);
  PARAMETER(PAR.RS_User_Changed);
  PARAMETER(PAR.RS_Date_Changed);
  PARAMETER(PAR.RS_Time_Changed);
  PARAMETER(PAR.RS_Record_Status);
  PARAMETER(PAR.RS_Job);
  PARAMETER(PAR.RS_Program);
  PARAMETER(PAR.RS_User_Added);
  PARAMETER(PAR.RS_Date_Added);
  PARAMETER(PAR.RS_Time_Added);
  {
   //?USER: Processing before Data update

   EXECUTE FUNCTION(Rtv Add Stamp         IF) TYPE(EXCINTFUN)                      AB1100935;
   PARAMETER(DB1.RS_Record_Status);
   PARAMETER(DB1.RS_Job);
   PARAMETER(DB1.RS_Program);
   PARAMETER(DB1.RS_User_Added);
   PARAMETER(DB1.RS_Date_Added);
   PARAMETER(DB1.RS_Time_Added);
   {
    //?Execute internal function

    // PAR.RS Record Status = CND.Active
    PAR.RS_Record_Status = 'A';

    // PAR.RS User Added = JOB.*USER
    PAR.RS_User_Added = JOB.*USER;

    // PAR.RS Date Added = JOB.*Job date
    PAR.RS_Date_Added = JOB.*Job_date;

    // PAR.RS Time Added = JOB.*Job time
    PAR.RS_Time_Added = JOB.*Job_time;

    // PAR.RS Program = JOB.*PROGRAM
    PAR.RS_Program = JOB.*PROGRAM;

    // PAR.RS Job = JOB.*JOB
    PAR.RS_Job = JOB.*JOB;

   }

  }

  //?USER: Process Data record

  EXECUTE FUNCTION(Change Fax Detail) TYPE(CHGOBJ) FILE(PKEAREP)                  AB1206171;
  PARAMETER(DB1.FD_Application_Code);
  PARAMETER(DB1.FD_Fax_Area_Code);
  PARAMETER(DB1.FD_Fax_Number);
  PARAMETER(PAR.FD_Fax_Attention);
  {
   //?USER: Processing before Data update

   EXECUTE FUNCTION(Rtv Change Stamp      IF) TYPE(EXCINTFUN)                      AB1100934;
   PARAMETER(DB1.RS_User_Changed);
   PARAMETER(DB1.RS_Date_Changed);
   PARAMETER(DB1.RS_Time_Changed);
   PARAMETER(DB1.RS_Job);
   PARAMETER(DB1.RS_Program);
   {
    //?Execute internal function

    // PAR.RS User Changed = JOB.*USER
    PAR.RS_User_Changed = JOB.*USER;

    // PAR.RS Date Changed = JOB.*Job date
    PAR.RS_Date_Changed = JOB.*Job_date;

    // PAR.RS Time Changed = JOB.*Job time
    PAR.RS_Time_Changed = JOB.*Job_time;

    // PAR.RS Job = JOB.*JOB
    PAR.RS_Job = JOB.*JOB;

    // PAR.RS Program = JOB.*PROGRAM
    PAR.RS_Program = JOB.*PROGRAM;

   }

  }

 }

 ENDIF;

 //?MPR Producer Purchase Type
 CASE;

 // IF PAR.MPR Purchase Type Code is Entered
 IF PAR.MPR_Purchase_Type_Code > 0;

 EXECUTE FUNCTION(Rtv/Crt/Chg MPR PrPur RT) TYPE(RTVOBJ) FILE(PKE3CPP)           AB1235598;
 PARAMETER(PAR.PD_Producer_Code);
 PARAMETER(PAR.MPR_Purchase_Type_Code);
 PARAMETER(PAR.RS_User_Changed);
 PARAMETER(PAR.RS_Date_Changed);
 PARAMETER(PAR.RS_Time_Changed);
 PARAMETER(PAR.RS_Record_Status);
 PARAMETER(PAR.RS_Job);
 PARAMETER(PAR.RS_Program);
 PARAMETER(PAR.RS_User_Added);
 PARAMETER(PAR.RS_Date_Added);
 PARAMETER(PAR.RS_Time_Added);
 {
  //?USER: Processing if Data record not found

  EXECUTE FUNCTION(Crt MPR Prdcr Purch   CR) TYPE(CRTOBJ) FILE(PKE3CPP)           AB1235460;
  PARAMETER(PAR.PD_Producer_Code);
  PARAMETER(PAR.MPR_Purchase_Type_Code);
  PARAMETER(*BLANK);
  PARAMETER(*ZERO);
  PARAMETER(*ZERO);
  PARAMETER('A');
  PARAMETER(PAR.RS_Job);
  PARAMETER(PAR.RS_Program);
  PARAMETER(PAR.RS_User_Added);
  PARAMETER(PAR.RS_Date_Added);
  PARAMETER(PAR.RS_Time_Added);
  {
   //?USER: Processing before Data update

   EXECUTE FUNCTION(Rtv Add Stamp         IF) TYPE(EXCINTFUN)                      AB1100935;
   PARAMETER(DB1.RS_Record_Status);
   PARAMETER(DB1.RS_Job);
   PARAMETER(DB1.RS_Program);
   PARAMETER(DB1.RS_User_Added);
   PARAMETER(DB1.RS_Date_Added);
   PARAMETER(DB1.RS_Time_Added);
   {
    //?Execute internal function

    // PAR.RS Record Status = CND.Active
    PAR.RS_Record_Status = 'A';

    // PAR.RS User Added = JOB.*USER
    PAR.RS_User_Added = JOB.*USER;

    // PAR.RS Date Added = JOB.*Job date
    PAR.RS_Date_Added = JOB.*Job_date;

    // PAR.RS Time Added = JOB.*Job time
    PAR.RS_Time_Added = JOB.*Job_time;

    // PAR.RS Program = JOB.*PROGRAM
    PAR.RS_Program = JOB.*PROGRAM;

    // PAR.RS Job = JOB.*JOB
    PAR.RS_Job = JOB.*JOB;

   }

  }

  //?USER: Process Data record

  CASE;

  // IF PAR.MPR Purchase Type Code NE DB1.MPR Purchase Type Code
  IF PAR.MPR_Purchase_Type_Code <> DB1.MPR_Purchase_Type_Code;

  EXECUTE FUNCTION(Del MPR Prdcr Purch   DL) TYPE(DLTOBJ) FILE(PKE3CPP)           AB1235462;
  PARAMETER(DB1.PD_Producer_Code);
  PARAMETER(DB1.MPR_Purchase_Type_Code);
  EXECUTE FUNCTION(Crt MPR Prdcr Purch   CR) TYPE(CRTOBJ) FILE(PKE3CPP)           AB1235460;
  PARAMETER(PAR.PD_Producer_Code);
  PARAMETER(PAR.MPR_Purchase_Type_Code);
  PARAMETER(PAR.RS_User_Changed);
  PARAMETER(PAR.RS_Date_Changed);
  PARAMETER(PAR.RS_Time_Changed);
  PARAMETER('A');
  PARAMETER(PAR.RS_Job);
  PARAMETER(DB1.RS_Program);
  PARAMETER(DB1.RS_User_Added);
  PARAMETER(DB1.RS_Date_Added);
  PARAMETER(DB1.RS_Time_Added);
  {
   //?USER: Processing before Data update

   EXECUTE FUNCTION(Rtv Add Stamp         IF) TYPE(EXCINTFUN)                      AB1100935;
   PARAMETER(DB1.RS_Record_Status);
   PARAMETER(DB1.RS_Job);
   PARAMETER(DB1.RS_Program);
   PARAMETER(DB1.RS_User_Added);
   PARAMETER(DB1.RS_Date_Added);
   PARAMETER(DB1.RS_Time_Added);
   {
    //?Execute internal function

    // PAR.RS Record Status = CND.Active
    PAR.RS_Record_Status = 'A';

    // PAR.RS User Added = JOB.*USER
    PAR.RS_User_Added = JOB.*USER;

    // PAR.RS Date Added = JOB.*Job date
    PAR.RS_Date_Added = JOB.*Job_date;

    // PAR.RS Time Added = JOB.*Job time
    PAR.RS_Time_Added = JOB.*Job_time;

    // PAR.RS Program = JOB.*PROGRAM
    PAR.RS_Program = JOB.*PROGRAM;

    // PAR.RS Job = JOB.*JOB
    PAR.RS_Job = JOB.*JOB;

   }

  }

  ENDIF;

 }

 ENDIF;

}


//?USER: Process command keys

CASE;

// IF PGM.*Program mode is *CHANGE
IF PGM.*Program_mode = 'CHG';

RETURN;

ENDIF;

