      *****************  RPG PROGRAM HEADING  ************************
      *
      * ENVIRONMENT:  J.D. Edwards
      * PROGRAM:      ACTRETW
      * TITLE:        Validate Account ID in JDE
      * AUTHOR:       Brad Baden   SDN465   TFS# 16169
      * CREATED:       3/13/2020
      *
      * FUNCTION: This program validates the account I.D. and returns a 50-character
      *           description that is a concatenation of:
      *              cost center + object account + subsidiary + description
      *
      *
      ****************************************************************
      * MODIFICATIONS:
      ****************************************************************
      * DATE      PROGRAMMER
      * 06/27/03  Barb Gutierrez
      *           This program was excluding posting edit codes of an "I'
      *           or an "N" (Inactive and Non posting).  Want to retrieve
      *           the account info regardless of the posting edit code.
      *
      *  3/10/20  Brad Baden    SDN465  TFS# 16169
      *           Rename this program from ACTRET to ACTRETW and move it
      *           from QRPGLESRC in JFOODCUST to E1IDEVGEN.
      *
      /EJECT
      ****************************************************************
      * FILE SPECIFICATIONS
      ****************************************************************
      *
     Ff0901la   if   e           k disk
      *    account master
      *
      /eject
      ****************************************************************
      * DEFINITION SPECIFICATIONS
      ****************************************************************
      *
      *
      * Parm fields
      *
     D xxretrn         s              7
     D xxaid           s                   like(gmaid)
     D xxchar50        s             50
      *
      *
      * The following is a dummy C-spec to keep the D-specs from
      * running over into the C-specs on the compile listing. It
      * serves no other purpose and can be deleted at any time.
      *
     C                   if        xxaid = *blank
     C                   endif
      /EJECT
      ****************************************************************
      * MAINLINE
      ****************************************************************
      *
      * Valaidate that the account is an active/posting account in the
      * account master file
      *
     C     xxaid         chain     f0901la                            92
     C                   if        *in92 = *off                                 If hit
     C*********          if        *in92 = *off and                             If hit
     C*********                    gmpec <> 'I' and
     C*********                    gmpec <> 'N'
      *
      * Build a 50-character field that consists of:
      *    a) cost center  (ie: business unit)
      *    b) object account
      *    c) subsidiary
      *    d) description
      *
      * Cost center
     C                   eval      %subst(xxchar50: 1: 12) = gmmcu
      * Object account
     C                   eval      %subst(xxchar50: 14: 6) = gmobj
      * Subsidiary
     C                   eval      %subst(xxchar50: 21: 8) = gmsub
      * Description
     C                   eval      %subst(xxchar50: 30: 21) = gmdl01
     C                   else
      *
      * Account did not exist or was inactive or was not a posting account.
      *
     C                   eval      xxretrn = 'ERR    '
     C                   endif                                                  If hit
      *
     C                   seton                                        lr
      /EJECT
      *---------------------------------------------------------------
      * *inzsr - initialization subroutine
      *---------------------------------------------------------------
      *
     C     *inzsr        begsr
      *
      * Parm lists
      *
     C     *entry        plist
     C                   parm                    xxretrn
     C                   parm                    xxaid
     C                   parm                    xxchar50
      *
     C                   endsr
      /EJECT
