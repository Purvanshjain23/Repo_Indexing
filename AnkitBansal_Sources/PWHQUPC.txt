/*********************************************************************/
/* PROGRAM : PWHQUPC                                                 */
/* DESC    : Carcass Weight Range Report using SEQUEL                */
/* DATE    : 11/16/2018                                              */
/* PROJECT : E14119 - Carcass Weight Range                           */
/* BY      : Brad baden                                              */
/* PURPOSE : Call SEQUEL to send Carcass Weight Range report as an   */
/*           Excel spreadsheet to a user via email.                  */
/*********************************************************************/
/* MAINTENANCE LOG:                                                  */
/*-------------------------------------------------------------------*/
/* DATE     BY  CHANGE DESCRIPTION                                   */
/* -------- --- ---------------------------------------------------- */
/* MM/DD/YY xxx Project ID. Desc                                     */
/*                                                                   */
/*********************************************************************/

             PGM

             DCL        VAR(&COMP) TYPE(*DEC) LEN(3 0)
             DCL        VAR(&COMPA) TYPE(*CHAR) LEN(5)
             DCL        VAR(&PROD) TYPE(*CHAR) LEN(8)
             DCL        VAR(&FDATEA) TYPE(*CHAR) LEN(8)
             DCL        VAR(&FDATE) TYPE(*DEC) LEN(7 0)
             DCL        VAR(&TDATEA) TYPE(*CHAR) LEN(8)
             DCL        VAR(&TDATE) TYPE(*DEC) LEN(7 0)
             DCL        VAR(&FWGT) TYPE(*DEC) LEN(5 0)
             DCL        VAR(&FWGTA) TYPE(*CHAR) LEN(5)
             DCL        VAR(&TWGT) TYPE(*DEC) LEN(5 0)
             DCL        VAR(&TWGTA) TYPE(*CHAR) LEN(5)
             DCL        VAR(&SRC) TYPE(*CHAR) LEN(5)
             DCL        VAR(&EMAIL) TYPE(*CHAR) LEN(50)

             CHGVAR     VAR(&COMP) VALUE(960)
             CHGVAR     VAR(&FDATEA) VALUE('10/27/18')
             CHGVAR     VAR(&TDATEA) VALUE('11/04/18')
             CHGVAR     VAR(&FWGTA) VALUE('100')
             CHGVAR     VAR(&TWGTA) VALUE('159')
             CHGVAR     VAR(&SRC) VALUE('"CPR"')
             CHGVAR     VAR(&EMAIL) +
                          VALUE('brad.baden@seaboardfoods.com  ')

/*-------------------------------------------------------------------*/
/* Create Excel Spreadsheet with SEQUEL Viewpoint and email to       */
/* receipient.                                                       */
/*-------------------------------------------------------------------*/
    /* Format Data to Blanks. */
         /* Company */
             IF         COND(&COMP = 0) THEN(DO)
             CHGVAR     VAR(&COMPA) VALUE('960')
             ENDDO
         /* Item Code */
             IF         COND(&PROD = '     ') THEN(DO)
             CHGVAR     VAR(&PROD) VALUE('*ALL')
             ENDDO

             EXECUTE    VIEW(WGTRANGE) PCFMT(*XLS) RECIPIENT(&EMAIL) +
                          EMLMSG('Carcass Weight Range Report') +
                          SETVAR((&COMP &COMPA) (&PROD &PROD) +
                          (&FDATE &FDATEA) (&TDATE &TDATEA) (&FWGT +
                          &FWGTA) (&TWGT &TWGTA) (&SRC &SRC))

 ENDPGM:
             ENDPGM
