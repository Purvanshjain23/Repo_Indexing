     H/TITLE Prt IC Sales Adj/Upd  PF  Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Print file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 12/05/19  Time  : 14:43:28
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FCAAFREL6IF  E           K        DISK
      * RSQ : Calendar                  RSQ Co/Date Descending
      *
     FOMHSTPMHIF  E           K        DISK
      * RSQ : Sales History             Type/Date(d)/ShT/Inv#/It
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FOMHLREL1IF  E           K        DISK
      * RTV : Accrual Program           Retrieval index
      *
     FOMHRCPL1IF  E           K        DISK
      * RTV : Shipping Dtl Accrual      Retrieval index
      *
     FPDNEREL1IF  E           K        DISK
      * RTV : Customer EXT              Retrieval index
      *
     FPOC5REL0IF  E           K        DISK
      * RTV : Broker                    Retrieval index
      *
     FPDJYREL2IF  E           K        DISK
      * RTV : Company Defaults Internal Active Records
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOMHSTPL0UF  E           K        DISK
      * UPD : Sales History             Update index
      *
     FOMHRCPL0IF  E           K        DISK                      A
      * UPD : Shipping Dtl Accrual      Update index
      *
     FPDICCPL0IF  E           K        DISK                      A
      * UPD : History Dtl Accrual       Update index
      *
     FPNKLPFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: Prt IC Sales Adj/Upd  PF  Print file
      *
     E                    UCT        40  1               CENTER TABLE
     E                    #L3         3  1
     E                    #L7         7  1
      * Long constants
     E                    @CN#    1  02  6   @CN    25
     I@FHSTD2
      * Sales History             Update index
      * Renamed input format fields
     I              F4AIC3                          WAAIC3
     I              F4C4NB                          WAC4NB
     I              F4DPNB                          WADPNB
     I              F4UENB                          WAUENB
     I              F4MONA                          WAMONA
     I              F4RJCD                          WARJCD
     I              F4RKCD                          WARKCD
     I              F4GPTX                          WAGPTX
     I              F4ABTX                          WAABTX
     I              F4KXCD                          WAKXCD
     I              F4BOCD                          WABOCD
     I              F4BTC7                          WABTC7
     I              F4ANC7                          WAANC7
     I              F4AQTX                          WAAQTX
     I              F4BKC7                          WABKC7
     I              F4BRTX                          WABRTX
     I              F4HNNA                          WAHNNA
     I              F4DBCD                          WADBCD
     I              F4CKTX                          WACKTX
     I              F4BCNA                          WABCNA
     I              F4A0DT                          WAA0DT
     I              F4ACDT                          WAACDT
     I              F4R4CD                          WAR4CD
     I              F4R5CD                          WAR5CD
     I              F4BFCD                          WABFCD
     I              F4Q4CD                          WAQ4CD
     I              F4AQCD                          WAAQCD
     I              F4TBNB                          WATBNB
     I              F4BZNA                          WABZNA
     I              F4RLCD                          WARLCD
     I              F4JNCD                          WAJNCD
     I              F4Q2CD                          WAQ2CD
     I              F4U2ST                          WAU2ST
     I              F4ATIN                          WAATIN
     I              F4T3NB                          WAT3NB
     I              F4RSRN                          WARSRN
     I              F4ORIT                          WAORIT
     I              F4AJCD                          WAAJCD
     I              F4AVQT                          WAAVQT
     I              F4D0WG                          WAD0WG
     I              F4CCQT                          WACCQT
     I              F4AUWG                          WAAUWG
     I              F4AGCD                          WAAGCD
     I              F4AKPR                          WAAKPR
     I              F4AUPR                          WAAUPR
     I              F4CRCD                          WACRCD
     I              F4A5DT                          WAA5DT
     I              F4AWDT                          WAAWDT
     I              F4HDDT                          WAHDDT
     I              F4AGCS                          WAAGCS
     I              F4AQCS                          WAAQCS
     I              F4AVWG                          WAAVWG
     I              F4AYVA                          WAAYVA
     I              F4AMST                          WAAMST
     I              F4ANST                          WAANST
     I              F4VAST                          WAVAST
     I              F4L6NB                          WAL6NB
     I              F4UMCD                          WAUMCD
     I              F4HCDT                          WAHCDT
     I              F4ESNB                          WAESNB
     I              F4ETNB                          WAETNB
     I              F4BZNB                          WABZNB
     I              F4EXQT                          WAEXQT
     I              F4BYWG                          WABYWG
     I              F4S5NB                          WAS5NB
     I              F4MAVA                          WAMAVA
     I              F4KDVA                          WAKDVA
     I              F4USVA                          WAUSVA
     I              F4UTVA                          WAUTVA
     I              F4A4WG                          WAA4WG
     I              F4CKNB                          WACKNB
     I              F4BMST                          WABMST
     I              F4R8NB                          WAR8NB
     I              F4RMCD                          WARMCD
     I              F4BZPR                          WABZPR
     I              F4RDCD                          WARDCD
     I              F4Q7CD                          WAQ7CD
     I              F4EXDT                          WAEXDT
     I              F4LQCD                          WALQCD
     I              F4HICD                          WAHICD
     I              F4RBCD                          WARBCD
     I              F4RGNB                          WARGNB
     I              F4RHNB                          WARHNB
     I              F4RINB                          WARINB
     I              F4R1NB                          WAR1NB
     I              F4CONB                          WACONB
     I              F4CEST                          WACEST
     I              F4GNDT                          WAGNDT
     I              F4RMNB                          WARMNB
     I              F4AODT                          WAAODT
     I              F4LLCD                          WALLCD
     I              F4LMCD                          WALMCD
     I              F4SKNB                          WASKNB
     I              F4SLNB                          WASLNB
     I              F4SMNB                          WASMNB
     I              F4G7NA                          WAG7NA
     I              F4ONVA                          WAONVA
     I              F4N0CD                          WAN0CD
     I              F4B4NB                          WAB4NB
     I              F4B5NB                          WAB5NB
     I              F4N1CD                          WAN1CD
     I              F4GIDT                          WAGIDT
     I              F4Z1ST                          WAZ1ST
     I              F4ULVA                          WAULVA
     I              F4UNVA                          WAUNVA
     I              F4UOVA                          WAUOVA
     I              F4UPVA                          WAUPVA
     I              F4UQVA                          WAUQVA
     I              F4SDCD                          WASDCD
     I              F4QZCD                          WAQZCD
     I              F4XWST                          WAXWST
     I              F4T9CD                          WAT9CD
     I              F4UBCD                          WAUBCD
     I              F4CFC7                          WACFC7
     I              F4X1CD                          WAX1CD
     I              F4GASX                          WAGASX
     I              F4DUPR                          WADUPR
     I              F4B6VL                          WAB6VL
     I              F4IANX                          WAIANX
     I              F4IBNX                          WAIBNX
     I              F4RPCD                          WARPCD
     I              F4NYDT                          WANYDT
     I              F4BZTM                          WABZTM
     I              F4Z4NB                          WAZ4NB
     I              F4XACD                          WAXACD
     I              F4OANA                          WAOANA
     I              F4OKTX                          WAOKTX
     I              F4K4TX                          WAK4TX
     I              F4NBBO                          WANBBO
     I              F4OCFR                          WAOCFR
     I              F4C0C7                          WAC0C7
     I              F4A1AA                          WAA1AA
     I              F4VEST                          WAVEST
     I              F4A5PR                          WAA5PR
     I              F4CDPR                          WACDPR
     I              F4D0PR                          WAD0PR
     I              F4D0VL                          WAD0VL
     I              F4IRSX                          WAIRSX
     I              F4CEVL                          WACEVL
     I              F4ISSX                          WAISSX
     I              F4ITSX                          WAITSX
     I              F4IUSX                          WAIUSX
     I              F4OHDT                          WAOHDT
     I              F4D9PR                          WAD9PR
     I              F4CFVL                          WACFVL
     I              F4UVST                          WAUVST
     I              F4UWST                          WAUWST
     I              F4UXST                          WAUXST
     I              F4AATM                          WAAATM
     I              F4AYNA                          WAAYNA
     I              F4A0NA                          WAA0NA
     I              F4AXDT                          WAAXDT
      *
     I@HRCPLL
      * Shipping Dtl Accrual      Update index
      * Renamed input format fields
     I              HRAIC3                          WBAIC3
     I              HRC4NB                          WBC4NB
     I              HRDPNB                          WBDPNB
     I              HRUENB                          WBUENB
     I              HRDXNB                          WBDXNB
     I              HRBKPR                          WBBKPR
     I              HRC5PC                          WBC5PC
     I              HRAYVA                          WBAYVA
     I              HREDVL                          WBEDVL
     I              HRHGCD                          WBHGCD
     I              HRBKC7                          WBBKC7
     I              HRDUC7                          WBDUC7
     I              HRHHAA                          WBHHAA
     I              HRPODT                          WBPODT
     I              HRBYWG                          WBBYWG
     I              HRBVST                          WBBVST
     I              HRP7SX                          WBP7SX
     I              HROKCD                          WBOKCD
     I              HRP8SX                          WBP8SX
     I              HRP9SX                          WBP9SX
     I              HRQASX                          WBQASX
     I              HRQBSX                          WBQBSX
     I              HRPPDT                          WBPPDT
     I              HRPQDT                          WBPQDT
     I              HREEVL                          WBEEVL
     I              HREFVL                          WBEFVL
     I              HRFITX                          WBFITX
     I              HRFJTX                          WBFJTX
     I              HRQ8DT                          WBQ8DT
     I              HRFKTX                          WBFKTX
     I              HRH0NY                          WBH0NY
     I              HRKQT1                          WBKQT1
     I              HRKTT1                          WBKTT1
     I              HRHIAA                          WBHIAA
     I              HRHLAA                          WBHLAA
     I              HROJCD                          WBOJCD
     I              HRAVNB                          WBAVNB
     I              HRDSCD                          WBDSCD
     I              HRUVST                          WBUVST
     I              HRUWST                          WBUWST
     I              HRUXST                          WBUXST
     I              HRAATM                          WBAATM
     I              HRAYNA                          WBAYNA
     I              HRA0NA                          WBA0NA
     I              HRAXDT                          WBAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
     IQOMHS1    E DSOMHSTPL0
      * UPD : Sales History             Update index
      * Renamed input format fields
     I              F4AIC3                          WAAIC3
     I              F4C4NB                          WAC4NB
     I              F4DPNB                          WADPNB
     I              F4UENB                          WAUENB
     I              F4MONA                          WAMONA
     I              F4RJCD                          WARJCD
     I              F4RKCD                          WARKCD
     I              F4GPTX                          WAGPTX
     I              F4ABTX                          WAABTX
     I              F4KXCD                          WAKXCD
     I              F4BOCD                          WABOCD
     I              F4BTC7                          WABTC7
     I              F4ANC7                          WAANC7
     I              F4AQTX                          WAAQTX
     I              F4BKC7                          WABKC7
     I              F4BRTX                          WABRTX
     I              F4HNNA                          WAHNNA
     I              F4DBCD                          WADBCD
     I              F4CKTX                          WACKTX
     I              F4BCNA                          WABCNA
     I              F4A0DT                          WAA0DT
     I              F4ACDT                          WAACDT
     I              F4R4CD                          WAR4CD
     I              F4R5CD                          WAR5CD
     I              F4BFCD                          WABFCD
     I              F4Q4CD                          WAQ4CD
     I              F4AQCD                          WAAQCD
     I              F4TBNB                          WATBNB
     I              F4BZNA                          WABZNA
     I              F4RLCD                          WARLCD
     I              F4JNCD                          WAJNCD
     I              F4Q2CD                          WAQ2CD
     I              F4U2ST                          WAU2ST
     I              F4ATIN                          WAATIN
     I              F4T3NB                          WAT3NB
     I              F4RSRN                          WARSRN
     I              F4ORIT                          WAORIT
     I              F4AJCD                          WAAJCD
     I              F4AVQT                          WAAVQT
     I              F4D0WG                          WAD0WG
     I              F4CCQT                          WACCQT
     I              F4AUWG                          WAAUWG
     I              F4AGCD                          WAAGCD
     I              F4AKPR                          WAAKPR
     I              F4AUPR                          WAAUPR
     I              F4CRCD                          WACRCD
     I              F4A5DT                          WAA5DT
     I              F4AWDT                          WAAWDT
     I              F4HDDT                          WAHDDT
     I              F4AGCS                          WAAGCS
     I              F4AQCS                          WAAQCS
     I              F4AVWG                          WAAVWG
     I              F4AYVA                          WAAYVA
     I              F4AMST                          WAAMST
     I              F4ANST                          WAANST
     I              F4VAST                          WAVAST
     I              F4L6NB                          WAL6NB
     I              F4UMCD                          WAUMCD
     I              F4HCDT                          WAHCDT
     I              F4ESNB                          WAESNB
     I              F4ETNB                          WAETNB
     I              F4BZNB                          WABZNB
     I              F4EXQT                          WAEXQT
     I              F4BYWG                          WABYWG
     I              F4S5NB                          WAS5NB
     I              F4MAVA                          WAMAVA
     I              F4KDVA                          WAKDVA
     I              F4USVA                          WAUSVA
     I              F4UTVA                          WAUTVA
     I              F4A4WG                          WAA4WG
     I              F4CKNB                          WACKNB
     I              F4BMST                          WABMST
     I              F4R8NB                          WAR8NB
     I              F4RMCD                          WARMCD
     I              F4BZPR                          WABZPR
     I              F4RDCD                          WARDCD
     I              F4Q7CD                          WAQ7CD
     I              F4EXDT                          WAEXDT
     I              F4LQCD                          WALQCD
     I              F4HICD                          WAHICD
     I              F4RBCD                          WARBCD
     I              F4RGNB                          WARGNB
     I              F4RHNB                          WARHNB
     I              F4RINB                          WARINB
     I              F4R1NB                          WAR1NB
     I              F4CONB                          WACONB
     I              F4CEST                          WACEST
     I              F4GNDT                          WAGNDT
     I              F4RMNB                          WARMNB
     I              F4AODT                          WAAODT
     I              F4LLCD                          WALLCD
     I              F4LMCD                          WALMCD
     I              F4SKNB                          WASKNB
     I              F4SLNB                          WASLNB
     I              F4SMNB                          WASMNB
     I              F4G7NA                          WAG7NA
     I              F4ONVA                          WAONVA
     I              F4N0CD                          WAN0CD
     I              F4B4NB                          WAB4NB
     I              F4B5NB                          WAB5NB
     I              F4N1CD                          WAN1CD
     I              F4GIDT                          WAGIDT
     I              F4Z1ST                          WAZ1ST
     I              F4ULVA                          WAULVA
     I              F4UNVA                          WAUNVA
     I              F4UOVA                          WAUOVA
     I              F4UPVA                          WAUPVA
     I              F4UQVA                          WAUQVA
     I              F4SDCD                          WASDCD
     I              F4QZCD                          WAQZCD
     I              F4XWST                          WAXWST
     I              F4T9CD                          WAT9CD
     I              F4UBCD                          WAUBCD
     I              F4CFC7                          WACFC7
     I              F4X1CD                          WAX1CD
     I              F4GASX                          WAGASX
     I              F4DUPR                          WADUPR
     I              F4B6VL                          WAB6VL
     I              F4IANX                          WAIANX
     I              F4IBNX                          WAIBNX
     I              F4RPCD                          WARPCD
     I              F4NYDT                          WANYDT
     I              F4BZTM                          WABZTM
     I              F4Z4NB                          WAZ4NB
     I              F4XACD                          WAXACD
     I              F4OANA                          WAOANA
     I              F4OKTX                          WAOKTX
     I              F4K4TX                          WAK4TX
     I              F4NBBO                          WANBBO
     I              F4OCFR                          WAOCFR
     I              F4C0C7                          WAC0C7
     I              F4A1AA                          WAA1AA
     I              F4VEST                          WAVEST
     I              F4A5PR                          WAA5PR
     I              F4CDPR                          WACDPR
     I              F4D0PR                          WAD0PR
     I              F4D0VL                          WAD0VL
     I              F4IRSX                          WAIRSX
     I              F4CEVL                          WACEVL
     I              F4ISSX                          WAISSX
     I              F4ITSX                          WAITSX
     I              F4IUSX                          WAIUSX
     I              F4OHDT                          WAOHDT
     I              F4D9PR                          WAD9PR
     I              F4CFVL                          WACFVL
     I              F4UVST                          WAUVST
     I              F4UWST                          WAUWST
     I              F4UXST                          WAUXST
     I              F4AATM                          WAAATM
     I              F4AYNA                          WAAYNA
     I              F4A0NA                          WAA0NA
     I              F4AXDT                          WAAXDT
      *
     IYARDCS      DS                            792
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQOMHR1    E DSOMHRCPL0
      * UPD : Shipping Dtl Accrual      Update index
      * Renamed input format fields
     I              HRAIC3                          WBAIC3
     I              HRC4NB                          WBC4NB
     I              HRDPNB                          WBDPNB
     I              HRUENB                          WBUENB
     I              HRDXNB                          WBDXNB
     I              HRBKPR                          WBBKPR
     I              HRC5PC                          WBC5PC
     I              HRAYVA                          WBAYVA
     I              HREDVL                          WBEDVL
     I              HRHGCD                          WBHGCD
     I              HRBKC7                          WBBKC7
     I              HRDUC7                          WBDUC7
     I              HRHHAA                          WBHHAA
     I              HRPODT                          WBPODT
     I              HRBYWG                          WBBYWG
     I              HRBVST                          WBBVST
     I              HRP7SX                          WBP7SX
     I              HROKCD                          WBOKCD
     I              HRP8SX                          WBP8SX
     I              HRP9SX                          WBP9SX
     I              HRQASX                          WBQASX
     I              HRQBSX                          WBQBSX
     I              HRPPDT                          WBPPDT
     I              HRPQDT                          WBPQDT
     I              HREEVL                          WBEEVL
     I              HREFVL                          WBEFVL
     I              HRFITX                          WBFITX
     I              HRFJTX                          WBFJTX
     I              HRQ8DT                          WBQ8DT
     I              HRFKTX                          WBFKTX
     I              HRH0NY                          WBH0NY
     I              HRKQT1                          WBKQT1
     I              HRKTT1                          WBKTT1
     I              HRHIAA                          WBHIAA
     I              HRHLAA                          WBHLAA
     I              HROJCD                          WBOJCD
     I              HRAVNB                          WBAVNB
     I              HRDSCD                          WBDSCD
     I              HRUVST                          WBUVST
     I              HRUWST                          WBUWST
     I              HRUXST                          WBUXST
     I              HRAATM                          WBAATM
     I              HRAYNA                          WBAYNA
     I              HRA0NA                          WBA0NA
     I              HRAXDT                          WBAXDT
      *
     IQPDIC1    E DSPDICCPL0
      * UPD : History Dtl Accrual       Update index
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Sales History
      * I : RST Type Code
     I                                        1   2 P1BOCD
      * I : POS Actual Shipped Date
     I                                    P   3   60P1GNDT
     IP2PARM      DS
      * N :  From Date             USR
     I                                    P   1   40P2L9DT
     IP3PARM      DS
      * N :  TP Sales Company Select
     I                                    P   1   20P3CXC3
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1BOCD    PARM           WP0001  2        Type Code
     C           P1GNDT    PARM           WP0002  70       Actual Shipped
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prt IC Sales Adj/Upd  PF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$EENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * Prt IC Sales Adj/Upd  PF: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN F4BOCD    WQKA01           Type Code
      * Define keylist
     C           KPSA      KLIST
     C                     KFLD           WQKA01           Type Code
     C                     KFLD           F4GNDT           Actual Shipped
      * Define keylist
     C           KRSA      KLIST
     C                     KFLD           WQKA01           Type Code
      * Setup key
     C                     MOVELP1BOCD    WQKA01           Type Code
     C                     Z-ADDP1GNDT    F4GNDT           Actual Shipped
      * Establish starting position
     C           KPSA      SETLL@HSTPCN                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        Type Code
     C                     MOVEL'Y'       W0AL01  1        Actual Shipped
     C                     MOVEL'Y'       W0AL02  1        Ship To Custome
     C                     MOVEL'Y'       W0AL03  1        Invoice Number
     C                     MOVEL'Y'       W0AL04  1        Shipped Item Co
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADD*ZERO     $DP3NY           Sales Adjustmen
     C                     Z-ADD*ZERO     $DL7VL           Ledgrd Accrl Am
     C                     Z-ADD*ZERO     $DL8VL           Ledgrd Accrl Am
     C                     Z-ADD*ZERO     $DMCVL           NonLedgrd Accrl
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP01  1
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP02  1
     C                     END
      *
     C           W0AL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP03  1
     C                     END
      *
     C           W0AL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP04  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDF4AWDT    $CAWDT           Invoice Date
     C                     Z-ADDF4GNDT    $CGNDT           Actual Shipped
     C                     Z-ADDF4AIC3    $CAIC3           Company Number
     C                     Z-ADDF4BKC7    $CBKC7           Ship To Custome
     C                     Z-ADDF4C4NB    $CC4NB           Order Number
     C                     Z-ADDF4RMNB    $CRMNB           Load ID
     C                     MOVELF4BOCD    $CBOCD           Type Code
     C                     Z-ADDF4S5NB    $CS5NB           Shipped Item Co
     C                     MOVEL*BLANK    $CSYCD           G/L Sub Code
     C                     Z-ADD*ZERO     $CL5VL           FOB Gross Amoun
     C                     Z-ADD*ZERO     $CATWG           Weight Shipped
     C                     Z-ADD*ZERO     $CGPPR           Transfer Price
     C                     Z-ADDF4USVA    $CUSVA           FOB Gross Amoun
     C                     Z-ADD*ZERO     $CL2VL           FOB Gross Amoun
     C                     Z-ADDF4BYWG    $CBYWG           Weight Billed
     C                     Z-ADD*ZERO     $CLOVA           Price Adjustmen
     C                     Z-ADD*ZERO     $CEKPR           Price 1 USR
     C                     Z-ADD*ZERO     $CP1NY           Sales Adjustmen
     C                     Z-ADD*ZERO     $CP2NY           Sales Adjustmen
     C                     Z-ADDF4CONB    $CCONB           Invoice Number
     C                     Z-ADDF4UNVA    $CUNVA           Ledgrd Trd Fund
     C                     Z-ADD*ZERO     $CL6VL           Ledgrd Accrl Am
     C                     MOVEL*BLANK    $CHETX           Explaination Te
     C                     MOVELF4BRTX    $CBRTX           Ship To Name
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN F4BOCD    WZA001           Type Code
     C                     MOVELF4BOCD    WZA001
     C           *LIKE     DEFN F4GNDT    WZA002           Actual Shipped
     C                     Z-ADDF4GNDT    WZA002
     C           *LIKE     DEFN F4BKC7    WZA003           Ship To Custome
     C                     Z-ADDF4BKC7    WZA003
     C           *LIKE     DEFN F4CONB    WZA004           Invoice Number
     C                     Z-ADDF4CONB    WZA004
     C           *LIKE     DEFN F4S5NB    WZA005           Shipped Item Co
     C                     Z-ADDF4S5NB    WZA005
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C           KRSA      READE@HSTPCN                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * CASE: DB1.Actual Shipped Date LT PAR.From Date             USR
     C           F4GNDT    IFLT P2L9DT                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Added 12/04/19 RMC
      * CASE: DB1.Order Type - Sales is Not Regular Order
     C           F4JNCD    IFNE 'OR'                       *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        Type Code
     C                     MOVEL*BLANK    W0AL01  1        Actual Shipped
     C                     MOVEL*BLANK    W0AL02  1        Ship To Custome
     C                     MOVEL*BLANK    W0AL03  1        Invoice Number
     C                     MOVEL*BLANK    W0AL04  1        Shipped Item Co
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        Type Code
     C                     MOVEL'Y'       W0AL01  1        Actual Shipped
     C                     MOVEL'Y'       W0AL02  1        Ship To Custome
     C                     MOVEL'Y'       W0AL03  1        Invoice Number
     C                     MOVEL'Y'       W0AL04  1        Shipped Item Co
     C                     ELSE
      * Next record - Detect level breaks
     C           F4BOCD    IFNE WZA001                     Type Code
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C           F4GNDT    IFNE WZA002                     Actual Shipped
     C           W0AL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL01
     C                     END
     C           F4BKC7    IFNE WZA003                     Ship To Custome
     C           W0AL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL02
     C                     END
     C           F4CONB    IFNE WZA004                     Invoice Number
     C           W0AL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL03
     C                     END
     C           F4S5NB    IFNE WZA005                     Shipped Item Co
     C           W0AL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL04
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP04
     C                     END
      *
     C           W0AL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP03
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP02
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP01
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 1
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$DFINTTL
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of Prt IC Sales Adj/Upd  PF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of Prt IC Sales Adj/Upd  PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print Type Code of Prt IC Sales Adj/Upd  PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP00
     C                     END                             FI
      * Print Actual Shipped Date of Prt IC Sales Adj/Upd  PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP01
     C                     END                             FI
      * Print Ship To Customer of Prt IC Sales Adj/Upd  PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP02
     C                     END                             FI
      * Print Invoice Number of Prt IC Sales Adj/Upd  PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP03
     C                     END                             FI
      * Print Shipped Item Code of Prt IC Sales Adj/Upd  PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP04
     C                     END                             FI
      * Print Detail line. of Prt IC Sales Adj/Upd  PF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * ** Calculation instructions documentation
     C                     EXSR UASUBR                     ** Calculation
      * CUR = DB1 By name
     C                     Z-ADDF4AWDT    $CAWDT           Invoice Date
     C                     Z-ADDF4GNDT    $CGNDT           Actual Shipped
     C                     Z-ADDF4AIC3    $CAIC3           Company Number
     C                     Z-ADDF4BKC7    $CBKC7           Ship To Custome
     C                     Z-ADDF4C4NB    $CC4NB           Order Number
     C                     Z-ADDF4RMNB    $CRMNB           Load ID
     C                     MOVELF4BOCD    $CBOCD           Type Code
     C                     Z-ADDF4S5NB    $CS5NB           Shipped Item Co
     C                     Z-ADDF4USVA    $CUSVA           FOB Gross Amoun
     C                     Z-ADDF4BYWG    $CBYWG           Weight Billed
     C                     Z-ADDF4CONB    $CCONB           Invoice Number
     C                     Z-ADDF4UNVA    $CUNVA           Ledgrd Trd Fund
     C                     MOVELF4BRTX    $CBRTX           Ship To Name
      * RTV Item desc/GL Sub   RT - Company Item  * 
     C                     EXSR SDRVGN
     C                     MOVEL'ISA'     YL0002           Accrual Code
      * RTV Accrual Info-All   RT - Accrual Program  * 
     C                     EXSR SERVGN
     C                     MOVEL*BLANK    YL0028           Retro Comm Calc
     C                     Z-ADD*ZERO     $CGPPR           Transfer Price
     C                     Z-ADD*ZERO     WUATWG           Weight Shipped
     C                     Z-ADD*ZERO     WUX8VA           FOB Gross Amoun
      * Clc Transfer Price    XF - Sales History  * 
     C                     CALL 'PNKOXFR'              90  Clc Transfer Pr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $CS5NB    WQ0001  70       Shipped Item Co
     C                     PARM P1GNDT    WQ0002  70       Actual Shipped
     C                     PARM F4AIC3    WQ0003  30       Company Number
     C           WUATWG    PARM WUATWG    WQ0004 112       Weight Billed
     C           WUX8VA    PARM WUX8VA    WQ0005 112       FOB Gross Amoun
     C                     PARM F4R8NB    WQ0006  30       Shipping Compan
     C                     PARM P2L9DT    WQ0007  70       Date From
     C                     PARM P1GNDT    WQ0008  70       Date To
     C                     PARM $CBKC7    WQ0009  70       Ship To Custome
     C                     PARM 'G'       WQ0010  1        Inter Company G
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADDWUATWG    $CATWG           Weight Shipped
      * ** Put calc'd fob gross into 3rd party fob gross
     C                     Z-ADDWUX8VA    $CL5VL           FOB Gross Amoun
      * Calculate CUR.Transfer Price USR (3rd party net per lb)
      * CASE: CUR.Weight Shipped Total is Greater than zero
     C           $CATWG    IFGT *ZERO                      *IF
     C           $CL5VL    DIV  $CATWG    $CGPPR    H      Transfer Price
     C                     END                             *FI
      * Calculate invoice net per lb
      * CASE: CUR.Weight Billed is Greater than zero
     C           $CBYWG    IFGT *ZERO                      *IF
     C           $CUSVA    DIV  $CBYWG    $CLOVA    H      Price Adjustmen
     C                     END                             *FI
      * E1449 No 3rd Party Sales for Item.
      * OVERRIDE: Transfer Price = Invoice Price, if 3rd Party Sales = Ze
      * CASE: CUR.Weight Shipped Total is Equal to zero
     C           $CATWG    IFEQ *ZERO                      *IF
     C                     Z-ADD$CLOVA    $CGPPR           Transfer Price
     C                     MOVEL*BLANK    $CHETX           Explaination Te
     C                     MOVEL@CN,001   $CHETX           Explaination Te
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $CHETX           Explaination Te
     C                     END                             *FI
      * E1449 ------------------------------------------------------
     C           $CLOVA    SUB  $CGPPR    $CEKPR           Price 1 USR
     C           $CBYWG    MULT $CEKPR    $CP1NY    H      Sales Adjustmen
      * ** Calculate FOB Gross "After"
     C           $CUSVA    SUB  $CP1NY    $CL2VL           FOB Gross Amoun
      * ***** UPDATE Sales History, Shipping Dtl Accrual, History Dtl Acc
      * ** UPDATE Ledgrd TF Accrual before,after & FOB Gross Amount
      * CASE: LCL.Ledger Accrual (Y/N) is yes
     C           YL0016    IFEQ 'Y'                        *IF
      * ** Ledgered Accrual - Before and After
     C           $CUNVA    ADD  $CP1NY    $CL6VL           Ledgrd Accrl Am
      * CHG FOB & Trade fund  CH - Sales History  * 
     C                     EXSR SFCHRC
     C                     END                             *FI
      * ** CREATE Shipping Dtl Acrual
      * CASE: DB1.Weight Billed is Not equal zero
     C           F4BYWG    IFNE *ZERO                      *IF
      * Rtv LAST SEQ F/ORDER  RT - Shipping Dtl Accrual  * 
     C                     EXSR SGRVGN
      * calc sequence number
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,002                    *IF
     C                     Z-ADD1         YL0029           Sequence Number
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         YL0029           Sequence Number
     C                     END                             *FI
     C                     DIV  100       YL0018           Accrual Rate
      * Val G/L Act Cde 2 HPE XF - STR Hog Prcr & Eval Sys  * G/L Code Dr
     C                     CALL 'PKVBXFR'              90  Val G/L Act Cde
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $CAIC3    WQ0011  30       Company Number
     C                     PARM YL0012    WQ0012  8        G/L Account Cod
     C           YL0030    PARM *BLANK    WQ0013 25        G/L Code Desc U
     C           YL0031    PARM *BLANK    WQ0014  8        G/L Account Id
     C                     PARM *BLANK    WQ0015  3        G/L Account Typ
     C                     PARM *BLANK    WQ0016  3        G/L Account Typ
     C           YL0032    PARM *BLANK    WQ0017  1        Record Found US
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKVBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Val G/L Act Cde 2 HPE XF - STR Hog Prcr & Eval Sys  * G/L Code Cr
     C                     CALL 'PKVBXFR'              90  Val G/L Act Cde
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $CAIC3    WQ0018  30       Company Number
     C                     PARM YL0013    WQ0019  8        G/L Account Cod
     C           YL0030    PARM *BLANK    WQ0020 25        G/L Code Desc U
     C           YL0033    PARM *BLANK    WQ0021  8        G/L Account Id
     C                     PARM *BLANK    WQ0022  3        G/L Account Typ
     C                     PARM *BLANK    WQ0023  3        G/L Account Typ
     C           YL0032    PARM *BLANK    WQ0024  1        Record Found US
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKVBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADD*ZERO     YL0034           G/L Sub Ledger
      * G/L Sub Ledger DRV
      * A/R Customer
      * CASE: PAR.Sub Ledger Code is A/R Customer
     C           YL0009    IFEQ 'A'                        *IF
      * Rtv g/l Vendor        RT - Customer EXT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0035    WL0001           Ship To Custome
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0002    YL0034           Customer G/L Ve
     C                     END                             *FI
      * Ship To Customer
      * CASE: PAR.Sub Ledger Code is Ship To Customer
     C           YL0009    IFEQ 'S'                        *IF
      * Rtv g/l Vendor        RT - Customer EXT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$CBKC7    WL0001           Ship To Custome
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0002    YL0034           Customer G/L Ve
     C                     END                             *FI
      * Broker
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Sub Ledger Code is Broker
      *   |- c2    : PAR.Sub Ledger Code is Buyer Group
      *   '-
     C           YL0009    IFEQ 'B'                        *IF
     C           YL0009    OREQ 'G'                        *OR
      * Rtv Broker Info       RT - Broker  * 
     C                     EXSR SIRVGN
     C                     END                             *FI
      * CRT OM Ship Dtl Accrul CR - Shipping Dtl Accrual  * 
     C                     EXSR SJCRRC
     C                     END                             *FI
      * ** CREATE History Dtl Accrual
      * CASE: DB1.Weight Billed is Not equal zero
     C           F4BYWG    IFNE *ZERO                      *IF
      * CRT PD History Dtl Acc CO - History Dtl Accrual  * 
     C                     EXSR SKCRRC
     C                     END                             *FI
      * ** Accumulate total sales adjustment amount
     C                     ADD  $CP1NY    $DP3NY           Sales Adjustmen
      * ** Accumulate total "before" Ledgered TF Accrual amount
     C                     ADD  $CUNVA    $DL7VL           Ledgrd Accrl Am
      * ** Accumulate total "after" Ledgered Accrual amount
     C                     ADD  $CL6VL    $DL8VL           Ledgrd Accrl Am
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Actual Shipped Date to display format
      * Convert date
     C           1000000   ADD  $CGNDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCGNDT
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $CAIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$CAIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VCAIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VCAIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $CBKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$CBKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VCBKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VCBKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $CC4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$CC4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VCC4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VCC4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Shipped Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $CS5NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$CS5NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VCS5NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VCS5NB           CD7 Ext Numeric
     C                     END                             *FI
      * Print column headings if required
     C           W0ACDT    IFEQ 'Y'
     C                     WRITE$CCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ACDT
     C                     END                             FI
      * Print format
     C                     WRITE$CDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of Prt IC Sales Adj/Upd  PF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Type Code of Prt IC Sales Adj/Upd  PF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Actual Shipped Date of Prt IC Sales Adj/Upd  PF
     C           W0AP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Ship To Customer of Prt IC Sales Adj/Upd  PF
     C           W0AP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Invoice Number of Prt IC Sales Adj/Upd  PF
     C           W0AP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Shipped Item Code of Prt IC Sales Adj/Upd  PF
     C           W0AP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt IC Sales Adj/Upd  PF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD2         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD5         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
      * USER: Process top of page
     C                     MOVEL*BLANK    $BAPTX           Company Name
     C                     MOVEL'*All'    $BAPTX           Company Name
     C                     Z-ADDP1GNDT    $BMADT           To Date
      * Convert fields to external form
      * Convert To Date               USR to display format
      * Convert date
     C           1000000   ADD  $BMADT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBMADT
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSA01           Application Cod
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSA01           Application Cod
     C                     MOVEL'OMS'     WQSA01           Application Cod
      * Establish starting position
     C           KRSSA     SETLL@DNRESF                    *
     C           KRSSA     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
     C           KRSSA     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSB01           Application Cod
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSB01           Application Cod
      * Establish starting position
     C           KRSSB     SETLL@DNRESF                    *
     C           KRSSB     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSB     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Prior Sunday      RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFAIC3    WQSC01           Company Number
      * Define keylist
     C           KPSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           AFBCDT           Post to G/L Dat
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
      * Setup key
     C                     Z-ADD360       WQSC01           Company Number
     C                     Z-ADDP1GNDT    AFBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSC     SETLL@AFREPU                    *
     C           KRSSC     READE@AFREPU                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0018' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     P2L9DT           Date Sun USR
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Day of Week is Sunday
     C           AFA9ST    IFEQ '1'                        *IF
     C                     Z-ADDAFBCDT    P2L9DT           Date Sun USR
     C                     GOTO SCEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSC     READE@AFREPU                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Item desc/GL Sub   RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADD$CAIC3    BZAIC3           Company Number
     C                     Z-ADD$CS5NB    BZHGCD           Item Code
      * Establish starting position
     C           KRSSD     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0001           Description Lin
     C                     MOVEL*BLANK    $CSYCD           G/L Sub Code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBZAVNA    YL0001           Description Lin
     C                     MOVELBZSYCD    $CSYCD           G/L Sub Code
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Accrual Info-All   RT - Accrual Program  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           HLOJCD           Accrual Code
      * Setup key
     C                     MOVELYL0002    HLOJCD           Accrual Code
      * Establish starting position
     C           KRSSE     CHAIN@HLREK4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1514' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0003           Accrual Descrip
     C                     MOVEL*BLANK    YL0004           Automatic Accru
     C                     MOVEL*BLANK    YL0005           Print On Invoic
     C                     MOVEL*BLANK    YL0006           Rate Usage
     C                     MOVEL*BLANK    YL0007           Add-on/Allowanc
     C                     MOVEL*BLANK    YL0008           Accrual Type
     C                     MOVEL*BLANK    YL0009           Sub Ledger Code
     C                     MOVEL*BLANK    YL0010           Reverse Accrual
     C                     MOVEL*BLANK    YL0011           U/M - Primary D
     C                     MOVEL*BLANK    YL0012           G/L Code Dr
     C                     MOVEL*BLANK    YL0013           G/L Code Cr
     C                     MOVEL*BLANK    YL0014           G/L Sub Account
     C                     MOVEL*BLANK    YL0015           Sales History E
     C                     MOVEL*BLANK    YL0016           Post to G/L (Y/
     C                     MOVEL*BLANK    YL0017           All Products (Y
     C                     Z-ADD*ZERO     YL0018           Accrual Rate
     C                     MOVEL*BLANK    YL0019           Accrual Rate Ty
     C                     MOVEL*BLANK    YL0020           Accrual Detail
     C                     MOVEL*BLANK    YL0021           Standard Schedu
     C                     MOVEL*BLANK    YL0022           Affect Sales Re
     C                     MOVEL*BLANK    YL0023           Affect Invoice
     C                     MOVEL*BLANK    YL0024           Invoice Print T
     C                     Z-ADD*ZERO     YL0025           Max Accrual Amo
     C                     MOVEL*BLANK    YL0026           Max Accrual Amo
     C                     MOVEL*BLANK    YL0027           Record Status
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELHLLENA    YL0003           Accrual Descrip
     C                     MOVELHLTOST    YL0004           Automatic Accru
     C                     MOVELHLTQST    YL0005           Print On Invoic
     C                     MOVELHLTRST    YL0006           Rate Usage
     C                     MOVELHLTSST    YL0007           Add-on/Allowanc
     C                     MOVELHLOKCD    YL0008           Accrual Type
     C                     MOVELHLTYST    YL0009           Sub Ledger Code
     C                     MOVELHLOQCD    YL0010           Reverse Accrual
     C                     MOVELHLHHCD    YL0011           U/M - Primary D
     C                     MOVELHLI2TX    YL0012           G/L Code Dr
     C                     MOVELHLJFTX    YL0013           G/L Code Cr
     C                     MOVELHLI3TX    YL0014           G/L Sub Account
     C                     MOVELHLJGTX    YL0015           Sales History E
     C                     MOVELHLLEDG    YL0016           Post to G/L (Y/
     C                     MOVELHLTTST    YL0017           All Products (Y
     C                     Z-ADDHLBKPR    YL0018           Accrual Rate
     C                     MOVELHLSHSX    YL0019           Accrual Rate Ty
     C                     MOVELHLQFSX    YL0020           Accrual Detail
     C                     MOVELHLFDTX    YL0021           Standard Schedu
     C                     MOVELHLFETX    YL0022           Affect Sales Re
     C                     MOVELHLFFTX    YL0023           Affect Invoice
     C                     MOVELHLFGTX    YL0024           Invoice Print T
     C                     Z-ADDHLHQVL    YL0025           Max Accrual Amo
     C                     MOVELHLFHTX    YL0026           Max Accrual Amo
     C                     MOVELHLVSST    YL0027           Record Status
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCHRC    BEGSR
      *================================================================
      * CHG FOB & Trade fund  CH - Sales History  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001 20        A/R City
     C                     MOVEL*BLANK    WN0002  2        A/R State
     C                     MOVEL*BLANK    WN0003  6        A/R County Code
     C                     MOVEL*BLANK    WN0004 11        A/R Zip/Postal
     C                     MOVEL*BLANK    WN0005 25        Alpha Search
     C                     MOVEL*BLANK    WN0006  6        Country Code
     C                     MOVEL*BLANK    WN0007  2        Type Code
     C                     Z-ADD*ZERO     WN0008  70       Parent Customer
     C                     Z-ADD*ZERO     WN0009  70       A/R Customer Nu
     C                     MOVEL*BLANK    WN0010 30        A/R Customer Na
     C                     Z-ADD*ZERO     WN0011  70       Ship To Custome
     C                     MOVEL*BLANK    WN0012 30        Ship To Name
     C                     MOVEL*BLANK    WN0013 20        Ship To City
     C                     MOVEL*BLANK    WN0014  2        Ship To State C
     C                     MOVEL*BLANK    WN0015 11        Ship To Zip/Pos
     C                     MOVEL*BLANK    WN0016 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0017  70       Order Date
     C                     Z-ADD*ZERO     WN0018  70       Cancel Date
     C                     MOVEL*BLANK    WN0019  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0020  3        Original Salesp
     C                     MOVEL*BLANK    WN0021  2        Manager Level C
     C                     MOVEL*BLANK    WN0022  3        VP Level Code
     C                     MOVEL*BLANK    WN0023  2        Terms Code
     C                     Z-ADD*ZERO     WN0024  52       Absorbed Freigh
     C                     MOVEL*BLANK    WN0025  3        Carrier Code
     C                     MOVEL*BLANK    WN0026  3        Order Header Re
     C                     MOVEL*BLANK    WN0027  2        Order Type - Sa
     C                     MOVEL*BLANK    WN0028  2        Shipping Method
     C                     MOVEL*BLANK    WN0029  1        Export Status
     C                     Z-ADD*ZERO     WN0030  70       Attach to Invoi
     C                     Z-ADD*ZERO     WN0031  70       Attach to Order
     C                     Z-ADD*ZERO     WN0032  70       Resell Referenc
     C                     Z-ADD*ZERO     WN0033  70       Original Item
     C                     MOVEL*BLANK    WN0034  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0035 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0036 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0037 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0038 112       Weight Schedule
     C                     MOVEL*BLANK    WN0039  2        U/M - Ordered
     C                     Z-ADD*ZERO     WN0040 114       Unit Price
     C                     Z-ADD*ZERO     WN0041 114       Unit Price Orde
     C                     MOVEL*BLANK    WN0042  2        U/M - Base Pric
     C                     Z-ADD*ZERO     WN0043  70       Requested Ship
     C                     Z-ADD*ZERO     WN0044  70       Invoice Date
     C                     Z-ADD*ZERO     WN0045  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0046 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0047 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0048 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0049 112       Extended Amount
     C                     MOVEL*BLANK    WN0050  1        Affect Inventor
     C                     MOVEL*BLANK    WN0051  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0052  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0053  70       Contract Number
     C                     MOVEL*BLANK    WN0054  6        Export Country
     C                     Z-ADD*ZERO     WN0055  70       LD Arrival Date
     C                     Z-ADD*ZERO     WN0056  40       Accounting Year
     C                     Z-ADD*ZERO     WN0057  20       Accounting Peri
     C                     Z-ADD*ZERO     WN0058  30       OM Week
     C                     Z-ADD*ZERO     WN0059 112       Quantity Billed
     C                     Z-ADD*ZERO     WN0060 112       Weight Billed
     C                     Z-ADD*ZERO     WN0061  70       Shipped Item Co
     C                     Z-ADD*ZERO     WN0062 112       Billing Detail
     C                     Z-ADD*ZERO     WN0063 112       Billing Detail
     C                     Z-ADD*ZERO     WN0064 112       Standard Overag
     C                     Z-ADD*ZERO     WN0065 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0066  80       G/L Document Nu
     C                     MOVEL*BLANK    WN0067  1        G/L Update Stat
     C                     Z-ADD*ZERO     WN0068  30       Shipping Compan
     C                     MOVEL*BLANK    WN0069  3        Order Detail Re
     C                     Z-ADD*ZERO     WN0070 114       Price Overage O
     C                     MOVEL*BLANK    WN0071  3        Date Method Cod
     C                     MOVEL*BLANK    WN0072  3        Price Method Co
     C                     Z-ADD*ZERO     WN0073  70       Market Pricing
     C                     MOVEL*BLANK    WN0074  3        Commodity Marke
     C                     MOVEL*BLANK    WN0075  2        Quality Level
     C                     MOVEL*BLANK    WN0076  2        Item Level
     C                     Z-ADD*ZERO     WN0077  30       Item Structure
     C                     Z-ADD*ZERO     WN0078  30       Item Structure
     C                     Z-ADD*ZERO     WN0079  30       Item Structure
     C                     Z-ADD*ZERO     WN0080 112       Rated Freight
     C                     Z-ADD*ZERO     WN0081  70       Invoice Number
     C                     MOVEL*BLANK    WN0082  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0083  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0084  70       Load ID
     C                     Z-ADD*ZERO     WN0085  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0086  3        Packaging Code
     C                     MOVEL*BLANK    WN0087  3        Item Market Cod
     C                     Z-ADD*ZERO     WN0088  20       Agrimetrics gro
     C                     Z-ADD*ZERO     WN0089  10       Agrimetrics pac
     C                     Z-ADD*ZERO     WN0090  20       Agrimetrics gra
     C                     MOVEL*BLANK    WN0091 30        Order Desc. Lin
     C                     Z-ADD*ZERO     WN0092 112       Actual Freight
     C                     MOVEL*BLANK    WN0093  3        Item Type Code
     C                     Z-ADD*ZERO     WN0094  30       PM R/M Type Cod
     C                     Z-ADD*ZERO     WN0095  50       PM Line Number
     C                     MOVEL*BLANK    WN0096  3        SH Unused (was
     C                     Z-ADD*ZERO     WN0097  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0098  1        Modified Flag
     C                     Z-ADD*ZERO     WN0099 112       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0100 112       Commission Amou
     C                     Z-ADD*ZERO     WN0101 112       Financials Amou
     C                     Z-ADD*ZERO     WN0102 112       Financials Amou
     C                     MOVEL*BLANK    WN0103  1        Group for Packa
     C                     MOVEL*BLANK    WN0104  2        Base/Conv/Loss
     C                     MOVEL*BLANK    WN0105  1        Variety/Rendere
     C                     MOVEL*BLANK    WN0106  3        Customer Group
     C                     MOVEL*BLANK    WN0107  3        Customer Group
     C                     Z-ADD*ZERO     WN0108  70       Order Group Cod
     C                     MOVEL*BLANK    WN0109  4        Shipping Zone C
     C                     MOVEL*BLANK    WN0110  1        Process Sts for
     C                     Z-ADD*ZERO     WN0111 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0112 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0113  30       Req Shipping Te
     C                     Z-ADD*ZERO     WN0114  30       Actual Shipping
     C                     MOVEL*BLANK    WN0115  1        Age Code
     C                     Z-ADD*ZERO     WN0116  70       Req Delivery Da
     C                     Z-ADD*ZERO     WN0117  60       Req Delivery Ti
     C                     Z-ADD*ZERO     WN0118  70       MPC Number
     C                     MOVEL*BLANK    WN0119  3        Shipping Line
     C                     MOVEL*BLANK    WN0120 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0121 25        Port City
     C                     MOVEL*BLANK    WN0122 30        Vessel Name
     C                     MOVEL*BLANK    WN0123 12        Booking Number
     C                     Z-ADD*ZERO     WN0124 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0125  70       Claim Number
     C                     Z-ADD*ZERO     WN0126  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0127  1        Palletize
     C                     Z-ADD*ZERO     WN0128 114       Commodity Marke
     C                     Z-ADD*ZERO     WN0129 114       Market Value
     C                     Z-ADD*ZERO     WN0130 114       Default Cmdty M
     C                     Z-ADD*ZERO     WN0131 114       Raw Material Co
     C                     MOVEL*BLANK    WN0132  1        Sales Expense P
     C                     Z-ADD*ZERO     WN0133 112       Sales Expense T
     C                     MOVEL*BLANK    WN0134  1        Data Mart Proce
     C                     MOVEL*BLANK    WN0135  1        LH Load Type
     C                     MOVEL*BLANK    WN0136  2        Order TF Exempt
     C                     Z-ADD*ZERO     WN0137  70       LD Sail Date
     C                     Z-ADD*ZERO     WN0138 114       NonLedgrd TrdFn
     C                     Z-ADD*ZERO     WN0139 112       HST Item Target
     C                     MOVEL*BLANK    WN0140  1        EDI Status 1
     C                     MOVEL*BLANK    WN0141  1        EDI Status 2
     C                     MOVEL*BLANK    WN0142  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0143  60       Job Time
     C                     MOVEL*BLANK    WN0144 10        User Id
     C                     MOVEL*BLANK    WN0145 10        Job Name
     C                     Z-ADD*ZERO     WN0146  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @FHSTD2
     C                     Z-ADD$CAIC3    WAAIC3           Company Number
     C                     Z-ADD$CC4NB    WAC4NB           Order Number
     C                     Z-ADDF4DPNB    WADPNB           Order Sequence
     C                     Z-ADDF4UENB    WAUENB           Order Secondary
      *
     C           KLCHSF    KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
     C                     KFLD           WADPNB           Order Sequence
     C                     KFLD           WAUENB           Order Secondary
     C           KLCHSF    CHAIN@FHSTD2              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMHSTPL0'MDACP
     C                     MOVEL'@FHSTD2' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMHS1    YARDCS
      * USER: Processing after Data read
     C                     MOVEL'N'       WAISSX           Data Mart Proce
     C                     MOVEL'N'       WAGASX           Process Sts for
      * Move non-key fields to @FHSTD2
     C                     Z-ADD$CL2VL    WAUSVA           FOB Gross Amoun
     C                     Z-ADD$CL6VL    WAUNVA           Ledgrd Trd Fund
      *
      * Set PGM.*Record Data Changed flag
     C           QOMHS1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@FHSTD2                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMHSTPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv LAST SEQ F/ORDER  RT - Shipping Dtl Accrual  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN HRAIC3    WQSG01           Company Number
     C           *LIKE     DEFN HRC4NB    WQSG02           Order Number
      * Define keylist
     C           KPSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Order Number
     C                     KFLD           HRDPNB           Order Sequence
     C                     KFLD           HRUENB           Order Secondary
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Order Number
      * Setup key
     C                     Z-ADD$CAIC3    WQSG01           Company Number
     C                     Z-ADD$CC4NB    WQSG02           Order Number
     C                     Z-ADDF4DPNB    HRDPNB           Order Sequence
     C                     Z-ADDF4UENB    HRUENB           Order Secondary
      * Establish starting position
     C           KPSSG     SETLL@HRCPLM                    *
     C           KRSSG     READE@HRCPLM                  90*
      * Data record not found
     C   90                MOVEL'USR1526' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDHRDXNB    YL0029           Sequence Number
     C           KRSSG     READE@HRCPLM                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv g/l Vendor        RT - Customer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           NEBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0001    NEBKC7           Ship To Custome
      * Establish starting position
     C           KRSSH     CHAIN@NEREAT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2880' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0002           Customer G/L Ve
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDNEAAC8    WL0002           Customer G/L Ve
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Broker Info       RT - Broker  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           C5HHAA           Broker Code
      * Setup key
     C                     MOVELYL0036    C5HHAA           Broker Code
      * Establish starting position
     C           KRSSI     CHAIN@C5RESJ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3288' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0037           Broker Name
     C                     MOVEL*BLANK    YL0038           Broker Address
     C                     MOVEL*BLANK    YL0039           Broker Address
     C                     MOVEL*BLANK    YL0040           Broker City
     C                     MOVEL*BLANK    YL0041           Broker State
     C                     MOVEL*BLANK    YL0042           Broker Zip
     C                     MOVEL*BLANK    YL0043           Broker Office M
     C                     MOVEL*BLANK    YL0044           Broker Telephon
     C                     MOVEL*BLANK    YL0045           Broker Fax Numb
     C                     MOVEL*BLANK    YL0046           Broker Email Ad
     C                     Z-ADD*ZERO     YL0034           Broker G/L Vend
     C                     MOVEL*BLANK    YL0047           Salesperson Cod
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELC5C4T1    YL0037           Broker Name
     C                     MOVELC5QMNA    YL0038           Broker Address
     C                     MOVELC5QNNA    YL0039           Broker Address
     C                     MOVELC5QONA    YL0040           Broker City
     C                     MOVELC5QPNA    YL0041           Broker State
     C                     MOVELC5C5T1    YL0042           Broker Zip
     C                     MOVELC5C6T1    YL0043           Broker Office M
     C                     MOVELC5C7T1    YL0044           Broker Telephon
     C                     MOVELC5C8T1    YL0045           Broker Fax Numb
     C                     MOVELC5C9T1    YL0046           Broker Email Ad
     C                     Z-ADDC5DAT1    YL0034           Broker G/L Vend
     C                     MOVELC5BCCD    YL0047           Salesperson Cod
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCRRC    BEGSR
      *================================================================
      * CRT OM Ship Dtl Accrul CR - Shipping Dtl Accrual  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @HRCPLL
     C                     Z-ADD$CAIC3    WBAIC3           Company Number
     C                     Z-ADD$CC4NB    WBC4NB           Order Number
     C                     Z-ADDF4DPNB    WBDPNB           Order Sequence
     C                     Z-ADDF4UENB    WBUENB           Order Secondary
     C                     Z-ADDYL0029    WBDXNB           Sequence Number
     C                     Z-ADDYL0018    WBBKPR           Accrual Rate
     C                     Z-ADD*ZERO     WBC5PC           Accrual Percent
     C                     Z-ADD$CP1NY    WBAYVA           Extended Amount
     C                     Z-ADD$CP1NY    WBEDVL           Item Accrual Am
     C                     Z-ADD$CS5NB    WBHGCD           Item Code
     C                     Z-ADD$CBKC7    WBBKC7           Ship To Custome
     C                     Z-ADDF4ANC7    WBDUC7           A/R Customer
     C                     MOVELYL0036    WBHHAA           Broker Code
     C                     Z-ADDF4GNDT    WBPODT           SDA Actual Ship
     C                     Z-ADD$CBYWG    WBBYWG           Weight Billed
     C                     MOVELYL0048    WBBVST           Use G/L Code Dr
     C                     MOVELYL0028    WBP7SX           Retro Comm Calc
     C                     MOVELYL0008    WBOKCD           Accrual Type
     C                     MOVELYL0022    WBP8SX           SDA Affect Sale
     C                     MOVELYL0023    WBP9SX           SDA Affect Invo
     C                     MOVELYL0005    WBQASX           SDA Print on In
     C                     MOVELYL0024    WBQBSX           SDA Invoice Pri
     C                     Z-ADD*ZERO     WBPPDT           SDA Ord Dtl Acr
     C                     Z-ADD*ZERO     WBPQDT           SDA Atch to Ord
     C                     Z-ADD*ZERO     WBEEVL           SDA Unused Amt
     C                     Z-ADD*ZERO     WBEFVL           SDA Unused Amt
     C                     MOVELYL0016    WBFITX           SDA Post to G/L
     C                     MOVELYL0019    WBFJTX           SDA Accrual Rat
     C                     Z-ADDF4AWDT    WBQ8DT           SDA Invoice Dat
     C                     MOVELYL0009    WBFKTX           SDA Sub Ledger
     C                     Z-ADDYL0034    WBH0NY           SDA G/L Sub Led
     C                     MOVELYL0012    WBKQT1           SDA G/L Code Dr
     C                     MOVELYL0013    WBKTT1           SDA G/L Code Cr
     C                     MOVELYL0031    WBHIAA           SDA JDE Account
     C                     MOVELYL0033    WBHLAA           SDA JDE Account
     C                     MOVELYL0002    WBOJCD           Accrual Code
     C                     MOVELYL0015    WBAVNB           SH Expense Buck
     C                     MOVELYL0049    WBDSCD           G/L Sub Account
     C                     MOVEL*BLANK    WBUVST           EDI Status 1
     C                     MOVEL*BLANK    WBUWST           EDI Status 2
     C                     MOVEL*BLANK    WBUXST           EDI Status 3
     C                     Z-ADD##JTM     WBAATM           Job Time
     C                     MOVEL##USR     WBAYNA           User Id
     C                     MOVEL##JOB     WBA0NA           Job Name
     C                     Z-ADD##JDT     WBAXDT           Job Date
      *
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WBAATM           Job Time
     C                     MOVEL##USR     WBAYNA           User Id
     C                     MOVEL##JOB     WBA0NA           Job Name
     C                     Z-ADD##JDT     WBAXDT           Job Date
     C           KLCRSJ    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
     C                     KFLD           WBDPNB           Order Sequence
     C                     KFLD           WBUENB           Order Secondary
     C                     KFLD           WBDXNB           Sequence Number
      * Check for duplicate primary key
     C           KLCRSJ    SETLL@HRCPLL                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1527' W0RTN   7
      * Send message 'Shipping Dtl Accrual   EX'
     C                     MOVEL'USR1527' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C                     WRITE@HRCPLL                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCRRC    BEGSR
      *================================================================
      * CRT PD History Dtl Acc CO - History Dtl Accrual  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @ICCPSZ
     C                     Z-ADD$CAIC3    ICAIC3           Company Number
     C                     Z-ADD$CC4NB    ICC4NB           Order Number
     C                     Z-ADDF4DPNB    ICDPNB           Order Sequence
     C                     Z-ADDF4UENB    ICUENB           Order Secondary
     C                     Z-ADDYL0029    ICDXNB           Sequence Number
     C                     Z-ADDYL0018    ICBKPR           Accrual Rate
     C                     Z-ADD$CP1NY    ICAYVA           Extended Amount
     C                     Z-ADD$CP1NY    ICEDVL           Item Accrual Am
     C                     Z-ADD$CS5NB    ICHGCD           Item Code
     C                     Z-ADD$CBKC7    ICBKC7           Ship To Custome
     C                     Z-ADDF4GNDT    ICPTDT           HDA Actual Ship
     C                     Z-ADD$CBYWG    ICBYWG           Weight Billed
     C                     MOVELYL0048    ICBVST           Use G/L Code Dr
     C                     MOVELYL0028    ICP7SX           Retro Comm Calc
     C                     MOVELYL0008    ICOKCD           Accrual Type
     C                     MOVELYL0022    ICQQSX           HDA Affect Sale
     C                     MOVELYL0023    ICQRSX           HDA Affect Invo
     C                     MOVELYL0005    ICFLTX           HDA Print on In
     C                     MOVELYL0024    ICQSSX           HDA Invoice Pri
     C                     Z-ADDP1GNDT    ICPRDT           HDA SA Week End
     C                     Z-ADD*ZERO     ICPSDT           HDA Atch to Ord
     C                     Z-ADD*ZERO     ICEGVL           HDA Unused Amt
     C                     Z-ADD*ZERO     ICEHVL           HDA Unused Amt
     C                     MOVELYL0015    ICAVNB           SH Expense Buck
     C                     MOVELYL0049    ICDSCD           G/L Sub Account
     C                     MOVELYL0016    ICFMTX           HDA Post to G/L
     C                     MOVELYL0019    ICFNTX           HDA Accrual Rat
     C                     Z-ADDF4AWDT    ICQ9DT           HDA Invoice Dat
     C                     MOVELYL0009    ICFOTX           HDA Sub Ledger
     C                     Z-ADDYL0034    ICH1NY           HDA G/L Sub Led
     C                     MOVELYL0012    ICKRT1           HDA G/L Code Dr
     C                     MOVELYL0013    ICKST1           HDA G/L Code Cr
     C                     MOVELYL0031    ICHJAA           HDA JDE Account
     C                     MOVELYL0033    ICHKAA           HDA JDE Account
     C                     MOVELYL0036    ICHHAA           Broker Code
     C                     MOVELYL0002    ICOJCD           Accrual Code
     C                     Z-ADD##JTM     ICAATM           Job Time
     C                     MOVEL##USR     ICAYNA           User Id
     C                     MOVEL##JOB     ICA0NA           Job Name
     C                     Z-ADD##JDT     ICAXDT           Job Date
      *
     C           KLCRSK    KLIST
     C                     KFLD           ICAIC3           Company Number
     C                     KFLD           ICC4NB           Order Number
     C                     KFLD           ICDPNB           Order Sequence
     C                     KFLD           ICUENB           Order Secondary
     C                     KFLD           ICDXNB           Sequence Number
      * Check for duplicate primary key
     C           KLCRSK    SETLL@ICCPSZ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1656' W0RTN   7
      * Send message 'History Dtl Accrual    EX'
     C                     MOVEL'USR1656' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C                     WRITE@ICCPSZ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * 08/09/2007 Todd Johnson
      * Based on EIS Specifications - FDD Accruals
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDICAIC3    WL0003           Company Number
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    YN0001    P      Plant Company S
     C                     MOVELWL0005    YL0050    P      Company Organiz
      * CASE: LCL.Company Organization is Daily's
     C           YL0050    IFEQ 'D'                        *IF
      * If Accrual Type is TF
      * CASE: DB1.Accrual Type is Trade Fund/Marketing
     C           ICOKCD    IFEQ 'TF'                       *IF
      * Rtv Descriptions      RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDICAIC3    WL0006           Company Number
     C                     Z-ADDICHGCD    WL0007           Item Code
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0008    YL0051    P      Description Lin
     C                     MOVELWL0009    YN0002    P      Description Lin
     C                     MOVELWL0010    YN0003    P      U/M - Primary
     C                     MOVELWL0011    YN0004    P      U/M - Second
     C                     MOVELWL0012    YN0005    P      U/M - Third
      * RTV All Header Fields  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDICAIC3    WL0013           Company Number
     C                     Z-ADDICC4NB    WL0014           Order Number
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0015    YN0006    P      Order Type - Sa
     C                     Z-ADDWL0016    YN0007           A/R Customer Nu
     C                     Z-ADDWL0017    YN0008           Ship To Custome
     C                     MOVELWL0018    YN0009    P      Ship To Name
     C                     MOVELWL0019    YN0010    P      Ship To Address
     C                     MOVELWL0020    YN0011    P      Ship To Address
     C                     MOVELWL0021    YN0012    P      Ship To Address
     C                     MOVELWL0022    YN0013    P      Ship To City
     C                     MOVELWL0023    YN0014    P      Ship To State C
     C                     MOVELWL0024    YN0015    P      Ship To Zip/Pos
     C                     Z-ADDWL0025    YN0016           Bill to Custome
     C                     MOVELWL0026    YN0017    P      Bill to Name
     C                     MOVELWL0027    YN0018    P      Bill to Address
     C                     MOVELWL0028    YN0019    P      Bill to Address
     C                     MOVELWL0029    YN0020    P      Bill to Address
     C                     MOVELWL0030    YN0021    P      Bill to City
     C                     MOVELWL0031    YN0022    P      Bill to State C
     C                     MOVELWL0032    YN0023    P      Bill to Zip/Pos
     C                     MOVELWL0033    YN0024    P      Customer Purcha
     C                     Z-ADDWL0034    YN0025           Order Date
     C                     Z-ADDWL0035    YN0026           Requested Ship
     C                     Z-ADDWL0036    YN0027           Actual Shipped
     C                     Z-ADDWL0037    YN0028           Cancel Date
     C                     MOVELWL0038    YN0029    P      Terms Code
     C                     MOVELWL0039    YN0030    P      Special Instruc
     C                     MOVELWL0040    YN0031    P      Special Instruc
     C                     MOVELWL0041    YN0032    P      Carrier Code
     C                     MOVELWL0042    YN0033    P      Comment Print A
     C                     MOVELWL0043    YN0034    P      Comment Print I
     C                     MOVELWL0044    YN0035    P      Comment Print P
     C                     MOVELWL0045    YN0036    P      Comment Print S
     C                     MOVELWL0046    YN0037    P      Reason Code
     C                     MOVELWL0047    YN0038    P      Order in Use
     C                     MOVELWL0048    YN0039    P      Header Status
     C                     MOVELWL0049    YN0040    P      Header Status L
     C                     MOVELWL0050    YN0041    P      Order Type Prin
     C                     Z-ADDWL0051    YN0042           Scheduled Ship
     C                     MOVELWL0052    YN0043    P      User Original E
     C                     Z-ADDWL0053    YN0044           Date of Origina
     C                     Z-ADDWL0054    YN0045           Order Value Tot
     C                     Z-ADDWL0055    YN0046           Order Weight To
     C                     MOVELWL0056    YN0047    P      Credit Hold
     C                     MOVELWL0057    YN0048    P      Production Hold
     C                     MOVELWL0058    YN0049    P      New Customer Ho
     C                     Z-ADDWL0059    YN0050           Requested Deliv
     C                     Z-ADDWL0060    YN0051           Requested Deliv
     C                     MOVELWL0061    YN0052    P      Accounts Receiv
     C                     MOVELWL0062    YN0053    P      Accounts Receiv
     C                     Z-ADDWL0063    YN0054           Load ID
     C                     Z-ADDWL0064    YN0055           Absorbed Freigh
     C                     Z-ADDWL0065    YN0056           Rated Freight
     C                     MOVELWL0066    YN0057    P      LTL Flag
     C                     MOVELWL0067    YN0058    P      Price Audit
     C                     MOVELWL0068    YN0059    P      Price Status
     C                     MOVELWL0069    YN0060    P      Shipping Method
     C                     MOVELWL0070    YN0061    P      Export Status
     C                     MOVELWL0071    YN0062    P      Palletize
     C                     MOVELWL0072    YN0063    P      Shrink Wrap
     C                     MOVELWL0073    YN0064    P      Slip Sheet
     C                     MOVELWL0074    YN0065    P      Age Code
     C                     Z-ADDWL0075    YN0066           Reefer Temperat
     C                     MOVELWL0076    YN0067    P      Load Type
     C                     Z-ADDWL0077    YN0068           Attach to Invoi
     C                     MOVELWL0078    YN0069    P      Load Plan Order
     C                     MOVELWL0079    YN0070    P      Print Pick Slip
     C                     Z-ADDWL0080    YN0071           Resell Referenc
     C                     MOVELWL0081    YN0072    P      Special Comment
     C                     MOVELWL0082    YN0073    P      Special Comment
     C                     MOVELWL0083    YN0074    P      Affect Auto Acc
     C                     MOVELWL0084    YN0075    P      Sales Route Cod
     C                     MOVELWL0085    YN0076    P      Manager Level C
     C                     MOVELWL0086    YN0077    P      VP Level Code
     C                     Z-ADDWL0087    YN0078           Attach to Order
     C                     MOVELWL0088    YN0079    P      Reason for Pric
     C                     Z-ADDWL0089    YL0052           Invoice Number
     C                     MOVELWL0090    YN0080    P      Invoice Suffix
     C                     Z-ADDWL0091    YL0053           Invoice Date
     C                     MOVELWL0092    YN0081    P      Event Code
     C                     MOVELWL0093    YN0082    P      Trans Contol AS
     C                     MOVELWL0094    YN0083    P      Modified Flag
     C                     Z-ADDWL0095    YN0084           A/R order Value
     C                     MOVELWL0096    YN0085    P      Billing Activit
     C                     MOVELWL0097    YN0086    P      Block Order Fla
     C                     MOVELWL0098    YN0087    P      Order Certifica
     C                     MOVELWL0099    YN0088    P      EDI Status 1
     C                     MOVELWL0100    YN0089    P      EDI Status 2
     C                     MOVELWL0101    YN0090    P      EDI Status 3
      * Convert fields first
      * CASE: *OTHERWISE
      * Invoice date to YYYYMMDD
      * LCL.USR Internal D8# YYYYMMDD = LCL.Invoice Date
     C           YL0053    IFEQ *ZERO
     C                     Z-ADD*ZERO     YL0054
     C                     ELSE
     C           YL0053    ADD  19000000  YL0054           USR Internal D8
     C                     END
      * Sub Ledger to Char
     C                     Z-ADDICH1NY    YL0055           USR Work Field
     C                     MOVEL*BLANK    YL0056           Text USR 5
     C                     MOVELYL0055    YL0056           Text USR 5
      * Invoice Number to Char
     C                     Z-ADDYL0052    YL0057           USR number
     C                     MOVEL*BLANK    YL0058           Invoice Number
     C                     MOVELYL0057    YL0058           Invoice Number
      * EUP Crt ACCR TRANS RCD - Shipping Dtl Accrual  * 
     C                     CALL 'PMLQUPR'              90  EUP Crt ACCR TR
     C                     PARM ICBKPR    WQ0025  96       Accrual Rate
     C                     PARM ICAYVA    WQ0026 112       Extended Amount
     C                     PARM ICHGCD    WQ0027  70       Item Code
     C                     PARM ICBKC7    WQ0028  70       Ship To Custome
     C                     PARM ICBYWG    WQ0029 112       Weight Billed
     C                     PARM YL0051    WQ0030 30        Description Lin
     C                     PARM YL0054    WQ0031  80       USR Internal D8
     C                     PARM YL0056    WQ0032  5        Text USR 5
     C                     PARM YL0058    WQ0033  6        Invoice Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMLQUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           JYAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0003    JYAIC3           Company Number
      * Establish starting position
     C           KRSSL     CHAIN@JYRECE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2025' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0004           Plant Company S
     C                     MOVEL*BLANK    WL0005           Company Organiz
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELJYYISX    WL0004           Plant Company S
     C                     MOVELJYYJSX    WL0005           Company Organiz
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Descriptions      RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0006    BZAIC3           Company Number
     C                     Z-ADDWL0007    BZHGCD           Item Code
      * Establish starting position
     C           KRSSM     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBZAVNA    WL0008           Description Lin
     C                     MOVELBZAWNA    WL0009           Description Lin
     C                     MOVELBZADCD    WL0010           U/M - Primary
     C                     MOVELBZAECD    WL0011           U/M - Second
     C                     MOVELBZAFCD    WL0012           U/M - Third
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV All Header Fields  RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0013    BEAIC3           Company Number
     C                     Z-ADDWL0014    BEC4NB           Order Number
      * Establish starting position
     C           KRSSN     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBEJNCD    WL0015           Order Type - Sa
     C                     Z-ADDBEANC7    WL0016           A/R Customer Nu
     C                     Z-ADDBEBKC7    WL0017           Ship To Custome
     C                     MOVELBEBRTX    WL0018           Ship To Name
     C                     MOVELBEHMNA    WL0019           Ship To Address
     C                     MOVELBEHONA    WL0020           Ship To Address
     C                     MOVELBEHPNA    WL0021           Ship To Address
     C                     MOVELBEHNNA    WL0022           Ship To City
     C                     MOVELBEDBCD    WL0023           Ship To State C
     C                     MOVELBECKTX    WL0024           Ship To Zip/Pos
     C                     Z-ADDBEB0C7    WL0025           Bill to Custome
     C                     MOVELBEAETX    WL0026           Bill to Name
     C                     MOVELBEB1NA    WL0027           Bill to Address
     C                     MOVELBEB3NA    WL0028           Bill to Address
     C                     MOVELBEB4NA    WL0029           Bill to Address
     C                     MOVELBEB2NA    WL0030           Bill to City
     C                     MOVELBEBHCD    WL0031           Bill to State C
     C                     MOVELBEC8TX    WL0032           Bill to Zip/Pos
     C                     MOVELBEBCNA    WL0033           Customer Purcha
     C                     Z-ADDBEA0DT    WL0034           Order Date
     C                     Z-ADDBEA5DT    WL0035           Requested Ship
     C                     Z-ADDBEGNDT    WL0036           Actual Shipped
     C                     Z-ADDBEACDT    WL0037           Cancel Date
     C                     MOVELBEAQCD    WL0038           Terms Code
     C                     MOVELBEB6NA    WL0039           Special Instruc
     C                     MOVELBEBYNA    WL0040           Special Instruc
     C                     MOVELBEBZNA    WL0041           Carrier Code
     C                     MOVELBEGTST    WL0042           Comment Print A
     C                     MOVELBEGVST    WL0043           Comment Print I
     C                     MOVELBEGUST    WL0044           Comment Print P
     C                     MOVELBEQFST    WL0045           Comment Print S
     C                     MOVELBECQCD    WL0046           Reason Code
     C                     MOVELBEGJST    WL0047           Order in Use
     C                     MOVELBEGWST    WL0048           Header Status
     C                     MOVELBEGXST    WL0049           Header Status L
     C                     MOVELBEGYST    WL0050           Order Type Prin
     C                     Z-ADDBEAODT    WL0051           Scheduled Ship
     C                     MOVELBEAIVN    WL0052           User Original E
     C                     Z-ADDBECXDT    WL0053           Date of Origina
     C                     Z-ADDBEJZVA    WL0054           Order Value Tot
     C                     Z-ADDBEA1WG    WL0055           Order Weight To
     C                     MOVELBEXIST    WL0056           Credit Hold
     C                     MOVELBEXJST    WL0057           Production Hold
     C                     MOVELBEXKST    WL0058           New Customer Ho
     C                     Z-ADDBEEIDT    WL0059           Requested Deliv
     C                     Z-ADDBEAFTM    WL0060           Requested Deliv
     C                     MOVELBEE8CD    WL0061           Accounts Receiv
     C                     MOVELBEE9CD    WL0062           Accounts Receiv
     C                     Z-ADDBERMNB    WL0063           Load ID
     C                     Z-ADDBETBNB    WL0064           Absorbed Freigh
     C                     Z-ADDBER1NB    WL0065           Rated Freight
     C                     MOVELBEPJST    WL0066           LTL Flag
     C                     MOVELBEU0ST    WL0067           Price Audit
     C                     MOVELBEU1ST    WL0068           Price Status
     C                     MOVELBEQ2CD    WL0069           Shipping Method
     C                     MOVELBEU2ST    WL0070           Export Status
     C                     MOVELBEVEST    WL0071           Palletize
     C                     MOVELBEVFST    WL0072           Shrink Wrap
     C                     MOVELBEVGST    WL0073           Slip Sheet
     C                     MOVELBERPCD    WL0074           Age Code
     C                     Z-ADDBERNNB    WL0075           Reefer Temperat
     C                     MOVELBEVDST    WL0076           Load Type
     C                     Z-ADDBEATIN    WL0077           Attach to Invoi
     C                     MOVELBEU4ST    WL0078           Load Plan Order
     C                     MOVELBEU5ST    WL0079           Print Pick Slip
     C                     Z-ADDBERSRN    WL0080           Resell Referenc
     C                     MOVELBEMHNA    WL0081           Special Comment
     C                     MOVELBEMINA    WL0082           Special Comment
     C                     MOVELBEWBST    WL0083           Affect Auto Acc
     C                     MOVELBER4CD    WL0084           Sales Route Cod
     C                     MOVELBEBFCD    WL0085           Manager Level C
     C                     MOVELBEQ4CD    WL0086           VP Level Code
     C                     Z-ADDBET3NB    WL0087           Attach to Order
     C                     MOVELBESICD    WL0088           Reason for Pric
     C                     Z-ADDBECONB    WL0089           Invoice Number
     C                     MOVELBECEST    WL0090           Invoice Suffix
     C                     Z-ADDBEAWDT    WL0091           Invoice Date
     C                     MOVELBEJPCD    WL0092           Event Code
     C                     MOVELBEXUST    WL0093           Trans Contol AS
     C                     MOVELBEZ1ST    WL0094           Modified Flag
     C                     Z-ADDBEVRVA    WL0095           A/R order Value
     C                     MOVELBEOBST    WL0096           Billing Activit
     C                     MOVELBEBCST    WL0097           Block Order Fla
     C                     MOVELBEBDST    WL0098           Order Certifica
     C                     MOVELBEUVST    WL0099           EDI Status 1
     C                     MOVELBEUWST    WL0100           EDI Status 2
     C                     MOVELBEUXST    WL0101           EDI Status 3
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ** Calculation instructions documentation
      *================================================================
      * ** Transfer Price = 3rd party fob gross / 3rd party weight billed
      * ** Invoice net/lb = invoice fob gross / invoice weight billed
      * ** Adjustment/lb = invoice net/lb - transfer price
      * ** Sales Adjustment Amount = Adjustment/lb * Invoice Weight Bille
      * ** to apply:
      * ** New SH fob gross = old fob gross amount - sales adjustment amo
      * ** New ledgered accrual =  old ledgered accrual + sales adjust am
      * ** New NonLedgrd accrual = Old NonLedgrd accrual + sales adjust a
      * ** Only create Shipping Dtl Accrual if Weight Billed is not zeros
      * ** Only create History Dtl Accrual if Weight Billed is not zeros
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P2L9DT           From Date
     C                     Z-ADD*ZERO     P3CXC3           TP Sales Compan
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Define work field First Time Flag
     C                     MOVEL*BLANK    WUTAST  1
      * Define work field Record Processed Usr
     C                     MOVEL*BLANK    WUSOSX  1
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    F4BOCD           Type Code
     C                     MOVEL*HIVAL    F4GNDT           Actual Shipped
     C                     MOVEL*LOVAL    F4BKC7           Ship To Custome
     C                     MOVEL*LOVAL    F4CONB           Invoice Number
     C                     MOVEL*LOVAL    F4S5NB           Shipped Item Co
      * Define work field Weight Shipped Total
     C                     Z-ADD*ZERO     WUATWG 112
      * Define work field FOB Gross Amount      USR
     C                     Z-ADD*ZERO     WUX8VA  92
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
     C                     Z-ADD*ZERO     WABTC7           Parent Customer
     C                     Z-ADD*ZERO     WAANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAA0DT           Order Date
     C                     Z-ADD*ZERO     WAACDT           Cancel Date
     C                     Z-ADD*ZERO     WATBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WAATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WAT3NB           Attach to Order
     C                     Z-ADD*ZERO     WARSRN           Resell Referenc
     C                     Z-ADD*ZERO     WAORIT           Original Item
     C                     Z-ADD*ZERO     WAAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WAD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WACCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WAAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WAAKPR           Unit Price
     C                     Z-ADD*ZERO     WAAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAAWDT           Invoice Date
     C                     Z-ADD*ZERO     WAHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WAAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WAAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WAAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WAAYVA           Extended Amount
     C                     Z-ADD*ZERO     WAL6NB           Contract Number
     C                     Z-ADD*ZERO     WAHCDT           LD Arrival Date
     C                     Z-ADD*ZERO     WAESNB           Accounting Year
     C                     Z-ADD*ZERO     WAETNB           Accounting Peri
     C                     Z-ADD*ZERO     WABZNB           OM Week
     C                     Z-ADD*ZERO     WAEXQT           Quantity Billed
     C                     Z-ADD*ZERO     WABYWG           Weight Billed
     C                     Z-ADD*ZERO     WAS5NB           Shipped Item Co
     C                     Z-ADD*ZERO     WAMAVA           Billing Detail
     C                     Z-ADD*ZERO     WAKDVA           Billing Detail
     C                     Z-ADD*ZERO     WAUSVA           FOB Gross Amoun
     C                     Z-ADD*ZERO     WAUTVA           Standard Overag
     C                     Z-ADD*ZERO     WAA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WACKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WAR8NB           Shipping Compan
     C                     Z-ADD*ZERO     WABZPR           Price Overage O
     C                     Z-ADD*ZERO     WAEXDT           Market Pricing
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WACONB           Invoice Number
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WASKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WASLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WASMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WAONVA           Actual Freight
     C                     Z-ADD*ZERO     WAB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WAB5NB           PM Line Number
     C                     Z-ADD*ZERO     WAGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WAULVA           Absorbed Freigh
     C                     Z-ADD*ZERO     WAUNVA           Ledgrd Trd Fund
     C                     Z-ADD*ZERO     WAUOVA           Commission Amou
     C                     Z-ADD*ZERO     WAUPVA           Financials Amou
     C                     Z-ADD*ZERO     WAUQVA           Financials Amou
     C                     Z-ADD*ZERO     WACFC7           Order Group Cod
     C                     Z-ADD*ZERO     WADUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WAB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WAIANX           Req Shipping Te
     C                     Z-ADD*ZERO     WAIBNX           Actual Shipping
     C                     Z-ADD*ZERO     WANYDT           Req Delivery Da
     C                     Z-ADD*ZERO     WABZTM           Req Delivery Ti
     C                     Z-ADD*ZERO     WAZ4NB           MPC Number
     C                     Z-ADD*ZERO     WAOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WAC0C7           Claim Number
     C                     Z-ADD*ZERO     WAA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WAA5PR           Commodity Marke
     C                     Z-ADD*ZERO     WACDPR           Market Value
     C                     Z-ADD*ZERO     WAD0PR           Default Cmdty M
     C                     Z-ADD*ZERO     WAD0VL           Raw Material Co
     C                     Z-ADD*ZERO     WACEVL           Sales Expense T
     C                     Z-ADD*ZERO     WAOHDT           LD Sail Date
     C                     Z-ADD*ZERO     WAD9PR           NonLedgrd TrdFn
     C                     Z-ADD*ZERO     WACFVL           HST Item Target
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBDPNB           Order Sequence
     C                     Z-ADD*ZERO     WBUENB           Order Secondary
     C                     Z-ADD*ZERO     WBDXNB           Sequence Number
     C                     Z-ADD*ZERO     WBBKPR           Accrual Rate
     C                     Z-ADD*ZERO     WBC5PC           Accrual Percent
     C                     Z-ADD*ZERO     WBAYVA           Extended Amount
     C                     Z-ADD*ZERO     WBEDVL           Item Accrual Am
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBDUC7           A/R Customer
     C                     Z-ADD*ZERO     WBPODT           SDA Actual Ship
     C                     Z-ADD*ZERO     WBBYWG           Weight Billed
     C                     Z-ADD*ZERO     WBPPDT           SDA Ord Dtl Acr
     C                     Z-ADD*ZERO     WBPQDT           SDA Atch to Ord
     C                     Z-ADD*ZERO     WBEEVL           SDA Unused Amt
     C                     Z-ADD*ZERO     WBEFVL           SDA Unused Amt
     C                     Z-ADD*ZERO     WBQ8DT           SDA Invoice Dat
     C                     Z-ADD*ZERO     WBH0NY           SDA G/L Sub Led
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SHRVGN.
     C                     Z-ADD*ZERO     WL0001  70
     C                     Z-ADD*ZERO     WL0002  80
      * Define local variables for subroutine SLRVGN.
     C                     Z-ADD*ZERO     WL0003  30
     C                     MOVEL*BLANK    WL0004  1
     C                     MOVEL*BLANK    WL0005  1
      * Define local variables for subroutine SMRVGN.
     C                     Z-ADD*ZERO     WL0006  30
     C                     Z-ADD*ZERO     WL0007  70
     C                     MOVEL*BLANK    WL0008 30
     C                     MOVEL*BLANK    WL0009 30
     C                     MOVEL*BLANK    WL0010  2
     C                     MOVEL*BLANK    WL0011  2
     C                     MOVEL*BLANK    WL0012  2
      * Define local variables for subroutine SNRVGN.
     C                     Z-ADD*ZERO     WL0013  30
     C                     Z-ADD*ZERO     WL0014  70
     C                     MOVEL*BLANK    WL0015  2
     C                     Z-ADD*ZERO     WL0016  70
     C                     Z-ADD*ZERO     WL0017  70
     C                     MOVEL*BLANK    WL0018 30
     C                     MOVEL*BLANK    WL0019 30
     C                     MOVEL*BLANK    WL0020 30
     C                     MOVEL*BLANK    WL0021 30
     C                     MOVEL*BLANK    WL0022 20
     C                     MOVEL*BLANK    WL0023  2
     C                     MOVEL*BLANK    WL0024 11
     C                     Z-ADD*ZERO     WL0025  70
     C                     MOVEL*BLANK    WL0026 30
     C                     MOVEL*BLANK    WL0027 30
     C                     MOVEL*BLANK    WL0028 30
     C                     MOVEL*BLANK    WL0029 30
     C                     MOVEL*BLANK    WL0030 20
     C                     MOVEL*BLANK    WL0031  2
     C                     MOVEL*BLANK    WL0032 11
     C                     MOVEL*BLANK    WL0033 15
     C                     Z-ADD*ZERO     WL0034  70
     C                     Z-ADD*ZERO     WL0035  70
     C                     Z-ADD*ZERO     WL0036  70
     C                     Z-ADD*ZERO     WL0037  70
     C                     MOVEL*BLANK    WL0038  2
     C                     MOVEL*BLANK    WL0039 40
     C                     MOVEL*BLANK    WL0040 40
     C                     MOVEL*BLANK    WL0041  3
     C                     MOVEL*BLANK    WL0042  1
     C                     MOVEL*BLANK    WL0043  1
     C                     MOVEL*BLANK    WL0044  1
     C                     MOVEL*BLANK    WL0045  1
     C                     MOVEL*BLANK    WL0046  3
     C                     MOVEL*BLANK    WL0047  1
     C                     MOVEL*BLANK    WL0048  1
     C                     MOVEL*BLANK    WL0049  1
     C                     MOVEL*BLANK    WL0050  1
     C                     Z-ADD*ZERO     WL0051  70
     C                     MOVEL*BLANK    WL0052 10
     C                     Z-ADD*ZERO     WL0053  70
     C                     Z-ADD*ZERO     WL0054 112
     C                     Z-ADD*ZERO     WL0055 112
     C                     MOVEL*BLANK    WL0056  1
     C                     MOVEL*BLANK    WL0057  1
     C                     MOVEL*BLANK    WL0058  1
     C                     Z-ADD*ZERO     WL0059  70
     C                     Z-ADD*ZERO     WL0060  40
     C                     MOVEL*BLANK    WL0061  4
     C                     MOVEL*BLANK    WL0062 12
     C                     Z-ADD*ZERO     WL0063  70
     C                     Z-ADD*ZERO     WL0064  52
     C                     Z-ADD*ZERO     WL0065 112
     C                     MOVEL*BLANK    WL0066  1
     C                     MOVEL*BLANK    WL0067  1
     C                     MOVEL*BLANK    WL0068  1
     C                     MOVEL*BLANK    WL0069  2
     C                     MOVEL*BLANK    WL0070  1
     C                     MOVEL*BLANK    WL0071  1
     C                     MOVEL*BLANK    WL0072  1
     C                     MOVEL*BLANK    WL0073  1
     C                     MOVEL*BLANK    WL0074  1
     C                     Z-ADD*ZERO     WL0075  52
     C                     MOVEL*BLANK    WL0076  1
     C                     Z-ADD*ZERO     WL0077  70
     C                     MOVEL*BLANK    WL0078  1
     C                     MOVEL*BLANK    WL0079  1
     C                     Z-ADD*ZERO     WL0080  70
     C                     MOVEL*BLANK    WL0081 30
     C                     MOVEL*BLANK    WL0082 30
     C                     MOVEL*BLANK    WL0083  1
     C                     MOVEL*BLANK    WL0084  3
     C                     MOVEL*BLANK    WL0085  2
     C                     MOVEL*BLANK    WL0086  3
     C                     Z-ADD*ZERO     WL0087  70
     C                     MOVEL*BLANK    WL0088  3
     C                     Z-ADD*ZERO     WL0089  70
     C                     MOVEL*BLANK    WL0090  2
     C                     Z-ADD*ZERO     WL0091  70
     C                     MOVEL*BLANK    WL0092  2
     C                     MOVEL*BLANK    WL0093  1
     C                     MOVEL*BLANK    WL0094  1
     C                     Z-ADD*ZERO     WL0095 112
     C                     MOVEL*BLANK    WL0096  1
     C                     MOVEL*BLANK    WL0097  1
     C                     MOVEL*BLANK    WL0098  1
     C                     MOVEL*BLANK    WL0099  1
     C                     MOVEL*BLANK    WL0100  1
     C                     MOVEL*BLANK    WL0101  1
      * Define local work field Item Description
     C                     MOVEL*BLANK    YL0001 30
      * Define local work field Accrual Code
     C                     MOVEL*BLANK    YL0002  3
      * Define local work field Accrual Description
     C                     MOVEL*BLANK    YL0003 30
      * Define local work field Automatic Accrual (Y/N)
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field Print On Invoice (Y/N)
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field Rate Usage
     C                     MOVEL*BLANK    YL0006  1
      * Define local work field Add-on/Allowance
     C                     MOVEL*BLANK    YL0007  1
      * Define local work field Accrual Type
     C                     MOVEL*BLANK    YL0008  2
      * Define local work field Sub Ledger Code
     C                     MOVEL*BLANK    YL0009  2
      * Define local work field Reverse Accrual Code
     C                     MOVEL*BLANK    YL0010  3
      * Define local work field U/M - Primary Dft
     C                     MOVEL*BLANK    YL0011  2
      * Define local work field G/L Code Dr
     C                     MOVEL*BLANK    YL0012  8
      * Define local work field G/L Code Cr
     C                     MOVEL*BLANK    YL0013  8
      * Define local work field G/L Sub Account Code
     C                     MOVEL*BLANK    YL0014  8
      * Define local work field Sales History Exp Bucket
     C                     MOVEL*BLANK    YL0015  8
      * Define local work field Post to G/L (Y/N)
     C                     MOVEL*BLANK    YL0016  1
      * Define local work field All Products (Y/N)
     C                     MOVEL*BLANK    YL0017  1
      * Define local work field Accrual Rate
     C                     Z-ADD*ZERO     YL0018  96
      * Define local work field Accrual Rate Type
     C                     MOVEL*BLANK    YL0019  2
      * Define local work field Accrual Detail Search
     C                     MOVEL*BLANK    YL0020  1
      * Define local work field Standard Schedule (Y/N)
     C                     MOVEL*BLANK    YL0021  1
      * Define local work field Affect Sales Realz Rpt
     C                     MOVEL*BLANK    YL0022  1
      * Define local work field Affect Invoice Price
     C                     MOVEL*BLANK    YL0023  1
      * Define local work field Invoice Print Type
     C                     MOVEL*BLANK    YL0024  2
      * Define local work field Max Accrual Amount
     C                     Z-ADD*ZERO     YL0025 112
      * Define local work field Max Accrual Amount Type
     C                     MOVEL*BLANK    YL0026  2
      * Define local work field Record Status
     C                     MOVEL*BLANK    YL0027  1
      * Define local work field Retro Comm Calculated
     C                     MOVEL*BLANK    YL0028  1
      * Define local work field Sequence Number
     C                     Z-ADD*ZERO     YL0029  30
      * Define local work field G/L Code Desc USR
     C                     MOVEL*BLANK    YL0030 25
      * Define local work field SDA JDE Account ID Dr
     C                     MOVEL*BLANK    YL0031  8
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0032  1
      * Define local work field SDA JDE Account ID Cr
     C                     MOVEL*BLANK    YL0033  8
      * Define local work field SDA G/L Sub Ledger
     C                     Z-ADD*ZERO     YL0034  80
      * Define local work field A/R Customer Number
     C                     Z-ADD*ZERO     YL0035  70
      * Define local work field Broker Code
     C                     MOVEL*BLANK    YL0036  6
      * Define local work field Broker Name
     C                     MOVEL*BLANK    YL0037 30
      * Define local work field Broker Address Line 1
     C                     MOVEL*BLANK    YL0038 30
      * Define local work field Broker Address Line 2
     C                     MOVEL*BLANK    YL0039 30
      * Define local work field Broker City
     C                     MOVEL*BLANK    YL0040 20
      * Define local work field Broker State
     C                     MOVEL*BLANK    YL0041  2
      * Define local work field Broker Zip
     C                     MOVEL*BLANK    YL0042 11
      * Define local work field Broker Office Manager
     C                     MOVEL*BLANK    YL0043 30
      * Define local work field Broker Telephone Number
     C                     MOVEL*BLANK    YL0044 25
      * Define local work field Broker Fax Number
     C                     MOVEL*BLANK    YL0045 25
      * Define local work field Broker Email Address
     C                     MOVEL*BLANK    YL0046 50
      * Define local work field Salesperson Code
     C                     MOVEL*BLANK    YL0047  3
      * Define local work field Use G/L Code Dr/Cr
     C                     MOVEL*BLANK    YL0048  1
      * Define local work field G/L Sub Account
     C                     MOVEL*BLANK    YL0049  8
      * Define null work field Plant Company Sts
     C                     MOVEL*BLANK    YN0001  1
      * Define local work field Company Organization
     C                     MOVEL*BLANK    YL0050  1
      * Define local work field Description Line One
     C                     MOVEL*BLANK    YL0051 30
      * Define null work field Description Line Two
     C                     MOVEL*BLANK    YN0002 30
      * Define null work field U/M - Primary
     C                     MOVEL*BLANK    YN0003  2
      * Define null work field U/M - Second
     C                     MOVEL*BLANK    YN0004  2
      * Define null work field U/M - Third
     C                     MOVEL*BLANK    YN0005  2
      * Define null work field Order Type - Sales
     C                     MOVEL*BLANK    YN0006  2
      * Define null work field A/R Customer Number
     C                     Z-ADD*ZERO     YN0007  70
      * Define null work field Ship To Customer
     C                     Z-ADD*ZERO     YN0008  70
      * Define null work field Ship To Name
     C                     MOVEL*BLANK    YN0009 30
      * Define null work field Ship To Address Line 1
     C                     MOVEL*BLANK    YN0010 30
      * Define null work field Ship To Address Line 2
     C                     MOVEL*BLANK    YN0011 30
      * Define null work field Ship To Address Line 3
     C                     MOVEL*BLANK    YN0012 30
      * Define null work field Ship To City
     C                     MOVEL*BLANK    YN0013 20
      * Define null work field Ship To State Code
     C                     MOVEL*BLANK    YN0014  2
      * Define null work field Ship To Zip/Postal Code
     C                     MOVEL*BLANK    YN0015 11
      * Define null work field Bill to Customer
     C                     Z-ADD*ZERO     YN0016  70
      * Define null work field Bill to Name
     C                     MOVEL*BLANK    YN0017 30
      * Define null work field Bill to Address Line 1
     C                     MOVEL*BLANK    YN0018 30
      * Define null work field Bill to Address Line 2
     C                     MOVEL*BLANK    YN0019 30
      * Define null work field Bill to Address Line 3
     C                     MOVEL*BLANK    YN0020 30
      * Define null work field Bill to City
     C                     MOVEL*BLANK    YN0021 20
      * Define null work field Bill to State Code
     C                     MOVEL*BLANK    YN0022  2
      * Define null work field Bill to Zip/Postal Code
     C                     MOVEL*BLANK    YN0023 11
      * Define null work field Customer Purchase Order #
     C                     MOVEL*BLANK    YN0024 15
      * Define null work field Order Date
     C                     Z-ADD*ZERO     YN0025  70
      * Define null work field Requested Ship Date
     C                     Z-ADD*ZERO     YN0026  70
      * Define null work field Actual Shipped Date
     C                     Z-ADD*ZERO     YN0027  70
      * Define null work field Cancel Date
     C                     Z-ADD*ZERO     YN0028  70
      * Define null work field Terms Code
     C                     MOVEL*BLANK    YN0029  2
      * Define null work field Special Instructions
     C                     MOVEL*BLANK    YN0030 40
      * Define null work field Special Instructions 2
     C                     MOVEL*BLANK    YN0031 40
      * Define null work field Carrier Code
     C                     MOVEL*BLANK    YN0032  3
      * Define null work field Comment Print Acknowledge
     C                     MOVEL*BLANK    YN0033  1
      * Define null work field Comment Print Inv/Cr.Memo
     C                     MOVEL*BLANK    YN0034  1
      * Define null work field Comment Print Pick Slip
     C                     MOVEL*BLANK    YN0035  1
      * Define null work field Comment Print Ship Doc
     C                     MOVEL*BLANK    YN0036  1
      * Define null work field Reason Code
     C                     MOVEL*BLANK    YN0037  3
      * Define null work field Order in Use
     C                     MOVEL*BLANK    YN0038  1
      * Define null work field Header Status
     C                     MOVEL*BLANK    YN0039  1
      * Define null work field Header Status Last
     C                     MOVEL*BLANK    YN0040  1
      * Define null work field Order Type Print Status
     C                     MOVEL*BLANK    YN0041  1
      * Define null work field Scheduled Ship Date
     C                     Z-ADD*ZERO     YN0042  70
      * Define null work field User Original Entry
     C                     MOVEL*BLANK    YN0043 10
      * Define null work field Date of Original Entry
     C                     Z-ADD*ZERO     YN0044  70
      * Define null work field Order Value Total
     C                     Z-ADD*ZERO     YN0045 112
      * Define null work field Order Weight Total
     C                     Z-ADD*ZERO     YN0046 112
      * Define null work field Credit Hold
     C                     MOVEL*BLANK    YN0047  1
      * Define null work field Production Hold
     C                     MOVEL*BLANK    YN0048  1
      * Define null work field New Customer Hold
     C                     MOVEL*BLANK    YN0049  1
      * Define null work field Requested Delivery Date
     C                     Z-ADD*ZERO     YN0050  70
      * Define null work field Requested Delivery Time
     C                     Z-ADD*ZERO     YN0051  40
      * Define null work field Accounts Receiv. Ent 1
     C                     MOVEL*BLANK    YN0052  4
      * Define null work field Accounts Receiv. Ent 2
     C                     MOVEL*BLANK    YN0053 12
      * Define null work field Load ID
     C                     Z-ADD*ZERO     YN0054  70
      * Define null work field Absorbed Freight Rate CWT
     C                     Z-ADD*ZERO     YN0055  52
      * Define null work field Rated Freight
     C                     Z-ADD*ZERO     YN0056 112
      * Define null work field LTL Flag
     C                     MOVEL*BLANK    YN0057  1
      * Define null work field Price Audit
     C                     MOVEL*BLANK    YN0058  1
      * Define null work field Price Status
     C                     MOVEL*BLANK    YN0059  1
      * Define null work field Shipping Method
     C                     MOVEL*BLANK    YN0060  2
      * Define null work field Export Status
     C                     MOVEL*BLANK    YN0061  1
      * Define null work field Palletize
     C                     MOVEL*BLANK    YN0062  1
      * Define null work field Shrink Wrap
     C                     MOVEL*BLANK    YN0063  1
      * Define null work field Slip Sheet
     C                     MOVEL*BLANK    YN0064  1
      * Define null work field Age Code
     C                     MOVEL*BLANK    YN0065  1
      * Define null work field Reefer Temperature
     C                     Z-ADD*ZERO     YN0066  52
      * Define null work field Load Type
     C                     MOVEL*BLANK    YN0067  1
      * Define null work field Attach to Invoice Number
     C                     Z-ADD*ZERO     YN0068  70
      * Define null work field Load Plan Order
     C                     MOVEL*BLANK    YN0069  1
      * Define null work field Print Pick Slip
     C                     MOVEL*BLANK    YN0070  1
      * Define null work field Resell Reference Number
     C                     Z-ADD*ZERO     YN0071  70
      * Define null work field Special Comment 1
     C                     MOVEL*BLANK    YN0072 30
      * Define null work field Special Comment 2
     C                     MOVEL*BLANK    YN0073 30
      * Define null work field Affect Auto Accruals
     C                     MOVEL*BLANK    YN0074  1
      * Define null work field Sales Route Code
     C                     MOVEL*BLANK    YN0075  3
      * Define null work field Manager Level Code
     C                     MOVEL*BLANK    YN0076  2
      * Define null work field VP Level Code
     C                     MOVEL*BLANK    YN0077  3
      * Define null work field Attach to Order Number
     C                     Z-ADD*ZERO     YN0078  70
      * Define null work field Reason for Price Audit
     C                     MOVEL*BLANK    YN0079  3
      * Define local work field Invoice Number
     C                     Z-ADD*ZERO     YL0052  70
      * Define null work field Invoice Suffix
     C                     MOVEL*BLANK    YN0080  2
      * Define local work field Invoice Date
     C                     Z-ADD*ZERO     YL0053  70
      * Define null work field Event Code
     C                     MOVEL*BLANK    YN0081  2
      * Define null work field Trans Contol AS400/Plant
     C                     MOVEL*BLANK    YN0082  1
      * Define null work field Modified Flag
     C                     MOVEL*BLANK    YN0083  1
      * Define null work field A/R order Value Total
     C                     Z-ADD*ZERO     YN0084 112
      * Define null work field Billing Activity Type
     C                     MOVEL*BLANK    YN0085  1
      * Define null work field Block Order Flag
     C                     MOVEL*BLANK    YN0086  1
      * Define null work field Order Certification Flag
     C                     MOVEL*BLANK    YN0087  1
      * Define null work field EDI Status 1
     C                     MOVEL*BLANK    YN0088  1
      * Define null work field EDI Status 2
     C                     MOVEL*BLANK    YN0089  1
      * Define null work field EDI Status 3
     C                     MOVEL*BLANK    YN0090  1
      * Define local work field USR Internal D8# YYYYMMDD
     C                     Z-ADD*ZERO     YL0054  80
      * Define local work field USR Work Field 5,0
     C                     Z-ADD*ZERO     YL0055  50
      * Define local work field Text USR 5
     C                     MOVEL*BLANK    YL0056  5
      * Define local work field USR number
     C                     Z-ADD*ZERO     YL0057  60
      * Define local work field Invoice Number 6 USR
     C                     MOVEL*BLANK    YL0058  6
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * VAL Rtv & Ctr Prt Hdg  IF
      * SET Setup Prt Headings IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SARVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * Center Txt String 40 - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc to PrtCo US - /UT User Source  * 
     C                     MOVE WUDE40    $ACMP
      * Rtv Prior Sunday      RT - Calendar  * 
     C                     EXSR SCRVGN
     C                     MOVEL'Y'       WUTAST           First Time Flag
     C                     MOVEL'N'       WUSOSX           Record Processe
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 No 3rd Party Sales
00002 Y2U0005
