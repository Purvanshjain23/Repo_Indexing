     H/TITLE CPY Weight Range      PV  Prompt & validate record
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Prompts fields, allowing user changes
     H* - Validates fields
     H* - If valid, performs an action
      *
     H* Generated by AllFusion 2E release 8.1SP2 (1250)
     H* Function type : Prompt & validate record
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISPPATE
     H* Date          : 05/06/09  Time  : 12:22:19
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPDB1PVR#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: CPY Weight Range      PV  Prompt & validate record
      *
     FPDIZREL1IF  E           K        DISK
      * RTV : PS Cutout Dist Lean %     Retrieval index
      *
     FPDI4REL1IF  E           K        DISK
      * RTV : PS Cutout Item            Retrieval index
      *
     FPDJ0REL1IF  E           K        DISK
      * RTV : PS Cutout Dist Backfat    Retrieval index
      *
     FPDJ1REL1IF  E           K        DISK
      * RTV : PS Cutout Dist Loin-Eye   Retrieval index
      *
     FPDI0REL1IF  E           K        DISK
      * RTV : PS Cutout Matrix          Retrieval index
      *
     FPDI1REL1IF  E           K        DISK
      * RTV : PS Cutout Weight Range    Retrieval index
      *
     FCAAQREL1IF  E           K        DISK
      * RTV : Company Defaults          Retrieval index       NV
      *
     FPDI1REL0IF  E           K        DISK                      A
      * UPD : PS Cutout Weight Range    Update index
      *
     FPDI4REL0IF  E           K        DISK                      A
      * UPD : PS Cutout Item            Update index
      *
     FPDIZREL0IF  E           K        DISK                      A
      * UPD : PS Cutout Dist Lean %     Update index
      *
     FPDJ0REL0IF  E           K        DISK                      A
      * UPD : PS Cutout Dist Backfat    Update index
      *
     FPDJ1REL0IF  E           K        DISK                      A
      * UPD : PS Cutout Dist Loin-Eye   Update index
      *
     E                    #L3         3  1
      * Set wdw location allowed?
     E                    YSL         1  1
     I@I1RES5
      * PS Cutout Weight Range    Update index
      * Renamed input format fields
     I              I1AIC3                          WAAIC3
     I              I1RXCD                          WARXCD
     I              I1GHDT                          WAGHDT
     I              I1UPNB                          WAUPNB
     I              I1UQNB                          WAUQNB
     I              I1VSNB                          WAVSNB
     I              I1VVNB                          WAVVNB
     I              I1DGPC                          WADGPC
     I              I1V0NB                          WAV0NB
     I              I1UVST                          WAUVST
     I              I1UWST                          WAUWST
     I              I1UXST                          WAUXST
     I              I1VSST                          WAVSST
     I              I1AATM                          WAAATM
     I              I1AYNA                          WAAYNA
     I              I1A0NA                          WAA0NA
     I              I1AXDT                          WAAXDT
      *
     I@IZRETC
      * PS Cutout Dist Lean %     Retrieval index
      * Renamed input format fields
     I              IZAIC3                          WBAIC3
     I              IZRXCD                          WBRXCD
     I              IZGHDT                          WBGHDT
     I              IZUPNB                          WBUPNB
     I              IZUQNB                          WBUQNB
     I              IZULNB                          WBULNB
     I              IZUNNB                          WBUNNB
     I              IZUONB                          WBUONB
     I              IZDIPC                          WBDIPC
     I              IZZ0NB                          WBZ0NB
     I              IZAVLE                          WBAVLE
     I              IZQPNX                          WBQPNX
     I              IZUVST                          WBUVST
     I              IZUWST                          WBUWST
     I              IZUXST                          WBUXST
     I              IZVSST                          WBVSST
     I              IZAATM                          WBAATM
     I              IZAYNA                          WBAYNA
     I              IZA0NA                          WBA0NA
     I              IZAXDT                          WBAXDT
      *
     I@I4RETX
      * PS Cutout Item            Retrieval index
      * Renamed input format fields
     I              I4AIC3                          WCAIC3
     I              I4RXCD                          WCRXCD
     I              I4GHDT                          WCGHDT
     I              I4UPNB                          WCUPNB
     I              I4UQNB                          WCUQNB
     I              I4ULNB                          WCULNB
     I              I4HGCD                          WCHGCD
     I              I4UTNB                          WCUTNB
     I              I4XRCD                          WCXRCD
     I              I4UVST                          WCUVST
     I              I4UWST                          WCUWST
     I              I4UXST                          WCUXST
     I              I4VSST                          WCVSST
     I              I4AATM                          WCAATM
     I              I4AYNA                          WCAYNA
     I              I4A0NA                          WCA0NA
     I              I4AXDT                          WCAXDT
      *
     I@I4RETW
      * PS Cutout Item            Update index
      * Renamed input format fields
     I              I4AIC3                          WDAIC3
     I              I4RXCD                          WDRXCD
     I              I4GHDT                          WDGHDT
     I              I4UPNB                          WDUPNB
     I              I4UQNB                          WDUQNB
     I              I4ULNB                          WDULNB
     I              I4HGCD                          WDHGCD
     I              I4UTNB                          WDUTNB
     I              I4XRCD                          WDXRCD
     I              I4UVST                          WDUVST
     I              I4UWST                          WDUWST
     I              I4UXST                          WDUXST
     I              I4VSST                          WDVSST
     I              I4AATM                          WDAATM
     I              I4AYNA                          WDAYNA
     I              I4A0NA                          WDA0NA
     I              I4AXDT                          WDAXDT
      *
     I@IZRETB
      * PS Cutout Dist Lean %     Update index
      * Renamed input format fields
     I              IZAIC3                          WEAIC3
     I              IZRXCD                          WERXCD
     I              IZGHDT                          WEGHDT
     I              IZUPNB                          WEUPNB
     I              IZUQNB                          WEUQNB
     I              IZULNB                          WEULNB
     I              IZUNNB                          WEUNNB
     I              IZUONB                          WEUONB
     I              IZDIPC                          WEDIPC
     I              IZZ0NB                          WEZ0NB
     I              IZAVLE                          WEAVLE
     I              IZQPNX                          WEQPNX
     I              IZUVST                          WEUVST
     I              IZUWST                          WEUWST
     I              IZUXST                          WEUXST
     I              IZVSST                          WEVSST
     I              IZAATM                          WEAATM
     I              IZAYNA                          WEAYNA
     I              IZA0NA                          WEA0NA
     I              IZAXDT                          WEAXDT
      *
     I@J0RECH
      * PS Cutout Dist Backfat    Retrieval index
      * Renamed input format fields
     I              J0AIC3                          WFAIC3
     I              J0RXCD                          WFRXCD
     I              J0GHDT                          WFGHDT
     I              J0UPNB                          WFUPNB
     I              J0UQNB                          WFUQNB
     I              J0BFIN                          WFBFIN
     I              J0UNNB                          WFUNNB
     I              J0UONB                          WFUONB
     I              J0DIPC                          WFDIPC
     I              J0Z0NB                          WFZ0NB
     I              J0AVLE                          WFAVLE
     I              J0QPNX                          WFQPNX
     I              J0UVST                          WFUVST
     I              J0UWST                          WFUWST
     I              J0UXST                          WFUXST
     I              J0VSST                          WFVSST
     I              J0AATM                          WFAATM
     I              J0AYNA                          WFAYNA
     I              J0A0NA                          WFA0NA
     I              J0AXDT                          WFAXDT
      *
     I@J0RECG
      * PS Cutout Dist Backfat    Update index
      * Renamed input format fields
     I              J0AIC3                          WGAIC3
     I              J0RXCD                          WGRXCD
     I              J0GHDT                          WGGHDT
     I              J0UPNB                          WGUPNB
     I              J0UQNB                          WGUQNB
     I              J0BFIN                          WGBFIN
     I              J0UNNB                          WGUNNB
     I              J0UONB                          WGUONB
     I              J0DIPC                          WGDIPC
     I              J0Z0NB                          WGZ0NB
     I              J0AVLE                          WGAVLE
     I              J0QPNX                          WGQPNX
     I              J0UVST                          WGUVST
     I              J0UWST                          WGUWST
     I              J0UXST                          WGUXST
     I              J0VSST                          WGVSST
     I              J0AATM                          WGAATM
     I              J0AYNA                          WGAYNA
     I              J0A0NA                          WGA0NA
     I              J0AXDT                          WGAXDT
      *
     I@J1RECK
      * PS Cutout Dist Loin-Eye   Retrieval index
      * Renamed input format fields
     I              J1AIC3                          WHAIC3
     I              J1RXCD                          WHRXCD
     I              J1GHDT                          WHGHDT
     I              J1UPNB                          WHUPNB
     I              J1UQNB                          WHUQNB
     I              J1LEDP                          WHLEDP
     I              J1UVST                          WHUVST
     I              J1UWST                          WHUWST
     I              J1UXST                          WHUXST
     I              J1VSST                          WHVSST
     I              J1AATM                          WHAATM
     I              J1AYNA                          WHAYNA
     I              J1A0NA                          WHA0NA
     I              J1AXDT                          WHAXDT
      *
     I@J1RECJ
      * PS Cutout Dist Loin-Eye   Update index
      * Renamed input format fields
     I              J1AIC3                          WIAIC3
     I              J1RXCD                          WIRXCD
     I              J1GHDT                          WIGHDT
     I              J1UPNB                          WIUPNB
     I              J1UQNB                          WIUQNB
     I              J1LEDP                          WILEDP
     I              J1UVST                          WIUVST
     I              J1UWST                          WIUWST
     I              J1UXST                          WIUXST
     I              J1VSST                          WIVSST
     I              J1AATM                          WIAATM
     I              J1AYNA                          WIAYNA
     I              J1A0NA                          WIA0NA
     I              J1AXDT                          WIAXDT
      *
     I@I0RES3
      * PS Cutout Matrix          Retrieval index
      * Renamed input format fields
     I              I0AIC3                          WJAIC3
     I              I0RXCD                          WJRXCD
     I              I0GHDT                          WJGHDT
     I              I0MXNA                          WJMXNA
     I              I0VTST                          WJVTST
     I              I0VUST                          WJVUST
     I              I0UVST                          WJUVST
     I              I0UWST                          WJUWST
     I              I0UXST                          WJUXST
     I              I0VSST                          WJVSST
     I              I0AATM                          WJAATM
     I              I0AYNA                          WJAYNA
     I              I0A0NA                          WJA0NA
     I              I0AXDT                          WJAXDT
      *
     I@I1RES6
      * PS Cutout Weight Range    Retrieval index
      * Renamed input format fields
     I              I1AIC3                          WKAIC3
     I              I1RXCD                          WKRXCD
     I              I1GHDT                          WKGHDT
     I              I1UPNB                          WKUPNB
     I              I1UQNB                          WKUQNB
     I              I1VSNB                          WKVSNB
     I              I1VVNB                          WKVVNB
     I              I1DGPC                          WKDGPC
     I              I1V0NB                          WKV0NB
     I              I1UVST                          WKUVST
     I              I1UWST                          WKUWST
     I              I1UXST                          WKUXST
     I              I1VSST                          WKVSST
     I              I1AATM                          WKAATM
     I              I1AYNA                          WKAYNA
     I              I1A0NA                          WKA0NA
     I              I1AXDT                          WKAXDT
      *
     I@AQREB9
      * Company Defaults          Retrieval index       NV
      * Renamed input format fields
     I              AQAIC3                          WLAIC3
     I              AQASVA                          WLASVA
     I              AQAIST                          WLAIST
     I              AQA3ST                          WLA3ST
     I              AQAVST                          WLAVST
     I              AQBYNA                          WLBYNA
     I              AQB6NA                          WLB6NA
     I              AQBZNA                          WLBZNA
     I              AQJ8ST                          WLJ8ST
     I              AQJ7NA                          WLJ7NA
     I              AQJ8NA                          WLJ8NA
     I              AQJ9NA                          WLJ9NA
     I              AQKANA                          WLKANA
     I              AQLWCD                          WLLWCD
     I              AQEJTX                          WLEJTX
     I              AQDGPC                          WLDGPC
     I              AQBFCD                          WLBFCD
     I              AQIDCD                          WLIDCD
     I              AQBSCD                          WLBSCD
     I              AQTOCD                          WLTOCD
     I              AQTPCD                          WLTPCD
     I              AQR4CD                          WLR4CD
     I              AQUVST                          WLUVST
     I              AQUWST                          WLUWST
     I              AQUXST                          WLUXST
     I              AQVSST                          WLVSST
     I              AQAATM                          WLAATM
     I              AQAYNA                          WLAYNA
     I              AQA0NA                          WLA0NA
     I              AQAXDT                          WLAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IQPDI11    E DSPDI1REL0
      * UPD : PS Cutout Weight Range    Update index
      * Renamed input format fields
     I              I1AIC3                          WAAIC3
     I              I1RXCD                          WARXCD
     I              I1GHDT                          WAGHDT
     I              I1UPNB                          WAUPNB
     I              I1UQNB                          WAUQNB
     I              I1VSNB                          WAVSNB
     I              I1VVNB                          WAVVNB
     I              I1DGPC                          WADGPC
     I              I1V0NB                          WAV0NB
     I              I1UVST                          WAUVST
     I              I1UWST                          WAUWST
     I              I1UXST                          WAUXST
     I              I1VSST                          WAVSST
     I              I1AATM                          WAAATM
     I              I1AYNA                          WAAYNA
     I              I1A0NA                          WAA0NA
     I              I1AXDT                          WAAXDT
      *
     IQPDI41    E DSPDI4REL0
      * UPD : PS Cutout Item            Update index
      * Renamed input format fields
     I              I4AIC3                          WDAIC3
     I              I4RXCD                          WDRXCD
     I              I4GHDT                          WDGHDT
     I              I4UPNB                          WDUPNB
     I              I4UQNB                          WDUQNB
     I              I4ULNB                          WDULNB
     I              I4HGCD                          WDHGCD
     I              I4UTNB                          WDUTNB
     I              I4XRCD                          WDXRCD
     I              I4UVST                          WDUVST
     I              I4UWST                          WDUWST
     I              I4UXST                          WDUXST
     I              I4VSST                          WDVSST
     I              I4AATM                          WDAATM
     I              I4AYNA                          WDAYNA
     I              I4A0NA                          WDA0NA
     I              I4AXDT                          WDAXDT
      *
     IQPDIZ1    E DSPDIZREL0
      * UPD : PS Cutout Dist Lean %     Update index
      * Renamed input format fields
     I              IZAIC3                          WEAIC3
     I              IZRXCD                          WERXCD
     I              IZGHDT                          WEGHDT
     I              IZUPNB                          WEUPNB
     I              IZUQNB                          WEUQNB
     I              IZULNB                          WEULNB
     I              IZUNNB                          WEUNNB
     I              IZUONB                          WEUONB
     I              IZDIPC                          WEDIPC
     I              IZZ0NB                          WEZ0NB
     I              IZAVLE                          WEAVLE
     I              IZQPNX                          WEQPNX
     I              IZUVST                          WEUVST
     I              IZUWST                          WEUWST
     I              IZUXST                          WEUXST
     I              IZVSST                          WEVSST
     I              IZAATM                          WEAATM
     I              IZAYNA                          WEAYNA
     I              IZA0NA                          WEA0NA
     I              IZAXDT                          WEAXDT
      *
     IQPDJ01    E DSPDJ0REL0
      * UPD : PS Cutout Dist Backfat    Update index
      * Renamed input format fields
     I              J0AIC3                          WGAIC3
     I              J0RXCD                          WGRXCD
     I              J0GHDT                          WGGHDT
     I              J0UPNB                          WGUPNB
     I              J0UQNB                          WGUQNB
     I              J0BFIN                          WGBFIN
     I              J0UNNB                          WGUNNB
     I              J0UONB                          WGUONB
     I              J0DIPC                          WGDIPC
     I              J0Z0NB                          WGZ0NB
     I              J0AVLE                          WGAVLE
     I              J0QPNX                          WGQPNX
     I              J0UVST                          WGUVST
     I              J0UWST                          WGUWST
     I              J0UXST                          WGUXST
     I              J0VSST                          WGVSST
     I              J0AATM                          WGAATM
     I              J0AYNA                          WGAYNA
     I              J0A0NA                          WGA0NA
     I              J0AXDT                          WGAXDT
      *
     IQPDJ11    E DSPDJ1REL0
      * UPD : PS Cutout Dist Loin-Eye   Update index
      * Renamed input format fields
     I              J1AIC3                          WIAIC3
     I              J1RXCD                          WIRXCD
     I              J1GHDT                          WIGHDT
     I              J1UPNB                          WIUPNB
     I              J1UQNB                          WIUQNB
     I              J1LEDP                          WILEDP
     I              J1UVST                          WIUVST
     I              J1UWST                          WIUWST
     I              J1UXST                          WIUXST
     I              J1VSST                          WIVSST
     I              J1AATM                          WIAATM
     I              J1AYNA                          WIAYNA
     I              J1A0NA                          WIA0NA
     I              J1AXDT                          WIAXDT
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: PS Cutout Weight Range
      * I : MAP Company Number
     I                                    P   1   20P1AIC3
      * I : MAP Cutout Matrix Code
     I                                        3   8 P1RXCD
      * I : MAP Effective Month/Day
     I                                    P   9  110P1GHDT
      * I : MAP Min Carcass Weight
     I                                    P  12  140P1UPNB
      * I : MAP Max Carcass Weight
     I                                    P  15  170P1UQNB
     IP2PARM      DS
      * FLD: Company Defaults
      * N :  Cooler Shrink Percent
     I                                    P   1   32P2DGPC
     IP3PARM      DS
      * FLD: PS Cutout Matrix
      * I : MAP Cutout Matrix Desc
     I                                        1  30 P3MXNA
     IP4PARM      DS
      * I : MAP Name
     I                                        1  30 P4ADTX
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'PS Min Wght GT Max Wght'
      * Min Carcass Weight
     I                                    P   1   30ZA0001
      * Max Carcass Weight
     I                                    P   4   60ZA0002
      * Message data for 'PS Weight Range Exist'
      * USR From Weight Range
     I                                    P   1   30ZA0003
      * USR To Weight Range
     I                                    P   4   60ZA0004
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1RXCD    PARM           WP0002  6        Cutout Matrix C
     C           P1GHDT    PARM           WP0003  40       Effective Month
     C           P1UPNB    PARM           WP0004  50       Min Carcass Wei
     C           P1UQNB    PARM           WP0005  50       Max Carcass Wei
     C           P3MXNA    PARM           WP0006 30        Cutout Matrix D
     C           P4ADTX    PARM           WP0007 30        Name
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Conduct screen conversation
     C                     DO   *HIVAL
      * Start new transaction
     C                     MOVEL'Y'       W0TRN   1
      * Process current transaction
     C           W0TRN     DOWEQ'Y'
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   30                CAS            MALDSC
      * Reposition window
     C   26                CAS            ZRRPWD
      * Process screen input
     C                     CAS            DAPRSC
     C                     END
      *
     C                     END
      *
     C                     END
      *****************************************************************
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
     C                     Z-ADD1         YWPNNO  10       Panel number
     C                     MOVEL'R'       YWLCTP  1        Locate action t
     C                     EXSR ZSSTLC                     Set window loca
     C                     Z-ADD1         W0WASM  10
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPRSC    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate screen input
     C                     EXSR DBVLSC
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPMCF
      * Quit if not confirmed
     C           *IN99     CABEQ'1'       DAEXIT
      * USER: User defined action
      * Calculate Min/Max Live Weight
     C                     EXSR UASUBR                     Calculate Min/M
      * Crt Weight Range      CR - PS Cutout Weight Range  * 
     C                     EXSR SACRRC
      * Cpy Weight Range      RT - PS Cutout Dist Lean %  * 
     C                     EXSR SBRVGN
      * Cpy Weight Range      RT - PS Cutout Dist Backfat  * 
     C                     EXSR SFRVGN
      * Cpy Dist Loin-Eye     RT - PS Cutout Dist Loin-Eye  * 
     C                     EXSR SHRVGN
      * Exit program
     C                     EXSR ZXEXPG
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBVLSC    BEGSR
      *================================================================
      * Validate screen input
      *================================================================
      * Bypass ref file checks if error already detected
     C   99                GOTO DBEXIT
      * Check reference to PS Cutout Matrix
     C                     EXSR VACKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate relations
      * To min carcass weight gt to max carcass weight
      * CASE: DTL.USR From Weight Range GT DTL.USR To Weight Range
     C           #DFWRG    IFGT #DV9NB                     *IF
      * Setup message data for message
     C                     Z-ADD#DFWRG    ZA0001           USR From Weight
     C                     Z-ADD#DV9NB    ZA0002           USR To Weight R
      * Send message 'PS Min Wght GT Max Wght'
     C                     MOVEL'USR1736' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993132*
      *
     C                     END                             *FI
      * Make sure weight range does not exist
      * Chk Weight Range Exist RT - PS Cutout Weight Range  * 
     C                     EXSR SJRVGN
      * If weight range exists send message
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ 'Y2U0003'                  *IF
      * Setup message data for message
     C                     Z-ADD#DFWRG    ZA0003           USR From Weight
     C                     Z-ADD#DV9NB    ZA0004           USR To Weight R
      * Send message 'PS Weight Range Exist'
     C                     MOVEL'USR1740' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993132*
      *
     C                     END                             *FI
      * If cooler shrink % eq 0 then load default
      * CASE: DTL.Cooler Shrink Percent is equal to zero
     C           #1DGPC    IFEQ *ZERO                      *IF
     C                     Z-ADDP2DGPC    #1DGPC           Cooler Shrink P
     C                     END                             *FI
      * Calculate min live weight & max live weight
     C           #1V0NB    DIV  100       WUBHPC    H      USR Percent Wor
      * If Yield percent is not zeros calc live weights
      * CASE: WRK.USR Percent Work, 7.4 is Not zeros
     C           WUBHPC    IFNE *ZERO                      *IF
     C           #DFWRG    DIV  WUBHPC    #1VSNB    H      Min Live Weight
     C           #DV9NB    DIV  WUBHPC    #1VVNB    H      Max Live Weight
     C                     END                             *FI
     C                     END
      * USR From Weight Range required
     C           #DFWRG    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * USR To Weight Range required
     C           #DV9NB    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9932  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DHPMCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Update screen time
     C                     TIME           ##TME
      * Refresh screen
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     EXSR ZVCFPM
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#RCDDTL1
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLWR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         MALDSC    BEGSR
      *================================================================
      * Load screen from passed parameters
      *================================================================
     C                     Z-ADD*ZERO     #1VSNB           Min Live Weight
     C                     Z-ADD*ZERO     #1VVNB           Max Live Weight
     C                     Z-ADD*ZERO     #1V0NB           Std Dressing Yi
     C                     MOVEL*BLANK    #1UVST           EDI Status 1
     C                     MOVEL*BLANK    #1UWST           EDI Status 2
     C                     MOVEL*BLANK    #1UXST           EDI Status 3
     C                     MOVEL*BLANK    #1VSST           Record Status
     C                     Z-ADD*ZERO     #1AATM           Job Time
     C                     MOVEL*BLANK    #1AYNA           User Id
     C                     MOVEL*BLANK    #1A0NA           Job Name
     C                     Z-ADD*ZERO     #1AXDT           Job Date
     C                     Z-ADDP1AIC3    #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
     C                     MOVELP4ADTX    #PADTX           Name
     C                     MOVELP1RXCD    #1RXCD           Cutout Matrix C
     C                     MOVELP3MXNA    #PMXNA           Cutout Matrix D
     C                     Z-ADDP1GHDT    #1GHDT           Effective Month
     C                     Z-ADDP1UPNB    #1UPNB           Min Carcass Wei
     C                     Z-ADDP1UQNB    #1UQNB           Max Carcass Wei
     C                     Z-ADD*ZERO     #DFWRG           USR From Weight
     C                     Z-ADD*ZERO     #DV9NB           USR To Weight R
     C                     Z-ADD*ZERO     #1DGPC           Cooler Shrink P
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         SACRRC    BEGSR
      *================================================================
      * Crt Weight Range      CR - PS Cutout Weight Range  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0011  60       Job Time
     C                     MOVEL*BLANK    WN0012 10        User Id
     C                     MOVEL*BLANK    WN0013 10        Job Name
     C                     Z-ADD*ZERO     WN0014  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @I1RES5
     C                     Z-ADD#1AIC3    WAAIC3           Company Number
     C                     MOVEL#1RXCD    WARXCD           Cutout Matrix C
     C                     Z-ADD#1GHDT    WAGHDT           Effective Month
     C                     Z-ADD#DFWRG    WAUPNB           Min Carcass Wei
     C                     Z-ADD#DV9NB    WAUQNB           Max Carcass Wei
     C                     Z-ADD#1VSNB    WAVSNB           Min Live Weight
     C                     Z-ADD#1VVNB    WAVVNB           Max Live Weight
     C                     Z-ADD#1DGPC    WADGPC           Cooler Shrink P
     C                     Z-ADD#1V0NB    WAV0NB           Std Dressing Yi
     C                     MOVEL#1UVST    WAUVST           EDI Status 1
     C                     MOVEL#1UWST    WAUWST           EDI Status 2
     C                     MOVEL#1UXST    WAUXST           EDI Status 3
     C                     MOVEL#1VSST    WAVSST           Record Status
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WAVSST           Record Status
     C                     Z-ADD##JTM     WAAATM           Job Time
     C                     MOVEL##USR     WAAYNA           User Id
     C                     MOVEL##JOB     WAA0NA           Job Name
     C                     Z-ADD##JDT     WAAXDT           Job Date
     C           KLCRSA    KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WARXCD           Cutout Matrix C
     C                     KFLD           WAGHDT           Effective Month
     C                     KFLD           WAUPNB           Min Carcass Wei
     C                     KFLD           WAUQNB           Max Carcass Wei
      * Check for duplicate primary key
     C           KLCRSA    SETLL@I1RES5                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1725' W0RTN   7
      * Send message 'PS Cutout Weight Range EX'
     C                     MOVEL'USR1725' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C                     WRITE@I1RES5                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Cpy Weight Range      RT - PS Cutout Dist Lean %  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSB01           Company Number
     C           *LIKE     DEFN WBRXCD    WQSB02           Cutout Matrix C
     C           *LIKE     DEFN WBGHDT    WQSB03           Effective Month
     C           *LIKE     DEFN WBUPNB    WQSB04           Min Carcass Wei
     C           *LIKE     DEFN WBUQNB    WQSB05           Max Carcass Wei
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Cutout Matrix C
     C                     KFLD           WQSB03           Effective Month
     C                     KFLD           WQSB04           Min Carcass Wei
     C                     KFLD           WQSB05           Max Carcass Wei
      * Setup key
     C                     Z-ADD#1AIC3    WQSB01           Company Number
     C                     MOVEL#1RXCD    WQSB02           Cutout Matrix C
     C                     Z-ADD#1GHDT    WQSB03           Effective Month
     C                     Z-ADD#1UPNB    WQSB04           Min Carcass Wei
     C                     Z-ADD#1UQNB    WQSB05           Max Carcass Wei
      * Establish starting position
     C           KRSSB     SETLL@IZRETC                    *
     C           KRSSB     READE@IZRETC                  90*
      * Data record not found
     C   90                MOVEL'USR1720' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Cpy Weight Range      RT - PS Cutout Item  * 
     C                     EXSR SCRVGN
      * Crt Distribution      CR - PS Cutout Dist Lean %  * 
     C                     EXSR SECRRC
     C           KRSSB     READE@IZRETC                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Cpy Weight Range      RT - PS Cutout Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSC01           Company Number
     C           *LIKE     DEFN WCRXCD    WQSC02           Cutout Matrix C
     C           *LIKE     DEFN WCGHDT    WQSC03           Effective Month
     C           *LIKE     DEFN WCUPNB    WQSC04           Min Carcass Wei
     C           *LIKE     DEFN WCUQNB    WQSC05           Max Carcass Wei
     C           *LIKE     DEFN WCULNB    WQSC06           Lean Percent
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Cutout Matrix C
     C                     KFLD           WQSC03           Effective Month
     C                     KFLD           WQSC04           Min Carcass Wei
     C                     KFLD           WQSC05           Max Carcass Wei
     C                     KFLD           WQSC06           Lean Percent
      * Setup key
     C                     Z-ADDWBAIC3    WQSC01           Company Number
     C                     MOVELWBRXCD    WQSC02           Cutout Matrix C
     C                     Z-ADDWBGHDT    WQSC03           Effective Month
     C                     Z-ADDWBUPNB    WQSC04           Min Carcass Wei
     C                     Z-ADDWBUQNB    WQSC05           Max Carcass Wei
     C                     Z-ADDWBULNB    WQSC06           Lean Percent
      * Establish starting position
     C           KRSSC     SETLL@I4RETX                    *
     C           KRSSC     READE@I4RETX                  90*
      * Data record not found
     C   90                MOVEL'USR1731' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Crt Cutout Item       CR - PS Cutout Item  * 
     C                     EXSR SDCRRC
     C           KRSSC     READE@I4RETX                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCRRC    BEGSR
      *================================================================
      * Crt Cutout Item       CR - PS Cutout Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @I4RETW
     C                     Z-ADDWCAIC3    WDAIC3           Company Number
     C                     MOVELWCRXCD    WDRXCD           Cutout Matrix C
     C                     Z-ADDWCGHDT    WDGHDT           Effective Month
     C                     Z-ADD#DFWRG    WDUPNB           Min Carcass Wei
     C                     Z-ADD#DV9NB    WDUQNB           Max Carcass Wei
     C                     Z-ADDWCULNB    WDULNB           Lean Percent
     C                     Z-ADDWCHGCD    WDHGCD           Item Code
     C                     Z-ADDWCUTNB    WDUTNB           Percent of Carc
     C                     MOVELWCXRCD    WDXRCD           Primal Group Co
     C                     MOVELWCUVST    WDUVST           EDI Status 1
     C                     MOVELWCUWST    WDUWST           EDI Status 2
     C                     MOVELWCUXST    WDUXST           EDI Status 3
     C                     MOVELWCVSST    WDVSST           Record Status
     C                     Z-ADDWCAATM    WDAATM           Job Time
     C                     MOVELWCAYNA    WDAYNA           User Id
     C                     MOVELWCA0NA    WDA0NA           Job Name
     C                     Z-ADDWCAXDT    WDAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WDVSST           Record Status
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##JOB     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
     C           KLCRSD    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDRXCD           Cutout Matrix C
     C                     KFLD           WDGHDT           Effective Month
     C                     KFLD           WDUPNB           Min Carcass Wei
     C                     KFLD           WDUQNB           Max Carcass Wei
     C                     KFLD           WDULNB           Lean Percent
     C                     KFLD           WDHGCD           Item Code
      * Check for duplicate primary key
     C           KLCRSD    SETLL@I4RETW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1732' W0RTN   7
      * Send message 'PS Cutout Item         EX'
     C                     MOVEL'USR1732' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C                     WRITE@I4RETW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECRRC    BEGSR
      *================================================================
      * Crt Distribution      CR - PS Cutout Dist Lean %  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @IZRETB
     C                     Z-ADDWBAIC3    WEAIC3           Company Number
     C                     MOVELWBRXCD    WERXCD           Cutout Matrix C
     C                     Z-ADDWBGHDT    WEGHDT           Effective Month
     C                     Z-ADD#DFWRG    WEUPNB           Min Carcass Wei
     C                     Z-ADD#DV9NB    WEUQNB           Max Carcass Wei
     C                     Z-ADDWBULNB    WEULNB           Lean Percent
     C                     Z-ADDWBUNNB    WEUNNB           Average Cold Wg
     C                     Z-ADDWBUONB    WEUONB           Population Perc
     C                     Z-ADDWBDIPC    WEDIPC           Average Lean Pe
     C                     Z-ADDWBZ0NB    WEZ0NB           Average Backfat
     C                     Z-ADDWBAVLE    WEAVLE           Average Loin-Ey
     C                     Z-ADDWBQPNX    WEQPNX           Population Head
     C                     MOVELWBUVST    WEUVST           EDI Status 1
     C                     MOVELWBUWST    WEUWST           EDI Status 2
     C                     MOVELWBUXST    WEUXST           EDI Status 3
     C                     MOVELWBVSST    WEVSST           Record Status
     C                     Z-ADDWBAATM    WEAATM           Job Time
     C                     MOVELWBAYNA    WEAYNA           User Id
     C                     MOVELWBA0NA    WEA0NA           Job Name
     C                     Z-ADDWBAXDT    WEAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WEVSST           Record Status
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##JOB     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
     C           KLCRSE    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WERXCD           Cutout Matrix C
     C                     KFLD           WEGHDT           Effective Month
     C                     KFLD           WEUPNB           Min Carcass Wei
     C                     KFLD           WEUQNB           Max Carcass Wei
     C                     KFLD           WEULNB           Lean Percent
      * Check for duplicate primary key
     C           KLCRSE    SETLL@IZRETB                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1721' W0RTN   7
      * Send message 'PS Cutout Dist Lean %  EX'
     C                     MOVEL'USR1721' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C                     WRITE@IZRETB                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Cpy Weight Range      RT - PS Cutout Dist Backfat  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSF01           Company Number
     C           *LIKE     DEFN WFRXCD    WQSF02           Cutout Matrix C
     C           *LIKE     DEFN WFGHDT    WQSF03           Effective Month
     C           *LIKE     DEFN WFUPNB    WQSF04           Min Carcass Wei
     C           *LIKE     DEFN WFUQNB    WQSF05           Max Carcass Wei
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Cutout Matrix C
     C                     KFLD           WQSF03           Effective Month
     C                     KFLD           WQSF04           Min Carcass Wei
     C                     KFLD           WQSF05           Max Carcass Wei
      * Setup key
     C                     Z-ADD#1AIC3    WQSF01           Company Number
     C                     MOVEL#1RXCD    WQSF02           Cutout Matrix C
     C                     Z-ADD#1GHDT    WQSF03           Effective Month
     C                     Z-ADD#1UPNB    WQSF04           Min Carcass Wei
     C                     Z-ADD#1UQNB    WQSF05           Max Carcass Wei
      * Establish starting position
     C           KRSSF     SETLL@J0RECH                    *
     C           KRSSF     READE@J0RECH                  90*
      * Data record not found
     C   90                MOVEL'USR2035' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WFUNNB' defaulted for 'Average Cold Wgt'.
      * Field '(DB1) WFUONB' defaulted for 'Population Percent'.
      * Field '(DB1) WFDIPC' defaulted for 'Average Lean Percent'.
      * Field '(DB1) WFZ0NB' defaulted for 'Average Backfat Inches'.
      * Field '(DB1) WFAVLE' defaulted for 'Average Loin-Eye Depth'.
      * Field '(DB1) WFQPNX' defaulted for 'Population Head'.
      * Crt Dist Backfat      CR - PS Cutout Dist Backfat  * 
     C                     EXSR SGCRRC
     C           KRSSF     READE@J0RECH                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCRRC    BEGSR
      *================================================================
      * Crt Dist Backfat      CR - PS Cutout Dist Backfat  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @J0RECG
     C                     Z-ADDWFAIC3    WGAIC3           Company Number
     C                     MOVELWFRXCD    WGRXCD           Cutout Matrix C
     C                     Z-ADDWFGHDT    WGGHDT           Effective Month
     C                     Z-ADD#DFWRG    WGUPNB           Min Carcass Wei
     C                     Z-ADD#DV9NB    WGUQNB           Max Carcass Wei
     C                     Z-ADDWFBFIN    WGBFIN           Backfat Inches
     C                     Z-ADDWFUNNB    WGUNNB           Average Cold Wg
     C                     Z-ADDWFUONB    WGUONB           Population Perc
     C                     Z-ADDWFDIPC    WGDIPC           Average Lean Pe
     C                     Z-ADDWFZ0NB    WGZ0NB           Average Backfat
     C                     Z-ADDWFAVLE    WGAVLE           Average Loin-Ey
     C                     Z-ADDWFQPNX    WGQPNX           Population Head
     C                     MOVELWFUVST    WGUVST           EDI Status 1
     C                     MOVELWFUWST    WGUWST           EDI Status 2
     C                     MOVELWFUXST    WGUXST           EDI Status 3
     C                     MOVELWFVSST    WGVSST           Record Status
     C                     Z-ADDWFAATM    WGAATM           Job Time
     C                     MOVELWFAYNA    WGAYNA           User Id
     C                     MOVELWFA0NA    WGA0NA           Job Name
     C                     Z-ADDWFAXDT    WGAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WGVSST           Record Status
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##JOB     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
     C           KLCRSG    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGRXCD           Cutout Matrix C
     C                     KFLD           WGGHDT           Effective Month
     C                     KFLD           WGUPNB           Min Carcass Wei
     C                     KFLD           WGUQNB           Max Carcass Wei
     C                     KFLD           WGBFIN           Backfat Inches
      * Check for duplicate primary key
     C           KLCRSG    SETLL@J0RECG                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2036' W0RTN   7
      * Send message 'PS Cutout Dist Backfat EX'
     C                     MOVEL'USR2036' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C                     WRITE@J0RECG                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Cpy Dist Loin-Eye     RT - PS Cutout Dist Loin-Eye  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHAIC3    WQSH01           Company Number
     C           *LIKE     DEFN WHRXCD    WQSH02           Cutout Matrix C
     C           *LIKE     DEFN WHGHDT    WQSH03           Effective Month
     C           *LIKE     DEFN WHUPNB    WQSH04           Min Carcass Wei
     C           *LIKE     DEFN WHUQNB    WQSH05           Max Carcass Wei
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WQSH02           Cutout Matrix C
     C                     KFLD           WQSH03           Effective Month
     C                     KFLD           WQSH04           Min Carcass Wei
     C                     KFLD           WQSH05           Max Carcass Wei
      * Setup key
     C                     Z-ADD#1AIC3    WQSH01           Company Number
     C                     MOVEL#1RXCD    WQSH02           Cutout Matrix C
     C                     Z-ADD#1GHDT    WQSH03           Effective Month
     C                     Z-ADD#1UPNB    WQSH04           Min Carcass Wei
     C                     Z-ADD#1UQNB    WQSH05           Max Carcass Wei
      * Establish starting position
     C           KRSSH     SETLL@J1RECK                    *
     C           KRSSH     READE@J1RECK                  90*
      * Data record not found
     C   90                MOVEL'USR2037' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Crt Dist Loin-Eye     CR - PS Cutout Dist Loin-Eye  * 
     C                     EXSR SICRRC
     C           KRSSH     READE@J1RECK                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICRRC    BEGSR
      *================================================================
      * Crt Dist Loin-Eye     CR - PS Cutout Dist Loin-Eye  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @J1RECJ
     C                     Z-ADDWHAIC3    WIAIC3           Company Number
     C                     MOVELWHRXCD    WIRXCD           Cutout Matrix C
     C                     Z-ADDWHGHDT    WIGHDT           Effective Month
     C                     Z-ADD#DFWRG    WIUPNB           Min Carcass Wei
     C                     Z-ADD#DV9NB    WIUQNB           Max Carcass Wei
     C                     Z-ADDWHLEDP    WILEDP           Loin-Eye Depth
     C                     MOVELWHUVST    WIUVST           EDI Status 1
     C                     MOVELWHUWST    WIUWST           EDI Status 2
     C                     MOVELWHUXST    WIUXST           EDI Status 3
     C                     MOVELWHVSST    WIVSST           Record Status
     C                     Z-ADDWHAATM    WIAATM           Job Time
     C                     MOVELWHAYNA    WIAYNA           User Id
     C                     MOVELWHA0NA    WIA0NA           Job Name
     C                     Z-ADDWHAXDT    WIAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WIVSST           Record Status
     C                     Z-ADD##JTM     WIAATM           Job Time
     C                     MOVEL##USR     WIAYNA           User Id
     C                     MOVEL##JOB     WIA0NA           Job Name
     C                     Z-ADD##JDT     WIAXDT           Job Date
     C           KLCRSI    KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIRXCD           Cutout Matrix C
     C                     KFLD           WIGHDT           Effective Month
     C                     KFLD           WIUPNB           Min Carcass Wei
     C                     KFLD           WIUQNB           Max Carcass Wei
     C                     KFLD           WILEDP           Loin-Eye Depth
      * Check for duplicate primary key
     C           KLCRSI    SETLL@J1RECJ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2038' W0RTN   7
      * Send message 'PS Cutout Dist Loin-Ey EX'
     C                     MOVEL'USR2038' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C                     WRITE@J1RECJ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Chk Weight Range Exist RT - PS Cutout Weight Range  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKRXCD           Cutout Matrix C
     C                     KFLD           WKGHDT           Effective Month
     C                     KFLD           WKUPNB           Min Carcass Wei
     C                     KFLD           WKUQNB           Max Carcass Wei
      * Setup key
     C                     Z-ADD#1AIC3    WKAIC3           Company Number
     C                     MOVEL#1RXCD    WKRXCD           Cutout Matrix C
     C                     Z-ADD#1GHDT    WKGHDT           Effective Month
     C                     Z-ADD#DFWRG    WKUPNB           Min Carcass Wei
     C                     Z-ADD#DV9NB    WKUQNB           Max Carcass Wei
      * Establish starting position
     C           KRSSJ     CHAIN@I1RES6              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1724' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Cooler Shrink %   RT - Company Defaults  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WLAIC3           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WLAIC3           Company Number
      * Establish starting position
     C           KRSSK     CHAIN@AQREB9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0041' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     P2DGPC           Cooler Shrink P
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWLDGPC    P2DGPC           Cooler Shrink P
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Calculate Min/Max Live Weight
      *================================================================
      * minimum live weight
      *
     C                     Z-ADD*ZERO     WN0001  95       Hot Weight Divi
     C                     Z-ADD*ZERO     WN0002  95       Hot Weight Subt
     C                     Z-ADD*ZERO     WN0003  95       Hot Weight Mult
     C                     Z-ADD*ZERO     WN0004  95       Hot Weight Addi
     C                     Z-ADD*ZERO     WN0005 112       USR Weight
      *
      * Clc Live Weight       IF
      * Rtv Live Wgt Calc Flds XF - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'PKOPXFR'              90  Rtv Live Wgt Ca
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0001  30       Company Number
     C           WN0001    PARM *ZERO     WQ0002  95       Hot Weight Divi
     C           WN0002    PARM *ZERO     WQ0003  95       Hot Weight Subt
     C           WN0003    PARM *ZERO     WQ0004  95       Hot Weight Mult
     C           WN0004    PARM *ZERO     WQ0005  95       Hot Weight Addi
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKOPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Live weight
      * CASE: PAR.Hot Weight Divisor NE WRK.ZERO
     C           WN0001    IFNE WUW0NB                     *IF
      * Calc Yield
      * PGM.*Synon (17,5) work field =
      *    *COMPUTE (((((x1 / x2) - x3) * x4) + x5))
      * x1    : PAR.Hot Weight Total
      * /     : PGM.*Synon (17,7) work field *
      * x2    : PAR.Hot Weight Divisor
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.Hot Weight Subtractor
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Hot Weight Multiplier
      * +     : PGM.*Synon (17,7) work field
      * x5    : PAR.Hot Weight Addition
     C           #DFWRG    DIV  WN0001    W0WD03           *Synon (17,7) w
     C           W0WD03    SUB  WN0002    W0WD02           *Synon (17,7) w
     C           W0WD02    MULT WN0003    W0WD01           *Synon (17,7) w
     C           W0WD01    ADD  WN0004    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    W0WC             *Synon (17,5) w
      * Live Weight
      * CASE: PGM.*Synon (17,5) work field NE WRK.ZERO
     C           W0WC      IFNE WUW0NB                     *IF
     C           #DFWRG    DIV  W0WC      WN0005    H      USR Weight
     C                     Z-ADDWN0005    WUNFNN           Live Weight Tot
     C           WN0005    MULT 1         #1VSNB    H      Live Weight 5.0
     C           WN0005    MULT 1         WUNFNN    H      Live Weight 11.
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUNFNN           Live Weight Tot
     C                     Z-ADD*ZERO     #1VSNB           Live Weight 5.0
     C                     Z-ADD*ZERO     WUNFNN           Live Weight 11.
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     W0WC             *Synon (17,5) w
     C                     Z-ADD*ZERO     WUNFNN           Live Weight Tot
     C                     Z-ADD*ZERO     #1VSNB           Live Weight 5.0
     C                     Z-ADD*ZERO     WUNFNN           Live Weight 11.
     C                     END                             *FI
      * maximum live weight
      *
     C                     Z-ADD*ZERO     WN0006  95       Hot Weight Divi
     C                     Z-ADD*ZERO     WN0007  95       Hot Weight Subt
     C                     Z-ADD*ZERO     WN0008  95       Hot Weight Mult
     C                     Z-ADD*ZERO     WN0009  95       Hot Weight Addi
     C                     Z-ADD*ZERO     WN0010 112       USR Weight
      *
      * Clc Live Weight       IF
      * Rtv Live Wgt Calc Flds XF - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'PKOPXFR'              90  Rtv Live Wgt Ca
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0006  30       Company Number
     C           WN0006    PARM *ZERO     WQ0007  95       Hot Weight Divi
     C           WN0007    PARM *ZERO     WQ0008  95       Hot Weight Subt
     C           WN0008    PARM *ZERO     WQ0009  95       Hot Weight Mult
     C           WN0009    PARM *ZERO     WQ0010  95       Hot Weight Addi
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKOPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Live weight
      * CASE: PAR.Hot Weight Divisor NE WRK.ZERO
     C           WN0006    IFNE WUW0NB                     *IF
      * Calc Yield
      * PGM.*Synon (17,5) work field =
      *    *COMPUTE (((((x1 / x2) - x3) * x4) + x5))
      * x1    : PAR.Hot Weight Total
      * /     : PGM.*Synon (17,7) work field *
      * x2    : PAR.Hot Weight Divisor
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.Hot Weight Subtractor
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.Hot Weight Multiplier
      * +     : PGM.*Synon (17,7) work field
      * x5    : PAR.Hot Weight Addition
     C           #DV9NB    DIV  WN0006    W0WD03           *Synon (17,7) w
     C           W0WD03    SUB  WN0007    W0WD02           *Synon (17,7) w
     C           W0WD02    MULT WN0008    W0WD01           *Synon (17,7) w
     C           W0WD01    ADD  WN0009    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    W0WC             *Synon (17,5) w
      * Live Weight
      * CASE: PGM.*Synon (17,5) work field NE WRK.ZERO
     C           W0WC      IFNE WUW0NB                     *IF
     C           #DV9NB    DIV  W0WC      WN0010    H      USR Weight
     C                     Z-ADDWN0010    WUNFNN           Live Weight Tot
     C           WN0010    MULT 1         #1VVNB    H      Live Weight 5.0
     C           WN0010    MULT 1         WUNFNN    H      Live Weight 11.
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUNFNN           Live Weight Tot
     C                     Z-ADD*ZERO     #1VVNB           Live Weight 5.0
     C                     Z-ADD*ZERO     WUNFNN           Live Weight 11.
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     W0WC             *Synon (17,5) w
     C                     Z-ADD*ZERO     WUNFNN           Live Weight Tot
     C                     Z-ADD*ZERO     #1VVNB           Live Weight 5.0
     C                     Z-ADD*ZERO     WUNFNN           Live Weight 11.
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Check reference to PS Cutout Matrix
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C                     MOVEL#1RXCD    WK1X02  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     C           WK1X02    OREQ '?'                        Cutout Matrix C
     C           YPMTFD    OREQ '#1RXCD'
     C           YPMTFD    OREQ '#1GHDT'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1RXCD' defaulted for 'Cutout Matrix Code'.
      * Field '(DTL) #1GHDT' defaulted for 'Effective Month/Day'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #PMXNA' defaulted for 'Cutout Matrix Desc'.
     C                     CALL 'PDAZSRR'              90  Sel Cutout Mtx
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0011  30       Company Number
     C           #1RXCD    PARM #1RXCD    WQ0012  6        Cutout Matrix C
     C           #1GHDT    PARM #1GHDT    WQ0013  40       Effective Month
     C           #PMXNA    PARM *BLANK    WQ0014 30        Cutout Matrix D
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDAZSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1RXCD    IFNE *BLANK                     Cutout Matrix C
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1GHDT    IFNE *ZERO                      Effective Month
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VAEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AIC3    IFEQ *ZERO                      Company Number
     C           #1RXCD    ANDEQ*BLANK                     Cutout Matrix C
     C           #1GHDT    ANDEQ*ZERO                      Effective Month
     C                     GOTO VAEXIT
     C                     END
      *
     C           KLVAWJ    KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJRXCD           Cutout Matrix C
     C                     KFLD           WJGHDT           Effective Month
      * Setup key
     C                     Z-ADD#1AIC3    WJAIC3
     C                     MOVEL#1RXCD    WJRXCD
     C                     Z-ADD#1GHDT    WJGHDT
     C           KLVAWJ    CHAIN@I0RES3              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VAEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VAEXIT
     C                     END
      * Send message 'PS Cutout Matrix       NF'
     C                     MOVEL'USR1722' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1722' W0RTN
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         YKDDW1    BEGSR
      *================================================================
      * Calculate window location for drop down lists on screen 1
      *================================================================
      *================================================================
     CSR         YKEXT1    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ##WSR     MULT 256       ZWORK   50
     C                     ADD  ##WSC     ZWORK
     C                     SUB  ZWORK     ZINPOS
     C                     SUB  1         ZINPOS
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C           @#WWRC    DIV  256       ZZCSRW  30       Row
     C                     MVR            ZZCSCL  30       Column
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C           @#WWRC    DIV  256       ZZCSRW  30       Row
     C                     MVR            ZZCSCL  30       Column
      *
     C           ZHCSRW    SUB  ##WSR     YWPORW  30
     C           ZHCSCL    SUB  ##WSC     YWPOC1  30
     C                     SUB  1         YWPOC1
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM 'PDB1PVRH'W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM YWPORW    YYRW    50       Row
     C                     PARM YWPOC1    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZRRPWD    BEGSR
      *================================================================
      * *Reposition window
      *================================================================
     C                     MOVEL'Y'       YSL,1            Set wdw locatio
     C                     MOVEL'R'       YWLCTP  1        Locate action t
     C                     EXSR ZSSTLC                     Set window loca
      *
      * Redisplay previous panel
     C                     WRITEASSUME
      *================================================================
     CSR         ZREXIT    ENDSR
      /EJECT
     CSR         ZSSTLC    BEGSR
      *================================================================
      * Set window location
      *================================================================
     C           YSL,1     IFEQ 'Y'                        Set wdw locatio
     C                     MOVEL'*CALC'   YWWDCR           Window referenc
     C                     Z-ADD-3        YWWDRW           Window start ro
     C                     Z-ADD-3        YWWDCL           Window start co
     C                     Z-ADD064       YWWDWD           Window width
     C                     Z-ADD018       YWWDDP           Window depth
     C                     MOVEL'N'       YSL,1            Set wdw locatio
      *
     C                     EXSR ZURTLC                     Retrieve window
     C                     EXSR ZTWDFD                     Move window fie
     C                     END
      *================================================================
     CSR         ZSEXIT    ENDSR
      /EJECT
     CSR         ZTWDFD    BEGSR
      *================================================================
      * Move window fields by panel
      *================================================================
     C                     Z-ADDYWWDRW    ##WSR            Window start ro
     C                     Z-ADDYWWDCL    ##WSC            Window start co
     C                     EXSR YKDDW1
      *================================================================
     CSR         ZTEXIT    ENDSR
      /EJECT
     CSR         ZURTLC    BEGSR
      *================================================================
      * Retrieve window location
      *================================================================
      *
      * Set up parameters to API
      *
      * Return code
     C                     MOVEL*BLANKS   W0RTN
      * Retrieval Function
     C                     MOVEL*BLANKS   YWRTFN
     C                     MOVEL'*WDWLOC' YWRTFN
      *
     C                     SETOF                       90  *
      *
     C                     CALL 'YWRTLCI'              90  *
     C                     PARM           YWRTFN 10        Retrieval Funct
     C                     PARM           YWWDWD  30       Window width
     C                     PARM           YWWDDP  30       Window depth
     C                     PARM           YWWDCR  5        Window referenc
     C                     PARM           YWWDRW  30       *Window start r
     C                     PARM           YWWDCL  30       *Window start c
     C                     PARM           W0RTN            Return code
      * If error on call to API - default window location to top left cor
     C           *IN90     IFEQ '1'
     C           W0RTN     ORNE *BLANKS
     C                     Z-ADD2         YWWDRW           *Window start r
     C                     Z-ADD2         YWWDCL           *Window start c
     C                     END
      *
      *================================================================
     CSR         ZUEXIT    ENDSR
      /EJECT
     CSR         ZVCFPM    BEGSR
      *================================================================
      * Set Confirm Prompt window location
      *================================================================
      *
     C           ##WSR     ADD  018       YWWDRW
     C           ##WSC     ADD  064       YWWDCL
      *
     C                     ADD  1         YWWDCL
     C                     SUB  1         YWWDRW           Window start ro
     C                     SUB  21        YWWDCL           Window start co
     C                     Z-ADD18        YWWDWD           Window width
     C                     Z-ADD2         YWWDDP           Window depth
     C                     MOVEL'*TL  '   YWWDCR           Window referenc
     C                     MOVEL*BLANKS   YWRTFN
     C                     MOVEL'*WDWLOC' YWRTFN           Retrieval Funct
     C                     EXSR ZURTLC                     Retrieve window
     C                     Z-ADDYWWDRW    ##WSRC           *Window start r
     C                     Z-ADDYWWDCL    ##WSCC           *Window start c
      *
      *================================================================
     CSR         ZVEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P2DGPC           Cooler Shrink P
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialise Allow Set Window Location flags
     C                     MOVEA*ALL'Y'   YSL
      * Set display size
     C                     SETOF                         93*
     C           @#SCRW    COMP 27                       93*
      * Initialise window location variables.
     C                     Z-ADD*ZEROS    ##WSR
     C                     Z-ADD*ZEROS    ##WSC
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAGHDT           Effective Month
     C                     Z-ADD*ZERO     WAUPNB           Min Carcass Wei
     C                     Z-ADD*ZERO     WAUQNB           Max Carcass Wei
     C                     Z-ADD*ZERO     WAVSNB           Min Live Weight
     C                     Z-ADD*ZERO     WAVVNB           Max Live Weight
     C                     Z-ADD*ZERO     WADGPC           Cooler Shrink P
     C                     Z-ADD*ZERO     WAV0NB           Std Dressing Yi
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBGHDT           Effective Month
     C                     Z-ADD*ZERO     WBUPNB           Min Carcass Wei
     C                     Z-ADD*ZERO     WBUQNB           Max Carcass Wei
     C                     Z-ADD*ZERO     WBULNB           Lean Percent
     C                     Z-ADD*ZERO     WBUNNB           Average Cold Wg
     C                     Z-ADD*ZERO     WBUONB           Population Perc
     C                     Z-ADD*ZERO     WBDIPC           Average Lean Pe
     C                     Z-ADD*ZERO     WBZ0NB           Average Backfat
     C                     Z-ADD*ZERO     WBAVLE           Average Loin-Ey
     C                     Z-ADD*ZERO     WBQPNX           Population Head
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCGHDT           Effective Month
     C                     Z-ADD*ZERO     WCUPNB           Min Carcass Wei
     C                     Z-ADD*ZERO     WCUQNB           Max Carcass Wei
     C                     Z-ADD*ZERO     WCULNB           Lean Percent
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCUTNB           Percent of Carc
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFGHDT           Effective Month
     C                     Z-ADD*ZERO     WFUPNB           Min Carcass Wei
     C                     Z-ADD*ZERO     WFUQNB           Max Carcass Wei
     C                     Z-ADD*ZERO     WFBFIN           Backfat Inches
     C                     Z-ADD*ZERO     WFUNNB           Average Cold Wg
     C                     Z-ADD*ZERO     WFUONB           Population Perc
     C                     Z-ADD*ZERO     WFDIPC           Average Lean Pe
     C                     Z-ADD*ZERO     WFZ0NB           Average Backfat
     C                     Z-ADD*ZERO     WFAVLE           Average Loin-Ey
     C                     Z-ADD*ZERO     WFQPNX           Population Head
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHGHDT           Effective Month
     C                     Z-ADD*ZERO     WHUPNB           Min Carcass Wei
     C                     Z-ADD*ZERO     WHUQNB           Max Carcass Wei
     C                     Z-ADD*ZERO     WHLEDP           Loin-Eye Depth
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJGHDT           Effective Month
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Define work field USR Percent Work, 7.4
     C                     Z-ADD*ZERO     WUBHPC  74
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLAIC3           Company Number
     C                     Z-ADD*ZERO     WLASVA           Credit Limit
     C                     Z-ADD*ZERO     WLDGPC           Cooler Shrink P
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WD03 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WC   175       *Synon (17,5) w
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * Rtv Cooler Shrink %   RT - Company Defaults  * 
     C                     EXSR SKRVGN
      * Load screen
     C                     EXSR MALDSC
      *================================================================
     CSR         ZZEXIT    ENDSR
