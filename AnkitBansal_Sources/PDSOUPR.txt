/*********************************************************************/
/*     Program: PDSOUPR                                              */
/*       TITLE: PRINT NIGHTLY CREDIT CHECK AUDIT REPORT */
/*        Date: 09/16/03                                             */
/* Description: -                                                    */
/*********************************************************************/
/* Modifications:                                                    */
/*                                                                   */
/*   Date     Pgmr     Description                                   */
/* -------- ---------- --------------------------------------------  */
/*  01/29/04  RMC      PRINT ON PRKPRT02 INSTEAD OF PRKPRT04         */
/*  07/11/2006 LJB     CALL A PROGRAM TO RETRIEVE THE OUTQ INSTEAD   */
/*                     OF HARD CODING IT.                            */
/*  JRB DLY029 06/01/07 Call PMD4XFR to set the default Company      */
/*  06/28/2017 LJB     CHANGE HOLD TO *YES AND HOLD THE REPORT       */
/*********************************************************************/
             PGM        PARM(&NGHTST)

        DCL    &RETURN     *CHAR   (7)           /* Return Code               */
        DCL    &COMPA      *CHAR   (3)           /* Company Alpha             */
        DCL    &PGM        *CHAR   (10)          /* CL to Submit              */
        DCL    &COPY       *DEC    (2 0) VALUE(1)  /* No. Copies              */
        DCL    &OUTQ       *CHAR   (10)          /* Output Queue              */
        DCL    VAR(&HOLD) TYPE(*CHAR) LEN(4) VALUE(*YES) /* +
                          Hold Status               */
        DCL    VAR(&SAVE) TYPE(*CHAR) LEN(4) VALUE(*YES) /* +
                          Save Status               */
        DCL    VAR(&COMP) TYPE(*DEC) LEN(3 0) /* To +
                          retrieve the A/R output queue */
        DCL    VAR(&COVALCODE) TYPE(*CHAR) LEN(10) /* Code +
                          value that points to the outq */
        DCL    &NQSTAT     *CHAR   (01)          /* If MUST run in Night Q    */
        DCL    &NIGHTQ     *CHAR   (10)          /* Night Job Queue           */
        DCL    &ERROR      *CHAR   (7) VALUE(' ')
        DCL    &NGHTST     *CHAR   (1)          /* NightLY JOB RUN 9/16/03  */
        DCL    &COMMAND    *CHAR   (512) /* +
                          Command for Create Printer File Override */
             IF         COND(&NGHTST = 'N') THEN(CHGVAR VAR(&HOLD) +
                          VALUE(*YES))
             IF         COND(&NGHTST = 'N') THEN(CHGVAR VAR(&SAVE) +
                          VALUE(*NO))

/* CHANGE OUTQ TO A VARIABLE AND GET THE OUTQ FROM THE COMPANY       */
/* VALUES FILE     07/11/2006 LJB A060706A                           */
             CALL       PGM(PMD4XFR) PARM('' &COMPA)
             CHGVAR     VAR(&COMP) VALUE(&COMPA)
             CHGVAR     VAR(&COVALCODE) VALUE('DFTARAGE')

             CALL       PGM(POMTXFR) PARM(' ' &COMP &COVALCODE &OUTQ)

             SBDPRTOVR  CMDVAR(&COMMAND) FILE(PDSNPFR$) OUTQ(&OUTQ) +
                          LANDSCAPE(*PRTF) COPIES(&COPY) +
                          HOLD(&HOLD) SAVE(&SAVE)

             CALL       PGM(QCMDEXC) PARM(&COMMAND 512)

/* CREATE AVAILABLE TO POST AND PRINT REPORT                         */

             CALL       PGM(PDSNPFR) PARM(' ' &NGHTST)

             DLTOVR     FILE(*ALL)
             CLRPFM     FILE(PDK9REP)
     /*      MONMSG     MSGID(CPF9999)   */
     /*      MONMSG     MSGID(CPF3130)   */

             ENDPGM
