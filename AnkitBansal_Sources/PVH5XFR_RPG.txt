     H/TITLE Cnv Fix Detail Line StsXF Execute external functio
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) BNDDIR(YBNDDIR) DBGVIEW(*SOURCE)
     Z* CVTOPT(*DATETIME) ACTGRP(*CALLER) OPTIMIZE(*BASIC)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Execute external function
     H* Object type   : *PGM
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 10/30/24  Time  : 16:33:50
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOPBGWKL1  IF   E           K DISK
      * RTV : Order Detail              Retrieval index
      *
     FOPBFCPL1  IF   E           K DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOPBGWKL0  UF   E           K DISK
      * UPD : Order Detail              Update index
      *
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
     D QOPBG1        E DS                  EXTNAME(OPBGWKL0)
      * UPD : Order Detail              Update index
      * Renamed input format fields
     D  WCAIC3       E                     EXTFLD(OMAIC3)
     D  WCC4NB       E                     EXTFLD(OMC4NB)
     D  WCDPNB       E                     EXTFLD(OMDPNB)
     D  WCUENB       E                     EXTFLD(OMUENB)
     D  WCHGCD       E                     EXTFLD(OMHGCD)
     D  WCAJCD       E                     EXTFLD(OMAJCD)
     D  WCBKC7       E                     EXTFLD(OMBKC7)
     D  WCCFC7       E                     EXTFLD(OMCFC7)
     D  WCGMST       E                     EXTFLD(OMGMST)
     D  WCGNST       E                     EXTFLD(OMGNST)
     D  WCMAVA       E                     EXTFLD(OMMAVA)
     D  WCKDVA       E                     EXTFLD(OMKDVA)
     D  WCL8VA       E                     EXTFLD(OML8VA)
     D  WCL9VA       E                     EXTFLD(OML9VA)
     D  WCGTST       E                     EXTFLD(OMGTST)
     D  WCGVST       E                     EXTFLD(OMGVST)
     D  WCGUST       E                     EXTFLD(OMGUST)
     D  WCQFST       E                     EXTFLD(OMQFST)
     D  WCAYVA       E                     EXTFLD(OMAYVA)
     D  WCEXDT       E                     EXTFLD(OMEXDT)
     D  WCLQCD       E                     EXTFLD(OMLQCD)
     D  WCRDCD       E                     EXTFLD(OMRDCD)
     D  WCQ7CD       E                     EXTFLD(OMQ7CD)
     D  WCBZPR       E                     EXTFLD(OMBZPR)
     D  WCL6NB       E                     EXTFLD(OML6NB)
     D  WCU1ST       E                     EXTFLD(OMU1ST)
     D  WCGIDT       E                     EXTFLD(OMGIDT)
     D  WCCRCD       E                     EXTFLD(OMCRCD)
     D  WCAGCD       E                     EXTFLD(OMAGCD)
     D  WCRZST       E                     EXTFLD(OMRZST)
     D  WCR0ST       E                     EXTFLD(OMR0ST)
     D  WCR1ST       E                     EXTFLD(OMR1ST)
     D  WCG7NA       E                     EXTFLD(OMG7NA)
     D  WCG8NA       E                     EXTFLD(OMG8NA)
     D  WCRPCD       E                     EXTFLD(OMRPCD)
     D  WCVEST       E                     EXTFLD(OMVEST)
     D  WCVGST       E                     EXTFLD(OMVGST)
     D  WCAVST       E                     EXTFLD(OMAVST)
     D  WCU0ST       E                     EXTFLD(OMU0ST)
     D  WCRFCD       E                     EXTFLD(OMRFCD)
     D  WCFZST       E                     EXTFLD(OMFZST)
     D  WCR1NB       E                     EXTFLD(OMR1NB)
     D  WCAVQT       E                     EXTFLD(OMAVQT)
     D  WCD0WG       E                     EXTFLD(OMD0WG)
     D  WCCCQT       E                     EXTFLD(OMCCQT)
     D  WCAUWG       E                     EXTFLD(OMAUWG)
     D  WCCBQT       E                     EXTFLD(OMCBQT)
     D  WCATWG       E                     EXTFLD(OMATWG)
     D  WCAQCS       E                     EXTFLD(OMAQCS)
     D  WCAGCS       E                     EXTFLD(OMAGCS)
     D  WCAKPR       E                     EXTFLD(OMAKPR)
     D  WCALPR       E                     EXTFLD(OMALPR)
     D  WCAUPR       E                     EXTFLD(OMAUPR)
     D  WCAVWG       E                     EXTFLD(OMAVWG)
     D  WCA4WG       E                     EXTFLD(OMA4WG)
     D  WCA5DT       E                     EXTFLD(OMA5DT)
     D  WCAODT       E                     EXTFLD(OMAODT)
     D  WCGNDT       E                     EXTFLD(OMGNDT)
     D  WCAMST       E                     EXTFLD(OMAMST)
     D  WCANST       E                     EXTFLD(OMANST)
     D  WCVAST       E                     EXTFLD(OMVAST)
     D  WCRGNB       E                     EXTFLD(OMRGNB)
     D  WCRHNB       E                     EXTFLD(OMRHNB)
     D  WCRINB       E                     EXTFLD(OMRINB)
     D  WCRBCD       E                     EXTFLD(OMRBCD)
     D  WCHICD       E                     EXTFLD(OMHICD)
     D  WCRNCD       E                     EXTFLD(OMRNCD)
     D  WCROCD       E                     EXTFLD(OMROCD)
     D  WCCXDT       E                     EXTFLD(OMCXDT)
     D  WCAJVN       E                     EXTFLD(OMAJVN)
     D  WCKXCD       E                     EXTFLD(OMKXCD)
     D  WCJPCD       E                     EXTFLD(OMJPCD)
     D  WCCQCD       E                     EXTFLD(OMCQCD)
     D  WCR4CD       E                     EXTFLD(OMR4CD)
     D  WCZ1ST       E                     EXTFLD(OMZ1ST)
     D  WCZ3ST       E                     EXTFLD(OMZ3ST)
     D  WCZ4ST       E                     EXTFLD(OMZ4ST)
     D  WCDUPR       E                     EXTFLD(OMDUPR)
     D  WCB6VL       E                     EXTFLD(OMB6VL)
     D  WCA1AA       E                     EXTFLD(OMA1AA)
     D  WCFZSX       E                     EXTFLD(OMFZSX)
     D  WCF0SX       E                     EXTFLD(OMF0SX)
     D  WCF1SX       E                     EXTFLD(OMF1SX)
     D  WCF2SX       E                     EXTFLD(OMF2SX)
     D  WCF3SX       E                     EXTFLD(OMF3SX)
     D  WCF4SX       E                     EXTFLD(OMF4SX)
     D  WCF5SX       E                     EXTFLD(OMF5SX)
     D  WCF6SX       E                     EXTFLD(OMF6SX)
     D  WCF7SX       E                     EXTFLD(OMF7SX)
     D  WCNTDT       E                     EXTFLD(OMNTDT)
     D  WCNUDT       E                     EXTFLD(OMNUDT)
     D  WCNVDT       E                     EXTFLD(OMNVDT)
     D  WCNWDT       E                     EXTFLD(OMNWDT)
     D  WCNXDT       E                     EXTFLD(OMNXDT)
     D  WCBUTM       E                     EXTFLD(OMBUTM)
     D  WCBVTM       E                     EXTFLD(OMBVTM)
     D  WCBWTM       E                     EXTFLD(OMBWTM)
     D  WCBXTM       E                     EXTFLD(OMBXTM)
     D  WCBYTM       E                     EXTFLD(OMBYTM)
     D  WCH5NX       E                     EXTFLD(OMH5NX)
     D  WCH6NX       E                     EXTFLD(OMH6NX)
     D  WCH7NX       E                     EXTFLD(OMH7NX)
     D  WCH8NX       E                     EXTFLD(OMH8NX)
     D  WCH9NX       E                     EXTFLD(OMH9NX)
     D  WCDVPR       E                     EXTFLD(OMDVPR)
     D  WCDWPR       E                     EXTFLD(OMDWPR)
     D  WCDXPR       E                     EXTFLD(OMDXPR)
     D  WCDYPR       E                     EXTFLD(OMDYPR)
     D  WCDZPR       E                     EXTFLD(OMDZPR)
     D  WCGSPR       E                     EXTFLD(OMGSPR)
     D  WCGTPR       E                     EXTFLD(OMGTPR)
     D  WCGUPR       E                     EXTFLD(OMGUPR)
     D  WCHOST       E                     EXTFLD(OMHOST)
     D  WCHPST       E                     EXTFLD(OMHPST)
     D  WCIOST       E                     EXTFLD(OMIOST)
     D  WCPEWG       E                     EXTFLD(OMPEWG)
     D  WCRINY       E                     EXTFLD(OMRINY)
     D  WCTIDT       E                     EXTFLD(OMTIDT)
     D  WCTJDT       E                     EXTFLD(OMTJDT)
     D  WCH2ST       E                     EXTFLD(OMH2ST)
     D  WCH0ST       E                     EXTFLD(OMH0ST)
     D  WCH1ST       E                     EXTFLD(OMH1ST)
     D  WCTKDT       E                     EXTFLD(OMTKDT)
     D  WCTLDT       E                     EXTFLD(OMTLDT)
     D  WCTMDT       E                     EXTFLD(OMTMDT)
     D  WCUVST       E                     EXTFLD(OMUVST)
     D  WCUWST       E                     EXTFLD(OMUWST)
     D  WCUXST       E                     EXTFLD(OMUXST)
     D  WCAATM       E                     EXTFLD(OMAATM)
     D  WCAYNA       E                     EXTFLD(OMAYNA)
     D  WCA0NA       E                     EXTFLD(OMA0NA)
     D  WCAXDT       E                     EXTFLD(OMAXDT)
      *
     D YARDCS          DS           525
      * Message data for message Y2U0009.
     D MD0009          DS
     D  MDPGM                  1     10
     D  MDACP                 11     20
     D  MDFMT                 21     30
     D  MDACT                 31     34
     D  MDLBL                 35     40
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  YL0001         S              1
     D  WUX1U1         S              1
     D  YL0002         S              1
     D  WL0001         S              3  0
     D  WL0002         S              7  0
     D  WL0003         S              1
     D  WL0004         S              3  0
     D  WL0005         S              7  0
     D  WL0006         S              3  0
     D  WL0007         S              3  0
     D  WL0008         S              1
     D  WL0009         S              1
     D  WN0001         S              7  0
     D  WN0002         S              3
     D  WN0003         S              7  0
     D  WN0004         S              7  0
     D  WN0005         S              1
     D  WN0006         S             11  2
     D  WN0007         S             11  2
     D  WN0008         S             11  2
     D  WN0009         S             11  2
     D  WN0010         S              1
     D  WN0011         S              1
     D  WN0012         S              1
     D  WN0013         S              1
     D  WN0014         S             11  2
     D  WN0015         S              7  0
     D  WN0016         S              3
     D  WN0017         S              3
     D  WN0018         S              3
     D  WN0019         S             11  4
     D  WN0020         S              7  0
     D  WN0021         S              1
     D  WN0022         S              7  0
     D  WN0023         S              2
     D  WN0024         S              2
     D  WN0025         S              1
     D  WN0026         S              1
     D  WN0027         S             30
     D  WN0028         S             30
     D  WN0029         S              1
     D  WN0030         S              1
     D  WN0031         S              1
     D  WN0032         S              1
     D  WN0033         S              1
     D  WN0034         S              3
     D  WN0035         S              1
     D  WN0036         S             11  2
     D  WN0037         S             11  2
     D  WN0038         S             11  2
     D  WN0039         S             11  2
     D  WN0040         S             11  2
     D  WN0041         S             11  2
     D  WN0042         S             11  2
     D  WN0043         S             11  4
     D  WN0044         S             11  4
     D  WN0045         S             11  4
     D  WN0046         S             11  4
     D  WN0047         S             11  4
     D  WN0048         S             11  2
     D  WN0049         S             11  2
     D  WN0050         S              7  0
     D  WN0051         S              7  0
     D  WN0052         S              7  0
     D  WN0053         S              1
     D  WN0054         S              1
     D  WN0055         S              1
     D  WN0056         S              3  0
     D  WN0057         S              3  0
     D  WN0058         S              3  0
     D  WN0059         S              2
     D  WN0060         S              2
     D  WN0061         S              2
     D  WN0062         S              2
     D  WN0063         S              7  0
     D  WN0064         S             10
     D  WN0065         S              6
     D  WN0066         S              2
     D  WN0067         S              3
     D  WN0068         S              3
     D  WN0069         S              1
     D  WN0070         S              1
     D  WN0071         S              1
     D  WN0072         S             11  4
     D  WN0073         S             11  2
     D  WN0074         S              3  0
     D  WN0075         S              1
     D  WN0076         S              1
     D  WN0077         S              1
     D  WN0078         S              1
     D  WN0079         S              1
     D  WN0080         S              2
     D  WN0081         S              2
     D  WN0082         S              3
     D  WN0083         S              3
     D  WN0084         S              7  0
     D  WN0085         S              7  0
     D  WN0086         S              7  0
     D  WN0087         S              7  0
     D  WN0088         S              7  0
     D  WN0089         S              6  0
     D  WN0090         S              6  0
     D  WN0091         S              6  0
     D  WN0092         S              6  0
     D  WN0093         S              6  0
     D  WN0094         S             11  2
     D  WN0095         S             11  2
     D  WN0096         S             11  2
     D  WN0097         S             11  2
     D  WN0098         S             11  2
     D  WN0099         S             11  4
     D  WN0100         S             11  4
     D  WN0101         S             11  4
     D  WN0102         S             11  4
     D  WN0103         S             11  4
     D  WN0104         S             11  4
     D  WN0105         S             11  4
     D  WN0106         S             11  4
     D  WN0107         S              1
     D  WN0108         S              1
     D  WN0109         S              1
     D  WN0110         S             11  2
     D  WN0111         S              4  0
     D  WN0112         S              7  0
     D  WN0113         S              7  0
     D  WN0114         S              1
     D  WN0115         S              2
     D  WN0116         S              3
     D  WN0117         S              7  0
     D  WN0118         S              7  0
     D  WN0119         S              7  0
     D  WN0120         S              1
     D  WN0121         S              1
     D  WN0122         S              1
     D  WN0123         S              6  0
     D  WN0124         S             10
     D  WN0125         S             10
     D  WN0126         S              7  0
     D  YARDC          S              1
     D  ZAPGMQ         S             10
     D  ZAPGRL         S              5
     D  ZAMSID         S              7
     D  ZAMSGF         S             10
     D  ZAMSTP         S              7
     D  YILE           S              1
     D  W0PMT          S              1
     D                 DS
     D  ZAMSDA                 1    132
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                      WAAIC3
     I              OMC4NB                      WAC4NB
     I              OMDPNB                      WADPNB
     I              OMUENB                      WAUENB
     I              OMHGCD                      WAHGCD
     I              OMAJCD                      WAAJCD
     I              OMBKC7                      WABKC7
     I              OMCFC7                      WACFC7
     I              OMGMST                      WAGMST
     I              OMGNST                      WAGNST
     I              OMMAVA                      WAMAVA
     I              OMKDVA                      WAKDVA
     I              OML8VA                      WAL8VA
     I              OML9VA                      WAL9VA
     I              OMGTST                      WAGTST
     I              OMGVST                      WAGVST
     I              OMGUST                      WAGUST
     I              OMQFST                      WAQFST
     I              OMAYVA                      WAAYVA
     I              OMEXDT                      WAEXDT
     I              OMLQCD                      WALQCD
     I              OMRDCD                      WARDCD
     I              OMQ7CD                      WAQ7CD
     I              OMBZPR                      WABZPR
     I              OML6NB                      WAL6NB
     I              OMU1ST                      WAU1ST
     I              OMGIDT                      WAGIDT
     I              OMCRCD                      WACRCD
     I              OMAGCD                      WAAGCD
     I              OMRZST                      WARZST
     I              OMR0ST                      WAR0ST
     I              OMR1ST                      WAR1ST
     I              OMG7NA                      WAG7NA
     I              OMG8NA                      WAG8NA
     I              OMRPCD                      WARPCD
     I              OMVEST                      WAVEST
     I              OMVGST                      WAVGST
     I              OMAVST                      WAAVST
     I              OMU0ST                      WAU0ST
     I              OMRFCD                      WARFCD
     I              OMFZST                      WAFZST
     I              OMR1NB                      WAR1NB
     I              OMAVQT                      WAAVQT
     I              OMD0WG                      WAD0WG
     I              OMCCQT                      WACCQT
     I              OMAUWG                      WAAUWG
     I              OMCBQT                      WACBQT
     I              OMATWG                      WAATWG
     I              OMAQCS                      WAAQCS
     I              OMAGCS                      WAAGCS
     I              OMAKPR                      WAAKPR
     I              OMALPR                      WAALPR
     I              OMAUPR                      WAAUPR
     I              OMAVWG                      WAAVWG
     I              OMA4WG                      WAA4WG
     I              OMA5DT                      WAA5DT
     I              OMAODT                      WAAODT
     I              OMGNDT                      WAGNDT
     I              OMAMST                      WAAMST
     I              OMANST                      WAANST
     I              OMVAST                      WAVAST
     I              OMRGNB                      WARGNB
     I              OMRHNB                      WARHNB
     I              OMRINB                      WARINB
     I              OMRBCD                      WARBCD
     I              OMHICD                      WAHICD
     I              OMRNCD                      WARNCD
     I              OMROCD                      WAROCD
     I              OMCXDT                      WACXDT
     I              OMAJVN                      WAAJVN
     I              OMKXCD                      WAKXCD
     I              OMJPCD                      WAJPCD
     I              OMCQCD                      WACQCD
     I              OMR4CD                      WAR4CD
     I              OMZ1ST                      WAZ1ST
     I              OMZ3ST                      WAZ3ST
     I              OMZ4ST                      WAZ4ST
     I              OMDUPR                      WADUPR
     I              OMB6VL                      WAB6VL
     I              OMA1AA                      WAA1AA
     I              OMFZSX                      WAFZSX
     I              OMF0SX                      WAF0SX
     I              OMF1SX                      WAF1SX
     I              OMF2SX                      WAF2SX
     I              OMF3SX                      WAF3SX
     I              OMF4SX                      WAF4SX
     I              OMF5SX                      WAF5SX
     I              OMF6SX                      WAF6SX
     I              OMF7SX                      WAF7SX
     I              OMNTDT                      WANTDT
     I              OMNUDT                      WANUDT
     I              OMNVDT                      WANVDT
     I              OMNWDT                      WANWDT
     I              OMNXDT                      WANXDT
     I              OMBUTM                      WABUTM
     I              OMBVTM                      WABVTM
     I              OMBWTM                      WABWTM
     I              OMBXTM                      WABXTM
     I              OMBYTM                      WABYTM
     I              OMH5NX                      WAH5NX
     I              OMH6NX                      WAH6NX
     I              OMH7NX                      WAH7NX
     I              OMH8NX                      WAH8NX
     I              OMH9NX                      WAH9NX
     I              OMDVPR                      WADVPR
     I              OMDWPR                      WADWPR
     I              OMDXPR                      WADXPR
     I              OMDYPR                      WADYPR
     I              OMDZPR                      WADZPR
     I              OMGSPR                      WAGSPR
     I              OMGTPR                      WAGTPR
     I              OMGUPR                      WAGUPR
     I              OMHOST                      WAHOST
     I              OMHPST                      WAHPST
     I              OMIOST                      WAIOST
     I              OMPEWG                      WAPEWG
     I              OMRINY                      WARINY
     I              OMTIDT                      WATIDT
     I              OMTJDT                      WATJDT
     I              OMH2ST                      WAH2ST
     I              OMH0ST                      WAH0ST
     I              OMH1ST                      WAH1ST
     I              OMTKDT                      WATKDT
     I              OMTLDT                      WATLDT
     I              OMTMDT                      WATMDT
     I              OMUVST                      WAUVST
     I              OMUWST                      WAUWST
     I              OMUXST                      WAUXST
     I              OMAATM                      WAAATM
     I              OMAYNA                      WAAYNA
     I              OMA0NA                      WAA0NA
     I              OMAXDT                      WAAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                      WBAIC3
     I              BEC4NB                      WBC4NB
     I              BEJNCD                      WBJNCD
     I              BEANC7                      WBANC7
     I              BEBKC7                      WBBKC7
     I              BEBRTX                      WBBRTX
     I              BEHMNA                      WBHMNA
     I              BEHONA                      WBHONA
     I              BEHPNA                      WBHPNA
     I              BEHNNA                      WBHNNA
     I              BEDBCD                      WBDBCD
     I              BECKTX                      WBCKTX
     I              BEB0C7                      WBB0C7
     I              BEAETX                      WBAETX
     I              BEB1NA                      WBB1NA
     I              BEB3NA                      WBB3NA
     I              BEB4NA                      WBB4NA
     I              BEB2NA                      WBB2NA
     I              BEBHCD                      WBBHCD
     I              BEC8TX                      WBC8TX
     I              BEBCNA                      WBBCNA
     I              BEA0DT                      WBA0DT
     I              BEA5DT                      WBA5DT
     I              BEGNDT                      WBGNDT
     I              BEACDT                      WBACDT
     I              BEAQCD                      WBAQCD
     I              BEB6NA                      WBB6NA
     I              BEBYNA                      WBBYNA
     I              BEBZNA                      WBBZNA
     I              BEGTST                      WBGTST
     I              BEGVST                      WBGVST
     I              BEGUST                      WBGUST
     I              BEQFST                      WBQFST
     I              BECQCD                      WBCQCD
     I              BEGJST                      WBGJST
     I              BEGWST                      WBGWST
     I              BEGXST                      WBGXST
     I              BEGYST                      WBGYST
     I              BEAODT                      WBAODT
     I              BEAIVN                      WBAIVN
     I              BECXDT                      WBCXDT
     I              BEJZVA                      WBJZVA
     I              BEA1WG                      WBA1WG
     I              BEXIST                      WBXIST
     I              BEXJST                      WBXJST
     I              BEXKST                      WBXKST
     I              BEEIDT                      WBEIDT
     I              BEAFTM                      WBAFTM
     I              BEE8CD                      WBE8CD
     I              BEE9CD                      WBE9CD
     I              BERMNB                      WBRMNB
     I              BETBNB                      WBTBNB
     I              BER1NB                      WBR1NB
     I              BEPJST                      WBPJST
     I              BEU0ST                      WBU0ST
     I              BEU1ST                      WBU1ST
     I              BEQ2CD                      WBQ2CD
     I              BEU2ST                      WBU2ST
     I              BEVEST                      WBVEST
     I              BEVFST                      WBVFST
     I              BEVGST                      WBVGST
     I              BERPCD                      WBRPCD
     I              BERNNB                      WBRNNB
     I              BEVDST                      WBVDST
     I              BEATIN                      WBATIN
     I              BEU4ST                      WBU4ST
     I              BEU5ST                      WBU5ST
     I              BERSRN                      WBRSRN
     I              BEMHNA                      WBMHNA
     I              BEMINA                      WBMINA
     I              BEWBST                      WBWBST
     I              BER4CD                      WBR4CD
     I              BEBFCD                      WBBFCD
     I              BEQ4CD                      WBQ4CD
     I              BET3NB                      WBT3NB
     I              BESICD                      WBSICD
     I              BECONB                      WBCONB
     I              BECEST                      WBCEST
     I              BEAWDT                      WBAWDT
     I              BEJPCD                      WBJPCD
     I              BEXUST                      WBXUST
     I              BEZ1ST                      WBZ1ST
     I              BEVRVA                      WBVRVA
     I              BEOBST                      WBOBST
     I              BEBCST                      WBBCST
     I              BEBDST                      WBBDST
     I              BEB7VL                      WBB7VL
     I              BEGASX                      WBGASX
     I              BEGBSX                      WBGBSX
     I              BEGCSX                      WBGCSX
     I              BEGDSX                      WBGDSX
     I              BEFNSX                      WBFNSX
     I              BEFOSX                      WBFOSX
     I              BEFPSX                      WBFPSX
     I              BEFQSX                      WBFQSX
     I              BEFRSX                      WBFRSX
     I              BEFSSX                      WBFSSX
     I              BEFTSX                      WBFTSX
     I              BEFUSX                      WBFUSX
     I              BEFVSX                      WBFVSX
     I              BEFWSX                      WBFWSX
     I              BEFXSX                      WBFXSX
     I              BEFYSX                      WBFYSX
     I              BENODT                      WBNODT
     I              BENPDT                      WBNPDT
     I              BENQDT                      WBNQDT
     I              BENRDT                      WBNRDT
     I              BENSDT                      WBNSDT
     I              BEBPTM                      WBBPTM
     I              BEBQTM                      WBBQTM
     I              BEBRTM                      WBBRTM
     I              BEBSTM                      WBBSTM
     I              BEBTTM                      WBBTTM
     I              BEH0NX                      WBH0NX
     I              BEH1NX                      WBH1NX
     I              BEH2NX                      WBH2NX
     I              BEH3NX                      WBH3NX
     I              BEH4NX                      WBH4NX
     I              BEC0C7                      WBC0C7
     I              BEUVST                      WBUVST
     I              BEUWST                      WBUWST
     I              BEUXST                      WBUXST
     I              BEAATM                      WBAATM
     I              BEAYNA                      WBAYNA
     I              BEA0NA                      WBA0NA
     I              BEAXDT                      WBAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                      WCAIC3
     I              OMC4NB                      WCC4NB
     I              OMDPNB                      WCDPNB
     I              OMUENB                      WCUENB
     I              OMHGCD                      WCHGCD
     I              OMAJCD                      WCAJCD
     I              OMBKC7                      WCBKC7
     I              OMCFC7                      WCCFC7
     I              OMGMST                      WCGMST
     I              OMGNST                      WCGNST
     I              OMMAVA                      WCMAVA
     I              OMKDVA                      WCKDVA
     I              OML8VA                      WCL8VA
     I              OML9VA                      WCL9VA
     I              OMGTST                      WCGTST
     I              OMGVST                      WCGVST
     I              OMGUST                      WCGUST
     I              OMQFST                      WCQFST
     I              OMAYVA                      WCAYVA
     I              OMEXDT                      WCEXDT
     I              OMLQCD                      WCLQCD
     I              OMRDCD                      WCRDCD
     I              OMQ7CD                      WCQ7CD
     I              OMBZPR                      WCBZPR
     I              OML6NB                      WCL6NB
     I              OMU1ST                      WCU1ST
     I              OMGIDT                      WCGIDT
     I              OMCRCD                      WCCRCD
     I              OMAGCD                      WCAGCD
     I              OMRZST                      WCRZST
     I              OMR0ST                      WCR0ST
     I              OMR1ST                      WCR1ST
     I              OMG7NA                      WCG7NA
     I              OMG8NA                      WCG8NA
     I              OMRPCD                      WCRPCD
     I              OMVEST                      WCVEST
     I              OMVGST                      WCVGST
     I              OMAVST                      WCAVST
     I              OMU0ST                      WCU0ST
     I              OMRFCD                      WCRFCD
     I              OMFZST                      WCFZST
     I              OMR1NB                      WCR1NB
     I              OMAVQT                      WCAVQT
     I              OMD0WG                      WCD0WG
     I              OMCCQT                      WCCCQT
     I              OMAUWG                      WCAUWG
     I              OMCBQT                      WCCBQT
     I              OMATWG                      WCATWG
     I              OMAQCS                      WCAQCS
     I              OMAGCS                      WCAGCS
     I              OMAKPR                      WCAKPR
     I              OMALPR                      WCALPR
     I              OMAUPR                      WCAUPR
     I              OMAVWG                      WCAVWG
     I              OMA4WG                      WCA4WG
     I              OMA5DT                      WCA5DT
     I              OMAODT                      WCAODT
     I              OMGNDT                      WCGNDT
     I              OMAMST                      WCAMST
     I              OMANST                      WCANST
     I              OMVAST                      WCVAST
     I              OMRGNB                      WCRGNB
     I              OMRHNB                      WCRHNB
     I              OMRINB                      WCRINB
     I              OMRBCD                      WCRBCD
     I              OMHICD                      WCHICD
     I              OMRNCD                      WCRNCD
     I              OMROCD                      WCROCD
     I              OMCXDT                      WCCXDT
     I              OMAJVN                      WCAJVN
     I              OMKXCD                      WCKXCD
     I              OMJPCD                      WCJPCD
     I              OMCQCD                      WCCQCD
     I              OMR4CD                      WCR4CD
     I              OMZ1ST                      WCZ1ST
     I              OMZ3ST                      WCZ3ST
     I              OMZ4ST                      WCZ4ST
     I              OMDUPR                      WCDUPR
     I              OMB6VL                      WCB6VL
     I              OMA1AA                      WCA1AA
     I              OMFZSX                      WCFZSX
     I              OMF0SX                      WCF0SX
     I              OMF1SX                      WCF1SX
     I              OMF2SX                      WCF2SX
     I              OMF3SX                      WCF3SX
     I              OMF4SX                      WCF4SX
     I              OMF5SX                      WCF5SX
     I              OMF6SX                      WCF6SX
     I              OMF7SX                      WCF7SX
     I              OMNTDT                      WCNTDT
     I              OMNUDT                      WCNUDT
     I              OMNVDT                      WCNVDT
     I              OMNWDT                      WCNWDT
     I              OMNXDT                      WCNXDT
     I              OMBUTM                      WCBUTM
     I              OMBVTM                      WCBVTM
     I              OMBWTM                      WCBWTM
     I              OMBXTM                      WCBXTM
     I              OMBYTM                      WCBYTM
     I              OMH5NX                      WCH5NX
     I              OMH6NX                      WCH6NX
     I              OMH7NX                      WCH7NX
     I              OMH8NX                      WCH8NX
     I              OMH9NX                      WCH9NX
     I              OMDVPR                      WCDVPR
     I              OMDWPR                      WCDWPR
     I              OMDXPR                      WCDXPR
     I              OMDYPR                      WCDYPR
     I              OMDZPR                      WCDZPR
     I              OMGSPR                      WCGSPR
     I              OMGTPR                      WCGTPR
     I              OMGUPR                      WCGUPR
     I              OMHOST                      WCHOST
     I              OMHPST                      WCHPST
     I              OMIOST                      WCIOST
     I              OMPEWG                      WCPEWG
     I              OMRINY                      WCRINY
     I              OMTIDT                      WCTIDT
     I              OMTJDT                      WCTJDT
     I              OMH2ST                      WCH2ST
     I              OMH0ST                      WCH0ST
     I              OMH1ST                      WCH1ST
     I              OMTKDT                      WCTKDT
     I              OMTLDT                      WCTLDT
     I              OMTMDT                      WCTMDT
     I              OMUVST                      WCUVST
     I              OMUWST                      WCUWST
     I              OMUXST                      WCUXST
     I              OMAATM                      WCAATM
     I              OMAYNA                      WCAYNA
     I              OMA0NA                      WCA0NA
     I              OMAXDT                      WCAXDT
      *
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * Cnv Fix Detail Line StsXF
      * ***This is for warranty fix on CR # 7001057 due to DDS to DDL
      *    conversion change to the O.D. table where Bruce P. process,
      *    the Order Close Stored Procedure was updating the 'Detail Line
      *    Status' with the 'Work Over_Short Status' field from O.D. file
      * Cnv Fix Detail Line StsRT - Order Detail  * 
     C                   EXSR      SARVGN
      *----------------------------------------------------------------
      * Exit program
     C     AAEXIT        TAG
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
      /EJECT
     CSR   SARVGN        BEGSR
      *================================================================
      * Cnv Fix Detail Line StsRT - Order Detail  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Establish starting position
     C     *LOVAL        SETLL     @BGWKL1                                      *
     C                   READ      @BGWKL1                                90    *
      * Data record not found
     C   90              MOVEL     'USR1309'     W0RTN
      * USER: Process Data record
     C                   DOW       NOT *IN90
     C                   MOVEL     WAGMST        YL0001                         Detail Line Sta
      * SELECT only 'Detail Line Status = O or S'.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.Detail Line Status Txt U is Overage
      *   |- c2    : LCL.Detail Line Status Txt U is Short
      *   '-
      * Save original status.
     C                   IF        YL0001 = 'O' OR
     C                             YL0001 = 'S'
     C                   MOVEL     YL0001        WUX1U1                         Detail Line Sta
      * Check Ordered QTY.
      * CASE: DB1.Quantity Ordered is Greater than zero
      * Check Shipped QTY to update the Detail Line Status per OH Hdr Sts
      * CASE: DB1.Quantity Shipped Total is Greater than zero
     C                   IF        WAAVQT > 0
      * RTV Header Status      RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                   IF        WACBQT > 0
     C                   Z-ADD     WAAIC3        WL0001                         Company Number
     C                   Z-ADD     WAC4NB        WL0002                         Order Number
     C                   EXSR      SBRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0003        YL0002                         Header Status
      * CHG Dtl Line&Wrk O/S StCH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WAAIC3        WL0004                         Company Number
     C                   Z-ADD     WAC4NB        WL0005                         Order Number
     C                   Z-ADD     WADPNB        WL0006                         Order Sequence
     C                   Z-ADD     WAUENB        WL0007                         Order Secondary
     C                   MOVEL(P)  YL0002        WL0008                         Detail Line Sta
     C                   MOVEL(P)  WUX1U1        WL0009                         Work Over_Short
     C                   EXSR      SCCHRC
     C                   ELSE
      * CASE: *OTHERWISE
      * Ordered QTY>0 & Shipped QTY=0, what status to update?
      * Per Barb G., will set it to 'R' even if Hdr Sts is 'C'. Will
      * have to cleanup with whatever comes through afterwards.
      * CHG Dtl Line&Wrk O/S StCH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WAAIC3        WL0004                         Company Number
     C                   Z-ADD     WAC4NB        WL0005                         Order Number
     C                   Z-ADD     WADPNB        WL0006                         Order Sequence
     C                   Z-ADD     WAUENB        WL0007                         Order Secondary
     C                   MOVEL(P)  'R'           WL0008                         Detail Line Sta
     C                   MOVEL(P)  WUX1U1        WL0009                         Work Over_Short
     C                   EXSR      SCCHRC
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
      * If Ordered QTY is 0, then Shipping personnel added this line
      * with a Line Seq of 50's.
      * If Shipped QTY > 0, update the Detail Line Status per OH Hdr Sts.
      * CASE: DB1.Quantity Shipped Total is Greater than zero
      * RTV Header Status      RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                   IF        WACBQT > 0
     C                   Z-ADD     WAAIC3        WL0001                         Company Number
     C                   Z-ADD     WAC4NB        WL0002                         Order Number
     C                   EXSR      SBRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0003        YL0002                         Header Status
      * CHG Dtl Line&Wrk O/S StCH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WAAIC3        WL0004                         Company Number
     C                   Z-ADD     WAC4NB        WL0005                         Order Number
     C                   Z-ADD     WADPNB        WL0006                         Order Sequence
     C                   Z-ADD     WAUENB        WL0007                         Order Secondary
     C                   MOVEL(P)  YL0002        WL0008                         Detail Line Sta
     C                   MOVEL(P)  WUX1U1        WL0009                         Work Over_Short
     C                   EXSR      SCCHRC
     C                   ELSE
      * CASE: *OTHERWISE
      * Ordered QTY=0 & Shipped QTY=0, no scenarios exist with this crite
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   READ      @BGWKL1                                90    *
     C                   ENDDO
      *================================================================
     CSR   SAEXIT        ENDSR
      /EJECT
     CSR   SBRVGN        BEGSR
      *================================================================
      * RTV Header Status      RT - Order Header TRG  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSB         KLIST
     C                   KFLD                    WBAIC3                         Company Number
     C                   KFLD                    WBC4NB                         Order Number
      * Setup key
     C                   Z-ADD     WL0001        WBAIC3                         Company Number
     C                   Z-ADD     WL0002        WBC4NB                         Order Number
      * Establish starting position
     C     KRSSB         CHAIN     @BECPFK                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR0176'     W0RTN
      * USER: Processing if Data record not found
     C                   MOVEL     'Y2U0005'     W0RTN                          *Return code
     C                   GOTO      SBEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     WBGWST        WL0003                         Header Status
     C                   ENDIF
      *================================================================
     CSR   SBEXIT        ENDSR
      /EJECT
     CSR   SCCHRC        BEGSR
      *================================================================
      * CHG Dtl Line&Wrk O/S StCH - Order Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                   Z-ADD     *ZERO         WN0001                         Item Code
     C                   EVAL      WN0002 = ' '                                 Warehouse Code
     C                   Z-ADD     *ZERO         WN0003                         Ship To Custome
     C                   Z-ADD     *ZERO         WN0004                         Order Group Cod
     C                   EVAL      WN0005 = ' '                                 Detail Line Sta
     C                   Z-ADD     *ZERO         WN0006                         Billing Detail
     C                   Z-ADD     *ZERO         WN0007                         Billing Detail
     C                   Z-ADD     *ZERO         WN0008                         Billing Detail
     C                   Z-ADD     *ZERO         WN0009                         Quantity to Sub
     C                   EVAL      WN0010 = ' '                                 Comment Print A
     C                   EVAL      WN0011 = ' '                                 Comment Print I
     C                   EVAL      WN0012 = ' '                                 Comment Print P
     C                   EVAL      WN0013 = ' '                                 Comment Print S
     C                   Z-ADD     *ZERO         WN0014                         Extended Amount
     C                   Z-ADD     *ZERO         WN0015                         Market Pricing
     C                   EVAL      WN0016 = ' '                                 Commodity Marke
     C                   EVAL      WN0017 = ' '                                 Date Method Cod
     C                   EVAL      WN0018 = ' '                                 Price Method Co
     C                   Z-ADD     *ZERO         WN0019                         Price Overage O
     C                   Z-ADD     *ZERO         WN0020                         Contract Number
     C                   EVAL      WN0021 = ' '                                 Price Status
     C                   Z-ADD     *ZERO         WN0022                         Pricing Date Us
     C                   EVAL      WN0023 = ' '                                 U_M_Base Price
     C                   EVAL      WN0024 = ' '                                 U_M_Ordered
     C                   EVAL      WN0025 = ' '                                 Work Confirm St
     C                   EVAL      WN0026 = ' '                                 OD Production P
     C                   EVAL      WN0027 = ' '                                 Order Desc_Line
     C                   EVAL      WN0028 = ' '                                 Order Desc_Line
     C                   EVAL      WN0029 = ' '                                 Age Code
     C                   EVAL      WN0030 = ' '                                 Palletize
     C                   EVAL      WN0031 = ' '                                 Slip Sheet
     C                   EVAL      WN0032 = ' '                                 Catch Weight St
     C                   EVAL      WN0033 = ' '                                 Price Audit
     C                   EVAL      WN0034 = ' '                                 Price Audit Rea
     C                   EVAL      WN0035 = ' '                                 Production Date
     C                   Z-ADD     *ZERO         WN0036                         Rated Freight
     C                   Z-ADD     *ZERO         WN0037                         Quantity Ordere
     C                   Z-ADD     *ZERO         WN0038                         Weight Ordered
     C                   Z-ADD     *ZERO         WN0039                         Quantity Schedu
     C                   Z-ADD     *ZERO         WN0040                         Weight Schedule
     C                   Z-ADD     *ZERO         WN0041                         Quantity Shippe
     C                   Z-ADD     *ZERO         WN0042                         Weight Shipped
     C                   Z-ADD     *ZERO         WN0043                         Unit Cost Prici
     C                   Z-ADD     *ZERO         WN0044                         Unit Cost Per P
     C                   Z-ADD     *ZERO         WN0045                         Unit Price
     C                   Z-ADD     *ZERO         WN0046                         Unit Price_Cred
     C                   Z-ADD     *ZERO         WN0047                         Unit Price Orde
     C                   Z-ADD     *ZERO         WN0048                         Unit Weight Ord
     C                   Z-ADD     *ZERO         WN0049                         Tare Weight Tot
     C                   Z-ADD     *ZERO         WN0050                         Requested Ship
     C                   Z-ADD     *ZERO         WN0051                         Scheduled Ship
     C                   Z-ADD     *ZERO         WN0052                         Actual Shipped
     C                   EVAL      WN0053 = ' '                                 Affect Inventor
     C                   EVAL      WN0054 = ' '                                 Affect Sales Do
     C                   EVAL      WN0055 = ' '                                 Affect Sales Pn
     C                   Z-ADD     *ZERO         WN0056                         Item Structure
     C                   Z-ADD     *ZERO         WN0057                         Item Structure
     C                   Z-ADD     *ZERO         WN0058                         Item Structure
     C                   EVAL      WN0059 = ' '                                 Item Level
     C                   EVAL      WN0060 = ' '                                 Quality Level
     C                   EVAL      WN0061 = ' '                                 Pricing Product
     C                   EVAL      WN0062 = ' '                                 Season Product
     C                   Z-ADD     *ZERO         WN0063                         Date of Origina
     C                   EVAL      WN0064 = ' '                                 User Profile Na
     C                   EVAL      WN0065 = ' '                                 Country Code
     C                   EVAL      WN0066 = ' '                                 Event Code
     C                   EVAL      WN0067 = ' '                                 Reason Code
     C                   EVAL      WN0068 = ' '                                 Sales Route Cod
     C                   EVAL      WN0069 = ' '                                 Modified Flag
     C                   EVAL      WN0070 = ' '                                 Substituted Fla
     C                   EVAL      WN0071 = ' '                                 OD Schedule Ove
     C                   Z-ADD     *ZERO         WN0072                         Invoice Unit Pr
     C                   Z-ADD     *ZERO         WN0073                         Invoice Extende
     C                   Z-ADD     *ZERO         WN0074                         Ham Group Numbe
     C                   EVAL      WN0075 = ' '                                 OD Adj Type Ove
     C                   EVAL      WN0076 = ' '                                 Affect Trade Fu
     C                   EVAL      WN0077 = ' '                                 Affect Commissi
     C                   EVAL      WN0078 = ' '                                 Affect Pricing
     C                   EVAL      WN0079 = ' '                                 Released by Use
     C                   EVAL      WN0080 = ' '                                 Ord TF Exempt C
     C                   EVAL      WN0081 = ' '                                 OD Pallet Type
     C                   EVAL      WN0082 = ' '                                 Production Ware
     C                   EVAL      WN0083 = ' '                                 OD Price Type
     C                   Z-ADD     *ZERO         WN0084                         Warehouse Palle
     C                   Z-ADD     *ZERO         WN0085                         Consumed Item C
     C                   Z-ADD     *ZERO         WN0086                         Deadline Depart
     C                   Z-ADD     *ZERO         WN0087                         OD Price Type R
     C                   Z-ADD     *ZERO         WN0088                         OD Firm Date
     C                   Z-ADD     *ZERO         WN0089                         Deadline Depart
     C                   Z-ADD     *ZERO         WN0090                         Price Code
     C                   Z-ADD     *ZERO         WN0091                         Maximum Net Wei
     C                   Z-ADD     *ZERO         WN0092                         Substitution Li
     C                   Z-ADD     *ZERO         WN0093                         Max Qty to sche
     C                   Z-ADD     *ZERO         WN0094                         Warehouse Palle
     C                   Z-ADD     *ZERO         WN0095                         Warehouse Avg P
     C                   Z-ADD     *ZERO         WN0096                         OD Item Target
     C                   Z-ADD     *ZERO         WN0097                         OD Estimated Gr
     C                   Z-ADD     *ZERO         WN0098                         OD Maximum Unit
     C                   Z-ADD     *ZERO         WN0099                         Order Gate_Fina
     C                   Z-ADD     *ZERO         WN0100                         OD Ceiling Pric
     C                   Z-ADD     *ZERO         WN0101                         OD Gate_Final P
     C                   Z-ADD     *ZERO         WN0102                         OD Weighted Avg
     C                   Z-ADD     *ZERO         WN0103                         OD Original Ord
     C                   Z-ADD     *ZERO         WN0104                         OD Cancel Date
     C                   Z-ADD     *ZERO         WN0105                         OD Unused Prc 7
     C                   Z-ADD     *ZERO         WN0106                         OD Unused Prc 8
     C                   EVAL      WN0107 = ' '                                 OD MPR Sent to
     C                   EVAL      WN0108 = ' '                                 OD MPR Prc Read
     C                   EVAL      WN0109 = ' '                                 OD UnUsed Price
     C                   Z-ADD     *ZERO         WN0110                         Weight Amount E
     C                   Z-ADD     *ZERO         WN0111                         Item Age Days
     C                   Z-ADD     *ZERO         WN0112                         Production Ovr
     C                   Z-ADD     *ZERO         WN0113                         Production Ovr
     C                   EVAL      WN0114 = ' '                                 OD Spot Buy
     C                   EVAL      WN0115 = ' '                                 OD Clm Full Ret
     C                   EVAL      WN0116 = ' '                                 Order Line Erro
     C                   Z-ADD     *ZERO         WN0117                         OD Market Begin
     C                   Z-ADD     *ZERO         WN0118                         OD Market Endin
     C                   Z-ADD     *ZERO         WN0119                         OD Atch to Ord
     C                   EVAL      WN0120 = ' '                                 EDI Status 1
     C                   EVAL      WN0121 = ' '                                 EDI Status 2
     C                   EVAL      WN0122 = ' '                                 EDI Status 3
     C                   Z-ADD     *ZERO         WN0123                         Job Time
     C                   EVAL      WN0124 = ' '                                 User Id
     C                   EVAL      WN0125 = ' '                                 Job Name
     C                   Z-ADD     *ZERO         WN0126                         Job Date
      *
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YARDC = ' '
      *
      * Move key fields to @BGWKL0
     C                   Z-ADD     WL0004        WCAIC3                         Company Number
     C                   Z-ADD     WL0005        WCC4NB                         Order Number
     C                   Z-ADD     WL0006        WCDPNB                         Order Sequence
     C                   Z-ADD     WL0007        WCUENB                         Order Secondary
      *
     C     KLCHSC        KLIST
     C                   KFLD                    WCAIC3                         Company Number
     C                   KFLD                    WCC4NB                         Order Number
     C                   KFLD                    WCDPNB                         Order Sequence
     C                   KFLD                    WCUENB                         Order Secondary
     C     KLCHSC        CHAIN     @BGWKL0                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'OPBGWKL0'    MDACP
     C                   MOVEL     '@BGWKL0'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL001.
     C                   MOVEL     'LBL001'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      SCEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      SCEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QOPBG1        YARDCS
      * Move non-key fields to @BGWKL0
     C                   MOVEL(P)  WL0008        WCGMST                         Detail Line Sta
     C                   MOVEL(P)  WL0009        WCR0ST                         Work Over_Short
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QOPBG1 <> YARDCS AND
     C                             YARDC <> 'N'
     C                   MOVE      'Y'           YARDC
     C                   ENDIF
      * USER: Processing before Data update
      * Set PGM.*Record Data Changed flag
     C                   IF        QOPBG1 <> YARDCS AND
     C                             YARDC <> 'N'
     C                   MOVE      'Y'           YARDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YARDC = 'Y'
     C                   UPDATE    @BGWKL0                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    OPBGWKL0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   SCEXIT        ENDSR
      /EJECT
     CSR   ZASNMS        BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C                   IF        ZAPGMQ = ' '
     C                   MOVEL     ##PGM         ZAPGMQ
     C                   END
     C                   CALL      'Y2SNMGC'
     C                   PARM                    ZAPGMQ                         Program queue
     C                   PARM                    ZAPGRL                         Rel queue
     C                   PARM                    ZAMSID                         Message ID
     C                   PARM                    ZAMSGF                         Message file
     C                   PARM                    ZAMSDA                         Message data
     C                   PARM                    ZAMSTP                         Message type
     C                   PARM      'Y'           YILE
      * Clear all fields for default mechanism next time
     C                   EVAL      ZAPGMQ = ' '
     C                   EVAL      ZAPGRL = ' '
     C                   EVAL      ZAMSID = ' '
     C                   EVAL      ZAMSGF = ' '
     C                   EVAL      ZAMSDA = ' '
     C                   EVAL      ZAMSTP = ' '
      *================================================================
     CSR   ZAEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      *
      *
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WAAIC3                         Company Number
     C                   Z-ADD     *ZERO         WAC4NB                         Order Number
     C                   Z-ADD     *ZERO         WADPNB                         Order Sequence
     C                   Z-ADD     *ZERO         WAUENB                         Order Secondary
     C                   Z-ADD     *ZERO         WAHGCD                         Item Code
     C                   Z-ADD     *ZERO         WABKC7                         Ship To Custome
     C                   Z-ADD     *ZERO         WACFC7                         Order Group Cod
     C                   Z-ADD     *ZERO         WAMAVA                         Billing Detail
     C                   Z-ADD     *ZERO         WAKDVA                         Billing Detail
     C                   Z-ADD     *ZERO         WAL8VA                         Billing Detail
     C                   Z-ADD     *ZERO         WAL9VA                         Quantity to Sub
     C                   Z-ADD     *ZERO         WAAYVA                         Extended Amount
     C                   Z-ADD     *ZERO         WAEXDT                         Market Pricing
     C                   Z-ADD     *ZERO         WABZPR                         Price Overage O
     C                   Z-ADD     *ZERO         WAL6NB                         Contract Number
     C                   Z-ADD     *ZERO         WAGIDT                         Pricing Date Us
     C                   Z-ADD     *ZERO         WAR1NB                         Rated Freight
     C                   Z-ADD     *ZERO         WAAVQT                         Quantity Ordere
     C                   Z-ADD     *ZERO         WAD0WG                         Weight Ordered
     C                   Z-ADD     *ZERO         WACCQT                         Quantity Schedu
     C                   Z-ADD     *ZERO         WAAUWG                         Weight Schedule
     C                   Z-ADD     *ZERO         WACBQT                         Quantity Shippe
     C                   Z-ADD     *ZERO         WAATWG                         Weight Shipped
     C                   Z-ADD     *ZERO         WAAQCS                         Unit Cost Prici
     C                   Z-ADD     *ZERO         WAAGCS                         Unit Cost Per P
     C                   Z-ADD     *ZERO         WAAKPR                         Unit Price
     C                   Z-ADD     *ZERO         WAALPR                         Unit Price_Cred
     C                   Z-ADD     *ZERO         WAAUPR                         Unit Price Orde
     C                   Z-ADD     *ZERO         WAAVWG                         Unit Weight Ord
     C                   Z-ADD     *ZERO         WAA4WG                         Tare Weight Tot
     C                   Z-ADD     *ZERO         WAA5DT                         Requested Ship
     C                   Z-ADD     *ZERO         WAAODT                         Scheduled Ship
     C                   Z-ADD     *ZERO         WAGNDT                         Actual Shipped
     C                   Z-ADD     *ZERO         WARGNB                         Item Structure
     C                   Z-ADD     *ZERO         WARHNB                         Item Structure
     C                   Z-ADD     *ZERO         WARINB                         Item Structure
     C                   Z-ADD     *ZERO         WACXDT                         Date of Origina
     C                   Z-ADD     *ZERO         WADUPR                         Invoice Unit Pr
     C                   Z-ADD     *ZERO         WAB6VL                         Invoice Extende
     C                   Z-ADD     *ZERO         WAA1AA                         Ham Group Numbe
     C                   Z-ADD     *ZERO         WANTDT                         Warehouse Palle
     C                   Z-ADD     *ZERO         WANUDT                         Consumed Item C
     C                   Z-ADD     *ZERO         WANVDT                         Deadline Depart
     C                   Z-ADD     *ZERO         WANWDT                         OD Price Type R
     C                   Z-ADD     *ZERO         WANXDT                         OD Firm Date
     C                   Z-ADD     *ZERO         WABUTM                         Deadline Depart
     C                   Z-ADD     *ZERO         WABVTM                         Price Code
     C                   Z-ADD     *ZERO         WABWTM                         Maximum Net Wei
     C                   Z-ADD     *ZERO         WABXTM                         Substitution Li
     C                   Z-ADD     *ZERO         WABYTM                         Max Qty to sche
     C                   Z-ADD     *ZERO         WAH5NX                         Warehouse Palle
     C                   Z-ADD     *ZERO         WAH6NX                         Warehouse Avg P
     C                   Z-ADD     *ZERO         WAH7NX                         OD Item Target
     C                   Z-ADD     *ZERO         WAH8NX                         OD Estimated Gr
     C                   Z-ADD     *ZERO         WAH9NX                         OD Maximum Unit
     C                   Z-ADD     *ZERO         WADVPR                         Order Gate_Fina
     C                   Z-ADD     *ZERO         WADWPR                         OD Ceiling Pric
     C                   Z-ADD     *ZERO         WADXPR                         OD Gate_Final P
     C                   Z-ADD     *ZERO         WADYPR                         OD Weighted Avg
     C                   Z-ADD     *ZERO         WADZPR                         OD Original Ord
     C                   Z-ADD     *ZERO         WAGSPR                         OD Cancel Date
     C                   Z-ADD     *ZERO         WAGTPR                         OD Unused Prc 7
     C                   Z-ADD     *ZERO         WAGUPR                         OD Unused Prc 8
     C                   Z-ADD     *ZERO         WAPEWG                         Weight Amount E
     C                   Z-ADD     *ZERO         WARINY                         Item Age Days
     C                   Z-ADD     *ZERO         WATIDT                         Production Ovr
     C                   Z-ADD     *ZERO         WATJDT                         Production Ovr
     C                   Z-ADD     *ZERO         WATKDT                         OD Market Begin
     C                   Z-ADD     *ZERO         WATLDT                         OD Market Endin
     C                   Z-ADD     *ZERO         WATMDT                         OD Atch to Ord
     C                   Z-ADD     *ZERO         WAAATM                         Job Time
     C                   Z-ADD     *ZERO         WAAXDT                         Job Date
      * Define work field Detail Line Status Txt U
     C                   EVAL      WUX1U1 = ' '
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WBAIC3                         Company Number
     C                   Z-ADD     *ZERO         WBC4NB                         Order Number
     C                   Z-ADD     *ZERO         WBANC7                         AR Customer Num
     C                   Z-ADD     *ZERO         WBBKC7                         Ship To Custome
     C                   Z-ADD     *ZERO         WBB0C7                         Bill to Custome
     C                   Z-ADD     *ZERO         WBA0DT                         Order Date
     C                   Z-ADD     *ZERO         WBA5DT                         Requested Ship
     C                   Z-ADD     *ZERO         WBGNDT                         Actual Shipped
     C                   Z-ADD     *ZERO         WBACDT                         Cancel Date
     C                   Z-ADD     *ZERO         WBAODT                         Scheduled Ship
     C                   Z-ADD     *ZERO         WBCXDT                         Date of Origina
     C                   Z-ADD     *ZERO         WBJZVA                         Order Value Tot
     C                   Z-ADD     *ZERO         WBA1WG                         Order Weight To
     C                   Z-ADD     *ZERO         WBEIDT                         Requested Deliv
     C                   Z-ADD     *ZERO         WBAFTM                         Requested Deliv
     C                   Z-ADD     *ZERO         WBRMNB                         Load ID
     C                   Z-ADD     *ZERO         WBTBNB                         Absorbed Freigh
     C                   Z-ADD     *ZERO         WBR1NB                         Rated Freight
     C                   Z-ADD     *ZERO         WBRNNB                         Reefer Temperat
     C                   Z-ADD     *ZERO         WBATIN                         Attach to Invoi
     C                   Z-ADD     *ZERO         WBRSRN                         Resell Referenc
     C                   Z-ADD     *ZERO         WBT3NB                         Attach to Order
     C                   Z-ADD     *ZERO         WBCONB                         Invoice Number
     C                   Z-ADD     *ZERO         WBAWDT                         Invoice Date
     C                   Z-ADD     *ZERO         WBVRVA                         A_R order Value
     C                   Z-ADD     *ZERO         WBB7VL                         Invoice Order V
     C                   Z-ADD     *ZERO         WBNODT                         OH Appt Confirm
     C                   Z-ADD     *ZERO         WBNPDT                         JPN Invoice Iss
     C                   Z-ADD     *ZERO         WBNQDT                         Load Actual Shi
     C                   Z-ADD     *ZERO         WBNRDT                         Load BOL Comple
     C                   Z-ADD     *ZERO         WBNSDT                         Load Truck Depa
     C                   Z-ADD     *ZERO         WBBPTM                         Maximum Gross W
     C                   Z-ADD     *ZERO         WBBQTM                         Time of Origina
     C                   Z-ADD     *ZERO         WBBRTM                         OH Appt Confirm
     C                   Z-ADD     *ZERO         WBBSTM                         Load BOL Comple
     C                   Z-ADD     *ZERO         WBBTTM                         Load Truck Depa
     C                   Z-ADD     *ZERO         WBH0NX                         Act Frt Referen
     C                   Z-ADD     *ZERO         WBH1NX                         Act Non_Ref Frt
     C                   Z-ADD     *ZERO         WBH2NX                         OH Fuel Surchar
     C                   Z-ADD     *ZERO         WBH3NX                         OH Total Non_Re
     C                   Z-ADD     *ZERO         WBH4NX                         OH Total Ref Fr
     C                   Z-ADD     *ZERO         WBC0C7                         Claim Number
     C                   Z-ADD     *ZERO         WBAATM                         Job Time
     C                   Z-ADD     *ZERO         WBAXDT                         Job Date
     C                   MOVEL     'N'           W0PMT
      * Define local variables for subroutine SBRVGN.
     C                   Z-ADD     *ZERO         WL0001
     C                   Z-ADD     *ZERO         WL0002
     C                   EVAL      WL0003 = ' '
      * Define local variables for subroutine SCCHRC.
     C                   Z-ADD     *ZERO         WL0004
     C                   Z-ADD     *ZERO         WL0005
     C                   Z-ADD     *ZERO         WL0006
     C                   Z-ADD     *ZERO         WL0007
     C                   EVAL      WL0008 = ' '
     C                   EVAL      WL0009 = ' '
      * Define local work field Detail Line Status Txt U
     C                   EVAL      YL0001 = ' '
      * Define local work field Header Status
     C                   EVAL      YL0002 = ' '
      *================================================================
     CSR   ZZEXIT        ENDSR
