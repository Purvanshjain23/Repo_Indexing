     H/TITLE PFS Inventory Rst FRZ XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 03/05/15  Time  : 16:57:24
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FPPB0CPL3IF  E           K        DISK
      * RSQ : PFS Inventory Restoration Co/Whs/Dte/Tme/Seq
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse                 Active records only
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAB0RELJIF  E           K        DISK
      * RTV : Item Balance              Acitve records only
      *
     FPDL2REL0IF  E           K        DISK
      * RTV : Warehouse Location        Retrieval index
      *
     FPDL3REL0IF  E           K        DISK
      * RTV : Warehouse Location Type   Retrieval index
      *
     FPDL5CPL1IF  E           K        DISK
      * RTV : Item Lot Location         Retrieval index
      *
     FPDL7CPL2IF  E           K        DISK
      * RSQ : Item Lot Loc Trans        Co/Itm/Whs/Typ/Dte/Sq(d)
      *
     FPDL7CPL0IF  E           K        DISK                      A
      * UPD : Item Lot Loc Trans        Update index
      *
     FPDL5CPL0UF  E           K        DISK                      A
      * UPD : Item Lot Location         Update index
      *
     FPPB0CPL0UF  E           K        DISK
      * UPD : PFS Inventory Restoration Update index
      *
      * Long constants
     E                    @CN#    1  08  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WAAJCD
     I              ADF8NA                          WAF8NA
     I              ADACNA                          WAACNA
     I              ADADNA                          WAADNA
     I              ADAENA                          WAAENA
     I              ADAJNA                          WAAJNA
     I              ADBTTX                          WABTTX
     I              ADAOCD                          WAAOCD
     I              ADBGCD                          WABGCD
     I              ADVHST                          WAVHST
     I              ADMPNA                          WAMPNA
     I              ADWPST                          WAWPST
     I              ADXUST                          WAXUST
     I              ADT0ST                          WAT0ST
     I              ADT1ST                          WAT1ST
     I              ADDBNB                          WADBNB
     I              ADT2ST                          WAT2ST
     I              ADT3ST                          WAT3ST
     I              ADT4ST                          WAT4ST
     I              ADT6ST                          WAT6ST
     I              ADBWC3                          WABWC3
     I              ADBTC3                          WABTC3
     I              ADBUC3                          WABUC3
     I              ADBVC3                          WABVC3
     I              ADFCAA                          WAFCAA
     I              ADRQSX                          WARQSX
     I              ADRRSX                          WARRSX
     I              ADRSSX                          WARSSX
     I              ADRTSX                          WARTSX
     I              ADT7ST                          WAT7ST
     I              ADT8ST                          WAT8ST
     I              ADRNSX                          WARNSX
     I              ADROSX                          WAROSX
     I              ADRPSX                          WARPSX
     I              ADUVST                          WAUVST
     I              ADUWST                          WAUWST
     I              ADUXST                          WAUXST
     I              ADVSST                          WAVSST
     I              ADAATM                          WAAATM
     I              ADAYNA                          WAAYNA
     I              ADA0NA                          WAA0NA
     I              ADAXDT                          WAAXDT
      *
     I@B0CPEP
      * PFS Inventory Restoration Co/Whs/Dte/Tme/Seq
      * Renamed input format fields
     I              B0Y1NX                          WBY1NX
     I              B0AID8                          WBAID8
     I              B0AFTS                          WBAFTS
     I              B0BCNY                          WBBCNY
     I              B0XKSX                          WBXKSX
     I              B0Y2NX                          WBY2NX
     I              B0U4SX                          WBU4SX
     I              B0ADNY                          WBADNY
     I              B0P7DT                          WBP7DT
     I              B0Z4NX                          WBZ4NX
     I              B0ACNY                          WBACNY
     I              B0CUNY                          WBCUNY
     I              B0CVNY                          WBCVNY
     I              B0UWSX                          WBUWSX
     I              B0UXSX                          WBUXSX
     I              B0V3SX                          WBV3SX
     I              B0AHNY                          WBAHNY
     I              B0AINY                          WBAINY
     I              B0AJNY                          WBAJNY
     I              B0AKNY                          WBAKNY
      *
     I@ADRET1
      * Warehouse                 Active records only
      * Renamed input format fields
     I              ADAJCD                          WCAJCD
     I              ADF8NA                          WCF8NA
     I              ADACNA                          WCACNA
     I              ADADNA                          WCADNA
     I              ADAENA                          WCAENA
     I              ADAJNA                          WCAJNA
     I              ADBTTX                          WCBTTX
     I              ADAOCD                          WCAOCD
     I              ADBGCD                          WCBGCD
     I              ADVHST                          WCVHST
     I              ADMPNA                          WCMPNA
     I              ADWPST                          WCWPST
     I              ADXUST                          WCXUST
     I              ADT0ST                          WCT0ST
     I              ADT1ST                          WCT1ST
     I              ADDBNB                          WCDBNB
     I              ADT2ST                          WCT2ST
     I              ADT3ST                          WCT3ST
     I              ADT4ST                          WCT4ST
     I              ADT6ST                          WCT6ST
     I              ADBWC3                          WCBWC3
     I              ADBTC3                          WCBTC3
     I              ADBUC3                          WCBUC3
     I              ADBVC3                          WCBVC3
     I              ADFCAA                          WCFCAA
     I              ADRQSX                          WCRQSX
     I              ADRRSX                          WCRRSX
     I              ADRSSX                          WCRSSX
     I              ADRTSX                          WCRTSX
     I              ADT7ST                          WCT7ST
     I              ADT8ST                          WCT8ST
     I              ADRNSX                          WCRNSX
     I              ADROSX                          WCROSX
     I              ADRPSX                          WCRPSX
     I              ADUVST                          WCUVST
     I              ADUWST                          WCUWST
     I              ADUXST                          WCUXST
     I              ADVSST                          WCVSST
     I              ADAATM                          WCAATM
     I              ADAYNA                          WCAYNA
     I              ADA0NA                          WCA0NA
     I              ADAXDT                          WCAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WDAIC3
     I              BZHGCD                          WDHGCD
     I              BZAVNA                          WDAVNA
     I              BZAWNA                          WDAWNA
     I              BZL7NA                          WDL7NA
     I              BZL8NA                          WDL8NA
     I              BZL6NA                          WDL6NA
     I              BZMFNA                          WDMFNA
     I              BZADCD                          WDADCD
     I              BZAWPC                          WDAWPC
     I              BZLXST                          WDLXST
     I              BZAECD                          WDAECD
     I              BZAXPC                          WDAXPC
     I              BZLYST                          WDLYST
     I              BZAFCD                          WDAFCD
     I              BZAICD                          WDAICD
     I              BZAIWG                          WDAIWG
     I              BZHICD                          WDHICD
     I              BZRBCD                          WDRBCD
     I              BZFZST                          WDFZST
     I              BZAVST                          WDAVST
     I              BZCZWG                          WDCZWG
     I              BZC0WG                          WDC0WG
     I              BZURTN                          WDURTN
     I              BZAJC8                          WDAJC8
     I              BZRINB                          WDRINB
     I              BZRHNB                          WDRHNB
     I              BZRGNB                          WDRGNB
     I              BZLNCD                          WDLNCD
     I              BZTFNB                          WDTFNB
     I              BZN0CD                          WDN0CD
     I              BZX4ST                          WDX4ST
     I              BZTMVA                          WDTMVA
     I              BZTNVA                          WDTNVA
     I              BZBLPR                          WDBLPR
     I              BZBMPR                          WDBMPR
     I              BZLRCD                          WDLRCD
     I              BZU9ST                          WDU9ST
     I              BZCMCO                          WDCMCO
     I              BZQ1CD                          WDQ1CD
     I              BZQ8CD                          WDQ8CD
     I              BZCHTM                          WDCHTM
     I              BZQZCD                          WDQZCD
     I              BZXWST                          WDXWST
     I              BZXXST                          WDXXST
     I              BZVMST                          WDVMST
     I              BZSWGH                          WDSWGH
     I              BZPPHE                          WDPPHE
     I              BZR3CD                          WDR3CD
     I              BZSDCD                          WDSDCD
     I              BZICN1                          WDICN1
     I              BZSVCD                          WDSVCD
     I              BZICN2                          WDICN2
     I              BZSWCD                          WDSWCD
     I              BZV2NB                          WDV2NB
     I              BZSXCD                          WDSXCD
     I              BZITCN                          WDITCN
     I              BZSYCD                          WDSYCD
     I              BZITC5                          WDITC5
     I              BZSZCD                          WDSZCD
     I              BZICN6                          WDICN6
     I              BZS0CD                          WDS0CD
     I              BZICN7                          WDICN7
     I              BZS1CD                          WDS1CD
     I              BZICN8                          WDICN8
     I              BZS2CD                          WDS2CD
     I              BZICN9                          WDICN9
     I              BZS3CD                          WDS3CD
     I              BZICN0                          WDICN0
     I              BZS4CD                          WDS4CD
     I              BZSFNB                          WDSFNB
     I              BZA3WG                          WDA3WG
     I              BZSJNB                          WDSJNB
     I              BZLLCD                          WDLLCD
     I              BZLMCD                          WDLMCD
     I              BZP3ST                          WDP3ST
     I              BZSKNB                          WDSKNB
     I              BZSLNB                          WDSLNB
     I              BZSMNB                          WDSMNB
     I              BZP4ST                          WDP4ST
     I              BZCFNB                          WDCFNB
     I              BZCGNB                          WDCGNB
     I              BZILNB                          WDILNB
     I              BZCHNB                          WDCHNB
     I              BZCINB                          WDCINB
     I              BZCJNB                          WDCJNB
     I              BZCMNB                          WDCMNB
     I              BZCNNB                          WDCNNB
     I              BZCRNB                          WDCRNB
     I              BZCSNB                          WDCSNB
     I              BZCVNB                          WDCVNB
     I              BZCWNB                          WDCWNB
     I              BZCXNB                          WDCXNB
     I              BZCZNB                          WDCZNB
     I              BZC0NB                          WDC0NB
     I              BZN1CD                          WDN1CD
     I              BZB4NB                          WDB4NB
     I              BZB5NB                          WDB5NB
     I              BZX5ST                          WDX5ST
     I              BZX6ST                          WDX6ST
     I              BZX7ST                          WDX7ST
     I              BZPCCT                          WDPCCT
     I              BZBDNB                          WDBDNB
     I              BZBJNB                          WDBJNB
     I              BZSUST                          WDSUST
     I              BZSVST                          WDSVST
     I              BZSYST                          WDSYST
     I              BZSZST                          WDSZST
     I              BZS1ST                          WDS1ST
     I              BZXRCD                          WDXRCD
     I              BZXTCD                          WDXTCD
     I              BZXUCD                          WDXUCD
     I              BZF5WG                          WDF5WG
     I              BZF6WG                          WDF6WG
     I              BZF7WG                          WDF7WG
     I              BZBLNB                          WDBLNB
     I              BZBNNB                          WDBNNB
     I              BZS2ST                          WDS2ST
     I              BZS4ST                          WDS4ST
     I              BZS5ST                          WDS5ST
     I              BZS6ST                          WDS6ST
     I              BZS8ST                          WDS8ST
     I              BZS9ST                          WDS9ST
     I              BZTCST                          WDTCST
     I              BZTDST                          WDTDST
     I              BZUVST                          WDUVST
     I              BZUWST                          WDUWST
     I              BZUXST                          WDUXST
     I              BZVSST                          WDVSST
     I              BZAATM                          WDAATM
     I              BZAYNA                          WDAYNA
     I              BZA0NA                          WDA0NA
     I              BZAXDT                          WDAXDT
      *
     I@B0REYY
      * Item Balance              Acitve records only
      * Renamed input format fields
     I              B0AIC3                          WEAIC3
     I              B0HGCD                          WEHGCD
     I              B0AJCD                          WEAJCD
     I              B0AGCS                          WEAGCS
     I              B0AECS                          WEAECS
     I              B0BACS                          WEBACS
     I              B0BBCS                          WEBBCS
     I              B0CBPR                          WECBPR
     I              B0GUDT                          WEGUDT
     I              B0XYST                          WEXYST
     I              B0CTPR                          WECTPR
     I              B0G4DT                          WEG4DT
     I              B0BOWG                          WEBOWG
     I              B0DDQT                          WEDDQT
     I              B0DEQT                          WEDEQT
     I              B0DFQT                          WEDFQT
     I              B0HDQT                          WEHDQT
     I              B0HEQT                          WEHEQT
     I              B0AJQT                          WEAJQT
     I              B0AQQT                          WEAQQT
     I              B0AUQT                          WEAUQT
     I              B0EMQT                          WEEMQT
     I              B0DOQT                          WEDOQT
     I              B0ATNA                          WEATNA
     I              B0AKDT                          WEAKDT
     I              B0ANDT                          WEANDT
     I              B0IDVA                          WEIDVA
     I              B0JVST                          WEJVST
     I              B0BZPC                          WEBZPC
     I              B0DGQT                          WEDGQT
     I              B0DIDT                          WEDIDT
     I              B0ALCD                          WEALCD
     I              B0BFDY                          WEBFDY
     I              B0DJDT                          WEDJDT
     I              B0BGDY                          WEBGDY
     I              B0DKDT                          WEDKDT
     I              B0J2ST                          WEJ2ST
     I              B0DJQT                          WEDJQT
     I              B0BNWG                          WEBNWG
     I              B0DLDT                          WEDLDT
     I              B0DPQT                          WEDPQT
     I              B0DQQT                          WEDQQT
     I              B0DMDT                          WEDMDT
     I              B0M0ST                          WEM0ST
     I              B0J9ST                          WEJ9ST
     I              B0KBST                          WEKBST
     I              B0AKC8                          WEAKC8
     I              B0RINB                          WERINB
     I              B0RHNB                          WERHNB
     I              B0RGNB                          WERGNB
     I              B0UVST                          WEUVST
     I              B0UWST                          WEUWST
     I              B0UXST                          WEUXST
     I              B0VSST                          WEVSST
     I              B0AATM                          WEAATM
     I              B0AYNA                          WEAYNA
     I              B0A0NA                          WEA0NA
     I              B0AXDT                          WEAXDT
      *
     I@L2RESM
      * Warehouse Location        Retrieval index
      * Renamed input format fields
     I              L2AJCD                          WFAJCD
     I              L2YMCD                          WFYMCD
     I              L2YPCD                          WFYPCD
     I              L2LCBY                          WFLCBY
     I              L2LCCT                          WFLCCT
     I              L2WLUS                          WFWLUS
     I              L2WUSD                          WFWUSD
     I              L2WLUN                          WFWLUN
     I              L2AGSX                          WFAGSX
     I              L2UVST                          WFUVST
     I              L2UWST                          WFUWST
     I              L2UXST                          WFUXST
     I              L2VSST                          WFVSST
     I              L2AATM                          WFAATM
     I              L2AYNA                          WFAYNA
     I              L2A0NA                          WFA0NA
     I              L2AXDT                          WFAXDT
      *
     I@L3RET8
      * Warehouse Location Type   Retrieval index
      * Renamed input format fields
     I              MEAGSX                          WGAGSX
     I              MEOPNA                          WGOPNA
     I              MESLTY                          WGSLTY
     I              MEAHSX                          WGAHSX
     I              MEAISX                          WGAISX
     I              MEUVST                          WGUVST
     I              MEUWST                          WGUWST
     I              MEUXST                          WGUXST
     I              MEVSST                          WGVSST
     I              MEAATM                          WGAATM
     I              MEAYNA                          WGAYNA
     I              MEA0NA                          WGA0NA
     I              MEAXDT                          WGAXDT
      *
     I@L5CPSV
      * Item Lot Location         Retrieval index
      * Renamed input format fields
     I              L5AIC3                          WHAIC3
     I              L5HGCD                          WHHGCD
     I              L5AJCD                          WHAJCD
     I              L5ELDT                          WHELDT
     I              L5LXNM                          WHLXNM
     I              L5YMCD                          WHYMCD
     I              L5YNCD                          WHYNCD
     I              L5J2QT                          WHJ2QT
     I              L5G5WG                          WHG5WG
     I              L5J3QT                          WHJ3QT
     I              L5G6WG                          WHG6WG
     I              L5J4QT                          WHJ4QT
     I              L5G7WG                          WHG7WG
     I              L5LODT                          WHLODT
     I              L5LPDT                          WHLPDT
     I              L5LQDT                          WHLQDT
     I              L5NBR                           WHNBR
     I              L5YTCD                          WHYTCD
     I              L5AMSX                          WHAMSX
     I              L5ASSX                          WHASSX
     I              L5ATSX                          WHATSX
     I              L5AUSX                          WHAUSX
     I              L5YSCD                          WHYSCD
     I              L5UVST                          WHUVST
     I              L5UWST                          WHUWST
     I              L5UXST                          WHUXST
     I              L5VSST                          WHVSST
     I              L5AATM                          WHAATM
     I              L5AYNA                          WHAYNA
     I              L5A0NA                          WHA0NA
     I              L5AXDT                          WHAXDT
      *
     I@L7CPUK
      * Item Lot Loc Trans        Co/Itm/Whs/Typ/Dte/Sq(d)
      * Renamed input format fields
     I              L7AIC3                          WIAIC3
     I              L7HGCD                          WIHGCD
     I              L7AJCD                          WIAJCD
     I              L7LTRT                          WILTRT
     I              L7LRDT                          WILRDT
     I              L7LLTS                          WILLTS
     I              L7LSDT                          WILSDT
     I              L7J5QT                          WIJ5QT
     I              L7G8WG                          WIG8WG
     I              L7LLTN                          WILLTN
     I              L7YMCD                          WIYMCD
     I              L7LLCL                          WILLCL
     I              L7BNAA                          WIBNAA
     I              L7LLTR                          WILLTR
     I              L7Y2CD                          WIY2CD
     I              L7LLTL                          WILLTL
     I              L7C4NB                          WIC4NB
     I              L7LOST                          WILOST
     I              L7LLTU                          WILLTU
     I              L7LLYT                          WILLYT
     I              L7UVST                          WIUVST
     I              L7UWST                          WIUWST
     I              L7UXST                          WIUXST
     I              L7VSST                          WIVSST
     I              L7AATM                          WIAATM
     I              L7AYNA                          WIAYNA
     I              L7A0NA                          WIA0NA
     I              L7AXDT                          WIAXDT
      *
     I@L7CPS3
      * Item Lot Loc Trans        Update index
      * Renamed input format fields
     I              L7AIC3                          WJAIC3
     I              L7HGCD                          WJHGCD
     I              L7AJCD                          WJAJCD
     I              L7LTRT                          WJLTRT
     I              L7LRDT                          WJLRDT
     I              L7LLTS                          WJLLTS
     I              L7LSDT                          WJLSDT
     I              L7J5QT                          WJJ5QT
     I              L7G8WG                          WJG8WG
     I              L7LLTN                          WJLLTN
     I              L7YMCD                          WJYMCD
     I              L7LLCL                          WJLLCL
     I              L7BNAA                          WJBNAA
     I              L7LLTR                          WJLLTR
     I              L7Y2CD                          WJY2CD
     I              L7LLTL                          WJLLTL
     I              L7C4NB                          WJC4NB
     I              L7LOST                          WJLOST
     I              L7LLTU                          WJLLTU
     I              L7LLYT                          WJLLYT
     I              L7UVST                          WJUVST
     I              L7UWST                          WJUWST
     I              L7UXST                          WJUXST
     I              L7VSST                          WJVSST
     I              L7AATM                          WJAATM
     I              L7AYNA                          WJAYNA
     I              L7A0NA                          WJA0NA
     I              L7AXDT                          WJAXDT
      *
     I@L5CPSL
      * Item Lot Location         Update index
      * Renamed input format fields
     I              L5AIC3                          WKAIC3
     I              L5HGCD                          WKHGCD
     I              L5AJCD                          WKAJCD
     I              L5ELDT                          WKELDT
     I              L5LXNM                          WKLXNM
     I              L5YMCD                          WKYMCD
     I              L5YNCD                          WKYNCD
     I              L5J2QT                          WKJ2QT
     I              L5G5WG                          WKG5WG
     I              L5J3QT                          WKJ3QT
     I              L5G6WG                          WKG6WG
     I              L5J4QT                          WKJ4QT
     I              L5G7WG                          WKG7WG
     I              L5LODT                          WKLODT
     I              L5LPDT                          WKLPDT
     I              L5LQDT                          WKLQDT
     I              L5NBR                           WKNBR
     I              L5YTCD                          WKYTCD
     I              L5AMSX                          WKAMSX
     I              L5ASSX                          WKASSX
     I              L5ATSX                          WKATSX
     I              L5AUSX                          WKAUSX
     I              L5YSCD                          WKYSCD
     I              L5UVST                          WKUVST
     I              L5UWST                          WKUWST
     I              L5UXST                          WKUXST
     I              L5VSST                          WKVSST
     I              L5AATM                          WKAATM
     I              L5AYNA                          WKAYNA
     I              L5A0NA                          WKA0NA
     I              L5AXDT                          WKAXDT
      *
     I@B0CPD1
      * PFS Inventory Restoration Update index
      * Renamed input format fields
     I              B0Y1NX                          WLY1NX
     I              B0AID8                          WLAID8
     I              B0AFTS                          WLAFTS
     I              B0BCNY                          WLBCNY
     I              B0XKSX                          WLXKSX
     I              B0Y2NX                          WLY2NX
     I              B0U4SX                          WLU4SX
     I              B0ADNY                          WLADNY
     I              B0P7DT                          WLP7DT
     I              B0Z4NX                          WLZ4NX
     I              B0ACNY                          WLACNY
     I              B0CUNY                          WLCUNY
     I              B0CVNY                          WLCVNY
     I              B0UWSX                          WLUWSX
     I              B0UXSX                          WLUXSX
     I              B0V3SX                          WLV3SX
     I              B0AHNY                          WLAHNY
     I              B0AINY                          WLAINY
     I              B0AJNY                          WLAJNY
     I              B0AKNY                          WLAKNY
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IQPDL71    E DSPDL7CPL0
      * UPD : Item Lot Loc Trans        Update index
      * Renamed input format fields
     I              L7AIC3                          WJAIC3
     I              L7HGCD                          WJHGCD
     I              L7AJCD                          WJAJCD
     I              L7LTRT                          WJLTRT
     I              L7LRDT                          WJLRDT
     I              L7LLTS                          WJLLTS
     I              L7LSDT                          WJLSDT
     I              L7J5QT                          WJJ5QT
     I              L7G8WG                          WJG8WG
     I              L7LLTN                          WJLLTN
     I              L7YMCD                          WJYMCD
     I              L7LLCL                          WJLLCL
     I              L7BNAA                          WJBNAA
     I              L7LLTR                          WJLLTR
     I              L7Y2CD                          WJY2CD
     I              L7LLTL                          WJLLTL
     I              L7C4NB                          WJC4NB
     I              L7LOST                          WJLOST
     I              L7LLTU                          WJLLTU
     I              L7LLYT                          WJLLYT
     I              L7UVST                          WJUVST
     I              L7UWST                          WJUWST
     I              L7UXST                          WJUXST
     I              L7VSST                          WJVSST
     I              L7AATM                          WJAATM
     I              L7AYNA                          WJAYNA
     I              L7A0NA                          WJA0NA
     I              L7AXDT                          WJAXDT
      *
     IQPDL51    E DSPDL5CPL0
      * UPD : Item Lot Location         Update index
      * Renamed input format fields
     I              L5AIC3                          WKAIC3
     I              L5HGCD                          WKHGCD
     I              L5AJCD                          WKAJCD
     I              L5ELDT                          WKELDT
     I              L5LXNM                          WKLXNM
     I              L5YMCD                          WKYMCD
     I              L5YNCD                          WKYNCD
     I              L5J2QT                          WKJ2QT
     I              L5G5WG                          WKG5WG
     I              L5J3QT                          WKJ3QT
     I              L5G6WG                          WKG6WG
     I              L5J4QT                          WKJ4QT
     I              L5G7WG                          WKG7WG
     I              L5LODT                          WKLODT
     I              L5LPDT                          WKLPDT
     I              L5LQDT                          WKLQDT
     I              L5NBR                           WKNBR
     I              L5YTCD                          WKYTCD
     I              L5AMSX                          WKAMSX
     I              L5ASSX                          WKASSX
     I              L5ATSX                          WKATSX
     I              L5AUSX                          WKAUSX
     I              L5YSCD                          WKYSCD
     I              L5UVST                          WKUVST
     I              L5UWST                          WKUWST
     I              L5UXST                          WKUXST
     I              L5VSST                          WKVSST
     I              L5AATM                          WKAATM
     I              L5AYNA                          WKAYNA
     I              L5A0NA                          WKA0NA
     I              L5AXDT                          WKAXDT
      *
     IYARDCS      DS                            111
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPPB01    E DSPPB0CPL0
      * UPD : PFS Inventory Restoration Update index
      * Renamed input format fields
     I              B0Y1NX                          WLY1NX
     I              B0AID8                          WLAID8
     I              B0AFTS                          WLAFTS
     I              B0BCNY                          WLBCNY
     I              B0XKSX                          WLXKSX
     I              B0Y2NX                          WLY2NX
     I              B0U4SX                          WLU4SX
     I              B0ADNY                          WLADNY
     I              B0P7DT                          WLP7DT
     I              B0Z4NX                          WLZ4NX
     I              B0ACNY                          WLACNY
     I              B0CUNY                          WLCUNY
     I              B0CVNY                          WLCVNY
     I              B0UWSX                          WLUWSX
     I              B0UXSX                          WLUXSX
     I              B0V3SX                          WLV3SX
     I              B0AHNY                          WLAHNY
     I              B0AINY                          WLAINY
     I              B0AJNY                          WLAJNY
     I              B0AKNY                          WLAKNY
      *
     IYBRDCS      DS                            111
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: PFS Inventory Restoration
      * I :  PFS Company Number
     I                                        1   30P1Y1NX
      * I :  PFS Warehouse Code
     I                                        4   6 P1U4SX
     IP2PARM      DS
      * I :  Program name USR
     I                                        1  10 P2BMVN
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'ESNDMAIL-RESTORATION'
      * Email Address
     I                                        1  50 ZA0001
      * Office Message USR
     I                                       51 182 ZA0002
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1Y1NX    PARM           WP0001  30       PFS Company Num
     C           P1U4SX    PARM           WP0002  3        PFS Warehouse C
     C           P2BMVN    PARM           WP0003 10        Program name US
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * PFS Inventory Rst FRZ XF
      * Rtv PFS Restoration   RT - Warehouse  * 
     C                     EXSR SARVGN
      * CASE: LCL.WHS Live w/Carlisle is Yes
     C           YL0002    IFEQ 'Y'                        *IF
      * I.  Initialize Warehouse on hand to -0-
      * CASE: LCL.Lot Tracking Flag is yes
     C           YL0001    IFEQ 'Y'                        *IF
      * PFS Post Phys Init    XF - Item Lot Location  * 
     C                     CALL 'PPTCXFR'              90  PFS Post Phys I
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1U4SX    WQ0001  3        PFS Warehouse C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPTCXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * Prc Post Phys Init    XF - Item Balance Detail  * 
     C                     CALL 'PPTDXFR'              90  Prc Post Phys I
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'Y'       WQ0002  1        Status - Y or N
     C                     PARM P1U4SX    WQ0003  3        PFS Warehouse C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPTDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * II. Process Warehouse Restoration matching input parm
      * PFS Inventory Rst FRZ RT - PFS Inventory Restoration  * 
     C                     EXSR SBRVGN
      * E3191 JJH 08/07/14 Do not send email if Automated Inv Restoration
      * CASE: PAR.Program name USR is WW PFS Restoration    DF
     C           P2BMVN    IFEQ @CN,005                    *IF
      * Rtv Alpha Value       XF - Company Values  * 
     C                     CALL 'POMTXFR'              90  Rtv Alpha Value
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1Y1NX    WQ0017  30       Company Number
     C                     PARM @CN,006   WQ0018 10        Company Value C
     C           YL0014    PARM *BLANK    WQ0019 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.Email Address is Entered
     C           YL0014    IFNE *BLANK                     *IF
      * E3191 JJH 08/06/14 Chg msg to indicate this is Carlisle Upload
     C                     Z-ADD1         ZQ      50
     C           @CN,007   CAT  @CN,008:ZQYL0015    P      Text USR 43
     C                     Z-ADD1         ZQ      50
     C           YL0015    CAT  P1U4SX:ZQ YL0016    P      Office Message
      * Setup message data for message
     C                     MOVELYL0014    ZA0001           Email Address
     C                     MOVELYL0016    ZA0002           Office Message
      *
      * Execute message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2EXMCC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR4703' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN   7
     C                     END
      *
     C           W0RTN     IFNE *BLANK
      * Error detected during execution
     C                     SETON                     99    *
     C                     END
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv PFS Restoration   RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAJCD           Warehouse Code
      * Setup key
     C                     MOVELP1U4SX    WAAJCD           Warehouse Code
      * Establish starting position
     C           KRSSA     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0001           Lot Tracking Fl
     C                     MOVEL*BLANK    YL0002           WHS Live w/Carl
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAVHST    YL0001           Lot Tracking Fl
     C                     MOVELWARRSX    YL0002           WHS Live w/Carl
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * PFS Inventory Rst FRZ RT - PFS Inventory Restoration  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  1        Production Date
     C                     Z-ADD*ZERO     WN0002  30       Company Number
     C                     Z-ADD*ZERO     WN0003  30       Item Structure
     C                     MOVEL*BLANK    WN0004  3        Item Type Code
     C                     Z-ADD*ZERO     WN0005  52       Fresh Chilling
     C                     MOVEL*BLANK    WN0006  3        Default Warehou
     C                     MOVEL*BLANK    WN0007  6        Primal Group Co
     C                     Z-ADD*ZERO     WN0008  10       PFS Process Sta
     C                     MOVEL*BLANK    WN0009  6        PFS Error Reaso
     C                     Z-ADD*ZERO     WN0010 114       Unit Cost Per P
     C                     MOVEL*BLANK    WN0011  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0012 112       Transaction Qua
     C                     Z-ADD*ZERO     WN0013 112       Transaction Wei
     C                     Z-ADD*ZERO     WN0014  70       Transaction Dat
     C                     Z-ADD*ZERO     WN0015  70       Item Code
     C                     Z-ADD*ZERO     WN0016  70       Production Date
     C                     Z-ADD*ZERO     WN0017  70       Label Date
     C                     MOVEL*BLANK    WN0018  1        Lot Tracking Fl
     C                     MOVEL*BLANK    WN0019  4        Location Code
     C                     MOVEL*BLANK    WN0020  1        ILL Status
     C                     MOVEL*BLANK    WN0021  3        Inv Hold Reason
     C                     Z-ADD*ZERO     WN0022  50       ILL Item Qty On
     C                     Z-ADD*ZERO     WN0023 112       ILl Item Wgt On
     C                     Z-ADD*ZERO     WN0024  20       Location Level
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 09/09/09 PKD E00475 Use System Date instead of Job Date
      * Rtv System Date *CYMD IF
      * LCL.*System timestamp = JOB.*System timestamp
     C                     EXSR XSTMS
     C                     MOVEL##TMS     YL0004           *System timesta
     C                     Z-ADD4         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00026
     C           ZQ        ORGT 00026
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0004:ZQ YL0005    P  90  Year USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00026
     C           ZQ        ORGT 00026
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0004:ZQ YL0006    P  90  Month USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD9         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00026
     C           ZQ        ORGT 00026
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0004:ZQ YL0007    P  90  Day USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           YL0005    CAT  YL0006:ZQ YL0008    P      Date (Char-8) U
     C                     Z-ADD0         ZQ      50
     C           YL0008    CAT  YL0007:ZQ YL0008    P      Date (Char-8) U
     C                     MOVE YL0008    YL0009           DATE
      *
     C                     Z-ADD*ZERO     WN0025  40       Year Code
     C                     Z-ADD*ZERO     WN0026  20       Month
     C                     Z-ADD*ZERO     WN0027  20       Day of Month US
     C                     MOVEL*BLANK    WN0028  4        Year Alpha (YYY
     C                     MOVEL*BLANK    WN0029  2        Month (Char) US
     C                     MOVEL*BLANK    WN0030  2        Day   (Char) US
     C                     Z-ADD*ZERO     WN0031  20       Year  NBR USR
     C                     MOVEL*BLANK    WN0032  2        Year  (Char) US
     C                     MOVEL*BLANK    WN0033  7        Date (Alpha) US
      *
      * CVT *YYMD to *CYMD    IF
      * ** YEAR **
     C           YL0009    DIV  10000     WN0025           Year Code
     C                     Z-ADDWN0025    WN0031           Year  NBR USR
     C                     MOVELWN0031    WN0032           Year  (Char) US
      * ** MONTH **
     C           YL0009    DIV  100       WN0026           Month
     C                     MOVELWN0026    WN0029           Month (Char) US
      * ** DAY **
     C                     Z-ADDYL0009    WN0027           Day of Month US
     C                     MOVELWN0027    WN0030           Day   (Char) US
      * CENTURY+YEAR
      * CASE: PAR.Year Code is Twentieth Century
     C           WN0025    IFLE 1999                       *IF
     C                     Z-ADD0         ZQ      50
     C           '0'       CAT  WN0032:ZQ WN0033    P      Date (Alpha) US
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD0         ZQ      50
     C           '1'       CAT  WN0032:ZQ WN0033    P      Date (Alpha) US
     C                     END                             *FI
     C                     Z-ADD0         ZQ      50
     C           WN0033    CAT  WN0029:ZQ WN0033    P      Date (Alpha) US
     C                     Z-ADD0         ZQ      50
     C           WN0033    CAT  WN0030:ZQ WN0033    P      Date (Alpha) US
     C                     MOVE WN0033    YL0003           Date
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBY1NX    WQSB01           PFS Company Num
     C           *LIKE     DEFN WBU4SX    WQSB02           PFS Warehouse C
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           PFS Company Num
     C                     KFLD           WQSB02           PFS Warehouse C
      * Setup key
     C                     Z-ADDP1Y1NX    WQSB01           PFS Company Num
     C                     MOVELP1U4SX    WQSB02           PFS Warehouse C
      * Establish starting position
     C           KRSSB     SETLL@B0CPEP                    *
     C           KRSSB     READE@B0CPEP                  90*
      * Data record not found
     C   90                MOVEL'USR3580' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0001           Production Date
     C                     Z-ADD*ZERO     WN0002           Company Number
     C                     Z-ADD*ZERO     WN0003           Item Structure
     C                     MOVEL*BLANK    WN0004           Item Type Code
     C                     Z-ADD*ZERO     WN0005           Fresh Chilling
     C                     MOVEL*BLANK    WN0006           Default Warehou
     C                     MOVEL*BLANK    WN0007           Primal Group Co
     C                     Z-ADD*ZERO     WN0008           PFS Process Sta
     C                     MOVEL*BLANK    WN0009           PFS Error Reaso
     C                     Z-ADD*ZERO     WN0010           Unit Cost Per P
     C                     MOVEL*BLANK    WN0011           Warehouse Code
     C                     Z-ADD*ZERO     WN0012           Transaction Qua
     C                     Z-ADD*ZERO     WN0013           Transaction Wei
     C                     Z-ADD*ZERO     WN0014           Transaction Dat
     C                     Z-ADD*ZERO     WN0015           Item Code
     C                     Z-ADD*ZERO     WN0016           Production Date
     C                     Z-ADD*ZERO     WN0017           Label Date
     C                     MOVEL*BLANK    WN0018           Lot Tracking Fl
     C                     MOVEL*BLANK    WN0019           Location Code
     C                     MOVEL*BLANK    WN0020           ILL Status
     C                     MOVEL*BLANK    WN0021           Inv Hold Reason
     C                     Z-ADD*ZERO     WN0022           ILL Item Qty On
     C                     Z-ADD*ZERO     WN0023           ILl Item Wgt On
     C                     Z-ADD*ZERO     WN0024           Location Level
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     Z-ADD0         WN0008           PFS Process Sta
     C                     MOVEL*BLANK    WN0009           PFS Error Reaso
      * ***** VALIDATION *****
     C                     EXSR UASUBR                     ***** VALIDATIO
      * ***** PROCESS RECORD *****
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Initialize
     C                     EXSR UBSUBR                     Initialize
      * ***** FREEZER RESTORATION     *****
      * CASE: PAR.Lot Tracking Flag is yes
     C           WN0018    IFEQ 'Y'                        *IF
      * Upd Loc On hand PFS   RT - Item Lot Location  * 
     C                     EXSR SIRVGN
     C                     END                             *FI
      * ***** FRESH RESTORATION     *****
      * CASE: PAR.Lot Tracking Flag is Not Yes
     C           WN0018    IFEQ *BLANK                     *IF
     C           WN0018    OREQ 'N'
      * Prc Create Dtl Receipt XF - Item Transaction Detail  * 
     C                     CALL 'CAALXFR'              90  Prc Create Dtl
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0002    WQ0004  30       Company Number
     C                     PARM WN0015    WQ0005  70       Item Code
     C                     PARM WN0011    WQ0006  3        Warehouse Code
     C                     PARM 'A'       WQ0007  1        Inventory Trans
     C                     PARM 'AP'      WQ0008  2        Inventory Trans
     C                     PARM WN0014    WQ0009  70       Transaction Dat
     C                     PARM WN0016    WQ0010  70       Production Date
     C                     PARM @CN,003   WQ0011 30        Description
     C                     PARM WN0012    WQ0012 112       Transaction Qua
     C                     PARM WN0013    WQ0013 112       Transaction Wei
     C                     PARM *BLANK    WQ0014  3        Reason Code
     C                     PARM '1'       WQ0015  1        Shift Number
     C                     PARM WN0017    WQ0016  70       Label Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAALXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     Z-ADD1         WN0008           PFS Process Sta
     C                     END                             *FI
      * CASE: PAR.PFS Error Reason is Inactive Transaction
     C           WN0009    IFEQ @CN,004                    *IF
     C                     Z-ADD1         WN0008           PFS Process Sta
     C                     END                             *FI
      * Chg PrcSts/ErrRsn     CH - PFS Inventory Restoration  * 
     C                     EXSR SNCHRC
     C           KRSSB     READE@B0CPEP                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Val Warehouse PFS     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAJCD           Warehouse Code
      * Setup key
     C                     MOVELWN0011    WCAJCD           Warehouse Code
      * Establish starting position
     C           KRSSC     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCVHST    WN0018           Lot Tracking Fl
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Val Itm/Whs,FG/WP PFS2RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDHGCD           Item Code
      * Setup key
     C                     Z-ADDWN0002    WDAIC3           Company Number
     C                     Z-ADDWN0015    WDHGCD           Item Code
      * Establish starting position
     C           KRSSD     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0001           Production Date
     C                     Z-ADD*ZERO     WN0003           Item Structure
     C                     MOVEL*BLANK    WN0004           Item Type Code
     C                     MOVEL*BLANK    WN0006           Default Warehou
     C                     Z-ADD*ZERO     WN0005           Fresh Chilling
     C                     MOVEL*BLANK    WN0007           Primal Group Co
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDFZST    WN0001           Production Date
     C                     Z-ADDWDRGNB    WN0003           Item Structure
     C                     MOVELWDN0CD    WN0004           Item Type Code
     C                     MOVELWDQ1CD    WN0006           Default Warehou
     C                     Z-ADDWDCHTM    WN0005           Fresh Chilling
     C                     MOVELWDXRCD    WN0007           Primal Group Co
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Unit Cost Active   RT - Item Balance  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEHGCD           Item Code
     C                     KFLD           WEAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWBY1NX    WEAIC3           Company Number
     C                     Z-ADDWBY2NX    WEHGCD           Item Code
     C                     MOVELWBU4SX    WEAJCD           Warehouse Code
      * Establish starting position
     C           KRSSE     CHAIN@B0REYY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0328' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0010           Unit Cost Per P
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWEAGCS    WN0010           Unit Cost Per P
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Live w/CT LD/ORD  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WAAJCD           Warehouse Code
      * Setup key
     C                     MOVELWN0011    WAAJCD           Warehouse Code
      * Establish starting position
     C           KRSSF     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0010           WHS Live w/Carl
     C                     MOVEL*BLANK    YL0011           WHS PFS Interfa
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWARRSX    YL0010           WHS Live w/Carl
     C                     MOVELWARSSX    YL0011           WHS PFS Interfa
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Loc Type          RT - Warehouse Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WFAJCD           Warehouse Code
     C                     KFLD           WFYMCD           Location Code
      * Setup key
     C                     MOVELWL0001    WFAJCD           Warehouse Code
     C                     MOVELWL0002    WFYMCD           Location Code
      * Establish starting position
     C           KRSSG     CHAIN@L2RESM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2628' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0003           WLT Type Code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFAGSX    WL0003           WLT Type Code
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Chill Time        RT - Warehouse Location Type  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WGAGSX           WLT Type Code
      * Setup key
     C                     MOVELWL0004    WGAGSX           WLT Type Code
      * Establish starting position
     C           KRSSH     CHAIN@L3RET8              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2660' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0005           WLT Type Chill
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWGSLTY    WL0005           WLT Type Chill
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Upd Loc On hand PFS   RT - Item Lot Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHHGCD           Item Code
     C                     KFLD           WHAJCD           Warehouse Code
     C                     KFLD           WHELDT           Production Date
     C                     KFLD           WHLXNM           Lot Number
     C                     KFLD           WHYMCD           Location Code
     C                     KFLD           WHYNCD           Location Level
      * Setup key
     C                     Z-ADDWN0002    WHAIC3           Company Number
     C                     Z-ADDWN0015    WHHGCD           Item Code
     C                     MOVELWN0011    WHAJCD           Warehouse Code
     C                     Z-ADDWN0016    WHELDT           Production Date
     C                     Z-ADD0         WHLXNM           Lot Number
     C                     MOVELWN0019    WHYMCD           Location Code
     C                     Z-ADDWN0024    WHYNCD           Location Level
      * Establish starting position
     C           KRSSI     CHAIN@L5CPSV              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2634' W0RTN   7
      * USER: Processing if Data record not found
      * Create Trans records with the difference   & Lot loc
     C                     Z-ADDWN0012    WUJ5QT           LLT Trans Qty
     C                     Z-ADDWN0013    WUG8WG           LLT Trans Wgt
      *
     C                     Z-ADD*ZERO     WN0063  30       LLT Sequence #
     C                     MOVEL*BLANK    WN0064  1        EDI Status 1
     C                     MOVEL*BLANK    WN0065  1        EDI Status 2
     C                     MOVEL*BLANK    WN0066  1        EDI Status 3
     C                     MOVEL*BLANK    WN0067  1        Record Status
     C                     Z-ADD*ZERO     WN0068  60       Job Time
     C                     MOVEL*BLANK    WN0069 10        User Id
     C                     MOVEL*BLANK    WN0070 10        Job Name
     C                     Z-ADD*ZERO     WN0071  70       Job Date
      *
      * PFS Item Lot/Loc Trns IF
      * Rtv Next Seq #        RT - IC Item Lot/Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0006           Company Number
     C                     Z-ADDWN0015    WL0007           Item Code
     C                     MOVELWN0011    WL0008    P      Warehouse Code
     C                     MOVEL'AP'      WL0009    P      LLT Trans Type
     C                     Z-ADDWN0014    WL0010           LLT Trans Date
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0011    WN0063           LLT Sequence #
      * Crt Item Lot/Loc Trns CR - Item Lot Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0012           Company Number
     C                     Z-ADDWN0015    WL0013           Item Code
     C                     MOVELWN0011    WL0014    P      Warehouse Code
     C                     MOVEL'AP'      WL0015    P      LLT Trans Type
     C                     Z-ADDWN0014    WL0016           LLT Trans Date
     C                     Z-ADDWN0063    WL0017           LLT Sequence #
     C                     Z-ADDWN0016    WL0018           LLT Production
     C                     Z-ADDWUJ5QT    WL0019           LLT Trans Qty
     C                     Z-ADDWUG8WG    WL0020           LLT Trans Wgt
     C                     Z-ADD0         WL0021           LLT Lot Number
     C                     MOVELWN0019    WL0022    P      Location Code
     C                     Z-ADDWN0024    WL0023           LLT Location Le
     C                     MOVEL*BLANK    WL0024           Transfer Wareho
     C                     Z-ADD0         WL0025           LLT Transfer Lo
     C                     MOVEL*BLANK    WL0026           Transfer Locati
     C                     Z-ADD0         WL0027           LLT Transfer Lo
     C                     Z-ADD0         WL0028           Order Number
     C                     MOVEL'P'       WL0029    P      LLT Status
     C                     MOVELWULLTU    WL0030    P      LTT Unused Sts
     C                     MOVELWULLYT    WL0031    P      LTT Unused Sts
     C                     MOVELWN0064    WL0032    P      EDI Status 1
     C                     MOVELWN0065    WL0033    P      EDI Status 2
     C                     MOVELWN0066    WL0034    P      EDI Status 3
     C                     MOVELWN0067    WL0035    P      Record Status
     C                     Z-ADDWN0068    WL0036           Job Time
     C                     MOVELWN0069    WL0037    P      User Id
     C                     MOVELWN0070    WL0038    P      Job Name
     C                     Z-ADDWN0071    WL0039           Job Date
     C                     EXSR SKCRRC
      * Update on hand qty and weight
      * CASE: PAR.ILL Item Qty On-Hand is NE Zero
     C           WN0012    IFNE 0                          *IF
     C           WN0013    DIV  WN0012    WUG5WG    H      ILL Unit Weight
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD0         WUG5WG           ILL Unit Weight
     C                     END                             *FI
      *
     C                     MOVEL*BLANK    WN0072  1        WLT Type Code
     C                     Z-ADD*ZERO     WN0073  52       WLT Type Chill
      *
      * Clc Loc Avail Shp Dte IF
      * Rtv Loc Type          RT - Warehouse Location  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0011    WL0001    P      Warehouse Code
     C                     MOVELWN0019    WL0002    P      Location Code
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    WN0072    P      WLT Type Code
      * Rtv Chill Time        RT - Warehouse Location Type  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0072    WL0004    P      WLT Type Code
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    WN0073           WLT Type Chill
      * PAR.ILL Avail Ship Date = PAR.Production Date + PAR.WLT Type Chil
     C           WN0016    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDWN0073    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WULODT
     C                     ELSE
     C           XDINDT    SUB  1000000   WULODT
     C                     END
      * Crt Item Loc          CR - Item Lot Location  * 
     C                     EXSR SLCRRC
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Create Trans records with the difference
     C           WN0012    SUB  WHJ2QT    WUJ5QT           LLT Trans Qty
     C           WN0013    SUB  WHG6WG    WUG8WG           LLT Trans Wgt
      *
     C                     Z-ADD*ZERO     WN0074  30       LLT Sequence #
     C                     MOVEL*BLANK    WN0075  1        EDI Status 1
     C                     MOVEL*BLANK    WN0076  1        EDI Status 2
     C                     MOVEL*BLANK    WN0077  1        EDI Status 3
     C                     MOVEL*BLANK    WN0078  1        Record Status
     C                     Z-ADD*ZERO     WN0079  60       Job Time
     C                     MOVEL*BLANK    WN0080 10        User Id
     C                     MOVEL*BLANK    WN0081 10        Job Name
     C                     Z-ADD*ZERO     WN0082  70       Job Date
      *
      * PFS Item Lot/Loc Trns IF
      * Rtv Next Seq #        RT - IC Item Lot/Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0006           Company Number
     C                     Z-ADDWN0015    WL0007           Item Code
     C                     MOVELWN0011    WL0008    P      Warehouse Code
     C                     MOVEL'AP'      WL0009    P      LLT Trans Type
     C                     Z-ADDWN0014    WL0010           LLT Trans Date
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0011    WN0074           LLT Sequence #
      * Crt Item Lot/Loc Trns CR - Item Lot Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0012           Company Number
     C                     Z-ADDWN0015    WL0013           Item Code
     C                     MOVELWN0011    WL0014    P      Warehouse Code
     C                     MOVEL'AP'      WL0015    P      LLT Trans Type
     C                     Z-ADDWN0014    WL0016           LLT Trans Date
     C                     Z-ADDWN0074    WL0017           LLT Sequence #
     C                     Z-ADDWN0016    WL0018           LLT Production
     C                     Z-ADDWUJ5QT    WL0019           LLT Trans Qty
     C                     Z-ADDWUG8WG    WL0020           LLT Trans Wgt
     C                     Z-ADD0         WL0021           LLT Lot Number
     C                     MOVELWN0019    WL0022    P      Location Code
     C                     Z-ADDWN0024    WL0023           LLT Location Le
     C                     MOVEL*BLANK    WL0024           Transfer Wareho
     C                     Z-ADD0         WL0025           LLT Transfer Lo
     C                     MOVEL*BLANK    WL0026           Transfer Locati
     C                     Z-ADD0         WL0027           LLT Transfer Lo
     C                     Z-ADD0         WL0028           Order Number
     C                     MOVEL'P'       WL0029    P      LLT Status
     C                     MOVELWULLTU    WL0030    P      LTT Unused Sts
     C                     MOVELWULLYT    WL0031    P      LTT Unused Sts
     C                     MOVELWN0075    WL0032    P      EDI Status 1
     C                     MOVELWN0076    WL0033    P      EDI Status 2
     C                     MOVELWN0077    WL0034    P      EDI Status 3
     C                     MOVELWN0078    WL0035    P      Record Status
     C                     Z-ADDWN0079    WL0036           Job Time
     C                     MOVELWN0080    WL0037    P      User Id
     C                     MOVELWN0081    WL0038    P      Job Name
     C                     Z-ADDWN0082    WL0039           Job Date
     C                     EXSR SKCRRC
      * Update on hand qty and weight
      * CASE: PAR.ILL Item Qty On-Hand is NE Zero
     C           WN0012    IFNE 0                          *IF
     C           WN0013    DIV  WN0012    WUG5WG    H      ILL Unit Weight
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD0         WUG5WG           ILL Unit Weight
     C                     END                             *FI
      *
     C                     MOVEL*BLANK    WN0083  1        WLT Type Code
     C                     Z-ADD*ZERO     WN0084  52       WLT Type Chill
      *
      * Clc Loc Avail Shp Dte IF
      * Rtv Loc Type          RT - Warehouse Location  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWHAJCD    WL0001    P      Warehouse Code
     C                     MOVELWHYMCD    WL0002    P      Location Code
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    WN0083    P      WLT Type Code
      * Rtv Chill Time        RT - Warehouse Location Type  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0083    WL0004    P      WLT Type Code
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    WN0084           WLT Type Chill
      * PAR.ILL Avail Ship Date = PAR.Production Date + PAR.WLT Type Chil
     C           WHELDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDWN0084    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WULODT
     C                     ELSE
     C           XDINDT    SUB  1000000   WULODT
     C                     END
      * Chg Loc On hand PFS   CH - Item Lot Location  * 
     C                     EXSR SMCHRC
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Next Seq #        RT - IC Item Lot/Loc Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIAIC3    WQSJ01           Company Number
     C           *LIKE     DEFN WIHGCD    WQSJ02           Item Code
     C           *LIKE     DEFN WIAJCD    WQSJ03           Warehouse Code
     C           *LIKE     DEFN WILTRT    WQSJ04           LLT Trans Type
     C           *LIKE     DEFN WILRDT    WQSJ05           LLT Trans Date
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           Item Code
     C                     KFLD           WQSJ03           Warehouse Code
     C                     KFLD           WQSJ04           LLT Trans Type
     C                     KFLD           WQSJ05           LLT Trans Date
      * Setup key
     C                     Z-ADDWL0006    WQSJ01           Company Number
     C                     Z-ADDWL0007    WQSJ02           Item Code
     C                     MOVELWL0008    WQSJ03           Warehouse Code
     C                     MOVELWL0009    WQSJ04           LLT Trans Type
     C                     Z-ADDWL0010    WQSJ05           LLT Trans Date
      * Establish starting position
     C           KRSSJ     SETLL@L7CPUK                    *
     C           KRSSJ     READE@L7CPUK                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2638' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WL0011           LLT Sequence #
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WILLTS    ADD  1         WL0011           LLT Sequence #
     C                     GOTO SJEXIT                     *QUIT
     C           KRSSJ     READE@L7CPUK                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCRRC    BEGSR
      *================================================================
      * Crt Item Lot/Loc Trns CR - Item Lot Loc Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @L7CPS3
     C                     Z-ADDWL0012    WJAIC3           Company Number
     C                     Z-ADDWL0013    WJHGCD           Item Code
     C                     MOVELWL0014    WJAJCD           Warehouse Code
     C                     MOVELWL0015    WJLTRT           LLT Trans Type
     C                     Z-ADDWL0016    WJLRDT           LLT Trans Date
     C                     Z-ADDWL0017    WJLLTS           LLT Sequence #
     C                     Z-ADDWL0018    WJLSDT           LLT Production
     C                     Z-ADDWL0019    WJJ5QT           LLT Trans Qty
     C                     Z-ADDWL0020    WJG8WG           LLT Trans Wgt
     C                     Z-ADDWL0021    WJLLTN           LLT Lot Number
     C                     MOVELWL0022    WJYMCD           Location Code
     C                     Z-ADDWL0023    WJLLCL           LLT Location Le
     C                     MOVELWL0024    WJBNAA           Transfer Wareho
     C                     Z-ADDWL0025    WJLLTR           LLT Transfer Lo
     C                     MOVELWL0026    WJY2CD           Transfer Locati
     C                     Z-ADDWL0027    WJLLTL           LLT Transfer Lo
     C                     Z-ADDWL0028    WJC4NB           Order Number
     C                     MOVELWL0029    WJLOST           LLT Status
     C                     MOVELWL0030    WJLLTU           LTT Unused Sts
     C                     MOVELWL0031    WJLLYT           LTT Unused Sts
     C                     MOVELWL0032    WJUVST           EDI Status 1
     C                     MOVELWL0033    WJUWST           EDI Status 2
     C                     MOVELWL0034    WJUXST           EDI Status 3
     C                     MOVELWL0035    WJVSST           Record Status
     C                     Z-ADDWL0036    WJAATM           Job Time
     C                     MOVELWL0037    WJAYNA           User Id
     C                     MOVELWL0038    WJA0NA           Job Name
     C                     Z-ADDWL0039    WJAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WJVSST           Record Status
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL##USR     WJAYNA           User Id
     C                     MOVEL##JOB     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
     C           KLCRSK    KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJHGCD           Item Code
     C                     KFLD           WJAJCD           Warehouse Code
     C                     KFLD           WJLTRT           LLT Trans Type
     C                     KFLD           WJLRDT           LLT Trans Date
     C                     KFLD           WJLLTS           LLT Sequence #
      * Check for duplicate primary key
     C           KLCRSK    SETLL@L7CPS3                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2639' W0RTN   7
      * Send message 'Item Lot Loc Trans     EX'
     C                     MOVEL'USR2639' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C                     WRITE@L7CPS3                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCRRC    BEGSR
      *================================================================
      * Crt Item Loc          CR - Item Lot Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @L5CPSL
     C                     Z-ADDWN0002    WKAIC3           Company Number
     C                     Z-ADDWN0015    WKHGCD           Item Code
     C                     MOVELWN0011    WKAJCD           Warehouse Code
     C                     Z-ADDWN0016    WKELDT           Production Date
     C                     Z-ADD0         WKLXNM           Lot Number
     C                     MOVELWN0019    WKYMCD           Location Code
     C                     Z-ADDWN0024    WKYNCD           Location Level
     C                     Z-ADDWN0012    WKJ2QT           ILL Item Qty On
     C                     Z-ADDWUG5WG    WKG5WG           ILL Unit Weight
     C                     Z-ADD0         WKJ3QT           ILL Co-Packer L
     C                     Z-ADDWN0013    WKG6WG           ILl Item Wgt On
     C                     Z-ADD0         WKJ4QT           ILL Unused Qty
     C                     Z-ADD0         WKG7WG           ILL Unused Wgt
     C                     Z-ADDWULODT    WKLODT           ILL Avail Ship
     C                     Z-ADD0         WKLPDT           ILL Unused Date
     C                     Z-ADD0         WKLQDT           ILL Unused Date
     C                     Z-ADD0         WKNBR            ILL Unused Nbr
     C                     MOVEL*BLANK    WKYTCD           ILL Customer Co
     C                     MOVELWN0020    WKAMSX           ILL Status
     C                     MOVELWUASSX    WKASSX           ILL Unused Sts
     C                     MOVELWUATSX    WKATSX           ILL Unused Sts
     C                     MOVELWUAUSX    WKAUSX           ILL Unused Sts
     C                     MOVELWN0021    WKYSCD           Inv Hold Reason
     C                     MOVELWUUVST    WKUVST           EDI Status 1
     C                     MOVELWUUWST    WKUWST           EDI Status 2
     C                     MOVELWUUXST    WKUXST           EDI Status 3
     C                     MOVEL'A'       WKVSST           Record Status
     C                     Z-ADD0         WKAATM           Job Time
     C                     MOVEL*BLANK    WKAYNA           User Id
     C                     MOVEL*BLANK    WKA0NA           Job Name
     C                     Z-ADD0         WKAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WKVSST           Record Status
     C                     Z-ADD##JTM     WKAATM           Job Time
     C                     MOVEL##USR     WKAYNA           User Id
     C                     MOVEL##JOB     WKA0NA           Job Name
     C                     Z-ADD##JDT     WKAXDT           Job Date
     C           KLCRSL    KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKHGCD           Item Code
     C                     KFLD           WKAJCD           Warehouse Code
     C                     KFLD           WKELDT           Production Date
     C                     KFLD           WKLXNM           Lot Number
     C                     KFLD           WKYMCD           Location Code
     C                     KFLD           WKYNCD           Location Level
      * Check for duplicate primary key
     C           KLCRSL    SETLL@L5CPSL                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2635' W0RTN   7
      * Send message 'Item Lot Location      EX'
     C                     MOVEL'USR2635' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C                     WRITE@L5CPSL                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCHRC    BEGSR
      *================================================================
      * Chg Loc On hand PFS   CH - Item Lot Location  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0085  50       ILL Co-Packer L
     C                     Z-ADD*ZERO     WN0086  50       ILL Unused Qty
     C                     Z-ADD*ZERO     WN0087 112       ILL Unused Wgt
     C                     Z-ADD*ZERO     WN0088  70       ILL Unused Date
     C                     Z-ADD*ZERO     WN0089  70       ILL Unused Date
     C                     Z-ADD*ZERO     WN0090  72       ILL Unused Nbr
     C                     MOVEL*BLANK    WN0091  6        ILL Customer Co
     C                     MOVEL*BLANK    WN0092  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0093  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0094  2        ILL Unused Sts
     C                     MOVEL*BLANK    WN0095  1        EDI Status 1
     C                     MOVEL*BLANK    WN0096  1        EDI Status 2
     C                     MOVEL*BLANK    WN0097  1        EDI Status 3
     C                     MOVEL*BLANK    WN0098  1        Record Status
     C                     Z-ADD*ZERO     WN0099  60       Job Time
     C                     MOVEL*BLANK    WN0100 10        User Id
     C                     MOVEL*BLANK    WN0101 10        Job Name
     C                     Z-ADD*ZERO     WN0102  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @L5CPSL
     C                     Z-ADDWHAIC3    WKAIC3           Company Number
     C                     Z-ADDWHHGCD    WKHGCD           Item Code
     C                     MOVELWHAJCD    WKAJCD    P      Warehouse Code
     C                     Z-ADDWHELDT    WKELDT           Production Date
     C                     Z-ADDWHLXNM    WKLXNM           Lot Number
     C                     MOVELWHYMCD    WKYMCD    P      Location Code
     C                     Z-ADDWHYNCD    WKYNCD           Location Level
      *
     C           KLCHSM    KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKHGCD           Item Code
     C                     KFLD           WKAJCD           Warehouse Code
     C                     KFLD           WKELDT           Production Date
     C                     KFLD           WKLXNM           Lot Number
     C                     KFLD           WKYMCD           Location Code
     C                     KFLD           WKYNCD           Location Level
     C           KLCHSM    CHAIN@L5CPSL              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDL5CPL0'MDACP
     C                     MOVEL'@L5CPSL' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDL51    YARDCS
      * Move non-key fields to @L5CPSL
     C                     Z-ADDWN0012    WKJ2QT           ILL Item Qty On
     C                     Z-ADDWUG5WG    WKG5WG           ILL Unit Weight
     C                     Z-ADDWN0013    WKG6WG           ILl Item Wgt On
     C                     Z-ADDWULODT    WKLODT           ILL Avail Ship
     C                     MOVELWN0020    WKAMSX    P      ILL Status
     C                     MOVELWN0021    WKYSCD    P      Inv Hold Reason
      *
      * Set PGM.*Record Data Changed flag
     C           QPDL51    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WKAATM           Job Time
     C                     MOVEL##USR     WKAYNA           User Id
     C                     MOVEL##JOB     WKA0NA           Job Name
     C                     Z-ADD##JDT     WKAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDL51    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@L5CPSL                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDL5CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNCHRC    BEGSR
      *================================================================
      * Chg PrcSts/ErrRsn     CH - PFS Inventory Restoration  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @B0CPD1
     C                     Z-ADDWBY1NX    WLY1NX           PFS Company Num
     C                     Z-ADDWBAID8    WLAID8           PFS Transaction
     C                     Z-ADDWBAFTS    WLAFTS           PFS Transaction
     C                     Z-ADDWBBCNY    WLBCNY           PFS Transaction
      *
     C           KLCHSN    KLIST
     C                     KFLD           WLY1NX           PFS Company Num
     C                     KFLD           WLAID8           PFS Transaction
     C                     KFLD           WLAFTS           PFS Transaction
     C                     KFLD           WLBCNY           PFS Transaction
     C           KLCHSN    CHAIN@B0CPD1              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PPB0CPL0'MDACP
     C                     MOVEL'@B0CPD1' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPPB01    YBRDCS
      * Move non-key fields to @B0CPD1
     C                     MOVELWBXKSX    WLXKSX    P      PFS Inv Hold Re
     C                     Z-ADDWBY2NX    WLY2NX           PFS Item Code
     C                     MOVELWBU4SX    WLU4SX    P      PFS Warehouse C
     C                     Z-ADDWBADNY    WLADNY           PFS Location Co
     C                     Z-ADDWBP7DT    WLP7DT           PFS Production
     C                     Z-ADDWBZ4NX    WLZ4NX           PFS Label Date
     C                     Z-ADDWBACNY    WLACNY           PFS Receive/Loc
     C                     Z-ADDWBCUNY    WLCUNY           PFS On Hand Qua
     C                     Z-ADDWBCVNY    WLCVNY           PFS On Hand Wei
     C                     MOVELWBUWSX    WLUWSX    P      PFS Record Stat
     C                     Z-ADDWN0008    WLUXSX           PFS Process Sta
     C                     MOVELWN0009    WLV3SX    P      PFS Error Reaso
     C                     Z-ADDWBAHNY    WLAHNY           PFS Create Date
     C                     Z-ADDWBAINY    WLAINY           PFS Create Time
     C                     Z-ADDWBAJNY    WLAJNY           PFS Change Date
     C                     Z-ADDWBAKNY    WLAKNY           PFS Change time
      *
      * Set PGM.*Record Data Changed flag
     C           QPPB01    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@B0CPD1                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPPB0CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** VALIDATION *****
      *================================================================
     C                     Z-ADDWBY1NX    WN0002           Company Number
     C                     Z-ADDWBY2NX    WN0015           Item Code
     C                     MOVELWBU4SX    WN0011           Warehouse Code
      * Val Warehouse PFS     RT - Warehouse  * 
     C                     EXSR SCRVGN
      * Warehouse Not Found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,002                    *IF
     C                     Z-ADD2         WN0008           PFS Process Sta
     C                     MOVEL'WHSCDE'  WN0009           PFS Error Reaso
     C                     END                             *FI
      * Lot Tracking is Yes: Location Code & Receive/Located Date
      * CASE: PAR.Lot Tracking Flag is yes
     C           WN0018    IFEQ 'Y'                        *IF
      * 12/16/08 PKD A decision was made to use Production Date instead
      *              of Receive/Locate Date.  This Date is not valid in
      *              Carlisle sometimes.
     C                     END                             *FI
      * 12/05/08 PKD Don't worry about inactive items.
      * Val Itm/Whs,FG/WP PFS2RT - Company Item  * 
     C                     EXSR SDRVGN
      * Item Code Not Found
      * CASE:
      *  - c1 OR c2 OR c3
      *   |- c1    : PGM.*Return code is *Record does not exist
      *   |- c2    : PAR.Primal Group Code is Scale Check
      *   |- c3    : PAR.Item Type Code is Not FG/WP
      *   '-
     C           W0RTN     IFEQ @CN,002                    *IF
     C           WN0007    OREQ 'SCALE'                    *OR
     C           WN0004    OREQ *BLANK                     *OR
     C           WN0004    OREQ 'PS'
     C           WN0004    OREQ 'RM'
     C           WN0004    OREQ 'EX'
     C                     Z-ADD2         WN0008           PFS Process Sta
     C                     MOVEL'ITMCDE'  WN0009           PFS Error Reaso
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
      * RTV Unit Cost Active   RT - Item Balance  * 
     C                     EXSR SERVGN
      * Label Date Not Entered
      * CASE: PAR.Production Date Control is yes
     C           WN0001    IFEQ 'Y'                        *IF
      * CASE: PAR.Lot Tracking Flag is yes
     C           WN0018    IFEQ 'Y'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.PFS Label Date is Not Entered
     C           WBZ4NX    IFEQ 0                          *IF
     C                     Z-ADD2         WN0008           PFS Process Sta
     C                     MOVEL'LBLDTE'  WN0009           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Rtv Live w/CT LD/ORD  RT - Warehouse  * 
     C                     EXSR SFRVGN
      * VAL:  ACTIVE WAREHOUSE
      * CASE: LCL.WHS Live w/Carlisle is Yes
     C           YL0010    IFEQ 'Y'                        *IF
      * CASE: LCL.WHS PFS Interface is Upload/Both
     C           YL0011    IFEQ 'U'                        *IF
     C           YL0011    OREQ 'B'
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD2         WN0008           PFS Process Sta
     C                     MOVEL'INACTV'  WN0009           PFS Error Reaso
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD2         WN0008           PFS Process Sta
     C                     MOVEL'INACTV'  WN0009           PFS Error Reaso
     C                     END                             *FI
      * ERROR:  DO NOT SELECT RECORD
      * CASE: PAR.PFS Process Status is Error
     C           WN0008    IFEQ 2                          *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
      * Warehouse Not Matching Par              9.20.05
      * CASE: DB1.PFS Warehouse Code NE PAR.PFS Warehouse Code
     C           WBU4SX    IFNE P1U4SX                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Initialize
      *================================================================
      * --- Transaction Date ---
     C                     Z-ADDYL0003    WN0014           Transaction Dat
      * ------------------------
      * Production & Label Date
      * CASE: PAR.Production Date Control is yes
     C           WN0001    IFEQ 'Y'                        *IF
      * 03/12/09 PKD Carlisle is sending the Label Date in the Production
      *              Date field instead of the Label Date field for the
      *              Freezer Restoration.
      * Lot Tracking = Y or N
      * CASE: PAR.Lot Tracking Flag is yes
     C           WN0018    IFEQ 'Y'                        *IF
      * LCL.PFS Production Date
      * CASE: DB1.PFS Production Date is Not Entered
     C           WBP7DT    IFEQ 0                          *IF
      * CASE: DB1.PFS Label Date is Entered
     C           WBZ4NX    IFNE 0                          *IF
     C                     Z-ADDWBZ4NX    YL0012           PFS Production
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWBACNY    YL0012           PFS Production
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWBP7DT    YL0012           PFS Production
     C                     END                             *FI
     C                     Z-ADD0         WN0016           Production Date
     C                     Z-ADD0         WN0017           Label Date
      * --- Receive date = Lot Loc Production Date ---
      * 12/16/08 PKD A decision was made to use Production Date instead
      *              of Receive/Locate Date.  This Date is not valid in
      *              Carlisle sometimes.
      * 04/02/09 PKD Use IF instead of CL to convert date.
      *
     C                     Z-ADD*ZERO     WN0034  40       Year Code
     C                     Z-ADD*ZERO     WN0035  20       Month
     C                     Z-ADD*ZERO     WN0036  20       Day of Month US
     C                     MOVEL*BLANK    WN0037  4        Year Alpha (YYY
     C                     MOVEL*BLANK    WN0038  2        Month (Char) US
     C                     MOVEL*BLANK    WN0039  2        Day   (Char) US
     C                     Z-ADD*ZERO     WN0040  20       Year  NBR USR
     C                     MOVEL*BLANK    WN0041  2        Year  (Char) US
     C                     MOVEL*BLANK    WN0042  7        Date (Alpha) US
      *
      * CVT *YYMD to *CYMD    IF
      * ** YEAR **
     C           YL0012    DIV  10000     WN0034           Year Code
     C                     Z-ADDWN0034    WN0040           Year  NBR USR
     C                     MOVELWN0040    WN0041           Year  (Char) US
      * ** MONTH **
     C           YL0012    DIV  100       WN0035           Month
     C                     MOVELWN0035    WN0038           Month (Char) US
      * ** DAY **
     C                     Z-ADDYL0012    WN0036           Day of Month US
     C                     MOVELWN0036    WN0039           Day   (Char) US
      * CENTURY+YEAR
      * CASE: PAR.Year Code is Twentieth Century
     C           WN0034    IFLE 1999                       *IF
     C                     Z-ADD0         ZQ      50
     C           '0'       CAT  WN0041:ZQ WN0042    P      Date (Alpha) US
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD0         ZQ      50
     C           '1'       CAT  WN0041:ZQ WN0042    P      Date (Alpha) US
     C                     END                             *FI
     C                     Z-ADD0         ZQ      50
     C           WN0042    CAT  WN0038:ZQ WN0042    P      Date (Alpha) US
     C                     Z-ADD0         ZQ      50
     C           WN0042    CAT  WN0039:ZQ WN0042    P      Date (Alpha) US
     C                     MOVE WN0042    WN0016           Date
     C                     Z-ADDWN0016    WN0017           Label Date
     C                     ELSE
      * CASE: *OTHERWISE
      * --- Production Date ---
      * 04/02/09 PKD Use IF instead of CL to convert date.
      *
     C                     Z-ADD*ZERO     WN0043  40       Year Code
     C                     Z-ADD*ZERO     WN0044  20       Month
     C                     Z-ADD*ZERO     WN0045  20       Day of Month US
     C                     MOVEL*BLANK    WN0046  4        Year Alpha (YYY
     C                     MOVEL*BLANK    WN0047  2        Month (Char) US
     C                     MOVEL*BLANK    WN0048  2        Day   (Char) US
     C                     Z-ADD*ZERO     WN0049  20       Year  NBR USR
     C                     MOVEL*BLANK    WN0050  2        Year  (Char) US
     C                     MOVEL*BLANK    WN0051  7        Date (Alpha) US
      *
      * CVT *YYMD to *CYMD    IF
      * ** YEAR **
     C           WBP7DT    DIV  10000     WN0043           Year Code
     C                     Z-ADDWN0043    WN0049           Year  NBR USR
     C                     MOVELWN0049    WN0050           Year  (Char) US
      * ** MONTH **
     C           WBP7DT    DIV  100       WN0044           Month
     C                     MOVELWN0044    WN0047           Month (Char) US
      * ** DAY **
     C                     Z-ADDWBP7DT    WN0045           Day of Month US
     C                     MOVELWN0045    WN0048           Day   (Char) US
      * CENTURY+YEAR
      * CASE: PAR.Year Code is Twentieth Century
     C           WN0043    IFLE 1999                       *IF
     C                     Z-ADD0         ZQ      50
     C           '0'       CAT  WN0050:ZQ WN0051    P      Date (Alpha) US
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD0         ZQ      50
     C           '1'       CAT  WN0050:ZQ WN0051    P      Date (Alpha) US
     C                     END                             *FI
     C                     Z-ADD0         ZQ      50
     C           WN0051    CAT  WN0047:ZQ WN0051    P      Date (Alpha) US
     C                     Z-ADD0         ZQ      50
     C           WN0051    CAT  WN0048:ZQ WN0051    P      Date (Alpha) US
     C                     MOVE WN0051    WN0016           Date
      * --- Label Date ---
      * 04/02/09 PKD Use IF instead of CL to convert date.
      *
     C                     Z-ADD*ZERO     WN0052  40       Year Code
     C                     Z-ADD*ZERO     WN0053  20       Month
     C                     Z-ADD*ZERO     WN0054  20       Day of Month US
     C                     MOVEL*BLANK    WN0055  4        Year Alpha (YYY
     C                     MOVEL*BLANK    WN0056  2        Month (Char) US
     C                     MOVEL*BLANK    WN0057  2        Day   (Char) US
     C                     Z-ADD*ZERO     WN0058  20       Year  NBR USR
     C                     MOVEL*BLANK    WN0059  2        Year  (Char) US
     C                     MOVEL*BLANK    WN0060  7        Date (Alpha) US
      *
      * CVT *YYMD to *CYMD    IF
      * ** YEAR **
     C           WBZ4NX    DIV  10000     WN0052           Year Code
     C                     Z-ADDWN0052    WN0058           Year  NBR USR
     C                     MOVELWN0058    WN0059           Year  (Char) US
      * ** MONTH **
     C           WBZ4NX    DIV  100       WN0053           Month
     C                     MOVELWN0053    WN0056           Month (Char) US
      * ** DAY **
     C                     Z-ADDWBZ4NX    WN0054           Day of Month US
     C                     MOVELWN0054    WN0057           Day   (Char) US
      * CENTURY+YEAR
      * CASE: PAR.Year Code is Twentieth Century
     C           WN0052    IFLE 1999                       *IF
     C                     Z-ADD0         ZQ      50
     C           '0'       CAT  WN0059:ZQ WN0060    P      Date (Alpha) US
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD0         ZQ      50
     C           '1'       CAT  WN0059:ZQ WN0060    P      Date (Alpha) US
     C                     END                             *FI
     C                     Z-ADD0         ZQ      50
     C           WN0060    CAT  WN0056:ZQ WN0060    P      Date (Alpha) US
     C                     Z-ADD0         ZQ      50
     C           WN0060    CAT  WN0057:ZQ WN0060    P      Date (Alpha) US
     C                     MOVE WN0060    WN0017           Date
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Production Date is not entered
      *   |- c2    : PAR.Production Date Control is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0016    IFEQ 0                          *IF
     C           WN0001    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWN0017    WN0016           Production Date
     C                     END                             *FI
      * Rtv Prod date with label date. carlisle is not to be trusted.
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD0         WN0016           Production Date
     C                     Z-ADD0         WN0017           Label Date
     C                     END                             *FI
     C                     Z-ADDWBCUNY    WN0012           Transaction Qua
     C                     Z-ADDWBCVNY    WN0013           Transaction Wei
      * LOT TRACKING WAREHOUSE
      * CASE: PAR.Lot Tracking Flag is yes
     C           WN0018    IFEQ 'Y'                        *IF
      * 12/16/08 PKD A decision was made to use Production Date instead
      *              of Receive/Locate Date.  This Date is not valid in
      *              Carlisle sometimes.
      * ----- Receive/Located Date -----
      * ----- Location Code -----
      * 01/09/09 PKD Default to location 7777
     C                     MOVEL'7777'    WN0019           Location Code
      * ----- Location Level -----
     C                     MOVE WBXKSX    WN0024           Location Level
     C                     MOVEL*BLANK    WN0021           Inv Hold Reason
     C                     MOVEL'A'       WN0020           ILL Status
      *
     C                     MOVEL*BLANK    WN0061  1        WLT Type Code
     C                     Z-ADD*ZERO     WN0062  52       WLT Type Chill
      *
      * Clc Loc Avail Shp Dte IF
      * Rtv Loc Type          RT - Warehouse Location  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0011    WL0001    P      Warehouse Code
     C                     MOVELWN0019    WL0002    P      Location Code
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    WN0061    P      WLT Type Code
      * Rtv Chill Time        RT - Warehouse Location Type  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0061    WL0004    P      WLT Type Code
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    WN0062           WLT Type Chill
      * PAR.ILL Avail Ship Date = PAR.Production Date + PAR.WLT Type Chil
     C           WN0016    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDWN0062    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0013
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0013
     C                     END
      * ILL Status
      * CASE:
      *  - c1 OR (c2 AND c3)
      *   |- c1    : LCL.ILL Avail Ship Date GT LCL.System Date USR
      *   |- c2    : PAR.Location Level is Entered
      *   |- c3    : PAR.Location Level is NE 60
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0013    IFGT YL0003                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WN0024    IFNE 0                          *IF
     C           WN0024    IFNE 60                         *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'H'       WN0020           ILL Status
     C                     END                             *FI
      * Hold Reason
      * CASE: LCL.ILL Avail Ship Date GT LCL.System Date USR
     C           YL0013    IFGT YL0003                     *IF
     C                     MOVEL*BLANK    WN0021           Inv Hold Reason
     C                     MOVEL'Q1'      WN0021           Inv Hold Reason
     C                     ELSE
      * CASE: DB1.PFS Inv Hold Reason Code is Q2 QA HOLD (Aged-Frozen)
     C           WBXKSX    IFEQ '7'                        *IF
     C                     MOVEL*BLANK    WN0021           Inv Hold Reason
     C                     MOVEL'Q2'      WN0021           Inv Hold Reason
     C                     ELSE
      * CASE: DB1.PFS Inv Hold Reason Code is Q3 QA HOLD
     C           WBXKSX    IFEQ '8'                        *IF
     C                     MOVEL*BLANK    WN0021           Inv Hold Reason
     C                     MOVEL'Q3'      WN0021           Inv Hold Reason
     C                     ELSE
      * CASE: DB1.PFS Inv Hold Reason Code is S1 Shipping Hold (WIP)
     C           WBXKSX    IFEQ '3'                        *IF
     C                     MOVEL*BLANK    WN0021           Inv Hold Reason
     C                     MOVEL'S1'      WN0021           Inv Hold Reason
     C                     ELSE
      * CASE: DB1.PFS Inv Hold Reason Code is S2 Shipping Hold (920i)
     C           WBXKSX    IFEQ '4'                        *IF
     C                     MOVEL*BLANK    WN0021           Inv Hold Reason
     C                     MOVEL'S2'      WN0021           Inv Hold Reason
     C                     ELSE
      * CASE: DB1.PFS Inv Hold Reason Code is S3 Shipping Hold
     C           WBXKSX    IFEQ '5'                        *IF
     C                     MOVEL*BLANK    WN0021           Inv Hold Reason
     C                     MOVEL'S3'      WN0021           Inv Hold Reason
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANKS   WN0019           Location Code
     C                     Z-ADD0         WN0024           Location Level
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XSTMS     BEGSR
      *================================================================
      * Refresh System timestamp
      *================================================================
     C                     CALL 'Y2RTTSK'
     C                     PARM           ##TMS  26        System timestam
      *================================================================
     CSR         XSTMSE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WADBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WABWC3           Shipping Compan
     C                     Z-ADD*ZERO     WABTC3           Accounting Comp
     C                     Z-ADD*ZERO     WABUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WABVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBY1NX           PFS Company Num
     C                     Z-ADD*ZERO     WBAID8           PFS Transaction
     C                     Z-ADD*ZERO     WBAFTS           PFS Transaction
     C                     Z-ADD*ZERO     WBBCNY           PFS Transaction
     C                     Z-ADD*ZERO     WBY2NX           PFS Item Code
     C                     Z-ADD*ZERO     WBADNY           PFS Location Co
     C                     Z-ADD*ZERO     WBP7DT           PFS Production
     C                     Z-ADD*ZERO     WBZ4NX           PFS Label Date
     C                     Z-ADD*ZERO     WBACNY           PFS Receive/Loc
     C                     Z-ADD*ZERO     WBCUNY           PFS On Hand Qua
     C                     Z-ADD*ZERO     WBCVNY           PFS On Hand Wei
     C                     Z-ADD*ZERO     WBUXSX           PFS Process Sta
     C                     Z-ADD*ZERO     WBAHNY           PFS Create Date
     C                     Z-ADD*ZERO     WBAINY           PFS Create Time
     C                     Z-ADD*ZERO     WBAJNY           PFS Change Date
     C                     Z-ADD*ZERO     WBAKNY           PFS Change time
     C                     MOVE '0'       XDTSDL 26 P
     C                     MOVEL@CN,001   XDTSDL
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDHGCD           Item Code
     C                     Z-ADD*ZERO     WDAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WDAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WDAIWG           Unit Weight
     C                     Z-ADD*ZERO     WDCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WDC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WDURTN           Number Cases On
     C                     Z-ADD*ZERO     WDAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WDRINB           Item Structure
     C                     Z-ADD*ZERO     WDRHNB           Item Structure
     C                     Z-ADD*ZERO     WDRGNB           Item Structure
     C                     Z-ADD*ZERO     WDTFNB           Transportation
     C                     Z-ADD*ZERO     WDTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WDTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WDBLPR           Market Overage
     C                     Z-ADD*ZERO     WDBMPR           Standard Overag
     C                     Z-ADD*ZERO     WDCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WDCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WDSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WDPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WDICN1           Item Category N
     C                     Z-ADD*ZERO     WDICN2           Item Category N
     C                     Z-ADD*ZERO     WDV2NB           Item Category N
     C                     Z-ADD*ZERO     WDITCN           Item Category N
     C                     Z-ADD*ZERO     WDITC5           Item Category N
     C                     Z-ADD*ZERO     WDICN6           Item Category N
     C                     Z-ADD*ZERO     WDICN7           Item Category N
     C                     Z-ADD*ZERO     WDICN8           Item Category N
     C                     Z-ADD*ZERO     WDICN9           Item Category N
     C                     Z-ADD*ZERO     WDICN0           Item Category N
     C                     Z-ADD*ZERO     WDSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WDA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WDSJNB           Production Lead
     C                     Z-ADD*ZERO     WDSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WDSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WDSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WDCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WDCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WDILNB           Packages per ca
     C                     Z-ADD*ZERO     WDCHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WDCINB           PM Batch Size
     C                     Z-ADD*ZERO     WDCJNB           Package Level s
     C                     Z-ADD*ZERO     WDCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WDCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WDCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WDCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WDCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WDCWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WDCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WDCZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WDC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WDB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WDB5NB           PM Line Number
     C                     Z-ADD*ZERO     WDBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WDBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WDF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WDF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WDF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WDBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WDBNNB           Production Qty
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFLCBY           Location Bay
     C                     Z-ADD*ZERO     WFLCCT           Loc Unused Chil
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGSLTY           WLT Type Chill
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHHGCD           Item Code
     C                     Z-ADD*ZERO     WHELDT           Production Date
     C                     Z-ADD*ZERO     WHLXNM           Lot Number
     C                     Z-ADD*ZERO     WHYNCD           Location Level
     C                     Z-ADD*ZERO     WHJ2QT           ILL Item Qty On
     C                     Z-ADD*ZERO     WHG5WG           ILL Unit Weight
     C                     Z-ADD*ZERO     WHJ3QT           ILL Co-Packer L
     C                     Z-ADD*ZERO     WHG6WG           ILl Item Wgt On
     C                     Z-ADD*ZERO     WHJ4QT           ILL Unused Qty
     C                     Z-ADD*ZERO     WHG7WG           ILL Unused Wgt
     C                     Z-ADD*ZERO     WHLODT           ILL Avail Ship
     C                     Z-ADD*ZERO     WHLPDT           ILL Unused Date
     C                     Z-ADD*ZERO     WHLQDT           ILL Unused Date
     C                     Z-ADD*ZERO     WHNBR            ILL Unused Nbr
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Define work field LLT Trans Qty
     C                     Z-ADD*ZERO     WUJ5QT  50
      * Define work field LLT Trans Wgt
     C                     Z-ADD*ZERO     WUG8WG 112
      * Define work field LTT Unused Sts 1
     C                     MOVEL*BLANK    WULLTU  1
      * Define work field LTT Unused Sts 2
     C                     MOVEL*BLANK    WULLYT  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIHGCD           Item Code
     C                     Z-ADD*ZERO     WILRDT           LLT Trans Date
     C                     Z-ADD*ZERO     WILLTS           LLT Sequence #
     C                     Z-ADD*ZERO     WILSDT           LLT Production
     C                     Z-ADD*ZERO     WIJ5QT           LLT Trans Qty
     C                     Z-ADD*ZERO     WIG8WG           LLT Trans Wgt
     C                     Z-ADD*ZERO     WILLTN           LLT Lot Number
     C                     Z-ADD*ZERO     WILLCL           LLT Location Le
     C                     Z-ADD*ZERO     WILLTR           LLT Transfer Lo
     C                     Z-ADD*ZERO     WILLTL           LLT Transfer Lo
     C                     Z-ADD*ZERO     WIC4NB           Order Number
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field ILL Unit Weight
     C                     Z-ADD*ZERO     WUG5WG 112
      * Define work field ILL Avail Ship Date
     C                     Z-ADD*ZERO     WULODT  70
      * Define work field ILL Unused Sts 1
     C                     MOVEL*BLANK    WUASSX  1
      * Define work field ILL Unused Sts 2
     C                     MOVEL*BLANK    WUATSX  1
      * Define work field ILL Unused Sts 3
     C                     MOVEL*BLANK    WUAUSX  2
      * Define work field EDI Status 1
     C                     MOVEL*BLANK    WUUVST  1
      * Define work field EDI Status 2
     C                     MOVEL*BLANK    WUUWST  1
      * Define work field EDI Status 3
     C                     MOVEL*BLANK    WUUXST  1
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SGRVGN.
     C                     MOVEL*BLANK    WL0001  3
     C                     MOVEL*BLANK    WL0002  4
     C                     MOVEL*BLANK    WL0003  1
      * Define local variables for subroutine SHRVGN.
     C                     MOVEL*BLANK    WL0004  1
     C                     Z-ADD*ZERO     WL0005  52
      * Define local variables for subroutine SJRVGN.
     C                     Z-ADD*ZERO     WL0006  30
     C                     Z-ADD*ZERO     WL0007  70
     C                     MOVEL*BLANK    WL0008  3
     C                     MOVEL*BLANK    WL0009  2
     C                     Z-ADD*ZERO     WL0010  70
     C                     Z-ADD*ZERO     WL0011  30
      * Define local variables for subroutine SKCRRC.
     C                     Z-ADD*ZERO     WL0012  30
     C                     Z-ADD*ZERO     WL0013  70
     C                     MOVEL*BLANK    WL0014  3
     C                     MOVEL*BLANK    WL0015  2
     C                     Z-ADD*ZERO     WL0016  70
     C                     Z-ADD*ZERO     WL0017  30
     C                     Z-ADD*ZERO     WL0018  70
     C                     Z-ADD*ZERO     WL0019  50
     C                     Z-ADD*ZERO     WL0020 112
     C                     Z-ADD*ZERO     WL0021  50
     C                     MOVEL*BLANK    WL0022  4
     C                     Z-ADD*ZERO     WL0023  20
     C                     MOVEL*BLANK    WL0024  3
     C                     Z-ADD*ZERO     WL0025  50
     C                     MOVEL*BLANK    WL0026  4
     C                     Z-ADD*ZERO     WL0027  20
     C                     Z-ADD*ZERO     WL0028  70
     C                     MOVEL*BLANK    WL0029  1
     C                     MOVEL*BLANK    WL0030  1
     C                     MOVEL*BLANK    WL0031  1
     C                     MOVEL*BLANK    WL0032  1
     C                     MOVEL*BLANK    WL0033  1
     C                     MOVEL*BLANK    WL0034  1
     C                     MOVEL*BLANK    WL0035  1
     C                     Z-ADD*ZERO     WL0036  60
     C                     MOVEL*BLANK    WL0037 10
     C                     MOVEL*BLANK    WL0038 10
     C                     Z-ADD*ZERO     WL0039  70
      * Define local work field Lot Tracking Flag
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field WHS Live w/Carlisle
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field System Date USR
     C                     Z-ADD*ZERO     YL0003  70
      * Define local work field *System timestamp
     C                     MOVELXDTSDL    YL0004 26
      * Define local work field Year USR
     C                     MOVEL*BLANK    YL0005  4
      * Define local work field Month USR
     C                     MOVEL*BLANK    YL0006  2
      * Define local work field Day USR
     C                     MOVEL*BLANK    YL0007  2
      * Define local work field Date (Char-8) USR
     C                     MOVEL*BLANK    YL0008  8
      * Define local work field DATE
     C                     Z-ADD*ZERO     YL0009  80
      * Define local work field WHS Live w/Carlisle
     C                     MOVEL*BLANK    YL0010  1
      * Define local work field WHS PFS Interface
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field PFS Production Date
     C                     Z-ADD*ZERO     YL0012  80
      * Define local work field ILL Avail Ship Date
     C                     Z-ADD*ZERO     YL0013  70
      * Define local work field Email Address
     C                     MOVEL*BLANK    YL0014 50
      * Define local work field Text USR 43
     C                     MOVEL*BLANK    YL0015 43
      * Define local work field Office Message USR
     C                     MOVEL*BLANK    YL0016132
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 0001-01-01-00.00.00.00000
00002 Y2U0005
00003 Post Physical
00004 INACTV
00005 PPT1DFR
00006 INVRST
00007 Carlisle Upload
00008 Completed for:
