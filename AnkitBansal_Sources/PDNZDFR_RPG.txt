     H/TITLE DSP Price Audit       DF  Display file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Displays the records from DBF as a subfile
     H* - Loads the SFL from the DBF a page at a time
     H* - The DBF record at which the SFL display starts may be
     H*   controlled by positioning fields on the SFL header
     H* - Any key fields on the SFL header will be used as
     H*   positioning values
     H* - Any non-key fields on the SFL header will be used as
     H*   selection values: a maximum of W0SLM records will be
     H*   read from the DBF before giving up
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Display file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISSPATI
     H* Date          : 06/12/24  Time  : 03:42:27
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPDNZDFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: DSP Price Audit       DF  Display file
      *
     FOPBGWKL1IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RTV : Order Detail              Retrieval index
      *
     FOPBFCPLWIF  E           K        DISK
      * RTV : Order Header TRG          Orders not Cancelled
      *
     FOPEYCPL9IF  E           K        DISK
      * RSQ : Order Events              Co/Order/Event Code
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer Master           Retrieval index       NV
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FCAAPREL2IF  E           K        DISK
      * RTV : Salesperson               Retrieval index       V
      *
     FPDJYREL2IF  E           K        DISK
      * RTV : Company Defaults Internal Active Records
      *
     FPMAMREL1IF  E           K        DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FOPBGWKLDIF  E           K        DISK
      * RSQ : Order Detail              Co/Order#/Item/Whse Not
      *
     FOMCRWKL1IF  E           K        DISK
      * RTV : Order Detail Fin          Retrieval index
      *
     FOMHQCPL1IF  E           K        DISK
      * RTV : Order Detail Accrual      Retrieval index
      *
     FOPBGWKL9IF  E           K        DISK
      * RTV : Order Detail              Priced,Audit Required
      *
     FPDK3CPL2IF  E           K        DISK
      * RSQ : Price Change Audit Log    Co/Ord/Seq1&2/AdtSeq (D)
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPNGQREL1IF  E           K        DISK
      * RTV : EDI Bill To Interchange   Retrieval index
      *
     FECP004L8IF  E           K        DISK
      * RSQ : EDI Purchase Order Header Trade Partner/PO Number
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FPDKXCPL0IF  E           K        DISK                      A
      * UPD : WF Price Audit Log Work   Update index
      *
     FPDK3CPL0IF  E           K        DISK                      A
      * UPD : Price Change Audit Log    Update index
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     E                    #L7         7  1
     E                    #L3         3  1
     E                    UCT        40  1               CENTER TABLE
      * Long constants
     E                    @CN#    1  02  6   @CN    25
     I@BGWKFW
      * Order Detail              Co/Order#/Item/Whse Not
      * Renamed input format fields
     I              OMAIC3                          WAAIC3
     I              OMC4NB                          WAC4NB
     I              OMDPNB                          WADPNB
     I              OMUENB                          WAUENB
     I              OMHGCD                          WAHGCD
     I              OMAJCD                          WAAJCD
     I              OMBKC7                          WABKC7
     I              OMCFC7                          WACFC7
     I              OMGMST                          WAGMST
     I              OMGNST                          WAGNST
     I              OMMAVA                          WAMAVA
     I              OMKDVA                          WAKDVA
     I              OML8VA                          WAL8VA
     I              OML9VA                          WAL9VA
     I              OMGTST                          WAGTST
     I              OMGVST                          WAGVST
     I              OMGUST                          WAGUST
     I              OMQFST                          WAQFST
     I              OMAYVA                          WAAYVA
     I              OMEXDT                          WAEXDT
     I              OMLQCD                          WALQCD
     I              OMRDCD                          WARDCD
     I              OMQ7CD                          WAQ7CD
     I              OMBZPR                          WABZPR
     I              OML6NB                          WAL6NB
     I              OMU1ST                          WAU1ST
     I              OMGIDT                          WAGIDT
     I              OMCRCD                          WACRCD
     I              OMAGCD                          WAAGCD
     I              OMRZST                          WARZST
     I              OMR0ST                          WAR0ST
     I              OMR1ST                          WAR1ST
     I              OMG7NA                          WAG7NA
     I              OMG8NA                          WAG8NA
     I              OMRPCD                          WARPCD
     I              OMVEST                          WAVEST
     I              OMVGST                          WAVGST
     I              OMAVST                          WAAVST
     I              OMU0ST                          WAU0ST
     I              OMRFCD                          WARFCD
     I              OMFZST                          WAFZST
     I              OMR1NB                          WAR1NB
     I              OMAVQT                          WAAVQT
     I              OMD0WG                          WAD0WG
     I              OMCCQT                          WACCQT
     I              OMAUWG                          WAAUWG
     I              OMCBQT                          WACBQT
     I              OMATWG                          WAATWG
     I              OMAQCS                          WAAQCS
     I              OMAGCS                          WAAGCS
     I              OMAKPR                          WAAKPR
     I              OMALPR                          WAALPR
     I              OMAUPR                          WAAUPR
     I              OMAVWG                          WAAVWG
     I              OMA4WG                          WAA4WG
     I              OMA5DT                          WAA5DT
     I              OMAODT                          WAAODT
     I              OMGNDT                          WAGNDT
     I              OMAMST                          WAAMST
     I              OMANST                          WAANST
     I              OMVAST                          WAVAST
     I              OMRGNB                          WARGNB
     I              OMRHNB                          WARHNB
     I              OMRINB                          WARINB
     I              OMRBCD                          WARBCD
     I              OMHICD                          WAHICD
     I              OMRNCD                          WARNCD
     I              OMROCD                          WAROCD
     I              OMCXDT                          WACXDT
     I              OMAJVN                          WAAJVN
     I              OMKXCD                          WAKXCD
     I              OMJPCD                          WAJPCD
     I              OMCQCD                          WACQCD
     I              OMR4CD                          WAR4CD
     I              OMZ1ST                          WAZ1ST
     I              OMZ3ST                          WAZ3ST
     I              OMZ4ST                          WAZ4ST
     I              OMDUPR                          WADUPR
     I              OMB6VL                          WAB6VL
     I              OMA1AA                          WAA1AA
     I              OMFZSX                          WAFZSX
     I              OMF0SX                          WAF0SX
     I              OMF1SX                          WAF1SX
     I              OMF2SX                          WAF2SX
     I              OMF3SX                          WAF3SX
     I              OMF4SX                          WAF4SX
     I              OMF5SX                          WAF5SX
     I              OMF6SX                          WAF6SX
     I              OMF7SX                          WAF7SX
     I              OMNTDT                          WANTDT
     I              OMNUDT                          WANUDT
     I              OMNVDT                          WANVDT
     I              OMNWDT                          WANWDT
     I              OMNXDT                          WANXDT
     I              OMBUTM                          WABUTM
     I              OMBVTM                          WABVTM
     I              OMBWTM                          WABWTM
     I              OMBXTM                          WABXTM
     I              OMBYTM                          WABYTM
     I              OMH5NX                          WAH5NX
     I              OMH6NX                          WAH6NX
     I              OMH7NX                          WAH7NX
     I              OMH8NX                          WAH8NX
     I              OMH9NX                          WAH9NX
     I              OMDVPR                          WADVPR
     I              OMDWPR                          WADWPR
     I              OMDXPR                          WADXPR
     I              OMDYPR                          WADYPR
     I              OMDZPR                          WADZPR
     I              OMGSPR                          WAGSPR
     I              OMGTPR                          WAGTPR
     I              OMGUPR                          WAGUPR
     I              OMHOST                          WAHOST
     I              OMHPST                          WAHPST
     I              OMIOST                          WAIOST
     I              OMPEWG                          WAPEWG
     I              OMRINY                          WARINY
     I              OMTIDT                          WATIDT
     I              OMTJDT                          WATJDT
     I              OMH2ST                          WAH2ST
     I              OMH0ST                          WAH0ST
     I              OMH1ST                          WAH1ST
     I              OMTKDT                          WATKDT
     I              OMTLDT                          WATLDT
     I              OMTMDT                          WATMDT
     I              OMUVST                          WAUVST
     I              OMUWST                          WAUWST
     I              OMUXST                          WAUXST
     I              OMAATM                          WAAATM
     I              OMAYNA                          WAAYNA
     I              OMA0NA                          WAA0NA
     I              OMAXDT                          WAAXDT
      *
     I@BGWKF9
      * Order Detail              Priced,Audit Required
      * Renamed input format fields
     I              OMAIC3                          WBAIC3
     I              OMC4NB                          WBC4NB
     I              OMDPNB                          WBDPNB
     I              OMUENB                          WBUENB
     I              OMHGCD                          WBHGCD
     I              OMAJCD                          WBAJCD
     I              OMBKC7                          WBBKC7
     I              OMCFC7                          WBCFC7
     I              OMGMST                          WBGMST
     I              OMGNST                          WBGNST
     I              OMMAVA                          WBMAVA
     I              OMKDVA                          WBKDVA
     I              OML8VA                          WBL8VA
     I              OML9VA                          WBL9VA
     I              OMGTST                          WBGTST
     I              OMGVST                          WBGVST
     I              OMGUST                          WBGUST
     I              OMQFST                          WBQFST
     I              OMAYVA                          WBAYVA
     I              OMEXDT                          WBEXDT
     I              OMLQCD                          WBLQCD
     I              OMRDCD                          WBRDCD
     I              OMQ7CD                          WBQ7CD
     I              OMBZPR                          WBBZPR
     I              OML6NB                          WBL6NB
     I              OMU1ST                          WBU1ST
     I              OMGIDT                          WBGIDT
     I              OMCRCD                          WBCRCD
     I              OMAGCD                          WBAGCD
     I              OMRZST                          WBRZST
     I              OMR0ST                          WBR0ST
     I              OMR1ST                          WBR1ST
     I              OMG7NA                          WBG7NA
     I              OMG8NA                          WBG8NA
     I              OMRPCD                          WBRPCD
     I              OMVEST                          WBVEST
     I              OMVGST                          WBVGST
     I              OMAVST                          WBAVST
     I              OMU0ST                          WBU0ST
     I              OMRFCD                          WBRFCD
     I              OMFZST                          WBFZST
     I              OMR1NB                          WBR1NB
     I              OMAVQT                          WBAVQT
     I              OMD0WG                          WBD0WG
     I              OMCCQT                          WBCCQT
     I              OMAUWG                          WBAUWG
     I              OMCBQT                          WBCBQT
     I              OMATWG                          WBATWG
     I              OMAQCS                          WBAQCS
     I              OMAGCS                          WBAGCS
     I              OMAKPR                          WBAKPR
     I              OMALPR                          WBALPR
     I              OMAUPR                          WBAUPR
     I              OMAVWG                          WBAVWG
     I              OMA4WG                          WBA4WG
     I              OMA5DT                          WBA5DT
     I              OMAODT                          WBAODT
     I              OMGNDT                          WBGNDT
     I              OMAMST                          WBAMST
     I              OMANST                          WBANST
     I              OMVAST                          WBVAST
     I              OMRGNB                          WBRGNB
     I              OMRHNB                          WBRHNB
     I              OMRINB                          WBRINB
     I              OMRBCD                          WBRBCD
     I              OMHICD                          WBHICD
     I              OMRNCD                          WBRNCD
     I              OMROCD                          WBROCD
     I              OMCXDT                          WBCXDT
     I              OMAJVN                          WBAJVN
     I              OMKXCD                          WBKXCD
     I              OMJPCD                          WBJPCD
     I              OMCQCD                          WBCQCD
     I              OMR4CD                          WBR4CD
     I              OMZ1ST                          WBZ1ST
     I              OMZ3ST                          WBZ3ST
     I              OMZ4ST                          WBZ4ST
     I              OMDUPR                          WBDUPR
     I              OMB6VL                          WBB6VL
     I              OMA1AA                          WBA1AA
     I              OMFZSX                          WBFZSX
     I              OMF0SX                          WBF0SX
     I              OMF1SX                          WBF1SX
     I              OMF2SX                          WBF2SX
     I              OMF3SX                          WBF3SX
     I              OMF4SX                          WBF4SX
     I              OMF5SX                          WBF5SX
     I              OMF6SX                          WBF6SX
     I              OMF7SX                          WBF7SX
     I              OMNTDT                          WBNTDT
     I              OMNUDT                          WBNUDT
     I              OMNVDT                          WBNVDT
     I              OMNWDT                          WBNWDT
     I              OMNXDT                          WBNXDT
     I              OMBUTM                          WBBUTM
     I              OMBVTM                          WBBVTM
     I              OMBWTM                          WBBWTM
     I              OMBXTM                          WBBXTM
     I              OMBYTM                          WBBYTM
     I              OMH5NX                          WBH5NX
     I              OMH6NX                          WBH6NX
     I              OMH7NX                          WBH7NX
     I              OMH8NX                          WBH8NX
     I              OMH9NX                          WBH9NX
     I              OMDVPR                          WBDVPR
     I              OMDWPR                          WBDWPR
     I              OMDXPR                          WBDXPR
     I              OMDYPR                          WBDYPR
     I              OMDZPR                          WBDZPR
     I              OMGSPR                          WBGSPR
     I              OMGTPR                          WBGTPR
     I              OMGUPR                          WBGUPR
     I              OMHOST                          WBHOST
     I              OMHPST                          WBHPST
     I              OMIOST                          WBIOST
     I              OMPEWG                          WBPEWG
     I              OMRINY                          WBRINY
     I              OMTIDT                          WBTIDT
     I              OMTJDT                          WBTJDT
     I              OMH2ST                          WBH2ST
     I              OMH0ST                          WBH0ST
     I              OMH1ST                          WBH1ST
     I              OMTKDT                          WBTKDT
     I              OMTLDT                          WBTLDT
     I              OMTMDT                          WBTMDT
     I              OMUVST                          WBUVST
     I              OMUWST                          WBUWST
     I              OMUXST                          WBUXST
     I              OMAATM                          WBAATM
     I              OMAYNA                          WBAYNA
     I              OMA0NA                          WBA0NA
     I              OMAXDT                          WBAXDT
      *
     I@K3CPKP
      * Price Change Audit Log    Update index
      * Renamed input format fields
     I              K3AIC3                          WCAIC3
     I              K3C4NB                          WCC4NB
     I              K3DPNB                          WCDPNB
     I              K3UENB                          WCUENB
     I              K3ASNO                          WCASNO
     I              K3HGCD                          WCHGCD
     I              K3GMST                          WCGMST
     I              K3GNST                          WCGNST
     I              K3AYVA                          WCAYVA
     I              K3YJVA                          WCYJVA
     I              K3U1ST                          WCU1ST
     I              K3PSTL                          WCPSTL
     I              K3U0ST                          WCU0ST
     I              K3RFCD                          WCRFCD
     I              K3PALS                          WCPALS
     I              K3WWCD                          WCWWCD
     I              K3AKPR                          WCAKPR
     I              K3DBPR                          WCDBPR
     I              K3ALPR                          WCALPR
     I              K3DCPR                          WCDCPR
     I              K3JPCD                          WCJPCD
     I              K3WXCD                          WCWXCD
     I              K3PREC                          WCPREC
     I              K3PIDX                          WCPIDX
     I              K3UVST                          WCUVST
     I              K3UWST                          WCUWST
     I              K3UXST                          WCUXST
     I              K3AATM                          WCAATM
     I              K3AYNA                          WCAYNA
     I              K3A0NA                          WCA0NA
     I              K3AXDT                          WCAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WDAIC3
     I              OMC4NB                          WDC4NB
     I              OMDPNB                          WDDPNB
     I              OMUENB                          WDUENB
     I              OMHGCD                          WDHGCD
     I              OMAJCD                          WDAJCD
     I              OMBKC7                          WDBKC7
     I              OMCFC7                          WDCFC7
     I              OMGMST                          WDGMST
     I              OMGNST                          WDGNST
     I              OMMAVA                          WDMAVA
     I              OMKDVA                          WDKDVA
     I              OML8VA                          WDL8VA
     I              OML9VA                          WDL9VA
     I              OMGTST                          WDGTST
     I              OMGVST                          WDGVST
     I              OMGUST                          WDGUST
     I              OMQFST                          WDQFST
     I              OMAYVA                          WDAYVA
     I              OMEXDT                          WDEXDT
     I              OMLQCD                          WDLQCD
     I              OMRDCD                          WDRDCD
     I              OMQ7CD                          WDQ7CD
     I              OMBZPR                          WDBZPR
     I              OML6NB                          WDL6NB
     I              OMU1ST                          WDU1ST
     I              OMGIDT                          WDGIDT
     I              OMCRCD                          WDCRCD
     I              OMAGCD                          WDAGCD
     I              OMRZST                          WDRZST
     I              OMR0ST                          WDR0ST
     I              OMR1ST                          WDR1ST
     I              OMG7NA                          WDG7NA
     I              OMG8NA                          WDG8NA
     I              OMRPCD                          WDRPCD
     I              OMVEST                          WDVEST
     I              OMVGST                          WDVGST
     I              OMAVST                          WDAVST
     I              OMU0ST                          WDU0ST
     I              OMRFCD                          WDRFCD
     I              OMFZST                          WDFZST
     I              OMR1NB                          WDR1NB
     I              OMAVQT                          WDAVQT
     I              OMD0WG                          WDD0WG
     I              OMCCQT                          WDCCQT
     I              OMAUWG                          WDAUWG
     I              OMCBQT                          WDCBQT
     I              OMATWG                          WDATWG
     I              OMAQCS                          WDAQCS
     I              OMAGCS                          WDAGCS
     I              OMAKPR                          WDAKPR
     I              OMALPR                          WDALPR
     I              OMAUPR                          WDAUPR
     I              OMAVWG                          WDAVWG
     I              OMA4WG                          WDA4WG
     I              OMA5DT                          WDA5DT
     I              OMAODT                          WDAODT
     I              OMGNDT                          WDGNDT
     I              OMAMST                          WDAMST
     I              OMANST                          WDANST
     I              OMVAST                          WDVAST
     I              OMRGNB                          WDRGNB
     I              OMRHNB                          WDRHNB
     I              OMRINB                          WDRINB
     I              OMRBCD                          WDRBCD
     I              OMHICD                          WDHICD
     I              OMRNCD                          WDRNCD
     I              OMROCD                          WDROCD
     I              OMCXDT                          WDCXDT
     I              OMAJVN                          WDAJVN
     I              OMKXCD                          WDKXCD
     I              OMJPCD                          WDJPCD
     I              OMCQCD                          WDCQCD
     I              OMR4CD                          WDR4CD
     I              OMZ1ST                          WDZ1ST
     I              OMZ3ST                          WDZ3ST
     I              OMZ4ST                          WDZ4ST
     I              OMDUPR                          WDDUPR
     I              OMB6VL                          WDB6VL
     I              OMA1AA                          WDA1AA
     I              OMFZSX                          WDFZSX
     I              OMF0SX                          WDF0SX
     I              OMF1SX                          WDF1SX
     I              OMF2SX                          WDF2SX
     I              OMF3SX                          WDF3SX
     I              OMF4SX                          WDF4SX
     I              OMF5SX                          WDF5SX
     I              OMF6SX                          WDF6SX
     I              OMF7SX                          WDF7SX
     I              OMNTDT                          WDNTDT
     I              OMNUDT                          WDNUDT
     I              OMNVDT                          WDNVDT
     I              OMNWDT                          WDNWDT
     I              OMNXDT                          WDNXDT
     I              OMBUTM                          WDBUTM
     I              OMBVTM                          WDBVTM
     I              OMBWTM                          WDBWTM
     I              OMBXTM                          WDBXTM
     I              OMBYTM                          WDBYTM
     I              OMH5NX                          WDH5NX
     I              OMH6NX                          WDH6NX
     I              OMH7NX                          WDH7NX
     I              OMH8NX                          WDH8NX
     I              OMH9NX                          WDH9NX
     I              OMDVPR                          WDDVPR
     I              OMDWPR                          WDDWPR
     I              OMDXPR                          WDDXPR
     I              OMDYPR                          WDDYPR
     I              OMDZPR                          WDDZPR
     I              OMGSPR                          WDGSPR
     I              OMGTPR                          WDGTPR
     I              OMGUPR                          WDGUPR
     I              OMHOST                          WDHOST
     I              OMHPST                          WDHPST
     I              OMIOST                          WDIOST
     I              OMPEWG                          WDPEWG
     I              OMRINY                          WDRINY
     I              OMTIDT                          WDTIDT
     I              OMTJDT                          WDTJDT
     I              OMH2ST                          WDH2ST
     I              OMH0ST                          WDH0ST
     I              OMH1ST                          WDH1ST
     I              OMTKDT                          WDTKDT
     I              OMTLDT                          WDTLDT
     I              OMTMDT                          WDTMDT
     I              OMUVST                          WDUVST
     I              OMUWST                          WDUWST
     I              OMUXST                          WDUXST
     I              OMAATM                          WDAATM
     I              OMAYNA                          WDAYNA
     I              OMA0NA                          WDA0NA
     I              OMAXDT                          WDAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WEAIC3
     I              BEC4NB                          WEC4NB
     I              BEJNCD                          WEJNCD
     I              BEANC7                          WEANC7
     I              BEBKC7                          WEBKC7
     I              BEBRTX                          WEBRTX
     I              BEHMNA                          WEHMNA
     I              BEHONA                          WEHONA
     I              BEHPNA                          WEHPNA
     I              BEHNNA                          WEHNNA
     I              BEDBCD                          WEDBCD
     I              BECKTX                          WECKTX
     I              BEB0C7                          WEB0C7
     I              BEAETX                          WEAETX
     I              BEB1NA                          WEB1NA
     I              BEB3NA                          WEB3NA
     I              BEB4NA                          WEB4NA
     I              BEB2NA                          WEB2NA
     I              BEBHCD                          WEBHCD
     I              BEC8TX                          WEC8TX
     I              BEBCNA                          WEBCNA
     I              BEA0DT                          WEA0DT
     I              BEA5DT                          WEA5DT
     I              BEGNDT                          WEGNDT
     I              BEACDT                          WEACDT
     I              BEAQCD                          WEAQCD
     I              BEB6NA                          WEB6NA
     I              BEBYNA                          WEBYNA
     I              BEBZNA                          WEBZNA
     I              BEGTST                          WEGTST
     I              BEGVST                          WEGVST
     I              BEGUST                          WEGUST
     I              BEQFST                          WEQFST
     I              BECQCD                          WECQCD
     I              BEGJST                          WEGJST
     I              BEGWST                          WEGWST
     I              BEGXST                          WEGXST
     I              BEGYST                          WEGYST
     I              BEAODT                          WEAODT
     I              BEAIVN                          WEAIVN
     I              BECXDT                          WECXDT
     I              BEJZVA                          WEJZVA
     I              BEA1WG                          WEA1WG
     I              BEXIST                          WEXIST
     I              BEXJST                          WEXJST
     I              BEXKST                          WEXKST
     I              BEEIDT                          WEEIDT
     I              BEAFTM                          WEAFTM
     I              BEE8CD                          WEE8CD
     I              BEE9CD                          WEE9CD
     I              BERMNB                          WERMNB
     I              BETBNB                          WETBNB
     I              BER1NB                          WER1NB
     I              BEPJST                          WEPJST
     I              BEU0ST                          WEU0ST
     I              BEU1ST                          WEU1ST
     I              BEQ2CD                          WEQ2CD
     I              BEU2ST                          WEU2ST
     I              BEVEST                          WEVEST
     I              BEVFST                          WEVFST
     I              BEVGST                          WEVGST
     I              BERPCD                          WERPCD
     I              BERNNB                          WERNNB
     I              BEVDST                          WEVDST
     I              BEATIN                          WEATIN
     I              BEU4ST                          WEU4ST
     I              BEU5ST                          WEU5ST
     I              BERSRN                          WERSRN
     I              BEMHNA                          WEMHNA
     I              BEMINA                          WEMINA
     I              BEWBST                          WEWBST
     I              BER4CD                          WER4CD
     I              BEBFCD                          WEBFCD
     I              BEQ4CD                          WEQ4CD
     I              BET3NB                          WET3NB
     I              BESICD                          WESICD
     I              BECONB                          WECONB
     I              BECEST                          WECEST
     I              BEAWDT                          WEAWDT
     I              BEJPCD                          WEJPCD
     I              BEXUST                          WEXUST
     I              BEZ1ST                          WEZ1ST
     I              BEVRVA                          WEVRVA
     I              BEOBST                          WEOBST
     I              BEBCST                          WEBCST
     I              BEBDST                          WEBDST
     I              BEB7VL                          WEB7VL
     I              BEGASX                          WEGASX
     I              BEGBSX                          WEGBSX
     I              BEGCSX                          WEGCSX
     I              BEGDSX                          WEGDSX
     I              BEFNSX                          WEFNSX
     I              BEFOSX                          WEFOSX
     I              BEFPSX                          WEFPSX
     I              BEFQSX                          WEFQSX
     I              BEFRSX                          WEFRSX
     I              BEFSSX                          WEFSSX
     I              BEFTSX                          WEFTSX
     I              BEFUSX                          WEFUSX
     I              BEFVSX                          WEFVSX
     I              BEFWSX                          WEFWSX
     I              BEFXSX                          WEFXSX
     I              BEFYSX                          WEFYSX
     I              BENODT                          WENODT
     I              BENPDT                          WENPDT
     I              BENQDT                          WENQDT
     I              BENRDT                          WENRDT
     I              BENSDT                          WENSDT
     I              BEBPTM                          WEBPTM
     I              BEBQTM                          WEBQTM
     I              BEBRTM                          WEBRTM
     I              BEBSTM                          WEBSTM
     I              BEBTTM                          WEBTTM
     I              BEH0NX                          WEH0NX
     I              BEH1NX                          WEH1NX
     I              BEH2NX                          WEH2NX
     I              BEH3NX                          WEH3NX
     I              BEH4NX                          WEH4NX
     I              BEC0C7                          WEC0C7
     I              BEUVST                          WEUVST
     I              BEUWST                          WEUWST
     I              BEUXST                          WEUXST
     I              BEAATM                          WEAATM
     I              BEAYNA                          WEAYNA
     I              BEA0NA                          WEA0NA
     I              BEAXDT                          WEAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WFAIC3
     I              BEC4NB                          WFC4NB
     I              BEJNCD                          WFJNCD
     I              BEANC7                          WFANC7
     I              BEBKC7                          WFBKC7
     I              BEBRTX                          WFBRTX
     I              BEHMNA                          WFHMNA
     I              BEHONA                          WFHONA
     I              BEHPNA                          WFHPNA
     I              BEHNNA                          WFHNNA
     I              BEDBCD                          WFDBCD
     I              BECKTX                          WFCKTX
     I              BEB0C7                          WFB0C7
     I              BEAETX                          WFAETX
     I              BEB1NA                          WFB1NA
     I              BEB3NA                          WFB3NA
     I              BEB4NA                          WFB4NA
     I              BEB2NA                          WFB2NA
     I              BEBHCD                          WFBHCD
     I              BEC8TX                          WFC8TX
     I              BEBCNA                          WFBCNA
     I              BEA0DT                          WFA0DT
     I              BEA5DT                          WFA5DT
     I              BEGNDT                          WFGNDT
     I              BEACDT                          WFACDT
     I              BEAQCD                          WFAQCD
     I              BEB6NA                          WFB6NA
     I              BEBYNA                          WFBYNA
     I              BEBZNA                          WFBZNA
     I              BEGTST                          WFGTST
     I              BEGVST                          WFGVST
     I              BEGUST                          WFGUST
     I              BEQFST                          WFQFST
     I              BECQCD                          WFCQCD
     I              BEGJST                          WFGJST
     I              BEGWST                          WFGWST
     I              BEGXST                          WFGXST
     I              BEGYST                          WFGYST
     I              BEAODT                          WFAODT
     I              BEAIVN                          WFAIVN
     I              BECXDT                          WFCXDT
     I              BEJZVA                          WFJZVA
     I              BEA1WG                          WFA1WG
     I              BEXIST                          WFXIST
     I              BEXJST                          WFXJST
     I              BEXKST                          WFXKST
     I              BEEIDT                          WFEIDT
     I              BEAFTM                          WFAFTM
     I              BEE8CD                          WFE8CD
     I              BEE9CD                          WFE9CD
     I              BERMNB                          WFRMNB
     I              BETBNB                          WFTBNB
     I              BER1NB                          WFR1NB
     I              BEPJST                          WFPJST
     I              BEU0ST                          WFU0ST
     I              BEU1ST                          WFU1ST
     I              BEQ2CD                          WFQ2CD
     I              BEU2ST                          WFU2ST
     I              BEVEST                          WFVEST
     I              BEVFST                          WFVFST
     I              BEVGST                          WFVGST
     I              BERPCD                          WFRPCD
     I              BERNNB                          WFRNNB
     I              BEVDST                          WFVDST
     I              BEATIN                          WFATIN
     I              BEU4ST                          WFU4ST
     I              BEU5ST                          WFU5ST
     I              BERSRN                          WFRSRN
     I              BEMHNA                          WFMHNA
     I              BEMINA                          WFMINA
     I              BEWBST                          WFWBST
     I              BER4CD                          WFR4CD
     I              BEBFCD                          WFBFCD
     I              BEQ4CD                          WFQ4CD
     I              BET3NB                          WFT3NB
     I              BESICD                          WFSICD
     I              BECONB                          WFCONB
     I              BECEST                          WFCEST
     I              BEAWDT                          WFAWDT
     I              BEJPCD                          WFJPCD
     I              BEXUST                          WFXUST
     I              BEZ1ST                          WFZ1ST
     I              BEVRVA                          WFVRVA
     I              BEOBST                          WFOBST
     I              BEBCST                          WFBCST
     I              BEBDST                          WFBDST
     I              BEB7VL                          WFB7VL
     I              BEGASX                          WFGASX
     I              BEGBSX                          WFGBSX
     I              BEGCSX                          WFGCSX
     I              BEGDSX                          WFGDSX
     I              BEFNSX                          WFFNSX
     I              BEFOSX                          WFFOSX
     I              BEFPSX                          WFFPSX
     I              BEFQSX                          WFFQSX
     I              BEFRSX                          WFFRSX
     I              BEFSSX                          WFFSSX
     I              BEFTSX                          WFFTSX
     I              BEFUSX                          WFFUSX
     I              BEFVSX                          WFFVSX
     I              BEFWSX                          WFFWSX
     I              BEFXSX                          WFFXSX
     I              BEFYSX                          WFFYSX
     I              BENODT                          WFNODT
     I              BENPDT                          WFNPDT
     I              BENQDT                          WFNQDT
     I              BENRDT                          WFNRDT
     I              BENSDT                          WFNSDT
     I              BEBPTM                          WFBPTM
     I              BEBQTM                          WFBQTM
     I              BEBRTM                          WFBRTM
     I              BEBSTM                          WFBSTM
     I              BEBTTM                          WFBTTM
     I              BEH0NX                          WFH0NX
     I              BEH1NX                          WFH1NX
     I              BEH2NX                          WFH2NX
     I              BEH3NX                          WFH3NX
     I              BEH4NX                          WFH4NX
     I              BEC0C7                          WFC0C7
     I              BEUVST                          WFUVST
     I              BEUWST                          WFUWST
     I              BEUXST                          WFUXST
     I              BEAATM                          WFAATM
     I              BEAYNA                          WFAYNA
     I              BEA0NA                          WFA0NA
     I              BEAXDT                          WFAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     IQPDKX1    E DSPDKXCPL0
      * UPD : WF Price Audit Log Work   Update index
      *
      * Outward parameters
     IPARC        DS                             12
      * KEY : Order Detail Accrual      Retrieval index
      * I : RST Company Number
     I                                    P   1   20PAAIC3
      * I : RST Order Number
     I                                    P   3   60PAC4NB
      * I : RST Order Sequence Number
     I                                    P   7   80PADPNB
      * I : RST Order Secondary Line Seq
     I                                    P   9  100PAUENB
      *
     IQPDK31    E DSPDK3CPL0
      * UPD : Price Change Audit Log    Update index
      * Renamed input format fields
     I              K3AIC3                          WCAIC3
     I              K3C4NB                          WCC4NB
     I              K3DPNB                          WCDPNB
     I              K3UENB                          WCUENB
     I              K3ASNO                          WCASNO
     I              K3HGCD                          WCHGCD
     I              K3GMST                          WCGMST
     I              K3GNST                          WCGNST
     I              K3AYVA                          WCAYVA
     I              K3YJVA                          WCYJVA
     I              K3U1ST                          WCU1ST
     I              K3PSTL                          WCPSTL
     I              K3U0ST                          WCU0ST
     I              K3RFCD                          WCRFCD
     I              K3PALS                          WCPALS
     I              K3WWCD                          WCWWCD
     I              K3AKPR                          WCAKPR
     I              K3DBPR                          WCDBPR
     I              K3ALPR                          WCALPR
     I              K3DCPR                          WCDCPR
     I              K3JPCD                          WCJPCD
     I              K3WXCD                          WCWXCD
     I              K3PREC                          WCPREC
     I              K3PIDX                          WCPIDX
     I              K3UVST                          WCUVST
     I              K3UWST                          WCUWST
     I              K3UXST                          WCUXST
     I              K3AATM                          WCAATM
     I              K3AYNA                          WCAYNA
     I              K3A0NA                          WCA0NA
     I              K3AXDT                          WCAXDT
      *
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WDAIC3
     I              OMC4NB                          WDC4NB
     I              OMDPNB                          WDDPNB
     I              OMUENB                          WDUENB
     I              OMHGCD                          WDHGCD
     I              OMAJCD                          WDAJCD
     I              OMBKC7                          WDBKC7
     I              OMCFC7                          WDCFC7
     I              OMGMST                          WDGMST
     I              OMGNST                          WDGNST
     I              OMMAVA                          WDMAVA
     I              OMKDVA                          WDKDVA
     I              OML8VA                          WDL8VA
     I              OML9VA                          WDL9VA
     I              OMGTST                          WDGTST
     I              OMGVST                          WDGVST
     I              OMGUST                          WDGUST
     I              OMQFST                          WDQFST
     I              OMAYVA                          WDAYVA
     I              OMEXDT                          WDEXDT
     I              OMLQCD                          WDLQCD
     I              OMRDCD                          WDRDCD
     I              OMQ7CD                          WDQ7CD
     I              OMBZPR                          WDBZPR
     I              OML6NB                          WDL6NB
     I              OMU1ST                          WDU1ST
     I              OMGIDT                          WDGIDT
     I              OMCRCD                          WDCRCD
     I              OMAGCD                          WDAGCD
     I              OMRZST                          WDRZST
     I              OMR0ST                          WDR0ST
     I              OMR1ST                          WDR1ST
     I              OMG7NA                          WDG7NA
     I              OMG8NA                          WDG8NA
     I              OMRPCD                          WDRPCD
     I              OMVEST                          WDVEST
     I              OMVGST                          WDVGST
     I              OMAVST                          WDAVST
     I              OMU0ST                          WDU0ST
     I              OMRFCD                          WDRFCD
     I              OMFZST                          WDFZST
     I              OMR1NB                          WDR1NB
     I              OMAVQT                          WDAVQT
     I              OMD0WG                          WDD0WG
     I              OMCCQT                          WDCCQT
     I              OMAUWG                          WDAUWG
     I              OMCBQT                          WDCBQT
     I              OMATWG                          WDATWG
     I              OMAQCS                          WDAQCS
     I              OMAGCS                          WDAGCS
     I              OMAKPR                          WDAKPR
     I              OMALPR                          WDALPR
     I              OMAUPR                          WDAUPR
     I              OMAVWG                          WDAVWG
     I              OMA4WG                          WDA4WG
     I              OMA5DT                          WDA5DT
     I              OMAODT                          WDAODT
     I              OMGNDT                          WDGNDT
     I              OMAMST                          WDAMST
     I              OMANST                          WDANST
     I              OMVAST                          WDVAST
     I              OMRGNB                          WDRGNB
     I              OMRHNB                          WDRHNB
     I              OMRINB                          WDRINB
     I              OMRBCD                          WDRBCD
     I              OMHICD                          WDHICD
     I              OMRNCD                          WDRNCD
     I              OMROCD                          WDROCD
     I              OMCXDT                          WDCXDT
     I              OMAJVN                          WDAJVN
     I              OMKXCD                          WDKXCD
     I              OMJPCD                          WDJPCD
     I              OMCQCD                          WDCQCD
     I              OMR4CD                          WDR4CD
     I              OMZ1ST                          WDZ1ST
     I              OMZ3ST                          WDZ3ST
     I              OMZ4ST                          WDZ4ST
     I              OMDUPR                          WDDUPR
     I              OMB6VL                          WDB6VL
     I              OMA1AA                          WDA1AA
     I              OMFZSX                          WDFZSX
     I              OMF0SX                          WDF0SX
     I              OMF1SX                          WDF1SX
     I              OMF2SX                          WDF2SX
     I              OMF3SX                          WDF3SX
     I              OMF4SX                          WDF4SX
     I              OMF5SX                          WDF5SX
     I              OMF6SX                          WDF6SX
     I              OMF7SX                          WDF7SX
     I              OMNTDT                          WDNTDT
     I              OMNUDT                          WDNUDT
     I              OMNVDT                          WDNVDT
     I              OMNWDT                          WDNWDT
     I              OMNXDT                          WDNXDT
     I              OMBUTM                          WDBUTM
     I              OMBVTM                          WDBVTM
     I              OMBWTM                          WDBWTM
     I              OMBXTM                          WDBXTM
     I              OMBYTM                          WDBYTM
     I              OMH5NX                          WDH5NX
     I              OMH6NX                          WDH6NX
     I              OMH7NX                          WDH7NX
     I              OMH8NX                          WDH8NX
     I              OMH9NX                          WDH9NX
     I              OMDVPR                          WDDVPR
     I              OMDWPR                          WDDWPR
     I              OMDXPR                          WDDXPR
     I              OMDYPR                          WDDYPR
     I              OMDZPR                          WDDZPR
     I              OMGSPR                          WDGSPR
     I              OMGTPR                          WDGTPR
     I              OMGUPR                          WDGUPR
     I              OMHOST                          WDHOST
     I              OMHPST                          WDHPST
     I              OMIOST                          WDIOST
     I              OMPEWG                          WDPEWG
     I              OMRINY                          WDRINY
     I              OMTIDT                          WDTIDT
     I              OMTJDT                          WDTJDT
     I              OMH2ST                          WDH2ST
     I              OMH0ST                          WDH0ST
     I              OMH1ST                          WDH1ST
     I              OMTKDT                          WDTKDT
     I              OMTLDT                          WDTLDT
     I              OMTMDT                          WDTMDT
     I              OMUVST                          WDUVST
     I              OMUWST                          WDUWST
     I              OMUXST                          WDUXST
     I              OMAATM                          WDAATM
     I              OMAYNA                          WDAYNA
     I              OMA0NA                          WDA0NA
     I              OMAXDT                          WDAXDT
      *
     IYARDCS      DS                            525
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WEAIC3
     I              BEC4NB                          WEC4NB
     I              BEJNCD                          WEJNCD
     I              BEANC7                          WEANC7
     I              BEBKC7                          WEBKC7
     I              BEBRTX                          WEBRTX
     I              BEHMNA                          WEHMNA
     I              BEHONA                          WEHONA
     I              BEHPNA                          WEHPNA
     I              BEHNNA                          WEHNNA
     I              BEDBCD                          WEDBCD
     I              BECKTX                          WECKTX
     I              BEB0C7                          WEB0C7
     I              BEAETX                          WEAETX
     I              BEB1NA                          WEB1NA
     I              BEB3NA                          WEB3NA
     I              BEB4NA                          WEB4NA
     I              BEB2NA                          WEB2NA
     I              BEBHCD                          WEBHCD
     I              BEC8TX                          WEC8TX
     I              BEBCNA                          WEBCNA
     I              BEA0DT                          WEA0DT
     I              BEA5DT                          WEA5DT
     I              BEGNDT                          WEGNDT
     I              BEACDT                          WEACDT
     I              BEAQCD                          WEAQCD
     I              BEB6NA                          WEB6NA
     I              BEBYNA                          WEBYNA
     I              BEBZNA                          WEBZNA
     I              BEGTST                          WEGTST
     I              BEGVST                          WEGVST
     I              BEGUST                          WEGUST
     I              BEQFST                          WEQFST
     I              BECQCD                          WECQCD
     I              BEGJST                          WEGJST
     I              BEGWST                          WEGWST
     I              BEGXST                          WEGXST
     I              BEGYST                          WEGYST
     I              BEAODT                          WEAODT
     I              BEAIVN                          WEAIVN
     I              BECXDT                          WECXDT
     I              BEJZVA                          WEJZVA
     I              BEA1WG                          WEA1WG
     I              BEXIST                          WEXIST
     I              BEXJST                          WEXJST
     I              BEXKST                          WEXKST
     I              BEEIDT                          WEEIDT
     I              BEAFTM                          WEAFTM
     I              BEE8CD                          WEE8CD
     I              BEE9CD                          WEE9CD
     I              BERMNB                          WERMNB
     I              BETBNB                          WETBNB
     I              BER1NB                          WER1NB
     I              BEPJST                          WEPJST
     I              BEU0ST                          WEU0ST
     I              BEU1ST                          WEU1ST
     I              BEQ2CD                          WEQ2CD
     I              BEU2ST                          WEU2ST
     I              BEVEST                          WEVEST
     I              BEVFST                          WEVFST
     I              BEVGST                          WEVGST
     I              BERPCD                          WERPCD
     I              BERNNB                          WERNNB
     I              BEVDST                          WEVDST
     I              BEATIN                          WEATIN
     I              BEU4ST                          WEU4ST
     I              BEU5ST                          WEU5ST
     I              BERSRN                          WERSRN
     I              BEMHNA                          WEMHNA
     I              BEMINA                          WEMINA
     I              BEWBST                          WEWBST
     I              BER4CD                          WER4CD
     I              BEBFCD                          WEBFCD
     I              BEQ4CD                          WEQ4CD
     I              BET3NB                          WET3NB
     I              BESICD                          WESICD
     I              BECONB                          WECONB
     I              BECEST                          WECEST
     I              BEAWDT                          WEAWDT
     I              BEJPCD                          WEJPCD
     I              BEXUST                          WEXUST
     I              BEZ1ST                          WEZ1ST
     I              BEVRVA                          WEVRVA
     I              BEOBST                          WEOBST
     I              BEBCST                          WEBCST
     I              BEBDST                          WEBDST
     I              BEB7VL                          WEB7VL
     I              BEGASX                          WEGASX
     I              BEGBSX                          WEGBSX
     I              BEGCSX                          WEGCSX
     I              BEGDSX                          WEGDSX
     I              BEFNSX                          WEFNSX
     I              BEFOSX                          WEFOSX
     I              BEFPSX                          WEFPSX
     I              BEFQSX                          WEFQSX
     I              BEFRSX                          WEFRSX
     I              BEFSSX                          WEFSSX
     I              BEFTSX                          WEFTSX
     I              BEFUSX                          WEFUSX
     I              BEFVSX                          WEFVSX
     I              BEFWSX                          WEFWSX
     I              BEFXSX                          WEFXSX
     I              BEFYSX                          WEFYSX
     I              BENODT                          WENODT
     I              BENPDT                          WENPDT
     I              BENQDT                          WENQDT
     I              BENRDT                          WENRDT
     I              BENSDT                          WENSDT
     I              BEBPTM                          WEBPTM
     I              BEBQTM                          WEBQTM
     I              BEBRTM                          WEBRTM
     I              BEBSTM                          WEBSTM
     I              BEBTTM                          WEBTTM
     I              BEH0NX                          WEH0NX
     I              BEH1NX                          WEH1NX
     I              BEH2NX                          WEH2NX
     I              BEH3NX                          WEH3NX
     I              BEH4NX                          WEH4NX
     I              BEC0C7                          WEC0C7
     I              BEUVST                          WEUVST
     I              BEUWST                          WEUWST
     I              BEUXST                          WEUXST
     I              BEAATM                          WEAATM
     I              BEAYNA                          WEAYNA
     I              BEA0NA                          WEA0NA
     I              BEAXDT                          WEAXDT
      *
     IYBRDCS      DS                            779
      * Outward parameters
     IPBRC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PBAIC3
      * I :  Order Number
     I                                    P   3   60PBC4NB
      * I :  Order Type_Sales
     I                                        7   8 PBJNCD
      * I :  AR Customer Number
     I                                    P   9  120PBANC7
      * I :  Ship To Customer
     I                                    P  13  160PBBKC7
      * I :  Ship To Name
     I                                       17  46 PBBRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PBHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PBHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PBHPNA
      * I :  Ship To City
     I                                      137 156 PBHNNA
      * I :  Ship To State Code
     I                                      157 158 PBDBCD
      * I :  Ship To Zip_Postal Code
     I                                      159 169 PBCKTX
      * I :  Bill to Customer
     I                                    P 170 1730PBB0C7
      * I :  Bill to Name
     I                                      174 203 PBAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PBB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PBB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PBB4NA
      * I :  Bill to City
     I                                      294 313 PBB2NA
      * I :  Bill to State Code
     I                                      314 315 PBBHCD
      * I :  Bill to Zip_Postal Code
     I                                      316 326 PBC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PBBCNA
      * I :  Order Date
     I                                    P 342 3450PBA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PBA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PBGNDT
      * I :  Cancel Date
     I                                    P 354 3570PBACDT
      * I :  Terms Code
     I                                      358 359 PBAQCD
      * I :  Special Instructions
     I                                      360 399 PBB6NA
      * I :  Special Instructions 2
     I                                      400 439 PBBYNA
      * I :  Carrier Code
     I                                      440 442 PBBZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PBGTST
      * I :  Comment Print Inv_Cr_Memo
     I                                      444 444 PBGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PBGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PBQFST
      * I :  Reason Code
     I                                      447 449 PBCQCD
      * I :  Order in Use
     I                                      450 450 PBGJST
      * I :  Header Status
     I                                      451 451 PBGWST
      * I :  Header Status Last
     I                                      452 452 PBGXST
      * I :  Order Type Print Status
     I                                      453 453 PBGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PBAODT
      * I :  User Original Entry
     I                                      458 467 PBAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PBCXDT
      * I :  Order Value Total
     I                                    P 472 4772PBJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PBA1WG
      * I :  Credit Hold
     I                                      484 484 PBXIST
      * I :  Production Hold
     I                                      485 485 PBXJST
      * I :  New Customer Hold
     I                                      486 486 PBXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PBEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PBAFTM
      * I :  Accounts Receiv_Ent 1
     I                                      494 497 PBE8CD
      * I :  Accounts Receiv_Ent 2
     I                                      498 509 PBE9CD
      * I :  Load ID
     I                                    P 510 5130PBRMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PBTBNB
      * I :  Rated Freight
     I                                    P 517 5222PBR1NB
      * I :  LTL Flag
     I                                      523 523 PBPJST
      * I :  Price Audit
     I                                      524 524 PBU0ST
      * I :  Price Status
     I                                      525 525 PBU1ST
      * I :  Shipping Method
     I                                      526 527 PBQ2CD
      * I :  Export Status
     I                                      528 528 PBU2ST
      * I :  Palletize
     I                                      529 529 PBVEST
      * I :  Shrink Wrap
     I                                      530 530 PBVFST
      * I :  Slip Sheet
     I                                      531 531 PBVGST
      * I :  Age Code
     I                                      532 532 PBRPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PBRNNB
      * I :  Load Type
     I                                      536 536 PBVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PBATIN
      * I :  Load Plan Order
     I                                      541 541 PBU4ST
      * I :  Print Pick Slip
     I                                      542 542 PBU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PBRSRN
      * I :  Special Comment 1
     I                                      547 576 PBMHNA
      * I :  Special Comment 2
     I                                      577 606 PBMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PBWBST
      * I :  Sales Route Code
     I                                      608 610 PBR4CD
      * I :  Manager Level Code
     I                                      611 612 PBBFCD
      * I :  VP Level Code
     I                                      613 615 PBQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PBT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PBSICD
      * I :  Invoice Number
     I                                    P 623 6260PBCONB
      * I :  Invoice Suffix
     I                                      627 628 PBCEST
      * I :  Invoice Date
     I                                    P 629 6320PBAWDT
      * I :  Event Code
     I                                      633 634 PBJPCD
      * I :  Trans Contol AS400_Plant
     I                                      635 635 PBXUST
      * I :  Modified Flag
     I                                      636 636 PBZ1ST
      * I :  A_R order Value Total
     I                                    P 637 6422PBVRVA
      * I :  Billing Activity Type
     I                                      643 643 PBOBST
      * I :  Block Order Flag
     I                                      644 644 PBBCST
      * I :  Order Certification Flag
     I                                      645 645 PBBDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PBB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PBGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PBGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PBGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PBGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PBFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PBFOSX
      * I :  Order Emailed
     I                                      658 658 PBFPSX
      * I :  Export Docs Go w_Driver
     I                                      659 659 PBFQSX
      * I :  Shipping Temp Code C_F
     I                                      660 660 PBFRSX
      * I :  Broker Order Status
     I                                      661 661 PBFSSX
      * I :  Air Freight Order
     I                                      662 662 PBFTSX
      * I :  Order Requires Review
     I                                      663 664 PBFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PBFVSX
      * I :  Export USDA Approved
     I                                      667 668 PBFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PBFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PBFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PBNODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PBNPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PBNQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PBNRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PBNSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PBBPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PBBQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PBBRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PBBSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PBBTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PBH0NX
      * I :  Act Non_Ref Frt Amount
     I                                    P 721 7262PBH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PBH2NX
      * I :  OH Total Non_Ref Frt Amt
     I                                    P 733 7382PBH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PBH4NX
      * I :  Claim Number
     I                                    P 745 7480PBC0C7
      * I :  EDI Status 1
     I                                      749 749 PBUVST
      * I :  EDI Status 2
     I                                      750 750 PBUWST
      * I :  EDI Status 3
     I                                      751 751 PBUXST
      * I :  Job Time
     I                                    P 752 7550PBAATM
      * I :  User Id
     I                                      756 765 PBAYNA
      * I :  Job Name
     I                                      766 775 PBA0NA
      * I :  Job Date
     I                                    P 776 7790PBAXDT
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Header TRG
      * I : RST Company Number
     I                                    P   1   20P1AIC3
      * I : RST Order Number
     I                                    P   3   60P1C4NB
      * I :  Order Type_Sales
     I                                        7   8 P1JNCD
      * I : MAP Ship To Customer
     I                                    P   9  120P1BKC7
      * I :  Ship To Name
     I                                       13  42 P1BRTX
      * I : MAP Ship To City
     I                                       43  62 P1HNNA
      * I : MAP Ship To State Code
     I                                       63  64 P1DBCD
      * I : MAP Requested Ship Date
     I                                    P  65  680P1A5DT
      * I : MAP Actual Shipped Date
     I                                    P  69  720P1GNDT
      * I : MAP Scheduled Ship Date
     I                                    P  73  760P1AODT
      * I : MAP Requested Delivery Date
     I                                    P  77  800P1EIDT
      * B : MAP Price Audit
     I                                       81  81 P1U0ST
     IP2PARM      DS
      * FLD: Salesperson
      * I : MAP Salesperson Code
     I                                        1   3 P2BCCD
     IP3PARM      DS
      * FLD: Order Detail
      * N :  Order Sequence Number
     I                                    P   1   20P3DPNB
      * N :  Order Secondary Line Seq
     I                                    P   3   40P3UENB
     IP4PARM      DS
      * N :  Allow CMD13 Accept Price
     I                                        1   1 P4ACAP
     IP5PARM      DS
      * N :  First Time Flag
     I                                        1   1 P5TAST
     IP6PARM      DS
      * N :  Seq No 1  PASS        USR
     I                                    P   1   85P6SEQ1
     IP7PARM      DS
      * N :  Seq No 2  PASS        USR
     I                                    P   1   85P7SEQ2
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
     C           P1JNCD    PARM           WP0003  2        Order Type_Sale
     C           P1BKC7    PARM           WP0004  70       Ship To Custome
     C           P1BRTX    PARM           WP0005 30        Ship To Name
     C           P1HNNA    PARM           WP0006 20        Ship To City
     C           P1DBCD    PARM           WP0007  2        Ship To State C
     C           P1A5DT    PARM           WP0008  70       Requested Ship
     C           P1GNDT    PARM           WP0009  70       Actual Shipped
     C           P1AODT    PARM           WP0010  70       Scheduled Ship
     C           P1EIDT    PARM           WP0011  70       Requested Deliv
     C           P1U0ST    PARM P1U0ST    WP0012  1        Price Audit
     C           P2BCCD    PARM           WP0013  3        Salesperson Cod
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise & load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END                             OD W0RSF
     C                     END                             OD *HIVAL
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise and load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
      * USER: Initialize subfile control
      * RMC 6/4/13 use one RTV for OH fields, added cust po
      * RTV Abs Frt,PO,Total  RT - Order Header TRG  * 
     C                     EXSR SARVGN
      * RTV Event Date         RT - Order Events  * 
     C                     EXSR SBRVGN
      * CTL.USR Desc. 10 = Condition name of CTL.Price Audit
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1250401   Y2LSNO  70       List number
     C                     PARM #2U0ST    W0INVL 25        Price Audit
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #CNCNA    PARM           W0CNNM 25        USR Desc. 10
      *
      * RTV Customer Name      RT - Customer  * 
     C                     EXSR SCRVGN
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SDRVGN
      * RTV Salesperson Name   RT - Salesperson  * 
     C                     EXSR SERVGN
      * CRT Price Audit Log    CR - PD Price Audit Log Work  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0001           Company Number
     C                     Z-ADD#2C4NB    WL0002           Order Number
     C                     MOVEL#PBCCD    WL0003    P      Salesperson Cod
     C                     Z-ADD##JDT     WL0004           Transaction Dat
     C                     Z-ADD##JTM     WL0005           Time
     C                     MOVEL'APE'     WL0006    P      Update Point
     C                     MOVEL#2U0ST    WL0007    P      Price Audit
     C                     EXSR SFCRRC
      * ** Retrieve shippping method from Order Header    2/16/06 LJB
      * ** Retrieve condition name for retrieved status   2/16/06 LJB
      * CTL.USR Shortened Name - 12 = Condition name of CTL.Shipping Meth
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1252129   Y2LSNO  70       List number
     C                     PARM #CQ2CD    W0INVL 25        Shipping Method
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #CJZNA    PARM           W0CNNM 25        USR Shortened N
      *
      * ** Highlight freight if zeros and ship method = prepaid   2/17/06
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.Absorbed Freight Rate is EQ Zeros
      *   |- c2    : CTL.Shipping Method is Prepaid
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CTBNB    IFEQ *ZERO                      *IF
     C           #CQ2CD    IFEQ 'PR'                       *IF
     C           #CQ2CD    OREQ 'PT'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUQKST           Display Flag
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUQKST           Display Flag
     C                     END                             *FI
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0008           Company Number
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0009    YN0001    P      Plant Company S
     C                     MOVELWL0010    YL0001    P      Company Organiz
      * C2226 HPB display    8/17/12
      * CASE: LCL.Company Organization is High Plains Biodiesel
     C           YL0001    IFEQ 'H'                        *IF
      * RTV HPB Equiv only   RT - Order Header Extension  * 
     C                     EXSR SHRVGN
      * CASE: CTL.HPB Equivalence Value USR is Not Entered
     C           #CP4NY    IFEQ *ZERO                      *IF
     C                     Z-ADD1.5       #CP4NY           HPB Equivalence
     C                     END                             *FI
     C                     END                             *FI
      * Rtv Gate Price        RT - Order Detail  * 
     C                     EXSR SIRVGN
      * CASE: LCL.Order Gate/Final Price is Not Zeros
     C           YL0003    IFNE *ZERO                      *IF
      * CLC Extend Prc f/ovrge RT - Order Detail  * 
     C                     EXSR SJRVGN
     C                     END                             *FI
      * Position DBF file
     C           KPOS      KLIST
     C                     KFLD           OMAIC3           Company Number
     C                     KFLD           OMC4NB           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Setup key
     C                     Z-ADD#2AIC3    OMAIC3
     C                     Z-ADD#2C4NB    OMC4NB
     C                     Z-ADD#2DPNB    OMDPNB
     C                     Z-ADD#2UENB    OMUENB
     C           KPOS      SETLL@BGWKL1
     C           KRST      KLIST
     C                     KFLD           OMAIC3           Company Number
     C                     KFLD           OMC4NB           Order Number
      * Setup key
     C                     Z-ADD#2AIC3    OMAIC3
     C                     Z-ADD#2C4NB    OMC4NB
     C           KRST      READE@BGWKL1                8782*82=EOF
      * Save previous selector values
     C           *LIKE     DEFN #2XIST    WZXIST
     C                     MOVEL#2XIST    WZXIST           Credit Hold
     C           *LIKE     DEFN #2XJST    WZXJST
     C                     MOVEL#2XJST    WZXJST           Production Hold
     C           *LIKE     DEFN #2GWST    WZGWST
     C                     MOVEL#2GWST    WZGWST           Header Status
     C           *LIKE     DEFN #2JNCD    WZJNCD
     C                     MOVEL#2JNCD    WZJNCD           Order Type_Sale
     C           *LIKE     DEFN #2RMNB    WZRMNB
     C                     MOVEL#2RMNB    WZRMNB           Load ID
     C           *LIKE     DEFN #2U2ST    WZU2ST
     C                     MOVEL#2U2ST    WZU2ST           Export Status
     C           *LIKE     DEFN #2HNNA    WZHNNA
     C                     MOVEL#2HNNA    WZHNNA           Ship To City
     C           *LIKE     DEFN #2DBCD    WZDBCD
     C                     MOVEL#2DBCD    WZDBCD           Ship To State C
     C           *LIKE     DEFN #2AFTM    WZAFTM
     C                     MOVEL#2AFTM    WZAFTM           Requested Deliv
     C           *LIKE     DEFN #2GJST    WZGJST
     C                     MOVEL#2GJST    WZGJST           Order in Use
     C           *LIKE     DEFN #2AJCD    WZAJCD
     C                     MOVEL#2AJCD    WZAJCD           Warehouse Code
     C           *LIKE     DEFN #2DPNB    WZDPNB
     C                     MOVEL#2DPNB    WZDPNB           Order Sequence
     C           *LIKE     DEFN #2UENB    WZUENB
     C                     MOVEL#2UENB    WZUENB           Order Secondary
     C           *LIKE     DEFN #2AIC3    WZAIC3
     C                     MOVEL#2AIC3    WZAIC3           Company Number
     C           *LIKE     DEFN #2A5DT    WZA5DT
     C                     MOVEL#2A5DT    WZA5DT           Requested Ship
     C           *LIKE     DEFN #2AODT    WZAODT
     C                     MOVEL#2AODT    WZAODT           Scheduled Ship
     C           *LIKE     DEFN #2BKC7    WZBKC7
     C                     MOVEL#2BKC7    WZBKC7           Ship To Custome
     C           *LIKE     DEFN #2GNDT    WZGNDT
     C                     MOVEL#2GNDT    WZGNDT           Actual Shipped
     C           *LIKE     DEFN #2C4NB    WZC4NB
     C                     MOVEL#2C4NB    WZC4NB           Order Number
     C           *LIKE     DEFN #2EIDT    WZEIDT
     C                     MOVEL#2EIDT    WZEIDT           Requested Deliv
     C           *LIKE     DEFN #2U0ST    WZU0ST
     C                     MOVEL#2U0ST    WZU0ST           Price Audit
      * Load subfile page
     C                     Z-ADD0         ##RROK  50
     C                     EXSR BBLDSF
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
      * Re-establish fields in read-ahead record
     C   27                DO
     C  N82                READP@BGWKL1                  90*
     C  N82                READ @BGWKL1                  90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVEL*ALL'0'   WKIND0  1
     C                     MOVEAWKIND0    *IN,31
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
      * Reset count of DBF records read
     C                     Z-ADD0         ##RRRD  90
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next SFL page until SFL page full, or
      * Scan limit reached
     C           *IN82     DOWEQ'0'                        DO
     C           ##RROK    ANDLT##SFLN
     C           ##RRRD    ANDLTW0SLM
      * Check selection fields - if fail, read next record
     C           #2AJCD    IFNE *BLANK                     Warehouse Code
     C           OMAJCD    CABNE#2AJCD    BB020            Warehouse Code
     C                     END
      * Load SFL fields
     C                     EXSR MBFL#1
     C                     MOVEL'Y'       W0RSL   1
      * Allow for possible *Set Cursor processing
     C                     ADD  1         ##RR
      * USER: Initialize subfile record from DBF record
      * Exclude cancelled lines
      * CASE: DB1.Detail Line Status is Cancelled
     C           OMGMST    IFEQ 'X'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * If last order sequence number has been read then allow CMD13=Yes
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Order Sequence Number EQ DB1.Order Sequence Numb
      *   |- c2    : PAR.Order Secondary Line Seq EQ DB1.Order Secondary
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3DPNB    IFEQ OMDPNB                     *IF
     C           P3UENB    IFEQ OMUENB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       P4ACAP           Allow CMD13 Acc
     C                     END                             *FI
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Save first line seq. numbers
      * CASE: PAR.First Time Flag is Yes
     C           P5TAST    IFEQ 'Y'                        *IF
     C                     Z-ADDOMDPNB    P6SEQ1           Seq No 1  PASS
     C                     Z-ADDOMUENB    P7SEQ2           Seq No 2  PASS
     C                     MOVELOMAJCD    #CT3CD           Warehouse Code
     C                     MOVEL'N'       P5TAST           First Time Flag
     C                     END                             *FI
      * Set substitution flag
      * CASE: DB1.Order Secondary Line Seq is GT 1
     C           OMUENB    IFGT 1                          *IF
     C                     MOVEL'Y'       #RPRST           Substitution Fl
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #RPRST           Substitution Fl
     C                     END                             *FI
     C                     Z-ADD#1CBQT    #RF4QT           USR Quantity Sh
      * Val Check Exist        RT - PD Order Detail Fin  * 
     C                     EXSR SKRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       #RA8ST           USR Financials
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWUGSTX    #RA8ST           USR Financials
     C                     END                             *FI
     C                     END                             *FI
      * Rtv Deduct/Add Exist  RT - Order Detail Accrual  * 
     C                     EXSR SLRVGN
     C                     SUB  1         ##RR
      * DBF record not selected
     C           W0RSL     CABNE'Y'       BB020
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Output to subfile
     C                     ADD  1         ##RR
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
     C                     WRITE#SFLRCD
     C           BB020     TAG
      * Increment scan check count
     C                     ADD  1         ##RRRD
     C           KRST      READE@BGWKL1                  82*82=EOF
     C                     END                             OD 1 - ##SFPG
      *................................................................
     C           BB900     TAG
      *................................................................
      * If no DBF records found, display error message
     C           ##RR      IFEQ *ZERO
     C           *IN82     ANDEQ'1'
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI ##RR = *ZERO
      *
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      * If scan limit reached, display error message
     C           ##RRRD    IFGE W0SLM
      * Send message '*Scan limit reached'
     C                     MOVEL'Y2U0017' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     ELSE
     C                     Z-ADD0         ##RROK
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen
      *================================================================
      * Convert fields to external form
     C  N30N27             EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Update screen time
     C                     TIME           ##TME
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     SETOF                       8392*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
     C           YPMTFD    IFNE *BLANKS
     C           YPMRRN    ANDEQ*ZERO
     C                     GOTO DAEXIT
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process subfile control (Pre-confirm)
      * F13 - Accept Pricing
      * CASE: CTL.*CMD key is *Accept Pricing
     C           *IN13     IFEQ '1'                        *IF
      * CASE: PAR.Allow CMD13 Accept Price is yes
     C           P4ACAP    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Accept Price CMD13 Not Al'
     C                     MOVEL'USR2373' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * Reload subfile requested
     C           W0RSF     CABEQ'Y'       DAEXIT
     C                     END
     C           *IN81     IFEQ '1'
      * Process subfile records
     C                     EXSR DBPRSF
     C                     END
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * If error, quit processing
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPRCF
      * Exit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO DAEXIT
     C                     END
      * Process subfile (pass 2)
     C                     EXSR EAPRSF
      * If error during 2nd pass exit:
     C           *IN99     CABEQ'1'       DAEXIT
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
      * Process subfile record
     C                     EXSR DCPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Setof error indicators and SFLNXTCHG
     C                     MOVEAWKIND0    *IN,31
     C                     SETOF                     98    *
     C           YPMTFD    CABNE*BLANKS   DCEXIT
      * SFLNXTCHG
     C                     SETON                     84
      * USER: Process subfile record (Pre-confirm)
      * CASE: RCD.*SFLSEL is *Display
     C           #1SEL     IFEQ '5'                        *IF
     C           #1SEL     OREQ ' 5'
      * DSP Ship Price Details DF - Order Detail Pricing  * 
     C                     CALL 'PDM4DFR'              90  DSP Ship Price
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0011  30       Company Number
     C                     PARM #2C4NB    WQ0012  70       Order Number
     C                     PARM #1DPNB    WQ0013  30       Order Sequence
     C                     PARM #1UENB    WQ0014  30       Order Secondary
     C                     PARM P1JNCD    WQ0015  2        Order Type_Sale
     C                     PARM #1BKC7    WQ0016  70       Ship To Custome
     C                     PARM P1BRTX    WQ0017 30        Ship To Name
     C                     PARM #1A5DT    WQ0018  70       Requested Ship
     C                     PARM #1GNDT    WQ0019  70       Actual Shipped
     C                     PARM #1HGCD    WQ0020  70       Item Code
     C                     PARM #1AJCD    WQ0021  3        Warehouse Code
     C                     PARM #1AYVA    WQ0022 112       Extended Amount
     C                     PARM #1EXDT    WQ0023  70       Market Pricing
     C                     PARM #1LQCD    WQ0024  3        Commodity Marke
     C                     PARM #1RDCD    WQ0025  3        Date Method Cod
     C                     PARM #1Q7CD    WQ0026  3        Price Method Co
     C                     PARM #1BZPR    WQ0027 114       Price Overage O
     C                     PARM #1L6NB    WQ0028  70       Contract Number
     C                     PARM #1U1ST    WQ0029  1        Price Status
     C                     PARM #1GIDT    WQ0030  70       Pricing Date Us
     C                     PARM #1CRCD    WQ0031  2        U_M_Base Price
     C                     PARM #1AGCD    WQ0032  2        U_M_Ordered
     C                     PARM #1G7NA    WQ0033 30        Order Desc_Line
     C                     PARM #1U0ST    WQ0034  1        Price Audit
     C                     PARM #1RFCD    WQ0035  3        Price Audit Rea
     C                     PARM #1CCQT    WQ0036 112       Quantity Schedu
     C                     PARM #1CBQT    WQ0037 112       Quantity Shippe
     C                     PARM #1AKPR    WQ0038 114       Unit Price
     C                     PARM #1AUPR    WQ0039 114       Unit Price Orde
     C                     PARM #1AVWG    WQ0040 112       Unit Weight Ord
     C                     PARM #1BVTM    WQ0041  60       Price Code
     C                     PARM #1DWPR    WQ0042 114       OD Ceiling Pric
     C                     PARM #1TKDT    WQ0043  70       OD Market Begin
     C                     PARM #1TLDT    WQ0044  70       OD Market Endin
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDM4DFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: RCD.*SFLSEL is *Financial Detail
     C           #1SEL     IFEQ '7'                        *IF
     C           #1SEL     OREQ ' 7'
      * DSP Ship Detail Finan. DF - PD Order Detail Fin  * 
     C                     CALL 'PDWRDFR'              90  DSP Ship Detail
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0045  30       Company Number
     C                     PARM #2C4NB    WQ0046  70       Order Number
     C                     PARM #1DPNB    WQ0047  30       Order Sequence
     C                     PARM #1UENB    WQ0048  30       Order Secondary
     C                     PARM #1HGCD    WQ0049  70       Item Code
     C                     PARM #1G7NA    WQ0050 30        Order Desc_Line
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDWRDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: RCD.*SFLSEL is Option 9
     C           #1SEL     IFEQ '9'                        *IF
     C           #1SEL     OREQ ' 9'
      * Dsp Ord Dtl Accr      DF - Order Detail Accrual  * 
     C                     CLEARPARC
     C                     Z-ADD#1AIC3    PAAIC3           Company Number
     C                     Z-ADD#1C4NB    PAC4NB           Order Number
     C                     Z-ADD#1DPNB    PADPNB           Order Sequence
     C                     Z-ADD#1UENB    PAUENB           Order Secondary
      *
     C                     CALL 'PNNEDFR'              90  Dsp Ord Dtl Acc
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Order Deta
     C                     PARM #1HGCD    WQ0051  70       Item Code
     C                     PARM #1BKC7    WQ0052  70       Ship To Custome
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNNEDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'N'       W0RSF            *Reload subfile
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     END                             FI *IN98
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         DHPRCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      * Update screen time
     C                     TIME           ##TME
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#SFLCTL
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         EAPRSF    BEGSR
      *================================================================
      * Update DBF from subfile
      *================================================================
      * USER: Process subfile control (Post-confirm)
      * CASE: CTL.*CMD key is *Accept Pricing
     C           *IN13     IFEQ '1'                        *IF
      * UPD Accept Price Audit RT - PD Order Detail  * 
     C                     EXSR SMRVGN
     C                     MOVEL'M'       #2U0ST           Price Audit
      * CRT Price Audit Log    CR - PD Price Audit Log Work  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0001           Company Number
     C                     Z-ADD#2C4NB    WL0002           Order Number
     C                     MOVEL#PBCCD    WL0003    P      Salesperson Cod
     C                     Z-ADD##JDT     WL0004           Transaction Dat
     C                     Z-ADD##JTM     WL0005           Time
     C                     MOVEL'PAU'     WL0006    P      Update Point
     C                     MOVEL#2U0ST    WL0007    P      Price Audit
     C                     EXSR SFCRRC
      * CHG Price Audit        CH - OP Order Header  * 
     C                     EXSR SQCHRC
     C                     MOVEL#2U0ST    P1U0ST           Price Audit
      * 2014/09/09 PKD Create 855 during Price Audit also
      * Val for PO Ack        IF
     C                     MOVEL'N'       YL0009           EDI Process Fla
      * Retrieve the BT Customer
      * Rtv Order Info ALL    RT - Order Header TRG  * 
     C                     EXSR SRRVGN
      * Check to see it the BT Cust should get a POA/POAC (ack or chgd ac
      * RTV BT Intrchg BT custRT - EDI Bill To Interchange  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0010    WL0011           Bill to Custome
     C                     MOVEL'POACK'   WL0012    P      Interchange Cod
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0013    YL0013    P      POC/POCA ??
     C                     MOVELWL0014    YL0014    P      EDI Trading Par
      * W95589 DN 01/24/23-Commented Out & Moved Below.
      * W95589 DN 01/24/23-Only Check if Record Exist to Set EDI POA Flag
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Chk to see if BT cust requires a EDI PO ACK
      * CASE: LCL.POC/POCA ?? is PO Ack
     C           YL0013    IFEQ 'POACK'                    *IF
     C                     MOVEL'Y'       YL0015           EDI POA
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0015           EDI POA
     C                     END                             *FI
     C                     END                             *FI
      * RTV BT Intrchg BT custRT - EDI Bill To Interchange  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0010    WL0011           Bill to Custome
     C                     MOVEL'POCACK'  WL0012    P      Interchange Cod
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0013    YL0013    P      POC/POCA ??
     C                     MOVELWL0014    YL0014    P      EDI Trading Par
      * W95589 DN 01/24/23-Commented Out & Moved Below.
      * W95589 DN 01/24/23-Only Check if Record Exist to Set EDI POAC Fla
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Chk to see if BT cust requires a EDI PO Chg ACK
      * CASE: LCL.POC/POCA ?? is PO Change Ack
     C           YL0013    IFEQ @CN,001                    *IF
     C                     MOVEL'Y'       YL0016           EDI POAC
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0016           EDI POAC
     C                     END                             *FI
     C                     END                             *FI
      * See if a rcd has been written to OH ext.
      * RTV EDI PO Flag       RT - Order Header Extension  * 
     C                     EXSR STRVGN
      * Record found in Order header ext
      * CASE: LCL.Record Found USR is Record Found
     C           YL0018    IFEQ 'Y'                        *IF
      * If flag blank, No ack has been sent for this PO yet.
      * CASE:
      *  - c1ORc2
      *   |- c1    : LCL.OHE PO ACK Flag is *Blank
      *   |- c2    : LCL.OHE PO ACK Flag is *NO
      *   '-
     C           YL0017    IFEQ *BLANK                     *IF
     C           YL0017    OREQ '*NO'                      *OR
      * CASE: LCL.EDI POA is Yes
     C           YL0015    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       YL0009           EDI Process Fla
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * If flag not blank, 855 ack has been sent for this PO. Need to sen
      * another 855(865) if the customer is set up for it.
      * CASE: LCL.EDI POAC is Yes
     C           YL0016    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       YL0009           EDI Process Fla
     C                     END                             *FI
     C                     END                             *FI
      * If record not found and POA is yes, send
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.EDI POA is Yes
     C           YL0015    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       YL0009           EDI Process Fla
     C                     END                             *FI
     C                     END                             *FI
      * When all chks are done, need to check to see if the Cust PO
      * has been entered. If not,do not send to customer.
      * If Cust PO# not entered
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5ORc6
      *   |- c1    : LCL.Customer Purchase Order # is tba
      *   |- c2    : LCL.Customer Purchase Order # is TBA(cap)
      *   |- c3    : LCL.Customer Purchase Order # is TBD(cap)
      *   |- c4    : LCL.Customer Purchase Order # is tbd
      *   |- c5    : LCL.Customer Purchase Order # is BLOCK(cap)
      *   |- c6    : LCL.Customer Purchase Order # is Block
      *   '-
     C           YL0011    IFEQ 'tba'                      *IF
     C           YL0011    OREQ 'TBA'                      *OR
     C           YL0011    OREQ 'TBD'                      *OR
     C           YL0011    OREQ 'tbd'                      *OR
     C           YL0011    OREQ 'BLOCK'                    *OR
     C           YL0011    OREQ 'Block'                    *OR
      * S13599 DN 08/16/18-Added check for 'TBD, tbd, BLOCK & Block'.
     C                     MOVEL'N'       YL0009           EDI Process Fla
     C                     MOVEL'NP'      YL0008           Trans Type 1 PA
     C                     END                             *FI
      * 2014/09/10 PKD/SAZ Check if PO was sent via EDI for SYSCO.  If ye
      *                    Create an 855; otherwise don't do it.
      * E003964 SLM  02/24/2015 logic for SYSCO & DSYSCO Work the same
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.EDI Trading Partner No. is SYSCO Dailys
      *   |- c2    : LCL.EDI Trading Partner No. is SYSCO Foods
      *   '-
     C           YL0014    IFEQ @CN,002                    *IF
     C           YL0014    OREQ 'SYSCO'                    *OR
      * VAL PO Exists         RT - EDI Purchase Order Header  * 
     C                     EXSR SURVGN
      * VAL: Return Code
      * CASE: LCL.Record Found USR is Record Not Found
     C           YL0018    IFEQ 'N'                        *IF
     C                     MOVEL'N'       YL0009           EDI Process Fla
     C                     MOVEL'TP'      YL0008           Trans Type 1 PA
     C                     END                             *FI
     C                     END                             *FI
      *  7/13/2021 JBB SDD657 - Trading Partner Control
      * Rtv EDI Manual PO Sts XF - EDI Bill To Interchange  * POACK
     C                     CALL 'PUTBXFR'              90  Rtv EDI Manual
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0053  30       Company Number
     C                     PARM #2C4NB    WQ0054  70       Order Number
     C                     PARM 'POACK'   WQ0055  6        Interchange Cod
     C           YL0019    PARM *BLANK    WQ0056  1        Send EDI Docume
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUTBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * If Send EDI Invoice = N, set EDI Process Flag = N
      * CASE: LCL.Send EDI Document Y/N is No
     C           YL0019    IFEQ 'N'                        *IF
     C                     MOVEL'N'       YL0009           EDI Process Fla
     C                     END                             *FI
      * CASE: LCL.EDI Process Flag is Process
     C           YL0009    IFEQ 'Y'                        *IF
      * 2014/09/09 PKD Added Price Audit condition
      * Do we need to EDI 855/865?
      * CASE:
      *  - c1 ORc2ORc3ORc4
      *   |- c1    : PAR.Pricing Event Called From is Market Price Change
      *   |- c2    : PAR.Pricing Event Called From is Order Entry
      *   |- c3    : PAR.Pricing Event Called From is Price Maintenance
      *   |- c4    : PAR.Pricing Event Called From is Price Audit
      *   '-
     C           'PA'      IFEQ 'MPC'                      *IF
     C           'PA'      OREQ 'OE'                       *OR
     C           'PA'      OREQ 'PM'                       *OR
     C           'PA'      OREQ 'PA'                       *OR
      * CASE: LCL.Price Status is Priced
     C           YL0012    IFEQ 'P'                        *IF
      * Rtv/Crt EDI PO Ack    XF - EDI PO Ack Hdr  * 
     C                     CALL 'PNYLXFR'              90  Rtv/Crt EDI PO
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0057  30       Company Number
     C                     PARM #2C4NB    WQ0058  70       Order Number
     C           YL0008    PARM YL0008    WQ0059  2        Trans Type 1 PA
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNYLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'OP'      YL0008           Trans Type 1 PA
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ---------------------------
     C                     MOVEL'PAC'     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C           *IN81     IFEQ '1'
      * Process all modified subfile records
     C                     READC#SFLRCD                  92*
     C           *IN92     DOWEQ'0'
      * Process modified subfile record
     C                     EXSR EBPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END                             WOD *92
     C                     END                             FI *81
      * If any errors, cancel reload
     C           *IN99     IFEQ '1'
     C                     MOVEL'N'       W0RSF   1
     C                     END
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPRSR    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,31
     C                     SETOF                     98
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C                     SETON                     84    SFLNXTCHG
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     GOTO EBEXIT
     C                     ELSE
      * SFLRCD valid
     C                     SETOF                     84    SFLNXTCHG
     C                     MOVEL*BLANK    #1SEL
     C                     END                             FI *IN98
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         GBDSA2    BEGSR
      *================================================================
      * Set display attributes for Subfile control
      *================================================================
     C                     MOVEL'0'       *IN79
     C           WUQKST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           #CYJVA    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           YL0001    IFEQ 'D'                        *IF
     C           YL0001    OREQ 'S'
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @BGWKL1 fields to subfile
      *================================================================
     C                     MOVEL*BLANK    #1SEL
     C                     Z-ADDOMAIC3    #1AIC3           Company Number
     C                     Z-ADDOMC4NB    #1C4NB           Order Number
     C                     Z-ADDOMDPNB    #1DPNB           Order Sequence
     C                     Z-ADDOMUENB    #1UENB           Order Secondary
     C                     Z-ADDOMCBQT    #1CBQT           Quantity Shippe
     C                     MOVELOMAJCD    #1AJCD           Warehouse Code
     C                     Z-ADDOMAVQT    #1AVQT           Quantity Ordere
     C                     Z-ADDOMD0WG    #1D0WG           Weight Ordered
     C                     Z-ADDOMALPR    #1ALPR           Unit Price_Cred
     C                     MOVELOMAGCD    #1AGCD           U_M_Ordered
     C                     Z-ADDOMAUPR    #1AUPR           Unit Price Orde
     C                     MOVELOMG8NA    #1G8NA           Order Desc_Line
     C                     Z-ADDOMAGCS    #1AGCS           Unit Cost Per P
     C                     Z-ADDOMAQCS    #1AQCS           Unit Cost Prici
     C                     Z-ADDOMAVWG    #1AVWG           Unit Weight Ord
     C                     MOVELOMAMST    #1AMST           Affect Inventor
     C                     MOVELOMANST    #1ANST           Affect Sales Do
     C                     MOVELOMVAST    #1VAST           Affect Sales Pn
     C                     Z-ADDOML6NB    #1L6NB           Contract Number
     C                     Z-ADDOMATWG    #1ATWG           Weight Shipped
     C                     Z-ADDOMCCQT    #1CCQT           Quantity Schedu
     C                     Z-ADDOMAUWG    #1AUWG           Weight Schedule
     C                     Z-ADDOMBKC7    #1BKC7           Ship To Custome
     C                     Z-ADDOMCFC7    #1CFC7           Order Group Cod
     C                     MOVELOMFZST    #1FZST           Production Date
     C                     MOVELOMAVST    #1AVST           Catch Weight St
     C                     MOVELOMGMST    #1GMST           Detail Line Sta
     C                     MOVELOMGNST    #1GNST           Detail Line Sta
     C                     MOVELOMR4CD    #1R4CD           Sales Route Cod
     C                     MOVELOMGTST    #1GTST           Comment Print A
     C                     MOVELOMGVST    #1GVST           Comment Print I
     C                     MOVELOMGUST    #1GUST           Comment Print P
     C                     MOVELOMQFST    #1QFST           Comment Print S
     C                     MOVELOMKXCD    #1KXCD           Country Code
     C                     Z-ADDOMR1NB    #1R1NB           Rated Freight
     C                     MOVELOMRZST    #1RZST           Work Confirm St
     C                     MOVELOMR0ST    #1R0ST           Work Over_Short
     C                     MOVELOMR1ST    #1R1ST           OD Production P
     C                     Z-ADDOMEXDT    #1EXDT           Market Pricing
     C                     Z-ADDOMBZPR    #1BZPR           Price Overage O
     C                     MOVELOMU1ST    #1U1ST           Price Status
     C                     MOVELOMU0ST    #1U0ST           Price Audit
     C                     MOVELOMRPCD    #1RPCD           Age Code
     C                     MOVELOMVEST    #1VEST           Palletize
     C                     Z-ADDOMMAVA    #1MAVA           Billing Detail
     C                     Z-ADDOMKDVA    #1KDVA           Billing Detail
     C                     MOVELOMVGST    #1VGST           Slip Sheet
     C                     Z-ADDOML8VA    #1L8VA           Billing Detail
     C                     Z-ADDOML9VA    #1L9VA           Quantity to Sub
     C                     Z-ADDOMA4WG    #1A4WG           Tare Weight Tot
     C                     MOVELOMRDCD    #1RDCD           Date Method Cod
     C                     MOVELOMLQCD    #1LQCD           Commodity Marke
     C                     MOVELOMCQCD    #1CQCD           Reason Code
     C                     MOVELOMHICD    #1HICD           Quality Level
     C                     MOVELOMRNCD    #1RNCD           Pricing Product
     C                     MOVELOMROCD    #1ROCD           Season Product
     C                     Z-ADDOMCXDT    #1CXDT           Date of Origina
     C                     MOVELOMAJVN    #1AJVN           User Profile Na
     C                     MOVELOMRBCD    #1RBCD           Item Level
     C                     Z-ADDOMRGNB    #1RGNB           Item Structure
     C                     Z-ADDOMRHNB    #1RHNB           Item Structure
     C                     Z-ADDOMRINB    #1RINB           Item Structure
     C                     Z-ADDOMGIDT    #1GIDT           Pricing Date Us
     C                     Z-ADDOMGNDT    #1GNDT           Actual Shipped
     C                     Z-ADDOMA5DT    #1A5DT           Requested Ship
     C                     MOVELOMJPCD    #1JPCD           Event Code
     C                     MOVELOMZ1ST    #1Z1ST           Modified Flag
     C                     Z-ADDOMAODT    #1AODT           Scheduled Ship
     C                     MOVELOMZ3ST    #1Z3ST           Substituted Fla
     C                     MOVELOMZ4ST    #1Z4ST           OD Schedule Ove
     C                     Z-ADDOMDUPR    #1DUPR           Invoice Unit Pr
     C                     Z-ADDOMB6VL    #1B6VL           Invoice Extende
     C                     Z-ADDOMA1AA    #1A1AA           Ham Group Numbe
     C                     MOVELOMFZSX    #1FZSX           OD Adj Type Ove
     C                     MOVELOMF0SX    #1F0SX           Affect Trade Fu
     C                     MOVELOMF1SX    #1F1SX           Affect Commissi
     C                     MOVELOMF2SX    #1F2SX           Affect Pricing
     C                     MOVELOMF3SX    #1F3SX           Released by Use
     C                     MOVELOMF4SX    #1F4SX           Ord TF Exempt C
     C                     MOVELOMF5SX    #1F5SX           OD Pallet Type
     C                     MOVELOMF6SX    #1F6SX           Production Ware
     C                     MOVELOMF7SX    #1F7SX           OD Price Type
     C                     Z-ADDOMNTDT    #1NTDT           Warehouse Palle
     C                     Z-ADDOMNUDT    #1NUDT           Consumed Item C
     C                     Z-ADDOMNVDT    #1NVDT           Deadline Depart
     C                     Z-ADDOMNWDT    #1NWDT           OD Price Type R
     C                     Z-ADDOMNXDT    #1NXDT           OD Firm Date
     C                     Z-ADDOMBUTM    #1BUTM           Deadline Depart
     C                     Z-ADDOMBVTM    #1BVTM           Price Code
     C                     Z-ADDOMBWTM    #1BWTM           Maximum Net Wei
     C                     Z-ADDOMBXTM    #1BXTM           Substitution Li
     C                     Z-ADDOMBYTM    #1BYTM           Max Qty to sche
     C                     Z-ADDOMH5NX    #1H5NX           Warehouse Palle
     C                     Z-ADDOMH6NX    #1H6NX           Warehouse Avg P
     C                     Z-ADDOMH7NX    #1H7NX           OD Item Target
     C                     Z-ADDOMH8NX    #1H8NX           OD Estimated Gr
     C                     Z-ADDOMH9NX    #1H9NX           OD Maximum Unit
     C                     Z-ADDOMDVPR    #1DVPR           Order Gate_Fina
     C                     Z-ADDOMDWPR    #1DWPR           OD Ceiling Pric
     C                     Z-ADDOMDXPR    #1DXPR           OD Gate_Final P
     C                     Z-ADDOMDYPR    #1DYPR           OD Weighted Avg
     C                     Z-ADDOMDZPR    #1DZPR           OD Original Ord
     C                     Z-ADDOMGSPR    #1GSPR           OD Cancel Date
     C                     Z-ADDOMGTPR    #1GTPR           OD Unused Prc 7
     C                     Z-ADDOMGUPR    #1GUPR           OD Unused Prc 8
     C                     MOVELOMHOST    #1HOST           OD MPR Sent to
     C                     MOVELOMHPST    #1HPST           OD MPR Prc Read
     C                     MOVELOMIOST    #1IOST           OD UnUsed Price
     C                     Z-ADDOMPEWG    #1PEWG           Weight Amount E
     C                     Z-ADDOMRINY    #1RINY           Item Age Days
     C                     Z-ADDOMTIDT    #1TIDT           Production Ovr
     C                     Z-ADDOMTJDT    #1TJDT           Production Ovr
     C                     MOVELOMH2ST    #1H2ST           OD Spot Buy
     C                     MOVELOMH0ST    #1H0ST           OD Clm Full Ret
     C                     MOVELOMH1ST    #1H1ST           Order Line Erro
     C                     Z-ADDOMTKDT    #1TKDT           OD Market Begin
     C                     Z-ADDOMTLDT    #1TLDT           OD Market Endin
     C                     Z-ADDOMTMDT    #1TMDT           OD Atch to Ord
     C                     MOVELOMUVST    #1UVST           EDI Status 1
     C                     MOVELOMUWST    #1UWST           EDI Status 2
     C                     MOVELOMUXST    #1UXST           EDI Status 3
     C                     Z-ADDOMAATM    #1AATM           Job Time
     C                     MOVELOMAYNA    #1AYNA           User Id
     C                     MOVELOMA0NA    #1A0NA           Job Name
     C                     Z-ADDOMAXDT    #1AXDT           Job Date
     C                     Z-ADDOMHGCD    #1HGCD           Item Code
      * Clear external version also
     C                     MOVEL*BLANK    V1HGCD
     C                     MOVELOMG7NA    #1G7NA           Order Desc_Line
     C                     MOVELOMQ7CD    #1Q7CD           Price Method Co
     C                     Z-ADDOMAKPR    #1AKPR           Unit Price
     C                     MOVELOMCRCD    #1CRCD           U_M_Base Price
     C                     Z-ADDOMAYVA    #1AYVA           Extended Amount
     C                     MOVELOMRFCD    #1RFCD           Price Audit Rea
     C                     MOVEL*BLANK    #RA8ST           USR Financials
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     Z-ADD*ZERO     #RF4QT           USR Quantity Sh
     C                     MOVEL*BLANK    #RPRST           Substitution Fl
     C                     MOVEL*BLANK    #RGLST           Deduct/Add Sts
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     MOVEL*BLANK    #CADTX           Name
     C                     MOVEL*BLANK    #2XIST           Credit Hold
     C                     MOVEL*BLANK    #2XJST           Production Hold
     C                     MOVEL*BLANK    #2GWST           Header Status
     C                     MOVEL*BLANK    #2JNCD           Order Type_Sale
     C                     Z-ADD*ZERO     #2RMNB           Load ID
     C                     MOVEL*BLANK    #2U2ST           Export Status
     C                     MOVELP1HNNA    #2HNNA           Ship To City
     C                     MOVELP1DBCD    #2DBCD           Ship To State C
     C                     Z-ADD*ZERO     #2AFTM           Requested Deliv
     C                     MOVEL*BLANK    #2GJST           Order in Use
     C                     Z-ADD*ZERO     #CF9DT           Actual Ship Dat
     C                     MOVEL*BLANK    #2AJCD           Warehouse Code
     C                     Z-ADD*ZERO     #2DPNB           Order Sequence
     C                     Z-ADD*ZERO     #2UENB           Order Secondary
     C                     Z-ADDP1AIC3    #2AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V2AIC3
     C                     MOVEL*BLANK    #CBCNA           Customer Purcha
     C                     Z-ADDP1A5DT    #2A5DT           Requested Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V2A5DT
     C                     MOVELP2BCCD    #PBCCD           Salesperson Cod
     C                     MOVEL*BLANK    #CALTX           Salesperson Nam
     C                     Z-ADDP1AODT    #2AODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V2AODT
     C                     Z-ADDP1BKC7    #2BKC7           Ship To Custome
      * Clear external version also
     C                     MOVEL*BLANK    V2BKC7
     C                     MOVEL*BLANK    #CAYTX           Customer Name
     C                     Z-ADDP1GNDT    #2GNDT           Actual Shipped
      * Clear external version also
     C                     Z-ADD*ZERO     V2GNDT
     C                     Z-ADDP1C4NB    #2C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V2C4NB
     C                     Z-ADDP1EIDT    #2EIDT           Requested Deliv
      * Clear external version also
     C                     Z-ADD*ZERO     V2EIDT
     C                     MOVELP1U0ST    #2U0ST           Price Audit
     C                     MOVEL*BLANK    #CNCNA           USR Desc. 10
     C                     MOVEL*BLANK    #CQ2CD           Shipping Method
     C                     MOVEL*BLANK    #CJZNA           USR Shortened N
     C                     Z-ADD*ZERO     #CTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     #CJZVA           Order Value Tot
     C                     Z-ADD*ZERO     #CYJVA           Extended Amount
     C                     MOVEL*BLANK    #CT3CD           Warehouse Code
     C                     Z-ADD*ZERO     #CP4NY           HPB Equivalence
     C                     MOVEL*BLANK    #CCHTX           OHE Override Ty
      * Check restriction within
     C                     EXSR VACKRL
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert subfile fields into external form
      *================================================================
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1HGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1HGCD           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#2    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #2AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V2AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Requested Ship Date to display format
      * Convert date
     C           1000000   ADD  #2A5DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2A5DT
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #2AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2AODT
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2BKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2BKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Actual Shipped Date to display format
      * Convert date
     C           1000000   ADD  #2GNDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2GNDT
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  #2EIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2EIDT
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Abs Frt,PO,Total  RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADD#2AIC3    BEAIC3           Company Number
     C                     Z-ADD#2C4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSSA     CHAIN@BFCPZ9              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBEBCNA    #CBCNA           Customer Purcha
     C                     Z-ADDBEJZVA    #CJZVA           Order Value Tot
     C                     Z-ADDBETBNB    #CTBNB           Absorbed Freigh
     C                     MOVELBEQ2CD    #CQ2CD           Shipping Method
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Event Date         RT - Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN EYAIC3    WQSB01           Company Number
     C           *LIKE     DEFN EYC4NB    WQSB02           Order Number
     C           *LIKE     DEFN EYJPCD    WQSB03           Event Code
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Order Number
     C                     KFLD           WQSB03           Event Code
      * Setup key
     C                     Z-ADD#2AIC3    WQSB01           Company Number
     C                     Z-ADD#2C4NB    WQSB02           Order Number
     C                     MOVEL'04'      WQSB03           Event Code
      * Establish starting position
     C           KRSSB     SETLL@EYCPZE                    *
     C           KRSSB     READE@EYCPZE                  90*
      * Data record not found
     C   90                MOVEL'USR1074' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDEYD2DT    #CF9DT           Event Date
     C           KRSSB     READE@EYCPZE                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Customer Name      RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#2BKC7    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSC     CHAIN@BBREE9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #CAYTX           Customer Name
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBBAYTX    #CAYTX           Customer Name
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADD#2AIC3    ABAIC3           Company Number
      * Establish starting position
     C           KRSSD     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #CADTX           Name
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    #CADTX           Name
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Salesperson Name   RT - Salesperson  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           APBCCD           Salesperson Cod
      * Setup key
     C                     MOVEL#PBCCD    APBCCD           Salesperson Cod
      * Establish starting position
     C           KRSSE     CHAIN@APREBU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0039' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #PBCCD           Salesperson Cod
     C                     MOVEL*BLANK    #CALTX           Salesperson Nam
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAPBCCD    #PBCCD           Salesperson Cod
     C                     MOVELAPALTX    #CALTX           Salesperson Nam
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCRRC    BEGSR
      *================================================================
      * CRT Price Audit Log    CR - PD Price Audit Log Work  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  1        EDI Status 1
     C                     MOVEL*BLANK    WN0002  1        EDI Status 2
     C                     MOVEL*BLANK    WN0003  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0004  60       Job Time
     C                     MOVEL*BLANK    WN0005 10        User Id
     C                     MOVEL*BLANK    WN0006 10        Job Name
     C                     Z-ADD*ZERO     WN0007  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @KXCPI4
     C                     Z-ADDWL0001    KXAIC3           Company Number
     C                     Z-ADDWL0002    KXC4NB           Order Number
     C                     MOVELWL0003    KXBCCD           Salesperson Cod
     C                     Z-ADDWL0004    KXB4DT           Transaction Dat
     C                     Z-ADDWL0005    KXAPTM           Time
     C                     MOVELWL0006    KXUPDP           Update Point
     C                     MOVELWL0007    KXU0ST           Price Audit
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     KXAATM           Job Time
     C                     MOVEL##USR     KXAYNA           User Id
     C                     MOVEL##JOB     KXA0NA           Job Name
     C                     Z-ADD##JDT     KXAXDT           Job Date
     C                     MOVEL##PGM     KXA0NA           Job Name
     C           KLCRSF    KLIST
     C                     KFLD           KXAIC3           Company Number
     C                     KFLD           KXC4NB           Order Number
     C                     KFLD           KXBCCD           Salesperson Cod
     C                     KFLD           KXB4DT           Transaction Dat
     C                     KFLD           KXAPTM           Time
     C                     KFLD           KXUPDP           Update Point
      * Check for duplicate primary key
     C           KLCRSF    SETLL@KXCPI4                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2323' W0RTN   7
      * Send message 'WF Price Audit Log Wor EX'
     C                     MOVEL'USR2323' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C                     WRITE@KXCPI4                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           JYAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0008    JYAIC3           Company Number
      * Establish starting position
     C           KRSSG     CHAIN@JYRECE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2025' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0009           Plant Company S
     C                     MOVEL*BLANK    WL0010           Company Organiz
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELJYYISX    WL0009           Plant Company S
     C                     MOVELJYYJSX    WL0010           Company Organiz
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV HPB Equiv only   RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           AMAIC3           Company Number
     C                     KFLD           AMC4NB           Order Number
      * Setup key
     C                     Z-ADD#2AIC3    AMAIC3           Company Number
     C                     Z-ADD#2C4NB    AMC4NB           Order Number
      * Establish starting position
     C           KRSSH     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     #CP4NY           OHE HPB RIN Equ
     C                     Z-ADD*ZERO     YL0002           OHE HPB RIN Pri
     C                     MOVEL*BLANK    #CCHTX           OHE Override Ty
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAMHEVL    #CP4NY           OHE HPB RIN Equ
     C                     Z-ADDAMHFVL    YL0002           OHE HPB RIN Pri
     C                     MOVELAMCHTX    #CCHTX           OHE Override Ty
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Gate Price        RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSI01           Company Number
     C           *LIKE     DEFN WAC4NB    WQSI02           Order Number
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Company Number
     C                     KFLD           WQSI02           Order Number
      * Setup key
     C                     Z-ADD#2AIC3    WQSI01           Company Number
     C                     Z-ADD#2C4NB    WQSI02           Order Number
      * Establish starting position
     C           KRSSI     SETLL@BGWKFW                    *
     C           KRSSI     READE@BGWKFW                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0003           Order Gate_Fina
     C                     Z-ADD*ZERO     YL0004           OD Gate_Final P
     C                     Z-ADD*ZERO     YL0005           OD Weighted Avg
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Order Gate Price is Not Zeros
     C           WADVPR    IFNE 0                          *IF
      * PAR = DB1 By name
     C                     Z-ADDWADVPR    YL0003           Order Gate_Fina
     C                     Z-ADDWADXPR    YL0004           OD Gate_Final P
     C                     Z-ADDWADYPR    YL0005           OD Weighted Avg
     C                     GOTO SIEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSI     READE@BGWKFW                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * CLC Extend Prc f/ovrge RT - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0008 112       Extended Amount
     C                     Z-ADD*ZERO     WN0009 114       Unit Price
     C                     Z-ADD*ZERO     WN0010 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0011 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0012 112       USR Quantity
     C                     Z-ADD*ZERO     WN0013 112       USR Weight
     C                     Z-ADD*ZERO     WN0014 114       Price per Pound
     C                     MOVEL*BLANK    WN0015  1        Company Organiz
     C                     MOVEL*BLANK    WN0016  6        Primal Group Co
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WN0008           Extended Amount
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0008           Company Number
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0009    YN0002    P      Plant Company S
     C                     MOVELWL0010    WN0015    P      Company Organiz
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSJ01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSJ02           Order Number
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           Order Number
      * Setup key
     C                     Z-ADD#2AIC3    WQSJ01           Company Number
     C                     Z-ADD#2C4NB    WQSJ02           Order Number
      * Establish starting position
     C           KRSSJ     SETLL@BGWKL1                    *
     C           KRSSJ     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Load Quantity Shipped Total field.
      * CASE: DB1.Quantity Shipped Total is Equal to zero
     C           OMCBQT    IFEQ 0                          *IF
     C                     Z-ADD1         WUCBQT           Quantity Shippe
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDOMCBQT    WUCBQT           Quantity Shippe
     C                     END                             *FI
      * Set quantity and weight according to order status
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Detail Line Status is Avail/Alloc/Enter/Hold
      *   |- c2    : DB1.Event Code is Entered Thru 03 Picked
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           OMGMST    IFEQ 'L'                        *IF
     C           OMGMST    OREQ 'A'
     C           OMGMST    OREQ 'E'
     C           OMGMST    OREQ 'H'
     C           OMJPCD    IFGE '01'                       *IF
     C           OMJPCD    ANDLE'03'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RMC 6/17/09 FP1054 use qty/wgt ordered instead of sched
     C                     Z-ADDOMAVQT    WN0012           USR Quantity
     C                     Z-ADDOMD0WG    WN0013           USR Weight
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWUCBQT    WN0012           USR Quantity
     C                     Z-ADDOMATWG    WN0013           USR Weight
     C                     END                             *FI
      * RTV For Price Extent   XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDXRXFR'              90  RTV For Price E
     C                     PARM *BLANK    W0RTN   7
     C                     PARM OMAIC3    WQ0001  30       Company Number
     C                     PARM OMHGCD    WQ0002  70       Item Code
     C                     PARM *BLANK    WQ0003  2        UOM Pricing
     C                     PARM *ZERO     WQ0004 112       Unit Weight
     C                     PARM *BLANK    WQ0005  1        Catch Weight St
     C           WN0016    PARM *BLANK    WQ0006  6        Primal Group Co
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * RTV PrcMthTyp/PrcTyp  XF - Price Method Header  * 
     C                     CALL 'PNS7XFR'              90  RTV PrcMthTyp/P
     C                     PARM *BLANK    W0RTN   7
     C                     PARM OMAIC3    WQ0007  30       Company Number
     C                     PARM OMQ7CD    WQ0008  3        Price Method Co
     C           YL0006    PARM *BLANK    WQ0009  1        Price Method Ty
     C           YL0007    PARM *BLANK    WQ0010  1        PMH Price Type
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNS7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Extend using price before gate price which is the Price overage o
      * CASE: LCL.Price Method Type is Gate Pricing
     C           YL0006    IFEQ 'G'                        *IF
      * Use Price Overage Override
      * CASE: DB1.U/M - Base Price is Pounds
     C           OMCRCD    IFEQ 'LB'                       *IF
     C           OMBZPR    MULT WN0013    WN0008    H      Extended Amount
     C                     ELSE
      * CASE: *OTHERWISE
     C           OMBZPR    MULT WN0012    WN0008    H      Extended Amount
     C                     END                             *FI
     C                     ADD  WN0008    #CYJVA           Extended Amount
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
     C           KRSSJ     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Val Check Exist        RT - PD Order Detail Fin  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN N1AIC3    WQSK01           Company Number
     C           *LIKE     DEFN N1C4NB    WQSK02           Order Number
     C           *LIKE     DEFN N1DPNB    WQSK03           Order Sequence
     C           *LIKE     DEFN N1UENB    WQSK04           Order Secondary
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           Company Number
     C                     KFLD           WQSK02           Order Number
     C                     KFLD           WQSK03           Order Sequence
     C                     KFLD           WQSK04           Order Secondary
      * Setup key
     C                     Z-ADD#1AIC3    WQSK01           Company Number
     C                     Z-ADD#1C4NB    WQSK02           Order Number
     C                     Z-ADD#1DPNB    WQSK03           Order Sequence
     C                     Z-ADD#1UENB    WQSK04           Order Secondary
      * Establish starting position
     C           KRSSK     SETLL@CRWKL1                    *
     C           KRSSK     READE@CRWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1317' W0RTN   7
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Deduct/Add Exist  RT - Order Detail Accrual  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    #RGLST           Deduct/Add Sts
      * Declare restrictor key work fields
     C           *LIKE     DEFN HQAIC3    WQSL01           Company Number
     C           *LIKE     DEFN HQC4NB    WQSL02           Order Number
     C           *LIKE     DEFN HQDPNB    WQSL03           Order Sequence
     C           *LIKE     DEFN HQUENB    WQSL04           Order Secondary
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Company Number
     C                     KFLD           WQSL02           Order Number
     C                     KFLD           WQSL03           Order Sequence
     C                     KFLD           WQSL04           Order Secondary
      * Setup key
     C                     Z-ADD#1AIC3    WQSL01           Company Number
     C                     Z-ADD#1C4NB    WQSL02           Order Number
     C                     Z-ADD#1DPNB    WQSL03           Order Sequence
     C                     Z-ADD#1UENB    WQSL04           Order Secondary
      * Establish starting position
     C           KRSSL     SETLL@HQCPLJ                    *
     C           KRSSL     READE@HQCPLJ                  90*
      * Data record not found
     C   90                MOVEL'USR1524' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       #RGLST           Deduct/Add Sts
     C                     GOTO SLEXIT                     *QUIT
     C           KRSSL     READE@HQCPLJ                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * UPD Accept Price Audit RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSM01           Company Number
     C           *LIKE     DEFN WBC4NB    WQSM02           Order Number
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           Order Number
      * Setup key
     C                     Z-ADD#2AIC3    WQSM01           Company Number
     C                     Z-ADD#2C4NB    WQSM02           Order Number
      * Establish starting position
     C           KRSSM     SETLL@BGWKF9                    *
     C           KRSSM     READE@BGWKF9                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           WBGMST    IFEQ 'L'                        *IF
     C           WBGMST    OREQ 'A'
     C           WBGMST    OREQ 'C'
     C           WBGMST    OREQ 'R'
     C           WBGMST    OREQ 'E'
     C           WBGMST    OREQ 'H'
     C           WBGMST    OREQ 'I'
      * RTV Next Audit Seq #   RT - PD Price Change Audit Log  * 
     C                     EXSR SNRVGN
      * CRT Price Change Audit CR - PD Price Change Audit Log  * 
     C                     EXSR SOCRRC
      * CHG Price Audit        CH - PD Order Detail  * 
     C                     EXSR SPCHRC
     C                     END                             *FI
     C           KRSSM     READE@BGWKF9                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Next Audit Seq #   RT - PD Price Change Audit Log  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN K3AIC3    WQSN01           Company Number
     C           *LIKE     DEFN K3C4NB    WQSN02           Order Number
     C           *LIKE     DEFN K3DPNB    WQSN03           Order Sequence
     C           *LIKE     DEFN K3UENB    WQSN04           Order Secondary
      * Define keylist
     C           KPSSN     KLIST
     C                     KFLD           WQSN01           Company Number
     C                     KFLD           WQSN02           Order Number
     C                     KFLD           WQSN03           Order Sequence
     C                     KFLD           WQSN04           Order Secondary
     C                     KFLD           K3ASNO           Audit Sequence
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Company Number
     C                     KFLD           WQSN02           Order Number
     C                     KFLD           WQSN03           Order Sequence
     C                     KFLD           WQSN04           Order Secondary
      * Setup key
     C                     Z-ADDWBAIC3    WQSN01           Company Number
     C                     Z-ADDWBC4NB    WQSN02           Order Number
     C                     Z-ADDWBDPNB    WQSN03           Order Sequence
     C                     Z-ADDWBUENB    WQSN04           Order Secondary
     C                     Z-ADD999       K3ASNO           Audit Sequence
      * Establish starting position
     C           KPSSN     SETLL@K3CPKR                    *
     C           KRSSN     READE@K3CPKR                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2378' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WUQQNB           USR Sequence Nu
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           K3ASNO    ADD  1         WUQQNB           USR Sequence Nu
     C                     GOTO SNEXIT                     *QUIT
     C           KRSSN     READE@K3CPKR                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCRRC    BEGSR
      *================================================================
      * CRT Price Change Audit CR - PD Price Change Audit Log  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0017  1        EDI Status 1
     C                     MOVEL*BLANK    WN0018  1        EDI Status 2
     C                     MOVEL*BLANK    WN0019  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0020  60       Job Time
     C                     MOVEL*BLANK    WN0021 10        User Id
     C                     MOVEL*BLANK    WN0022 10        Job Name
     C                     Z-ADD*ZERO     WN0023  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @K3CPKP
     C                     Z-ADDWBAIC3    WCAIC3           Company Number
     C                     Z-ADDWBC4NB    WCC4NB           Order Number
     C                     Z-ADDWBDPNB    WCDPNB           Order Sequence
     C                     Z-ADDWBUENB    WCUENB           Order Secondary
     C                     Z-ADDWUQQNB    WCASNO           Audit Sequence
     C                     Z-ADDWBHGCD    WCHGCD           Item Code
     C                     MOVELWBGMST    WCGMST           Detail Line Sta
     C                     MOVELWBGNST    WCGNST           Detail Line Sta
     C                     Z-ADDWBAYVA    WCAYVA           Extended Amount
     C                     Z-ADDWBAYVA    WCYJVA           Extended Amount
     C                     MOVELWBU1ST    WCU1ST           Price Status
     C                     MOVELWBU1ST    WCPSTL           Price Status La
     C                     MOVEL'M'       WCU0ST           Price Audit
     C                     MOVEL*BLANK    WCRFCD           Price Audit Rea
     C                     MOVELWBU0ST    WCPALS           Price Audit Las
     C                     MOVELWBRFCD    WCWWCD           Price Audit Rea
     C                     Z-ADDWBAKPR    WCAKPR           Unit Price
     C                     Z-ADDWBAKPR    WCDBPR           Unit Price Last
     C                     Z-ADDWBALPR    WCALPR           Unit Price_Cred
     C                     Z-ADDWBALPR    WCDCPR           Unit Price - Cr
     C                     MOVELWBJPCD    WCJPCD           Event Code
     C                     MOVELWBJPCD    WCWXCD           Event Code Last
     C                     MOVE *BLANK    WCPREC           Price Event Cal
     C                     MOVEL'PA'      WCPREC           Price Event Cal
     C                     MOVEL##PGM     WCPIDX           Program ID . .
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WCAATM           Job Time
     C                     MOVEL##USR     WCAYNA           User Id
     C                     MOVEL##JOB     WCA0NA           Job Name
     C                     Z-ADD##JDT     WCAXDT           Job Date
     C           KLCRSO    KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
     C                     KFLD           WCDPNB           Order Sequence
     C                     KFLD           WCUENB           Order Secondary
     C                     KFLD           WCASNO           Audit Sequence
      * Check for duplicate primary key
     C           KLCRSO    SETLL@K3CPKP                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2379' W0RTN   7
      * Send message 'Price Change Audit Log EX'
     C                     MOVEL'USR2379' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C                     WRITE@K3CPKP                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPCHRC    BEGSR
      *================================================================
      * CHG Price Audit        CH - PD Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0024  70       Item Code
     C                     MOVEL*BLANK    WN0025  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0026  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0027  70       Order Group Cod
     C                     MOVEL*BLANK    WN0028  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0029  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0030 112       Billing Detail
     C                     Z-ADD*ZERO     WN0031 112       Billing Detail
     C                     Z-ADD*ZERO     WN0032 112       Billing Detail
     C                     Z-ADD*ZERO     WN0033 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0034  1        Comment Print A
     C                     MOVEL*BLANK    WN0035  1        Comment Print I
     C                     MOVEL*BLANK    WN0036  1        Comment Print P
     C                     MOVEL*BLANK    WN0037  1        Comment Print S
     C                     Z-ADD*ZERO     WN0038 112       Extended Amount
     C                     Z-ADD*ZERO     WN0039  70       Market Pricing
     C                     MOVEL*BLANK    WN0040  3        Commodity Marke
     C                     MOVEL*BLANK    WN0041  3        Date Method Cod
     C                     MOVEL*BLANK    WN0042  3        Price Method Co
     C                     Z-ADD*ZERO     WN0043 114       Price Overage O
     C                     Z-ADD*ZERO     WN0044  70       Contract Number
     C                     MOVEL*BLANK    WN0045  1        Price Status
     C                     Z-ADD*ZERO     WN0046  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0047  2        U_M_Base Price
     C                     MOVEL*BLANK    WN0048  2        U_M_Ordered
     C                     MOVEL*BLANK    WN0049  1        Work Confirm St
     C                     MOVEL*BLANK    WN0050  1        Work Over_Short
     C                     MOVEL*BLANK    WN0051  1        OD Production P
     C                     MOVEL*BLANK    WN0052 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0053 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0054  1        Age Code
     C                     MOVEL*BLANK    WN0055  1        Palletize
     C                     MOVEL*BLANK    WN0056  1        Slip Sheet
     C                     MOVEL*BLANK    WN0057  1        Catch Weight St
     C                     MOVEL*BLANK    WN0058  1        Production Date
     C                     Z-ADD*ZERO     WN0059 112       Rated Freight
     C                     Z-ADD*ZERO     WN0060 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0061 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0062 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0063 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0064 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0065 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0066 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0067 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0068 114       Unit Price
     C                     Z-ADD*ZERO     WN0069 114       Unit Price_Cred
     C                     Z-ADD*ZERO     WN0070 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0071 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0072 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0073  70       Requested Ship
     C                     Z-ADD*ZERO     WN0074  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0075  70       Actual Shipped
     C                     MOVEL*BLANK    WN0076  1        Affect Inventor
     C                     MOVEL*BLANK    WN0077  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0078  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0079  30       Item Structure
     C                     Z-ADD*ZERO     WN0080  30       Item Structure
     C                     Z-ADD*ZERO     WN0081  30       Item Structure
     C                     MOVEL*BLANK    WN0082  2        Item Level
     C                     MOVEL*BLANK    WN0083  2        Quality Level
     C                     MOVEL*BLANK    WN0084  2        Pricing Product
     C                     MOVEL*BLANK    WN0085  2        Season Product
     C                     Z-ADD*ZERO     WN0086  70       Date of Origina
     C                     MOVEL*BLANK    WN0087 10        User Profile Na
     C                     MOVEL*BLANK    WN0088  6        Country Code
     C                     MOVEL*BLANK    WN0089  2        Event Code
     C                     MOVEL*BLANK    WN0090  3        Reason Code
     C                     MOVEL*BLANK    WN0091  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0092  1        Modified Flag
     C                     MOVEL*BLANK    WN0093  1        Substituted Fla
     C                     MOVEL*BLANK    WN0094  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0095 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0096 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0097  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0098  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0099  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0100  1        Affect Commissi
     C                     MOVEL*BLANK    WN0101  1        Affect Pricing
     C                     MOVEL*BLANK    WN0102  1        Released by Use
     C                     MOVEL*BLANK    WN0103  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0104  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0105  3        Production Ware
     C                     MOVEL*BLANK    WN0106  3        OD Price Type
     C                     Z-ADD*ZERO     WN0107  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0108  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0109  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0110  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0111  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0112  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0113  60       Price Code
     C                     Z-ADD*ZERO     WN0114  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0115  60       Substitution Li
     C                     Z-ADD*ZERO     WN0116  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0117 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0118 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0119 112       OD Item Target
     C                     Z-ADD*ZERO     WN0120 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0121 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0122 114       Order Gate_Fina
     C                     Z-ADD*ZERO     WN0123 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0124 114       OD Gate_Final P
     C                     Z-ADD*ZERO     WN0125 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0126 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0127 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0128 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0129 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0130  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0131  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0132  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0133 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0134  40       Item Age Days
     C                     Z-ADD*ZERO     WN0135  70       Production Ovr
     C                     Z-ADD*ZERO     WN0136  70       Production Ovr
     C                     MOVEL*BLANK    WN0137  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0138  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0139  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0140  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0141  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0142  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0143  1        EDI Status 1
     C                     MOVEL*BLANK    WN0144  1        EDI Status 2
     C                     MOVEL*BLANK    WN0145  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0146  60       Job Time
     C                     MOVEL*BLANK    WN0147 10        User Id
     C                     MOVEL*BLANK    WN0148 10        Job Name
     C                     Z-ADD*ZERO     WN0149  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWBAIC3    WDAIC3           Company Number
     C                     Z-ADDWBC4NB    WDC4NB           Order Number
     C                     Z-ADDWBDPNB    WDDPNB           Order Sequence
     C                     Z-ADDWBUENB    WDUENB           Order Secondary
      *
     C           KLCHSP    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
     C                     KFLD           WDDPNB           Order Sequence
     C                     KFLD           WDUENB           Order Secondary
     C           KLCHSP    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YARDCS
      * Move non-key fields to @BGWKL0
     C                     MOVEL'M'       WDU0ST    P      Price Audit
     C                     MOVEL*BLANK    WDRFCD    P      Price Audit Rea
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##JOB     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQCHRC    BEGSR
      *================================================================
      * CHG Price Audit        CH - OP Order Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0150  2        Order Type_Sale
     C                     Z-ADD*ZERO     WN0151  70       AR Customer Num
     C                     Z-ADD*ZERO     WN0152  70       Ship To Custome
     C                     MOVEL*BLANK    WN0153 30        Ship To Name
     C                     MOVEL*BLANK    WN0154 30        Ship To Address
     C                     MOVEL*BLANK    WN0155 30        Ship To Address
     C                     MOVEL*BLANK    WN0156 30        Ship To Address
     C                     MOVEL*BLANK    WN0157 20        Ship To City
     C                     MOVEL*BLANK    WN0158  2        Ship To State C
     C                     MOVEL*BLANK    WN0159 11        Ship To Zip_Pos
     C                     Z-ADD*ZERO     WN0160  70       Bill to Custome
     C                     MOVEL*BLANK    WN0161 30        Bill to Name
     C                     MOVEL*BLANK    WN0162 30        Bill to Address
     C                     MOVEL*BLANK    WN0163 30        Bill to Address
     C                     MOVEL*BLANK    WN0164 30        Bill to Address
     C                     MOVEL*BLANK    WN0165 20        Bill to City
     C                     MOVEL*BLANK    WN0166  2        Bill to State C
     C                     MOVEL*BLANK    WN0167 11        Bill to Zip_Pos
     C                     MOVEL*BLANK    WN0168 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0169  70       Order Date
     C                     Z-ADD*ZERO     WN0170  70       Requested Ship
     C                     Z-ADD*ZERO     WN0171  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0172  70       Cancel Date
     C                     MOVEL*BLANK    WN0173  2        Terms Code
     C                     MOVEL*BLANK    WN0174 40        Special Instruc
     C                     MOVEL*BLANK    WN0175 40        Special Instruc
     C                     MOVEL*BLANK    WN0176  3        Carrier Code
     C                     MOVEL*BLANK    WN0177  1        Comment Print A
     C                     MOVEL*BLANK    WN0178  1        Comment Print I
     C                     MOVEL*BLANK    WN0179  1        Comment Print P
     C                     MOVEL*BLANK    WN0180  1        Comment Print S
     C                     MOVEL*BLANK    WN0181  3        Reason Code
     C                     MOVEL*BLANK    WN0182  1        Order in Use
     C                     MOVEL*BLANK    WN0183  1        Header Status
     C                     MOVEL*BLANK    WN0184  1        Header Status L
     C                     MOVEL*BLANK    WN0185  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0186  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0187 10        User Original E
     C                     Z-ADD*ZERO     WN0188  70       Date of Origina
     C                     Z-ADD*ZERO     WN0189 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0190 112       Order Weight To
     C                     MOVEL*BLANK    WN0191  1        Credit Hold
     C                     MOVEL*BLANK    WN0192  1        Production Hold
     C                     MOVEL*BLANK    WN0193  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0194  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0195  40       Requested Deliv
     C                     MOVEL*BLANK    WN0196  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0197 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0198  70       Load ID
     C                     Z-ADD*ZERO     WN0199  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0200 112       Rated Freight
     C                     MOVEL*BLANK    WN0201  1        LTL Flag
     C                     MOVEL*BLANK    WN0202  1        Price Status
     C                     MOVEL*BLANK    WN0203  2        Shipping Method
     C                     MOVEL*BLANK    WN0204  1        Export Status
     C                     MOVEL*BLANK    WN0205  1        Palletize
     C                     MOVEL*BLANK    WN0206  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0207  1        Slip Sheet
     C                     MOVEL*BLANK    WN0208  1        Age Code
     C                     Z-ADD*ZERO     WN0209  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0210  1        Load Type
     C                     Z-ADD*ZERO     WN0211  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0212  1        Load Plan Order
     C                     MOVEL*BLANK    WN0213  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0214  70       Resell Referenc
     C                     MOVEL*BLANK    WN0215 30        Special Comment
     C                     MOVEL*BLANK    WN0216 30        Special Comment
     C                     MOVEL*BLANK    WN0217  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0218  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0219  2        Manager Level C
     C                     MOVEL*BLANK    WN0220  3        VP Level Code
     C                     Z-ADD*ZERO     WN0221  70       Attach to Order
     C                     MOVEL*BLANK    WN0222  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0223  70       Invoice Number
     C                     MOVEL*BLANK    WN0224  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0225  70       Invoice Date
     C                     MOVEL*BLANK    WN0226  2        Event Code
     C                     MOVEL*BLANK    WN0227  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0228  1        Modified Flag
     C                     Z-ADD*ZERO     WN0229 112       A_R order Value
     C                     MOVEL*BLANK    WN0230  1        Billing Activit
     C                     MOVEL*BLANK    WN0231  1        Block Order Fla
     C                     MOVEL*BLANK    WN0232  1        Order Certifica
     C                     Z-ADD*ZERO     WN0233 112       Invoice Order V
     C                     MOVEL*BLANK    WN0234  1        Process Sts for
     C                     MOVEL*BLANK    WN0235  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0236  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0237  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0238  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0239  1        Email Cust On O
     C                     MOVEL*BLANK    WN0240  1        Order Emailed
     C                     MOVEL*BLANK    WN0241  1        Export Docs Go
     C                     MOVEL*BLANK    WN0242  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0243  1        Broker Order St
     C                     MOVEL*BLANK    WN0244  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0245  2        Order Requires
     C                     MOVEL*BLANK    WN0246  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0247  2        Export USDA App
     C                     MOVEL*BLANK    WN0248  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0249  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0250  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0251  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0252  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0253  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0254  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0255  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0256  60       Time of Origina
     C                     Z-ADD*ZERO     WN0257  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0258  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0259  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0260 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0261 112       Act Non_Ref Frt
     C                     Z-ADD*ZERO     WN0262 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0263 112       OH Total Non_Re
     C                     Z-ADD*ZERO     WN0264 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0265  70       Claim Number
     C                     MOVEL*BLANK    WN0266  1        EDI Status 1
     C                     MOVEL*BLANK    WN0267  1        EDI Status 2
     C                     MOVEL*BLANK    WN0268  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0269  60       Job Time
     C                     MOVEL*BLANK    WN0270 10        User Id
     C                     MOVEL*BLANK    WN0271 10        Job Name
     C                     Z-ADD*ZERO     WN0272  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDP1AIC3    WEAIC3           Company Number
     C                     Z-ADDP1C4NB    WEC4NB           Order Number
      *
     C           KLCHSQ    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C           KLCHSQ    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SQEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YBRDCS
      * Move non-key fields to @BECPFJ
     C                     MOVEL#2U0ST    WEU0ST    P      Price Audit
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##PGM     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPBRC
     C                     Z-ADDWEAIC3    PBAIC3           Company Number
     C                     Z-ADDWEC4NB    PBC4NB           Order Number
     C                     MOVELWEJNCD    PBJNCD    P      Order Type_Sale
     C                     Z-ADDWEANC7    PBANC7           AR Customer Num
     C                     Z-ADDWEBKC7    PBBKC7           Ship To Custome
     C                     MOVELWEBRTX    PBBRTX    P      Ship To Name
     C                     MOVELWEHMNA    PBHMNA    P      Ship To Address
     C                     MOVELWEHONA    PBHONA    P      Ship To Address
     C                     MOVELWEHPNA    PBHPNA    P      Ship To Address
     C                     MOVELWEHNNA    PBHNNA    P      Ship To City
     C                     MOVELWEDBCD    PBDBCD    P      Ship To State C
     C                     MOVELWECKTX    PBCKTX    P      Ship To Zip_Pos
     C                     Z-ADDWEB0C7    PBB0C7           Bill to Custome
     C                     MOVELWEAETX    PBAETX    P      Bill to Name
     C                     MOVELWEB1NA    PBB1NA    P      Bill to Address
     C                     MOVELWEB3NA    PBB3NA    P      Bill to Address
     C                     MOVELWEB4NA    PBB4NA    P      Bill to Address
     C                     MOVELWEB2NA    PBB2NA    P      Bill to City
     C                     MOVELWEBHCD    PBBHCD    P      Bill to State C
     C                     MOVELWEC8TX    PBC8TX    P      Bill to Zip_Pos
     C                     MOVELWEBCNA    PBBCNA    P      Customer Purcha
     C                     Z-ADDWEA0DT    PBA0DT           Order Date
     C                     Z-ADDWEA5DT    PBA5DT           Requested Ship
     C                     Z-ADDWEGNDT    PBGNDT           Actual Shipped
     C                     Z-ADDWEACDT    PBACDT           Cancel Date
     C                     MOVELWEAQCD    PBAQCD    P      Terms Code
     C                     MOVELWEB6NA    PBB6NA    P      Special Instruc
     C                     MOVELWEBYNA    PBBYNA    P      Special Instruc
     C                     MOVELWEBZNA    PBBZNA    P      Carrier Code
     C                     MOVELWEGTST    PBGTST    P      Comment Print A
     C                     MOVELWEGVST    PBGVST    P      Comment Print I
     C                     MOVELWEGUST    PBGUST    P      Comment Print P
     C                     MOVELWEQFST    PBQFST    P      Comment Print S
     C                     MOVELWECQCD    PBCQCD    P      Reason Code
     C                     MOVELWEGJST    PBGJST    P      Order in Use
     C                     MOVELWEGWST    PBGWST    P      Header Status
     C                     MOVELWEGXST    PBGXST    P      Header Status L
     C                     MOVELWEGYST    PBGYST    P      Order Type Prin
     C                     Z-ADDWEAODT    PBAODT           Scheduled Ship
     C                     MOVELWEAIVN    PBAIVN    P      User Original E
     C                     Z-ADDWECXDT    PBCXDT           Date of Origina
     C                     Z-ADDWEJZVA    PBJZVA           Order Value Tot
     C                     Z-ADDWEA1WG    PBA1WG           Order Weight To
     C                     MOVELWEXIST    PBXIST    P      Credit Hold
     C                     MOVELWEXJST    PBXJST    P      Production Hold
     C                     MOVELWEXKST    PBXKST    P      New Customer Ho
     C                     Z-ADDWEEIDT    PBEIDT           Requested Deliv
     C                     Z-ADDWEAFTM    PBAFTM           Requested Deliv
     C                     MOVELWEE8CD    PBE8CD    P      Accounts Receiv
     C                     MOVELWEE9CD    PBE9CD    P      Accounts Receiv
     C                     Z-ADDWERMNB    PBRMNB           Load ID
     C                     Z-ADDWETBNB    PBTBNB           Absorbed Freigh
     C                     Z-ADDWER1NB    PBR1NB           Rated Freight
     C                     MOVELWEPJST    PBPJST    P      LTL Flag
     C                     MOVELWEU0ST    PBU0ST    P      Price Audit
     C                     MOVELWEU1ST    PBU1ST    P      Price Status
     C                     MOVELWEQ2CD    PBQ2CD    P      Shipping Method
     C                     MOVELWEU2ST    PBU2ST    P      Export Status
     C                     MOVELWEVEST    PBVEST    P      Palletize
     C                     MOVELWEVFST    PBVFST    P      Shrink Wrap
     C                     MOVELWEVGST    PBVGST    P      Slip Sheet
     C                     MOVELWERPCD    PBRPCD    P      Age Code
     C                     Z-ADDWERNNB    PBRNNB           Reefer Temperat
     C                     MOVELWEVDST    PBVDST    P      Load Type
     C                     Z-ADDWEATIN    PBATIN           Attach to Invoi
     C                     MOVELWEU4ST    PBU4ST    P      Load Plan Order
     C                     MOVELWEU5ST    PBU5ST    P      Print Pick Slip
     C                     Z-ADDWERSRN    PBRSRN           Resell Referenc
     C                     MOVELWEMHNA    PBMHNA    P      Special Comment
     C                     MOVELWEMINA    PBMINA    P      Special Comment
     C                     MOVELWEWBST    PBWBST    P      Affect Auto Acc
     C                     MOVELWER4CD    PBR4CD    P      Sales Route Cod
     C                     MOVELWEBFCD    PBBFCD    P      Manager Level C
     C                     MOVELWEQ4CD    PBQ4CD    P      VP Level Code
     C                     Z-ADDWET3NB    PBT3NB           Attach to Order
     C                     MOVELWESICD    PBSICD    P      Reason for Pric
     C                     Z-ADDWECONB    PBCONB           Invoice Number
     C                     MOVELWECEST    PBCEST    P      Invoice Suffix
     C                     Z-ADDWEAWDT    PBAWDT           Invoice Date
     C                     MOVELWEJPCD    PBJPCD    P      Event Code
     C                     MOVELWEXUST    PBXUST    P      Trans Contol AS
     C                     MOVELWEZ1ST    PBZ1ST    P      Modified Flag
     C                     Z-ADDWEVRVA    PBVRVA           A_R order Value
     C                     MOVELWEOBST    PBOBST    P      Billing Activit
     C                     MOVELWEBCST    PBBCST    P      Block Order Fla
     C                     MOVELWEBDST    PBBDST    P      Order Certifica
     C                     Z-ADDWEB7VL    PBB7VL           Invoice Order V
     C                     MOVELWEGASX    PBGASX    P      Process Sts for
     C                     MOVELWEGBSX    PBGBSX    P      Order Conf Fax
     C                     MOVELWEGCSX    PBGCSX    P      Manifest Fax St
     C                     MOVELWEGDSX    PBGDSX    P      Invoice Fax Sts
     C                     MOVELWEFNSX    PBFNSX    P      Transfer in Sto
     C                     MOVELWEFOSX    PBFOSX    P      Email Cust On O
     C                     MOVELWEFPSX    PBFPSX    P      Order Emailed
     C                     MOVELWEFQSX    PBFQSX    P      Export Docs Go
     C                     MOVELWEFRSX    PBFRSX    P      Shipping Temp C
     C                     MOVELWEFSSX    PBFSSX    P      Broker Order St
     C                     MOVELWEFTSX    PBFTSX    P      Air Freight Ord
     C                     MOVELWEFUSX    PBFUSX    P      Order Requires
     C                     MOVELWEFVSX    PBFVSX    P      OH Load Plan Re
     C                     MOVELWEFWSX    PBFWSX    P      Export USDA App
     C                     MOVELWEFXSX    PBFXSX    P      HPB Ship to War
     C                     MOVELWEFYSX    PBFYSX    P      OH TF Exempt Co
     C                     Z-ADDWENODT    PBNODT           OH Appt Confirm
     C                     Z-ADDWENPDT    PBNPDT           JPN Invoice Iss
     C                     Z-ADDWENQDT    PBNQDT           Load Actual Shi
     C                     Z-ADDWENRDT    PBNRDT           Load BOL Comple
     C                     Z-ADDWENSDT    PBNSDT           Load Truck Depa
     C                     Z-ADDWEBPTM    PBBPTM           Maximum Gross W
     C                     Z-ADDWEBQTM    PBBQTM           Time of Origina
     C                     Z-ADDWEBRTM    PBBRTM           OH Appt Confirm
     C                     Z-ADDWEBSTM    PBBSTM           Load BOL Comple
     C                     Z-ADDWEBTTM    PBBTTM           Load Truck Depa
     C                     Z-ADDWEH0NX    PBH0NX           Act Frt Referen
     C                     Z-ADDWEH1NX    PBH1NX           Act Non_Ref Frt
     C                     Z-ADDWEH2NX    PBH2NX           OH Fuel Surchar
     C                     Z-ADDWEH3NX    PBH3NX           OH Total Non_Re
     C                     Z-ADDWEH4NX    PBH4NX           OH Total Ref Fr
     C                     Z-ADDWEC0C7    PBC0C7           Claim Number
     C                     MOVELWEUVST    PBUVST    P      EDI Status 1
     C                     MOVELWEUWST    PBUWST    P      EDI Status 2
     C                     MOVELWEUXST    PBUXST    P      EDI Status 3
     C                     Z-ADDWEAATM    PBAATM           Job Time
     C                     MOVELWEAYNA    PBAYNA    P      User Id
     C                     MOVELWEA0NA    PBA0NA    P      Job Name
     C                     Z-ADDWEAXDT    PBAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv Order Info ALL    RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFC4NB           Order Number
      * Setup key
     C                     Z-ADD#2AIC3    WFAIC3           Company Number
     C                     Z-ADD#2C4NB    WFC4NB           Order Number
      * Establish starting position
     C           KRSSR     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0010           AR Customer Num
     C                     MOVEL*BLANK    YL0011           Customer Purcha
     C                     MOVEL*BLANK    YL0012           Price Status
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWFANC7    YL0010           AR Customer Num
     C                     MOVELWFBCNA    YL0011           Customer Purcha
     C                     MOVELWFU1ST    YL0012           Price Status
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * RTV BT Intrchg BT custRT - EDI Bill To Interchange  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0013           POC/POCA ??
     C                     MOVEL*BLANK    WL0014           EDI Trading Par
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           GQB0C7           Bill to Custome
     C                     KFLD           GQM4AA           Interchange Cod
      * Setup key
     C                     Z-ADDWL0011    GQB0C7           Bill to Custome
     C                     MOVELWL0012    GQM4AA           Interchange Cod
      * Establish starting position
     C           KRSSS     CHAIN@GQREH2              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4373' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0013           POC/POCA ??
     C                     MOVEL*BLANK    WL0014           EDI Trading Par
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELGQJ5NX    WL0014           EDI Trading Par
      * 01/24/23 DN W95589-Check Record Status is Active for both 855 & 8
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Interchange Code is PO Acknowledgement  855
      *   |- c2    : DB1.Record Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           GQM4AA    IFEQ 'POACK'                    *IF
     C           GQVSST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL*BLANK    WL0013           POC/POCA ??
     C                     MOVEL'POACK'   WL0013           POC/POCA ??
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Interchange Code is PO Change Ack       865
      *   |- c2    : DB1.Record Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           GQM4AA    IFEQ @CN,001                    *IF
     C           GQVSST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'POCACK'  WL0013           POC/POCA ??
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * RTV EDI PO Flag       RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 3/11/14 SAZ If OHE PO ack flag = Blank, initialize to *NO
      * 3/11/14 SAZ If Record not found, initialize  OHE PO Ack Flag to *
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           AMAIC3           Company Number
     C                     KFLD           AMC4NB           Order Number
      * Setup key
     C                     Z-ADD#2AIC3    AMAIC3           Company Number
     C                     Z-ADD#2C4NB    AMC4NB           Order Number
      * Establish starting position
     C           KRSST     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0017           OHE PO ACK Flag
     C                     MOVEL*BLANK    YL0018           Record Found US
     C                     MOVEL'N'       YL0018           Record Found US
     C                     MOVEL*BLANK    YL0017           OHE PO ACK Flag
     C                     MOVEL'*NO'     YL0017           OHE PO ACK Flag
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELAMC6TX    YL0017           OHE PO ACK Flag
      * CASE: DB1.OHE PO ACK Flag is *Blank
     C           AMC6TX    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    YL0017           OHE PO ACK Flag
     C                     MOVEL'*NO'     YL0017           OHE PO ACK Flag
     C                     END                             *FI
     C                     MOVEL'Y'       YL0018           Record Found US
     C                     GOTO STEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * VAL PO Exists         RT - EDI Purchase Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BQJ5NX    WQSU01           EDI Trading Par
     C           *LIKE     DEFN BQPONO    WQSU02           G5003-PURCHASE
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WQSU01           EDI Trading Par
     C                     KFLD           WQSU02           G5003-PURCHASE
      * Setup key
     C                     MOVELYL0014    WQSU01           EDI Trading Par
     C                     MOVELYL0011    WQSU02           G5003-PURCHASE
      * Establish starting position
     C           KRSSU     SETLL@P004SK                    *
     C           KRSSU     READE@P004SK                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3103' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       YL0018           Record Found US
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       YL0018           Record Found US
     C                     GOTO SUEXIT                     *QUIT
     C           KRSSU     READE@P004SK                  90*
     C                     ENDDO
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSV01           Application Cod
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSV01           Application Cod
     C                     MOVEL'OMS'     WQSV01           Application Cod
      * Establish starting position
     C           KRSSV     SETLL@DNRESF                    *
     C           KRSSV     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SWRVGN
     C                     END                             *FI
     C           KRSSV     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSW01           Application Cod
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WQSW01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSW01           Application Cod
      * Establish starting position
     C           KRSSW     SETLL@DNRESF                    *
     C           KRSSW     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSW     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * RTV Last Order Seq #'s RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSX01           Company Number
     C           *LIKE     DEFN WBC4NB    WQSX02           Order Number
      * Define keylist
     C           KPSSX     KLIST
     C                     KFLD           WQSX01           Company Number
     C                     KFLD           WQSX02           Order Number
     C                     KFLD           WBDPNB           Order Sequence
     C                     KFLD           WBUENB           Order Secondary
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WQSX01           Company Number
     C                     KFLD           WQSX02           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSX01           Company Number
     C                     Z-ADDP1C4NB    WQSX02           Order Number
     C                     Z-ADDP3DPNB    WBDPNB           Order Sequence
     C                     Z-ADDP3UENB    WBUENB           Order Secondary
      * Establish starting position
     C           KPSSX     SETLL@BGWKF9                    *
     C           KRSSX     READE@BGWKF9                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           WBGMST    IFEQ 'L'                        *IF
     C           WBGMST    OREQ 'A'
     C           WBGMST    OREQ 'C'
     C           WBGMST    OREQ 'R'
     C           WBGMST    OREQ 'E'
     C           WBGMST    OREQ 'H'
     C           WBGMST    OREQ 'I'
      * PAR = DB1 By name
     C                     Z-ADDWBDPNB    P3DPNB           Order Sequence
     C                     Z-ADDWBUENB    P3UENB           Order Secondary
     C                     END                             *FI
     C           KRSSX     READE@BGWKF9                  90*
     C                     ENDDO
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C                     MOVELV2AIC3    WK1X01  1
     C                     MOVELV2C4NB    WK1X02  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#2AIC3'
     C           WK1X02    OREQ '?'                        Order Number
     C           YPMTFD    OREQ '#2C4NB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(CTL) #2AIC3' defaulted for 'Company Number'.
      * Field '(CTL) #2C4NB' defaulted for 'Order Number'.
     C                     CALL 'PDPCSRR'              90  SEL Order
     C                     PARM *BLANK    W0RTN   7
     C           #2AIC3    PARM #2AIC3    WQ0060  30       Company Number
     C           #2C4NB    PARM #2C4NB    WQ0061  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPCSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #2AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #2C4NB    IFNE *ZERO                      Order Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VA999
     C                     END
     C                     END
      *................................................................
      *
     C           KLVAWF    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFC4NB           Order Number
      * Setup key
     C                     Z-ADD#2AIC3    WFAIC3
     C                     Z-ADD#2C4NB    WFC4NB
     C           KLVAWF    CHAIN@BECPFK              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     MOVELWFXIST    #2XIST           Credit Hold
     C                     MOVELWFXJST    #2XJST           Production Hold
     C                     MOVELWFGWST    #2GWST           Header Status
     C                     MOVELWFJNCD    #2JNCD           Order Type_Sale
     C                     Z-ADDWFRMNB    #2RMNB           Load ID
     C                     MOVELWFU2ST    #2U2ST           Export Status
     C                     MOVELWFHNNA    #2HNNA           Ship To City
     C                     MOVELWFDBCD    #2DBCD           Ship To State C
     C                     Z-ADDWFEIDT    #2EIDT           Requested Deliv
     C                     Z-ADDWFAFTM    #2AFTM           Requested Deliv
     C                     MOVELWFGJST    #2GJST           Order in Use
     C                     GOTO VAEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VAEXIT
     C                     END
     C           VA999     TAG
      * Restrictor relation not satisfied
      * Send message 'Order Header TRG       NF'
     C                     MOVEL'USR0176' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'USR0176' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD16        ZHSTRW  40
     C                     Z-ADD21        ZHNDRW  40
     C                     Z-ADD1         ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P3DPNB           Order Sequence
     C                     Z-ADD*ZERO     P3UENB           Order Secondary
      * Clear all neither parameters
     C                     MOVEL*BLANK    P4ACAP           Allow CMD13 Acc
      * Clear all neither parameters
     C                     MOVEL*BLANK    P5TAST           First Time Flag
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P6SEQ1           Seq No 1  PASS
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P7SEQ2           Seq No 2  PASS
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Clear all neither parameters
      * CRT Price Audit Log    CR - PD Price Audit Log Work  * 
     C                     Z-ADD*ZERO     KXAATM           Job Time
     C                     Z-ADD*ZERO     KXAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Display Flag
     C                     MOVEL*BLANK    WUQKST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WACFC7           Order Group Cod
     C                     Z-ADD*ZERO     WAMAVA           Billing Detail
     C                     Z-ADD*ZERO     WAKDVA           Billing Detail
     C                     Z-ADD*ZERO     WAL8VA           Billing Detail
     C                     Z-ADD*ZERO     WAL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WAAYVA           Extended Amount
     C                     Z-ADD*ZERO     WAEXDT           Market Pricing
     C                     Z-ADD*ZERO     WABZPR           Price Overage O
     C                     Z-ADD*ZERO     WAL6NB           Contract Number
     C                     Z-ADD*ZERO     WAGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WAAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WAD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WACCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WAAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WACBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WAATWG           Weight Shipped
     C                     Z-ADD*ZERO     WAAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WAAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WAAKPR           Unit Price
     C                     Z-ADD*ZERO     WAALPR           Unit Price_Cred
     C                     Z-ADD*ZERO     WAAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WAAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WAA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WADUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WAB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WAA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WANTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WANUDT           Consumed Item C
     C                     Z-ADD*ZERO     WANVDT           Deadline Depart
     C                     Z-ADD*ZERO     WANWDT           OD Price Type R
     C                     Z-ADD*ZERO     WANXDT           OD Firm Date
     C                     Z-ADD*ZERO     WABUTM           Deadline Depart
     C                     Z-ADD*ZERO     WABVTM           Price Code
     C                     Z-ADD*ZERO     WABWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WABXTM           Substitution Li
     C                     Z-ADD*ZERO     WABYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WAH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WAH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WAH7NX           OD Item Target
     C                     Z-ADD*ZERO     WAH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WAH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WADVPR           Order Gate_Fina
     C                     Z-ADD*ZERO     WADWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WADXPR           OD Gate_Final P
     C                     Z-ADD*ZERO     WADYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WADZPR           OD Original Ord
     C                     Z-ADD*ZERO     WAGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WAGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WAGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WAPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WARINY           Item Age Days
     C                     Z-ADD*ZERO     WATIDT           Production Ovr
     C                     Z-ADD*ZERO     WATJDT           Production Ovr
     C                     Z-ADD*ZERO     WATKDT           OD Market Begin
     C                     Z-ADD*ZERO     WATLDT           OD Market Endin
     C                     Z-ADD*ZERO     WATMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Quantity Shipped Total
     C                     Z-ADD*ZERO     WUCBQT 112
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Define work field USR Sequence Num. New ATR
     C                     Z-ADD*ZERO     WUQQNB  30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCDPNB           Order Sequence
     C                     Z-ADD*ZERO     WCUENB           Order Secondary
     C                     Z-ADD*ZERO     WCASNO           Audit Sequence
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCAYVA           Extended Amount
     C                     Z-ADD*ZERO     WCYJVA           Extended Amount
     C                     Z-ADD*ZERO     WCAKPR           Unit Price
     C                     Z-ADD*ZERO     WCDBPR           Unit Price Last
     C                     Z-ADD*ZERO     WCALPR           Unit Price_Cred
     C                     Z-ADD*ZERO     WCDCPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEC4NB           Order Number
     C                     Z-ADD*ZERO     WEANC7           AR Customer Num
     C                     Z-ADD*ZERO     WEBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WEB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WEA0DT           Order Date
     C                     Z-ADD*ZERO     WEA5DT           Requested Ship
     C                     Z-ADD*ZERO     WEGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WEACDT           Cancel Date
     C                     Z-ADD*ZERO     WEAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WECXDT           Date of Origina
     C                     Z-ADD*ZERO     WEJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WEA1WG           Order Weight To
     C                     Z-ADD*ZERO     WEEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WEAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WERMNB           Load ID
     C                     Z-ADD*ZERO     WETBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WER1NB           Rated Freight
     C                     Z-ADD*ZERO     WERNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WEATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WERSRN           Resell Referenc
     C                     Z-ADD*ZERO     WET3NB           Attach to Order
     C                     Z-ADD*ZERO     WECONB           Invoice Number
     C                     Z-ADD*ZERO     WEAWDT           Invoice Date
     C                     Z-ADD*ZERO     WEVRVA           A_R order Value
     C                     Z-ADD*ZERO     WEB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WENODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WENPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WENQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WENRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WENSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WEBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WEBQTM           Time of Origina
     C                     Z-ADD*ZERO     WEBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WEBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WEBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WEH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WEH1NX           Act Non_Ref Frt
     C                     Z-ADD*ZERO     WEH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WEH3NX           OH Total Non_Re
     C                     Z-ADD*ZERO     WEH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WEC0C7           Claim Number
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL@CN,1     @CN,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SFCRRC.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003  3
     C                     Z-ADD*ZERO     WL0004  70
     C                     Z-ADD*ZERO     WL0005  60
     C                     MOVEL*BLANK    WL0006  3
     C                     MOVEL*BLANK    WL0007  1
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0008  30
     C                     MOVEL*BLANK    WL0009  1
     C                     MOVEL*BLANK    WL0010  1
      * Define local variables for subroutine SSRVGN.
     C                     Z-ADD*ZERO     WL0011  70
     C                     MOVEL*BLANK    WL0012  6
     C                     MOVEL*BLANK    WL0013  6
     C                     MOVEL*BLANK    WL0014  6
      * Define null work field Plant Company Sts
     C                     MOVEL*BLANK    YN0001  1
      * Define local work field Company Organization
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field OHE HPB RIN Price
     C                     Z-ADD*ZERO     YL0002 112
      * Define local work field Order Gate_Final Price
     C                     Z-ADD*ZERO     YL0003 114
      * Define local work field OD Gate_Final Price Adj
     C                     Z-ADD*ZERO     YL0004 114
      * Define local work field OD Weighted Avg Price
     C                     Z-ADD*ZERO     YL0005 114
      * Define null work field Plant Company Sts
     C                     MOVEL*BLANK    YN0002  1
      * Define null work field UOM Pricing
     C                     MOVEL*BLANK    YN0003  2
      * Define null work field Unit Weight
     C                     Z-ADD*ZERO     YN0004 112
      * Define null work field Catch Weight Status
     C                     MOVEL*BLANK    YN0005  1
      * Define local work field Price Method Type
     C                     MOVEL*BLANK    YL0006  1
      * Define local work field PMH Price Type
     C                     MOVEL*BLANK    YL0007  1
      * Define local work field Trans Type 1 PASS     USR
     C                     MOVEL*BLANK    YL0008  2
      * Define local work field EDI Process Flag
     C                     MOVEL*BLANK    YL0009  1
      * Define null work field Order Type_Sales
     C                     MOVEL*BLANK    YN0006  2
      * Define local work field AR Customer Number
     C                     Z-ADD*ZERO     YL0010  70
      * Define null work field Ship To Customer
     C                     Z-ADD*ZERO     YN0007  70
      * Define null work field Ship To Name
     C                     MOVEL*BLANK    YN0008 30
      * Define null work field Ship To Address Line 1
     C                     MOVEL*BLANK    YN0009 30
      * Define null work field Ship To Address Line 2
     C                     MOVEL*BLANK    YN0010 30
      * Define null work field Ship To Address Line 3
     C                     MOVEL*BLANK    YN0011 30
      * Define null work field Ship To City
     C                     MOVEL*BLANK    YN0012 20
      * Define null work field Ship To State Code
     C                     MOVEL*BLANK    YN0013  2
      * Define null work field Ship To Zip_Postal Code
     C                     MOVEL*BLANK    YN0014 11
      * Define null work field Bill to Customer
     C                     Z-ADD*ZERO     YN0015  70
      * Define null work field Bill to Name
     C                     MOVEL*BLANK    YN0016 30
      * Define null work field Bill to Address Line 1
     C                     MOVEL*BLANK    YN0017 30
      * Define null work field Bill to Address Line 2
     C                     MOVEL*BLANK    YN0018 30
      * Define null work field Bill to Address Line 3
     C                     MOVEL*BLANK    YN0019 30
      * Define null work field Bill to City
     C                     MOVEL*BLANK    YN0020 20
      * Define null work field Bill to State Code
     C                     MOVEL*BLANK    YN0021  2
      * Define null work field Bill to Zip_Postal Code
     C                     MOVEL*BLANK    YN0022 11
      * Define local work field Customer Purchase Order #
     C                     MOVEL*BLANK    YL0011 15
      * Define null work field Order Date
     C                     Z-ADD*ZERO     YN0023  70
      * Define null work field Requested Ship Date
     C                     Z-ADD*ZERO     YN0024  70
      * Define null work field Actual Shipped Date
     C                     Z-ADD*ZERO     YN0025  70
      * Define null work field Cancel Date
     C                     Z-ADD*ZERO     YN0026  70
      * Define null work field Terms Code
     C                     MOVEL*BLANK    YN0027  2
      * Define null work field Special Instructions
     C                     MOVEL*BLANK    YN0028 40
      * Define null work field Special Instructions 2
     C                     MOVEL*BLANK    YN0029 40
      * Define null work field Carrier Code
     C                     MOVEL*BLANK    YN0030  3
      * Define null work field Comment Print Acknowledge
     C                     MOVEL*BLANK    YN0031  1
      * Define null work field Comment Print Inv_Cr_Memo
     C                     MOVEL*BLANK    YN0032  1
      * Define null work field Comment Print Pick Slip
     C                     MOVEL*BLANK    YN0033  1
      * Define null work field Comment Print Ship Doc
     C                     MOVEL*BLANK    YN0034  1
      * Define null work field Reason Code
     C                     MOVEL*BLANK    YN0035  3
      * Define null work field Order in Use
     C                     MOVEL*BLANK    YN0036  1
      * Define null work field Header Status
     C                     MOVEL*BLANK    YN0037  1
      * Define null work field Header Status Last
     C                     MOVEL*BLANK    YN0038  1
      * Define null work field Order Type Print Status
     C                     MOVEL*BLANK    YN0039  1
      * Define null work field Scheduled Ship Date
     C                     Z-ADD*ZERO     YN0040  70
      * Define null work field User Original Entry
     C                     MOVEL*BLANK    YN0041 10
      * Define null work field Date of Original Entry
     C                     Z-ADD*ZERO     YN0042  70
      * Define null work field Order Value Total
     C                     Z-ADD*ZERO     YN0043 112
      * Define null work field Order Weight Total
     C                     Z-ADD*ZERO     YN0044 112
      * Define null work field Credit Hold
     C                     MOVEL*BLANK    YN0045  1
      * Define null work field Production Hold
     C                     MOVEL*BLANK    YN0046  1
      * Define null work field New Customer Hold
     C                     MOVEL*BLANK    YN0047  1
      * Define null work field Requested Delivery Date
     C                     Z-ADD*ZERO     YN0048  70
      * Define null work field Requested Delivery Time
     C                     Z-ADD*ZERO     YN0049  40
      * Define null work field Accounts Receiv_Ent 1
     C                     MOVEL*BLANK    YN0050  4
      * Define null work field Accounts Receiv_Ent 2
     C                     MOVEL*BLANK    YN0051 12
      * Define null work field Load ID
     C                     Z-ADD*ZERO     YN0052  70
      * Define null work field Absorbed Freight Rate CWT
     C                     Z-ADD*ZERO     YN0053  52
      * Define null work field Rated Freight
     C                     Z-ADD*ZERO     YN0054 112
      * Define null work field LTL Flag
     C                     MOVEL*BLANK    YN0055  1
      * Define null work field Price Audit
     C                     MOVEL*BLANK    YN0056  1
      * Define local work field Price Status
     C                     MOVEL*BLANK    YL0012  1
      * Define null work field Shipping Method
     C                     MOVEL*BLANK    YN0057  2
      * Define null work field Export Status
     C                     MOVEL*BLANK    YN0058  1
      * Define null work field Palletize
     C                     MOVEL*BLANK    YN0059  1
      * Define null work field Shrink Wrap
     C                     MOVEL*BLANK    YN0060  1
      * Define null work field Slip Sheet
     C                     MOVEL*BLANK    YN0061  1
      * Define null work field Age Code
     C                     MOVEL*BLANK    YN0062  1
      * Define null work field Reefer Temperature
     C                     Z-ADD*ZERO     YN0063  52
      * Define null work field Load Type
     C                     MOVEL*BLANK    YN0064  1
      * Define null work field Attach to Invoice Number
     C                     Z-ADD*ZERO     YN0065  70
      * Define null work field Load Plan Order
     C                     MOVEL*BLANK    YN0066  1
      * Define null work field Print Pick Slip
     C                     MOVEL*BLANK    YN0067  1
      * Define null work field Resell Reference Number
     C                     Z-ADD*ZERO     YN0068  70
      * Define null work field Special Comment 1
     C                     MOVEL*BLANK    YN0069 30
      * Define null work field Special Comment 2
     C                     MOVEL*BLANK    YN0070 30
      * Define null work field Affect Auto Accruals
     C                     MOVEL*BLANK    YN0071  1
      * Define null work field Sales Route Code
     C                     MOVEL*BLANK    YN0072  3
      * Define null work field Manager Level Code
     C                     MOVEL*BLANK    YN0073  2
      * Define null work field VP Level Code
     C                     MOVEL*BLANK    YN0074  3
      * Define null work field Attach to Order Number
     C                     Z-ADD*ZERO     YN0075  70
      * Define null work field Reason for Price Audit
     C                     MOVEL*BLANK    YN0076  3
      * Define null work field Invoice Number
     C                     Z-ADD*ZERO     YN0077  70
      * Define null work field Invoice Suffix
     C                     MOVEL*BLANK    YN0078  2
      * Define null work field Invoice Date
     C                     Z-ADD*ZERO     YN0079  70
      * Define null work field Event Code
     C                     MOVEL*BLANK    YN0080  2
      * Define null work field Trans Contol AS400_Plant
     C                     MOVEL*BLANK    YN0081  1
      * Define null work field Modified Flag
     C                     MOVEL*BLANK    YN0082  1
      * Define null work field A_R order Value Total
     C                     Z-ADD*ZERO     YN0083 112
      * Define null work field Billing Activity Type
     C                     MOVEL*BLANK    YN0084  1
      * Define null work field Block Order Flag
     C                     MOVEL*BLANK    YN0085  1
      * Define null work field Order Certification Flag
     C                     MOVEL*BLANK    YN0086  1
      * Define null work field Invoice Order Value Tot
     C                     Z-ADD*ZERO     YN0087 112
      * Define null work field Process Sts for 3C
     C                     MOVEL*BLANK    YN0088  1
      * Define null work field Order Conf Fax Sts
     C                     MOVEL*BLANK    YN0089  1
      * Define null work field Manifest Fax Sts
     C                     MOVEL*BLANK    YN0090  1
      * Define null work field Invoice Fax Sts
     C                     MOVEL*BLANK    YN0091  1
      * Define null work field Transfer in Storage Ind
     C                     MOVEL*BLANK    YN0092  1
      * Define null work field Email Cust On Order Ship
     C                     MOVEL*BLANK    YN0093  1
      * Define null work field Order Emailed
     C                     MOVEL*BLANK    YN0094  1
      * Define null work field Export Docs Go w_Driver
     C                     MOVEL*BLANK    YN0095  1
      * Define null work field Shipping Temp Code C_F
     C                     MOVEL*BLANK    YN0096  1
      * Define null work field Broker Order Status
     C                     MOVEL*BLANK    YN0097  1
      * Define null work field Air Freight Order
     C                     MOVEL*BLANK    YN0098  1
      * Define null work field Order Requires Review
     C                     MOVEL*BLANK    YN0099  2
      * Define null work field OH Load Plan Ready
     C                     MOVEL*BLANK    YN0100  2
      * Define null work field Export USDA Approved
     C                     MOVEL*BLANK    YN0101  2
      * Define null work field HPB Ship to Warehouse
     C                     MOVEL*BLANK    YN0102  3
      * Define null work field OH TF Exempt Code
     C                     MOVEL*BLANK    YN0103  3
      * Define null work field OH Appt Confirmation Dt
     C                     Z-ADD*ZERO     YN0104  70
      * Define null work field JPN Invoice Issuance Date
     C                     Z-ADD*ZERO     YN0105  70
      * Define null work field Load Actual Shipped Date
     C                     Z-ADD*ZERO     YN0106  70
      * Define null work field Load BOL Complete Date
     C                     Z-ADD*ZERO     YN0107  70
      * Define null work field Load Truck Departure Date
     C                     Z-ADD*ZERO     YN0108  70
      * Define null work field Maximum Gross Weight
     C                     Z-ADD*ZERO     YN0109  60
      * Define null work field Time of Original Entry
     C                     Z-ADD*ZERO     YN0110  60
      * Define null work field OH Appt Confirmation Tm
     C                     Z-ADD*ZERO     YN0111  60
      * Define null work field Load BOL Complete Time
     C                     Z-ADD*ZERO     YN0112  60
      * Define null work field Load Truck Departure Time
     C                     Z-ADD*ZERO     YN0113  60
      * Define null work field Act Frt Reference Amount
     C                     Z-ADD*ZERO     YN0114 112
      * Define null work field Act Non_Ref Frt Amount
     C                     Z-ADD*ZERO     YN0115 112
      * Define null work field OH Fuel Surcharge Amount
     C                     Z-ADD*ZERO     YN0116 112
      * Define null work field OH Total Non_Ref Frt Amt
     C                     Z-ADD*ZERO     YN0117 112
      * Define null work field OH Total Ref Frt Amt
     C                     Z-ADD*ZERO     YN0118 112
      * Define null work field Claim Number
     C                     Z-ADD*ZERO     YN0119  70
      * Define null work field EDI Status 1
     C                     MOVEL*BLANK    YN0120  1
      * Define null work field EDI Status 2
     C                     MOVEL*BLANK    YN0121  1
      * Define null work field EDI Status 3
     C                     MOVEL*BLANK    YN0122  1
      * Define null work field Job Time
     C                     Z-ADD*ZERO     YN0123  60
      * Define null work field User Id
     C                     MOVEL*BLANK    YN0124 10
      * Define null work field Job Name
     C                     MOVEL*BLANK    YN0125 10
      * Define null work field Job Date
     C                     Z-ADD*ZERO     YN0126  70
      * Define local work field POC/POCA ??
     C                     MOVEL*BLANK    YL0013  6
      * Define local work field EDI Trading Partner No
     C                     MOVEL*BLANK    YL0014  6
      * Define local work field EDI POA
     C                     MOVEL*BLANK    YL0015  1
      * Define local work field EDI POAC
     C                     MOVEL*BLANK    YL0016  1
      * Define local work field OHE PO ACK Flag
     C                     MOVEL*BLANK    YL0017  4
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0018  1
      * Define local work field Send EDI Document Y/N
     C                     MOVEL*BLANK    YL0019  1
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     Z-ADD06        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * VAL Rtv and Center Hdg IF
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SVRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
     C                     Z-ADD*ZERO     P3DPNB           Order Sequence
     C                     Z-ADD*ZERO     P3UENB           Order Secondary
      * Change Usr lines on screen to 999 to retrieve last order detail l
      * RTV Last Order Seq #'s RT - PD Order Detail  * 
     C                     EXSR SXRVGN
     C                     MOVEL'N'       P4ACAP           Allow CMD13 Acc
     C                     MOVEL'Y'       P5TAST           First Time Flag
     C                     MOVEL'N'       WUQKST           Display Flag
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 POCACK
00002 DSYSCO
